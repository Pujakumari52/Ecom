null
function TransientImpostor(n){function t(){for(var n=0;n<a.length;n++)e(a[n])}function e(n){var t=f;u[n]=function(){var e=t[n];return function(){r.push(e.bind(t,arguments))}}()}function i(){if(l){o[c]=f,s&&clearTimeout(s);for(var n=0,t=r.length;t>n;n++){var e=r.shift();e()}u=null,l=!1}}var r=[],u={},a=null,o=n.ctx,c=n.nameSpace,f=n.object||o[c];n.iterateKeys?(a=Object.keys(f),t()):u=function(){var n=f;return function(){r.length>0&&(r=[]),r.push(n.bind(o,arguments))}}(),o[c]=u;var s,l=!0;return n.dismantleTimeout&&(s=setTimeout(function(){i()},n.dismantleTimeout)),{dismantle:i}}
var appEvent=new function(){function r(r,n){for(var t=[],e=r.length,i=0;e>i;i++)t.push(n[r[i]]);return t}var n={};return{on:function(r,t){r=r.split(" ");var e={};return e.fn=t,e.args=Array.prototype.slice.call(arguments,2),r.forEach(function(r){var t=n[r];t||(n[r]=[]),n[r].push(e)}),this},off:function(r,t){r=r.split(" "),r.forEach(function(r){var e=n[r];for(var i in e)e[i].fn===t&&e.splice(i,1)})},trigger:function(t,e,i){var a=n[t];if(!a)return void 0;var f=!1,s=this;return a.forEach(function(n){if(e&&Array.isArray(e))var t=e;else var t=r(n.args,e);var a=n.fn.apply(i||s,t||[]);appEvent.isDefaultPrevented(a)&&(f=!0)}),f?(f=!1,this.preventDefault()):void 0},list:function(){return n},preventDefault:function(){return this.signals.PREVENT_DEFAULT},isDefaultPrevented:function(r){return this.signals.PREVENT_DEFAULT===r},signals:{PREVENT_DEFAULT:{}}}};
!function(){WmsContactImpl.handleHideContactsUI=function(){var t=["wmscollapsebar","wmscollapsetbar","wmschatbar","wmsudtlsbar","wmsntfybar","wmsactchatbar","wmsgrpbar","wmsusrsbar"];t.forEach(function(t){var e=document.getElementById(t);e&&(e.style.display="")}),document.getElementById("wmscollapsetbar").style.zIndex=""},WmsContactImpl.handleShowContactsUI=function(){var t=["#wmscollapsebar","#wmsudtlsbar","#wmschatbar","#wmsntfybar","#wmsactchatbar","#wmsgrpbar","#wmsusrsbar",".wms-ucd"];t.forEach(function(t){var e=document.querySelector(t);e&&(e.style.display="none")});var e=document.getElementById("wmscollapsetbar");e.style.zIndex="23001",e.style.height="25px"},WmsContactImpl.handleNonUser=function(){var t=["wmscollapsebar","wmsudtlsbar","wmsntfybar","wmsgrpbar","wmsusrsbar","wmsactchatbar","wmscollapsetbar","wmsbarmovablehint"];t.forEach(function(t){var e=document.getElementById(t);e&&(e.style.display="none")})};var t="";WmsUIImpl.UIReady=function(){if(WebMessanger.disableWMSStatus(),!t){var e=document.getElementById("statusBarContainer");e&&(t=e.innerHTML,e.innerHTML="")}$("#wmsstatusbar").css({width:"50%",float:"right"}),WebMessanger.setServiceStatus(t),initBottomBand(),(!getObj("mainOuterDiv")||writerCalenderWorkbook||showChartWorbook)&&($("#screenViewContiner").hide(),$("#userConnectStatusDiv").hide()),appEvent.trigger("wms.uiready")};var e={ctx:window,nameSpace:"WmsContactImpl",iterateKeys:!0},a=TransientImpostor(e),s={ctx:window,nameSpace:"WmsUIImpl",iterateKeys:!0},n=TransientImpostor(s);document.addEventListener("DOMContentLoaded",function(){a.dismantle(),n.dismantle()})}();
function reregister(){var e=new RequestParameters(ActionConstants.GET_WMS_USERS),s=new AjaxRequest;e.setParameters("isuserpresent"),s.init("POST",e.getURL(),!0,e.getParametersAsString()),s.addEventListener("onComplete",function(e){var s=e.response;if("FALSE"==s){CollabPanel.allowUserSessionInit();var r=wmsOptions,a=r.loginName||LOGINNAME;if(r.isAnonUser||writerCalenderWorkbook||showChartWorbook){var n=r.rmUser||r.zuid;WebMessanger.registerAnnon("ST",n,a)}else WebMessanger.getNickName()&&(a=WebMessanger.getNickName()),WebMessanger.registerZuid("ST",r.zuid,a,r.wmsSilent)}}),s.sendRequest()}!function(){var e=wmsOptions;WebMessanger.setNoDomainChange(),WebMessanger.theme=e.theme?e.theme:"grey",WebMessanger.setWmsContext("_wmssheet"),e.langCode&&e.countryCode&&WebMessanger.setLocale(e.langCode,e.countryCode),e.rebrandName&&WebMessanger.setRebrand(e.rebrandName),e.meetingURL&&WebMessanger.setMeetingUrl(e.meetingURL),e.disableMeeting&&WebMessanger.disableMeeting(),e.disableContacts&&WebMessanger.disableContacts(),e.disableGroups&&WebMessanger.disableGroups(),e.disableActiveChat&&WebMessanger.disableActiveChat(),e.disableProfile&&WebMessanger.disableProfile(),e.disableChatbarOptions&&(WebMessanger.showEmptyBar?WebMessanger.showEmptyBar():(WebMessanger.disableMeeting(),WebMessanger.disableContacts(),WebMessanger.disableGroups(),WebMessanger.disableActiveChat(),WebMessanger.disableProfile(),WebMessanger.disableNotification(),WebMessanger.disableToggleUI())),e.jsStaticServerURL&&WebMessanger.setJsStaticDomain(e.jsStaticServerURL),e.cssStaticServerURL&&WebMessanger.setCssStaticDomain(e.cssStaticServerURL),e.photoServerURL&&(window.PHOTO_SERVER_URL=e.photoServerURL,WebMessanger.setPhotoServer(e.photoServerURL)),e.chatServerURL&&WebMessanger.setChatServer(e.chatServerURL),e.mailServerURL&&WebMessanger.setMailServer(e.mailServerURL),e.IamServerURL&&(window.IAM_SERVER_URL=e.IamServerURL,WebMessanger.setIamServer(e.IamServerURL));var s=e.loginName||LOGINNAME,r=e.zuid||-1,a=e.isAnonUser;if(a||writerCalenderWorkbook){var n=e.rmUser||e.zuid;e.doNotRegisterWMS&&(n="-1",document.addEventListener("DOMContentLoaded",function(){documentBakeStatus.setCollabBake(!0)})),"AUTH_REMOTE"==accessIdentity?WebMessanger.registerAnnon("ST",n,s,!0):WebMessanger.registerAnnon("ST",n,s)}else{var t=WMSSessionConfig.CHAT|WMSSessionConfig.CHAT_PRESENCE|WMSSessionConfig.PRESENCE_ORG|WMSSessionConfig.PRESENCE_PERSONAL|WMSSessionConfig.CROSS_PRD;if(WebMessanger.getNickName()&&(s=WebMessanger.getNickName()),jsMsg.ZohoHomeURL.indexOf("skydesk")<0)try{WebMessanger.enableTokenPairAuth()}catch(e){}WebMessanger.setConfig(t),isPreview&&(WebMessanger.disableContacts(),WebMessanger.disableGroups(),WebMessanger.disableActiveChat(),WebMessanger.disableProfile(),WebMessanger.disableMeeting(),WebMessanger.disableNotification(),WebMessanger.disableCWActions(),WebMessanger.disableSmartChat()),WebMessanger.registerZuid("ST",r,s,e.wmsSilent)}}();
!function(){var e={};e.handleUserList=function(e,n){isCollabJoined=!0,COLLAB_ID!=e||""==COLLAB_ID||WebMessanger.isdisablewms()||jsVERSION_VIEW||(documentBakeStatus.setCollabBake(!0),documentBakeStatus.isBaked()&grantRequest&&(jsPUBLIC_VIEW&&void 0!=TEMP_CONTAINER_IDENTITY||(grantRequest=!1,postDocumentLoader())),READ_WRITE||"undefined"==typeof CollabPanel||CollabPanel.changeUserPresenceState("true"),appEvent.trigger("collab.userlistchange",[n]))},e.handleMessage=function(e,n,s,o,t){setTimeout(function(){e!==COLLAB_ID||jsVERSION_VIEW||WMSResponseProcessor.processMessage(e,n,s,o,t)},2)},e.handlePresence=function(e,n,s,o,t){return appEvent.trigger("collab.handlepresence",[e,n,s,o,t]),!1},e.join=function(e){WebMessanger.joinCollab(e)},e.quit=function(e){WebMessanger.quit(e),setTimeout(function(){CollabPanel.syncUserSessions()},10)},e.onConnect=function(){},e.serverup=function(){WMSResponseProcessor.handleServerUp();new _ResponseManager(1e3,3e3,25e3,9,5e3,allowSyncTimerGetStatus)},e.serverdown=function(){$("#wms-netdownbanner").css("z-index",0),WMSResponseProcessor.handleServerDown()},e.handleZohoMessage=function(){},e.handleCustomMessage=function(e){setTimeout(function(){jsVERSION_VIEW||WMSResponseProcessor.processCustomMessage(e)},2)},e.handleCrossProductMessage=function(e,n){var s=n.RESOURCE_ID?n.RESOURCE_ID:n.resourceId;if(s==RESOURCE_ID){void 0!=n.newDocumentName?updateDocName(n.newDocumentName):void 0!=n.NAME&&n.ACTION_BY!=zuid&&updateDocName(n.NAME);var o=null,t=new AjaxRequest,a=LOGINNAME,r="userIdentity="+a;if("RESOURCE_PERMISSION_CHANGED"==n.ACTION)o=new RequestParameters(ActionConstants.SHARE_PERMISSION_CHANGE);else if("RESOURCE_LOCKED"==n.ACTION||"RESOURCE_UNLOCKED"==n.ACTION)o=new RequestParameters(ActionConstants.CHECKIN_CHECKOUT);else if("RESOURCE_TRASHED"==n.ACTION&&0==DOCUMENT_LOCKED){var i={DU:!0,a:ActionConstants.DOCUMENT_TRASH};WMSResponseProcessor.processMessage(COLLAB_ID,a,a,CURR_DOC_OWNERNAME,JSON.stringify(i))}else if("RESOURCE_UNSHARED"==n.ACTION){var i={DU:!0,a:ActionConstants.SHARE_REMOVE_BYOWNER};WMSResponseProcessor.processMessage(COLLAB_ID,zuid,zuid,CURR_DOC_OWNERNAME,JSON.stringify(i))}zuid!=n.ACTION_BY&&null!=o?(t.init("POST",o.getURL(),!0,o.getParametersAsString()),t.appendParams(r),t.sendRequest()):zuid==n.ACTION_BY&&("RESOURCE_LOCKED"==n.ACTION?(showLockedBy("you"),InfoBanner.showBanner(jsMsg["Checkin.CheckoutBanner"],!0,"info")):"RESOURCE_UNLOCKED"==n.ACTION&&(document.getElementById("lockIcon").remove(),RESOURCE_LOCKED=!1,InfoBanner.showBanner(jsMsg["Checkin.CheckinBanner"],!0,"info"))),appEvent.trigger("Discussion.updateSharedUsers",[n])}appEvent.trigger("collab.crossproductmsg",[e,n])},e.openURL=function(e,n,s,o){return"ST"==o&&null!=s.DOCID?(loadDocument(s.DOCID,n),!1):!0},e.handleUserAdd=function(){},e.handleUserDeleted=function(e,n){CollabPanel.handleUserDelete(n)},e.handleCollabAdd=function(){},e.handleCollabDelete=function(){},e.handleIsOnline=function(){},e.handleLogout=function(){},e.goOffline=function(){},e.wmsOffline=function(){try{WMSResponseProcessor.handleWmsOffline()}catch(e){}},e.handleChatNotifyMessage=function(){},e.getPageTitle=function(){return DOCUMENT_NAME},e.handleWmsDisable=function(){},e.handleServiceMessage=function(e){showBannerMessage("INFO",e.msg,!0)},e.handleComposeMail=function(){return!1},e.handleLanguageChange=function(){var e=new RequestParameters(ActionConstants.INIT_I18N_SESSION),n=new AjaxRequest;n.init("POST",e.getURL(),!1,e.getParametersAsString()),n.sendRequest()},window.Collaboration=e;var n={ctx:window,nameSpace:"Collaboration",iterateKeys:!0},s=TransientImpostor(n);document.addEventListener("DOMContentLoaded",function(){s.dismantle()})}(window);
var requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)}}(),cancelAnimationFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||function(n){clearTimeout(n)}}();
function isIE(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var t=navigator.userAgent,n=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1))}return-1==e?!1:!0}function findPosX(e){var t=0;if(document.getElementById||document.all)try{for(;e.offsetParent;)t+=e.offsetLeft,e=e.offsetParent}catch(e){return t}else document.layers&&(t+=e.x);return t}function findPosY(e){var t=0;if(document.getElementById||document.all)try{for(;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent}catch(e){return t}else document.layers&&(t+=e.y);return t}function findDocDim(){return browser_ie?{width:document.documentElement.offsetWidth+document.body.scrollLeft,height:document.documentElement.offsetHeight+document.body.scrollTop}:browser_nn4||browser_nn6?{width:window.innerWidth+document.body.scrollLeft,height:window.innerHeight+document.body.scrollTop}:void 0}function findClientDim(){if(browser_ie)var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight;else if(browser_nn4||browser_nn6)var e=window.innerWidth,t=window.innerHeight;return{width:e,height:t}}function getCursorPos(e){if(browser_ie)var t=window.event.clientX+document.documentElement.scrollLeft,n=window.event.clientY+document.documentElement.scrollTop;else if(browser_nn6)var t=e.pageX,n=e.pageY;return{x:t,y:n}}function getObj(e,t){return t||(t=document),t.getElementById(e)}function getXmlhttp(){return new XMLHttpRequest}function clearTextSelection(){if(READ_WRITE&&!Discussion.isAddCmtOn&&!Annot.isNoteOn())if(window.getSelection)window.getSelection().removeAllRanges();else if(document.getSelection){var e=document.getSelection();e.collapse&&e.collapse(!0),e.removeAllRanges&&e.removeAllRanges()}else document.selection&&("Text"!=document.selection.type?document.selection.empty():document.selection.clear())}function isCapsLockOn(e,t){return e>=65&&90>=e&&!t||e>=95&&123>=e&&t?!0:!1}function readCookie(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){var o=n[r].trim();if(0===o.indexOf(t))return o.substring(t.length)}}function set_cookie(e,t){var n=set_cookie.arguments,r=set_cookie.arguments.length,o=r>2?n[2]:null,i=r>3?n[3]:null,a=r>4?n[4]:null,s=r>5?n[5]:!1;document.cookie=e+"="+escape(t)+(null==o?"":"; expires="+o.toGMTString())+(null==i?"":"; path="+i)+(null==a?"":"; domain="+a)+(1==s?"; secure":"")}function getCaretPos(e){var t=-1;if("undefined"==typeof document.selection||browser_opera||browser_ie)"undefined"!=typeof e.selectionStart&&(t=e.selectionStart);else{var n=document.selection.createRange();if("INPUT"!=e.tagName.toUpperCase()){var r=n.duplicate();r.moveToElementText(e),r.setEndPoint("EndToEnd",n),e.selectionStart=r.text.length-n.text.length,e.selectionEnd=e.selectionStart+n.text.length,t=e.selectionStart}else"INPUT"==e.tagName.toUpperCase()&&(t=getFormInputCaretPos(e,n))}return t}function setCaretPos(e,t){return"none"==e.style.display||e.disabled||"hidden"==e.style.visibility?!1:(e.focus(),void(isNaN(t)?"START"==t?setSelectionRange(e,0,0):"END"==t&&setSelectionRange(e,e.value.length,e.value.length):setSelectionRange(e,t,t)))}function getSelectedText(e){if(is_ie&&!browser_opera){if(document.selection){var t=document.selection.createRange();if("TEXTAREA"==e.tagName){var n=t.duplicate();n.moveToElementText(e),n.setEndPoint("EndToEnd",t),e.selectionStart=n.text.length-t.text.length,e.selectionEnd=e.selectionStart+t.text.length}else"INPUT"==e.tagName.toUpperCase()&&(e.selectionStart=getFormInputCaretPos(e,t),e.selectionEnd=getSelectionEnd(e,t))}return e.value.substring(e.selectionStart,e.selectionEnd)}var r="";return e.value&&(r=e.value.substring(getSelectionStart(e),getSelectionEnd(e))),r}function selectText(e,t,n){e.focus(),setSelectionRange(e,t,n)}function insertText(e,t){var n=getCaretPos(e),r=e.value.substring(0,getSelectionStart(e)),o=e.value.substr(getSelectionEnd(e),e.value.length);return e.value=r+t+o,setCaretPos(e,n+t.length),n}function getCurrentStyle(e,t){if(browser_ie){if(e&&e.currentStyle)return e.currentStyle[t]}else if(browser_nn6)return document.defaultView.getComputedStyle(e,"")[t]}function getSelectionStart(e){var t=-1;if("undefined"==typeof document.selection||browser_opera)"undefined"!=typeof e.selectionStart&&(t=e.selectionStart);else{var n=document.selection.createRange();if("INPUT"!=e.tagName.toUpperCase()){var r=n.duplicate();r.moveToElementText(e),r.setEndPoint("EndToEnd",n),e.selectionStart=r.text.length-n.text.length,e.selectionEnd=e.selectionStart+n.text.length,t=e.selectionStart}else t=getFormInputCaretPos(e,n)}return t}function getSelectionEnd(e){var t=-1;return"undefined"==typeof document.selection||browser_opera?"undefined"!=typeof e.selectionStart&&(t=e.selectionEnd):t=getSelectionStart(e)+document.selection.createRange().text.length,t}function getFormInputCaretPos(e,t){var n,r,o;return"INPUT"==e.tagName.toUpperCase()?(r=0==t.compareEndPoints("StartToEnd",t),r||t.collapse(!0),o=t.getBookmark(),n=o.charCodeAt(2)-2):void 0}function setSelectionRange(e,t,n){try{if(e.setSelectionRange)e.setSelectionRange(t,n);else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),t!=n?(r.moveEnd("character",n),r.moveStart("character",t)):r.moveStart("character",t),r.select()}}catch(e){}}function getCountOfOccrnceOfCharInStr(e,t){return e.split(t).length-1}function stopEvt(e){if(!e)var e=window.event;return e.stopPropagation(),e.preventDefault(),!1}function disableKeys(e){return"undefined"==typeof e||79!=e.keyCode&&70!=e.keyCode&&80!=e.keyCode?void 0:(e.keyCode=0,!1)}function matchString(e,t){var n=[];if(isNaN(e)&&null!=new RegExp("[a-z].*","gi").exec(e)){e=escapeSpecialChar(e);for(var r=t.length,o=0;r>o;o++){var i=escapeSpecialChar(t[o],"no"),a=new RegExp("^"+e+".*?","gi"),s=a.exec(i);s&&0==s.index&&(n[n.length]=unescapeSpecialChar(i))}}return n}function isTextSelected(e){return getSelectedText(e).length>0?!0:!1}function restrictTextSelection(e){e.onselectstart=function(){return!1},e.onmousedown=function(){return!1}}function isNumber(e){return"number"==typeof e?!0:!1}function isObject(e){return"object"==typeof e?!0:!1}function isStr(e){return"string"==typeof e?!0:!1}function isBoolean(e){return"boolean"==typeof e?!0:!1}function isDialogHidden(){return 1==dialogHidden?!0:!1}function getChildNode(e,t){return browser_ie?e&&null!=e.childNodes[t]?e.childNodes[t]:null:browser_nn6?e&&null!=e.childNodes.item(t)?e.childNodes.item(t):null:void 0}function getChildItem(e,t){return browser_ie?e[t]:browser_nn6?e.item(t):void 0}function findIndex(e){if(e&&!isUndefined(e.parentNode)&&null!=e.parentNode){for(var t=e.parentNode.childNodes,n=-1,r=0,o=t.length;o>r;r++)if(t[r]==e){n=r;break}return n}return 0}function getChildNodesLength(e){return browser_ie?e.children.length:browser_nn6?e.childNodes.length:void 0}function isUndefined(e){return"undefined"==typeof e}function isElement(e){return e&&e.tagName?!0:!1}function isArray(e){return"[object Array]"===Object.prototype.toString.call(e)}function convertNumber(e){if(isNumber(e))return e;var t=parseInt(e);return isNaN(t)?e:t}function getDateFormat(){var e="mm/dd/yy";return"MDY"===userDateFormatType&&(e="mm"+userDateSeparator+"dd"+userDateSeparator+"yy"),"DMY"===userDateFormatType&&(e="dd"+userDateSeparator+"mm"+userDateSeparator+"yy"),"YMD"===userDateFormatType&&(e="yy"+userDateSeparator+"mm"+userDateSeparator+"dd"),e}function getPrintableCharacterKeyCodes(){return[8,32,46,48,49,50,51,52,53,54,55,56,57,59,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,107,109,188,190,191,192,219,220,221,222]}function parseJSON(e){return e?JSON.parse(e):""}function unique(e){var t=[];e:for(var n=0,r=e.length;r>n;n++){for(var o=0,i=t.length;i>o;o++)if(t[o]==e[n])continue e;t[t.length]=e[n]}return t}function showElements(e,t,n){if(isUndefined(t))for(var r=0;r<e.length;r++)$("#"+e[r]).is(":hidden")&&n,$("#"+e[r]).show();else for(var r=0;r<e.length;r++)$("#"+e[r]).is(":hidden")&&n?$("#"+t).zbutton("show","#"+e[r]):$("#"+t).zbutton("show","#"+e[r])}function hideElements(e,t,n){if(isUndefined(t))for(var r=0;r<e.length;r++)$("#"+e[r]).is(":visible")&&n,$("#"+e[r]).hide();else for(var r=0;r<e.length;r++)!$("#"+e[r]).is(":hidden")&&n?$("#"+t).zbutton("hide","#"+e[r]):$("#"+t).zbutton("hide","#"+e[r])}function positionDialog(){"sheetdialog"!=sheetdialog.getDialogName()&&$.dialogutil.makeCenter(sheetdialog.getDialogName())}function addSTDMode(e){return isNaN&&(e+=""),-1==e.indexOf("px")&&(e=e.concat("px")),e}function getOnlyNumber(e){var t=e.replace(/[^0-9]/gi,"");return t}function removeElementFromArray(e,t){for(i=0;i<e.length;i++)e[i]==t&&(rem=e.splice(i,1));return e}function getOnlyHtml(e){var t=new RegExp(scriptFragment,"img");return e.replace(t,"")}function getScripts(e){var t=new RegExp(scriptFragment,"img");return e.match(t)}var browser_ie=!1,browser_ie6=!1,browser_nn4=!1,browser_nn6=!1,browser_opera=!1,browser_safari=!1,browser_ff3=!1,browser_chrome=!1,web_kit=!1,os_windows=!1,os_linux=!1,os_mac=!1,browser_firefox=!1,agt=navigator.userAgent.toLowerCase(),userAgent=navigator.userAgent.toUpperCase(),is_ie=-1!=agt.indexOf("msie")&&-1==agt.indexOf("opera"),browser_macSafari=!1;isIE()?(browser_ie=!0,navigator.appVersion.indexOf("6.0")>-1&&(browser_ie6=!0)):document.layers?browser_nn4=!0:(document.layers||!document.all&&document.getElementById)&&(browser_nn6=!0),userAgent.indexOf("OPERA")>=0&&(browser_opera=!0,browser_nn6=!0),userAgent.indexOf("APPLEWEBKIT")>=0&&(web_kit=!0),userAgent.indexOf("SAFARI")>=0&&(browser_safari=!0),userAgent.indexOf("CHROME")>=0&&(browser_chrome=!0),userAgent.indexOf("FIREFOX/3")>=0&&(browser_ff3=!0),userAgent.indexOf("WIN")>=0&&(os_windows=!0),navigator.platform.toUpperCase().indexOf("LINUX")>=0&&(os_linux=!0),navigator.platform.toUpperCase().indexOf("MAC")>=0&&(os_mac=!0),userAgent.indexOf("FIREFOX/3")>=0&&(browser_ff3=!0),-1!=userAgent.indexOf("FIREFOX")&&(browser_firefox=!0),os_mac&&browser_safari&&-1!=navigator.vendor.toUpperCase().indexOf("APPLE")&&(browser_macSafari=!0),Array.prototype.contains=function(e,t){var n=this.length;if("undefined"==typeof t){for(;n--;)if(this[n]==e)return!0}else for(;n--;)if(this[n][t]==e[t])return!0;return!1},String.prototype.toBoolean=function(){return"true"==this||"TRUE"==this},ArrayUtils={getSortedIndex:function(e,t,n){for(var r=e.length,o=-1,i=n||0;r>i;)o=i+r>>1,e[o]<t?i=o+1:r=o;return i},indexOf:function(e,t,n){var r=(e.length,this.getSortedIndex(e,t,n));return e[r]===t?r:-1},slice:function(e,t,n){var r=e.length;t=t>0?t:0,n=0>t||n>=r?r:n;try{return Array.prototype.slice.call(e,t,n)}catch(r){for(var o=[],i=t;n>i;i++)o.push(e[i]);return o}}};var featureSupport={boxAlign:!1,classList:!!document.body.classList,checkForBoxAlign:function(){return"string"==typeof document.body.style.webkitBoxAlign}};window.performance=window.performance||{},performance.now=function(){return performance.now||performance.webkitNow||performance.mozNow||performance.msNow||performance.oNow||function(){return(new Date).getTime()}}(),UTIL={},UTIL.DOM={hasClass:function(e,t){return featureSupport.classList?e.classList.contains(t):jQuery(e).hasClass(t)},addClass:function(e,t){featureSupport.classList?e.classList.add(t):jQuery(e).addClass(t)},removeClass:function(e,t){featureSupport.classList?e.classList.remove(t):jQuery(e).removeClass(t)},isChild:function(e,t){return e===t?!1:UTIL.DOM.contains(t,e)},contains:function(e,t){if(e){var n=e.contains;return n?e.contains(t):t===e||jQuery.contains(e,t)}},getOuterHTML:function(e){return e.outerHTML||function(e){var t,n=document.createElement("div");return n.appendChild(e.cloneNode(!0)),t=n.innerHTML,n=null,t}(e)}};var scriptFragment="(?:<script.*?>)((\n|.)*?)(?:</script>)";
var IconSetConstants={IN_3TRAFFICLIGHTS2:"3TrafficLights2",IN_3TRAFFICLIGHTS1:"3TrafficLights1",ARROWSGRAY5:"5ArrowsGray",ARROWSGRAY4:"4ArrowsGray",IS_5WIFI0:"iS-5Wifi0",ARROWSGRAY3:"3ArrowsGray",IN_3TRAFFICLIGHTS10:"3TrafficLights10",IS_5WIFI3:"iS-5Wifi3",IN_3TRAFFICLIGHTS11:"3TrafficLights11",IS_5WIFI4:"iS-5Wifi4",IN_3TRAFFICLIGHTS12:"3TrafficLights12",IS_5WIFI1:"iS-5Wifi1",IS_5WIFI2:"iS-5Wifi2",IN_5ARROWSGRAY2:"5ArrowsGray2",IN_3SYMBOLS22:"3Symbols22",IN_5ARROWSGRAY3:"5ArrowsGray3",IN_5ARROWSGRAY0:"5ArrowsGray0",IN_3SYMBOLS20:"3Symbols20",IN_5ARROWSGRAY1:"5ArrowsGray1",IN_3TRAFFICLIGHTS20:"3TrafficLights20",IN_3SYMBOLS21:"3Symbols21",TRAFFICLIGHTS32:"3TrafficLights2",IN_5ARROWSGRAY4:"5ArrowsGray4",IN_3COLORSMILIES1:"3ColorSmilies1",IN_3COLORSMILIES0:"3ColorSmilies0",IN_3COLORSMILIES2:"3ColorSmilies2",IN_3TRAFFICLIGHTS0:"3TrafficLights0",IS_5TRIFFICLIGHTS1:"iS-5TrafficLights1",IS_5TRIFFICLIGHTS0:"iS-5TrafficLights0",HEARTRATING3:"3HeartRating",IN_5BOXES4:"5BOXES4",IN_5BOXES3:"5BOXES3",IN_5BOXES2:"5BOXES2",IN_5BOXES1:"5BOXES1",IN_5BOXES0:"5BOXES0",IS_5TRIFFICLIGHTS4:"iS-5TrafficLights4",IS_5TRIFFICLIGHTS3:"iS-5TrafficLights3",IS_5TRIFFICLIGHTS2:"iS-5TrafficLights2",IN_3HEARTRATING2:"3HeartRating2",QUARTERS5:"5Quarters",IN_5ARROWS3:"5Arrows3",IS_5ARROWSGRAY4:"iS-5ArrowsGray4",IN_5ARROWS4:"5Arrows4",IS_5ARROWSGRAY3:"iS-5ArrowsGray3",IN_5ARROWS1:"5Arrows1",IS_5ARROWSGRAY2:"iS-5ArrowsGray2",IN_5ARROWS2:"5Arrows2",IS_5ARROWSGRAY1:"iS-5ArrowsGray1",IS_5ARROWSGRAY0:"iS-5ArrowsGray0",IN_5ARROWS0:"5Arrows0",SMILEYS5:"5Smileys",IN_2LOVE0:"2Love0",SMILEYS3:"3Smileys",IN_3SMILEYS1:"3Smileys1",LOVE2:"2Love",IN_3SMILEYS2:"3Smileys2",IN_5TRAFFICLIGHTS0:"5TrafficLights0",IN_5TRAFFICLIGHTS1:"5TrafficLights1",IN_5TRAFFICLIGHTS2:"5TrafficLights2",IN_3SMILEYS0:"3Smileys0",IN_5TRAFFICLIGHTS3:"5TrafficLights3",IN_5TRAFFICLIGHTS4:"5TrafficLights4",IN_3TRAFFICLIGHTS21:"3TrafficLights21",FLAGS3:"3Flags",IN_3TRAFFICLIGHTS22:"3TrafficLights22",IN_3SYMBOLS11:"3Symbols11",IN_3SYMBOLS12:"3Symbols12",INDICATOR2:"2Indicators",STARS3:"3Stars",IN_3SYMBOLS10:"3Symbols10",SIGNS3:"3Signs",INDICATOR3:"3Indicators",IN_4RATING3:"4Rating3",IN_4RATING0:"4Rating0",IN_4RATING2:"4Rating2",IN_4RATING1:"4Rating1",RATINGS5:"5Ratings",IN_5QUARTERS3:"5Quarters3",IS_5SMILEYS2:"iS-5Smileys1",IN_5QUARTERS2:"5Quarters2",IS_5SMILEYS4:"iS-5Smileys4",IN_5QUARTERS4:"5Quarters4",IN_5QUARTERS1:"5Quarters1",IS_5ARROWS1:"iS-5Arrows1",IS_5SMILEYS0:"iS-5Smileys0",IN_3SIGNS0:"3Signs0",IN_5QUARTERS0:"5Quarters0",IS_5ARROWS0:"iS-5Arrows0",IN_4CIRCLESREDTOBLACK3:"4CirclesRedToBlack3",IN_3SIGNS1:"3Signs1",IN_4CIRCLESREDTOBLACK2:"4CirclesRedToBlack2",IN_3SIGNS2:"3Signs2",IN_4CIRCLESREDTOBLACK1:"4CirclesRedToBlack1",IN_4CIRCLESREDTOBLACK0:"4CirclesRedToBlack0",IS_5ARROWS3:"iS-5Arrows3",IS_5ARROWS2:"iS-5Arrows2",TRIANGLES3:"3Triangles",BOXES5:"5BOXES",IS_5ARROWS4:"iS-5Arrows4",WEATHER5:"5Weather",IN_3ARROWSGRAY2:"3ArrowsGray2",IN_3ARROWSGRAY1:"3ArrowsGray1",IN_4TRAFFICLIGHTS1:"4TrafficLights1",IN_3ARROWSGRAY0:"3ArrowsGray0",IN_4TRAFFICLIGHTS0:"4TrafficLights0",IN_4TRAFFICLIGHTS3:"4TrafficLights3",IN_4TRAFFICLIGHTS2:"4TrafficLights2",IN_4ARROWSGRAY0:"4ArrowsGray0",IN_4ARROWSGRAY1:"4ArrowsGray1",IN_4ARROWSGRAY2:"4ArrowsGray2",IN_4ARROWSGRAY3:"4ArrowsGray3",IN_4ARROWS0:"4Arrows0",IN_4ARROWS1:"4Arrows1",IN_4ARROWS2:"4Arrows2",IN_4ARROWS3:"4Arrows3",IN_3ARROWS2:"3Arrows2",IN_3ARROWS1:"3Arrows1",IN_3ARROWS0:"3Arrows0",LIKES2:"2Likes",IN_3ARROWS4:"3Arrows4",IN_3ARROWS3:"3Arrows3",IS_3SYMBOLS0:"iS-3Symbols0",IS_3SYMBOLS2:"iS-3Symbols2",IS_3SYMBOLS1:"iS-3Symbols1",IN_5RATINGS3:"5Ratings3",ARROWS5:"5Arrows",SYMBOLS3:"3Symbols",IN_5RATINGS4:"5Ratings4",ARROWS4:"4Arrows",ARROWS3:"3Arrows",TRAFFICLIGHTS5:"5TrafficLights",TRAFFICLIGHTS4:"4TrafficLights",TRAFFICLIGHTS3:"3TrafficLights",IN_5RATINGS0:"5Ratings0",IN_5RATINGS1:"5Ratings1",IN_5RATINGS2:"5Ratings2",IN_4REDTOBLACK0:"4RedToBlack0",IN_4REDTOBLACK1:"4RedToBlack1",IN_4REDTOBLACK2:"4RedToBlack2",IN_4REDTOBLACK3:"4RedToBlack3",REDTOBLACK4:"4RedToBlack",IS_5QUARTERS4:"iS-5Quarters4",IS_5QUARTERS3:"iS-5Quarters3",IS_5QUARTERS0:"iS-5Quarters0",IS_5QUARTERS2:"iS-5Quarters2",IS_3HEART0:"iS-3Heart0",IS_5QUARTERS1:"iS-5Quarters1"};
var ActionConstants={USED_INDEX:280,NICEURL_CMTDLG:1032,IMAGE_DELETE:201,NEW_SPREADSHEET_FROM_TEMPLATE:307,LOAD_BOOK:227,FORMAT:69,LOCK_RANGE:282,JSP_EXTERNAL_DATA_EDIT:519,DETECT_FORM_RANGE:3003,LP_REMOVE_PERMISSION:8015,GET_HTML_WEBDATA:621,NAMEDRANGE_MODIFY:138,IMAGE_SENDBACKWARD:1126,HIDE_ROWS:109,NOTIFICATION_SETTINGS:1040,SERVERCLIP_REMOVE:765,ZIA_RECONNECT:9005,READ_PROTECTED_RANGES:286,JSP_PRINT:537,LIST_NAMEDRANGES:279,SPARKLINE_GROUP:4002,BROWSER_PRINT:602,CREATE_CHAT:604,JSP_PRINT_DIALOG:549,BORDER_OUTSIDE:19,AUDIT_FILTER_BY_DATE:649,JSP_ERROR:554,TEXTTOCOLUMNS_APPLY:662,REMOTEIPHONE_APPENDROWS:629,CHART_DETAILS:695,SHEET_VIEW:1281,BORDER_TOP_BOTTOM_THICK:28,SEARCH:803,APPLYFILTER_PIVOT:684,RANGE_PUBLISH:451,FORM_FIELD_UPDATED:639,RECAST:1130,EDIT_SPARKLINE_DATA:4005,INSERTMODE_CLEAR_STYLE:143,JSP_PUBLISH_FORM:1201,NICEURL_REPLY:1034,SPARKLINE_CREATE:4e3,BORDER_VERTICAL:20,LOCK_SHEET:284,MAKE_PUBLIC:620,CONDITIONAL_FORMAT_READ_RANGE:241,OPEN_EXPLORE:889,CHANGE_DISPLAYINFO_PIVOT:1601,AUTHENTICATE_SAVE_TO_MYACCOUNT:1100,JSP_HYPERLINK:510,ZIA_FILTER_HEADER:9010,READ_PIVOT_FILTER_DATA:689,JSP_PUBLISH_FORM_URL:1202,CHART_SAVE:700,ICON_SET_APPLY:780,SEND_SPREADSHEET_IN_MAIL:755,WORKBOOK_OPEN:179,INSERT_COL:43,FILTER_JSON:266,CHART_QUICK_EDIT:1122,COPY_PASTE:52,INSERTMODE_COPY_NOSTYLE:140,NICEURL_VERSIONS:1036,UNLOCK_SHEET:285,IMPORT_REPLACE_CURRENTSHEET:777,DRE_DELETE_GRID:1236,BORDER_TOP_BOTTOM:18,PIVOT_CHART_BUTTON_DETAILS:6009,CLEARCONTENTS:32,JSP_MACROEDITOR:551,WEBHOOK_NEW_ROW:827,WEB_DATA:68,STRINGFORMAT:34,COMPUTE_SUM_C:158,WRAP:9,FORM_UNPUBLISH:921,DISCUSSION_LIKE:1006,DATA_CLEANSING_REFRESH:10006,BORDER_RIGHT:14,ZIA_OPEN:9e3,JSP_DOCUMENT_SETTING:557,BORDER_ALL_TOP:115,CHART:70,RECONSTRUCT_FILTER_ICON:267,CONDITIONAL_STYLE_REORDER:753,FILTER_REAPPLY:645,DRE_UPDATEANDEXECUTE:1231,VALIDATE_INPUT_CF:679,JSP_PUBLISH:524,CELLSTYLES_DEFINITION:901,DELETE_TEMPLATE:248,JSP_CONFIRM_PUBLIC_TEMPLATE:528,MACRO_STOP_RECORDING:192,JSP_NOTIFY_USER:555,COUNT_EMPTY_CELLS:1155,DELETE_ALL_USERPROFILE:605,DETECT_PIVOT_RANGE:690,RANGE_PATTERN:65,INSERT_JSON_DATA_AT_END:807,UPDATE_ROW_DATA:802,ZIA_PRIORITY_HEADER:9006,IMPORT_APPEND_ROWS_TO_CURRENTSHEET:778,JSP_NAMEDRANGE:502,READ_SHEET_DETAILS:800,JSP_DATETIMEMENU:560,COLOR:7,SHADOW:76,JSP_VERSIONLIST:515,BORDER_VERTICAL_OUTSIDE:21,EXPORT_DOCUMENT:270,APPLY_FILTER:261,DISCUSSION_GET:1011,LP_MANAGE_WALKTHROUGH:8011,CHANGE_SPARKLINE_ORIENTATION:4007,ZIA_REFRESH:9002,MACRO_TEMP_SAVE:186,SPARKLINE_PROPERTIES:4008,SPREADSHEET_PROPERTIES:911,READ_FILTER_RANGE:265,DOCUMENT_TRASH:301,NAMEDRANGE_ADD:137,APPLY_FILTER_READ_ONLY:274,CONDITIONAL_FORMAT_CLEAR_RULE:754,FONTSIZE:4,DRE_UPDATE:1227,LIST_SHEET_NAMES:131,DRE_RESERVESPACE:1223,JSP_GOALSEEK:501,UPDATE_FILTER_RANGE:264,FEEDBACK:626,CREATE_SHEET_FOR_FORM:704,PIVOT_GETRANGE:614,UNDO:163,FORMATCELLS_GRID:608,SHEET_INSERT:104,COLUMN_PATTERN:66,SOLVER_CANCEL:610,ZIA_RECOMMEND_QUERIES:9008,IMAGE_COPY_PASTE:249,CHECKBOX_EDIT:322,SHEET_VISIBLE:103,SHARE_PERMISSION_CHANGE:402,RECALCULATE:156,UNLOCK_RANGE:283,ZIA_SYNC:9001,INSERT_CELL_TOP:674,GET_FILE_CONTENT_FROM_URL:10013,HIDE_COLUMNS:324,CHANGE_PIVOT_THEME:693,CTRL_NAVIGATION:165,JSP_CANCEL_PUBLISH_FORM:1203,NICEURL_DOC:1028,BORDER_BOTTOM:17,FETCH_DOCUMENTSETTINGS:1559,FORMATNUMBER:58,DOCUMENT_RESTORE:303,LP_GET_USER_NAME_FROM_ZUID:8014,JSP_DOC_FROM_TEMPLATE:514,FILLSERIES_AUTO:772,BORDER_ALL_BOTTOM:116,VIEW_PUBLISH_RANGE:456,JSP_CUSTOM:506,NAMED_RANGE:67,MERGE_RANGE:149,CTRL_COMP:237,CALCAPP:1123,DATA_VALIDATION_EDIT:668,CHART_EDIT:652,IMAGE_MOVE:202,SAVE_DOCUMENT:209,WEBHOOK_SUBSCRIBE:820,JSP_EXTERNAL_DATA:518,CHECKIN_CHECKOUT:632,ACTION_STREAM_UPDATE:3e3,JSP_PUBLIC:523,HALIGN:6,INSERTMODE_COPY_NEXTCELL_STYLE:142,DEBUG_MSG:107,APPLY_FILTER_ALL:268,CHART_NEW:75,JSP_MACRO_EDITOR:533,LAYOUTFORMAT:78,IMAGE_REMOVE:204,SERVERCLIP_GET_REFSHEETS:766,DISCUSSION_UNLIKE:1012,UNFREEZE_PANES:196,JSP_SAVE_OPTION:547,MACRO_SAVE_RUN:182,IMAGE_CLONE:214,DATA_VALIDATION_READSHEET:665,MACRO_START_RECORDING:191,PUBLICHTML_APPENDROWS:630,ALT_EQUAL_RANGE:157,MACRO_NEWSHEET_EVENT:190,SHOW_GRID:246,ENABLE_EVENTS:80,IMAGE_RESIZE:203,JSP_SHARE:525,VERSION_UPLOAD_NOTIFICATION:3e3,CHART_UPDATE:701,UNHIDE_ROWS:110,LP_GET_TEMPLATES:8003,EXTERNAL_REMOTE_SAVE:758,UPDATE_PUBLISH_RANGE:452,CLEARSTYLES:31,SERVERCLIP_COPY_SHEET:759,DRE_CREATE:1224,JSP_MANAGE_PIVOT:531,JSP_MAKE_TEMPLATE_PUBLIC:545,DRE_UPDATE_GRID:1237,JSP_INSERT_HTML:543,WIDTH:41,JSP_FIND:553,DELETE_CELL_BOTTOM:676,MERGE_AND_CENTER:152,LP_GET_USER_DETAILS:8013,COMMENT:35,LP_TOGGLE_SYSTEM_TEMPLATES:8012,WEBHOOK_UNSUBSCRIBE:821,SHEET_DUPLICATE:768,ALIGN:905,FIND_IN_SHEET:251,VIRTUAL_CHART:6010,FILTER_BY_VALUE:644,GET_SHEET_TABCOLORS:278,SEND_MAIL:225,CLEAR_AUDITTRAIL_ACTIONLIST:658,CHART_REFRESH:702,IS_LOCK_EXISTS:770,FIND_IN_RANGE:290,SERVERCLIP_CLIPBOARD_COMPARE:906,FORM_FIELD_DELETED:640,SELECT:95,LP_SEARCH:8001,UNHIDE_COLUMNS:325,FORMAT_TEXT:169,STRIKETHROUGH:77,WORKBOOK_ACTION:126,PREDICT_DATATYPES:3002,CLEARFORMATS:174,SPARKLINE_DATA:4009,JSP_NOTIFY_SHARED_USERS:527,CELL:49,SHEET_TABCOLOR:277,AUDIT_FILTER_BY_NAME:648,DISCUSSION_UPDATE_DOC_CLOSEDTIME:1015,IMAGE_ROTATE:909,SAVE_RTL_SHEET:888,CHART_COPY_STYLE:6003,REDIRECT_ROPEN:1560,NEW_WORKBOOK:128,IPHONE_APPENDROWS:627,COLUMN:47,FILTER_BY_CELL_COLOR:646,BORDER_ALL_RIGHT:114,WEBHOOK_UPDATE_SHEET:826,PIVOTSHEET_INSERT:612,VALUE:94,JSP_FUNCTIONS:516,DATA_DUPLICATES_INFO:10012,JSP_RANGE_SNIPPET:521,MACRO_WARNING:130,DATA_VALIDATION_READLIST:664,SPARKLINE_REMOVE:4003,PROTECT_RANGE_DIALOG:287,SERVERCLIP_PASTE_SHEET:762,FIND:254,IMPORT_CREATE_NEW:774,USER_PRESENCE_REMOVE:198,CHAT_MSG:600,COLLAB_USERS_STATUS:617,SPECIAL_CRITERIA:269,INSERT_ROW:42,CHECKIN_SPREADSHEET:10002,BORDER_HORIZONTAL:22,OVERWRITE_API_PREPROCESS:659,WEBHOOK_UPDATE_RANGE:825,CHART_UNPUBLISH:654,INSERTMODE_COPY_PREVIOUSCELL_STYLE:141,DISCUSSION_RESOLVE:1005,NUMBERFORMAT:33,CHECKBOX_ADD:321,FREEZE_PANES:162,IMAGE_NEW:200,SERVERCLIP_COPY_RANGE:760,JSP_EDIT_PIVOT_RANGE:530,ZIA_SAVE:9004,SORT:60,NOTIFICATION_SETTINGS_SETSTATE:1042,SHEET_COPY_CREATE_NEW_SPREADSHEET:769,DISCUSSION_DELETE_ALL:1016,LOCK_MULTIPLE:288,RANGE:46,JSP_EDIT_CHART:509,SAVEAS_NEW_DOCUMENT:213,MANAGE_PUBLIC:624,JSP_RUN_MACROS:534,DISCUSSION_ADD:1e3,RENAME_VERSION:656,DISCUSSION_REOPEN:1004,JSP_EDIT_PIVOT_PROPS:529,REDO:164,DATA_VALIDATION_READRANGE:671,ZIA_RESET:9009,FILLSERIES:54,REQUEST_BANNER:670,BORDER_NONE:12,SPARKLINE_GROUP_REMOVE:4004,ZIA_CLOSE:9003,IMAGE_BRINGTOFRONT:1129,UNDO_PASTE:500,UPDATE_CSV_DATA:135,JSP_GOTO:513,SERVERCLIP_PASTE_RANGE:763,CREATE_RECOMMENDED_PIVOT:1699,CHECKBOX_CLEAR:323,RENAME_DOCUMENT:210,GET_CHARTS:222,CLEARALL:61,DOCUMENT_DELETE:302,MERGE_DOWN:150,CONDITIONAL_FORMAT_READ_SHEET:242,REFRESH_VIEWPORT_RANGE:154,INIT_I18N_SESSION:625,NICEURL_SHEETRANGE:1030,DRE_GETALL:1226,UPDATE_COLLABORATOR_COLORS:657,CHART_PASTE_STYLE:6004,FORMAT_DECREMENT_DECIMAL:173,JSP_FUNCTIONSLIST:517,BORDER_HORIZONTAL_OUTSIDE:23,JSP_VERSION_VIEW_DIALOG:548,FORMAT_DATE:167,BORDER_INSIDE:24,BORDER_BOTTOM_DOUBLE:26,CHART_DATACHANGE:72,SOLVER:609,JSP_VIEW_ACTIONLIST:558,CHART_REGENERATE:71,RESET_HIGHLIGHT_INVALID:678,FIND_IN_COL:253,MACRO_DELETE:184,ERROR:257,DATA_CLEANSING:10004,JSP_STANDARD_FILTER:507,GET_DATA_DUPLICATES:10011,COPY_DOCUMENT:211,CONDITIONAL_FORMAT_DELETE:240,SYNC_CHECK:455,PDF_PRINT_PREVIEW:631,AUDIT_TRAIL:606,NICEURL_SHEETID:1037,LOAD_IMAGE:912,CHANGE_OWNER:308,JSP_FORMATCELLS:505,FORM_METADATACHANGE:635,MACRO_RUN:181,PDF_PRINT:618,DISCUSSION_ADD_REPLY:1007,DISCUSSION_UPDATE_REPLY:1008,SB_TEMPLATE:223,JSP_MACROERROR:552,FORMAT_ACCOUNTING:4010,DRE_GALLERY:1232,VALIGN:5,MACRO_INSERT:185,IMAGE_SENDTOBACK:1127,SHARE_REMOVE_BYOWNER:403,CHART_QUICK_STYLE:6001,TEXTCOLOR:8,POST_MVIEW_LOAD:790,JSP_NOTIFIER:550,DISCUSSION_UNLIKE_REPLY:1013,BORDER_DIAGONAL_UP:118,CONDITIONAL_FORMAT_EDIT:239,CREATEAPP:1125,SYSTEMCLIP_PASTE:767,SHEET_ACTIVATE:98,FORM_SUBMIT:637,DELETE_CELL_RIGHT:675,UNDERLINE:2,CONDITIONAL_FORMAT_READ_DATATYPE:247,JSP_PRINT_PREV:538,JSP_NEW_DOCFROM_TEMPLATE:546,SEARCH_REPLACE:804,INSERT_CUT_COLUMN:124,MACRO_CANCEL_RECORDING:193,NICEURL:"NICEURL",NICEURL_RANGE:1031,HIDDEN_ROW_DATA:271,CALCDEMO:1124,CTRL_COMP_ASSIGNMACRO:235,DRE_GETNAME:1235,LP_GET_ALL_SPREADSHEETS:8002,DRAG_DROP:908,JSP_IMPORT_GDOC:503,CONVERT_FORM:3001,SHEET_RENAME:102,JSP_REMOTEDATA_LIST:520,HJOIN_COLLAB:903,CHANGE_PIVOT_SOURCE:691,NICEURL_GETREPLY:1035,DATA_HIGHLIGHT_INVALID:677,READ_CELLS:801,PERCENT:108,CHART_PUBLISH_INTERACTIVE:703,SUBMIT:0,READ_PROTECTED_SHEETS:289,CHANGE_PIVOT_GRANDTOTALCOLOPTION:1696,JSP_MANAGE_MACROS:532,LP_GET_FAVOURITE_SPREADSHEETS:8007,FIND_IN_ROW:252,GET_ACTION_LIST:1558,CONDITIONAL_FORMAT_READ_WORKBOOK:243,FORMAT_COMMA:170,API_PING:806,SHOW_ERROR_MESSAGE:199,JSP_INSERT_IMAGE:504,GET_MACRO_EDITOR_INFO:5001,GET_WMS_USERS:2002,FORM_LIVE_SUBMIT:641,BORDER_LEFT:13,HIDE_GRID:245,DISCUSSION_DELETE_REPLY:1009,JSP_ASSIGN_MACRO:536,FORM_CREATE:633,CHART_PREVIEW:696,SHARE_REMOVE_BYUSER:404,DISCUSSION_DELETE:1003,HYPERLINK:56,IMAGE_CHECKDELETE:215,BOLD:38,POST_DOC_LOAD:177,GDRIVEDOC_UPDATE:623,REPLACE:255,DATA_BAR_APPLY:781,POST_PAGE_LOAD:628,LP_GET_TRASHED_SPREADSHEETS:8004,SHOW_PUBLISH_RANGE:453,DETECT_TABLE:9007,REFRESH_COLLAB_DETAILS:2e3,PDF_DATA:619,REVERT_VERSION:207,SAVE_WORKBOOK:127,CREATE_VERSION:205,CONDITIONAL_FORMAT_APPLY:238,INSERT_CSV_DATA_AT_END:134,COLOR_SCALES_APPLY:752,RENAME_TEMPLATE:219,CHART_MOVE:74,FORM_REPORT_CREATE:1633,IMAGE_SAVE:216,NICEURL_SHEET:1029,JSP_MAKE_PUBLISH:556,IMPORT_REPLACE_DATA_STARTING_AT_CELL:779,LP_GET_OWNED_SPREADSHEETS:8006,BORDER_DIAGONAL_DOWN:117,CREATE_FILTER:260,VERIFY_ACCOUNT:751,DEPENDENT_CELL:59,CLOSE_DOCUMENT:197,CTRL_COMP_RESIZE:233,NOTIFICATION_SETTINGS_GETSTATE:1041,TEXTTOCOLUMNS_PREVIEW:661,ERROR_MESSAGE:258,FORM_DELETE:642,MERGE_SPLIT:37,REPEAT_ACTION:129,UPDATE_OLE:226,JSP_CONFIRMATIONPROMPT:539,FILTER_BY_FONT_COLOR:647,SHARED_USERS:400,EDIT_PIVOT:681,FETCH_DATA:902,UPDATE_IMAGE:178,SAVEAS_NEW_TEMPLATE:306,CHART_PUBLISH:653,GOAL_SEEK_CANCEL:145,CALCULATE:96,CHANGE_DOC_STATUS:309,IMAGE_REPLACE:218,PERFORMUSEROPTION_PIVOT:685,JSP_MOVE_SHEET:511,COPY_TO_CLIP:153,CLEAR_ANNOTATION:112,GOAL_SEEK:144,JSP_MANAGE_GROUPS:526,CLEAR_CHART_DETAILS:698,DOCACTION:79,LIST_WORKBOOKS:805,NAMEDRANGE_READ:161,FORM_PUBLISH:920,CHART_DELETE:73,SPARKLINE_UNGROUP:4001,MACRO_SHOW:183,DELETE_COL:45,INSERT_COPY_COLUMN:122,GET_TEMPLATES:305,IMPORT_INSERT_AS_NEW_SHEETS:775,REVERT_VERSION_ON_ERROR:276,JSP_EDIT_COND_FORMAT:541,FORMATCELLS:147,ADD_ROW_IN_NAMEDRANGE:281,MERGE_ACROSS:151,DRE_GETDETAIL:1225,BORDER_BOTTOM_THICK:29,FONTFAMILY:3,DYNAMIC_REQUEST:1050,RANGE_STYLE:64,PIVOT_CHART_DETAILS:1697,READ_RANGE_DETAILS:272,GET_VERSION_DETAILS:1548,CELL_STYLENAME:50,FORMAT_CURRENCY:168,PIVOT_REFRESH:616,WEBFORM_PROVIDEURL:634,BORDER_INSIDE_HORIZONTAL:120,LP_GET_SHARED_WITH_ME_SPREADSHEETS:8008,SHEET_COPY:99,SHEETACTION:97,DATA_VALIDATION_APPLY:663,DELETE_ROW:44,JSP_COPY_SIGNIN:542,DISCUSSION_UPDATE_SHAREDUSERS:1014,SAVE_API:559,READ_PIVOT_FIELDS:688,GET_FILTER_DATA:263,READ_RECOMMENDED_PIVOT:1698,REFRESH_ALL_PIVOT:692,COLUMN_CELLSTYLENAME:48,UPDATE_VIEWPORT:175,UNDO_MESSAGE:63,REMOTE_SAVE:603,READ_CELL:132,FORMAT_PERCENT:171,GET_SHARED_TYPE:401,CELL_COMMENT:57,DELETE_PIVOT:683,READ_DATA_DUPLICATES:10010,DISCUSSION:1025,DOC_COMMENT_SAVE:259,FIND_ACTION:160,JSP_CANCEL_PUBLIC:522,FORMULA:93,BORDER_ALL:25,SET_VISIBILITY:111,EDIT_SPARKLINE_GROUP_DATA:4006,PIVOT_UPDATEPROPERTIES:613,DISCUSSION_UPDATE_RANGE_CONTENT:1001,BORDER_TOP_BOTTOM_DOUBLE:27,HCLOSE_DOCUMENT:904,COMPUTE_SUM:55,HIGHLIGHT_VERSION_CHANGES:310,CHANGE_PIVOT_GRANDTOTALROWOPTION:1695,UNDOREDOCOUNT:11,RESET_ANNOTE_POSITION:773,SERVERCLIP_CHECK_LOCALE:771,SWITCH_SHEET:62,NL_QUERY:890,SAVE_TO_MYACCOUNT:212,DOC_COMMENT:220,CHECKIN_CHECKOUT_FROM_SHEET:7001,DRE_CREATEANDEXECUTE:1230,COLLAB_USER_EDIT:2001,IMAGE_UPLOAD:907,SHEET_MOVE:101,DELETE_VERSION:208,LP_GET_SYSTEM_TEMPLATES:8010,DISCUSSION_LIKE_REPLY:1010,IMPORT_AS_TEMPLATE:7e3,UPDATE_WEB_DATA:221,GET_DOC_PROPERTY:601,CHART_MOVE_TO_NEW_SHEET:6002,CTRL_COMP_ADD:230,PASTESPECIAL_FORMATS:148,SHEET_ZOOM:291,VIEW_VERSION:206,BATCH_UPDATE_BY_CELL_REF:136,REPLACE_ALL:256,REFRESH_PIVOT:682,INSERT_CELL_LEFT:673,ITALIC:1,BORDER_TOP:16,INSERT_COPY_ROW:121,MACRO_SAVE:180,GOAL_SEEK_OK:146,EXPORT_TO_CLOUD_DRIVES:10003,IMPORT_REPLACE_SPREADSHEET:776,BORDERS:36,GET_NEWLY_ADDED_USER:2003,NAMEDRANGE_DELETE:139,FILTER_CALLBACK:273,FORMAT_INCREMENT_DECIMAL:172,VERSION:224,BORDER_INSIDE_VERTICAL:119,WEBDATA_LIST:10101,SORT_PIVOT:687,BORDER_LEFT_RIGHT:15,IMAGE_CUT_PASTE:217,JSP_COPY_SHEET:512,MACRO_OPEN_EVENT:188,SERVERCLIP_CUT_RANGE:761,GET_SHARED_USER:757,EXECUTOR_ACTION:611,AUDIT_FILTER_BY_SHEET:660,VALIDATE_INPUT:672,READ_NAMEDRANGE_DETAILS:133,REMOVE_FILTER:262,DATA_VALIDATION_READWORKBOOK:669,JSP_IMAGE_UPLOAD:508,INSERT_CUT_ROW:123,CREATE_PIVOT:680,READ_FORM_RANGE:643,CHANGE_PIVOT_SUBTOTALOPTION:694,WAKE_UP_CALL:454,FETCH_DECLARATIVE_TABLE:697,FILL_EMPTY:354,LOAD_SHEET:228,DOCUMENT_SETTING:275,FIND_IN_WORKBOOK:250,CTRL_COMP_MOVE:232,MACRO_CHANGE_EVENT:189,GET_MACRO_LIST:5002,SERVERCLIP_PASTE_SHEET_CANCEL:764,SCROLL:229,CTRL_COMP_SETCAPTION:234,DRE_INSTALLGALERY:1233,CHANGE_BRIDGENO:105,CHART_REMOVE:651,AUDIT_FILTER_BY_RANGE:655,LP_UPDATE_THEME:8009,DATA_CLEANSING_REPLACE_ALL:10005,JSP_MACRO_ERROR:535,MOVE_PIVOT:686,COPY_PIVOT:1602,FORMATCELLS_CLIENT:607,CHART_CELL_REF:6e3,IMAGE_BRINGFORWARD:1128,CHART_RESIZE:650,CHECKOUT_SPREADSHEET:10001,CUT_PASTE:53,DATA_VALIDATION_CLEAR:667,DOCUMENT_RESTORE_RETENTION:304,PICK_LIST:159,GRID_VIEW:782,JSP_SEND_SPREADSHEET_IN_MAIL:756,COPY_PASTE_CONTENT:51,LP_UPDATE_SORTING_ORDER:8005,USER_PRESENCE:166,SORT_DETAILS:195,CTRL_COMP_CLONE:231,SHEET_REMOVE:100,DRE_LOGS:1234,PIVOT_EDIT:615,NICEURL_COMMENT:1033,AUTO_SUM:155,JSP_MAKE_PUBLIC:544,JOIN_COLLAB:176,OTHER_SHEET_CHANGE:106,DRE_EXECUTE:1229,GET_CHART_RECOMMENDATION:6005,HEIGHT:10,CTRL_COMP_DELETE:236,JSP_CONDITIONALFORMAT:540,IMAGE_DRAG_DROP:910,GET_FORMULA_SUGGEST_INFO:622,FORM_FIELD_ADDED:638,BORDER_ALL_LEFT:113,MACRO:125,MACRO_CONTENT_CHANGED:187,FORM_DELETE_ON_REVERT_VERSION:3004,DRE_DELETE:1228};
var JSONConstants={REVERTED_VERSION_OF_TIMESTAMP:"r_v_ts",FORM_RID:"form_rid",ARRAY_DETAILS:"ARRAYDETAILS",DRE_DESCRIPTION:"description",SHEET_NAME:"sn",DBAXISCOLOR:"db_axisc",SPARKLINE_VALUE_UPDATE:"svu",SPARKLINE_GROUP:"sg",FORMULA_SUGGEST_INFO:"fsi",DBFILLNCOLOR:"db_fillnc",SHEET_TAB_COLOR:"stbc",EXECUTED_VERSION:"xversion",FORM_FIELD_TYPE:"type",SHEET_VIEW:"sheet_view",FILL_EMPTY_VALUE:"fev",SPARKLINE_RANGE_TO_CUT:"srtc",WEBFORM_CREATE_JSON:"wfc",ZIA_META:"META",IMAGE_TILTE:"IMAGE_TITLE",IS_SAME_CONTENT:"isSame",GADGET_SKYDRIVE_KEY:"skydrive",FILL_EMPTY_WITH_AVERAGE:"avg",EXECUTED_ACTION_ID_WHILE_COPY:"xaidc",SPARKLINE_CREATE:"spc",RECORD_MACRO_OBJECT:"rmo",FORM_CREATERESPONSE:"fcr",SHEET_FAULTY_LIST:"sheetfaultylist",DUMMY_ID:"dummyId",IS_FORM_PUBLISHED:"ifp",IS_SERVER_ACTION:"isServerAction",ZOOM_VALUE:"zoomVal",COPY_CLIP:"cC",PROTECTED_SHEETS:"ps",CV_ERROR:"cv_err",SHEETLIST:"sheetList",SOURCE_DOC:"sdoc",CURRENT_COUNTRY:"ccy",IS_NEW_SHEET:"ins",IS_CTRL_SHIFT_ENTER:"isCSE",IS_ADOPT_SOURCE_FORMAT:"isFormatApply",IS_ROLL_BACK:"irb",MESSAGE:"msg",READ_COMMENT_USERS:"rcU",ICON_CRITERIA:"is_c",SOURCE_START_ROW:"ssr",FORM_RID_LIST:"form_rid_list",NO_OF_MATCH:"nom",INTERVAL:"intr",COLORSCALE_COLOR:"cs_c",BUILD_VERSION_LABEL:"buildVersionLabel",READ_ONLY_USERS:"roU",IS_STYLE_CHANGED:"is_sc",CS_HEXCOLOR:"csHexColor",MODIFIED_RANGE_START_ROW:"mrsr",IMAGE_ACTUAL_WIDTH:"actWd",SHEET_ID:"sid",MODIFIED_RANGE_END_ROW:"mrer",FORM_FIELDS:"fields",IS_IN_VIEWPORT:"isinvp",SOURCE_RID:"srid",SOURCE_DOCID:"sdid",CELLSTYLES_DEFINITION:"cellstylesdef",IS_FROM_RECOMMENDED:"ifrec",CLEAR_CSJSON:"clearJson",SPARKLINE_CUT_PASTE:"spcp",TIME_STAMP:"ts",RECORD_MACRO_COMMENT:"rmc",RECORD_UNDO:"ru",PIVOT_ICON_TYPE:"pic",READ_ONLY_ORGS:"roO",SRC_DOC_PARAMS:"sdp",DELUGE_RESPONSE:"delugeResponse",DRE_SCRIPT:"script",INSERT_AT_END:"iae",DD_UNIQUE:"unique",ASSOCIATED_SHEET_NAME:"asn",IMAGE_WIDTH:"imgWd",INDEX:"idx",DBBORDERCOLOR:"db_borderc",DESTINATION_SHEETLIST:"dstnSheetList",HEADER_INDEX:"hidx",IS_PIVOT_SHEET:"ips",CV_LISTDISPLAYTYPE:"cv_ldt",SPARKLINE_PROPERTIES:"sprop",IS_DISPLAY:"is_dis",ACTIVE_RANGES:"act_rng",COLLAB_ID:"cid",BASECELLADDRESS:"bca",IMAGE_ROW_DIFF:"sRowDiff",COPY_REFERRED_SHEETS:"crs",LAST_SAVED_ID:"lsid",VALUE_ARRAY:"v_a",END:"e",DATAVALIDATION_ERRORMSG:"dv_err_msg",CONDITION_FORMAT:"c_f",PIVOT_DATAFIELDINDEX:"pdfi",FILTER_CELLS:"fc",LOCKED_ORGS:"lo",FILE_FORMAT:"format",FORM_URLS:"furls",DBDIRECTION:"db_dir",AUTHORS_LIST:"al",FORM_FIELD_SEQUENCE_NUMBER:"sequence_number",VERSIONS_INFO:"vi",AVERAGE:"avg",ZIA_SYNC:"SYNC",IMAGE_ACTUAL_HEIGHT:"actHt",DATABAR:"d_b",DESTINATION_DOC:"ddoc",GADGET_BOX_KEY:"box",IS_DUMMY_PIVOT:"idp",FORM_LINKNAME:"link_name",FILL_EMPTY_WITH_MODE:"mode",IS_SAME_DOCUMENT:"isd",FORM:"form",DRE_FUNCTION_NAME:"functionname",TTC_COLUMN_HEAD:"ttcch",CTRL_PRESSED:"ck",RID:"rid",IS_SAME_LOCALE:"isl",FROM_UNDO:"fromundo",ACTION:"a",DATAVALIDATION_ERROR:"dv_error",SPARKLINE_RESPONSE:"spr",START:"s",SPARKLINE_TYPE:"st",CURRENT_ACTIVE_COLUMN:"c",FILL_EMPTY_TYPE:"fet",TTC_COUNTRY_NAME:"ttccn",DISPLAY_MEMBER_MODE:"dmm",LOCK:"lock",DATAVALIDATION_HIGHLIGHT:"dv_hl",DD_TYPE:"actionType",DBBORDERPCOLOR:"db_borderpc",CREATEPIVOTID_ARRAY:"createpivotid_array",FILL_EMPTY_WITH_VALUE:"val",PIVOTTEMPLATE_COLOR:"ptc",SPARKLINE_ID:"spid",DBAXISTYPE:"db_axist",TTC_ISMERGEDDELIMITERS_CHECKED:"ttcismdc",ID:"id",COLORSCALE:"c_s",DOC_ID:"docId",INDICES:"indices",PIVOT_FILTER_DATAFIELDINDEX:"pfdfi",PERSISTED_POSITIONS:"pers_pos",OLD_SHEET_NAME:"osn",DEFAULT_ICON_SIZE:"dis",READ_ONLY_GROUPS:"roG",DOCUMENT_AUTHENTICATED_PATH:"docauthpath",IMAGE_TEXT_STYLE_NAME:"imgTextStyNm",LOCKED_GROUPS:"lg",FILL_DIRECTION:"fd",IS_SHEET:"is_s",REVERTED_VERSION_OF_NO:"r_v_no",DOCUMENT_VIEW:"doc_view",FORMS_INFO:"formsInfo",IS_DOC_OWNER:"is_doc_own",SOURCE_SHEET_NAMES_LIST:"srcSheetNamesList",ICONSET:"i_s",MATCH_AT:"ma",HAS_PROTECTED_RANGES:"rp",DBWIDTH:"db_w",CRITERIA_STYLE:"cstyle",IMAGE_ROW:"row",UNLOCKED_ORGS:"ulo",UNLOCKED_USERS:"ulu",ZIA_QUERY:"QUERY",DESTINATION_RANGE:"dRange",IS_EXACT_MATCH:"iem",TTC_DELIMITERS:"ttcd",SORTBY_TOOLTIP:"sbtp",RANGES:"ranges",PIVOT_INFO:"pivotinfo",CSCLEARRANGEJSON:"csclearrangejson",DETECT_TABLE_DETAILS:"DTD",DBBORDERNCOLOR:"db_bordernc",PASTESPECIAL_SKIPBLANKCELLS:"isbc",OPEN_URL:"url",FORMAT_COUNTRY:"cy",PIVOT_ACTION_JSON:"pa_json",INFO_MESSAGE:"im",COLUMN:"C",VALUE:"v",FORM_COL_DELETED:"frmcoldel",DIRECT_UPDATE:"DU",IS_OVERLAPPING_RANGES_ALLOWED:"is_ao",DD_DUPLICATE_COUNT:"duplicateCount",IMAGE_URL:"imgurl",ACTIVE_CELL:"act_cell",ASSOCIATED_SHEET_NAME_LIST:"asnl",ASCENDING_SORT:"as",DATAVALIDATION_ISSTOPEDIT:"dv_isse",START_COLUMN:"sc",PIVOTTEMPLATE_ID:"ptid",FILL_EMPTY_WITH_PREVIOUS_NON_EMPTY:"prv_n_empty",ACCESS_TYPE:"at",FOCUS_OBJECT:"fo",ROW:"R",ZUID:"zuid",RANGE:"range",IS_SAME_SHEET:"iss",REPLACE_STRING:"rs",FORM_PUBLISH_TYPE:"fpt",FUNCTION_SYNTAX:"fsyn",ACTION_DETAILS:"AD",READ_ONLY:"ro",ISFORMEXISTS:"ife",MINIMUM:"min",CLIENT_ACTION:"ca",IS_EXECUTED:"is_ex",PATTERN_STRING:"pns",IS_CLIENT_ACTION:"is_ca",NAME_OF_RANGE:"nor",FIELD_LINK_NAME:"field_link_name",FROM_REDO:"fromredo",IS_SHEET_PROTECTED:"sp",DBFILLTYPE:"db_fill",PASTED_SHEETNAMES:"psn",FORM_SHEET_ID:"formSheetId",CSTYLEJSON:"cstylejson",CURRENT_ACTIVE_ROW:"r",SOURCE_DOCNAME:"sdn",LINK_PARAM:"lp",SHEET_LOCKED_GROUPS:"slG",JSON_OBJECT_TYPE:"jot",CURRENT_LANGUAGE:"cl",ALL_FIELDS:"af",WORKBOOK_LEVEL_ACTION:"wla",GADGET_ZOHO_DOC_KEY:"zohodocs",SOURCE_END_ROW:"ser",FORM_DATA:"form_data",FORM_VERSION_ID:"frmversionid",IMAGE_ID:"imgId",FORM_DELETE_URL:"frmdelurl",SELECT_ALL:"sa",DBAXISPOINT:"db_axisp",READ_WRITE_ORGS:"rwO",IMAGE_STYLE_NAME:"imgStyNm",BACKGROUND_STYLE:"bs",FUNCTION_MAX_ARGS:"fnma",FILL_SERIES_TYPE:"fst",VERSION_LABEL:"vl",NOOFCOND:"noofcond",AUTOTEXTCOLOR:"atc",FILE_NAME:"fname",PIVOT_BUTTONS:"pb",POSITION:"pos",OWNER:"owner",CSUID:"csuid",COPY_CLIP_TTL:"ccttl",GADGET_GDRIVE_KEY:"gdrive",OLD_START_COLUMN:"osc",COUNT_NUMBERS:"cn",SPARKLINE_GROUP_CHANGE:"sgc",CV_ALLOWBLANKCELLS:"cv_abc",IS_DIFF_TYPE_OF_RANGES_ALLOWED:"is_adtr",SUM:"sum",LOCKED_USERS:"lu",ACTION_ID:"aid",FORMAT_TO_ADOPT:"format",CREATE_ANYWAY_PIVOT:"cap",TTC_ENCLOSURE:"ttce",SPARKLINE_DATA_ARRAY:"da",SHEET_LOCKED_USERS:"slU",SUBTOTALOPTION:"sto",DOCUMENT_SERVED_STATE:"docServedState",GET_NO_OF_MATCH:"gnom",PASTESPECIAL_TRANSPOSE:"itr",IS_RECONNECT:"irc",IS_REQUIRED_TAB_SEPARATED_VALUES:"irtsv",IGNORE_EMPTY:"i_emt",INTERRUPT:"INTERRUPT",GROUP:"gr",FILL_VALUE:"fval",DRAG_DROP:"dd",ROWGRANDTOTALOPTION:"rgto",IS_TYPE_AHEAD:"is_ta",ICON_NAME:"icon_name",OLD_START_ROW:"osr",USER_NAME:"un",FORM_TYPE:"form_type",TTC_STARTS_FROM_ROW:"ttcsfr",MACRO_NAME:"mn",RANGELIST:"rangeList",IMAGE_COL_DIFF:"sColDiff",IS_CONTAINS_HEADER:"ich",USED_FIELDS:"uf",DBFILLPCOLOR:"db_fillpc",CRITERIA_VALUE:"cval",SPARKLINE_ORIENTATION:"so",REVERSE_ICON_ORDER:"rio",IS_NAMED_RANGE_CHANGED:"is_nrc",SCOPE:"scp",FORM_FIELD_OPTIONS:"choices",PERMISSION_TO:"pmTo",CV_HINT:"cv_hi",FORM_NAME:"form_name",IMAGE_Y:"yPos",IMAGE_X:"xPos",RELOAD_TILES:"rt",DD_COUNT:"rowCount",RESEND_RESPONSE:999,IS_REPEAT_ACTION:"is_ra",SHEET_NAMES_LIST:"sheetNamesList",FEED_ACTION_ID:"aaid",FORM_CONVERSION_JSON:"convert_form_json",TRAVERSE_MODE:"tm",REVERT_VERSION_NO:"r_ver",UNIQUE_TAB_ID:"utid",ONLY_CLIP_TO_SERVER:"octs",CS_PRIORITY:"priority",WARN:"WARN",FORM_RANGE:"frange",INSERT_OPTION:"inop",COLGRANDTOTALOPTION:"cgto",CURRENT_ACTIVE_SHEET_NAME:"csn",ISTHEME:"istheme",PIVOT_FIELD_REFERENCE:"pfr",SHEETS_TO_COPY:"stc",DATARANGE:"datarange",IS_COL_CHANGED:"is_cc",CO_OWNER_USERS:"coU",ERROR_MESSAGE:"em",PASTESPECIAL_TYPE:"pstype",FILTER_ID:"fid",UNDO_REDO:"ur",FUNCTION_TIPS:"fnt",IMAGE_HYPERLINK:"IMAGE_HYPERLINK",ICON_ID:"icon_id",CONSTRAINT_COMMAND:"constrainedCommand",PROTECTED_RANGES:"pr",IMAGE_COLUMN:"column",SPARKLINE_RANGE_IN_VIEWPORT:"sprv",FUNCTION_NAMES:"fns",UNDO_REDO_ACTION_OBJECT:"urao",CLEARRANGES:"clearranges",IS_SOURCE_CHANGED:"is_src",STROKE_STYLE:"ss",IMAGE_ZINDEX:"zIndex",CS_TYPE:"cs_type",COLOR_CODE:"cc",DOCUMENT_COMMAND:"gridCommand",ROLL_BACK_ERROR_CODE:"rb_ec",SHEET_LOCKED_ORGS:"slO",FORM_LINK_NAME:"form_link_name",FOCUS_TYPE:"ft",NOOFRULES:"noofrules",IS_SUCCESS:"is",ACTIVE_COLUMN:"ac",MACRO_ERROR:"me",PIVOT_SORT_DETAILS:"psd",DESTINATION_RANGELIST:"dstnRangeList",DD_DUPLICATE:"duplicate",NEW_SHEET_NAME:"nsn",CRITERIA_TYPE:"cr_ty",IS_CASE_SENSITIVE:"ics",IS_UNDID:"isUndid",SOURCE_START_COLUMN:"ssc",IS_VALUE_CHANGED:"is_vc",HAS_STOCK_FORMULA:"stk_fml",LAST_EXECUTED_ACTION_ID:"leaid",END_ROW:"er",MAXIMUM:"max",CURRENT_ACTIVE_CELL:"activeCell",CONTENT_VALIDATION:"contentvalidation",IMAGE_SOURCE_ID:"imgsid",FUNCTION:"fn",SOURCE_SHEETLIST:"srcSheetList",DRE_ARGUMENTS:"arguments",SPARKLINE_CELL:"sCell",FUNCTION_CATEGORIES:"fnc",FORM_FIELD:"field",PIVOT_TOTALOPTION:"pto",RSID:"rsid",COUNT:"count",FEED_ACTION:"aaction",FORMAT_STRING:"fs",RANGE_TO_COPY:"rtc",SOURCE_RANGELIST:"srcRangeList",SOURCE_END_COLUMN:"sec",STOP_GET_STATUS:"sgs",FORM_REQUESTBODY:"frb",SPARKLINE_TO_REMOVE:"str",IS_NEW_DOC:"is_nd",IS_OPTIMAL:"iopt",IS_CALC_ROW_HEIGHT:"is_calc_rh",IMAGE_HEIGHT:"imgHt",ACTION_SELECTION_TYPE:"ast",UNDO_ACTION_ID:"uaid",CURRENT_ACTIVE_SHEET:"s",FUNCTION_LOCALIZED_NAMES:"fnl",COLUMN_FIELDS:"cf",FORM_DESCRIPTION:"description",CRITERIA_NUM:"cr_nu",IS_COMPLETE_GROUP:"icg",API_ACTION:"aa",GADGET_OFC365_KEY:"office365",USER_COMMAND:"userCommand",FEED_ACTION_PARAMS:"aparams",VERSION:"ver",FILL_EMPTY_SUB_PARAMS:"fesp",START_ROW:"sr",DATAVALIDATION_MESSAGE:"dv_msg",FORMAT_LANGUAGE:"l",DBBORDERTYPE:"db_border",FORMAT_TYPE:"fmt_t",ACTION_PARAMS:"ap",PIVOT_FILTER_DETAILS:"pfd",FONT_STYLE:"fs",OLD_END_COLUMN:"oec",PIVOT_SORTMODE:"psm",CF_RESPONSE_TIMEOUT:"cfRespTimeoutError",VALUE_CHANGED:"vc",LINK_SHARE_PERMISSSION:"liShP",DBFILLCOLOR:"db_fillc",NO_OF_DUPLICATES:"nod",FORM_RESPONSE:"fr",TAB_TYPE:"tabType",RECEIVER:"rec",FORM_OPERATION_TYPE:"oper-type",IMAGE_NAME:"imgNm",SOURCE_SHEET_NAME:"ssn",MESSAGE_TYPE:"msgt",IS_HIDDEN:"isHide",FORMREPORT_SHEET_NAME:"frsn",OVERWRITE_DATA:"od",READ_WRITE_GROUPS:"rwG",CRITERIA_CONDITION:"cond",IMAGE_DESC:"IMAGE_DESC",FORM_DISPLAYNAME:"display_name",READ_WRITE_USERS:"rwU",PERMISSION_FROM:"pmFr",UNLOCKED_GROUPS:"ulg",DD_UNIQUE_COUNT:"uniqueValueCount",PAGE_FIELDS:"pf",OPEN_SHEET:"os",NO_LINK_PARAM:"nlp",GADGET_DROPBOX_KEY:"dropbox",DYNAMIC_MSG:"d_msg",LOGIN_NAME:"ln",DOC_NAME:"dn",HIDECELLCONTENT:"hcc",PIVOT_DETAILS:"pd",DRE_FUNCTION_ID:"functionid",CO_OWNER_GROUPS:"coG",SOURCE_RANGE:"sRange",VIEW_PORT:"vp",PIVOTTEMPLATE_ACCENT:"pta",ASSOCIATED_SOURCE_SHEET_NAME:"sasn",OLD_END_ROW:"oer",ACTIVE_ROW:"ar",HEADER_ROW:"hr",UPDATEPIVOTID_ARRAY:"updatepivotid_array",RESEND:"resend",DATA_FIELDS:"df",ICON_SET_TYPE:"iconSetName",FORMULA_AND_CELLS:"formulas_and_cells",BORDER_STYLE:"bs",CELL_RESPONSE_NEEDED:"crsn",SERVERCLIP_SOURCE_ASN:"scsasn",END_COLUMN:"ec",ROW_FIELDS:"rf",QUEUED_ACTION_ID:"qaid",CELLSTYLES_NAME:"cellstylesname",APPLY_CSJSON:"applyJson",PIVOT_FIELD_TYPE:"pft",TIME_TAKEN:"tt",EXECUTED_ACTION_ID:"xaid",FUNCTION_LOCALE:"fl",NO_OF_REPLACE:"nore"};
var CellConstants={TEXTCOLOR:"2",TEXTALIGN:"5",VALUEFORMAT:"3",BACKGROUNDCOLOR:"1",BORDERLEFT:"9",FONTSTYLE:"13",COLSPAN:"cS",VALFORMAT:"11",CELLVALUE:"7",BORDERTOP:"7",TEXTDECORATION:"14",ICONHTML:"16",CELLANNOT:"4",CELLFORMULA:"5",VERTICALALIGN:"8",WRAP:"1",CLASSNAME:"0",BORDERRIGHT:"10",CELLHYPER:"2",FONTSIZE:"4",CELLSTYLE:"6",LITERALCOLSPAN:"lcs",BORDERBOTTOM:"8",LITERALROWSPAN:"lrs",STRIKETHROUGH:"15",FONTFAMILY:"3",VALIGN:"6",DATAVALIDATION:"10",FONTWEIGHT:"12",ROWSPAN:"rS",ENCODEDCELLVALUE:"9"};
var CommandConstants={COLUMN_LEVEL_CELLSTYLES:69,FORM_RID:105,FORMAT_DATE:162,CURRENCYNAME:171,USER_ID:279,FORMULA_CELLS:9,RECONSTRUCT_FILTER_ICONS:66,IS_NEW_CLIENT_RESPONSE:43,IS_REVERT_VERSION:114,ROW_HEADERS:31,OWNER:277,ERROR:104,SHEET_LIST:213,ISCUSTOM:154,CHART_DETAILS:142,META:76,TABCOLOR:54,WORKSHEETS:21,IMAGE_TILTE:196,EDIT:202,PUBLISH:215,RECAST:248,SPREADSHEET_SETTINGS:160,UNPUBLISH:262,MACRO_INFO:232,APPLIED_COND_STYLE:224,REPLACE_CURRENTSHEET:210,QUERY:255,DOCUMENT_ID:26,SOURCE:107,CHECK_BOX:135,WEB_USERMETA_INFO:293,DOCUMENT_SERVED_STATE:116,ACTION_IDENTIFIER:3,KEY:296,DUMMY_ID:205,DISCUSSION_UNLIKE_REPLY:260,IS_SERVER_ACTION:91,FORMATCELLS_REGIONAL:300,PUBLISH_TYPE:216,BUTTON:236,PROTECTED_SHEETS:103,SYSTEMCLIP_PASTE:253,DELETE_CELL_RIGHT:101,TIME_DURATION:166,DOC_CTX_INFO:120,GROUP:243,DELETE:49,REBRAND_PROPERTIES:131,VERSION_NUMBER:132,CTX_PATH:126,SERVERCLIP_INFO:292,DEFAULT_DATETIME:165,DISCUSSION_LIKE:257,IMAGE_ACTUAL_WIDTH:200,USER_NAME:280,APPEND:80,OLE_DATA:30,IMAGE_COL_DIFF:191,REPLY:283,CHART:141,COLUMN_SHIFT:15,ZIA_AFFECTED_HOLDERS:261,LOCALUTILCURSYMBOLS:169,CELLSTYLES_DEFINITION:40,DOCUMENT_OWNER:174,ACTIVESHEET_NAME:22,ROW_HEADERS_DEFINITION:58,DATEFMRT:153,TARGET:108,ADD:45,BUILD_VERSION:123,SYNC_RESPONSE:230,HIDDEN_ROWS:11,FILTERED_ROWS:63,SHEET_META:77,WORKBOOKLOCALE:172,FILTER_CRITERIA_APPLIED_COLS:65,LAST_SAVED_TIME:112,VIEW:271,SHIFT_MODE:51,NEGATIVEFRMT:155,SHARE_META:237,IS_CONTAINS_OLEOBJ:115,HIDE_GRID:117,COUNTRY:146,ADD_REPLY:267,IMPORT_AS_NEWSHEET:209,ASSOCIATED_SHEET_NAME:35,IMAGE_WIDTH:187,DATA_DUPLICATES:295,SHOW_FORMULAS:218,IS_FAVORITE:263,COLUMN_HEADERS:32,FORCED_REFRESH_TILE:269,UNIQUE_TAB_ID:287,PIVOT:29,SPREADSHEET_PROPERTIES:173,ACTIVE_RANGES:42,DOCUMENT_CTX_PATH:128,REPLACE_SPREADSHEET:208,FORM_RANGE:28,USER_INFO:122,IMAGE_ROW_DIFF:190,LAST_SAVED_ID:94,TOPVERSION:175,CELL_INDEX:90,EMAIL_ID:130,CSRF:119,SYNC:79,COLUMN_DATA:8,REPEATLOCATION:289,COLUMN_HEADERS_DEFINITION:59,UNDO:244,ISEDITABLE:109,USER_NOTIFICATION:231,STATE:281,CONDITIONALFORMAT:74,DOCUMENT_NAME:24,INSERT_CELL_TOP:98,IMAGE_HYPERLINK:198,IMAGE_ACTUAL_HEIGHT:199,COPY_TO_CLIP:68,PROTECTED_RANGES:102,IMAGE_COLUMN:189,RENAME:53,CURRENCY:167,CELLS:85,FRACTION_DIGITS:157,USERS_METAINFO:33,MAX_USED_CELL:113,CURRENCYSYMBOL:168,TIME:163,MSG_UNREAD:276,ROW_SHIFT:14,IMAGE_ZINDEX:185,RECENT_MODIFICATION_TIME:179,MERGE_ACROSS:203,NAMED_RANGE_MODIFY:19,DELETE_REPLY:256,CELL_STYLES:6,ZIA:254,DATETIME:164,NAMED_RANGE:16,FOCUS_TYPE:38,RANGE_LIST:61,UNGROUP:240,DATA_HEADER:92,MACRO_ERROR:233,SHARED_DETAILS:180,RESOURCE_ID:25,SPARKLINE:242,SERVERCLIP:138,DATACLEANSING:285,FIND_ALL_COUNT:228,ARRAY_FORMULAS:4,EDIT_GROUP:241,DECIMAL_SEPARATOR:144,LOCALE_DATEFORMAT_TYPE:227,IMAGE:136,PUBLISHED_AS:182,ALLOW_EXPORT:217,DOCUMENT_LOCALE:219,DECIMALS:150,CURRENCYSYMBOL_HTML:170,DISCUSSION_UNLIKE:258,ID:272,TYPE:82,COLORSCALE:140,DC_HIGHLIGHT:286,ISCOMMENTABLE:294,ACTIVE_INFO:41,CSRF_TOKEN:125,LANGUAGE:145,LAST_EXECUTED_ACTION_ID:93,FOCUS_RANGE_ARY:39,DISCUSSION:246,NEWLY_CREATED_STYLES:60,PERSISTED_POSITIONS:1,IMAGE_SOURCE_ID:204,IMAGE_TEXT_STYLE_NAME:194,CELL_COMMENTS:5,RECENTLY_MODIFIED_BY:178,SYMBOL:156,DELUGE_FUNCTIONS:247,RSID:97,DOC_POINTER:159,SHARE_INFO:239,USER_ACTION_RESPONSE:223,SHARED_TO:184,ZIA_RECOMMEND_QUERY:264,FOCUS:36,DELETE_CELL_BOTTOM:100,TIMEFMRT:158,PUBLISHED_VIEWS:183,ICONSET:212,ISSCRATCH:137,IMPORT:207,SYNC_STYLES:57,RESIZE:83,IMAGE_HEIGHT:186,MATCH_AT:267,DISCUSSION_LIKE_REPLY:259,DOCUMENT_META:23,SYNC_COL_STYLES:72,UNHIDDEN_SHEETS:251,REMOVE:47,UPDATE:265,LOCKED_BY:1e3,INSERT_SHEETS:268,INSERT_CELL_LEFT:99,MSG:274,MAX_USED_CELLFORMAT:206,IMAGE_ROW:188,MODIFY:46,LEADINGZEROES:151,TOGGLE_FILTER:67,OPERATION_TYPE:50,NAMED_RANGE_ADD:17,ISDOCOWNER:225,RANGES:86,DATAVALIDATION:75,VERSION:118,DATAVALIDATION_MESSAGE:87,ACTION_LIST:214,REPEATCHAR:290,CHART_COPY_STYLE:6003,ALL:278,SHARE_USER_INFO:270,COLUMN:56,FORMATCELLS_CUSTOM:301,REGIONALTYPE:149,REPLACE_ALL_COUNT:302,MACRO_WARNING:234,DIRECT_UPDATE:96,OWNER_ID:273,THOUSAND_SEPARATOR:143,EXTREMES:245,USED_CURSORS:2,ACCOUNTING:291,ACTIVE_CELL:37,IMAGE_URL:195,SHARE_TYPE:238,IS_TEMPLATE:220,ERRORMSG:89,IMAGE_NAME:192,LOCKED_BY_ZUID:1001,MERGE_CELLS:10,SYNC_ROW_STYLES:71,FORMATSTRING:148,HIDDEN_COLS:12,FILTER_RANGE:62,DOC_LAST_OPENED_TIME:177,FREEZE_PANES:13,DATE:161,SYNC_CELL_STYLES:70,IMAGE_DESC:197,DATA:81,FAULTY:84,INSERT:48,ISSHARABLE:110,ROW:55,ISGROUPINGUSED:152,ZUID:34,LOGIN_NAME:129,CELL_META:78,FORM_PUBLISH_TYPE:211,CHART_MODIFY:266,DATE_SEPARATOR:226,DOC_CREATED_TIME:176,FORM_SHEETS:106,LIKES:282,IS_STOPEDIT:88,NAMED_RANGE_LIST:20,TIME_ZONE:221,HIDDEN_SHEETS:250,FULL_NAME:133,RANGE_HIGHLIGHT:229,FILLSERIES:252,PUBLISHED_TO:181,ACTION_TYPE:275,REPEATINDEX:288,DOC_SETTINGS:27,SHEET_DIRECTION:222,REBRAND_INFO:121,APPLIED_COND_STYLE_NAME:111,SERVERCLIP_PASTE_RANGE:249,USER_META:139,ACCESS_IDENTITY:127,FILTER_DETAILS:64,ROW_DATA:7,CSRF_PARAM_NAME:124,FORMATTYPE:147,MOVE:52,LOADING_INFO:134,EXECUTED_ACTION_ID:95,IMAGE_ID:201,MACRO:235,ZOOM:73,IMAGE_STYLE_NAME:193,NAMED_RANGE_DELETE:18,META_DEFINITION:44,DC_AFFECTED_COLS:284};
function getColMax(){return 256}var isExportEvent=!1,ie=!1,DOCUMENT_ID="doc_id",RESOURCE_ID,RESOURCE_LOCKED,LOCKED_BY,templateActionRid,DOCUMENT_MAX_PERMISSION,COLLAB_DOCUMENT_ID="",DOCUMENTSHEET_ID="docsheet_id",DOCUMENT_VIEW="NEW_VIEW",SIDEBAR_VIEW="mydocs",COLOR_DIV_ID="bg_fill_div",DOCUMENT_NAME="",DOC_NAME="",NEWDOCNAME="",DEFAULT_FILENAME_FLAG=!1,jsNEW_DOC_VIEW=!1,jsOPEN_DOC_VIEW=!1,jsSHARE_VIEW=!1,jsTRASH_VIEW=!1,jsGUEST_VIEW=!1,jsPUBLIC_VIEW=!1,jsEMBED_VIEW=!1,jsTHROWAWAY_VIEW=!1,jsGADGET_VIEW=!1,jsREMOTE_VIEW=!1,jsVERSION_VIEW=!1,jsREMOTE_SAVE_VIEW=!1,jsIPHONE_VIEW=!1,jsHTML_VIEW=!1,jsPUBLISH_RANGE_VIEW=!1,jsPRINT_VIEW=!1,DOCUMENT_LOCKED=!1,READ_WRITE=!1,IPHONE_VIEW=!1,isDocumentPublic=!1,isDocumentSemiPublic=!1,SAVED=!0,OOLOADED=!0,ENTEREDPERFCHECK=!1,CANREADWRITE=!0,AUTO_SAVED=null,SERVERPORT="",SERVERNAME="",SERVERSCHEME="",TAGLIST="",TOTALSHEETS=0,IMAGE_PATH="",LOCKED_USER="",SAVECHART="false",IMPORTDOC="IMPORTDOC",ERRORIMPORT=!1,CURRENTTIME="CURRENTTIME",IMPORTACC="0",IMPORTTIME="IMPORTTIME",isEdit=!1,ENABLECACHE=!0,ENABLERTC=!0,HTMLVIEW=!1,HTMLCHARTINFO=[],STYLE_PATH="",USE_COMPRESSION="",BUILD_VERSION="",DV_MAX_CELLRANGE_ITEMS=16e3,ssServer="",initSSWidth="",initSSHeight="",initColHeadHeight="",initRowHeadWidth="",initCols="",initRows="",initColWidth="",initRowHeight="",defCellStyleStr="",defCellStyle="",defCellFormat="",defCellHolderProp="",tablewidth="",tableheight="",bridgeNumber="-1",saveForward="",commentCnt=0,guestId="",versionDetailsNo=0,IS_UNSAVED_SHEET=!1,IS_REVERT_ALLOWED=!1,ALL_SHEET_SHARED=!1,isSheetBasedShare=!1,isRegistered=!0,isVersionPending=!1,cursor_Row_Index=0,cursor_Col_Index=0,position_Bottom=0,position_Left=0,formatPainterON=!1,currUserColor="",USERPRESENCE_COLORS=[],signupTriggerTimer=0,cellPrevState=void 0,RTLlang=!1,prevSheetStyle=null,BLOCK_RTL=!0;document.all&&(ie=!0);var maskOpenRec=!1,isRangeDialog=!1,CURR_DOC_OWNERNAME="",isPublished=!1,isRangeEdit=!1,SHAREDUSERS="",COLLAB_ID="",ISSAMESHEET="true",RTCSHEETNAME="",SAVEDOC="false",C_STARTROW="",C_ENDROW="",C_STARTCOL="",C_ENDCOL="",RTC_EXISTS="false",COLLABORATIVE_EDITING="OFF",SHAREDUSERSLIST=[],ISCOLLAB="false",CURRENTUSER="",documentOpened="false",LISTOFCOLLABIDS="",BACKUPCOLLABID="",DONTNOTIFY=!1,INSERTIMAGE=!1,IMAGEOBJECT=null,XPOSITION=null,YPOSITION=null,UPDATEIMAGEINOO=!0,doAutoSave=!1,usedCursCol=0,usedCursRow=0,publicURL="",sbWidth=200,MKIMODE=!1,MKIEXPORT=!1,NOPDF=!1,USERCURRENCY,savedFlag=!0,DO_INDEX_SEARCH=!1,DOCUMENT_NAME_URL="",BACKGROUNDCOLOR="",FONTCOLOR="",CURR_THEME="",DEFAULT_THEME="",wholeValAsStringInArrFormt="",defineNameHTML="",ASSIGNEDTO="",FOCUSSEDNAMEINPUTOBJECT="",SHEETSWITCH=!1,isExprFieldExpanded=!1,H_SCROLLBAR_HEIGHT,V_SCROLLBAR_WIDTH,fromDeleteCol=!1,afterConstructTilesFromJson=!1,MACROSAVED=!0,ISMINDLG=!1,ISMACRODOCCHANGE=!1,RECORDINGMACRO=!1,MACRO_DOC_SAVED=!0,ISMACROEDITOROPEN=!1,TOP="",zoid=-1,zuid=-1,orgName="",orgDisplayName="",CLONEIMAGE=!1,ISGEEDITOR=!1,colorcodes=["6BA125","076CB0","FC7A0A","F3CC03","D70005","5E8C5E","476FB3","CFA012","DF4620","5D39A5"],colorcodeidx=0,userColorCode={},userpremission=[],userpresenceintvl,displayAll=!1,SET_LASTEDITED_DOCID=!1,filenameFieldId="",CREATE_TEMPLATE_FROM_UI="",CREATE_TEMPLATE_FROM_MENU="",isEngineSupported=!1,WIDTHHEIGHTUNDO=!1,VBAEDITORMODULENAME="",VBAEDITORLINENO="",VBAEDITORMODULETYPE="",VBAEDITORSHOW="",isPivotDialogOpen=!1,isEditPivotDialogOpen=!1,currImg="",decSymbol="",docLocale="",userDateFormatType="",userCurrencySymbol="",userDateSeparator,TEMP_CONTAINER_IDENTITY,Public={holdRequests:!1},doOlePosCheck=!1,oleObjectsAry=[],allowtowrite=!0,allowOrgEdit=!1,allowExport=!0,showFormulas=!0,allowExportOrg=!0,allowPublishOrg=!1,showFormulasOrg=!0,showPublic=!0,pubType="",allowExportPublic=!0,poweredByObjHt=0,isCoOwnerSharedDoc=!1,canShare=!1,isAdmin=!1,isEditorClosed,ROWS_PER_TILE=1,ARROW_HEIGHT_IN_SCROLLBAR=16,ARROW_WIDTH_IN_SCROLLBAR=16,cellDefaultHeight=18,cellDefaultWidth=80,SCROLL_PER_MOUSEWHEEL=40,isRespondedInScroll=!0,FILE_FORMAT,showErrorPanelMsg="ShowErrorPanel",parseError=!1,fromOpenFreeze=!1,PUBLIC_EDIT_MODE=!1,LOAD_OBJECT_IN_PUBLIC=!1,isInOOMode=!1,tempPublicDocId="",showPrevMessage,PREVIOUS_MESSAGE="",wmsCommErrorStatus="",wmsErrorMsgShown=!1,isAnyOnline=!1,DISABLECHAT=!1,importId=null,isDocContainsArrayFormula=!1,remoteUserDocId="",hasOleMoved=!1,isPublicEditDoc=!1,isPublicViewDoc=!1,isReadOnlyViewMode=!1,toolbarinited=!1,Row={},hiddenRowStartIdxAry=[],hiddenRowEndIdxAry=[],indexedHiddenRowAry=[],rowsInPage=[],isCopiedRowRangeHasFilteredRows=!1,isDevelopmentMode=!1,isCollabJoined=!1,transMode=!1,grantRequest=!0,isGDriveView=!1,selectedmenutab,isNewDocument=!1,stopGetStatus=!1,wakeUpTime=null,restrictScroll=!0,isFullScreen=!1,Product_Type,Owner_ID,BASEZINDEX=getColMax()+3,user={permissions:{}},Logger={},dialogEl,dialogOpened,FadeCell={},isFuncDlgOpen,pivot={},pivotId=null,sendGetStatusRequest=!0,submitCallBack={},WMSREQ_SEND_COUNT=0,WMSREQ_RECEIVE_COUNT=0,UI={fontNamesCSSClassMap:{Arial:"fnal","Arial Black":"fnab","Book Antiqua":"fnba",Calibri:"fnci","Comic Sans MS":"fncs","Courier New":"fncn",Garamond:"fngd",Georgia:"fnga","Lucida Console":"fnlc",MingLiU:"fnml","MS Gothic":"fnmg","MS PGothic":"fnmpg","MS Mincho":"fnmm","MS P Mincho":"fnmpm","MS Sans Serif":"fnms",SimHei:"fnsh",Tahoma:"fnta","Times New Roman":"fntn","Trebuchet MS":"fntms",Verdana:"fnva",FangSong_GB2312:"fnfs",KaiTi_GB2312:"fnkt",LiSu:"fnls",SimSun:"fnss",NSimSun:"fnnss",YouYuan:"fnyy","Simsun (Founder Extended)":"fnssfe",FZShuTi:"fnfzst",FZYaoti:"fnfzy",STFangsong:"fnstf",STHupo:"fnsth",STKaiti:"fnstk",STLiti:"fnstl",STSong:"fnsts",STXinwei:"fnstxw",STXihei:"fnstxh",STXingkai:"fnstxk",STZhongsong:"fnstz","Microsoft YaHei":"fnmyh",STCaiyun:"fnstc","GIST-TMOTChanakya":"fntc","GIST-TMOTIlango":"fnti","GIST-TMOTPattinathar":"fntptn","GIST-TMOTPadma":"fntp","GIST-TMOTKrishnan":"fntk",TSC_Kannadaasan:"fntka",Anjal:"fna",Impact:"fnit","Andale Mono":"fnam","Palatino Linotype":"fnpl",Symbol:"fnsl",Webdings:"fnws","Wingdings 2":"fnws2","Wingdings 3":"fnws3",Cambria:"fncbra",Century:"fnctry",HGMaruGothicMPRO:"fnhmgp"},CSSClassFontNamesMap:{fnal:"Arial",fnab:"Arial Black",fnba:"Book Antiqua",fnci:"Calibri",fncs:"Comic Sans MS",fncn:"Courier New",fngd:"Garamond",fnga:"Georgia",fnlc:"Lucida Console",fnml:"MingLiU",fnmg:"MS Gothic",fnmpg:"MS PGothic",fnmm:"MS Mincho",fnmpm:"MS P Mincho",fnms:"MS Sans Serif",fnsh:"SimHei",fnta:"Tahoma",fntn:"Times New Roman",fntms:"Trebuchet MS",fnva:"Verdana",fnfs:"FangSong_GB2312",fnkt:"KaiTi_GB2312",fnls:"LiSu",fnss:"SimSun",fnnss:"NSimSun",fnyy:"YouYuan",fnssfe:"Simsun (Founder Extended)",fnfzst:"FZShuTi",fnfzy:"FZYaoti",fnstf:"STFangsong",fnsth:"STHupo",fnstk:"STKaiti",fnstl:"STLiti",fnsts:"STSong",fnstxw:"STXinwei",fnstxh:"STXihei",fnstxk:"STXingkai",fnstz:"STZhongsong",fnmyh:"Microsoft YaHei",fnstc:"STCaiyun",fntc:"GIST-TMOTChanakya",fnti:"GIST-TMOTIlango",fntptn:"GIST-TMOTPattinathar",fntp:"GIST-TMOTPadma",fntk:"GIST-TMOTKrishnan",fntka:"TSC_Kannadaasan",fna:"Anjal",fnit:"Impact",fnam:"Andale Mono",fnpl:"Palatino Linotype",fnsl:"Symbol",fnws:"Webdings",fnws2:"Wingdings 2",fnws3:"Wingdings 3",fncbra:"Cambria",fnctry:"Century",fnhmgp:"HGMaruGothicMPRO"},CSSClassNamePatterns:{fontSize:/( f[0-9]{1,2})(\b)/i,fontFamily:/( fn[A-Za-z0-9]{1,5})(\b)/i,fontWeight:/( fwb)(\b)/i,bold:/( fwb)(\b)/i,textDecoration:/( tdu)(\b)/i,underline:/( tdu)(\b)/i,verticalAlign:/( va[mbt])(\b)/i,textAlign:/( ta[rc])(\b)/i,utextAlign:/( fa[rlc])(\b)/i,nFormat:/( nFT[1-8])(\b)/i,fontStyle:/( fsi)(\b)/i,italic:/( fsi)(\b)/i,borderRight:/( br[12d])(\b)/i,borderBottom:/( bb[12d])(\b)/i,borderLeft:/( bl[123])(\b)/i,borderTop:/( bt[123])(\b)/i,wrapText:/( nW| W)(\b)/i,cellComment:/( cC)(\b)/i,strikeThrough:/( tdst)(\b)/i,strike:/( tdst)(\b)/i,underlineStrikethrough:/( tdsu)(\b)/i,iconset:/( iS-[A-Za-z0-9]{1,19})(\b)/i,alignClass:/( (fa|ta)[rlc])(\b)/i}},ALLOW_TO_COMMENT=!1,isHighlightInvalidData=!1,isDvListCell=void 0,isFileUploadServerDisabled=!1,isZSAdminAnnouncementDisplayed=!1,wmsSmiley={},shortCutKeys={},isFirstTimeTabPressed=!0,sheetScrollLeftVal=0,SERVICE_NAME,DOMAIN_NAME,aTk="",BLOCK_REMOVED_FILE_REQUEST=!1,pivotSheetScrollTopId,pvtDragRowNo=0,pvtDragColNo=0,widgetprevMenuItemTicked="",isCopyPasteWidgetPresent=!1,isFormatApply=!0,pivotDataMenuCount=0;
function escapeSpecialCharacters(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;").replace(/\"/g,"&quot;"):e}function revertQuote(e){return replace(e,"&apos;","'")}function replace(e,r,a){var c=e.length,p=r.length;if(0==c||0==p)return e;var g=e.indexOf(r);if(!g&&r!=e.substring(0,p))return e;if(-1==g)return e;var l=e.substring(0,g)+a;return c>g+p&&(l+=replace(e.substring(g+p,c),r,a)),l}function replaceSplChrs(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&amp;/g,"&").replace(/&#x2F;/g,"/").replace(/&#x27;/g,"'")}function revertSplChrs(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;")}function revertJsonSplChrs(e){return e?e.replace(/&#123;/g,"{").replace(/&#125;/g,"}").replace(/&#091;/g,"[").replace(/&#093;/g,"]"):e}function doit(e,r){return e=e.replace(/\%/g,"%25"),e=e.replace(/\!/g,"%21"),e=e.replace(/\"/g,"%22"),e=e.replace(/\#/g,"%23"),e=e.replace(/\$/g,"%24"),e=e.replace(/\&/g,"%26"),e=e.replace(/\(/g,"%28"),e=e.replace(/\)/g,"%29"),e=e.replace(/\*/g,"%2A"),e=e.replace(/\+/g,"%2B"),e=e.replace(/\,/g,"%2C"),e=e.replace(/\-/g,"%2D"),e=e.replace(/\./g,"%2E"),e=e.replace(/\//g,"%2F"),e=e.replace(/\:/g,"%3A"),e=e.replace(/\;/g,"%3B"),e=e.replace(/\</g,"%3C"),e=e.replace(/\=/g,"%3D"),e=e.replace(/\>/g,"%3E"),e=e.replace(/\?/g,"%3F"),e=e.replace(/\@/g,"%40"),e=e.replace(/\[/g,"%5B"),e=e.replace(/\\/g,"%5C"),e=e.replace(/\]/g,"%5D"),e=e.replace(/\^/g,"%5E"),e=e.replace(/\_/g,"%5F"),e=e.replace(/\`/g,"%60"),e=e.replace(/\{/g,"%7B"),e=e.replace(/\|/g,"%7C"),e=e.replace(/\}/g,"%7D"),e=e.replace(/\~/g,"%7E"),r&&(e=replace(e,"\n","%0A")),e}function escapeSpecialChar(e){var r=arguments[1];return e=encodeURIComponent(escape(e)),"no"!=r&&(-1!=arguments[0].indexOf(".")&&(e=e.replace(/\./g,"\\.")),-1!=arguments[0].indexOf("*")&&(e=e.replace(/\*/g,"\\*")),-1!=arguments[0].indexOf("_")&&(e=e.replace(/\_/g,"\\_")),-1!=arguments[0].indexOf("-")&&(e=e.replace(/\-/g,"\\-"))),e}function unescapeSpecialChar(e){var r=arguments[1];return"no"!=r&&(-1!=arguments[0].indexOf(".")&&(e=e.replace(/\\\./g,".")),-1!=arguments[0].indexOf("*")&&(e=e.replace(/\\\*/g,"*")),-1!=arguments[0].indexOf("_")&&(e=e.replace(/\\\_/g,"_")),-1!=arguments[0].indexOf("-")&&(e=e.replace(/\\\-/g,"-"))),e=unescape(decodeURIComponent(e))}
!function(e,t){function n(e){var t=ht[e]={};return K.each(e.split(tt),function(e,n){t[n]=!0}),t}function r(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(mt,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:gt.test(r)?K.parseJSON(r):r}catch(e){}K.data(e,n,r)}else r=t}return r}function i(e){var t;for(t in e)if(("data"!==t||!K.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function o(){return!1}function a(){return!0}function s(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function u(e,t,n){if(t=t||0,K.isFunction(t))return K.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return K.grep(e,function(e){return e===t===n});if("string"==typeof t){var r=K.grep(e,function(e){return 1===e.nodeType});if(_t.test(t))return K.filter(t,r,!n);t=K.filter(t,r)}return K.grep(e,function(e){return K.inArray(e,t)>=0===n})}function c(e){var t=Wt.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function f(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function p(e,t){if(1===t.nodeType&&K.hasData(e)){var n,r,i,o=K._data(e),a=K._data(t,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)K.event.add(t,n,s[n][r])}a.data&&(a.data=K.extend({},a.data))}}function d(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),K.support.html5Clone&&e.innerHTML&&!K.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Jt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(K.expando))}function h(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function g(e){Jt.test(e.type)&&(e.defaultChecked=e.checked)}function m(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=vn.length;i--;)if(t=vn[i]+n,t in e)return t;return r}function y(e,t){return e=t||e,"none"===K.css(e,"display")||!K.contains(e.ownerDocument,e)}function v(e,t){for(var n,r,i=[],o=0,a=e.length;a>o;o++)n=e[o],n.style&&(i[o]=K._data(n,"olddisplay"),t?(i[o]||"none"!==n.style.display||(n.style.display=""),""===n.style.display&&y(n)&&(i[o]=K._data(n,"olddisplay",T(n.nodeName)))):(r=nn(n,"display"),i[o]||"none"===r||K._data(n,"olddisplay",r)));for(o=0;a>o;o++)n=e[o],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?i[o]||"":"none"));return e}function b(e,t,n){var r=fn.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function x(e,t,n,r){for(var i=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>i;i+=2)"margin"===n&&(o+=K.css(e,n+yn[i],!0)),r?("content"===n&&(o-=parseFloat(nn(e,"padding"+yn[i]))||0),"margin"!==n&&(o-=parseFloat(nn(e,"border"+yn[i]+"Width"))||0)):(o+=parseFloat(nn(e,"padding"+yn[i]))||0,"padding"!==n&&(o+=parseFloat(nn(e,"border"+yn[i]+"Width"))||0));return o}function w(e,t,n){var r="width"===t?e.offsetWidth:e.offsetHeight,i=!0,o=K.support.boxSizing&&"border-box"===K.css(e,"boxSizing");if(0>=r||null==r){if(r=nn(e,t),(0>r||null==r)&&(r=e.style[t]),pn.test(r))return r;i=o&&(K.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+x(e,t,n||(o?"border":"content"),i)+"px"}function T(e){if(hn[e])return hn[e];var t=K("<"+e+">").appendTo(R.body),n=t.css("display");return t.remove(),("none"===n||""===n)&&(rn=R.body.appendChild(rn||K.extend(R.createElement("iframe"),{frameBorder:0,width:0,height:0})),on&&rn.createElement||(on=(rn.contentWindow||rn.contentDocument).document,on.write("<!doctype html><html><body>"),on.close()),t=on.body.appendChild(on.createElement(e)),n=nn(t,"display"),R.body.removeChild(rn)),hn[e]=n,n}function N(e,t,n,r){var i;if(K.isArray(t))K.each(t,function(t,i){n||wn.test(e)?r(e,i):N(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==K.type(t))r(e,t);else for(i in t)N(e+"["+i+"]",t[i],n,r)}function C(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i,o,a=t.toLowerCase().split(tt),s=0,l=a.length;if(K.isFunction(n))for(;l>s;s++)r=a[s],o=/^\+/.test(r),o&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[o?"unshift":"push"](n)}}function k(e,n,r,i,o,a){o=o||n.dataTypes[0],a=a||{},a[o]=!0;for(var s,l=e[o],u=0,c=l?l.length:0,f=e===qn;c>u&&(f||!s);u++)s=l[u](n,r,i),"string"==typeof s&&(!f||a[s]?s=t:(n.dataTypes.unshift(s),s=k(e,n,r,i,s,a)));return!f&&s||a["*"]||(s=k(e,n,r,i,"*",a)),s}function E(e,n){var r,i,o=K.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((o[r]?e:i||(i={}))[r]=n[r]);i&&K.extend(!0,e,i)}function S(e,n,r){var i,o,a,s,l=e.contents,u=e.dataTypes,c=e.responseFields;for(o in c)o in r&&(n[c[o]]=r[o]);for(;"*"===u[0];)u.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(o in l)if(l[o]&&l[o].test(i)){u.unshift(o);break}if(u[0]in r)a=u[0];else{for(o in r){if(!u[0]||e.converters[o+" "+u[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==u[0]&&u.unshift(a),r[a]):void 0}function A(e,t){var n,r,i,o,a=e.dataTypes.slice(),s=a[0],l={},u=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a[1])for(n in e.converters)l[n.toLowerCase()]=e.converters[n];for(;i=a[++u];)if("*"!==i){if("*"!==s&&s!==i){if(n=l[s+" "+i]||l["* "+i],!n)for(r in l)if(o=r.split(" "),o[1]===i&&(n=l[s+" "+o[0]]||l["* "+o[0]])){n===!0?n=l[r]:l[r]!==!0&&(i=o[0],a.splice(u--,0,i));break}if(n!==!0)if(n&&e.throws)t=n(t);else try{t=n(t)}catch(e){return{state:"parsererror",error:n?e:"No conversion from "+s+" to "+i}}}s=i}return{state:"success",data:t}}function j(){try{return new e.XMLHttpRequest}catch(e){}}function D(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function L(){return setTimeout(function(){Yn=t},0),Yn=K.now()}function H(e,t){K.each(t,function(t,n){for(var r=(Zn[t]||[]).concat(Zn["*"]),i=0,o=r.length;o>i;i++)if(r[i].call(e,t,n))return})}function F(e,t,n){var r,i=0,o=Kn.length,a=K.Deferred().always(function(){delete s.elem}),s=function(){for(var t=Yn||L(),n=Math.max(0,l.startTime+l.duration-t),r=n/l.duration||0,i=1-r,o=0,s=l.tweens.length;s>o;o++)l.tweens[o].run(i);return a.notifyWith(e,[l,i,n]),1>i&&s?n:(a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:K.extend({},t),opts:K.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Yn||L(),duration:n.duration,tweens:[],createTween:function(t,n){var r=K.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){for(var n=0,r=t?l.tweens.length:0;r>n;n++)l.tweens[n].run(1);return t?a.resolveWith(e,[l,t]):a.rejectWith(e,[l,t]),this}}),u=l.props;for(M(u,l.opts.specialEasing);o>i;i++)if(r=Kn[i].call(l,e,u,l.opts))return r;return H(l,u),K.isFunction(l.opts.start)&&l.opts.start.call(e,l),K.fx.timer(K.extend(s,{anim:l,queue:l.opts.queue,elem:e})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function M(e,t){var n,r,i,o,a;for(n in e)if(r=K.camelCase(n),i=t[r],o=e[n],K.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=K.cssHooks[r],a&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function O(e,t,n){var r,i,o,a,s,l,u,c,f,p=this,d=e.style,h={},g=[],m=e.nodeType&&y(e);n.queue||(c=K._queueHooks(e,"fx"),null==c.unqueued&&(c.unqueued=0,f=c.empty.fire,c.empty.fire=function(){c.unqueued||f()}),c.unqueued++,p.always(function(){p.always(function(){c.unqueued--,K.queue(e,"fx").length||c.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],"inline"===K.css(e,"display")&&"none"===K.css(e,"float")&&(K.support.inlineBlockNeedsLayout&&"inline"!==T(e.nodeName)?d.zoom=1:d.display="inline-block")),n.overflow&&(d.overflow="hidden",K.support.shrinkWrapBlocks||p.done(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}));for(r in t)if(o=t[r],Jn.exec(o)){if(delete t[r],l=l||"toggle"===o,o===(m?"hide":"show"))continue;g.push(r)}if(a=g.length){s=K._data(e,"fxshow")||K._data(e,"fxshow",{}),"hidden"in s&&(m=s.hidden),l&&(s.hidden=!m),m?K(e).show():p.done(function(){K(e).hide()}),p.done(function(){var t;K.removeData(e,"fxshow",!0);for(t in h)K.style(e,t,h[t])});for(r=0;a>r;r++)i=g[r],u=p.createTween(i,m?s[i]:0),h[i]=s[i]||K.style(e,i),i in s||(s[i]=u.start,m&&(u.end=u.start,u.start="width"===i||"height"===i?1:0))}}function _(e,t,n,r,i){return new _.prototype.init(e,t,n,r,i)}function q(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=yn[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function B(e){return K.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var W,P,R=e.document,$=e.location,I=e.navigator,z=e.jQuery,X=e.$,U=Array.prototype.push,Y=Array.prototype.slice,V=Array.prototype.indexOf,J=Object.prototype.toString,G=Object.prototype.hasOwnProperty,Q=String.prototype.trim,K=function(e,t){return new K.fn.init(e,t,W)},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,it=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ot=/^[\],:{}\s]*$/,at=/(?:^|:|,)(?:\s*\[)+/g,st=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,lt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ut=/^-ms-/,ct=/-([\da-z])/gi,ft=function(e,t){return(t+"").toUpperCase()},pt=function(){R.addEventListener?(R.removeEventListener("DOMContentLoaded",pt,!1),K.ready()):"complete"===R.readyState&&(R.detachEvent("onreadystatechange",pt),K.ready())},dt={};K.fn=K.prototype={constructor:K,init:function(e,n,r){var i,o,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:rt.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1])return n=n instanceof K?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:R,e=K.parseHTML(i[1],a,!0),it.test(i[1])&&K.isPlainObject(n)&&this.attr.call(e,n,!0),K.merge(this,e);if(o=R.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(e);this.length=1,this[0]=o}return this.context=R,this.selector=e,this}return K.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),K.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return Y.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=K.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,"find"===t?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return K.each(this,e,t)},ready:function(e){return K.ready.promise().done(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Y.apply(this,arguments),"slice",Y.call(arguments).join(","))},map:function(e){return this.pushStack(K.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:U,sort:[].sort,splice:[].splice},K.fn.init.prototype=K.fn,K.extend=K.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||K.isFunction(s)||(s={}),u===l&&(s=this,--l);u>l;l++)if(null!=(e=arguments[l]))for(n in e)r=s[n],i=e[n],s!==i&&(c&&i&&(K.isPlainObject(i)||(o=K.isArray(i)))?(o?(o=!1,a=r&&K.isArray(r)?r:[]):a=r&&K.isPlainObject(r)?r:{},s[n]=K.extend(c,a,i)):i!==t&&(s[n]=i));return s},K.extend({noConflict:function(t){return e.$===K&&(e.$=X),t&&e.jQuery===K&&(e.jQuery=z),K},isReady:!1,readyWait:1,holdReady:function(e){e?K.readyWait++:K.ready(!0)},ready:function(e){if(e===!0?!--K.readyWait:!K.isReady){if(!R.body)return setTimeout(K.ready,1);K.isReady=!0,e!==!0&&--K.readyWait>0||(P.resolveWith(R,[K]),K.fn.trigger&&K(R).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===K.type(e)},isArray:Array.isArray||function(e){return"array"===K.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):dt[J.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==K.type(e)||e.nodeType||K.isWindow(e))return!1;try{if(e.constructor&&!G.call(e,"constructor")&&!G.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}var n;for(n in e);return n===t||G.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return e&&"string"==typeof e?("boolean"==typeof t&&(n=t,t=0),t=t||R,(r=it.exec(e))?[t.createElement(r[1])]:(r=K.buildFragment([e],t,n?null:[]),K.merge([],(r.cacheable?K.clone(r.fragment):r.fragment).childNodes))):null},parseJSON:function(t){return t&&"string"==typeof t?(t=K.trim(t),e.JSON&&e.JSON.parse?e.JSON.parse(t):ot.test(t.replace(st,"@").replace(lt,"]").replace(at,""))?new Function("return "+t)():void K.error("Invalid JSON: "+t)):null},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(e){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||K.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ut,"ms-").replace(ct,ft)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,o=0,a=e.length,s=a===t||K.isFunction(e);if(r)if(s){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;a>o&&n.apply(e[o++],r)!==!1;);else if(s){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;a>o&&n.call(e[o],o,e[o++])!==!1;);return e},trim:Q&&!Q.call("")?function(e){return null==e?"":Q.call(e)}:function(e){return null==e?"":(e+"").replace(nt,"")},makeArray:function(e,t){var n,r=t||[];return null!=e&&(n=K.type(e),null==e.length||"string"===n||"function"===n||"regexp"===n||K.isWindow(e)?U.call(r,e):K.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(V)return V.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,o=0;if("number"==typeof r)for(;r>o;o++)e[i++]=n[o];else for(;n[o]!==t;)e[i++]=n[o++];return e.length=i,e},grep:function(e,t,n){var r,i=[],o=0,a=e.length;for(n=!!n;a>o;o++)r=!!t(e[o],o),n!==r&&i.push(e[o]);return i},map:function(e,n,r){var i,o,a=[],s=0,l=e.length,u=e instanceof K||l!==t&&"number"==typeof l&&(l>0&&e[0]&&e[l-1]||0===l||K.isArray(e));if(u)for(;l>s;s++)i=n(e[s],s,r),null!=i&&(a[a.length]=i);else for(o in e)i=n(e[o],o,r),null!=i&&(a[a.length]=i);return a.concat.apply([],a)},guid:1,proxy:function(e,n){var r,i,o;return"string"==typeof n&&(r=e[n],n=e,e=r),K.isFunction(e)?(i=Y.call(arguments,2),o=function(){return e.apply(n,i.concat(Y.call(arguments)))},o.guid=e.guid=e.guid||K.guid++,o):t},access:function(e,n,r,i,o,a,s){var l,u=null==r,c=0,f=e.length;if(r&&"object"==typeof r){for(c in r)K.access(e,n,c,r[c],1,a,i);o=1}else if(i!==t){if(l=s===t&&K.isFunction(i),u&&(l?(l=n,n=function(e,t,n){return l.call(K(e),n)}):(n.call(e,i),n=null)),n)for(;f>c;c++)n(e[c],r,l?i.call(e[c],c,n(e[c],r)):i,s);o=1}return o?e:u?n.call(e):f?n(e[0],r):a},now:function(){return(new Date).getTime()}}),K.ready.promise=function(t){if(!P)if(P=K.Deferred(),"complete"===R.readyState)setTimeout(K.ready,1);else if(R.addEventListener)R.addEventListener("DOMContentLoaded",pt,!1),e.addEventListener("load",K.ready,!1);else{R.attachEvent("onreadystatechange",pt),e.attachEvent("onload",K.ready);var n=!1;try{n=null==e.frameElement&&R.documentElement}catch(e){}n&&n.doScroll&&!function e(){if(!K.isReady){try{n.doScroll("left")}catch(t){return setTimeout(e,50)}K.ready()}}()}return P.promise(t)},K.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){dt["[object "+t+"]"]=t.toLowerCase()}),W=K(R);var ht={};K.Callbacks=function(e){e="string"==typeof e?ht[e]||n(e):K.extend({},e);var r,i,o,a,s,l,u=[],c=!e.once&&[],f=function(t){for(r=e.memory&&t,i=!0,l=a||0,a=0,s=u.length,o=!0;u&&s>l;l++)if(u[l].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}o=!1,u&&(c?c.length&&f(c.shift()):r?u=[]:p.disable())},p={add:function(){if(u){var t=u.length;!function t(n){K.each(n,function(n,r){var i=K.type(r);"function"===i?e.unique&&p.has(r)||u.push(r):r&&r.length&&"string"!==i&&t(r)})}(arguments),o?s=u.length:r&&(a=t,f(r))}return this},remove:function(){return u&&K.each(arguments,function(e,t){for(var n;(n=K.inArray(t,u,n))>-1;)u.splice(n,1),o&&(s>=n&&s--,l>=n&&l--)}),this},has:function(e){return K.inArray(e,u)>-1},empty:function(){return u=[],this},disable:function(){return u=c=r=t,this},disabled:function(){return!u},lock:function(){return c=t,r||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||i&&!c||(o?c.push(t):f(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!i}};return p},K.extend({Deferred:function(e){var t=[["resolve","done",K.Callbacks("once memory"),"resolved"],["reject","fail",K.Callbacks("once memory"),"rejected"],["notify","progress",K.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return K.Deferred(function(n){K.each(t,function(t,r){var o=r[0],a=e[t];i[r[1]](K.isFunction(a)?function(){var e=a.apply(this,arguments);e&&K.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===i?n:this,[e])}:n[o])}),e=null}).promise()},promise:function(e){return null!=e?K.extend(e,r):r}},i={};return r.pipe=r.then,K.each(t,function(e,o){var a=o[2],s=o[3];r[o[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),i[o[0]]=a.fire,i[o[0]+"With"]=a.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,o=Y.call(arguments),a=o.length,s=1!==a||e&&K.isFunction(e.promise)?a:0,l=1===s?e:K.Deferred(),u=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?Y.call(arguments):i,r===t?l.notifyWith(n,r):--s||l.resolveWith(n,r)}};if(a>1)for(t=new Array(a),n=new Array(a),r=new Array(a);a>i;i++)o[i]&&K.isFunction(o[i].promise)?o[i].promise().done(u(i,r,o)).fail(l.reject).progress(u(i,n,t)):--s;return s||l.resolveWith(r,o),l.promise()}}),K.support=function(){var t,n,r,i,o,a,s,l,u,c,f,p=R.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0],!n||!r||!n.length)return{};i=R.createElement("select"),o=i.appendChild(R.createElement("option")),a=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:"/a"===r.getAttribute("href"),opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:"on"===a.value,optSelected:o.selected,getSetAttribute:"t"!==p.className,enctype:!!R.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==R.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===R.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},a.checked=!0,t.noCloneChecked=a.cloneNode(!0).checked,i.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(e){t.deleteExpando=!1}if(!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",f=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",f)),a=R.createElement("input"),a.value="t",a.setAttribute("type","radio"),t.radioValue="t"===a.value,a.setAttribute("checked","checked"),a.setAttribute("name","t"),p.appendChild(a),s=R.createDocumentFragment(),s.appendChild(p.lastChild),t.checkClone=s.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=a.checked,s.removeChild(a),s.appendChild(p),p.attachEvent)for(u in{submit:!0,change:!0,focusin:!0})l="on"+u,c=l in p,c||(p.setAttribute(l,"return;"),c="function"==typeof p[l]),t[u+"Bubbles"]=c;return K(function(){var n,r,i,o,a="padding:0;margin:0;border:0;display:block;overflow:hidden;",s=R.getElementsByTagName("body")[0];s&&(n=R.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",s.insertBefore(n,s.firstChild),r=R.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=r.getElementsByTagName("td"),i[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===i[0].offsetHeight,i[0].style.display="",i[1].style.display="none",t.reliableHiddenOffsets=c&&0===i[0].offsetHeight,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===r.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==s.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(r,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(r,null)||{width:"4px"}).width,o=R.createElement("div"),o.style.cssText=r.style.cssText=a,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),"undefined"!=typeof r.style.zoom&&(r.innerHTML="",r.style.cssText=a+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===r.offsetWidth,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==r.offsetWidth,n.style.zoom=1),s.removeChild(n),n=r=i=o=null)}),s.removeChild(p),n=r=i=o=a=s=p=null,t}();var gt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,mt=/([A-Z])/g;K.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(K.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?K.cache[e[K.expando]]:e[K.expando],!!e&&!i(e)},data:function(e,n,r,i){if(K.acceptData(e)){var o,a,s=K.expando,l="string"==typeof n,u=e.nodeType,c=u?K.cache:e,f=u?e[s]:e[s]&&s;if(f&&c[f]&&(i||c[f].data)||!l||r!==t)return f||(u?e[s]=f=K.deletedIds.pop()||K.guid++:f=s),c[f]||(c[f]={},u||(c[f].toJSON=K.noop)),("object"==typeof n||"function"==typeof n)&&(i?c[f]=K.extend(c[f],n):c[f].data=K.extend(c[f].data,n)),o=c[f],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[K.camelCase(n)]=r),l?(a=o[n],null==a&&(a=o[K.camelCase(n)])):a=o,a}},removeData:function(e,t,n){if(K.acceptData(e)){var r,o,a,s=e.nodeType,l=s?K.cache:e,u=s?e[K.expando]:K.expando;if(l[u]){if(t&&(r=n?l[u]:l[u].data)){K.isArray(t)||(t in r?t=[t]:(t=K.camelCase(t),t=t in r?[t]:t.split(" ")));for(o=0,a=t.length;a>o;o++)delete r[t[o]];if(!(n?i:K.isEmptyObject)(r))return}(n||(delete l[u].data,i(l[u])))&&(s?K.cleanData([e],!0):K.support.deleteExpando||l!=l.window?delete l[u]:l[u]=null)}}},_data:function(e,t,n){return K.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&K.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),K.fn.extend({data:function(e,n){var i,o,a,s,l,u=this[0],c=0,f=null;if(e===t){if(this.length&&(f=K.data(u),1===u.nodeType&&!K._data(u,"parsedAttrs"))){for(a=u.attributes,l=a.length;l>c;c++)s=a[c].name,s.indexOf("data-")||(s=K.camelCase(s.substring(5)),r(u,s,f[s]));K._data(u,"parsedAttrs",!0)}return f}return"object"==typeof e?this.each(function(){K.data(this,e)}):(i=e.split(".",2),i[1]=i[1]?"."+i[1]:"",o=i[1]+"!",K.access(this,function(n){return n===t?(f=this.triggerHandler("getData"+o,[i[0]]),f===t&&u&&(f=K.data(u,e),f=r(u,e,f)),f===t&&i[1]?this.data(i[0]):f):(i[1]=n,void this.each(function(){var t=K(this);t.triggerHandler("setData"+o,i),K.data(this,e,n),t.triggerHandler("changeData"+o,i)}))},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){K.removeData(this,e)})}}),K.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=K._data(e,t),n&&(!r||K.isArray(n)?r=K._data(e,t,K.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=K.queue(e,t),r=n.length,i=n.shift(),o=K._queueHooks(e,t),a=function(){K.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return K._data(e,n)||K._data(e,n,{empty:K.Callbacks("once memory").add(function(){K.removeData(e,t+"queue",!0),K.removeData(e,n,!0)})})}}),K.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),arguments.length<r?K.queue(this[0],e):n===t?this:this.each(function(){var t=K.queue(this,e,n);K._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&K.dequeue(this,e)})},dequeue:function(e){return this.each(function(){K.dequeue(this,e)})},delay:function(e,t){return e=K.fx?K.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,o=K.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";s--;)r=K._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l));return l(),o.promise(n)}});var yt,vt,bt,xt=/[\t\r\n]/g,wt=/\r/g,Tt=/^(?:button|input)$/i,Nt=/^(?:button|input|object|select|textarea)$/i,Ct=/^a(?:rea|)$/i,kt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Et=K.support.getSetAttribute;K.fn.extend({attr:function(e,t){return K.access(this,K.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){K.removeAttr(this,e)})},prop:function(e,t){return K.access(this,K.prop,e,t,arguments.length>1)},removeProp:function(e){return e=K.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(e){}})},addClass:function(e){var t,n,r,i,o,a,s;if(K.isFunction(e))return this.each(function(t){K(this).addClass(e.call(this,t,this.className))});if(e&&"string"==typeof e)for(t=e.split(tt),n=0,r=this.length;r>n;n++)if(i=this[n],1===i.nodeType)if(i.className||1!==t.length){for(o=" "+i.className+" ",a=0,s=t.length;s>a;a++)o.indexOf(" "+t[a]+" ")<0&&(o+=t[a]+" ");i.className=K.trim(o)}else i.className=e;return this},removeClass:function(e){var n,r,i,o,a,s,l;if(K.isFunction(e))return this.each(function(t){K(this).removeClass(e.call(this,t,this.className))});if(e&&"string"==typeof e||e===t)for(n=(e||"").split(tt),s=0,l=this.length;l>s;s++)if(i=this[s],1===i.nodeType&&i.className){for(r=(" "+i.className+" ").replace(xt," "),o=0,a=n.length;a>o;o++)for(;r.indexOf(" "+n[o]+" ")>=0;)r=r.replace(" "+n[o]+" "," ");i.className=e?K.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e,r="boolean"==typeof t;return this.each(K.isFunction(e)?function(n){K(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var i,o=0,a=K(this),s=t,l=e.split(tt);i=l[o++];)s=r?s:!a.hasClass(i),a[s?"addClass":"removeClass"](i);else("undefined"===n||"boolean"===n)&&(this.className&&K._data(this,"__className__",this.className),this.className=this.className||e===!1?"":K._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(xt," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,o=this[0];{if(arguments.length)return i=K.isFunction(e),this.each(function(r){var o,a=K(this);1===this.nodeType&&(o=i?e.call(this,r,a.val()):e,null==o?o="":"number"==typeof o?o+="":K.isArray(o)&&(o=K.map(o,function(e){return null==e?"":e+""})),n=K.valHooks[this.type]||K.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,o,"value")!==t||(this.value=o))});if(o)return n=K.valHooks[o.type]||K.valHooks[o.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(o,"value"))!==t?r:(r=o.value,"string"==typeof r?r.replace(wt,""):null==r?"":r)}}}),K.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;s>l;l++)if(n=r[l],!(!n.selected&&l!==i||(K.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&K.nodeName(n.parentNode,"optgroup"))){if(t=K(n).val(),o)return t;a.push(t)}return a},set:function(e,t){var n=K.makeArray(t);return K(e).find("option").each(function(){this.selected=K.inArray(K(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var o,a,s,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return i&&K.isFunction(K.fn[n])?K(e)[n](r):"undefined"==typeof e.getAttribute?K.prop(e,n,r):(s=1!==l||!K.isXMLDoc(e),s&&(n=n.toLowerCase(),a=K.attrHooks[n]||(kt.test(n)?vt:yt)),r!==t?null===r?void K.removeAttr(e,n):a&&"set"in a&&s&&(o=a.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r):a&&"get"in a&&s&&null!==(o=a.get(e,n))?o:(o=e.getAttribute(n),null===o?t:o))},removeAttr:function(e,t){var n,r,i,o,a=0;if(t&&1===e.nodeType)for(r=t.split(tt);a<r.length;a++)i=r[a],i&&(n=K.propFix[i]||i,o=kt.test(i),o||K.attr(e,i,""),e.removeAttribute(Et?i:n),o&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(Tt.test(e.nodeName)&&e.parentNode)K.error("type property can't be changed");else if(!K.support.radioValue&&"radio"===t&&K.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return yt&&K.nodeName(e,"button")?yt.get(e,t):t in e?e.value:null},set:function(e,t,n){return yt&&K.nodeName(e,"button")?yt.set(e,t,n):void(e.value=t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,o,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return a=1!==s||!K.isXMLDoc(e),a&&(n=K.propFix[n]||n,o=K.propHooks[n]),r!==t?o&&"set"in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get"in o&&null!==(i=o.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):Nt.test(e.nodeName)||Ct.test(e.nodeName)&&e.href?0:t}}}}),vt={get:function(e,n){var r,i=K.prop(e,n);return i===!0||"boolean"!=typeof i&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?K.removeAttr(e,n):(r=K.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},Et||(bt={name:!0,id:!0,coords:!0},yt=K.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(bt[n]?""!==r.value:r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=R.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},K.each(["width","height"],function(e,t){K.attrHooks[t]=K.extend(K.attrHooks[t],{set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}})}),K.attrHooks.contenteditable={get:yt.get,set:function(e,t,n){""===t&&(t="false"),yt.set(e,t,n)}}),K.support.hrefNormalized||K.each(["href","src","width","height"],function(e,n){K.attrHooks[n]=K.extend(K.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return null===r?t:r}})}),K.support.style||(K.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),K.support.optSelected||(K.propHooks.selected=K.extend(K.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),K.support.enctype||(K.propFix.enctype="encoding"),K.support.checkOn||K.each(["radio","checkbox"],function(){K.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),K.each(["radio","checkbox"],function(){K.valHooks[this]=K.extend(K.valHooks[this],{set:function(e,t){return K.isArray(t)?e.checked=K.inArray(K(e).val(),t)>=0:void 0}})});var St=/^(?:textarea|input|select)$/i,At=/^([^\.]*|)(?:\.(.+)|)$/,jt=/(?:^|\s)hover(\.\S+|)\b/,Dt=/^key/,Lt=/^(?:mouse|contextmenu)|click/,Ht=/^(?:focusinfocus|focusoutblur)$/,Ft=function(e){return K.event.special.hover?e:e.replace(jt,"mouseenter$1 mouseleave$1")};K.event={add:function(e,n,r,i,o){var a,s,l,u,c,f,p,d,h,g,m;if(3!==e.nodeType&&8!==e.nodeType&&n&&r&&(a=K._data(e))){for(r.handler&&(h=r,r=h.handler,o=h.selector),r.guid||(r.guid=K.guid++),l=a.events,l||(a.events=l={}),s=a.handle,s||(a.handle=s=function(e){return"undefined"==typeof K||e&&K.event.triggered===e.type?t:K.event.dispatch.apply(s.elem,arguments)},s.elem=e),n=K.trim(Ft(n)).split(" "),u=0;u<n.length;u++)c=At.exec(n[u])||[],f=c[1],p=(c[2]||"").split(".").sort(),m=K.event.special[f]||{},f=(o?m.delegateType:m.bindType)||f,m=K.event.special[f]||{},d=K.extend({type:f,origType:c[1],data:i,handler:r,guid:r.guid,selector:o,needsContext:o&&K.expr.match.needsContext.test(o),namespace:p.join(".")},h),g=l[f],g||(g=l[f]=[],g.delegateCount=0,m.setup&&m.setup.call(e,i,p,s)!==!1||(e.addEventListener?e.addEventListener(f,s,!1):e.attachEvent&&e.attachEvent("on"+f,s))),m.add&&(m.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),o?g.splice(g.delegateCount++,0,d):g.push(d),K.event.global[f]=!0;e=null}},global:{},remove:function(e,t,n,r,i){var o,a,s,l,u,c,f,p,d,h,g,m=K.hasData(e)&&K._data(e);if(m&&(p=m.events)){for(t=K.trim(Ft(t||"")).split(" "),o=0;o<t.length;o++)if(a=At.exec(t[o])||[],s=l=a[1],u=a[2],s){for(d=K.event.special[s]||{},s=(r?d.delegateType:d.bindType)||s,h=p[s]||[],c=h.length,u=u?new RegExp("(^|\\.)"+u.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,f=0;f<h.length;f++)g=h[f],!i&&l!==g.origType||n&&n.guid!==g.guid||u&&!u.test(g.namespace)||r&&r!==g.selector&&("**"!==r||!g.selector)||(h.splice(f--,1),g.selector&&h.delegateCount--,d.remove&&d.remove.call(e,g));0===h.length&&c!==h.length&&(d.teardown&&d.teardown.call(e,u,m.handle)!==!1||K.removeEvent(e,s,m.handle),delete p[s])}else for(s in p)K.event.remove(e,s+t[o],n,r,!0);K.isEmptyObject(p)&&(delete m.handle,K.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,o){if(!i||3!==i.nodeType&&8!==i.nodeType){var a,s,l,u,c,f,p,d,h,g,m=n.type||n,y=[];if(!Ht.test(m+K.event.triggered)&&(m.indexOf("!")>=0&&(m=m.slice(0,-1),s=!0),m.indexOf(".")>=0&&(y=m.split("."),m=y.shift(),y.sort()),i&&!K.event.customEvent[m]||K.event.global[m]))if(n="object"==typeof n?n[K.expando]?n:new K.Event(m,n):new K.Event(m),n.type=m,n.isTrigger=!0,n.exclusive=s,n.namespace=y.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,f=m.indexOf(":")<0?"on"+m:"",i){if(n.result=t,n.target||(n.target=i),r=null!=r?K.makeArray(r):[],r.unshift(n),p=K.event.special[m]||{},!p.trigger||p.trigger.apply(i,r)!==!1){if(h=[[i,p.bindType||m]],!o&&!p.noBubble&&!K.isWindow(i)){for(g=p.delegateType||m,u=Ht.test(g+m)?i:i.parentNode,c=i;u;u=u.parentNode)h.push([u,g]),c=u;c===(i.ownerDocument||R)&&h.push([c.defaultView||c.parentWindow||e,g])}for(l=0;l<h.length&&!n.isPropagationStopped();l++)u=h[l][0],n.type=h[l][1],d=(K._data(u,"events")||{})[n.type]&&K._data(u,"handle"),d&&d.apply(u,r),d=f&&u[f],d&&K.acceptData(u)&&d.apply&&d.apply(u,r)===!1&&n.preventDefault();return n.type=m,o||n.isDefaultPrevented()||p._default&&p._default.apply(i.ownerDocument,r)!==!1||"click"===m&&K.nodeName(i,"a")||!K.acceptData(i)||f&&i[m]&&("focus"!==m&&"blur"!==m||0!==n.target.offsetWidth)&&!K.isWindow(i)&&(c=i[f],c&&(i[f]=null),K.event.triggered=m,i[m](),K.event.triggered=t,c&&(i[f]=c)),n.result}}else{a=K.cache;for(l in a)a[l].events&&a[l].events[m]&&K.event.trigger(n,r,a[l].handle.elem,!0)}}},dispatch:function(n){n=K.event.fix(n||e.event);var r,i,o,a,s,l,u,c,f,p=(K._data(this,"events")||{})[n.type]||[],d=p.delegateCount,h=Y.call(arguments),g=!n.exclusive&&!n.namespace,m=K.event.special[n.type]||{},y=[];if(h[0]=n,n.delegateTarget=this,!m.preDispatch||m.preDispatch.call(this,n)!==!1){if(d&&(!n.button||"click"!==n.type))for(o=n.target;o!=this;o=o.parentNode||this)if(o.disabled!==!0||"click"!==n.type){for(s={},u=[],r=0;d>r;r++)c=p[r],f=c.selector,s[f]===t&&(s[f]=c.needsContext?K(f,this).index(o)>=0:K.find(f,this,null,[o]).length),s[f]&&u.push(c);u.length&&y.push({elem:o,matches:u})}for(p.length>d&&y.push({elem:this,matches:p.slice(d)}),r=0;r<y.length&&!n.isPropagationStopped();r++)for(l=y[r],n.currentTarget=l.elem,i=0;i<l.matches.length&&!n.isImmediatePropagationStopped();i++)c=l.matches[i],(g||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))&&(n.data=c.data,n.handleObj=c,a=((K.event.special[c.origType]||{}).handle||c.handler).apply(l.elem,h),a!==t&&(n.result=a,a===!1&&(n.preventDefault(),n.stopPropagation())));return m.postDispatch&&m.postDispatch.call(this,n),n.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,a=n.button,s=n.fromElement;return null==e.pageX&&null!=n.clientX&&(r=e.target.ownerDocument||R,i=r.documentElement,o=r.body,e.pageX=n.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&s&&(e.relatedTarget=s===e.target?n.toElement:s),e.which||a===t||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e[K.expando])return e;var t,n,r=e,i=K.event.fixHooks[e.type]||{},o=i.props?this.props.concat(i.props):this.props;for(e=K.Event(r),t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||R),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,i.filter?i.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){K.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=K.extend(new K.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?K.event.trigger(i,null,t):K.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},K.event.handle=K.event.dispatch,K.removeEvent=R.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&("undefined"==typeof e[r]&&(e[r]=null),e.detachEvent(r,n))},K.Event=function(e,t){return this instanceof K.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?a:o):this.type=e,t&&K.extend(this,t),this.timeStamp=e&&e.timeStamp||K.now(),void(this[K.expando]=!0)):new K.Event(e,t)},K.Event.prototype={preventDefault:function(){this.isDefaultPrevented=a;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=a;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()},isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o},K.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){K.event.special[e]={delegateType:t,bindType:t,handle:function(e){{var n,r=this,i=e.relatedTarget,o=e.handleObj;o.selector}return(!i||i!==r&&!K.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),K.support.submitBubbles||(K.event.special.submit={setup:function(){return K.nodeName(this,"form")?!1:void K.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=K.nodeName(n,"input")||K.nodeName(n,"button")?n.form:t;r&&!K._data(r,"_submit_attached")&&(K.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),K._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&K.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return K.nodeName(this,"form")?!1:void K.event.remove(this,"._submit")}}),K.support.changeBubbles||(K.event.special.change={setup:function(){return St.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(K.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),K.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),K.event.simulate("change",this,e,!0)})),!1):void K.event.add(this,"beforeactivate._change",function(e){var t=e.target;St.test(t.nodeName)&&!K._data(t,"_change_attached")&&(K.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||K.event.simulate("change",this.parentNode,e,!0)}),K._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return K.event.remove(this,"._change"),!St.test(this.nodeName)}}),K.support.focusinBubbles||K.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){K.event.simulate(t,e.target,K.event.fix(e),!0)};K.event.special[t]={setup:function(){0===n++&&R.addEventListener(e,r,!0)},teardown:function(){0===--n&&R.removeEventListener(e,r,!0)}}}),K.fn.extend({on:function(e,n,r,i,a){var s,l;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(l in e)this.on(l,n,r,e[l],a);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=o;else if(!i)return this;return 1===a&&(s=i,i=function(e){return K().off(e),s.apply(this,arguments)},i.guid=s.guid||(s.guid=K.guid++)),this.each(function(){K.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,a;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,K(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(a in e)this.off(a,n,e[a]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=o),this.each(function(){K.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return K(this.context).on(e,this.selector,t,n),this},die:function(e,t){return K(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){K.event.trigger(e,t,this)})},triggerHandler:function(e,t){return this[0]?K.event.trigger(e,t,this[0],!0):void 0},toggle:function(e){var t=arguments,n=e.guid||K.guid++,r=0,i=function(n){var i=(K._data(this,"lastToggle"+e.guid)||0)%r;return K._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};for(i.guid=n;r<t.length;)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),K.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){K.fn[t]=function(e,n){return null==n&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Dt.test(t)&&(K.event.fixHooks[t]=K.event.keyHooks),Lt.test(t)&&(K.event.fixHooks[t]=K.event.mouseHooks)}),function(e,t){function n(e,t,n,r){n=n||[],t=t||L;var i,o,a,s,l=t.nodeType;if(!e||"string"!=typeof e)return n;if(1!==l&&9!==l)return[];if(a=w(t),!a&&!r&&(i=nt.exec(e)))if(s=i[1]){if(9===l){if(o=t.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&T(t,o)&&o.id===s)return n.push(o),n}else{if(i[2])return _.apply(n,q.call(t.getElementsByTagName(e),0)),n;if((s=i[3])&&pt&&t.getElementsByClassName)return _.apply(n,q.call(t.getElementsByClassName(s),0)),n}return g(e.replace(Q,"$1"),t,n,r,a)}function r(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function i(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function o(e){return W(function(t){return t=+t,W(function(n,r){for(var i,o=e([],n.length,t),a=o.length;a--;)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function a(e,t,n){if(e===t)return n;for(var r=e.nextSibling;r;){if(r===t)return-1;r=r.nextSibling}return 1}function s(e,t){var r,i,o,a,s,l,u,c=$[j][e+" "];if(c)return t?0:c.slice(0);for(s=e,l=[],u=b.preFilter;s;){(!r||(i=Z.exec(s)))&&(i&&(s=s.slice(i[0].length)||s),l.push(o=[])),r=!1,(i=et.exec(s))&&(o.push(r=new D(i.shift())),s=s.slice(r.length),r.type=i[0].replace(Q," "));for(a in b.filter)!(i=st[a].exec(s))||u[a]&&!(i=u[a](i))||(o.push(r=new D(i.shift())),s=s.slice(r.length),r.type=a,r.matches=i);if(!r)break}return t?s.length:s?n.error(e):$(e,l).slice(0)}function l(e,t,n){var r=t.dir,i=n&&"parentNode"===t.dir,o=M++;return t.first?function(t,n,o){for(;t=t[r];)if(i||1===t.nodeType)return e(t,n,o)}:function(t,n,a){if(a){for(;t=t[r];)if((i||1===t.nodeType)&&e(t,n,a))return t}else for(var s,l=F+" "+o+" ",u=l+y;t=t[r];)if(i||1===t.nodeType){if((s=t[j])===u)return t.sizset;if("string"==typeof s&&0===s.indexOf(l)){if(t.sizset)return t}else{if(t[j]=u,e(t,n,a))return t.sizset=!0,t;t.sizset=!1}}}}function u(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function c(e,t,n,r,i){for(var o,a=[],s=0,l=e.length,u=null!=t;l>s;s++)(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s));return a}function f(e,t,n,r,i,o){return r&&!r[j]&&(r=f(r)),i&&!i[j]&&(i=f(i,o)),W(function(o,a,s,l){var u,f,p,d=[],g=[],m=a.length,y=o||h(t||"*",s.nodeType?[s]:s,[]),v=!e||!o&&t?y:c(y,d,e,s,l),b=n?i||(o?e:m||r)?[]:a:v;if(n&&n(v,b,s,l),r)for(u=c(b,g),r(u,[],s,l),f=u.length;f--;)(p=u[f])&&(b[g[f]]=!(v[g[f]]=p));if(o){if(i||e){if(i){for(u=[],f=b.length;f--;)(p=b[f])&&u.push(v[f]=p);i(null,b=[],u,l)}for(f=b.length;f--;)(p=b[f])&&(u=i?B.call(o,p):d[f])>-1&&(o[u]=!(a[u]=p))}}else b=c(b===a?b.splice(m,b.length):b),i?i(null,a,b,l):_.apply(a,b)})}function p(e){for(var t,n,r,i=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,c=l(function(e){return e===t},a,!0),d=l(function(e){return B.call(t,e)>-1},a,!0),h=[function(e,n,r){return!o&&(r||n!==E)||((t=n).nodeType?c(e,n,r):d(e,n,r))}];i>s;s++)if(n=b.relative[e[s].type])h=[l(u(h),n)];else{if(n=b.filter[e[s].type].apply(null,e[s].matches),n[j]){for(r=++s;i>r&&!b.relative[e[r].type];r++);return f(s>1&&u(h),s>1&&e.slice(0,s-1).join("").replace(Q,"$1"),n,r>s&&p(e.slice(s,r)),i>r&&p(e=e.slice(r)),i>r&&e.join(""))}h.push(n)}return u(h)}function d(e,t){var r=t.length>0,i=e.length>0,o=function(a,s,l,u,f){var p,d,h,g=[],m=0,v="0",x=a&&[],w=null!=f,T=E,N=a||i&&b.find.TAG("*",f&&s.parentNode||s),C=F+=null==T?1:Math.E;for(w&&(E=s!==L&&s,y=o.el);null!=(p=N[v]);v++){if(i&&p){for(d=0;h=e[d];d++)if(h(p,s,l)){u.push(p);break}w&&(F=C,y=++o.el)}r&&((p=!h&&p)&&m--,a&&x.push(p))}if(m+=v,r&&v!==m){for(d=0;h=t[d];d++)h(x,g,s,l);if(a){if(m>0)for(;v--;)x[v]||g[v]||(g[v]=O.call(u));g=c(g)}_.apply(u,g),w&&!a&&g.length>0&&m+t.length>1&&n.uniqueSort(u)}return w&&(F=C,E=T),x};return o.el=0,r?W(o):o}function h(e,t,r){for(var i=0,o=t.length;o>i;i++)n(e,t[i],r);return r}function g(e,t,n,r,i){{var o,a,l,u,c,f=s(e);f.length}if(!r&&1===f.length){if(a=f[0]=f[0].slice(0),a.length>2&&"ID"===(l=a[0]).type&&9===t.nodeType&&!i&&b.relative[a[1].type]){if(t=b.find.ID(l.matches[0].replace(at,""),t,i)[0],!t)return n;e=e.slice(a.shift().length)}for(o=st.POS.test(e)?-1:a.length-1;o>=0&&(l=a[o],!b.relative[u=l.type]);o--)if((c=b.find[u])&&(r=c(l.matches[0].replace(at,""),rt.test(a[0].type)&&t.parentNode||t,i))){if(a.splice(o,1),e=r.length&&a.join(""),!e)return _.apply(n,q.call(r,0)),n;break}}return N(e,f)(r,t,i,n,rt.test(e)),n}function m(){}var y,v,b,x,w,T,N,C,k,E,S=!0,A="undefined",j=("sizcache"+Math.random()).replace(".",""),D=String,L=e.document,H=L.documentElement,F=0,M=0,O=[].pop,_=[].push,q=[].slice,B=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},W=function(e,t){return e[j]=null==t||t,e},P=function(){var e={},t=[];return W(function(n,r){return t.push(n)>b.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},R=P(),$=P(),I=P(),z="[\\x20\\t\\r\\n\\f]",X="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",U=X.replace("w","w#"),Y="([*^$|!~]?=)",V="\\["+z+"*("+X+")"+z+"*(?:"+Y+z+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+U+")|)|)"+z+"*\\]",J=":("+X+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+V+")|[^:]|\\\\.)*|.*))\\)|)",G=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+z+"*((?:-\\d)?\\d*)"+z+"*\\)|)(?=[^-]|$)",Q=new RegExp("^"+z+"+|((?:^|[^\\\\])(?:\\\\.)*)"+z+"+$","g"),Z=new RegExp("^"+z+"*,"+z+"*"),et=new RegExp("^"+z+"*([\\x20\\t\\r\\n\\f>+~])"+z+"*"),tt=new RegExp(J),nt=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,rt=/[\x20\t\r\n\f]*[+~]/,it=/h\d/i,ot=/input|select|textarea|button/i,at=/\\(?!\\)/g,st={ID:new RegExp("^#("+X+")"),CLASS:new RegExp("^\\.("+X+")"),NAME:new RegExp("^\\[name=['\"]?("+X+")['\"]?\\]"),TAG:new RegExp("^("+X.replace("w","w*")+")"),ATTR:new RegExp("^"+V),PSEUDO:new RegExp("^"+J),POS:new RegExp(G,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+z+"*(even|odd|(([+-]|)(\\d*)n|)"+z+"*(?:([+-]|)"+z+"*(\\d+)|))"+z+"*\\)|)","i"),needsContext:new RegExp("^"+z+"*[>+~]|"+G,"i")},lt=function(e){var t=L.createElement("div");try{return e(t)}catch(e){return!1}finally{t=null}},ut=lt(function(e){return e.appendChild(L.createComment("")),!e.getElementsByTagName("*").length}),ct=lt(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==A&&"#"===e.firstChild.getAttribute("href")}),ft=lt(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),pt=lt(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),dt=lt(function(e){e.id=j+0,e.innerHTML="<a name='"+j+"'></a><div name='"+j+"'></div>",H.insertBefore(e,H.firstChild);var t=L.getElementsByName&&L.getElementsByName(j).length===2+L.getElementsByName(j+0).length;return v=!L.getElementById(j),H.removeChild(e),t});try{q.call(H.childNodes,0)[0].nodeType}catch(e){q=function(e){for(var t,n=[];t=this[e];e++)n.push(t);return n}}n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){return n(t,null,null,[e]).length>0},x=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=x(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=x(t);return n},w=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},T=n.contains=H.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&1===r.nodeType&&n.contains&&n.contains(r))}:H.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},n.attr=function(e,t){var n,r=w(e);return r||(t=t.toLowerCase()),(n=b.attrHandle[t])?n(e):r||ft?e.getAttribute(t):(n=e.getAttributeNode(t),n?"boolean"==typeof e[t]?e[t]?t:null:n.specified?n.value:null:null)},b=n.selectors={cacheLength:50,createPseudo:W,match:st,attrHandle:ct?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:v?function(e,t,n){if(typeof t.getElementById!==A&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==A&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==A&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:ut?function(e,t){return typeof t.getElementsByTagName!==A?t.getElementsByTagName(e):void 0}:function(e,t){var n=t.getElementsByTagName(e);if("*"===e){for(var r,i=[],o=0;r=n[o];o++)1===r.nodeType&&i.push(r);return i}return n},NAME:dt&&function(e,t){return typeof t.getElementsByName!==A?t.getElementsByName(name):void 0},CLASS:pt&&function(e,t,n){return typeof t.getElementsByClassName===A||n?void 0:t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(at,""),e[3]=(e[4]||e[5]||"").replace(at,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||n.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&n.error(e[0]),e},PSEUDO:function(e){var t,n;return st.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(t=e[4])&&(tt.test(t)&&(n=s(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t),e.slice(0,3))}},filter:{ID:v?function(e){return e=e.replace(at,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(at,""),function(t){var n=typeof t.getAttributeNode!==A&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(at,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=R[j][e+" "];return t||(t=new RegExp("(^|"+z+")"+e+"("+z+"|$)"))&&R(e,function(e){return t.test(e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(i){var o=n.attr(i,e);return null==o?"!="===t:t?(o+="","="===t?o===r:"!="===t?o!==r:"^="===t?r&&0===o.indexOf(r):"*="===t?r&&o.indexOf(r)>-1:"$="===t?r&&o.substr(o.length-r.length)===r:"~="===t?(" "+o+" ").indexOf(r)>-1:"|="===t?o===r||o.substr(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r){return"nth"===e?function(e){var t,i,o=e.parentNode;if(1===n&&0===r)return!0;if(o)for(i=0,t=o.firstChild;t&&(1!==t.nodeType||(i++,e!==t));t=t.nextSibling);return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":for(;n=n.previousSibling;)if(1===n.nodeType)return!1;if("first"===e)return!0;n=t;case"last":for(;n=n.nextSibling;)if(1===n.nodeType)return!1;return!0}}},PSEUDO:function(e,t){var r,i=b.pseudos[e]||b.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return i[j]?i(t):i.length>1?(r=[e,e,"",t],b.setFilters.hasOwnProperty(e.toLowerCase())?W(function(e,n){for(var r,o=i(e,t),a=o.length;a--;)r=B.call(e,o[a]),e[r]=!(n[r]=o[a])}):function(e){return i(e,0,r)}):i}},pseudos:{not:W(function(e){var t=[],n=[],r=N(e.replace(Q,"$1"));return r[j]?W(function(e,t,n,i){for(var o,a=r(e,null,i,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()}}),has:W(function(e){return function(t){return n(e,t).length>0}}),contains:W(function(e){return function(t){return(t.textContent||t.innerText||x(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!b.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if(e.nodeName>"@"||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},header:function(e){return it.test(e.nodeName)},text:function(e){var t,n;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(n=e.getAttribute("type"))||n.toLowerCase()===t)},radio:r("radio"),checkbox:r("checkbox"),file:r("file"),password:r("password"),image:r("image"),submit:i("submit"),reset:i("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return ot.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:o(function(){return[0]}),last:o(function(e,t){return[t-1]}),eq:o(function(e,t,n){return[0>n?n+t:n]}),even:o(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:o(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:o(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:o(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},C=H.compareDocumentPosition?function(e,t){return e===t?(k=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return k=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],o=[],s=e.parentNode,l=t.parentNode,u=s;if(s===l)return a(e,t);if(!s)return-1;if(!l)return 1;for(;u;)i.unshift(u),u=u.parentNode;for(u=l;u;)o.unshift(u),u=u.parentNode;n=i.length,r=o.length;for(var c=0;n>c&&r>c;c++)if(i[c]!==o[c])return a(i[c],o[c]);return c===n?a(e,o[c],-1):a(i[c],t,1)},[0,0].sort(C),S=!k,n.uniqueSort=function(e){var t,n=[],r=1,i=0;if(k=S,e.sort(C),k){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return e},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},N=n.compile=function(e,t){var n,r=[],i=[],o=I[j][e+" "];if(!o){for(t||(t=s(e)),n=t.length;n--;)o=p(t[n]),o[j]?r.push(o):i.push(o);o=I(e,d(i,r))}return o},L.querySelectorAll&&!function(){var e,t=g,r=/'|\\/g,i=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,o=[":focus"],a=[":active"],l=H.matchesSelector||H.mozMatchesSelector||H.webkitMatchesSelector||H.oMatchesSelector||H.msMatchesSelector;lt(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||o.push("\\["+z+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||o.push(":checked")}),lt(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&o.push("[*^$]="+z+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||o.push(":enabled",":disabled")}),o=new RegExp(o.join("|")),g=function(e,n,i,a,l){if(!a&&!l&&!o.test(e)){var u,c,f=!0,p=j,d=n,h=9===n.nodeType&&e;if(1===n.nodeType&&"object"!==n.nodeName.toLowerCase()){for(u=s(e),(f=n.getAttribute("id"))?p=f.replace(r,"\\$&"):n.setAttribute("id",p),p="[id='"+p+"'] ",c=u.length;c--;)u[c]=p+u[c].join("");d=rt.test(e)&&n.parentNode||n,h=u.join(",")}if(h)try{return _.apply(i,q.call(d.querySelectorAll(h),0)),i}catch(e){}finally{f||n.removeAttribute("id")}}return t(e,n,i,a,l)},l&&(lt(function(t){e=l.call(t,"div");try{l.call(t,"[test!='']:sizzle"),a.push("!=",J)}catch(e){}}),a=new RegExp(a.join("|")),n.matchesSelector=function(t,r){if(r=r.replace(i,"='$1']"),!w(t)&&!a.test(r)&&!o.test(r))try{var s=l.call(t,r);if(s||e||t.document&&11!==t.document.nodeType)return s}catch(e){}return n(r,null,null,[t]).length>0})}(),b.pseudos.nth=b.pseudos.eq,b.filters=m.prototype=b.pseudos,b.setFilters=new m,n.attr=K.attr,K.find=n,K.expr=n.selectors,K.expr[":"]=K.expr.pseudos,K.unique=n.uniqueSort,K.text=n.getText,K.isXMLDoc=n.isXML,K.contains=n.contains}(e);var Mt=/Until$/,Ot=/^(?:parents|prev(?:Until|All))/,_t=/^.[^:#\[\.,]*$/,qt=K.expr.match.needsContext,Bt={children:!0,contents:!0,next:!0,prev:!0};K.fn.extend({find:function(e){var t,n,r,i,o,a,s=this;if("string"!=typeof e)return K(e).filter(function(){for(t=0,n=s.length;n>t;t++)if(K.contains(s[t],this))return!0});for(a=this.pushStack("","find",e),t=0,n=this.length;n>t;t++)if(r=a.length,K.find(e,this[t],a),t>0)for(i=r;i<a.length;i++)for(o=0;r>o;o++)if(a[o]===a[i]){a.splice(i--,1);break}return a},has:function(e){var t,n=K(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(K.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(u(this,e,!1),"not",e)},filter:function(e){return this.pushStack(u(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"==typeof e?qt.test(e)?K(e,this.context).index(this[0])>=0:K.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var n,r=0,i=this.length,o=[],a=qt.test(e)||"string"!=typeof e?K(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n.ownerDocument&&n!==t&&11!==n.nodeType;){if(a?a.index(n)>-1:K.find.matchesSelector(n,e)){o.push(n);break}n=n.parentNode}return o=o.length>1?K.unique(o):o,this.pushStack(o,"closest",e)},index:function(e){return e?"string"==typeof e?K.inArray(this[0],K(e)):K.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"==typeof e?K(e,t):K.makeArray(e&&e.nodeType?[e]:e),r=K.merge(this.get(),n);return this.pushStack(s(n[0])||s(r[0])?r:K.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),K.fn.andSelf=K.fn.addBack,K.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return K.dir(e,"parentNode")},parentsUntil:function(e,t,n){return K.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return K.dir(e,"nextSibling")},prevAll:function(e){return K.dir(e,"previousSibling")},nextUntil:function(e,t,n){return K.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return K.dir(e,"previousSibling",n)},siblings:function(e){return K.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return K.sibling(e.firstChild)},contents:function(e){return K.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:K.merge([],e.childNodes)}},function(e,t){K.fn[e]=function(n,r){var i=K.map(this,t,n);return Mt.test(e)||(r=n),r&&"string"==typeof r&&(i=K.filter(r,i)),i=this.length>1&&!Bt[e]?K.unique(i):i,this.length>1&&Ot.test(e)&&(i=i.reverse()),this.pushStack(i,e,Y.call(arguments).join(","))}}),K.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?K.find.matchesSelector(t[0],e)?[t[0]]:[]:K.find.matches(e,t)},dir:function(e,n,r){for(var i=[],o=e[n];o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!K(o).is(r));)1===o.nodeType&&i.push(o),o=o[n];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Wt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Pt=/ jQuery\d+="(?:null|\d+)"/g,Rt=/^\s+/,$t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,It=/<([\w:]+)/,zt=/<tbody/i,Xt=/<|&#?\w+;/,Ut=/<(?:script|style|link)/i,Yt=/<(?:script|object|embed|option|style)/i,Vt=new RegExp("<(?:"+Wt+")[\\s/>]","i"),Jt=/^(?:checkbox|radio)$/,Gt=/checked\s*(?:[^=]|=\s*.checked.)/i,Qt=/\/(java|ecma)script/i,Kt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},en=c(R),tn=en.appendChild(R.createElement("div"));Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,K.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),K.fn.extend({text:function(e){return K.access(this,function(e){return e===t?K.text(this):this.empty().append((this[0]&&this[0].ownerDocument||R).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(K.isFunction(e))return this.each(function(t){K(this).wrapAll(e.call(this,t))});if(this[0]){var t=K(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return this.each(K.isFunction(e)?function(t){K(this).wrapInner(e.call(this,t))}:function(){var t=K(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=K.isFunction(e);return this.each(function(n){K(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){K.nodeName(this,"body")||K(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!s(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=K.clean(arguments);return this.pushStack(K.merge(e,this),"before",this.selector)}},after:function(){if(!s(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=K.clean(arguments);return this.pushStack(K.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var n,r=0;null!=(n=this[r]);r++)(!e||K.filter(e,[n]).length)&&(t||1!==n.nodeType||(K.cleanData(n.getElementsByTagName("*")),K.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&K.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return K.clone(this,e,t)})},html:function(e){return K.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(Pt,""):t;if(!("string"!=typeof e||Ut.test(e)||!K.support.htmlSerialize&&Vt.test(e)||!K.support.leadingWhitespace&&Rt.test(e)||Zt[(It.exec(e)||["",""])[1].toLowerCase()])){e=e.replace($t,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(K.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(e){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return s(this[0])?this.length?this.pushStack(K(K.isFunction(e)?e():e),"replaceWith",e):this:K.isFunction(e)?this.each(function(t){var n=K(this),r=n.html();n.replaceWith(e.call(this,t,r))}):("string"!=typeof e&&(e=K(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;K(this).remove(),t?K(t).before(e):K(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,o,a,s,l=0,u=e[0],c=[],p=this.length;if(!K.support.checkClone&&p>1&&"string"==typeof u&&Gt.test(u))return this.each(function(){K(this).domManip(e,n,r)});if(K.isFunction(u))return this.each(function(i){var o=K(this);e[0]=u.call(this,i,n?o.html():t),o.domManip(e,n,r)});if(this[0]){if(i=K.buildFragment(e,this,c),a=i.fragment,o=a.firstChild,1===a.childNodes.length&&(a=o),o)for(n=n&&K.nodeName(o,"tr"),s=i.cacheable||p-1;p>l;l++)r.call(n&&K.nodeName(this[l],"table")?f(this[l],"tbody"):this[l],l===s?a:K.clone(a,!0,!0));a=o=null,c.length&&K.each(c,function(e,t){t.src?K.ajax?K.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):K.error("no ajax"):K.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Kt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),K.buildFragment=function(e,n,r){var i,o,a,s=e[0];return n=n||R,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,!(1===e.length&&"string"==typeof s&&s.length<512&&n===R&&"<"===s.charAt(0))||Yt.test(s)||!K.support.checkClone&&Gt.test(s)||!K.support.html5Clone&&Vt.test(s)||(o=!0,i=K.fragments[s],a=i!==t),i||(i=n.createDocumentFragment(),K.clean(e,n,i,r),o&&(K.fragments[s]=a&&i)),{fragment:i,cacheable:o}},K.fragments={},K.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){K.fn[e]=function(n){var r,i=0,o=[],a=K(n),s=a.length,l=1===this.length&&this[0].parentNode;if((null==l||l&&11===l.nodeType&&1===l.childNodes.length)&&1===s)return a[t](this[0]),this;for(;s>i;i++)r=(i>0?this.clone(!0):this).get(),K(a[i])[t](r),o=o.concat(r);return this.pushStack(o,e,a.selector)}}),K.extend({clone:function(e,t,n){var r,i,o,a;if(K.support.html5Clone||K.isXMLDoc(e)||!Vt.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(tn.innerHTML=e.outerHTML,tn.removeChild(a=tn.firstChild)),!(K.support.noCloneEvent&&K.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||K.isXMLDoc(e)))for(d(e,a),r=h(e),i=h(a),o=0;r[o];++o)i[o]&&d(r[o],i[o]);if(t&&(p(e,a),n))for(r=h(e),i=h(a),o=0;r[o];++o)p(r[o],i[o]);return r=i=null,a},clean:function(e,t,n,r){var i,o,a,s,l,u,f,p,d,h,m,y=t===R&&en,v=[];for(t&&"undefined"!=typeof t.createDocumentFragment||(t=R),i=0;null!=(a=e[i]);i++)if("number"==typeof a&&(a+=""),a){if("string"==typeof a)if(Xt.test(a)){for(y=y||c(t),f=t.createElement("div"),y.appendChild(f),a=a.replace($t,"<$1></$2>"),s=(It.exec(a)||["",""])[1].toLowerCase(),l=Zt[s]||Zt._default,u=l[0],f.innerHTML=l[1]+a+l[2];u--;)f=f.lastChild;if(!K.support.tbody)for(p=zt.test(a),d="table"!==s||p?"<table>"!==l[1]||p?[]:f.childNodes:f.firstChild&&f.firstChild.childNodes,o=d.length-1;o>=0;--o)K.nodeName(d[o],"tbody")&&!d[o].childNodes.length&&d[o].parentNode.removeChild(d[o]);!K.support.leadingWhitespace&&Rt.test(a)&&f.insertBefore(t.createTextNode(Rt.exec(a)[0]),f.firstChild),a=f.childNodes,f.parentNode.removeChild(f)}else a=t.createTextNode(a);a.nodeType?v.push(a):K.merge(v,a)}if(f&&(a=f=y=null),!K.support.appendChecked)for(i=0;null!=(a=v[i]);i++)K.nodeName(a,"input")?g(a):"undefined"!=typeof a.getElementsByTagName&&K.grep(a.getElementsByTagName("input"),g);if(n)for(h=function(e){return!e.type||Qt.test(e.type)?r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e):void 0},i=0;null!=(a=v[i]);i++)K.nodeName(a,"script")&&h(a)||(n.appendChild(a),"undefined"!=typeof a.getElementsByTagName&&(m=K.grep(K.merge([],a.getElementsByTagName("script")),h),v.splice.apply(v,[i+1,0].concat(m)),i+=m.length));return v},cleanData:function(e,t){for(var n,r,i,o,a=0,s=K.expando,l=K.cache,u=K.support.deleteExpando,c=K.event.special;null!=(i=e[a]);a++)if((t||K.acceptData(i))&&(r=i[s],n=r&&l[r])){if(n.events)for(o in n.events)c[o]?K.event.remove(i,o):K.removeEvent(i,o,n.handle);l[r]&&(delete l[r],u?delete i[s]:i.removeAttribute?i.removeAttribute(s):i[s]=null,K.deletedIds.push(r))}}}),function(){var e,t;K.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=K.uaMatch(I.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),K.browser=t,K.sub=function(){function e(t,n){return new e.fn.init(t,n)}K.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(n,r){return r&&r instanceof K&&!(r instanceof e)&&(r=e(r)),K.fn.init.call(this,n,r,t)},e.fn.init.prototype=e.fn;var t=e(R);return e}}();var nn,rn,on,an=/alpha\([^)]*\)/i,sn=/opacity=([^)]*)/,ln=/^(top|right|bottom|left)$/,un=/^(none|table(?!-c[ea]).+)/,cn=/^margin/,fn=new RegExp("^("+Z+")(.*)$","i"),pn=new RegExp("^("+Z+")(?!px)[a-z%]+$","i"),dn=new RegExp("^([-+])=("+Z+")","i"),hn={BODY:"block"},gn={position:"absolute",visibility:"hidden",display:"block"},mn={letterSpacing:0,fontWeight:400},yn=["Top","Right","Bottom","Left"],vn=["Webkit","O","Moz","ms"],bn=K.fn.toggle;K.fn.extend({css:function(e,n){return K.access(this,function(e,n,r){return r!==t?K.style(e,n,r):K.css(e,n)},e,n,arguments.length>1)},show:function(){return v(this,!0)},hide:function(){return v(this)},toggle:function(e,t){var n="boolean"==typeof e;return K.isFunction(e)&&K.isFunction(t)?bn.apply(this,arguments):this.each(function(){(n?e:y(this))?K(this).show():K(this).hide()})}}),K.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return""===n?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:K.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=K.camelCase(n),u=e.style;if(n=K.cssProps[l]||(K.cssProps[l]=m(u,l)),s=K.cssHooks[n]||K.cssHooks[l],r===t)return s&&"get"in s&&(o=s.get(e,!1,i))!==t?o:u[n];if(a=typeof r,"string"===a&&(o=dn.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(K.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||K.cssNumber[l]||(r+="px"),s&&"set"in s&&(r=s.set(e,r,i))===t)))try{u[n]=r}catch(e){}}},css:function(e,n,r,i){var o,a,s,l=K.camelCase(n);return n=K.cssProps[l]||(K.cssProps[l]=m(e.style,l)),s=K.cssHooks[n]||K.cssHooks[l],s&&"get"in s&&(o=s.get(e,!0,i)),o===t&&(o=nn(e,n)),"normal"===o&&n in mn&&(o=mn[n]),r||i!==t?(a=parseFloat(o),r||K.isNumeric(a)?a||0:o):o},swap:function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=o[i];return r}}),e.getComputedStyle?nn=function(t,n){var r,i,o,a,s=e.getComputedStyle(t,null),l=t.style;return s&&(r=s.getPropertyValue(n)||s[n],""!==r||K.contains(t.ownerDocument,t)||(r=K.style(t,n)),pn.test(r)&&cn.test(n)&&(i=l.width,o=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=r,r=s.width,l.width=i,l.minWidth=o,l.maxWidth=a)),r}:R.documentElement.currentStyle&&(nn=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],o=e.style;return null==i&&o&&o[t]&&(i=o[t]),pn.test(i)&&!ln.test(t)&&(n=o.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),o.left="fontSize"===t?"1em":i,i=o.pixelLeft+"px",o.left=n,r&&(e.runtimeStyle.left=r)),""===i?"auto":i}),K.each(["height","width"],function(e,t){K.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&un.test(nn(e,"display"))?K.swap(e,gn,function(){return w(e,t,r)}):w(e,t,r):void 0},set:function(e,n,r){return b(e,n,r?x(e,t,r,K.support.boxSizing&&"border-box"===K.css(e,"boxSizing")):0)}}}),K.support.opacity||(K.cssHooks.opacity={get:function(e,t){return sn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=K.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,t>=1&&""===K.trim(o.replace(an,""))&&n.removeAttribute&&(n.removeAttribute("filter"),r&&!r.filter)||(n.filter=an.test(o)?o.replace(an,i):o+" "+i)}}),K(function(){K.support.reliableMarginRight||(K.cssHooks.marginRight={get:function(e,t){return K.swap(e,{display:"inline-block"},function(){return t?nn(e,"marginRight"):void 0})}}),!K.support.pixelPosition&&K.fn.position&&K.each(["top","left"],function(e,t){K.cssHooks[t]={get:function(e,n){if(n){var r=nn(e,t);return pn.test(r)?K(e).position()[t]+"px":r}}}})}),K.expr&&K.expr.filters&&(K.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!K.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||nn(e,"display"))},K.expr.filters.visible=function(e){return!K.expr.filters.hidden(e)}),K.each({margin:"",padding:"",border:"Width"},function(e,t){K.cssHooks[e+t]={expand:function(n){var r,i="string"==typeof n?n.split(" "):[n],o={};for(r=0;4>r;r++)o[e+yn[r]+t]=i[r]||i[r-2]||i[0];return o}},cn.test(e)||(K.cssHooks[e+t].set=b)});var xn=/%20/g,wn=/\[\]$/,Tn=/\r?\n/g,Nn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Cn=/^(?:select|textarea)/i;K.fn.extend({serialize:function(){return K.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?K.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Cn.test(this.nodeName)||Nn.test(this.type))}).map(function(e,t){var n=K(this).val();return null==n?null:K.isArray(n)?K.map(n,function(e){return{name:t.name,value:e.replace(Tn,"\r\n")}}):{name:t.name,value:n.replace(Tn,"\r\n")}}).get()}}),K.param=function(e,n){var r,i=[],o=function(e,t){t=K.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=K.ajaxSettings&&K.ajaxSettings.traditional),K.isArray(e)||e.jquery&&!K.isPlainObject(e))K.each(e,function(){o(this.name,this.value)});else for(r in e)N(r,e[r],n,o);return i.join("&").replace(xn,"+")};var kn,En,Sn=/#.*$/,An=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,jn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Dn=/^(?:GET|HEAD)$/,Ln=/^\/\//,Hn=/\?/,Fn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Mn=/([?&])_=[^&]*/,On=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_n=K.fn.load,qn={},Bn={},Wn=["*/"]+["*"];try{En=$.href}catch(e){En=R.createElement("a"),En.href="",En=En.href}kn=On.exec(En.toLowerCase())||[],K.fn.load=function(e,n,r){if("string"!=typeof e&&_n)return _n.apply(this,arguments);if(!this.length)return this;var i,o,a,s=this,l=e.indexOf(" ");return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),K.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),K.ajax({url:e,type:o,dataType:"html",data:n,complete:function(e,t){r&&s.each(r,a||[e.responseText,t,e])}}).done(function(e){a=arguments,s.html(i?K("<div>").append(e.replace(Fn,"")).find(i):e)}),this},K.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){K.fn[t]=function(e){return this.on(t,e)}}),K.each(["get","post"],function(e,n){K[n]=function(e,r,i,o){return K.isFunction(r)&&(o=o||i,i=r,r=t),K.ajax({type:n,url:e,data:r,success:i,dataType:o})}}),K.extend({getScript:function(e,n){return K.get(e,t,n,"script")},getJSON:function(e,t,n){return K.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?E(e,K.ajaxSettings):(t=e,e=K.ajaxSettings),E(e,t),e},ajaxSettings:{url:En,isLocal:jn.test(kn[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Wn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":K.parseJSON,"text xml":K.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:C(qn),ajaxTransport:C(Bn),ajax:function(e,n){function r(e,n,r,a){var u,f,v,b,w,N=n;2!==x&&(x=2,l&&clearTimeout(l),s=t,o=a||"",T.readyState=e>0?4:0,r&&(b=S(p,T,r)),e>=200&&300>e||304===e?(p.ifModified&&(w=T.getResponseHeader("Last-Modified"),w&&(K.lastModified[i]=w),w=T.getResponseHeader("Etag"),w&&(K.etag[i]=w)),304===e?(N="notmodified",u=!0):(u=A(p,b),N=u.state,f=u.data,v=u.error,u=!v)):(v=N,(!N||e)&&(N="error",0>e&&(e=0))),T.status=e,T.statusText=(n||N)+"",u?g.resolveWith(d,[f,N,T]):g.rejectWith(d,[T,N,v]),T.statusCode(y),y=t,c&&h.trigger("ajax"+(u?"Success":"Error"),[T,p,u?f:v]),m.fireWith(d,[T,N]),c&&(h.trigger("ajaxComplete",[T,p]),--K.active||K.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var i,o,a,s,l,u,c,f,p=K.ajaxSetup({},n),d=p.context||p,h=d!==p&&(d.nodeType||d instanceof K)?K(d):K.event,g=K.Deferred(),m=K.Callbacks("once memory"),y=p.statusCode||{},v={},b={},x=0,w="canceled",T={readyState:0,setRequestHeader:function(e,t){if(!x){var n=e.toLowerCase();e=b[n]=b[n]||e,v[e]=t}return this},getAllResponseHeaders:function(){return 2===x?o:null},getResponseHeader:function(e){var n;if(2===x){if(!a)for(a={};n=An.exec(o);)a[n[1].toLowerCase()]=n[2];n=a[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return x||(p.mimeType=e),this},abort:function(e){return e=e||w,s&&s.abort(e),r(0,e),this}};if(g.promise(T),T.success=T.done,T.error=T.fail,T.complete=m.add,T.statusCode=function(e){if(e){var t;if(2>x)for(t in e)y[t]=[y[t],e[t]];else t=e[T.status],T.always(t)}return this},p.url=((e||p.url)+"").replace(Sn,"").replace(Ln,kn[1]+"//"),p.dataTypes=K.trim(p.dataType||"*").toLowerCase().split(tt),null==p.crossDomain&&(u=On.exec(p.url.toLowerCase()),p.crossDomain=!(!u||u[1]===kn[1]&&u[2]===kn[2]&&(u[3]||("http:"===u[1]?80:443))==(kn[3]||("http:"===kn[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=K.param(p.data,p.traditional)),k(qn,p,n,T),2===x)return T;if(c=p.global,p.type=p.type.toUpperCase(),p.hasContent=!Dn.test(p.type),c&&0===K.active++&&K.event.trigger("ajaxStart"),!p.hasContent&&(p.data&&(p.url+=(Hn.test(p.url)?"&":"?")+p.data,delete p.data),i=p.url,p.cache===!1)){var N=K.now(),C=p.url.replace(Mn,"$1_="+N);p.url=C+(C===p.url?(Hn.test(p.url)?"&":"?")+"_="+N:"")}(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&T.setRequestHeader("Content-Type",p.contentType),p.ifModified&&(i=i||p.url,K.lastModified[i]&&T.setRequestHeader("If-Modified-Since",K.lastModified[i]),K.etag[i]&&T.setRequestHeader("If-None-Match",K.etag[i])),T.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Wn+"; q=0.01":""):p.accepts["*"]);for(f in p.headers)T.setRequestHeader(f,p.headers[f]);if(p.beforeSend&&(p.beforeSend.call(d,T,p)===!1||2===x))return T.abort();w="abort";for(f in{success:1,error:1,complete:1})T[f](p[f]);if(s=k(Bn,p,n,T)){T.readyState=1,c&&h.trigger("ajaxSend",[T,p]),p.async&&p.timeout>0&&(l=setTimeout(function(){T.abort("timeout")},p.timeout));try{x=1,s.send(v,r)}catch(e){if(!(2>x))throw e;r(-1,e)}}else r(-1,"No Transport");return T},active:0,lastModified:{},etag:{}});var Pn=[],Rn=/\?/,$n=/(=)\?(?=&|$)|\?\?/,In=K.now();K.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Pn.pop()||K.expando+"_"+In++;return this[e]=!0,e}}),K.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.data,u=n.url,c=n.jsonp!==!1,f=c&&$n.test(u),p=c&&!f&&"string"==typeof l&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&$n.test(l);return"jsonp"===n.dataTypes[0]||f||p?(o=n.jsonpCallback=K.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a=e[o],f?n.url=u.replace($n,"$1"+o):p?n.data=l.replace($n,"$1"+o):c&&(n.url+=(Rn.test(u)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||K.error(o+" was not called"),s[0]},n.dataTypes[0]="json",e[o]=function(){s=arguments},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Pn.push(o)),s&&K.isFunction(a)&&a(s[0]),s=a=t}),"script"):void 0}),K.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return K.globalEval(e),e}}}),K.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),K.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=R.head||R.getElementsByTagName("head")[0]||R.documentElement;return{send:function(i,o){n=R.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var zn,Xn=e.ActiveXObject?function(){for(var e in zn)zn[e](0,1)}:!1,Un=0;K.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&j()||D()}:j,function(e){K.extend(K.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(K.ajaxSettings.xhr()),K.support.ajax&&K.ajaxTransport(function(n){if(!n.crossDomain||K.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(e){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,f,p;try{if(r&&(i||4===l.readyState))if(r=t,a&&(l.onreadystatechange=K.noop,Xn&&delete zn[a]),i)4!==l.readyState&&l.abort();else{s=l.status,c=l.getAllResponseHeaders(),f={},p=l.responseXML,p&&p.documentElement&&(f.xml=p);try{f.text=l.responseText}catch(e){}try{u=l.statusText}catch(e){u=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=f.text?200:404}}catch(e){i||o(-1,e)}f&&o(s,u,f,c)},n.async?4===l.readyState?setTimeout(r,0):(a=++Un,Xn&&(zn||(zn={},K(e).unload(Xn)),zn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var Yn,Vn,Jn=/^(?:toggle|show|hide)$/,Gn=new RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Qn=/queueHooks$/,Kn=[O],Zn={"*":[function(e,t){var n,r,i=this.createTween(e,t),o=Gn.exec(t),a=i.cur(),s=+a||0,l=1,u=20;if(o){if(n=+o[2],r=o[3]||(K.cssNumber[e]?"":"px"),"px"!==r&&s){s=K.css(i.elem,e,!0)||n||1;do l=l||".5",s/=l,K.style(i.elem,e,s+r);while(l!==(l=i.cur()/a)&&1!==l&&--u)}i.unit=r,i.start=s,i.end=o[1]?s+(o[1]+1)*n:n}return i}]};K.Animation=K.extend(F,{tweener:function(e,t){K.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],Zn[n]=Zn[n]||[],Zn[n].unshift(t)},prefilter:function(e,t){t?Kn.unshift(e):Kn.push(e)}}),K.Tween=_,_.prototype={constructor:_,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(K.cssNumber[n]?"":"px")},cur:function(){var e=_.propHooks[this.prop];return e&&e.get?e.get(this):_.propHooks._default.get(this)},run:function(e){var t,n=_.propHooks[this.prop];return this.pos=t=this.options.duration?K.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):_.propHooks._default.set(this),this}},_.prototype.init.prototype=_.prototype,_.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=K.css(e.elem,e.prop,!1,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){K.fx.step[e.prop]?K.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[K.cssProps[e.prop]]||K.cssHooks[e.prop])?K.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},_.propHooks.scrollTop=_.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},K.each(["toggle","show","hide"],function(e,t){var n=K.fn[t];K.fn[t]=function(r,i,o){return null==r||"boolean"==typeof r||!e&&K.isFunction(r)&&K.isFunction(i)?n.apply(this,arguments):this.animate(q(t,!0),r,i,o)}}),K.fn.extend({fadeTo:function(e,t,n,r){return this.filter(y).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=K.isEmptyObject(e),o=K.speed(t,n,r),a=function(){var t=F(this,K.extend({},e),o);i&&t.stop(!0)};return i||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=K.timers,a=K._data(this);if(n)a[n]&&a[n].stop&&i(a[n]);else for(n in a)a[n]&&a[n].stop&&Qn.test(n)&&i(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1));(t||!r)&&K.dequeue(this,e)})}}),K.each({slideDown:q("show"),slideUp:q("hide"),slideToggle:q("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){K.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),K.speed=function(e,t,n){var r=e&&"object"==typeof e?K.extend({},e):{complete:n||!n&&t||K.isFunction(e)&&e,duration:e,easing:n&&t||t&&!K.isFunction(t)&&t};return r.duration=K.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in K.fx.speeds?K.fx.speeds[r.duration]:K.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){K.isFunction(r.old)&&r.old.call(this),r.queue&&K.dequeue(this,r.queue)},r},K.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},K.timers=[],K.fx=_.prototype.init,K.fx.tick=function(){var e,n=K.timers,r=0;for(Yn=K.now();r<n.length;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||K.fx.stop(),Yn=t},K.fx.timer=function(e){e()&&K.timers.push(e)&&!Vn&&(Vn=setInterval(K.fx.tick,K.fx.interval))},K.fx.interval=13,K.fx.stop=function(){clearInterval(Vn),Vn=null},K.fx.speeds={slow:600,fast:200,_default:400},K.fx.step={},K.expr&&K.expr.filters&&(K.expr.filters.animated=function(e){return K.grep(K.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;K.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){K.offset.setOffset(this,e,t)});var n,r,i,o,a,s,l,u={top:0,left:0},c=this[0],f=c&&c.ownerDocument;if(f)return(r=f.body)===c?K.offset.bodyOffset(c):(n=f.documentElement,K.contains(n,c)?("undefined"!=typeof c.getBoundingClientRect&&(u=c.getBoundingClientRect()),i=B(f),o=n.clientTop||r.clientTop||0,a=n.clientLeft||r.clientLeft||0,s=i.pageYOffset||n.scrollTop,l=i.pageXOffset||n.scrollLeft,{top:u.top+s-o,left:u.left+l-a}):u)},K.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return K.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(K.css(e,"marginTop"))||0,n+=parseFloat(K.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=K.css(e,"position");"static"===r&&(e.style.position="relative");var i,o,a=K(e),s=a.offset(),l=K.css(e,"top"),u=K.css(e,"left"),c=("absolute"===r||"fixed"===r)&&K.inArray("auto",[l,u])>-1,f={},p={};c?(p=a.position(),i=p.top,o=p.left):(i=parseFloat(l)||0,o=parseFloat(u)||0),K.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(f.top=t.top-s.top+i),null!=t.left&&(f.left=t.left-s.left+o),"using"in t?t.using.call(e,f):a.css(f)}},K.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(K.css(e,"marginTop"))||0,n.left-=parseFloat(K.css(e,"marginLeft"))||0,r.top+=parseFloat(K.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(K.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||R.body;e&&!er.test(e.nodeName)&&"static"===K.css(e,"position");)e=e.offsetParent;return e||R.body})}}),K.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);K.fn[e]=function(i){return K.access(this,function(e,i,o){var a=B(e);return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:void(a?a.scrollTo(r?K(a).scrollLeft():o,r?o:K(a).scrollTop()):e[i]=o)},e,i,arguments.length,null)}}),K.each({Height:"height",Width:"width"},function(e,n){K.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){K.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");return K.access(this,function(n,r,i){var o;return K.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?K.css(n,r,i,s):K.style(n,r,i,s)},n,a?i:t,a,null)}})}),e.jQuery=e.$=K,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return K})}(window);
!function(t,e){function i(e,i){var n,a,o,r=e.nodeName.toLowerCase();return"area"===r?(n=e.parentNode,a=n.name,e.href&&a&&"map"===n.nodeName.toLowerCase()?(o=t("img[usemap=#"+a+"]")[0],!!o&&s(o)):!1):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r?e.href||i:i)&&s(e)}function s(e){return t.expr.filters.visible(e)&&!t(e).parents().andSelf().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var n=0,a=/^ui-id-\d+$/;t.ui=t.ui||{},t.ui.version||(t.extend(t.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({_focus:t.fn.focus,focus:function(e,i){return"number"==typeof e?this.each(function(){var s=this;setTimeout(function(){t(s).focus(),i&&i.call(s)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(i){if(i!==e)return this.css("zIndex",i);if(this.length)for(var s,n,a=t(this[0]);a.length&&a[0]!==document;){if(s=a.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(n=parseInt(a.css("zIndex"),10),!isNaN(n)&&0!==n))return n;a=a.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(e){return i(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var s=t.attr(e,"tabindex"),n=isNaN(s);return(n||s>=0)&&i(e,!n)}}),t(function(){var e=document.body,i=e.appendChild(i=document.createElement("div"));i.offsetHeight,t.extend(i.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),t.support.minHeight=100===i.offsetHeight,t.support.selectstart="onselectstart"in i,e.removeChild(i).style.display="none"}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,s){function n(e,i,s,n){return t.each(a,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),n&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var a="Width"===s?["Left","Right"]:["Top","Bottom"],o=s.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+s]=function(i){return i===e?r["inner"+s].call(this):this.each(function(){t(this).css(o,n(this,i)+"px")})},t.fn["outer"+s]=function(e,i){return"number"!=typeof e?r["outer"+s].call(this,e):this.each(function(){t(this).css(o,n(this,e,!0,i)+"px")})}}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),function(){var e=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];t.ui.ie=e.length?!0:!1,t.ui.ie6=6===parseFloat(e[1],10)}(),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,s){var n,a=t.ui[e].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(t,e,i){var s,n=t.plugins[e];if(n&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(s=0;s<n.length;s++)t.options[n[s][0]]&&n[s][1].apply(t.element,i)}},contains:t.contains,hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)},isOverAxis:function(t,e,i){return t>e&&e+i>t},isOver:function(e,i,s,n,a,o){return t.ui.isOverAxis(e,s,a)&&t.ui.isOverAxis(i,n,o)}}))}(jQuery),function(t,e){var i=0,s=Array.prototype.slice,n=t.cleanData;t.cleanData=function(e){for(var i,s=0;null!=(i=e[s]);s++)try{t(i).triggerHandler("remove")}catch(t){}n(e)},t.widget=function(e,i,s){var n,a,o,r,h=e.split(".")[0];e=e.split(".")[1],n=h+"-"+e,s||(s=i,i=t.Widget),t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[h]=t[h]||{},a=t[h][e],o=t[h][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,a,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(s,function(e,n){t.isFunction(n)&&(s[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},s=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,a=this._superApply;return this._super=t,this._superApply=s,e=n.apply(this,arguments),this._super=i,this._superApply=a,e}}())}),o.prototype=t.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix:e},s,{constructor:o,namespace:h,widgetName:e,widgetBaseClass:n,widgetFullName:n}),a?(t.each(a._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o)},t.widget.extend=function(i){for(var n,a,o=s.call(arguments,1),r=0,h=o.length;h>r;r++)for(n in o[r])a=o[r][n],o[r].hasOwnProperty(n)&&a!==e&&(i[n]=t.isPlainObject(a)?t.isPlainObject(i[n])?t.widget.extend({},i[n],a):t.widget.extend({},a):a);return i},t.widget.bridge=function(i,n){var a=n.prototype.widgetFullName||i;t.fn[i]=function(o){var r="string"==typeof o,h=s.call(arguments,1),l=this;return o=!r&&h.length?t.widget.extend.apply(null,[o].concat(h)):o,this.each(r?function(){var s,n=t.data(this,a);return n?t.isFunction(n[o])&&"_"!==o.charAt(0)?(s=n[o].apply(n,h),s!==n&&s!==e?(l=s&&s.jquery?l.pushStack(s.get()):s,!1):void 0):t.error("no such method '"+o+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+o+"'")}:function(){var e=t.data(this,a);e?e.option(o||{})._init():t.data(this,a,new n(o,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),s!==this&&(t.data(s,this.widgetName,this),t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,s){var n,a,o,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},n=i.split("."),i=n.shift(),n.length){for(a=r[i]=t.widget.extend({},this.options[i]),o=0;o<n.length-1;o++)a[n[o]]=a[n[o]]||{},a=a[n[o]];if(i=n.pop(),s===e)return a[i]===e?null:a[i];a[i]=s}else{if(s===e)return this.options[i]===e?null:this.options[i];r[i]=s}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,s){var n,a=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,o){function r(){return e||a.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||t.guid++);var h=s.match(/^(\w+)\s*(.*)$/),l=h[1]+a.eventNamespace,c=h[2];c?n.delegate(c,l,r):i.bind(l,r)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,a,o=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(t.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),o=!t.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&t.effects&&(t.effects.effect[r]||t.uiBackCompat!==!1&&t.effects[r])?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){t(this)[e](),a&&a.call(s[0]),i()})}}),t.uiBackCompat!==!1&&(t.Widget.prototype._getCreateOptions=function(){return t.metadata&&t.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(t){var e=!1;t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,a="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return n&&!a&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return s._mouseMove(t)},this._mouseUpDelegate=function(t){return s._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){return!t.ui.ie||document.documentMode>=9||e.button?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(t,e){function i(t,e,i){return[parseInt(t[0],10)*(d.test(t[0])?e/100:1),parseInt(t[1],10)*(d.test(t[1])?i/100:1)]}function s(e,i){return parseInt(t.css(e,i),10)||0}t.ui=t.ui||{};var n,a=Math.max,o=Math.abs,r=Math.round,h=/left|center|right/,l=/top|center|bottom/,c=/[\+\-]\d+%?/,u=/^\w+/,d=/%$/,p=t.fn.position;t.position={scrollbarWidth:function(){if(n!==e)return n;var i,s,a=t("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=a.children()[0];return t("body").append(a),i=o.offsetWidth,a.css("overflow","scroll"),s=o.offsetWidth,i===s&&(s=a[0].clientWidth),a.remove(),n=i-s},getScrollInfo:function(e){var i=e.isWindow?"":e.element.css("overflow-x"),s=e.isWindow?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,a="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:n?t.position.scrollbarWidth():0,height:a?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]);return{element:i,isWindow:s,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s?i.width():i.outerWidth(),height:s?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return p.apply(this,arguments);e=t.extend({},e);var n,d,f,g,m,v=t(e.of),_=t.position.getWithinInfo(e.within),b=t.position.getScrollInfo(_),y=v[0],w=(e.collision||"flip").split(" "),x={};return 9===y.nodeType?(d=v.width(),f=v.height(),g={top:0,left:0}):t.isWindow(y)?(d=v.width(),f=v.height(),g={top:v.scrollTop(),left:v.scrollLeft()}):y.preventDefault?(e.at="left top",d=f=0,g={top:y.pageY,left:y.pageX}):(d=v.outerWidth(),f=v.outerHeight(),g=v.offset()),m=t.extend({},g),t.each(["my","at"],function(){var t,i,s=(e[this]||"").split(" ");1===s.length&&(s=h.test(s[0])?s.concat(["center"]):l.test(s[0])?["center"].concat(s):["center","center"]),s[0]=h.test(s[0])?s[0]:"center",s[1]=l.test(s[1])?s[1]:"center",t=c.exec(s[0]),i=c.exec(s[1]),x[this]=[t?t[0]:0,i?i[0]:0],e[this]=[u.exec(s[0])[0],u.exec(s[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===e.at[0]?m.left+=d:"center"===e.at[0]&&(m.left+=d/2),"bottom"===e.at[1]?m.top+=f:"center"===e.at[1]&&(m.top+=f/2),n=i(x.at,d,f),m.left+=n[0],m.top+=n[1],this.each(function(){var h,l,c=t(this),u=c.outerWidth(),p=c.outerHeight(),y=s(this,"marginLeft"),k=s(this,"marginTop"),C=u+y+s(this,"marginRight")+b.width,D=p+k+s(this,"marginBottom")+b.height,P=t.extend({},m),I=i(x.my,c.outerWidth(),c.outerHeight());"right"===e.my[0]?P.left-=u:"center"===e.my[0]&&(P.left-=u/2),"bottom"===e.my[1]?P.top-=p:"center"===e.my[1]&&(P.top-=p/2),P.left+=I[0],P.top+=I[1],t.support.offsetFractions||(P.left=r(P.left),P.top=r(P.top)),h={marginLeft:y,marginTop:k},t.each(["left","top"],function(i,s){t.ui.position[w[i]]&&t.ui.position[w[i]][s](P,{targetWidth:d,targetHeight:f,elemWidth:u,elemHeight:p,collisionPosition:h,collisionWidth:C,collisionHeight:D,offset:[n[0]+I[0],n[1]+I[1]],my:e.my,at:e.at,within:_,elem:c})}),t.fn.bgiframe&&c.bgiframe(),e.using&&(l=function(t){var i=g.left-P.left,s=i+d-u,n=g.top-P.top,r=n+f-p,h={target:{element:v,left:g.left,top:g.top,width:d,height:f},element:{element:c,left:P.left,top:P.top,width:u,height:p},horizontal:0>s?"left":i>0?"right":"center",vertical:0>r?"top":n>0?"bottom":"middle"};u>d&&o(i+s)<d&&(h.horizontal="center"),p>f&&o(n+r)<f&&(h.vertical="middle"),h.important=a(o(i),o(s))>a(o(n),o(r))?"horizontal":"vertical",e.using.call(this,t,h)}),c.offset(t.extend(P,{using:l}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,o=s.width,r=t.left-e.collisionPosition.marginLeft,h=n-r,l=r+e.collisionWidth-o-n;e.collisionWidth>o?h>0&&0>=l?(i=t.left+h+e.collisionWidth-o-n,t.left+=h-i):t.left=l>0&&0>=h?n:h>l?n+o-e.collisionWidth:n:h>0?t.left+=h:l>0?t.left-=l:t.left=a(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,o=e.within.height,r=t.top-e.collisionPosition.marginTop,h=n-r,l=r+e.collisionHeight-o-n;e.collisionHeight>o?h>0&&0>=l?(i=t.top+h+e.collisionHeight-o-n,t.top+=h-i):t.top=l>0&&0>=h?n:h>l?n+o-e.collisionHeight:n:h>0?t.top+=h:l>0?t.top-=l:t.top=a(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,a=n.offset.left+n.scrollLeft,r=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=t.left-e.collisionPosition.marginLeft,c=l-h,u=l+e.collisionWidth-r-h,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-r-a,(0>i||i<o(c))&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-h,(s>0||o(s)<u)&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,a=n.offset.top+n.scrollTop,r=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=t.top-e.collisionPosition.marginTop,c=l-h,u=l+e.collisionHeight-r-h,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-r-a,t.top+p+f+g>c&&(0>s||s<o(c))&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-h,t.top+p+f+g>u&&(i>0||o(i)<u)&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,s,n,a,o=document.getElementsByTagName("body")[0],r=document.createElement("div");e=document.createElement(o?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&t.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in s)e.style[a]=s[a];e.appendChild(r),i=o||document.documentElement,i.insertBefore(e,i.firstChild),r.style.cssText="position: absolute; left: 10.7432222px;",n=t(r).offset().left,t.support.offsetFractions=n>10&&11>n,e.innerHTML="",i.removeChild(e)}(),t.uiBackCompat!==!1&&!function(t){var i=t.fn.position;t.fn.position=function(s){if(!s||!s.offset)return i.call(this,s);var n=s.offset.split(" "),a=s.at.split(" ");return 1===n.length&&(n[1]=n[0]),/^\d/.test(n[0])&&(n[0]="+"+n[0]),/^\d/.test(n[1])&&(n[1]="+"+n[1]),1===a.length&&(/left|center|right/.test(a[0])?a[1]="center":(a[1]=a[0],a[0]="center")),i.call(this,t.extend(s,{at:a[0]+n[0]+" "+a[1]+n[1],offset:e}))}}(jQuery)}(jQuery),function(t){var e=0,i={},s={};i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="hide",s.height=s.paddingTop=s.paddingBottom=s.borderTopWidth=s.borderBottomWidth="show",t.widget("ui.accordion",{version:"1.9.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var i=this.accordionId="ui-accordion-"+(this.element.attr("id")||++e),s=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset"),this.headers=this.element.find(s.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this._hoverable(this.headers),this._focusable(this.headers),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(),s.collapsible||s.active!==!1&&null!=s.active||(s.active=0),s.active<0&&(s.active+=this.headers.length),this.active=this._findActive(s.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this._createIcons(),this.refresh(),this.element.attr("role","tablist"),this.headers.attr("role","tab").each(function(e){var s=t(this),n=s.attr("id"),a=s.next(),o=a.attr("id");n||(n=i+"-header-"+e,s.attr("id",n)),o||(o=i+"-panel-"+e,a.attr("id",o)),s.attr("aria-controls",o),a.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._on(this.headers,{keydown:"_keydown"}),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._setupEvents(s.event)},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?void this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),void("disabled"===t&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e)))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),a=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(t(e.target).attr("tabIndex",-1),t(a).attr("tabIndex",0),a.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e,i,s=this.options.heightStyle,n=this.element.parent();"fill"===s?(t.support.minHeight||(i=n.css("overflow"),n.css("overflow","hidden")),e=n.height(),this.element.siblings(":visible").each(function(){var i=t(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(e-=i.outerHeight(!0))}),i&&n.css("overflow",i),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===s&&(e=0,this.headers.next().each(function(){e=Math.max(e,t(this).css("height","").height())}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={};e&&(t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._on(this.headers,i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?t():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?t():n,newPanel:r};e.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",e,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?t():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({"aria-expanded":"false","aria-hidden":"true"}),s.prev().attr("aria-selected","false"),i.length&&s.length?s.prev().attr("tabIndex",-1):i.length&&this.headers.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(t,e,n){var a,o,r,h=this,l=0,c=t.length&&(!e.length||t.index()<e.index()),u=this.options.animate||{},d=c&&u.down||u,p=function(){h._toggleComplete(n)};return"number"==typeof d&&(r=d),"string"==typeof d&&(o=d),o=o||d.easing||u.easing,r=r||d.duration||u.duration,e.length?t.length?(a=t.show().outerHeight(),e.animate(i,{duration:r,easing:o,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(s,{duration:r,easing:o,complete:p,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?l+=i.now:"content"!==h.options.heightStyle&&(i.now=Math.round(a-e.outerHeight()-l),l=0)}})):e.animate(i,r,o,p):t.animate(s,r,o,p)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.uiBackCompat!==!1&&(!function(t,e){t.extend(e.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var i=e._create;e._create=function(){if(this.options.navigation){var e=this,s=this.element.find(this.options.header),n=s.next(),a=s.add(n).find("a").filter(this.options.navigationFilter)[0];a&&s.add(n).each(function(i){return t.contains(this,a)?(e.options.active=Math.floor(i/2),!1):void 0})}i.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(t,e){t.extend(e.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var i=e._create,s=e._setOption;t.extend(e,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle(),i.call(this)},_setOption:function(t){("autoHeight"===t||"clearStyle"===t||"fillSpace"===t)&&(this.options.heightStyle=this._mergeHeightStyle()),s.apply(this,arguments)},_mergeHeightStyle:function(){var t=this.options;return t.fillSpace?"fill":t.clearStyle?"content":t.autoHeight?"auto":void 0}})}(jQuery,jQuery.ui.accordion.prototype),function(t,e){t.extend(e.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var i=e._createIcons;e._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected),i.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(t,e){e.activate=e._activate;var i=e._findActive;e._findActive=function(t){return-1===t&&(t=!1),t&&"number"!=typeof t&&(t=this.headers.index(this.headers.filter(t)),-1===t&&(t=!1)),i.call(this,t)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(t,e){t.extend(e.options,{change:null,changestart:null});var i=e._trigger;e._trigger=function(t,e,s){var n=i.apply(this,arguments);return n?("beforeActivate"===t?n=i.call(this,"changestart",e,{oldHeader:s.oldHeader,oldContent:s.oldPanel,newHeader:s.newHeader,newContent:s.newPanel}):"activate"===t&&(n=i.call(this,"change",e,{oldHeader:s.oldHeader,oldContent:s.oldPanel,newHeader:s.newHeader,newContent:s.newPanel})),n):!1}}(jQuery,jQuery.ui.accordion.prototype),function(t,e){t.extend(e.options,{animate:null,animated:"slide"});var i=e._create;e._create=function(){var t=this.options;null===t.animate&&(t.animate=t.animated?"slide"===t.animated?300:"bounceslide"===t.animated?{duration:200,down:{easing:"easeOutBounce",duration:1e3}}:t.animated:!1),i.call(this)}}(jQuery,jQuery.ui.accordion.prototype))}(jQuery),function(t){var e=0;t.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,i,s;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,void(i=!0);e=!1,s=!1,i=!1;var a=t.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:e=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case a.UP:e=!1,this._keyEvent("previous",n);break;case a.DOWN:e=!1,this._keyEvent("next",n);break;case a.ENTER:case a.NUMPAD_ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&!this.element.hasClass("ui-input-ignore-esc")&&(this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,void s.preventDefault();if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this._initMenu(),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(s){s.target===e.element[0]||s.target===i||t.contains(i,s.target)||e.close()})})},menufocus:function(e,i){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)});var s=i.item.data("ui-autocomplete-item")||i.item.data("item.autocomplete");!1!==this._trigger("focus",e,{item:s})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(s.value):this.liveRegion.text(s.value)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item")||e.item.data("item.autocomplete"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),t.fn.bgiframe&&this.menu.element.bgiframe()},_initMenu:function(){this.menu=t("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:t(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu")},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this.document.find(e||"body")[0]),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var t=this,i=++e;return function(s){i===e&&t.__response(s),t.pending--,t.pending||t.element.removeClass("ui-autocomplete-loading")}},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({label:e.label||e.value,value:e.value||e.label},e)})},_suggest:function(e){var i=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(i,e),this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<a>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=new RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.text(e))}})}(jQuery),function(t,e){var i,s,n,a,o="ui-button ui-widget ui-state-default ui-corner-all",r="ui-state-hover ui-state-active ",h="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",l=function(){var e=t(this).find(":ui-button");setTimeout(function(){e.button("refresh")},1)},c=function(e){var i=e.name,s=e.form,n=t([]);return i&&(n=s?t(s).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter(function(){return!this.form})),n};t.widget("ui.button",{version:"1.9.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,l),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,r=this.options,h="checkbox"===this.type||"radio"===this.type,u=h?"":"ui-state-active",d="ui-state-focus";null===r.label&&(r.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){r.disabled||this===i&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){r.disabled||t(this).removeClass(u)}).bind("click"+this.eventNamespace,function(t){r.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){e.buttonElement.addClass(d)}).bind("blur"+this.eventNamespace,function(){e.buttonElement.removeClass(d)}),h&&(this.element.bind("change"+this.eventNamespace,function(){a||e.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(t){r.disabled||(a=!1,s=t.pageX,n=t.pageY)}).bind("mouseup"+this.eventNamespace,function(t){r.disabled||(s!==t.pageX||n!==t.pageY)&&(a=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return r.disabled||a?!1:(t(this).toggleClass("ui-state-active"),void e.buttonElement.attr("aria-pressed",e.element[0].checked))}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(r.disabled||a)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var i=e.element[0];c(i).not(i).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return r.disabled?!1:(t(this).addClass("ui-state-active"),i=this,void e.document.one("mouseup",function(){i=null}))}).bind("mouseup"+this.eventNamespace,function(){return r.disabled?!1:void t(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){return r.disabled?!1:void((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",r.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+r+" "+h).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(e?this.element.prop("disabled",!0):this.element.prop("disabled",!1),void this._trigger("disabled",null,{element:this.element,disabled:e})):void this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?c(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var e=this.buttonElement.removeClass(h),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):a.push("ui-button-text-only"),e.addClass(a.join(" "))}}),t.widget("ui.buttonset",{version:"1.9.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){if("custom"!=this.element.data("uitype")){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()}},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons!==e&&this.buttons.length&&this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(t){var e="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(e,"mouseout",function(){$(this).removeClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(e,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?t.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))})}function extendRemove(t,e){$.extend(t,e);for(var i in e)(null==e[i]||e[i]==undefined)&&(t[i]=e[i]);return t}$.extend($.ui,{datepicker:{version:"1.9.2"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return extendRemove(this._defaults,t||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(t){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline="div"==nodeName||"span"==nodeName;target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),"input"==nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(t,e){var i=t[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:i,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(t,e){var i=$(t);e.append=$([]),e.trigger=$([]),i.hasClass(this.markerClassName)||(this._attachments(i,e),i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(t,i,s){e.settings[i]=s}).bind("getData.datepicker",function(t,i){return this._get(e,i)}),this._autoSize(e),$.data(t,PROP_NAME,e),e.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,e){var i=this._get(e,"appendText"),s=this._get(e,"isRTL");e.append&&e.append.remove(),i&&(e.append=$('<span class="'+this._appendClass+'">'+i+"</span>"),t[s?"before":"after"](e.append)),t.unbind("focus",this._showDatepicker),e.trigger&&e.trigger.remove();var n=this._get(e,"showOn");if(("focus"==n||"both"==n)&&t.focus(this._showDatepicker),"button"==n||"both"==n){var a=this._get(e,"buttonText"),o=this._get(e,"buttonImage");e.trigger=$(this._get(e,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:a,title:a}):$('<button type="button"></button>').addClass(this._triggerClass).html(""==o?a:$("<img/>").attr({src:o,alt:a,title:a}))),t[s?"before":"after"](e.trigger),e.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==t[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=t[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(t[0])):$.datepicker._showDatepicker(t[0]),!1})}},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e=new Date(2009,11,20),i=this._get(t,"dateFormat");if(i.match(/[DM]/)){var s=function(t){for(var e=0,i=0,s=0;s<t.length;s++)t[s].length>e&&(e=t[s].length,i=s);return i};e.setMonth(s(this._get(t,i.match(/MM/)?"monthNames":"monthNamesShort"))),e.setDate(s(this._get(t,i.match(/DD/)?"dayNames":"dayNamesShort"))+20-e.getDay())}t.input.attr("size",this._formatDate(t,e).length)}},_inlineDatepicker:function(t,e){var i=$(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv).bind("setData.datepicker",function(t,i,s){e.settings[i]=s}).bind("getData.datepicker",function(t,i){return this._get(e,i)}),$.data(t,PROP_NAME,e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),e.settings.disabled&&this._disableDatepicker(t),e.dpDiv.css("display","block"))},_dialogDatepicker:function(t,e,i,s,n){var a=this._dialogInst;if(!a){this.uuid+=1;var o="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+o+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},$.data(this._dialogInput[0],PROP_NAME,a)}if(extendRemove(a.settings,s||{}),e=e&&e.constructor==Date?this._formatDate(a,e):e,this._dialogInput.val(e),this._pos=n?n.length?n:[n.pageX,n.pageY]:null,!this._pos){var r=document.documentElement.clientWidth,h=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[r/2-100+l,h/2-150+c]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),a.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,a),this},_destroyDatepicker:function(t){var e=$(t),i=$.data(t,PROP_NAME);if(e.hasClass(this.markerClassName)){var s=t.nodeName.toLowerCase();$.removeData(t,PROP_NAME),"input"==s?(i.append.remove(),i.trigger.remove(),e.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==s||"span"==s)&&e.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(t){var e=$(t),i=$.data(t,PROP_NAME);if(e.hasClass(this.markerClassName)){var s=t.nodeName.toLowerCase();if("input"==s)t.disabled=!1,i.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==s||"span"==s){var n=e.children("."+this._inlineClass);n.children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=$.map(this._disabledInputs,function(e){return e==t?null:e})}},_disableDatepicker:function(t){var e=$(t),i=$.data(t,PROP_NAME);if(e.hasClass(this.markerClassName)){var s=t.nodeName.toLowerCase();if("input"==s)t.disabled=!0,i.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==s||"span"==s){var n=e.children("."+this._inlineClass);n.children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=$.map(this._disabledInputs,function(e){return e==t?null:e}),this._disabledInputs[this._disabledInputs.length]=t}},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]==t)return!0;return!1},_getInst:function(t){try{return $.data(t,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,e,i){var s=this._getInst(t);if(2==arguments.length&&"string"==typeof e)return"defaults"==e?$.extend({},$.datepicker._defaults):s?"all"==e?$.extend({},s.settings):this._get(s,e):null;var n=e||{};if("string"==typeof e&&(n={},n[e]=i),s){this._curInst==s&&this._hideDatepicker();var a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(s,"min"),r=this._getMinMaxDate(s,"max");extendRemove(s.settings,n),null!==o&&n.dateFormat!==undefined&&n.minDate===undefined&&(s.settings.minDate=this._formatDate(s,o)),null!==r&&n.dateFormat!==undefined&&n.maxDate===undefined&&(s.settings.maxDate=this._formatDate(s,r)),this._attachments($(t),s),this._autoSize(s),this._setDate(s,a),this._updateAlternate(s),this._updateDatepicker(s)}},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(t){var e=$.datepicker._getInst(t.target),i=!0,s=e.dpDiv.is(".ui-datepicker-rtl");if(e._keyEvent=!0,$.datepicker._datepickerShowing)switch(t.keyCode){case 9:$.datepicker._hideDatepicker(),i=!1;break;case 13:var n=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",e.dpDiv);n[0]&&$.datepicker._selectDay(t.target,e.selectedMonth,e.selectedYear,n[0]);var a=$.datepicker._get(e,"onSelect");if(a){var o=$.datepicker._formatDate(e);a.apply(e.input?e.input[0]:null,[o,e])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(t.target,t.ctrlKey?-$.datepicker._get(e,"stepBigMonths"):-$.datepicker._get(e,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(t.target,t.ctrlKey?+$.datepicker._get(e,"stepBigMonths"):+$.datepicker._get(e,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&$.datepicker._clearDate(t.target),i=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&$.datepicker._gotoToday(t.target),i=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,s?1:-1,"D"),i=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&$.datepicker._adjustDate(t.target,t.ctrlKey?-$.datepicker._get(e,"stepBigMonths"):-$.datepicker._get(e,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,-7,"D"),i=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,s?-1:1,"D"),i=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&$.datepicker._adjustDate(t.target,t.ctrlKey?+$.datepicker._get(e,"stepBigMonths"):+$.datepicker._get(e,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&$.datepicker._adjustDate(t.target,7,"D"),i=t.ctrlKey||t.metaKey;break;default:i=!1}else 36==t.keyCode&&t.ctrlKey?$.datepicker._showDatepicker(this):i=!1;i&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e=$.datepicker._getInst(t.target);if($.datepicker._get(e,"constrainInput")){var i=$.datepicker._possibleChars($.datepicker._get(e,"dateFormat")),s=String.fromCharCode(t.charCode==undefined?t.keyCode:t.charCode);return t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1}},_doKeyUp:function(t){var e=$.datepicker._getInst(t.target);if(e.input.val()!=e.lastVal)try{var i=$.datepicker.parseDate($.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,$.datepicker._getFormatConfig(e));i&&($.datepicker._setDateFromField(e),$.datepicker._updateAlternate(e),$.datepicker._updateDatepicker(e))}catch(t){$.datepicker.log(t)}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!=t.nodeName.toLowerCase()&&(t=$("input",t.parentNode)[0]),!$.datepicker._isDisabledDatepicker(t)&&$.datepicker._lastInput!=t){var e=$.datepicker._getInst(t);$.datepicker._curInst&&$.datepicker._curInst!=e&&($.datepicker._curInst.dpDiv.stop(!0,!0),e&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var i=$.datepicker._get(e,"beforeShow"),s=i?i.apply(t,[t,e]):{};if(s!==!1){extendRemove(e.settings,s),e.lastVal=null,$.datepicker._lastInput=t,$.datepicker._setDateFromField(e),$.datepicker._inDialog&&(t.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(t),$.datepicker._pos[1]+=t.offsetHeight);var n=!1;$(t).parents().each(function(){return n|="fixed"==$(this).css("position"),!n});var a={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};if($.datepicker._pos=null,e.dpDiv.empty(),e.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(e),a=$.datepicker._checkOffset(e,a,n),e.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":n?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),!e.inline){var o=$.datepicker._get(e,"showAnim"),r=$.datepicker._get(e,"duration"),h=function(){var t=e.dpDiv.find("iframe.ui-datepicker-cover");if(t.length){var i=$.datepicker._getBorders(e.dpDiv);t.css({left:-i[0],top:-i[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()})}};e.dpDiv.zIndex($(t).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&($.effects.effect[o]||$.effects[o])?e.dpDiv.show(o,$.datepicker._get(e,"showOptions"),r,h):e.dpDiv[o||"show"](o?r:null,h),o&&r||h(),e.input.is(":visible")&&!e.input.is(":disabled")&&e.input.focus(),$.datepicker._curInst=e}}}},_updateDatepicker:function(t){this.maxRows=4;var e=$.datepicker._getBorders(t.dpDiv);instActive=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i=t.dpDiv.find("iframe.ui-datepicker-cover");i.length&&i.css({left:-e[0],top:-e[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()}),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var s=this._getNumberOfMonths(t),n=s[1],a=17;if(t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!=s[0]||1!=s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t==$.datepicker._curInst&&$.datepicker._datepickerShowing&&t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&t.input[0]!=document.activeElement&&t.input.focus(),t.yearshtml){var o=t.yearshtml;setTimeout(function(){o===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),o=t.yearshtml=null},0)}},_getBorders:function(t){var e=function(t){return{thin:1,medium:2,thick:3}[t]||t};return[parseFloat(e(t.css("border-left-width"))),parseFloat(e(t.css("border-top-width")))]},_checkOffset:function(t,e,i){var s=t.dpDiv.outerWidth(),n=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,o=t.input?t.input.outerHeight():0,r=document.documentElement.clientWidth+(i?0:$(document).scrollLeft()),h=document.documentElement.clientHeight+(i?0:$(document).scrollTop());return e.left-=this._get(t,"isRTL")?s-a:0,e.left-=i&&e.left==t.input.offset().left?$(document).scrollLeft():0,e.top-=i&&e.top==t.input.offset().top+o?$(document).scrollTop():0,e.left-=Math.min(e.left,e.left+s>r&&r>s?Math.abs(e.left+s-r):0),e.top-=Math.min(e.top,e.top+n>h&&h>n?Math.abs(n+o):0),e},_findPos:function(t){for(var e=this._getInst(t),i=this._get(e,"isRTL");t&&("hidden"==t.type||1!=t.nodeType||$.expr.filters.hidden(t));)t=t[i?"previousSibling":"nextSibling"];var s=$(t).offset();return[s.left,s.top]},_hideDatepicker:function(t){var e=this._curInst;if(e&&(!t||e==$.data(t,PROP_NAME))&&this._datepickerShowing){var i=this._get(e,"showAnim"),s=this._get(e,"duration"),n=function(){$.datepicker._tidyDialog(e)};$.effects&&($.effects.effect[i]||$.effects[i])?e.dpDiv.hide(i,$.datepicker._get(e,"showOptions"),s,n):e.dpDiv["slideDown"==i?"slideUp":"fadeIn"==i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1;var a=this._get(e,"onClose");a&&a.apply(e.input?e.input[0]:null,[e.input?e.input.val():"",e]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if($.datepicker._curInst){var e=$(t.target),i=$.datepicker._getInst(e[0]);(e[0].id!=$.datepicker._mainDivId&&0==e.parents("#"+$.datepicker._mainDivId).length&&!e.hasClass($.datepicker.markerClassName)&&!e.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||e.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=i)&&$.datepicker._hideDatepicker()}},_adjustDate:function(t,e,i){var s=$(t),n=this._getInst(s[0]);this._isDisabledDatepicker(s[0])||(this._adjustInstDate(n,e+("M"==i?this._get(n,"showCurrentAtPos"):0),i),this._updateDatepicker(n))},_gotoToday:function(t){var e=$(t),i=this._getInst(e[0]);if(this._get(i,"gotoCurrent")&&i.currentDay)i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear;else{var s=new Date;i.selectedDay=s.getDate(),i.drawMonth=i.selectedMonth=s.getMonth(),i.drawYear=i.selectedYear=s.getFullYear()}this._notifyChange(i),this._adjustDate(e)},_selectMonthYear:function(t,e,i){var s=$(t),n=this._getInst(s[0]);n["selected"+("M"==i?"Month":"Year")]=n["draw"+("M"==i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(n),this._adjustDate(s)},_selectDay:function(t,e,i,s){var n=$(t);if(!$(s).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(n[0])){var a=this._getInst(n[0]);a.selectedDay=a.currentDay=$("a",s).html(),a.selectedMonth=a.currentMonth=e,a.selectedYear=a.currentYear=i,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear))}},_clearDate:function(t){{var e=$(t);this._getInst(e[0])}this._selectDate(e,"")},_selectDate:function(t,e){var i=$(t),s=this._getInst(i[0]);e=null!=e?e:this._formatDate(s),s.input&&s.input.val(e),this._updateAlternate(s);var n=this._get(s,"onSelect");n?n.apply(s.input?s.input[0]:null,[e,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var e=this._get(t,"altField");if(e){var i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t));$(e).each(function(){$(this).val(n)})}},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e=new Date(t.getTime());e.setDate(e.getDate()+4-(e.getDay()||7));var i=e.getTime();return e.setMonth(0),e.setDate(1),Math.floor(Math.round((i-e)/864e5)/7)+1},parseDate:function(t,e,i){if(null==t||null==e)throw"Invalid arguments";if(e="object"==typeof e?e.toString():e+"",""==e)return null;var s=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff;s="string"!=typeof s?s:(new Date).getFullYear()%100+parseInt(s,10);for(var n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=-1,l=-1,c=-1,u=-1,d=!1,p=function(e){var i=_+1<t.length&&t.charAt(_+1)==e;return i&&_++,i},f=function(t){var i=p(t),s="@"==t?14:"!"==t?20:"y"==t&&i?4:"o"==t?3:2,n=new RegExp("^\\d{1,"+s+"}"),a=e.substring(v).match(n);if(!a)throw"Missing number at position "+v;return v+=a[0].length,parseInt(a[0],10)},g=function(t,i,s){var n=$.map(p(t)?s:i,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)}),a=-1;if($.each(n,function(t,i){var s=i[1];return e.substr(v,s.length).toLowerCase()==s.toLowerCase()?(a=i[0],v+=s.length,!1):void 0}),-1!=a)return a+1;throw"Unknown name at position "+v},m=function(){if(e.charAt(v)!=t.charAt(_))throw"Unexpected literal at position "+v;v++},v=0,_=0;_<t.length;_++)if(d)"'"!=t.charAt(_)||p("'")?m():d=!1;else switch(t.charAt(_)){case"d":c=f("d");break;case"D":g("D",n,a);break;case"o":u=f("o");break;case"m":l=f("m");break;case"M":l=g("M",o,r);break;case"y":h=f("y");break;case"@":var b=new Date(f("@"));h=b.getFullYear(),l=b.getMonth()+1,c=b.getDate();break;case"!":var b=new Date((f("!")-this._ticksTo1970)/1e4);h=b.getFullYear(),l=b.getMonth()+1,c=b.getDate();break;case"'":p("'")?m():d=!0;break;default:m()}if(v<e.length){var y=e.substr(v);if(!/^\s+/.test(y))throw"Extra/unparsed characters found in date: "+y}if(-1==h?h=(new Date).getFullYear():100>h&&(h+=(new Date).getFullYear()-(new Date).getFullYear()%100+(s>=h?0:-100)),u>-1)for(l=1,c=u;;){var w=this._getDaysInMonth(h,l-1);if(w>=c)break;l++,c-=w}var b=this._daylightSavingAdjust(new Date(h,l-1,c));if(b.getFullYear()!=h||b.getMonth()+1!=l||b.getDate()!=c)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(t,e,i){if(!e)return"";var s=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,n=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,o=(i?i.monthNames:null)||this._defaults.monthNames,r=function(e){var i=d+1<t.length&&t.charAt(d+1)==e;return i&&d++,i},h=function(t,e,i){var s=""+e;if(r(t))for(;s.length<i;)s="0"+s;return s},l=function(t,e,i,s){return r(t)?s[e]:i[e]},c="",u=!1;if(e)for(var d=0;d<t.length;d++)if(u)"'"!=t.charAt(d)||r("'")?c+=t.charAt(d):u=!1;else switch(t.charAt(d)){case"d":c+=h("d",e.getDate(),2);break;case"D":c+=l("D",e.getDay(),s,n);break;case"o":c+=h("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=h("m",e.getMonth()+1,2);break;case"M":c+=l("M",e.getMonth(),a,o);break;case"y":c+=r("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":c+=e.getTime();break;case"!":c+=1e4*e.getTime()+this._ticksTo1970;break;case"'":r("'")?c+="'":u=!0;break;default:c+=t.charAt(d)}return c},_possibleChars:function(t){for(var e="",i=!1,s=function(e){var i=n+1<t.length&&t.charAt(n+1)==e;return i&&n++,i},n=0;n<t.length;n++)if(i)"'"!=t.charAt(n)||s("'")?e+=t.charAt(n):i=!1;else switch(t.charAt(n)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":s("'")?e+="'":i=!0;break;default:e+=t.charAt(n)}return e},_get:function(t,e){return t.settings[e]!==undefined?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!=t.lastVal){var i,s,n=this._get(t,"dateFormat"),a=t.lastVal=t.input?t.input.val():null;i=s=this._getDefaultDate(t);var o=this._getFormatConfig(t);try{i=this.parseDate(n,a,o)||s}catch(t){this.log(t),a=e?"":a}t.selectedDay=i.getDate(),t.drawMonth=t.selectedMonth=i.getMonth(),t.drawYear=t.selectedYear=i.getFullYear(),t.currentDay=a?i.getDate():0,t.currentMonth=a?i.getMonth():0,t.currentYear=a?i.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(t,e,i){var s=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},n=function(e){try{return $.datepicker.parseDate($.datepicker._get(t,"dateFormat"),e,$.datepicker._getFormatConfig(t))}catch(t){}for(var i=(e.toLowerCase().match(/^c/)?$.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),n=i.getMonth(),a=i.getDate(),o=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,r=o.exec(e);r;){switch(r[2]||"d"){case"d":case"D":a+=parseInt(r[1],10);break;case"w":case"W":a+=7*parseInt(r[1],10);break;case"m":case"M":n+=parseInt(r[1],10),a=Math.min(a,$.datepicker._getDaysInMonth(s,n));break;case"y":case"Y":s+=parseInt(r[1],10),a=Math.min(a,$.datepicker._getDaysInMonth(s,n))}r=o.exec(e)}return new Date(s,n,a)},a=null==e||""===e?i:"string"==typeof e?n(e):"number"==typeof e?isNaN(e)?i:s(e):new Date(e.getTime());return a=a&&"Invalid Date"==a.toString()?i:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,a=t.selectedYear,o=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=o.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=o.getMonth(),t.drawYear=t.selectedYear=t.currentYear=o.getFullYear(),n==t.selectedMonth&&a==t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""==t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(t){var e=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(i,-e,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(i,+e,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(i)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(i,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e=new Date;e=this._daylightSavingAdjust(new Date(e.getFullYear(),e.getMonth(),e.getDate()));var i=this._get(t,"isRTL"),s=this._get(t,"showButtonPanel"),n=this._get(t,"hideIfNoPrevNext"),a=this._get(t,"navigationAsDateFormat"),o=this._getNumberOfMonths(t),r=this._get(t,"showCurrentAtPos"),h=this._get(t,"stepMonths"),l=1!=o[0]||1!=o[1],c=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),u=this._getMinMaxDate(t,"min"),d=this._getMinMaxDate(t,"max"),p=t.drawMonth-r,f=t.drawYear;if(0>p&&(p+=12,f--),d){var g=this._daylightSavingAdjust(new Date(d.getFullYear(),d.getMonth()-o[0]*o[1]+1,d.getDate()));for(g=u&&u>g?u:g;this._daylightSavingAdjust(new Date(f,p,1))>g;)p--,0>p&&(p=11,f--)}t.drawMonth=p,t.drawYear=f;var m=this._get(t,"prevText");m=a?this.formatDate(m,this._daylightSavingAdjust(new Date(f,p-h,1)),this._getFormatConfig(t)):m;var v=this._canAdjustMonth(t,-1,f,p)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"e":"w")+'">'+m+"</span></a>":n?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"e":"w")+'">'+m+"</span></a>",_=this._get(t,"nextText");_=a?this.formatDate(_,this._daylightSavingAdjust(new Date(f,p+h,1)),this._getFormatConfig(t)):_;var b=this._canAdjustMonth(t,1,f,p)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+_+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"w":"e")+'">'+_+"</span></a>":n?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+_+'"><span class="ui-icon ui-icon-circle-triangle-'+(i?"w":"e")+'">'+_+"</span></a>",y=this._get(t,"currentText"),w=this._get(t,"gotoCurrent")&&t.currentDay?c:e;y=a?this.formatDate(y,w,this._getFormatConfig(t)):y;var x=t.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(t,"closeText")+"</button>",k=s?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(i?x:"")+(this._isInRange(t,w)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+y+"</button>":"")+(i?"":x)+"</div>":"",C=parseInt(this._get(t,"firstDay"),10);C=isNaN(C)?0:C;for(var D=this._get(t,"showWeek"),P=this._get(t,"dayNames"),I=(this._get(t,"dayNamesShort"),this._get(t,"dayNamesMin")),M=this._get(t,"monthNames"),T=this._get(t,"monthNamesShort"),S=this._get(t,"beforeShowDay"),z=this._get(t,"showOtherMonths"),A=this._get(t,"selectOtherMonths"),H=(this._get(t,"calculateWeek")||this.iso8601Week,this._getDefaultDate(t)),N="",E=0;E<o[0];E++){var W="";this.maxRows=4;for(var O=0;O<o[1];O++){var F=this._daylightSavingAdjust(new Date(f,p,t.selectedDay)),R=" ui-corner-all",j="";if(l){if(j+='<div class="ui-datepicker-group',o[1]>1)switch(O){case 0:j+=" ui-datepicker-group-first",R=" ui-corner-"+(i?"right":"left");break;case o[1]-1:j+=" ui-datepicker-group-last",R=" ui-corner-"+(i?"left":"right");break;default:j+=" ui-datepicker-group-middle",R=""}j+='">'}j+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+R+'">'+(/all|left/.test(R)&&0==E?i?b:v:"")+(/all|right/.test(R)&&0==E?i?v:b:"")+this._generateMonthYearHeader(t,p,f,u,d,E>0||O>0,M,T)+'</div><table class="ui-datepicker-calendar"><thead><tr>';for(var L=D?'<th class="ui-datepicker-week-col">'+this._get(t,"weekHeader")+"</th>":"",Y=0;7>Y;Y++){var B=(Y+C)%7;L+="<th"+((Y+C+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+P[B]+'">'+I[B]+"</span></th>"}j+=L+"</tr></thead><tbody>";var K=this._getDaysInMonth(f,p);f==t.selectedYear&&p==t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,K));var q=(this._getFirstDayOfMonth(f,p)-C+7)%7,Q=Math.ceil((q+K)/7),U=l&&this.maxRows>Q?this.maxRows:Q;this.maxRows=U;for(var V=this._daylightSavingAdjust(new Date(f,p,1-q)),X=0;U>X;X++){j+="<tr>";for(var G=D?'<td class="ui-datepicker-week-col">'+this._get(t,"calculateWeek")(V)+"</td>":"",Y=0;7>Y;Y++){var Z=S?S.apply(t.input?t.input[0]:null,[V]):[!0,""],J=V.getMonth()!=p,te=J&&!A||!Z[0]||u&&u>V||d&&V>d;G+='<td class="'+((Y+C+6)%7>=5?" ui-datepicker-week-end":"")+(J?" ui-datepicker-other-month":"")+(V.getTime()==F.getTime()&&p==t.selectedMonth&&t._keyEvent||H.getTime()==V.getTime()&&H.getTime()==F.getTime()?" "+this._dayOverClass:"")+(te?" "+this._unselectableClass+" ui-state-disabled":"")+(J&&!z?"":" "+Z[1]+(V.getTime()==c.getTime()?" "+this._currentClass:"")+(V.getTime()==e.getTime()?" ui-datepicker-today":""))+'"'+(J&&!z||!Z[2]?"":' title="'+Z[2]+'"')+(te?"":' data-handler="selectDay" data-event="click" data-month="'+V.getMonth()+'" data-year="'+V.getFullYear()+'"')+">"+(J&&!z?"&#xa0;":te?'<span class="ui-state-default">'+V.getDate()+"</span>":'<a class="ui-state-default'+(V.getTime()==e.getTime()?" ui-state-highlight":"")+(V.getTime()==c.getTime()?" ui-state-active":"")+(J?" ui-priority-secondary":"")+'" href="#">'+V.getDate()+"</a>")+"</td>",V.setDate(V.getDate()+1),V=this._daylightSavingAdjust(V)}j+=G+"</tr>"}p++,p>11&&(p=0,f++),j+="</tbody></table>"+(l?"</div>"+(o[0]>0&&O==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),W+=j}N+=W}return N+=k+($.ui.ie6&&!t.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),t._keyEvent=!1,N},_generateMonthYearHeader:function(t,e,i,s,n,a,o,r){var h=this._get(t,"changeMonth"),l=this._get(t,"changeYear"),c=this._get(t,"showMonthAfterYear"),u='<div class="ui-datepicker-title">',d="";if(a||!h)d+='<span class="ui-datepicker-month">'+o[e]+"</span>";else{var p=s&&s.getFullYear()==i,f=n&&n.getFullYear()==i;d+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var g=0;12>g;g++)(!p||g>=s.getMonth())&&(!f||g<=n.getMonth())&&(d+='<option value="'+g+'"'+(g==e?' selected="selected"':"")+">"+r[g]+"</option>");d+="</select>"}if(c||(u+=d+(!a&&h&&l?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",a||!l)u+='<span class="ui-datepicker-year">'+i+"</span>";else{var m=this._get(t,"yearRange").split(":"),v=(new Date).getFullYear(),_=function(t){var e=t.match(/c[+-].*/)?i+parseInt(t.substring(1),10):t.match(/[+-].*/)?v+parseInt(t,10):parseInt(t,10);return isNaN(e)?v:e},b=_(m[0]),y=Math.max(b,_(m[1]||""));for(b=s?Math.max(b,s.getFullYear()):b,y=n?Math.min(y,n.getFullYear()):y,t.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';y>=b;b++)t.yearshtml+='<option value="'+b+'"'+(b==i?' selected="selected"':"")+">"+b+"</option>";t.yearshtml+="</select>",u+=t.yearshtml,t.yearshtml=null}return u+=this._get(t,"yearSuffix"),c&&(u+=(!a&&h&&l?"":"&#xa0;")+d),u+="</div>"},_adjustInstDate:function(t,e,i){var s=t.drawYear+("Y"==i?e:0),n=t.drawMonth+("M"==i?e:0),a=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"==i?e:0),o=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,a)));t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),("M"==i||"Y"==i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return n=s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),a=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(t,a)},_isInRange:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max");return(!i||e.getTime()>=i.getTime())&&(!s||e.getTime()<=s.getTime())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),$.fn.datepicker=function(t){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv),$.datepicker.initialized=!0);var e=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!=t&&"getDate"!=t&&"widget"!=t?"option"==t&&2==arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+t+"Datepicker"].apply($.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof t?$.datepicker["_"+t+"Datepicker"].apply($.datepicker,[this].concat(e)):$.datepicker._attachDatepicker(this,t)}):$.datepicker["_"+t+"Datepicker"].apply($.datepicker,[this[0]].concat(e))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.9.2",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(t,e){var i="ui-dialog ui-widget ui-widget-content ui-corner-all ",s={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},n={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};t.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),"string"!=typeof this.originalTitle&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var e,s,n,a,o,r=this,h=this.options,l=h.title||"&#160;";e=(this.uiDialog=t("<div>")).addClass(i+h.dialogClass).css({display:"none",outline:0,zIndex:h.zIndex}).attr("tabIndex",-1).keydown(function(e){h.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE&&(r.close(e),e.preventDefault())}).mousedown(function(t){r.moveToTop(!1,t)}).appendTo("body"),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(e),s=(this.uiDialogTitlebar=t("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",function(){e.focus()}).prependTo(e),n=t("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(t){t.preventDefault(),r.close(t)}).appendTo(s),(this.uiDialogTitlebarCloseText=t("<span>")).addClass("ui-icon ui-icon-closethick").text(h.closeText).appendTo(n),a=t("<span>").uniqueId().addClass("ui-dialog-title").html(l).prependTo(s),o=(this.uiDialogButtonPane=t("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),(this.uiButtonSet=t("<div>")).addClass("ui-dialog-buttonset").appendTo(o),e.attr({role:"dialog","aria-labelledby":a.attr("id")}),s.find("*").add(s).disableSelection(),this._hoverable(n),this._focusable(n),h.draggable&&t.fn.draggable&&this._makeDraggable(),h.resizable&&t.fn.resizable&&this._makeResizable(),this._createButtons(h.buttons),this._isOpen=!1,t.fn.bgiframe&&e.bgiframe(),this._on(e,{keydown:function(i){if(h.modal&&i.keyCode===t.ui.keyCode.TAB){var s=t(":tabbable",e),n=s.filter(":first"),a=s.filter(":last");return i.target!==a[0]||i.shiftKey?i.target===n[0]&&i.shiftKey?(a.focus(1),!1):void 0:(n.focus(1),!1)}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var t,e=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(e){var i,s,n=this;if(this._isOpen&&!1!==this._trigger("beforeClose",e))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",e)}):(this.uiDialog.hide(),this._trigger("close",e)),t.ui.dialog.overlay.resize(),this.options.modal&&(i=0,t(".ui-dialog").each(function(){this!==n.uiDialog[0]&&(s=t(this).css("z-index"),isNaN(s)||(i=Math.max(i,s)))}),t.ui.dialog.maxZ=i),this},isOpen:function(){return this._isOpen},moveToTop:function(e,i){var s,n=this.options;return n.modal&&!e||!n.stack&&!n.modal?this._trigger("focus",i):(n.zIndex>t.ui.dialog.maxZ&&(t.ui.dialog.maxZ=n.zIndex),this.overlay&&(t.ui.dialog.maxZ+=1,t.ui.dialog.overlay.maxZ=t.ui.dialog.maxZ,this.overlay.$el.css("z-index",t.ui.dialog.overlay.maxZ)),s={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},t.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",t.ui.dialog.maxZ),this.element.attr(s),this._trigger("focus",i),this)},open:function(){if(!this._isOpen){var e,i=this.options,s=this.uiDialog;return this._size(),this._position(i.position),s.show(i.show),this.overlay=i.modal?new t.ui.dialog.overlay(this):null,this.moveToTop(!0),e=this.element.find(":tabbable"),e.length||(e=this.uiDialogButtonPane.find(":tabbable"),e.length||(e=s)),e.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(e){var i=this,s=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),"object"==typeof e&&null!==e&&t.each(e,function(){return!(s=!0)}),s?(t.each(e,function(e,s){var n,a;s=t.isFunction(s)?{click:s,text:e}:s,s=t.extend({type:"button"},s),a=s.click,s.click=function(){a.apply(i.element[0],arguments)},n=t("<button></button>",s).appendTo(i.uiButtonSet),t.fn.button&&n.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){t(this).addClass("ui-dialog-dragging"),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,a){s.position=[a.position.left-i.document.scrollLeft(),a.position.top-i.document.scrollTop()],t(this).removeClass("ui-dialog-dragging"),i._trigger("dragStop",n,e(a)),t.ui.dialog.overlay.resize()}})},_makeResizable:function(i){function s(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}i=i===e?this.options.resizable:i;var n=this,a=this.options,o=this.uiDialog.css("position"),r="string"==typeof i?i:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:this._minHeight(),handles:r,start:function(e,i){t(this).addClass("ui-dialog-resizing"),n._trigger("resizeStart",e,s(i))},resize:function(t,e){n._trigger("resize",t,s(e))},stop:function(e,i){t(this).removeClass("ui-dialog-resizing"),a.height=t(this).height(),a.width=t(this).width(),n._trigger("resizeStop",e,s(i)),t.ui.dialog.overlay.resize()}}).css("position",o).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(e){var i,s=[],n=[0,0];e?(("string"==typeof e||"object"==typeof e&&"0"in e)&&(s=e.split?e.split(" "):[e[0],e[1]],1===s.length&&(s[1]=s[0]),t.each(["left","top"],function(t,e){+s[t]===s[t]&&(n[t]=s[t],s[t]=e)}),e={my:s[0]+(n[0]<0?n[0]:"+"+n[0])+" "+s[1]+(n[1]<0?n[1]:"+"+n[1]),at:s.join(" ")}),e=t.extend({},t.ui.dialog.prototype.options.position,e)):e=t.ui.dialog.prototype.options.position,i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(e),i||this.uiDialog.hide()},_setOptions:function(e){var i=this,a={},o=!1;t.each(e,function(t,e){i._setOption(t,e),t in s&&(o=!0),t in n&&(a[t]=e)}),o&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",a)},_setOption:function(e,s){var n,a,o=this.uiDialog;switch(e){case"buttons":this._createButtons(s);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+s);break;case"dialogClass":o.removeClass(this.options.dialogClass).addClass(i+s);break;case"disabled":s?o.addClass("ui-dialog-disabled"):o.removeClass("ui-dialog-disabled");break;case"draggable":n=o.is(":data(draggable)"),n&&!s&&o.draggable("destroy"),!n&&s&&this._makeDraggable();break;case"position":this._position(s);break;case"resizable":a=o.is(":data(resizable)"),a&&!s&&o.resizable("destroy"),a&&"string"==typeof s&&o.resizable("option","handles",s),a||s===!1||this._makeResizable(s);break;case"title":t(".ui-dialog-title",this.uiDialogTitlebar).html(""+(s||"&#160;"))}this._super(e,s)},_size:function(){var e,i,s,n=this.options,a=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),i=Math.max(0,n.minHeight-e),"auto"===n.height?t.support.minHeight?this.element.css({minHeight:i,height:"auto"}):(this.uiDialog.show(),s=this.element.css("height","auto").height(),a||this.uiDialog.hide(),this.element.height(Math.max(s,i))):this.element.height(Math.max(n.height-e,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),t.extend(t.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(t){var e=t.attr("id");return e||(this.uuid+=1,e=this.uuid),"ui-dialog-title-"+e},overlay:function(e){this.$el=t.ui.dialog.overlay.create(e)}}),t.extend(t.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:t.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(t){return t+".dialog-overlay"}).join(" "),create:function(e){0===this.instances.length&&(setTimeout(function(){t.ui.dialog.overlay.instances.length&&t(document).bind(t.ui.dialog.overlay.events,function(e){return t(e.target).zIndex()<t.ui.dialog.overlay.maxZ?!1:void 0})},1),t(window).bind("resize.dialog-overlay",t.ui.dialog.overlay.resize));var i=this.oldInstances.pop()||t("<div>").addClass("ui-widget-overlay");return t(document).bind("keydown.dialog-overlay",function(s){var n=t.ui.dialog.overlay.instances;0!==n.length&&n[n.length-1]===i&&e.options.closeOnEscape&&!s.isDefaultPrevented()&&s.keyCode&&s.keyCode===t.ui.keyCode.ESCAPE&&(e.close(s),s.preventDefault())}),i.appendTo(document.body).css({width:this.width(),height:this.height()}),t.fn.bgiframe&&i.bgiframe(),this.instances.push(i),i},destroy:function(e){var i=t.inArray(e,this.instances),s=0;-1!==i&&this.oldInstances.push(this.instances.splice(i,1)[0]),0===this.instances.length&&t([document,window]).unbind(".dialog-overlay"),e.height(0).width(0).remove(),t.each(this.instances,function(){s=Math.max(s,this.css("z-index"))}),this.maxZ=s},height:function(){var e,i;return t.ui.ie?(e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),i=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),i>e?t(window).height()+"px":e+"px"):t(document).height()+"px"},width:function(){var e,i;return t.ui.ie?(e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),i=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),i>e?t(window).width()+"px":e+"px"):t(document).width()+"px"},resize:function(){var e=t([]);t.each(t.ui.dialog.overlay.instances,function(){e=e.add(this)}),e.css({width:0,height:0}).css({width:t.ui.dialog.overlay.width(),height:t.ui.dialog.overlay.height()})}}),t.extend(t.ui.dialog.overlay.prototype,{destroy:function(){t.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(t){t.widget("ui.draggable",t.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(e),this.handle?(t(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){t('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),i.containment&&this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=!1;t.ui.ddmanager&&!this.options.dropBehaviour&&(i=t.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1);for(var s=this.element[0],n=!1;s&&(s=s.parentNode);)s==document&&(n=!0);if(!n&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!i||"valid"==this.options.revert&&i||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)){var a=this;t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){a._trigger("stop",e)!==!1&&a._clear()})}else this._trigger("stop",e)!==!1&&this._clear();return!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){var i=this.options.handle&&t(this.options.handle,this.element).length?!1:!0;return t(this.options.handle,this.element).find("*").andSelf().each(function(){this==e.target&&(i=!0)}),i},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"==i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"==i.appendTo?this.element[0].parentNode:i.appendTo),s[0]==this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if("parent"==e.containment&&(e.containment=this.helper[0].parentNode),("document"==e.containment||"window"==e.containment)&&(this.containment=["document"==e.containment?0:t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==e.containment?0:t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==e.containment?0:t(window).scrollLeft())+t("document"==e.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==e.containment?0:t(window).scrollTop())+(t("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||e.containment.constructor==Array)e.containment.constructor==Array&&(this.containment=e.containment);else{var i=t(e.containment),s=i[0];if(!s)return;var n=(i.offset(),"hidden"!=t(s).css("overflow"));this.containment=[(parseInt(t(s).css("borderLeftWidth"),10)||0)+(parseInt(t(s).css("paddingLeft"),10)||0),(parseInt(t(s).css("borderTopWidth"),10)||0)+(parseInt(t(s).css("paddingTop"),10)||0),(n?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(t(s).css("borderLeftWidth"),10)||0)-(parseInt(t(s).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(n?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(t(s).css("borderTopWidth"),10)||0)-(parseInt(t(s).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i}},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"==e?1:-1,n=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(e){var i=this.options,s="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(s[0].tagName),a=e.pageX,o=e.pageY;if(this.originalPosition){var r;if(this.containment){if(this.relative_container){var h=this.relative_container.offset();r=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+h.left,this.containment[3]+h.top]}else r=this.containment;e.pageX-this.offset.click.left<r[0]&&(a=r[0]+this.offset.click.left),e.pageY-this.offset.click.top<r[1]&&(o=r[1]+this.offset.click.top),e.pageX-this.offset.click.left>r[2]&&(a=r[2]+this.offset.click.left),e.pageY-this.offset.click.top>r[3]&&(o=r[3]+this.offset.click.top)}if(i.grid){var l=i.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1]:this.originalPageY;o=r&&(l-this.offset.click.top<r[1]||l-this.offset.click.top>r[3])?l-this.offset.click.top<r[1]?l+i.grid[1]:l-i.grid[1]:l;var c=i.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/i.grid[0])*i.grid[0]:this.originalPageX;a=r&&(c-this.offset.click.left<r[0]||c-this.offset.click.left>r[2])?c-this.offset.click.left<r[0]?c+i.grid[0]:c-i.grid[0]:c}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:s.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:s.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s]),"drag"==e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var s=t(this).data("draggable"),n=s.options,a=t.extend({},i,{item:s.element});s.sortables=[],t(n.connectToSortable).each(function(){var i=t.data(this,"sortable");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",e,a))})},stop:function(e,i){var s=t(this).data("draggable"),n=t.extend({},i,{item:s.element});t.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"==s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,n))})},drag:function(e,i){var s=t(this).data("draggable"),n=this;t.each(s.sortables,function(){var a=!1,o=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(a=!0,t.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!=o&&this.instance._intersectsWith(this.instance.containerCache)&&t.ui.contains(o.instance.element[0],this.instance.element[0])&&(a=!1),a})),a?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(n).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",e),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",e),s.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),i=t(this).data("draggable").options;e.css("cursor")&&(i._cursor=e.css("cursor")),e.css("cursor",i.cursor)},stop:function(){var e=t(this).data("draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var s=t(i.helper),n=t(this).data("draggable").options;s.css("opacity")&&(n._opacity=s.css("opacity")),s.css("opacity",n.opacity)},stop:function(e,i){var s=t(this).data("draggable").options;s._opacity&&t(i.helper).css("opacity",s._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("draggable");e.scrollParent[0]!=document&&"HTML"!=e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var i=t(this).data("draggable"),s=i.options,n=!1;i.scrollParent[0]!=document&&"HTML"!=i.scrollParent[0].tagName?(s.axis&&"x"==s.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<s.scrollSensitivity?i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop+s.scrollSpeed:e.pageY-i.overflowOffset.top<s.scrollSensitivity&&(i.scrollParent[0].scrollTop=n=i.scrollParent[0].scrollTop-s.scrollSpeed)),s.axis&&"y"==s.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-e.pageX<s.scrollSensitivity?i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft+s.scrollSpeed:e.pageX-i.overflowOffset.left<s.scrollSensitivity&&(i.scrollParent[0].scrollLeft=n=i.scrollParent[0].scrollLeft-s.scrollSpeed))):(s.axis&&"x"==s.axis||(e.pageY-t(document).scrollTop()<s.scrollSensitivity?n=t(document).scrollTop(t(document).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<s.scrollSensitivity&&(n=t(document).scrollTop(t(document).scrollTop()+s.scrollSpeed))),s.axis&&"y"==s.axis||(e.pageX-t(document).scrollLeft()<s.scrollSensitivity?n=t(document).scrollLeft(t(document).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<s.scrollSensitivity&&(n=t(document).scrollLeft(t(document).scrollLeft()+s.scrollSpeed)))),n!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("draggable"),i=e.options;e.snapElements=[],t(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var i=t(this),s=i.offset();this!=e.element[0]&&e.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:s.top,left:s.left})})},drag:function(e,i){for(var s=t(this).data("draggable"),n=s.options,a=n.snapTolerance,o=i.offset.left,r=o+s.helperProportions.width,h=i.offset.top,l=h+s.helperProportions.height,c=s.snapElements.length-1;c>=0;c--){var u=s.snapElements[c].left,d=u+s.snapElements[c].width,p=s.snapElements[c].top,f=p+s.snapElements[c].height;if(o>u-a&&d+a>o&&h>p-a&&f+a>h||o>u-a&&d+a>o&&l>p-a&&f+a>l||r>u-a&&d+a>r&&h>p-a&&f+a>h||r>u-a&&d+a>r&&l>p-a&&f+a>l){if("inner"!=n.snapMode){var g=Math.abs(p-l)<=a,m=Math.abs(f-h)<=a,v=Math.abs(u-r)<=a,_=Math.abs(d-o)<=a;g&&(i.position.top=s._convertPositionTo("relative",{top:p-s.helperProportions.height,left:0}).top-s.margins.top),m&&(i.position.top=s._convertPositionTo("relative",{top:f,left:0}).top-s.margins.top),v&&(i.position.left=s._convertPositionTo("relative",{top:0,left:u-s.helperProportions.width}).left-s.margins.left),_&&(i.position.left=s._convertPositionTo("relative",{top:0,left:d}).left-s.margins.left)}var b=g||m||v||_;if("outer"!=n.snapMode){var g=Math.abs(p-h)<=a,m=Math.abs(f-l)<=a,v=Math.abs(u-o)<=a,_=Math.abs(d-r)<=a;g&&(i.position.top=s._convertPositionTo("relative",{top:p,left:0}).top-s.margins.top),m&&(i.position.top=s._convertPositionTo("relative",{top:f-s.helperProportions.height,left:0}).top-s.margins.top),v&&(i.position.left=s._convertPositionTo("relative",{top:0,left:u}).left-s.margins.left),_&&(i.position.left=s._convertPositionTo("relative",{top:0,left:d-s.helperProportions.width}).left-s.margins.left)}!s.snapElements[c].snapping&&(g||m||v||_||b)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=g||m||v||_||b}else s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1}}}),t.ui.plugin.add("draggable","stack",{start:function(){var e=t(this).data("draggable").options,i=t.makeArray(t(e.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});if(i.length){var s=parseInt(i[0].style.zIndex)||0;t(i).each(function(t){this.style.zIndex=s+t}),this[0].style.zIndex=s+i.length}}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var s=t(i.helper),n=t(this).data("draggable").options;s.css("zIndex")&&(n._zIndex=s.css("zIndex")),s.css("zIndex",n.zIndex)},stop:function(e,i){var s=t(this).data("draggable").options;s._zIndex&&t(i.helper).css("zIndex",s._zIndex)}})}(jQuery),function(t){t.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var e=this.options,i=e.accept;this.isover=0,this.isout=1,this.accept=t.isFunction(i)?i:function(t){return t.is(i)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},t.ui.ddmanager.droppables[e.scope]=t.ui.ddmanager.droppables[e.scope]||[],t.ui.ddmanager.droppables[e.scope].push(this),e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=t.ui.ddmanager.droppables[this.options.scope],i=0;i<e.length;i++)e[i]==this&&e.splice(i,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){"accept"==e&&(this.accept=t.isFunction(i)?i:function(t){return t.is(i)}),t.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!=this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!=this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current;if(!s||(s.currentItem||s.element)[0]==this.element[0])return!1;var n=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope==s.options.scope&&e.accept.call(e.element[0],s.currentItem||s.element)&&t.ui.intersect(s,t.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(s)),this.element):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(e,i,s){if(!i.offset)return!1;var n=(e.positionAbs||e.position.absolute).left,a=n+e.helperProportions.width,o=(e.positionAbs||e.position.absolute).top,r=o+e.helperProportions.height,h=i.offset.left,l=h+i.proportions.width,c=i.offset.top,u=c+i.proportions.height;switch(s){case"fit":return n>=h&&l>=a&&o>=c&&u>=r;case"intersect":return h<n+e.helperProportions.width/2&&a-e.helperProportions.width/2<l&&c<o+e.helperProportions.height/2&&r-e.helperProportions.height/2<u;case"pointer":var d=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,p=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,f=t.ui.isOver(p,d,c,h,i.proportions.height,i.proportions.width);return f;case"touch":return(o>=c&&u>=o||r>=c&&u>=r||c>o&&r>u)&&(n>=h&&l>=n||a>=h&&l>=a||h>n&&a>l);default:return!1}},t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var s=t.ui.ddmanager.droppables[e.options.scope]||[],n=i?i.type:null,a=(e.currentItem||e.element).find(":data(droppable)").andSelf();t:for(var o=0;o<s.length;o++)if(!(s[o].options.disabled||e&&!s[o].accept.call(s[o].element[0],e.currentItem||e.element))){for(var r=0;r<a.length;r++)if(a[r]==s[o].element[0]){s[o].proportions.height=0;continue t}s[o].visible="none"!=s[o].element.css("display"),s[o].visible&&("mousedown"==n&&s[o]._activate.call(s[o],i),s[o].offset=s[o].element.offset(),s[o].proportions={width:s[o].element[0].offsetWidth,height:s[o].element[0].offsetHeight})}},drop:function(e,i){var s=!1;return t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s=t.ui.intersect(e,this,this.options.tolerance),n=s||1!=this.isover?s&&0==this.isover?"isover":null:"isout";if(n){var a;if(this.options.greedy){var o=this.options.scope,r=this.element.parents(":data(droppable)").filter(function(){return t.data(this,"droppable").options.scope===o});r.length&&(a=t.data(r[0],"droppable"),a.greedyChild="isover"==n?1:0)}a&&"isover"==n&&(a.isover=0,a.isout=1,a._out.call(a,i)),this[n]=1,this["isout"==n?"isover":"isout"]=0,this["isover"==n?"_over":"_out"].call(this,i),a&&"isout"==n&&(a.isout=0,a.isover=1,a._over.call(a,i))}}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}}}(jQuery),jQuery.effects||function(t,e){var i=t.uiBackCompat!==!1,s="ui-effects-";t.effects={effect:{}},function(e,i){function s(t,e,i){var s=d[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:s.max<t?s.max:t)}function n(t){var i=c(),s=i._rgba=[];return t=t.toLowerCase(),g(l,function(e,n){var a,o=n.re.exec(t),r=o&&n.parse(o),h=n.space||"rgba";return r?(a=i[h](r),i[u[h].cache]=a[u[h].cache],s=i._rgba=a._rgba,!1):void 0}),s.length?("0,0,0,0"===s.join()&&e.extend(s,o.transparent),i):o[t]}function a(t,e,i){return i=(i+1)%1,1>6*i?t+(e-t)*i*6:1>2*i?e:2>3*i?t+(e-t)*(2/3-i)*6:t}var o,r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),h=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],c=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},p=c.support={},f=e("<p>")[0],g=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",p.rgba=f.style.backgroundColor.indexOf("rgba")>-1,g(u,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),c.fn=e.extend(c.prototype,{parse:function(a,r,h,l){if(a===i)return this._rgba=[null,null,null,null],this;(a.jquery||a.nodeType)&&(a=e(a).css(r),r=i);var d=this,p=e.type(a),f=this._rgba=[];return r!==i&&(a=[a,r,h,l],p="array"),"string"===p?this.parse(n(a)||o._default):"array"===p?(g(u.rgba.props,function(t,e){f[e.idx]=s(a[e.idx],e)}),this):"object"===p?(a instanceof c?g(u,function(t,e){a[e.cache]&&(d[e.cache]=a[e.cache].slice())}):g(u,function(e,i){var n=i.cache;g(i.props,function(t,e){if(!d[n]&&i.to){if("alpha"===t||null==a[t])return;d[n]=i.to(d._rgba)}d[n][e.idx]=s(a[t],e,!0)}),d[n]&&t.inArray(null,d[n].slice(0,3))<0&&(d[n][3]=1,i.from&&(d._rgba=i.from(d[n])))}),this):void 0},is:function(t){var e=c(t),i=!0,s=this;return g(u,function(t,n){var a,o=e[n.cache];return o&&(a=s[n.cache]||n.to&&n.to(s._rgba)||[],g(n.props,function(t,e){return null!=o[e.idx]?i=o[e.idx]===a[e.idx]:void 0})),i}),i},_space:function(){var t=[],e=this;return g(u,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var i=c(t),n=i._space(),a=u[n],o=0===this.alpha()?c("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return i=i[a.cache],g(a.props,function(t,n){var a=n.idx,o=r[a],l=i[a],c=d[n.type]||{};null!==l&&(null===o?h[a]=l:(c.mod&&(l-o>c.mod/2?o+=c.mod:o-l>c.mod/2&&(o-=c.mod)),h[a]=s((l-o)*e+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=c(t)._rgba;return c(e.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,u.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,a=t[2]/255,o=t[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,c=r+h,u=.5*c;return e=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===u||1===u?u:.5>=u?l/c:l/(2-c),[Math.round(e)%360,i,u,null==o?1:o]},u.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],n=t[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*a(r,o,e+1/3)),Math.round(255*a(r,o,e)),Math.round(255*a(r,o,e-1/3)),n]},g(u,function(t,n){var a=n.props,o=n.cache,r=n.to,l=n.from;c.fn[t]=function(t){if(r&&!this[o]&&(this[o]=r(this._rgba)),t===i)return this[o].slice();var n,h=e.type(t),u="array"===h||"object"===h?t:arguments,d=this[o].slice();return g(a,function(t,e){var i=u["object"===h?t:e.idx];null==i&&(i=d[e.idx]),d[e.idx]=s(i,e)}),l?(n=c(l(d)),n[o]=d,n):c(d)},g(a,function(i,s){c.fn[i]||(c.fn[i]=function(n){var a,o=e.type(n),r="alpha"===i?this._hsla?"hsla":"rgba":t,l=this[r](),c=l[s.idx];return"undefined"===o?c:("function"===o&&(n=n.call(this,c),o=e.type(n)),null==n&&s.empty?this:("string"===o&&(a=h.exec(n),a&&(n=c+parseFloat(a[2])*("+"===a[1]?1:-1))),l[s.idx]=n,this[r](l)))})})}),g(r,function(t,i){e.cssHooks[i]={set:function(t,s){var a,o,r="";if("string"!==e.type(s)||(a=n(s))){if(s=c(a||s),!p.rgba&&1!==s._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(t){}s=s.blend(r&&"transparent"!==r?r:"_default")}s=s.toRgbaString()}try{t.style[i]=s}catch(t){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=c(t.elem,i),t.end=c(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}}),e.cssHooks.borderColor={expand:function(t){var e={};return g(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},o=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(){var e,i,s=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,n={};if(s&&s.length&&s[0]&&s[s[0]])for(i=s.length;i--;)e=s[i],"string"==typeof s[e]&&(n[t.camelCase(e)]=s[e]);else for(e in s)"string"==typeof s[e]&&(n[e]=s[e]);return n}function s(e,i){var s,n,o={};for(s in i)n=i[s],e[s]!==n&&(a[s]||(t.fx.step[s]||!isNaN(parseFloat(n)))&&(o[s]=n));return o}var n=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}}),t.effects.animateClass=function(e,a,o,r){var h=t.speed(a,o,r);return this.queue(function(){var a,o=t(this),r=o.attr("class")||"",l=h.children?o.find("*").andSelf():o;l=l.map(function(){var e=t(this);return{el:e,start:i.call(this)}}),a=function(){t.each(n,function(t,i){e[i]&&o[i+"Class"](e[i])})},a(),l=l.map(function(){return this.end=i.call(this.el[0]),this.diff=s(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var e=this,i=t.Deferred(),s=jQuery.extend({},h,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,l.get()).done(function(){a(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),h.complete.call(o[0])})})},t.fn.extend({_addClass:t.fn.addClass,addClass:function(e,i,s,n){return i?t.effects.animateClass.call(this,{add:e},i,s,n):this._addClass(e)},_removeClass:t.fn.removeClass,removeClass:function(e,i,s,n){return i?t.effects.animateClass.call(this,{remove:e},i,s,n):this._removeClass(e)},_toggleClass:t.fn.toggleClass,toggleClass:function(i,s,n,a,o){return"boolean"==typeof s||s===e?n?t.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):this._toggleClass(i,s):t.effects.animateClass.call(this,{toggle:i},s,n,a)},switchClass:function(e,i,s,n,a){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,a)}})}(),function(){function n(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function a(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?!1:i&&t.effects[e]?!1:!0}t.extend(t.effects,{version:"1.9.2",save:function(t,e){for(var i=0;i<e.length;i++)null!==e[i]&&t.data(s+e[i],t[0].style[e[i]])},restore:function(t,i){var n,a;for(a=0;a<i.length;a++)null!==i[a]&&(n=t.data(s+i[a]),n===e&&(n=""),t.css(i[a],n))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},a=document.activeElement;try{a.id}catch(t){a=document.body}return e.wrap(s),(e[0]===a||t.contains(e[0],a))&&t(a).focus(),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var a=e.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),t.fn.extend({effect:function(){function e(e){function i(){t.isFunction(a)&&a.call(n[0]),t.isFunction(e)&&e()}var n=t(this),a=s.complete,o=s.mode;(n.is(":hidden")?"hide"===o:"show"===o)?i():r.call(n[0],s,i)}var s=n.apply(this,arguments),a=s.mode,o=s.queue,r=t.effects.effect[s.effect],h=!r&&i&&t.effects[s.effect];return t.fx.off||!r&&!h?a?this[a](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):r?o===!1?this.each(e):this.queue(o||"fx",e):h.call(this,{options:s,duration:s.duration,callback:s.complete,mode:s.mode})},_show:t.fn.show,show:function(t){if(a(t))return this._show.apply(this,arguments);var e=n.apply(this,arguments);return e.mode="show",this.effect.call(this,e)},_hide:t.fn.hide,hide:function(t){if(a(t))return this._hide.apply(this,arguments);var e=n.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)},__toggle:t.fn.toggle,toggle:function(e){if(a(e)||"boolean"==typeof e||t.isFunction(e))return this.__toggle.apply(this,arguments);var i=n.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)},cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}()}(jQuery),function(t){var e=/up|down|vertical/,i=/up|left|vertical|horizontal/;t.effects.effect.blind=function(s,n){var a,o,r,h=t(this),l=["position","top","bottom","left","right","height","width"],c=t.effects.setMode(h,s.mode||"hide"),u=s.direction||"up",d=e.test(u),p=d?"height":"width",f=d?"top":"left",g=i.test(u),m={},v="show"===c;h.parent().is(".ui-effects-wrapper")?t.effects.save(h.parent(),l):t.effects.save(h,l),h.show(),a=t.effects.createWrapper(h).css({overflow:"hidden"}),o=a[p](),r=parseFloat(a.css(f))||0,m[p]=v?o:0,g||(h.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),m[f]=v?r:o+r),v&&(a.css(p,0),g||a.css(f,r+o)),a.animate(m,{duration:s.duration,easing:s.easing,queue:!1,complete:function(){"hide"===c&&h.hide(),t.effects.restore(h,l),t.effects.removeWrapper(h),n()}})}}(jQuery),function(t){t.effects.effect.bounce=function(e,i){var s,n,a,o=t(this),r=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(o,e.mode||"effect"),l="hide"===h,c="show"===h,u=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(c||l?1:0),g=e.duration/f,m=e.easing,v="up"===u||"down"===u?"top":"left",_="up"===u||"left"===u,b=o.queue(),y=b.length;for((c||l)&&r.push("opacity"),t.effects.save(o,r),o.show(),t.effects.createWrapper(o),d||(d=o["top"===v?"outerHeight":"outerWidth"]()/3),c&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,_?2*-d:2*d).animate(a,g,m)),l&&(d/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(_?"-=":"+=")+d,o.animate(n,g,m).animate(a,g,m),d=l?2*d:d/2;l&&(n={opacity:0},n[v]=(_?"-=":"+=")+d,o.animate(n,g,m)),o.queue(function(){l&&o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}),y>1&&b.splice.apply(b,[1,0].concat(b.splice(y,f+1))),o.dequeue()}}(jQuery),function(t){t.effects.effect.clip=function(e,i){var s,n,a,o=t(this),r=["position","top","bottom","left","right","height","width"],h=t.effects.setMode(o,e.mode||"hide"),l="show"===h,c=e.direction||"vertical",u="vertical"===c,d=u?"height":"width",p=u?"top":"left",f={};t.effects.save(o,r),o.show(),s=t.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[d](),l&&(n.css(d,0),n.css(p,a/2)),f[d]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){l||o.hide(),t.effects.restore(o,r),t.effects.removeWrapper(o),i()}})}}(jQuery),function(t){t.effects.effect.drop=function(e,i){var s,n=t(this),a=["position","top","bottom","left","right","opacity","height","width"],o=t.effects.setMode(n,e.mode||"hide"),r="show"===o,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h?"pos":"neg",u={opacity:r?1:0};t.effects.save(n,a),n.show(),t.effects.createWrapper(n),s=e.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===c?-s:s),u[l]=(r?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&n.hide(),t.effects.restore(n,a),t.effects.removeWrapper(n),i()}})}}(jQuery),function(t){t.effects.effect.explode=function(e,i){function s(){b.push(this),b.length===u*d&&n()}function n(){p.css({visibility:"visible"}),t(b).remove(),g||p.hide(),i()}var a,o,r,h,l,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/d),_=Math.ceil(p.outerHeight()/u),b=[];for(a=0;u>a;a++)for(h=m.top+a*_,c=a-(u-1)/2,o=0;d>o;o++)r=m.left+o*v,l=o-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*_}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:_,left:r+(g?l*v:0),top:h+(g?c*_:0),opacity:g?0:1}).animate({left:r+(g?0:l*v),top:h+(g?0:c*_),opacity:g?1:0},e.duration||500,e.easing,s)}}(jQuery),function(t){t.effects.effect.fade=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:i})}}(jQuery),function(t){t.effects.effect.fold=function(e,i){var s,n,a=t(this),o=["position","top","bottom","left","right","height","width"],r=t.effects.setMode(a,e.mode||"hide"),h="show"===r,l="hide"===r,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,p=h!==d,f=p?["width","height"]:["height","width"],g=e.duration/2,m={},v={};t.effects.save(a,o),a.show(),s=t.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],u&&(c=parseInt(u[1],10)/100*n[l?0:1]),h&&s.css(d?{height:0,width:c}:{height:c,width:0}),m[f[0]]=h?n[0]:c,v[f[1]]=h?n[1]:0,s.animate(m,g,e.easing).animate(v,g,e.easing,function(){l&&a.hide(),t.effects.restore(a,o),t.effects.removeWrapper(a),i()})}}(jQuery),function(t){t.effects.effect.highlight=function(e,i){var s=t(this),n=["backgroundImage","backgroundColor","opacity"],a=t.effects.setMode(s,e.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),t.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(o,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===a&&s.hide(),t.effects.restore(s,n),i()}})}}(jQuery),function(t){t.effects.effect.pulsate=function(e,i){var s,n=t(this),a=t.effects.setMode(n,e.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(e.times||5)+(h?1:0),c=e.duration/l,u=0,d=n.queue(),p=d.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),u=1),s=1;l>s;s++)n.animate({opacity:u},c,e.easing),u=1-u;n.animate({opacity:u},c,e.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,l+1))),n.dequeue()}}(jQuery),function(t){t.effects.effect.puff=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"hide"),a="hide"===n,o=parseInt(e.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(e)},t.effects.effect.scale=function(e,i){var s=t(this),n=t.extend(!0,{},e),a=t.effects.setMode(s,e.mode||"effect"),o=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===a?0:100),r=e.direction||"both",h=e.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},c={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=e.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*c.y,width:l.width*c.x,outerHeight:l.outerHeight*c.y,outerWidth:l.outerWidth*c.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},t.effects.effect.size=function(e,i){var s,n,a,o=t(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(o,e.mode||"effect"),f=e.restore||"effect"!==p,g=e.scale||"both",m=e.origin||["middle","center"],v=o.css("position"),_=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===e.mode&&"show"===p?(o.from=e.to||b,o.to=e.from||s):(o.from=e.from||("show"===p?b:s),o.to=e.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===g||"both"===g)&&(a.from.y!==a.to.y&&(_=_.concat(u),o.from=t.effects.setTransition(o,u,a.from.y,o.from),o.to=t.effects.setTransition(o,u,a.to.y,o.to)),a.from.x!==a.to.x&&(_=_.concat(d),o.from=t.effects.setTransition(o,d,a.from.x,o.from),o.to=t.effects.setTransition(o,d,a.to.x,o.to))),("content"===g||"both"===g)&&a.from.y!==a.to.y&&(_=_.concat(c).concat(l),o.from=t.effects.setTransition(o,c,a.from.y,o.from),o.to=t.effects.setTransition(o,c,a.to.y,o.to)),t.effects.save(o,_),o.show(),t.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(n=t.effects.getBaseline(m,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===g||"both"===g)&&(u=u.concat(["marginTop","marginBottom"]).concat(c),d=d.concat(["marginLeft","marginRight"]),l=r.concat(u).concat(d),o.find("*[width]").each(function(){var i=t(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=t.effects.setTransition(i,u,a.from.y,i.from),i.to=t.effects.setTransition(i,u,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=t.effects.setTransition(i,d,a.from.x,i.from),i.to=t.effects.setTransition(i,d,a.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),t.effects.restore(o,_),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):t.each(["top","left"],function(t,e){o.css(e,function(e,i){var s=parseInt(i,10),n=t?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),t.effects.removeWrapper(o),i()}})}}(jQuery),function(t){t.effects.effect.shake=function(e,i){var s,n=t(this),a=["position","top","bottom","left","right","height","width"],o=t.effects.setMode(n,e.mode||"effect"),r=e.direction||"left",h=e.distance||20,l=e.times||3,c=2*l+1,u=Math.round(e.duration/c),d="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},g={},m={},v=n.queue(),_=v.length;for(t.effects.save(n,a),n.show(),t.effects.createWrapper(n),f[d]=(p?"-=":"+=")+h,g[d]=(p?"+=":"-=")+2*h,m[d]=(p?"-=":"+=")+2*h,n.animate(f,u,e.easing),s=1;l>s;s++)n.animate(g,u,e.easing).animate(m,u,e.easing);n.animate(g,u,e.easing).animate(f,u/2,e.easing).queue(function(){"hide"===o&&n.hide(),t.effects.restore(n,a),t.effects.removeWrapper(n),i()}),_>1&&v.splice.apply(v,[1,0].concat(v.splice(_,c+1))),n.dequeue()}}(jQuery),function(t){t.effects.effect.slide=function(e,i){var s,n=t(this),a=["position","top","bottom","left","right","width","height"],o=t.effects.setMode(n,e.mode||"show"),r="show"===o,h=e.direction||"left",l="up"===h||"down"===h?"top":"left",c="up"===h||"left"===h,u={};t.effects.save(n,a),n.show(),s=e.distance||n["top"===l?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,c?isNaN(s)?"-"+s:-s:s),u[l]=(r?c?"+=":"-=":c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&n.hide(),t.effects.restore(n,a),t.effects.removeWrapper(n),i()}})}}(jQuery),function(t){t.effects.effect.transfer=function(e,i){var s=t(this),n=t(e.to),a="fixed"===n.css("position"),o=t("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),c={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},u=s.offset(),d=t('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(e.className).css({top:u.top-r,left:u.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),i()})}}(jQuery),function(t){var e=!1;t.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,t.proxy(function(t){this.options.disabled&&t.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(t){t.preventDefault()},"click .ui-state-disabled > a":function(t){t.preventDefault()},"click .ui-menu-item:has(a)":function(i){var s=t(i.target).closest(".ui-menu-item");!e&&s.not(".ui-state-disabled").length&&(e=!0,this.select(i),s.has(".ui-menu").length?this.expand(i):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var i=t(e.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(i){t(i.target).closest(".ui-menu").length||this.collapseAll(i),e=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var s,n,a,o,r,h=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:h=!1,n=this.previousFilter||"",a=String.fromCharCode(e.keyCode),o=!1,clearTimeout(this.filterTimer),a===n?o=!0:a=n+a,r=new RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(t(this).children("a").text())}),s=o&&-1!==s.index(this.active.next())?this.active.nextAll(".ui-menu-item"):s,s.length||(a=String.fromCharCode(e.keyCode),r=new RegExp("^"+i(a),"i"),s=this.activeMenu.children(".ui-menu-item").filter(function(){return r.test(t(this).children("a").text())})),s.length?(this.focus(e,s),s.length>1?(this.previousFilter=a,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}h&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i=this.options.icons.submenu,s=this.element.find(this.options.menus);s.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),s=e.prev("a"),n=t("<span>").addClass("ui-menu-icon ui-icon "+i).data("ui-menu-submenu-carat",!0);s.attr("aria-haspopup","true").prepend(n),e.attr("aria-labelledby",s.attr("id"))}),e=s.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var e=t(this);/[^\-\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(t,e){if(e){var i,s;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})}},_scrollIntoView:function(e){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=e.height(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.children(".ui-menu-item")[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s-n<0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,s,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.children(".ui-menu-item").first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)}})}(jQuery),function(t,e){t.widget("ui.progressbar",{version:"1.9.2",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return t===e?this._value():(this._setOption("value",t),this)},_setOption:function(t,e){"value"===t&&(this.options.value=e,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),this._super(t,e)},_value:function(){var t=this.options.value;return"number"!=typeof t&&(t=0),Math.min(this.options.max,Math.max(this.min,t))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var t=this.value(),e=this._percentage();this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),this.valueDiv.toggle(t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(e.toFixed(0)+"%"),this.element.attr("aria-valuenow",t)}})}(jQuery),function(t){t.widget("ui.resizable",t.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var e=this,i=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(t('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=i.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var s=this.handles.split(",");this.handles={};for(var n=0;n<s.length;n++){var a=t.trim(s[n]),o="ui-resizable-"+a,r=t('<div class="ui-resizable-handle '+o+'"></div>');r.css({zIndex:i.zIndex}),"se"==a&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[a]=".ui-resizable-"+a,this.element.append(r)}}this._renderAxis=function(e){e=e||this.element;for(var i in this.handles){if(this.handles[i].constructor==String&&(this.handles[i]=t(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var s=t(this.handles[i],this.element),n=0;n=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth();var a=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");e.css(a,n),this._proportionallyResize()}t(this.handles[i]).length}},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!e.resizing){if(this.className)var t=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);e.axis=t&&t[1]?t[1]:"se"}}),i.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){i.disabled||(t(this).removeClass("ui-resizable-autohide"),e._handles.show())}).mouseleave(function(){i.disabled||e.resizing||(t(this).addClass("ui-resizable-autohide"),e._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var i=this.element;this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")}).insertAfter(i),i.remove()}return this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var i=!1;for(var s in this.handles)t(this.handles[s])[0]==e.target&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(i){var s=this.options,n=this.element.position(),a=this.element;this.resizing=!0,this.documentScroll={top:t(document).scrollTop(),left:t(document).scrollLeft()},(a.is(".ui-draggable")||/absolute/.test(a.css("position")))&&a.css({position:"absolute",top:n.top,left:n.left}),this._renderProxy();var o=e(this.helper.css("left")),r=e(this.helper.css("top"));s.containment&&(o+=t(s.containment).scrollLeft()||0,r+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:r},this.size=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalPosition={left:o,top:r},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1;var h=t(".ui-resizable-"+this.axis).css("cursor");return t("body").css("cursor","auto"==h?this.axis+"-resize":h),a.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(t){var e=this.helper,i=(this.options,this.originalMousePosition),s=this.axis,n=t.pageX-i.left||0,a=t.pageY-i.top||0,o=this._change[s];if(!o)return!1;var r=o.apply(this,[t,n,a]);return this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(r=this._updateRatio(r,t)),r=this._respectSize(r,t),this._propagate("resize",t),e.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(r),this._trigger("resize",t,this.ui()),!1},_mouseStop:function(e){this.resizing=!1;var i=this.options,s=this;if(this._helper){var n=this._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&t.ui.hasScroll(n[0],"left")?0:s.sizeDiff.height,r=a?0:s.sizeDiff.width,h={width:s.helper.width()-r,height:s.helper.height()-o},l=parseInt(s.element.css("left"),10)+(s.position.left-s.originalPosition.left)||null,c=parseInt(s.element.css("top"),10)+(s.position.top-s.originalPosition.top)||null;i.animate||this.element.css(t.extend(h,{top:c,left:l})),s.helper.height(s.size.height),s.helper.width(s.size.width),this._helper&&!i.animate&&this._proportionallyResize()}return t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(t){var e,s,n,a,o,r=this.options;o={minWidth:i(r.minWidth)?r.minWidth:0,maxWidth:i(r.maxWidth)?r.maxWidth:1/0,minHeight:i(r.minHeight)?r.minHeight:0,maxHeight:i(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,n=o.minWidth/this.aspectRatio,s=o.maxHeight*this.aspectRatio,a=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),n>o.minHeight&&(o.minHeight=n),s<o.maxWidth&&(o.maxWidth=s),a<o.maxHeight&&(o.maxHeight=a)),this._vBoundaries=o},_updateCache:function(t){this.options;this.offset=this.helper.offset(),i(t.left)&&(this.position.left=t.left),i(t.top)&&(this.position.top=t.top),i(t.height)&&(this.size.height=t.height),i(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=(this.options,this.position),s=this.size,n=this.axis;return i(t.height)?t.width=t.height*this.aspectRatio:i(t.width)&&(t.height=t.width/this.aspectRatio),"sw"==n&&(t.left=e.left+(s.width-t.width),t.top=null),"nw"==n&&(t.top=e.top+(s.height-t.height),t.left=e.left+(s.width-t.width)),t},_respectSize:function(t,e){var s=(this.helper,this._vBoundaries),n=(this._aspectRatio||e.shiftKey,this.axis),a=i(t.width)&&s.maxWidth&&s.maxWidth<t.width,o=i(t.height)&&s.maxHeight&&s.maxHeight<t.height,r=i(t.width)&&s.minWidth&&s.minWidth>t.width,h=i(t.height)&&s.minHeight&&s.minHeight>t.height;r&&(t.width=s.minWidth),h&&(t.height=s.minHeight),a&&(t.width=s.maxWidth),o&&(t.height=s.maxHeight);var l=this.originalPosition.left+this.originalSize.width,c=this.position.top+this.size.height,u=/sw|nw|w/.test(n),d=/nw|ne|n/.test(n);r&&u&&(t.left=l-s.minWidth),a&&u&&(t.left=l-s.maxWidth),h&&d&&(t.top=c-s.minHeight),o&&d&&(t.top=c-s.maxHeight);var p=!t.width&&!t.height;return p&&!t.left&&t.top?t.top=null:p&&!t.top&&t.left&&(t.left=null),t},_proportionallyResize:function(){this.options;if(this._proportionallyResizeElements.length)for(var e=this.helper||this.element,i=0;i<this._proportionallyResizeElements.length;i++){var s=this._proportionallyResizeElements[i];if(!this.borderDif){var n=[s.css("borderTopWidth"),s.css("borderRightWidth"),s.css("borderBottomWidth"),s.css("borderLeftWidth")],a=[s.css("paddingTop"),s.css("paddingRight"),s.css("paddingBottom"),s.css("paddingLeft")];this.borderDif=t.map(n,function(t,e){var i=parseInt(t,10)||0,s=parseInt(a[e],10)||0;return i+s})}s.css({height:e.height()-this.borderDif[0]-this.borderDif[2]||0,width:e.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var e=this.element,i=this.options;if(this.elementOffset=e.offset(),this._helper){this.helper=this.helper||t('<div style="overflow:hidden;"></div>');var s=t.ui.ie6?1:0,n=t.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+n,height:this.element.outerHeight()+n,position:"absolute",left:this.elementOffset.left-s+"px",top:this.elementOffset.top-s+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=(this.options,this.originalSize),s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=(this.options,this.originalSize),n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!=e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).data("resizable"),i=e.options,s=function(e){t(e).each(function(){var e=t(this);e.data("resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof i.alsoResize||i.alsoResize.parentNode?s(i.alsoResize):i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):t.each(i.alsoResize,function(t){s(t)})},resize:function(e,i){var s=t(this).data("resizable"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0},h=function(e,s){t(e).each(function(){var e=t(this),n=t(this).data("resizable-alsoresize"),a={},o=s&&s.length?s:e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(n[e]||0)+(r[e]||0);i&&i>=0&&(a[e]=i||null)}),e.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?h(n.alsoResize):t.each(n.alsoResize,function(t,e){h(t,e)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).data("resizable"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&t.ui.hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(h,c&&l?{top:c,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var i=t(this).data("resizable"),s=i.options,n=i.element,a=s.containment,o=a instanceof t?a.get(0):/parent/.test(a)?n.parent().get(0):a;if(o)if(i.containerElement=t(o),/document/.test(a)||a==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight};else{var r=t(o),h=[];t(["Top","Right","Left","Bottom"]).each(function(t,i){h[t]=e(r.css("padding"+i))}),i.containerOffset=r.offset(),i.containerPosition=r.position(),i.containerSize={height:r.innerHeight()-h[3],width:r.innerWidth()-h[1]};var l=i.containerOffset,c=i.containerSize.height,u=i.containerSize.width,d=t.ui.hasScroll(o,"left")?o.scrollWidth:u,p=t.ui.hasScroll(o)?o.scrollHeight:c;i.parentData={element:o,left:l.left,top:l.top,width:d,height:p}}},resize:function(e){var i=t(this).data("resizable"),s=i.options,n=(i.containerSize,i.containerOffset),a=(i.size,i.position),o=i._aspectRatio||e.shiftKey,r={top:0,left:0},h=i.containerElement;h[0]!=document&&/static/.test(h.css("position"))&&(r=n),a.left<(i._helper?n.left:0)&&(i.size.width=i.size.width+(i._helper?i.position.left-n.left:i.position.left-r.left),o&&(i.size.height=i.size.width/i.aspectRatio),i.position.left=s.helper?n.left:0),a.top<(i._helper?n.top:0)&&(i.size.height=i.size.height+(i._helper?i.position.top-n.top:i.position.top),o&&(i.size.width=i.size.height*i.aspectRatio),i.position.top=i._helper?n.top:0),i.offset.left=i.parentData.left+i.position.left,i.offset.top=i.parentData.top+i.position.top;var l=Math.abs((i._helper?i.offset.left-r.left:i.offset.left-r.left)+i.sizeDiff.width),c=Math.abs((i._helper?i.offset.top-r.top:i.offset.top-n.top)+i.sizeDiff.height),u=i.containerElement.get(0)==i.element.parent().get(0),d=/relative|absolute/.test(i.containerElement.css("position"));u&&d&&(l-=i.parentData.left),l+i.size.width>=i.parentData.width&&(i.size.width=i.parentData.width-l,o&&(i.size.height=i.size.width/i.aspectRatio)),c+i.size.height>=i.parentData.height&&(i.size.height=i.parentData.height-c,o&&(i.size.width=i.size.height*i.aspectRatio))},stop:function(){var e=t(this).data("resizable"),i=e.options,s=(e.position,e.containerOffset),n=e.containerPosition,a=e.containerElement,o=t(e.helper),r=o.offset(),h=o.outerWidth()-e.sizeDiff.width,l=o.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(a.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l}),e._helper&&!i.animate&&/static/.test(a.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).data("resizable"),i=e.options,s=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){{var e=t(this).data("resizable");e.options}e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){{var e=t(this).data("resizable");e.options}e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(e){{var i=t(this).data("resizable"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis;s._aspectRatio||e.shiftKey}s.grid="number"==typeof s.grid?[s.grid,s.grid]:s.grid;var h=Math.round((n.width-a.width)/(s.grid[0]||1))*(s.grid[0]||1),l=Math.round((n.height-a.height)/(s.grid[1]||1))*(s.grid[1]||1);/^(se|s|e)$/.test(r)?(i.size.width=a.width+h,i.size.height=a.height+l):/^(ne)$/.test(r)?(i.size.width=a.width+h,i.size.height=a.height+l,i.position.top=o.top-l):/^(sw)$/.test(r)?(i.size.width=a.width+h,i.size.height=a.height+l,i.position.left=o.left-h):(i.size.width=a.width+h,i.size.height=a.height+l,i.position.top=o.top-l,i.position.left=o.left-h)}});var e=function(t){return parseInt(t,10)||0},i=function(t){return!isNaN(parseInt(t,10))}}(jQuery),function(t){t.widget("ui.selectable",t.ui.mouse,{version:"1.9.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var e=this;this.element.addClass("ui-selectable"),this.dragged=!1;var i;this.refresh=function(){i=t(e.options.filter,e.element[0]),i.addClass("ui-selectee"),i.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=i.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this;if(this.opos=[e.pageX,e.pageY],!this.options.disabled){var s=this.options;this.selectees=t(s.filter,this.element[0]),this._trigger("start",e),t(s.appendTo).append(this.helper),this.helper.css({left:e.clientX,top:e.clientY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=t.data(this,"selectable-item");s.startselected=!0,e.metaKey||e.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",e,{unselecting:s.element}))}),t(e.target).parents().andSelf().each(function(){var s=t.data(this,"selectable-item");if(s){var n=!e.metaKey&&!e.ctrlKey||!s.$element.hasClass("ui-selected");return s.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),s.unselecting=!n,s.selecting=n,s.selected=n,n?i._trigger("selecting",e,{selecting:s.element}):i._trigger("unselecting",e,{unselecting:s.element}),!1}})}},_mouseDrag:function(e){var i=this;if(this.dragged=!0,!this.options.disabled){var s=this.options,n=this.opos[0],a=this.opos[1],o=e.pageX,r=e.pageY;if(n>o){var h=o;o=n,n=h}if(a>r){var h=r;r=a,a=h}return this.helper.css({left:n,top:a,width:o-n,height:r-a}),this.selectees.each(function(){var h=t.data(this,"selectable-item");if(h&&h.element!=i.element[0]){var l=!1;"touch"==s.tolerance?l=!(h.left>o||h.right<n||h.top>r||h.bottom<a):"fit"==s.tolerance&&(l=h.left>n&&h.right<o&&h.top>a&&h.bottom<r),l?(h.selected&&(h.$element.removeClass("ui-selected"),h.selected=!1),h.unselecting&&(h.$element.removeClass("ui-unselecting"),h.unselecting=!1),h.selecting||(h.$element.addClass("ui-selecting"),h.selecting=!0,i._trigger("selecting",e,{selecting:h.element}))):(h.selecting&&((e.metaKey||e.ctrlKey)&&h.startselected?(h.$element.removeClass("ui-selecting"),h.selecting=!1,h.$element.addClass("ui-selected"),h.selected=!0):(h.$element.removeClass("ui-selecting"),h.selecting=!1,h.startselected&&(h.$element.addClass("ui-unselecting"),h.unselecting=!0),i._trigger("unselecting",e,{unselecting:h.element}))),h.selected&&(e.metaKey||e.ctrlKey||h.startselected||(h.$element.removeClass("ui-selected"),h.selected=!1,h.$element.addClass("ui-unselecting"),h.unselecting=!0,i._trigger("unselecting",e,{unselecting:h.element}))))}}),!1}},_mouseStop:function(e){var i=this;this.dragged=!1;this.options;return t(".ui-unselecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",e,{unselected:s.element})}),t(".ui-selecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",e,{selected:s.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}(jQuery),function(t){var e=5;t.widget("ui.slider",t.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var i,s,n=this.options,a=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",r=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(n.disabled?" ui-slider-disabled ui-disabled":"")),this.range=t([]),n.range&&(n.range===!0&&(n.values||(n.values=[this._valueMin(),this._valueMin()]),n.values.length&&2!==n.values.length&&(n.values=[n.values[0],n.values[0]])),this.range=t("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===n.range||"max"===n.range?" ui-slider-range-"+n.range:""))),s=n.values&&n.values.length||1,i=a.length;s>i;i++)r.push(o);this.handles=a.add(t(r.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(t){t.preventDefault()}).mouseenter(function(){n.disabled||t(this).addClass("ui-state-hover")}).mouseleave(function(){t(this).removeClass("ui-state-hover")}).focus(function(){n.disabled?t(this).blur():(t(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),t(this).addClass("ui-state-focus"))}).blur(function(){t(this).removeClass("ui-state-focus")}),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)}),this._on(this.handles,{keydown:function(i){var s,n,a,o,r=t(i.target).data("ui-slider-handle-index");switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(i.target).addClass("ui-state-active"),s=this._start(i,r),s===!1))return}switch(o=this.options.step,n=a=this.options.values&&this.options.values.length?this.values(r):this.value(),i.keyCode){case t.ui.keyCode.HOME:a=this._valueMin();break;case t.ui.keyCode.END:a=this._valueMax();break;case t.ui.keyCode.PAGE_UP:a=this._trimAlignValue(n+(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.PAGE_DOWN:a=this._trimAlignValue(n-(this._valueMax()-this._valueMin())/e);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(n===this._valueMax())return;a=this._trimAlignValue(n+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(n===this._valueMin())return;a=this._trimAlignValue(n-o)}this._slide(i,r,a)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,a,o,r,h,l,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));n>i&&(n=i,a=t(this),o=e)}),u.range===!0&&this.values(1)===u.min&&(o+=1,a=t(this.handles[o])),r=this._start(e,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!t(e.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-a.width()/2,top:e.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,a;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>s||1===e&&s>i)&&(i=s),i!==this.values(e)&&(n=this.values(),n[e]=i,a=this._trigger("slide",t,{handle:this.handles[e],value:i,values:n}),s=this.values(e?0:1),a!==!1&&this.values(e,i,!0))):i!==this.value()&&(a=this._trigger("slide",t,{handle:this.handles[e],value:i}),a!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var s,n,a;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(s=this.options.values,n=arguments[0],a=0;a<s.length;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch(t.isArray(this.options.values)&&(n=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"disabled":i?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);for(i=this.options.values.slice(),s=0;s<i.length;s+=1)i[s]=this._trimAlignValue(i[s]);return i},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=(h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())*100,c["horizontal"===h.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[l?"animate":"css"](c,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?(s-n)/(a-n)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](c,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))}})}(jQuery),function(t){t.widget("ui.sortable",t.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var s=this;if(this.reverting)return!1;if(this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(e);{var n=null;t(e.target).parents().each(function(){return t.data(this,s.widgetName+"-item")==s?(n=t(this),!1):void 0})}if(t.data(e.target,s.widgetName+"-item")==s&&(n=t(e.target)),!n)return!1;if(this.options.handle&&!i){var a=!1;if(t(this.options.handle,n).find("*").andSelf().each(function(){this==e.target&&(a=!0)}),!a)return!1}return this.currentItem=n,this._removeCurrentsFromItems(),!0},_mouseStart:function(e,i,s){var n=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),n.containment&&this._setContainment(),n.cursor&&(t("body").css("cursor")&&(this._storedCursor=t("body").css("cursor")),t("body").css("cursor",n.cursor)),n.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",n.opacity)),n.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",n.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(var a=this.containers.length-1;a>=0;a--)this.containers[a]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var i=this.options,s=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<i.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+i.scrollSpeed:e.pageY-this.overflowOffset.top<i.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-i.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<i.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+i.scrollSpeed:e.pageX-this.overflowOffset.left<i.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-i.scrollSpeed)):(e.pageY-t(document).scrollTop()<i.scrollSensitivity?s=t(document).scrollTop(t(document).scrollTop()-i.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<i.scrollSensitivity&&(s=t(document).scrollTop(t(document).scrollTop()+i.scrollSpeed)),e.pageX-t(document).scrollLeft()<i.scrollSensitivity?s=t(document).scrollLeft(t(document).scrollLeft()-i.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<i.scrollSensitivity&&(s=t(document).scrollLeft(t(document).scrollLeft()+i.scrollSpeed))),s!==!1&&t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)}this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var n=this.items.length-1;n>=0;n--){var a=this.items[n],o=a.item[0],r=this._intersectsWithPointer(a);if(r&&a.instance===this.currentContainer&&o!=this.currentItem[0]&&this.placeholder[1==r?"next":"prev"]()[0]!=o&&!t.contains(this.placeholder[0],o)&&("semi-dynamic"==this.options.type?!t.contains(this.element[0],o):!0)){if(this.direction=1==r?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(a))break;this._rearrange(e,a),this._trigger("change",e,this._uiHash());break}}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset();this.reverting=!0,t(this.helper).animate({left:n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=t.left,o=a+t.width,r=t.top,h=r+t.height,l=this.offset.click.top,c=this.offset.click.left,u=s+l>r&&h>s+l&&e+c>a&&o>e+c;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?u:a<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&r<s+this.helperProportions.height/2&&n-this.helperProportions.height/2<h},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),s="y"===this.options.axis||t.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),n=i&&s,a=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return n?this.floating?o&&"right"==o||"down"==a?2:1:a&&("down"==a?2:1):!1},_intersectsWithSides:function(e){var i=t.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),s=t.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return this.floating&&a?"right"==a&&s||"left"==a&&!s:n&&("down"==n&&i||"up"==n&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!=t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!=t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor==String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i=[],s=[],n=this._connectWith();if(n&&e)for(var a=n.length-1;a>=0;a--)for(var o=t(n[a]),r=o.length-1;r>=0;r--){var h=t.data(o[r],this.widgetName);h&&h!=this&&!h.options.disabled&&s.push([t.isFunction(h.options.items)?h.options.items.call(h.element):t(h.options.items,h.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),h])}s.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var a=s.length-1;a>=0;a--)s[a][0].each(function(){i.push(this)});return t(i)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]==t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i=this.items,s=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],n=this._connectWith();if(n&&this.ready)for(var a=n.length-1;a>=0;a--)for(var o=t(n[a]),r=o.length-1;r>=0;r--){var h=t.data(o[r],this.widgetName);h&&h!=this&&!h.options.disabled&&(s.push([t.isFunction(h.options.items)?h.options.items.call(h.element[0],e,{item:this.currentItem}):t(h.options.items,h.element),h]),this.containers.push(h))}for(var a=s.length-1;a>=0;a--)for(var l=s[a][1],c=s[a][0],r=0,u=c.length;u>r;r++){var d=t(c[r]);d.data(this.widgetName+"-item",l),i.push({item:d,instance:l,width:0,height:0,left:0,top:0})}},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var i=this.items.length-1;i>=0;i--){var s=this.items[i];if(s.instance==this.currentContainer||!this.currentContainer||s.item[0]==this.currentItem[0]){var n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item;e||(s.width=n.outerWidth(),s.height=n.outerHeight());var a=n.offset();s.left=a.left,s.top=a.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var i=this.containers.length-1;i>=0;i--){var a=this.containers[i].element.offset();this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}return this},_createPlaceholder:function(e){e=e||this;var i=e.options;if(!i.placeholder||i.placeholder.constructor==String){var s=i.placeholder;i.placeholder={element:function(){var i=t(document.createElement(e.currentItem[0].nodeName)).addClass(s||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return s||(i.style.visibility="hidden"),i},update:function(t,n){(!s||i.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}}e.placeholder=t(i.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),i.placeholder.update(e,e.placeholder)},_contactContainers:function(e){for(var i=null,s=null,n=this.containers.length-1;n>=0;n--)if(!t.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(i&&t.contains(this.containers[n].element[0],i.element[0]))continue;i=this.containers[n],s=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",e,this._uiHash(this)),this.containers[n].containerCache.over=0);if(i)if(1===this.containers.length)this.containers[s]._trigger("over",e,this._uiHash(this)),this.containers[s].containerCache.over=1;else{for(var a=1e4,o=null,r=this.containers[s].floating?"left":"top",h=this.containers[s].floating?"width":"height",l=this.positionAbs[r]+this.offset.click[r],c=this.items.length-1;c>=0;c--)if(t.contains(this.containers[s].element[0],this.items[c].item[0])&&this.items[c].item[0]!=this.currentItem[0]){var u=this.items[c].item.offset()[r],d=!1;Math.abs(u-l)>Math.abs(u+this.items[c][h]-l)&&(d=!0,u+=this.items[c][h]),Math.abs(u-l)<a&&(a=Math.abs(u-l),o=this.items[c],this.direction=d?"up":"down")}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[s],o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[s].element,!0),this._trigger("change",e,this._uiHash()),this.containers[s]._trigger("change",e,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[s]._trigger("over",e,this._uiHash(this)),this.containers[s].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"==i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!=i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(""==s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if("parent"==e.containment&&(e.containment=this.helper[0].parentNode),("document"==e.containment||"window"==e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"==e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(e.containment)){var i=t(e.containment)[0],s=t(e.containment).offset(),n="hidden"!=t(i).css("overflow");this.containment=[s.left+(parseInt(t(i).css("borderLeftWidth"),10)||0)+(parseInt(t(i).css("paddingLeft"),10)||0)-this.margins.left,s.top+(parseInt(t(i).css("borderTopWidth"),10)||0)+(parseInt(t(i).css("paddingTop"),10)||0)-this.margins.top,s.left+(n?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t(i).css("borderLeftWidth"),10)||0)-(parseInt(t(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,s.top+(n?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t(i).css("borderTopWidth"),10)||0)-(parseInt(t(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"==e?1:-1,n=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(e){var i=this.options,s="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(s[0].tagName);"relative"!=this.cssPosition||this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset());var a=e.pageX,o=e.pageY;if(this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid)){var r=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1];o=this.containment&&(r-this.offset.click.top<this.containment[1]||r-this.offset.click.top>this.containment[3])?r-this.offset.click.top<this.containment[1]?r+i.grid[1]:r-i.grid[1]:r;var h=this.originalPageX+Math.round((a-this.originalPageX)/i.grid[0])*i.grid[0];a=this.containment&&(h-this.offset.click.left<this.containment[0]||h-this.offset.click.left>this.containment[2])?h-this.offset.click.left<this.containment[0]?h+i.grid[0]:h-i.grid[0]:h}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:s.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:s.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n==this.counter&&this.refreshPositions(!s)})},_clear:function(e,i){this.reverting=!1;var s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var n in this._storedCSS)("auto"==this._storedCSS[n]||"static"==this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!i&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev==this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent==this.currentItem.parent()[0]||i||s.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(i||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))));for(var n=this.containers.length-1;n>=0;n--)i||s.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over&&(s.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[n])),this.containers[n].containerCache.over=0);if(this._storedCursor&&t("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!i){this._trigger("beforeStop",e,this._uiHash());for(var n=0;n<s.length;n++)s[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(i||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!i){for(var n=0;n<s.length;n++)s[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}(jQuery),function(t){function e(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.widget("ui.spinner",{version:"1.9.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh()},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);void 0!==n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",t)))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:void this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&t<s.min?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,void this.element.val(this._format(i))}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),this._super(t,e),"disabled"===t&&(e?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:e(function(t){this._super(t),this._value(this.element.val())}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:e(function(t){this._stepUp(t)}),_stepUp:function(t){this._spin((t||1)*this.options.step)},stepDown:e(function(t){this._stepDown(t)}),_stepDown:function(t){this._spin((t||1)*-this.options.step)},pageUp:e(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:e(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?void e(this._value).call(this,t):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(t,e){function i(){return++n}function s(t){return t.hash.length>1&&t.href.replace(a,"")===location.href.replace(a,"").replace(/\s/g,"%20")}var n=0,a=/#.*$/;t.widget("ui.tabs",{version:"1.9.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options,s=i.active,n=location.hash.substring(1);this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),null===s&&(n&&this.tabs.each(function(e,i){return t(i).attr("aria-controls")===n?(s=e,!1):void 0}),null===s&&(s=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===s||-1===s)&&(s=this.tabs.length?0:!1)),s!==!1&&(s=this.tabs.index(this.tabs.eq(s)),-1===s&&(s=i.collapsible?!1:0)),i.active=s,!i.collapsible&&i.active===!1&&this.anchors.length&&(i.active=0),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(this.options.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:s++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:n=!1,s--;break;case t.ui.keyCode.END:s=this.anchors.length-1;break;case t.ui.keyCode.HOME:s=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(s);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(s===this.options.active?!1:s);default:return}e.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),e.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){function s(){return e>n&&(e=0),0>e&&(e=n),e}for(var n=this.tabs.length-1;-1!==t.inArray(s(),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||this.options.active!==!1||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),function(t){return i.index(t)}),this._processTabs(),e.active!==!1&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return t("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each(function(i,n){var a,o,r,h=t(n).uniqueId().attr("id"),l=t(n).closest("li"),c=l.attr("aria-controls");s(n)?(a=n.hash,o=e.element.find(e._sanitizeSelector(a))):(r=e._tabId(l),a="#"+r,o=e.element.find(a),o.length||(o=e._createPanel(r),o.insertAfter(e.panels[i-1]||e.tablist)),o.attr("aria-live","polite")),o.length&&(e.panels=e.panels.add(o)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":a.substring(1),"aria-labelledby":h}),o.attr("aria-labelledby",h)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,s=0;i=this.tabs[s];s++)e===!0||-1!==t.inArray(s,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,s,n=this.element.parent();"fill"===e?(t.support.minHeight||(s=n.css("overflow"),n.css("overflow","hidden")),i=n.height(),this.element.siblings(":visible").each(function(){var e=t(this),s=e.css("position");"absolute"!==s&&"fixed"!==s&&(i-=e.outerHeight(!0))}),s&&n.css("overflow",s),this.element.children().not(this.panels).each(function(){i-=t(this).outerHeight(!0)}),this.panels.each(function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each(function(){i=Math.max(i,t(this).height("").height())}).height(i))},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?t():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):t(),c={oldTab:s,oldPanel:l,newTab:r?t():a,newPanel:h};e.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",e,c)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?t():a,this.xhr&&this.xhr.abort(),l.length||h.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),e),this._toggle(e,c))},_toggle:function(e,i){function s(){a.running=!1,a._trigger("activate",e,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===t(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,s=this._findActive(e);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return e===!1?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(),this.tabs.add(this.panels).each(function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i):e.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var s=this.options.disabled;s!==!1&&(i===e?s=!1:(i=this._getIndex(i),s=t.isArray(s)?t.map(s,function(t){return t!==i?t:null}):t.map(this.tabs,function(t,e){return e!==i?e:null})),this._setupDisabled(s))},disable:function(i){var s=this.options.disabled;if(s!==!0){if(i===e)s=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,s))return;s=t.isArray(s)?t.merge([i],s).sort():[i]}this._setupDisabled(s)}},load:function(e,i){e=this._getIndex(e);var n=this,a=this.tabs.eq(e),o=a.find(".ui-tabs-anchor"),r=this._getPanelForTab(a),h={tab:a,panel:r};s(o[0])||(this.xhr=t.ajax(this._ajaxSettings(o,i,h)),this.xhr&&"canceled"!==this.xhr.statusText&&(a.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(t){setTimeout(function(){r.html(t),n._trigger("load",i,h)},1)}).complete(function(t,e){setTimeout(function(){"abort"===e&&n.panels.stop(!1,!0),a.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),t===n.xhr&&delete n.xhr},1)})))},_ajaxSettings:function(e,i,s){var n=this;return{url:e.attr("href"),beforeSend:function(e,a){return n._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:a},s))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),t.uiBackCompat!==!1&&(t.ui.tabs.prototype._ui=function(t,e){return{tab:t,panel:e,index:this.anchors.index(t)}},t.widget("ui.tabs",t.ui.tabs,{url:function(t,e){this.anchors.eq(t).attr("href",e)}}),t.widget("ui.tabs",t.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var e=this;this._on({tabsbeforeload:function(i,s){return t.data(s.tab[0],"cache.tabs")?void i.preventDefault():void s.jqXHR.success(function(){e.options.cache&&t.data(s.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(e,i,s){var n=this.options.ajaxOptions;return t.extend({},n,{error:function(t,e){try{n.error(t,e,s.tab.closest("li").index(),s.tab[0])}catch(t){}}},this._superApply(arguments))},_setOption:function(t,e){"cache"===t&&e===!1&&this.anchors.removeData("cache.tabs"),this._super(t,e)},_destroy:function(){this.anchors.removeData("cache.tabs"),this._super()},url:function(t){this.anchors.eq(t).removeData("cache.tabs"),this._superApply(arguments)}}),t.widget("ui.tabs",t.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),t.widget("ui.tabs",t.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super(),this._on({tabsbeforeload:function(t,e){if(t.target===this.element[0]&&this.options.spinner){var i=e.tab.find("span"),s=i.html();i.html(this.options.spinner),e.jqXHR.complete(function(){i.html(s)})}}})}}),t.widget("ui.tabs",t.ui.tabs,{options:{enable:null,disable:null},enable:function(e){var i,s=this.options;(e&&s.disabled===!0||t.isArray(s.disabled)&&-1!==t.inArray(e,s.disabled))&&(i=!0),this._superApply(arguments),i&&this._trigger("enable",null,this._ui(this.anchors[e],this.panels[e]))},disable:function(e){var i,s=this.options;(e&&s.disabled===!1||t.isArray(s.disabled)&&-1===t.inArray(e,s.disabled))&&(i=!0),this._superApply(arguments),i&&this._trigger("disable",null,this._ui(this.anchors[e],this.panels[e]))}}),t.widget("ui.tabs",t.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(i,s,n){n===e&&(n=this.anchors.length);var a,o,r=this.options,h=t(r.tabTemplate.replace(/#\{href\}/g,i).replace(/#\{label\}/g,s)),l=i.indexOf("#")?this._tabId(h):i.replace("#","");return h.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0),h.attr("aria-controls",l),a=n>=this.tabs.length,o=this.element.find("#"+l),o.length||(o=this._createPanel(l),a?n>0?o.insertAfter(this.panels.eq(-1)):o.appendTo(this.element):o.insertBefore(this.panels[n])),o.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),a?h.appendTo(this.tablist):h.insertBefore(this.tabs[n]),r.disabled=t.map(r.disabled,function(t){return t>=n?++t:t}),this.refresh(),1===this.tabs.length&&r.active===!1&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[n],this.panels[n])),this},remove:function(e){e=this._getIndex(e);var i=this.options,s=this.tabs.eq(e).remove(),n=this._getPanelForTab(s).remove();return s.hasClass("ui-tabs-active")&&this.anchors.length>2&&this._activate(e+(e+1<this.anchors.length?1:-1)),i.disabled=t.map(t.grep(i.disabled,function(t){return t!==e}),function(t){return t>=e?--t:t}),this.refresh(),this._trigger("remove",null,this._ui(s.find("a")[0],n[0])),this}}),t.widget("ui.tabs",t.ui.tabs,{length:function(){return this.anchors.length}}),t.widget("ui.tabs",t.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(e){var s=e.is("li")?e.find("a[href]"):e;return s=s[0],t(s).closest("li").attr("aria-controls")||s.title&&s.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+i()}}),t.widget("ui.tabs",t.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(e){return t(this.options.panelTemplate).attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),t.widget("ui.tabs",t.ui.tabs,{_create:function(){var t=this.options;null===t.active&&t.selected!==e&&(t.active=-1===t.selected?!1:t.selected),this._super(),t.selected=t.active,t.selected===!1&&(t.selected=-1)},_setOption:function(t,e){if("selected"!==t)return this._super(t,e);var i=this.options;this._super("active",-1===e?!1:e),i.selected=i.active,i.selected===!1&&(i.selected=-1)},_eventHandler:function(){this._superApply(arguments),this.options.selected=this.options.active,this.options.selected===!1&&(this.options.selected=-1)}}),t.widget("ui.tabs",t.ui.tabs,{options:{show:null,select:null},_create:function(){this._super(),this.options.active!==!1&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(t,e,i){var s,n,a=this._superApply(arguments);return a?("beforeActivate"===t?(s=i.newTab.length?i.newTab:i.oldTab,n=i.newPanel.length?i.newPanel:i.oldPanel,a=this._super("select",e,{tab:s.find(".ui-tabs-anchor")[0],panel:n[0],index:s.closest("li").index()})):"activate"===t&&i.newTab.length&&(a=this._super("show",e,{tab:i.newTab.find(".ui-tabs-anchor")[0],panel:i.newPanel[0],index:i.newTab.closest("li").index()})),a):!1}}),t.widget("ui.tabs",t.ui.tabs,{select:function(t){if(t=this._getIndex(t),-1===t){if(!this.options.collapsible||-1===this.options.selected)return;t=this.options.selected}this.anchors.eq(t).trigger(this.options.event+this.eventNamespace)}}),function(){var e=0;t.widget("ui.tabs",t.ui.tabs,{options:{cookie:null},_create:function(){var t,e=this.options;null==e.active&&e.cookie&&(t=parseInt(this._cookie(),10),-1===t&&(t=!1),e.active=t),this._super()},_cookie:function(i){var s=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++e)];return arguments.length&&(s.push(i===!1?-1:i),s.push(this.options.cookie)),t.cookie.apply(null,s)},_refresh:function(){this._super(),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super(),this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),t.widget("ui.tabs",t.ui.tabs,{_trigger:function(e,i,s){var n=t.extend({},s);return"load"===e&&(n.panel=n.panel[0],n.tab=n.tab.find(".ui-tabs-anchor")[0]),this._super(e,i,n)}}),t.widget("ui.tabs",t.ui.tabs,{options:{fx:null},_getFx:function(){var e,i,s=this.options.fx;return s&&(t.isArray(s)?(e=s[0],i=s[1]):e=i=s),s?{show:i,hide:e}:null},_toggle:function(t,e){function i(){n.running=!1,n._trigger("activate",t,e)}function s(){e.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),a.length&&r.show?a.animate(r.show,r.show.duration,function(){i()}):(a.show(),i())}var n=this,a=e.newPanel,o=e.oldPanel,r=this._getFx();return r?(n.running=!0,void(o.length&&r.hide?o.animate(r.hide,r.hide.duration,function(){e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s()}):(e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o.hide(),s()))):this._super(t,e)}}))}(jQuery),function(t){function e(e,i){var s=(e.attr("aria-describedby")||"").split(/\s+/);s.push(i),e.data("ui-tooltip-id",i).attr("aria-describedby",t.trim(s.join(" ")))}function i(e){var i=e.data("ui-tooltip-id"),s=(e.attr("aria-describedby")||"").split(/\s+/),n=t.inArray(i,s);-1!==n&&s.splice(n,1),e.removeData("ui-tooltip-id"),s=t.trim(s.join(" ")),s?e.attr("aria-describedby",s):e.removeAttr("aria-describedby")}var s=0;t.widget("ui.tooltip",{version:"1.9.2",options:{content:function(){return t(this).attr("title")},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,i){var s=this;return"disabled"===e?(this[i?"_disable":"_enable"](),void(this.options[e]=i)):(this._super(e,i),void("content"===e&&t.each(this.tooltips,function(t,e){s._updateContent(e)})))},_disable:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0)}),this.element.find(this.options.items).andSelf().each(function(){var e=t(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var e=t(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var i=this,s=t(e?e.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&s.parents().each(function(){var e,s=t(this);s.data("ui-tooltip-open")&&(e=t.Event("blur"),e.target=e.currentTarget=this,i.close(e,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._updateContent(s,e))},_updateContent:function(t,e){var i,s=this.options.content,n=this,a=e?e.type:null;return"string"==typeof s?this._open(e,t,s):(i=s.call(t[0],function(i){t.data("ui-tooltip-open")&&n._delay(function(){e&&(e.type=a),this._open(e,t,i)})}),void(i&&this._open(e,t,i)))},_open:function(i,s,n){function a(t){l.of=t,o.is(":hidden")||o.position(l)}var o,r,h,l=t.extend({},this.options.position);if(n){if(o=this._find(s),o.length)return void o.find(".ui-tooltip-content").html(n);s.is("[title]")&&(i&&"mouseover"===i.type?s.attr("title",""):s.removeAttr("title")),o=this._tooltip(s),e(s,o.attr("id")),o.find(".ui-tooltip-content").html(n),this.options.track&&i&&/^mouse/.test(i.type)?(this._on(this.document,{mousemove:a}),a(i)):o.position(t.extend({of:s},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(h=setInterval(function(){o.is(":visible")&&(a(l.of),clearInterval(h))},t.fx.interval)),this._trigger("open",i,{tooltip:o}),r={keyup:function(e){if(e.keyCode===t.ui.keyCode.ESCAPE){var i=t.Event(e);i.currentTarget=s[0],this.close(i,!0)}},remove:function(){this._removeTooltip(o)}},i&&"mouseover"!==i.type||(r.mouseleave="close"),i&&"focusin"!==i.type||(r.focusout="close"),this._on(!0,s,r)}},close:function(e){var s=this,n=t(e?e.currentTarget:this.element),a=this._find(n);this.closing||(n.data("ui-tooltip-title")&&n.attr("title",n.data("ui-tooltip-title")),i(n),a.stop(!0),this._hide(a,this.options.hide,function(){s._removeTooltip(t(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),e&&"mouseleave"===e.type&&t.each(this.parents,function(e,i){t(i.element).attr("title",i.title),delete s.parents[e]}),this.closing=!0,this._trigger("close",e,{tooltip:a}),this.closing=!1)},_tooltip:function(e){var i="ui-tooltip-"+s++,n=t("<div>").attr({id:i,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return t("<div>").addClass("ui-tooltip-content").appendTo(n),n.appendTo(this.document[0].body),t.fn.bgiframe&&n.bgiframe(),this.tooltips[i]=e,n},_find:function(e){var i=e.data("ui-tooltip-id");return i?t("#"+i):t()},_removeTooltip:function(t){t.remove(),delete this.tooltips[t.attr("id")]},_destroy:function(){var e=this;t.each(this.tooltips,function(i,s){var n=t.Event("blur");n.target=n.currentTarget=s[0],e.close(n,!0),t("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))})}})}(jQuery);
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,j=i.bind,w=function(n){return n instanceof w?n:this instanceof w?void(this._wrapped=n):new w(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):n._=w,w.VERSION="1.4.4";var A=w.each=w.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(w.has(n,a)&&t.call(e,n[a],a,n)===r)return};w.map=w.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)};var O="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=w.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},w.reduceRight=w.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=w.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=w.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},w.find=w.detect=function(n,t,r){var e;return E(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},w.filter=w.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},w.reject=function(n,t,r){return w.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},w.every=w.all=function(n,t,e){t||(t=w.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var E=w.some=w.any=function(n,t,e){t||(t=w.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};w.contains=w.include=function(n,t){return null==n?!1:y&&n.indexOf===y?-1!=n.indexOf(t):E(n,function(n){return n===t})},w.invoke=function(n,t){var r=o.call(arguments,2),e=w.isFunction(t);return w.map(n,function(n){return(e?t:n[t]).apply(n,r)})},w.pluck=function(n,t){return w.map(n,function(n){return n[t]})},w.where=function(n,t,r){return w.isEmpty(t)?r?null:[]:w[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},w.findWhere=function(n,t){return w.where(n,t,!0)},w.max=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&w.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},w.min=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&w.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},w.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=w.random(r++),e[r-1]=e[t],e[t]=n}),e};var k=function(n){return w.isFunction(n)?n:function(t){return t[n]}};w.sortBy=function(n,t,r){var e=k(t);return w.pluck(w.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(e>r||void 0===e)return-1}return n.index<t.index?-1:1}),"value")};var F=function(n,t,r,e){var u={},i=k(t||w.identity);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};w.groupBy=function(n,t,r){return F(n,t,r,function(n,t,r){(w.has(n,t)?n[t]:n[t]=[]).push(r)})},w.countBy=function(n,t,r){return F(n,t,r,function(n,t){w.has(n,t)||(n[t]=0),n[t]++})},w.sortedIndex=function(n,t,r,e){r=null==r?w.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},w.toArray=function(n){return n?w.isArray(n)?o.call(n):n.length===+n.length?w.map(n,w.identity):w.values(n):[]},w.size=function(n){return null==n?0:n.length===+n.length?n.length:w.keys(n).length},w.first=w.head=w.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},w.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},w.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},w.rest=w.tail=w.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},w.compact=function(n){return w.filter(n,w.identity)};var R=function(n,t,r){return A(n,function(n){w.isArray(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r};w.flatten=function(n,t){return R(n,t,[])},w.without=function(n){return w.difference(n,o.call(arguments,1))},w.uniq=w.unique=function(n,t,r,e){w.isFunction(t)&&(e=r,r=t,t=!1);var u=r?w.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:w.contains(a,r))||(a.push(r),i.push(n[e]))}),i},w.union=function(){return w.uniq(c.apply(e,arguments))},w.intersection=function(n){var t=o.call(arguments,1);return w.filter(w.uniq(n),function(n){return w.every(t,function(t){return w.indexOf(t,n)>=0})})},w.difference=function(n){var t=c.apply(e,o.call(arguments,1));return w.filter(n,function(n){return!w.contains(t,n)})},w.zip=function(){for(var n=o.call(arguments),t=w.max(w.pluck(n,"length")),r=new Array(t),e=0;t>e;e++)r[e]=w.pluck(n,""+e);return r},w.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},w.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=w.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},w.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},w.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i},w.bind=function(n,t){if(n.bind===j&&j)return j.apply(n,o.call(arguments,1));var r=o.call(arguments,2);return function(){return n.apply(t,r.concat(o.call(arguments)))}},w.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},w.bindAll=function(n){var t=o.call(arguments,1);return 0===t.length&&(t=w.functions(n)),A(t,function(t){n[t]=w.bind(n[t],n)}),n},w.memoize=function(n,t){var r={};return t||(t=w.identity),function(){var e=t.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},w.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},w.defer=function(n){return w.delay.apply(w,[n,1].concat(o.call(arguments,1)))},w.throttle=function(n,t){var r,e,u,i,a=0,o=function(){a=new Date,u=null,i=n.apply(r,e)};return function(){var c=new Date,l=t-(c-a);return r=this,e=arguments,0>=l?(clearTimeout(u),u=null,a=c,i=n.apply(r,e)):u||(u=setTimeout(o,l)),i}},w.debounce=function(n,t,r){var e,u;return function(){var i=this,a=arguments,o=function(){e=null,r||(u=n.apply(i,a))},c=r&&!e;return clearTimeout(e),e=setTimeout(o,t),c&&(u=n.apply(i,a)),u}},w.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},w.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},w.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},w.after=function(n,t){return 0>=n?t():function(){return--n<1?t.apply(this,arguments):void 0}},w.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)w.has(n,r)&&(t[t.length]=r);return t},w.values=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push(n[r]);return t},w.pairs=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push([r,n[r]]);return t},w.invert=function(n){var t={};for(var r in n)w.has(n,r)&&(t[n[r]]=r);return t},w.functions=w.methods=function(n){var t=[];for(var r in n)w.isFunction(n[r])&&t.push(r);return t.sort()},w.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},w.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},w.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)w.contains(r,u)||(t[u]=n[u]);return t},w.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)null==n[r]&&(n[r]=t[r])}),n},w.clone=function(n){return w.isObject(n)?w.isArray(n)?n.slice():w.extend({},n):n},w.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof w&&(n=n._wrapped),t instanceof w&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;r.push(n),e.push(t);var a=0,o=!0;if("[object Array]"==u){if(a=n.length,o=a==t.length)for(;a--&&(o=S(n[a],t[a],r,e)););}else{var c=n.constructor,f=t.constructor;if(c!==f&&!(w.isFunction(c)&&c instanceof c&&w.isFunction(f)&&f instanceof f))return!1;for(var s in n)if(w.has(n,s)&&(a++,!(o=w.has(t,s)&&S(n[s],t[s],r,e))))break;if(o){for(s in t)if(w.has(t,s)&&!a--)break;o=!a}}return r.pop(),e.pop(),o};w.isEqual=function(n,t){return S(n,t,[],[])},w.isEmpty=function(n){if(null==n)return!0;if(w.isArray(n)||w.isString(n))return 0===n.length;for(var t in n)if(w.has(n,t))return!1;return!0},w.isElement=function(n){return!(!n||1!==n.nodeType)},w.isArray=x||function(n){return"[object Array]"==l.call(n)},w.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){w["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),w.isArguments(arguments)||(w.isArguments=function(n){return!(!n||!w.has(n,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(n){return"function"==typeof n}),w.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},w.isNaN=function(n){return w.isNumber(n)&&n!=+n},w.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},w.isNull=function(n){return null===n},w.isUndefined=function(n){return void 0===n},w.has=function(n,t){return f.call(n,t)},w.noConflict=function(){return n._=t,this},w.identity=function(n){return n},w.times=function(n,t,r){for(var e=Array(n),u=0;n>u;u++)e[u]=t.call(r,u);return e},w.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=w.invert(I.escape);var M={escape:new RegExp("["+w.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+w.keys(I.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(n){w[n]=function(t){return null==t?"":(""+t).replace(M[n],function(t){return I[n][t]})}}),w.result=function(n,t){if(null==n)return null;var r=n[t];return w.isFunction(r)?r.call(n):r},w.mixin=function(n){A(w.functions(n),function(t){var r=w[t]=n[t];w.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,r.apply(w,n))}})};var N=0;w.uniqueId=function(n){var t=++N+"";return n?n+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(n,t,r){var e;r=w.defaults({},r,w.templateSettings);var u=new RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(B,function(n){return"\\"+q[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(n){throw n.source=a,n}if(t)return e(t,w);var o=function(n){return e.call(this,n,w)};return o.source="function("+(r.variable||"obj")+"){\n"+a+"}",o},w.chain=function(n){return w(n).chain()};var D=function(n){return this._chain?w(n).chain():n};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];w.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],D.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];w.prototype[n]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);
(function(){var t,e=this,i=e.Backbone,s=[],n=s.push,r=s.slice,a=s.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="1.0.0";var o=e._;o||"undefined"==typeof require||(o=require("underscore")),t.$=e.jQuery||e.Zepto||e.ender||e.$,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var h=t.Events={on:function(t,e,i){if(!c(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var s=this._events[t]||(this._events[t]=[]);return s.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var s=this,n=o.once(function(){s.off(t,n),e.apply(this,arguments)});return n._callback=e,this.on(t,n,i)},off:function(t,e,i){var s,n,r,a,h,u,l,d;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i)return this._events={},this;for(a=t?[t]:o.keys(this._events),h=0,u=a.length;u>h;h++)if(t=a[h],r=this._events[t]){if(this._events[t]=s=[],e||i)for(l=0,d=r.length;d>l;l++)n=r[l],(e&&e!==n.callback&&e!==n.callback._callback||i&&i!==n.context)&&s.push(n);s.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!c(this,"trigger",t,e))return this;var i=this._events[t],s=this._events.all;return i&&l(i,e),s&&l(s,arguments),this},stopListening:function(t,e,i){var s=this._listeners;if(!s)return this;var n=!e&&!i;"object"==typeof e&&(i=this),t&&((s={})[t._listenerId]=t);for(var r in s)s[r].off(e,i,this),n&&delete this._listeners[r];return this}},u=/\s+/,c=function(t,e,i,s){if(!i)return!0;if("object"==typeof i){for(var n in i)t[e].apply(t,[n,i[n]].concat(s));return!1}if(u.test(i)){for(var r=i.split(u),a=0,o=r.length;o>a;a++)t[e].apply(t,[r[a]].concat(s));return!1}return!0},l=function(t,e){var i,s=-1,n=t.length,r=e[0],a=e[1],o=e[2];switch(e.length){case 0:for(;++s<n;)(i=t[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=t[s]).callback.call(i.ctx,r);return;case 2:for(;++s<n;)(i=t[s]).callback.call(i.ctx,r,a);return;case 3:for(;++s<n;)(i=t[s]).callback.call(i.ctx,r,a,o);return;default:for(;++s<n;)(i=t[s]).callback.apply(i.ctx,e)}},d={listenTo:"on",listenToOnce:"once"};o.each(d,function(t,e){h[e]=function(e,i,s){var n=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=o.uniqueId("l"));return n[r]=e,"object"==typeof i&&(s=this),e[t](i,s,this),this}}),h.bind=h.on,h.unbind=h.off,o.extend(t,h);var f=t.Model=function(t,e){var i,s=t||{};e||(e={}),this.cid=o.uniqueId("c"),this.attributes={},o.extend(this,o.pick(e,p)),e.parse&&(s=this.parse(s,e)||{}),(i=o.result(this,"defaults"))&&(s=o.defaults({},s,i)),this.set(s,e),this.changed={},this.initialize.apply(this,arguments)},p=["url","urlRoot","collection"];o.extend(f.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return o.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return o.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,i){var s,n,r,a,h,u,c,l;if(null==t)return this;if("object"==typeof t?(n=t,i=e):(n={})[t]=e,i||(i={}),!this._validate(n,i))return!1;r=i.unset,h=i.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=o.clone(this.attributes),this.changed={}),l=this.attributes,c=this._previousAttributes,this.idAttribute in n&&(this.id=n[this.idAttribute]);for(s in n)e=n[s],o.isEqual(l[s],e)||a.push(s),o.isEqual(c[s],e)?delete this.changed[s]:this.changed[s]=e,r?delete l[s]:l[s]=e;if(!h){a.length&&(this._pending=!0);for(var d=0,f=a.length;f>d;d++)this.trigger("change:"+a[d],this,l[a[d]],i)}if(u)return this;if(!h)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,o.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,o.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!o.isEmpty(this.changed):o.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1;var e,i=!1,s=this._changing?this._previousAttributes:this.attributes;for(var n in t)o.isEqual(s[n],e=t[n])||((i||(i={}))[n]=e);return i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,i=t.success;return t.success=function(s){return e.set(e.parse(s,t),t)?(i&&i(e,s,t),void e.trigger("sync",e,s,t)):!1},R(this,t),this.sync("read",this,t)},save:function(t,e,i){var s,n,r,a=this.attributes;if(null==t||"object"==typeof t?(s=t,i=e):(s={})[t]=e,!(!s||i&&i.wait||this.set(s,i)))return!1;if(i=o.extend({validate:!0},i),!this._validate(s,i))return!1;s&&i.wait&&(this.attributes=o.extend({},a,s)),void 0===i.parse&&(i.parse=!0);var h=this,u=i.success;return i.success=function(t){h.attributes=a;var e=h.parse(t,i);return i.wait&&(e=o.extend(s||{},e)),o.isObject(e)&&!h.set(e,i)?!1:(u&&u(h,t,i),void h.trigger("sync",h,t,i))},R(this,i),n=this.isNew()?"create":i.patch?"patch":"update","patch"===n&&(i.attrs=s),r=this.sync(n,this,i),s&&i.wait&&(this.attributes=a),r},destroy:function(t){t=t?o.clone(t):{};var e=this,i=t.success,s=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(n){(t.wait||e.isNew())&&s(),i&&i(e,n,t),e.isNew()||e.trigger("sync",e,n,t)},this.isNew())return t.success(),!1;R(this,t);var n=this.sync("delete",this,t);return t.wait||s(),n},url:function(){var t=o.result(this,"urlRoot")||o.result(this.collection,"url")||U();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},o.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=o.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,o.extend(e||{},{validationError:i})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];o.each(g,function(t){f.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.attributes),o[t].apply(o,e)}});var v=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,o.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};o.extend(v.prototype,h,{model:f,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,o.defaults(e||{},y))},remove:function(t,e){t=o.isArray(t)?t.slice():[t],e||(e={});var i,s,n,r;for(i=0,s=t.length;s>i;i++)r=this.get(t[i]),r&&(delete this._byId[r.id],delete this._byId[r.cid],n=this.indexOf(r),this.models.splice(n,1),this.length--,e.silent||(e.index=n,r.trigger("remove",r,this,e)),this._removeReference(r));return this},set:function(t,e){e=o.defaults(e||{},m),e.parse&&(t=this.parse(t,e)),o.isArray(t)||(t=t?[t]:[]);var i,s,r,h,u,c=e.at,l=this.comparator&&null==c&&e.sort!==!1,d=o.isString(this.comparator)?this.comparator:null,f=[],p=[],g={};for(i=0,s=t.length;s>i;i++)(r=this._prepareModel(t[i],e))&&((h=this.get(r))?(e.remove&&(g[h.cid]=!0),e.merge&&(h.set(r.attributes,e),l&&!u&&h.hasChanged(d)&&(u=!0))):e.add&&(f.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)));if(e.remove){for(i=0,s=this.length;s>i;++i)g[(r=this.models[i]).cid]||p.push(r);p.length&&this.remove(p,e)}if(f.length&&(l&&(u=!0),this.length+=f.length,null!=c?a.apply(this.models,[c,0].concat(f)):n.apply(this.models,f)),u&&this.sort({silent:!0}),e.silent)return this;for(i=0,s=f.length;s>i;i++)(r=f[i]).trigger("add",r,this,e);return u&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var i=0,s=this.models.length;s>i;i++)this._removeReference(this.models[i]);return e.previousModels=this.models,this._reset(),this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return o.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),o.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(o.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,i){e||(e=this.comparator);var s=o.isFunction(e)?e:function(t){return t.get(e)};return o.sortedIndex(this.models,t,s,i)},pluck:function(t){return o.invoke(this.models,"get",t)},fetch:function(t){t=t?o.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,i=this;return t.success=function(s){var n=t.reset?"reset":"set";i[n](s,t),e&&e(i,s,t),i.trigger("sync",i,s,t)},R(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?o.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var i=this,s=e.success;return e.success=function(n){e.wait&&i.add(t,e),s&&s(t,n,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof f)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var i=new this.model(t,e);return i._validate(t,e)?i:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,s){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,s),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var _=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];o.each(_,function(t){v.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.models),o[t].apply(o,e)}});var b=["groupBy","countBy","sortBy"];o.each(b,function(t){v.prototype[t]=function(e,i){var s=o.isFunction(e)?e:function(t){return t.get(e)};return o[t](this.models,s,i)}});var w=t.View=function(t){this.cid=o.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,E=["model","collection","el","id","attributes","className","tagName","events"];o.extend(w.prototype,h,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=o.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(o.isFunction(i)||(i=this[t[e]]),i){var s=e.match(x),n=s[1],r=s[2];i=o.bind(i,this),n+=".delegateEvents"+this.cid,""===r?this.$el.on(n,i):this.$el.on(n,r,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=o.extend({},o.result(this,"options"),t)),o.extend(this,o.pick(t,E)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(o.result(this,"el"),!1);else{var e=o.extend({},o.result(this,"attributes"));this.id&&(e.id=o.result(this,"id")),this.className&&(e.class=o.result(this,"className"));var i=t.$("<"+o.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,s){var n=k[e];o.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:n,dataType:"json"};if(s.url||(r.url=o.result(i,"url")||U()),null!=s.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(s.attrs||i.toJSON(s))),s.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),s.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){r.type="POST",s.emulateJSON&&(r.data._method=n);var a=s.beforeSend;s.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",n),a?a.apply(this,arguments):void 0}}"GET"===r.type||s.emulateJSON||(r.processData=!1),"PATCH"!==r.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var h=s.xhr=t.ajax(o.extend(r,s));return i.trigger("request",i,h,s),h};var k={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},$=/\((.*?)\)/g,T=/(\(\?)?:\w+/g,H=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;o.extend(S.prototype,h,{initialize:function(){},route:function(e,i,s){o.isRegExp(e)||(e=this._routeToRegExp(e)),o.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var n=this;return t.history.route(e,function(r){var a=n._extractParameters(e,r);s&&s.apply(n,a),n.trigger.apply(n,["route:"+i].concat(a)),n.trigger("route",i,a),t.history.trigger("route",n,i,a)}),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=o.result(this,"routes");for(var t,e=o.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(A,"\\$&").replace($,"(?:$1)?").replace(T,function(t,e){return e?t:"([^/]+)"}).replace(H,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return o.map(i,function(t){return t?decodeURIComponent(t):null})}});var I=t.History=function(){this.handlers=[],o.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,O=/msie [\w.]+/,C=/\/$/;I.started=!1,o.extend(I.prototype,h,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,"");t.indexOf(i)||(t=t.substr(i.length))}else t=this.getHash();return t.replace(N,"")},start:function(e){if(I.started)throw new Error("Backbone.history has already been started");I.started=!0,this.options=o.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),s=document.documentMode,n=O.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);this.root=("/"+this.root+"/").replace(P,"/"),n&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(i)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var r=this.location,a=r.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&r.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),I.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),i=o.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return i},navigate:function(t,e){if(!I.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var i=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,i){if(i){var s=t.href.replace(/(javascript:|#).*$/,"");t.replace(s+"#"+e)}else t.hash="#"+e}}),t.history=new I;var j=function(t,e){var i,s=this;i=t&&o.has(t,"constructor")?t.constructor:function(){return s.apply(this,arguments)},o.extend(i,s,e);var n=function(){this.constructor=i};return n.prototype=s.prototype,i.prototype=new n,t&&o.extend(i.prototype,t),i.__super__=s.prototype,i};f.extend=v.extend=S.extend=w.extend=I.extend=j;var U=function(){throw new Error('A "url" property or function must be specified')},R=function(t,e){var i=e.error;e.error=function(s){i&&i(t,s,e),t.trigger("error",t,s,e)}}}).call(this);
!function(t){function n(t,n){return"MODIFY"==n.mode?t*=parseFloat(n.value):"OFFSET"==n.mode?t+=parseFloat(n.value):"ABSOLUTE"==n.mode&&(t=parseFloat(n.value)),t}window.zoho={color:{darken:function(t,n){n=zoho.math.limit(n,0,1);var r=[{mode:"MODIFY",value:1-n}];return this.hsl(t,{luminance:r})},lighten:function(t,n){n=zoho.math.limit(n,0,1);var r=[{mode:"MODIFY",value:1-n},{mode:"OFFSET",value:n}];return this.hsl(t,{luminance:r})},shade:function(t,n){n=zoho.math.limit(n,0,1);var r=[{mode:"MODIFY",value:n}];return this.rgb(t,{red:r,green:r,blue:r})},tint:function(t,n){n=zoho.math.limit(n,0,1);var r=[{mode:"MODIFY",value:n},{mode:"OFFSET",value:1-n}];return this.rgb(t,{red:r,green:r,blue:r})},blue:2,green:1,red:0,rgb:function(t,n){return this.modify(t,n,"scRGB")},luminance:2,saturation:1,hue:0,modify:function(r,e,a){var o=this["to"+a].call(this,r),i=this;return t.each(e,function(r,e){var a=i[r];t.each(e,function(t,r){o[a]=n(o[a],r),o[a]=zoho.math.limit(o[a],0,1)})}),this[a+"toRGB"].call(this,o)},hsl:function(t,n){return this.modify(t,n,"HSL")},tweak:function(n,r){if(!t.isArray(n)){var e=n;n=[e[0],e[1],e[2]]}n=zoho.array.toNum(n);var e=this;return t.each(r,function(t,r){e[t]&&(n=e[t].call(e,n,r))}),n},toscRGB:function(n){return n=t.map(n,function(t){if(t/=255,0>t)return 0;if(.0405>=t)return t/12.92;if(1>=t){var n=(t+.055)/1.055;return Math.pow(n,2.4)}return 1})},scRGBtoRGB:function(n){return n=t.map(n,function(t){if(0>t)t=0;else if(.0031308>=t)t*=12.92;else if(1>=t){var n=1/2.4;t=1.055*Math.pow(t,n)-.055}else t=1;return Math.round(t*=255)})},toHSL:function(t){var n=t[0],r=t[1],e=t[2],a=Math.max(n,r,e),o=Math.min(n,r,e),i=0;if(a==o);else if(a==n){var u=(r-e)/(a-o);i=(60*u+360)%360}else if(a==r){var u=(e-n)/(a-o);i=60*u+120}else{var u=(n-r)/(a-o);i=60*u+240}i/=360;var c=(a+o)/510,h=0;return a==o||(h=.5>=c?(a-o)/(2*c):(a-o)/(2-2*c)),h/=255,[i,h,c]},HSLtoRGB:function(n){var r,e=n[0],a=n[1],o=n[2];r=.5>o?o*(1+a):o+a-o*a;var i=2*o-r,u=e,c=u+1/3,h=u,s=u-1/3,f=[c,h,s];return f=t.map(f,function(t){0>t?t+=1:t>1&&(t-=1),t%=1,t=1/6>t?i+6*(r-i)*t:t>=1/6&&.5>t?r:t>=.5&&2/3>t?i+6*(r-i)*(2/3-t):i;var n=Math.round(255*t);return n=zoho.math.limit(n,0,255)})},isDark:function(t){return this.brightness(t)<127.5},rgbToHex:function(n){if("object"!=typeof n){var r=/rgb|rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)/;if(null!=n.match(r)){var e=/\d{1,3}/g;n=n.match(e)}}var a="#";return t.each(n,function(t,n){var r=zoho.color.numToHex(n);isNaN(zoho.color.hexToNum(r))&&(r="00"),a+=r}),a},RGBToHSV:function(t){var n=t[0]/255,r=t[1]/255,e=t[2]/255,a=Math.min(n,r,e),o=Math.max(n,r,e),i=100*o,u=s=0,c=o-a;if(0==o)return s=u=0,[u,s,i];s=c/o*100;var h=0;c&&(h=n==o?(r-e)/c:r==o?2+(e-n)/c:4+(n-r)/c),u=60*h,0>u&&(u+=360);var f=Math.round;return u=f(u),s=f(s),i=f(i),[u,s,i]},HSVToRGB:function(t){var n=t[0],r=t[1],e=t[2],a=r/100,o=e/100,i=g=b=0,u=function(t,n,r){var e=Math.round;i=e(255*t),g=e(255*n),b=e(255*r)};if(0==a)return u(o,o,o),[i,g,b];360==n&&(n=0);var c=n/60,h=Math.floor(c),s=c-h,f=o*(1-a),l=o*(1-a*s),m=o*(1-a*(1-s));switch(h){case 0:u(o,m,f);break;case 1:u(l,o,f);break;case 2:u(f,o,m);break;case 3:u(f,l,o);break;case 4:u(m,f,o);break;default:u(o,f,l)}return[i,g,b]},hexToRgb:function(n,r){if(n=n.replace("#",""),3==n.length&&(n+=n),6!=n.length){if(!r)return"rgb(0, 0, 0)";n=r}var e="rgb(",a="";return t.each(n.split(""),function(t,n){a=!t%2?n:a+n,t%2&&(_v=zoho.color.hexToNum(a),isNaN(_v)&&(_v=0),e+=_v,4>=t&&(e+=","),a="")}),e+=")"},numToHex:function(t){var n=parseInt(t).toString(16);return 1==n.length?"0"+n:n},hexToNum:function(t){return parseInt(t,16)},brightness:function(t){var n=t[0],r=t[1],e=t[2],a=.299*n+.587*r+.114*e;return a}},math:{limit:function(t,n,r){var e=Math.min(t,r);return Math.max(e,n)},maxLimit:function(t,n){return Math.min(t,n)},minLimit:function(t,n){return Math.max(t,n)},toRadians:function(t){return t*(Math.PI/180)},toDegrees:function(t){return t*(180/Math.PI)},getRotatedValue:function(t,n,r,e,a){var o={},i=zoho.math.toRadians(t);o.a=Math.cos(i),o.c=-1*Math.sin(i),o.b=Math.sin(i),o.d=Math.cos(i),o.e=a*o.b-e*o.d+e,o.f=a-e*o.b-a*o.d;var u=n*o.a+r*o.c+o.e,c=n*o.b+r*o.d+o.f;return{x:u,y:c}},getAngle:function(t,n,r,e,a,o){var i=2*Math.PI;a=a?a:r,o=o?o:e;var u=(n-o)*r,c=(t-a)*e,h=Math.atan2(u,c);return h+=i,h%=i},bezierPoint:function(t,n,r,e,a){var o=Math.pow(1-a,3)*t+3*Math.pow(1-a,2)*a*n+3*(1-a)*Math.pow(a,2)*r+Math.pow(a,3)*e;return o},length:function(t,n,r,e){return Math.sqrt(Math.pow(r-t,2)+Math.pow(e-n,2))},getPointAtDistance:function(t,n){var r=t.start,e=t.end,a=zoho.math.length(r.x,r.y,e.x,e.y);return{x:r.x+n/a*(e.x-r.x),y:r.y+n/a*(e.y-r.y)}},distanceOf:function(t,n,r,e,a){var o=n.y-t.y;a&&(o*=-1);var i=t.x-n.x;a&&(i*=-1);var u=-1*i*t.y-o*t.x,c=Math.sqrt(Math.pow(o,2)+Math.pow(i,2)),h=c?(o*r+i*e+u)/c:0;return h},toCubicControlPoints:function(t,n,r,e,a,o){var i=2/3,u=1/3,c=i*r+u*t,h=i*e+u*n,s=i*r+u*a,f=i*e+u*o;return[c,h,s,f]},ifElse:function(t,n,r){return t>0?n:r},cosTan:function(t,n,r){return t*Math.cos(Math.atan2(r,n))},sinTan:function(t,n,r){return t*Math.sin(Math.atan2(r,n))},roundDecimal:function(t,n){var r=Math.pow(10,n),e=Math.round(t*r)/r;return e},modulo:function(t,n){t=parseFloat(t),n=parseFloat(n);var r=zoho.math._getFloatingPointLength,e=Math.pow(10,Math.max(r(t),r(n)));return t*e%(n*e)/e},_getFloatingPointLength:function(t){var n=t.toString().split(".")[1];return n?n.length:0},midPoint:function(t,n){return{x:.5*(t.x+n.x),y:.5*(t.y+n.y)}},getDiff:function(t,n,r){return r||(r=1),{x:(t.x-n.x)*r,y:(t.y-n.y)*r}},gcd:function(t,n){return 0==n?t:this.gcd(n,t%n)}},array:{toNum:function(n){return t.map(n,function(t){return 1*t})},sort:function(t,n){return t.sort(zoho.array.sortnum),n&&t.reverse(),t},sortnum:function(t,n){return t-n},compareXY:function(t,n){return t.small?t.small-n.small:t.big?t.big-n.big:void 0},compareZindex:function(t,n){return t.zindex-n.zindex},diff:function(t,n){for(var r=[],e=0;t.length>e;e++)-1==n.indexOf(t[e])&&r.push(t[e]);return r},unique:function(n){var r,e=[],a=n.length;for(r=0;a>r;r++)t.inArray(n[r],e)<0&&e.push(n[r]);return e},clear:function(t){t.splice(0,t.length)}},string:{removeSpace:function(t){return t.replace(/\s+/g,"")}},customMerge:function(){var n,r,e,a,o,i,u=arguments[0]||{},c=1,h=arguments.length,s=!1;if(("boolean"==typeof u||t.isObject(u)&&(u.deep||u.overwrite))&&(s=u.deep?u.deep:u,o=u.overwrite?u.overwrite:[],i=u,u=arguments[1]||{},c=2),"object"==typeof u||t.isFunction(u)||(u={}),h===c)return u;for(;h>c;c++)if(null!=(n=arguments[c]))for(r in n)if(e=u[r],a=n[r],u!==a)if(s&&a&&(t.isPlainObject(a)||t.isArray(a))){var f=e&&(t.isPlainObject(e)||t.isArray(e))?e:t.isArray(a)?[]:{},l=e&&i.skip&&-1!=t.inArray(r,i.skip)?!0:!1;if(l)continue;u[r]=-1==t.inArray(r,o)?zoho.customMerge(i,f,a):t.extend(s,t.isArray(a)?[]:{},a)}else void 0!==a&&(u[r]=a);return u}}}(jQuery);
!function($){$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(t,e){this.defaults.type=t,this.defaults.name=e},get:function(elem,opts){var settings=$.extend({},this.defaults,opts);settings.single.length||(settings.single="metadata");var data=$.data(elem,settings.single);if(data)return data;data="{}";var getData=function(data){return"string"!=typeof data?data:void(data.indexOf("{")<0&&(data=eval("("+data+")")))},getObject=function(data){return"string"!=typeof data?data:data=eval("("+data+")")},getJSONObject=function(t){return"string"!=typeof t?t:t=$.parseJSON(t)};if("attr"==settings.type&&void 0!=elem.getAttribute){var attr=elem.getAttribute(settings.name);attr&&(data=attr),object=getObject(data.indexOf("{")<0?"{"+data+"}":data)}else if("JSON"==settings.type&&void 0!=elem.getAttribute){var attr=elem.getAttribute(settings.name);attr&&(data=attr),object=getJSONObject(data.indexOf("{")<0?"{"+data+"}":data)}else if("JSON"==settings.type||"attr"==settings.type||"#document"==elem.nodeName)object={};else if("html5"==settings.type){var object={};$(elem.attributes).each(function(){var t=this.nodeName;return t.match(/^data-/)?(t=t.replace(/^data-/,""),void(object[t]=getObject(this.nodeValue))):!0})}else{if("class"==settings.type){var m=settings.cre.exec(elem.className);m&&(data=m[1])}else if("elem"==settings.type){if(!elem.getElementsByTagName)return;var e=elem.getElementsByTagName(settings.name);e.length&&(data=$.trim(e[0].innerHTML))}else if(void 0!=elem.getAttribute){var attr=elem.getAttribute(settings.name);attr&&(data=attr)}object=getObject(data.indexOf("{")<0?"{"+data+"}":data)}return $.data(elem,settings.single,object),object}}}),$.fn.metadata=function(t){return $.metadata.get(this[0],t)}}(jQuery);
!function(t){t.ui.utils={colorpalette:void 0,addFocusElement:function(e){var n=t("<button>").css({height:1,width:1,position:"absolute",top:"1px",border:"none"});return n.addClass("ui-focus-element"),e.append(n.fadeTo(0,0)),n},invokeAction:function(t){var e=t.attr("action");if(e){for(var n=e.split("("),o=n[0],i=o.split("."),r=window,a=void 0,s=0;s<i.length;s++)s==i.length-1&&(a=r),r=r[i[s]];var c=n[1].split(")")[0].split(",");r.apply(a,c)}},displayColorPallet:function(e,n,o){this.colorpalette||(this.colorpalette=t("<div>"),t("body").append(this.colorpalette),t(this.colorpalette).zcolorpalette(o.createoptions)),"hide"!=n?t(this.colorpalette).zcolorpalette("show",t(e),o.showoptions):t(this.colorpalette).zcolorpalette("hide")},initDeferredComponents:function(e,n,o){var i=this;setTimeout(function(){t.each(e,function(e,n){t(n).each(function(n,o){i._initComponent(t(o),e)})}),o&&o(e)},n?n:1e4)},destroyComponents:function(e,n,o){o=o||"ctype";var i="["+o+"]",r=t(i,e);e.is(i)&&(r=t(e).add(r));var a=this;r.length?t.eachAsync(r,{delay:20,loop:function(e,n){t(n)[n.getAttribute(o)]("destroy")},end:function(){a._end(e,r,n,!0)}}):a._end(e,r,n,!0)},_initComponent:function(e,n,o){o=o?o:"ctype";var i=t(e),r=void 0;i.is(":hidden")&&(r=i.parentsUntil(":visible").last().show()),n=n?n:i.attr(o);var a=i.attr("data"),s=i.metadata();a?i[n](s.componentOptions?s.componentOptions:s):i[n](),r&&r.hide()},initComponents:function(e,n,o){t.ui.directionIsRTL=t.ui.directionIsRTL?t.ui.directionIsRTL:"rtl"===t("body").css("direction");var i="["+(o?o:"ctype")+"]",r=t(i,e);e.is(i)&&(r=t(e).add(r));var a=this;r.length?t.eachAsync(r,{delay:20,loop:function(t,e){a._initComponent(e,void 0,o)},end:function(){a._end(e,r,n)}}):a._end(e,r,n)},_end:function(e,n,o,i){t(document).trigger(i?"componentdestroyed":"componentinitialized",e),o&&o(n)},_getCtype:function(t){return t.attr("ctype")},getValue:function(t){return t[this._getCtype(t)]("getValue")},setValue:function(t,e){return t[this._getCtype(t)]("setValue",e)},invokeMethodByCtype:function(t,e,n){return t[this._getCtype(t)](e,n)},getAsFunction:function(e){if(e){var n=e.split("."),o=window,i="";return t(n).each(function(t,e){o=o[e],t==n.length-2&&(i=o)}),{fn:o,base:i,callable:function(){o.call(i)}}}},getPositionFromDirection:function(e,n,o){var i=t(e).offset(),r="northeast"==o||"southeast"==o||"east"==o?i.left+t(e).outerWidth(!0)-n.outerWidth(!0):"north"==o||"south"==o||"center"==o?i.left+t(e).width()/2-n.outerWidth(!0)/2:i.left,a="south"==o||"southeast"==o||"southwest"==o?i.top+t(e).outerHeight(!0):"west"==o||"east"==o||"center"==o?i.top+t(e).outerHeight(!0)/2-n.outerHeight(!0)/2:i.top;return{left:r+"px",top:a+"px"}},getI18NString:function(e,n,o,i){var r=t.i18n(e,n,o);if(r==="[noi18n] "+n&&(r=i[n],o&&i))for(var a=0;a<o.length;a++)r=r.replace("{"+a+"}",o[a]);return r}}}(jQuery);
!function(t){var i={_mac:!0,_spinning:!1,_input:void 0,_timeout:void 0,_uiSpinner:void 0,_hasValidValue:!0,_millisecsForAnHour:36e5,_millisecsForAMinute:6e4,_millisecsForASecond:1e3,widgetEventPrefix:"spinner",_timeFormats:["hh:mm:ss:ms","hh:mm:ss","hh:mm","hh","mm:ss:ms","mm.ss","mm","ss:ms","ss","ms"],_create:function(){this.options=t.extend({},t.ui.zspinner.defaults,this.options),this._mac=this._isMac(),this._parseOptions(),this._initSpinner()},_EVENTS:{ONSTART:"start",ONSPIN:"spin",ONCHANGE:"change",ONSTOP:"stop"},_parseOptions:function(){this.options.max=t(this.element).attr("max"),this.options.min=t(this.element).attr("min"),this.options.step=t(this.element).attr("step");var i=this;t(["min","max","step","quickstep"]).each(function(t,s){i.options[s]=parseFloat(i.options[s])})},getFormatFromTime:function(t){var i=mins=secs=msecs=0;t>0&&(i=parseInt(t/this._millisecsForAnHour),mins=parseInt(t%this._millisecsForAnHour/this._millisecsForAMinute),secs=parseInt(t%this._millisecsForAMinute/this._millisecsForASecond),msecs=parseInt(t%this._millisecsForAMinute%this._millisecsForASecond));var s=this._convertToFormat(t,i,mins,secs,msecs);return s},_convertToFormat:function(i,s,e,n,o){var a=this.options.timeunit,l=this.options.timeFormat,p=i,h=l.split(":"),u="";return t.each(h,function(t,i){var l=t+1==h.length;switch(a=l?"":a,i){case"hh":u+=s;break;case"mm":u+=e;break;case"ss":u+=n;break;case"ms":u+=o}u+=a}),p=u},getTimeFromFormat:function(t){var i=this.options.timeunit,s=0,e=t.toString().split(i);if(4==e.length){var n=e[0]*this._millisecsForAnHour,o=e[1]*this._millisecsForAMinute,a=e[2]*this._millisecsForASecond,l=parseInt(e[3]);s=n+o+a+l}else s=this.options.value;return s},_initSpinner:function(){var i=this,s=t(this.element)[i.options.editable?"val":"text"]();"time"!=this.options.type?(s.match("[0-9]")||(s=isNaN(this.options.defaultValue)?this.options.nullValue?this.options.nullValue:this.options.min+this.options.unit:this.options.defaultValue+this.options.unit),this.options.value=i.options.unit?s.toString().split(i.options.unit)[0]:s):s=this.getFormatFromTime(this.options.value),this.options._lastValue=this.options.value;var e=this.element.width()>=50?this.element.width():50;this._baseElement=t("<div>").css({width:e,display:"inline-block"}).addClass("ui-zspinner"),this._input=t(i.options.editable?"<input>":"<div>").attr(i.options.editable?"type":"contentEditable",this.options.editable?"text":!1).css({width:e-16}),this._baseElement.append(this._input);var n=t("<span>").addClass("ui-state-default ui-zspinner-up");n.hover(function(){n.addClass("ui-state-hover")},function(){n.removeClass("ui-state-hover")});var o=t("<span>").addClass("ui-icon ui-components-icon ui-icon-arrow-n");o.appendTo(n);var a=t("<span>").addClass("ui-state-default ui-zspinner-down");a.hover(function(){a.addClass("ui-state-hover")},function(){a.removeClass("ui-state-hover")});var l=t("<span>").addClass("ui-icon ui-components-icon ui-icon-arrow-s");l.appendTo(a);var p=t("<div>").addClass("ui-zspinner-controls").append(n).append(a);this.options.unit.match("[0-9]")&&(this.options.unit=""),this._input.addClass("ui-zspinner-content ui-widget-content")[i.options.editable?"val":"text"](s),this.options.editable||this._input.addClass("ui-noneditable-spinner"),this._baseElement.insertAfter(this.element),p.insertAfter(this._input),this._initEvents(),this.element.is(":disabled")&&this.disable(),this.element.hide()},_initEvents:function(){var i=this;this.options.editable||this._input.on("mousedown",function(){i._input.attr("tabindex",0)}),this._input.on("keydown."+this.widgetName,function(s){if(i._isDisabled(i.element))return!1;var e=void 0;switch(s.keyCode){case t.ui.keyCode.UP:e=!1;break;case t.ui.keyCode.DOWN:e=!0}void 0!=e&&i._setSpinning(e,s.shiftKey);var n=i._input[i.options.editable?"val":"text"]();return i.options.editable?n==i.options.nullValue?(i.options.value=i.options.nullValue,!1):void i._checkValue(s):!1}).keyup(function(){return i._isDisabled(i.element)?!1:void i._stopSpinning()}).on("focus."+this.widgetName,function(){return i._isDisabled(i.element)?!1:void 0}).on("blur."+this.widgetName,function(){var s=i._input[i.options.editable?"val":"text"]();s=i.options.unit?s.toString().split(i.options.unit)[0]:s;var e=!1,n=/^[. 0-9]+$/;"time"===i.options.type&&(n=/^[: 0-9]+$/),isNaN(parseFloat(s))||!n.test(s)?(e=!0,i.setValue(i.options._lastValue)):i.options.unit?(e=!0,i._input.val(s+i.options.unit),i.options._lastValue=s):"time"!=i.options.type&&(i.options._lastValue=s);var o=i._checkAndReturnValue();e&&i.options.value!=o&&(i._input.val(o+i.options.unit),i.options.value=o,i._callOnChange(),i.options.onchangeEvent&&t(i.element).trigger(i.options.onchangeEvent,{value:i.getValue()}),i._triggerEvent(i.options.quickTrigger?i._EVENTS.ONCHANGE:i._EVENTS.ONSPIN)),i._resetValue(i.options.value)});var s=this._baseElement.children(".ui-zspinner-controls"),e=s.children(".ui-state-default");e.find("span").on("mousedown."+i.widgetName,function(s){if(i._isDisabled(i.element))return!1;if(i._mousedown=!0,s.which>1)return!1;var e=t(s.target).parent();e.addClass("ui-state-active");var n=t(s.target).hasClass("ui-icon-arrow-s");i._setSpinning(n,s.shiftKey),t(document).on("mouseup."+i.widgetName,function(s){return i._isDisabled(i.element)?!1:(e.removeClass("ui-state-active"),i._stopSpinning(s),i._input.attr("tabindex",0),i._input.focus(),void t(document).off("mouseup."+i.widgetName))})})},_setSpinning:function(t,i){this._triggerEvent(this._EVENTS.ONSTART),this._spinning=!0,this._startSpinning(t?"down":"up",i)},_startSpinning:function(i,s){var e=isNaN(this.options.value)?this.options.min:this.options.value;e==this.options.nullValue||isNaN(e)?e="up"==i?this.options.min-1:this.options.rotate?this.options.max+1:this.options.nullValue:(e=parseFloat(e),e==this.options.min&&this.options.nullValue&&(e="up"==i?e:this.options.nullValue)),-1!=e.toString().indexOf(this.options.unit)&&(this.options.unit="");var n=this;if(this._spinning){var o=this.options[s?"quickstep":"step"];switch(i){case"up":e+=o,void 0==this.options.max||isNaN(this.options.max)?this._spinValue("up",e,o,s):(e>this.options.max&&this.options.rotate&&(e=this.options.nullValue?this.options.nullValue:this.options.min),(e>this.options.max||e<this.options.min)&&this._input[n.options.editable?"val":"text"](("time"==this.options.type?this.getFormatFromTime(this.options.max):this.options.max)+this.options.unit),(e<=this.options.max||isNaN(e))&&this._spinValue("up",e,o,s));break;case"down":e-=o,void 0==this.options.min||isNaN(this.options.min)?this._spinValue("down",e,o,s):(e<this.options.min&&this.options.rotate&&(e=this.options.nullValue?this.options.nullValue:this.options.max),(e<this.options.min||e>this.options.max)&&this._input[n.options.editable?"val":"text"](("time"==this.options.type?this.getFormatFromTime(this.options.min):this.options.min)+this.options.unit),(e>=this.options.min||isNaN(e))&&this._spinValue("down",e,o,s))}this.options.value=e,this.options.value=isNaN(e)?this.options.nullValue:this.options._lastValue=n._checkAndReturnValue(),this._callOnChange(),this.options.onchangeEvent&&t(this.element).trigger(this.options.onchangeEvent,{value:this.getValue()}),this._triggerEvent(this.options.quickTrigger?this._EVENTS.ONCHANGE:this._EVENTS.ONSPIN)}},_callOnChange:function(){this.options.onchange&&(isNaN(parseFloat(this.options.value))&&"time"!=this.options.type&&(this.options.value=parseFloat(this.element.val())),this.options.onchange(this.getValue()))},_spinValue:function(t,i,s,e){var n=this;this.options.floatLength=this.options.floatLength?this.options.floatLength:this._getDecimalPointLength(this.options.step);var o="time"!=this.options.type?isNaN(i)||i==this.options.nullValue?this.options.nullValue:i.toFixed(this.options.floatLength)+this.options.unit:this.getFormatFromTime(i);this._input[n.options.editable?"val":"text"](o).focus(),this._timeout=setTimeout(function(){n._startSpinning(t,e)},150)},_checkValue:function(i){var s=String.fromCharCode(i.keyCode).toLowerCase(),e=this,n=t(i.target)[e.options.editable?"val":"text"]();this.options.floatLength=this.options.floatLength?this.options.floatLength:this._getDecimalPointLength(this.options.step);var o=this.options.floatLength,a=externalKeys=void 0;!o||190!=i.keyCode&&110!=i.keyCode&&188!=i.keyCode&&59!=i.keyCode||-1!=n.indexOf(".")||(s=".",externalKeys=!0),a=i.keyCode>=48&&i.keyCode<=57||i.keyCode>=96&&i.keyCode<=105,-1!=e.options.min.toString().indexOf("-")&&(a=a||189==i.keyCode);var l="time"!=e.options.type?t(i.target)[e.options.editable?"val":"text"]():e.getTimeFromFormat(t(i.target)[e.options.editable?"val":"text"]());l=parseFloat(e.options.unit?l.toString().split(e.options.unit)[0]:l),a||externalKeys?window.setTimeout(function(){var s=e._input[e.options.editable?"val":"text"](),o=!1;l="time"!=e.options.type?s:l,s=parseFloat(s),(s>e.options.max||s<e.options.min)&&(o=!0),o&&(l=s>e.options.max?n:s,t(i.target)[e.options.editable?"val":"text"](l)),e.options.value=e.options.unit?l.toString().split(e.options.unit)[0]:l,e._hasValidValue=!0,e._callOnChange()},1):i.ctrlKey||i.metaKey?89===i.keyCode?e._mac&&e._stopEvent(i):65!=i.keyCode&&67!=i.keyCode&&86!=i.keyCode&&88!=i.keyCode&&90!=i.keyCode&&89!=i.keyCode?e._stopEvent(i):86===i.keyCode&&e._checkValue(i):40!=i.keyCode&&38!=i.keyCode&&46!=i.keyCode&&8!=i.keyCode?(37!=i.keyCode&&39!=i.keyCode&&9!=i.keyCode&&e._stopEvent(i),e._hasValidValue=!1):(e._hasValidValue=!0,window.setTimeout(function(){var t=e._input[e.options.editable?"val":"text"]();t="time"!=e.options.type?t:l,e.options.value=e.options.unit?t.toString().split(e.options.unit)[0]:t,e._callOnChange()},1))},_isMac:function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mac")},_stopEvent:function(t){t.preventDefault(),t.stopPropagation()},_checkAndReturnValue:function(){var t=this.options.value;return t>this.options.max&&(t=this.options.max),t<this.options.min&&(t=this.options.min),t},_getDecimalPointLength:function(t){var i=-1!=t.toString().indexOf(".")?!0:!1,s=0;return i&&(s=t.toString().split(".")[1],s=s&&s.length>=2?2:s.length),s},_isDisabled:function(i){var s=t(i).attr("disabled");return s?!0:!1},_triggerEvent:function(i){var s=this,e=s.getValue(),n={spinner:t(s.element),value:parseFloat(e)};return this.element.val(e),s._trigger(i,i,n)},_stopSpinning:function(){this._timeout=clearTimeout(this._timeout),this._spinning=!1,!this.options.quickTrigger&&this._hasValidValue&&(isNaN(parseFloat(this.options.value))&&"time"!=this.options.type&&(this.options.value=parseFloat(this.element.val())),this._triggerEvent(this._EVENTS.ONCHANGE),this._triggerEvent(this._EVENTS.ONSTOP)),this._resetValue(this.options.value)},_resetValue:function(t){var i=this._baseElement.children(".ui-zspinner-controls");i.find(".ui-state-disabled").removeClass("ui-state-disabled"),(t>=this.options.max||t<=this.options.min)&&(t>=this.options.max&&i.find(".ui-zspinner-up").addClass("ui-state-disabled"),t<=this.options.min&&i.find(".ui-zspinner-down").addClass("ui-state-disabled"))},getValue:function(){return isNaN(parseFloat(this.options.value))?this.options.min?this.options.min:0:this.options.value},setValue:function(t){if(!this._isDisabled(this.element))if(isNaN(parseFloat(t)))this.options.nullValue?(t=this.options.nullValue,this.options.value=t):null===t?(t="",this.options.value=this.options.hiddenValue?this.options.hiddenValue:isNaN(this.options.defaultValue)?this.options.min:this.options.defaultValue):(t=isNaN(this.options.defaultValue)?this.options.min:this.options.defaultValue,this.options.value=t,t+=this.options.unit),this._input[this.options.editable?"val":"text"](t);else{t=t>this.options.max?this.options.max:t<this.options.min?this.options.min:parseFloat(t),t=t.toString().match("[0-9.]")?t:this.options.min;var i="time"!=this.options.type?parseFloat(t).toFixed(this.options.floatLength):this.getFormatFromTime(t);this.options.value="time"!=this.options.type?i:t,this._input[this.options.editable?"val":"text"](i+this.options.unit),this.options._lastValue=i,this.element.val(i),this._resetValue(this.options.value)}},setMinValue:function(i){t(this.element).attr("min",i),this.options.min=i},setMaxValue:function(i){t(this.element).attr("max",i),this.options.max=i},setStepValue:function(i){t(this.element).attr("step",i),this.options.step=i},setUnit:function(t){t&&(this.options.unit=t.toString())},disable:function(){t(this.element).attr("disabled","true"),this._baseElement.addClass("ui-state-disabled"),this._baseElement.find("input").attr("disabled","true")},enable:function(){this._isDisabled(this.element)&&(t(this.element).removeAttr("disabled"),this._baseElement.removeClass("ui-state-disabled"),this._baseElement.find("input").removeAttr("disabled"))},widget:function(){return this._baseElement},destroy:function(){this._baseElement.off("."+this.widgetName).remove(),t(this.element).show(),t.Widget.prototype.destroy.apply(this,arguments)}};t.widget("ui.zspinner",i),t.ui.zspinner.defaults={quickstep:5,rotate:!1,onchange:void 0,onchangeEvent:void 0,quickTrigger:!1,unit:"",decimalAllowed:!0,floatLength:0,nullValue:void 0,editable:!0,timeFormat:"mm:ss:ms"}}(jQuery);
!function(l){var t=function(l){this.element=l};t.prototype={_EVENTS:{ONSCROLL:"scroll",ONSCROLLEND:"scrollend"},vertical:!1,horizontal:!1,_create:function(){this._minScrollBarSize=20,this._scrollbarwidth=l.getDefaultScrollWidth(),this._createScroll()},_createScroll:function(){var i=this;this.horSize=0,this.verSize=0,"hidden"!==this.element.css("overflow-y")&&(this.vertical=!0,this.horSize=20),"hidden"!==this.element.css("overflow-x")&&(this.horizontal=!0,this.verSize=20),this.element.addClass("ui-zscroll").mouseenter(function(){i._refresh()});var t=20-this._scrollbarwidth;this._scrollChild=l("<div>").css("padding",this.element.css("padding-top")+" "+this.element.css("padding-right")+" "+this.element.css("padding-bottom")+" "+this.element.css("padding-left")).append(this.element.html()).data("zscroll",!0),this.element.html(this._scrollChild);var r=this.vertical&&this.horizontal?"scroll":"";this.vertical&&(r="scroll"===r?"scroll":"y",this._hideVScrollBar="",this.setMinVerSize=0,this._verticalScrollBar=l("<div>").attr("class","ui-zscroll-vertical"),this.element.append(this._verticalScrollBar),this._scrollChild.css("padding-right",t+parseInt(this.element.css("padding-right")))),this.horizontal&&(r="scroll"===r?"scroll":"x",this._hideHScrollBar="",this.setMinHorSize=0,this._horizontalScrollBar=l("<div>").attr("class","ui-zscroll-horizontal"),this.element.append(this._horizontalScrollBar),this._scrollChild.css("padding-bottom",t+parseInt(this.element.css("padding-bottom")))),this._scrollChild.scroll(function(l){i.vertical?i._showScrollBarVertical():null,i.horizontal?i._showScrollBarHorizontal():null,i._triggerEvent(i._EVENTS.ONSCROLL,l),i._scrollEnd(l)}),this._scrollChild.addClass(" ui-zscroll-child ui-zscroll-child-"+r),this._refresh(),this._dragScrollbar()},_triggerEvent:function(l,i){this.element.trigger(l,i)},_scrollEnd:function(l){this.childScrollHeight===this.clientHeight+this._scrollChild.scrollTop()&&this._triggerEvent(this._EVENTS.ONSCROLLEND,l)},_showScrollBarVertical:function(){this._verticalScrollBar.css("opacity",""),this.scrollTop=this._scrollChild.scrollTop()/this.childScrollHeight*(this.clientHeight-(this.setMinVerSize+this.verSize)),this._verticalScrollBar.css({top:this.scrollTop}),clearTimeout(this._hideVScrollBar);var l=this;this._hideVScrollBar=setTimeout(function(){l._verticalScrollBar.css("opacity","0")},1500)},_showScrollBarHorizontal:function(){this._horizontalScrollBar.css("opacity",""),this.scrollLeft=this._scrollChild.scrollLeft()/this.childScrollWidth*(this.clientWidth-(this.setMinHorSize+this.horSize)),this._horizontalScrollBar.css({left:this.scrollLeft}),clearTimeout(this._hideHScrollBar);var l=this;this._hideHScrollBar=setTimeout(function(){l._horizontalScrollBar.css("opacity","0")},1500)},_setHorScrollSize:function(){var l=this.vertical?this._scrollbarwidth:0;this.clientWidth=this._scrollChild.innerWidth()-l,this.childScrollWidth=this._scrollChild[0].scrollWidth,this.scrollWidth=this.clientWidth/this.childScrollWidth*this.clientWidth,this._horizontalScrollBar.css({width:this.scrollWidth}),this.setMinHorSize=0,this.scrollWidth<this._minScrollBarSize&&(this._horizontalScrollBar.css({width:this._minScrollBarSize}),this.setMinHorSize=this._minScrollBarSize-this.scrollWidth,this.scrollWidth<=0&&(this.scrollWidth=.1)),this._scrollChild.innerWidth()>=this._scrollChild[0].scrollWidth+l?this._horizontalScrollBar.hide():this._horizontalScrollBar.show()},_setVerScrollSize:function(){var l=this.horizontal?this._scrollbarwidth:0;this._scrollChild.height(this.element.height()+l),this.clientHeight=this._scrollChild.innerHeight()-l,this.childScrollHeight=this._scrollChild[0].scrollHeight,this.scrollHeight=this.clientHeight/this.childScrollHeight*this.clientHeight,this._verticalScrollBar.css({height:this.scrollHeight}),this.setMinVerSize=0,this.scrollHeight<this._minScrollBarSize&&(this._verticalScrollBar.css({height:this._minScrollBarSize}),this.setMinVerSize=this._minScrollBarSize-this.scrollHeight,this.scrollHeight<=0&&(this.scrollHeight=.1)),this._scrollChild.innerHeight()>=this._scrollChild[0].scrollHeight+l?this._verticalScrollBar.hide():this._verticalScrollBar.show()},_dragScrollbar:function(){var i=this,t=l(window),r=l("body");-1!=navigator.appVersion.indexOf("MSIE")&&(version=parseFloat(navigator.appVersion.split("MSIE")[1]),9>version&&(t=l("body"))),this.vertical&&this._verticalScrollBar.mousedown(function(l){var s=l.pageY||l.clientY,o=i._scrollChild.scrollTop();r.addClass("ui-zscroll-cursor"),i.element.addClass("ui-zscroll-user-select"),i._verticalScrollBar.addClass("ui-zscroll-hover"),t.on("selectstart.zscroll",function(){return!1}),t.on("mousemove.zscroll",function(l){var t=l.pageY||l.clientY;i._scrollChild.scrollTop(o+(t-s)*((i.clientHeight+i.setMinVerSize+i.verSize)/i.scrollHeight))}),t.on("mouseup.zscroll",function(){i._verticalScrollBar.removeClass("ui-zscroll-hover"),r.removeClass("ui-zscroll-cursor"),i.element.removeClass("ui-zscroll-user-select"),t.off("mouseup.zscroll mousemove.zscroll selectstart.zscroll")})}),this.horizontal&&this._horizontalScrollBar.mousedown(function(l){var s=l.pageX||l.clientX,o=i._scrollChild.scrollLeft();r.addClass("ui-zscroll-cursor"),i.element.addClass("ui-zscroll-user-select"),i._horizontalScrollBar.addClass("ui-zscroll-hover"),t.on("selectstart.zscroll",function(){return!1}),t.on("mousemove.zscroll",function(l){var t=l.pageX||l.clientX;i._scrollChild.scrollLeft(o+(t-s)*((i.clientWidth+i.setMinHorSize+i.horSize)/i.scrollWidth))}),t.on("mouseup.zscroll",function(){i._horizontalScrollBar.removeClass("ui-zscroll-hover"),r.removeClass("ui-zscroll-cursor"),i.element.removeClass("ui-zscroll-user-select"),t.off("mouseup.zscroll mousemove.zscroll selectstart.zscroll")})})},_refresh:function(){this.vertical&&(this._setVerScrollSize(),this._showScrollBarVertical()),this.horizontal&&(this._setHorScrollSize(),this._showScrollBarHorizontal())},_destroy:function(){this.element.data({zscroll:!1,zscrolldestroy:!0}),this.element.find(".ui-zscroll-vertical,.ui-zscroll-horizontal").remove();var l=this._scrollChild.html();this._scrollChild.remove(),this.element.removeClass("ui-zscroll").html(l)},setScrollX:function(l){this._scrollChild.scrollLeft(l)},setScrollY:function(l){this._scrollChild.scrollTop(l)},getScrollX:function(){return this._scrollChild.scrollLeft()},getScrollY:function(){return this._scrollChild.scrollTop()}},l.zdefaultScrollWidth=void 0,l.getDefaultScrollWidth=function(){if(!l.zdefaultScrollWidth){var i=l("<div>").css({width:"100px",height:"100px",overflow:"scroll"}).appendTo("body");l.zdefaultScrollWidth=i.width()-i[0].scrollWidth,i.remove()}return l.zdefaultScrollWidth},l.fn.zscroll=function(){var r=arguments[0],s=arguments[1];for(i=0;i<this.length;i++){var o=l(this[i]);if(!o.data("zscrolldestroy")||"instance"==r)if(o.data("zscroll")){var e=o.data("options");if("scrollY"==r){if(void 0==s)return e.getScrollY();e.setScrollY(s)}else if("scrollX"==r){if(void 0==s)return e.getScrollX();e.setScrollX(s)}else"destroy"==r?e._destroy():"refresh"==r&&e._refresh()}else{var e=new t(o);e._create(),o.scrollTop(0).scrollLeft(0).data({options:e,zscrolldestroy:!1,zscroll:!0})}}}}(window.jQuery);
!function(n){n.whileAsync=function(n){var t=Math.abs(n.delay)||10,e=isNaN(n.bulk)?500:Math.abs(n.bulk),c=n.test||function(){return!0},u=n.loop||function(){},o=n.end||function(){};!function(){for(var n=!1,a=new Date;(n=c())&&(u(),!(0===e||new Date-a>e)););n?setTimeout(arguments.callee,t):o()}()},n.eachAsync=function(t,e){var c=0,u=t.length,o=e.loop||function(){};n.whileAsync(n.extend(e,{test:function(){return u>c},loop:function(){var n=t[c];return o.call(n,c++,n)}}))},n.fn.eachAsync=function(t){return n.eachAsync(this,t),this}}(jQuery);
!function(n,t){"$:nomunge";var u,e=n.jQuery||n.Cowboy||(n.Cowboy={});e.throttle=u=function(n,u,o,i){function r(){function e(){c=+new Date,o.apply(f,d)}function r(){a=t}var f=this,g=+new Date-c,d=arguments;i&&!a&&e(),a&&clearTimeout(a),i===t&&g>n?e():u!==!0&&(a=setTimeout(i?r:e,i===t?n-g:n))}var a,c=0;return"boolean"!=typeof u&&(i=o,o=u,u=t),e.guid&&(r.guid=o.guid=o.guid||e.guid++),r},e.debounce=function(n,e,o){return o===t?u(n,e,!1):u(n,o,e!==!1)}}(this);
function AjaxRequest(){this.eventHandler={}}function postAjax(e,t,s){e.open("POST",t,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),e.send(s)}AjaxRequest.MAX_RETRY_COUNT=3,AjaxRequest.NETWORK_RETRY_COUNT=0,AjaxRequest.Method={POST:"POST",GET:"GET"},AjaxRequest.prototype={init:function(e,t,s,r){return e!==AjaxRequest.Method.GET&&e!==AjaxRequest.Method.POST&&showAlertDialog("Please Give the valid method Type for AjaxRequest, only GET | POST is allowed"),this.method=e,this.URL=t,this.asynchronous=s,r&&(this.parameters=encodeURI(r).replace(/\+/g,"%2B")),this.retryCount=0,this.xmlHttpRequest=null,this.actionConstant=-1,this},appendParams:function(e){e=encodeURI(e).replace(/\+/g,"%2B"),this.parameters=this.parameters?this.parameters+"&"+e:e},addEventListener:function(e,t){switch(e){case"onBeforeSend":case"onProcess":case"onComplete":case"onBeforeComplete1":case"onBeforeComplete2":case"onAfterComplete":case"onServerError":case"onDisconnect":case"onError":break;default:return void showAlertDialog("Please Give the valid Events for addEventListener")}var s=Array.prototype.slice.call(arguments,2);this.eventHandler[e]={},this.eventHandler[e].handler=t,this.eventHandler[e].params=s},_triggerListener:function(e){var t=this.eventHandler[e];if(t)switch(e){case"onBeforeSend":case"onProcess":case"onComplete":case"onBeforeComplete1":case"onBeforeComplete2":case"onAfterComplete":case"onDisconnect":case"onServerError":case"onError":RESPONSE_CODE=this.xmlHttpRequest.status,t.params.unshift(this.xmlHttpRequest),t.handler.apply(null,t.params)}},_getXmlHttpRequest:function(){return XMLHttpRequest?(AjaxRequest.prototype._getXmlHttpRequest=function(){return new XMLHttpRequest},this._getXmlHttpRequest()):void showAlertDialog(jsMsg.UpdateLatestBrowser)},_onreadyStateChange:function(){switch(this.xmlHttpRequest.readyState){case 0:case 1:this._triggerListener("onBeforeSend");break;case 2:case 3:this._triggerListener("onProcess");break;case 4:200==this.xmlHttpRequest.status?(this._triggerListener("onBeforeComplete1"),this._triggerListener("onBeforeComplete2"),this._triggerListener("onComplete"),this._triggerListener("onAfterComplete"),AjaxRequest.NETWORK_RETRY_COUNT=0):999==this.xmlHttpRequest.status?this._handleError():(this._triggerListener("onError"),this._handleError())}},sendRequest:function(e){if("undefined"==typeof BLOCK_REMOVED_FILE_REQUEST||!BLOCK_REMOVED_FILE_REQUEST){var t=this.parameters;if(t&&t.indexOf("&action=")>-1){t=this.parameters.substr(t.indexOf("&action=")+"&action=".length);var s=parseInt(t.substr(0,t.indexOf("&")));ActionConstants.SYNC_CHECK!==s&&(this.actionConstant=s,ActionConstants.USER_PRESENCE!==s&&(LAST_REQUESTED_ACTION_ID=s))}if(this._triggerListener("onBeforeSend"),this.xmlHttpRequest=this._getXmlHttpRequest(),"undefined"!=typeof appEvent){params=this.parameters;var r=params.slice(params.indexOf("&action")+8),n=r.slice(0,r.indexOf("&")),a=params.indexOf("&proxyURL")+10;if(-1!==a){var i=params.slice(a),o=i.slice(0,i.indexOf("&"));appEvent.trigger("execute.OnGridAction",[o,n])}}this.addEventListener("onBeforeComplete1",function(e,t){var s=e.responseText;if(s){try{var r=JSON.parse(s)}catch(e){r=!1}if(r&&"undefined"==typeof TEMP_CONTAINER_IDENTITY&&r.TEMP_CONTAINER_IDENTITY)return Public.holdRequests=!0,Public.requestsArray=[],Public.requestsArray.push(t),TEMP_CONTAINER_IDENTITY=r.TEMP_CONTAINER_IDENTITY,COLLAB_ID=r.COLLAB_ID,COLLAB_INFO={},void WMSResponseProcessor.handleServerUp()}},this),!Public.holdRequests||this.parameters.indexOf("action="+ActionConstants.JOIN_COLLAB)>0?(this.xmlHttpRequest.onreadystatechange=this._onreadyStateChange.bind(this),"GET"==this.methodType?this.xmlHttpRequest.open(this.method,this.URL+"?"+this.parameters,this.asynchronous):this.xmlHttpRequest.open(this.method,this.URL,this.asynchronous),this.xmlHttpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),"undefined"==typeof USER_LOCALE&&(USER_LOCALE="en"),this.xmlHttpRequest.setRequestHeader("User-Locale",USER_LOCALE),e&&this.xmlHttpRequest.setRequestHeader("Authorization",e),this.xmlHttpRequest.send("POST"==this.method?this.parameters:null)):("undefined"==typeof Public.requestsArray&&(Public.requestsArray=[]),Public.requestsArray.push(this))}},_resendRequest:function(){this.retryCount<AjaxRequest.MAX_RETRY_COUNT&&this.sendRequest(),this.retryCount++},_handleError:function(){if(this.actionConstant==ActionConstants.USER_PRESENCE)return!1;switch(this.xmlHttpRequest.status){case 999:this._resendRequest();break;case 400:break;case 401:this.eventHandler.onError||showAlertDialog(jsMsg["Error.OperationNotPermissible"]);break;case 402:case 403:case 404:showAlertDialog(replaceParams(jsMsg.NotFoundMatchingURI,new Array(this.URL)));break;case 405:case 406:case 407:break;case 408:this._resendRequest();break;case 409:case 410:break;case 411:break;case 412:break;case 413:setTimeout(function(){this._resendRequest()},xmlHttpRequest.getResponseHeader("Retry-After"));break;case 414:case 415:case 416:case 417:break;case 500:case 501:case 502:case 504:case 505:this._triggerListener("onServerError");break;case 0:case 503:case 12007:case 12029:case 12031:WebMessanger.isReconnecting()||AjaxRequest.NETWORK_RETRY_COUNT>=1?this.eventHandler.onDisconnect?this._triggerListener("onDisconnect"):handleServerError("ERROR","ConnectionLost",!0,!0):(this._resendRequest(),AjaxRequest.NETWORK_RETRY_COUNT++)}}};
var ActionProps={get:function(t){var a;switch(t){case ActionConstants.SUBMIT:a={params:["currentSheet","cellValue","isCSE","startRow","startCol","endRow","endCol","colWidth","validateDV"],URL:"gridaction"};break;case ActionConstants.COMPUTE_SUM:case ActionConstants.COMPUTE_SUM_C:a={params:["currentSheet","row","column","startRow","startCol","endRow","endCol","value"],URL:"gridaction"};break;case ActionConstants.DOCUMENT_SETTING:a={params:["currentSheet","startRow","startCol","endRow","endCol","countryName","timeZoneId","setDefault","sheetDirection"],URL:"gridaction"};break;case ActionConstants.JSP_DOCUMENT_SETTING:a={URL:"documentsettingsdialog"};break;case ActionConstants.JSP_SEND_SPREADSHEET_IN_MAIL:a={params:["currSheetName"],URL:"senddocmaildialog"};break;case ActionConstants.JSP_DATETIMEMENU:a={URL:"datetimemenu"};break;case ActionConstants.BOLD:case ActionConstants.ITALIC:case ActionConstants.STRIKETHROUGH:case ActionConstants.UNDERLINE:case ActionConstants.FONTFAMILY:case ActionConstants.FONTSIZE:case ActionConstants.VALIGN:case ActionConstants.HALIGN:case ActionConstants.COLOR:case ActionConstants.TEXTCOLOR:case ActionConstants.WRAP:case ActionConstants.CHECKBOX_EDIT:a={params:["currentSheet","startRow","startCol","endRow","endCol","value"],URL:"gridaction"};break;case ActionConstants.HEIGHT:case ActionConstants.WIDTH:a={params:["currentSheet","startRow","startCol","endRow","endCol","value","isOptimal"],URL:"gridaction"};break;case ActionConstants.CLEARCONTENTS:case ActionConstants.CLEARSTYLES:case ActionConstants.CLEARALL:case ActionConstants.MERGE_AND_CENTER:case ActionConstants.MERGE_RANGE:case ActionConstants.MERGE_ACROSS:case ActionConstants.MERGE_DOWN:case ActionConstants.MERGE_SPLIT:case ActionConstants.CHECKBOX_ADD:case ActionConstants.CHECKBOX_CLEAR:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.SEND_SPREADSHEET_IN_MAIL:a={params:["emailids","format","message","sendCopy","currSheetName"],URL:"useraction"};break;case ActionConstants.COPY_TO_CLIP:case ActionConstants.SERVERCLIP_COPY_RANGE:case ActionConstants.SERVERCLIP_CUT_RANGE:a={params:["currentSheet","startRow","startCol","endRow","endCol","isSolidCopy","isRequiredTabSeparatedValues",JSONConstants.VERSION,JSONConstants.ONLY_CLIP_TO_SERVER],URL:"useraction"};break;case ActionConstants.SORT_DETAILS:case ActionConstants.AUTO_SUM:case ActionConstants.ALT_EQUAL_RANGE:case ActionConstants.READ_RANGE_DETAILS:case ActionConstants.WEBHOOK_UPDATE_RANGE:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"useraction"};break;case ActionConstants.SORT:a={params:["currentSheet","startRow","startCol","endRow","endCol","sortAndIndex","numberOfColumns","isSortColumns","containsHeader","isCaseSensitive"],URL:"gridaction"};break;case ActionConstants.FILLSERIES:a={params:["currentSheet","startRow","startCol","endRow","endCol","isCtrlPressed","srcCount","fillDirection","type"],URL:"gridaction"};break;case ActionConstants.FILLSERIES_AUTO:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.BORDERS:case ActionConstants.FORMAT_CURRENCY:case ActionConstants.CLEARFORMATS:case ActionConstants.FORMAT_TEXT:case ActionConstants.FORMAT_PERCENT:a={params:["currentSheet","startRow","startCol","endRow","endCol","type"],URL:"gridaction"};break;case ActionConstants.FORMAT_DATE:a={params:["currentSheet","startRow","startCol","endRow","endCol","type","formatString"],URL:"gridaction"};break;case ActionConstants.FORMAT_DECREMENT_DECIMAL:case ActionConstants.FORMAT_INCREMENT_DECIMAL:case ActionConstants.FORMAT_COMMA:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.INSERT_CELL_LEFT:case ActionConstants.INSERT_CELL_TOP:case ActionConstants.DELETE_CELL_RIGHT:case ActionConstants.DELETE_CELL_BOTTOM:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.INSERT_ROW:case ActionConstants.DELETE_ROW:a={params:["currentSheet","row","count"],URL:"gridaction"};break;case ActionConstants.INSERT_COL:case ActionConstants.DELETE_COL:a={params:["currentSheet","column","count"],URL:"gridaction"};break;case ActionConstants.INSERT_COPY_ROW:a={params:["currentSheet","destStartRow","destEndRow","count"],URL:"gridaction"};break;case ActionConstants.INSERT_CUT_ROW:a={params:["currentSheet","destStartRow"],URL:"gridaction"};break;case ActionConstants.INSERT_COPY_COLUMN:a={params:["currentSheet","destStartCol","destEndCol","isSameSheet","count"],URL:"gridaction"};break;case ActionConstants.INSERT_CUT_COLUMN:a={params:["currentSheet","destStartCol"],URL:"gridaction"};break;case ActionConstants.SYSTEMCLIP_PASTE:case ActionConstants.COPY_PASTE_CONTENT:a={params:["currentSheet","startRow","startCol","cellContent","isHtmlData","isFormatApply"],URL:"gridaction"};break;case ActionConstants.RECAST:a={params:["aaid","aaction","aparams"],URL:"gridaction"};break;case ActionConstants.REPEAT_ACTION:a={params:["currentSheet","lastAction"],URL:"gridaction"};break;case ActionConstants.COPY_PASTE:a={params:["currentSheet","startRow","startCol","endRow","endCol","srcSheet","destStartRow","destStartCol","destEndRow","destEndCol","PasteType","isTranspose","srcSheetName"],URL:"gridaction"};break;case ActionConstants.SERVERCLIP_PASTE_RANGE:a={params:["currentSheet","startRow","startCol","endRow","endCol","PasteType","isTranspose"],URL:"gridaction"};break;case ActionConstants.PASTESPECIAL_FORMATS:a={params:["currentSheet","startRow","startCol","endRow","endCol","srcSheet","destStartRow","destStartCol","destEndRow","destEndCol","srcSheetName"],URL:"gridaction"};break;case ActionConstants.DRAG_DROP:a={params:["currentSheet","startRow","startCol","endRow","endCol","srcSheet","destStartRow","destStartCol","srcSheetName","isCopy"],URL:"gridaction"};break;case ActionConstants.CUT_PASTE:a={params:["currentSheet","startRow","startCol","endRow","endCol","srcSheet","destStartRow","destStartCol","srcSheetName"],URL:"gridaction"};break;case ActionConstants.FREEZE_PANES:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.DISCUSSION_ADD:a={params:["currentSheet","content","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_DELETE:case ActionConstants.DISCUSSION_RESOLVE:case ActionConstants.DISCUSSION_REOPEN:a={params:["disId","currentSheet","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_ADD_REPLY:a={params:["disId","content","currentSheet","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_UPDATE_RANGE_CONTENT:a={params:["disId","content","currentSheet","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_UPDATE_REPLY:a={params:["cid","disId","content","currentSheet","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_LIKE:case ActionConstants.DISCUSSION_UNLIKE:a={params:["disId","currentSheet","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_LIKE_REPLY:case ActionConstants.DISCUSSION_UNLIKE_REPLY:case ActionConstants.DISCUSSION_DELETE_REPLY:a={params:["disId","cid","currentSheet","startRow","startCol","endRow","endCol"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_DELETE_ALL:a={params:["isSheetBased","currentSheet","state"],URL:"commentAction"};break;case ActionConstants.DISCUSSION_GET:case ActionConstants.DISCUSSION_UPDATE_SHAREDUSERS:case ActionConstants.DISCUSSION_UPDATE_DOC_CLOSEDTIME:a={URL:"discussionaction"};break;case ActionConstants.NOTIFICATION_SETTINGS:a={params:["state","subaction"],URL:"notificationsettings"};break;case ActionConstants.UPDATE_VIEWPORT:a={params:["currentSheet","rows","columns","scrolledRow","scrolledCol","freezedRow"],URL:"viewport"};break;case ActionConstants.USER_PRESENCE:a={params:["currentSheet","startRow","startCol","endRow","endCol","loginname","userid","color","editstatus","r"],URL:"sendMessage"};break;case ActionConstants.UNDO:case ActionConstants.REDO:case ActionConstants.RECALCULATE:case ActionConstants.UNFREEZE_PANES:case ActionConstants.USED_INDEX:case ActionConstants.READ_SHEET_DETAILS:a={params:["currentSheet"],URL:"gridaction"};break;case ActionConstants.NAMEDRANGE_ADD:case ActionConstants.NAMEDRANGE_MODIFY:a={params:["currentSheet","startRow","startCol","endRow","endCol","rangeName","range"],URL:"gridaction"};break;case ActionConstants.NAMEDRANGE_DELETE:a={params:["rangeName","currentSheet"],URL:"gridaction"};break;case ActionConstants.NAMEDRANGE_READ:a={params:["currentSheet","rangeName","startRow","startCol","endRow","endCol"],URL:"useraction"};break;case ActionConstants.LOCK_RANGE:a={params:["currentSheet","startRow","startCol","endRow","endCol","authUsers","unAuthUsers","authGroups","authOrgs","isPubAuth"],URL:"gridaction"};break;case ActionConstants.UNLOCK_RANGE:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.IS_LOCK_EXISTS:a={params:["currentSheet"],URL:"useraction"};case ActionConstants.READ_PROTECTED_RANGES:a={params:["currentSheet","validateSharedUsers"],URL:"useraction"};break;case ActionConstants.SERVERCLIP_CHECK_LOCALE:case ActionConstants.READ_PROTECTED_SHEETS:a={URL:"useraction"};break;case ActionConstants.GOAL_SEEK:a={params:["currentSheet","vCellSheetName","tCellSheetName","variableCell","targetCell","desiredValue"],URL:"useraction"};break;case ActionConstants.GOAL_SEEK_CANCEL:a={params:["currentSheet","vCellSheetName","variableCell"],URL:"useraction"};break;case ActionConstants.CTRL_NAVIGATION:a={params:["currentSheet","startRow","startCol","endRow","endCol","traverseMode","totalRows","totalCols"],URL:"useraction"};break;case ActionConstants.PICK_LIST:a={params:["currentSheet","startRow","startCol","endRow","endCol","isTypeAhead"],URL:"useraction"};break;case ActionConstants.HIDDEN_ROW_DATA:a={params:["currentSheet","row"],URL:"useraction"};break;case ActionConstants.READ_RECOMMENDED_PIVOT:a={params:["formRid","srcSheet","sourceStartRow","sourceStartCol","sourceEndRow","sourceEndCol","currentSheet","row","column"],URL:"useraction"};break;case ActionConstants.READ_PIVOT_FIELDS:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"useraction"};break;case ActionConstants.DETECT_PIVOT_RANGE:a={params:["currentSheet","row","column"],URL:"useraction"};break;case ActionConstants.READ_PIVOT_FILTER_DATA:a={params:["pivotId","value"],URL:"useraction"};break;case ActionConstants.HIDE_GRID:a={params:["currentSheet"],URL:"gridaction"};break;case ActionConstants.SHOW_GRID:a={params:["currentSheet"],URL:"gridaction"};break;case ActionConstants.JOIN_COLLAB:a={params:["currentSheet","oldrsid","sid","rows","columns","scrolledRow","scrolledCol","freezedRow"],URL:"joincollab"};break;case ActionConstants.POST_DOC_LOAD:case ActionConstants.SWITCH_SHEET:a={params:["currentSheet","isCurrentVersion","isCloseVersionHistory","readCharts","affectedCharts","rows","columns","scrolledRow","scrolledCol","freezedRow"],URL:"postdocloadaction"};break;case ActionConstants.POST_MVIEW_LOAD:a={params:["currentSheet","readCharts"],URL:"postdocloadaction"};break;case ActionConstants.LIST_SHEET_NAMES:a={URL:"useraction"};break;case ActionConstants.SHEET_TABCOLOR:a={params:["currentSheet","sheetTabColor"],URL:"sheetaction"};break;case ActionConstants.GET_SHEET_TABCOLORS:a={URL:"getsheettabcolors"};break;case ActionConstants.SHEET_RENAME:a={params:["oldSheetName","newSheetName","currentSheet"],URL:"sheetaction"};break;case ActionConstants.SHEET_MOVE:a={params:["currentSheet","position"],URL:"sheetaction"};break;case ActionConstants.SHEET_INSERT:a={params:["currentSheet","insertAtEnd","isPivotSheet"],URL:"sheetaction"};break;case ActionConstants.SHEET_DUPLICATE:case ActionConstants.SHEET_COPY:a={params:["sheetName","currentSheet","subMode","insertAfter","copyLocks"],URL:"sheetaction"};break;case ActionConstants.LOCK_SHEET:a={params:["currentSheet","authUsers","unAuthUsers","authGroups","authOrgs","isPubAuth"],URL:"sheetaction"};break;case ActionConstants.SHEET_REMOVE:case ActionConstants.UNLOCK_SHEET:a={params:["currentSheet","formRid"],URL:"sheetaction"};break;case ActionConstants.LOAD_IMAGE:a={params:["sheetName"],URL:"loadimage"};break;case ActionConstants.IMAGE_UPLOAD:a={URL:"imagefileupload"};break;case ActionConstants.IMAGE_NEW:case ActionConstants.IMAGE_REPLACE:case ActionConstants.IMAGE_CLONE:case ActionConstants.IMAGE_MOVE:case ActionConstants.IMAGE_RESIZE:case ActionConstants.IMAGE_REMOVE:a={params:["currentSheet","imageJsonArray"],URL:"gridaction"};break;case ActionConstants.IMAGE_SAVE:a={params:["iVal","type","src","iName","currentSheet"],URL:"saveimage"};break;case ActionConstants.IMAGE_CHECKDELETE:a={params:["imgId"],URL:"useraction"};break;case ActionConstants.IMAGE_DELETE:a={params:["currentSheet","imgId","imgName"],URL:"gridaction"};break;case ActionConstants.CTRL_COMP_ADD:case ActionConstants.CTRL_COMP_CLONE:case ActionConstants.CTRL_COMP_MOVE:case ActionConstants.CTRL_COMP_RESIZE:case ActionConstants.CTRL_COMP_SETCAPTION:a={params:["currentSheet","left","top","height","width","dummyId","name","caption","function","cloneType"],URL:"gridaction"};break;case ActionConstants.CTRL_COMP_ASSIGNMACRO:a={params:["currentSheet","name","function"],URL:"gridaction"};break;case ActionConstants.CTRL_COMP_DELETE:a={params:["currentSheet","name"],URL:"gridaction"};break;case ActionConstants.SYNC_CHECK:a={params:["docId","collabstatus","bv"],URL:"getstatus"};break;case ActionConstants.MACRO_SAVE:a={params:["currentSheet","moduleContent"],URL:"gridaction"};break;case ActionConstants.ENABLE_EVENTS:a={URL:"gridaction"};break;case ActionConstants.MACRO_RUN:case ActionConstants.MACRO_SAVE_RUN:a={params:["currentSheet","startRow","startCol","endRow","endCol","moduleName","macroName","lineNo","moduleContent"],URL:"macro"};break;case ActionConstants.MACRO_INSERT:a={params:["macroName","description"],URL:"gridaction"};break;case ActionConstants.MACRO_DELETE:a={params:["currentSheet","moduleName","macroName"],URL:"gridaction"};break;case ActionConstants.MACRO_START_RECORDING:a={params:["macroName"],URL:"gridaction"};break;case ActionConstants.MACRO_STOP_RECORDING:case ActionConstants.MACRO_CANCEL_RECORDING:a={params:["recordObj"],URL:"gridaction"};break;case ActionConstants.MACRO_CONTENT_CHANGED:a={params:["moduleNames","actionOwner"],URL:"macro"};break;case ActionConstants.CLOSE_DOCUMENT:a={action:!1,URL:"closedoc",params:["currentSheet","workBookSheets","highlightSelected","copyDoc"]};break;case ActionConstants.SAVE_RTL_SHEET:a={params:["currentSheet","isRTL"],URL:"sheetaction"};break;case ActionConstants.OPEN_EXPLORE:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"useraction"};break;case ActionConstants.NL_QUERY:a={params:["currentSheet","query"],URL:"useraction"};break;case ActionConstants.INIT_I18N_SESSION:a={URL:"initi18nsession"};break;case ActionConstants.RENAME_VERSION:a={params:["versionLabel","revTimeStamp","revVerNo"],URL:"versiondocument"};break;case ActionConstants.CREATE_VERSION:a={params:["versionLabel"],URL:"versiondocument"};break;case ActionConstants.VIEW_VERSION:a={params:["newVersionNo","prevVersionNo"],URL:"viewversion"};break;case ActionConstants.REVERT_VERSION:a={params:["newVersionNo"],URL:"gridaction"};break;case ActionConstants.DELETE_VERSION:a={params:["newVersionNo"],URL:"versiondocument"};break;case ActionConstants.REVERT_VERSION_ON_ERROR:a={params:["newVersionNo"],URL:"versiondocument"};break;case ActionConstants.SAVE_DOCUMENT:a={params:["currentSheet"],URL:"save"};break;case ActionConstants.RENAME_DOCUMENT:a={params:["newDocName"],URL:"save"};break;case ActionConstants.LOAD_SHEET:a={params:["currentSheet","newOrOpen","viewType","height","width","pivotType","parentTable","zdbdiv","isCurrentVersion"],URL:"loadsheet"};break;case ActionConstants.HYPERLINK:a={params:["currentSheet","startRow","startCol","endRow","endCol","subMode","cellValue","url"],URL:"gridaction"};break;case ActionConstants.SCROLL:a={params:["currentSheet","startCol","endCol","scrollType","rowsToLoad","isExecIdNeeded","viewPortHeight","showFormulas","highlightVersionChanges","isCloseVersionHistory","isCurrentVersion","isVeryFirstScroll","scrollTop","rowToView","documentVersion"],URL:"enginescroll"};break;case ActionConstants.LOAD_BOOK:a={params:["docRequestedTime","toolbarInputs"],URL:"loadbook"};break;case ActionConstants.CELL_COMMENT:a={params:["currentSheet","startRow","startCol","endRow","endCol","subMode","comment"],URL:"gridaction"};break;case ActionConstants.RESET_ANNOTE_POSITION:a={params:["currentSheet","row","column","xPos","yPos","width","height"],URL:"useraction"};break;case ActionConstants.COPY_DOCUMENT:a={URL:"copydoc"};break;case ActionConstants.SAVE_TO_MYACCOUNT:a={params:["saveChanges","remoteView","sheetName"],URL:"savetomyacc"};break;case ActionConstants.AUTHENTICATE_SAVE_TO_MYACCOUNT:a={params:["saveChanges","remoteView","sheetName"],URL:"authenticatesavetomyaccount"};break;case ActionConstants.VERIFY_ACCOUNT:a={URL:"verifyaccount"};break;case ActionConstants.NEW_SPREADSHEET_FROM_TEMPLATE:case ActionConstants.SAVEAS_NEW_TEMPLATE:case ActionConstants.SAVEAS_NEW_DOCUMENT:a={params:["newDocName"],URL:"copydoc"};break;case ActionConstants.RENAME_TEMPLATE:a={params:["newDocName"],URL:"template"};break;case ActionConstants.DELETE_TEMPLATE:a={URL:"template"};break;case ActionConstants.DOC_COMMENT_SAVE:a={params:["type","value","commentId"],URL:"save_doc_comment"};break;case ActionConstants.DOC_COMMENT:a={params:["inside","isEdit","editorTheme"],URL:"doc_comment"};break;case ActionConstants.WEB_DATA:a={params:["mode","currentSheet","webdataUrl","webdataSheet","webdataCell","webdataInterval","selectTbls"],remoteDetails:!1,URL:"gridaction"};break;case ActionConstants.UPDATE_WEB_DATA:a={params:["mode","currentSheet","webdataUrl","webdataSheet","webdataCell","webdataInterval","selectTbls","webdataId","feedupdate"],remoteDetails:!1,URL:"gridaction"};break;case ActionConstants.GET_HTML_WEBDATA:a={params:["mode","currentSheet","webdataUrl","webdataSheet"],remoteDetails:!1,URL:"useraction"};break;case ActionConstants.JSP_REMOTEDATA_LIST:a={params:["docid","versionDetailsNo"],URL:"pages/remotedatalist.jsp",isDocSpecificURL:!1};break;case ActionConstants.CHART:a={params:["currentSheet","viewType","row","column","sRowDiff","sColDiff","mode","GENPUBLICCHART","doNotSave"],URL:"chart"};break;case ActionConstants.VIEW_PUBLISH_RANGE:a={params:["id","fetchhtmldata"],URL:"publishrangeproxy"};break;case ActionConstants.SHOW_PUBLISH_RANGE:a={params:["currentSheet","orgName"],URL:"showpublishrange"};break;case ActionConstants.UPDATE_PUBLISH_RANGE:a={params:["mode","id","from","sheetName","startRow","startCol","endRow","endCol"],URL:"updatepublishrange"};break;case ActionConstants.RANGE_PUBLISH:a={params:["currentSheet","range","type"],URL:"rangepublish"};break;case ActionConstants.UPDATE_OLE:a={params:["img","hasImages","button","hasButtons","chart","hasCharts","currentSheet","isRemoteView"],URL:"updateole"};break;case ActionConstants.CREATE_PIVOT:case ActionConstants.EDIT_PIVOT:a={params:["srcSheet","sourceStartRow","sourceStartCol","sourceEndRow","sourceEndCol","currentSheet","row","column","fields","pivotFunctions","pivotId","groups","overwriteData","isNewSheet","isFromRecommended","pSortDetail","pFilterDetail"],URL:"gridaction"};break;case ActionConstants.DELETE_PIVOT:a={params:["pivotId"],URL:"gridaction"};break;case ActionConstants.REFRESH_PIVOT:a={params:["pivotId","overwriteData"],URL:"gridaction"};break;case ActionConstants.REFRESH_ALL_PIVOT:a={params:[],URL:"gridaction"};break;case ActionConstants.APPLYFILTER_PIVOT:a={params:["pivotId","fieldType","headerIndex","pivotFilterJsonParam","selectAll","overwriteData"],URL:"gridaction"};break;case ActionConstants.SORT_PIVOT:a={params:["pivotId","fieldType","headerIndex","isAscending","overwriteData","sortMode"],URL:"gridaction"};break;case ActionConstants.CHANGE_DISPLAYINFO_PIVOT:a={params:["pivotId","fieldType","headerIndex","displayMemberMode","count","overwriteData","sortMode"],URL:"gridaction"};break;case ActionConstants.MOVE_PIVOT:a={params:["currentSheet","isNewSheet","row","column","pivotId","overwriteData"],URL:"gridaction"};break;case ActionConstants.CHANGE_PIVOT_SOURCE:a={params:["srcSheet","sourceStartRow","sourceStartCol","sourceEndRow","sourceEndCol","pivotId","overwriteData"],URL:"gridaction"};break;case ActionConstants.CHANGE_PIVOT_THEME:a={params:["pivotId","theme","accent"],URL:"gridaction"};break;case ActionConstants.CHANGE_PIVOT_SUBTOTALOPTION:case ActionConstants.CHANGE_PIVOT_GRANDTOTALROWOPTION:case ActionConstants.CHANGE_PIVOT_GRANDTOTALCOLOPTION:a={params:["pivotId","value"],URL:"gridaction"};break;case ActionConstants.PERFORMUSEROPTION_PIVOT:a={params:["pivotId","cap"],URL:"gridaction"};break;case ActionConstants.GET_FILTER_DATA:a={params:["currentSheet","filterCol","index"],URL:"filterAction"};break;case ActionConstants.CREATE_FILTER:case ActionConstants.REMOVE_FILTER:case ActionConstants.FILTER_REAPPLY:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.APPLY_FILTER:a={params:["currentSheet","index","dt","fv1","fc1","fv2","fc2","fo","filtertype","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.APPLY_FILTER_READ_ONLY:a={params:["currentSheet","index","dt","fv1","fc1","fv2","fc2","fo","filtertype","startRow","startCol","endRow","endCol","isCurrentVersion"],URL:"filterAction"};break;case ActionConstants.FILTER_CALLBACK:a={params:["currentSheet","startRow","endRow"],URL:"filterAction"};break;case ActionConstants.FILTER_BY_VALUE:case ActionConstants.FILTER_BY_CELL_COLOR:case ActionConstants.FILTER_BY_FONT_COLOR:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"gridaction"};break;case ActionConstants.FIND:a={params:["currentSheet","startRow","startCol","endRow","endCol","row","column","cellContent","isNext","isCaseSensitive","isExactMatch","traverseMode"],URL:"useraction"};break;case ActionConstants.REPLACE:case ActionConstants.REPLACE_ALL:a={params:["currentSheet","startRow","startCol","endRow","endCol","row","column","cellContent","replaceString","isNext","isCaseSensitive","isExactMatch","traverseMode"],URL:"gridaction"};break;case ActionConstants.EXPORT_DOCUMENT:a={params:["currentSheet","ftype","version"],URL:"export"};break;case ActionConstants.GET_TEMPLATES:a={params:["sortval","filterval"],URL:"useraction"};break;case ActionConstants.CHART_NEW:case ActionConstants.CHART_EDIT:a={params:["currentSheet","id","chartType","dataRange","seriesIn","frl","fcl","lpos","sr","sc","srd","scd","left","top","wd","ht","title","subTitle","xTitle","tooltip","zoom","animation","trendline","isFloating","majorGridLineWidth","minorTickInterval","xLabel","yLabel","isSingleYAxis","isIncludeHiddenCells","slant","labelFormat","sline","appedingWay","isMarker","trendlineType","threshold","degree","autoExpand","actionList","isPivotChart","pivotId","isCloned","comboChartTypes","yAxis","lineStyles","aggregation","filter","isFromZia"],URL:"chartaction"};break;case ActionConstants.CHART_QUICK_EDIT:a={params:["currentSheet","id","subAction","value"],URL:"chartaction"};break;case ActionConstants.CHART_MOVE_TO_NEW_SHEET:a={params:["currentSheet","id","newSheetName","position"],URL:"chartaction"};break;case ActionConstants.CHART_MOVE:a={params:["currentSheet","id","sr","sc","srd","scd","left","top"],URL:"chartaction"};break;case ActionConstants.CHART_RESIZE:a={params:["currentSheet","id","wd","ht","sr","sc","srd","scd","left","top","isReadChartOptions"],URL:"chartaction"};break;case ActionConstants.CHART_DELETE:a={params:["currentSheet","id"],URL:"chartaction"};break;case ActionConstants.CHART_PUBLISH:case ActionConstants.CHART_UNPUBLISH:a={params:["currentSheet","id"],URL:"chartaction"};break;case ActionConstants.JSP_CHART_MAKE_PUBLIC:a={params:["url","height","width","title"],isDocSpecificURL:!1,URL:"pages/publishcharturls.jsp"};break;case ActionConstants.CHART_SAVE:a={params:["currentSheet","id"],URL:"useraction"};break;case ActionConstants.CHART_DETAILS:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"useraction"};break;case ActionConstants.PIVOT_CHART_DETAILS:a={params:["currentSheet","id","isPivotChart","pivotId"],URL:"useraction"};break;case ActionConstants.CHART_UPDATE:a={params:["currentSheet","id","sr","sc","srd","scd","left","top"],URL:"useraction"};break;case ActionConstants.CHART_REFRESH:a={params:["currentSheet","chartList"],URL:"useraction"};break;case ActionConstants.CHART_PREVIEW:a={params:["currentSheet","id","chartType","dataRange","seriesIn","frl","fcl","lpos","sr","sc","srd","scd","left","top","wd","ht","title","subTitle","xTitle","tooltip","zoom","animation","trendline","isFloating","majorGridLineWidth","minorTickInterval","xLabel","yLabel","isSingleYAxis","isIncludeHiddenCells","slant","labelFormat","sline","appedingWay","isMarker","trendlineType","threshold","degree","autoExpand","actionList","isPivotChart","pivotId","isCloned","comboChartTypes","yAxis","lineStyles","aggregation","filter","isFromZia"],URL:"previewaction"};break;case ActionConstants.FETCH_DECLARATIVE_TABLE:a={params:["currentSheet","dataRange","isCol"],URL:"previewaction"};break;case ActionConstants.CLEAR_CHART_DETAILS:a={params:["currentSheet"],URL:"previewaction"};break;case ActionConstants.GET_CHART_RECOMMENDATION:a={params:["currentSheet","dataRange","seriesIn","appedingWay","frl","fcl","isIncludeHiddenCells","aggregationProcess","isAndroidClient"],URL:"useraction"};break;case ActionConstants.CHART_CELL_REF:a={params:["currentSheet","cellRange"],URL:"previewaction"};break;case ActionConstants.VIRTUAL_CHART:a={params:["currentSheet","cellRange"],URL:"previewaction"};break;case ActionConstants.PIVOT_CHART_BUTTON_DETAILS:a={params:["currentSheet","pivotButtonRange"],URL:"previewaction"};break;case ActionConstants.CHART_QUICK_STYLE:a={params:["currentSheet","id","subAction","chartStyles"],URL:"chartaction"};break;case ActionConstants.CHART_COPY_STYLE:a={params:["currentSheet","id"],URL:"useraction"};break;case ActionConstants.CHART_PASTE_STYLE:a={params:["currentSheet","id","copiedId"],URL:"chartaction"};break;case ActionConstants.JSP_MANAGE_MACROS:a={params:["currentSheet","startRow","startCol","endRow","endCol","mode","viewType"],URL:"managemacros"};break;case ActionConstants.JSP_RANGE_SNIPPET:a={params:["pubType","subaction","orgName","url","id","height","width","type","title"],URL:"pages/rangesnippet.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_IMPORTDIV:a={params:["csvMashUp"],URL:"importdiv"};break;case ActionConstants.JSP_FUNCTIONS:a={params:["viewType"],URL:"pages/functions.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_FUNCTIONSLIST:a={params:["viewType","workBookLocale"],URL:"pages/functionslist.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_ASSIGN_MACRO:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"assignmacro"};break;case ActionConstants.JSP_PUBLIC:a={URL:"public"};break;case ActionConstants.JSP_CONFIRMATIONPROMPT:a={params:["fname","msgone","msgtwo","chk","msgtype","inputmsg1","inputmsg2"],URL:"confirmationprompt"};break;case ActionConstants.JSP_SETTINGS:a={URL:"pages/settings.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_EDIT_COND_FORMAT:a={params:["rname"],URL:"pages/editcondformat.jsp",isDocSpecificURL:!1};break;case ActionConstants.COLOR_SCALES_APPLY:case ActionConstants.ICON_SET_APPLY:case ActionConstants.CONDITIONAL_FORMAT_APPLY:case ActionConstants.CONDITIONAL_FORMAT_EDIT:case ActionConstants.CONDITIONAL_STYLE_REORDER:case ActionConstants.CONDITIONAL_FORMAT_DELETE:a={params:["currentSheet","conditionsparam","csuid"],URL:"gridaction",docParams:!1};break;case ActionConstants.CONDITIONAL_FORMAT_READ_DATATYPE:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"useraction",docParams:!1};break;case ActionConstants.DATA_VALIDATION_CLEAR:case ActionConstants.CONDITIONAL_FORMAT_CLEAR_RULE:a={params:["currentSheet","startRow","startCol","endRow","endCol","conditionsparam","csuid"],URL:"gridaction",docParams:!1};break;case ActionConstants.CONDITIONAL_FORMAT_READ_EDITOBJ:case ActionConstants.CONDITIONAL_FORMAT_READ_RANGE:case ActionConstants.CONDITIONAL_FORMAT_READ_SHEET:case ActionConstants.CONDITIONAL_FORMAT_READ_WORKBOOK:case ActionConstants.DATA_VALIDATION_READWORKBOOK:case ActionConstants.DATA_VALIDATION_READSHEET:case ActionConstants.DATA_VALIDATION_READRANGE:a={params:["currentSheet","dateFormat","timeFormat","startRow","startCol","endRow","endCol"],URL:"useraction",docParams:!1};break;case ActionConstants.DATA_HIGHLIGHT_INVALID:a={params:["currentSheet"],URL:"useraction",docParams:!1};break;case ActionConstants.RESET_HIGHLIGHT_INVALID:a={params:["currentSheet"],URL:"useraction",docParams:!1};break;case ActionConstants.VALIDATE_INPUT_CF:a={params:["currentSheet","validateFor","valCFInpsJson"],URL:"useraction",docParams:!1};break;case ActionConstants.VALIDATE_INPUT:a={params:["currentSheet","startRow","startCol","endRow","endCol","validateFor","valInpsJson"],URL:"useraction",docParams:!1};break;case ActionConstants.JSP_EXTERNAL_DATA:a={URL:"pages/externaldata.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_REMOTE_DATA_LIST:a={params:["docid","versionDetailsNo"],URL:"pages/remotedatalist"};break;case ActionConstants.JSP_EXTERNAL_DATA_EDIT:a={URL:"pages/externaldataedit.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_COPY_SIGNIN:a={params:["split","src"],URL:"copysignin.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_INSERT_HTML:a={URL:"pages/inserthtml.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_INSERT_IMAGE:a={params:["mode","viewType"],URL:"insertimage"};break;case ActionConstants.JSP_RUN_MACROS:a={params:["currentSheet","startRow","startCol","endRow","endCol"],URL:"runmacros"};break;case ActionConstants.JSP_MAKE_PUBLISH:a={params:["url","isPublic","showURL","isSemi","callFrom","showFormulas","allowExport","showPublic","type"],URL:"pages/makepublish.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_EDIT_CHART:a={params:["mode"],URL:"pages/editchart.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_MAKE_PUBLIC:a={params:["rid","showPublic","orgName","type","allowExport","showFormulas","allowOrgEdit","doc_type","isSemi","isPublic"],isDocSpecificURL:!1,URL:"pages/dialogs/makepublicdialog.jsp"};break;case ActionConstants.JSP_CONFIRM_PUBLIC_TEMPLATE:a={params:["showPublic","orgName","type","allowExportOrg","showFormulasOrg","doc_type","url","isSemi"],URL:"maketemplatepublic"};break;case ActionConstants.JSP_NOTIFY_SHARED_USERS:a={URL:"notifysharedusers"};break;case ActionConstants.JSP_MANAGE_GROUPS:a={URL:"pages/managegroups.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_MAKE_TEMPLATE_PUBLIC:a={URL:"maketemplatepublic"};break;case ActionConstants.JSP_NEW_DOCFROM_TEMPLATE:a={URL:"newdocfromtemplate"};break;case ActionConstants.JSP_SAVE_OPTION:a={URL:"pages/saveoption.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_VERSION_VIEW_DIALOG:a={params:["allowRevert","isParseError","startPoint","versionIndex","scrollHeight","isNamedVesionOnly","divDimensions"],URL:"useraction"};break;case ActionConstants.JSP_VIEW_ACTIONLIST:a={params:["showAll","isCurrentVersion"],URL:"viewactiondetail"};break;case ActionConstants.JSP_PRINT_DIALOG:a={URL:"pages/dialogs/printdialog.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_NOTIFIER:a={params:["msg","moreInfo","msgType"],URL:"pages/notifier.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_HYPERLINK:a={params:["currentSheet","sheetNames","rangeNames","cellValue"],URL:"pages/Hyperlink.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_MACROEDITOR:a={params:["currentSheet","startRow","startCol","endRow","endCol","width","moduleName","lineNo","macroName","viewType"],URL:"macroeditor"};break;case ActionConstants.JSP_MACROERROR:a={params:["msg","error","moduleName","lineNo","modType"],URL:"pages/macroerror.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_GOTO:a={params:["namedRanges"],URL:"pages/goto.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_FIND:a={URL:"pages/find.jsp",isDocSpecificURL:!1};break;case ActionConstants.SHARE_PERMISSION_CHANGE:a={URL:"WmsNotification"};break;case ActionConstants.CHECKIN_CHECKOUT:a={URL:"WmsNotification"};break;case ActionConstants.CHECKIN_CHECKOUT_FROM_SHEET:a={params:["subaction"],URL:"CheckInCheckOutAction"};break;case ActionConstants.SHARE_REMOVE_BYOWNER:a={URL:"WmsNotification"};break;case ActionConstants.JSP_FORMATCELLS:a={params:["startRow","endRow","startCol","endCol","row","column","currentSheet","mode","defaultFrmtType"],URL:"formatcellsdialog"};break;case ActionConstants.JSP_CUSTOM:a={URL:"pages/dialogs/customformatdialog.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_GOALSEEK:a={URL:"pages/dialogs/goalseekdialog.jsp",isDocSpecificURL:!1};break;case ActionConstants.JSP_NAMEDRANGE:a={params:["row","column"],URL:"namedrange"};break;case ActionConstants.CHAT_MSG:a={params:["msg"],URL:"sendMessage"};break;case ActionConstants.BROWSER_PRINT:a={params:["sheetName","printloop","browser_ie","range","rowtop","totalRows"],URL:"browserPrint"};break;case ActionConstants.FORMATCELLS_CLIENT:a={params:["currentSheet","startRow","startCol","endRow","endCol","row","column","frmtCellsParam"],URL:"useraction"};break;case ActionConstants.FORMATCELLS_GRID:a={params:["currentSheet","startRow","startCol","endRow","endCol","frmtCellsParam"],URL:"gridaction"};break;case ActionConstants.REMOTE_SAVE:a={URL:"remotesave"};break;case ActionConstants.AUDIT_TRAIL:a={URL:"auditTrail"};break;case ActionConstants.AUDIT_FILTER_BY_NAME:a={params:["user"],URL:"audittrailfilter"};break;case ActionConstants.AUDIT_FILTER_BY_DATE:a={params:["dateType","from","to"],URL:"audittrailfilter"};break;case ActionConstants.AUDIT_FILTER_BY_SHEET:case ActionConstants.AUDIT_FILTER_BY_RANGE:a={params:["auditRange"],URL:"audittrailfilter"};break;case ActionConstants.CREATE_CHAT:a={params:["r"],URL:"sendMessage"};break;case ActionConstants.COLLAB_USERS_STATUS:a={URL:"collabUsersStatus"};break;case ActionConstants.SOLVER:a={params:["currentSheet","startRow","startCol","endRow","endCol","vCellsSheetName","objectiveCell","oCellSheetName","goalType","isValueboxSelected","nonNegRestriction","constrLHS","constrREL","constrRHS","specificValue"],URL:"useraction"};break;case ActionConstants.SOLVER_CANCEL:a={params:["currentSheet","startRow","startCol","endRow","endCol","vCellsSheetName","oldValue"],URL:"useraction"};break;case ActionConstants.PIVOT_UPDATEPROPERTIES:a={params:["sheetName","reportDesc","reportTitle"],URL:"useraction"};break;case ActionConstants.PIVOT_GETRANGE:a={params:["sheetName"],URL:"useraction"};break;case ActionConstants.PIVOT_EDIT:a={params:["sheetName","dataSheetName","rangeAddr"],URL:"useraction"};break;case ActionConstants.PIVOT_REFRESH:a={params:["sheetName"],URL:"useraction"};break;case ActionConstants.MAKE_PUBLIC:a={params:["docs","html","isSemi","docName","showFormulas","allowExport","showPublic","type","doc_type","allowOrgEdit"],URL:"makepublic"};break;case ActionConstants.DATA_VALIDATION_APPLY:a={params:["currentSheet","startRow","startCol","endRow","endCol","dvJSON"],URL:"gridaction",docParams:!1};break;case ActionConstants.DATA_VALIDATION_READLIST:a={params:["currentSheet","row","column","tparts","partnum"],URL:"useraction"};break;case ActionConstants.MANAGE_PUBLIC:a={params:["type","docs","html","propertyName","propertyValue"],URL:"makepublic"};break;case ActionConstants.SERVERCLIP_REMOVE:a={params:["from"],URL:"useraction"};break;case ActionConstants.GET_FORMULA_SUGGEST_INFO:a={URL:"useraction"};break;case ActionConstants.PDF_DATA:a={params:["subaction","pdfTime","iName"],URL:"fetchpdfdata"};break;case ActionConstants.PDF_PRINT:a={params:["sheetName","margin","range","paperWidth","paperHeight","addGridLine","addChart","addImage","addButton","fitToWidth","orientation","outputType","printType","skipL7Check"],URL:"print"};break;case ActionConstants.PDF_PRINT_PREVIEW:a={params:["sheetName","range","addGridLine","addChart","addImage","addButton","printType"],URL:"print"};break;case ActionConstants.GDRIVEDOC_UPDATE:a={params:["gdrivemode"],URL:"updategdrivedoc"};break;case ActionConstants.GET_SHARED_USER:a={params:[],URL:"getshareduserinfo"};break;case ActionConstants.TEXTTOCOLUMNS_APPLY:a={params:["srcSheet","currentSheet","startRow","startCol","endRow","endCol","delimiters","enclosure","isMergeDelimitersChecked","destStartRow","destStartCol","columnHeads","cellContent","countryName","startsFromRow"],URL:"gridaction"};break;case ActionConstants.TEXTTOCOLUMNS_PREVIEW:a={params:["srcSheet","currentSheet","startRow","startCol","endRow","endCol","delimiters","enclosure","isMergeDelimitersChecked","cellContent","startsFromRow"],URL:"useraction"};break;case ActionConstants.FEEDBACK:a={params:["fbsubject","fbmessage","feedBackAttachment","SenderDetails","BUILDVersion"],URL:"feedback"};break;case ActionConstants.IPHONE_APPENDROWS:a={params:["sheet","printloop","range","rowtop","totalRows"],URL:"iphoneviewlazyload"};break;case ActionConstants.REMOTEIPHONE_APPENDROWS:a={params:["sheet","doc","printloop","range","rowtop","totalRows"],URL:"iphoneviewlazyload"};break;case ActionConstants.PUBLICHTML_APPENDROWS:a={params:["sheet","printloop","range","rowtop","totalRows","mode"],URL:"publichtml"};break;case ActionConstants.CHANGE_DOC_STATUS:a={params:[],URL:"useraction"};break;case ActionConstants.FORM_CREATE:a={params:["currentSheet","insertAtEnd","formName","formDesc"],URL:"webformaction"};break;case ActionConstants.DETECT_FORM_RANGE:a={params:["sR","sC","eR","eC","currentSheet"],URL:"webformaction"};break;case ActionConstants.PREDICT_DATATYPES:a={params:["sR","sC","eR","eC","currentSheet"],URL:"webformaction"};break;case ActionConstants.CONVERT_FORM:a={params:["sR","sC","eR","eC","formName","formDesc","isFirstRowAsHeader","columnList","dataTypeList","currentSheet"],URL:"webformaction"};break;case ActionConstants.FORM_DELETE:a={params:["formRid","currentSheet"],URL:"webformaction"};break;case ActionConstants.FORM_DELETE_ON_REVERT_VERSION:a={params:["currentSheet"],URL:"webformaction"};break;case ActionConstants.JSP_FORM_CREATE:a={URL:"createformdialog"};break;case ActionConstants.FORM_FIELD_ADDED:a={params:["resource_id"],URL:"gridaction"};break;case ActionConstants.FORM_REPORT_CREATE:a={params:["formRid","srcSheet","selectedReport","currentSheet","row","column","pivotJson"],URL:"gridaction"};break;case ActionConstants.PROTECT_RANGE_DIALOG:a={params:["startRow","startCol","endRow","endCol","currentSheet","isSheet","isExtend","exSr","exSc","exEr","exEc"],URL:"useraction"};break;case ActionConstants.JSP_PUBLISH_FORM:a={params:["formRid","type","orgName"],isDocSpecificURL:!1,URL:"pages/dialogs/publishformdialog.jsp"};break;case ActionConstants.JSP_PUBLISH_FORM_URL:a={params:["formRid","type","orgName"],isDocSpecificURL:!1,URL:"pages/publicformurl.jsp"};break;case ActionConstants.JSP_CANCEL_PUBLISH_FORM:a={params:["type"],isDocSpecificURL:!1,URL:"pages/cancelformpublic.jsp"};break;case ActionConstants.SERVERCLIP_COPY_SHEET:a={params:["currentSheet",JSONConstants.SHEETS_TO_COPY],URL:"useraction"};break;case ActionConstants.SERVERCLIP_PASTE_SHEET_CANCEL:case ActionConstants.SERVERCLIP_GET_REFSHEETS:a={params:["currentSheet","from"],URL:"useraction"};break;case ActionConstants.SHEET_COPY_CREATE_NEW_SPREADSHEET:a={params:["currentSheet",JSONConstants.COPY_REFERRED_SHEETS],URL:"useraction"};break;case ActionConstants.SERVERCLIP_PASTE_SHEET:a={params:["currentSheet",JSONConstants.COPY_REFERRED_SHEETS],URL:"gridaction"};break;case ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL:a={params:["currentSheet","srid","startRow","startCol","sdn"],URL:"gridaction"};break;case ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET:case ActionConstants.IMPORT_REPLACE_CURRENTSHEET:case ActionConstants.IMPORT_REPLACE_SPREADSHEET:case ActionConstants.IMPORT_INSERT_AS_NEW_SHEETS:a={params:["currentSheet","srid","sdn"],URL:"gridaction"};break;case ActionConstants.IMPORT_CANCEL:a={params:["currentSheet","srid"],URL:"useraction"};break;case ActionConstants.HIGHLIGHT_VERSION_CHANGES:a={params:["currentSheet"],URL:"versiondocument"};break;case ActionConstants.CLEAR_AUDITTRAIL_ACTIONLIST:a={params:["currentSheet"],URL:"versiondocument"};break;case ActionConstants.LOCK_MULTIPLE:a={params:["prObj","isSheet"],URL:"gridaction"};break;case ActionConstants.GET_WMS_USERS:a={params:["subaction"],URL:"getwmsusers"};break;case ActionConstants.SERVERCLIP_CLIPBOARD_COMPARE:a={params:["cellContent"],URL:"useraction"};break;default:showAlertDialog("Action params are not defined :"+t)}return a}};
function RequestParameters(t){this.action=t,this.actionParams=ActionProps.get(this.action),this.actionParams.isDocSpecificURL=isUndefined(this.actionParams.isDocSpecificURL)?!0:!1,this.opType=isUndefined(this.actionParams.opType)?0:this.actionParams.opType,this.keyAry=this.actionParams.params,this.valueAry=[]}RequestParameters.prototype={setParameters:function(){this.valueAry=Array.prototype.slice.call(arguments,0)},getParametersAsString:function(){var t=new StringBuffer,i=this.keyAry,e=this.valueAry;if(i)for(var n=0,s=i.length;s>n;n++){var a=e[n];null!=a&&void 0!=a&&t.append(i[n]+"="+a)}if(this.actionParams.isDocSpecificURL&&this._bufferDocParams(t),jsPRINT_VIEW||jsIPHONE_VIEW&&null==RMUSER||jsPUBLISH_RANGE_VIEW||!REMOTE.ISRMVIEW&&!jsPUBLIC_VIEW&&-1!=zuid||(t.append("RMNAME="+RMUSER),jsPUBLIC_VIEW||jsHTML_VIEW||jsIPHONE_VIEW||t.append("doc="+REMOTE_ENC_DOC_ID)),jsIPHONE_VIEW&&aTk&&t.append("authtoken="+aTk),jsPUBLIC_VIEW&&(t.append("cid="+COLLAB_ID),void 0!=TEMP_CONTAINER_IDENTITY&&t.append("temp_container_identity="+TEMP_CONTAINER_IDENTITY)),(0===this.opType&&this.action!==ActionConstants.GDRIVEDOC_UPDATE&&this.action!==ActionConstants.VIEW_PUBLISH_RANGE&&this.action!==ActionConstants.EXPORT_DOCUMENT&&this.action!==ActionConstants.IMAGE_SAVE&&this.action!==ActionConstants.PDF_PRINT&&this.action!==ActionConstants.PDF_DATA&&this.action!==ActionConstants.AUDIT_TRAIL&&this.action!==ActionConstants.AUTHENTICATE_SAVE_TO_MYACCOUNT&&this.action!==ActionConstants.FEEDBACK||3===this.opType)&&t.append(csrfParamName+"="+readCookie(csrfCookieName)),!(jsPRINT_VIEW||jsHTML_VIEW||jsIPHONE_VIEW||jsPUBLISH_RANGE_VIEW)){var o=this.actionParams.URL,r=o&&("gridaction"===o||"sheetaction"===o||"chartaction"===o);WebMessanger.getRawSid()?t.append("rsid="+WebMessanger.getRawSid()):r&&t.append("tempViewPort="+this._getViewPortAsString()),utid&&(r||o&&"enginescroll"===o)&&t.append("utid="+utid)}return t.toString("&")},getURL:function(){return this.actionParams.isDocSpecificURL?ctxpath+docCtxPath+DOCUMENT_INFO.DOCUMENT_POINTER:ctxpath+this.actionParams.URL},_getViewPortAsString:function(){var t=Row.getVisibleRowsInViewPortAsJSONStr(!1),i='[{"sc":0,"ec":'+(totCols-1)+"}]",e={};return e.currentSheet=WorkSheets.getAssociatedActiveSheetName(),e.rows=t,e.columns=i,e.scrolledRow=totRows,e.scrolledCol=totCols,e.freezedRow=FREEZED_ROW,JSON.stringify(e)},_bufferDocParams:function(t){if(t.append("proxyURL="+this.actionParams.URL),this.action==ActionConstants.NEW_SPREADSHEET_FROM_TEMPLATE||this.action==ActionConstants.RENAME_TEMPLATE||this.action==ActionConstants.DELETE_TEMPLATE?t.append("rid="+templateActionRid):"REMOTE"!=accessIdentity&&t.append("rid="+RESOURCE_ID),t.append("action="+this.action),jsVERSION_VIEW&&""!=DOCUMENT_VERSION&&t.append("versionNo="+DOCUMENT_VERSION),!jsIPHONE_VIEW&&this.keyAry&&-1!==this.keyAry.indexOf("currentSheet")){var i=WorkSheets.getSheetNameFromCode(this.valueAry[this.keyAry.indexOf("currentSheet")]),e=i?i:CURRSHEETNAME;t.append("currSheetName="+e)}var n=this.actionParams.URL;!jsREMOTE_SAVE_VIEW||"gridaction"!=n&&"sheetaction"!=n||btn_enabled()}};var StringBuffer=function(){this.buffer=[],this.index=0};StringBuffer.prototype={append:function(t){this.buffer[this.index]=t,this.index++},toString:function(t,i){return i&&0==this.buffer.length?null:this.buffer.join(t)}};
function PulsatingQueue(){this.init()}function RequestManager(e){this.requestQueue=new PulsatingQueue,this.isSendingRequest=!1,this.MAX_REQUEST=e,this.lastRequest,this.listenerHolder={}}PulsatingQueue.prototype={init:function(){this.head={},this.head.length=0,this.head.next=this.head,this.head.prev=this.head},add:function(e){var t={data:e,next:null,prev:null};t.next=this.head.next,this.head.next=t,t.prev=this.head,t.next.prev=t,this.head.length++},retrive:function(){if(0==this.head.length)return null;var e=this.head.prev,t=e.data;return this.head.prev=e.prev,e.prev.next=this.head,this.head.length--,delete e.prev,delete e.next,delete e,t},get:function(){return 0!=this.head.length?this.head.prev.data:null},getSize:function(){return this.head.length},isEmpty:function(){return 0==this.head.length},insertFront:function(e){var t={data:e,next:null,prev:null};t.prev=this.head.prev,t.next=this.head,this.head.prev.next=t,this.head.prev=t,this.head.length++},iterate:function(e){var t=Array.prototype.slice.call(arguments,1),s=this.head.length,n=this.head.prev;for(t.unshift(n.data);s>0;)e.apply(void 0,t),n=n.prev,s--}},RequestManager.prototype={addRequest:function(e){showSaveMessage("enable"),e.addEventListener("onBeforeComplete2",this.onComplete.bind(this)),e.addEventListener("onError",this.onError.bind(this)),appEvent.trigger("request.addedInQue",[e.parameters]),this.requestQueue.add(e),Logger.isEnabled&&Logger.updateRequestIndicator(this.requestQueue.getSize());var t=this.requestQueue.getSize();if(t>this.MAX_REQUEST)return void showAlertDialog(replaceParams(jsMsg.WaitMoreRequestInqueue,[this.MAX_REQUEST]));if(Public.holdRequests){if(e.parameters.indexOf("temp_container_identity")<0){var s="&temp_container_identity="+TEMP_CONTAINER_IDENTITY;actionManager.reProcessData(function(e,t){e.appendParams(t)},s)}}else this._sendRequest()},_sendRequest:function(){if(!this.isSendingRequest){var e=this.requestQueue.get();Logger.isEnabled&&Logger.storeRequestAjax(e),this.lastRequest=e,void 0!=typeof e&&null!=e&&(e=this.requestQueue.retrive(),Logger.isEnabled&&Logger.updateRequestIndicator(this.requestQueue.getSize()),this.isSendingRequest=!0,appEvent.trigger("request.dispatchedFromQue"),e.sendRequest())}},onComplete:function(e){Logger.isEnabled&&Logger.storeRequest(e.responseText);var t=e.responseText;if(this._resetSendingBoolean(),!t)return void handleServerError("ERROR",jsMsg["Error.Add.Action.To.Queue1"],!0);var s=parseJSON(t);if(s){if("undefined"==typeof TEMP_CONTAINER_IDENTITY&&s.TEMP_CONTAINER_IDENTITY){this.isSendingRequest=!0,Public.holdRequests=!0;var n="&temp_container_identity="+s.TEMP_CONTAINER_IDENTITY;return actionManager.addRequestInFront(this.lastRequest),actionManager.reProcessData(function(e,t){e.appendParams(t)},n),TEMP_CONTAINER_IDENTITY=s.TEMP_CONTAINER_IDENTITY,COLLAB_ID=s.COLLAB_ID,responseManager.preInit({xid:s.ACTION_ID}),COLLAB_INFO={},void WMSResponseProcessor.handleServerUp()}if(s.a===ActionConstants.SHOW_ERROR_MESSAGE)return void ErrorMsg.show(s);responseManager.isExecutedResponse(s)?(logMsg&&(time[s.xaid]=(new Date).getTime(),test.log("response in same thread : xaid : "+s.xaid+"  :: qaid : "+s.qaid)),s.isActionOwner=!0,appEvent.trigger("qaid.returned",[s]),appEvent.trigger("xaid.returned",[s[ResponseKey.EXECUTED],LOGINNAME]),responseManager.updateResponse(s)):responseManager.isQueuedResponse(s)&&(appEvent.trigger("qaid.returned",[s]),responseManager.updateRequestedAction(s))}this.requestQueue.isEmpty()||this._sendRequest()},onError:function(e){var t=e.responseText;if(this._resetSendingBoolean(),t){try{var s=parseJSON(t)}catch(e){}if(s&&s.a===ActionConstants.SHOW_ERROR_MESSAGE)return void ErrorMsg.show(s);handleServerError("ERROR",jsMsg["Error.Internal.Server"],!0)}else handleServerError("ERROR",showErrorPanelMsg,!0)},isRequestInProgress:function(){return this.isSendingRequest},isRequestAwaited:function(){return!this.requestQueue.isEmpty()},_resetSendingBoolean:function(){if(this.isSendingRequest=!1,this.listenerHolder.onResponse){for(var e=this.listenerHolder.onResponse.length,t=0;e>t;t++){var s=this.listenerHolder.onResponse[t],n=s.fn,r=s.params,i=s.condn;(!i||i())&&(this.listenerHolder.onResponse.splice(t,1),n.apply(void 0,r),t--,e--)}this.listenerHolder.onResponse&&!this.listenerHolder.onResponse.length&&delete this.listenerHolder.onResponse}},addEventListener:function(e,t){switch(e){case"onResponse":this.listenerHolder[e]||(this.listenerHolder[e]=[]),this.listenerHolder[e].push(t)}},addRequestInFront:function(e){this.requestQueue.insertFront(e)},reProcessData:function(){var e=Array.prototype.slice.call(arguments,0);this.requestQueue.iterate.apply(this.requestQueue,e)},revokeHoldedRequest:function(){this._resetSendingBoolean(),this._sendRequest()}};var actionManager=new RequestManager(10),test=console,time=[],logMsg=!1;
function ItemQueue(e){this.items={},this.front=0/0,this.rear=e,this.size=0}function _ResponseManager(e,t,s,i,n,r){this.MAX_WAITING_TIME=e,this.MAX_INTERMIT_RESPONSE_TIME=t,this.MAX_SYNC_CHECK_TIME=s,this.MAX_TRIAL=i,this.MAX_SYNC_WAIT_TIMER=n,this.TRIAL_THRESHOLD=this.MAX_SYNC_CHECK_TIME/1e3,this.waitingTimer=null,this.unOrderedTimer=null,this.syncCheckTimer=null,this.retryCount=0,this.responseQueue=new ItemQueue,this.lastExecutedActionId=null,this.lastRequestedActionId=null,this.syncRequestInProgress=!1,this.isRefreshInProgress=!1,this.isRefreshInProgressCounter=0,this.maxClientRecievedId=null,this.isDisConnected=!1,this.errorCount=0,this.restrictGetStatusRequest=r}ItemQueue.prototype={addItem:function(e,t){if(e=1*e,!isNaN(e)){if(isNaN(this.front)&&(this.front=this.rear),e<this.rear){if(e<this.front)return!1;this.items[e].response=t}else{for(;this.rear<e;)this.addQueue(null);this.addQueue(t)}return!0}return!1},addQueue:function(e){var t={};t.actionId=this.rear,t.addedTime=new Date,t.response=e,this.setItem(this.rear,t),this.rear++,this.size++},setItem:function(e,t){("undefined"==typeof this.items[e]||null==this.items[e])&&(this.items[e]=t)},retrive:function(){var e=void 0;return this.isEmpty()||(e=this.items[this.front]),e},removeItem:function(e){"undefined"==typeof e&&(e=this.front),this.items[e]=void 0,e==this.front&&(this.front++,this.size--,this.front==this.rear&&(this.front=0/0))},getItem:function(e){return this.items[e]},isEmpty:function(){return isNaN(this.front)||0==this.size},getSize:function(){return this.size}};var ResponseKey={QUEUED:"qaid",EXECUTED:"xaid"};_ResponseManager.prototype={preInit:function(e){"undefined"!=typeof e[ResponseKey.EXECUTED]&&(this.setRequestedActionId(e[ResponseKey.EXECUTED],!0),this.setLastExecutedActionId(e[ResponseKey.EXECUTED],!0),this.setMaxClientRecievedId(e[ResponseKey.EXECUTED],!0))},init:function(e){var t=e[ResponseKey.EXECUTED];if("undefined"!=typeof t){var s=this.getLastExecutedActionId();null==s?(this.setRequestedActionId(t,!0),this.setLastExecutedActionId(t,!0),this.setMaxClientRecievedId(t,!0)):this.reInit(e),this.setSyncCheckTimer(this.MAX_SYNC_CHECK_TIME)}},reInit:function(e){var t=e[ResponseKey.EXECUTED];"undefined"!=typeof t&&this.isActionNotExecuted(t)&&this.refreshTile(t,"ON_RECONNECT")},updateResponse:function(e){this.isExecutedResponse(e)&&(Logger.isConsoleEnabled&&console,this.handleExecutedResponse(e))},handleExecutedResponse:function(e){if(Logger.isEnabled&&Logger.storeResponse(e),this.isResponseInOrder(e[ResponseKey.EXECUTED])){this.clearUnOrderedTimer(),logMsg&&test.log("update json call for xaid : "+e[ResponseKey.EXECUTED]),updateJson(e);var t=!1;e&&e[JSONConstants.DATAVALIDATION_ERROR]&&(t=Boolean(e[JSONConstants.DATAVALIDATION_ERROR][JSONConstants.DATAVALIDATION_ISSTOPEDIT])===!0),this.setLastExecutedActionId(e[ResponseKey.EXECUTED],void 0,e[JSONConstants.SAVE_MESSAGE_INFO],t),this.resumeResponse()}else this.isActionNotExecuted(e[ResponseKey.EXECUTED])&&(this.addResponse(e[ResponseKey.EXECUTED],e),this.setUnOrderedTimer(this.MAX_INTERMIT_RESPONSE_TIME,this.getLastExecutedActionId()+1));this.setMaxClientRecievedId(e[ResponseKey.EXECUTED])},isActionNotExecuted:function(e){return e>this.getLastExecutedActionId()},isRequestIntermitted:function(e){return e<this.getRequestedActionId()||this.isRequestPending()},isRequestPending:function(){return actionManager.isRequestAwaited()||actionManager.isRequestInProgress()},setMaxClientRecievedId:function(e,t){return t?void(this.maxClientRecievedId=e):void(this.maxClientRecievedId=e>this.maxClientRecievedId?e:this.maxClientRecievedId)},getMaxClientRecievedId:function(){return this.maxClientRecievedId},setLastExecutedActionId:function(e,t,s,i){Logger.isEnabled&&Logger.updateExecIdIndicator(e),this.lastExecutedActionId=e,this.getLastExecutedActionId()>=this.getRequestedActionId()&&(t||(updatedSaveTime="saved"),0===e||i===!0||jsPUBLIC_VIEW||showSaveMessage("disable",s))},getLastExecutedActionId:function(){return this.lastExecutedActionId},isExecutedResponse:function(e){return!isUndefined(e[ResponseKey.EXECUTED])},isResponseInOrder:function(e){return e-this.getLastExecutedActionId()===1},addResponse:function(e,t){this.responseQueue.isEmpty()&&(this.responseQueue=new ItemQueue(this.getLastExecutedActionId()+1)),this.responseQueue.addItem(e,t)},updateRequestedAction:function(e){this.setRequestedActionId(e.qaid),e.qaid>this.getLastExecutedActionId()&&this.invokeWaitingTimer(e.qaid)},setRequestedActionId:function(e,t){this.lastRequestedActionId=e,Logger.isEnabled&&!t&&Logger.updateResponseQueIndicator(e)},getRequestedActionId:function(){return this.lastRequestedActionId},isQueuedResponse:function(e){return!isUndefined(e[ResponseKey.QUEUED])},setUnOrderedTimer:function(e,t){this.isDisConnected||null==this.unOrderedTimer&&(this.unOrderedTimer=setTimeout(responseManager._unOrderedTimerCallBack,e,t))},setWaitingTimer:function(e,t){this.isDisConnected||null==this.waitingTimer&&(this.waitingTimer=setTimeout(responseManager._waitTimerCallBack,e,t))},setSyncCheckTimer:function(e){!this.isDisConnected&&this.restrictGetStatusRequest&&null==this.syncCheckTimer&&(this.syncCheckTimer=setTimeout(responseManager._syncCheckTimerCallBack,e))},setSyncRetardTimer:function(e,t){this.isDisConnected||setTimeout(responseManager._syncRetardTimeTimerCallBack,e,t)},clearUnOrderedTimer:function(){null!=this.unOrderedTimer&&(clearTimeout(this.unOrderedTimer),this.unOrderedTimer=null)},clearWaitingTimer:function(){null!=this.waitingTimer&&(clearTimeout(this.waitingTimer),this.waitingTimer=null)},clearSyncCheckTimer:function(){null!=this.syncCheckTimer&&(clearTimeout(this.syncCheckTimer),this.syncCheckTimer=null)},_unOrderedTimerCallBack:function(e){responseManager.clearUnOrderedTimer(),e>responseManager.getLastExecutedActionId()?responseManager.refreshTile(e,"UN_ORDERED_TIMER"):responseManager.getMaxClientRecievedId()>responseManager.getLastExecutedActionId()&&responseManager.resumeResponse()},_waitTimerCallBack:function(e){if(responseManager.clearWaitingTimer(),responseManager.getLastExecutedActionId()<e){if(responseManager.retryCount==responseManager.MAX_TRIAL-1)responseManager.getStatus(e,"WAITING_TIMER");else if(responseManager.retryCount<responseManager.MAX_TRIAL-1)responseManager.setWaitingTimer(responseManager.MAX_WAITING_TIME,e);else{var t=responseManager.retryCount-responseManager.MAX_TRIAL;responseManager.TRIAL_THRESHOLD>responseManager.retryCount&&t&&t-1&&(t&~t+1)==t?responseManager.getStatus(e,"WAITING_TIMER"):responseManager.setWaitingTimer(responseManager.MAX_WAITING_TIME,e)}responseManager.incrementRetryCount()}else responseManager.resetRetryCount()},_syncCheckTimerCallBack:function(){responseManager.clearSyncCheckTimer(),responseManager.getStatus(void 0,"SYNC_CHECK_TIMER")},_syncRetardTimeTimerCallBack:function(e){e>responseManager.getLastExecutedActionId()&&responseManager.refreshTile(e,"SYNC_CHECK_TIMER")},destroyWaitingTimer:function(){this.resetRetryCount(),this.clearWaitingTimer()},invokeWaitingTimer:function(e){this.destroyWaitingTimer(),this.setWaitingTimer(this.MAX_WAITING_TIME,e)},reinvokeWaitingTimer:function(){this.getLastExecutedActionId()<this.getRequestedActionId()&&(this.resetRetryCount(),this.setWaitingTimer(this.MAX_WAITING_TIME,this.getRequestedActionId()))},reInvokeSyncCheckTimer:function(){this.clearSyncCheckTimer(),this.setSyncCheckTimer(this.MAX_SYNC_CHECK_TIME)},incrementRetryCount:function(){this.retryCount++},resetRetryCount:function(){this.retryCount=0},isRetryAllowed:function(){return this.retryCount<this.MAX_TRIAL},getStatus:function(e,t){if(!this.syncRequestInProgress){if(stopGetStatus)return this.clearSyncCheckTimer(),void this.setSyncCheckTimer(this.MAX_SYNC_CHECK_TIME);var s=new RequestParameters(ActionConstants.SYNC_CHECK);s.setParameters(DOCUMENT_ID,void 0,BUILD_VERSION);var i=new AjaxRequest;i.init("POST",s.getURL(),!0,s.getParametersAsString()),i.addEventListener("onComplete",this._getStatusCallBack.bind(this),e,t),i.addEventListener("onError",this._getStatusCallBackFailure.bind(this),e,t),i.addEventListener("onDisconnect",this._getStatusCallBackFailure.bind(this),e,t),this.syncRequestInProgress=!0,i.sendRequest()}},_getStatusCallBack:function(e,t,s){responseManager.errorCount=0,this.syncRequestInProgress=!1;var i=e.responseText;if(i){var n=parseJSON(i);if("undefined"==typeof isCollabJoined||isCollabJoined||("undefined"!=typeof last_Xaid?responseManager.getLastExecutedActionId()!==last_Xaid&&(responseManager.setLastExecutedActionId(last_Xaid),reloadPage()):reloadPage()),last_Xaid=n.xaid,n.zsannounce&&""!=n.zsannounce.msg&&!isZSAdminAnnouncementDisplayed&&(jsOPEN_DOC_VIEW||jsSHARE_VIEW||cdview)){var r="<div ctype='zannouncementbar' id='zannouncementbarnew' data=\"{'type':'"+n.zsannounce.l+"', 'message':'"+n.zsannounce.msg+"',autoOpen:true}\" ></div>";$("#aboveTopBand").remove(),AnnouncementBanner.showBanner("zannouncementbarnew",r,void 0,!0,n.zsannounce.isRefreshNeeded,n.zsannounce.msg)}if("WAITING_TIMER"===s){if(this.isActionNotExecuted(t)){var a=n.xaid;t>a?this.setWaitingTimer(this.MAX_WAITING_TIME,t):this.refreshTile(a,s)}}else if("SYNC_CHECK_TIMER"===s){var a=n.xaid,o=this.getMaxClientRecievedId();a>o&&null==this.waitingTimer&&this.setSyncRetardTimer(this.MAX_SYNC_WAIT_TIMER,a)}}null==this.syncCheckTimer&&this.setSyncCheckTimer(this.MAX_SYNC_CHECK_TIME)},_getStatusCallBackFailure:function(e,t,s){e.responseText&&"Error.Remote.Document.Not.Available"==parseJSON(e.responseText).mk&&(ErrorMsg.show(parseJSON(e.responseText)),BLOCK_REMOVED_FILE_REQUEST=!0),++responseManager.errorCount>9&&handleServerError("ERROR","serverErrorWithReopen",!0),this.syncRequestInProgress=!1,"WAITING_TIMER"===s&&this.isActionNotExecuted(t)&&this.setWaitingTimer(this.MAX_WAITING_TIME,t),null==this.syncCheckTimer&&this.setSyncCheckTimer(this.MAX_SYNC_CHECK_TIME)},refreshTile:function(e,t){if(this.isRequestIntermitted(e))return void(null==this.waitingTimer&&this.reinvokeWaitingTimer());if(this.isActionNotExecuted(e)){if(this.isRefreshInProgress&&this.isRefreshInProgressCounter<=1)return void this.isRefreshInProgressCounter++;this.isRefreshInProgressCounter=0,this.isRefreshInProgress=!0,appEvent.trigger("refresh.tile",[e]),Logger.isEnabled&&(Logger.updateRefreshTileIndicator("Refreshing Tile by .",t,e),Logger.storeRefreshTileInfo(e,t));var s={};s.onAfterComplete={},s.onFailure={},s.onWait={},s.isExecuteActionIdNeeded=!0,s.onAfterComplete.method=responseManager._refreshTileCallBack,s.onAfterComplete.param=WorkSheets.getAssociatedActiveSheetName(),s.onFailure.method=responseManager._refreshTileFailure,s.onWait.method=responseManager._refreshTileWait,s.isXaidToBeAppended=!0,s.onWait.params=[e,t],s.tileUpdateBreaker=function(e){var t;return responseManager.isRequestIntermitted(e)?(t=!0,null==responseManager.waitingTimer&&responseManager.reinvokeWaitingTimer()):e<=responseManager.getLastExecutedActionId()&&(t=!0),Logger.isConsoleEnabled&&console,!!t},reloadPage(void 0,!0,s),"WAITING_TIMER"===t&&reregister()}},_refreshTileCallBack:function(e,t,s){if(Logger.isEnabled&&Logger.updateRefreshTileIndicator(""),t){documentBakeStatus.setRenderBake(!0);var i=t;WorkSheets.updateSheetNamesList(i),WorkSheets.dom.fill(i[0]);var n=i[1].indexOf(s);if(-1!=n){CURRSHEETNAME=i[0][n];var r=getObj("sheetdiv-"+s).getElementsByTagName("DIV")[0];r.className="tabItem selected"}documentBakeStatus.setRenderBake(!0)}responseManager.setLastExecutedActionId(e),responseManager.setMaxClientRecievedId(e),responseManager.clearUnOrderedTimer(),responseManager._invokeRefreshTileFollower(),appEvent.trigger("Discussion.sheetReady")},_refreshTileWait:function(e,t){responseManager.isRefreshInProgress=!1,responseManager.refreshTile(e,t)},_refreshTileFailure:function(){Logger.isEnabled&&Logger.updateRefreshTileIndicator("Refreshing Failed ..."),Logger.isEnabled&&Logger.updateRefreshTileIndicator(""),responseManager._invokeRefreshTileFollower()},_invokeRefreshTileFollower:function(){this.isRefreshInProgress=!1,this.resumeResponse(),null==this.waitingTimer&&this.reinvokeWaitingTimer(),null==this.syncCheckTimer&&this.reInvokeSyncCheckTimer()},resumeResponse:function(){for(var e=this.responseQueue.retrive();void 0!=e;)if(this.isItemExpired(e))this.clearItem(e),e=this.responseQueue.retrive();else{if(!this.isResponseInOrder(e.actionId)||this.isVacantItem(e)){var t=new Date-e.addedTime;if(t>=this.MAX_INTERMIT_RESPONSE_TIME)this.refreshTile(e.actionId,"DELAY_TIMER");else{var s=this.MAX_INTERMIT_RESPONSE_TIME-t;this.setUnOrderedTimer(s,e.actionId)}break}this.clearUnOrderedTimer(),updateJson(e.response),this.setLastExecutedActionId(e.actionId),this.responseQueue.removeItem(),e=this.responseQueue.retrive()}},isItemExpired:function(e){return e.actionId<=this.lastExecutedActionId},clearItem:function(){this.responseQueue.removeItem()},isVacantItem:function(e){return null==e.response}};var allowSyncTimerGetStatus=!0;(jsPUBLIC_VIEW||jsPUBLISH_RANGE_VIEW)&&(allowSyncTimerGetStatus=!1);var responseManager=new _ResponseManager(1e3,1e3,2500,9,1e3,allowSyncTimerGetStatus);responseManager.setSyncCheckTimer(1e3);
var onVisibilityChange=function(){document.hidden?(sendGetStatusRequest=!1,stopGetStatus=!0):0==sendGetStatusRequest&&(sendGetStatusRequest=!0,stopGetStatus=!1,jsPUBLIC_VIEW||jsPUBLISH_RANGE_VIEW||(responseManager.clearSyncCheckTimer(),responseManager.getStatus(void 0,"SYNC_CHECK_TIMER")))};"hidden"in document?document.addEventListener("visibilitychange",onVisibilityChange):"mozHidden"in document?document.addEventListener("mozvisibilitychange",onVisibilityChange):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",onVisibilityChange):"msHidden"in document&&document.addEventListener("msvisibilitychange",onVisibilityChange);
pivot.Model=Backbone.Model.extend({defaults:{ssr:void 0,ssc:void 0,ser:void 0,sec:void 0,sr:void 0,sc:void 0,er:void 0,ec:void 0,sasn:void 0,asn:void 0,fn:[],pf:void 0,rf:void 0,cf:void 0,df:void 0,af:void 0,uf:void 0,id:void 0,ptid:"3tc1",sto:!0,rgto:!0,cgto:!0},initialize:function(){},sync:function(){return null}});
var PivotList=Backbone.Collection.extend({model:pivot.Model,isPivotRange:function(t,n,s,e,o,S,O){if(this.isEmpty())return!1;if(o||(o=WorkSheets.getAssociatedActiveSheetName()),void 0===t){var i=getCellRange();t=i.startRow,n=i.startCol,s=t,e=n}var C,N=this.any(function(i){C=i.get(JSONConstants.ID);var N=i.get(JSONConstants.START_ROW),a=i.get(JSONConstants.START_COLUMN),E=i.get(JSONConstants.END_ROW),_=i.get(JSONConstants.END_COLUMN),r=(O!==C||void 0===O)&&o===i.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&(t>=N&&E>=t||s>=N&&E>=s||N>t&&s>E)&&(n>=a&&_>=n||e>=a&&_>=e||a>n&&e>_);return((S===ActionConstants.INSERT_ROW||S===ActionConstants.INSERT_CUT_ROW||S===ActionConstants.INSERT_COPY_ROW)&&N>=t||(S===ActionConstants.INSERT_COL||S===ActionConstants.INSERT_CUT_COLUMN||S===ActionConstants.INSERT_COPY_COLUMN)&&a>=n)&&(r=!1),r});return N&&(pivotId=C),N},isPivotCell:function(t,n,s,e){return this.any(function(o){return(e!==o.get(JSONConstants.ID)||void 0===e)&&t==o.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&n>=o.get(JSONConstants.START_ROW)&&s>=o.get(JSONConstants.START_COLUMN)&&n<=o.get(JSONConstants.END_ROW)&&s<=o.get(JSONConstants.END_COLUMN)})},isPivotSourceCell:function(t,n,s){return this.any(function(e){return t===e.get(JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME)&&n>=e.get(JSONConstants.SOURCE_START_ROW)&&s>=e.get(JSONConstants.SOURCE_START_COLUMN)&&n<=e.get(JSONConstants.SOURCE_END_ROW)&&s<=e.get(JSONConstants.SOURCE_END_COLUMN)})},isMaxField:function(){return this.any(function(t){return PivotUtil.isMaxNoOfFieldsExceeded(t.toJSON())})},createFilterIcons:function(){if(!this.isEmpty()){var t=WorkSheets.getAssociatedActiveSheetName();this.forEach(function(n){var s=n.get(JSONConstants.ID);t===n.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&"temp"!==s&&PivotUtil.createFilterIcon(n.get(JSONConstants.FILTER_CELLS),s,PivotUtil.getValueObj(n.get(JSONConstants.ROW_FIELDS),n.get(JSONConstants.COLUMN_FIELDS)))})}},rowShiftOperation:function(t,n,s){if(!this.isEmpty()){var e=WorkSheets.getAssociatedActiveSheetName();this.forEach(function(o){if(s===o.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&t<=o.get(JSONConstants.START_ROW)){for(var S=o.get(JSONConstants.FILTER_CELLS),O=0;O<S.length;O++){var i=S[O];s===e&&PivotUtil.changeFilterIconPos(i,i.row+n,i.col),i.row=i.row+n}o.set({sr:o.get(JSONConstants.START_ROW)+n,er:o.get(JSONConstants.END_ROW)+n})}s===o.get(JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME)&&t<=o.get(JSONConstants.SOURCE_END_ROW)&&(o.set({ser:o.get(JSONConstants.SOURCE_END_ROW)+n}),t<=o.get(JSONConstants.SOURCE_START_ROW)&&o.set({ssr:o.get(JSONConstants.SOURCE_START_ROW)+n}))})}},colShiftOperation:function(t,n,s){if(!this.isEmpty()){var e=WorkSheets.getAssociatedActiveSheetName();this.forEach(function(o){if(s===o.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&t<=o.get(JSONConstants.START_COLUMN)){for(var S=o.get(JSONConstants.FILTER_CELLS),O=0;O<S.length;O++){var i=S[O];s===e&&PivotUtil.changeFilterIconPos(i,i.row,i.col+n),i.col=i.col+n}o.set({sc:o.get(JSONConstants.START_COLUMN)+n,ec:o.get(JSONConstants.END_COLUMN)+n})}s===o.get(JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME)&&t<=o.get(JSONConstants.SOURCE_END_COLUMN)&&(o.set({sec:o.get(JSONConstants.SOURCE_END_COLUMN)+n}),t<=o.get(JSONConstants.SOURCE_START_COLUMN)&&o.set({ssc:o.get(JSONConstants.SOURCE_START_COLUMN)+n}))})}},deleteSheetOperation:function(t){if(!this.isEmpty()){var n=this.filter(function(n){return t===n.get(JSONConstants.ASSOCIATED_SHEET_NAME)||t===n.get(JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME)});this.remove(n)}},setPivotId:function(t,n,s){if(!this.isEmpty()){var e=s?s:WorkSheets.getAssociatedActiveSheetName();this.forEach(function(s){return e===s.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&t>=s.get(JSONConstants.START_ROW)&&n>=s.get(JSONConstants.START_COLUMN)&&t<=s.get(JSONConstants.END_ROW)&&n<=s.get(JSONConstants.END_COLUMN)?void(pivotId=s.get(JSONConstants.ID)):void 0})}}});pivot.Collection=new PivotList,pivot.Collection.on("remove",function(t){PivotUtil.removeFilterIcon(t.get(JSONConstants.ID))});
function showRecommendedPivotTables(){docPanel.show("RecommendedPivotTables","no"),PivotUtil.setRecommendPanelHeight(),$(".subHdrs").css("background-color","#eaeaea")}function showPivotBuilder(){docPanel.show("pivotBuilder","no"),$(".subHdrs").css("background-color","#f5f5f5")}function closepvtBuilderDataMenu(t){if($(".pvtDataMenu").is(":visible")){var t=t||window.event,e=t.target;if($(".pvtDataMenu").is(":visible")){var o=$(e).closest(".pvtDataMenuBox"),n=$(e).closest(".ui-zcombo-dropdown"),i=$(e).hasClass("PvtDataClsBtn");o.length||n.length||($(".pvtDataMenu").hide(),appEvent.off("body.mousedown",closepvtBuilderDataMenu)),i&&($(".pvtDataMenu").hide(),appEvent.off("body.mousedown",closepvtBuilderDataMenu))}}}function showExploreRecommendedDetails(){$(".rPdC#rPlC").css("zIndex",0);var t=document.getElementById("rPlCMore"),e=document.getElementById("recommendedTableList"),o=document.getElementsByClassName("pHdr")[0];o&&(o.innerHTML="<span></span> <div>"+jsMsg["Menuitem.InsertTab.Pivot"]+"</div>"),$(o).find("span").click(function(){}),t.insertChildAtIndex(e,1),$("#recommendedTableList").removeClass("singleTable")}function showExploreRecommendedList(){$(".rPdC#rPlC").css("zIndex",1);var t=document.getElementById("recommendedReportList"),e=document.getElementById("recommendedTableList"),o=document.getElementsByClassName("pHdr")[0];o&&(o.innerHTML="<div>"+jsMsg["MenuItem.DataTab.Explore"]+"</div>"),t.insertChildAtIndex(e,1),$("#recommendedTableList").addClass("singleTable")}var PivotUtil={openRecommended:function(t,e,o){"true"===t||t===!0?(docPanel.show("Explore","no"),o=void 0===o?{}:o,o.isFormReport=!1):"true"===e?(o=void 0===o?{}:o,docPanel.show("RecommendedPivotTables"),o.isFormReport=!0,o.sasn=WorkSheets.getAssociatedActiveSheetName()):(docPanel.show("RecommendedPivotTables"),o=void 0===o?{}:o,o.isFormReport=!1),setTimeout(function(){new pivot.Recommend({model:JSON.parse(JSON.stringify(o))})},100)},closeRecommended:function(t){docPanel.show("RecommendedPivotTables"===t?"RecommendedPivotTables":"Explore"),$("#recommendedReportList").empty()},readrecommendedPivotTable:function(t){var e,o=new RequestParameters(ActionConstants.READ_RECOMMENDED_PIVOT),n=t[JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME],i=t[JSONConstants.SOURCE_START_ROW],s=t[JSONConstants.SOURCE_END_ROW],a=t[JSONConstants.SOURCE_START_COLUMN],r=t[JSONConstants.SOURCE_END_COLUMN],l=t[JSONConstants.ASSOCIATED_SHEET_NAME];o.setParameters(t[JSONConstants.FORM_RID],n,i,a,s,r,l,i,a);var c=new AjaxRequest;return c.init("POST",o.getURL(),!1,o.getParametersAsString()),c.addEventListener("onComplete",function(t){e=JSON.parse(unescape(t.responseText))}),c.sendRequest(),e},recommendPivotChart:function(t,e,o,n,i,s){return new Promise(function(){var a,r,l=t,r=n+e;if(s)a=s;else{var a=document.createElement("div");$(a).attr("id",r)}i?(a.style.width="636px",a.style.height="300px"):a.className="recPrvCDiv",$(a).appendTo(o),s||(l.co=chart.handleLineMarker(l,!1),l.co.chart.renderTo=r,l.co.legend.enabled=!1,l.co=chartGlance.applyregressionColorIndex(l.co),l.co=chartGlance.applyDataLabels(l.co,l.lf,l.currency,l.xAxisSymbol),l.co=chartGlance.advanceDataLabelSetting(l.co),l.co=chartGlance.applySharedLegendInPie(l.co),l.co=chartGlance.advanceChartSettingsInLegend(l.co),l.co=chartGlance.applyTooltip(l.co),l.co=chartGlance.handleChartStyle(l.co),l.co=chartGlance.applyGrouping(l.co,l.grouping,!1,!0),l.co=chartGlance.defaultGroupingSlat(l.co,l.grouping,!1),l.co=chartGlance.applyChartSpacing(l.co,10,10,10,10),chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),r,l))})},openBuilder:function(t){if(PivotUtil.isPivotBuilderOpen())return sheetdialog.close(),void $($("#pivotBuilderOptions").children()).removeClass("uiGrey");sheetdialog.close(),$($("#pivotBuilderOptions").children()).addClass("uiGrey");var e=pivot.Collection.get(pivotId);if(t||PivotUtil.getPivotFields(e)){var o="right",n=e.get(JSONConstants.START_COLUMN),i=$(getCell(getAvailableStartRow(),n));if("temp"===pivotId&&(pivot.alertBeforeClose=!0),i){var s=i.offset();s&&s.left>screen.width/2&&(o="left")}var a=Math.round(screen.height/10);o+=" top";var r={width:418,position:{my:o,at:o,of:window,using:function(t){var e=$(this).css("height");e=1*e.replace("px",""),e+a+25>window.innerHeight&&(a=0),$(this).css("left",t.left),$(this).css("top",t.top+a)}},title:jsMsg["Pivot.UI.Builder.Title"],resizable:!1,autoOpen:!1,hidetoolbar:!1,beforeClose:function(){if("temp"===pivotId&&pivot.alertBeforeClose){var t={buttons:[{text:jsMsg["Dialog.confirm.Yes"],class:"ui-zbutton-primary",click:function(){pivotId=null,sheetdialog.closeNotify(),sheetdialog.close()}},{text:jsMsg["Dialog.confirm.No"],click:function(){sheetdialog.closeNotify()}}]};return sheetdialog.showConfirmDialog(jsMsg["Error.Pivot.Not.Created"],t),!1}$($("#pivotBuilderOptions").children()).removeClass("uiGrey"),PivotUtil.closePivotBuilder()}};sheetdialog.open("pivotdialog",r,{init:function(t){t.css("overflow","visible"),$(t.parent()).css("overflow","visible");new pivot.Dialog({model:JSON.parse(JSON.stringify(e.toJSON()))});$("#hometw, #formattw, #inserttw, #formulastw, #datatw, #formtw, #viewtw, #reviewtw, #macrostw, #sharetw").disable(),$("#pivot #nSheetErr").bind("click",function(){$("#targetLoc").slideUp(200),$("#confirmPivot").removeClass("ui-button-disabled ui-state-disabled")}),$("#pivot #eSheetErr").bind("click",function(){$("#targetLoc").slideDown(200),$("#targetCell").focus(),PivotUtil.enableDiasablePromptDlgBtn()}),$("#pivot #targetCell").bind("select",function(){PivotUtil.enableDiasablePromptDlgBtn()})}})}},getPivotFields:function(t){var e=t.get(JSONConstants.ALL_FIELDS),o=[],n=!1,i=!1,s=t.get(JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME),a=t.get(JSONConstants.SOURCE_START_ROW),r=t.get(JSONConstants.SOURCE_END_ROW),l=t.get(JSONConstants.SOURCE_START_COLUMN),c=t.get(JSONConstants.SOURCE_END_COLUMN),d=new RequestParameters(ActionConstants.READ_PIVOT_FIELDS);d.setParameters(s,a,l,r,c);var v=new AjaxRequest;return v.init("POST",d.getURL(),!1,d.getParametersAsString()),v.addEventListener("onComplete",function(s){var a=JSON.parse(s.responseText);o=a.data;for(var r=[],l=0;l<o.length;l++){var c=o[l],d=c.content;if(!d){i=!0;break}if(r.contains(d)){n=!0;break}if(r.push(d),e&&e.length){for(var v=0;v<e.length;v++){var S=!0,O=e[l];if(O.content===d&&O.colIndex===c.colIndex){S=!1,void 0!==O[JSONConstants.GROUP]&&(c[JSONConstants.GROUP]=O[JSONConstants.GROUP]);break}}if(S)for(var p=O.colIndex,g=[JSONConstants.PAGE_FIELDS,JSONConstants.ROW_FIELDS,JSONConstants.COLUMN_FIELDS,JSONConstants.DATA_FIELDS],u=0;u<g.length;u++){var C=t.get(g[u]);if(C){var P=C.indexOf(p);-1!==P&&(t.set(JSONConstants.IS_SOURCE_CHANGED,!0),C.splice(P,1))}}}}}),v.sendRequest(),n?(showAlertDialog(jsMsg["Error.Pivot.Invalid.Source"]),!1):i?(showAlertDialog(jsMsg["Error.Pivot.Invalid.Source.Empty"]),!1):(t.set(JSONConstants.ALL_FIELDS,o),!0)},closePivotBuilder:function(){PivotUtil.enableToolbar(),PivotUtil.cancelPivot(),pivotDataMenuCount=0},enableToolbar:function(){$("#hometw, #formattw, #inserttw, #formulastw, #datatw, #formtw, #viewtw, #reviewtw, #macrostw, #sharetw").enable(),setTimeout(function(){menutabs.toggleToolbar()},50)},cancelPivot:function(){RangeSelector.off(),$("#main").droppable().droppable("destroy"),PivotUtil.hideAndDisplayPivotTab(!1),$(".catList").children().remove(),$("#allFields").children().remove(),pivotDataMenuCount=0},initNewPivot:function(){sheetdialog.close(),pivotId="temp";var t={width:358,title:jsMsg["Data.Pivot.CreatePivotTable"],resizable:!1,autoOpen:!1};sheetdialog.open("pivotpromptdialog",t,{init:function(){$(".ui-icon-closethick").bind("click",function(){PivotUtil.cancelPivot()});new pivot.Prompt({model:void 0})}})},isLocked:function(t){t||(t=pivotId);var e=pivot.Collection.get(t);return ProtectedRanges.isRangeLocked(e.get(JSONConstants.START_ROW),e.get(JSONConstants.START_COLUMN),e.get(JSONConstants.END_ROW),e.get(JSONConstants.END_COLUMN))?!0:!1},move:function(){if(!PivotUtil.isLocked(pivotId)){var t={width:358,title:jsMsg["Pivot.UI.Move.Title"],resizable:!1,autoOpen:!1,close:function(){PivotUtil.cancelPivot(),sheetdialog.close()}};sheetdialog.open("pivotpromptdialog",t,{init:function(){new pivot.Prompt({model:pivot.Collection.get(pivotId).toJSON()})}})}},getPivotTargetLoc:function(){var t={width:358,title:jsMsg["Pivot.UI.Select.Location.Title"],resizable:!1,autoOpen:!1,close:function(){PivotUtil.cancelPivot(),sheetdialog.close()}};sheetdialog.open("pivotpromptdialog",t,{init:function(){new pivot.Prompt({model:void 0})}})},changeSource:function(){if(!PivotUtil.isLocked(pivotId)){var t={width:358,title:jsMsg["Pivot.UI.Source.Title"],resizable:!1,autoOpen:!1};sheetdialog.open("pivotpromptdialog",t,{init:function(){$(".ui-icon-closethick").bind("click",function(){PivotUtil.cancelChangeSource(pivotId)});new pivot.Prompt({model:pivot.Collection.get(pivotId).toJSON()})}})}},cancelChangeSource:function(t){PivotUtil.cancelPivot(),sheetdialog.close(),PivotUtil.goToDestination(t)},goToDestination:function(t){var e=pivot.Collection.get(t),o=e.get(JSONConstants.ASSOCIATED_SHEET_NAME);WorkSheets.getAssociatedActiveSheetName()===o?focusCell(currRow,currCol):showsheet("sheetdiv-"+o,"open",!1,!1)},getTargetLocation:function(t,e){var o=t.indexOf("."),n=o>-1?t.substring(o+1):t;return CellUtils.getCellPosByLabel(e?"A1":n)},isValidTargetCell:function(t,e,o){return pivot.Collection.isPivotCell(t,e.row,e.col,o)?(showAlertDialog(jsMsg["Error.Pivot.Table.Overlaps"]),!1):pivot.Collection.isPivotSourceCell(t,e.row,e.col)?(showAlertDialog(jsMsg["Error.Pivot.Table.Overlaps.With.Source"]),!1):!0},isPivotCell:function(t,e){return pivot.Collection.isPivotCell(WorkSheets.getAssociatedActiveSheetName(),t,e)?(showAlertDialog(jsMsg["Error.Pivot.Table.Part.Change"]),!0):!1},deletePivot:function(t){if(!PivotUtil.isLocked(t)){var e={buttons:[{text:jsMsg["Dialog.confirm.Yes"],class:"ui-zbutton-primary",click:function(){PivotUtil.deletePivotWithoutAlert(t,!0),sheetdialog.close(),sheetdialog.closeNotify()}},{text:jsMsg["Dialog.confirm.No"],click:function(){sheetdialog.closeNotify()}}]};sheetdialog.showConfirmDialog(jsMsg["Pivot.UI.Delete.Confirm"],e)}},deletePivotWithoutAlert:function(t,e){if(t||(t=pivotId),e||!PivotUtil.isLocked(t)){PivotUtil.deletePivotInClient(t);var o=new RequestParameters(ActionConstants.DELETE_PIVOT);o.setParameters(t);var n=new AjaxRequest;n.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(n)}},deletePivotInClient:function(t){var e=pivot.Collection.get(t);e&&(e.get(JSONConstants.ASSOCIATED_SHEET_NAME)===WorkSheets.getAssociatedActiveSheetName()&&(clearAll(e.get(JSONConstants.START_ROW),e.get(JSONConstants.START_COLUMN),e.get(JSONConstants.END_ROW),e.get(JSONConstants.END_COLUMN),!0,!0),init_format(currCell)),pivot.Collection.remove(t))},clearPivotDestination:function(t,e){if(t.get(JSONConstants.ASSOCIATED_SHEET_NAME)===WorkSheets.getAssociatedActiveSheetName()){var o=t.get(JSONConstants.START_ROW),n=t.get(JSONConstants.START_COLUMN),i=t.get(JSONConstants.END_ROW),s=t.get(JSONConstants.END_COLUMN);Merge.remove(o,n,i,s),e||clearAll(o,n,i,s,!0,!0)}},removeFilterIcon:function(t){function e(e){for(var o=e.children,n=0;n<o.length;){var i=o[n];i.getAttribute(JSONConstants.ID)===t?i.parentNode.removeChild(i):n++}}e(filterIconsPane),ISFREEZED&&(e(filterIconsPane1),e(filterIconsPane2),e(filterIconsPane3))},changeFilterIconPos:function(t,e,o){function n(n){for(var i=n.querySelectorAll("[pivot]"),s=0;s<i.length;s++){var a=i[s];1*a.getAttribute("col")===t.col&&1*a.getAttribute("row")===t.row&&(a.style.top=getRowTop(e)+"px",a.style.left=getColLeft(o)+"px",a.setAttribute("col",o),a.setAttribute("row",e))}}n(filterIconsPane),ISFREEZED&&(n(filterIconsPane1),n(filterIconsPane2),n(filterIconsPane3))},submitPivotFromRecommend:function(t,e,o,n,i){t||(t=WorkSheets.getAssociatedActiveSheetName());var s="temp",a=i[JSONConstants.SOURCE_START_ROW],r=i[JSONConstants.SOURCE_END_ROW],l=i[JSONConstants.SOURCE_START_COLUMN],c=i[JSONConstants.SOURCE_END_COLUMN],d=JSON.stringify([i[JSONConstants.PAGE_FIELDS],i[JSONConstants.ROW_FIELDS],i[JSONConstants.COLUMN_FIELDS],i[JSONConstants.DATA_FIELDS]]),v=i[JSONConstants.FUNCTION],S=JSON.stringify(PivotUtil.getPrimitiveFnFromStr(v)),O=JSON.stringify(i[JSONConstants.GROUP]),p=JSON.stringify(i[JSONConstants.PIVOT_SORT_DETAILS]),g=JSON.stringify(i[JSONConstants.PIVOT_FILTER_DETAILS]),u=new RequestParameters(ActionConstants.CREATE_PIVOT);u.setParameters(t,a,l,r,c,e,o,n,d,S,s,O,!1,!1,!0,p,g);var C=new AjaxRequest;C.init("POST",u.getURL(),!0,u.getParametersAsString()),actionManager.addRequest(C)},getPrimitiveFnFromStr:function(t){for(var e=[],o=0;o<t.length;o++){var n,i,s=t[o];for(n in s)i=s[n];var a,r,s={};"sum"===n?a=1:"count"===n?a=2:"max"===n?a=3:"min"===n?a=4:"product"===n?a=5:"average"===n?a=6:"stdev"===n?a=7:"stdevp"===n?a=8:"var"===n?a=9:"varp"===n?a=10:"median"===n?a=11:"countnums"===n&&(a=12),"none"===i?r=0:"row-percentage"===i?r=5:"column-percentage"===i?r=6:"total-percentage"===i&&(r=7),s[a]=r,e.push(s)}return e},refresh:function(){if(!PivotUtil.isLocked(pivotId)&&!PivotUtil.isMaxNoOfFieldsExceeded(pivot.Collection.get(pivotId).toJSON())){var t=new RequestParameters(ActionConstants.REFRESH_PIVOT);t.setParameters(pivotId,!1),PivotUtil.setLastAction(t);var e=new AjaxRequest;e.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(e),showProgressMessage(jsMsg["Pivot.UI.Refresh"])}},refreshAll:function(){if(!pivot.Collection.isMaxField()){var t=new RequestParameters(ActionConstants.REFRESH_ALL_PIVOT);t.setParameters();var e=new AjaxRequest;e.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(e),showProgressMessage(jsMsg["Pivot.UI.Refresh"])}},filter:function(t,e,o,n){if(!PivotUtil.isLocked(pivotId)&&!PivotUtil.isMaxNoOfFieldsExceeded(pivot.Collection.get(pivotId).toJSON())){if(!n)var i=JSON.stringify(o),s=encodeURIComponent(i);var a=new RequestParameters(ActionConstants.APPLYFILTER_PIVOT);a.setParameters(pivotId,t,e,s,n,!1),PivotUtil.setLastAction(a);var r=new AjaxRequest;r.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(r)}},sort:function(t,e,o,n){if(!PivotUtil.isLocked(pivotId)&&!PivotUtil.isMaxNoOfFieldsExceeded(pivot.Collection.get(pivotId).toJSON())){var i=new RequestParameters(ActionConstants.SORT_PIVOT);i.setParameters(pivotId,t,e,o,!1,n),PivotUtil.setLastAction(i);var s=new AjaxRequest;s.init("POST",i.getURL(),!0,i.getParametersAsString()),actionManager.addRequest(s)}},changeDisplayInfo:function(t,e,o,n,i){if(!PivotUtil.isLocked(pivotId)&&!PivotUtil.isMaxNoOfFieldsExceeded(pivot.Collection.get(pivotId).toJSON())){var s=new RequestParameters(ActionConstants.CHANGE_DISPLAYINFO_PIVOT);s.setParameters(pivotId,t,e,o,n,!1,i),PivotUtil.setLastAction(s);var a=new AjaxRequest;a.init("POST",s.getURL(),!0,s.getParametersAsString()),actionManager.addRequest(a)}},getsortByValues:function(t,e){var o=[],n=pivot.Collection.get(pivotId);if(n){for(var i=n.get("row"==t?JSONConstants.ROW_FIELDS:JSONConstants.COLUMN_FIELDS),s=n.get(JSONConstants.FUNCTION),a=n.get(JSONConstants.ALL_FIELDS),r=n.get(JSONConstants.DATA_FIELDS),l=[],c=i[e],d=0;d<a.length;d++)c==a[d].colIndex&&o.push(a[d].content);for(var v=0;v<r.length;v++)for(var S=r[v],d=0;d<a.length;d++)S==a[d].colIndex&&l.push(a[d].content);for(var d=0;d<s.length;d++){var O,p,g=s[d];for(O in g)p=g[O];var u=O.charAt(0).toUpperCase()+O.slice(1),C=replaceParams(jsMsg["Pivot.UI.Datafield.Content."+u],new Array(escapeSpecialCharacters(l[d])));o.push(C)}}return o},changeOptions:function(t){var e=$("#pivotOptionsMenu"),o=$($("#"+t).children().children()[0]).hasClass("ui-zmenu-no-icon");o?e.zmenu("changeIcon",t,"ui-individual-icon ui-icon-ztick"):e.zmenu("changeIcon",t,"ui-zmenu-no-icon");var n;switch(t){case"pivotSubtotal":n=ActionConstants.CHANGE_PIVOT_SUBTOTALOPTION;break;case"pivotRowGrandTotal":n=ActionConstants.CHANGE_PIVOT_GRANDTOTALROWOPTION;break;case"pivotColumnGrandTotal":n=ActionConstants.CHANGE_PIVOT_GRANDTOTALCOLOPTION}var i=new RequestParameters(n);i.setParameters(pivotId,o);var s=new AjaxRequest;s.init("POST",i.getURL(),!0,i.getParametersAsString()),actionManager.addRequest(s)},getPivotAllFilterDetailsByPivotId:function(t){var e=pivot.Collection.get(t);return e&&e.attributes?e.attributes.fc:void 0},getPivotChartAttributesByPivotId:function(t){var e=pivot.Collection.get(t);return e&&e.attributes?e.attributes:void 0},getPivotAllFilterButtonDetailsByPivotId:function(t){var e=pivot.Collection.get(t);return e&&e.attributes?e.attributes.pb:void 0},getSortType:function(t,e,o){if(t)for(var n=0;n<t.length;n++){var i=t[n];if(i[JSONConstants.PIVOT_FIELD_TYPE]===e&&i[JSONConstants.HEADER_INDEX]===o)return i[JSONConstants.ASCENDING_SORT]?0:1}return-1},getIconType:function(t,e){switch(e){case-1:return t?"filterApplied":"filter_new";case 0:return t?"pivot_filter_ascending":"pivot_ascending";case 1:return t?"pivot_filter_descending":"pivot_descending"}return"pivotdown"},isFilterApplied:function(t,e,o){if(t)for(var n=0;n<t.length;n++){var i=t[n];if(i[JSONConstants.PIVOT_FIELD_TYPE]===e&&i[JSONConstants.HEADER_INDEX]===o)return!0}return!1},setToolTip:function(t,e,o,n,i,s,a){if(a)for(var r=0;r<a.length;r++){var l,c,d,v=a[r],S=v[JSONConstants.HEADER_INDEX],O=v[JSONConstants.PIVOT_FIELD_TYPE],p=v[JSONConstants.PIVOT_DATAFIELDINDEX],g=(v[JSONConstants.ASCENDING_SORT],-1==p?O:"data");switch(g){case"row":l=e[S];break;case"column":l=o[S];break;case"data":l=n[p];var u,C,P=i[p];for(u in P)C=P[u];c=u.charAt(0).toUpperCase()+u.slice(1)}for(var N=0;N<t.length;N++)l==t[N].colIndex&&(d=t[N].content);"data"===g&&(d=replaceParams(jsMsg["Pivot.UI.Datafield.Content."+c],new Array(escapeSpecialCharacters(d)))),d=replaceParams(jsMsg["Pivot.Tooltip.SortedBy"],new Array(escapeSpecialCharacters(d)));for(var f=0;f<s.length;f++){var E=s[f],T=E[JSONConstants.PIVOT_FIELD_TYPE],I=E[JSONConstants.HEADER_INDEX];O===T&&S===I&&(E[JSONConstants.SORTBY_TOOLTIP]=d)}}return!1},getFilterCells:function(t,e,o,n,i,s,a,r,l){var c=WorkSheets.getSheetNameFromCode(r);s&&s.indexOf("'")>-1&&c.indexOf(" ")>-1&&(c="'"+c+"'");var d,v=[];if(s=s?s.trim():""){var S=s.split(c);S.splice(0,1);for(var O=0;O<S.length;O++){var p=S[O];p=p.substring(p.indexOf(".")+1).trim();var g,u;d=CellUtils.getCellPosByLabel(p),i>O?(g="page",u=O,d[JSONConstants.PIVOT_FIELD_TYPE]=g,d[JSONConstants.HEADER_INDEX]=u):i+n>O?(g="row",u=O-i,d[JSONConstants.PIVOT_FIELD_TYPE]=g,d[JSONConstants.HEADER_INDEX]=u):(g="column",u=O-i-n,d[JSONConstants.PIVOT_FIELD_TYPE]=g,d[JSONConstants.HEADER_INDEX]=u);var C=PivotUtil.isFilterApplied(a,g,u),P=PivotUtil.getSortType(l,g,u);d[JSONConstants.PIVOT_ICON_TYPE]=PivotUtil.getIconType(C,P),d[JSONConstants.SELECT_ALL]=!C,v.push(d)}}else{for(var N=0===i?0:1,O=0;o>O;O++){d={row:t+i+N,col:e+O+Math.max(n,1),pft:"column",hidx:O};var C=PivotUtil.isFilterApplied(a,"row",O),P=PivotUtil.getSortType(l,"row",O);d[JSONConstants.PIVOT_ICON_TYPE]=PivotUtil.getIconType(C,P),d[JSONConstants.SELECT_ALL]=!C,v.push(d)}for(var f=0;n>f;f++){d={row:t+Math.max(o,1)+i+N,col:e+f,pft:"row",hidx:f};var C=PivotUtil.isFilterApplied(a,"col",f),P=PivotUtil.getSortType(l,"col",f);d[JSONConstants.PIVOT_ICON_TYPE]=PivotUtil.getIconType(C,P),d[JSONConstants.SELECT_ALL]=!C,v.push(d)}for(var E=0;i>E;E++){d={row:t+E,col:e,pft:"page",hidx:E};var C=PivotUtil.isFilterApplied(a,"page",E),P=PivotUtil.getSortType(l,"page",E);d[JSONConstants.PIVOT_ICON_TYPE]=PivotUtil.getIconType(C,P),d[JSONConstants.SELECT_ALL]=!C,v.push(d)}}return v},createPivotObject:function(t){var e=t[JSONConstants.START_ROW],o=t[JSONConstants.START_COLUMN],n=t[JSONConstants.COLUMN_FIELDS],i=t[JSONConstants.ROW_FIELDS],s=n.length,a=i.length,r=t[JSONConstants.PAGE_FIELDS].length,l=t[JSONConstants.PIVOT_BUTTONS],c=PivotUtil.getFilterCells(e,o,s,a,r,l,t[JSONConstants.PIVOT_FILTER_DETAILS],t[JSONConstants.ASSOCIATED_SHEET_NAME],t[JSONConstants.PIVOT_SORT_DETAILS]);t[JSONConstants.FILTER_CELLS]=c,PivotUtil.setToolTip(t[JSONConstants.ALL_FIELDS],i,n,t[JSONConstants.DATA_FIELDS],t[JSONConstants.FUNCTION],t[JSONConstants.FILTER_CELLS],t[JSONConstants.PIVOT_SORT_DETAILS]),t[JSONConstants.ASSOCIATED_SHEET_NAME]===WorkSheets.getAssociatedActiveSheetName()&&PivotUtil.createFilterIcon(c,t[JSONConstants.ID],PivotUtil.getValueObj(i,n)),pivot.Collection.create(t)},changeCreatePivotBt:function(t,e){var o=$("#createPivot");o.length&&(t?($(o.children()[0]).removeClass("generate"),$(o.children()[1]).text(jsMsg["Pivot.UI.Generate"]),o.css("padding-left","14px"),e&&o.addClass("ui-button-disabled ui-state-disabled")):($(o.children()[1]).text(jsMsg["Pivot.UI.Progress"]),$(o.children()[0]).addClass("generate"),o.css("padding-left","25px")))},createFilterIcon:function(t,e,o){Filter.isPivotFilter=!0;for(var n=0;n<t.length;n++){var i=t[n],s=i.row,a=i.col,r=i[JSONConstants.PIVOT_FIELD_TYPE],l=i[JSONConstants.HEADER_INDEX];if(!o||r!==o[JSONConstants.PIVOT_FIELD_TYPE]||l!==o[JSONConstants.HEADER_INDEX]){var c=(Filter.getHeader(),getObj("fIP")),d=s,v=getRowTop(d),S=getRowHeight(d),O=Filter.getIconContainer();browser_ie&&(c.style.zIndex=51+BASEZINDEX);var p=(!i[JSONConstants.SELECT_ALL],O.cloneNode(!0));p.setAttribute("col",a),p.setAttribute("row",s),p.setAttribute("pivot",!0),p.style.height=S+"px",p.style.width=getColWidth(a)+"px",p.style.left=getColLeft(a)+"px",p.style.top=v+"px",p.setAttribute(JSONConstants.PIVOT_FIELD_TYPE,r),p.setAttribute(JSONConstants.HEADER_INDEX,l),p.setAttribute(JSONConstants.ID,e),c.appendChild(p);var g=p.childNodes[0];i[JSONConstants.SORTBY_TOOLTIP]&&(g.title=i[JSONConstants.SORTBY_TOOLTIP]),g.src=IMAGE_PATH+i[JSONConstants.PIVOT_ICON_TYPE]+".png",g.setAttribute("col",a),g.setAttribute("row",s),PivotUtil.generateFilterDropDown(g)}}Filter.replicateInAllPanes(!1)},getValueObj:function(t,e){return t&&-1!==t.indexOf(-1)?{pft:"row",hidx:t.indexOf(-1)}:e&&-1!==e.indexOf(-1)?{pft:"column",hidx:e.indexOf(-1)}:void 0},generateFilterDropDown:function(t){t.onclick=function(t){var e=t.target,o=e.getAttribute("col");Filter.isPivotFilter=!0,Filter.showFilterOptions(t,o)}},changeSortIcon:function(t){var e=t[JSONConstants.ID],o=t[JSONConstants.HEADER_INDEX],n=t[JSONConstants.PIVOT_FIELD_TYPE],i=t[JSONConstants.ASCENDING_SORT],s=t[JSONConstants.PIVOT_DATAFIELDINDEX],a=pivot.Collection.get(e),r=a.get(JSONConstants.PIVOT_SORT_DETAILS);if(r){for(var l=0;l<r.length;l++)if(sortDetail=r[l],sortDetail[JSONConstants.PIVOT_FIELD_TYPE]===n&&sortDetail[JSONConstants.HEADER_INDEX]===o){r.splice(l,1);break}}else r=[],a.set(JSONConstants.PIVOT_SORT_DETAILS,r);sortDetail={hidx:o,pft:n,as:i,pdfi:s},r.push(sortDetail)},changeFilterIcon:function(t,e,o,n,i){function s(i){for(var s=i.querySelectorAll("[pivot]"),a=0;a<s.length;a++){var r=s[a];if(r.getAttribute(JSONConstants.ID)===t&&1*r.getAttribute(JSONConstants.HEADER_INDEX)===e&&r.getAttribute(JSONConstants.PIVOT_FIELD_TYPE)===o){r.children[0].src=IMAGE_PATH+(n?Filter.header.filterImage:Filter.header.filterAppliedImage);break}}}s(filterIconsPane),ISFREEZED&&(s(filterIconsPane1),s(filterIconsPane2),s(filterIconsPane3));var a=pivot.Collection.get(t),r=a.get(JSONConstants.PIVOT_FILTER_DETAILS),l=a.get(JSONConstants.FILTER_CELLS);if(l)for(var c=0;c<l.length;c++){var d=l[c];if(d[JSONConstants.PIVOT_FIELD_TYPE]===o&&d[JSONConstants.HEADER_INDEX]===e){d[JSONConstants.SELECT_ALL]=n;break}}var v,S=!1;if(r){for(var c=0;c<r.length;c++)if(v=r[c],v[JSONConstants.PIVOT_FIELD_TYPE]===o&&v[JSONConstants.HEADER_INDEX]===e){S=!0,n&&!i&&r.splice(c,1);break}}else r=[],a.set(JSONConstants.PIVOT_FILTER_DETAILS,r);S||n&&!i||(v={hidx:e,pft:o},r.push(v))},reconstructFilterIcon:function(t){var e=t.get(JSONConstants.ID);PivotUtil.removeFilterIcon(e);var o=t.get(JSONConstants.ROW_FIELDS),n=t.get(JSONConstants.COLUMN_FIELDS),i=PivotUtil.getFilterCells(t.get(JSONConstants.START_ROW),t.get(JSONConstants.START_COLUMN),n.length,o.length,t.get(JSONConstants.PAGE_FIELDS).length,t.get(JSONConstants.PIVOT_BUTTONS),t.get(JSONConstants.PIVOT_FILTER_DETAILS),t.get(JSONConstants.ASSOCIATED_SHEET_NAME),t.get(JSONConstants.PIVOT_SORT_DETAILS));t.set(JSONConstants.FILTER_CELLS,i),PivotUtil.setToolTip(t.get(JSONConstants.ALL_FIELDS),o,n,t.get(JSONConstants.DATA_FIELDS),t.get(JSONConstants.FUNCTION),t.get(JSONConstants.FILTER_CELLS),t.get(JSONConstants.PIVOT_SORT_DETAILS)),WorkSheets.getAssociatedActiveSheetName()===t.get(JSONConstants.ASSOCIATED_SHEET_NAME)&&PivotUtil.createFilterIcon(i,e,PivotUtil.getValueObj(o,n))},resetPivotProps:function(t,e){e&&(e=JSON.parse(decodeURIComponent(JSON.stringify(e))),t.set(JSONConstants.END_ROW,e[JSONConstants.END_ROW]),t.set(JSONConstants.END_COLUMN,e[JSONConstants.END_COLUMN]),t.set(JSONConstants.PIVOT_BUTTONS,e[JSONConstants.PIVOT_BUTTONS]),t.set(JSONConstants.PAGE_FIELDS,e[JSONConstants.PAGE_FIELDS]),t.set(JSONConstants.ROW_FIELDS,e[JSONConstants.ROW_FIELDS]),t.set(JSONConstants.COLUMN_FIELDS,e[JSONConstants.COLUMN_FIELDS]),t.set(JSONConstants.DATA_FIELDS,e[JSONConstants.DATA_FIELDS]),t.set(JSONConstants.ALL_FIELDS,e[JSONConstants.ALL_FIELDS]))},hideAndDisplayPivotTab:function(t){var e=$("#menutabs"),o=e.ztab("getSelectedTab");if(READ_WRITE||PivotUtil.isPivotBuilderOpen()){var n=pivotId;if(o.length)if(pivot.Collection.isPivotRange(currRow,currCol,currRow,currCol)){if(!$("#pivottw").is(":visible")){var i=o[0].id;"chartMenu"!==i&&"pivottw"!==i&&(selectedmenutab=o[0].id),$("#pivottw").show(),t&&ZComponentTabs.setSelectedTab("pivottw")}n!==pivotId&&sheetdialog.getTitle()===jsMsg["Pivot.UI.Builder.Title"]&&sheetdialog.close()}else"pivotTabmenu"===o.metadata().toolbar&&(PivotUtil.isPivotBuilderOpen()&&PivotUtil.enableToolbar(),PivotUtil.showPrevSelectedTab()),$("#pivottw").hide()}else ProtectedRanges.isSheetLocked(CURRSHEETNAME)&&o.length&&$("#pivottw").is(":visible")&&(PivotUtil.showPrevSelectedTab(),$("#pivottw").hide())},showPrevSelectedTab:function(){selectedmenutab&&$("#"+selectedmenutab).is(":visible")||(selectedmenutab="hometw"),ZComponentTabs.setSelectedTab(selectedmenutab)},isPivotBuilderOpen:function(){return sheetdialog.getOpenedDialog().length>0&&sheetdialog.getTitle()===jsMsg["Pivot.UI.Builder.Title"]},detectRange:function(t,e){return PivotUtil.detectRangeFromServer(t,e)},detectRangeFromServer:function(t,e){var o,n=new RequestParameters(ActionConstants.DETECT_PIVOT_RANGE);n.setParameters(WorkSheets.getAssociatedActiveSheetName(),t,e);var i=new AjaxRequest;return i.init("POST",n.getURL(),!1,n.getParametersAsString()),i.addEventListener("onComplete",function(t){o=JSON.parse(decodeURIComponent(t.responseText))}),i.sendRequest(),o?{startRow:o[JSONConstants.START_ROW],startCol:o[JSONConstants.START_COLUMN],endRow:o[JSONConstants.END_ROW],endCol:o[JSONConstants.END_COLUMN]}:{startRow:t,startCol:e,endRow:t,endCol:e}},changeTheme:function(t,e){if(!PivotUtil.isLocked(pivotId)){var o=pivot.Collection.get(pivotId);if(!PivotUtil.isMaxNoOfFieldsExceeded(o.toJSON())){var n=t+"tc"+e;if(o.get(JSONConstants.PIVOTTEMPLATE_ID)!==n){o.set(JSONConstants.PIVOTTEMPLATE_ID,n);var i=new RequestParameters(ActionConstants.CHANGE_PIVOT_THEME);i.setParameters(pivotId,t,e);var s=new AjaxRequest;s.init("POST",i.getURL(),!0,i.getParametersAsString()),actionManager.addRequest(s)}}}},enableDiasablePromptDlgBtn:function(){""===$("#targetCell").val()?$("#confirmPivot").addClass("ui-button-disabled ui-state-disabled"):$("#confirmPivot").removeClass("ui-button-disabled ui-state-disabled")},hideMaxFieldError:function(){$("#errMaxField").slideUp(),$("#rf, #cf, #pf, #df").removeClass("errMaxCont")},gridChange:function(t){var e=sheetdialog.getOpenedDialog(),o=t?browser_firefox?t.currentTarget:window.event.srcElement:$("#gridView")[0],n=e.css("left");if(!$(o).hasClass("active")){var i=$(o).hasClass("pGridView");$(o).addClass("active"),i?(pivot.is_grid_dialog=!0,e.css("width",639),$(".catS").css("float","left"),$(".catList").addClass("catListHgt"),$(".pListView").removeClass("active"),$("#allFields").removeClass("pListV"),$("#allFields").addClass("pGridV"),$("#errMaxField").css("left","15%")):(pivot.is_grid_dialog=!1,$(".catS").css("float",""),$(".catList").removeClass("catListHgt"),e.css("width",428),$(".pGridView").removeClass("active"),$("#allFields").removeClass("pGridV"),$("#allFields").addClass("pListV"),$("#errMaxField").css("left","-16px")),n=parseInt(n),n=Math.max(0,i?n-200:n+200),e.css("left",n),PivotUtil.setErrDivWidth()}},setErrDivWidth:function(){var t=$("#pivotdialogzdialog").parent().css("width");t&&$("#err").css("width",parseInt(t)-2+"px")},updateVerticalScroll:function(t){t>usedCursRow&&(usedCursRow=t,usedCursRow>totRows&&appendBlankRows("ROWS_EXCEEDED",usedCursRow))},isEnterKeyPressed:function(t){var e=window.event?window.event.keyCode:t.which;return 13===e},setLastAction:function(t){var e={};e.url=t.getURL(),e.params=t.getParametersAsString(),pivot.lastAction=e},resendRequest:function(){var t=pivot.lastAction;if(t){var e=t.params.replace("overwriteData=false","overwriteData=true"),o=new AjaxRequest;o.init("POST",t.url,!0,e),actionManager.addRequest(o),pivot.lastAction=void 0}},setFollowUpAction:function(t){var e={};e.url=t.getURL(),e.params=t.getParametersAsString(),pivot.fua=e},sendFollowUpAction:function(t){var e=pivot.fua;if(e){var o=WorkSheets.getSheetCodeFromName(t),n=new AjaxRequest,i=e.params,s=i.indexOf("currSheetName="),a=i.indexOf("&",s),r=i.slice(s,a>0?a+1:i.length);i=i.replace(r,""),i+="&currSheetName="+t,i+="&currentSheet="+o,n.init("POST",e.url,!0,i),actionManager.addRequest(n),pivot.fua=void 0}},isMaxNoOfFieldsExceeded:function(t){var e=t[JSONConstants.ROW_FIELDS].length,o=t[JSONConstants.COLUMN_FIELDS].length,n=t[JSONConstants.PAGE_FIELDS].length,i=t[JSONConstants.DATA_FIELDS].length,s=e>5||o>5||n>5||i>5;if(s){var a="",r=jsMsg["Error.Pivot.Max.Fields"];return e>5&&(a+=replaceParams(r,new Array(jsMsg["Find.Row"])),a+=" "),o>5&&(a+=replaceParams(r,new Array(jsMsg["Find.Column"])),a+=" "),n>5&&(a+=replaceParams(r,new Array(jsMsg["Pivot.UI.Filter"])),a+=" "),i>5&&(a+=replaceParams(r,new Array(jsMsg["Pivot.UI.Data"])),a+=" "),a+=jsMsg["Error.Pivot.Max.Field.Alert"],showAlertDialog(a),!0}return!1},disableBuilder:function(){$("#pf ul, #rf ul, #cf ul, #df ul").sortable("disable").droppable("disable"),$("#allFields li").draggable("disable"),$("#searchField").disable()},enableBuilder:function(){$("#err").slideUp(500),setTimeout(function(){$("#targetCell").blur()},501),$("#pf ul, #rf ul, #cf ul, #df ul").sortable("enable").droppable("enable"),$("#allFields li").draggable("enable"),$("#searchField").enable(),RangeSelector.off()},isPivotDialogError:function(t,e){if(PivotUtil.changeCreatePivotBt(!0),hideProgressMessage(),"Error.Pivot.Table.Overlaps"===t||"Error.Pivot.Overwrite.Data"==t){PivotUtil.disableBuilder();var o,n;return"Error.Pivot.Table.Overlaps"===t?(o=jsMsg["Error.Pivot.Table.Overlaps.Create"],n=jsMsg["Error.Pivot.Table.Overlaps.Header"],$("#overwrite").css("display","none")):(o=jsMsg[t],n=jsMsg["Error.Pivot.Overwrite.Data.Header"],$("#overwrite").css("display","block"),PivotUtil.enableDisableOverwrite(!0)),o=replaceParams(o,e),$("#builder_err_msg")[0].innerHTML=o,$("#builder_err_msg_title")[0].innerHTML=n,$("#err").slideDown(1e3),setTimeout(function(){$("#targetCell").focus()},1200),!0}return!1},enableDisableOverwrite:function(t){t?($("#confirmPivot").addClass("ui-button-disabled ui-state-disabled"),$("#overwrite").removeClass("ui-button-disabled ui-state-disabled")):($("#overwrite").addClass("ui-button-disabled ui-state-disabled"),$("#confirmPivot").removeClass("ui-button-disabled ui-state-disabled"))}};appEvent.on("range.focus cell.focus",function(){jsVERSION_VIEW||PivotUtil.hideAndDisplayPivotTab(!0)}),appEvent.on("doMenuItemBinding",function(){$("#pivotThemeMenu").bind("menushow",function(){var t=pivot.Collection.get(pivotId),e=t.get(JSONConstants.PIVOTTEMPLATE_ID);e="pt_"+e.replace("tc",""),$("#pivotThemeMenu").zmenu("check",e)}),$("#pivotOptionsMenu").bind("menubeforeshow",function(){for(var t=pivot.Collection.get(pivotId),e=$("#pivotOptionsMenu"),o=[JSONConstants.SUBTOTALOPTION,JSONConstants.ROWGRANDTOTALOPTION,JSONConstants.COLGRANDTOTALOPTION],n=["pivotSubtotal","pivotRowGrandTotal","pivotColumnGrandTotal"],i=0;i<o.length;i++){var s=o[i];t.get(s)?e.zmenu("changeIcon",n[i],"ui-individual-icon ui-icon-ztick"):e.zmenu("changeIcon",n[i],"ui-zmenu-no-icon")}})}),appEvent.on("grid.shift",function(t,e){if(e&&e.a)switch(e.a){case ActionConstants.INSERT_ROW:pivot.Collection.rowShiftOperation(e.si,e.count,WorkSheets.getSheetCodeFromName(e.sn));break;case ActionConstants.DELETE_ROW:pivot.Collection.rowShiftOperation(e.si,-e.count,WorkSheets.getSheetCodeFromName(e.sn));break;case ActionConstants.INSERT_COL:pivot.Collection.colShiftOperation(e.si,e.count,WorkSheets.getSheetCodeFromName(e.sn));break;case ActionConstants.DELETE_COL:pivot.Collection.colShiftOperation(e.si,-e.count,WorkSheets.getSheetCodeFromName(e.sn))}});var PlaceHolder={getDimObj:function(t){var e=pivot.Collection.get(t);if(e&&e.get(JSONConstants.ASSOCIATED_SHEET_NAME)===WorkSheets.getAssociatedActiveSheetName()){var o=e.get(JSONConstants.START_ROW),n=e.get(JSONConstants.START_COLUMN),i=e.get(JSONConstants.END_ROW),s=e.get(JSONConstants.END_COLUMN),a=getCellRangeDIM(o,n,i,s);return a}},create:function(t){$("<div>",{class:"pBpHA",id:"pBpHAiD"}).appendTo("#sOP");var e=PlaceHolder.getDimObj(t),o=e.left,n=e.top,i=e.width-1,s=e.height-1;$("<div>",{class:"pBpH",id:"pBpHiD_"+t,style:"left:"+o+"px;top:"+n+"px;width:"+i+"px;height:"+s+"px;"}).appendTo("#pBpHAiD"),$("<div>",{class:"pBpHl"}).text("PivotTable").appendTo("#pBpHiD_"+t),$("<div>",{class:"pBpHi"}).appendTo("#pBpHiD_"+t)},remove:function(t){$("#pBpHiD_"+t).remove()},pHApplyBackgound:function(t,e,o,n){updateRangeFormat(t,e,o,n,"backgroundColor","#F2F2F2")},createBorder:function(t,e,o,n){PlaceHolder.pHTopBorder(t,e),PlaceHolder.pHLeftBorder(t,e),PlaceHolder.pHBottomBorder(o,e),PlaceHolder.pHRightBorder(t,n)},pHTopBorder:function(t,e){var o=t-1;for(i=0;2>=i;i++){var n={r:o,c:e+i,17:"1px solid #000000"};updateCellBorder(o,e+i,n)}},pHLeftBorder:function(t,e){var o=e-1;for(i=0;10>=i;i++){var n={r:t+i,c:o,14:"1px solid #000000"};updateCellBorder(t+i,o,n)}},pHBottomBorder:function(t,e){for(i=0;2>=i;i++){var o={r:t,c:e+i,17:"1px solid #000000"};updateCellBorder(t,e+i,o)}},pHRightBorder:function(t,e){for(i=0;10>=i;i++){var o={r:t+i,c:e,14:"1px solid #000000"};updateCellBorder(t+i,e,o)}}};
function stopEvent(e){is_ie?(e.cancelBubble=!0,e.returnValue=!1):(e.preventDefault(),e.stopPropagation())}function showLockedBy(e){var t=document.createElement("img");t.id="lockIcon",t.src=IMAGE_PATH+"spacer.gif",t.className="zdocstatus zdocstatus-locked",t.title=replaceParams(jsMsg["Checkin.lockedBy"],new Array(e));var a=document.getElementById("docstausicons");a.appendChild(t)}function errorAlert(e,t,a,s){showErrorPanelMsg==t||"error"==s?(null!=e&&""!=e&&(e=jsMsg.Error+" "+e+": "),handleServerError("ERROR",e+t,!0)):"true"==a?showBannerMessage(s.toUpperCase(),t):cookieEnabled&&handleServerError("ERROR",jsMsg["ErrorPanel.MainContent"]+" "+jsMsg.KindlyReopenFileAndTryAgain,!0)}function OpenRecDoc(e){window.open(ctxpath+"open/"+e)}function openFileDialog(){isCellEdited()&&submitCell(),FILEDIALOG.showOpenFileDialog("zohosheet","_blank",user.permissions.create)}function trimNameWithDots(e,t){return BAIHUIMODE&&(noOfDigits=10),"undefined"==typeof t&&(t=noOfDigits),"undefined"!=typeof e&&null!=e?e.length>t?e.substring(0,t-3)+"...":e:void 0}function btn_disabled(){if(SAVED=!0,$("#save").disable(),ENABLE_SAVE_MESSAGE&&showSaveMessage("disable"),jsREMOTE_SAVE_VIEW||isEdit){if(ENABLE_SAVE_MESSAGE){var e=getObj("save_message_display");e&&(e.style.display="")}window.clearInterval(AUTO_SAVED),AUTO_SAVED=null}"undefined"!=typeof ZohoMockup&&ZohoMockup.__sendRequest("onDocumentChange",{result:!SAVED})}function btn_enabled(){SAVED&&(lastSavedTime=new Date),isDocSaved()&&!isEditorClosed&&(SAVED=!1,$("#save").enable(),"undefined"!=typeof ZohoMockup&&ZohoMockup.__sendRequest("onDocumentChange",{result:!SAVED})),isChangeMadeAfterScroll=!0}function getAryMetadata(e){for(var e=e,t=e[0],a=0,s=e.length,o="[",n=1;s>n;n++)t!=e[n]&&(o=o+"{ sr: "+a+", er:"+(n-1)+", v:"+t+"},",t=e[n],a=n);return o=o+"{ sr: "+a+", er:"+(s-1)+", v:"+t+"}]"}function resetPageDim(e){resetEditorDim(e)}function resetEditorDim(e){var t=null!=arguments[0]?arguments[0]:"";resetHScrollDim(e),resetSheetsTabDim(),resetWorkSheetDim(),appEvent.trigger("editor.resize"),jsTHROWAWAY_VIEW||setTimeout(function(){"ONLY_WIDTH"!==t&&appEvent.trigger("docpanel.resetDim"),jsVERSION_VIEW&&!isPreview&&(ISCDVIEW&&AuditTrail.showVersionHistory(DOCUMENT_VERSION),AuditTrail.setVersionDialogHeight())},150)}function resetWorkSheetDim(){var e=getObj("sheetdiv");isSSActive&&(isEditorClosed||showHScrollbar(),jsGADGET_VIEW||"none"!=getObj("eP").style.display||showSheetToolbars(),e.style.width="",e.style.height="",resetSheetDim())}function showSheetToolbars(){getObj("eP").style.display=""}function registerIconEvents(e){for(var t=0;t<e.length;t++){var a=e[t].className;("icon"==a||"iconText"==a||"iconDropDown"==a||"iconMore"==a)&&(e[t].onmouseover=function(){iconMouseOver(this)},e[t].onmouseout=function(){iconMouseOut(this)},e[t].onmousedown=function(){iconMouseDown(this)},e[t].onmouseup=function(){iconMouseUp(this)})}}function getIconBaseClass(e){if(!jsGADGET_VIEW){if("string"==typeof e&&(e=getObj(e)),null!=e){var t=e.className;return t.indexOf(" ")>-1&&(t=t.substr(0,t.indexOf(" "))),t}return""}}function getIconText(e){var t=e.getElementsByTagName("SPAN");return 0==t?"":t[0]}function getIconImg(e){var t=e.getElementsByTagName("IMG");return 0==t.length?"":t[0]}function iconMouseOver(e){if(null!=e){var t=e.getAttribute("iconType");if("button"!=t||"true"!=e.getAttribute("iconDisabled")){var a=getIconBaseClass(e);if(e.className!=a+" pressed"){if(e.className=a+" hover","dropdown"==t){var s=getObj(e.getAttribute("relId"));if(null!=s&&(s.className=getIconBaseClass(s)+" hover"),null!=e.getAttribute("displayState"))var o=e;else if(null!=s&&null!=s.getAttribute("displayState"))var o=s}else if(null!=e.getAttribute("displayState"))var o=e;if("undefined"!=typeof o&&"disabled"==o.getAttribute("displayState")){var n=getIconImg(o);""!=n&&(n.src=IMAGE_PATH+o.getAttribute("imgName")+".png");var i=getIconText(o);"undefined"!=typeof i&&null!=i&&""!=i&&(i.className="")}}}}}function iconMouseOut(e){var t=e.getAttribute("iconType"),a=getIconBaseClass(e);if(e.className!=a+" pressed"){if(e.className=a,"dropdown"==t){var s=getObj(e.getAttribute("relId"));if(null!=s&&(s.className=getIconBaseClass(s)),null!=e.getAttribute("displayState"))var o=e;else if(null!=s&&null!=s.getAttribute("displayState"))var o=s}else if(null!=e.getAttribute("displayState"))var o=e;if("undefined"!=typeof o&&"disabled"==o.getAttribute("displayState")){var n=getIconImg(o);""!=n&&(n.src=IMAGE_PATH+o.getAttribute("imgName")+"_disabled.png");var i=getIconText(o);"undefined"!=typeof i&&null!=i&&""!=i&&(i.className="disabled")}}}function iconMouseDown(e){var t=e.getAttribute("iconType");if("formatbrush"!=e.id&&exitFormatPainter(),"button"!=t||"true"!=e.getAttribute("iconDisabled")){var a=getIconBaseClass(e);e.className!=a+" pressed"&&(e.className=a+" mouseDown")}}function iconMouseUp(e){var t=e.getAttribute("iconType");if("button"!=t||"true"!=e.getAttribute("iconDisabled")){var t=e.getAttribute("iconType");if("check"==t){var a=getIconBaseClass(e);e.className=e.className!=a+" pressed"?a+" pressed":a}}}function saveas(){if(null!=$("#fileName")){var e=getObj("saveAsFileName"),t=e.value;if(add="yes",doc_id="doc_id",param="saveas",null==t||"null"==t.trim()||"undefined"==t.trim()||""==t.trim())return showAlertDialog(jsMsg["InvalidMsg.SpreadsheetName"]),e.focus(),!1;t=replaceDisallowedCharsInDocName(t).trim();var a=(encodeURIComponent(DOCUMENT_NAME),getObj("loading"));null!=a&&($("#loading").addClass("updatingmsg"),showPrevMessage&&(PREVIOUS_MESSAGE=a.innerHTML)),sheetdialog.close(),showProgressMessage();var s=new RequestParameters(ActionConstants.SAVEAS_NEW_DOCUMENT);s.setParameters(t);var o=new AjaxRequest;o.init("POST",s.getURL(),!0,s.getParametersAsString()),o.addEventListener("onComplete",function(e){hideProgressMessage();var t=parseJSON(e.responseText);loadDocument(t.di)}),o.sendRequest()}}function renameDocument(e){if(e||(e=getObj("saveAsDocOrTempFileName").value),e&&""===e.trim())return void showAlertDialog(jsMsg["Rename.DocumentNameCannotBeEmpty"]);if(!e)return void showAlertDialog(jsMsg["Rename.InvalidDocumentName"]);sheetdialog.close(),loadon(),$("#loading").addClass("updatingmsg"),isNewDoc=!1,e=e.trim(),updatedSaveTime="saved";var t=new RequestParameters(ActionConstants.RENAME_DOCUMENT);t.setParameters(encodeURIComponent(e));var a=new AjaxRequest;a.init("POST",t.getURL(),!0,t.getParametersAsString()),a.addEventListener("onComplete",function(){loadoff()}),a.sendRequest()}function blindDown(e,t,a){var s=getObj(e);s.style.overflow="hidden",s.style.display="",s.style.height="100%";var o=s.offsetHeight;s.style.height="1px",s.style.display="","undefined"!=typeof blindUpIntvl&&window.clearInterval(blindUpIntvl),"undefined"!=typeof blindDownIntvl&&window.clearInterval(blindDownIntvl),"undefined"==typeof a&&(a=1),blindDownIntvl=window.setInterval('doBlindDown("'+e+'", '+o+", "+t+")",a)}function doBlindDown(e,t,a){var s=getObj(e),o=parseInt(s.style.height)+5;o>t-5&&(o=parseInt(s.style.height)+1),t>=o?s.style.height=o+"px":(s.style.height=t+"px",window.clearInterval(blindDownIntvl),"undefined"!=typeof a&&a())}function blindUp(e,t){var a=getObj(e);a.style.display="","undefined"!=typeof blindUpIntvl&&window.clearInterval(blindUpIntvl),"undefined"!=typeof blindDownIntvl&&window.clearInterval(blindDownIntvl),blindUpIntvl=window.setInterval('doBlindUp("'+e+'", '+t+")",1)}function doBlindUp(e,t){var a=getObj(e),s=parseInt(a.style.height)-4;4>s&&(s=parseInt(a.style.height)-1),s>0?a.style.height=s+"px":(a.style.height="0px",a.style.display="none",window.clearInterval(blindUpIntvl),"undefined"!=typeof t&&t())}function fadeIn(e,t,a){alphaVal=0;var s=getObj(e);s.style.opacity=alphaVal,s.style.filter="alpha(opacity="+alphaVal+")",s.style.display="",fadeInIntvl=window.setInterval('doFadeIn("'+e+'", '+a+")",t)}function doFadeIn(e,t){var a=getObj(e);10>alphaVal?(a.style.filter="alpha(opacity="+10*alphaVal+")",a.style.opacity=alphaVal/10,alphaVal++):(a.style.filter="alpha(opacity=100)",a.style.opacity=.99,window.clearInterval(fadeInIntvl),"undefined"!=typeof t&&t())}function fadeOut(e,t,a){alphaVal=9,fadeOutIntvl=window.setInterval('doFadeOut("'+e+'", '+a+")",t)}function doFadeOut(e,t){var a=getObj(e);alphaVal>0?(a.style.filter="alpha(opacity="+10*alphaVal+")",a.style.opacity=alphaVal/10,alphaVal--):(alphaVal=0,a.style.filter="alpha(opacity=0)",a.style.opacity=.01,a.style.display="none",window.clearInterval(fadeOutIntvl),"undefined"!=typeof t&&t())}function initBottomBand(){jsGADGET_VIEW||(browser_ie||browser_ff3?resetSheetsTabDim():setSheetsTabDim())}function saveRemoteWorkbook(){isGDriveView?updateDocToGDrive():REMOTE.ISRMVIEW&&saveremoteGEdoc("save")}function saveremoteGEdoc(e,t,a){if(ALLOW_TO_WRITE&&!savingInProgress){if("autosave"!=e&&(exprFieldKeyPressed||isCellEdited()))return submitCallBack={action:"saveremoteGEdoc",args:[e,t,a]},submitCell(),void(doAutoSave=!0);if("autosave"!=e&&forceSaveAs&&"null"!=forceSaveAs)return void saveAsRemoteDoc();var s=!1;if("undefined"==typeof t||null==t?s=SAVED:(IS_SAVEAS=!0,s=!1),!savingInProgress||a){if(""==DOCUMENT_NAME.trim()&&"autosave"!=e){if(ISGEEDITOR){var o=new RequestParameters(ActionConstants.JSP_GESAVEPOPUP);return o.setParameters(HANDBACK_ID),void showURLInDialog(o.getURL()+o.getParametersAsString(),"width = 450, height = 425, position=absmiddle, top = 15, closeOnEscKey=yes, modal=yes,title=Save")}var n={width:300,modal:!0,title:jsMsg.Save,buttons:[{text:jsMsg.OK,click:function(){saveNewDoc()}},{text:jsMsg.Cancel,click:function(){sheetdialog.close()}}]};sheetdialog.open(getSaveDialogHTML(),n);var i=getObj("save_docName");return null!=i&&(i.focus(),i.select()),!1}if(s)return!1;if("autosave"!=e)if(IS_SAVEAS)showProgressMessage(replaceParams(jsMsg["RemoteEditor.SaveAs.StatusMessage"],new Array(t.toUpperCase())));else if(ENABLE_SAVE_MESSAGE)showSaveMessage("enable");else{var l=getObj("save_message_display");l&&(l.innerHTML=jsMsg.Saving+"...")}var r=new RequestParameters(ActionConstants.REMOTE_SAVE);r.setParameters();var c=new AjaxRequest;c.init("POST",r.getURL(),!0,r.getParametersAsString()),c.addEventListener("onComplete",function(e){noOfUpdateRequestInProgress--,savingInProgress=!1;var t=e.responseText;if(t)if("AgentSave"==t.trim()){SAVED=!0,btn_disabled();var a=getObj("save_message_display");a.innerHTML=""}else{var s=JSON.parse(t),a=getObj("save_message_display");"success"==s.status&&(SAVED=!0,btn_disabled()),a&&(a.innerHTML=ZSEC.Encoder.encodeForHTML(s.msg)),setTimeout(function(){a.innerHTML=""},2e3)}}),c.addEventListener("onError",function(){var e=getObj("save_message_display");e.innerHTML="",handleServerError("ERROR",jsMsg["Error.Internal.Server"],!0)}),noOfUpdateRequestInProgress++,savingInProgress=!0,savingInProgressTimer=setInterval(resetSavingInProgressFlag,1e4),c.sendRequest()}}}function resetSavingInProgressFlag(){savingInProgress&&(savingInProgress=!1),clearInterval(savingInProgressTimer)}function saveremoteDraft(){Collaboration.quit(COLLAB_ID);var e=new getXmlhttp;e.open("POST",ctxpath+"remotedraftSave.do",!1),e.onreadystatechange=function(){4==e.readyState},e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8");var t="doc="+DOCUMENT_ID+"&uname="+RMUSER+"&autosave=savedraft";""!=USERSTATEID&&(t+="&userStateId="+USERSTATEID),e.send(t)}function deleteremotedoc(){if(jsREMOTE_SAVE_VIEW||jsREMOTE_VIEW){var e=new getXmlhttp,t="doc="+DOCUMENT_ID;null!=RMUSER&&(t+="&uname="+RMUSER),""!=USERSTATEID&&(t+="&userStateId="+USERSTATEID),""!=COLLAB_ID&&(t+="&collabId="+COLLAB_ID),e.open("GET",ctxpath+"remotestatedelete.do?"+t,!1),e.onreadystatechange=function(){if(4==e.readyState){e.responseText}},e.send(null)}}function getInvalidEmailError(e){if("undefined"==typeof checkForLength&&(checkForLength=!0),e=e.trim(),""==e)return jsMsg.PleaseEnterEmailAddress;var t=validateEmail(e);return t?null:jsMsg.PleaseEnterValidEmailAddress}function validateEmail(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function isCellEdited(){return!isEditingInExprField&&!isCellFieldSPANHided()}function addSelectOptions(e,t,a,s,o){if("undefined"!=typeof e&&null!=e){var n=document.createElement("OPTION");"undefined"!=typeof t&&(n.text=t),"undefined"!=typeof a&&(n.value=a),"undefined"!=typeof s&&(n.id=s),"undefined"!=typeof o&&(n.title=o),"undefined"!=typeof e&&e.options.add(n)}}function removeSelectOptions(e,t){if("undefined"!=typeof e&&null!=e)if("ALL"==t)for(i=e.length-1;i>=0;i--)e.remove(i);else"undefined"!=typeof t&&e.remove(t)}function replaceParams(e,t){if("undefined"!=typeof t&&t.length>0&&!transMode)for(i=0;i<t.length;i++)e=replace(e,"{"+i+"}",t[i]);return e}function showMyAccountsMenu(){var e=[];e.push({data:"{label:'"+jsMsg.MyAccount+"', appData:{callback: 'window.open', arg:'IAMMyAccount'}}"}),e.push({mtype:"separator"}),e.push({data:"{label:'"+jsMsg.SignOut+"', appData:{callback: 'checksaved', arg:'logout'}}"});var t={target:$("#myAccountLink"),clearcache:!1,menuoptions:{type:"text_only"}};sheetMenu.showMenu("accountlinkMenu",e,t)}function showSheetOptions(e){var t=[];-1!=e.indexOf("KeyboardShortcuts")&&t.push({data:"{label:'"+jsMsg.KeyboardShortcuts+"',appData:{dynamic:true, callback: 'window.open', arg:'"+jsMsg.KeyboardShortcutsURL+"'}}"}),-1!=e.indexOf("NewFeatures")&&t.push({data:"{label:'"+jsMsg.NewFeatures+"',appData:{dynamic:true, callback: 'window.open', arg:'"+REBRAND_URLS.NewFeaturesURL+"'}}"}),-1!=e.indexOf("Help")&&t.push({data:"{label:'"+jsMsg.SettingMenuHelp+"',appData:{dynamic:true, callback: 'window.open', arg:'"+REBRAND_URLS.SettingMenuHelpUrl+"'}}"}),-1!=e.indexOf("TranslationTool")&&t.push({data:"{label:'"+jsMsg.TranslationTool+"',appData:{dynamic:true, callback: 'window.open', arg:'https://"+jsMsg.DomainTranslateSheetZohoCom+"/'}}"}),(-1!=e.indexOf("Forums")||-1!=e.indexOf("Blogs")||-1!=e.indexOf("Feedback"))&&t.push({mtype:"separator"}),-1!=e.indexOf("Forums")&&t.push({data:"{label:'"+jsMsg.Forums+"',appData:{dynamic:true, callback: 'window.open', arg:'"+REBRAND_URLS.ForumsURL+"'}}"}),-1!=e.indexOf("Blogs")&&t.push({data:"{label:'"+jsMsg.Blogs+"',appData:{dynamic:true, callback: 'window.open', arg:'"+REBRAND_URLS.BlogsURL+"'}}"}),-1!=e.indexOf("Feedback")&&t.push({data:"{label:'"+jsMsg.Feedback+"',appData:{dynamic:true, callback: 'Feedback.showdialog'}}"});var a={target:$("#sheetOptions"),clearcache:!1,menuoptions:{type:"text_only"}};sheetMenu.showMenu("settingsMenu",t,a);var s=$("#settingsMenu").offset().left;$("#settingsMenu").css("left",s+10+"px")}function updateDocName(e){DOCUMENT_NAME=e,$("#fileName").zfilefield("rename",escapeSpecialCharacters(e)),updateDocTitle(e)}function getUsrName(e){var t="";if(0==SHAREDUSERSLIST.length)return t=LOGINNAME;for(var a=0;a<SHAREDUSERSLIST.length;a++){var s=SHAREDUSERSLIST[a],o=s.zuid;if((null==o||""==o||-1==o)&&(o=s.uname),e==o){t=s.dname;break}}return t}function isNewSave(e,t,a,s,o){var n="";if(n+=o?"action=saveAs":"action=isNewSave",null==a||""==a.trim())return!1;n+="&bookName="+encodeURIComponent(a),"undefined"!=typeof s&&null!=s&&(n+="&handbackId="+s),n+="&doc="+REMOTE_ENC_DOC_ID;var i=new getXmlhttp;i.open("POST",ctxpath+"remoteAction.do",!0),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var t=i.responseXML;if(t){var a=t.firstChild.childNodes[0].childNodes[0].nodeValue,s=t.firstChild.childNodes[1].childNodes[0].nodeValue;o?updateRemoteDocName(a,e,s,!0,!0):updateRemoteDocName(a,e,s,!0)}}},i.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),i.send(n)}function updateRemoteDocName(e,t,a,s,o){DOCUMENT_NAME=e?e:DOCUMENT_NAME,$("#sp_docName").text(DOCUMENT_NAME);var n=0;$("#topBand").find("ul").length>0&&(n=$("#topBand").find("ul").first().offset().left-($("#docnamepart").offset().left+$("#docnamepart").width())),n>480?$("#ellipsis").removeClass("ui-zellipsis-gradient"):$("#ellipsis").addClass("ui-zellipsis-gradient");var i=getObj("sp_docName");null!=i&&(i.innerHTML=ZSEC.Encoder.encodeForHTML(DOCUMENT_NAME)+(0==a.indexOf(".")?ZSEC.Encoder.encodeForHTML(a):"."+ZSEC.Encoder.encodeForHTML(a)),i.setAttribute("docname",ZSEC.Encoder.encodeForHTMLAttribute(DOCUMENT_NAME)),i.title=ZSEC.Encoder.encodeForHTMLAttribute(DOCUMENT_NAME)),i=null,updateDocTitle(DOCUMENT_NAME.trim(),a),a=null,SAVED=!1,s&&(o?saveremoteGEdoc(t,a,!0):saveremoteGEdoc(t,a)),ISGEEDITOR&&doFileNameUpdatePost()}function getSaveDialogHTML(){var e="";return e+="<div><div class='divSpacing'>"+jsMsg["PromptMsg.SpreadsheetName"]+"</div>",e+="<input type='text' id='save_docName' value='"+jsMsg.Untitled+"' maxlength='250' style='width:98%' class='textField'/></div>"}function saveNewDoc(e){var t=getObj("save_docName");e&&(t=getObj("saveAsFileName"));var a=t.value;return""==a.trim()||null==a?(showAlertDialog(jsMsg["InvalidMsg.SpreadsheetName"]),e&&(t.value=DOCUMENT_NAME),t.focus(),t.select(),!1):(sheetdialog.close(),void(e?isNewSave(null,null,a,null,!0):isNewSave(null,null,a)))}function editMode_disableButtons(){var e=getObj("td_redo");btnState=null!=e?e.getAttribute("icondisabled"):!1,toggleREDO()}function editMode_enableButtons(){null!=btnState&&"false"===btnState&&toggleREDO(),btnState=null}function isDocSaved(){return SAVED||null==AUTO_SAVED?!0:!1}function getCommentCalloutPropertyValues(){cellCommentContent=getObj("cellCommentCalloutContent"),null!=cellCommentContent&&(defaultCalloutContentWidth=getCurrentStyle(cellCommentContent,"width"),defaultCalloutContentMinheight=getCurrentStyle(cellCommentContent,"minHeight"))}function getColorCode(e){return userColorCode[e]||(userColorCode[e]=USERPRESENCE_COLORS[Object.keys(userColorCode).length]),userColorCode[e]}function setProgressMessage(e,t){var a=getObj("loading");a&&(e?($("#loading").hasClass("updatingmsg")&&$("#loading").removeClass("updatingmsg"),$("#loading").addClass("savingmsg"),a.innerHTML=t?ZSEC.Encoder.encodeForHTML(e):ZSEC.Encoder.encodeForHTML(e)+"..."):a.innerHTML=jsMsg.Updating+"...")}function showProgressMessage(e,t){var a=getObj("loading");ENABLE_SAVE_MESSAGE?"Saving"!=e?a&&(a.style.display="block",e&&(a.innerHTML=ZSEC.Encoder.encodeForHTML(e)+"..."),t&&setTimeout(function(){hideProgressMessage()},3e3),showPrevMessage=!0,PREVIOUS_MESSAGE=a.innerHTML):showSaveMessage("enable"):a&&(a.style.display="block",e&&(a.innerHTML=ZSEC.Encoder.encodeForHTML(e)+"..."),t&&setTimeout(function(){hideProgressMessage()},3e3),showPrevMessage=!0,PREVIOUS_MESSAGE=a.innerHTML)}function showSuccessMessage(e){var t=getObj("loading");t.style.display="block",e&&(t.innerHTML=ZSEC.Encoder.encodeForHTML(e),setTimeout(hideProgressMessage,1e3))}function hideProgressMessage(){var e=getObj("loading");e&&($("#loading").hasClass("savingmsg")&&$("#loading").removeClass("savingmsg"),$("#loading").addClass("updatingmsg"),e.style.display="none",e.innerHTML=jsMsg.Updating+"...",PREVIOUS_MESSAGE="",showPrevMessage=!1),ENABLE_SAVE_MESSAGE&&showSaveMessage("disable")}function loadRemoteDocument(){message(jsMsg.Loading,"block","...");var e=new getXmlhttp;e.onreadystatechange=function(){if(4==e.readyState){var t,a;t=sheetObjectsPane.getElementsByTagName("IMG");for(a in t)/ExcelGraph.*/gi.test(t[a].id)&&sheetObjectsPane.removeChild(t[a]);removeXTiles(getAvailableStartRow(),getAvailableEndRow(),"UNLOADED_PAGE"),loadXTileIfVacantInViewPort(),getCharts(DOCUMENT_ID,CURRSHEETNAME),hideBannerMessage(),isErrorDoc=!1,READ_WRITE=!0,ALLOW_TO_WRITE=!0,message(jsMsg.Loading,"none")}};var t="&doc="+REMOTE_ENC_DOC_ID+"&reconnect=true";postAjax(e,ctxpath+"editor.do",t)}function handleServerError(e,t,a,s){message("","none"),ALLOW_TO_WRITE=!1,a&&(READ_WRITE=!1),allowSheetSwitch=s||!1,t=t||"";var o=t,n=new Array("","");if((jsNEW_DOC_VIEW||jsSHARE_VIEW||jsOPEN_DOC_VIEW)&&DOCUMENT_ID&&""!=DOCUMENT_ID&&(n=new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+'", "", "", "fcl");\' href=\'#\'>',"</a>")),t==showErrorPanelMsg||"serverErrorWithReopen"==t?t=jsMsg.TheServerHasEncounteredProblem+" "+replaceParams(jsMsg["ErrorPanel.reopen"],n):"ConnectionLost"==t&&(t=replaceParams(jsMsg["Error.Connection.Lost"],n)),""!=t&&(btn_disabled(),e=e||"ERROR",showBannerMessage(e,t)),"ERROR"==e){isErrorDoc=!0,document.getElementById("menutabs")&&errorDocMenutab("disable");var i=getObj("addSheetBtn");if(i&&(i.style.visibility="hidden"),ole&&(ole.setObjectProperties("button",{permissions:{isDraggable:!1,isResizable:!1,isEditable:!1}}),ole.setObjectProperties("chart",{permissions:{isDraggable:!1,isResizable:!1,isEditable:!1}}),ole.setObjectProperties("img",{permissions:{isDraggable:!1,isResizable:!1,isEditable:!1}})),""!=COLLAB_ID&&"null"!=COLLAB_ID){Collaboration.quit(COLLAB_ID);var l=COLLAB_ID;resetRTCvariables(),jsSHARE_VIEW&&(COLLAB_ID=l)}if("REMOTE_VIEW"!==DOCUMENT_VIEW){var r=document.createElement("span");r.textContent=jsMsg.ReportTheError,ERROR_TIME=(new Date).toJSON(),$(r).click(function(){Feedback.showdialog(!0)});var c={ZUID:zuid,DOMAIN:document.domain,BUILD_VERSION:BUILD_VERSION,RESOURCE_ID:RESOURCE_ID,URI:window.location.pathname,LAST_REQUESTED_ACTION_CONSTANT:LAST_REQUESTED_ACTION_ID,LAST_EXCECUTED_ACTION_ID:responseManager.getLastExecutedActionId(),LAST_RESPONSE_CODE:RESPONSE_CODE,ERROR_TIME:ERROR_TIME,USER_AGENT:navigator.userAgent,ERROR_MESSAGE:o,DOC_LOCALE:docLocale};c=JSON.stringify(c),sendErrorLog(c)}}}function showBannerMessage(e,t,a,s,o){if(cookieStatusShown)return!1;RTLlang&&($("#bannerCloseBtn").css("float","left"),$("#msgBannerPanel").css("direction","rtl")),getObj("bannerCloseBtn").style.display="undefined"!=typeof a?a?"":"none":"WARNING"==e||"INFO"==e?"":"none";var n=getObj("msgBannerPanel");n.style.height="100%",getObj("bannerMessage").innerHTML=t;var i=getObj("msgBanner"),l=getObj("bannerErrorIcon"),r=getObj("bannerWarningIcon"),c=getObj("bannerInfoIcon");l.style.display="none",r.style.display="none",c.style.display="none","ERROR"==e?(l.style.display="",i.className="error",errorMsgShown=!0,responseManager.isDisConnected=!0):"WARNING"==e?(r.style.display="",i.className="warning"):"INFO"==e&&(c.style.display="",i.className="info"),"none"==n.style.display?"undefined"==typeof s||s>0?blindDown("msgBannerPanel",openErrorPanelCallBack,s):n.style.display="":fadeIn(i.id,50),"undefined"!=typeof o&&o()}function showConnectionLostError(e){if(COLLAB_ID&&""!=COLLAB_ID){var t;t=(jsNEW_DOC_VIEW||jsSHARE_VIEW||jsOPEN_DOC_VIEW)&&DOCUMENT_ID&&""!=DOCUMENT_ID&&"doc_id"!=DOCUMENT_ID?replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+'", "", "", "fsm");\' href=\'#\'>',"</a>")):replaceParams(jsMsg["ErrorPanel.ConnectionLost"],new Array("","")),isRegistered=!1,e?handleServerError("ERROR",t,!0,!1):handleServerError("ERROR","ConnectionLost",!0,!1)}}function hideBannerMessage(){getObj("bannerCloseBtn").style.display="none",getObj("msgBannerPanel").style.display="none",resetWorkSheetDim()}function bodyClick(e){if(browser_ie)var t=window.event.srcElement;var t=e.target;if("file"==t.type)return!1;var a=t.id;t==exprField?currFocusFld=exprField:"td_function"==a||"td_function_icon"==a||"td_sum"==a||"td_sum_icon"==a||isExprFunc||"eETable"==a||"eFTC"==a||"eFTE"==a||(currFocusFld="",isEditingInExprField=!1,exprField&&exprField.blur()),isCellFieldSPANHided()&&activateCellField(document.activeElement);var s=$(".ui-zcolorpalette");if(s&&s.is(":visible")){var o=$(t).parent().attr("class");o&&-1==o.indexOf("ui-")&&s.click()}sheetMenu.hideMenu(e)}function bodyMousedown(e){var t;if(browser_ie?(e=window.event,t=e.srcElement):t=e.target,isFilterOptionsDIVOpened){var a=t.id;a&&!(browser_safari||browser_firefox&&a&&-1!=a.indexOf("fo"))&&-1===a.indexOf("fVal")&&-1==t.className.indexOf("zspinner")&&-1==t.id.indexOf("filterSearch")&&Filter.hideFilterOptions()}var s=document.activeElement,o=t.className;if("string"==typeof o&&o.match(/ui-autocomplete/g)){var n=t.nodeName;"UL"===n&&(s.focus(),stopEvt(e))}isVScrollFaceClicked&&t!==ssVScrollbar&&(rowInfoBoxTimeout&&window.clearTimeout(rowInfoBoxTimeout),clearTileLoadTimeout(),hideRowInfoBox(),hideRowInfoLoaderBox(),isVScrollFaceClicked=!1),"undefined"!=typeof snippet&&snippet.hideDesignModeCue(),appEvent.trigger("body.mousedown",[e])}function updateDocTitle(e,t,a){if(!jsGADGET_VIEW){var s=jsMsg.ZohoSheet;e||(e=""),t&&"null"!=t&&(e+=0==t.indexOf(".")?t:"."+t),"NEW_DOC"===a&&(e=jsMsg.Untitled),$("#topband").length>0&&$("#fileName").attr("title",e).text(e),""!=e&&(e+=" - "),document.title=e+s}}function saveAsRemoteDoc(){if("undefined"!=typeof ZohoMockup){var e={};e.olddocid=remoteUserDocId,e.oldfilename=DOCUMENT_NAME,e.docid=DOCUMENT_ID,ZohoMockup.__sendRequest("onSaveAs",e)}else{var t=window.open(ctxpath+"pages/blank.html","saveas operation redirect page","width=500,height=500,scrollbars=yes,toolbar=no,menubar=no");t.moveTo(250,150),t.focus();var a=new getXmlhttp;a.onreadystatechange=function(){if(4==a.readyState){var e=a.responseText;if(null!=e&&""!=e.trim()){var s=JSON.parse(e),o=s.ERROR;if(o)return t.close(),showAlertDialog(o),!1;var n=(s.ZDOCID,s.PDOCID,s.SAVE_AS_URL);t.location.href=n}}};var s="remoteBookId="+DOCUMENT_ID+"&isDocSaved="+isDocSaved();postAjax(a,ctxpath+"remoteduplicate.do",s)}}function isValidURL(e){var t="^(?:ht|f)tp(s?)://[0-9a-zA-Z]([-.w]*[0-9a-zA-Z])*(:(0-9)*)*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_()]*)?$",a=e.match(t);return null==a?!1:!0}function getServerPath(){var e=location.protocol+"//"+location.hostname,t=location.port;return""!=t&&443!=t&&(e+=":"+t),e}function updateSaveToolTip(e,t){var a=getObj("save_message_display");if(ENABLE_SAVE_MESSAGE&&a){{var s;a.getAttribute("lastUpdatedTime")}s=void 0!=t&&LOGINNAME!=t?replaceParams(jsMsg["Save.Message.LastModifiedBy"],new Array(t,e)):replaceParams(jsMsg["Save.Message.LastModifiedByYou"],new Array(e));var o=a.getElementsByTagName("img");o.length>0?o[0].title=s:a.innerHTML+="<img alt='im' src='"+IMAGE_PATH+"info_save.png' style='margin-left:6px' title='"+s+"'/>"}}function createNewDocument(e,t){var a={service:"zohosheet",parentid:"-1"};e&&(a.type=e),t&&(a.filename=t),window.open("https://"+DOCS_SERVER_URL+"/createnew.do?"+$.param(a),"_blank")}function setDocumentName(){sbRenameDocumentOrTemplate()}function sbRenameDocumentOrTemplate(e){sbFname=e;var t={width:327,modal:!0,title:jsMsg.Rename,buttons:[{text:jsMsg.OK,class:"ui-zbutton-primary",click:function(){renameDocument()}},{text:jsMsg.Cancel,click:function(){sheetdialog.close()}}]};sheetdialog.open("renamedialog",t,{init:function(){setTimeout(function(){sbRenameDocumentOrTemplateCallback()},200)}})}function sbRenameDocumentOrTemplateCallback(){positionDialog(),getObj("saveAsDocOrTempFileName")&&(getObj("saveAsDocOrTempFileName").value=null!=getObj(sbFname)?getObj(sbFname).value:DOCUMENT_NAME,getObj("saveAsDocOrTempFileName").focus(),getObj("saveAsDocOrTempFileName").select()),sbFname=""}function openPublicView(){window.open(publicURL)}function setFileNameMaxWidth(){if($("#topBand").length>0){var e=jQuery(window).width()-jQuery("#toplinkspart ul").width()-jQuery("#logopart").width()-jQuery("#docstausicons").width()-jQuery("#ellipsis").width()-jQuery("#topdocsep").width()-Math.round(screen.width/5)-jQuery("#loading").width(),t=0;null!=jQuery("#toplinkspart ul").offset()&&(t=jQuery("#toplinkspart ul").offset().left),jsPUBLIC_VIEW&&jQuery("#sp_docName").css("max-width",e-jQuery("#pubdoc").width()-jQuery("#ellipsis").width()),jQuery("#fileName").css("max-width",e),jQuery("#sp_docName").css("max-width",e)}}function showSaveMessage(e,t){var a=getObj("save_message_display");if(ENABLE_SAVE_MESSAGE&&a&&ALLOW_TO_WRITE){var s,o,n=a.getElementsByTagName("img"),i="";n.length>0&&(i=n[0]),a.style.display="block","disable"!=e||isNewDoc?"enable"==e?a.innerHTML=jsMsg.Saving+"...":"disable"==e&&isNewDoc?"saved"==updatedSaveTime&&(t&&(s=t[JSONConstants.TIME_STAMP]),o=formatTimeForSaveMsg(s),a.innerHTML=replaceParams(jsMsg["Save.Message.SavedAt"],new Array(" "+o))):a.style.display="none":""==updatedSaveTime&&getObj("lastSavedDateTime")?a.innerHTML=getObj("lastSavedDateTime").value:"saved"==updatedSaveTime&&(t&&(s=t[JSONConstants.TIME_STAMP]),o=formatTimeForSaveMsg(s),a.innerHTML=replaceParams(jsMsg["Save.Message.SavedAt"],new Array(" "+o)),""!=i&&(a.innerHTML+=i))}}function showFBTopBand(){if(window.top!=window.self){var e=getObj("topPanel");e.style.display="none"}else{var t=getObj("showfbbanneriframe");t&&(t.src=window.location.protocol+"//"+window.location.host+docs_url)}var a=getObj("topBand");if(a){a.style.marginTop="1px",a.style.marginRight="0px",a.style.marginBottom="-1px",$("#sheetOptions").css({marginTop:"-3px"}),a.style.marginLeft="0px";var s=$("#docnamepart");s.css("margin-left","1px"),s.css("margin-top","2px"),s.css("margin-bottom","2px")}}function startCountDown(){$("#cntDwn").html(count),0>=count&&(sheetdialog.close(),document.location.href=location.href),count--}function saveasdialog(e){var t="saveasdialog",a=jsMsg.SaveAs,s={init:function(){$("#saveAsFileName").val(replaceParams(jsMsg.CopyOfName,new Array(DOCUMENT_NAME))),$("#saveAsFileName").select()}};e="string"==typeof e?e.toBoolean():e,e&&(t="saveastemplatedialog",a=jsMsg["Dialog.SaveAsTemplate"],s={init:function(){setTimeout(function(){$("#saveAsTemplateMenuFileName").val(DOCUMENT_NAME),$("#saveAsTemplateMenuFileName").select()},200)}});var o={title:a,minHeight:10,modal:!0,buttons:[{text:jsMsg.Save,class:"ui-zbutton-primary",click:function(){e?Template.saveAsTemplate():saveas()}},{text:jsMsg.Cancel,click:function(){sheetdialog.close()}}]};sheetdialog.open(t,o,s)}function loadoff(){hideProgressMessage()}function loadon(){getObj("loading").style.display="block",showPrevMessage=!0,PREVIOUS_MESSAGE=getObj("loading").innerHTML}function showAPIHelper(){return isDevelopmentMode?void showURLInDialog(ctxpath+"devtools/APIHelper.jsp?docid="+DOCUMENT_ID,"status = 1, scrollbars=yes, location = yes, title = 'API Helper' ",positionDialog):!1}function toggleScreenView(){var e=$("#sheetdiv"),t=$("#gridMask"),a={duration:250,easing:"linear",complete:function(){resetSheetDim(),appEvent.trigger("docpanel.resetDim")},step:function(){t.length&&t.css({top:e.offset().top})}};jsVERSION_VIEW?$("#ztb-topband,#versionToolbarDiv").slideToggle(a):$("#ztb-topband,#mainOuterDiv,#topBand").slideToggle(a);var s=$("#customscreenview"),o=$("#fullscreen_close");if(isFullScreen)closeFullscreenNotify(),isFullScreen=!1,$(s).removeClass("sFs");else{var n=(clientWidth-o.outerWidth())/2;o.css("left",n+"px"),o.fadeIn(),fTime=setTimeout(closeFullscreenNotify,1e4),isFullScreen=!0,$(s).addClass("sFs")}}function closeFullscreenNotify(){$("#fullscreen_close").is(":visible")&&($("#fullscreen_close").fadeOut(),window.clearTimeout(fTime))}function pickFromList(){try{if(ProtectedRanges.isCellLocked(currRow,currCol))return;isAutoSuggestMenuOpen=!0,sheetdialog.close(),getSuggestList(currCol)}catch(e){}}function formatTimeForSaveMsg(e){var t=void 0!=e?new Date(e):new Date,a=t.getHours(),s=t.getMinutes(),o="AM";a>=12&&(o="PM",a-=12),0==a&&(a=12),s=10>s?"0"+s:s;var n=a+":"+s+" "+o;return n}function updateDocToGDrive(){var e=new RequestParameters(ActionConstants.GDRIVEDOC_UPDATE);e.setParameters("updateDoc");var t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),message(jsMsg.Saving,"block","..."),t.addEventListener("onComplete",function(){message(jsMsg.Saving,"none")}),t.sendRequest()}function togglefullScreen(){var e=document.location.href;window.open(e,"_blank","fullscreen=yes,location=no, menubar=no, resizable=no,status=no,titlebar=no,toolbar=no")}function updateSheetObjects(e,t,a){if(t){var s=t;WorkSheets.updateSheetNamesList(s),WorkSheets.dom.fill(s[0]);var o=s[1].indexOf(a);o=-1==o?0:o,CURRSHEETNAME=s[0][o],WorkSheets.updateAscActiveSheetName();var n=WorkSheets.getSheetObjByName(CURRSHEETNAME);n.addClass("tabItem selected"),documentBakeStatus.setRenderBake(!0)}appEvent.trigger("PostSheetObjectUpdate")}function removeSheetContextMenu(){for(var e=getObj("sheetsTabTable").getElementsByTagName("TR")[0].cells,t=e.length-1,a=0;t>a;a++){var s=e[a];s.removeAttribute("context"),s.removeAttribute("onmousedown");var o=s.getAttribute("title");s.setAttribute("onclick","versionSheetopen('"+o+"')")}}function fireRegisteredEvent(){if(submitCallBack.action){var e=submitCallBack.args,t=submitCallBack.action,a=window[t];e?a.apply("",e):a.call(),submitCallBack={}}}function isCellRangeContainsValues(e,t,a,s){for(var o=!1,n=e;a>=n;n++)for(var i=t;s>=i;i++){var l=getCell(n,i);if(!l)return!0;if(l.getAttribute("cv"))return!0}return o}function setStatusText(e){getObj("cellStatus").innerHTML=0==e.trim().length?"&nbsp;":e,$("#cellStatus").show()}function sendDocInMail(){var e=new RequestParameters(ActionConstants.SEND_SPREADSHEET_IN_MAIL),t=getMailIdToSend(),a=$("#maildoctype").val(),s=$("#docMesg").html().trim();if(null===t)return $("#emailAlrt").slideDown(),!1;var o=t.split(","),n=null,i=0,l="checked"===$("#sendCopy").attr("checked")?!0:!1,r=null;("tsv"===a||"csv"===a)&&(r=$("#sheetNameSelect").val());for(var c=0;c<o.length;c++)validateEmail(o[c])&&(i+=1,n=null==n?o[c]:n+","+o[c]);if(0===i||o.length!==i)return showAlertDialog(jsMsg.EnterProperEmail),!1;if(i>10)return showAlertDialog(replaceParams(jsMsg.EmailLimitMsg,"10")),!1;"tsv"===a||"csv"===a?(r=$("#sheetNameSelect").val(),e.setParameters(n,a,s,l,r)):e.setParameters(n,a,s,l);var d=new AjaxRequest;d.init("POST",e.getURL(),!0,e.getParametersAsString()),d.addEventListener("onComplete",function(e){var t=parseJSON(e.response);t.status.RESP_CODE?(sheetdialog.close(),InfoBanner.showBanner(jsMsg.EmailSendSuccessMsg,!0,"success"),$("#tokenizer").zautosuggest("refresh")):InfoBanner.showBanner(jsMsg.EmailSendFailureMsg,!0,"error"),$("#sendmailid").val(""),$("#docMesg").val(""),$("#sendDocMsgBox").hide(),$("#maildoctype option:first").attr("selected","selected"),$("#customMsg").show()}),d.sendRequest()}function showSendMail(){sheetdialog.close();var e=new AjaxRequest,t=new RequestParameters(ActionConstants.JSP_SEND_SPREADSHEET_IN_MAIL);t.setParameters(CURRSHEETNAME),e.init("POST",t.getURL(),!0,t.getParametersAsString()),e.addEventListener("onComplete",function(e){var t={width:450,minHeight:0,title:jsMsg.EmailsSpreadsheet,maxHeight:$(window).height()/2,closeOnEscape:!1};sheetdialog.open(e.responseText,t),$("#sheetNameSelect").zcombo("setValue",CURRSHEETNAME),$("#sendmailid").bind("keyup",function(){$(this).val().trim().length>0?$("#hiddenEle").show():$("#hiddenEle").hide()}),contactResp&&$("#tokenizer").zautosuggest({list:contactResp,imageURL:"https://"+jsMsg.DomainContactsZohoCom,keys:{"searchplaceholder.label":jsMsg.EnterEmail}}),$(".ui-zautosuggest-input").on("blur",function(){null!=getMailIdToSend()&&$("#emailAlrt").slideUp()}),$(".ui-zautosuggest-input").keypress(function(){$("#emailAlrt").slideUp()})}),e.sendRequest()}function show(){$("#sendDocMsgBox").show(),$("#customMsg").hide()}function validateEmail(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function showHideSheetNameDiv(){var e=$("#maildoctype").val();"csv"===e||"tsv"===e?($("#sheetnamezombo").show(),$("#sheetNameSelect").val(CURRSHEETNAME)):$("#sheetnamezombo").hide()}function toggleMsgBox(){$(".emailMsg").toggle(),$(".emailMsg").is(":visible")?($("#showHideMsg").removeClass("sDO"),$("#showHideMsg").addClass("sAO")):($("#showHideMsg").removeClass("sAO"),$("#showHideMsg").addClass("sDO"))}function showMailSending(){$("#senddocmailmsgdiv").dialog({modal:!0,resizable:!1,minHeight:85,width:330,open:function(){$(".ui-dialog-titlebar").hide()}})}function getSharedUser(){var e=new RequestParameters(ActionConstants.GET_SHARED_USER);if(contactResp)showSendMail();else{var t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),t.addEventListener("onComplete",function(e){contactResp=JSON.parse(e.response),showSendMail()}),t.sendRequest()}}function getMailIdToSend(){var e=$("#tokenizer").zautosuggest("getData"),t=$("#tokenizer").zautosuggest("getData").length,a=null;for(i=0;t>i;i++)a=null===a?e[i].email.trim():a+","+e[i].email.trim();return a}function toggleMsgBox(){$(".emailMsg").slideToggle(),$("#showHideMsg").toggleClass("ArrowUp")}function showArrowMark(e,t,a){if(!getObj("tempDivId1")){var s=document.createElement("div");s.setAttribute("id","tempDivId1"),s.setAttribute("class","arw"),document.body.appendChild(s)}var o=$("#tempDivId1");if("show"===e){var n=$(t),i=n.offset().top,l=n.offset().left,r=0,c=0;"commentView"===a?(c=8,r=25):"cmtMoreOptions"===a?(c=2,r=27):"notifySettings"===a&&(c=5,r=23),o.css("top",i+r),o.css("left",l+c),o.show()}else o.hide()}function getCookie(e){var t="; "+document.cookie,a=t.split("; "+e+"=");return 2==a.length?a.pop().split(";").shift():void 0}function sendErrorLog(e){if(e){e="customMessage="+e+"&"+csrfParamName+"="+getCookie("zscookcsr");var t=new getXmlhttp;postAjax(t,ctxpath+"errorlog.do",e)}}function selectedRangeForDialog(){var e=getCellRange();return e=getServerRange(e.startRow,e.startCol,e.endRow,e.endCol),CellUtils.constructCellName(e.startRow,e.startCol,e.endRow,e.endCol,!1,CURRSHEETNAME)}function sendUserPresence(){if(jsPUBLIC_VIEW)return!1;WMSREQ_SEND_COUNT++;var e=getCellRange(),t=zuid,a=LOGIN_FULL_NAME;(REMOTE.ISRMVIEW||-1==zuid||""==zuid)&&(t=RMUSER,a=WebMessanger.getNickName());var s=new RequestParameters(ActionConstants.USER_PRESENCE);"null"===currUserColor&&(currUserColor=null),"number"==typeof t?s.setParameters(CURRSHEETNAME,e.startRow,e.startCol,e.endRow,e.endCol,a,t,currUserColor,isCellEdited(),null):s.setParameters(CURRSHEETNAME,e.startRow,e.startCol,e.endRow,e.endCol,a,null,currUserColor,isCellEdited(),t);var o=new AjaxRequest;o.init("POST",s.getURL(),!0,s.getParametersAsString()),o.addEventListener("onComplete",function(){}),o.sendRequest()}function pivotScrollSheet(e,t,a){pivotScrollSheetVertandHorz(e,t,a)}function pivotScrollSheetVertandHorz(e,t){var a,s,o,n,i,l,r=100,c=1;n=t.position.top,o=t.position.left,0>n?($("#Tv").hide(),a=!0):n>getSheetHeight()&&($("#Tv").show(),s=!0),100>o?i=!0:o>getSheetWidth()&&(l=!0),n||o?(clearInterval(pivotSheetScrollTopId),pivotSheetScrollTopId=setInterval(function(){s&&pivotScrollTB(c,"bottom",e,t),a&&pivotScrollTB(c,"top",e,t),i&&pivotScrollTB(c,"left",e,t),l&&pivotScrollTB(c,"right",e,t)},r)):($("#Tv").show(),clearInterval(pivotSheetScrollTopId))}function pivotScrollTB(e,t,a,s){var o,n,i,l;o=getRowPosInMouseEvent(a),n=getColPosInMouseEvent(a),"top"===t||"bottom"===t?i=getRowHeight(o):l=getColWidth(n);var r=getCell(o,n);if(r){var c=$(r).offset().left-$("#sheet").offset().left,d=$(r).offset().top-$("#sheet").offset().top;if($(s).css("left",c-1),$(s).css("top",d),$(s).css("height:",i,"countToScrollWidth:",l),pvtDragRowNo=o,pvtDragColNo=n,"bottom"===t)setScrollTop($("#ssVScrollbar").scrollTop()+i);else if("top"===t){var u=$("#ssVScrollbar").scrollTop()-i;0>u&&($("#Tv").show(),clearInterval(pivotSheetScrollTopId)),setScrollTop($("#ssVScrollbar").scrollTop()-i)}else if("left"===t){var g=$("#ssHScrollbar").scrollLeft()-l;0>g&&(g=0),setScrollLeft(g)}else"right"===t&&setScrollLeft($("#ssHScrollbar").scrollLeft()+l)}}function closePivotEnlargeView(e){e=e||window.event,27==e.keyCode&&($("#rPtMd").remove(),$(document).unbind("keydown",closePivotEnlargeView))}function editExploreSource(e){if("edit"===e)$(".pivotRecContainer #expSrc").addClass("editRange"),$("#expCellRef").prop("disabled",!1),$("#expCellRef").focus();else{if("save"===e){$("#explPrevSrcRng").text($("#expCellRef").val());var t=$("#expCellRef").val(),a=CellUtils.getRangeFromCellLbl(t);recPivotList.remove("temp");var s={sasn:a.asn,ssr:a.startRow,ssc:a.startCol,ser:a.endRow,sec:a.endCol};PivotUtil.openRecommended(!0,!1,s)}else"cancel"===e&&$("#expCellRef").val($("#explPrevSrcRng").text());$(".pivotRecContainer #expSrc").removeClass("editRange"),$("#expCellRef").prop("disabled",!0),RangeSelector.off()}}function editExploreSourceRange(e){FOCUSSEDNAMEINPUTOBJECT=e;var t=e;RangeSelector.on({el:t,isAbsoluteRef:!1,appendSheetName:!0,allowSheetSwitch:!0,directInput:!0})}function showCopyPasteWidget(e,t,a,s,o,n){var i=!1;hideCopyPasteWidget(),WMSREQ_SEND_COUNT++,copyPasteDim=getCellRangeDIM(e,t,a,s),setTimeout(function(){var o=calWidgetPos(e,a,t,s,copyPasteDim);if(boxLeft=o.boxLeft,boxTop=o.boxTop,applyPosToWidget(boxLeft,boxTop),isCopyPasteWidgetPresent=!0,ISFREEZED){var n=getPaneId(e,t);a+1>FREEZED_ROW&&s+1>FREEZED_COL&&(i=!0),"sP"==n&&i&&$("#cWsP").show()}else $("#cWsP").show()},500),constructMenuLayout(o,n,".cW button",e,t,a,s),commonWidgetEl=$("#commonWidget"),commonWidgetEl.bind("menubeforeshow",function(){showRecastMenu(copyPasteDim,e,t,i)});getCellRange();appEvent.on("grid.cellFieldKeyDown",function(e){var t=e.keyCode;isWidgetCreated=!1,27===t&&($(".cW").hide(),isCopyPasteWidgetPresent=!1,$(".recastHighlight").hide())}),appEvent.on("execute.OnGridAction",function(e,t){"gridaction"===e&&parseInt(t)!==ActionConstants.RECAST?($(".cW").hide(),isCopyPasteWidgetPresent=!1,$(".recastHighlight").hide()):widgetScroll("manuallyNotScrolled")}),appEvent.on("grid.mousedown",function(){$(".recastHighlight").hide()}),appEvent.on("book.onbeforesheetswitch",function(){$(".cW").hide(),isCopyPasteWidgetPresent=!1,$(".recastHighlight").hide()}),copyPastePos={sR:e,sC:t,eR:a,eC:s}}function calcRangeHighlightArea(){var e=copyPastePos.sR,t=copyPastePos.sC,a=copyPastePos.eR,s=copyPastePos.eC,o=getCellRangeDIM(e,t,a,s);$(".recastHighlight").css("width",o.width),$(".recastHighlight").css("height",o.height+1),$(".recastHighlight rect").attr("width",o.width-1.2),$(".recastHighlight rect").attr("height",o.height-1)}function showRecastMenu(e,t,a,s){var o=e.left-1,n=e.top-1;if(ISFREEZED){var i=parseInt($("#sP2").css("height")),l=parseInt($("#sP3").css("width")),r=getPaneId(t,a);"sP1"==r&&s?($("#recastHlt1").css("left",o),$("#recastHlt1").css("top",n),$("#recastHlt2").css("left",o-l),$("#recastHlt2").css("top",n),$("#recastHlt3").css("left",o),$("#recastHlt3").css("top",n-i),$("#recastHlt").css("left",o-l),$("#recastHlt").css("top",n-i),calcRangeHighlightArea(),$(".recastHighlight").show()):"sP2"==r&&s?(1==FREEZED_ROW&&0==FREEZED_COL?($("#recastHlt2").css("left",o),$("#recastHlt2").css("top",n),$("#recastHlt").css("left",o),$("#recastHlt").css("top",n-i)):($("#recastHlt2").css("left",o-l),$("#recastHlt2").css("top",n),$("#recastHlt").css("left",o-l),$("#recastHlt").css("top",n-i)),calcRangeHighlightArea(),$("#recastHlt2").show(),$("#recastHlt").show()):"sP3"==r&&s?(0==FREEZED_ROW&&1==FREEZED_COL?($("#recastHlt3").css("left",o),$("#recastHlt3").css("top",n),$("#recastHlt").css("left",o-l),$("#recastHlt").css("top",n)):($("#recastHlt3").css("left",o),$("#recastHlt3").css("top",n-i),$("#recastHlt").css("left",o-l),$("#recastHlt").css("top",n-i)),calcRangeHighlightArea(),$("#recastHlt3").show(),$("#recastHlt").show()):"sP"==r&&s&&($("#recastHlt").css("left",o-l),$("#recastHlt").css("top",n-i),calcRangeHighlightArea(),$("#recastHlt").show())}else $("#recastHlt").css("left",o),$("#recastHlt").css("top",n),calcRangeHighlightArea(),$(".recastHighlight").show()}function hideCopyPasteWidget(){$("#cWsP").is(":visible")&&$("#cWsP").hide()}function widgetScroll(e){if(isCopyPasteWidgetPresent){var t=copyPastePos.sR,a=copyPastePos.sC,s=copyPastePos.eR,o=copyPastePos.eC;"manuallyNotScrolled"!=e&&($("#commonWidget").hide(),$(".cW").removeClass("ui-state-open"));var n=calWidgetPos(t,s,a,o,copyPasteDim);n&&(boxLeft=n.boxLeft,boxTop=n.boxTop,applyPosToWidget(boxLeft,boxTop),calcRangeHighlightArea())}}function applyPosToWidget(e,t){0>=t&&(t=0),0>=e&&(e=1),isRTL?$(".cW").css("right",e-5+"px"):$(".cW").css("left",e-1+"px"),$(".cW").css("top",t-1+"px")}function calWidgetPos(e,t,a,s){var o,n,i,l,r,c,d,u,g,p,f,h=$("#cWsP").outerWidth(),m=$("#cWsP").outerHeight(),E=$("#sheet").offset().top,v=$("#sheet").offset().left,C=$("#sheet").width(),S=$("#sheet").height(),T=getBoundaryRowInViewPort(),b=getBoundaryColInViewPort(),O=T.firstRow-1,M=T.lastRow-1,I=b.firstCol-1,A=b.lastCol-1,R=!1;if(i=getCell(e,a),l=getCell(e,s),r=getCell(t,a),c=getCell(t,s),d=$(c).offset(),botLeftCellOffset=$(r).offset(),topLeftCellOffset=$(i).offset(),topRightCellOffset=$(l).offset(),p=parseInt($(c).css("width")),f=parseInt($(c).css("height")),botLeftCellWidth=parseInt($(r).css("width")),botLeftCellHeight=parseInt($(r).css("height")),topLeftCellWidth=parseInt($(i).css("width")),topLeftCellHeight=parseInt($(i).css("height")),topRightCellWidth=parseInt($(l).css("width")),topRightCellHeight=parseInt($(l).css("height")),c&&(u=d.top-E,g=d.left-v),r&&(botLeftCellOffsetTop=botLeftCellOffset.top-E,botLeftCellOffsetLeft=botLeftCellOffset.left-v),i&&(topLeftCellOffsetTop=topLeftCellOffset.top-E,topLeftCellOffsetLeft=topLeftCellOffset.left-v),l&&(topRightCellOffsetTop=topRightCellOffset.top-E,topRightCellOffsetLeft=topRightCellOffset.left-v),threeStatePosition){if(S-(u+f+m)>=0&&C-(g+p+h)>=0?(o=g+p+v,n=u+f+E):R=!0,R){if(A>s&&t>=M){var y=getCell(M-1,s);y&&(o=$(y).offset().left+parseInt($(y).css("width")),n=E+S-m)}else if(A>s&&M>t){var y=getCell(t,s);y&&(o=$(y).offset().left+parseInt($(y).css("width")),n=$(y).offset().top+parseInt($(y).css("height"))-m)}else if(s>=A&&t>=M)o=v+C-h,n=E+S-m;else if(s>=A&&M>t){var y=getCell(t,A);y&&(o=v+C-h,n=$(y).offset().top+parseInt($(y).css("height"))-m)}R=!1}if(O>e&&O>t&&(I>=a||a>I)&&(A>=s||s>A))$("#cWsP").hide();else if((e>O||O>=e)&&(M>=t||t>M)&&a>A&&s>A)$("#cWsP").hide();else if(e>M&&t>M&&(I>=a||a>I)&&(A>=s||s>A))$("#cWsP").hide();else if(I>a&&I>s&&(e>O||O>=e)&&(M>=t||t>M))$(".cW").hide();else{if(n+$("#cWsP").outerHeight()>E+S){var w=n+$("#cWsP").outerHeight()-(E+S);n-=w}else if(E>n){var w=E-n;n+=w}if(o+$("#cWsP").outerWidth()>v+C){var w=o+$("#cWsP").outerWidth()-(v+C);o-=w}else if(v>o){var w=v-o;o+=w}$("#cWsP").show()}}else{if(c&&M>t?S-(u+f+m)>=0&&C-(g+p+h)>=0?(o=g+p+v,n=u+f+E):S-(u+f+m)>=0&&0>=C-(g+p+h)?(o=C+v-h,n=u+f+E):S-u>=0&&C-(g+p+h)>=0?(o=g+p+v,n=u+E):R=!0:r&&M>=t&&a>I?botLeftCellOffsetLeft+h-v>=0&&botLeftCellOffsetTop+botLeftCellHeight-S>=0?(o=botLeftCellOffsetLeft+v-h,n=botLeftCellOffsetTop+E):R=!0:i&&e>O&&a>I?topLeftCellOffsetLeft+h-v>=12&&topLeftCellOffsetTop>=0?(o=topLeftCellOffsetLeft+v-h,n=topLeftCellOffsetTop+E):topLeftCellOffsetTop>=m&&topLeftCellOffsetLeft+topLeftCellWidth>=0?(o=v,n=topLeftCellOffsetTop+E-m):R=!0:l&&e>O?topRightCellOffsetTop>=m?0>=C-(topRightCellOffsetLeft+topRightCellWidth)?(o=v+C-h,n=topRightCellOffsetTop+E-m):(o=topRightCellOffsetLeft+topRightCellWidth+v-h,n=topRightCellOffsetTop+E-m):C-(topRightCellOffsetLeft+topRightCellWidth+h)>=0&&topRightCellOffsetTop>=0?(o=topRightCellOffsetLeft+topRightCellWidth+v,n=topRightCellOffsetTop+E):R=!0:R=!0,R){if(A>s&&t>=M){var y=getCell(M-1,s);o=$(y).offset().left+parseInt($(y).css("width"))-h,n=E+S-m}else if(s>=A&&t>=M)o=v+C-h,n=E+S-m;else if(s>=A&&M>t){var y=getCell(t,A);o=$(y).offset().left,n=$(y).offset().top+parseInt($(y).css("height"))}R=!1}if(O>e&&O>=t&&(I>=a||a>I)&&(A>=s||s>A))$("#cWsP").hide();else if((e>O||O>=e)&&(M>=t||t>M)&&a>A&&s>A)$("#cWsP").hide();else if(e>=M&&t>M&&(I>=a||a>I)&&(A>=s||s>A))$("#cWsP").hide();else if(I>a&&I>s&&(e>O||O>=e)&&(M>=t||t>M))$("#cWsP").hide();else{if(n+$("#cWsP").outerHeight()>E+S){var w=n+$("#cWsP").outerHeight()-(E+S);n-=w}else if(E>n){var w=E-n;n+=w}if(o+$("#cWsP").outerWidth()>v+C){var w=o+$("#cWsP").outerWidth()-(v+C);o-=w}else if(v>o){var w=v-o;o+=w}$("#cWsP").show()}}return{boxLeft:o,boxTop:n}}function constructCopyPasteMenuLayout(e,t,a,s,o,n,i,l){if("undefined"!=typeof isWidgetCreated&&!isWidgetCreated){for(var r=[],c=0;c<l.length;c++)r.push({id:l[c].format,data:'{"label":"'+l[c].title+'","appData":{"callback": "'+l[c].callBack+'",arg:"'+e+","+t+","+l[c].format+","+s+","+o+","+n+","+i+'"}}'});var d={target:$(a),clearcache:!0,menuoptions:{}};sheetMenu.showMenu("commonWidget",r,d),sheetMenu.hideOpenedMenu(),isWidgetCreated=!0}}function constructMenuLayoutOptions(e,t,a,s,o){for(var n=[],i=0;i<e.length;i++)n.push({id:e[i][a],data:'{"label":"'+e[i].title+'","appData":{"callback": "'+e[i].callBack+'",arg:"'+o.toString()+","+e[i][s]+'"}}'});var l={target:$(t),clearcache:!0,menuoptions:{}};sheetMenu.showMenu("commonWidget",n,l),sheetMenu.hideOpenedMenu(),isWidgetCreated=!0}function getExtraParamNameForRecast(e){return recastExtraParamMap[e]}function constructMenuLayout(e,t,a,s,o,n,i){var l=fetchWidgetOption(e),r=id=getExtraParamNameForRecast(e),c=[e,t,s,o,n,i];isRecastAction?isRecastAction=!1:constructMenuLayoutOptions(l,a,id,r,c)}function fetchWidgetOption(e){switch(e){case ActionConstants.SYSTEMCLIP_PASTE:return fetchSystemClipPasteWidgetOptions();case ActionConstants.COPY_PASTE:return fetchCopyPasteWidgetOptions();case ActionConstants.INSERT_ROW:return fetchInsertRowStyleWidgetOptions();case ActionConstants.INSERT_COL:return fetchInsertColumnStyleWidgetOptions();case ActionConstants.INSERT_CELL_LEFT:case ActionConstants.INSERT_CELL_TOP:return fetchInsertCellStyleWidgetOptions();case ActionConstants.FILLSERIES:return fetchFillSeriesWidgetOptions()}}function fetchFillSeriesWidgetOptions(){var e=[],t={title:jsMsg["FillSeries.CopyCells"],callBack:"alterFillSeriesType",fst:"FILL_COPY"},a={title:jsMsg["FillSeries.Default"],callBack:"alterFillSeriesType",fst:"FILL_DEFAULT"},s={title:jsMsg["FillSeries.FillFormats"],callBack:"alterFillSeriesType",fst:"FILL_FORMATS"},o={title:jsMsg["FillSeries.FillWithOutFormats"],callBack:"alterFillSeriesType",fst:"FILL_EXCEPT_FORMATS"};return e.push(t),e.push(a),e.push(s),e.push(o),e}function fetchInsertRowStyleWidgetOptions(){var e=[],t={title:jsMsg["InsertRow.PreviousStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_PREVIOUSCELL_STYLE},a={title:jsMsg["InsertRow.NextStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_NEXTCELL_STYLE},s={title:jsMsg["InsertRow.NoStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_NOSTYLE};return e.push(t),e.push(a),e.push(s),e}function fetchInsertCellStyleWidgetOptions(){var e=[],t={title:jsMsg["InsertCell.PreviousStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_PREVIOUSCELL_STYLE},a={title:jsMsg["InsertCell.NextStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_NEXTCELL_STYLE},s={title:jsMsg["InsertCell.NoStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_NOSTYLE};return e.push(t),e.push(a),e.push(s),e}function fetchInsertColumnStyleWidgetOptions(){var e=[],t={title:jsMsg["InsertColumn.PreviousStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_PREVIOUSCELL_STYLE},a={title:jsMsg["InsertColumn.NextStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_NEXTCELL_STYLE},s={title:jsMsg["InsertColumn.NoStyle"],callBack:"alterStyleAction",style:ActionConstants.INSERTMODE_COPY_NOSTYLE};return e.push(t),e.push(a),e.push(s),e}function fetchSystemClipPasteWidgetOptions(){var e=[],t={title:jsMsg.CopyPasteMatchWithSource,callBack:"alterSystemCopyPasteAction",format:"source_format"};e.push(t);var a={title:jsMsg.CopyPasteMatchWithDestination,callBack:"alterSystemCopyPasteAction",format:"destination_format"};return e.push(a),e}function fetchCopyPasteWidgetOptions(){var e=[{title:jsMsg["MenuItem.HomeTab.Paste.All"],pstype:"ALL"},{title:jsMsg["MenuItem.HomeTab.Paste.Values"],pstype:"VALUES"},{title:jsMsg["MenuItem.HomeTab.Paste.Formats"],pstype:"FORMATS"},{title:jsMsg["MenuItem.HomeTab.Paste.Formulas"],pstype:"FORMULAS"},{title:jsMsg["MenuItem.HomeTab.Paste.Notes"],pstype:"COMMENTS"},{title:jsMsg["MenuItem.HomeTab.Paste.ValuesAndNumberFormats"],pstype:"VALUES_AND_NUMBERFORMATS"},{title:jsMsg["MenuItem.HomeTab.Paste.FormulasAndNumberFormats"],pstype:"FORMULAS_AND_NUMBERFORMATS"},{title:jsMsg["MenuItem.HomeTab.Paste.AllExceptNotes"],pstype:"ALL_EXCEPT_COMMENTS"},{title:jsMsg["MenuItem.HomeTab.Paste.AllExceptBorders"],pstype:"ALL_EXCEPT_BORDERS"},{title:jsMsg["MenuItem.HomeTab.Paste.Validation"],pstype:"VALIDATION"}],t="alterCopyPasteAction",a=[];return e.forEach(function(e){e.callBack=t,a.push(e)}),a}function updateOption(e,t){var a=$("#"+e);""==widgetprevMenuItemTicked?widgetprevMenuItemTicked=t:$(a).find("#"+widgetprevMenuItemTicked).length&&a.zmenu("changeIcon",widgetprevMenuItemTicked,"ui-zmenu-no-icon"),widgetprevMenuItemTicked=t,a.zmenu("changeIcon",widgetprevMenuItemTicked,"ui-individual-icon ui-icon-ztick")}function alterFillSeriesType(e,t,a,s,o,n,i){var l=[[{sr:a,sc:s,er:o,ec:n}]],r=[[WorkSheets.getAssociatedActiveSheetName()]],c={fst:i,rangeList:l,sheetList:r},d=function(){updateOption("commonWidget",i)};invokeRecastActions(e,t,c,d)}function alterStyleAction(e,t,a,s,o,n,i){var l={style:i,asn:WorkSheets.getAssociatedActiveSheetName(),sr:a,sc:s,er:o,ec:n},r=function(){updateOption("commonWidget",i)};invokeRecastActions(e,t,l,r)}function alterSystemCopyPasteAction(e,t,a,s,o,n,i){var l=[[{sr:a,sc:s,er:o,ec:n}]],r=[[WorkSheets.getAssociatedActiveSheetName()]],c={format:i,rangeList:l,sheetList:r},d=function(){updateOption("commonWidget",i)};invokeRecastActions(e,t,c,d)}function alterCopyPasteAction(e,t,a,s,o,n,i){var l=[[{sr:a,sc:s,er:o,ec:n}]],r=[[WorkSheets.getAssociatedActiveSheetName()]],c={pstype:i,rangeList:l,sheetList:r},d=function(){updateOption("commonWidget",i)};invokeRecastActions(e,t,c,d)}function invokeRecastActions(e,t,a,s){isRecastAction=!0;var o=new RequestParameters(ActionConstants.RECAST),n=new AjaxRequest;o.setParameters(t,e,JSON.stringify(a)),n.init("POST",o.getURL(),!0,o.getParametersAsString()),n.addEventListener("onComplete",function(){void 0!=s&&"function"==typeof s&&s()}),actionManager.addRequest(n)}function getBoundaryRowInViewPort(){var e=getSheetScrollTop(),t=findRowInYPos(e+findThirdPaneYPos())+1,a=findRowInYPos(e+getSheetHeight())+1,s=getRowMax();return t=ISFREEZED?FREEZED_ROW>=t?FREEZED_ROW+1:t:t>0?t:1,a=s>=a?a:s,{firstRow:t,lastRow:a}}function getBoundaryColInViewPort(){var e=getSheetScrollLeft(),t=findColInXPos(e+findSecondPaneXPos())+1,a=findColInXPos(e+getSheetWidth())+1,s=getColMax();return t=ISFREEZED?FREEZED_COL>=t?FREEZED_COL+1:t:t>0?t:1,a=s>=a?a:s,{firstCol:t,lastCol:a}}var add="yes",fname="",isNewVersion=!1,versionLabelName="",lastSavedTime=null,is_shared=!1,panelOpenedFor="",localizedFunctionName="",timeFormat="",image_urls="",updatedSaveTime="",isFromServer=!1,containThousandSeparator=!1,thousandSeparator=null,contactResp=null,onLineStatusTimeOut,sendCustomHeader=!1,isWidgetCreated=!1,isRecastAction=!1,threeStatePosition=!0,recastExtraParamMap={};recastExtraParamMap[ActionConstants.FILLSERIES]="fst",recastExtraParamMap[ActionConstants.SYSTEMCLIP_PASTE]="format",recastExtraParamMap[ActionConstants.COPY_PASTE]="pstype",recastExtraParamMap[ActionConstants.INSERT_ROW]="pstype",recastExtraParamMap[ActionConstants.INSERT_COL]="pstype",recastExtraParamMap[ActionConstants.INSERT_CELL_TOP]="pstype",recastExtraParamMap[ActionConstants.INSERT_CELL_LEFT]="pstype";var fillSeriesType="FILL_DEFAULT",noOfDigits=18,savingInProgress=!1,alphaVal=0,IS_SAVEAS=!1,savingInProgressTimer,publicServer="",myAccountsMenuStatus=!1,btnState=null,cellCommentContent,defaultCalloutContentWidth,defaultCalloutContentMinheight,isErrorDoc=!1,allowSheetSwitch=!1;openErrorPanelCallBack=function(){resetPageDim()};var sbFname,count=15,timer=void 0;InfoBanner={showBanner:function(e,t,a){if(e){$("#notifyMsg").html(e);var s=(findClientDim().width-$("#notifyContainer").width())/2;$("#notifyContainer").css({left:s,position:"absolute",top:"-2px","z-index":"1100"}).show(),InfoBanner.setClasses(a),t&&setTimeout(function(){InfoBanner.hideBanner()},5e3)}},setClasses:function(e){if(e){$("#notifyContainer").removeClass(),$("#notifyIcon").removeClass();var t="ui-corner-all ui-znotifier",a="ui-components-icon",s="";switch(e){case"error":t+=" ui-state-error",a+=" ui-state-error-icon";break;case"info":t+=" ui-state-info",a+=" ui-state-info-icon",s+="#AFE1FF";break;case"success":t+=" ui-state-status",a+=" ui-state-status-icon",s+="#D2E9C5";break;case"warning":t+=" ui-state-warning",a+=" ui-state-warning-icon"}$("#notifyContainer").addClass(t),$("#notifyIcon").addClass(a)}},hideBanner:function(){$("#notifyContainer").fadeOut()}},ConfirmBox={cBoxHtml:"",showDialog:function(e,t,a,s){var o={width:"440px",modal:!0,title:e,buttons:[{text:a,class:"ui-zbutton-primary",click:function(){t(),sheetdialog.close()}},{text:s,click:function(){sheetdialog.close()}}]};this.cBoxHtml||(this.cBoxHtml=$("#confirmDialog").html(),$("#confirmDialog").html("")),sheetdialog.open(this.cBoxHtml,o);var n=sheetdialog.getOpenedDialog(),i=n.find(".ui-dialog-buttonset").children("button")[0];i&&i.focus()},setInfoMsg:function(e,t,a,s,o,n){if(e&&$("#msgBox").html(e),t&&($("#infoChkBox").show(),$("#msgBox2").html(t),n&&$("#chkBox").attr("checked",!0)),a){var i=$("#sheetName");i.children("span").text(a),$("#sheetName").show()}s&&$("#dialogCtnr").addClass("thumbnailView"),o&&($("#iconBox").addClass("infoIcon"),$("#msgCtnr").css("marginLeft","40px"))},setWarningMsg:function(e,t,a){e&&$("#msgBox").html(e),t&&($("#dialogCtnr").addClass("warning"),$("#dialogCtnr").css({width:"auto"})),a&&($("#iconBox").addClass("warningSmallIcon"),$("#iconBox").css("marginTop","3px"),$("#msgCtnr").css("marginLeft","30px"))}},Feedback={showdialog:function(e){var t=jsMsg.Feedback,a=jsMsg.SupportMailId;if(("undefined"!=typeof serviceUrl&&serviceUrl.indexOf("localzoho")>-1||e)&&(a="websheet-issues@zohocorp.com"),e&&(t=jsMsg.ReportTheError),$("body").on("zfeedbackopen",function(){if($("#ui-zfeedback-dialog .ui-dialog-titlebar .ui-dialog-title").text(t),e){{window.location.pathname+" - "+("null"===RESOURCE_ID?DOCUMENT_ID:RESOURCE_ID)}$("#zfb-input-message").val($($("#bannerMessage")[0]).text().split(jsMsg.ReportTheError)[0]),$("#zfb-input-message").val('\n"'+$($("#bannerMessage")[0]).text().split(jsMsg.ReportTheError)[0]+'"'),$("#zfb-input-subject").val(jsMsg.ErrorReports)}}),e){var s=zuid+" - "+document.domain+" [ "+BUILD_VERSION+" ] - "+RESOURCE_ID+" [ "+window.location.pathname+" ] - "+LAST_REQUESTED_ACTION_ID+" [ "+responseManager.getLastExecutedActionId()+" ] - [ "+RESPONSE_CODE+" ] ["+ERROR_TIME+" ] ["+docLocale+" ]",o={"Other details":s};ZFeedback.open({formType:t,attachment:!0,screengrabber:!0,criticality:!0,sendTo:a,customHeaders:o})}else ZFeedback.open({formType:t,attachment:!0,screengrabber:!0,criticality:!0,sendTo:a})}};var fTime=0,REMOTE={VIEW:0,EDITVIEW:1,COLLABEDITVIEW:2,COLLABVIEW:3,EDITORVIEW:4,EXCELVIEW:5,SCRATCHVIEW:6,ISVIEW:!1,ISEDIT:!1,ISCOLLABEDITVIEW:!1,ISCOLLABVIEW:!1,ISEDITORVIEW:!1,ISEXCELVIEW:!1,ISSCRATCHVIEW:!1,MODE:void 0,WMSREGISTERREQUIRED:!0,ISEDITABLE:!0,ISSAVEABLE:!1,ISRMVIEW:void 0,init:function(e){switch(this.MODE=e,this.ISRMVIEW=!0,this.MODE){case this.VIEW:this.ISVIEW=!0,this.WMSREGISTERREQUIRED=!1,this.ISEDITABLE=!1;break;case this.EDITVIEW:this.ISEDITVIEW=!0,this.ISSAVEABLE=!0;break;case this.COLLABEDITVIEW:this.ISCOLLABEDITVIEW=!0,this.ISSAVEABLE=!0;break;case this.COLLABVIEW:this.ISCOLLABVIEW=!0,this.ISEDITABLE=!1;break;case this.EDITORVIEW:this.ISEDITORVIEW=!0;break;case this.EXCELVIEW:this.ISEXCELVIEW=!0}}},chatObject=null,lastChatCount=0,onlineStatusUserQueue=[],minChatCount=0,needScrollBottom=!1,collabChat={getChat:function(e,t){needScrollBottom=t,$(".spinner").show();(new Date).getTime();e||(e=50);var a=-1;if(null!==chatObject){if(0==chatObject.chatDetails.length)return!1;$($(".chatTimeStamp")[0]).text()}if($(".chatTimeStamp")[0]&&(a=chatObject.chatDetails[chatObject.chatDetails.length-1].CHAT_CONTENT[chatObject.chatDetails[chatObject.chatDetails.length-1].CHAT_CONTENT.length-1].t),chatObject&&chatObject.lastChatCount&&(lastChatCount=chatObject.lastChatCount),null!==RESOURCE_ID&&"null"!==RESOURCE_ID){var s="rid="+RESOURCE_ID+"&chatCount="+e+"&lastChatTime="+a+"&lastChatCount="+lastChatCount+"&"+csrfParamName+"="+getCookie("zscookcsr");$.post(ctxpath+"chat.do",s).done(function(t){if(chatObject=jQuery.parseJSON(t),null!=chatObject&&chatObject.chatDetails.length>0){{$(".ui-zcollaborator-chatmsg").length}collabChat.updateChatPannel(chatObject.chatDetails,chatObject.totalChat-e,chatObject.userList,chatObject.timeZoneOffset,chatObject.lastChatCount,chatObject.minChatCount)}})}},updateChatPannel:function(e,t,a,s,o,n){var i=((new Date).getTime(),$(".ui-zcollaborator-chatmsg").length,null),l=null,r="00-00-00",c="00:00";$("#morechat").remove();var d=($(".ui-zcollaborator-content")[1].scrollHeight,null),u=!1,g=null,p=null,f=null,h=null;$(".chatTimeStamp")[0]&&(h=$(".chatTimeStamp")[0].id,r=collabChat.checkDate(h,h),c=collabChat.checkTime(h,h));for(var m=!1,E=null,v=0;v<e.length;v++)for(var C=e[v].CHAT_CONTENT.length-1;C>=0;C--)if(E=e[v].CHAT_CONTENT[C].chatid,!($("#"+E).length>0)){{var S=$("<div>"),T=$("<span>"),b=$("<span>"),O=$("<span>"),M=!1;e[v].CHAT_CONTENT[C].uid}if(d=parseFloat(e[v].CHAT_CONTENT[C].t),r!==collabChat.checkDate(r,d)?(r=collabChat.checkDate(r,d),M=!0,u=!0,g=d):c!==collabChat.checkTime(c,d)&&(c=collabChat.checkTime(r,d),M=!0),u){if(null===p)p=collabChat.dateLocaleFormat(g,null,null,null,null,!0),f=g;else{var I=$("<div>");I.addClass("ui-zcollaborator-chatblock");var A=($("<span>"),$("<fieldset>"));A.addClass("cTsD");var R=null;R=$("<legend>"+p+"<legend>"),A.append(R),$($(".ui-zcollaborator-chatblock")[0]).prepend(A),p=collabChat.dateLocaleFormat(g,null,null,null,null,!0),f=g}u=!1}l=-1===e[v].CHAT_CONTENT[C].uid?jsMsg.CollabChatGuest+":":(e[v].CHAT_CONTENT[C].uid===zuid?jsMsg.CollbChatMe:a[e[v].CHAT_CONTENT[C].uid])+" :",T.text(l);var y=encodeURI(e[v].CHAT_CONTENT[C].msg);y.indexOf("%0A")>0&&(y=y.split("%0A").join("<br>")),y=decodeURI(y);var w=LinkMaker.convert(y);if(y=w.msg,w.hasLinkMsg||y.indexOf("script")>-1&&(y=y.replace(/</gm,"&lt;"),y=y.replace(/>/gm,"&gt;")),y=y.replace(/&lt;br&gt;/gm,"\n"),b.html(y),S.addClass("ui-zcollaborator-chatblock"),S.attr("id",E),T.addClass("ui-zcollaborator-username"),b.addClass("ui-zcollaborator-chatmsg"),M){if($(".chatTimeStamp").length>0){var D=new Date(parseFloat($(".chatTimeStamp")[$(".chatTimeStamp").length-1].id)).setHours(0,0,0,0),N=(new Date).setHours(0,0,0,0);D===N&&$(".2Dchat").length>0&&$(".2Dchat").remove()}O.text(collabChat.dateLocaleFormat(h,!1)),O.addClass("chatTimeStamp"),O.attr("id",h),$(".ui-zcollaborator-chatblock")[0]&&0===$($(".ui-zcollaborator-chatblock")[0].childNodes).find("span").length?("cTsD"===$($(".ui-zcollaborator-chatblock")[0].childNodes[0]).attr("class")?"ui-zcollaborator-username"===$($(".ui-zcollaborator-chatblock")[0].childNodes[1]).attr("class")?$($(".ui-zcollaborator-chatblock")[0].childNodes[1]).append(O):$($(".ui-zcollaborator-chatblock")[0].childNodes[1]).prepend(O):"ui-zcollaborator-username"===$($(".ui-zcollaborator-chatblock")[0].childNodes[0]).attr("class")?$($(".ui-zcollaborator-chatblock")[0].childNodes[0]).append(O):$($(".ui-zcollaborator-chatblock")[0]).prepend(O),c=collabChat.checkTime(c,d),h=d):h=d}null!=i&&i!==e[v].CHAT_CONTENT[C].uid?e[v].CHAT_CONTENT[C-1]&&e[v].CHAT_CONTENT[C-1]&&e[v].CHAT_CONTENT[C].uid===e[v].CHAT_CONTENT[C-1].uid?(S.prepend(b),$($(".ui-zcollaborator-content")[1]).prepend(S)):(S.prepend(b),S.prepend(T),$($(".ui-zcollaborator-content")[1]).prepend(S)):(null===i||i===e[v].CHAT_CONTENT[C].uid)&&e[v].CHAT_CONTENT[C-1]&&e[v].CHAT_CONTENT[C].uid===e[v].CHAT_CONTENT[C-1].uid?(S.prepend(b),$($(".ui-zcollaborator-content")[1]).prepend(S)):(S.prepend(b),S.prepend(T),$($(".ui-zcollaborator-content")[1]).prepend(S)),i=e[v].CHAT_CONTENT[C].uid;var L=$($(".ui-zcollaborator-content")[1]).scrollTop()+$($(".ui-zcollaborator-chatblock")[0]).height();$($(".ui-zcollaborator-content")[1]).scrollTop(L)}var _=e[e.length-1].CHAT_CONTENT[0].t,O=$("<span>");if(O.text(collabChat.dateLocaleFormat(_,!1)),O.addClass("chatTimeStamp"),O.attr("id",_),0===$("#"+_).length&&$($(".ui-zcollaborator-chatblock")[0].childNodes[0]).append(O),m=!0,o>0&&o!==n){var P=$("<div id='morechat' style='padding:2px;color:black;'><div class='spinner' style='display:none'><div class='bounce1'></div><div class='bounce2'></div><div class='bounce3'></div></div><div>");$($(".ui-zcollaborator-content")[1]).prepend(P)}else if(0===n||o&&(0>o-5||o-5===0||n===o||0>t)){$($(".ui-zcollaborator-content")[1]).unbind("scroll");var P=$("<div id='morechat' ><div class='cSd'></div></div>");if($($(".ui-zcollaborator-content")[1]).prepend(P),$(".ui-zcollaborator-chatmsg").length>0){var j=collabChat.dateLocaleFormat(parseFloat($(".chatTimeStamp")[0].id),null,null,null,!0);if($("#morechat div").text(replaceParams(jsMsg.CollabChatCoversionInfo,new Array(j))),!m){var O=$("<span>");O.text(collabChat.dateLocaleFormat(d,!1)),O.addClass("chatTimeStamp"),O.attr("id",d),$($(".ui-zcollaborator-chatblock")[0].childNodes[0]).append(O),0===$("#"+d).length&&$($(".ui-zcollaborator-chatblock")[0].childNodes[0]).append(O)}}}$(".2Dchat").length>0&&$(".2Dchat").remove();var L=$($(".ui-zcollaborator-content")[1]).scrollTop()+$($(".ui-zcollaborator-chatblock")[0]).height();$($(".ui-zcollaborator-content")[1]).scrollTop(L),$(".spinner").hide()},checkDate:function(e,t){var a=new Date(t),s=a.getDate()+"-"+a.getMonth()+"-"+a.getYear()%100;return e==s?s:s},checkTime:function(e,t){var a=new Date(t),s=a.getHours()+":"+a.getMinutes();return s},dateLocaleFormat:function(e,t,a,s,o,n,i){var l=null;if(accLocale&&null!==accLocale){var r=accLocale.split("_");l=r[0]+"-"+r[1]}else l=window.navigator.userLanguage||window.navigator.language;var c=null,d=null;c=-1!==e||null!==e?new Date(e):new Date,d=n?{year:"numeric",month:"long",day:"numeric"}:o?{weekday:"short",year:"numeric",month:"short",day:"numeric"}:a?s?i?{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}:{weekday:"short",year:"numeric",month:"short",day:"numeric"}:{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}:{hour:"2-digit",minute:"2-digit"};var u=null;return u=o||n?c.toLocaleDateString(l,d):c.toLocaleTimeString(l,d)},showOnlineStatus:function(){var e=null,t=onlineStatusUserQueue.length;t>0&&(e=onlineStatusUserQueue.pop()),null!=e&&(parseFloat(e.zuid)!==zuid&&($("#userQuitStatus").hide(),$("#connectUserName").text(""),$("#userJoinStatus").show(),$("#connectUserName").text(e.dname)),setTimeout(function(){onlineStatusUserQueue.length>0&&CollabPanel.getActiveCollaborators().length<=10?onLineStatusTimeOut=collabChat.showOnlineStatus():($("#userJoinStatus").hide(),$("#connectUserName").text(""))},collabChat.getTimeOut(t)))},getTimeOut:function(e){var t=1e3;return 1===e?ttimeOut=3e3:e>1&&6>e?t=2500:e>5&&11>e&&(t=2e3),t},isAtBottom:function(){var e=$(".ui-zcollaborator-content")[1],t=e.scrollHeight,a=e.scrollTop,s=t-a,o=$($(".ui-zcollaborator-content")[1]).height();return s===o}},copyPastePos={},copyPasteDim,commonWidgetEl;appEvent.on("sheet.verticallyScrolled",widgetScroll),appEvent.on("sheet.horizontallyScrolled",widgetScroll),NewVersion={enable:function(){var e=csrfParamName+"="+readCookie(csrfCookieName);e+="&action=new_version&subaction=enableNewVersion&value=true",$.ajax({type:"POST",url:ctxpath+"usersettings.do",data:e,success:function(){location.reload()}})}};
function _ole(e,t,o,r,i){if(this.el=getObj(e),this.type=this.el.objType,"chart"===this.type&&(this.isPivotChart=this.el.isPivotChart),this.sheet=CURRSHEETNAME,this.document=DOCUMENT_ID,this.prevStateLeft=o,this.prevStateTop=t,this.id=e,this.height=r?r:parseFloat(this.el.offsetHeight,10),this.width=i?i:parseFloat(this.el.offsetWidth,10),this.top=t?t:parseFloat(this.el.style.top,10),o)this[isRTL?"right":"left"]=o;else{var s=parseFloat(this.el.style.left||this.el.style.right);isRTL?(this.right=s,this.el.style.right=s,$("#"+e).css("right",s),$("#"+e).css("left","")):(this.left=s,this.el.style.left=s,$("#"+e).css("left",s),$("#"+e).css("right",""))}this.zIndex=this.el.style.zIndex=ole.iniZIndex,this.isExposed=!1,this.isSynchronized=!0,this.permitToDesign=!0,this.isResizedOnce=!1,this.isDraggedOnce=!1,this.isEnabled=!0,this.isResizeSidesChecked=!1,this.isMovedOrResizedAfterClone=!1,this.cloneCountSinceLastDragOrResize=0,ole.objects[this.type].focusLayer&&(this.el.onmouseover=function(t){ole.onDrag||ole.onResize||!ole.objects[this.objType].onmouseover||ole.objects[this.objType].onmouseover(this.id,t),OLE[e].focus(t)}),this.el.onmouseout=function(e){ole.onDrag||ole.onResize||!ole.objects[this.objType].onmouseout||(!ole(this.id).permitToDesign,ole.objects[this.objType].onmouseout(this.id,e))}}function checkForDependants(e,t){var o=UTIL.DOM.contains;try{for(var r=0;r<e.length;r++){if(o(getObj(e[r]),t))return!0;if(t){if("svg"===t.tagName||$(t).hasClass("cPaletteLeg")||$(t).hasClass("colorMenuCustomPallete")||-1!==t.id.indexOf("chartmenucustomcolorDropDown")||-1!==t.id.indexOf("lineTypesLine")||-1!==t.id.indexOf("min")||-1!==t.id.indexOf("max")||-1!==t.id.indexOf("interval")||-1!==t.id.indexOf("customTitle")||-1!==t.id.indexOf("chartbgcolorDropDown")||-1!==t.id.indexOf("chartFontColorDropDown")||-1!==t.id.indexOf("OLEBoxFormat_fonts")||-1!==t.id.indexOf("OLEBoxFormat")||-1!==t.className.indexOf("chartSubType")||-1!=t.className.indexOf("chartSubTypeSel")||-1!==t.id.indexOf("fontSize3")||-1!==t.className.indexOf("ui-zcolorpalette-colorbox"))return!0;if("object"==typeof t.className)return!0;if(t.parentElement){if(t.parentElement.className&&"function"==typeof t.parentElement.className.indexOf&&-1!==t.parentElement.className.indexOf("cPaletteCode"))return!0;if("lineChart"==t.parentElement.getAttribute("name")||$(t.parentElement).hasClass("ui-zadvcolorpalette-bar")||$(t.parentElement).hasClass("ui-zspinner-down")||$(t.parentElement).hasClass("ui-zadvcolorpalette-spinnerpane")||$(t.parentElement).hasClass("ui-zspinner-content")||$(t.parentElement).hasClass("ui-zadvcolorpalette-swatchmain")||$(t.parentElement).hasClass("ui-zcolorpalette-shadecontainer")||$(t.parentElement).hasClass("ui-zcolorpalette-morecolors-text")||$(t.parentElement).hasClass("ui-zcolorpalette-colors-container")||$(t.parentElement).hasClass("toggleMenuCustomCheckBox")||-1!==t.parentElement.className.indexOf("ui-state-default")||-1!=t.parentElement.className.indexOf("chartSubTypeSel")||-1!=t.parentElement.className.indexOf("chartSubType")||-1!=t.parentElement.id.indexOf("OLEBoxFormat")||-1!=t.parentElement.id.indexOf("OLEBoxFormat_fonts")||-1!==t.parentElement.id.indexOf("colorSlider-zslider")||"ui-zcolorpalette-shadecontainer"===t.parentElement.className)return!0;if(t.parentElement.parentElement){if(-1!==t.parentElement.className.indexOf("ui-zcolorpalette-morecolors-text")||-1!==t.parentElement.parentElement.id.indexOf("formatData1")||"ui-zcombo"===t.parentElement.parentElement.className)return!0;if(t.parentElement.parentElement.parentElement){if(-1!==t.parentElement.parentElement.parentElement.id.indexOf("sliding_val")||-1!==t.parentElement.parentElement.parentElement.id.indexOf("OLEBoxFormat_fonts")||-1!==t.parentElement.parentElement.parentElement.id.indexOf("OLEBoxFormat")||-1!==t.parentElement.parentElement.parentElement.id.indexOf("chartBgColorGroup"))return!0;if(t.parentElement.parentElement.parentElement.parentElement){if(-1!==t.parentElement.parentElement.parentElement.parentElement.id.indexOf("OLEBoxFormat"))return!0;if(t.parentElement.parentElement.parentElement.parentElement.parentElement&&t.parentElement.parentElement.parentElement.parentElement.parentElement.id&&-1!==t.parentElement.parentElement.parentElement.parentElement.parentElement.id.indexOf("OLEBoxFormat"))return!0}}}}}else if(getObj("rangeSelectorDialog"))return!0}}catch(e){}return!1}var OLE={};ole=function(){var e;return e=null==OLE[arguments[0]]?ole.init(arguments[0]):OLE[arguments[0]]},ole.objectsSubHeader={},ole.typesRegistered=[],ole.init=function(e,t,o,r,i){OLE[e]=new _ole(e,t,o,r,i);var s=OLE[e].type;return-1===ole.typesRegistered.indexOf(s)&&(ole.constructSubHeader(s),ole.typesRegistered.push(s)),ole.clearObjectsPositionCache(),OLE[e]},ole.currObjLeft=0,ole.currObjTop=0,ole.alpha=0,ole.alphaValue=0,ole.onDrag=!1,ole.onResize=!1,ole.cloneCount=0,ole.isDragged=!1,ole.isResized=!1,ole.count=-1,ole.editModeTDs=0,ole.iniZIndex=110+BASEZINDEX,ole.isCalledOnce=!1,ole.contextMenuStatus=!1,ole.isActionBarLocked=!1,ole.isBlurredOnLayerSwitch=!1,ole.isObjContextMenuCreated=!1,ole.isFirstClickOutsideOLECompleted=!1,ole.objects={defaultObjectProperties:{focusLayer:"OLEFocusLayer",selectLayer:"OLESelectLayer",menuData:"",minHeight:10,minWidth:10,actionBar:"",contextMenu:"",permissions:{isDraggable:!0,isResizable:!0,isEditable:!1},resizeCorners:"",resizeCornersBehaviour:"",onActionBarMouseDown:void 0,onAfterFocus:void 0,onBeforeLoadActionBar:void 0,onClone:void 0,onCtrlKeyDown:void 0,onCtrlKeyUp:void 0,onCtrlKeyPress:void 0,onDbClick:void 0,onDragStart:void 0,onDrag:void 0,onDragEnd:void 0,onFocusLayerMouseDown:void 0,onExpose:void 0,onFirstMouseDownOutsideOLEElements:void 0,onMask:void 0,onMouseDownOutsideOLEElements:void 0,onMouseDownOverOLEElements:void 0,onmouseover:void 0,onmouseout:void 0,onRemove:void 0,onOLEObjMouseDown:void 0,onObjectSwitch:void 0,onObjectTypeSwitch:void 0,onResizeStart:void 0,onResize:void 0,onResizeEnd:void 0,onSelectLayerMouseDown:void 0,onSync:void 0,onCopy:void 0,onCut:void 0}},_ole.prototype={focus:function(e){var t=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);if((t.isDraggable||t.isResizable)&&this.isEnabled&&!ole.isSelected(this.id)&&this.permitToDesign&&!ole.onDrag&&!ole.onResize&&!this.isExposed){ole.currFocusObj&&ole.currFocusObj!==this&&ole.currFocusObj!==ole.currObj&&(ole.currFocusObj.getFocusLayer().style.display="none"),ole.currFocusObj=this,this.setFocusLayer(),this.getFocusLayer().style.filter="alpha(opacity=0)",ole.isBlurredOnLayerSwitch=!1;var o=this.getFocusLayer();o.style.filter="alpha(opacity=100)",o.style.opacity=.99,ole.objects[this.type].onAfterFocus&&ole.objects[this.type].onAfterFocus(this.id,e)}return this},blur:function(e){if(isUndefined(this))return!1;browser_ie&&(e=window.event);var t=this.getFocusLayer(),o=e.clientX+getSheetScrollLeft()-sheetLeft,r=e.clientY+getSheetScrollTop()-sheetTop,i=parseFloat(t.style.left,10),s=parseFloat(t.style.top,10),n=i+parseFloat(t.style.width,10),l=s+parseFloat(t.style.height,10);return(i+3>o||o>n-4||s+3>r||r>l-4)&&(t.style.filter="alpha(opacity=1)",t.style.opacity=.01,t.style.display="none",this.sendToBack()),stopEvt(e),this},fadeIn:function(){var e=this.getFocusLayer();return ole.alpha<10?(e.style.opacity=ole.alpha/10,e.style.filter="alpha(opacity="+10*ole.alpha+")",ole.alpha++):(e.style.opacity=.99,e.style.filter="alpha(opacity=100)",window.clearInterval(OLEFadeInIntvl)),this},fadeOut:function(){return ole.alpha>0?(focusLayer.style.opacity=ole.alpha/10,focusLayer.style.filter="alpha(opacity="+10*ole.alpha+")",ole.alpha--):(ole.alpha=0,focusLayer.style.opacity=.01,focusLayer.style.filter="alpha(opacity=0)",focusLayer.style.display="none",window.clearInterval(OLEFadeOutIntvl)),this},getLeft:function(){return this.right||this.left},getTop:function(){return this.top},getHeight:function(){return this.height},getWidth:function(){return this.width},getPos:function(){return{left:this.getLeft(),top:this.getTop()}},getRearPos:function(){return{x:this.getRearX(),y:this.getRearY()}},getDim:function(){return{width:this.getWidth(),height:this.getHeight()}},getZIndex:function(){return this.zIndex},getRearX:function(){return parseInt(this[isRTL?"right":"left"],10)+parseInt(this.width,10)},getRearY:function(){return parseInt(this.top,10)+parseInt(this.height,10)},setRearX:function(e){var t=e-this.width;return t>0&&this.setLeft(t),this},setRearY:function(e){var t=e-this.height;return t>0&&this.setTop(t),this},calcMaxHeight:function(e){return this.maxHeight=e-this.maxHeight,this},getMaxHeight:function(){return this.maxHeight},getMaxWidth:function(){},getMinLeft:function(){},getMaxLeft:function(){},getMinTop:function(){},getMaxTop:function(){},setLeft:function(e){return isRTL?(this.right=e,this.left="",this.el.style.right=e+"px",this.el.style.left=""):(this.left=e,this.right="",this.el.style.left=e+"px",this.el.style.right=""),ole.clearObjectsPositionCache(),this},setTop:function(e){return 0>e&&(e=0),this.top=e,this.el.style.top=e+"px",ole.clearObjectsPositionCache(),this},setHeight:function(e){return e>0&&(this.height=e,this.el.style.height=e+"px"),this},setWidth:function(e){return this.width=e,this.el.style.width=e+"px",this},switchLayers:function(e){return ole.isBlurredOnLayerSwitch=!0,ole.currObj&&(ole.prevObj=ole.currObj),ole.currObj=this,ole.objects[this.type].onFocusLayerMouseDown&&ole.objects[this.type].onFocusLayerMouseDown(this.id,e),this._setSelectLayer().displayAssociativeElements("","none").positionActionBar(),stopEvt(e),this},getSelectLayer:function(){var e=this.type;return subHeader=ole.objectsSubHeader[e],subHeader.selectLayer||ole.createSelectAndFocusLayer(e),subHeader.selectLayer},_setSelectLayer:function(e,t,o,r){return e||(ole.pointer=void 0),this.setSelectLayer(t,o,r)},setSelectLayer:function(){var e=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);if((e.isDraggable||e.isResizable)&&this.isEnabled){ole.currObj=this,ole.conf.onfocus(!0),isUndefined(ole.tempObj)?ole.tempObj=this:ole.tempObj!==ole.currObj&&(ole.prevObj=ole.tempObj);var t=ole.currObj.getSelectLayer();this.bringToFront(),ole.getCurrObj()&&"chart"===ole.getCurrObj().type?ole.getCurrObj().isPivotChart?($("#chartMenu").is(":visible")&&$("#chartMenu").hide(),$("#pivotChartMenu").show(),initializeToolbar("#pivotChartTab"),ZComponentTabs.setSelectedTab("pivotChartMenu")):($("#chartMenu").show(),initializeToolbar("#chartTab"),ZComponentTabs.setSelectedTab("chartMenu")):($("#menutabs").length&&"chartMenu"===$("#menutabs").ztab("getSelectedTab")[0].id&&chartOLEAction.backToPreviousToolbar(),ole.getCurrObj()&&"img"===ole.getCurrObj().type&&(getObj(ole.getCurrObj().id).style.background="white")),ole.prevObj&&ole.prevObj!==this&&(ole.onDrag||ole.onResize||(this.cloneCountSinceLastDragOrResize=0,ole.prevObj.type!==ole.currObj.type&&(ole.prevObj.displayAssociativeElements("none","none","none"),ole.objects[this.type].onObjectTypeSwitch&&ole.objects[this.type].onObjectTypeSwitch(this.id)),OLE[ole.prevObj.id]&&ole.objects[ole.prevObj.type].onObjectSwitch&&ole.objects[ole.prevObj.type].onObjectSwitch(ole.prevObj.id))),ole.tempObj=this,ole.activeState=!0;var o=ole.objectsSubHeader[this.type].selectLayerDiffX,r=ole.objectsSubHeader[this.type].selectLayerDiffY;-1==ole.getCurrObj().type.indexOf("chart")&&(t.style[isRTL?"right":"left"]=this[isRTL?"right":"left"]-20-o+"px",t.style.top=this.top-20-r+"px",t.style.height=parseFloat(this.height)+40+2*r+"px",t.style.width=parseFloat(this.width)+40+2*o+"px"),$(ole.currObj.getSelectLayer()).children(".oleMenuList").show(),$(t).children().first().find(".select").height($(this.el).height()+40+2*r),$(t).children().first().find(".select").width($(this.el).width()+40+2*o),$(t).css("border-style","solid"),$($(t).find(".oleresize")).css("display","block"),$("#fCROD").css("display","none"),$("#fCROD").css("z-index",""),$(ole.currObj.getSelectLayer()).children("#OleEditModeMenu").hide(),$(ole.currObj.getSelectLayer()).children("#OleViewModeMenu").hide(),-1!==ole.getCurrObj().type.indexOf("chart")&&(t.style.background="#FFF",chartPreview.setOleLayer(t.id),this.el.style.border=ole.onDrag||ole.onResize?"1px solid lightgray":"1px solid #FFF",t.style.height=parseInt(this.el.offsetHeight,10)+50+2*r+"px",$(t).children().first().find(".select").height($(this.el).height()+45+2*r),t.style[isRTL?"right":"left"]=this[isRTL?"right":"left"]-25-o+"px",t.style.top=this.top-25-r+"px",t.style.height=parseFloat(this.height)+50+2*r+"px",t.style.width=parseFloat(this.width)+50+2*o+"px",$(ole.currObj.getSelectLayer()).children("#OleEditModeMenu").show(),$(ole.currObj.getSelectLayer()).children("#OleViewModeMenu").show()),t.style.zIndex=this.zIndex-1,t.style.display="block",ole.isFirstClickOutsideOLECompleted=!1}return this},getFocusLayer:function(){var e=this.type;return subHeader=ole.objectsSubHeader[e],subHeader.focusLayer||ole.createSelectAndFocusLayer(e),subHeader.focusLayer},setFocusLayer:function(){ole.currFocusObj=this;var e=ole.objectsSubHeader[this.type].focusLayerDiffX,t=ole.objectsSubHeader[this.type].focusLayerDiffY,o=this.getFocusLayer();return o.style[isRTL?"right":"left"]=parseFloat(this.el.style[isRTL?"right":"left"],10)-e+"px",o.style.top=parseFloat(this.el.style.top,10)-t+"px",o.style.height=parseFloat(this.el.offsetHeight,10)+2*t+"px",o.style.width=parseFloat(this.el.offsetWidth,10)+2*e+"px",o.style.direction="ltr",$(o).children().first().find(".focusGrid").height($(this.el).height()+2*t),$(o).children().first().find(".focusGrid").width($(this.el).width()+2*e),o.style.zIndex=this.zIndex+1,o.style.display="block",this},getActionBar:function(){var e=ole.objectsSubHeader[this.type];return e.hasActionBar?e.actionBar:void 0},displayAssociativeElements:function(e,t,o){var r=this.getSelectLayer();if(ole.objects[this.type].focusLayer)var i=this.getFocusLayer();return isUndefined(e)||(r.style.display=e),i&&!isUndefined(t)&&(i.style.display=t),!isUndefined(o)&&ole.objectsSubHeader[this.type].hasActionBar&&(this.getActionBar().style.display=o),this},deSelect:function(){return this.displayAssociativeElements("none","none","none").hideContextMenu(),this.isExposed&&(this.mask().isExposed=!1),ole.conf.onblur(),ole.activeState=!1,ole.objects[this.type].onDeselect&&ole.objects[this.type].onDeselect(),ole.currObj=null,this},showContextMenu:function(e){var t=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);if(ole.objectsSubHeader[this.type].hasContextMenu&&(t.isDraggable||t.isResizable)&&this.isEnabled){var o=ole.getCurrObj().type,r="",i=[],s="",n=[];"chart"==o?(n=chart.createChartContextMenu(),s="chartMoveToSubMenu",r="chartRMenu",$("#"+s).remove()):"img"==o?(n=createImageContextMenu(),r="imageRMenu"):"button"==o&&(n=createButtonContextMenu(),r="buttonRMenu");var l=getCursorPos(e),a=l.x,c=l.y,u={target:$("#"+ole.getCurrObj().id),position:[a,c],clearcache:!0};sheetMenu.showMenu(r,n,u),"chart"==o&&(i=chartOnLoad.createSubMenu(),$.ui.zmenu.createMenu(s,i,u),$("#"+s).unbind(s).bind(s,function(e,t){contextMenu._bindrclickevent(e,t)}),chartOnLoad.chartFormatePainter()),browser_ie&&(e=window.event),stopEvent(e),ole.contextMenuStatus=!0}else stopEvent(e),stopEvt(e);return this},hideContextMenu:function(){return ole.contextMenuStatus?(ole.contextMenuStatus=!1,sheetMenu.hideMenu(),this):void 0},moveTo:function(e,t){return this.setLeft(e).setTop(t),this},resizeTo:function(e,t){return this.setWidth(e).setHeight(t),this},expose:function(){return this.isExposed=!0,ole.objects[this.type].onExpose&&ole.objects[this.type].onExpose(this.id),this},mask:function(){return this.el.style.zIndex=this.zIndex,this.isExposed=!1,ole.objects[this.type].onMask&&ole.objects[this.type].onMask(this.id),this},setZIndex:function(e){return this.el.style.zIndex=e,this.zIndex=e,this},bringToFront:function(){if(ole.getObjectProperty(this.type,"hasOrdering")){for(var e=ole.sortByZIndex(),t=e.length-1;t>0&&e[t][0]!==this.id;t--){var o=ole(e[t][0]).zIndex;ole(e[t][0]).setZIndex(ole(e[t-1][0]).zIndex),ole(e[t-1][0]).setZIndex(o)}var r=this.getSelectLayer();"none"!==r.style.display&&(r.style.zIndex=parseInt(this.zIndex,10)+1)}else ole.resetZIndex(),this.setZIndex(105+BASEZINDEX),ole.isSelected(this.id)?this.getSelectLayer().style.zIndex=106+BASEZINDEX:ole.currObj&&(ole.currObj.setZIndex(103+BASEZINDEX),ole.currObj.getSelectLayer().style.zIndex=104+BASEZINDEX),ole.isFocussed(this.id)?this.getFocusLayer().style.zIndex=106+BASEZINDEX:(currFocusObj=ole.currFocusObj,currFocusObj&&(currFocusObj.setZIndex(103+BASEZINDEX),currFocusObj.getFocusLayer().style.zIndex=104+BASEZINDEX));return this},sendToBack:function(){if(ole.isBlurredOnLayerSwitch)return this;if(ole.getObjectProperty(this.type,"hasOrdering")){for(var e=ole.sortByZIndex(),t=0;t<e.length-1&&e[t][0]!==this.id;t++){var o=ole(e[t][0]).zIndex;ole(e[t][0]).setZIndex(ole(e[t+1][0]).zIndex),ole(e[t+1][0]).setZIndex(o)}"none"!==selectLayer.style.display&&(selectLayer.style.zIndex=parseInt(this.zIndex,10)+1,focusLayer.style.zIndex=parseInt(ole.currFocusObj.zIndex,10)+1)}else ole.resetZIndex(),this.setZIndex(99+BASEZINDEX),ole.isSelected(this.id)?this.getSelectLayer().style.zIndex=100+BASEZINDEX:ole.currObj&&(ole.currObj.setZIndex(105+BASEZINDEX),ole.currObj.getSelectLayer().style.zIndex=104+BASEZINDEX),ole.isFocussed(this.id)?this.getFocusLayer().style.zIndex=100+BASEZINDEX:(currFocusObj=ole.currFocusObj,currFocusObj&&(currFocusObj.setZIndex(103+BASEZINDEX),currFocusObj.getFocusLayer().style.zIndex=104+BASEZINDEX));return this},positionActionBar:function(e){var t=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);if(t.isDraggable||t.isResizable){var o=ole.objectsSubHeader[this.type];if(o.hasActionBar&&!ole.isActionBarLocked){ole.objects[this.type].onBeforeLoadActionBar&&ole.objects[this.type].onBeforeLoadActionBar(this.id);{var r=this.getSelectLayer(),i=screen.width,s=screen.height,n=parseInt(o.actionBarHt,10),l=parseInt(o.actionBar.offsetWidth,10),a=sheetTop-n-o.actionBarDiffX,c=parseFloat(r.style[isRTL?"right":"left"],10)+rowHeadWidth-getNormalizedScrollLeft()+"px",u=parseFloat(r.style.top,10)-(n+o.actionBarDiffX)+sheetTop-getSheetScrollTop()+"px",d=this.getActionBar();d.style[isRTL?"right":"left"],d.style.top}d.style[isRTL?"right":"left"]=parseFloat(c,10)+l>=i?i-l-2+"px":parseFloat(c,10)+"px",d.style[isRTL?"right":"left"]=parseFloat(d.style[isRTL?"right":"left"],10)<0?"0px":parseFloat(d.style[isRTL?"right":"left"],10)+"px",d.style.top=parseFloat(u,10)+n>=s?s-n-2+"px":parseFloat(u,10)+"px",d.style.top=parseFloat(d.style.top,10)<a?a+"px":parseFloat(d.style.top,10)+"px",isUndefined(e)&&(e=!0),ole.focusActionBar(e)}}return this},setDesignMode:function(e){return this.permitToDesign=e,this},clone:function(e,t,o,r,i){var s=ole.cloneElement(this.el.id);return ole.constructOLEObj(s),isUndefined(t)&&(t=20),isUndefined(o)&&(o=20),isUndefined(r)&&(r=this.height),isUndefined(i)&&(i=this.width),iLeft=this[isRTL?"right":"left"]+20,iTop=this.top+20,1==e?(OLE[s].setLeft(parseFloat(t)+parseFloat(this[isRTL?"right":"left"],10)).setTop(parseFloat(o)+parseFloat(this.top,10)).setHeight(r).setWidth(i),ole.sendServerRequestOnClone(s,1),this.cloneCountSinceLastDragOrResize+=1):2==e&&(ole.setElementStyleProps(s,!0,!0,!0,t+parseFloat(this[isRTL?"right":"left"],10),o+parseFloat(this.top,10),r,i,"none",.99),ole.sendServerRequestOnClone(s,2)),this},synchronizeClones:function(e,t,o){2==e&&(ole(t).style.display="",isUndefined(arguments[3])||ole(t).setLeft(parseFloat(arguments[3],10)),isUndefined(arguments[4])||ole(t).setTop(parseFloat(arguments[4],10)),isUndefined(arguments[5])||ole(t).setHeight(parseFloat(arguments[5],10)),isUndefined(arguments[6])||ole(t).setWidth(parseFloat(arguments[6],10))),OLE[o]=OLE[t],OLE[o].id=OLE[o].el.id=o,2==e&&(ole.prevObj=ole.currObj,ole.currObj=OLE[o]),OLE[t]=null,delete OLE[t];var r=OLE[o];return r.el.onmouseover=function(e){ole.objects[this.objType].onmouseover&&ole.objects[this.objType].onmouseover(this.id,e),OLE[o].focus(e)},ole.objects[this.type].onSync&&ole.objects[this.type].onSync(o,t,r.left,r.top,r.height,r.width),ole(o).isSynchronized=!0,OLE[o]},resetActionBarState:function(){return this},getActionBarButtonStateByTitle:function(e){for(var t=this.getActionBar().getElementsByTagName("TD"),o=0;o<t.length;o++)if(t[o].title===e){var r=t[o].className;if("iconText pressed"===r)return{classValue:r,state:"pressed"};if("iconText"===r)return{classValue:r,state:"notpressed"};if("iconText hover"===r)return{classValue:r,state:"hover"}}},setActionBarButtonStateByTitle:function(e,t,o){for(var r=this.getActionBar().getElementsByTagName("TD"),i=0;i<r.length;i++)r[i].title===e&&(r[i].className=t);if(o)for(var i=0;i<r.length;i++)r[i].title===e||"iconText pressed"!==r[i].className&&"iconText hover"!==r[i].className||(r[i].className="iconText");return this},overrideProperties:function(e){return this.isPermissionsOverridden=!0,this.overriddenPermissions=e,this},deOverrideProperties:function(){return this.isPermissionsOverridden=!1,this.overriddenPermissions=void 0,this},lockActionBar:function(){return ole.isActionBarLocked=!0,this},unlockActionBar:function(){return ole.isActionBarLocked=!1,this},brightenActionBar:function(){return this.getActionBar().className="toolbar mouseOver",this},dimDownActionBar:function(){return this.getActionBar().className="toolbar",this},enable:function(){return this.isEnabled=!0,this},disable:function(){return this.isEnabled=!1,this}},ole.createObjectProperties=function(e,t){isUndefined(ole.objects[e])&&(ole.objects[e]={}),ole.objects[e]=t},ole.extentProperty=function(e,t){_ole.prototype[e]=t},ole.removeObjectProperties=function(e,t){if(t){if(!isUndefined(ole.objects[e]))for(var o=0,r=t.length;r>o;o++)ole.objects[e][key]=void 0}else ole.objects[e]={}},ole.removeObjectProperty=function(e,t){isUndefined(ole.objects[e])||isUndefined(ole.objects[e].key)||(ole.objects[e][t]=void 0)},ole.setObjectProperties=function(e,t){if(!isUndefined(ole.objects[e]))for(x in t)ole.objects[e][x]=t[x]},ole.setObjectProperty=function(e,t,o){isUndefined(ole.objects[e])||(ole.objects[e][t]=o)},ole.getObjectsLeft=function(e){var t=[];"undefined"==typeof e&&(e=ole.getObjects());for(var o=0;o<e.length;o++)t[o]=e[o][isRTL?"right":"left"];return t},ole.getObjectsTop=function(e){var t=[];"undefined"==typeof e&&(e=ole.getObjects());for(var o=0;o<e.length;o++)t[o]=e[o].top;return t},ole.getObjectsByPositionX=function(e,t){var o=[],r=0;for(x in OLE){var i=OLE[x].left,s=OLE[x].left+OLE[x].width;"undefined"==typeof t?OLE[x]&&i>=e&&(o[r++]=OLE[x]):("undefined"==typeof e&&(e=0),OLE[x]&&(i>=e&&t>=i||s>=e&&t>=s)?o[r++]=OLE[x]:OLE[x]&&e>i&&s>t&&(o[r++]=OLE[x]))}return o},ole.getObjectsByPositionY=function(e,t){var o=[],r=0;e=e?e:0,t=t?t:rowTopAry[totRows];for(x in OLE){var i=OLE[x].top;OLE[x]&&i>=e&&t>=i&&(o[r++]=OLE[x])}return o},ole.getObjectsByPositionXYRange=function(e,t,o,r,i){if(!e||"ALL"!=e||"chart"!=e||"button"!=e||"img"!=e){var s=[],n=0;if(t&&o){r&&i||(r=t,i=o);for(x in OLE)if(e==OLE[x].type||"ALL"==e){var l=OLE[x].top,a=OLE[x].left;OLE[x]&&a>=t&&r>=a&&l>=o&&i>=l&&(s[n++]=OLE[x])}return s}}},ole.getElement=function(e,t){getObj(ole.getObjectProperty(e,t))&&getObj(ole.getObjectProperty(e,t))},ole.getObjectProperty=function(e,t){return isUndefined(ole.objects[e][t])?void 0:ole.objects[e][t]},ole.getObjectProperties=function(e){return isUndefined(ole.objects[e])?void 0:ole.objects[e]},ole.onOpenNewDoc=function(){ole.currObj&&ole.currObj.deSelect()},ole.reset=function(){OLE={};for(var e=ole.typesRegistered,t=0,o=e.length;o>t;t++){var r=ole.objectsSubHeader[e[t]];r.selectLayer=void 0,r.focusLayer=void 0}},ole.onCtrlKeyDown=function(e){for(x in ole.objects)ole.objects[x].onCtrlKeyDown&&ole.objects[x].onCtrlKeyDown(e)},ole.onCtrlKeyUp=function(e){for(x in ole.objects)ole.objects[x].onCtrlKeyUp&&ole.objects[x].onCtrlKeyUp(e)},ole.onCtrlKeyUp=function(e){for(x in ole.objects)ole.objects[x].onCtrlKeyUp&&ole.objects[x].onCtrlKeyUp(e)},ole.onCtrlKeyPress=function(e){for(x in ole.objects)ole.objects[x].onCtrlKeyPress&&ole.objects[x].onCtrlKeyPress(e)},ole.getObjects=function(e,t){var o=[],r=0;("undefined"==typeof t||null==t)&&(t=OLE);for(x in t)t[x]&&t[x].type===e?o[r++]=t[x]:("undefined"==typeof e||null==e)&&(o[r++]=t[x]);return o},ole.isSelected=function(e){return ole.currObj&&ole.currObj.id===e?!0:!1},ole.isFocussed=function(e){return ole.currFocusObj&&ole.currFocusObj.id===e?!0:!1},ole.getCurrObj=function(){return ole.currObj},ole.getObjectPermissions=function(e,t){for(var o={},r=0;r<t.length;r++)ole(e).isOverridden?o[t[r]]=isUndefined(ole(e).overriddenPermissions[ole.objects[ole(e).type].permissions[t[r]]])?ole.objects[ole(e).type].permissions[t[r]]:ole(e).overriddenPermissions[t[r]]:isUndefined(ole.objects[ole(e).type].permissions[t[r]])||(o[t[r]]=ole.objects[ole(e).type].permissions[t[r]]);return o},ole.createSelectAndFocusLayer=function(e){if(header=ole.objects[e],subHeader=ole.objectsSubHeader[e],!subHeader.selectLayer){var t=ole.cloneCount++,o=getObj(header.selectLayer||ole.objects.defaultObjectProperties.selectLayer).cloneNode(!0);o.id=o.id+t,ole.getWorkSpace().appendChild(o),subHeader.selectLayer=o}if(header.focusLayer&&!subHeader.focusLayer){var r=getObj(header.focusLayer).cloneNode(!0);r.id=r.id+t,ole.getWorkSpace().appendChild(r),subHeader.focusLayer=r}ole.setResizeCorners(e).setSelectAndFocusLayerEvents(e)},ole.constructSubHeader=function(e){if(isUndefined(ole.objectsSubHeader[e])){var t=ole.objectsSubHeader[e]={};ole.createSelectAndFocusLayer(e),t.selectLayerDiffX=0,t.selectLayerDiffY=0,t.focusLayerDiffX=7,t.focusLayerDiffY=7,t.X1=0,t.Y1=0,t.X2=1e3,t.Y2=1e3,t.hasActionBar=ole.inspectActionBar(e),t.hasContextMenu=ole.inspectContextMenu(e),t.hasActionBar&&(t.actionBar=getObj(ole.objects[e].actionBar),t.actionBarDiffX=3,t.actionBarHt=t.actionBar.offsetHeight,t.actionBarWd=t.actionBar.offsetWidth),ole.setResizeCorners(e).setSelectAndFocusLayerEvents(e)}},ole.fadeInActionBar=function(){if(ole.currObj&&ole.objectsSubHeader[ole.currObj.type].hasActionBar&&!ole.isActionBarLocked){var e=ole.currObj.getActionBar();ole.alphaValue<10?(e.style.opacity=ole.alphaValue/10,e.style.filter="alpha(opacity="+10*ole.alphaValue+")",ole.alphaValue++):(e.style.opacity=1,e.style.filter="alpha(opacity=100)",window.clearInterval(ActnFadeInIntvl))}},ole.focusActionBar=function(e){if(ole.currObj&&ole.objectsSubHeader[ole.currObj.type].hasActionBar){"undefined"!=typeof ActnFadeInIntvl&&window.clearInterval(ActnFadeInIntvl),"undefined"!=typeof ActnFadeOutIntvl&&window.clearInterval(ActnFadeOutIntvl);var t;browser_ie?t=15:browser_nn6&&(t=20);var o=ole.currObj.getActionBar();e?((parseInt(o.style.opacity,10)>=0||""===o.style.opacity)&&(o.style.opacity=0,o.style.filter="alpha(opacity=0)"),"none"===o.style.display&&(o.style.display=""),ActnFadeInIntvl=window.setInterval(function(){ole.fadeInActionBar()},t),ole.alphaValue=0):("none"===o.style.display&&(o.style.display=""),o.style.opacity=1,o.style.filter="alpha(opacity=100)")}},ole.remove=function(e,t){var o=OLE[e];if(!isUndefined(OLE[e])&&null!==OLE[e]){t&&ole.objects[OLE[e].type].onRemove&&ole.objects[OLE[e].type].onRemove(OLE[e].id);var r=getObj(e).parentNode;ole.isSelected(e)?(o.displayAssociativeElements("none",void 0,"none").hideContextMenu(),delete ole.currObj):ole.isFocussed(e)&&(o.displayAssociativeElements(void 0,"none",void 0),delete ole.currFocusObj),delete OLE[e],ole.activeState=!1,null!==r&&r.removeChild(getObj(e)),activateCellField(),ole.clearObjectsPositionCache()}},ole.removeAll=function(){Chart.clearInstance();var e=ole.typesRegistered;e.forEach(function(e){ole.removeByType(e)})},ole.removeByType=function(e){var t=ole.getObjects(e);t.forEach(function(e){ole.remove(e.id)})},ole.inspectActionBar=function(e){var t=ole.objects[e];return t.actionBar?!0:!1},ole.inspectContextMenu=function(e){var t=ole.objects[e];return t.contextMenu?!0:!1},ole.cloneElement=function(e){ole.cloneCount++;var t=getObj(e).cloneNode(!0);return t.id="clone"+ole.cloneCount,"undefined"!==ole.currObj.type&&(t.objType=ole.currObj.type),ole.getWorkSpace().appendChild(t),t.id},ole.setElementStyleProps=function(e,t,o,r){var i,s;s=getObj(e),t&&(s.style.left=arguments[4],s.style.top=arguments[5]),o&&(t?(s.style.height=arguments[6],s.style.width=arguments[7]):t||(s.style.height=arguments[4],s.style.width=arguments[5])),r&&(t&&o?i=8:t||o?(!t&&o||t&&!o)&&(i=6):i=4,"undefined"!=typeof arguments[i]&&(s.style.display=arguments[i],s.style.opacity=arguments[i+1],s.style.filter="alpha(opacity = "+100*s.style.opacity+")",isUndefined(arguments[i+2])||null===arguments[i+2]||(s.style.zIndex=parseInt(arguments[i+2],10))))},ole.setMaxHeight=function(e){return ole.maxHeight=e,this},ole.setMaxWidth=function(e){ole.maxWidth=e},ole.getMaxHeight=function(){return ole.maxHeight},ole.getMaxWidth=function(){return ole.maxWidth},ole.setMaxTopAndMaxHeight=function(e){relativeY=ole.getMaxHeight()-e;for(x in OLE);return this},ole.setMaxLeftAndMaxWidth=function(e){relativeX=ole.getMaxHeight()-e;for(x in OLE);return this},ole.constructOLEObj=function(e){ole(e),OLE[e].parentId=ole.currObj.id,this.isSynchronized=!1},ole.setAsCurrObj=function(e){return ole.prevObj=ole.currObj,ole.currObj=OLE[e],ole.currObj},ole.sendServerRequestOnClone=function(e,t){if(ole.objects[ole.currObj.type].onClone){var o=OLE[e],r=o.type;ole.objects[r].onClone(t,e,o.getLeft(),o.getTop(),o.getWidth(),o.getHeight(),o.parentId)}OLE[e].isSynchronized=!1},ole.isActive=function(){return ole.activeState},ole.startDrag=function(e,t){oleDIV=e.target;var o=ole.currObj;if(o){ole.getCurrObj()&&"chart"==ole.getCurrObj().type&&$("#"+ole.getCurrObj().id).css("border","1px solid lightgray");var r,i=ole.getObjectPermissions(o.id,["isDraggable"]);if(i.isDraggable&&!o.isExposed&&o.isEnabled)if(ole.onDrag)ole.endDrag(e);else if(!ole.onDrag&&!ole.onResize){var s=o.getSelectLayer();s.style.opacity=.4;var n=o.id;preOleTopVal=OLE[ole.currObj.id].getTop(),preOleLeftVal=OLE[ole.currObj.id].getLeft(),OLEDragProps.scrollTop=getSheetScrollTop(),appEvent.on("scrollCallBack",setOleDimentiononOutsideViewportForDrag,"rowNo","colNo","direction","top","left"),document.OLEMouseMoveLis=document.OLEMouseUpLis=this,document.OLEMouseMoveFunc=function(e){return document.OLEMouseMoveLis.drag(e,n)},document.OLEMouseUpFunc=function(e){return"chart"==ole.getCurrObj().type&&$("#"+ole.getCurrObj().id).css("border","1px solid #FFF"),document.OLEMouseUpLis.endDrag(e,n,t)},document.OLEMouseDownFunc=function(e){return document.OLEMouseUpLis.drag(e,n,t)},browser_ie?(e=window.event,r=e.button):browser_nn6&&(r=e.which);{var l=o.type;ole.objectsSubHeader[l].selectLayerDiffX,ole.objectsSubHeader[l].selectLayerDiffY}ole.diffX=isRTL?clientDim.width-e.clientX-rowHeadWidth-parseFloat(s.style.right)+getNormalizedScrollLeft():e.clientX-sheetLeft-parseFloat(s.style.left)+getSheetScrollLeft(),ole.diffY=e.clientY-sheetTop-parseFloat(s.style.top)+getSheetScrollTop(),ole.onDrag=!0,document.addEventListener("mousemove",document.OLEMouseMoveFunc,!1),document.addEventListener("mouseup",document.OLEMouseUpFunc,!1),document.addEventListener("mousedown",document.OLEMouseDownFunc,!1),ole.onDragStart=!0}return!1}},ole.drag=function(e,t){ole.getCurrObj()&&"chart"==ole.getCurrObj().type&&($("#"+t).css("border","1px solid lightgray"),chartPreview.hideContextualToolbar(t,!0)),clearTextSelection(),browser_ie&&(e=window.event);{var o=ole.currObj;getCursorPos(e)}if(o){var r,i;"chart"==o.type?(i=isRTL?clientDim.width-e.clientX+getNormalizedScrollLeft()-rowHeadWidth-ole.diffX+25:e.clientX+getSheetScrollLeft()-sheetLeft-ole.diffX+25,r=e.clientY+getSheetScrollTop()-sheetTop-ole.diffY+25):(i=isRTL?clientDim.width-e.clientX+getNormalizedScrollLeft()-rowHeadWidth-ole.diffX+20:e.clientX+getSheetScrollLeft()-sheetLeft-ole.diffX+20,r=e.clientY+getSheetScrollTop()-sheetTop-ole.diffY+20);var s=ole.objectsSubHeader[ole.currObj.type].selectLayerDiffX,n=ole.objectsSubHeader[ole.currObj.type].selectLayerDiffY;i=i+s>=0?i:-n,r=r+n>=0?r:-n,appEvent.trigger("ole.onDrag",[r,i,e]);var l=o.type;if(ole.onDragStart&&(ole.objects[l].onDragStart&&ole.objects[l].onDragStart(o.id,i,r),ole.onDragStart=!1),r+o.height>getRowTop(getRowMax()-1)+getRowHeight(getRowMax()-1)&&(r=getRowTop(getRowMax()-1)+getRowHeight(getRowMax()-1)-o.height),ole.objects[l].onDrag&&ole.objects[l].onDrag(o.id,i,r),!ole.isCalledOnce){ole.isDragged=!0,o.isDraggedOnce=!0,o.displayAssociativeElements("","none");var a=ole.currObj.getActionBar();ole.objectsSubHeader[o.type].hasActionBar&&(a.style.visibility="hidden"),ole.isCalledOnce=!0,ole.contextMenuStatus=!1,ole.isActionBarLocked=!0,o.isMovedOrResizedAfterClone=!0,o.cloneCountSinceLastDragOrResize=0}}},ole.endDrag=function(e,t,o){var r,i;if(e&&(i=e.ctrlKey),ole.isDragged&&(o=!1),"undefined"!=typeof sheetScrollLeftId&&clearInterval(sheetScrollLeftId),"undefined"!=typeof sheetScrollTopId&&clearInterval(sheetScrollTopId),null!=document.getElementById("horizontalBorderLine")){var s=getObj("horizontalBorderLine"),n=s.parentNode;n.removeChild(s)}if(null!=document.getElementById("verticalBorderLine")){var l=getObj("verticalBorderLine"),n=l.parentNode;n.removeChild(l)}appEvent.off("scrollCallBack",setOleDimentiononOutsideViewportForDrag);var a=ole.currObj;if(a){var c=a.type;ole.currObj.getSelectLayer().style.opacity=1;var u=ole.getObjectProperty(c,"cloneOnCTRLDrag");if(isUndefined(u)&&(u=!1),i&&!o&&u&&(r=ole.cloneElement(a.el.id),ole.constructOLEObj(r),a=ole.setAsCurrObj(r)),"chart"==ole.getCurrObj().type&&$("#"+ole.getCurrObj().id).css("border","1px solid #FFF"),i&&!o&&u&&ole.sendServerRequestOnClone(r,3),document.removeEventListener("mousemove",document.OLEMouseMoveFunc,!1),document.removeEventListener("mouseup",document.OLEMouseUpFunc,!1),document.removeEventListener("mousedown",document.OLEMouseDownFunc,!1),ole.onDrag=!1,ole.isDragged&&(ole.isDragged=!1,ole.isCalledOnce=!1,ole.isActionBarLocked=!1,ole.currObj[isRTL?"right":"left"]!==ole.currObj.prevStateLeft&&ole.currObj.top!==ole.currObj.prevStateTop)){var d=ole.currObj.getActionBar();ole.objectsSubHeader[a.type].hasActionBar&&(d.style.visibility="visible"),a.positionActionBar(!0),ole.currObj.prevStateLeft=ole.currObj[isRTL?"right":"left"],ole.currObj.prevStateTop=ole.currObj.top;var h=parseFloat(a.el.style.top);a.setLeft(parseFloat(a.el.style[isRTL?"right":"left"])).setTop(h),h+a.height<getSheetScrollTop()&&setScrollTop(h+a.height),h>getSheetScrollTop()+getSheetHeight()&&setScrollTop(h-getSheetHeight()),a._setSelectLayer(!0),a.isSynchronized&&ole.objects[c].onDragEnd&&ole.objects[c].onDragEnd(a.id,a[isRTL?"right":"left"],a.top)}}},ole.resizeProportionally=function(e,t,o,r){var i;return"undefined"!=typeof e?i=Math.round(e/(o/r)):"undefined"!=typeof t&&(i=Math.round(t*(o/r))),i},ole.startResize=function(e,t){var o=ole.currObj,r=o.getSelectLayer(),i=ole.getObjectPermissions(o.id,["isResizable"]);return i.isResizable&&!o.isExposed&&o.isEnabled&&(ole.onResize?ole.endResize(t):ole.onDrag||ole.onResize||(r.style.opacity=.4,ole.resizeType=e,ole.currObjLeft=o[isRTL?"right":"left"],ole.currObjTop=o.top,ole.currObjWd=o.width,ole.currObjHt=o.height,preOleTopVal=OLE[ole.currObj.id].getTop(),preOleLeftVal=OLE[ole.currObj.id].getLeft(),prevOleHeight=OLE[ole.currObj.id].getHeight(),prevOleWidth=OLE[ole.currObj.id].getWidth(),ole.onResize=!0,appEvent.on("scrollCallBack",setOleDimentiononOutsideViewportForResize,"rowNo","colNo","direction","top","left"),document.OLEMouseMoveLis=document.OLEMouseUpLis=this,document.OLEMouseMoveFunc=function(e){return document.OLEMouseMoveLis.resize(e)},document.OLEMouseUpFunc=function(e){document.OLEMouseUpLis.endResize(e)},document.addEventListener("mousemove",document.OLEMouseMoveFunc,!1),document.addEventListener("mouseup",document.OLEMouseUpFunc,!1),t.stopPropagation(),ole.onResizeStart=!0)),!1},ole.showPropotionalEffect=function(e,t,o,r){var i,s,n,l=ole.currObj,a={};switch(document.getElementById("oleShowEffectDom")?(i=document.getElementById("oleShowEffectDom"),n=document.getElementById("oleShowEffectHeightDom"),s=document.getElementById("oleShowEffectWidthDom"),$(i).show(),$(n).show(),$(s).show()):(i=document.createElement("div"),i.id="oleShowEffectDom",s=document.createElement("div"),s.id="oleShowEffectWidthDom",$(i).append($(s)),n=document.createElement("div"),n.id="oleShowEffectHeightDom",$(i).append($(n))),ole.resizeType){case"E":a.x=l.width+l.left-55,a.y=r.pageY+getSheetScrollTop()-153;break;case"W":a.x=l.left+45,a.y=r.pageY+getSheetScrollTop()-153;break;case"N":a.x=r.pageX+getSheetScrollLeft()-40,a.y=l.top+7;break;case"S":a.x=r.pageX+getSheetScrollLeft()-40,a.y=l.height+l.top-38;break;case"SW":a.x=l.left+45,a.y=l.height+l.top-48;break;case"NW":a.x=l.left+45,a.y=l.top+7;break;case"SE":a.x=l.width+l.left-55,a.y=l.height+l.top-48;break;case"NE":a.x=l.width+l.left-55,a.y=l.top+7}i.className="oleShowEffectDom",i.style.zIndex=o+10,i.style.left=a.x+"px",i.style.top=a.y+"px",t?s.innerHTML=jsMsg["Ole.Width"]+":&nbsp;"+t+"px":$(s).hide(),e?n.innerHTML=jsMsg["Ole.Height"]+":&nbsp;"+e+"px":$(n).hide(),$(i).insertAfter($("#"+chartPreview.getOleLayer()))},ole.resize=function(e){clearTextSelection(),chartPreview.hideContextualToolbar(),browser_ie&&(e=window.event);var t=isRTL?clientDim.width-e.clientX:e.clientX,o=e.clientY,r=ole.currObj,i=r.width,s=r.height,n=r.type,l=ole.objects[n].minWidth||100,a=ole.objects[n].minHeight||100,c=ole.objects[n].resizeCornersBehaviour,u=(getCursorPos(e),t+getNormalizedScrollLeft()-rowHeadWidth-(ole.diffX?ole.diffX:0)+20),d=e.clientY+getSheetScrollTop()-sheetTop+20;ole.onResizeStart&&(ole.onResizeStart=!1,ole.objects[n].onResizeStart&&ole.objects[n].onResizeStart(r.id,r.width,r.height,e)),appEvent.trigger("ole.onResize",[d,u,e]);var h=getNormalizedScrollLeft(),p=getSheetScrollTop();if(ole.resizeType.indexOf("E")>=0){var f=t+h-ole.currObjLeft-56;"chart"==ole.currObj.type&&(f=t+h-ole.currObjLeft-66),f=l>f?l:f,r.setWidth(f)._setSelectLayer(),prevOleWidth=f,this.showPropotionalEffect(b,f,ole.currObj.zIndex,e)}else if(ole.resizeType.indexOf("W")>=0){var y=t+h-rowHeadWidth+15;"chart"==ole.currObj.type&&(y=t+h-sheetLeft+25),y=0>y?0:y,maxMovableLeft=ole.currObjLeft+ole.currObjWd-l,y=maxMovableLeft>y?y:maxMovableLeft;var f=ole.currObjWd+(ole.currObjLeft-y);f=l>f?l:f,(y<r[isRTL?"right":"left"]||r.width>l)&&r.setLeft(y).setWidth(f)._setSelectLayer(),this.showPropotionalEffect(b,f,ole.currObj.zIndex,e)}if(ole.resizeType.indexOf("S")>=0){var b=o+p-sheetTop-ole.currObjTop-10;"chart"==ole.currObj.type&&(b=o+p-sheetTop-ole.currObjTop-20),b=a>b?a:b,"Proportional"!=c||"SE"!=ole.resizeType&&"SW"!=ole.resizeType?r.setHeight(b)._setSelectLayer():r.setHeight(ole.resizeProportionally(f,b,i,s))._setSelectLayer(),this.showPropotionalEffect(b,f,ole.currObj.zIndex,e)}else if(ole.resizeType.indexOf("N")>=0){var O=o+p-sheetTop+15;"chart"==ole.currObj.type&&(O=o+p-sheetTop+25),O=0>O?0:O,maxMovableTop=ole.currObjTop+ole.currObjHt-a,O=maxMovableTop>O?O:maxMovableTop;var b=ole.currObjHt+(ole.currObjTop-O);if(b=a>b?a:b,O<r.top||r.height>a)if("Proportional"!=c||"NE"!=ole.resizeType&&"NW"!=ole.resizeType)r.setTop(O).setHeight(b)._setSelectLayer();else{var g=r.top+-(ole.resizeProportionally(f,b,i,s)-s);r.setTop(g).setHeight(ole.resizeProportionally(f,b,i,s))._setSelectLayer()}this.showPropotionalEffect(b,f,ole.currObj.zIndex,e)}return ole.objects[n].onResize&&ole.objects[n].onResize(r.id,r.getWidth(),r.getHeight()),ole.isCalledOnce||(r.displayAssociativeElements("","none","none"),ole.isResized=!0,ole.isCalledOnce=!0,ole.contextMenuStatus=!1,ole.isActionBarLocked=!0,r.isResizedOnce=!0,r.isMovedOrResizedAfterClone=!0,r.cloneCountSinceLastDragOrResize=0),!1},ole.endResize=function(){document.removeEventListener("mousemove",document.OLEMouseMoveFunc,!1),document.removeEventListener("mouseup",document.OLEMouseUpFunc,!1),ole.onResize=!1;var e=ole.currObj;if(e.getSelectLayer().style.opacity=1,$("#oleShowEffectDom").is(":visible")&&$("#oleShowEffectDom").hide(),"undefined"!=typeof sheetScrollLeftId&&clearInterval(sheetScrollLeftId),"undefined"!=typeof sheetScrollTopId&&clearInterval(sheetScrollTopId),null!=document.getElementById("horizontalBorderLine")){var t=getObj("horizontalBorderLine"),o=t.parentNode;o.removeChild(t)}if(null!=document.getElementById("verticalBorderLine")){var r=getObj("verticalBorderLine"),o=r.parentNode;o.removeChild(r)}if(appEvent.off("scrollCallBack",setOleDimentiononOutsideViewportForResize),ole.isResized){ole.isResized=!1,ole.isCalledOnce=!1,ole.isActionBarLocked=!1;var i=e.type;e.positionActionBar(!0),parseFloat(e.el.style.top)<findThirdPaneYPos()&&(e.el.style.top=findThirdPaneYPos()+"px",e.setTop(parseFloat(e.el.style.top))._setSelectLayer(!0)),parseFloat(e.el.style.top)+e.height<getSheetScrollTop()&&setScrollTop(parseFloat(e.el.style.top)+e.height),parseFloat(e.el.style.top)>getSheetScrollTop()+getSheetHeight()&&setScrollTop(parseFloat(e.el.style.top)-getSheetHeight()),e.isSynchronized&&ole.objects[i].onResizeEnd&&ole.objects[i].onResizeEnd(e.id,e.getWidth(),e.getHeight())}},ole.resetZIndex=function(){for(x in OLE)OLE[x]&&OLE[x].setZIndex(101+BASEZINDEX)},ole.sortByZIndex=function(){var e=[],t=-1;for(x in OLE)OLE[x]&&(t++,e[t]=new Array(2),e[t][0]=OLE[x].id,e[t][1]=OLE[x].zIndex);return e.sort(function(e,t){return numA=e[1],numB=t[1],isNaN(numA)?0:isNaN(numB)?0:numA-numB}),e},ole.sortByPosition=function(){var e=[],t=-1;for(x in OLE)OLE[x]&&(t++,e[t]=new Array(3),e[t][0]=OLE[x].id,e[t][1]=OLE[x].top,e[t][2]=OLE[x].left);return e.sort(function(e,t){return numA=e[1],numB=t[1],numA===numB?e[2]-t[2]:numA-numB}),e},ole.clearObjectsPositionCache=function(){"undefined"!=typeof ole.objectsSortedByPos&&(ole.objectsSortedByPos=void 0,ole.pointer=void 0)},ole.getObjectsSortedByPos=function(){return"undefined"==typeof ole.objectsSortedByPos&&(ole.objectsSortedByPos=ole.sortByPosition()),ole.objectsSortedByPos},ole.setSelectAndFocusLayerEvents=function(e){var t=ole.objectsSubHeader[e].selectLayer;if(t.oncontextmenu=function(e){ole.currObj.showContextMenu(e).positionActionBar(!1)},ole.objects[e].onDbClick&&(t.ondblclick=function(){ole.objects[e].onDbClick()}),ole.objects[e].focusLayer){var o=ole.objectsSubHeader[e].focusLayer;o.oncontextmenu=function(e){ole.currFocusObj.switchLayers(e),ole.currObj.showContextMenu(e)},o.onmouseout=function(e){ole&&ole.currFocusObj&&ole.currFocusObj.blur(e)}}return this},ole.setResizeCorners=function(e){function t(){i.onmousedown=function(e){return isRTL?(ole.currObj.hideContextMenu(),-1!==i.style.cursor.indexOf("nw")?ole.startResize("NE",e):-1!==i.style.cursor.indexOf("ne")?ole.startResize("NW",e):-1!==i.style.cursor.indexOf("sw")?ole.startResize("SE",e):-1!==i.style.cursor.indexOf("se")?ole.startResize("SW",e):-1!==i.style.cursor.indexOf("w-")?ole.startResize("E",e):-1!==i.style.cursor.indexOf("n-")?ole.startResize("N",e):-1!==i.style.cursor.indexOf("e-")?ole.startResize("W",e):-1!==i.style.cursor.indexOf("s-")?ole.startResize("S",e):"pointer"===i.style.cursor?void 0:ole.startDrag(e)):(ole.currObj.hideContextMenu(),-1!==i.style.cursor.indexOf("nw")?ole.startResize("NW",e):-1!==i.style.cursor.indexOf("ne")?ole.startResize("NE",e):-1!==i.style.cursor.indexOf("sw")?ole.startResize("SW",e):-1!==i.style.cursor.indexOf("se")?ole.startResize("SE",e):-1!==i.style.cursor.indexOf("w-")?ole.startResize("W",e):-1!==i.style.cursor.indexOf("n-")?ole.startResize("N",e):-1!==i.style.cursor.indexOf("e-")?ole.startResize("E",e):-1!==i.style.cursor.indexOf("s-")?ole.startResize("S",e):"pointer"===i.style.cursor?void 0:ole.startDrag(e))},i.onmousemove=function(t){if(isRTL)var o=clientDim.width-t.clientX-rowHeadWidth-parseFloat(i.style.right)+getNormalizedScrollLeft();else var o=t.clientX-sheetLeft-parseFloat(i.style.left)+getSheetScrollLeft();var r=t.clientY-sheetTop-parseFloat(i.style.top)+getSheetScrollTop(),s=parseFloat(i.style.height),n=parseFloat(i.style.width);ole.onResize||(i.style.cursor=21>o&&21>r?isRTL?"ne-resize":"nw-resize":21>r&&o>n-20?"chart"===e?5>r||o>n-8?isRTL?"nw-resize":"ne-resize":"pointer":isRTL?"nw-resize":"ne-resize":21>o&&r>s-20?isRTL?"se-resize":"sw-resize":o>n-20&&r>s-20?isRTL?"sw-resize":"se-resize":5>o&&r>21?isRTL?"e-resize":"w-resize":5>r&&o>21?"n-resize":o>n-5&&r>21&&s-20>r?isRTL?"w-resize":"e-resize":o>21&&n-20>o&&r>s-5?"s-resize":"move")};for(var t=[2,5,7,8,11],o=0,r=t.length;r>o;o++)s&&(focusLayerTDs[t[o]].onmousedown=function(e){return ole.currFocusObj.switchLayers(e),ole.startDrag(e,!0)})}var o=ole.objects[e].resizeCorners,r=ole.objectsSubHeader[e],i=r.selectLayer;selectLayerTDs=i.getElementsByTagName("TD"),"none"===o?o=[]:o&&"all"!==o||(o=["NW","N","NE","W","E","SW","S","SE"]);var s=ole.objects[e].focusLayer;if(s){var n=r.focusLayer;focusLayerTDs=n.getElementsByTagName("TD")}return t(),this},ole.isRelativeClicked=function(e,t){var o=ole.currObj,r=ole.objects[o.type],i=o.id,s=!1,n=UTIL.DOM.contains;return n(o.getSelectLayer(),t)&&(s=!0,r.onSelectLayerMouseDown&&r.onSelectLayerMouseDown(i,e)),ole.objectsSubHeader[o.type].hasActionBar&&n(o.getActionBar(),t)?(s=!0,r.onActionBarMouseDown&&r.onActionBarMouseDown(i,e)):n(o.el,t)?(s=!0,r.onOLEObjMouseDown&&r.onOLEObjMouseDown(i,e)):r.focusLayer&&n(o.getFocusLayer(),t)?(s=!0,r.onFocusLayerMouseDown&&r.onFocusLayerMouseDown(i,e)):sheetMenu.isCursorOverMenu(e)&&(s=!0),s},ole._onmousedown=function(e){if(!(!ISMINDLG&&dialogEl&&"yes"===dialog_modal||sheetdialog.isDialogOpen()))if(ole.currObj){var t,o;browser_ie?(t=e.button,o=e.srcElement):browser_nn6&&(t=e.which,o=e.target);var r=ole.getObjectProperty(ole.currObj.type,"dependantsIdAry");if(r&&(-1!==r.indexOf(o.id)||checkForDependants(r,o)))return;if(1!==t&&ole.onDrag)return!1;if(ole.isRelativeClicked(e,o))ole.isFirstClickOutsideOLECompleted=!1,ole.objects[ole.currObj.type].onMouseDownOverOLEElements&&ole.objects[ole.currObj.type].onMouseDownOverOLEElements(ole.currObj.id,e);else{ole.objects[ole.currObj.type].onMouseDownOutsideOLEElements&&ole.objects[ole.currObj.type].onMouseDownOutsideOLEElements(ole.currObj.id,e),ole.isFirstClickOutsideOLECompleted||(ole.objects[ole.currObj.type].onFirstMouseDownOutsideOLEElements&&ole.objects[ole.currObj.type].onFirstMouseDownOutsideOLEElements(ole.currObj.id,e),ole.isFirstClickOutsideOLECompleted=!0),ole.currObj.deSelect();var i=getObj(ole.lastClonedSelectLayer);i&&getObj(i).parentNode.removeChild(i),ole.endDrag(void 0,ole.lastClonedSelectLayer,void 0)}}else ole.currFocusObj&&(ole.currFocusObj.getFocusLayer().style.display="none",ole.currFocusObj=null)},window.addEventListener("mousedown",function(e){ole._onmousedown(e)},!1),ole.handleKeyDownEvents=function(e){if(ole.currObj){if(browser_ie)var e=window.event;return ole.conf.onKeyDown(e)}},ole.handleKeyUpEvents=function(e){if(ole.currObj){if(browser_ie)var e=window.event;return ole.conf.onKeyUp(e)}},ole.getWorkSpace=function(){return ole.workSpace},ole.setWorkSpace=function(e){ole.workSpace=e},ole.focus=function(){var e=ole.conf.focusElement;e&&document.activeElement.id!==e&&getObj(e).focus()},ole.blur=function(){var e=ole.conf.focusElement;e&&document.activeElement.id===e&&getObj(e).blur()},ole.dispatchEvents=function(){for(var e=ole.eventBuffer,t=ole.eventBuffer.length,o=0;t>o;o++)ole.objects[e[o][1]][e[o][2]](e[o][0],e[o][3],e[o][4]);ole.eventBuffer=[]},ole.addToEventBuffer=function(e){var t=ole.eventBuffer.length;if(0===t)return void(ole.lastUpdatedEventInfo=ole.eventBuffer[0]=e);var o,r;if(o=e[0],r=e[2],ole.lastUpdatedEventInfo[0]===o&&ole.lastUpdatedEventInfo[2]===r)return void(ole.lastUpdatedEventInfo=ole.eventBuffer[t-1]=e);for(var i=0;t>i;i++)if(ole.eventBuffer[0]===o&&ole.eventBuffer[2]===r)return void(ole.lastUpdatedEventInfo=ole.eventBuffer[i]=e);ole.lastUpdatedEventInfo=ole.eventBuffer[t]=e},ole.getDependants=function(){for(var e,t=[],o=0,r=ole.typesRegistered.length;r>o;o++)e=ole.typesRegistered[o],t=t.concat(ole.objects[e].dependantsIdAry);return t},ole.eventBuffer=[];
var Range=function(t,e,n,s){this.startRow=t,this.startCol=e,this.endRow=n,this.endCol=s};Range.prototype={isSingle:function(){return!(this.endRow-this.startRow|this.endCol-this.startCol)},isRow:function(){return 0==this.startCol&&this.endCol==getColMax()-1},isCol:function(){return 0==this.startRow&&this.endRow==getRowMax()-1},isWhole:function(){return this.isRow()&&this.isCol()},getAddress:function(){return this.startRow+"R:"+this.startCol+"C"},getFirstLabel:function(){},getLastLabel:function(){},getPrimal:function(){return this.startRow+":"+this.startCol},getIterator:function(t){var e=this.getOrderedRange();return new Iterator(e.sR,e.sC,e.eR,e.eC,t)},getRealRange:function(){return{sR:this.startRow,eR:this.endRow,sC:this.startCol,eC:this.endCol}},equals:function(t){var e=this.startRow-t.startRow,n=this.startCol-t.startCol,s=this.endRow-t.endRow,o=this.endCol-t.endCol;return!(e&n&s&o)},intersects:function(t){return!(t.startRow>this.endRow||t.startCol>this.endCol||t.endRow<this.startRow||t.endCol<this.startCol)},subset:function(t){return this.startRow<=t.startRow&&t.endRow<=this.endRow&&this.startCol<=t.startCol&&t.endCol<=this.endCol},union:function(t){this.startRow=this.startRow>t.startRow?t.startRow:this.startRow,this.startCol=this.startCol>t.startCol?t.startCol:this.startCol,this.endRow=this.endRow<t.endRow?t.endRow:this.endRow,this.endCol=this.endCol<t.endCol?t.endCol:this.endCol},getOrderedRange:function(){var t={};return this.startRow<=this.endRow?(t.sR=this.startRow,t.eR=this.endRow):(t.sR=this.endRow,t.eR=this.startRow),this.startCol<=this.endCol?(t.sC=this.startCol,t.eC=this.endCol):(t.sC=this.endCol,t.eC=this.startCol),t},getVisibleRowsCount:function(){return isUndefined(this.visibleRowsCount)&&(this.visibleRowsCount=this.endRow-this.startRow+1-Row.getHiddenRowCount(this.startRow,this.endRow)),this.visibleRowsCount}},Range.getOrderedRange=function(t,e,n,s){var o={};return n>=t?(o.sR=t,o.eR=n):(o.sR=n,o.eR=t),s>=e?(o.sC=e,o.eC=s):(o.sC=s,o.eC=e),o},Range.getPrimal=function(t,e){return t+":"+e},Range.getIterator=function(t,e,n,s){return new Range(t,e,n,s).getIterator()},Range.executeInsertDeleteOperation=function(t){var t="INSERTLEFT"===t?ActionConstants.INSERT_CELL_LEFT:"INSERTTOP"===t?ActionConstants.INSERT_CELL_TOP:"DELETERIGHT"===t?ActionConstants.DELETE_CELL_RIGHT:ActionConstants.DELETE_CELL_BOTTOM,e=getCellRange(),n=e.startRow,s=e.startCol,o=e.endRow,r=e.endCol;if(void 0!==Merge.getCellInfo(n,s)&&(n=Math.max(Merge.getCellInfo(n,s).startRow,n),s=Math.max(Merge.getCellInfo(n,s).startCol,s),o=Math.max(Merge.getCellInfo(n,s).endRow,o),r=Math.max(Merge.getCellInfo(n,s).endCol,r)),void 0!==Filter.getInstance()){if((t===ActionConstants.INSERT_CELL_TOP||t===ActionConstants.DELETE_CELL_BOTTOM)&&o<Filter.getInstance().range.sr&&(s>Filter.getInstance().range.sc&&s<=Filter.getInstance().range.ec||r<Filter.getInstance().range.ec&&r>=Filter.getInstance().range.sc))return void showAlertDialog(jsMsg["Insert.CannotInsertOnFilterRange"]);if((t===ActionConstants.INSERT_CELL_LEFT||t===ActionConstants.DELETE_CELL_RIGHT)&&r<Filter.getInstance().range.sc&&(n>Filter.getInstance().range.sr&&n<=Filter.getInstance().range.er||o<Filter.getInstance().range.er&&o>=Filter.getInstance().range.sr))return void showAlertDialog(jsMsg["Insert.CannotInsertOnFilterRange"]);if((t===ActionConstants.INSERT_CELL_LEFT||t===ActionConstants.INSERT_CELL_TOP)&&n===Filter.getInstance().range.sr&&(s===Filter.getInstance().range.sc&&r!==Filter.getInstance().range.ec||s!==Filter.getInstance().range.sc&&r===Filter.getInstance().range.ec))return void showAlertDialog(jsMsg["Insert.CannotInsertOnFilterRange"])}var a=o-n+1,i=r-s+1;if(t==ActionConstants.INSERT_CELL_TOP&&a+usedCursRow>getRowMax()-1||t==ActionConstants.INSERT_CELL_LEFT&&i+usedCursCol>getColMax()-1)return void showAlertDialog(jsMsg["Insert.CannotInsert"]);if(t===ActionConstants.INSERT_CELL_TOP?isPartOfMergeOrArray(n,s,getRowMax()-1,r,"merge"):t==ActionConstants.INSERT_CELL_LEFT?isPartOfMergeOrArray(n,s,o,getColMax()-1,"merge"):"DELETEBOTTOM"==t?isPartOfMergeOrArray(n,s,getRowMax()-1,r,"merge"):isPartOfMergeOrArray(n,s,o,getColMax()-1,"merge"))return void showAlertDialog(jsMsg["Insert.CannotInsertOnMergedCells"]);if(!((t===ActionConstants.INSERT_CELL_LEFT||t===ActionConstants.DELETE_CELL_RIGHT?isPivotOrArrayRange(n,s,o,getColMax()-1):isPivotOrArrayRange(n,s,getRowMax()-1,r))||("INSERTLEFT"===t||"DELETERIGHT"===t?ProtectedRanges.isRangeLocked(n,s,o,getColMax()-1,t):ProtectedRanges.isRangeLocked(n,s,getRowMax()-1,r,t))||(t===ActionConstants.DELETE_CELL_RIGHT||t===ActionConstants.DELETE_CELL_BOTTOM)&&Discussion.isDisRangeDelete(CURRSHEETNAME,t==ActionConstants.DELETE_CELL_BOTTOM?!0:!1,t==ActionConstants.DELETE_CELL_BOTTOM?n:s,t==ActionConstants.DELETE_CELL_BOTTOM?a:i))){var l=new AjaxRequest,C=actionManager.addRequest.bind(actionManager),R=new RequestParameters(t);R.setParameters(WorkSheets.getAssociatedActiveSheetName(),n,s,o,r),l.init("POST",R.getURL(),!0,R.getParametersAsString()),C(l)}},Range.executeShiftOperation=function(t,e){var n=appEvent.isDefaultPrevented(appEvent.trigger("grid.beforeInsertRowOrColumn"));n||Range.meta.shiftOperations[e][t].apply(void 0,Array.prototype.slice.call(arguments,2))},Range.executeShiftOperationCallback=function(t,e,n,s){Range.meta.shiftOperationsCallback[e][t].apply(void 0,Array.prototype.slice.call(arguments,2)),!arguments[3]&&Range.shiftCellFieldAndRange[e][t](arguments[2]),appEvent.trigger("grid.shift",[s,n]),appEvent.trigger("UpdateDiscussionRanges",[n.sn,"ROW"==e?!0:!1,"DELETE"==t?!0:!1,n.si,n.count])},Range.shiftCellFieldAndRange={ROW:{INSERT:function(t){if(t&&t.sn===CURRSHEETNAME){var e=t.si,n=t.count,s=getRowMax(),o=currRow+n>s?s-currRow:n,r=getCellRange();isCellRange()&&(r.startRow>=e&&(selectedCellRange.startRow+=o),r.endRow>=e&&(selectedCellRange.endRow+=o)),ActiveCellInfo.getStartRow()>=e&&(currRow+=o,ActiveCellInfo.reset(currRow,currCol))}},DELETE:function(t){if(t&&t.sn===CURRSHEETNAME){var e=t.si,n=t.count,s=getCellRange(),o=e+n-1;isCellRange()&&(s.startRow>=e&&(selectedCellRange.startRow=s.startRow>o?selectedCellRange.startRow-n:e),s.endRow<=o?s.startRow>=e?selectedCellRange.endRow=e:s.endRow>=e&&(selectedCellRange.endRow=e-1):selectedCellRange.endRow-=n);var r=ActiveCellInfo.getStartRow();r>=e&&o>=r?(currRow=e,!isCellFieldSPANHided()&&(ActiveCellInfo.isEditingCellDeleted=!0),ActiveCellInfo.reset(currRow,currCol)):r>o&&(currRow-=n,ActiveCellInfo.reset(currRow,currCol))}}},COLUMN:{INSERT:function(t){if(t&&t.sn===CURRSHEETNAME){var e=t.si,n=t.count,s=getColMax(),o=currCol+n>s?s-currCol:n,r=getCellRange();if(isCellRange()){r.startCol>=e&&(selectedCellRange.startCol+=o),r.endCol>=e&&(selectedCellRange.endCol+=o);for(var a=r.startCol,i=r.endCol;i>=a;a+=1){var l=getColHead(a);l&&(l.className="colHeadFocus")}}ActiveCellInfo.getStartCol()>=e&&(currCol+=o,ActiveCellInfo.reset(currRow,currCol))}},DELETE:function(t){if(t&&t.sn===CURRSHEETNAME){var e=t.si,n=t.count,s=getCellRange(),o=s.endCol,r=e+n-1;if(isCellRange()){s.startCol>=e&&(selectedCellRange.startCol=s.startCol>r?selectedCellRange.startCol-n:e),s.endCol<=r?s.startCol>=e?selectedCellRange.endCol=e:s.endCol>=e&&(selectedCellRange.endCol=e-1):selectedCellRange.endCol-=n;for(var a=s.startCol,i=s.endCol;i>=a;a+=1){var l=getColHead(a);l&&(l.className="colHeadFocus")}for(;o>=a;a++){var l=getColHead(a);l&&(l.className="")}}var C=ActiveCellInfo.getStartCol();C>=e&&r>=C?(currCol=e,!isCellFieldSPANHided()&&(ActiveCellInfo.isEditingCellDeleted=!0),ActiveCellInfo.reset(currRow,currCol)):C>r&&(currCol-=n,ActiveCellInfo.reset(currRow,currCol))}},INSERT_COPY_COLUMN:function(){},INSERT_CUT_COLUMN:function(){}}};
function getCurrentSelection(){if(isCellRange()){var e=getCellRange();return isWholeSheetSelected()?getCellLabel(0,0)+":"+getCellLabel(getRowMax()-1,getColMax()-1):isRowSelected()?getCellLabel(e.startRow,0)+":"+getCellLabel(e.endRow,getColMax()-1):isColSelected()?getCellLabel(0,e.startCol)+":"+getCellLabel(getRowMax()-1,e.endCol):getCellLabel(e.startRow,e.startCol)+":"+getCellLabel(e.endRow,e.endCol)}var t=ActiveCellInfo;if(t){var r=t.getStartRow(),o=t.getStartCol();if(t.isMerged()){var n=t.getEndRow(),l=t.getEndCol();if(!isUndefined(n)&&!isUndefined(l))return getCellLabel(r,o)+":"+getCellLabel(n,l)}else if(!isUndefined(r)&&!isUndefined(o))return getCellLabel(r,o)}return""}function getCurrentSelectionRange(){if(isCellRange()){var e=getCellRange();return isWholeSheetSelected()?(e.endRow=getRowMax()-1,e.endCol=getColMax()-1):isRowSelected()?(e.startCol=0,e.endCol=getColMax()-1):isColSelected()&&(e.startRow=0,e.endRow=getRowMax()-1),e}return{startRow:ActiveCellInfo.getStartRow(),startCol:ActiveCellInfo.getStartCol(),endRow:ActiveCellInfo.getEndRow(),endCol:ActiveCellInfo.getEndCol()}}var _merge=function(){Range.apply(this,arguments)};_merge.prototype=new Range,_merge.prototype.getColSpan=function(){return this.endCol-this.startCol+1},_merge.prototype.getRowSpan=function(){return this.endRow-this.startRow+1},_merge.prototype.getIterator=function(){var e=this.getOrderedRange();return new MergeIterator(e.sR,e.sC,e.eR,e.eC)},_merge.prototype.getDOM=function(){return mergeDOMInfo[this.getPrimal()]},_merge.prototype.getHeight=function(){return getRowTop(this.endRow)+getRowHeight(this.endRow)-getRowTop(this.startRow)},_merge.prototype.getWidth=function(){return getColLeft(this.endCol)+getColWidth(this.endCol)-getColLeft(this.startCol)},_merge.prototype.getTop=function(){return getRowTop(this.startRow)},_merge.prototype.getLeft=function(){return getColLeft(this.startCol)};var Merge={getWhole:function(){return this._mergeAll||(this._mergeAll=new _merge(0,0,65535,255)),this._mergeAll},resizeDOM:function(e,t,r){switch(r){case"COLS":var o=new _merge(0,e,totRows-1,t);o.getIterator().iterateNNotifyAboveStartCol(this._resizeDOMByCol);break;case"ROWS":var o=new _merge(e,0,t,totCols-1);o.getIterator().iterateNNotifyAboveStartRow(this._resizeDOMByRow)}},_resizeDOMByCol:function(e,t,r){var o=r.getDOM();if(o){var n=r.getWidth(),l=r.getLeft();o.mC.style.width=n+"px",o.mC.style.left=l+"px",setCellWidthForVAlignedCell(o.mC),ISFREEZED&&(o.mC1&&(o.mC1.style.width=n+"px",o.mC1.style.left=l+"px",setCellWidthForVAlignedCell(o.mC1)),o.mC2&&(o.mC2.style.width=n+"px",o.mC2.style.left=l+"px",setCellWidthForVAlignedCell(o.mC2)),o.mC3&&(o.mC3.style.width=n+"px",o.mC3.style.left=l+"px",setCellWidthForVAlignedCell(o.mC3)))}},_resizeDOMByRow:function(e,t,r){var o=r.getDOM();if(o){var n=r.getHeight(),l=r.getTop();o.mC.style.height=n+"px",o.mC.style.top=l+"px",setCellHeightForVAlignedCell(o.mC),o.mC.style.display=0==n?"none":"",ISFREEZED&&(o.mC1&&(o.mC1.style.height=n+"px",o.mC1.style.top=l+"px",setCellHeightForVAlignedCell(o.mC1)),o.mC2&&(o.mC2.style.height=n+"px",o.mC2.style.top=l+"px",setCellHeightForVAlignedCell(o.mC2)),o.mC3&&(o.mC3.style.height=n+"px",o.mC3.style.top=l+"px",setCellHeightForVAlignedCell(o.mC3)))}},update:function(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t][JSONConstants.START_ROW],o=e[t][JSONConstants.END_ROW],n=e[t][JSONConstants.START_COLUMN],l=e[t][JSONConstants.END_COLUMN];this.add(r,n,o,l,e[t])}},add:function(e,t,r,o,n){var l=new Range(e,t,r,o),i=l.getOrderedRange(),a=i.sR,g=i.eR,s=i.sC,f=i.eC,C=Range.getPrimal(a,s);if(!mergeDOMInfo[C]){var m=sheetPaneId;ISFREEZED&&FREEZED_ROW>e&&availableStartRow>FREEZED_ROW&&(m=sheetPane2Id);var v=getCell(g,f,m,!0),d="";if(v){var R=new RegExp(getCSSStyleRegex("borderRight")).exec(v.className);if(null!=R&&(d+=R[0]),""!=v.style.borderRight){v.style.borderRight}var R=new RegExp(getCSSStyleRegex("borderBottom")).exec(v.className);if(null!=R&&(d+=R[0]),""!=v.style.borderBottom){v.style.borderBottom}}clearCoveredCells(e,t,r,o);var c=new _merge(a,s,g,f);if(mergeInfo.mergeList[C]=c,appEvent.trigger("cell.merge.add",[a,s,g,f]),c.isWhole())mergeInfo._mergeAll=!0;else if(c.isCol())for(var u=s;f>=u;u++)mergeInfo.colMerge[u]=c;else if(c.isRow())for(var h=a;g>=h;h++)mergeInfo.rowMerge[h]=c;else for(var h=a;g>=h;h++)for(var u=s;f>=u;u++)mergeInfo.cellMerge[Range.getPrimal(h,u)]=c;return this.addDOM(a,s,g,f,n),jsTHROWAWAY_VIEW||userPresence.handleMerge(e,t),c}},addDOM:function(e,t,r,o,n){doMergeCells(e,t,r,o,n)},remove:function(e,t,r,o,n,l){var i=new _merge(e,t,r,o),a=Merge.getCellInfo(e,t);i.getIterator().iterate(n?this.removeDOM:this._remove),jsTHROWAWAY_VIEW||userPresence.handleMerge(e,t),a&&!l&&appEvent.trigger("cell.merge.remove",[a.startRow,a.startCol,a.endRow,a.endCol])},removeDOM:function(e,t,r){if(r){var o=getAvailableStartRow(),n=getAvailableStartCol(),l=getAvailableEndRow(),i=getAvailableEndCol(),a=new Range(o,n,l,i);if(a.intersects(r)||r.startRow<FREEZED_ROW)return;if(-1==o||-1==l){var o=lastRequestedTileInfo.startRow,l=lastRequestedTileInfo.endRow;if(a=new Range(o,n,l,i),a.intersects(r))return}}var g=Range.getPrimal(e,t),s=mergeDOMInfo[g];if(s){var f=s.mC;if(f&&f.parentNode&&(appEvent.trigger("grid.merge.removeDOM",[e,t,f]),f.parentNode.removeChild(f),ISFREEZED)){if(FREEZED_ROW>0){var f=s.mC2;f&&f.parentNode&&f.parentNode.removeChild(f)}if(FREEZED_COL>0){var f=s.mC3;f&&f.parentNode&&f.parentNode.removeChild(f)}if(FREEZED_COL>0&&FREEZED_ROW>0){var f=s.mC1;f&&f.parentNode&&f.parentNode.removeChild(f)}}delete mergeDOMInfo[g]}},getIterator:function(e,t,r,o){return new _merge(e,t,r,o).getIterator()},_remove:function(e,t,r){r.isWhole()?Merge._removeAll():r.isRow()?Merge._removeRow(r.startRow,r.endRow):r.isCol()?Merge._removeCol(r.startCol,r.endCol):Merge._removeCell(r.startRow,r.startCol,r.endRow,r.endCol),Merge.removeDOM(r.startRow,r.startCol)},_removeCell:function(e,t,r,o){var n=r-e,l=o-t;do{var i=r-n,a=l;do{var g=o-a;delete mergeInfo.cellMerge[Range.getPrimal(i,g)],a--}while(a>=0);n--}while(n>=0);delete mergeInfo.mergeList[Range.getPrimal(e,t)]},_removeCol:function(e,t){var r=t-e;do{var o=t-r;delete mergeInfo.colMerge[o],--r}while(r>=0);delete mergeInfo.mergeList[Range.getPrimal(0,e)]},_removeRow:function(e,t){var r=t-e;do{var o=t-r;delete mergeInfo.rowMerge[o],--r}while(r>=0);delete mergeInfo.mergeList[Range.getPrimal(e,0)]},_removeAll:function(){mergeInfo._mergeAll=!1,delete mergeInfo.mergeList[Range.getPrimal(0,0)]},bindDOMObjcts:function(e){var t=mergeDOMInfo;for(var r in t){var o=t[r],n=o.mC;if(n){var l=parseInt(n.style.top),i=parseInt(n.style.left),a=findMergedCell(l,i,e);switch(e){case sheetPane1Id:o.mC1=a;break;case sheetPane2Id:o.mC2=a;break;case sheetPane3Id:o.mC3=a}}}},unBindDOMObjcts:function(){var e=mergeDOMInfo;for(var t in e){{var r=e[t];r.mC}r.mC1&&delete r.mC1,r.mC2&&delete r.mC2,r.mC3&&delete r.mC3}},getCellInfo:function(e,t){return mergeInfo._mergeAll?Merge.getWhole():mergeInfo.colMerge&&mergeInfo.colMerge[t]?mergeInfo.colMerge[t]:mergeInfo.rowMerge&&mergeInfo.rowMerge[e]?mergeInfo.rowMerge[e]:mergeInfo.cellMerge?mergeInfo.cellMerge[e+":"+t]:void 0},getRootCellInfo:function(e,t){var r=Range.getPrimal(e,t);return mergeInfo.mergeList[r]},isCovered:function(e,t){var r=this.getCellInfo(e,t);return r?e!=r.startRow||t!=r.startCol:!!r},isRowMergeXists:function(){var e=!1;if(mergeInfo._mergeAll)e=!0;else{var t=mergeInfo.rowMerge;for(var r in t){e=!0;break}}return e},isColMergeXists:function(){var e=!1;if(mergeInfo._mergeAll)e=!0;else{var t=mergeInfo.colMerge;for(var r in t){e=!0;break}}return e},isSheetMergeXists:function(){return this.isRowMergeXists()&&this.isColMergeXists()},extendRange:function(e){var t=mergeInfo.mergeList;for(var r in t){var o=t[r];if(e.intersects(o)&&!e.subset(o)){e.union(o),this.extendRange(e);break}}},extendCol:function(e){if(e.isCol()){var t=mergeInfo.mergeList;for(var r in t){var o=t[r];if(o.isCol()&&e.intersects(o)&&!e.subset(o)){e.union(o),this.extendRange(e);break}}}},extendRow:function(e){if(e.isRow()){var t=mergeInfo.mergeList;for(var r in t){var o=t[r];if(o.isRow()&&e.intersects(o)&&!e.subset(o)){e.union(o),this.extendRange(e);break}}}},reset:function(){mergeInfo.mergeList={},mergeInfo.rowMerge={},mergeInfo.colMerge={},mergeInfo.cellMerge={},mergeInfo._mergeAll=!1,mergeDOMInfo={}},shiftRow:function(e,t,r){r?Merge._insertRow(e,t):Merge._deleteRow(e,t)},_insertRow:function(e,t){var r,o,n,l,i=mergeInfo.mergeList,a=mergeInfo.cellMerge,g={},s={},f=[];for(var C in i){var m=i[C].startRow,v=i[C].startCol,d=i[C].endCol,R=i[C].endRow,c=i[C].getRowSpan();if(m>=e){var u=(getRowTop(m),getColLeft(v),i[C].getDOM());if(r=mergeInfo.mergeList[C].startRow=i[C].startRow=i[C].startRow+t,o=i[C].startCol,n=mergeInfo.mergeList[C].endRow=i[C].endRow=i[C].endRow+t,l=i[C].endCol,g[Range.getPrimal(r,o)]=i[C],i[C].isRow()){for(var h=t>c?c:t,w=h,I=m,p=m+h;p>I;I++)delete mergeInfo.rowMerge[I];var M=R+1,_=t-c;_>0&&(M+=_);for(var I=M,p=M+w;p>I;I++)mergeInfo.rowMerge[I]=i[C]}else{for(var h=t>c?c:t,w=h,I=m,p=m+h;p>I;I++)for(var O=v;d>=O;O++)f.contains(Range.getPrimal(I,O))||delete a[Range.getPrimal(I,O)];var M=R+1,_=t-c;_>0&&(M+=_);for(var I=M,p=M+w;p>I;I++)for(var O=v;d>=O;O++){var E=Range.getPrimal(I,O);a[E]=i[C],f.push(E)}}if(u){var S=u.mC,x=i[C].getTop();S&&(s[Range.getPrimal(r,o)]=mergeDOMInfo[C],S.style.top=x+"px"),ISFREEZED&&(u.mC1&&(u.mC1.style.top=x+"px"),u.mC2&&(u.mC2.style.top=x+"px"),u.mC3&&(u.mC3.style.top=x+"px"))}}else if(!(e>=m+c)&&e>m&&m+c>=e){var u=(getRowTop(m),getColLeft(v),i[C].getDOM());if(r=i[C].startRow,o=i[C].startCol,n=mergeInfo.mergeList[C].endRow=i[C].endRow=i[C].endRow+t,l=i[C].endCol,g[Range.getPrimal(r,o)]=i[C],s[Range.getPrimal(r,o)]=mergeDOMInfo[C],i[C].isRow())for(var I=R+1,p=I+t;p>I;I++)mergeInfo.rowMerge[I]=i[C];else for(var I=R+1,p=I+t;p>I;I++)for(var O=v;d>=O;O++)a[Range.getPrimal(I,O)]=i[C];if(u){var S=u.mC,y=i[C].getHeight();S&&(S.style.height=y+"px"),ISFREEZED&&(u.mC1&&(u.mC1.style.height=y+"px"),u.mC2&&(u.mC2.style.height=y+"px"),u.mC3&&(u.mC3.style.height=y+"px"))}}else r=i[C].startRow,o=i[C].startCol,g[Range.getPrimal(r,o)]=i[C],s[Range.getPrimal(r,o)]=mergeDOMInfo[C]}mergeInfo.mergeList=g,mergeDOMInfo=s},_deleteRow:function(e,t){var r,o,n,l,i,a=mergeInfo.mergeList,g=mergeInfo.cellMerge,s={},f={};for(var C in a){var m=a[C].startRow,v=a[C].startCol,d=a[C].endRow,R=a[C].endCol,c=a[C].getRowSpan();if(m>=e&&e+t>m){var u=(getRowTop(m),getColLeft(v),a[C].getDOM());if(a[C].isRow())for(var h=m;d>=h;h++)delete mergeInfo.rowMerge[h];else if(a[C].isCol())for(var h=v;R>=h;h++)delete mergeInfo.colMerge[h];else for(var h=m;d>=h;h++)for(var w=v;R>=w;w++)g[Range.getPrimal(h,w)]===a[C]&&delete g[Range.getPrimal(h,w)];if(u){var I=u.mC;if(I){delete mergeDOMInfo[C];var p=getObj("mCC");p.removeChild(I)}if(ISFREEZED){if(u.mC1){var M=u.mC1,_=getObj("mCC1");_.removeChild(M)}if(u.mC2){var O=u.mC2,E=getObj("mCC2");E.removeChild(O)}if(u.mC3){var S=u.mC3,x=getObj("mCC3");x.removeChild(S)}}}}else if(!(e>=m+c)&&e>m&&m+c>=e&&!a[C].isCol()){var u=(getRowTop(m),getColLeft(v),a[C].getDOM());if(i=c+m>e+t?t:d-e+1,i>=1){if(r=a[C].startRow,o=a[C].startCol,n=a[C].endRow=d-i,l=a[C].endCol,s[Range.getPrimal(r,o)]=a[C],a[C].isRow())for(var h=d,y=d-i;h>y;h--)delete mergeInfo.rowMerge[h];else for(var h=d,y=d-i;h>y;h--)for(var w=v;R>=w;w++)delete g[Range.getPrimal(h,w)];if(u){var I=u.mC,D=a[C].getHeight();if(r===n&&o===l){var b=I.innerHTML,A=I.getAttribute("fn");if(delete mergeDOMInfo[C],delete g[Range.getPrimal(r,o)],I){var p=getObj("mCC");p.removeChild(I)}var L=getCell(r,o);L.innerHTML=b,L.style.overflow="visible",""!==b&&A&&""!=A?(L.setAttribute("cV",b),L.setAttribute("fn",b)):A&&""!=A?(L.removeAttribute("cV"),L.setAttribute("fn",A)):(L.removeAttribute("cV"),L.removeAttribute("fn"),L.removeAttribute("format")),appEvent.trigger("cell.setcontent",[L,r,o,totCols,b])}else f[C]=mergeDOMInfo[C],I&&(I.style.height=D+"px");if(ISFREEZED)if(r===n&&o===l){if(u.mC1){var F=getObj("mCC1");F.removeChild(u.mC1)}if(u.mC2){var P=getObj("mCC2");P.removeChild(u.mC2)}if(u.mC3){var T=getObj("mCC3");T.removeChild(u.mC3)}}else u.mC1&&(u.mC1.style.height=D+"px"),u.mC2&&(u.mC2.style.height=D+"px"),u.mC3&&(u.mC3.style.height=D+"px")}}}else if(m>=e+t){var u=(getRowTop(m),getColLeft(v),a[C].getDOM());if(r=a[C].startRow=a[C].startRow-t,o=a[C].startCol,n=a[C].endRow=a[C].endRow-t,l=a[C].endCol,s[Range.getPrimal(r,o)]=a[C],a[C].isRow()){var W=d-t+1;W=m>W?m:W;for(var h=W;d>=h;h++)delete mergeInfo.rowMerge[h];var N=m;N=t>c?m-(t-c):m;for(var h=m-t;N>h;h++)mergeInfo.rowMerge[h]=a[C]}else{var W=d-t+1;W=m>W?m:W;for(var h=W;d>=h;h++)for(var w=v;R>=w;w++)delete g[Range.getPrimal(h,w)];var N=m;N=t>c?m-(t-c):m;for(var h=m-t;N>h;h++)for(var w=v;R>=w;w++)g[Range.getPrimal(h,w)]=a[C]}if(u){var I=u.mC,Z=a[C].getTop();I&&(f[Range.getPrimal(r,o)]=mergeDOMInfo[C],delete mergeDOMInfo[C],I.style.top=Z+"px"),ISFREEZED&&(u.mC1&&(u.mC1.style.top=Z+"px"),u.mC2&&(u.mC2.style.top=Z+"px"),u.mC3&&(u.mC3.style.top=Z+"px"))}}else r=mergeInfo.mergeList[C].startRow=a[C].startRow,o=a[C].startCol,s[Range.getPrimal(r,o)]=a[C],f[Range.getPrimal(r,o)]=mergeDOMInfo[C]}mergeInfo.mergeList=s,mergeDOMInfo=f},shiftColumn:function(e,t,r){r?this._insertCol(e,t):this._deleteCol(e,t)},_insertCol:function(e,t){var r,o,n,l,i=mergeInfo.mergeList,a=mergeInfo.cellMerge,g={};for(var s in i){var f=i[s].startRow,C=i[s].startCol,m=i[s].endCol,v=i[s].endRow,d=i[s].getColSpan();if(C>=e){var R=(getRowTop(f),getColLeft(C),i[s].getDOM());if(r=i[s].startRow,o=i[s].startCol=i[s].startCol+t,n=i[s].endRow,l=i[s].endCol=i[s].endCol+t,g[Range.getPrimal(r,o)]=i[s],i[s].isCol()){for(var c=t>d?d:t,u=c,h=C,w=C+c;w>h;h++)delete mergeInfo.colMerge[h];var I=m+1,p=t-d;p>0&&(I+=p);for(var h=I,w=I+u;w>h;h++)mergeInfo.colMerge[h]=i[s]}else{for(var c=t>d?d:t,u=c,h=f;v>=h;h++)for(var M=C,w=C+c;w>M;M++)delete a[Range.getPrimal(h,M)];var I=m+1,p=t-d;p>0&&(I+=p);for(var h=f;v>=h;h++)for(var M=I,w=I+u;w>M;M++)a[Range.getPrimal(h,M)]=i[s]}if(R){var _=R.mC,O=i[s].getLeft();_&&(mergeDOMInfo[Range.getPrimal(r,o)]=mergeDOMInfo[s],delete mergeDOMInfo[s],_.style.left=O+"px"),ISFREEZED&&(R.mC1&&(R.mC1.style.left=O+"px"),R.mC2&&(R.mC2.style.left=O+"px"),R.mC3&&(R.mC3.style.left=O+"px"))}}else if(!(e>=C+d)&&e>C&&C+d>=e){var R=(getRowTop(f),getColLeft(C),i[s].getDOM());if(r=i[s].startRow,o=i[s].startCol,n=i[s].endRow,l=i[s].endCol=i[s].endCol+t,g[Range.getPrimal(r,o)]=i[s],i[s].isCol())for(var h=m+1,w=h+t;w>h;h++)mergeInfo.colMerge[h]=i[s];else for(var h=f;v>=h;h++)for(var M=m+1,w=M+t;w>M;M++)a[Range.getPrimal(h,M)]=i[s];if(R){var _=R.mC,E=i[s].getWidth();_&&(_.style.width=E+"px"),ISFREEZED&&(R.mC1&&(R.mC1.style.width=E+"px"),R.mC2&&(R.mC2.style.width=E+"px"),R.mC3&&(R.mC3.style.width=E+"px"))}}else r=i[s].startRow,o=i[s].startCol,g[Range.getPrimal(r,o)]=i[s]}mergeInfo.mergeList=g},_deleteCol:function(e,t){var r,o,n,l,i,a=mergeInfo.mergeList,g=mergeInfo.cellMerge,s={},f={};for(var C in a){var m=a[C].startRow,v=a[C].startCol,d=a[C].endRow,R=a[C].endCol,c=a[C].getColSpan();if(v>=e&&e+t>v){var u=(getRowTop(m),getColLeft(v),a[C].getDOM());if(a[C].isCol())for(var h=v;R>=h;h++)delete mergeInfo.colMerge[h];else if(a[C].isRow())for(var h=m;d>=h;h++)delete mergeInfo.rowMerge[h];else for(var h=m;d>=h;h++)for(var w=v;R>=w;w++)g[Range.getPrimal(h,w)]===a[C]&&delete g[Range.getPrimal(h,w)];if(u){var I=u.mC;if(I){delete mergeDOMInfo[C];var p=getObj("mCC");p.removeChild(I)}if(ISFREEZED){if(u.mC1){var M=u.mC1,_=getObj("mCC1");_.removeChild(M)}if(u.mC2){var O=u.mC2,E=getObj("mCC2");E.removeChild(O)}if(u.mC3){var S=u.mC3,x=getObj("mCC3");x.removeChild(S)}}}}else if(!(e>=v+c)&&e>v&&v+c>=e&&!a[C].isRow()){var u=(getRowTop(m),getColLeft(v),a[C].getDOM());if(i=c+v>e+t?t:R-e+1,i>=1){if(r=a[C].startRow,o=a[C].startCol,n=a[C].endRow,l=a[C].endCol=R-i,(r!=n||o!=l)&&(s[Range.getPrimal(m,v)]=a[C]),a[C].isCol())for(var h=R,y=R-i;h>y;h--)delete mergeInfo.colMerge[h];else for(var h=m;d>=h;h++)for(var w=R,y=R-i;w>y;w--)delete g[Range.getPrimal(h,w)];if(u){var I=u.mC,D=a[C].getWidth();if(r===n&&o===l){var b=I.innerHTML,A=I.getAttribute("fn");if(delete mergeDOMInfo[C],delete g[Range.getPrimal(r,o)],I){var p=getObj("mCC");p.removeChild(I)}var L=getCell(r,o),F=!0;""!=getCellContent(L)&&(F=!1),L.innerHTML=b,L.style.overflow="visible",""!==b&&A&&""!=A?(L.setAttribute("cV",b),L.setAttribute("fn",b)):A&&""!=A?(L.removeAttribute("cV"),L.setAttribute("fn",A)):(L.removeAttribute("cV"),L.removeAttribute("fn"),L.removeAttribute("format")),appEvent.trigger("cell.setcontent",[L,r,o,totCols,b,F])}else f[C]=mergeDOMInfo[C],I&&(I.style.width=D+"px");if(ISFREEZED)if(r===n&&o===l){if(u.mC1){var P=getObj("mCC1");P.removeChild(u.mC1)}if(u.mC2){var T=getObj("mCC2");T.removeChild(u.mC2)}if(u.mC3){var W=getObj("mCC3");W.removeChild(u.mC3)}}else u.mC1&&(u.mC1.style.width=D+"px"),u.mC2&&(u.mC2.style.width=D+"px"),u.mC3&&(u.mC3.style.width=D+"px")}}}else if(v>=e+t){var u=(getRowTop(m),getColLeft(v),a[C].getDOM());if(r=a[C].startRow,o=a[C].startCol=a[C].startCol-t,n=a[C].endRow,l=a[C].endCol=a[C].endCol-t,s[Range.getPrimal(r,o)]=a[C],a[C].isCol()){var N=R-t+1;N=v>N?v:N;for(var h=N;R>=h;h++)delete mergeInfo.colMerge[h];var Z=v;Z=t>c?v-(t-c):v;for(var h=v-t;Z>h;h++)mergeInfo.colMerge[h]=a[C]}else{var N=R-t+1;N=v>N?v:N;for(var h=m;d>=h;h++)for(var w=N;R>=w;w++)delete g[Range.getPrimal(h,w)];var Z=v;Z=t>c?v-(t-c):v;for(var h=m;d>=h;h++)for(var w=v-t;Z>w;w++)g[Range.getPrimal(h,w)]=a[C]}if(u){var I=u.mC,j=a[C].getLeft();I&&(f[Range.getPrimal(r,o)]=mergeDOMInfo[C],delete mergeDOMInfo[C],I.style.left=j+"px"),ISFREEZED&&(u.mC1&&(u.mC1.style.left=j+"px"),u.mC2&&(u.mC2.style.left=j+"px"),u.mC3&&(u.mC3.style.left=j+"px"))}}else r=a[C].startRow,o=a[C].startCol,s[Range.getPrimal(r,o)]=a[C],f[Range.getPrimal(r,o)]=mergeDOMInfo[C]}mergeInfo.mergeList=s,mergeDOMInfo=f}},mergeInfo={},mergeDOMInfo={};Merge.reset();var ActiveFormulaInfo={isEditingCellDeleted:!1,_activeFormulaInfo:{},set:function(e,t){var r=Merge.getCellInfo(e,t);this._activeFormulaInfo.activeRow=e,this._activeFormulaInfo.activeCol=t,this._activeFormulaInfo.startRow=e,this._activeFormulaInfo.startCol=t,this._activeFormulaInfo.endRow=e,this._activeFormulaInfo.endCol=t,this._activeFormulaInfo.isMerged=!1,this._activeFormulaInfo.isSetted=!0,r&&(this._activeFormulaInfo.isMerged=!0,this._activeFormulaInfo.startRow=r.startRow,this._activeFormulaInfo.startCol=r.startCol,this._activeFormulaInfo.endRow=r.endRow,this._activeFormulaInfo.endCol=r.endCol,this._activeFormulaInfo.rng=r)},reset:function(){this._activeFormulaInfo.isSetted=!1},isAvailable:function(){return!!this._activeFormulaInfo.isSetted},getActiveRow:function(){return this._activeFormulaInfo.activeRow},getActiveCol:function(){return this._activeFormulaInfo.activeCol},getStartRow:function(){return this._activeFormulaInfo.startRow},getStartCol:function(){return this._activeFormulaInfo.startCol},getEndRow:function(){return this._activeFormulaInfo.endRow},getEndCol:function(){return this._activeFormulaInfo.endCol},getRange:function(){return this._activeFormulaInfo.rng},isMerged:function(){return this._activeFormulaInfo.isMerged},getTop:function(){return getRowTop(this.getStartRow())},getLeft:function(){return getColLeft(this.getStartCol())},getHeight:function(){return getRowTop(this.getEndRow())+getRowHeight(this.getEndRow())-getRowTop(this.getStartRow())},getWidth:function(){return getColLeft(this.getEndCol())+getColWidth(this.getEndCol())-getColLeft(this.getStartCol())},getColSpan:function(){return this._activeFormulaInfo.endCol-this._activeFormulaInfo.startCol+1},getRowSpan:function(){return this._activeFormulaInfo.endRow-this._activeFormulaInfo.startRow+1}},ActiveCellInfo={_activeCellInfo:{format:{}},resetFormat:function(e){this._activeCellInfo.format=e},_getFormat:function(e){if(!e)return{};var t=e.className,r={bolded:-1!=t.indexOf("fwb"),italicized:-1!=t.indexOf("fsi"),striked:-1!=t.indexOf("tdst")||-1!=t.indexOf("tdsu"),underlined:-1!=t.indexOf("tdu")||-1!=t.indexOf("tdsu"),hAlign:function(){var e=getCSSStyleRegex("textAlign").exec(t);return null==e&&(e=getCSSStyleRegex("utextAlign").exec(t)),e?e[0]:void 0}(),vAlign:function(){var e=getCSSStyleRegex("verticalAlign").exec(t);return e?e[0]:void 0}(),PERCENT:"PERCENT"==e.getAttribute("format"),wrapped:-1==t.indexOf(" nW"),fontFamily:function(){var e=getCSSStyleRegex("fontFamily").exec(t);return e?e[0]:void 0}(),fontSize:function(){var e=getCSSStyleRegex("fontSize").exec(t);return e?e[0]:void 0}(),hasComment:null!=e.getAttribute("comment"),hasSeparator:function(){var t=e.getAttribute("cv");return t&&$(currCell).hasClass("tar")&&-1!=t.indexOf(thousandSeparator)?!0:!1}()};return r},getFormat:function(){return this._activeCellInfo.format},reset:function(e,t){var r=Merge.getCellInfo(e,t);this._activeCellInfo.activeRow=e,this._activeCellInfo.activeCol=t,this._activeCellInfo.startRow=e,this._activeCellInfo.startCol=t,this._activeCellInfo.endRow=e,this._activeCellInfo.endCol=t,this._activeCellInfo.isMerged=!1,r&&(this._activeCellInfo.isMerged=!0,this._activeCellInfo.startRow=r.startRow,this._activeCellInfo.startCol=r.startCol,this._activeCellInfo.endRow=r.endRow,this._activeCellInfo.endCol=r.endCol,this._activeCellInfo.rng=r)},getActiveRow:function(){return this._activeCellInfo.activeRow},getActiveCol:function(){return this._activeCellInfo.activeCol},getStartRow:function(){return this._activeCellInfo.startRow},getStartCol:function(){return this._activeCellInfo.startCol},getEndRow:function(){return this._activeCellInfo.endRow},getEndCol:function(){return this._activeCellInfo.endCol},getRange:function(){return this._activeCellInfo.rng},isMerged:function(){return this._activeCellInfo.isMerged},getTop:function(){return getRowTop(this.getStartRow())},getLeft:function(){return getColLeft(this.getStartCol())},getHeight:function(){return getRowTop(this.getEndRow())+getRowHeight(this.getEndRow())-getRowTop(this.getStartRow())},getWidth:function(){return getColLeft(this.getEndCol())+getColWidth(this.getEndCol())-getColLeft(this.getStartCol())},getColSpan:function(){return this._activeCellInfo.endCol-this._activeCellInfo.startCol+1},getRowSpan:function(){return this._activeCellInfo.endRow-this._activeCellInfo.startRow+1},getDOM:function(){}},Selection={changeInPosition:function(e,t,r,o){var n=[],l=[],i={};r>t||e>o?(n[0]={start:e,end:t},l[0]={start:r,end:o}):r>e&&o>=t?(n[0]={start:e,end:r-1},l[0]={start:t,end:o}):e>=r&&t>o?(n[0]={start:o+1,end:t},l[0]={start:r,end:e-1}):r>e&&t>o?(n[0]={start:e,end:r-1},n[1]={start:o+1,end:t}):e>=r&&o>=t&&(l[0]={start:r,end:e-1},l[1]={start:t+1,end:o});var a=!1;return n.length>0&&(a=!0,i.reset=n),l.length>0&&(a=!0,i.set=l),a?i:void 0}};
var ErrorMsg={show:function(e){var t=e.mt,r=e.dt,s=e.mk,i=s.split("#"),o=i[0],a=i.slice(1,i.length);sheetdialog.getOpenedDialog().length>0&&sheetdialog.getTitle()===jsMsg["Pivot.UI.Builder.Title"]&&(PivotUtil.isPivotDialogError(o,a)&&(r=void 0),pivot.alertBeforeClose=!1);var l=jsMsg[o]||jsMsg[ErrorMsg.getDefaultErrorMsg().mk],n=replaceParams(l.replace("#RL","<a onclick='javascript:loadDocument(\""+DOCUMENT_ID+"\");' href='#'>").replace("#CRL","</a>"),a),g=e.df,c=e.ss;if(g&&deferLoadFiles(),isUndefined(e[ActionConstants.UNDOREDOCOUNT])||(setUNDO(e[ActionConstants.UNDOREDOCOUNT].u),setREDO(e[ActionConstants.UNDOREDOCOUNT].r)),"Skip.Action"===o)hideProgressMessage(),repeat.doAction(repeat.LASTACTIONJSON,!1);else if("BANNER"===r){n||(n=o),showBannerMessage(t,n,!0);var d=!0;c&&(d=!1),this.maskEditor(!0,!0,d,!0),""!==COLLAB_ID&&"null"!==COLLAB_ID&&Collaboration.quit(COLLAB_ID),WebMessanger.disable()}else if("DIALOG"===r)hideProgressMessage(),showAlertDialog(n?n:o);else if("DIALOG_YES_NO"===r){hideProgressMessage();var D={buttons:[{text:jsMsg["Dialog.confirm.Yes"],class:"ui-zbutton-primary",click:function(){sheetdialog.closeNotify(),("Error.Pivot.Overwrite.Data"===o||"Error.Pivot.Overwrite.Data.Changesource"===o||"Error.Pivot.Overwrite.Data.Refresh"===o||"Error.Pivot.Overwrite.Data.Filter"===o||"Error.Pivot.Overwrite.Data.Sort"===o||"Error.Pivot.Overwrite.Data.Move"===o)&&PivotUtil.resendRequest()}},{text:jsMsg["Dialog.confirm.No"],click:function(){sheetdialog.closeNotify()}}]};sheetdialog.showConfirmDialog(n,D)}},maskEditor:function(e,t,r,s){if(message("","none"),document.getElementById("menutabs")&&errorDocMenutab(),ole&&(ole.setObjectProperties("button",{permissions:{isDraggable:!1,isResizable:!1,isEditable:!1}}),ole.setObjectProperties("chart",{permissions:{isDraggable:!1,isResizable:!1,isEditable:!1}}),ole.setObjectProperties("image",{permissions:{isDraggable:!1,isResizable:!1,isEditable:!1}})),e&&(READ_WRITE=!1,ALLOW_TO_WRITE=!1),t){var i=getObj("addSheetBtn");i&&(i.style.visibility="hidden")}r?(isErrorDoc=!0,allowSheetSwitch=!1,documentBakeStatus.setCollabBake(!1)):(allowSheetSwitch=!0,restrictScroll=!1,documentBakeStatus.setCollabBake(!0)),s&&(resetRTCvariables(),window.onbeforeunload())},getDefaultErrorMsg:function(){var e={mt:"ERROR",dt:"BANNER",mk:"Error.Internal.Server"};return e}};
var Iterator=function(t,e,r,i,s){this.startRow=t,this.startCol=e,this.endRow=r,this.endCol=i,this.listenAll=!0,this.stopper=!1,this.eventHandler={},this.rowsAry=isUndefined(this.startRow)?[]:Row.getAvailableRowsInRange(t,r),this.iteratorOptions=s,this.resultHandler};Iterator.prototype={iterate:function(t){if(mergeInfo._mergeAll)return void this.invoke(t,0,0,this.args);this.args=Array.prototype.slice.call(arguments,1),this.stack={},this.colStack={},this.cellMerge=mergeInfo.cellMerge,this.rowMerge=mergeInfo.rowMerge,this.colMerge=mergeInfo.colMerge;var e=this.rowsAry.length;this.rowIter=e-1;for(var r=this.endCol-this.startCol;this.rowIter>=0&&!this.stopper;){this.colIter=r;var i=this.rowsAry[e-1-this.rowIter];this.triggerListener("onRowBefore",i,this.startCol);do{if(this.stopper)break;var s=this.endCol-this.colIter;if(this.assureNExecuteRowMerge(i,s),!this._isColMerged(s)||this.iteratorOptions&&(!this.iteratorOptions||this.iteratorOptions.doNotSkipCoveredCells||this.iteratorOptions.doNotSkipFirstCoveredCell)){var o=this.stack[s];if(o){var a=o.rS;a-=1,this.stack[s].rS=a,a||delete this.stack[s],(!this.iteratorOptions||this.iteratorOptions&&!this.iteratorOptions.doNotSkipCoveredCells&&!this.iteratorOptions.doNotSkipFirstCoveredCell)&&this._skipColumn(o.cS)}else{var n=this.cellMerge[Range.getPrimal(i,s)],h=this.colMerge[s],l=this.rowMerge[i],c=!1;if(n){var p=n.startRow,d=n.startCol,g=i-p,v=s-d,f=n.getRowSpan()-1-g,o={};o.rS=f,o.cS=n.getColSpan()-1-v,f&&(this.stack[s]=o),!this.iteratorOptions||this.iteratorOptions.doNotSkipCoveredCells||this.iteratorOptions.doNotSkipFirstCoveredCell||this._skipColumn(o.cS),g||v||this.iteratorOptions&&(!this.iteratorOptions||this.iteratorOptions.doNotSkipCoveredCells||this.iteratorOptions.doNotSkipFirstCoveredCell)?c=!0:(this.setMergeInThread(n),this.triggerListener("onMergeEncounter",i,s),this.resetThreadLocal())}else if(h){var p=h.startRow,u=i-p;this.colStack[s]=h.getColSpan()-1,u&&(c=!0),!this.iteratorOptions||this.iteratorOptions.doNotSkipCoveredCells||this.iteratorOptions.doNotSkipFirstCoveredCell||this._skipColumn(this.colStack[s])}else if(l){var d=l.startCol,C=s-d;C&&(c=!0)}this.listenAll&&t&&(!c||this.iteratorOptions&&(this.iteratorOptions.doNotSkipCoveredCells||this.iteratorOptions.doNotSkipFirstCoveredCell))&&this.invoke(t,i,s,this.args)}}else this._skipColumn(this._getColSpan(s));this.iteratorOptions&&this.iteratorOptions.doNotSkipFirstCoveredCell&&(this.iteratorOptions.doNotSkipFirstCoveredCell=!1)}while(this.colIter--);this.triggerListener("onRowAfter",i,s),this.rowIter--}return this.reset(),this.returnVal},initData:function(t){this.result=t},addEventListener:function(t,e){switch(t){case"onRowBefore":case"onRowAfter":case"onMergeEncounter":break;default:return void showAlertDialog("Please Give the valid param")}var r=Array.prototype.slice.call(arguments,2);this.eventHandler[t]={},this.eventHandler[t].handler=e,this.eventHandler[t].params=r},triggerListener:function(t,e,r){var i=this.eventHandler[t];i&&this.invoke(i.handler,e,r,i.params)},setDataProcessor:function(t){"undefined"!=typeof this.result?this.resultHandler=t:showAlertDialog("Please Init The Data")},processData:function(){this.resultHandler?this.result=this.resultHandler.apply(this,arguments):showAlertDialog("Set Result Handler")},getData:function(){return this.result},invoke:function(t,e,r,i){var s=[e,r];s=s.concat(i),this.returnVal=t.apply(this,s)},setMergeInThread:function(t){this.setThreadLocal("MERGE",t)},setThreadLocal:function(t,e){switch(this._threadLocalObjct=this._threadLocalObjct||{},t){case"MERGE":this._threadLocalObjct[t]=e}},resetThreadLocal:function(){delete this._threadLocalObjct},getThreadLocal:function(){return this._threadLocalObjct},getMerge:function(){return this.getThreadLocal()?this.getThreadLocal().MERGE:void 0},interrupt:function(){this.stopper=!0},_skipRow:function(t){this.rowIter-=t,this.rowIter=this._assertPositive(this.rowIter)},_skipColumn:function(t){this.colIter-=t,this.colIter=this._assertPositive(this.colIter)},_isColMerged:function(t){return"undefined"!=typeof this.colStack[t]},_getColSpan:function(t){return this.colStack[t]},_assertPositive:function(t){return t=0>t?0:t},assureNExecuteRowMerge:function(t){var e=this.rowMerge[t];e&&(this.colIter=0,this._skipRow(e.getRowSpan()-1))},reset:function(){delete this.cellMerge,delete this.rowMerge,delete this.colMerge,delete this.colStack,delete this.stack}};var MergeIterator=function(){Iterator.apply(this,arguments)};MergeIterator.prototype=new Iterator,MergeIterator.prototype.iterate=function(t){if(mergeInfo._mergeAll){var e=Merge.getWhole();return void this.invoke(t,0,0,e)}var r=new Range(this.startRow,this.startCol,this.endRow,this.endCol),i=mergeInfo.mergeList;for(var s in i){if(this.stopper)break;var o=i[s];if(r.intersects(o)){var a=o.startRow,n=o.startCol;this.setMergeInThread(o),this.invoke(t,a,n,o),this.resetThreadLocal()}}},MergeIterator.prototype.iterateNNotifyAboveStartRow=function(t){if(mergeInfo._mergeAll){var e=Merge.getWhole();return void this.invoke(t,0,0,e)}var r=new Range(this.startRow,this.startCol,this.endRow,this.endCol),i=mergeInfo.mergeList;for(var s in i){if(this.stopper)break;var o=i[s];if(r.startRow<o.startRow||r.intersects(o)){var a=o.startRow,n=o.startCol;this.invoke(t,a,n,o)}}},MergeIterator.prototype.iterateNNotifyAboveStartCol=function(t){if(mergeInfo._mergeAll)return void this.invoke(t,0,0);var e=new Range(this.startRow,this.startCol,this.endRow,this.endCol),r=mergeInfo.mergeList;for(var i in r){if(this.stopper)break;var s=r[i];if(e.startCol<s.startCol||e.intersects(s)){var o=s.startRow,a=s.startCol;this.invoke(t,o,a,s)}}},MergeIterator.prototype.invoke=function(t,e,r,i){var s=t.call(this,e,r,i);s&&(this.stopper=!0)};
