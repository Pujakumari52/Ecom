!function(t,e){"object"==typeof module&&module.exports?module.exports=t.document?e(t):e:t.Highcharts=e(t)}("undefined"!=typeof window?window:this,function(t){var e=function(){var e="undefined"==typeof t?window:t,i=e.document,n="http://www.w3.org/2000/svg",o=e.navigator&&e.navigator.userAgent||"",r=i&&i.createElementNS&&!!i.createElementNS(n,"svg").createSVGRect,s=/(edge|msie|trident)/i.test(o)&&!e.opera,a=/Firefox/.test(o),l=a&&parseInt(o.split("Firefox/")[1],10)<4,h=e.Highcharts?e.Highcharts.error(16,!0):{product:"Highstock",version:"6.0.4",deg2rad:2*Math.PI/360,doc:i,hasBidiBug:l,hasTouch:i&&void 0!==i.documentElement.ontouchstart,isMS:s,isWebKit:/AppleWebKit/.test(o),isFirefox:a,isTouchDevice:/(Mobile|Android|Windows Phone)/.test(o),SVG_NS:n,chartCount:0,seriesTypes:{},symbolSizes:{},svg:r,win:e,marginNames:["plotTop","marginRight","marginBottom","plotLeft"],noop:function(){return void 0},charts:[]};return h}();!function(t){t.timers=[];var e=t.charts,i=t.doc,n=t.win;t.error=function(e,i){var o=t.isNumber(e)?"Highcharts error #"+e+": www.highcharts.com/errors/"+e:e;if(i)throw new Error(o);n.console},t.Fx=function(t,e,i){this.options=e,this.elem=t,this.prop=i},t.Fx.prototype={dSetter:function(){var t,e=this.paths[0],i=this.paths[1],n=[],o=this.now,r=e.length;if(1===o)n=this.toD;else if(r===i.length&&1>o)for(;r--;)t=parseFloat(e[r]),n[r]=isNaN(t)?i[r]:o*parseFloat(i[r]-t)+t;else n=i;this.elem.attr("d",n,null,!0)},update:function(){var t=this.elem,e=this.prop,i=this.now,n=this.options.step;this[e+"Setter"]?this[e+"Setter"]():t.attr?t.element&&t.attr(e,i,null,!0):t.style[e]=i+this.unit,n&&n.call(t,i,this)},run:function(e,i,o){var r=this,s=r.options,a=function(t){return a.stopped?!1:r.step(t)},l=n.requestAnimationFrame||function(t){setTimeout(t,13)},h=function(){for(var e=0;e<t.timers.length;e++)t.timers[e]()||t.timers.splice(e--,1);t.timers.length&&l(h)};e===i?(delete s.curAnim[this.prop],s.complete&&0===t.keys(s.curAnim).length&&s.complete.call(this.elem)):(this.startTime=+new Date,this.start=e,this.end=i,this.unit=o,this.now=this.start,this.pos=0,a.elem=this.elem,a.prop=this.prop,a()&&1===t.timers.push(a)&&l(h))},step:function(e){var i,n,o=+new Date,r=this.options,s=this.elem,a=r.complete,l=r.duration,h=r.curAnim;return s.attr&&!s.element?i=!1:e||o>=l+this.startTime?(this.now=this.end,this.pos=1,this.update(),h[this.prop]=!0,n=!0,t.objectEach(h,function(t){t!==!0&&(n=!1)}),n&&a&&a.call(s),i=!1):(this.pos=r.easing((o-this.startTime)/l),this.now=this.start+(this.end-this.start)*this.pos,this.update(),i=!0),i},initPath:function(e,i,n){function o(t){var e,i;for(d=t.length;d--;)e="M"===t[d]||"L"===t[d],i=/[a-zA-Z]/.test(t[d+3]),e&&i&&t.splice(d+1,0,t[d+1],t[d+2],t[d+1],t[d+2])}function r(t,e,i){[].splice.apply(t,[i,0].concat(e))}function s(t,e){for(;t.length<h;)t[0]=e[h-t.length],r(t,t.slice(0,m),0),y&&(r(t,t.slice(t.length-m),t.length),d--);t[0]="M"}function a(t,e){for(var i=(h-t.length)/m;i>0&&i--;)c=t.slice().splice(t.length/b-m,m*b),c[0]=e[h-m-i*m],f&&(c[m-6]=c[m-2],c[m-5]=c[m-1]),r(t,c,t.length/b),y&&i--}i=i||"";var l,h,c,d,p,u=e.startX,g=e.endX,f=i.indexOf("C")>-1,m=f?7:3,x=i.split(" "),v=n.slice(),y=e.isArea,b=y?2:1;if(f&&(o(x),o(v)),u&&g){for(d=0;d<u.length;d++){if(u[d]===g[0]){l=d;break}if(u[0]===g[g.length-u.length+d]){l=d,p=!0;break}}void 0===l&&(x=[])}return x.length&&t.isNumber(l)&&(h=v.length+l*b*m,p?(s(x,v),a(v,x)):(s(v,x),a(x,v))),[x,v]}},t.Fx.prototype.fillSetter=t.Fx.prototype.strokeSetter=function(){this.elem.attr(this.prop,t.color(this.start).tweenTo(t.color(this.end),this.pos),null,!0)},t.extend=function(t,e){var i;t||(t={});for(i in e)t[i]=e[i];return t},t.merge=function(){var e,i,n=arguments,o={},r=function(e,i){return"object"!=typeof e&&(e={}),t.objectEach(i,function(n,o){e[o]=!t.isObject(n,!0)||t.isClass(n)||t.isDOMElement(n)?i[o]:r(e[o]||{},n)}),e};for(n[0]===!0&&(o=n[1],n=Array.prototype.slice.call(n,2)),i=n.length,e=0;i>e;e++)o=r(o,n[e]);return o},t.pInt=function(t,e){return parseInt(t,e||10)},t.isString=function(t){return"string"==typeof t},t.isArray=function(t){var e=Object.prototype.toString.call(t);return"[object Array]"===e||"[object Array Iterator]"===e},t.isObject=function(e,i){return!(!e||"object"!=typeof e||i&&t.isArray(e))},t.isDOMElement=function(e){return t.isObject(e)&&"number"==typeof e.nodeType},t.isClass=function(e){var i=e&&e.constructor;return!(!t.isObject(e,!0)||t.isDOMElement(e)||!i||!i.name||"Object"===i.name)},t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)&&1/0>t&&t>-1/0},t.erase=function(t,e){for(var i=t.length;i--;)if(t[i]===e){t.splice(i,1);break}},t.defined=function(t){return void 0!==t&&null!==t},t.attr=function(e,i,n){var o;return t.isString(i)?t.defined(n)?e.setAttribute(i,n):e&&e.getAttribute&&(o=e.getAttribute(i)):t.defined(i)&&t.isObject(i)&&t.objectEach(i,function(t,i){e.setAttribute(i,t)}),o},t.splat=function(e){return t.isArray(e)?e:[e]},t.syncTimeout=function(t,e,i){return e?setTimeout(t,e,i):void t.call(0,i)},t.pick=function(){var t,e,i=arguments,n=i.length;for(t=0;n>t;t++)if(e=i[t],void 0!==e&&null!==e)return e},t.css=function(e,i){t.isMS&&!t.svg&&i&&void 0!==i.opacity&&(i.filter="alpha(opacity="+100*i.opacity+")"),t.extend(e.style,i)},t.createElement=function(e,n,o,r,s){var a=i.createElement(e),l=t.css;return n&&t.extend(a,n),s&&l(a,{padding:0,border:"none",margin:0}),o&&l(a,o),r&&r.appendChild(a),a},t.extendClass=function(e,i){var n=function(){};return n.prototype=new e,t.extend(n.prototype,i),n},t.pad=function(t,e,i){return new Array((e||2)+1-String(t).length).join(i||0)+t},t.relativeLength=function(t,e,i){return/%$/.test(t)?e*parseFloat(t)/100+(i||0):parseFloat(t)},t.wrap=function(t,e,i){var n=t[e];t[e]=function(){var t,e=Array.prototype.slice.call(arguments),o=arguments,r=this;return r.proceed=function(){n.apply(r,arguments.length?arguments:o)},e.unshift(n),t=i.apply(this,e),r.proceed=null,t}},t.getTZOffset=function(e){var i=t.Date;return 6e4*(i.hcGetTimezoneOffset&&i.hcGetTimezoneOffset(e)||i.hcTimezoneOffset||0)},t.dateFormat=function(e,i,n){if(!t.defined(i)||isNaN(i))return t.defaultOptions.lang.invalidDate||"";e=t.pick(e,"%Y-%m-%d %H:%M:%S");var o=t.Date,r=new o(i-t.getTZOffset(i)),s=r[o.hcGetHours](),a=r[o.hcGetDay](),l=r[o.hcGetDate](),h=r[o.hcGetMonth](),c=r[o.hcGetFullYear](),d=t.defaultOptions.lang,p=d.weekdays,u=d.shortWeekdays,g=t.pad,f=t.extend({a:u?u[a]:p[a].substr(0,3),A:p[a],d:g(l),e:g(l,2," "),w:a,b:d.shortMonths[h],B:d.months[h],m:g(h+1),y:c.toString().substr(2,2),Y:c,H:g(s),k:s,I:g(s%12||12),l:s%12||12,M:g(r[o.hcGetMinutes]()),p:12>s?"AM":"PM",P:12>s?"am":"pm",S:g(r.getSeconds()),L:g(Math.round(i%1e3),3)},t.dateFormats);return t.objectEach(f,function(t,n){for(;-1!==e.indexOf("%"+n);)e=e.replace("%"+n,"function"==typeof t?t(i):t)}),n?e.substr(0,1).toUpperCase()+e.substr(1):e},t.formatSingle=function(e,i){var n,o=/f$/,r=/\.([0-9])/,s=t.defaultOptions.lang;return o.test(e)?(n=e.match(r),n=n?n[1]:-1,null!==i&&(i=t.numberFormat(i,n,s.decimalPoint,e.indexOf(",")>-1?s.thousandsSep:""))):i=t.dateFormat(e,i),i},t.format=function(e,i){for(var n,o,r,s,a,l,h,c="{",d=!1,p=[];e&&(h=e.indexOf(c),-1!==h);){if(n=e.slice(0,h),d){for(o=n.split(":"),r=o.shift().split("."),a=r.length,l=i,s=0;a>s;s++)l&&(l=l[r[s]]);o.length&&(l=t.formatSingle(o.join(":"),l)),p.push(l)}else p.push(n);e=e.slice(h+1),d=!d,c=d?"}":"{"}return p.push(e),p.join("")},t.getMagnitude=function(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10))},t.normalizeTickInterval=function(e,i,n,o,r){var s,a,l=e;for(n=t.pick(n,1),s=e/n,i||(i=r?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],o===!1&&(1===n?i=t.grep(i,function(t){return t%1===0}):.1>=n&&(i=[1/n]))),a=0;a<i.length&&(l=i[a],!(r&&l*n>=e||!r&&s<=(i[a]+(i[a+1]||i[a]))/2));a++);return l=t.correctFloat(l*n,-Math.round(Math.log(.001)/Math.LN10))},t.stableSort=function(t,e){var i,n,o=t.length;for(n=0;o>n;n++)t[n].safeI=n;for(t.sort(function(t,n){return i=e(t,n),0===i?t.safeI-n.safeI:i}),n=0;o>n;n++)delete t[n].safeI},t.arrayMin=function(t){for(var e=t.length,i=t[0];e--;)t[e]<i&&(i=t[e]);return i},t.arrayMax=function(t){for(var e=t.length,i=t[0];e--;)t[e]>i&&(i=t[e]);return i},t.destroyObjectProperties=function(e,i){t.objectEach(e,function(t,n){t&&t!==i&&t.destroy&&t.destroy(),delete e[n]})},t.discardElement=function(e){var i=t.garbageBin;i||(i=t.createElement("div")),e&&i.appendChild(e),i.innerHTML=""},t.correctFloat=function(t,e){return parseFloat(t.toPrecision(e||14))},t.setAnimation=function(e,i){i.renderer.globalAnimation=t.pick(e,i.options.chart.animation,!0)},t.animObject=function(e){return t.isObject(e)?t.merge(e):{duration:e?500:0}},t.timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},t.numberFormat=function(e,i,n,o){e=+e||0,i=+i;var r,s,a,l,h,c=t.defaultOptions.lang,d=(e.toString().split(".")[1]||"").split("e")[0].length,p=e.toString().split("e");-1===i?i=Math.min(d,2):t.isNumber(i)?i&&p[1]&&p[1]<0&&(h=i+ +p[1],h>=0?(p[0]=(+p[0]).toExponential(h).split("e")[0],i=h):(p[0]=p[0].split(".")[0]||0,e=20>i?(p[0]*Math.pow(10,p[1])).toFixed(i):0,p[1]=0)):i=2,l=(Math.abs(p[1]?p[0]:e)+Math.pow(10,-Math.max(i,d)-1)).toFixed(i),r=String(t.pInt(l)),s=r.length>3?r.length%3:0,n=t.pick(n,c.decimalPoint),o=t.pick(o,c.thousandsSep),a=0>e?"-":"",a+=s?r.substr(0,s)+o:"",a+=r.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+o);var u=t.pInt(l.slice(-i));return i&&u&&(a+=n+l.slice(-i)),p[1]&&0!==+a&&(a+="e"+p[1]),a},Math.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},t.getStyle=function(e,i,o){var r;return"width"===i?Math.min(e.offsetWidth,e.scrollWidth)-t.getStyle(e,"padding-left")-t.getStyle(e,"padding-right"):"height"===i?Math.min(e.offsetHeight,e.scrollHeight)-t.getStyle(e,"padding-top")-t.getStyle(e,"padding-bottom"):(n.getComputedStyle||t.error(27,!0),r=n.getComputedStyle(e,void 0),r&&(r=r.getPropertyValue(i),t.pick(o,"opacity"!==i)&&(r=t.pInt(r))),r)},t.inArray=function(e,i){return(t.indexOfPolyfill||Array.prototype.indexOf).call(i,e)},t.grep=function(e,i){return(t.filterPolyfill||Array.prototype.filter).call(e,i)},t.find=Array.prototype.find?function(t,e){return t.find(e)}:function(t,e){var i,n=t.length;for(i=0;n>i;i++)if(e(t[i],i))return t[i]},t.map=function(t,e){for(var i=[],n=0,o=t.length;o>n;n++)i[n]=e.call(t[n],t[n],n,t);return i},t.keys=function(e){return(t.keysPolyfill||Object.keys).call(void 0,e)},t.reduce=function(e,i,n){return(t.reducePolyfill||Array.prototype.reduce).call(e,i,n)},t.offset=function(t){var e=i.documentElement,o=t.parentElement?t.getBoundingClientRect():{top:0,left:0};return{top:o.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:o.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}},t.stop=function(e,i){for(var n=t.timers.length;n--;)t.timers[n].elem!==e||i&&i!==t.timers[n].prop||(t.timers[n].stopped=!0)},t.each=function(e,i,n){return(t.forEachPolyfill||Array.prototype.forEach).call(e,i,n)},t.objectEach=function(t,e,i){for(var n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)},t.addEvent=function(e,i,n){var o,r,s=e.addEventListener||t.addEventListenerPolyfill;return e.hcEvents&&!Object.prototype.hasOwnProperty.call(e,"hcEvents")&&(r={},t.objectEach(e.hcEvents,function(t,e){r[e]=t.slice(0)}),e.hcEvents=r),o=e.hcEvents=e.hcEvents||{},s&&s.call(e,i,n,!1),o[i]||(o[i]=[]),o[i].push(n),function(){t.removeEvent(e,i,n)}},t.removeEvent=function(e,i,n){function o(i,n){var o=e.removeEventListener||t.removeEventListenerPolyfill;o&&o.call(e,i,n,!1)}function r(){var n,r;e.nodeName&&(i?(n={},n[i]=!0):n=l,t.objectEach(n,function(t,e){if(l[e])for(r=l[e].length;r--;)o(e,l[e][r])}))}var s,a,l=e.hcEvents;l&&(i?(s=l[i]||[],n?(a=t.inArray(n,s),a>-1&&(s.splice(a,1),l[i]=s),o(i,n)):(r(),l[i]=[])):(r(),e.hcEvents={}))},t.fireEvent=function(e,n,o,r){var s,a,l,h,c,d=e.hcEvents;if(o=o||{},i.createEvent&&(e.dispatchEvent||e.fireEvent))s=i.createEvent("Events"),s.initEvent(n,!0,!0),t.extend(s,o),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(n,s);else if(d)for(a=d[n]||[],l=a.length,o.target||t.extend(o,{preventDefault:function(){o.defaultPrevented=!0},target:e,type:n}),h=0;l>h;h++)c=a[h],c&&c.call(e,o)===!1&&o.preventDefault();r&&!o.defaultPrevented&&r(o)},t.animate=function(e,i,n){var o,r,s,a,l="";t.isObject(n)||(a=arguments,n={duration:a[2],easing:a[3],complete:a[4]}),t.isNumber(n.duration)||(n.duration=400),n.easing="function"==typeof n.easing?n.easing:Math[n.easing]||Math.easeInOutSine,n.curAnim=t.merge(i),t.objectEach(i,function(a,h){t.stop(e,h),s=new t.Fx(e,n,h),r=null,"d"===h?(s.paths=s.initPath(e,e.d,i.d),s.toD=i.d,o=0,r=1):e.attr?o=e.attr(h):(o=parseFloat(t.getStyle(e,h))||0,"opacity"!==h&&(l="px")),r||(r=a),r&&r.match&&r.match("px")&&(r=r.replace(/px/g,"")),s.run(o,r,l)})},t.seriesType=function(e,i,n,o,r){var s=t.getOptions(),a=t.seriesTypes;return s.plotOptions[e]=t.merge(s.plotOptions[i],n),a[e]=t.extendClass(a[i]||function(){},o),a[e].prototype.type=e,r&&(a[e].prototype.pointClass=t.extendClass(t.Point,r)),a[e]},t.uniqueKey=function(){var t=Math.random().toString(36).substring(2,9),e=0;return function(){return"highcharts-"+t+"-"+e++}}(),n.jQuery&&(n.jQuery.fn.highcharts=function(){var i=[].slice.call(arguments);return this[0]?i[0]?(new(t[t.isString(i[0])?i.shift():"Chart"])(this[0],i[0],i[1]),this):e[t.attr(this[0],"data-highcharts-chart")]:void 0})}(e),function(t){var e=t.each,i=t.isNumber,n=t.map,o=t.merge,r=t.pInt;t.Color=function(e){return this instanceof t.Color?void this.init(e):new t.Color(e)},t.Color.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),parseFloat(t[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),1]}}],names:{none:"rgba(255,255,255,0)",white:"#ffffff",black:"#000000"},init:function(e){var i,o,r,s,a;if(this.input=e=this.names[e&&e.toLowerCase?e.toLowerCase():""]||e,e&&e.stops)this.stops=n(e.stops,function(e){return new t.Color(e[1])});else if(e&&e.charAt&&"#"===e.charAt()&&(a=e.length,e=parseInt(e.substr(1),16),7===a?o=[(16711680&e)>>16,(65280&e)>>8,255&e,1]:4===a&&(o=[(3840&e)>>4|(3840&e)>>8,(240&e)>>4|240&e,(15&e)<<4|15&e,1])),!o)for(r=this.parsers.length;r--&&!o;)s=this.parsers[r],i=s.regex.exec(e),i&&(o=s.parse(i));this.rgba=o||[]},get:function(t){var n,r=this.input,s=this.rgba;return this.stops?(n=o(r),n.stops=[].concat(n.stops),e(this.stops,function(e,i){n.stops[i]=[n.stops[i][0],e.get(t)]})):n=s&&i(s[0])?"rgb"===t||!t&&1===s[3]?"rgb("+s[0]+","+s[1]+","+s[2]+")":"a"===t?s[3]:"rgba("+s.join(",")+")":r,n},brighten:function(t){var n,o=this.rgba;if(this.stops)e(this.stops,function(e){e.brighten(t)});else if(i(t)&&0!==t)for(n=0;3>n;n++)o[n]+=r(255*t),o[n]<0&&(o[n]=0),o[n]>255&&(o[n]=255);return this},setOpacity:function(t){return this.rgba[3]=t,this},tweenTo:function(t,e){var i,n,o=this.rgba,r=t.rgba;return r.length&&o&&o.length?(i=1!==r[3]||1!==o[3],n=(i?"rgba(":"rgb(")+Math.round(r[0]+(o[0]-r[0])*(1-e))+","+Math.round(r[1]+(o[1]-r[1])*(1-e))+","+Math.round(r[2]+(o[2]-r[2])*(1-e))+(i?","+(r[3]+(o[3]-r[3])*(1-e)):"")+")"):n=t.input||"none",n}},t.color=function(e){return new t.Color(e)}}(e),function(t){var e,i,n=t.addEvent,o=t.animate,r=t.attr,s=t.charts,a=t.color,l=t.css,h=t.createElement,c=t.defined,d=t.deg2rad,p=t.destroyObjectProperties,u=t.doc,g=t.each,f=t.extend,m=t.erase,x=t.grep,v=t.hasTouch,y=t.inArray,b=t.isArray,k=t.isFirefox,M=t.isMS,w=t.isObject,S=t.isString,A=t.isWebKit,T=t.merge,P=t.noop,C=t.objectEach,L=t.pick,O=t.pInt,D=t.removeEvent,I=(t.splat,t.stop),B=t.svg,z=t.SVG_NS,E=t.symbolSizes,R=t.win;e=t.SVGElement=function(){return this},f(e.prototype,{opacity:1,SVG_NS:z,textProps:["direction","fontSize","fontWeight","fontFamily","fontStyle","color","lineHeight","width","textAlign","textDecoration","textOverflow","textOutline"],init:function(t,e){this.element="span"===e?h(e):u.createElementNS(this.SVG_NS,e),this.renderer=t},animate:function(e,i,n){var r=t.animObject(L(i,this.renderer.globalAnimation,!0));return 0!==r.duration?(n&&(r.complete=n),o(this,e,r)):(this.attr(e,null,n),r.step&&r.step.call(this)),this},colorGradient:function(e,i,n){var o,r,s,a,l,h,d,p,u,f,m,x,v=this.renderer,y=[];e.radialGradient?r="radialGradient":e.linearGradient&&(r="linearGradient"),r&&(s=e[r],l=v.gradients,d=e.stops,f=n.radialReference,b(s)&&(e[r]=s={x1:s[0],y1:s[1],x2:s[2],y2:s[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===r&&f&&!c(s.gradientUnits)&&(a=s,s=T(s,v.getRadialAttr(f,a),{gradientUnits:"userSpaceOnUse"})),C(s,function(t,e){"id"!==e&&y.push(e,t)}),C(d,function(t){y.push(t)}),y=y.join(","),l[y]?m=l[y].attr("id"):(s.id=m=t.uniqueKey(),l[y]=h=v.createElement(r).attr(s).add(v.defs),h.radAttr=a,h.stops=[],g(d,function(e){var i;0===e[1].indexOf("rgba")?(o=t.color(e[1]),p=o.get("rgb"),u=o.get("a")):(p=e[1],u=1),i=v.createElement("stop").attr({offset:e[0],"stop-color":p,"stop-opacity":u}).add(h),h.stops.push(i)})),x="url("+v.url+"#"+m+")",n.setAttribute(i,x),n.gradient=y,e.toString=function(){return x})},applyTextOutline:function(e){var i,n,o,s,a,l,h=this.element,c=-1!==e.indexOf("contrast"),d={};if(c&&(d.textOutline=e=e.replace(/contrast/g,this.renderer.getContrast(h.style.fill))),e=e.split(" "),o=e[e.length-1],s=e[0],s&&"none"!==s&&t.svg){for(this.fakeTS=!0,i=[].slice.call(h.getElementsByTagName("tspan")),this.ySetter=this.xSetter,s=s.replace(/(^[\d\.]+)(.*?)$/g,function(t,e,i){return 2*e+i}),l=i.length;l--;)n=i[l],"highcharts-text-outline"===n.getAttribute("class")&&m(i,h.removeChild(n));a=h.firstChild,g(i,function(t,e){var i;0===e&&(t.setAttribute("x",h.getAttribute("x")),e=h.getAttribute("y"),t.setAttribute("y",e||0),null===e&&h.setAttribute("y",0)),i=t.cloneNode(1),r(i,{class:"highcharts-text-outline",fill:o,stroke:o,"stroke-width":s,"stroke-linejoin":"round"}),h.insertBefore(i,a)})}},attr:function(t,e,i,n){var o,r,s,a,l=this.element,h=this;return"string"==typeof t&&void 0!==e&&(o=t,t={},t[o]=e),"string"==typeof t?h=(this[t+"Getter"]||this._defaultGetter).call(this,t,l):(C(t,function(e,i){s=!1,n||I(this,i),this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)$/.test(i)&&(r||(this.symbolAttr(t),r=!0),s=!0),!this.rotation||"x"!==i&&"y"!==i||(this.doTransform=!0),s||(a=this[i+"Setter"]||this._defaultSetter,a.call(this,e,i,l),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(i)&&this.updateShadows(i,e,a))},this),this.afterSetters()),i&&i(),h},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(t,e,i){for(var n=this.shadows,o=n.length;o--;)i.call(n[o],"height"===t?Math.max(e-(n[o].cutHeight||0),0):"d"===t?this.d:e,t,n[o])},addClass:function(t,e){var i=this.attr("class")||"";return-1===i.indexOf(t)&&(e||(t=(i+(i?" ":"")+t).replace("  "," ")),this.attr("class",t)),this},hasClass:function(t){return-1!==y(t,(this.attr("class")||"").split(" "))},removeClass:function(t){return this.attr("class",(this.attr("class")||"").replace(t,""))},symbolAttr:function(t){var e=this;g(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(i){e[i]=L(t[i],e[i])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},clip:function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":"none")},crisp:function(t,e){var i,n=this;return e=e||t.strokeWidth||0,i=Math.round(e)%2/2,t.x=Math.floor(t.x||n.x||0)+i,t.y=Math.floor(t.y||n.y||0)+i,t.width=Math.floor((t.width||n.width||0)-2*i),t.height=Math.floor((t.height||n.height||0)-2*i),c(t.strokeWidth)&&(t.strokeWidth=e),t},css:function(t){var e,i,n=this.styles,o={},s=this.element,a="",h=!n,c=["textOutline","textOverflow","width"];return t&&t.color&&(t.fill=t.color),n&&C(t,function(t,e){t!==n[e]&&(o[e]=t,h=!0)}),h&&(n&&(t=f(n,o)),e=this.textWidth=t&&t.width&&"auto"!==t.width&&"text"===s.nodeName.toLowerCase()&&O(t.width),this.styles=t,e&&!B&&this.renderer.forExport&&delete t.width,M&&!B?l(this.element,t):(i=function(t,e){return"-"+e.toLowerCase()},C(t,function(t,e){-1===y(e,c)&&(a+=e.replace(/([A-Z])/g,i)+":"+t+";")}),a&&r(s,"style",a)),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),t&&t.textOutline&&this.applyTextOutline(t.textOutline))),this},strokeWidth:function(){return this["stroke-width"]||0},on:function(t,e){var i=this,n=i.element;return v&&"click"===t?(n.ontouchstart=function(t){i.touchEventFired=Date.now(),t.preventDefault(),e.call(n,t)},n.onclick=function(t){(-1===R.navigator.userAgent.indexOf("Android")||Date.now()-(i.touchEventFired||0)>1100)&&e.call(n,t)}):n["on"+t]=e,this},setRadialReference:function(t){var e=this.renderer.gradients[this.element.gradient];return this.element.radialReference=t,e&&e.radAttr&&e.animate(this.renderer.getRadialAttr(t,e.radAttr)),this},translate:function(t,e){return this.attr({translateX:t,translateY:e})},invert:function(t){var e=this;return e.inverted=t,e.updateTransform(),e},updateTransform:function(){var t,e=this,i=e.translateX||0,n=e.translateY||0,o=e.scaleX,r=e.scaleY,s=e.inverted,a=e.rotation,l=e.matrix,h=e.element;s&&(i+=e.width,n+=e.height),t=["translate("+i+","+n+")"],c(l)&&t.push("matrix("+l.join(",")+")"),s?t.push("rotate(90) scale(-1,1)"):a&&t.push("rotate("+a+" "+L(this.rotationOriginX,h.getAttribute("x"),0)+" "+L(this.rotationOriginY,h.getAttribute("y")||0)+")"),(c(o)||c(r))&&t.push("scale("+L(o,1)+" "+L(r,1)+")"),t.length&&h.setAttribute("transform",t.join(" "))},toFront:function(){var t=this.element;return t.parentNode.appendChild(t),this},align:function(t,e,i){var n,o,r,s,a,l,h,c={},d=this.renderer,p=d.alignedObjects;return t?(this.alignOptions=t,this.alignByTranslate=e,(!i||S(i))&&(this.alignTo=a=i||"renderer",m(p,this),p.push(this),i=null)):(t=this.alignOptions,e=this.alignByTranslate,a=this.alignTo),i=L(i,d[a],d),n=t.align,o=t.verticalAlign,r=(i.x||0)+(t.x||0),s=(i.y||0)+(t.y||0),"right"===n?l=1:"center"===n&&(l=2),l&&(r+=(i.width-(t.width||0))/l),c[e?"translateX":"x"]=Math.round(r),"bottom"===o?h=1:"middle"===o&&(h=2),h&&(s+=(i.height-(t.height||0))/h),c[e?"translateY":"y"]=Math.round(s),this[this.placed?"animate":"attr"](c),this.placed=!0,this.alignAttr=c,this},getBBox:function(t,e){var i,n,o,r,s,a,l,h,p=this,u=p.renderer,m=p.element,x=p.styles,v=p.textStr,y=u.cache,b=u.cacheKeys;if(r=L(e,p.rotation),s=r*d,a=x&&x.fontSize,c(v)&&(h=v.toString(),-1===h.indexOf("<")&&(h=h.replace(/[0-9]/g,"0")),h+=["",r||0,a,x&&x.width,x&&x.textOverflow].join(",")),h&&!t&&(i=y[h]),!i){if(m.namespaceURI===p.SVG_NS||u.forExport){try{l=this.fakeTS&&function(t){g(m.querySelectorAll(".highcharts-text-outline"),function(e){e.style.display=t})},l&&l("none"),i=m.getBBox?f({},m.getBBox()):{width:m.offsetWidth,height:m.offsetHeight},l&&l("")}catch(t){}(!i||i.width<0)&&(i={width:0,height:0})}else i=p.htmlGetBBox();if(u.isSVG&&(n=i.width,o=i.height,x&&"11px"===x.fontSize&&17===Math.round(o)&&(i.height=o=14),r&&(i.width=Math.abs(o*Math.sin(s))+Math.abs(n*Math.cos(s)),i.height=Math.abs(o*Math.cos(s))+Math.abs(n*Math.sin(s)))),h&&i.height>0){for(;b.length>250;)delete y[b.shift()];y[h]||b.push(h),y[h]=i}}return i},show:function(t){return this.attr({visibility:t?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(t){var e=this;e.animate({opacity:0},{duration:t||150,complete:function(){e.attr({y:-9999})}})},add:function(t){var e,i=this.renderer,n=this.element;return t&&(this.parentGroup=t),this.parentInverted=t&&t.inverted,void 0!==this.textStr&&i.buildText(this),this.added=!0,(!t||t.handleZ||this.zIndex)&&(e=this.zIndexSetter()),e||(t?t.element:i.box).appendChild(n),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(t){var e=t.parentNode;e&&e.removeChild(t)},destroy:function(){var t,e,i=this,n=i.element||{},o=i.renderer.isSVG&&"SPAN"===n.nodeName&&i.parentGroup,r=n.ownerSVGElement;if(n.onclick=n.onmouseout=n.onmouseover=n.onmousemove=n.point=null,I(i),i.clipPath&&r&&(g(r.querySelectorAll("[clip-path],[CLIP-PATH]"),function(t){t.getAttribute("clip-path").match(RegExp('[("]#'+i.clipPath.element.id+'[)"]'))&&t.removeAttribute("clip-path")}),i.clipPath=i.clipPath.destroy()),i.stops){for(e=0;e<i.stops.length;e++)i.stops[e]=i.stops[e].destroy();i.stops=null}for(i.safeRemoveChild(n),i.destroyShadows();o&&o.div&&0===o.div.childNodes.length;)t=o.parentGroup,i.safeRemoveChild(o.div),delete o.div,o=t;return i.alignTo&&m(i.renderer.alignedObjects,i),C(i,function(t,e){delete i[e]}),null},shadow:function(t,e,i){var n,o,s,a,l,h,c=[],d=this.element;if(t){if(!this.shadows){for(a=L(t.width,3),l=(t.opacity||.15)/a,h=this.parentInverted?"(-1,-1)":"("+L(t.offsetX,1)+", "+L(t.offsetY,1)+")",n=1;a>=n;n++)o=d.cloneNode(0),s=2*a+1-2*n,r(o,{isShadow:"true",stroke:t.color||"#000000","stroke-opacity":l*n,"stroke-width":s,transform:"translate"+h,fill:"none"}),i&&(r(o,"height",Math.max(r(o,"height")-s,0)),o.cutHeight=s),e?e.element.appendChild(o):d.parentNode&&d.parentNode.insertBefore(o,d),c.push(o);this.shadows=c}}else this.destroyShadows();return this},destroyShadows:function(){g(this.shadows||[],function(t){this.safeRemoveChild(t)},this),this.shadows=void 0},xGetter:function(t){return"circle"===this.element.nodeName&&("x"===t?t="cx":"y"===t&&(t="cy")),this._defaultGetter(t)},_defaultGetter:function(t){var e=L(this[t+"Value"],this[t],this.element?this.element.getAttribute(t):null,0);return/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e},dSetter:function(t,e,i){t&&t.join&&(t=t.join(" ")),/(NaN| {2}|^$)/.test(t)&&(t="M 0 0"),this[e]!==t&&(i.setAttribute(e,t),this[e]=t)},dashstyleSetter:function(t){var e,i=this["stroke-width"];if("inherit"===i&&(i=1),t=t&&t.toLowerCase()){for(t=t.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),e=t.length;e--;)t[e]=O(t[e])*i;t=t.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",t)}},alignSetter:function(t){var e={left:"start",center:"middle",right:"end"};this.alignValue=t,this.element.setAttribute("text-anchor",e[t])},opacitySetter:function(t,e,i){this[e]=t,i.setAttribute(e,t)},titleSetter:function(t){var e=this.element.getElementsByTagName("title")[0];e||(e=u.createElementNS(this.SVG_NS,"title"),this.element.appendChild(e)),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(u.createTextNode(String(L(t),"").replace(/<[^>]*>/g,"")))},textSetter:function(t){t!==this.textStr&&(delete this.bBox,this.textStr=t,this.added&&this.renderer.buildText(this))},fillSetter:function(t,e,i){"string"==typeof t?i.setAttribute(e,t):t&&this.colorGradient(t,e,i)},visibilitySetter:function(t,e,i){"inherit"===t?i.removeAttribute(e):this[e]!==t&&i.setAttribute(e,t),this[e]=t},zIndexSetter:function(t,e){var i,n,o,r,s,a,l=this.renderer,h=this.parentGroup,d=h||l,p=d.element||l.box,u=this.element,g=p===l.box,f=this.added;if(c(t)&&(u.zIndex=t,t=+t,this[e]===t&&(f=!1),this[e]=t),f){for(t=this.zIndex,t&&h&&(h.handleZ=!0),i=p.childNodes,a=i.length-1;a>=0&&!r;a--)n=i[a],o=n.zIndex,s=!c(o),n!==u&&(0>t&&s&&!g&&!a?(p.insertBefore(u,i[a]),r=!0):(O(o)<=t||s&&(!c(t)||t>=0))&&(p.insertBefore(u,i[a+1]||null),r=!0));r||(p.insertBefore(u,i[g?3:0]||null),r=!0)}return r},_defaultSetter:function(t,e,i){i.setAttribute(e,t)}}),e.prototype.yGetter=e.prototype.xGetter,e.prototype.translateXSetter=e.prototype.translateYSetter=e.prototype.rotationSetter=e.prototype.verticalAlignSetter=e.prototype.rotationOriginXSetter=e.prototype.rotationOriginYSetter=e.prototype.scaleXSetter=e.prototype.scaleYSetter=e.prototype.matrixSetter=function(t,e){this[e]=t,this.doTransform=!0},e.prototype["stroke-widthSetter"]=e.prototype.strokeSetter=function(t,i,n){this[i]=t,this.stroke&&this["stroke-width"]?(e.prototype.fillSetter.call(this,this.stroke,"stroke",n),n.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===i&&0===t&&this.hasStroke&&(n.removeAttribute("stroke"),this.hasStroke=!1)},i=t.SVGRenderer=function(){this.init.apply(this,arguments)},f(i.prototype,{Element:e,SVG_NS:z,init:function(t,e,i,o,s,a){var h,c,d,p=this;h=p.createElement("svg").attr({version:"1.1",class:"highcharts-root"}).css(this.getStyle(o)),c=h.element,t.appendChild(c),r(t,"dir","ltr"),-1===t.innerHTML.indexOf("xmlns")&&r(c,"xmlns",this.SVG_NS),p.isSVG=!0,this.box=c,this.boxWrapper=h,p.alignedObjects=[],this.url=(k||A)&&u.getElementsByTagName("base").length?R.location.href.replace(/#.*?$/,"").replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",d=this.createElement("desc").add(),d.element.appendChild(u.createTextNode("Created with Highstock 6.0.4")),p.defs=this.createElement("defs").add(),p.allowHTML=a,p.forExport=s,p.gradients={},p.cache={},p.cacheKeys=[],p.imgCount=0,p.setSize(e,i,!1);var g,f;k&&t.getBoundingClientRect&&(g=function(){l(t,{left:0,top:0}),f=t.getBoundingClientRect(),l(t,{left:Math.ceil(f.left)-f.left+"px",top:Math.ceil(f.top)-f.top+"px"})},g(),p.unSubPixelFix=n(R,"resize",g))},getStyle:function(t){return this.style=f({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},t),this.style},setStyle:function(t){this.boxWrapper.css(this.getStyle(t))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this,e=t.defs;return t.box=null,t.boxWrapper=t.boxWrapper.destroy(),p(t.gradients||{}),t.gradients=null,e&&(t.defs=e.destroy()),t.unSubPixelFix&&t.unSubPixelFix(),t.alignedObjects=null,null},createElement:function(t){var e=new this.Element;return e.init(this,t),e},draw:P,getRadialAttr:function(t,e){return{cx:t[0]-t[2]/2+e.cx*t[2],cy:t[1]-t[2]/2+e.cy*t[2],r:e.r*t[2]}},getSpanWidth:function(t,e){var i=this,n=t.getBBox(!0),o=n.width;return!B&&i.forExport&&(o=i.measureSpanWidth(e.firstChild.data,t.styles)),o},applyEllipsis:function(t,e,i,n){var o,r,s,a=this,l=t.rotation,h=i,c=0,d=i.length,p=function(t){e.removeChild(e.firstChild),t&&e.appendChild(u.createTextNode(t))};if(t.rotation=0,r=a.getSpanWidth(t,e),s=r>n){for(;d>=c;)o=Math.ceil((c+d)/2),h=i.substring(0,o)+"…",p(h),r=a.getSpanWidth(t,e),c===d?c=d+1:r>n?d=o-1:c=o;0===d&&p("")}return t.rotation=l,s},escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},buildText:function(t){var e,i,n,o,s,a,h,c=t.element,d=this,p=d.forExport,f=L(t.textStr,"").toString(),m=-1!==f.indexOf("<"),v=c.childNodes,y=r(c,"x"),b=t.styles,k=t.textWidth,M=b&&b.lineHeight,w=b&&b.textOutline,S=b&&"ellipsis"===b.textOverflow,A=b&&"nowrap"===b.whiteSpace,T=b&&b.fontSize,P=v.length,D=k&&!t.added&&this.box,I=function(t){var e;return e=/(px|em)$/.test(t&&t.style.fontSize)?t.style.fontSize:T||d.style.fontSize||12,M?O(M):d.fontMetrics(e,t.getAttribute("style")?t:c).h},E=function(t){return C(d.escapes,function(e,i){t=t.replace(new RegExp(e,"g"),i)}),t};if(a=[f,S,A,M,w,T,k].join(","),a!==t.textCache){for(t.textCache=a;P--;)c.removeChild(v[P]);m||w||S||k||-1!==f.indexOf(" ")?(i=/<.*class="([^"]+)".*>/,n=/<.*style="([^"]+)".*>/,o=/<.*href="([^"]+)".*>/,D&&D.appendChild(c),e=m?f.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[f],e=x(e,function(t){return""!==t}),g(e,function(e,a){var f,m=0;e=e.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),f=e.split("|||"),g(f,function(e){if(""!==e||1===f.length){var g,x,v={},b=u.createElementNS(d.SVG_NS,"tspan");if(i.test(e)&&(g=e.match(i)[1],r(b,"class",g)),n.test(e)&&(x=e.match(n)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),r(b,"style",x)),o.test(e)&&!p&&(r(b,"onclick",'location.href="'+e.match(o)[1]+'"'),r(b,"class","highcharts-anchor"),l(b,{cursor:"pointer"})),e=E(e.replace(/<[a-zA-Z\/](.|\n)*?>/g,"")||" ")," "!==e){if(b.appendChild(u.createTextNode(e)),m?v.dx=0:a&&null!==y&&(v.x=y),r(b,v),c.appendChild(b),!m&&h&&(!B&&p&&l(b,{display:"block"}),r(b,"dy",I(b))),k){var M,w,T=e.replace(/([^\^])-/g,"$1- ").split(" "),P=f.length>1||a||T.length>1&&!A,C=[],L=I(b),O=t.rotation;for(S&&(s=d.applyEllipsis(t,b,e,k));!S&&P&&(T.length||C.length);)t.rotation=0,w=d.getSpanWidth(t,b),M=w>k,void 0===s&&(s=M),M&&1!==T.length?(b.removeChild(b.firstChild),C.unshift(T.pop())):(T=C,C=[],T.length&&!A&&(b=u.createElementNS(z,"tspan"),r(b,{dy:L,x:y}),x&&r(b,"style",x),c.appendChild(b)),w>k&&(k=w)),T.length&&b.appendChild(u.createTextNode(T.join(" ").replace(/- /g,"-")));t.rotation=O}m++}}}),h=h||c.childNodes.length}),s&&t.attr("title",t.textStr),D&&D.removeChild(c),w&&t.applyTextOutline&&t.applyTextOutline(w)):c.appendChild(u.createTextNode(E(f)))}},getContrast:function(t){return t=a(t).rgba,t[0]+t[1]+t[2]>510?"#000000":"#FFFFFF"},button:function(t,e,i,o,r,s,a,l,h){var c=this.label(t,e,i,h,null,null,null,null,"button"),d=0;c.attr(T({padding:8,r:2},r));var p,u,g,m;return r=T({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},r),p=r.style,delete r.style,s=T(r,{fill:"#e6e6e6"},s),u=s.style,delete s.style,a=T(r,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},a),g=a.style,delete a.style,l=T(r,{style:{color:"#cccccc"}},l),m=l.style,delete l.style,n(c.element,M?"mouseover":"mouseenter",function(){3!==d&&c.setState(1)}),n(c.element,M?"mouseout":"mouseleave",function(){3!==d&&c.setState(d)}),c.setState=function(t){1!==t&&(c.state=d=t),c.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),c.attr([r,s,a,l][t||0]).css([p,u,g,m][t||0])},c.attr(r).css(f({cursor:"default"},p)),c.on("click",function(t){3!==d&&o.call(c,t)})},crispLine:function(t,e){return t[1]===t[4]&&(t[1]=t[4]=Math.round(t[1])-e%2/2),t[2]===t[5]&&(t[2]=t[5]=Math.round(t[2])+e%2/2),t},path:function(t){var e={fill:"none"};return b(t)?e.d=t:w(t)&&f(e,t),this.createElement("path").attr(e)},circle:function(t,e,i){var n=w(t)?t:{x:t,y:e,r:i},o=this.createElement("circle");return o.xSetter=o.ySetter=function(t,e,i){i.setAttribute("c"+e,t)},o.attr(n)},arc:function(t,e,i,n,o,r){var s,a;return w(t)?(a=t,e=a.y,i=a.r,n=a.innerR,o=a.start,r=a.end,t=a.x):a={innerR:n,start:o,end:r},s=this.symbol("arc",t,e,i,i,a),s.r=i,s},rect:function(t,e,i,n,o,s){o=w(t)?t.r:o;var a=this.createElement("rect"),l=w(t)?t:void 0===t?{}:{x:t,y:e,width:Math.max(i,0),height:Math.max(n,0)};return void 0!==s&&(l.strokeWidth=s,l=a.crisp(l)),l.fill="none",o&&(l.r=o),a.rSetter=function(t,e,i){r(i,{rx:t,ry:t})},a.attr(l)},setSize:function(t,e,i){var n=this,o=n.alignedObjects,r=o.length;for(n.width=t,n.height=e,n.boxWrapper.animate({width:t,height:e},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:L(i,!0)?void 0:0});r--;)o[r].align()},g:function(t){var e=this.createElement("g");return t?e.attr({class:"highcharts-"+t}):e},image:function(t,e,i,n,o){var r,s={preserveAspectRatio:"none"};return arguments.length>1&&f(s,{x:e,y:i,width:n,height:o}),r=this.createElement("image").attr(s),r.element.setAttributeNS?r.element.setAttributeNS("http://www.w3.org/1999/xlink","href",t):r.element.setAttribute("hc-svg-href",t),r},symbol:function(t,e,i,n,o,r){var a,d,p,m=this,x=/^url\((.*?)\)$/,v=x.test(t),y=!v&&(this.symbols[t]?t:"circle"),b=y&&this.symbols[y],k=c(e)&&b&&b.call(this.symbols,Math.round(e),Math.round(i),n,o,r);return b?(a=this.path(k),a.attr("fill","none"),f(a,{symbolName:y,x:e,y:i,width:n,height:o}),r&&f(a,r)):v&&(d=t.match(x)[1],a=this.image(d),a.imgwidth=L(E[d]&&E[d].width,r&&r.width),a.imgheight=L(E[d]&&E[d].height,r&&r.height),p=function(){a.attr({width:a.width,height:a.height})},g(["width","height"],function(t){a[t+"Setter"]=function(t,e){var i={},n=this["img"+e],o="width"===e?"translateX":"translateY";this[e]=t,c(n)&&(this.element&&this.element.setAttribute(e,n),this.alignByTranslate||(i[o]=((this[e]||0)-n)/2,this.attr(i)))}}),c(e)&&a.attr({x:e,y:i}),a.isImg=!0,c(a.imgwidth)&&c(a.imgheight)?p():(a.attr({width:0,height:0}),h("img",{onload:function(){var t=s[m.chartIndex];0===this.width&&(l(this,{position:"absolute",top:"-999em"}),u.body.appendChild(this)),E[d]={width:this.width,height:this.height},a.imgwidth=this.width,a.imgheight=this.height,a.element&&p(),this.parentNode&&this.parentNode.removeChild(this),m.imgCount--,!m.imgCount&&t&&t.onload&&t.onload()},src:d}),this.imgCount++)),a},symbols:{circle:function(t,e,i,n){return this.arc(t+i/2,e+n/2,i/2,n/2,{start:0,end:2*Math.PI,open:!1})},square:function(t,e,i,n){return["M",t,e,"L",t+i,e,t+i,e+n,t,e+n,"Z"]},triangle:function(t,e,i,n){return["M",t+i/2,e,"L",t+i,e+n,t,e+n,"Z"]},"triangle-down":function(t,e,i,n){return["M",t,e,"L",t+i,e,t+i/2,e+n,"Z"]},diamond:function(t,e,i,n){return["M",t+i/2,e,"L",t+i,e+n/2,t+i/2,e+n,t,e+n/2,"Z"]},arc:function(t,e,i,n,o){var r,s=o.start,a=o.r||i,l=o.r||n||i,h=.001,d=Math.abs(o.end-o.start-2*Math.PI)<h,p=o.end-h,u=o.innerR,g=L(o.open,d),f=Math.cos(s),m=Math.sin(s),x=Math.cos(p),v=Math.sin(p),y=o.end-s-Math.PI<h?0:1;return r=["M",t+a*f,e+l*m,"A",a,l,0,y,1,t+a*x,e+l*v],c(u)&&r.push(g?"M":"L",t+u*x,e+u*v,"A",u,u,0,y,0,t+u*f,e+u*m),r.push(g?"":"Z"),r},callout:function(t,e,i,n,o){var r,s=6,a=6,l=Math.min(o&&o.r||0,i,n),h=l+a,c=o&&o.anchorX,d=o&&o.anchorY;return r=["M",t+l,e,"L",t+i-l,e,"C",t+i,e,t+i,e,t+i,e+l,"L",t+i,e+n-l,"C",t+i,e+n,t+i,e+n,t+i-l,e+n,"L",t+l,e+n,"C",t,e+n,t,e+n,t,e+n-l,"L",t,e+l,"C",t,e,t,e,t+l,e],c&&c>i?d>e+h&&e+n-h>d?r.splice(13,3,"L",t+i,d-a,t+i+s,d,t+i,d+a,t+i,e+n-l):r.splice(13,3,"L",t+i,n/2,c,d,t+i,n/2,t+i,e+n-l):c&&0>c?d>e+h&&e+n-h>d?r.splice(33,3,"L",t,d+a,t-s,d,t,d-a,t,e+l):r.splice(33,3,"L",t,n/2,c,d,t,n/2,t,e+l):d&&d>n&&c>t+h&&t+i-h>c?r.splice(23,3,"L",c+a,e+n,c,e+n+s,c-a,e+n,t+l,e+n):d&&0>d&&c>t+h&&t+i-h>c&&r.splice(3,3,"L",c-a,e,c,e-s,c+a,e,i-l,e),r}},clipRect:function(e,i,n,o){var r,s=t.uniqueKey(),a=this.createElement("clipPath").attr({id:s}).add(this.defs);return r=this.rect(e,i,n,o,0).add(a),r.id=s,r.clipPath=a,r.count=0,r},text:function(t,e,i,n){var o,r=this,s={};return!n||!r.allowHTML&&r.forExport?(s.x=Math.round(e||0),i&&(s.y=Math.round(i)),(t||0===t)&&(s.text=t),o=r.createElement("text").attr(s),n||(o.xSetter=function(t,e,i){var n,o,r=i.getElementsByTagName("tspan"),s=i.getAttribute(e);for(o=0;o<r.length;o++)n=r[o],n.getAttribute(e)===s&&n.setAttribute(e,t);i.setAttribute(e,t)}),o):r.html(t,e,i)},fontMetrics:function(t,e){var i,n;return t=t||e&&e.style&&e.style.fontSize||this.style&&this.style.fontSize,t=/px/.test(t)?O(t):/em/.test(t)?parseFloat(t)*(e?this.fontMetrics(null,e.parentNode).f:16):12,i=24>t?t+3:Math.round(1.2*t),n=Math.round(.8*i),{h:i,b:n,f:t}},rotCorr:function(t,e,i){var n=t;return e&&i&&(n=Math.max(n*Math.cos(e*d),4)),{x:-t/3*Math.sin(e*d),y:n}},label:function(i,n,o,r,s,a,l,h,d){var p,u,m,x,v,y,b,k,M,w,S,A,P,C=this,L=C.g("button"!==d&&"label"),O=L.text=C.text("",0,0,l).attr({zIndex:1}),I=0,B=3,z=0,E={},R=/^url\((.*?)\)$/.test(r),G=R;d&&L.addClass("highcharts-"+d),G=R,w=function(){return(k||0)%2/2},S=function(){var t,e=O.element.style,i={};u=(void 0===m||void 0===x||b)&&c(O.textStr)&&O.getBBox(),L.width=(m||u.width||0)+2*B+z,L.height=(x||u.height||0)+2*B,M=B+C.fontMetrics(e&&e.fontSize,O).b,G&&(p||(L.box=p=C.symbols[r]||R?C.symbol(r):C.rect(),p.addClass(("button"===d?"":"highcharts-label-box")+(d?" highcharts-"+d+"-box":"")),p.add(L),t=w(),i.x=t,i.y=(h?-M:0)+t),i.width=Math.round(L.width),i.height=Math.round(L.height),p.attr(f(i,E)),E={})},A=function(){var t,e=z+B;t=h?0:M,c(m)&&u&&("center"===b||"right"===b)&&(e+={center:.5,right:1}[b]*(m-u.width)),(e!==O.x||t!==O.y)&&(O.attr("x",e),void 0!==t&&O.attr("y",t)),O.x=e,O.y=t},P=function(t,e){p?p.attr(t,e):E[t]=e},L.onAdd=function(){O.add(L),L.attr({text:i||0===i?i:"",x:n,y:o}),p&&c(s)&&L.attr({anchorX:s,anchorY:a})},L.widthSetter=function(e){m=t.isNumber(e)?e:null},L.heightSetter=function(t){x=t},L["text-alignSetter"]=function(t){b=t},L.paddingSetter=function(t){c(t)&&t!==B&&(B=L.padding=t,A())},L.paddingLeftSetter=function(t){c(t)&&t!==z&&(z=t,A())},L.alignSetter=function(t){t={left:0,center:.5,right:1}[t],t!==I&&(I=t,u&&L.attr({x:v}))},L.textSetter=function(t){void 0!==t&&O.textSetter(t),S(),A()},L["stroke-widthSetter"]=function(t,e){t&&(G=!0),k=this["stroke-width"]=t,P(e,t)},L.strokeSetter=L.fillSetter=L.rSetter=function(t,e){"r"!==e&&("fill"===e&&t&&(G=!0),L[e]=t),P(e,t)},L.anchorXSetter=function(t,e){s=L.anchorX=t,P(e,Math.round(t)-w()-v)},L.anchorYSetter=function(t,e){a=L.anchorY=t,P(e,t-y)},L.xSetter=function(t){L.x=t,I&&(t-=I*((m||u.width)+2*B)),v=Math.round(t),L.attr("translateX",v)},L.ySetter=function(t){y=L.y=Math.round(t),L.attr("translateY",y)};var X=L.css;return f(L,{css:function(t){if(t){var e={};t=T(t),g(L.textProps,function(i){void 0!==t[i]&&(e[i]=t[i],delete t[i])}),O.css(e)}return X.call(L,t)},getBBox:function(){return{width:u.width+2*B,height:u.height+2*B,x:u.x-B,y:u.y-B}},shadow:function(t){return t&&(S(),p&&p.shadow(t)),L},destroy:function(){D(L.element,"mouseenter"),D(L.element,"mouseleave"),O&&(O=O.destroy()),p&&(p=p.destroy()),e.prototype.destroy.call(L),L=C=S=A=P=null}})}}),t.Renderer=i}(e),function(t){var e=t.attr,i=t.createElement,n=t.css,o=t.defined,r=t.each,s=t.extend,a=t.isFirefox,l=t.isMS,h=t.isWebKit,c=t.pick,d=t.pInt,p=t.SVGElement,u=t.SVGRenderer,g=t.win,f=t.wrap;s(p.prototype,{htmlCss:function(t){var e=this,i=e.element,o=t&&"SPAN"===i.tagName&&t.width;return o&&(delete t.width,e.textWidth=o,e.updateTransform()),t&&"ellipsis"===t.textOverflow&&(t.whiteSpace="nowrap",t.overflow="hidden"),e.styles=s(e.styles,t),n(e.element,t),e},htmlGetBBox:function(){var t=this,e=t.element;return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}},htmlUpdateTransform:function(){if(!this.added)return void(this.alignOnAdd=!0);var t=this,e=t.renderer,i=t.element,s=t.translateX||0,a=t.translateY||0,l=t.x||0,c=t.y||0,p=t.textAlign||"left",u={left:0,center:.5,right:1}[p],g=t.styles;if(n(i,{marginLeft:s,marginTop:a}),t.shadows&&r(t.shadows,function(t){n(t,{marginLeft:s+1,marginTop:a+1})}),t.inverted&&r(i.childNodes,function(t){e.invertChild(t,i)}),"SPAN"===i.tagName){var f,m=t.rotation,x=d(t.textWidth),v=g&&g.whiteSpace,y=[m,p,i.innerHTML,t.textWidth,t.textAlign].join(",");y!==t.cTT&&(f=e.fontMetrics(i.style.fontSize).b,o(m)&&t.setSpanRotation(m,u,f),n(i,{width:"",whiteSpace:v||"nowrap"}),i.offsetWidth>x&&/[ \-]/.test(i.textContent||i.innerText)&&n(i,{width:x+"px",display:"block",whiteSpace:v||"normal"}),t.getSpanCorrection(i.offsetWidth,f,u,m,p)),n(i,{left:l+(t.xCorr||0)+"px",top:c+(t.yCorr||0)+"px"}),h&&(f=i.offsetHeight),t.cTT=y}},setSpanRotation:function(t,e,i){var o={},r=this.renderer.getTransformKey();o[r]=o.transform="rotate("+t+"deg)",o[r+(a?"Origin":"-origin")]=o.transformOrigin=100*e+"% "+i+"px",n(this.element,o)},getSpanCorrection:function(t,e,i){this.xCorr=-t*i,this.yCorr=-e}}),s(u.prototype,{getTransformKey:function(){return l&&!/Edge/.test(g.navigator.userAgent)?"-ms-transform":h?"-webkit-transform":a?"MozTransform":g.opera?"-o-transform":""},html:function(t,n,o){var a=this.createElement("span"),h=a.element,d=a.renderer,p=d.isSVG,u=function(t,e){r(["opacity","visibility"],function(i){f(t,i+"Setter",function(t,i,n,o){t.call(this,i,n,o),e[n]=i})})};return a.textSetter=function(t){t!==h.innerHTML&&delete this.bBox,this.textStr=t,h.innerHTML=c(t,""),a.htmlUpdateTransform()},p&&u(a,a.element.style),a.xSetter=a.ySetter=a.alignSetter=a.rotationSetter=function(t,e){"align"===e&&(e="textAlign"),a[e]=t,a.htmlUpdateTransform()},a.attr({text:t,x:Math.round(n),y:Math.round(o)}).css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize,position:"absolute"}),h.style.whiteSpace="nowrap",a.css=a.htmlCss,p&&(a.add=function(t){var n,o,c=d.box.parentNode,p=[];if(this.parentGroup=t,t){if(n=t.div,!n){for(o=t;o;)p.push(o),o=o.parentGroup;r(p.reverse(),function(t){function o(e,i){t[i]=e,l?r[d.getTransformKey()]="translate("+(t.x||t.translateX)+"px,"+(t.y||t.translateY)+"px)":"translateX"===i?r.left=e+"px":r.top=e+"px",t.doTransform=!0}var r,h=e(t.element,"class");h&&(h={className:h}),n=t.div=t.div||i("div",h,{position:"absolute",left:(t.translateX||0)+"px",top:(t.translateY||0)+"px",display:t.display,opacity:t.opacity,pointerEvents:t.styles&&t.styles.pointerEvents},n||c),r=n.style,s(t,{classSetter:function(t){return function(e){this.element.setAttribute("class",e),t.className=e}}(n),on:function(){return p[0].div&&a.on.apply({element:p[0].div},arguments),t},translateXSetter:o,translateYSetter:o}),u(t,r)})}}else n=c;return n.appendChild(h),a.added=!0,a.alignOnAdd&&a.htmlUpdateTransform(),a}),a}})}(e),function(t){function e(){var e=t.defaultOptions.global,i=h.moment;if(e.timezone){if(i)return function(t){return-i.tz(t,e.timezone).utcOffset()};t.error(25)}return e.useUTC&&e.getTimezoneOffset}function i(){var i,n,r=t.defaultOptions.global,s=r.useUTC,l=s?"getUTC":"get",c=s?"setUTC":"set",d=["Minutes","Hours","Day","Date","Month","FullYear"],p=d.concat(["Milliseconds","Seconds"]);for(t.Date=i=r.Date||h.Date,i.hcTimezoneOffset=s&&r.timezoneOffset,i.hcGetTimezoneOffset=e(),i.hcHasTimeZone=!(!i.hcTimezoneOffset&&!i.hcGetTimezoneOffset),i.hcMakeTime=function(t,e,n,r,l,h){var c;return s?(c=i.UTC.apply(0,arguments),c+=o(c)):c=new i(t,e,a(n,1),a(r,0),a(l,0),a(h,0)).getTime(),c},n=0;n<d.length;n++)i["hcGet"+d[n]]=l+d[n];for(n=0;n<p.length;n++)i["hcSet"+p[n]]=c+p[n]}var n=t.color,o=t.getTZOffset,r=t.isTouchDevice,s=t.merge,a=t.pick,l=t.svg,h=t.win;t.defaultOptions={colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" "),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0},chart:{borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:l,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",padding:8,snap:r?25:10,backgroundColor:n("#f7f7f7").setOpacity(.85).get(),borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}},t.setOptions=function(e){return t.defaultOptions=s(!0,t.defaultOptions,e),i(),t.defaultOptions},t.getOptions=function(){return t.defaultOptions},t.defaultPlotOptions=t.defaultOptions.plotOptions,i()}(e),function(t){var e=t.correctFloat,i=t.defined,n=t.destroyObjectProperties,o=t.isNumber,r=t.merge,s=t.pick,a=t.deg2rad;t.Tick=function(t,e,i,n){this.axis=t,this.pos=e,this.type=i||"",this.isNew=!0,this.isNewLabel=!0,i||n||this.addLabel()},t.Tick.prototype={addLabel:function(){var t,n,o=this,a=o.axis,l=a.options,h=a.chart,c=a.categories,d=a.names,p=o.pos,u=l.labels,g=a.tickPositions,f=p===g[0],m=p===g[g.length-1],x=c?s(c[p],d[p],p):p,v=o.label,y=g.info;a.isDatetimeAxis&&y&&(n=l.dateTimeLabelFormats[y.higherRanks[p]||y.unitName]),o.isFirst=f,o.isLast=m,t=a.labelFormatter.call({axis:a,chart:h,isFirst:f,isLast:m,dateTimeLabelFormat:n,value:a.isLog?e(a.lin2log(x)):x,pos:p}),i(v)?v&&v.attr({text:t}):(o.label=v=i(t)&&u.enabled?h.renderer.text(t,0,0,u.useHTML).css(r(u.style)).add(a.labelGroup):null,o.labelLength=v&&v.getBBox().width,o.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(t){var e,i,n,o=this.axis,r=o.options.labels,l=t.x,h=o.chart.chartWidth,c=o.chart.spacing,d=s(o.labelLeft,Math.min(o.pos,c[3])),p=s(o.labelRight,Math.max(o.isRadial?0:o.pos+o.len,h-c[1])),u=this.label,g=this.rotation,f={left:0,center:.5,right:1}[o.labelAlign||u.attr("align")],m=u.getBBox().width,x=o.getSlotWidth(),v=x,y=f,b=1,k={};g||r.overflow===!1?0>g&&d>l-f*m?n=Math.round(l/Math.cos(g*a)-d):g>0&&l+f*m>p&&(n=Math.round((h-l)/Math.cos(g*a))):(e=l-f*m,i=l+(1-f)*m,d>e?v=t.x+v*(1-f)-d:i>p&&(v=p-t.x+v*f,b=-1),v=Math.min(x,v),x>v&&"center"===o.labelAlign&&(t.x+=b*(x-v-y*(x-Math.min(m,v)))),(m>v||o.autoRotation&&(u.styles||{}).width)&&(n=v)),n&&(k.width=n,(r.style||{}).textOverflow||(k.textOverflow="ellipsis"),u.css(k))},getPosition:function(t,e,i,n){var o=this.axis,r=o.chart,s=n&&r.oldChartHeight||r.chartHeight;return{x:t?o.translate(e+i,null,null,n)+o.transB:o.left+o.offset+(o.opposite?(n&&r.oldChartWidth||r.chartWidth)-o.right-o.left:0),y:t?s-o.bottom+o.offset-(o.opposite?o.height:0):s-o.translate(e+i,null,null,n)-o.transB}},getLabelPosition:function(t,e,n,o,r,s,l,h){var c,d=this.axis,p=d.transA,u=d.reversed,g=d.staggerLines,f=d.tickRotCorr||{x:0,y:0},m=r.y,x=o||d.reserveSpaceDefault?0:-d.labelOffset*("center"===d.labelAlign?.5:1);return i(m)||(m=0===d.side?n.rotation?-8:-n.getBBox().height:2===d.side?f.y+8:Math.cos(n.rotation*a)*(f.y-n.getBBox(!1,0).height/2)),t=t+r.x+x+f.x-(s&&o?s*p*(u?-1:1):0),e=e+m-(s&&!o?s*p*(u?1:-1):0),g&&(c=l/(h||1)%g,d.opposite&&(c=g-c-1),e+=c*(d.labelOffset/g)),{x:t,y:Math.round(e)}},getMarkPath:function(t,e,i,n,o,r){return r.crispLine(["M",t,e,"L",t+(o?0:-i),e+(o?i:0)],n)},renderGridLine:function(t,e,i){var n,o=this,r=o.axis,s=r.options,a=o.gridLine,l={},h=o.pos,c=o.type,d=r.tickmarkOffset,p=r.chart.renderer,u=c?c+"Grid":"grid",g=s[u+"LineWidth"],f=s[u+"LineColor"],m=s[u+"LineDashStyle"];a||(l.stroke=f,l["stroke-width"]=g,m&&(l.dashstyle=m),c||(l.zIndex=1),t&&(l.opacity=0),o.gridLine=a=p.path().attr(l).addClass("highcharts-"+(c?c+"-":"")+"grid-line").add(r.gridGroup)),!t&&a&&(n=r.getPlotLinePath(h+d,a.strokeWidth()*i,t,!0),n&&a[o.isNew?"attr":"animate"]({d:n,opacity:e}))},renderMark:function(t,e,i){var n=this,o=n.axis,r=o.options,a=o.chart.renderer,l=n.type,h=l?l+"Tick":"tick",c=o.tickSize(h),d=n.mark,p=!d,u=t.x,g=t.y,f=s(r[h+"Width"],!l&&o.isXAxis?1:0),m=r[h+"Color"];c&&(o.opposite&&(c[0]=-c[0]),p&&(n.mark=d=a.path().addClass("highcharts-"+(l?l+"-":"")+"tick").add(o.axisGroup),d.attr({stroke:m,"stroke-width":f})),d[p?"attr":"animate"]({d:n.getMarkPath(u,g,c[0],d.strokeWidth()*i,o.horiz,a),opacity:e}))},renderLabel:function(t,e,i,n){var r=this,a=r.axis,l=a.horiz,h=a.options,c=r.label,d=h.labels,p=d.step,u=a.tickmarkOffset,g=!0,f=t.x,m=t.y;c&&o(f)&&(c.xy=t=r.getLabelPosition(f,m,c,l,d,u,n,p),r.isFirst&&!r.isLast&&!s(h.showFirstLabel,1)||r.isLast&&!r.isFirst&&!s(h.showLastLabel,1)?g=!1:!l||d.step||d.rotation||e||0===i||r.handleOverflow(t),p&&n%p&&(g=!1),g&&o(t.y)?(t.opacity=i,c[r.isNewLabel?"attr":"animate"](t),r.isNewLabel=!1):(c.attr("y",-9999),r.isNewLabel=!0))},render:function(t,e,i){var n=this,o=n.axis,r=o.horiz,a=n.pos,l=o.tickmarkOffset,h=n.getPosition(r,a,l,e),c=h.x,d=h.y,p=r&&c===o.pos+o.len||!r&&d===o.pos?-1:1;i=s(i,1),this.isActive=!0,this.renderGridLine(e,i,p),this.renderMark(h,i,p),this.renderLabel(h,e,i,t),n.isNew=!1},destroy:function(){n(this,this.axis)}}}(e);var i=function(t){var e=t.addEvent,i=t.animObject,n=t.arrayMax,o=t.arrayMin,r=t.color,s=t.correctFloat,a=t.defaultOptions,l=t.defined,h=t.deg2rad,c=t.destroyObjectProperties,d=t.each,p=t.extend,u=t.fireEvent,g=t.format,f=t.getMagnitude,m=t.grep,x=t.inArray,v=t.isArray,y=t.isNumber,b=t.isString,k=t.merge,M=t.normalizeTickInterval,w=t.objectEach,S=t.pick,A=t.removeEvent,T=t.splat,P=t.syncTimeout,C=t.Tick,L=function(){this.init.apply(this,arguments)};return t.extend(L.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,labels:{enabled:!0,style:{color:"#666666",cursor:"default",fontSize:"11px"},x:0},maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",minPadding:.01,startOfWeek:1,startOnTick:!1,tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{allowOverlap:!1,enabled:!1,formatter:function(){return t.numberFormat(this.total,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"#000000",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(t,i){var n=i.isX,o=this;o.chart=t,o.horiz=t.inverted&&!o.isZAxis?!n:n,o.isXAxis=n,o.coll=o.coll||(n?"xAxis":"yAxis"),o.opposite=i.opposite,o.side=i.side||(o.horiz?o.opposite?0:2:o.opposite?1:3),o.setOptions(i);var r=this.options,s=r.type,a="datetime"===s;o.labelFormatter=r.labels.formatter||o.defaultLabelFormatter,o.userOptions=i,o.minPixelPadding=0,o.reversed=r.reversed,o.visible=r.visible!==!1,o.zoomEnabled=r.zoomEnabled!==!1,o.hasNames="category"===s||r.categories===!0,o.categories=r.categories||o.hasNames,o.names=o.names||[],o.plotLinesAndBandsGroups={},o.isLog="logarithmic"===s,o.isDatetimeAxis=a,o.positiveValuesOnly=o.isLog&&!o.allowNegativeLog,o.isLinked=l(r.linkedTo),o.ticks={},o.labelEdge=[],o.minorTicks={},o.plotLinesAndBands=[],o.alternateBands={},o.len=0,o.minRange=o.userMinRange=r.minRange||r.maxZoom,o.range=r.range,o.offset=r.offset||0,o.stacks={},o.oldStacks={},o.stacksTouched=0,o.max=null,o.min=null,o.crosshair=S(r.crosshair,T(t.options.tooltip.crosshairs)[n?0:1],!1);var h=o.options.events;-1===x(o,t.axes)&&(n?t.axes.splice(t.xAxis.length,0,o):t.axes.push(o),t[o.coll].push(o)),o.series=o.series||[],t.inverted&&!o.isZAxis&&n&&void 0===o.reversed&&(o.reversed=!0),w(h,function(t,i){e(o,i,t)}),o.lin2log=r.linearToLogConverter||o.lin2log,o.isLog&&(o.val2lin=o.log2lin,o.lin2val=o.lin2log)},setOptions:function(t){this.options=k(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],k(a[this.coll],t))},defaultLabelFormatter:function(){var e,i,n=this.axis,o=this.value,r=n.categories,s=this.dateTimeLabelFormat,l=a.lang,h=l.numericSymbols,c=l.numericSymbolMagnitude||1e3,d=h&&h.length,p=n.options.labels.format,u=n.isLog?Math.abs(o):n.tickInterval;if(p)i=g(p,this);else if(r)i=o;else if(s)i=t.dateFormat(s,o);else if(d&&u>=1e3)for(;d--&&void 0===i;)e=Math.pow(c,d+1),u>=e&&10*o%e===0&&null!==h[d]&&0!==o&&(i=t.numberFormat(o/e,-1)+h[d]);return void 0===i&&(i=Math.abs(o)>=1e4?t.numberFormat(o,-1):t.numberFormat(o,-1,void 0,"")),i},getSeriesExtremes:function(){var t=this,e=t.chart;t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.threshold=null,t.softThreshold=!t.isXAxis,t.buildStacks&&t.buildStacks(),d(t.series,function(i){if(i.visible||!e.options.chart.ignoreHiddenSeries){var r,s,a,h=i.options,c=h.threshold;t.hasVisibleSeries=!0,t.positiveValuesOnly&&0>=c&&(c=null),t.isXAxis?(r=i.xData,r.length&&(s=o(r),a=n(r),y(s)||s instanceof Date||(r=m(r,y),s=o(r)),t.dataMin=Math.min(S(t.dataMin,r[0],s),s),t.dataMax=Math.max(S(t.dataMax,r[0],a),a))):(i.getExtremes(),a=i.dataMax,s=i.dataMin,l(s)&&l(a)&&(t.dataMin=Math.min(S(t.dataMin,s),s),t.dataMax=Math.max(S(t.dataMax,a),a)),l(c)&&(t.threshold=c),(!h.softThreshold||t.positiveValuesOnly)&&(t.softThreshold=!1))}})},translate:function(t,e,i,n,o,r){var s,a=this.linkedParent||this,l=1,h=0,c=n?a.oldTransA:a.transA,d=n?a.oldMin:a.min,p=a.minPixelPadding,u=(a.isOrdinal||a.isBroken||a.isLog&&o)&&a.lin2val;return c||(c=a.transA),i&&(l*=-1,h=a.len),a.reversed&&(l*=-1,h-=l*(a.sector||a.len)),e?(t=t*l+h,t-=p,s=t/c+d,u&&(s=a.lin2val(s))):(u&&(t=a.val2lin(t)),s=y(d)?l*(t-d)*c+h+l*p+(y(r)?c*r:0):void 0),s},toPixels:function(t,e){return this.translate(t,!1,!this.horiz,null,!0)+(e?0:this.pos)},toValue:function(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(t,e,i,n,o){var r,s,a,l,h,c=this,d=c.chart,p=c.left,u=c.top,g=i&&d.oldChartHeight||d.chartHeight,f=i&&d.oldChartWidth||d.chartWidth,m=c.transB,x=function(t,e,i){return(e>t||t>i)&&(n?t=Math.min(Math.max(e,t),i):h=!0),t};return o=S(o,c.translate(t,null,null,i)),r=a=Math.round(o+m),s=l=Math.round(g-o-m),y(o)?c.horiz?(s=u,l=g-c.bottom,r=a=x(r,p,p+c.width)):(r=p,a=f-c.right,s=l=x(s,u,u+c.height)):(h=!0,n=!1),h&&!n?null:d.renderer.crispLine(["M",r,s,"L",a,l],e||1)},getLinearTickPositions:function(t,e,i){var n,o,r,a=s(Math.floor(e/t)*t),l=s(Math.ceil(i/t)*t),h=[];if(s(a+t)===a&&(r=20),this.single)return[e];for(n=a;l>=n&&(h.push(n),n=s(n+t,r),n!==o);)o=n;return h},getMinorTickInterval:function(){var t=this.options;return t.minorTicks===!0?S(t.minorTickInterval,"auto"):t.minorTicks===!1?null:t.minorTickInterval},getMinorTickPositions:function(){var t,e=this,i=e.options,n=e.tickPositions,o=e.minorTickInterval,r=[],s=e.pointRangePadding||0,a=e.min-s,l=e.max+s,h=l-a;if(h&&h/o<e.len/3)if(e.isLog)d(this.paddedTicks,function(t,i,n){i&&r.push.apply(r,e.getLogTickPositions(o,n[i-1],n[i],!0))});else if(e.isDatetimeAxis&&"auto"===this.getMinorTickInterval())r=r.concat(e.getTimeTicks(e.normalizeTimeTickInterval(o),a,l,i.startOfWeek));else for(t=a+(n[0]-a)%o;l>=t&&t!==r[0];t+=o)r.push(t);return 0!==r.length&&e.trimTicks(r),r},adjustForMinRange:function(){var t,e,i,r,s,a,h,c,p,u,g=this,f=g.options,m=g.min,x=g.max;g.isXAxis&&void 0===g.minRange&&!g.isLog&&(l(f.min)||l(f.max)?g.minRange=null:(d(g.series,function(t){for(a=t.xData,h=t.xIncrement?1:a.length-1,r=h;r>0;r--)s=a[r]-a[r-1],(void 0===i||i>s)&&(i=s)}),g.minRange=Math.min(5*i,g.dataMax-g.dataMin))),x-m<g.minRange&&(e=g.dataMax-g.dataMin>=g.minRange,u=g.minRange,t=(u-x+m)/2,c=[m-t,S(f.min,m-t)],e&&(c[2]=g.isLog?g.log2lin(g.dataMin):g.dataMin),m=n(c),p=[m+u,S(f.max,m+u)],e&&(p[2]=g.isLog?g.log2lin(g.dataMax):g.dataMax),x=o(p),u>x-m&&(c[0]=x-u,c[1]=S(f.min,x-u),m=n(c))),g.min=m,g.max=x},getClosest:function(){var t;return this.categories?t=1:d(this.series,function(e){var i=e.closestPointRange,n=e.visible||!e.chart.options.chart.ignoreHiddenSeries;!e.noSharedTooltip&&l(i)&&n&&(t=l(t)?Math.min(t,i):i)}),t},nameToX:function(t){var e,i=v(this.categories),n=i?this.categories:this.names,o=t.options.x;return t.series.requireSorting=!1,l(o)||(o=this.options.uniqueNames===!1?t.series.autoIncrement():x(t.name,n)),-1===o?i||(e=n.length):e=o,void 0!==e&&(this.names[e]=t.name),e},updateNames:function(){var t=this;this.names.length>0&&(this.names.length=0,this.minRange=this.userMinRange,d(this.series||[],function(e){e.xIncrement=null,(!e.points||e.isDirtyData)&&(e.processData(),e.generatePoints()),d(e.points,function(i,n){var o;i.options&&(o=t.nameToX(i),void 0!==o&&o!==i.x&&(i.x=o,e.xData[n]=o))})}))},setAxisTranslation:function(t){var e,i,n=this,o=n.max-n.min,r=n.axisPointRange||0,s=0,a=0,l=n.linkedParent,h=!!n.categories,c=n.transA,p=n.isXAxis;(p||h||r)&&(e=n.getClosest(),l?(s=l.minPointOffset,a=l.pointRangePadding):d(n.series,function(t){var i=h?1:p?S(t.options.pointRange,e,0):n.axisPointRange||0,o=t.options.pointPlacement;r=Math.max(r,i),n.single||(s=Math.max(s,b(o)?0:i/2),a=Math.max(a,"on"===o?0:i))}),i=n.ordinalSlope&&e?n.ordinalSlope/e:1,n.minPointOffset=s*=i,n.pointRangePadding=a*=i,n.pointRange=Math.min(r,o),p&&(n.closestPointRange=e)),t&&(n.oldTransA=c),n.translationSlope=n.transA=c=n.options.staticScale||n.len/(o+a||1),n.transB=n.horiz?n.left:n.bottom,n.minPixelPadding=c*s},minFromRange:function(){return this.max-this.range},setTickInterval:function(e){var i,n,o,r,a,h,c,p=this,g=p.chart,m=p.options,x=p.isLog,v=p.log2lin,b=p.isDatetimeAxis,k=p.isXAxis,w=p.isLinked,A=m.maxPadding,T=m.minPadding,P=m.tickInterval,C=m.tickPixelInterval,L=p.categories,O=p.threshold,D=p.softThreshold;b||L||w||this.getTickAmount(),h=S(p.userMin,m.min),c=S(p.userMax,m.max),w?(p.linkedParent=g[p.coll][m.linkedTo],n=p.linkedParent.getExtremes(),p.min=S(n.min,n.dataMin),p.max=S(n.max,n.dataMax),m.type!==p.linkedParent.options.type&&t.error(11,1)):(!D&&l(O)&&(p.dataMin>=O?(r=O,T=0):p.dataMax<=O&&(a=O,A=0)),p.min=S(h,r,p.dataMin),p.max=S(c,a,p.dataMax)),x&&(p.positiveValuesOnly&&!e&&Math.min(p.min,S(p.dataMin,p.min))<=0&&t.error(10,1),p.min=s(v(p.min),15),p.max=s(v(p.max),15)),p.range&&l(p.max)&&(p.userMin=p.min=h=Math.max(p.dataMin,p.minFromRange()),p.userMax=c=p.max,p.range=null),u(p,"foundExtremes"),p.beforePadding&&p.beforePadding(),p.adjustForMinRange(),L||p.axisPointRange||p.usePercentage||w||!l(p.min)||!l(p.max)||(i=p.max-p.min,i&&(!l(h)&&T&&(p.min-=i*T),!l(c)&&A&&(p.max+=i*A))),y(m.softMin)&&!y(p.userMin)&&(p.min=Math.min(p.min,m.softMin)),y(m.softMax)&&!y(p.userMax)&&(p.max=Math.max(p.max,m.softMax)),y(m.floor)&&(p.min=Math.max(p.min,m.floor)),y(m.ceiling)&&(p.max=Math.min(p.max,m.ceiling)),D&&l(p.dataMin)&&(O=O||0,!l(h)&&p.min<O&&p.dataMin>=O?p.min=O:!l(c)&&p.max>O&&p.dataMax<=O&&(p.max=O)),p.tickInterval=p.min===p.max||void 0===p.min||void 0===p.max?1:w&&!P&&C===p.linkedParent.options.tickPixelInterval?P=p.linkedParent.tickInterval:S(P,this.tickAmount?(p.max-p.min)/Math.max(this.tickAmount-1,1):void 0,L?1:(p.max-p.min)*C/Math.max(p.len,C)),k&&!e&&d(p.series,function(t){t.processData(p.min!==p.oldMin||p.max!==p.oldMax)}),p.setAxisTranslation(!0),p.beforeSetTickPositions&&p.beforeSetTickPositions(),p.postProcessTickInterval&&(p.tickInterval=p.postProcessTickInterval(p.tickInterval)),p.pointRange&&!P&&(p.tickInterval=Math.max(p.pointRange,p.tickInterval)),o=S(m.minTickInterval,p.isDatetimeAxis&&p.closestPointRange),!P&&p.tickInterval<o&&(p.tickInterval=o),b||x||P||(p.tickInterval=M(p.tickInterval,null,f(p.tickInterval),S(m.allowDecimals,!(p.tickInterval>.5&&p.tickInterval<5&&p.max>1e3&&p.max<9999)),!!this.tickAmount)),this.tickAmount||(p.tickInterval=p.unsquish()),this.setTickPositions()},setTickPositions:function(){var t,e=this.options,i=e.tickPositions,n=this.getMinorTickInterval(),o=e.tickPositioner,r=e.startOnTick,s=e.endOnTick;this.tickmarkOffset=this.categories&&"between"===e.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===n&&this.tickInterval?this.tickInterval/5:n,this.single=this.min===this.max&&l(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||e.allowDecimals!==!1),this.tickPositions=t=i&&i.slice(),t||(t=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,e.units),this.min,this.max,e.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),t.length>this.len&&(t=[t[0],t.pop()],t[0]===t[1]&&(t.length=1)),this.tickPositions=t,o&&(o=o.apply(this,[this.min,this.max]),o&&(this.tickPositions=t=o))),this.paddedTicks=t.slice(0),this.trimTicks(t,r,s),this.isLinked||(this.single&&t.length<2&&(this.min-=.5,this.max+=.5),i||o||this.adjustTickAmount())},trimTicks:function(t,e,i){var n=t[0],o=t[t.length-1],r=this.minPointOffset||0;if(!this.isLinked){if(e&&n!==-1/0)this.min=n;else for(;this.min-r>t[0];)t.shift();if(i)this.max=o;else for(;this.max+r<t[t.length-1];)t.pop();0===t.length&&l(n)&&!this.options.tickPositions&&t.push((o+n)/2)}},alignToOthers:function(){var t,e={},i=this.options;return this.chart.options.chart.alignTicks===!1||i.alignTicks===!1||this.isLog||d(this.chart[this.coll],function(i){var n=i.options,o=i.horiz,r=[o?n.left:n.top,n.width,n.height,n.pane].join(",");i.series.length&&(e[r]?t=!0:e[r]=1)}),t},getTickAmount:function(){var t=this.options,e=t.tickAmount,i=t.tickPixelInterval;!l(t.tickInterval)&&this.len<i&&!this.isRadial&&!this.isLog&&t.startOnTick&&t.endOnTick&&(e=2),!e&&this.alignToOthers()&&(e=Math.ceil(this.len/i)+1),4>e&&(this.finalTickAmt=e,e=5),this.tickAmount=e},adjustTickAmount:function(){var t,e,i=this.tickInterval,n=this.tickPositions,o=this.tickAmount,r=this.finalTickAmt,a=n&&n.length,h=S(this.threshold,this.softThreshold?0:null);if(this.hasData()){if(o>a){for(;n.length<o;)n.length%2||this.min===h?n.push(s(n[n.length-1]+i)):n.unshift(s(n[0]-i));this.transA*=(a-1)/(o-1),this.min=n[0],this.max=n[n.length-1]}else a>o&&(this.tickInterval*=2,this.setTickPositions());if(l(r)){for(t=e=n.length;t--;)(3===r&&t%2===1||2>=r&&t>0&&e-1>t)&&n.splice(t,1);this.finalTickAmt=void 0}}},setScale:function(){var t,e,i=this;i.oldMin=i.min,i.oldMax=i.max,i.oldAxisLength=i.len,i.setAxisSize(),e=i.len!==i.oldAxisLength,d(i.series,function(e){(e.isDirtyData||e.isDirty||e.xAxis.isDirty)&&(t=!0)}),e||t||i.isLinked||i.forceRedraw||i.userMin!==i.oldUserMin||i.userMax!==i.oldUserMax||i.alignToOthers()?(i.resetStacks&&i.resetStacks(),i.forceRedraw=!1,i.getSeriesExtremes(),i.setTickInterval(),i.oldUserMin=i.userMin,i.oldUserMax=i.userMax,i.isDirty||(i.isDirty=e||i.min!==i.oldMin||i.max!==i.oldMax)):i.cleanStacks&&i.cleanStacks()},setExtremes:function(t,e,i,n,o){var r=this,s=r.chart;i=S(i,!0),d(r.series,function(t){delete t.kdTree}),o=p(o,{min:t,max:e}),u(r,"setExtremes",o,function(){r.userMin=t,r.userMax=e,r.eventArgs=o,i&&s.redraw(n)})},zoom:function(t,e){var i=this.dataMin,n=this.dataMax,o=this.options,r=Math.min(i,S(o.min,i)),s=Math.max(n,S(o.max,n));return(t!==this.min||e!==this.max)&&(this.allowZoomOutside||(l(i)&&(r>t&&(t=r),t>s&&(t=s)),l(n)&&(r>e&&(e=r),e>s&&(e=s))),this.displayBtn=void 0!==t||void 0!==e,this.setExtremes(t,e,!1,void 0,{trigger:"zoom"})),!0},setAxisSize:function(){var e=this.chart,i=this.options,n=i.offsets||[0,0,0,0],o=this.horiz,r=this.width=Math.round(t.relativeLength(S(i.width,e.plotWidth-n[3]+n[1]),e.plotWidth)),s=this.height=Math.round(t.relativeLength(S(i.height,e.plotHeight-n[0]+n[2]),e.plotHeight)),a=this.top=Math.round(t.relativeLength(S(i.top,e.plotTop+n[0]),e.plotHeight,e.plotTop)),l=this.left=Math.round(t.relativeLength(S(i.left,e.plotLeft+n[3]),e.plotWidth,e.plotLeft));this.bottom=e.chartHeight-s-a,this.right=e.chartWidth-r-l,this.len=Math.max(o?r:s,0),this.pos=o?l:a},getExtremes:function(){{var t=this,e=t.isLog;t.lin2log}return{min:e?s(t.lin2log(t.min)):t.min,max:e?s(t.lin2log(t.max)):t.max,dataMin:t.dataMin,dataMax:t.dataMax,userMin:t.userMin,userMax:t.userMax}},getThreshold:function(t){var e=this,i=e.isLog,n=(e.lin2log,i?e.lin2log(e.min):e.min),o=i?e.lin2log(e.max):e.max;return null===t?t=n:n>t?t=n:t>o&&(t=o),e.translate(t,0,1,0,1)},autoLabelAlign:function(t){var e,i=(S(t,0)-90*this.side+720)%360;return e=i>15&&165>i?"right":i>195&&345>i?"left":"center"},tickSize:function(t){var e=this.options,i=e[t+"Length"],n=S(e[t+"Width"],"tick"===t&&this.isXAxis?1:0);return n&&i?("inside"===e[t+"Position"]&&(i=-i),[i,n]):void 0},labelMetrics:function(){var t=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[t]&&this.ticks[t].label)},unsquish:function(){var t,e,i,n=this.options.labels,o=this.horiz,r=this.tickInterval,s=r,a=this.len/(((this.categories?1:0)+this.max-this.min)/r),c=n.rotation,p=this.labelMetrics(),u=Number.MAX_VALUE,g=function(t){var e=t/(a||1);return e=e>1?Math.ceil(e):1,e*r};return o?(i=!n.staggerLines&&!n.step&&(l(c)?[c]:a<S(n.autoRotationLimit,80)&&n.autoRotation),i&&d(i,function(i){var n;(i===c||i&&i>=-90&&90>=i)&&(e=g(Math.abs(p.h/Math.sin(h*i))),n=e+Math.abs(i/360),u>n&&(u=n,t=i,s=e))})):n.step||(s=g(p.h)),this.autoRotation=i,this.labelRotation=S(t,c),s},getSlotWidth:function(){var t=this.chart,e=this.horiz,i=this.options.labels,n=Math.max(this.tickPositions.length-(this.categories?0:1),1),o=t.margin[3];return e&&(i.step||0)<2&&!i.rotation&&(this.staggerLines||1)*this.len/n||!e&&(i.style&&parseInt(i.style.width,10)||o&&o-t.spacing[3]||.33*t.chartWidth)},renderUnsquish:function(){var t,e,i,n,o=this.chart,r=o.renderer,s=this.tickPositions,a=this.ticks,l=this.options.labels,h=this.horiz,c=this.getSlotWidth(),p=Math.max(1,Math.round(c-2*(l.padding||5))),u={},g=this.labelMetrics(),f=l.style&&l.style.textOverflow,m=0;if(b(l.rotation)||(u.rotation=l.rotation||0),d(s,function(t){t=a[t],t&&t.labelLength>m&&(m=t.labelLength)}),this.maxLabelLength=m,this.autoRotation)m>p&&m>g.h?u.rotation=this.labelRotation:this.labelRotation=0;else if(c&&(t={width:p+"px"},!f))for(t.textOverflow="clip",i=s.length;!h&&i--;)n=s[i],e=a[n].label,e&&(e.styles&&"ellipsis"===e.styles.textOverflow?e.css({textOverflow:"clip"}):a[n].labelLength>c&&e.css({width:c+"px"}),e.getBBox().height>this.len/s.length-(g.h-g.f)&&(e.specCss={textOverflow:"ellipsis"}));u.rotation&&(t={width:(m>.5*o.chartHeight?.33*o.chartHeight:o.chartHeight)+"px"},f||(t.textOverflow="ellipsis")),this.labelAlign=l.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(u.align=this.labelAlign),d(s,function(e){var i=a[e],n=i&&i.label;n&&(n.attr(u),t&&n.css(k(t,n.specCss)),delete n.specCss,i.rotation=u.rotation)}),this.tickRotCorr=r.rotCorr(g.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||l(this.min)&&l(this.max)&&this.tickPositions&&this.tickPositions.length>0},addTitle:function(t){var e,i=this,n=i.chart.renderer,o=i.horiz,r=i.opposite,s=i.options,a=s.title;i.axisTitle||(e=a.textAlign,e||(e=(o?{low:"left",middle:"center",high:"right"}:{low:r?"right":"left",middle:"center",high:r?"left":"right"})[a.align]),i.axisTitle=n.text(a.text,0,0,a.useHTML).attr({zIndex:7,rotation:a.rotation||0,align:e}).addClass("highcharts-axis-title").css(a.style).add(i.axisGroup),i.axisTitle.isNew=!0),a.style.width||i.isRadial||i.axisTitle.css({width:i.len}),i.axisTitle[t?"show":"hide"](!0)},generateTick:function(t){var e=this.ticks;e[t]?e[t].addLabel():e[t]=new C(this,t)},getOffset:function(){var t,e,i,n,o,r,s=this,a=s.chart,h=a.renderer,c=s.options,p=s.tickPositions,u=s.ticks,g=s.horiz,f=s.side,m=a.inverted&&!s.isZAxis?[1,0,3,2][f]:f,x=0,v=0,y=c.title,b=c.labels,k=0,M=a.axisOffset,A=a.clipOffset,T=[-1,1,1,-1][f],P=c.className,C=s.axisParent,L=this.tickSize("tick");t=s.hasData(),s.showAxis=e=t||S(c.showEmpty,!0),s.staggerLines=s.horiz&&b.staggerLines,s.axisGroup||(s.gridGroup=h.g("grid").attr({zIndex:c.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(P||"")).add(C),s.axisGroup=h.g("axis").attr({zIndex:c.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(P||"")).add(C),s.labelGroup=h.g("axis-labels").attr({zIndex:b.zIndex||7}).addClass("highcharts-"+s.coll.toLowerCase()+"-labels "+(P||"")).add(C)),t||s.isLinked?(d(p,function(t,e){s.generateTick(t,e)}),s.renderUnsquish(),s.reserveSpaceDefault=0===f||2===f||{1:"left",3:"right"}[f]===s.labelAlign,S(b.reserveSpace,"center"===s.labelAlign?!0:null,s.reserveSpaceDefault)&&d(p,function(t){k=Math.max(u[t].getLabelSize(),k)}),s.staggerLines&&(k*=s.staggerLines),s.labelOffset=k*(s.opposite?-1:1)):w(u,function(t,e){t.destroy(),delete u[e]}),y&&y.text&&y.enabled!==!1&&(s.addTitle(e),e&&y.reserveSpace!==!1&&(s.titleOffset=x=s.axisTitle.getBBox()[g?"height":"width"],i=y.offset,v=l(i)?0:S(y.margin,g?5:10))),s.renderLine(),s.offset=T*S(c.offset,M[f]),s.tickRotCorr=s.tickRotCorr||{x:0,y:0},r=0===f?-s.labelMetrics().h:2===f?s.tickRotCorr.y:0,n=Math.abs(k)+v,k&&(n-=r,n+=T*(g?S(b.y,s.tickRotCorr.y+8*T):b.x)),s.axisTitleMargin=S(i,n),M[f]=Math.max(M[f],s.axisTitleMargin+x+T*s.offset,n,t&&p.length&&L?L[0]+T*s.offset:0),o=c.offset?0:2*Math.floor(s.axisLine.strokeWidth()/2),A[m]=Math.max(A[m],o)},getLinePath:function(t){var e=this.chart,i=this.opposite,n=this.offset,o=this.horiz,r=this.left+(i?this.width:0)+n,s=e.chartHeight-this.bottom-(i?this.height:0)+n;return i&&(t*=-1),e.renderer.crispLine(["M",o?this.left:r,o?s:this.top,"L",o?e.chartWidth-this.right:r,o?s:e.chartHeight-this.bottom],t)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var t=this.horiz,e=this.left,i=this.top,n=this.len,o=this.options.title,r=t?e:i,s=this.opposite,a=this.offset,l=o.x||0,h=o.y||0,c=this.axisTitle,d=this.chart.renderer.fontMetrics(o.style&&o.style.fontSize,c),p=Math.max(c.getBBox(null,0).height-d.h-1,0),u={low:r+(t?0:n),middle:r+n/2,high:r+(t?n:0)}[o.align],g=(t?i+this.height:e)+(t?1:-1)*(s?-1:1)*this.axisTitleMargin+[-p,p,d.f,-p][this.side];return{x:t?u+l:g+(s?this.width:0)+a+l,y:t?g+h-(s?this.height:0)+a:u+h}},renderMinorTick:function(t){var e=this.chart.hasRendered&&y(this.oldMin),i=this.minorTicks;i[t]||(i[t]=new C(this,t,"minor")),e&&i[t].isNew&&i[t].render(null,!0),i[t].render(null,!1,1)},renderTick:function(t,e){var i=this.isLinked,n=this.ticks,o=this.chart.hasRendered&&y(this.oldMin);(!i||t>=this.min&&t<=this.max)&&(n[t]||(n[t]=new C(this,t)),o&&n[t].isNew&&n[t].render(e,!0,.1),n[t].render(e))},render:function(){var e,n,o=this,r=o.chart,s=r.renderer,a=o.options,l=o.isLog,h=(o.lin2log,o.isLinked),c=o.tickPositions,p=o.axisTitle,u=o.ticks,g=o.minorTicks,f=o.alternateBands,m=a.stackLabels,x=a.alternateGridColor,v=o.tickmarkOffset,b=o.axisLine,k=o.showAxis,M=i(s.globalAnimation);if(o.labelEdge.length=0,o.overlap=!1,d([u,g,f],function(t){w(t,function(t){t.isActive=!1})}),(o.hasData()||h)&&(o.minorTickInterval&&!o.categories&&d(o.getMinorTickPositions(),function(t){o.renderMinorTick(t)}),c.length&&(d(c,function(t,e){o.renderTick(t,e)}),v&&(0===o.min||o.single)&&(u[-1]||(u[-1]=new C(o,-1,null,!0)),u[-1].render(-1))),x&&d(c,function(i,s){n=void 0!==c[s+1]?c[s+1]+v:o.max-v,s%2===0&&i<o.max&&n<=o.max+(r.polar?-v:v)&&(f[i]||(f[i]=new t.PlotLineOrBand(o)),e=i+v,f[i].options={from:l?o.lin2log(e):e,to:l?o.lin2log(n):n,color:x},f[i].render(),f[i].isActive=!0)}),o._addedPlotLB||(d((a.plotLines||[]).concat(a.plotBands||[]),function(t){o.addPlotBandOrLine(t)}),o._addedPlotLB=!0)),d([u,g,f],function(t){var e,i=[],n=M.duration,o=function(){for(e=i.length;e--;)t[i[e]]&&!t[i[e]].isActive&&(t[i[e]].destroy(),delete t[i[e]])};w(t,function(t,e){t.isActive||(t.render(e,!1,0),t.isActive=!1,i.push(e))}),P(o,t!==f&&r.hasRendered&&n?n:0)}),b&&(b[b.isPlaced?"animate":"attr"]({d:this.getLinePath(b.strokeWidth())}),b.isPlaced=!0,b[k?"show":"hide"](!0)),p&&k){var S=o.getTitlePosition();y(S.y)?(p[p.isNew?"attr":"animate"](S),p.isNew=!1):(p.attr("y",-9999),p.isNew=!0)}m&&m.enabled&&o.renderStackTotals(),o.isDirty=!1},redraw:function(){this.visible&&(this.render(),d(this.plotLinesAndBands,function(t){t.render()})),d(this.series,function(t){t.isDirty=!0})},keepProps:["extKey","hcEvents","names","series","userMax","userMin"],destroy:function(t){var e,i,n=this,o=n.stacks,r=n.plotLinesAndBands;if(t||A(n),w(o,function(t,e){c(t),o[e]=null}),d([n.ticks,n.minorTicks,n.alternateBands],function(t){c(t)}),r)for(i=r.length;i--;)r[i].destroy();d(["stackTotalGroup","axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross"],function(t){n[t]&&(n[t]=n[t].destroy())});for(e in n.plotLinesAndBandsGroups)n.plotLinesAndBandsGroups[e]=n.plotLinesAndBandsGroups[e].destroy();w(n,function(t,e){-1===x(e,n.keepProps)&&delete n[e]})},drawCrosshair:function(t,e){var i,n,o,s=this.crosshair,a=S(s.snap,!0),h=this.cross;if(t||(t=this.cross&&this.cross.e),this.crosshair&&(l(e)||!a)!==!1){if(a?l(e)&&(n=this.isXAxis?e.plotX:this.len-e.plotY):n=t&&(this.horiz?t.chartX-this.pos:this.len-t.chartY+this.pos),l(n)&&(i=this.getPlotLinePath(e&&(this.isXAxis?e.x:S(e.stackY,e.y)),null,null,null,n)||null),!l(i))return void this.hideCrosshair();o=this.categories&&!this.isRadial,h||(this.cross=h=this.chart.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(o?"category ":"thin ")+s.className).attr({zIndex:S(s.zIndex,2)}).add(),h.attr({stroke:s.color||(o?r("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":S(s.width,1)}).css({"pointer-events":"none"}),s.dashStyle&&h.attr({dashstyle:s.dashStyle})),h.show().attr({d:i}),o&&!s.width&&h.attr({"stroke-width":this.transA}),this.cross.e=t}else this.hideCrosshair()},hideCrosshair:function(){this.cross&&this.cross.hide()}}),t.Axis=L,L}(e);!function(t){var e=t.Axis,i=t.Date,n=t.dateFormat,o=t.defaultOptions,r=t.defined,s=t.each,a=t.extend,l=t.getMagnitude,h=t.getTZOffset,c=t.normalizeTickInterval,d=t.pick,p=t.timeUnits;e.prototype.getTimeTicks=function(t,e,l,c){var u,g,f,m,x=[],v={},y=o.global.useUTC,b=new i(e-Math.max(h(e),h(l))),k=i.hcMakeTime,M=t.unitRange,w=t.count;if(r(e)){b[i.hcSetMilliseconds](M>=p.second?0:w*Math.floor(b.getMilliseconds()/w)),M>=p.second&&b[i.hcSetSeconds](M>=p.minute?0:w*Math.floor(b.getSeconds()/w)),M>=p.minute&&b[i.hcSetMinutes](M>=p.hour?0:w*Math.floor(b[i.hcGetMinutes]()/w)),M>=p.hour&&b[i.hcSetHours](M>=p.day?0:w*Math.floor(b[i.hcGetHours]()/w)),M>=p.day&&b[i.hcSetDate](M>=p.month?1:w*Math.floor(b[i.hcGetDate]()/w)),M>=p.month&&(b[i.hcSetMonth](M>=p.year?0:w*Math.floor(b[i.hcGetMonth]()/w)),g=b[i.hcGetFullYear]()),M>=p.year&&(g-=g%w,b[i.hcSetFullYear](g)),M===p.week&&b[i.hcSetDate](b[i.hcGetDate]()-b[i.hcGetDay]()+d(c,1)),g=b[i.hcGetFullYear]();var S=b[i.hcGetMonth](),A=b[i.hcGetDate](),T=b[i.hcGetHours]();e=b.getTime(),i.hcHasTimeZone&&(m=(!y||!!i.hcGetTimezoneOffset)&&(l-e>4*p.month||h(e)!==h(l)),f=h(b),b=new i(e+f));var P=b.getTime();for(u=1;l>P;)x.push(P),M===p.year?P=k(g+u*w,0):M===p.month?P=k(g,S+u*w):!m||M!==p.day&&M!==p.week?m&&M===p.hour?P=k(g,S,A,T+u*w,0,0,f)-f:P+=M*w:P=k(g,S,A+u*w*(M===p.day?1:7)),u++;x.push(P),M<=p.hour&&x.length<1e4&&s(x,function(t){t%18e5===0&&"000000000"===n("%H%M%S%L",t)&&(v[t]="day")})}return x.info=a(t,{higherRanks:v,totalRange:M*w}),x},e.prototype.normalizeTimeTickInterval=function(t,e){var i,n,o=e||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],r=o[o.length-1],s=p[r[0]],a=r[1];for(n=0;n<o.length;n++)if(r=o[n],s=p[r[0]],a=r[1],o[n+1]){var h=(s*a[a.length-1]+p[o[n+1][0]])/2;if(h>=t)break}return s===p.year&&5*s>t&&(a=[1,2,5]),i=c(t/s,a,"year"===r[0]?Math.max(l(t/s),1):1),{unitRange:s,count:i,unitName:r[0]}}}(e),function(t){var e=t.Axis,i=t.getMagnitude,n=t.map,o=t.normalizeTickInterval,r=t.pick;e.prototype.getLogTickPositions=function(t,e,s,a){var l=this,h=l.options,c=l.len,d=l.lin2log,p=l.log2lin,u=[];if(a||(l._minorAutoInterval=null),t>=.5)t=Math.round(t),u=l.getLinearTickPositions(t,e,s);else if(t>=.08){var g,f,m,x,v,y,b,k=Math.floor(e);for(g=t>.3?[1,2,4]:t>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],f=k;s+1>f&&!b;f++)for(x=g.length,m=0;x>m&&!b;m++)v=l.log2lin(l.lin2log(f)*g[m]),v>e&&(!a||s>=y)&&void 0!==y&&u.push(y),y>s&&(b=!0),y=v}else{var M=l.lin2log(e),w=d(s),S=a?this.getMinorTickInterval():h.tickInterval,A="auto"===S?null:S,T=h.tickPixelInterval/(a?5:1),P=a?c/l.tickPositions.length:c;t=r(A,l._minorAutoInterval,(w-M)*T/(P||1)),t=o(t,null,i(t)),u=n(l.getLinearTickPositions(t,M,w),p),a||(l._minorAutoInterval=t/5)}return a||(l.tickInterval=t),u},e.prototype.log2lin=function(t){return Math.log(t)/Math.LN10},e.prototype.lin2log=function(t){return Math.pow(10,t)}}(e),function(t,e){var i=t.arrayMax,n=t.arrayMin,o=t.defined,r=t.destroyObjectProperties,s=t.each,a=t.erase,l=t.merge,h=t.pick;t.PlotLineOrBand=function(t,e){this.axis=t,e&&(this.options=e,this.id=e.id)},t.PlotLineOrBand.prototype={render:function(){var e,i=this,n=i.axis,r=n.horiz,s=i.options,a=s.label,c=i.label,d=s.to,p=s.from,u=s.value,g=o(p)&&o(d),f=o(u),m=i.svgElem,x=!m,v=[],y=s.color,b=h(s.zIndex,0),k=s.events,M={class:"highcharts-plot-"+(g?"band ":"line ")+(s.className||"")},w={},S=n.chart.renderer,A=g?"bands":"lines",T=n.log2lin;if(n.isLog&&(p=T(p),d=T(d),u=T(u)),f?(M={stroke:y,"stroke-width":s.width},s.dashStyle&&(M.dashstyle=s.dashStyle)):g&&(y&&(M.fill=y),s.borderWidth&&(M.stroke=s.borderColor,M["stroke-width"]=s.borderWidth)),w.zIndex=b,A+="-"+b,e=n.plotLinesAndBandsGroups[A],e||(n.plotLinesAndBandsGroups[A]=e=S.g("plot-"+A).attr(w).add()),x&&(i.svgElem=m=S.path().attr(M).add(e)),f)v=n.getPlotLinePath(u,m.strokeWidth());else{if(!g)return;v=n.getPlotBandPath(p,d,s)}return x&&v&&v.length?(m.attr({d:v}),k&&t.objectEach(k,function(t,e){m.on(e,function(t){k[e].apply(i,[t])})})):m&&(v?(m.show(),m.animate({d:v})):(m.hide(),c&&(i.label=c=c.destroy()))),a&&o(a.text)&&v&&v.length&&n.width>0&&n.height>0&&!v.flat?(a=l({align:r&&g&&"center",x:r?!g&&4:10,verticalAlign:!r&&g&&"middle",y:r?g?16:10:g?6:-4,rotation:r&&!g&&90},a),this.renderLabel(a,v,g,b)):c&&c.hide(),i},renderLabel:function(t,e,o,r){var s,a,l,h,c,d=this,p=d.label,u=d.axis.chart.renderer;p||(s={align:t.textAlign||t.align,rotation:t.rotation,class:"highcharts-plot-"+(o?"band":"line")+"-label "+(t.className||"")},s.zIndex=r,d.label=p=u.text(t.text,0,0,t.useHTML).attr(s).add(),p.css(t.style)),a=e.xBounds||[e[1],e[4],o?e[6]:e[1]],l=e.yBounds||[e[2],e[5],o?e[7]:e[2]],h=n(a),c=n(l),p.align(t,!1,{x:h,y:c,width:i(a)-h,height:i(l)-c}),p.show()},destroy:function(){a(this.axis.plotLinesAndBands,this),delete this.axis,r(this)}},t.extend(e.prototype,{getPlotBandPath:function(t,e){var i,n,o=this.getPlotLinePath(e,null,null,!0),r=this.getPlotLinePath(t,null,null,!0),s=[],a=this.horiz,l=1,h=t<this.min&&e<this.min||t>this.max&&e>this.max;if(r&&o)for(h&&(n=r.toString()===o.toString(),l=0),i=0;i<r.length;i+=6)a&&o[i+1]===r[i+1]?(o[i+1]+=l,o[i+4]+=l):a||o[i+2]!==r[i+2]||(o[i+2]+=l,o[i+5]+=l),s.push("M",r[i+1],r[i+2],"L",r[i+4],r[i+5],o[i+4],o[i+5],o[i+1],o[i+2],"z"),s.flat=n;else r=null;return s},addPlotBand:function(t){return this.addPlotBandOrLine(t,"plotBands")},addPlotLine:function(t){return this.addPlotBandOrLine(t,"plotLines")},addPlotBandOrLine:function(e,i){var n=new t.PlotLineOrBand(this,e).render(),o=this.userOptions;return n&&(i&&(o[i]=o[i]||[],o[i].push(e)),this.plotLinesAndBands.push(n)),n},removePlotBandOrLine:function(t){for(var e=this.plotLinesAndBands,i=this.options,n=this.userOptions,o=e.length;o--;)e[o].id===t&&e[o].destroy();s([i.plotLines||[],n.plotLines||[],i.plotBands||[],n.plotBands||[]],function(e){for(o=e.length;o--;)e[o].id===t&&a(e,e[o])})},removePlotBand:function(t){this.removePlotBandOrLine(t)},removePlotLine:function(t){this.removePlotBandOrLine(t)}})}(e,i),function(t){var e=t.dateFormat,i=t.each,n=t.extend,o=t.format,r=t.isNumber,s=t.map,a=t.merge,l=t.pick,h=t.splat,c=t.syncTimeout,d=t.timeUnits;t.Tooltip=function(){this.init.apply(this,arguments)},t.Tooltip.prototype={init:function(t,e){this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=e.split&&!t.inverted,this.shared=e.shared||this.split},cleanSplit:function(t){i(this.chart.series,function(e){var i=e&&e.tt;i&&(!i.isActive||t?e.tt=i.destroy():i.isActive=!1)})},getLabel:function(){var t=this.chart.renderer,e=this.options;return this.label||(this.split?this.label=t.g("tooltip"):(this.label=t.label("",0,0,e.shape||"callout",null,null,e.useHTML,null,"tooltip").attr({padding:e.padding,r:e.borderRadius}),this.label.attr({fill:e.backgroundColor,"stroke-width":e.borderWidth}).css(e.style).shadow(e.shadow)),this.label.attr({zIndex:8}).add()),this.label},update:function(t){this.destroy(),a(!0,this.chart.options.tooltip.userOptions,t),this.init(this.chart,a(!0,this.options,t))},destroy:function(){this.label&&(this.label=this.label.destroy()),this.split&&this.tt&&(this.cleanSplit(this.chart,!0),this.tt=this.tt.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(t,e,i,o){var r=this,s=r.now,a=r.options.animation!==!1&&!r.isHidden&&(Math.abs(t-s.x)>1||Math.abs(e-s.y)>1),l=r.followPointer||r.len>1;n(s,{x:a?(2*s.x+t)/3:t,y:a?(s.y+e)/2:e,anchorX:l?void 0:a?(2*s.anchorX+i)/3:i,anchorY:l?void 0:a?(s.anchorY+o)/2:o}),r.getLabel().attr(s),a&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){r&&r.move(t,e,i,o)},32))},hide:function(t){var e=this;clearTimeout(this.hideTimer),t=l(t,this.options.hideDelay,500),this.isHidden||(this.hideTimer=c(function(){e.getLabel()[t?"fadeOut":"hide"](),e.isHidden=!0},t))},getAnchor:function(t,e){var n,o,r,a=this.chart,l=a.inverted,c=a.plotTop,d=a.plotLeft,p=0,u=0;return t=h(t),n=t[0].tooltipPos,this.followPointer&&e&&(void 0===e.chartX&&(e=a.pointer.normalize(e)),n=[e.chartX-a.plotLeft,e.chartY-c]),n||(i(t,function(t){o=t.series.yAxis,r=t.series.xAxis,p+=t.plotX+(!l&&r?r.left-d:0),u+=(t.plotLow?(t.plotLow+t.plotHigh)/2:t.plotY)+(!l&&o?o.top-c:0)}),p/=t.length,u/=t.length,n=[l?a.plotWidth-u:p,this.shared&&!l&&t.length>1&&e?e.chartY-c:l?a.plotHeight-p:u]),s(n,Math.round)},getPosition:function(t,e,i){var n,o=this.chart,r=this.distance,s={},a=o.inverted&&i.h||0,h=["y",o.chartHeight,e,i.plotY+o.plotTop,o.plotTop,o.plotTop+o.plotHeight],c=["x",o.chartWidth,t,i.plotX+o.plotLeft,o.plotLeft,o.plotLeft+o.plotWidth],d=!this.followPointer&&l(i.ttBelow,!o.inverted==!!i.negative),p=function(t,e,i,n,o,l){var h=n-r>i,c=e>n+r+i,p=n-r-i,u=n+r;if(d&&c)s[t]=u;else if(!d&&h)s[t]=p;else if(h)s[t]=Math.min(l-i,0>p-a?p:p-a);else{if(!c)return!1;s[t]=Math.max(o,u+a+i>e?u:u+a)}},u=function(t,e,i,n){var o;return r>n||n>e-r?o=!1:s[t]=i/2>n?1:n>e-i/2?e-i-2:n-i/2,o},g=function(t){var e=h;h=c,c=e,n=t},f=function(){p.apply(0,h)!==!1?u.apply(0,c)!==!1||n||(g(!0),f()):n?s.x=s.y=0:(g(!0),f())};return(o.inverted||this.len>1)&&g(),f(),s},defaultFormatter:function(t){var e,i=this.points||h(this);return e=[t.tooltipFooterHeaderFormatter(i[0])],e=e.concat(t.bodyFormatter(i)),e.push(t.tooltipFooterHeaderFormatter(i[0],!0)),e},refresh:function(t,e){var n,o,r,s,a,c,d=this,p=d.options,u=t,g={},f=[],m=p.formatter||d.defaultFormatter,x=d.shared;p.enabled&&(clearTimeout(this.hideTimer),d.followPointer=h(u)[0].series.tooltipOptions.followPointer,s=d.getAnchor(u,e),o=s[0],r=s[1],!x||u.series&&u.series.noSharedTooltip?g=u.getLabelConfig():(i(u,function(t){t.setState("hover"),f.push(t.getLabelConfig())}),g={x:u[0].category,y:u[0].y},g.points=f,u=u[0]),this.len=f.length,a=m.call(g,d),c=u.series,this.distance=l(c.tooltipOptions.distance,16),a===!1?this.hide():(n=d.getLabel(),d.isHidden&&n.attr({opacity:1}).show(),d.split?this.renderSplit(a,h(t)):(p.style.width||n.css({width:this.chart.spacingBox.width}),n.attr({text:a&&a.join?a.join(""):a}),n.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+l(u.colorIndex,c.colorIndex)),n.attr({stroke:p.borderColor||u.color||c.color||"#666666"}),d.updatePosition({plotX:o,plotY:r,negative:u.negative,ttBelow:u.ttBelow,h:s[2]||0})),this.isHidden=!1))},renderSplit:function(e,n){var o=this,r=[],s=this.chart,a=s.renderer,h=!0,c=this.options,d=0,p=this.getLabel();t.isString(e)&&(e=[!1,e]),i(e.slice(0,n.length+1),function(t,e){if(t!==!1){var i,u,g,f,m=n[e-1]||{isHeader:!0,plotX:n[0].plotX},x=m.series||o,v=x.tt,y=m.series||{},b="highcharts-color-"+l(m.colorIndex,y.colorIndex,"none");v||(x.tt=v=a.label(null,null,null,"callout",null,null,c.useHTML).addClass("highcharts-tooltip-box "+b).attr({padding:c.padding,r:c.borderRadius,fill:c.backgroundColor,stroke:c.borderColor||m.color||y.color||"#333333","stroke-width":c.borderWidth}).add(p)),v.isActive=!0,v.attr({text:t}),v.css(c.style).shadow(c.shadow),g=v.getBBox(),f=g.width+v.strokeWidth(),m.isHeader?(d=g.height,u=Math.max(0,Math.min(m.plotX+s.plotLeft-f/2,s.chartWidth-f))):u=m.plotX+s.plotLeft-l(c.distance,16)-f,0>u&&(h=!1),i=(m.series&&m.series.yAxis&&m.series.yAxis.pos)+(m.plotY||0),i-=s.plotTop,r.push({target:m.isHeader?s.plotHeight+d:i,rank:m.isHeader?1:0,size:x.tt.getBBox().height+1,point:m,x:u,tt:v})}}),this.cleanSplit(),t.distribute(r,s.plotHeight+d),i(r,function(t){var e=t.point,i=e.series;t.tt.attr({visibility:void 0===t.pos?"hidden":"inherit",x:h||e.isHeader?t.x:e.plotX+s.plotLeft+l(c.distance,16),y:t.pos+s.plotTop,anchorX:e.isHeader?e.plotX+s.plotLeft:e.plotX+i.xAxis.pos,anchorY:e.isHeader?t.pos+s.plotTop-15:e.plotY+i.yAxis.pos})})},updatePosition:function(t){var e=this.chart,i=this.getLabel(),n=(this.options.positioner||this.getPosition).call(this,i.width,i.height,t);this.move(Math.round(n.x),Math.round(n.y||0),t.plotX+e.plotLeft,t.plotY+e.plotTop)},getDateFormat:function(t,i,n,o){var r,s,a=e("%m-%d %H:%M:%S.%L",i),l="01-01 00:00:00.000",h={millisecond:15,second:12,minute:9,hour:6,day:3},c="millisecond";for(s in d){if(t===d.week&&+e("%w",i)===n&&a.substr(6)===l.substr(6)){s="week";break}if(d[s]>t){s=c;break}if(h[s]&&a.substr(h[s])!==l.substr(h[s]))break;"week"!==s&&(c=s)}return s&&(r=o[s]),r},getXDateFormat:function(t,e,i){var n,o=e.dateTimeLabelFormats,r=i&&i.closestPointRange;return n=r?this.getDateFormat(r,t.x,i.options.startOfWeek,o):o.day,n||o.year},tooltipFooterHeaderFormatter:function(t,e){var n=e?"footer":"header",s=t.series,a=s.tooltipOptions,l=a.xDateFormat,h=s.xAxis,c=h&&"datetime"===h.options.type&&r(t.key),d=a[n+"Format"];return c&&!l&&(l=this.getXDateFormat(t,a,h)),c&&l&&i(t.point&&t.point.tooltipDateKeys||["key"],function(t){d=d.replace("{point."+t+"}","{point."+t+":"+l+"}")}),o(d,{point:t,series:s})},bodyFormatter:function(t){return s(t,function(t){var e=t.series.tooltipOptions;return(e[(t.point.formatPrefix||"point")+"Formatter"]||t.point.tooltipFormatter).call(t.point,e[(t.point.formatPrefix||"point")+"Format"])})}}}(e),function(t){var e=t,i=e.addEvent,n=e.attr,o=e.charts,r=e.color,s=e.css,a=e.defined,l=e.each,h=e.extend,c=e.find,d=e.fireEvent,p=e.isObject,u=e.offset,g=e.pick,f=e.splat,m=e.Tooltip;t.Pointer=function(t,e){this.init(t,e)},t.Pointer.prototype={init:function(t,e){this.options=e,this.chart=t,this.runChartClick=e.chart.events&&!!e.chart.events.click,this.pinchDown=[],this.lastValidTouch={},m&&(t.tooltip=new m(t,e.tooltip),this.followTouchMove=g(e.tooltip.followTouchMove,!0)),this.setDOMEvents()},zoomOption:function(t){var e,i,n=this.chart,o=n.options.chart,r=o.zoomType||"",s=n.inverted;/touch/.test(t.type)&&(r=g(o.pinchType,r)),this.zoomX=e=/x/.test(r),this.zoomY=i=/y/.test(r),this.zoomHor=e&&!s||i&&s,this.zoomVert=i&&!s||e&&s,this.hasZoom=e||i},normalize:function(t,e){var i;return i=t.touches?t.touches.length?t.touches.item(0):t.changedTouches[0]:t,e||(this.chartPosition=e=u(this.chart.container)),h(t,{chartX:Math.round(i.pageX-e.left),chartY:Math.round(i.pageY-e.top)})},getCoordinates:function(t){var e={xAxis:[],yAxis:[]};return l(this.chart.axes,function(i){e[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(t[i.horiz?"chartX":"chartY"])})}),e},findNearestKDPoint:function(t,e,i){var n,o=function(t,i){var n,o=t.distX-i.distX,r=t.dist-i.dist,s=(i.series.group&&i.series.group.zIndex)-(t.series.group&&t.series.group.zIndex);return n=0!==o&&e?o:0!==r?r:0!==s?s:t.series.index>i.series.index?-1:1};return l(t,function(t){var r=t.noSharedTooltip&&e,s=!r&&t.options.findNearestPointBy.indexOf("y")<0,a=t.searchPoint(i,s);p(a,!0)&&(!p(n,!0)||o(n,a)>0)&&(n=a)}),n},getPointFromEvent:function(t){for(var e,i=t.target;i&&!e;)e=i.point,i=i.parentNode;return e},getChartCoordinatesFromPoint:function(t,e){var i=t.series,n=i.xAxis,o=i.yAxis,r=g(t.clientX,t.plotX);return n&&o?e?{chartX:n.len+n.pos-r,chartY:o.len+o.pos-t.plotY}:{chartX:r+n.pos,chartY:t.plotY+o.pos}:void 0},getHoverData:function(t,i,n,o,r,s,a){var h,d=[],u=i,f=a&&a.isBoosting,m=!(!o||!t),x=u&&!u.stickyTracking,v=function(t){return t.visible&&!(!r&&t.directTouch)&&g(t.options.enableMouseTracking,!0)},y=x?[u]:e.grep(n,function(t){return v(t)&&t.stickyTracking});return h=m?t:this.findNearestKDPoint(y,r,s),u=h&&h.series,h&&(r&&!u.noSharedTooltip?(y=e.grep(n,function(t){return v(t)&&!t.noSharedTooltip}),l(y,function(t){var e=c(t.points,function(t){return t.x===h.x&&!t.isNull});p(e)&&(f&&(e=t.getPoint(e)),d.push(e))})):d.push(h)),{hoverPoint:h,hoverSeries:u,hoverPoints:d}},runPointActions:function(t,n){var r,s,a,h,c=this,d=c.chart,p=d.series,u=d.tooltip&&d.tooltip.options.enabled?d.tooltip:void 0,f=u?u.shared:!1,m=n||d.hoverPoint,x=m&&m.series||d.hoverSeries,v=!!n||x&&x.directTouch&&c.isDirectTouch,y=this.getHoverData(m,x,p,v,f,t,{isBoosting:d.isBoosting});if(m=y.hoverPoint,h=y.hoverPoints,x=y.hoverSeries,s=x&&x.tooltipOptions.followPointer,r=f&&x&&!x.noSharedTooltip,m&&(m!==d.hoverPoint||u&&u.isHidden)){if(l(d.hoverPoints||[],function(t){-1===e.inArray(t,h)&&t.setState()}),l(h||[],function(t){t.setState("hover")}),d.hoverSeries!==x&&x.onMouseOver(),d.hoverPoint&&d.hoverPoint.firePointEvent("mouseOut"),!m.series)return;m.firePointEvent("mouseOver"),d.hoverPoints=h,d.hoverPoint=m,u&&u.refresh(r?h:m,t)}else s&&u&&!u.isHidden&&(a=u.getAnchor([{}],t),u.updatePosition({plotX:a[0],plotY:a[1]}));c.unDocMouseMove||(c.unDocMouseMove=i(d.container.ownerDocument,"mousemove",function(t){var i=o[e.hoverChartIndex];i&&i.pointer.onDocumentMouseMove(t)})),l(d.axes,function(i){var n=g(i.crosshair.snap,!0),o=n?e.find(h,function(t){return t.series[i.coll]===i}):void 0;o||!n?i.drawCrosshair(t,o):i.hideCrosshair()})},reset:function(t,e){var i=this,n=i.chart,o=n.hoverSeries,r=n.hoverPoint,s=n.hoverPoints,a=n.tooltip,h=a&&a.shared?s:r;t&&h&&l(f(h),function(e){e.series.isCartesian&&void 0===e.plotX&&(t=!1)}),t?a&&h&&(a.refresh(h),r&&(r.setState(r.state,!0),l(n.axes,function(t){t.crosshair&&t.drawCrosshair(null,r)}))):(r&&r.onMouseOut(),s&&l(s,function(t){t.setState()}),o&&o.onMouseOut(),a&&a.hide(e),i.unDocMouseMove&&(i.unDocMouseMove=i.unDocMouseMove()),l(n.axes,function(t){t.hideCrosshair()}),i.hoverX=n.hoverPoints=n.hoverPoint=null)},scaleGroups:function(t,e){var i,n=this.chart;l(n.series,function(o){i=t||o.getPlotBox(),o.xAxis&&o.xAxis.zoomEnabled&&o.group&&(o.group.attr(i),o.markerGroup&&(o.markerGroup.attr(i),o.markerGroup.clip(e?n.clipRect:null)),o.dataLabelsGroup&&o.dataLabelsGroup.attr(i))}),n.clipRect.attr(e||n.clipBox)},dragStart:function(t){var e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=this.mouseDownX=t.chartX,e.mouseDownY=this.mouseDownY=t.chartY},drag:function(t){var e,i,n=this.chart,o=n.options.chart,s=t.chartX,a=t.chartY,l=this.zoomHor,h=this.zoomVert,c=n.plotLeft,d=n.plotTop,p=n.plotWidth,u=n.plotHeight,g=this.selectionMarker,f=this.mouseDownX,m=this.mouseDownY,x=o.panKey&&t[o.panKey+"Key"];g&&g.touch||(c>s?s=c:s>c+p&&(s=c+p),d>a?a=d:a>d+u&&(a=d+u),this.hasDragged=Math.sqrt(Math.pow(f-s,2)+Math.pow(m-a,2)),this.hasDragged>10&&(e=n.isInsidePlot(f-c,m-d),n.hasCartesianSeries&&(this.zoomX||this.zoomY)&&e&&!x&&(g||(this.selectionMarker=g=n.renderer.rect(c,d,l?1:p,h?1:u,0).attr({fill:o.selectionMarkerFill||r("#335cad").setOpacity(.25).get(),class:"highcharts-selection-marker",zIndex:7}).add())),g&&l&&(i=s-f,g.attr({width:Math.abs(i),x:(i>0?0:i)+f})),g&&h&&(i=a-m,g.attr({height:Math.abs(i),y:(i>0?0:i)+m})),e&&!g&&o.panning&&n.pan(t,o.panning)))},drop:function(t){var e=this,i=this.chart,n=this.hasPinched;if(this.selectionMarker){var o,r={originalEvent:t,xAxis:[],yAxis:[]},c=this.selectionMarker,p=c.attr?c.attr("x"):c.x,u=c.attr?c.attr("y"):c.y,g=c.attr?c.attr("width"):c.width,f=c.attr?c.attr("height"):c.height;(this.hasDragged||n)&&(l(i.axes,function(i){if(i.zoomEnabled&&a(i.min)&&(n||e[{xAxis:"zoomX",yAxis:"zoomY"}[i.coll]])){var s=i.horiz,l="touchend"===t.type?i.minPixelPadding:0,h=i.toValue((s?p:u)+l),c=i.toValue((s?p+g:u+f)-l);r[i.coll].push({axis:i,min:Math.min(h,c),max:Math.max(h,c)}),o=!0}}),o&&d(i,"selection",r,function(t){i.zoom(h(t,n?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),n&&this.scaleGroups()}i&&(s(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(t){2!==t.button&&(t=this.normalize(t),this.zoomOption(t),t.preventDefault&&t.preventDefault(),this.dragStart(t))},onDocumentMouseUp:function(t){o[e.hoverChartIndex]&&o[e.hoverChartIndex].pointer.drop(t)},onDocumentMouseMove:function(t){var e=this.chart,i=this.chartPosition;t=this.normalize(t,i),!i||this.inClass(t.target,"highcharts-tracker")||e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)||this.reset()},onContainerMouseLeave:function(t){var i=o[e.hoverChartIndex];i&&(t.relatedTarget||t.toElement)&&(i.pointer.reset(),i.pointer.chartPosition=null)},onContainerMouseMove:function(t){var i=this.chart;a(e.hoverChartIndex)&&o[e.hoverChartIndex]&&o[e.hoverChartIndex].mouseIsDown||(e.hoverChartIndex=i.index),t=this.normalize(t),t.returnValue=!1,"mousedown"===i.mouseIsDown&&this.drag(t),!this.inClass(t.target,"highcharts-tracker")&&!i.isInsidePlot(t.chartX-i.plotLeft,t.chartY-i.plotTop)||i.openMenu||this.runPointActions(t)},inClass:function(t,e){for(var i;t;){if(i=n(t,"class")){if(-1!==i.indexOf(e))return!0;if(-1!==i.indexOf("highcharts-container"))return!1}t=t.parentNode}},onTrackerMouseOut:function(t){var e=this.chart.hoverSeries,i=t.relatedTarget||t.toElement;this.isDirectTouch=!1,!e||!i||e.stickyTracking||this.inClass(i,"highcharts-tooltip")||this.inClass(i,"highcharts-series-"+e.index)&&this.inClass(i,"highcharts-tracker")||e.onMouseOut()},onContainerClick:function(t){var e=this.chart,i=e.hoverPoint,n=e.plotLeft,o=e.plotTop;t=this.normalize(t),e.cancelClick||(i&&this.inClass(t.target,"highcharts-tracker")?(d(i.series,"click",h(t,{point:i})),e.hoverPoint&&i.firePointEvent("click",t)):(h(t,this.getCoordinates(t)),e.isInsidePlot(t.chartX-n,t.chartY-o)&&d(e,"click",t)))},setDOMEvents:function(){var t=this,n=t.chart.container,o=n.ownerDocument;n.onmousedown=function(e){t.onContainerMouseDown(e)},n.onmousemove=function(e){t.onContainerMouseMove(e)},n.onclick=function(e){t.onContainerClick(e)},this.unbindContainerMouseLeave=i(n,"mouseleave",t.onContainerMouseLeave),e.unbindDocumentMouseUp||(e.unbindDocumentMouseUp=i(o,"mouseup",t.onDocumentMouseUp)),e.hasTouch&&(n.ontouchstart=function(e){t.onContainerTouchStart(e)},n.ontouchmove=function(e){t.onContainerTouchMove(e)},e.unbindDocumentTouchEnd||(e.unbindDocumentTouchEnd=i(o,"touchend",t.onDocumentTouchEnd)))},destroy:function(){var t=this;t.unDocMouseMove&&t.unDocMouseMove(),this.unbindContainerMouseLeave(),e.chartCount||(e.unbindDocumentMouseUp&&(e.unbindDocumentMouseUp=e.unbindDocumentMouseUp()),e.unbindDocumentTouchEnd&&(e.unbindDocumentTouchEnd=e.unbindDocumentTouchEnd())),clearInterval(t.tooltipTimeout),e.objectEach(t,function(e,i){t[i]=null})}}}(e),function(t){var e=t.charts,i=t.each,n=t.extend,o=t.map,r=t.noop,s=t.pick,a=t.Pointer;n(a.prototype,{pinchTranslate:function(t,e,i,n,o,r){this.zoomHor&&this.pinchTranslateDirection(!0,t,e,i,n,o,r),this.zoomVert&&this.pinchTranslateDirection(!1,t,e,i,n,o,r)},pinchTranslateDirection:function(t,e,i,n,o,r,s,a){var l,h,c,d,p,u,g=this.chart,f=t?"x":"y",m=t?"X":"Y",x="chart"+m,v=t?"width":"height",y=g["plot"+(t?"Left":"Top")],b=a||1,k=g.inverted,M=g.bounds[t?"h":"v"],w=1===e.length,S=e[0][x],A=i[0][x],T=!w&&e[1][x],P=!w&&i[1][x],C=function(){!w&&Math.abs(S-T)>20&&(b=a||Math.abs(A-P)/Math.abs(S-T)),c=(y-A)/b+S,l=g["plot"+(t?"Width":"Height")]/b};C(),h=c,h<M.min?(h=M.min,d=!0):h+l>M.max&&(h=M.max-l,d=!0),d?(A-=.8*(A-s[f][0]),w||(P-=.8*(P-s[f][1])),C()):s[f]=[A,P],k||(r[f]=c-y,r[v]=l),u=k?t?"scaleY":"scaleX":"scale"+m,p=k?1/b:b,o[v]=l,o[f]=h,n[u]=b,n["translate"+m]=p*y+(A-p*S)},pinch:function(t){var e=this,a=e.chart,l=e.pinchDown,h=t.touches,c=h.length,d=e.lastValidTouch,p=e.hasZoom,u=e.selectionMarker,g={},f=1===c&&(e.inClass(t.target,"highcharts-tracker")&&a.runTrackerClick||e.runChartClick),m={};c>1&&(e.initiated=!0),p&&e.initiated&&!f&&t.preventDefault(),o(h,function(t){return e.normalize(t)}),"touchstart"===t.type?(i(h,function(t,e){l[e]={chartX:t.chartX,chartY:t.chartY}}),d.x=[l[0].chartX,l[1]&&l[1].chartX],d.y=[l[0].chartY,l[1]&&l[1].chartY],i(a.axes,function(t){if(t.zoomEnabled){var e=a.bounds[t.horiz?"h":"v"],i=t.minPixelPadding,n=t.toPixels(s(t.options.min,t.dataMin)),o=t.toPixels(s(t.options.max,t.dataMax)),r=Math.min(n,o),l=Math.max(n,o);e.min=Math.min(t.pos,r-i),e.max=Math.max(t.pos+t.len,l+i)}}),e.res=!0):e.followTouchMove&&1===c?this.runPointActions(e.normalize(t)):l.length&&(u||(e.selectionMarker=u=n({destroy:r,touch:!0},a.plotBox)),e.pinchTranslate(l,h,g,u,m,d),e.hasPinched=p,e.scaleGroups(g,m),e.res&&(e.res=!1,this.reset(!1,0)))},touch:function(e,i){var n,o,r,a=this.chart;a.index!==t.hoverChartIndex&&this.onContainerMouseLeave({relatedTarget:!0}),t.hoverChartIndex=a.index,1===e.touches.length?(e=this.normalize(e),r=a.isInsidePlot(e.chartX-a.plotLeft,e.chartY-a.plotTop),r&&!a.openMenu?(i&&this.runPointActions(e),"touchmove"===e.type&&(o=this.pinchDown,n=o[0]?Math.sqrt(Math.pow(o[0].chartX-e.chartX,2)+Math.pow(o[0].chartY-e.chartY,2))>=4:!1),s(n,!0)&&this.pinch(e)):i&&this.reset()):2===e.touches.length&&this.pinch(e)},onContainerTouchStart:function(t){this.zoomOption(t),this.touch(t,!0)},onContainerTouchMove:function(t){this.touch(t)},onDocumentTouchEnd:function(i){e[t.hoverChartIndex]&&e[t.hoverChartIndex].pointer.drop(i)}})}(e),function(t){var e=t.addEvent,i=t.charts,n=t.css,o=t.doc,r=t.extend,s=t.hasTouch,a=t.noop,l=t.Pointer,h=t.removeEvent,c=t.win,d=t.wrap;if(!s&&(c.PointerEvent||c.MSPointerEvent)){var p={},u=!!c.PointerEvent,g=function(){var e=[];return e.item=function(t){return this[t]},t.objectEach(p,function(t){e.push({pageX:t.pageX,pageY:t.pageY,target:t.target})}),e},f=function(e,n,o,r){var s;"touch"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH||!i[t.hoverChartIndex]||(r(e),s=i[t.hoverChartIndex].pointer,s[n]({type:o,target:e.currentTarget,preventDefault:a,touches:g()}))};r(l.prototype,{onContainerPointerDown:function(t){f(t,"onContainerTouchStart","touchstart",function(t){p[t.pointerId]={pageX:t.pageX,pageY:t.pageY,target:t.currentTarget}})},onContainerPointerMove:function(t){f(t,"onContainerTouchMove","touchmove",function(t){p[t.pointerId]={pageX:t.pageX,pageY:t.pageY},p[t.pointerId].target||(p[t.pointerId].target=t.currentTarget)})},onDocumentPointerUp:function(t){f(t,"onDocumentTouchEnd","touchend",function(t){delete p[t.pointerId]})},batchMSEvents:function(t){t(this.chart.container,u?"pointerdown":"MSPointerDown",this.onContainerPointerDown),t(this.chart.container,u?"pointermove":"MSPointerMove",this.onContainerPointerMove),t(o,u?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),d(l.prototype,"init",function(t,e,i){t.call(this,e,i),this.hasZoom&&n(e.container,{"-ms-touch-action":"none","touch-action":"none"})}),d(l.prototype,"setDOMEvents",function(t){t.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(e)}),d(l.prototype,"destroy",function(t){this.batchMSEvents(h),t.call(this)})}}(e),function(t){var e=t,i=e.addEvent,n=e.css,o=e.discardElement,r=e.defined,s=e.each,a=e.isFirefox,l=e.marginNames,h=e.merge,c=e.pick,d=e.setAnimation,p=e.stableSort,u=e.win,g=e.wrap;t.Legend=function(t,e){this.init(t,e)},t.Legend.prototype={init:function(t,e){this.chart=t,this.setOptions(e),e.enabled&&(this.render(),i(this.chart,"endResize",function(){this.legend.positionCheckboxes()}))},setOptions:function(t){var e=c(t.padding,8);this.options=t,this.itemStyle=t.itemStyle,this.itemHiddenStyle=h(this.itemStyle,t.itemHiddenStyle),this.itemMarginTop=t.itemMarginTop||0,this.padding=e,this.initialItemY=e-5,this.maxItemWidth=0,this.itemHeight=0,this.symbolWidth=c(t.symbolWidth,16),this.pages=[]},update:function(t,e){var i=this.chart;this.setOptions(h(!0,this.options,t)),this.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,c(e,!0)&&i.redraw()},colorizeItem:function(t,e){t.legendGroup[e?"removeClass":"addClass"]("highcharts-legend-item-hidden");var i=this,n=i.options,o=t.legendItem,r=t.legendLine,s=t.legendSymbol,a=i.itemHiddenStyle.color,l=e?n.itemStyle.color:a,h=e?t.color||a:a,c=t.options&&t.options.marker,d={fill:h};o&&o.css({fill:l,color:l}),r&&r.attr({stroke:h}),s&&(c&&s.isMarker&&(d=t.pointAttribs(),e||(d.stroke=d.fill=a)),s.attr(d))},positionItem:function(t){var e=this,i=e.options,n=i.symbolPadding,o=!i.rtl,r=t._legendItemPos,s=r[0],a=r[1],l=t.checkbox,h=t.legendGroup;h&&h.element&&h.translate(o?s:e.legendWidth-s-2*n-4,a),l&&(l.x=s,l.y=a)},destroyItem:function(t){var e=t.checkbox;s(["legendItem","legendLine","legendSymbol","legendGroup"],function(e){t[e]&&(t[e]=t[e].destroy())}),e&&o(t.checkbox)},destroy:function(){function t(t){this[t]&&(this[t]=this[t].destroy())}s(this.getAllItems(),function(e){s(["legendItem","legendGroup"],t,e)}),s(["clipRect","up","down","pager","nav","box","title","group"],t,this),this.display=null},positionCheckboxes:function(){var t,e=this.group&&this.group.alignAttr,i=this.clipHeight||this.legendHeight,o=this.titleHeight;e&&(t=e.translateY,s(this.allItems,function(r){var s,a=r.checkbox;a&&(s=t+o+a.y+(this.scrollOffset||0)+3,n(a,{left:e.translateX+r.checkboxOffset+a.x-20+"px",top:s+"px",display:s>t-6&&t+i-6>s?"":"none"}))},this))},renderTitle:function(){var t,e=this.options,i=this.padding,n=e.title,o=0;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,i-3,i-4,null,null,null,e.useHTML,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),t=this.title.getBBox(),o=t.height,this.offsetWidth=t.width,this.contentGroup.attr({translateY:o})),this.titleHeight=o},setText:function(t){var i=this.options;t.legendItem.attr({text:i.labelFormat?e.format(i.labelFormat,t):i.labelFormatter.call(t)})},renderItem:function(t){var e,i,n,o=this,r=o.chart,s=r.renderer,a=o.options,l="horizontal"===a.layout,d=o.symbolWidth,p=a.symbolPadding,u=o.itemStyle,g=o.itemHiddenStyle,f=o.padding,m=l?c(a.itemDistance,20):0,x=!a.rtl,v=a.width,y=a.itemMarginBottom||0,b=o.itemMarginTop,k=t.legendItem,M=!t.series,w=!M&&t.series.drawLegendSymbol?t.series:t,S=w.options,A=o.createCheckboxForItem&&S&&S.showCheckbox,T=d+p+m+(A?20:0),P=a.useHTML,C=12,L=t.options.className;k||(t.legendGroup=s.g("legend-item").addClass("highcharts-"+w.type+"-series highcharts-color-"+t.colorIndex+(L?" "+L:"")+(M?" highcharts-series-"+t.index:"")).attr({zIndex:1}).add(o.scrollGroup),t.legendItem=k=s.text("",x?d+p:-p,o.baseline||0,P).css(h(t.visible?u:g)).attr({align:x?"left":"right",zIndex:2}).add(t.legendGroup),o.baseline||(C=u.fontSize,o.fontMetrics=s.fontMetrics(C,k),o.baseline=o.fontMetrics.f+3+b,k.attr("y",o.baseline)),o.symbolHeight=a.symbolHeight||o.fontMetrics.f,w.drawLegendSymbol(o,t),o.setItemEvents&&o.setItemEvents(t,k,P),A&&o.createCheckboxForItem(t)),o.colorizeItem(t,t.visible),u.width||k.css({width:(a.itemWidth||a.width||r.spacingBox.width)-T}),o.setText(t),i=k.getBBox(),n=t.checkboxOffset=a.itemWidth||t.legendItemWidth||i.width+T,o.itemHeight=e=Math.round(t.legendItemHeight||i.height||o.symbolHeight),l&&o.itemX-f+n>(v||r.spacingBox.width-2*f-a.x)&&(o.itemX=f,o.itemY+=b+o.lastLineHeight+y,o.lastLineHeight=0),o.maxItemWidth=Math.max(o.maxItemWidth,n),o.lastItemY=b+o.itemY+y,o.lastLineHeight=Math.max(e,o.lastLineHeight),t._legendItemPos=[o.itemX,o.itemY],l?o.itemX+=n:(o.itemY+=b+e+y,o.lastLineHeight=e),o.offsetWidth=v||Math.max((l?o.itemX-f-(t.checkbox?0:m):n)+f,o.offsetWidth)},getAllItems:function(){var t=[];return s(this.chart.series,function(e){var i=e&&e.options;e&&c(i.showInLegend,r(i.linkedTo)?!1:void 0,!0)&&(t=t.concat(e.legendItems||("point"===i.legendType?e.data:e)))}),t},getAlignment:function(){var t=this.options;return t.floating?"":t.align.charAt(0)+t.verticalAlign.charAt(0)+t.layout.charAt(0)},adjustMargins:function(t,e){var i=this.chart,n=this.options,o=this.getAlignment();o&&s([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(s,a){s.test(o)&&!r(t[a])&&(i[l[a]]=Math.max(i[l[a]],i.legend[(a+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][a]*n[a%2?"x":"y"]+c(n.margin,12)+e[a]+(0===a?i.titleOffset+i.options.title.margin:0)))})},render:function(){var t,e,i,n,o,r=this,a=r.chart,l=a.renderer,c=r.group,d=r.box,u=r.options,g=r.padding;r.itemX=g,r.itemY=r.initialItemY,r.offsetWidth=0,r.lastItemY=0,c||(r.group=c=l.g("legend").attr({zIndex:7}).add(),r.contentGroup=l.g().attr({zIndex:1}).add(c),r.scrollGroup=l.g().add(r.contentGroup)),r.renderTitle(),t=r.getAllItems(),p(t,function(t,e){return(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)}),u.reversed&&t.reverse(),r.allItems=t,r.display=e=!!t.length,r.lastLineHeight=0,s(t,function(t){r.renderItem(t)}),i=(u.width||r.offsetWidth)+g,n=r.lastItemY+r.lastLineHeight+r.titleHeight,n=r.handleOverflow(n),n+=g,d||(r.box=d=l.rect().addClass("highcharts-legend-box").attr({r:u.borderRadius}).add(c),d.isNew=!0),d.attr({stroke:u.borderColor,"stroke-width":u.borderWidth||0,fill:u.backgroundColor||"none"}).shadow(u.shadow),i>0&&n>0&&(d[d.isNew?"attr":"animate"](d.crisp.call({},{x:0,y:0,width:i,height:n},d.strokeWidth())),d.isNew=!1),d[e?"show":"hide"](),r.legendWidth=i,r.legendHeight=n,s(t,function(t){r.positionItem(t)}),e&&(o=a.spacingBox,/(lth|ct|rth)/.test(r.getAlignment())&&(o=h(o,{y:o.y+a.titleOffset+a.options.title.margin})),c.align(h(u,{width:i,height:n}),!0,o)),a.isResizing||this.positionCheckboxes()},handleOverflow:function(t){var e,i,n=this,o=this.chart,r=o.renderer,a=this.options,l=a.y,h="top"===a.verticalAlign,d=this.padding,p=o.spacingBox.height+(h?-l:l)-d,u=a.maxHeight,g=this.clipRect,f=a.navigation,m=c(f.animation,!0),x=f.arrowSize||12,v=this.nav,y=this.pages,b=this.allItems,k=function(t){"number"==typeof t?g.attr({height:t}):g&&(n.clipRect=g.destroy(),n.contentGroup.clip()),n.contentGroup.div&&(n.contentGroup.div.style.clip=t?"rect("+d+"px,9999px,"+(d+t)+"px,0)":"auto")};return"horizontal"!==a.layout||"middle"===a.verticalAlign||a.floating||(p/=2),u&&(p=Math.min(p,u)),y.length=0,t>p&&f.enabled!==!1?(this.clipHeight=e=Math.max(p-20-this.titleHeight-d,0),this.currentPage=c(this.currentPage,1),this.fullHeight=t,s(b,function(t,n){var o=t._legendItemPos[1],r=Math.round(t.legendItem.getBBox().height),s=y.length;(!s||o-y[s-1]>e&&(i||o)!==y[s-1])&&(y.push(i||o),s++),t.pageIx=s-1,i&&(b[n-1].pageIx=s-1),n===b.length-1&&o+r-y[s-1]>e&&(y.push(o),t.pageIx=s),o!==i&&(i=o)}),g||(g=n.clipRect=r.clipRect(0,d,9999,0),n.contentGroup.clip(g)),k(e),v||(this.nav=v=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,x,x).on("click",function(){n.scroll(-1,m)}).add(v),this.pager=r.text("",15,10).addClass("highcharts-legend-navigation").css(f.style).add(v),this.down=r.symbol("triangle-down",0,0,x,x).on("click",function(){n.scroll(1,m)}).add(v)),n.scroll(0),t=p):v&&(k(),this.nav=v.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t},scroll:function(t,e){var i=this.pages,n=i.length,o=this.currentPage+t,r=this.clipHeight,s=this.options.navigation,a=this.pager,l=this.padding;o>n&&(o=n),o>0&&(void 0!==e&&d(e,this.chart),this.nav.attr({translateX:l,translateY:r+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({class:1===o?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),a.attr({text:o+"/"+n}),this.down.attr({x:18+this.pager.getBBox().width,class:o===n?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),this.up.attr({fill:1===o?s.inactiveColor:s.activeColor}).css({cursor:1===o?"default":"pointer"}),this.down.attr({fill:o===n?s.inactiveColor:s.activeColor}).css({cursor:o===n?"default":"pointer"}),this.scrollOffset=-i[o-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=o,this.positionCheckboxes())}},e.LegendSymbolMixin={drawRectangle:function(t,e){var i=t.options,n=t.symbolHeight,o=i.squareSymbol,r=o?n:t.symbolWidth;e.legendSymbol=this.chart.renderer.rect(o?(t.symbolWidth-n)/2:0,t.baseline-n+1,r,n,c(t.options.symbolRadius,n/2)).addClass("highcharts-point").attr({zIndex:3}).add(e.legendGroup)},drawLineMarker:function(t){var e,i,n=this.options,o=n.marker,r=t.symbolWidth,s=t.symbolHeight,a=s/2,l=this.chart.renderer,d=this.legendGroup,p=t.baseline-Math.round(.3*t.fontMetrics.b),u={};u={"stroke-width":n.lineWidth||0},n.dashStyle&&(u.dashstyle=n.dashStyle),this.legendLine=l.path(["M",0,p,"L",r,p]).addClass("highcharts-graph").attr(u).add(d),o&&o.enabled!==!1&&(e=Math.min(c(o.radius,a),a),0===this.symbol.indexOf("url")&&(o=h(o,{width:s,height:s}),e=0),this.legendSymbol=i=l.symbol(this.symbol,r/2-e,p-e,2*e,2*e,o).addClass("highcharts-point").add(d),i.isMarker=!0)}},(/Trident\/7\.0/.test(u.navigator.userAgent)||a)&&g(t.Legend.prototype,"positionItem",function(t,e){var i=this,n=function(){e._legendItemPos&&t.call(i,e)};n(),setTimeout(n)})}(e),function(t){var e=t.addEvent,i=t.animate,n=t.animObject,o=t.attr,r=t.doc,s=t.Axis,a=t.createElement,l=t.defaultOptions,h=t.discardElement,c=t.charts,d=t.css,p=t.defined,u=t.each,g=t.extend,f=t.find,m=t.fireEvent,x=t.grep,v=t.isNumber,y=t.isObject,b=t.isString,k=t.Legend,M=t.marginNames,w=t.merge,S=t.objectEach,A=t.Pointer,T=t.pick,P=t.pInt,C=t.removeEvent,L=t.seriesTypes,O=t.splat,D=t.svg,I=t.syncTimeout,B=t.win,z=t.Chart=function(){this.getArgs.apply(this,arguments)};t.chart=function(t,e,i){return new z(t,e,i)},g(z.prototype,{callbacks:[],getArgs:function(){var t=[].slice.call(arguments);(b(t[0])||t[0].nodeName)&&(this.renderTo=t.shift()),this.init(t[0],t[1])},init:function(i,n){var o,r,s=i.series,a=i.plotOptions||{};i.series=null,o=w(l,i);for(r in o.plotOptions)o.plotOptions[r].tooltip=a[r]&&w(a[r].tooltip)||void 0;o.tooltip.userOptions=i.chart&&i.chart.forExport&&i.tooltip.userOptions||i.tooltip,o.series=i.series=s,this.userOptions=i;var h=o.chart,d=h.events;this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=n,this.isResizing=0,this.options=o,this.axes=[],this.series=[],this.hasCartesianSeries=h.showAxes;var p=this;p.index=c.length,c.push(p),t.chartCount++,d&&S(d,function(t,i){e(p,i,t)}),p.xAxis=[],p.yAxis=[],p.pointCount=p.colorCounter=p.symbolCounter=0,p.firstRender()},initSeries:function(e){var i,n=this,o=n.options.chart,r=e.type||o.type||o.defaultSeriesType,s=L[r];return s||t.error(17,!0),i=new s,i.init(this,e),i},orderSeries:function(t){for(var e=this.series,i=t||0;i<e.length;i++)e[i]&&(e[i].index=i,e[i].name=e[i].name||"Series "+(e[i].index+1))},isInsidePlot:function(t,e,i){var n=i?e:t,o=i?t:e;return n>=0&&n<=this.plotWidth&&o>=0&&o<=this.plotHeight},redraw:function(e){var i,n,o,r,s=this,a=s.axes,l=s.series,h=s.pointer,c=s.legend,d=s.isDirtyLegend,p=s.hasCartesianSeries,f=s.isDirtyBox,x=s.renderer,v=x.isHidden(),y=[];for(s.setResponsive&&s.setResponsive(!1),t.setAnimation(e,s),v&&s.temporaryDisplay(),s.layOutTitles(),o=l.length;o--;)if(r=l[o],r.options.stacking&&(i=!0,r.isDirty)){n=!0;break}if(n)for(o=l.length;o--;)r=l[o],r.options.stacking&&(r.isDirty=!0);u(l,function(t){t.isDirty&&"point"===t.options.legendType&&(t.updateTotals&&t.updateTotals(),d=!0),t.isDirtyData&&m(t,"updatedData")}),d&&c.options.enabled&&(c.render(),s.isDirtyLegend=!1),i&&s.getStacks(),p&&u(a,function(t){t.updateNames(),t.setScale()}),s.getMargins(),p&&(u(a,function(t){t.isDirty&&(f=!0)}),u(a,function(t){var e=t.min+","+t.max;t.extKey!==e&&(t.extKey=e,y.push(function(){m(t,"afterSetExtremes",g(t.eventArgs,t.getExtremes())),delete t.eventArgs})),(f||i)&&t.redraw()})),f&&s.drawChartBox(),m(s,"predraw"),u(l,function(t){(f||t.isDirty)&&t.visible&&t.redraw(),t.isDirtyData=!1}),h&&h.reset(!0),x.draw(),m(s,"redraw"),m(s,"render"),v&&s.temporaryDisplay(!0),u(y,function(t){t.call()})},get:function(t){function e(e){return e.id===t||e.options&&e.options.id===t}var i,n,o=this.series;for(i=f(this.axes,e)||f(this.series,e),n=0;!i&&n<o.length;n++)i=f(o[n].points||[],e);return i},getAxes:function(){var t,e=this,i=this.options,n=i.xAxis=O(i.xAxis||{}),o=i.yAxis=O(i.yAxis||{});u(n,function(t,e){t.index=e,t.isX=!0}),u(o,function(t,e){t.index=e}),t=n.concat(o),u(t,function(t){new s(e,t)})},getSelectedPoints:function(){var t=[];return u(this.series,function(e){t=t.concat(x(e.data||[],function(t){return t.selected}))}),t},getSelectedSeries:function(){return x(this.series,function(t){return t.selected})},setTitle:function(t,e,i){var n,o,r=this,s=r.options;n=s.title=w({style:{color:"#333333",fontSize:s.isStock?"16px":"18px"}},s.title,t),o=s.subtitle=w({style:{color:"#666666"}},s.subtitle,e),u([["title",t,n],["subtitle",e,o]],function(t,e){var i=t[0],n=r[i],o=t[1],s=t[2];n&&o&&(r[i]=n=n.destroy()),s&&!n&&(r[i]=r.renderer.text(s.text,0,0,s.useHTML).attr({align:s.align,class:"highcharts-"+i,zIndex:s.zIndex||4}).add(),r[i].update=function(t){r.setTitle(!e&&t,e&&t)},r[i].css(s.style))}),r.layOutTitles(i)},layOutTitles:function(t){var e,i=0,n=this.renderer,o=this.spacingBox;u(["title","subtitle"],function(t){var e,r=this[t],s=this.options[t],a="title"===t?-3:s.verticalAlign?0:i+2;r&&(e=s.style.fontSize,e=n.fontMetrics(e,r).b,r.css({width:(s.width||o.width+s.widthAdjust)+"px"}).align(g({y:a+e},s),!1,"spacingBox"),s.floating||s.verticalAlign||(i=Math.ceil(i+r.getBBox(s.useHTML).height)))},this),e=this.titleOffset!==i,this.titleOffset=i,!this.isDirtyBox&&e&&(this.isDirtyBox=e,this.hasRendered&&T(t,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this,i=e.options.chart,n=i.width,o=i.height,r=e.renderTo;p(n)||(e.containerWidth=t.getStyle(r,"width")),p(o)||(e.containerHeight=t.getStyle(r,"height")),e.chartWidth=Math.max(0,n||e.containerWidth||600),e.chartHeight=Math.max(0,t.relativeLength(o,e.chartWidth)||(e.containerHeight>1?e.containerHeight:400))},temporaryDisplay:function(e){var i,n=this.renderTo;if(e)for(;n&&n.style;)n.hcOrigStyle&&(t.css(n,n.hcOrigStyle),delete n.hcOrigStyle),n.hcOrigDetached&&(r.body.removeChild(n),n.hcOrigDetached=!1),n=n.parentNode;else for(;n&&n.style&&(r.body.contains(n)||n.parentNode||(n.hcOrigDetached=!0,r.body.appendChild(n)),("none"===t.getStyle(n,"display",!1)||n.hcOricDetached)&&(n.hcOrigStyle={display:n.style.display,height:n.style.height,overflow:n.style.overflow},i={display:"block",overflow:"hidden"},n!==this.renderTo&&(i.height=0),t.css(n,i),n.offsetWidth||n.style.setProperty("display","block","important")),n=n.parentNode,n!==r.body););},setClassName:function(t){this.container.className="highcharts-container "+(t||"")},getContainer:function(){var e,i,n,s,l,h,d=this,p=d.options,u=p.chart,f=d.renderTo,m="data-highcharts-chart",x=t.uniqueKey();f||(d.renderTo=f=u.renderTo),b(f)&&(d.renderTo=f=r.getElementById(f)),f||t.error(13,!0),s=P(o(f,m)),v(s)&&c[s]&&c[s].hasRendered&&c[s].destroy(),o(f,m,d.index),f.innerHTML="",u.skipClone||f.offsetWidth||d.temporaryDisplay(),d.getChartSize(),i=d.chartWidth,n=d.chartHeight,h=g({position:"relative",overflow:"hidden",width:i+"px",height:n+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},u.style),e=a("div",{id:x},h,f),d.container=e,d._cursor=e.style.cursor,l=t[u.renderer]||t.Renderer,d.renderer=new l(e,i,n,null,u.forExport,p.exporting&&p.exporting.allowHTML),d.setClassName(u.className),d.renderer.setStyle(u.style),d.renderer.chartIndex=d.index},getMargins:function(t){var e=this,i=e.spacing,n=e.margin,o=e.titleOffset;e.resetMargins(),o&&!p(n[0])&&(e.plotTop=Math.max(e.plotTop,o+e.options.title.margin+i[0])),e.legend&&e.legend.display&&e.legend.adjustMargins(n,i),e.extraMargin&&(e[e.extraMargin.type]=(e[e.extraMargin.type]||0)+e.extraMargin.value),e.adjustPlotArea&&e.adjustPlotArea(),t||this.getAxisMargins()},getAxisMargins:function(){var t=this,e=t.axisOffset=[0,0,0,0],i=t.margin;t.hasCartesianSeries&&u(t.axes,function(t){t.visible&&t.getOffset()}),u(M,function(n,o){p(i[o])||(t[n]+=e[o])}),t.setChartSize()},reflow:function(e){var i=this,n=i.options.chart,o=i.renderTo,s=p(n.width)&&p(n.height),a=n.width||t.getStyle(o,"width"),l=n.height||t.getStyle(o,"height"),h=e?e.target:B;s||i.isPrinting||!a||!l||h!==B&&h!==r||((a!==i.containerWidth||l!==i.containerHeight)&&(clearTimeout(i.reflowTimeout),i.reflowTimeout=I(function(){i.container&&i.setSize(void 0,void 0,!1)},e?100:0)),i.containerWidth=a,i.containerHeight=l)},initReflow:function(){var t,i=this;t=e(B,"resize",function(t){i.reflow(t)}),e(i,"destroy",t)},setSize:function(e,o,r){var s,a=this,l=a.renderer;a.isResizing+=1,t.setAnimation(r,a),a.oldChartHeight=a.chartHeight,a.oldChartWidth=a.chartWidth,void 0!==e&&(a.options.chart.width=e),void 0!==o&&(a.options.chart.height=o),a.getChartSize(),s=l.globalAnimation,(s?i:d)(a.container,{width:a.chartWidth+"px",height:a.chartHeight+"px"},s),a.setChartSize(!0),l.setSize(a.chartWidth,a.chartHeight,r),u(a.axes,function(t){t.isDirty=!0,t.setScale()}),a.isDirtyLegend=!0,a.isDirtyBox=!0,a.layOutTitles(),a.getMargins(),a.redraw(r),a.oldChartHeight=null,m(a,"resize"),I(function(){a&&m(a,"endResize",null,function(){a.isResizing-=1})},n(s).duration)},setChartSize:function(t){var e,i,n,o,r,s,a,l=this,h=l.inverted,c=l.renderer,d=l.chartWidth,p=l.chartHeight,g=l.options.chart,f=l.spacing,m=l.clipOffset;l.plotLeft=n=Math.round(l.plotLeft),l.plotTop=o=Math.round(l.plotTop),l.plotWidth=r=Math.max(0,Math.round(d-n-l.marginRight)),l.plotHeight=s=Math.max(0,Math.round(p-o-l.marginBottom)),l.plotSizeX=h?s:r,l.plotSizeY=h?r:s,l.plotBorderWidth=g.plotBorderWidth||0,l.spacingBox=c.spacingBox={x:f[3],y:f[0],width:d-f[3]-f[1],height:p-f[0]-f[2]},l.plotBox=c.plotBox={x:n,y:o,width:r,height:s},a=2*Math.floor(l.plotBorderWidth/2),e=Math.ceil(Math.max(a,m[3])/2),i=Math.ceil(Math.max(a,m[0])/2),l.clipBox={x:e,y:i,width:Math.floor(l.plotSizeX-Math.max(a,m[1])/2-e),height:Math.max(0,Math.floor(l.plotSizeY-Math.max(a,m[2])/2-i))},t||u(l.axes,function(t){t.setAxisSize(),t.setAxisTranslation()})},resetMargins:function(){var t=this,e=t.options.chart;u(["margin","spacing"],function(i){var n=e[i],o=y(n)?n:[n,n,n,n];u(["Top","Right","Bottom","Left"],function(n,r){t[i][r]=T(e[i+n],o[r])})}),u(M,function(e,i){t[e]=T(t.margin[i],t.spacing[i])}),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]},drawChartBox:function(){var t,e,i,n=this,o=n.options.chart,r=n.renderer,s=n.chartWidth,a=n.chartHeight,l=n.chartBackground,h=n.plotBackground,c=n.plotBorder,d=n.plotBGImage,p=o.backgroundColor,u=o.plotBackgroundColor,g=o.plotBackgroundImage,f=n.plotLeft,m=n.plotTop,x=n.plotWidth,v=n.plotHeight,y=n.plotBox,b=n.clipRect,k=n.clipBox,M="animate";l||(n.chartBackground=l=r.rect().addClass("highcharts-background").add(),M="attr"),t=o.borderWidth||0,e=t+(o.shadow?8:0),i={fill:p||"none"},(t||l["stroke-width"])&&(i.stroke=o.borderColor,i["stroke-width"]=t),l.attr(i).shadow(o.shadow),l[M]({x:e/2,y:e/2,width:s-e-t%2,height:a-e-t%2,r:o.borderRadius}),M="animate",h||(M="attr",n.plotBackground=h=r.rect().addClass("highcharts-plot-background").add()),h[M](y),h.attr({fill:u||"none"}).shadow(o.plotShadow),g&&(d?d.animate(y):n.plotBGImage=r.image(g,f,m,x,v).add()),b?b.animate({width:k.width,height:k.height}):n.clipRect=r.clipRect(k),M="animate",c||(M="attr",n.plotBorder=c=r.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),c.attr({stroke:o.plotBorderColor,"stroke-width":o.plotBorderWidth||0,fill:"none"}),c[M](c.crisp({x:f,y:m,width:x,height:v},-c.strokeWidth())),n.isDirtyBox=!1},propFromSeries:function(){var t,e,i,n=this,o=n.options.chart,r=n.options.series;u(["inverted","angular","polar"],function(s){for(t=L[o.type||o.defaultSeriesType],i=o[s]||t&&t.prototype[s],e=r&&r.length;!i&&e--;)t=L[r[e].type],t&&t.prototype[s]&&(i=!0);n[s]=i})},linkSeries:function(){var t=this,e=t.series;u(e,function(t){t.linkedSeries.length=0}),u(e,function(e){var i=e.options.linkedTo;b(i)&&(i=":previous"===i?t.series[e.index-1]:t.get(i),i&&i.linkedParent!==e&&(i.linkedSeries.push(e),e.linkedParent=i,e.visible=T(e.options.visible,i.options.visible,e.visible)))})},renderSeries:function(){u(this.series,function(t){t.translate(),t.render()})},renderLabels:function(){var t=this,e=t.options.labels;e.items&&u(e.items,function(i){var n=g(e.style,i.style),o=P(n.left)+t.plotLeft,r=P(n.top)+t.plotTop+12;delete n.left,delete n.top,t.renderer.text(i.html,o,r).attr({zIndex:2}).css(n).add()})},render:function(){var t,e,i,n,o=this,r=o.axes,s=o.renderer,a=o.options;o.setTitle(),o.legend=new k(o,a.legend),o.getStacks&&o.getStacks(),o.getMargins(!0),o.setChartSize(),t=o.plotWidth,e=o.plotHeight=Math.max(o.plotHeight-21,0),u(r,function(t){t.setScale()}),o.getAxisMargins(),i=t/o.plotWidth>1.1,n=e/o.plotHeight>1.05,(i||n)&&(u(r,function(t){(t.horiz&&i||!t.horiz&&n)&&t.setTickInterval(!0)}),o.getMargins()),o.drawChartBox(),o.hasCartesianSeries&&u(r,function(t){t.visible&&t.render()}),o.seriesGroup||(o.seriesGroup=s.g("series-group").attr({zIndex:3}).add()),o.renderSeries(),o.renderLabels(),o.addCredits(),o.setResponsive&&o.setResponsive(),o.hasRendered=!0},addCredits:function(t){var e=this;t=w(!0,this.options.credits,t),t.enabled&&!this.credits&&(this.credits=this.renderer.text(t.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){t.href&&(B.location.href=t.href)}).attr({align:t.position.align,zIndex:8}).css(t.style).add().align(t.position),this.credits.update=function(t){e.credits=e.credits.destroy(),e.addCredits(t)})},destroy:function(){var e,i=this,n=i.axes,o=i.series,r=i.container,s=r&&r.parentNode;for(m(i,"destroy"),i.renderer.forExport?t.erase(c,i):c[i.index]=void 0,t.chartCount--,i.renderTo.removeAttribute("data-highcharts-chart"),C(i),e=n.length;e--;)n[e]=n[e].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),e=o.length;e--;)o[e]=o[e].destroy();u(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(t){var e=i[t];e&&e.destroy&&(i[t]=e.destroy())}),r&&(r.innerHTML="",C(r),s&&h(r)),S(i,function(t,e){delete i[e]})},isReadyToRender:function(){var t=this;return D||B!=B.top||"complete"===r.readyState?!0:(r.attachEvent("onreadystatechange",function(){r.detachEvent("onreadystatechange",t.firstRender),"complete"===r.readyState&&t.firstRender()}),!1)},firstRender:function(){var t=this,e=t.options;t.isReadyToRender()&&(t.getContainer(),m(t,"init"),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes(),u(e.series||[],function(e){t.initSeries(e)}),t.linkSeries(),m(t,"beforeRender"),A&&(t.pointer=new A(t,e)),t.render(),!t.renderer.imgCount&&t.onload&&t.onload(),t.temporaryDisplay(!0))},onload:function(){u([this.callback].concat(this.callbacks),function(t){t&&void 0!==this.index&&t.apply(this,[this])},this),m(this,"load"),m(this,"render"),p(this.index)&&this.options.chart.reflow!==!1&&this.initReflow(),this.onload=null}})}(e),function(t){var e,i=t,n=i.each,o=i.extend,r=i.erase,s=i.fireEvent,a=i.format,l=i.isArray,h=i.isNumber,c=i.pick,d=i.removeEvent;t.Point=e=function(){},t.Point.prototype={init:function(t,e,i){var n,o,r=this,s=t.chart.options.chart.colorCount;return r.series=t,r.color=t.color,r.applyOptions(e,i),t.options.colorByPoint?(n=t.options.colors||t.chart.options.colors,r.color=r.color||n[t.colorCounter],s=n.length,o=t.colorCounter,t.colorCounter++,t.colorCounter===s&&(t.colorCounter=0)):o=t.colorIndex,r.colorIndex=c(r.colorIndex,o),t.chart.pointCount++,r},applyOptions:function(t,i){var n=this,r=n.series,s=r.options.pointValKey||r.pointValKey;return t=e.prototype.optionsToObject.call(this,t),o(n,t),n.options=n.options?o(n.options,t):t,t.group&&delete n.group,s&&(n.y=n[s]),n.isNull=c(n.isValid&&!n.isValid(),null===n.x||!h(n.y,!0)),n.selected&&(n.state="select"),"name"in n&&void 0===i&&r.xAxis&&r.xAxis.hasNames&&(n.x=r.xAxis.nameToX(n)),void 0===n.x&&r&&(n.x=void 0===i?r.autoIncrement(n):i),n},optionsToObject:function(t){var e,i={},n=this.series,o=n.options.keys,r=o||n.pointArrayMap||["y"],s=r.length,a=0,c=0;if(h(t)||null===t)i[r[0]]=t;else if(l(t))for(!o&&t.length>s&&(e=typeof t[0],"string"===e?i.name=t[0]:"number"===e&&(i.x=t[0]),a++);s>c;)o&&void 0===t[a]||(i[r[c]]=t[a]),a++,c++;else"object"==typeof t&&(i=t,t.dataLabels&&(n._hasPointLabels=!0),t.marker&&(n._hasPointMarkers=!0));return i},getClassName:function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},getZone:function(){var t,e=this.series,i=e.zones,n=e.zoneAxis||"y",o=0;for(t=i[o];this[n]>=t.value;)t=i[++o];return t&&t.color&&!this.options.color&&(this.color=t.color),t},destroy:function(){var t,e=this,i=e.series,n=i.chart,o=n.hoverPoints;n.pointCount--,o&&(e.setState(),r(o,e),o.length||(n.hoverPoints=null)),e===n.hoverPoint&&e.onMouseOut(),(e.graphic||e.dataLabel)&&(d(e),e.destroyElements()),e.legendItem&&n.legend.destroyItem(e);for(t in e)e[t]=null},destroyElements:function(){for(var t,e=this,i=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],n=6;n--;)t=i[n],e[t]&&(e[t]=e[t].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(t){var e=this.series,i=e.tooltipOptions,o=c(i.valueDecimals,""),r=i.valuePrefix||"",s=i.valueSuffix||"";return n(e.pointArrayMap||["y"],function(e){e="{point."+e,(r||s)&&(t=t.replace(e+"}",r+e+"}"+s)),t=t.replace(e+"}",e+":,."+o+"f}")}),a(t,{point:this,series:this.series})},firePointEvent:function(t,e,i){var n=this,o=this.series,r=o.options;(r.point.events[t]||n.options&&n.options.events&&n.options.events[t])&&this.importEvents(),"click"===t&&r.allowPointSelect&&(i=function(t){n.select&&n.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),s(this,t,e,i)},visible:!0}}(e),function(t){var e=t.addEvent,i=t.animObject,n=t.arrayMax,o=t.arrayMin,r=t.correctFloat,s=t.Date,a=t.defaultOptions,l=t.defaultPlotOptions,h=t.defined,c=t.each,d=t.erase,p=t.extend,u=t.fireEvent,g=t.grep,f=t.isArray,m=t.isNumber,x=t.isString,v=t.LegendSymbolMixin,y=t.merge,b=t.objectEach,k=t.pick,M=t.Point,w=t.removeEvent,S=t.splat,A=t.SVGElement,T=t.syncTimeout,P=t.win;t.Series=t.seriesType("line",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{lineWidth:0,lineColor:"#ffffff",radius:4,states:{hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return null===this.y?"":t.numberFormat(this.y,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},{isCartesian:!0,pointClass:M,sorted:!0,requireSorting:!0,directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],coll:"series",init:function(t,i){var n,o,r=this,s=t.series;r.chart=t,r.options=i=r.setOptions(i),r.linkedSeries=[],r.bindAxes(),p(r,{name:i.name,state:"",visible:i.visible!==!1,selected:i.selected===!0}),n=i.events,b(n,function(t,i){e(r,i,t)}),(n&&n.click||i.point&&i.point.events&&i.point.events.click||i.allowPointSelect)&&(t.runTrackerClick=!0),r.getColor(),r.getSymbol(),c(r.parallelArrays,function(t){r[t+"Data"]=[]}),r.setData(i.data,!1),r.isCartesian&&(t.hasCartesianSeries=!0),s.length&&(o=s[s.length-1]),r._i=k(o&&o._i,-1)+1,t.orderSeries(this.insert(s))},insert:function(t){var e,i=this.options.index;if(m(i)){for(e=t.length;e--;)if(i>=k(t[e].options.index,t[e]._i)){t.splice(e+1,0,this);break}-1===e&&t.unshift(this),e+=1}else t.push(this);return k(e,t.length-1)},bindAxes:function(){var e,i=this,n=i.options,o=i.chart;c(i.axisTypes||[],function(r){c(o[r],function(t){e=t.options,(n[r]===e.index||void 0!==n[r]&&n[r]===e.id||void 0===n[r]&&0===e.index)&&(i.insert(t.series),i[r]=t,t.isDirty=!0)}),i[r]||i.optionalAxis===r||t.error(18,!0)})},updateParallelArrays:function(t,e){var i=t.series,n=arguments,o=m(e)?function(n){var o="y"===n&&i.toYData?i.toYData(t):t[n];i[n+"Data"][e]=o}:function(t){Array.prototype[e].apply(i[t+"Data"],Array.prototype.slice.call(n,2))};c(i.parallelArrays,o)},autoIncrement:function(){var e,i,n=this.options,o=this.xIncrement,r=n.pointIntervalUnit,a=0;return o=k(o,n.pointStart,0),this.pointInterval=i=k(this.pointInterval,n.pointInterval,1),r&&(e=new s(o),"day"===r?e=+e[s.hcSetDate](e[s.hcGetDate]()+i):"month"===r?e=+e[s.hcSetMonth](e[s.hcGetMonth]()+i):"year"===r&&(e=+e[s.hcSetFullYear](e[s.hcGetFullYear]()+i)),s.hcHasTimeZone&&(a=t.getTZOffset(e)-t.getTZOffset(o)),i=e-o+a),this.xIncrement=o+i,o},setOptions:function(t){var e,i,n=this.chart,o=n.options,r=o.plotOptions,s=n.userOptions||{},l=s.plotOptions||{},c=r[this.type];return this.userOptions=t,e=y(c,r.series,t),this.tooltipOptions=y(a.tooltip,a.plotOptions.series&&a.plotOptions.series.tooltip,a.plotOptions[this.type].tooltip,o.tooltip.userOptions,r.series&&r.series.tooltip,r[this.type].tooltip,t.tooltip),this.stickyTracking=k(t.stickyTracking,l[this.type]&&l[this.type].stickyTracking,l.series&&l.series.stickyTracking,this.tooltipOptions.shared&&!this.noSharedTooltip?!0:e.stickyTracking),null===c.marker&&delete e.marker,this.zoneAxis=e.zoneAxis,i=this.zones=(e.zones||[]).slice(),!e.negativeColor&&!e.negativeFillColor||e.zones||i.push({value:e[this.zoneAxis+"Threshold"]||e.threshold||0,className:"highcharts-negative",color:e.negativeColor,fillColor:e.negativeFillColor}),i.length&&h(i[i.length-1].value)&&i.push({color:this.color,fillColor:this.fillColor}),e},getCyclic:function(t,e,i){var n,o,r=this.chart,s=this.userOptions,a=t+"Index",l=t+"Counter",c=i?i.length:k(r.options.chart[t+"Count"],r[t+"Count"]);e||(o=k(s[a],s["_"+a]),h(o)?n=o:(r.series.length||(r[l]=0),s["_"+a]=n=r[l]%c,r[l]+=1),i&&(e=i[n])),void 0!==n&&(this[a]=n),this[t]=e},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||l[this.type].color,this.chart.options.colors)},getSymbol:function(){var t=this.options.marker;this.getCyclic("symbol",t.symbol,this.chart.options.symbols)},drawLegendSymbol:v.drawLineMarker,setData:function(e,i,n,o){var r,s,a,l=this,h=l.points,d=h&&h.length||0,p=l.options,u=l.chart,g=null,v=l.xAxis,y=p.turboThreshold,b=this.xData,M=this.yData,w=l.pointArrayMap,S=w&&w.length;if(e=e||[],r=e.length,i=k(i,!0),o!==!1&&r&&d===r&&!l.cropped&&!l.hasGroupedData&&l.visible)c(e,function(t,e){h[e].update&&t!==p.data[e]&&h[e].update(t,!1,null,!1)});else{if(l.xIncrement=null,l.colorCounter=0,c(this.parallelArrays,function(t){l[t+"Data"].length=0}),y&&r>y){for(s=0;null===g&&r>s;)g=e[s],s++;if(m(g))for(s=0;r>s;s++)b[s]=this.autoIncrement(),M[s]=e[s];else if(f(g))if(S)for(s=0;r>s;s++)a=e[s],b[s]=a[0],M[s]=a.slice(1,S+1);else for(s=0;r>s;s++)a=e[s],b[s]=a[0],M[s]=a[1];else t.error(12)}else for(s=0;r>s;s++)void 0!==e[s]&&(a={series:l},l.pointClass.prototype.applyOptions.apply(a,[e[s]]),l.updateParallelArrays(a,s));for(M&&x(M[0])&&t.error(14,!0),l.data=[],l.options.data=l.userOptions.data=e,s=d;s--;)h[s]&&h[s].destroy&&h[s].destroy();v&&(v.minRange=v.userMinRange),l.isDirty=u.isDirtyBox=!0,l.isDirtyData=!!h,n=!1}"point"===p.legendType&&(this.processData(),this.generatePoints()),i&&u.redraw(n)},processData:function(e){var i,n,o,r,s,a,l,h,c=this,d=c.xData,p=c.yData,u=d.length,g=0,f=c.xAxis,m=c.options,x=m.cropThreshold,v=c.getExtremesFromAll||m.getExtremesFromAll,y=c.isCartesian,b=f&&f.val2lin,k=f&&f.isLog,M=c.requireSorting;if(y&&!c.isDirty&&!f.isDirty&&!c.yAxis.isDirty&&!e)return!1;for(f&&(a=f.getExtremes(),l=a.min,h=a.max),y&&c.sorted&&!v&&(!x||u>x||c.forceCrop)&&(d[u-1]<l||d[0]>h?(d=[],p=[]):(d[0]<l||d[u-1]>h)&&(i=this.cropData(c.xData,c.yData,l,h),d=i.xData,p=i.yData,g=i.start,n=!0)),s=d.length||1;--s;)o=k?b(d[s])-b(d[s-1]):d[s]-d[s-1],o>0&&(void 0===r||r>o)?r=o:0>o&&M&&(t.error(15),M=!1);c.cropped=n,c.cropStart=g,c.processedXData=d,c.processedYData=p,c.closestPointRange=r},cropData:function(t,e,i,n){var o,r,s=t.length,a=0,l=s,h=k(this.cropShoulder,1);for(o=0;s>o;o++)if(t[o]>=i){a=Math.max(0,o-h);break}for(r=o;s>r;r++)if(t[r]>n){l=r+h;break}return{xData:t.slice(a,l),yData:e.slice(a,l),start:a,end:l}},generatePoints:function(){var t,e,i,n,o=this,r=o.options,s=r.data,a=o.data,l=o.processedXData,h=o.processedYData,c=o.pointClass,d=l.length,p=o.cropStart||0,u=o.hasGroupedData,g=r.keys,f=[];if(!a&&!u){var m=[];m.length=s.length,a=o.data=m}for(g&&u&&(o.options.keys=!1),n=0;d>n;n++)e=p+n,u?(i=(new c).init(o,[l[n]].concat(S(h[n]))),i.dataGroup=o.groupMap[n]):(i=a[e],i||void 0===s[e]||(a[e]=i=(new c).init(o,s[e],l[n]))),i&&(i.index=e,f[n]=i);if(o.options.keys=g,a&&(d!==(t=a.length)||u))for(n=0;t>n;n++)n!==p||u||(n+=d),a[n]&&(a[n].destroyElements(),a[n].plotX=void 0);o.data=a,o.points=f},getExtremes:function(t){var e,i,r,s,a,l,h,c=this.xAxis,d=this.yAxis,p=this.processedXData,u=[],g=0,x=c.getExtremes(),v=x.min,y=x.max;for(t=t||this.stackedYData||this.processedYData||[],e=t.length,l=0;e>l;l++)if(s=p[l],a=t[l],i=(m(a,!0)||f(a))&&(!d.positiveValuesOnly||a.length||a>0),r=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(p[l+1]||s)>=v&&(p[l-1]||s)<=y,i&&r)if(h=a.length)for(;h--;)"number"==typeof a[h]&&(u[g++]=a[h]);else u[g++]=a;this.dataMin=o(u),this.dataMax=n(u)},translate:function(){this.processedXData||this.processData(),this.generatePoints();var t,e,i,n,o,s=this,a=s.options,l=a.stacking,c=s.xAxis,d=c.categories,p=s.yAxis,u=s.points,g=u.length,f=!!s.modifyValue,x=a.pointPlacement,v="between"===x||m(x),y=a.threshold,b=a.startFromThreshold?y:0,M=Number.MAX_VALUE;for("between"===x&&(x=.5),m(x)&&(x*=k(a.pointRange||c.pointRange)),t=0;g>t;t++){var w,S,A=u[t],T=A.x,P=A.y,C=A.low,L=l&&p.stacks[(s.negStacks&&(b?0:y)>P?"-":"")+s.stackKey];p.positiveValuesOnly&&null!==P&&0>=P&&(A.isNull=!0),A.plotX=e=r(Math.min(Math.max(-1e5,c.translate(T,0,0,0,1,x,"flags"===this.type)),1e5)),l&&s.visible&&!A.isNull&&L&&L[T]&&(o=s.getStackIndicator(o,T,s.index),w=L[T],S=w.points[o.key],C=S[0],P=S[1],C===b&&o.key===L[T].base&&(C=k(y,p.min)),p.positiveValuesOnly&&0>=C&&(C=null),A.total=A.stackTotal=w.total,A.percentage=w.total&&A.y/w.total*100,A.stackY=P,w.setOffset(s.pointXOffset||0,s.barW||0)),A.yBottom=h(C)?p.translate(C,0,1,0,1):null,f&&(P=s.modifyValue(P,A)),A.plotY=i="number"==typeof P&&1/0!==P?Math.min(Math.max(-1e5,p.translate(P,0,1,0,1)),1e5):void 0,A.isInside=void 0!==i&&i>=0&&i<=p.len&&e>=0&&e<=c.len,A.clientX=v?r(c.translate(T,0,0,0,1,x)):e,A.negative=A.y<(y||0),A.category=d&&void 0!==d[A.x]?d[A.x]:A.x,A.isNull||(void 0!==n&&(M=Math.min(M,Math.abs(e-n))),n=e),A.zone=this.zones.length&&A.getZone()}s.closestPointRangePx=M},getValidPoints:function(t,e){var i=this.chart;return g(t||this.points||[],function(t){return e&&!i.isInsidePlot(t.plotX,t.plotY,i.inverted)?!1:!t.isNull})},setClip:function(t){var e=this.chart,i=this.options,n=e.renderer,o=e.inverted,r=this.clipBox,s=r||e.clipBox,a=this.sharedClipKey||["_sharedClip",t&&t.duration,t&&t.easing,s.height,i.xAxis,i.yAxis].join(","),l=e[a],h=e[a+"m"];l||(t&&(s.width=0,o&&(s.x=e.plotSizeX),e[a+"m"]=h=n.clipRect(o?e.plotSizeX+99:-99,o?-e.plotLeft:-e.plotTop,99,o?e.chartWidth:e.chartHeight)),e[a]=l=n.clipRect(s),l.count={length:0}),t&&(l.count[this.index]||(l.count[this.index]=!0,l.count.length+=1)),i.clip!==!1&&(this.group.clip(t||r?l:e.clipRect),this.markerGroup.clip(h),this.sharedClipKey=a),t||(l.count[this.index]&&(delete l.count[this.index],l.count.length-=1),0===l.count.length&&a&&e[a]&&(r||(e[a]=e[a].destroy()),e[a+"m"]&&(e[a+"m"]=e[a+"m"].destroy())))},animate:function(t){var e,n,o=this,r=o.chart,s=i(o.options.animation);t?o.setClip(s):(n=this.sharedClipKey,e=r[n],e&&e.animate({width:r.plotSizeX,x:0},s),r[n+"m"]&&r[n+"m"].animate({width:r.plotSizeX+99,x:0},s),o.animate=null)},afterAnimate:function(){this.setClip(),u(this,"afterAnimate"),this.finishedAnimating=!0},drawPoints:function(){var t,e,i,n,o,r,s,a,l,h=this,c=h.points,d=h.chart,p=h.options,u=p.marker,g=h[h.specialGroup]||h.markerGroup,f=h.xAxis,m=k(u.enabled,f.isRadial?!0:null,h.closestPointRangePx>=2*u.radius);if(u.enabled!==!1||h._hasPointMarkers)for(t=0;t<c.length;t++)e=c[t],n=e.graphic,o=e.marker||{},r=!!e.marker,s=m&&void 0===o.enabled||o.enabled,a=e.isInside,s&&!e.isNull?(i=k(o.symbol,h.symbol),e.hasImage=0===i.indexOf("url"),l=h.markerAttribs(e,e.selected&&"select"),n?n[a?"show":"hide"](!0).animate(l):a&&(l.width>0||e.hasImage)&&(e.graphic=n=d.renderer.symbol(i,l.x,l.y,l.width,l.height,r?o:u).add(g)),n&&n.attr(h.pointAttribs(e,e.selected&&"select")),n&&n.addClass(e.getClassName(),!0)):n&&(e.graphic=n.destroy())},markerAttribs:function(t,e){var i,n,o,r=this.options.marker,s=t.marker||{},a=k(s.radius,r.radius);return e&&(i=r.states[e],n=s.states&&s.states[e],a=k(n&&n.radius,i&&i.radius,a+(i&&i.radiusPlus||0))),t.hasImage&&(a=0),o={x:Math.floor(t.plotX)-a,y:t.plotY-a},a&&(o.width=o.height=2*a),o},pointAttribs:function(t,e){var i,n,o,r,s=this.options.marker,a=t&&t.options,l=a&&a.marker||{},h=this.color,c=a&&a.color,d=t&&t.color,p=k(l.lineWidth,s.lineWidth),u=t&&t.zone&&t.zone.color;return h=c||u||d||h,o=l.fillColor||s.fillColor||h,r=l.lineColor||s.lineColor||h,e&&(i=s.states[e],n=l.states&&l.states[e]||{},p=k(n.lineWidth,i.lineWidth,p+k(n.lineWidthPlus,i.lineWidthPlus,0)),o=n.fillColor||i.fillColor||o,r=n.lineColor||i.lineColor||r),{stroke:r,"stroke-width":p,fill:o}},destroy:function(){var t,e,i,n,o=this,r=o.chart,s=/AppleWebKit\/533/.test(P.navigator.userAgent),a=o.data||[];for(u(o,"destroy"),w(o),c(o.axisTypes||[],function(t){n=o[t],n&&n.series&&(d(n.series,o),n.isDirty=n.forceRedraw=!0)}),o.legendItem&&o.chart.legend.destroyItem(o),e=a.length;e--;)i=a[e],i&&i.destroy&&i.destroy();o.points=null,clearTimeout(o.animationTimeout),b(o,function(e,i){e instanceof A&&!e.survive&&(t=s&&"group"===i?"hide":"destroy",e[t]())}),r.hoverSeries===o&&(r.hoverSeries=null),d(r.series,o),r.orderSeries(),b(o,function(t,e){delete o[e]})},getGraphPath:function(t,e,i){var n,o,r=this,s=r.options,a=s.step,l=[],d=[];return t=t||r.points,n=t.reversed,n&&t.reverse(),a={right:1,center:2}[a]||a&&3,a&&n&&(a=4-a),!s.connectNulls||e||i||(t=this.getValidPoints(t)),c(t,function(n,c){var p,u=n.plotX,g=n.plotY,f=t[c-1];(n.leftCliff||f&&f.rightCliff)&&!i&&(o=!0),n.isNull&&!h(e)&&c>0?o=!s.connectNulls:n.isNull&&!e?o=!0:(0===c||o?p=["M",n.plotX,n.plotY]:r.getPointSpline?p=r.getPointSpline(t,n,c):a?(p=1===a?["L",f.plotX,g]:2===a?["L",(f.plotX+u)/2,f.plotY,"L",(f.plotX+u)/2,g]:["L",u,f.plotY],p.push("L",u,g)):p=["L",u,g],d.push(n.x),a&&d.push(n.x),l.push.apply(l,p),o=!1)}),l.xMap=d,r.graphPath=l,l},drawGraph:function(){var t=this,e=this.options,i=(this.gappedPath||this.getGraphPath).call(this),n=[["graph","highcharts-graph",e.lineColor||this.color,e.dashStyle]];c(this.zones,function(i,o){n.push(["zone-graph-"+o,"highcharts-graph highcharts-zone-graph-"+o+" "+(i.className||""),i.color||t.color,i.dashStyle||e.dashStyle])}),c(n,function(n,o){var r,s=n[0],a=t[s];a?(a.endX=t.preventGraphAnimation?null:i.xMap,a.animate({d:i})):i.length&&(t[s]=t.chart.renderer.path(i).addClass(n[1]).attr({zIndex:1}).add(t.group),r={stroke:n[2],"stroke-width":e.lineWidth,fill:t.fillGraph&&t.color||"none"},n[3]?r.dashstyle=n[3]:"square"!==e.linecap&&(r["stroke-linecap"]=r["stroke-linejoin"]="round"),a=t[s].attr(r).shadow(2>o&&e.shadow)),a&&(a.startX=i.xMap,a.isArea=i.isArea)})},applyZones:function(){var t,e,i,n,o,r,s,a,l,h=this,d=this.chart,p=d.renderer,u=this.zones,g=this.clips||[],f=this.graph,m=this.area,x=Math.max(d.chartWidth,d.chartHeight),v=this[(this.zoneAxis||"y")+"Axis"],y=d.inverted,b=!1;u.length&&(f||m)&&v&&void 0!==v.min&&(o=v.reversed,r=v.horiz,f&&f.hide(),m&&m.hide(),n=v.getExtremes(),c(u,function(c,u){t=o?r?d.plotWidth:0:r?0:v.toPixels(n.min),t=Math.min(Math.max(k(e,t),0),x),e=Math.min(Math.max(Math.round(v.toPixels(k(c.value,n.max),!0)),0),x),b&&(t=e=v.toPixels(n.max)),s=Math.abs(t-e),a=Math.min(t,e),l=Math.max(t,e),v.isXAxis?(i={x:y?l:a,y:0,width:s,height:x},r||(i.x=d.plotHeight-i.x)):(i={x:0,y:y?l:a,width:x,height:s},r&&(i.y=d.plotWidth-i.y)),y&&p.isVML&&(i=v.isXAxis?{x:0,y:o?a:l,height:i.width,width:d.chartWidth}:{x:i.y-d.plotLeft-d.spacingBox.x,y:0,width:i.height,height:d.chartHeight}),g[u]?g[u].animate(i):(g[u]=p.clipRect(i),f&&h["zone-graph-"+u].clip(g[u]),m&&h["zone-area-"+u].clip(g[u])),b=c.value>n.max}),this.clips=g)},invertGroups:function(t){function i(){c(["group","markerGroup"],function(e){o[e]&&(r.renderer.isVML&&o[e].attr({width:o.yAxis.len,height:o.xAxis.len}),o[e].width=o.yAxis.len,o[e].height=o.xAxis.len,o[e].invert(t))})}var n,o=this,r=o.chart;o.xAxis&&(n=e(r,"resize",i),e(o,"destroy",n),i(t),o.invertGroups=i)},plotGroup:function(t,e,i,n,o){var r=this[t],s=!r;return s&&(this[t]=r=this.chart.renderer.g().attr({zIndex:n||.1}).add(o)),r.addClass("highcharts-"+e+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(h(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(r.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),r.attr({visibility:i})[s?"attr":"animate"](this.getPlotBox()),r},getPlotBox:function(){var t=this.chart,e=this.xAxis,i=this.yAxis;return t.inverted&&(e=i,i=this.xAxis),{translateX:e?e.left:t.plotLeft,translateY:i?i.top:t.plotTop,scaleX:1,scaleY:1}},render:function(){var t,e=this,n=e.chart,o=e.options,r=!!e.animate&&n.renderer.isSVG&&i(o.animation).duration,s=e.visible?"inherit":"hidden",a=o.zIndex,l=e.hasRendered,h=n.seriesGroup,c=n.inverted;t=e.plotGroup("group","series",s,a,h),e.markerGroup=e.plotGroup("markerGroup","markers",s,a,h),r&&e.animate(!0),t.inverted=e.isCartesian?c:!1,e.drawGraph&&(e.drawGraph(),e.applyZones()),e.drawDataLabels&&e.drawDataLabels(),e.visible&&e.drawPoints(),e.drawTracker&&e.options.enableMouseTracking!==!1&&e.drawTracker(),e.invertGroups(c),o.clip===!1||e.sharedClipKey||l||t.clip(n.clipRect),r&&e.animate(),l||(e.animationTimeout=T(function(){e.afterAnimate()},r)),e.isDirty=!1,e.hasRendered=!0},redraw:function(){var t=this,e=t.chart,i=t.isDirty||t.isDirtyData,n=t.group,o=t.xAxis,r=t.yAxis;n&&(e.inverted&&n.attr({width:e.plotWidth,height:e.plotHeight}),n.animate({translateX:k(o&&o.left,e.plotLeft),translateY:k(r&&r.top,e.plotTop)})),t.translate(),t.render(),i&&delete this.kdTree},kdAxisArray:["clientX","plotY"],searchPoint:function(t,e){var i=this,n=i.xAxis,o=i.yAxis,r=i.chart.inverted;return this.searchKDTree({clientX:r?n.len-t.chartY+n.pos:t.chartX-n.pos,plotY:r?o.len-t.chartX+o.pos:t.chartY-o.pos},e)},buildKDTree:function(){function t(e,n,o){var r,s,a=e&&e.length;return a?(r=i.kdAxisArray[n%o],e.sort(function(t,e){return t[r]-e[r]}),s=Math.floor(a/2),{point:e[s],left:t(e.slice(0,s),n+1,o),right:t(e.slice(s+1),n+1,o)}):void 0}function e(){i.kdTree=t(i.getValidPoints(null,!i.directTouch),n,n),i.buildingKdTree=!1}this.buildingKdTree=!0;var i=this,n=i.options.findNearestPointBy.indexOf("y")>-1?2:1;delete i.kdTree,T(e,i.options.kdNow?0:1)},searchKDTree:function(t,e){function i(t,e){var i=h(t[r])&&h(e[r])?Math.pow(t[r]-e[r],2):null,n=h(t[s])&&h(e[s])?Math.pow(t[s]-e[s],2):null,o=(i||0)+(n||0);e.dist=h(o)?Math.sqrt(o):Number.MAX_VALUE,e.distX=h(i)?Math.sqrt(i):Number.MAX_VALUE}function n(t,e,r,s){var l,h,c,d,p,u=e.point,g=o.kdAxisArray[r%s],f=u;return i(t,u),l=t[g]-u[g],h=0>l?"left":"right",c=0>l?"right":"left",e[h]&&(d=n(t,e[h],r+1,s),f=d[a]<f[a]?d:u),e[c]&&Math.sqrt(l*l)<f[a]&&(p=n(t,e[c],r+1,s),f=p[a]<f[a]?p:f),f}var o=this,r=this.kdAxisArray[0],s=this.kdAxisArray[1],a=e?"distX":"dist",l=o.options.findNearestPointBy.indexOf("y")>-1?2:1;return this.kdTree||this.buildingKdTree||this.buildKDTree(),this.kdTree?n(t,this.kdTree,l,l):void 0}})}(e),function(t){var e=t.Axis,i=t.Chart,n=t.correctFloat,o=t.defined,r=t.destroyObjectProperties,s=t.each,a=t.format,l=t.objectEach,h=t.pick,c=t.Series;t.StackItem=function(t,e,i,n,o){var r=t.chart.inverted;this.axis=t,this.isNegative=i,this.options=e,this.x=n,this.total=null,this.points={},this.stack=o,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:e.align||(r?i?"left":"right":"center"),verticalAlign:e.verticalAlign||(r?"middle":i?"bottom":"top"),y:h(e.y,r?4:i?14:-6),x:h(e.x,r?i?-6:6:0)},this.textAlign=e.textAlign||(r?i?"right":"left":"center")},t.StackItem.prototype={destroy:function(){r(this,this.axis)},render:function(t){var e=this.options,i=e.format,n=i?a(i,this):e.formatter.call(this);this.label?this.label.attr({text:n,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(n,null,null,e.useHTML).css(e.style).attr({align:this.textAlign,rotation:e.rotation,visibility:"hidden"}).add(t)},setOffset:function(t,e){var i,n=this,o=n.axis,r=o.chart,s=o.translate(o.usePercentage?100:n.total,0,0,0,1),a=o.translate(0),l=Math.abs(s-a),h=r.xAxis[0].translate(n.x)+t,c=n.getStackBox(r,n,h,s,e,l),d=n.label;d&&(d.align(n.alignOptions,null,c),i=d.alignAttr,d[n.options.crop===!1||r.isInsidePlot(i.x,i.y)?"show":"hide"](!0))},getStackBox:function(t,e,i,n,o,r){var s=e.axis.reversed,a=t.inverted,l=t.plotHeight,h=e.isNegative&&!s||!e.isNegative&&s;return{x:a?h?n:n-r:i,y:a?l-i-o:h?l-n-r:l-n,width:a?r:o,height:a?o:r}}},i.prototype.getStacks=function(){var t=this;s(t.yAxis,function(t){t.stacks&&t.hasVisibleSeries&&(t.oldStacks=t.stacks)}),s(t.series,function(e){!e.options.stacking||e.visible!==!0&&t.options.chart.ignoreHiddenSeries!==!1||(e.stackKey=e.type+h(e.options.stack,""))})},e.prototype.buildStacks=function(){var t,e=this.series,i=h(this.options.reversedStacks,!0),n=e.length;if(!this.isXAxis){for(this.usePercentage=!1,t=n;t--;)e[i?t:n-t-1].setStackedPoints();for(t=0;n>t;t++)e[t].modifyStacks()}},e.prototype.renderStackTotals=function(){var t=this,e=t.chart,i=e.renderer,n=t.stacks,o=t.stackTotalGroup;o||(t.stackTotalGroup=o=i.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),o.translate(e.plotLeft,e.plotTop),l(n,function(t){l(t,function(t){t.render(o)})})},e.prototype.resetStacks=function(){var t=this,e=t.stacks;t.isXAxis||l(e,function(e){l(e,function(i,n){i.touched<t.stacksTouched?(i.destroy(),delete e[n]):(i.total=null,i.cumulative=null)})})},e.prototype.cleanStacks=function(){var t;this.isXAxis||(this.oldStacks&&(t=this.stacks=this.oldStacks),l(t,function(t){l(t,function(t){t.cumulative=t.total})}))},c.prototype.setStackedPoints=function(){if(this.options.stacking&&(this.visible===!0||this.chart.options.chart.ignoreHiddenSeries===!1)){var e,i,r,s,a,l,c,d,p,u=this,g=u.processedXData,f=u.processedYData,m=[],x=f.length,v=u.options,y=v.threshold,b=h(v.startFromThreshold&&y,0),k=v.stack,M=v.stacking,w=u.stackKey,S="-"+w,A=u.negStacks,T=u.yAxis,P=T.stacks,C=T.oldStacks;for(T.stacksTouched+=1,c=0;x>c;c++)d=g[c],p=f[c],e=u.getStackIndicator(e,d,u.index),l=e.key,i=A&&(b?0:y)>p,a=i?S:w,P[a]||(P[a]={}),P[a][d]||(C[a]&&C[a][d]?(P[a][d]=C[a][d],P[a][d].total=null):P[a][d]=new t.StackItem(T,T.options.stackLabels,i,d,k)),r=P[a][d],null!==p?(r.points[l]=r.points[u.index]=[h(r.cumulative,b)],o(r.cumulative)||(r.base=l),r.touched=T.stacksTouched,e.index>0&&u.singleStacks===!1&&(r.points[l][0]=r.points[u.index+","+d+",0"][0])):r.points[l]=r.points[u.index]=null,"percent"===M?(s=i?w:S,A&&P[s]&&P[s][d]?(s=P[s][d],r.total=s.total=Math.max(s.total,r.total)+Math.abs(p)||0):r.total=n(r.total+(Math.abs(p)||0))):r.total=n(r.total+(p||0)),r.cumulative=h(r.cumulative,b)+(p||0),null!==p&&(r.points[l].push(r.cumulative),m[c]=r.cumulative);"percent"===M&&(T.usePercentage=!0),this.stackedYData=m,T.oldStacks={}}},c.prototype.modifyStacks=function(){var t,e=this,i=e.stackKey,n=e.yAxis.stacks,o=e.processedXData,r=e.options.stacking;e[r+"Stacker"]&&s([i,"-"+i],function(i){for(var s,a,l,h=o.length;h--;)s=o[h],t=e.getStackIndicator(t,s,e.index,i),a=n[i]&&n[i][s],l=a&&a.points[t.key],l&&e[r+"Stacker"](l,a,h)})},c.prototype.percentStacker=function(t,e,i){var o=e.total?100/e.total:0;t[0]=n(t[0]*o),t[1]=n(t[1]*o),this.stackedYData[i]=t[1]},c.prototype.getStackIndicator=function(t,e,i,n){return!o(t)||t.x!==e||n&&t.key!==n?t={x:e,index:0,key:n}:t.index++,t.key=[i,e,t.index].join(","),t}}(e),function(t){var e=t.addEvent,i=t.animate,n=t.Axis,o=t.Chart,r=t.createElement,s=t.css,a=t.defined,l=t.each,h=t.erase,c=t.extend,d=t.fireEvent,p=t.inArray,u=t.isNumber,g=t.isObject,f=t.isArray,m=t.merge,x=t.objectEach,v=t.pick,y=t.Point,b=t.Series,k=t.seriesTypes,M=t.setAnimation,w=t.splat;c(o.prototype,{addSeries:function(t,e,i){var n,o=this;return t&&(e=v(e,!0),d(o,"addSeries",{options:t},function(){n=o.initSeries(t),o.isDirtyLegend=!0,o.linkSeries(),e&&o.redraw(i)})),n},addAxis:function(t,e,i,o){var r,s=e?"xAxis":"yAxis",a=this.options,l=m(t,{index:this[s].length,isX:e});return r=new n(this,l),a[s]=w(a[s]||{}),a[s].push(l),v(i,!0)&&this.redraw(o),r},showLoading:function(t){var n=this,o=n.options,a=n.loadingDiv,l=o.loading,h=function(){a&&s(a,{left:n.plotLeft+"px",top:n.plotTop+"px",width:n.plotWidth+"px",height:n.plotHeight+"px"})};a||(n.loadingDiv=a=r("div",{className:"highcharts-loading highcharts-loading-hidden"},null,n.container),n.loadingSpan=r("span",{className:"highcharts-loading-inner"},null,a),e(n,"redraw",h)),a.className="highcharts-loading",n.loadingSpan.innerHTML=t||o.lang.loading,s(a,c(l.style,{zIndex:10})),s(n.loadingSpan,l.labelStyle),n.loadingShown||(s(a,{opacity:0,display:""}),i(a,{opacity:l.style.opacity||.5},{duration:l.showDuration||0})),n.loadingShown=!0,h()},hideLoading:function(){var t=this.options,e=this.loadingDiv;e&&(e.className="highcharts-loading highcharts-loading-hidden",i(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){s(e,{display:"none"})}})),this.loadingShown=!1},propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","tooltip"],update:function(t,e,i){var n,o,r,s,h=this,c={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle"},d=t.chart,g=[];d&&(m(!0,h.options.chart,d),"className"in d&&h.setClassName(d.className),("inverted"in d||"polar"in d)&&(h.propFromSeries(),n=!0),"alignTicks"in d&&(n=!0),x(d,function(t,e){-1!==p("chart."+e,h.propsRequireUpdateSeries)&&(o=!0),-1!==p(e,h.propsRequireDirtyBox)&&(h.isDirtyBox=!0)}),"style"in d&&h.renderer.setStyle(d.style)),t.colors&&(this.options.colors=t.colors),t.plotOptions&&m(!0,this.options.plotOptions,t.plotOptions),x(t,function(t,e){h[e]&&"function"==typeof h[e].update?h[e].update(t,!1):"function"==typeof h[c[e]]&&h[c[e]](t),"chart"!==e&&-1!==p(e,h.propsRequireUpdateSeries)&&(o=!0)}),l(["xAxis","yAxis","zAxis","series","colorAxis","pane"],function(e){t[e]&&(l(w(t[e]),function(t,n){var o=a(t.id)&&h.get(t.id)||h[e][n];o&&o.coll===e&&(o.update(t,!1),i&&(o.touched=!0)),!o&&i&&("series"===e?h.addSeries(t,!1).touched=!0:("xAxis"===e||"yAxis"===e)&&(h.addAxis(t,"xAxis"===e,!1).touched=!0))}),i&&l(h[e],function(t){t.touched?delete t.touched:g.push(t)}))}),l(g,function(t){t.remove(!1)}),n&&l(h.axes,function(t){t.update({},!1)}),o&&l(h.series,function(t){t.update({},!1)}),t.loading&&m(!0,h.options.loading,t.loading),r=d&&d.width,s=d&&d.height,u(r)&&r!==h.chartWidth||u(s)&&s!==h.chartHeight?h.setSize(r,s):v(e,!0)&&h.redraw()},setSubtitle:function(t){this.setTitle(void 0,t)}}),c(y.prototype,{update:function(t,e,i,n){function o(){s.applyOptions(t),null===s.y&&l&&(s.graphic=l.destroy()),g(t,!0)&&(l&&l.element&&t&&t.marker&&void 0!==t.marker.symbol&&(s.graphic=l.destroy()),t&&t.dataLabels&&s.dataLabel&&(s.dataLabel=s.dataLabel.destroy()),s.connector&&(s.connector=s.connector.destroy())),r=s.index,a.updateParallelArrays(s,r),c.data[r]=g(c.data[r],!0)||g(t,!0)?s.options:t,a.isDirty=a.isDirtyData=!0,!a.fixedBox&&a.hasCartesianSeries&&(h.isDirtyBox=!0),"point"===c.legendType&&(h.isDirtyLegend=!0),e&&h.redraw(i)}var r,s=this,a=s.series,l=s.graphic,h=a.chart,c=a.options;e=v(e,!0),n===!1?o():s.firePointEvent("update",{options:t},o)},remove:function(t,e){this.series.removePoint(p(this,this.series.data),t,e)}}),c(b.prototype,{addPoint:function(t,e,i,n){var o,r,s,a,l=this,h=l.options,c=l.data,d=l.chart,p=l.xAxis,u=p&&p.hasNames&&p.names,g=h.data,f=l.xData;if(e=v(e,!0),o={series:l},l.pointClass.prototype.applyOptions.apply(o,[t]),a=o.x,s=f.length,l.requireSorting&&a<f[s-1])for(r=!0;s&&f[s-1]>a;)s--;l.updateParallelArrays(o,"splice",s,0,0),l.updateParallelArrays(o,s),u&&o.name&&(u[a]=o.name),g.splice(s,0,t),r&&(l.data.splice(s,0,null),l.processData()),"point"===h.legendType&&l.generatePoints(),i&&(c[0]&&c[0].remove?c[0].remove(!1):(c.shift(),l.updateParallelArrays(o,"shift"),g.shift())),l.isDirty=!0,l.isDirtyData=!0,e&&d.redraw(n)},removePoint:function(t,e,i){var n=this,o=n.data,r=o[t],s=n.points,a=n.chart,l=function(){s&&s.length===o.length&&s.splice(t,1),o.splice(t,1),n.options.data.splice(t,1),n.updateParallelArrays(r||{series:n},"splice",t,1),r&&r.destroy(),n.isDirty=!0,n.isDirtyData=!0,e&&a.redraw()};M(i,a),e=v(e,!0),r?r.firePointEvent("remove",null,l):l()},remove:function(t,e,i){function n(){o.destroy(),r.isDirtyLegend=r.isDirtyBox=!0,r.linkSeries(),v(t,!0)&&r.redraw(e)}var o=this,r=o.chart;i!==!1?d(o,"remove",null,n):n()},update:function(t,e){var i,n=this,o=n.chart,r=n.userOptions,s=n.oldType||n.type,a=t.type||r.type||o.options.chart.type,h=k[s].prototype,d=["group","markerGroup","dataLabelsGroup"],p=["navigatorSeries","baseSeries"],u=n.finishedAnimating&&{animation:!1};if(Object.keys&&"data"===Object.keys(t).toString())return this.setData(t.data,e);p=d.concat(p),l(p,function(t){p[t]=n[t],delete n[t]}),t=m(r,u,{index:n.index,pointStart:n.xData[0]},{data:n.options.data},t),n.remove(!1,null,!1);for(i in h)n[i]=void 0;c(n,k[a||s].prototype),l(p,function(t){n[t]=p[t]}),n.init(o,t),t.zIndex!==r.zIndex&&l(d,function(e){n[e]&&n[e].attr({zIndex:t.zIndex})}),n.oldType=s,o.linkSeries(),v(e,!0)&&o.redraw(!1)}}),c(n.prototype,{update:function(t,e){var i=this.chart;t=i.options[this.coll][this.options.index]=m(this.userOptions,t),this.destroy(!0),this.init(i,c(t,{events:void 0})),i.isDirtyBox=!0,v(e,!0)&&i.redraw()},remove:function(t){for(var e=this.chart,i=this.coll,n=this.series,o=n.length;o--;)n[o]&&n[o].remove(!1);h(e.axes,this),h(e[i],this),f(e.options[i])?e.options[i].splice(this.options.index,1):delete e.options[i],l(e[i],function(t,e){t.options.index=e}),this.destroy(),e.isDirtyBox=!0,v(t,!0)&&e.redraw()},setTitle:function(t,e){this.update({title:t},e)},setCategories:function(t,e){this.update({categories:t},e)}})}(e),function(t){var e=t.color,i=t.each,n=t.LegendSymbolMixin,o=t.map,r=t.pick,s=t.Series,a=t.seriesType;a("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(e){var n,s,a=this,l=[],h=[],c=this.xAxis,d=this.yAxis,p=d.stacks[this.stackKey],u={},g=a.index,f=d.series,m=f.length,x=r(d.options.reversedStacks,!0)?1:-1;if(e=e||this.points,this.options.stacking){for(s=0;s<e.length;s++)e[s].leftNull=e[s].rightNull=null,u[e[s].x]=e[s];t.objectEach(p,function(t,e){null!==t.total&&h.push(e)}),h.sort(function(t,e){return t-e}),n=o(f,function(){return this.visible}),i(h,function(t,e){var o,r,a=0;if(u[t]&&!u[t].isNull)l.push(u[t]),i([-1,1],function(i){var a=1===i?"rightNull":"leftNull",l=1===i?"rightCliff":"leftCliff",c=0,d=p[h[e+i]];if(d)for(s=g;s>=0&&m>s;)o=d.points[s],o||(s===g?u[t][a]=!0:n[s]&&(r=p[t].points[s],r&&(c-=r[1]-r[0]))),s+=x;u[t][l]=c});else{for(s=g;s>=0&&m>s;){if(o=p[t].points[s]){a=o[1];break}s+=x}a=d.translate(a,0,1,0,1),l.push({isNull:!0,plotX:c.translate(t,0,0,0,1),x:t,plotY:a,yBottom:a})}})}return l},getGraphPath:function(t){var e,i,n,o,a,l,h,c,d=s.prototype.getGraphPath,p=this.options,u=p.stacking,g=this.yAxis,f=[],m=[],x=this.index,v=g.stacks[this.stackKey],y=p.threshold,b=g.getThreshold(p.threshold),k=p.connectNulls||"percent"===u,M=function(e,i,n){var o,r,s=t[e],a=u&&v[s.x].points[x],h=s[n+"Null"]||0,c=s[n+"Cliff"]||0,d=!0;c||h?(o=(h?a[0]:a[1])+c,r=a[0]+c,d=!!h):!u&&t[i]&&t[i].isNull&&(o=r=y),void 0!==o&&(m.push({plotX:l,plotY:null===o?b:g.getThreshold(o),isNull:d,isCliff:!0}),f.push({plotX:l,plotY:null===r?b:g.getThreshold(r),doCurve:!1}))};for(t=t||this.points,u&&(t=this.getStackPoints(t)),o=0;o<t.length;o++)h=t[o].isNull,l=r(t[o].rectPlotX,t[o].plotX),c=r(t[o].yBottom,b),(!h||k)&&(k||M(o,o-1,"left"),h&&!u&&k||(m.push(t[o]),f.push({x:o,plotX:l,plotY:c})),k||M(o,o+1,"right"));return i=d.call(this,m,!0,!0),f.reversed=!0,n=d.call(this,f,!0,!0),n.length&&(n[0]="L"),a=i.concat(n),e=d.call(this,m,!1,k),a.xMap=i.xMap,this.areaPath=a,e},drawGraph:function(){this.areaPath=[],s.prototype.drawGraph.apply(this);var t=this,n=this.areaPath,o=this.options,a=this.zones,l=[["area","highcharts-area",this.color,o.fillColor]];i(a,function(e,i){l.push(["zone-area-"+i,"highcharts-area highcharts-zone-area-"+i+" "+e.className,e.color||t.color,e.fillColor||o.fillColor])}),i(l,function(i){var s=i[0],a=t[s];a?(a.endX=t.preventGraphAnimation?null:n.xMap,a.animate({d:n})):(a=t[s]=t.chart.renderer.path(n).addClass(i[1]).attr({fill:r(i[3],e(i[2]).setOpacity(r(o.fillOpacity,.75)).get()),zIndex:0}).add(t.group),a.isArea=!0),a.startX=n.xMap,a.shiftUnit=o.step?2:1})},drawLegendSymbol:n.drawRectangle})}(e),function(t){var e=t.pick,i=t.seriesType;i("spline","line",{},{getPointSpline:function(t,i,n){function o(t){return t&&!t.isNull&&t.doCurve!==!1&&!i.isCliff}var r,s,a,l,h,c=1.5,d=c+1,p=i.plotX,u=i.plotY,g=t[n-1],f=t[n+1];if(o(g)&&o(f)){var m=g.plotX,x=g.plotY,v=f.plotX,y=f.plotY,b=0;r=(c*p+m)/d,s=(c*u+x)/d,a=(c*p+v)/d,l=(c*u+y)/d,a!==r&&(b=(l-s)*(a-p)/(a-r)+u-l),s+=b,l+=b,s>x&&s>u?(s=Math.max(x,u),l=2*u-s):x>s&&u>s&&(s=Math.min(x,u),l=2*u-s),l>y&&l>u?(l=Math.max(y,u),s=2*u-l):y>l&&u>l&&(l=Math.min(y,u),s=2*u-l),i.rightContX=a,i.rightContY=l}return h=["C",e(g.rightContX,g.plotX),e(g.rightContY,g.plotY),e(r,p),e(s,u),p,u],g.rightContX=g.rightContY=null,h}})}(e),function(t){var e=t.seriesTypes.area.prototype,i=t.defaultPlotOptions,n=t.LegendSymbolMixin,o=t.seriesType;o("areaspline","spline",i.area,{getStackPoints:e.getStackPoints,getGraphPath:e.getGraphPath,drawGraph:e.drawGraph,drawLegendSymbol:n.drawRectangle})}(e),function(t){var e=t.animObject,i=t.color,n=t.each,o=t.extend,r=t.isNumber,s=t.LegendSymbolMixin,a=t.merge,l=t.noop,h=t.pick,c=t.Series,d=t.seriesType,p=t.svg;d("column","line",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){c.prototype.init.apply(this,arguments);var t=this,e=t.chart;e.hasRendered&&n(e.series,function(e){e.type===t.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var t,e=this,i=e.options,o=e.xAxis,r=e.yAxis,s=o.reversed,a={},l=0;i.grouping===!1?l=1:n(e.chart.series,function(i){var n,o=i.options,s=i.yAxis;i.type!==e.type||!i.visible&&e.chart.options.chart.ignoreHiddenSeries||r.len!==s.len||r.pos!==s.pos||(o.stacking?(t=i.stackKey,void 0===a[t]&&(a[t]=l++),n=a[t]):o.grouping!==!1&&(n=l++),i.columnIndex=n)});var c=Math.min(Math.abs(o.transA)*(o.ordinalSlope||i.pointRange||o.closestPointRange||o.tickInterval||1),o.len),d=c*i.groupPadding,p=c-2*d,u=p/(l||1),g=Math.min(i.maxPointWidth||o.len,h(i.pointWidth,u*(1-2*i.pointPadding))),f=(u-g)/2,m=(e.columnIndex||0)+(s?1:0),x=f+(d+m*u-c/2)*(s?-1:1);return e.columnMetrics={width:g,offset:x},e.columnMetrics},crispCol:function(t,e,i,n){var o,r,s,a=this.chart,l=this.borderWidth,h=-(l%2?.5:0),c=l%2?.5:1;return a.inverted&&a.renderer.isVML&&(c+=1),this.options.crisp&&(o=Math.round(t+i)+h,t=Math.round(t)+h,i=o-t),r=Math.round(e+n)+c,s=Math.abs(e)<=.5&&r>.5,e=Math.round(e)+c,n=r-e,s&&n&&(e-=1,n+=1),{x:t,y:e,width:i,height:n}},translate:function(){var t=this,e=t.chart,i=t.options,o=t.dense=t.closestPointRange*t.xAxis.transA<2,r=t.borderWidth=h(i.borderWidth,o?0:1),s=t.yAxis,a=i.threshold,l=t.translatedThreshold=s.getThreshold(a),d=h(i.minPointLength,5),p=t.getColumnMetrics(),u=p.width,g=t.barW=Math.max(u,1+2*r),f=t.pointXOffset=p.offset;e.inverted&&(l-=.5),i.pointPadding&&(g=Math.ceil(g)),c.prototype.translate.apply(t),n(t.points,function(i){var n,o=h(i.yBottom,l),r=999+Math.abs(o),c=Math.min(Math.max(-r,i.plotY),s.len+r),p=i.plotX+f,m=g,x=Math.min(c,o),v=Math.max(c,o)-x;d&&Math.abs(v)<d&&(v=d,n=!s.reversed&&!i.negative||s.reversed&&i.negative,i.y===a&&t.dataMax<=a&&s.min<a&&(n=!n),x=Math.abs(x-l)>d?o-d:l-(n?d:0)),i.barX=p,i.pointWidth=u,i.tooltipPos=e.inverted?[s.len+s.pos-e.plotLeft-c,t.xAxis.len-p-m/2,v]:[p+m/2,c+s.pos-e.plotTop,v],i.shapeType="rect",i.shapeArgs=t.crispCol.apply(t,i.isNull?[p,l,m,0]:[p,x,m,v])})},getSymbol:l,drawLegendSymbol:s.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(t,e){var n,o,r,s,l=this.options,h=this.pointAttrToOptions||{},c=h.stroke||"borderColor",d=h["stroke-width"]||"borderWidth",p=t&&t.color||this.color,u=t&&t[c]||l[c]||this.color||p,g=t&&t[d]||l[d]||this[d]||0,f=l.dashStyle;return t&&this.zones.length&&(r=t.getZone(),p=t.options.color||r&&r.color||this.color),e&&(n=a(l.states[e],t.options.states&&t.options.states[e]||{}),s=n.brightness,p=n.color||void 0!==s&&i(p).brighten(n.brightness).get()||p,u=n[c]||u,g=n[d]||g,f=n.dashStyle||f),o={fill:p,stroke:u,"stroke-width":g},f&&(o.dashstyle=f),o},drawPoints:function(){var t,e=this,i=this.chart,o=e.options,s=i.renderer,l=o.animationLimit||250;n(e.points,function(n){var h=n.plotY,c=n.graphic;r(h)&&null!==n.y?(t=n.shapeArgs,c?c[i.pointCount<l?"animate":"attr"](a(t)):n.graphic=c=s[n.shapeType](t).add(n.group||e.group),o.borderRadius&&c.attr({r:o.borderRadius}),c.attr(e.pointAttribs(n,n.selected&&"select")).shadow(o.shadow,null,o.stacking&&!o.borderRadius),c.addClass(n.getClassName(),!0)):c&&(n.graphic=c.destroy())})},animate:function(t){var i,n,r=this,s=this.yAxis,a=r.options,l=this.chart.inverted,h={},c=l?"translateX":"translateY";p&&(t?(h.scaleY=.001,n=Math.min(s.pos+s.len,Math.max(s.pos,s.toPixels(a.threshold))),l?h.translateX=n-s.len:h.translateY=n,r.group.attr(h)):(i=r.group.attr(c),r.group.animate({scaleY:1},o(e(r.options.animation),{step:function(t,e){h[c]=i+e.pos*(s.pos-i),r.group.attr(h)}})),r.animate=null))},remove:function(){var t=this,e=t.chart;e.hasRendered&&n(e.series,function(e){e.type===t.type&&(e.isDirty=!0)}),c.prototype.remove.apply(t,arguments)}})}(e),function(t){var e=t.seriesType;e("bar","column",null,{inverted:!0})}(e),function(t){var e=t.Series,i=t.seriesType;i("scatter","line",{lineWidth:0,findNearestPointBy:"xy",marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 0.85em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,drawGraph:function(){this.options.lineWidth&&e.prototype.drawGraph.call(this)}})}(e),function(t){var e=t.deg2rad,i=t.isNumber,n=t.pick,o=t.relativeLength;t.CenteredSeriesMixin={getCenter:function(){var t,e,i,r=this.options,s=this.chart,a=2*(r.slicedOffset||0),l=s.plotWidth-2*a,h=s.plotHeight-2*a,c=r.center,d=[n(c[0],"50%"),n(c[1],"50%"),r.size||"100%",r.innerSize||0],p=Math.min(l,h);for(e=0;4>e;++e)i=d[e],t=2>e||2===e&&/%$/.test(i),d[e]=o(i,[l,h,p,d[2]][e])+(t?a:0);return d[3]>d[2]&&(d[3]=d[2]),d},getStartAndEndRadians:function(t,n){var o=i(t)?t:0,r=i(n)&&n>o&&360>n-o?n:o+360,s=-90;return{start:e*(o+s),end:e*(r+s)}}}}(e),function(t){var e=t.addEvent,i=t.CenteredSeriesMixin,n=t.defined,o=t.each,r=t.extend,s=i.getStartAndEndRadians,a=t.inArray,l=t.LegendSymbolMixin,h=t.noop,c=t.pick,d=t.Point,p=t.Series,u=t.seriesType,g=t.seriesTypes,f=t.setAnimation;u("pie","line",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,states:{hover:{brightness:.1,shadow:!1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttribs:g.column.prototype.pointAttribs,animate:function(t){var e=this,i=e.points,n=e.startAngleRad;t||(o(i,function(t){var i=t.graphic,o=t.shapeArgs;i&&(i.attr({r:t.startR||e.center[3]/2,start:n,end:n}),i.animate({r:o.r,start:o.start,end:o.end},e.options.animation))}),e.animate=null)},updateTotals:function(){var t,e,i=0,n=this.points,o=n.length,r=this.options.ignoreHiddenPoint;for(t=0;o>t;t++)e=n[t],i+=r&&!e.visible?0:e.isNull?0:e.y;for(this.total=i,t=0;o>t;t++)e=n[t],e.percentage=i>0&&(e.visible||!r)?e.y/i*100:0,e.total=i},generatePoints:function(){p.prototype.generatePoints.call(this),this.updateTotals()},translate:function(t){this.generatePoints();var e,i,n,o,r,a,l,h,d=this,p=0,u=1e3,g=d.options,f=g.slicedOffset,m=f+(g.borderWidth||0),x=s(g.startAngle,g.endAngle),v=d.startAngleRad=x.start,y=d.endAngleRad=x.end,b=y-v,k=d.points,M=g.dataLabels.distance,w=g.ignoreHiddenPoint,S=k.length;for(t||(d.center=t=d.getCenter()),d.getX=function(e,i,n){return o=Math.asin(Math.min((e-t[1])/(t[2]/2+n.labelDistance),1)),t[0]+(i?-1:1)*Math.cos(o)*(t[2]/2+n.labelDistance)},l=0;S>l;l++)h=k[l],h.labelDistance=c(h.options.dataLabels&&h.options.dataLabels.distance,M),d.maxLabelDistance=Math.max(d.maxLabelDistance||0,h.labelDistance),i=v+p*b,(!w||h.visible)&&(p+=h.percentage/100),n=v+p*b,h.shapeType="arc",h.shapeArgs={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:Math.round(i*u)/u,end:Math.round(n*u)/u},o=(n+i)/2,o>1.5*Math.PI?o-=2*Math.PI:o<-Math.PI/2&&(o+=2*Math.PI),h.slicedTranslation={translateX:Math.round(Math.cos(o)*f),translateY:Math.round(Math.sin(o)*f)},r=Math.cos(o)*t[2]/2,a=Math.sin(o)*t[2]/2,h.tooltipPos=[t[0]+.7*r,t[1]+.7*a],h.half=o<-Math.PI/2||o>Math.PI/2?1:0,h.angle=o,e=Math.min(m,h.labelDistance/5),h.labelPos=[t[0]+r+Math.cos(o)*h.labelDistance,t[1]+a+Math.sin(o)*h.labelDistance,t[0]+r+Math.cos(o)*e,t[1]+a+Math.sin(o)*e,t[0]+r,t[1]+a,h.labelDistance<0?"center":h.half?"right":"left",o]},drawGraph:null,drawPoints:function(){var t,e,i,n,s=this,a=s.chart,l=a.renderer,h=s.options.shadow;h&&!s.shadowGroup&&(s.shadowGroup=l.g("shadow").add(s.group)),o(s.points,function(o){if(e=o.graphic,o.isNull)e&&(o.graphic=e.destroy());else{n=o.shapeArgs,t=o.getTranslate();var a=o.shadowGroup;h&&!a&&(a=o.shadowGroup=l.g("shadow").add(s.shadowGroup)),a&&a.attr(t),i=s.pointAttribs(o,o.selected&&"select"),e?e.setRadialReference(s.center).attr(i).animate(r(n,t)):(o.graphic=e=l[o.shapeType](n).setRadialReference(s.center).attr(t).add(s.group),o.visible||e.attr({visibility:"hidden"}),e.attr(i).attr({"stroke-linejoin":"round"}).shadow(h,a)),e.addClass(o.getClassName())}})},searchPoint:h,sortByAngle:function(t,e){t.sort(function(t,i){return void 0!==t.angle&&(i.angle-t.angle)*e})},drawLegendSymbol:l.drawRectangle,getCenter:i.getCenter,getSymbol:h},{init:function(){d.prototype.init.apply(this,arguments);var t,i=this;return i.name=c(i.name,"Slice"),t=function(t){i.slice("select"===t.type)},e(i,"select",t),e(i,"unselect",t),i},isValid:function(){return t.isNumber(this.y,!0)&&this.y>=0},setVisible:function(t,e){var i=this,n=i.series,r=n.chart,s=n.options.ignoreHiddenPoint;e=c(e,s),t!==i.visible&&(i.visible=i.options.visible=t=void 0===t?!i.visible:t,n.options.data[a(i,n.data)]=i.options,o(["graphic","dataLabel","connector","shadowGroup"],function(e){i[e]&&i[e][t?"show":"hide"](!0)}),i.legendItem&&r.legend.colorizeItem(i,t),t||"hover"!==i.state||i.setState(""),s&&(n.isDirty=!0),e&&r.redraw())},slice:function(t,e,i){var o=this,r=o.series,s=r.chart;f(i,s),e=c(e,!0),o.sliced=o.options.sliced=t=n(t)?t:!o.sliced,r.options.data[a(o,r.data)]=o.options,o.graphic.animate(this.getTranslate()),o.shadowGroup&&o.shadowGroup.animate(this.getTranslate())},getTranslate:function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},haloPath:function(t){var e=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(e.x,e.y,e.r+t,e.r+t,{innerR:this.shapeArgs.r-1,start:e.start,end:e.end})}})}(e),function(t){var e=t.addEvent,i=t.arrayMax,n=t.defined,o=t.each,r=t.extend,s=t.format,a=t.map,l=t.merge,h=t.noop,c=t.pick,d=t.relativeLength,p=t.Series,u=t.seriesTypes,g=t.stableSort;t.distribute=function(t,e){function i(t,e){return t.target-e.target}var n,r,s,l=!0,h=t,d=[],p=0;for(n=t.length;n--;)p+=t[n].size;if(p>e){for(g(t,function(t,e){return(e.rank||0)-(t.rank||0)}),n=0,p=0;e>=p;)p+=t[n].size,n++;d=t.splice(n-1,t.length)}for(g(t,i),t=a(t,function(t){return{size:t.size,targets:[t.target],align:c(t.align,.5)}});l;){for(n=t.length;n--;)r=t[n],s=(Math.min.apply(0,r.targets)+Math.max.apply(0,r.targets))/2,r.pos=Math.min(Math.max(0,s-r.size*r.align),e-r.size);for(n=t.length,l=!1;n--;)n>0&&t[n-1].pos+t[n-1].size>t[n].pos&&(t[n-1].size+=t[n].size,t[n-1].targets=t[n-1].targets.concat(t[n].targets),t[n-1].align=.5,t[n-1].pos+t[n-1].size>e&&(t[n-1].pos=e-t[n-1].size),t.splice(n,1),l=!0)}n=0,o(t,function(t){var e=0;o(t.targets,function(){h[n].pos=t.pos+e,e+=h[n].size,n++})}),h.push.apply(h,d),g(h,i)},p.prototype.drawDataLabels=function(){function i(t,e){var i,n,o,r=e.filter;return r?(i=r.operator,n=t[r.property],o=r.value,">"===i&&n>o||"<"===i&&o>n||">="===i&&n>=o||"<="===i&&o>=n||"=="===i&&n==o||"==="===i&&n===o?!0:!1):!0}var r,a,h,d,p=this,u=p.options,g=u.dataLabels,f=p.points,m=p.hasRendered||0,x=c(g.defer,!!u.animation),v=p.chart.renderer;(g.enabled||p._hasPointLabels)&&(p.dlProcessOptions&&p.dlProcessOptions(g),d=p.plotGroup("dataLabelsGroup","data-labels",x&&!m?"hidden":"visible",g.zIndex||6),x&&(d.attr({opacity:+m}),m||e(p,"afterAnimate",function(){p.visible&&d.show(!0),d[u.animation?"animate":"attr"]({opacity:1},{duration:200})})),a=g,o(f,function(e){var o,f,m,x,y,b,k=e.dataLabel,M=e.connector,w=!k;r=e.dlOptions||e.options&&e.options.dataLabels,o=c(r&&r.enabled,a.enabled)&&!e.isNull,o&&(o=i(e,r||g)===!0),o&&(g=l(a,r),f=e.getLabelConfig(),b=g[e.formatPrefix+"Format"]||g.format,h=n(b)?s(b,f):(g[e.formatPrefix+"Formatter"]||g.formatter).call(f,g),y=g.style,x=g.rotation,y.color=c(g.color,y.color,p.color,"#000000"),"contrast"===y.color&&(e.contrastColor=v.getContrast(e.color||p.color),y.color=g.inside||c(e.labelDistance,g.distance)<0||u.stacking?e.contrastColor:"#000000"),u.cursor&&(y.cursor=u.cursor),m={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":g.borderWidth,r:g.borderRadius||0,rotation:x,padding:g.padding,zIndex:1},t.objectEach(m,function(t,e){void 0===t&&delete m[e]})),!k||o&&n(h)?o&&n(h)&&(k?m.text=h:(k=e.dataLabel=x?v.text(h,0,-9999).addClass("highcharts-data-label"):v.label(h,0,-9999,g.shape,null,null,g.useHTML,null,"data-label"),k.addClass(" highcharts-data-label-color-"+e.colorIndex+" "+(g.className||"")+(g.useHTML?"highcharts-tracker":""))),k.attr(m),k.css(y).shadow(g.shadow),k.added||k.add(d),p.alignDataLabel(e,k,g,null,w)):(e.dataLabel=k=k.destroy(),M&&(e.connector=M.destroy()))}))},p.prototype.alignDataLabel=function(t,e,i,n,o){var s,a,l,h,d,p,u=this.chart,g=u.inverted,f=c(t.dlBox&&t.dlBox.centerX,t.plotX,-9999),m=c(t.plotY,-9999),x=e.getBBox(),v=i.rotation,y=i.align,b=this.visible&&(t.series.forceDL||u.isInsidePlot(f,Math.round(m),g)||n&&u.isInsidePlot(f,g?n.x+1:n.y+n.height-1,g)),k="justify"===c(i.overflow,"justify");b&&(s=i.style.fontSize,a=u.renderer.fontMetrics(s,e).b,n=r({x:g?this.yAxis.len-m:f,y:Math.round(g?this.xAxis.len-f:m),width:0,height:0},n),r(i,{width:x.width,height:x.height}),v?(k=!1,d=u.renderer.rotCorr(a,v),p={x:n.x+i.x+n.width/2+d.x,y:n.y+i.y+{top:0,middle:.5,bottom:1}[i.verticalAlign]*n.height},e[o?"attr":"animate"](p).attr({align:y}),l=(v+720)%360,h=l>180&&360>l,"left"===y?p.y-=h?x.height:0:"center"===y?(p.x-=x.width/2,p.y-=x.height/2):"right"===y&&(p.x-=x.width,p.y-=h?0:x.height)):(e.align(i,null,n),p=e.alignAttr),k?t.isLabelJustified=this.justifyDataLabel(e,i,p,x,n,o):c(i.crop,!0)&&(b=u.isInsidePlot(p.x,p.y)&&u.isInsidePlot(p.x+x.width,p.y+x.height)),i.shape&&!v&&e[o?"attr":"animate"]({anchorX:g?u.plotWidth-t.plotY:t.plotX,anchorY:g?u.plotHeight-t.plotX:t.plotY})),b||(e.attr({y:-9999}),e.placed=!1)},p.prototype.justifyDataLabel=function(t,e,i,n,o,r){var s,a,l=this.chart,h=e.align,c=e.verticalAlign,d=t.box?0:t.padding||0;return s=i.x+d,0>s&&("right"===h?e.align="left":e.x=-s,a=!0),s=i.x+n.width-d,s>l.plotWidth&&("left"===h?e.align="right":e.x=l.plotWidth-s,a=!0),s=i.y+d,0>s&&("bottom"===c?e.verticalAlign="top":e.y=-s,a=!0),s=i.y+n.height-d,s>l.plotHeight&&("top"===c?e.verticalAlign="bottom":e.y=l.plotHeight-s,a=!0),a&&(t.placed=!r,t.align(e,null,o)),a},u.pie&&(u.pie.prototype.drawDataLabels=function(){var e,r,s,a,l,h,d,u,g,f,m=this,x=m.data,v=m.chart,y=m.options.dataLabels,b=c(y.connectorPadding,10),k=c(y.connectorWidth,1),M=v.plotWidth,w=v.plotHeight,S=m.center,A=S[2]/2,T=S[1],P=[[],[]],C=[0,0,0,0];m.visible&&(y.enabled||m._hasPointLabels)&&(o(x,function(t){t.dataLabel&&t.visible&&t.dataLabel.shortened&&(t.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),t.dataLabel.shortened=!1)}),p.prototype.drawDataLabels.apply(m),o(x,function(t){t.dataLabel&&t.visible&&(P[t.half].push(t),t.dataLabel._pos=null)}),o(P,function(i,r){var p,x,k,P,L,O,D=i.length,I=[];if(D)for(m.sortByAngle(i,r-.5),m.maxLabelDistance>0&&(p=Math.max(0,T-A-m.maxLabelDistance),x=Math.min(T+A+m.maxLabelDistance,v.plotHeight),o(i,function(t){t.labelDistance>0&&t.dataLabel&&(t.top=Math.max(0,T-A-t.labelDistance),t.bottom=Math.min(T+A+t.labelDistance,v.plotHeight),O=t.dataLabel.getBBox().height||21,t.positionsIndex=I.push({target:t.labelPos[1]-t.top+O/2,size:O,rank:t.y})-1)}),t.distribute(I,x+O-p)),f=0;D>f;f++)e=i[f],L=e.positionsIndex,l=e.labelPos,s=e.dataLabel,g=e.visible===!1?"hidden":"inherit",k=l[1],u=k,I&&n(I[L])&&(void 0===I[L].pos?g="hidden":(h=I[L].size,u=e.top+I[L].pos)),delete e.positionIndex,d=y.justify?S[0]+(r?-1:1)*(A+e.labelDistance):m.getX(u<e.top+2||u>e.bottom-2?k:u,r,e),s._attr={visibility:g,align:l[6]},s._pos={x:d+y.x+({left:b,right:-b}[l[6]]||0),y:u+y.y-10},l.x=d,l.y=u,c(y.crop,!0)&&(a=s.getBBox().width,P=null,b>d-a?(P=Math.round(a-d+b),C[3]=Math.max(P,C[3])):d+a>M-b&&(P=Math.round(d+a-M+b),C[1]=Math.max(P,C[1])),0>u-h/2?C[0]=Math.max(Math.round(-u+h/2),C[0]):u+h/2>w&&(C[2]=Math.max(Math.round(u+h/2-w),C[2])),s.sideOverflow=P)}),(0===i(C)||this.verifyDataLabelOverflow(C))&&(this.placeDataLabels(),k&&o(this.points,function(t){var e;r=t.connector,s=t.dataLabel,s&&s._pos&&t.visible&&t.labelDistance>0?(g=s._attr.visibility,e=!r,e&&(t.connector=r=v.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+t.colorIndex).add(m.dataLabelsGroup),r.attr({"stroke-width":k,stroke:y.connectorColor||t.color||"#666666"})),r[e?"attr":"animate"]({d:m.connectorPath(t.labelPos)}),r.attr("visibility",g)):r&&(t.connector=r.destroy())})))},u.pie.prototype.connectorPath=function(t){var e=t.x,i=t.y;return c(this.options.dataLabels.softConnector,!0)?["M",e+("left"===t[6]?5:-5),i,"C",e,i,2*t[2]-t[4],2*t[3]-t[5],t[2],t[3],"L",t[4],t[5]]:["M",e+("left"===t[6]?5:-5),i,"L",t[2],t[3],"L",t[4],t[5]]},u.pie.prototype.placeDataLabels=function(){o(this.points,function(t){var e,i=t.dataLabel;i&&t.visible&&(e=i._pos,e?(i.sideOverflow&&(i._attr.width=i.getBBox().width-i.sideOverflow,i.css({width:i._attr.width+"px",textOverflow:"ellipsis"}),i.shortened=!0),i.attr(i._attr),i[i.moved?"animate":"attr"](e),i.moved=!0):i&&i.attr({y:-9999}))},this)},u.pie.prototype.alignDataLabel=h,u.pie.prototype.verifyDataLabelOverflow=function(t){var e=this.center,i=this.options,n=i.center,o=i.minSize||80,r=o,s=null!==i.size;return s||(null!==n[0]?r=Math.max(e[2]-Math.max(t[1],t[3]),o):(r=Math.max(e[2]-t[1]-t[3],o),e[0]+=(t[3]-t[1])/2),null!==n[1]?r=Math.max(Math.min(r,e[2]-Math.max(t[0],t[2])),o):(r=Math.max(Math.min(r,e[2]-t[0]-t[2]),o),e[1]+=(t[0]-t[2])/2),r<e[2]?(e[2]=r,e[3]=Math.min(d(i.innerSize||0,r),r),this.translate(e),this.drawDataLabels&&this.drawDataLabels()):s=!0),s}),u.column&&(u.column.prototype.alignDataLabel=function(t,e,i,n,o){var r,s=this.chart.inverted,a=t.series,h=t.dlBox||t.shapeArgs,d=c(t.below,t.plotY>c(this.translatedThreshold,a.yAxis.len)),u=c(i.inside,!!this.options.stacking);h&&(n=l(h),n.y<0&&(n.height+=n.y,n.y=0),r=n.y+n.height-a.yAxis.len,r>0&&(n.height-=r),s&&(n={x:a.yAxis.len-n.y-n.height,y:a.xAxis.len-n.x-n.width,width:n.height,height:n.width}),u||(s?(n.x+=d?0:n.width,n.width=0):(n.y+=d?n.height:0,n.height=0))),i.align=c(i.align,!s||u?"center":d?"right":"left"),i.verticalAlign=c(i.verticalAlign,s||u?"middle":d?"top":"bottom"),p.prototype.alignDataLabel.call(this,t,e,i,n,o),t.isLabelJustified&&t.contrastColor&&t.dataLabel.css({color:t.contrastColor})})}(e),function(t){var e=t.Chart,i=t.each,n=t.objectEach,o=t.pick,r=t.addEvent;r(e.prototype,"render",function(){var t=[];i(this.labelCollectors||[],function(e){t=t.concat(e())}),i(this.yAxis||[],function(e){e.options.stackLabels&&!e.options.stackLabels.allowOverlap&&n(e.stacks,function(e){n(e,function(e){t.push(e.label)})})}),i(this.series||[],function(e){var n=e.options.dataLabels,r=e.dataLabelCollections||["dataLabel"];(n.enabled||e._hasPointLabels)&&!n.allowOverlap&&e.visible&&i(r,function(n){i(e.points,function(e){e[n]&&(e[n].labelrank=o(e.labelrank,e.shapeArgs&&e.shapeArgs.height),t.push(e[n]))})})}),this.hideOverlappingLabels(t)}),e.prototype.hideOverlappingLabels=function(t){var e,n,o,r,s,a,l,h,c,d,p,u,g=t.length,f=function(t,e,i,n,o,r,s,a){return!(o>t+i||t>o+s||r>e+n||e>r+a)};for(n=0;g>n;n++)e=t[n],e&&(e.oldOpacity=e.opacity,e.newOpacity=1,e.width||(u=e.getBBox(),e.width=u.width,e.height=u.height));for(t.sort(function(t,e){return(e.labelrank||0)-(t.labelrank||0)}),n=0;g>n;n++)for(r=t[n],o=n+1;g>o;++o)s=t[o],r&&s&&r!==s&&r.placed&&s.placed&&0!==r.newOpacity&&0!==s.newOpacity&&(l=r.alignAttr,h=s.alignAttr,c=r.parentGroup,d=s.parentGroup,p=2*(r.box?0:r.padding||0),a=f(l.x+c.translateX,l.y+c.translateY,r.width-p,r.height-p,h.x+d.translateX,h.y+d.translateY,s.width-p,s.height-p),a&&((r.labelrank<s.labelrank?r:s).newOpacity=0));i(t,function(t){var e,i;t&&(i=t.newOpacity,t.oldOpacity!==i&&t.placed&&(i?t.show(!0):e=function(){t.hide()},t.alignAttr.opacity=i,t[t.isOld?"animate":"attr"](t.alignAttr,null,e)),t.isOld=!0)})}}(e),function(t){var e,i=t.addEvent,n=t.Chart,o=t.createElement,r=t.css,s=t.defaultOptions,a=t.defaultPlotOptions,l=t.each,h=t.extend,c=t.fireEvent,d=t.hasTouch,p=t.inArray,u=t.isObject,g=t.Legend,f=t.merge,m=t.pick,x=t.Point,v=t.Series,y=t.seriesTypes,b=t.svg;e=t.TrackerMixin={drawTrackerPoint:function(){var t=this,e=t.chart,i=e.pointer,n=function(t){var e=i.getPointFromEvent(t);void 0!==e&&(i.isDirectTouch=!0,e.onMouseOver(t))};l(t.points,function(t){t.graphic&&(t.graphic.element.point=t),t.dataLabel&&(t.dataLabel.div?t.dataLabel.div.point=t:t.dataLabel.element.point=t)}),t._hasTracking||(l(t.trackerGroups,function(e){t[e]&&(t[e].addClass("highcharts-tracker").on("mouseover",n).on("mouseout",function(t){i.onTrackerMouseOut(t)}),d&&t[e].on("touchstart",n),t.options.cursor&&t[e].css(r).css({cursor:t.options.cursor}))}),t._hasTracking=!0)},drawTrackerGraph:function(){var t,e=this,i=e.options,n=i.trackByArea,o=[].concat(n?e.areaPath:e.graphPath),r=o.length,s=e.chart,a=s.pointer,h=s.renderer,c=s.options.tooltip.snap,p=e.tracker,u=function(){s.hoverSeries!==e&&e.onMouseOver()},g="rgba(192,192,192,"+(b?1e-4:.002)+")";if(r&&!n)for(t=r+1;t--;)"M"===o[t]&&o.splice(t+1,0,o[t+1]-c,o[t+2],"L"),(t&&"M"===o[t]||t===r)&&o.splice(t,0,"L",o[t-2]+c,o[t-1]);p?p.attr({d:o}):e.graph&&(e.tracker=h.path(o).attr({"stroke-linejoin":"round",visibility:e.visible?"visible":"hidden",stroke:g,fill:n?g:"none","stroke-width":e.graph.strokeWidth()+(n?0:2*c),zIndex:2}).add(e.group),l([e.tracker,e.markerGroup],function(t){t.addClass("highcharts-tracker").on("mouseover",u).on("mouseout",function(t){a.onTrackerMouseOut(t)}),i.cursor&&t.css({cursor:i.cursor}),d&&t.on("touchstart",u)}))}},y.column&&(y.column.prototype.drawTracker=e.drawTrackerPoint),y.pie&&(y.pie.prototype.drawTracker=e.drawTrackerPoint),y.scatter&&(y.scatter.prototype.drawTracker=e.drawTrackerPoint),h(g.prototype,{setItemEvents:function(t,e,i){var n=this,o=n.chart.renderer.boxWrapper,r="highcharts-legend-"+(t instanceof x?"point":"series")+"-active";(i?e:t.legendGroup).on("mouseover",function(){t.setState("hover"),o.addClass(r),e.css(n.options.itemHoverStyle)}).on("mouseout",function(){e.css(f(t.visible?n.itemStyle:n.itemHiddenStyle)),o.removeClass(r),t.setState()}).on("click",function(e){var i="legendItemClick",n=function(){t.setVisible&&t.setVisible()};o.removeClass(r),e={browserEvent:e},t.firePointEvent?t.firePointEvent(i,e,n):c(t,i,e,n)})},createCheckboxForItem:function(t){var e=this;t.checkbox=o("input",{type:"checkbox",checked:t.selected,defaultChecked:t.selected},e.options.itemCheckboxStyle,e.chart.container),i(t.checkbox,"click",function(e){var i=e.target;c(t.series||t,"checkboxClick",{checked:i.checked,item:t},function(){t.select()})})}}),s.legend.itemStyle.cursor="pointer",h(n.prototype,{showResetZoom:function(){function t(){e.zoomOut()}var e=this,i=s.lang,n=e.options.chart.resetZoomButton,o=n.theme,r=o.states,a="chart"===n.relativeTo?null:"plotBox";this.resetZoomButton=e.renderer.button(i.resetZoom,null,null,t,o,r&&r.hover).attr({align:n.position.align,title:i.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(n.position,!1,a)},zoomOut:function(){var t=this;c(t,"selection",{resetSelection:!0},function(){t.zoom()})},zoom:function(t){var e,i,n=this,o=n.pointer,r=!1;!t||t.resetSelection?(l(n.axes,function(t){e=t.zoom()}),o.initiated=!1):l(t.xAxis.concat(t.yAxis),function(t){var i=t.axis,n=i.isXAxis;o[n?"zoomX":"zoomY"]&&(e=i.zoom(t.min,t.max),i.displayBtn&&(r=!0))}),i=n.resetZoomButton,r&&!i?n.showResetZoom():!r&&u(i)&&(n.resetZoomButton=i.destroy()),e&&n.redraw(m(n.options.chart.animation,t&&t.animation,n.pointCount<100))},pan:function(t,e){var i,n=this,o=n.hoverPoints;o&&l(o,function(t){t.setState()}),l("xy"===e?[1,0]:[1],function(e){var o,r=n[e?"xAxis":"yAxis"][0],s=r.horiz,a=t[s?"chartX":"chartY"],l=s?"mouseDownX":"mouseDownY",h=n[l],c=(r.pointRange||0)/2,d=r.getExtremes(),p=r.toValue(h-a,!0)+c,u=r.toValue(h+r.len-a,!0)-c,g=p>u,f=g?u:p,m=g?p:u,x=Math.min(d.dataMin,c?d.min:r.toValue(r.toPixels(d.min)-r.minPixelPadding)),v=Math.max(d.dataMax,c?d.max:r.toValue(r.toPixels(d.max)+r.minPixelPadding));o=x-f,o>0&&(m+=o,f=x),o=m-v,o>0&&(m=v,f-=o),r.series.length&&f!==d.min&&m!==d.max&&(r.setExtremes(f,m,!1,!1,{trigger:"pan"}),i=!0),n[l]=a}),i&&n.redraw(!1),r(n.container,{cursor:"move"})}}),h(x.prototype,{select:function(t,e){var i=this,n=i.series,o=n.chart;t=m(t,!i.selected),i.firePointEvent(t?"select":"unselect",{accumulate:e},function(){i.selected=i.options.selected=t,n.options.data[p(i,n.data)]=i.options,i.setState(t&&"select"),e||l(o.getSelectedPoints(),function(t){t.selected&&t!==i&&(t.selected=t.options.selected=!1,n.options.data[p(t,n.data)]=t.options,t.setState(""),t.firePointEvent("unselect"))})})},onMouseOver:function(t){var e=this,i=e.series,n=i.chart,o=n.pointer;t=t?o.normalize(t):o.getChartCoordinatesFromPoint(e,n.inverted),o.runPointActions(t,e)},onMouseOut:function(){var t=this,e=t.series.chart;t.firePointEvent("mouseOut"),l(e.hoverPoints||[],function(t){t.setState()}),e.hoverPoints=e.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var e=this,n=f(e.series.options.point,e.options),o=n.events;e.events=o,t.objectEach(o,function(t,n){i(e,n,t)}),this.hasImportedEvents=!0}},setState:function(t,e){var i,n,o,r=this,s=Math.floor(r.plotX),l=r.plotY,c=r.series,d=c.options.states[t]||{},p=a[c.type].marker&&c.options.marker,u=p&&p.enabled===!1,g=p&&p.states&&p.states[t]||{},f=g.enabled===!1,x=c.stateMarkerGraphic,v=r.marker||{},y=c.chart,b=c.halo,k=p&&c.markerAttribs;t=t||"",t===r.state&&!e||r.selected&&"select"!==t||d.enabled===!1||t&&(f||u&&g.enabled===!1)||t&&v.states&&v.states[t]&&v.states[t].enabled===!1||(k&&(n=c.markerAttribs(r,t)),r.graphic?(r.state&&r.graphic.removeClass("highcharts-point-"+r.state),t&&r.graphic.addClass("highcharts-point-"+t),r.graphic.animate(c.pointAttribs(r,t),m(y.options.chart.animation,d.animation)),n&&r.graphic.animate(n,m(y.options.chart.animation,g.animation,p.animation)),x&&x.hide()):(t&&g&&(o=v.symbol||c.symbol,x&&x.currentSymbol!==o&&(x=x.destroy()),x?x[e?"animate":"attr"]({x:n.x,y:n.y}):o&&(c.stateMarkerGraphic=x=y.renderer.symbol(o,n.x,n.y,n.width,n.height).add(c.markerGroup),x.currentSymbol=o),x&&x.attr(c.pointAttribs(r,t))),x&&(x[t&&y.isInsidePlot(s,l,y.inverted)?"show":"hide"](),x.element.point=r)),i=d.halo,i&&i.size?(b||(c.halo=b=y.renderer.path().add((r.graphic||x).parentGroup)),b[e?"animate":"attr"]({d:r.haloPath(i.size)}),b.attr({class:"highcharts-halo highcharts-color-"+m(r.colorIndex,c.colorIndex)}),b.point=r,b.attr(h({fill:r.color||c.color,"fill-opacity":i.opacity,zIndex:-1},i.attributes))):b&&b.point&&b.point.haloPath&&b.animate({d:b.point.haloPath(0)}),r.state=t)},haloPath:function(t){var e=this.series,i=e.chart;return i.renderer.symbols.circle(Math.floor(this.plotX)-t,this.plotY-t,2*t,2*t)}}),h(v.prototype,{onMouseOver:function(){var t=this,e=t.chart,i=e.hoverSeries;i&&i!==t&&i.onMouseOut(),t.options.events.mouseOver&&c(t,"mouseOver"),t.setState("hover"),e.hoverSeries=t},onMouseOut:function(){var t=this,e=t.options,i=t.chart,n=i.tooltip,o=i.hoverPoint;i.hoverSeries=null,o&&o.onMouseOut(),t&&e.events.mouseOut&&c(t,"mouseOut"),!n||t.stickyTracking||n.shared&&!t.noSharedTooltip||n.hide(),t.setState()},setState:function(t){var e,i=this,n=i.options,o=i.graph,r=n.states,s=n.lineWidth,a=0;if(t=t||"",i.state!==t){if(l([i.group,i.markerGroup,i.dataLabelsGroup],function(e){e&&(i.state&&e.removeClass("highcharts-series-"+i.state),t&&e.addClass("highcharts-series-"+t))}),i.state=t,r[t]&&r[t].enabled===!1)return;if(t&&(s=r[t].lineWidth||s+(r[t].lineWidthPlus||0)),o&&!o.dashstyle)for(e={"stroke-width":s},o.animate(e,m(i.chart.options.chart.animation,r[t]&&r[t].animation));i["zone-graph-"+a];)i["zone-graph-"+a].attr(e),a+=1}},setVisible:function(t,e){var i,n=this,o=n.chart,r=n.legendItem,s=o.options.chart.ignoreHiddenSeries,a=n.visible;n.visible=t=n.options.visible=n.userOptions.visible=void 0===t?!a:t,i=t?"show":"hide",l(["group","dataLabelsGroup","markerGroup","tracker","tt"],function(t){n[t]&&n[t][i]()}),(o.hoverSeries===n||(o.hoverPoint&&o.hoverPoint.series)===n)&&n.onMouseOut(),r&&o.legend.colorizeItem(n,t),n.isDirty=!0,n.options.stacking&&l(o.series,function(t){t.options.stacking&&t.visible&&(t.isDirty=!0)}),l(n.linkedSeries,function(e){e.setVisible(t,!1)}),s&&(o.isDirtyBox=!0),e!==!1&&o.redraw(),c(n,i)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){var e=this;e.selected=t=void 0===t?!e.selected:t,e.checkbox&&(e.checkbox.checked=t),c(e,t?"select":"unselect")},drawTracker:e.drawTrackerGraph})}(e),function(t){var e=t.Chart,i=t.each,n=t.inArray,o=t.isArray,r=t.isObject,s=t.pick,a=t.splat;e.prototype.setResponsive=function(e){var n,o=this.options.responsive,r=[],s=this.currentResponsive;o&&o.rules&&i(o.rules,function(i){void 0===i._id&&(i._id=t.uniqueKey()),this.matchResponsiveRule(i,r,e)},this);var a=t.merge.apply(0,t.map(r,function(e){return t.find(o.rules,function(t){return t._id===e}).chartOptions}));r=r.toString()||void 0,n=s&&s.ruleIds,r!==n&&(s&&this.update(s.undoOptions,e),r?(this.currentResponsive={ruleIds:r,mergedOptions:a,undoOptions:this.currentOptions(a)},this.update(a,e)):this.currentResponsive=void 0)},e.prototype.matchResponsiveRule=function(t,e){var i=t.condition,n=i.callback||function(){return this.chartWidth<=s(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=s(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=s(i.minWidth,0)&&this.chartHeight>=s(i.minHeight,0)};n.call(this)&&e.push(t._id)},e.prototype.currentOptions=function(e){function i(e,s,l,h){var c;t.objectEach(e,function(t,e){if(!h&&n(e,["series","xAxis","yAxis"])>-1)for(t=a(t),l[e]=[],c=0;c<t.length;c++)s[e][c]&&(l[e][c]={},i(t[c],s[e][c],l[e][c],h+1));else r(t)?(l[e]=o(t)?[]:{},i(t,s[e]||{},l[e],h+1)):l[e]=s[e]||null})}var s={};return i(e,this.options,s,0),s}}(e);var e=function(t){return t}(e);!function(t){var e=t.addEvent,i=t.Axis,n=t.Chart,o=t.css,r=t.dateFormat,s=t.defined,a=t.each,l=t.extend,h=t.noop,c=t.pick,d=t.Series,p=t.timeUnits,u=t.wrap;u(d.prototype,"init",function(t){var i,n=this;t.apply(this,Array.prototype.slice.call(arguments,1)),i=n.xAxis,i&&i.options.ordinal&&e(n,"updatedData",function(){delete i.ordinalIndex})}),u(i.prototype,"getTimeTicks",function(t,e,i,n,o,a,l,h){var c,d,u,g,f,m,x=0,v={},y=[],b=-Number.MAX_VALUE,k=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||!a||a.length<3||void 0===i)return t.call(this,e,i,n,o);for(f=a.length,c=0;f>c;c++){if(m=c&&a[c-1]>n,a[c]<i&&(x=c),c===f-1||a[c+1]-a[c]>5*l||m){if(a[c]>b){for(d=t.call(this,e,a[x],a[c],o);d.length&&d[0]<=b;)d.shift();d.length&&(b=d[d.length-1]),y=y.concat(d)}x=c+1}if(m)break}if(g=d.info,h&&g.unitRange<=p.hour){for(c=y.length-1,x=1;c>x;x++)r("%d",y[x])!==r("%d",y[x-1])&&(v[y[x]]="day",u=!0);u&&(v[y[0]]="day"),g.higherRanks=v}if(y.info=g,h&&s(k)){for(var M,w,S,A,T,P=y.length,C=P,L=[],O=[];C--;)w=this.translate(y[C]),S&&(O[C]=S-w),L[C]=S=w;for(O.sort(),A=O[Math.floor(O.length/2)],.6*k>A&&(A=null),C=y[P-1]>n?P-1:P,S=void 0;C--;)w=L[C],T=Math.abs(S-w),S&&.8*k>T&&(null===A||.8*A>T)?(v[y[C]]&&!v[y[C+1]]?(M=C+1,S=w):M=C,y.splice(M,1)):S=w}return y}),l(i.prototype,{beforeSetTickPositions:function(){var t,e,i,n,o,r,l=this,h=[],d=!1,p=l.getExtremes(),u=p.min,g=p.max,f=l.isXAxis&&!!l.options.breaks,m=l.options.ordinal,x=Number.MAX_VALUE,v=l.chart.options.chart.ignoreHiddenSeries,y="highcharts-navigator-xaxis"===l.options.className;if(!l.options.overscroll||l.max!==l.dataMax||l.chart.mouseIsDown&&!y||l.eventArgs&&(!l.eventArgs||"navigator"===l.eventArgs.trigger)||(l.max+=l.options.overscroll,!y&&s(l.userMin)&&(l.min+=l.options.overscroll)),m||f){if(a(l.series,function(e,i){if(!(v&&e.visible===!1||e.takeOrdinalPosition===!1&&!f)&&(h=h.concat(e.processedXData),t=h.length,h.sort(function(t,e){return t-e}),x=Math.min(x,c(e.closestPointRange,x)),t))for(i=t-1;i--;)h[i]===h[i+1]&&h.splice(i,1)}),t=h.length,t>2){for(e=h[1]-h[0],r=t-1;r--&&!d;)h[r+1]-h[r]!==e&&(d=!0);!l.options.keepOrdinalPadding&&(h[0]-u>e||g-h[h.length-1]>e)&&(d=!0)}else l.options.overscroll&&(2===t?x=h[1]-h[0]:1===t?(x=l.options.overscroll,h=[h[0],h[0]+x]):x=l.overscrollPointsRange);d?(l.options.overscroll&&(l.overscrollPointsRange=x,h=h.concat(l.getOverscrollPositions())),l.ordinalPositions=h,i=l.ordinal2lin(Math.max(u,h[0]),!0),n=Math.max(l.ordinal2lin(Math.min(g,h[h.length-1]),!0),1),l.ordinalSlope=o=(g-u)/(n-i),l.ordinalOffset=u-i*o):(l.overscrollPointsRange=c(l.closestPointRange,l.overscrollPointsRange),l.ordinalPositions=l.ordinalSlope=l.ordinalOffset=void 0)}l.isOrdinal=m&&d,l.groupIntervalFactor=null},val2lin:function(t,e){var i,n=this,o=n.ordinalPositions;if(o){var r,s,a,l=o.length;for(r=l;r--;)if(o[r]===t){a=r;break}for(r=l-1;r--;)if(t>o[r]||0===r){s=(t-o[r])/(o[r+1]-o[r]),a=r+s;break}i=e?a:n.ordinalSlope*(a||0)+n.ordinalOffset}else i=t;return i},lin2val:function(t,e){var i,n=this,o=n.ordinalPositions;if(o){var r,s,a,l=n.ordinalSlope,h=n.ordinalOffset,c=o.length-1;if(e)0>t?t=o[0]:t>c?t=o[c]:(c=Math.floor(t),a=t-c);else for(;c--;)if(r=l*c+h,t>=r){s=l*(c+1)+h,a=(t-r)/(s-r);break}return void 0!==a&&void 0!==o[c]?o[c]+(a?a*(o[c+1]-o[c]):0):t}return i=t},getExtendedPositions:function(){var t,e,n=this,o=n.chart,r=n.series[0].currentDataGrouping,s=n.ordinalIndex,l=r?r.count+r.unitName:"raw",c=n.options.overscroll,d=n.getExtremes();return s||(s=n.ordinalIndex={}),s[l]||(t={series:[],chart:o,getExtremes:function(){return{min:d.dataMin,max:d.dataMax+c}},options:{ordinal:!0},val2lin:i.prototype.val2lin,ordinal2lin:i.prototype.ordinal2lin},a(n.series,function(i){e={xAxis:t,xData:i.xData.slice(),chart:o,destroyGroupedData:h},e.xData=e.xData.concat(n.getOverscrollPositions()),e.options={dataGrouping:r?{enabled:!0,forced:!0,approximation:"open",units:[[r.unitName,[r.count]]]}:{enabled:!1}},i.processData.apply(e),t.series.push(e)}),n.beforeSetTickPositions.apply(t),s[l]=t.ordinalPositions),s[l]},getOverscrollPositions:function(){var e=this,i=e.options.overscroll,n=e.overscrollPointsRange,o=[],r=e.dataMax;if(t.defined(n))for(o.push(r);r<=e.dataMax+i;)r+=n,o.push(r);return o},getGroupIntervalFactor:function(t,e,i){var n,o,r=i.processedXData,s=r.length,a=[],l=this.groupIntervalFactor;if(!l){for(n=0;s-1>n;n++)a[n]=r[n+1]-r[n];a.sort(function(t,e){return t-e}),o=a[Math.floor(s/2)],t=Math.max(t,r[0]),e=Math.min(e,r[s-1]),this.groupIntervalFactor=l=s*o/(e-t)}return l},postProcessTickInterval:function(t){var e,i=this.ordinalSlope;return e=i?this.options.breaks?this.closestPointRange||t:t/(i/this.closestPointRange):t}}),i.prototype.ordinal2lin=i.prototype.val2lin,u(n.prototype,"pan",function(t,e){var i=this,n=i.xAxis[0],r=n.options.overscroll,s=e.chartX,l=!1;if(n.options.ordinal&&n.series.length){var h,c,d,p,u=i.mouseDownX,g=n.getExtremes(),f=g.dataMax,m=g.min,x=g.max,v=i.hoverPoints,y=n.closestPointRange||n.overscrollPointsRange,b=n.translationSlope*(n.ordinalSlope||y),k=(u-s)/b,M={ordinalPositions:n.getExtendedPositions()},w=n.lin2val,S=n.val2lin;M.ordinalPositions?Math.abs(k)>1&&(v&&a(v,function(t){t.setState()}),0>k?(d=M,p=n.ordinalPositions?n:M):(d=n.ordinalPositions?n:M,p=M),c=p.ordinalPositions,f>c[c.length-1]&&c.push(f),i.fixedRange=x-m,h=n.toFixedRange(null,null,w.apply(d,[S.apply(d,[m,!0])+k,!0]),w.apply(p,[S.apply(p,[x,!0])+k,!0])),h.min>=Math.min(g.dataMin,m)&&h.max<=Math.max(f,x)+r&&n.setExtremes(h.min,h.max,!0,!1,{trigger:"pan"}),i.mouseDownX=s,o(i.container,{cursor:"move"})):l=!0}else l=!0;l&&(r&&(n.max=n.dataMax+r),t.apply(this,Array.prototype.slice.call(arguments,1)))})}(e),function(t){function e(){return Array.prototype.slice.call(arguments,1)}function i(t){t.apply(this),this.drawBreaks(this.xAxis,["x"]),this.drawBreaks(this.yAxis,n(this.pointArrayMap,["y"]))}var n=t.pick,o=t.wrap,r=t.each,s=t.extend,a=t.isArray,l=t.fireEvent,h=t.Axis,c=t.Series;s(h.prototype,{isInBreak:function(t,e){var i,n=t.repeat||1/0,o=t.from,r=t.to-t.from,s=e>=o?(e-o)%n:n-(o-e)%n;return i=t.inclusive?r>=s:r>s&&0!==s},isInAnyBreak:function(t,e){var i,o,r,s=this.options.breaks,a=s&&s.length;if(a){for(;a--;)this.isInBreak(s[a],t)&&(i=!0,o||(o=n(s[a].showPoints,this.isXAxis?!1:!0)));r=i&&e?i&&!o:i}return r}}),o(h.prototype,"setTickPositions",function(t){if(t.apply(this,Array.prototype.slice.call(arguments,1)),this.options.breaks){var e,i=this,n=this.tickPositions,o=this.tickPositions.info,r=[];for(e=0;e<n.length;e++)i.isInAnyBreak(n[e])||r.push(n[e]);this.tickPositions=r,this.tickPositions.info=o}}),o(h.prototype,"init",function(t,e,i){var o,s=this;i.breaks&&i.breaks.length&&(i.ordinal=!1),t.call(this,e,i),o=this.options.breaks,s.isBroken=a(o)&&!!o.length,s.isBroken&&(s.val2lin=function(t){var e,i,n=t;for(i=0;i<s.breakArray.length;i++)if(e=s.breakArray[i],e.to<=t)n-=e.len;else{if(e.from>=t)break;if(s.isInBreak(e,t)){n-=t-e.from;break}}return n},s.lin2val=function(t){var e,i,n=t;for(i=0;i<s.breakArray.length&&(e=s.breakArray[i],!(e.from>=n));i++)e.to<n?n+=e.len:s.isInBreak(e,n)&&(n+=e.len);return n},s.setExtremes=function(t,e,i,n,o){for(;this.isInAnyBreak(t);)t-=this.closestPointRange;for(;this.isInAnyBreak(e);)e-=this.closestPointRange;h.prototype.setExtremes.call(this,t,e,i,n,o)},s.setAxisTranslation=function(t){h.prototype.setAxisTranslation.call(this,t);var e,i,o,a,c=s.options.breaks,d=[],p=[],u=0,g=s.userMin||s.min,f=s.userMax||s.max,m=n(s.pointRangePadding,0);r(c,function(t){i=t.repeat||1/0,s.isInBreak(t,g)&&(g+=t.to%i-g%i),s.isInBreak(t,f)&&(f-=f%i-t.from%i)}),r(c,function(t){for(o=t.from,i=t.repeat||1/0;o-i>g;)o-=i;for(;g>o;)o+=i;for(a=o;f>a;a+=i)d.push({value:a,move:"in"}),d.push({value:a+(t.to-t.from),move:"out",size:t.breakSize})}),d.sort(function(t,e){var i;return i=t.value===e.value?("in"===t.move?0:1)-("in"===e.move?0:1):t.value-e.value}),e=0,o=g,r(d,function(t){e+="in"===t.move?1:-1,1===e&&"in"===t.move&&(o=t.value),0===e&&(p.push({from:o,to:t.value,len:t.value-o-(t.size||0)}),u+=t.value-o-(t.size||0))}),s.breakArray=p,s.unitLength=f-g-u+m,l(s,"afterBreaks"),s.options.staticScale?s.transA=s.options.staticScale:s.unitLength&&(s.transA*=(f-s.min+m)/s.unitLength),m&&(s.minPixelPadding=s.transA*s.minPointOffset),s.min=g,s.max=f})}),o(c.prototype,"generatePoints",function(t){t.apply(this,e(arguments));var i,n,o=this,r=o.xAxis,s=o.yAxis,a=o.points,l=a.length,h=o.options.connectNulls;if(r&&s&&(r.options.breaks||s.options.breaks))for(;l--;)i=a[l],n=null===i.y&&h===!1,n||!r.isInAnyBreak(i.x,!0)&&!s.isInAnyBreak(i.y,!0)||(a.splice(l,1),this.data[l]&&this.data[l].destroyElements())}),t.Series.prototype.drawBreaks=function(t,e){var i,o,s,a,h=this,c=h.points;t&&r(e,function(e){i=t.breakArray||[],o=t.isXAxis?t.min:n(h.options.threshold,t.min),r(c,function(h){a=n(h["stack"+e.toUpperCase()],h[e]),r(i,function(e){s=!1,o<e.from&&a>e.to||o>e.from&&a<e.from?s="pointBreak":(o<e.from&&a>e.from&&a<e.to||o>e.from&&a>e.to&&a<e.from)&&(s="pointInBreak"),s&&l(t,s,{point:h,brk:e})})})})},t.Series.prototype.gappedPath=function(){var e,i,n=this.options.gapSize,o=this.points.slice(),r=o.length-1,s=this.yAxis;if(n&&r>0)for("value"!==this.options.gapUnit&&(n*=this.closestPointRange);r--;)o[r+1].x-o[r].x>n&&(e=(o[r].x+o[r+1].x)/2,o.splice(r+1,0,{isNull:!0,x:e}),this.options.stacking&&(i=s.stacks[this.stackKey][e]=new t.StackItem(s,s.options.stackLabels,!1,e,this.stack),i.total=0));return this.getGraphPath(o)},o(t.seriesTypes.column.prototype,"drawPoints",i),o(t.Series.prototype,"drawPoints",i)}(e),function(t){var e=t.arrayMax,i=t.arrayMin,n=t.Axis,o=t.defaultPlotOptions,r=t.defined,s=t.each,a=t.extend,l=t.format,h=t.isNumber,c=t.merge,d=t.pick,p=t.Point,u=t.Series,g=t.Tooltip,f=t.wrap,m=u.prototype,x=m.processData,v=m.generatePoints,y={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},b={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},k=t.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],M=t.approximations={sum:function(t){var e,i=t.length;if(!i&&t.hasNulls)e=null;else if(i)for(e=0;i--;)e+=t[i];return e},average:function(t){var e=t.length,i=M.sum(t);return h(i)&&e&&(i/=e),i},averages:function(){var t=[];return s(arguments,function(e){t.push(M.average(e))}),void 0===t[0]?void 0:t},open:function(t){return t.length?t[0]:t.hasNulls?null:void 0},high:function(t){return t.length?e(t):t.hasNulls?null:void 0},low:function(t){return t.length?i(t):t.hasNulls?null:void 0},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:void 0},ohlc:function(t,e,i,n){return t=M.open(t),e=M.high(e),i=M.low(i),n=M.close(n),h(t)||h(e)||h(i)||h(n)?[t,e,i,n]:void 0},range:function(t,e){return t=M.low(t),e=M.high(e),h(t)||h(e)?[t,e]:null===t&&null===e?null:void 0}};m.groupData=function(t,e,i,n){var o,r,a,l,c,d,p=this,u=p.data,g=p.options.data,f=[],m=[],x=[],v=t.length,k=!!e,w=[],S="function"==typeof n?n:M[n]||b[p.type]&&M[b[p.type].approximation]||M[y.approximation],A=p.pointArrayMap,T=A&&A.length,P=0,C=0;for(T?s(A,function(){w.push([])}):w.push([]),l=T||1,c=0;v>=c&&!(t[c]>=i[0]);c++);for(c;v>=c;c++){for(;void 0!==i[P+1]&&t[c]>=i[P+1]||c===v;){for(o=i[P],p.dataGroupInfo={start:C,length:w[0].length},a=S.apply(p,w),void 0!==a&&(f.push(o),m.push(a),x.push(p.dataGroupInfo)),C=c,d=0;l>d;d++)w[d].length=0,w[d].hasNulls=!1;if(P+=1,c===v)break}if(c===v)break;if(A){var L,O=p.cropStart+c,D=u&&u[O]||p.pointClass.prototype.applyOptions.apply({series:p},[g[O]]);for(d=0;T>d;d++)L=D[A[d]],h(L)?w[d].push(L):null===L&&(w[d].hasNulls=!0)}else r=k?e[c]:null,h(r)?w[0].push(r):null===r&&(w[0].hasNulls=!0)}return[f,m,x]},m.processData=function(){var t,e,i,n=this,o=n.chart,s=n.options,a=s.dataGrouping,l=n.allowDG!==!1&&a&&d(a.enabled,o.options.isStock),h=n.visible||!o.options.chart.ignoreHiddenSeries,c=this.currentDataGrouping;if(n.forceCrop=l,n.groupPixelWidth=null,n.hasProcessed=!0,e=x.apply(n,arguments)===!1||!l,!e){n.destroyGroupedData();var p,u=n.processedXData,g=n.processedYData,f=o.plotSizeX,v=n.xAxis,y=v.options.ordinal,b=n.groupPixelWidth=v.getGroupPixelWidth&&v.getGroupPixelWidth();if(b){t=!0,n.isDirty=!0,n.points=null;var M=v.getExtremes(),w=M.min,S=M.max,A=y&&v.getGroupIntervalFactor(w,S,n)||1,T=b*(S-w)/f*A,P=v.getTimeTicks(v.normalizeTimeTickInterval(T,a.units||k),Math.min(w,u[0]),Math.max(S,u[u.length-1]),v.options.startOfWeek,u,n.closestPointRange),C=m.groupData.apply(n,[u,g,P,a.approximation]),L=C[0],O=C[1];if(a.smoothed&&L.length){for(p=L.length-1,L[p]=Math.min(L[p],S);p--&&p>0;)L[p]+=T/2;L[0]=Math.max(L[0],w)}i=P.info,n.closestPointRange=P.info.totalRange,n.groupMap=C[2],r(L[0])&&L[0]<v.dataMin&&h&&(v.min===v.dataMin&&(v.min=L[0]),v.dataMin=L[0]),n.processedXData=L,n.processedYData=O}else n.groupMap=null;n.hasGroupedData=t,n.currentDataGrouping=i,n.preventGraphAnimation=(c&&c.totalRange)!==(i&&i.totalRange)}},m.destroyGroupedData=function(){var t=this.groupedData;s(t||[],function(e,i){e&&(t[i]=e.destroy?e.destroy():null)}),this.groupedData=null},m.generatePoints=function(){v.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},f(p.prototype,"update",function(e){this.dataGroup?t.error(24):e.apply(this,[].slice.call(arguments,1))}),f(g.prototype,"tooltipFooterHeaderFormatter",function(e,i,n){var o,r,s,c,d,p=this,u=i.series,g=u.options,f=u.tooltipOptions,m=g.dataGrouping,x=f.xDateFormat,v=u.xAxis,y=t.dateFormat;return v&&"datetime"===v.options.type&&m&&h(i.key)?(r=u.currentDataGrouping,s=m.dateTimeLabelFormats,r?(c=s[r.unitName],1===r.count?x=c[0]:(x=c[1],o=c[2])):!x&&s&&(x=p.getXDateFormat(i,f,v)),d=y(x,i.key),o&&(d+=y(o,i.key+r.totalRange-1)),l(f[(n?"footer":"header")+"Format"],{point:a(i.point,{key:d}),series:u})):e.call(p,i,n)}),f(m,"destroy",function(t){t.call(this),this.destroyGroupedData()}),f(m,"setOptions",function(t,e){var i=t.call(this,e),n=this.type,r=this.chart.options.plotOptions,s=o[n].dataGrouping;return b[n]&&(s||(s=c(y,b[n])),i.dataGrouping=c(s,r.series&&r.series.dataGrouping,r[n].dataGrouping,e.dataGrouping)),this.chart.options.isStock&&(this.requireSorting=!0),i}),f(n.prototype,"setScale",function(t){t.call(this),s(this.series,function(t){t.hasProcessed=!1})}),n.prototype.getGroupPixelWidth=function(){var t,e,i,n=this.series,o=n.length,r=0,s=!1;for(t=o;t--;)i=n[t].options.dataGrouping,i&&(r=Math.max(r,i.groupPixelWidth));for(t=o;t--;)i=n[t].options.dataGrouping,i&&n[t].hasProcessed&&(e=(n[t].processedXData||n[t].data).length,(n[t].groupPixelWidth||e>this.chart.plotSizeX/r||e&&i.forced)&&(s=!0));return s?r:0},n.prototype.setDataGrouping=function(t,e){var i;if(e=d(e,!0),t||(t={forced:!1,units:null}),this instanceof n)for(i=this.series.length;i--;)this.series[i].update({dataGrouping:t},!1);else s(this.chart.options.series,function(e){e.dataGrouping=t},!1);e&&this.chart.redraw()}}(e),function(t){var e=t.each,i=t.Point,n=t.seriesType,o=t.seriesTypes;n("ohlc","column",{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},threshold:null,states:{hover:{lineWidth:3}},stickyTracking:!0},{directTouch:!1,pointArrayMap:["open","high","low","close"],toYData:function(t){return[t.open,t.high,t.low,t.close]},pointValKey:"close",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},pointAttribs:function(t,e){var i=o.column.prototype.pointAttribs.call(this,t,e),n=this.options;return delete i.fill,!t.options.color&&n.upColor&&t.open<t.close&&(i.stroke=n.upColor),i},translate:function(){var t=this,i=t.yAxis,n=!!t.modifyValue,r=["plotOpen","plotHigh","plotLow","plotClose","yBottom"];o.column.prototype.translate.apply(t),e(t.points,function(o){e([o.open,o.high,o.low,o.close,o.low],function(e,s){null!==e&&(n&&(e=t.modifyValue(e)),o[r[s]]=i.toPixels(e,!0))}),o.tooltipPos[1]=o.plotHigh+i.pos-t.chart.plotTop})},drawPoints:function(){var t=this,i=t.points,n=t.chart;e(i,function(e){var i,o,r,s,a,l,h=e.graphic,c=!h;void 0!==e.plotY&&(h||(e.graphic=h=n.renderer.path().add(t.group)),h.attr(t.pointAttribs(e,e.selected&&"select")),r=h.strokeWidth()%2/2,l=Math.round(e.plotX)-r,s=Math.round(e.shapeArgs.width/2),a=["M",l,Math.round(e.yBottom),"L",l,Math.round(e.plotHigh)],null!==e.open&&(i=Math.round(e.plotOpen)+r,a.push("M",l,i,"L",l-s,i)),null!==e.close&&(o=Math.round(e.plotClose)+r,a.push("M",l,o,"L",l+s,o)),h[c?"attr":"animate"]({d:a}).addClass(e.getClassName(),!0))})},animate:null},{getClassName:function(){return i.prototype.getClassName.call(this)+(this.open<this.close?" highcharts-point-up":" highcharts-point-down")}})}(e),function(t){var e=t.defaultPlotOptions,i=t.each,n=t.merge,o=t.seriesType,r=t.seriesTypes,s={states:{hover:{lineWidth:2}},tooltip:e.ohlc.tooltip,threshold:null,lineColor:"#000000",lineWidth:1,upColor:"#ffffff",stickyTracking:!0};o("candlestick","ohlc",n(e.column,s),{pointAttribs:function(t,e){var i,n=r.column.prototype.pointAttribs.call(this,t,e),o=this.options,s=t.open<t.close,a=o.lineColor||this.color;return n["stroke-width"]=o.lineWidth,n.fill=t.options.color||(s?o.upColor||this.color:this.color),n.stroke=t.lineColor||(s?o.upLineColor||a:a),e&&(i=o.states[e],n.fill=i.color||n.fill,n.stroke=i.lineColor||n.stroke,n["stroke-width"]=i.lineWidth||n["stroke-width"]),n},drawPoints:function(){var t=this,e=t.points,n=t.chart;i(e,function(e){var i,o,r,s,a,l,h,c,d,p,u=e.graphic,g=!u;void 0!==e.plotY&&(u||(e.graphic=u=n.renderer.path().add(t.group)),u.attr(t.pointAttribs(e,e.selected&&"select")).shadow(t.options.shadow),h=u.strokeWidth()%2/2,c=Math.round(e.plotX)-h,i=e.plotOpen,o=e.plotClose,r=Math.min(i,o),s=Math.max(i,o),p=Math.round(e.shapeArgs.width/2),a=Math.round(r)!==Math.round(e.plotHigh),l=s!==e.yBottom,r=Math.round(r)+h,s=Math.round(s)+h,d=[],d.push("M",c-p,s,"L",c-p,r,"L",c+p,r,"L",c+p,s,"Z","M",c,r,"L",c,a?Math.round(e.plotHigh):r,"M",c,s,"L",c,l?Math.round(e.yBottom):s),u[g?"attr":"animate"]({d:d}).addClass(e.getClassName(),!0))})}})}(e);var n=function(t){var e=t.each,i=t.seriesTypes,n=t.stableSort,o={translate:function(){i.column.prototype.translate.apply(this);var t,o,r,s,a,l,h,c=this,d=c.options,p=c.chart,u=c.points,g=u.length-1,f=d.onSeries,m=f&&p.get(f),x=d.onKey||"y",v=m&&m.options.step,y=m&&m.points,b=y&&y.length,k=c.xAxis,M=c.yAxis,w=k.getExtremes(),S=0;if(m&&m.visible&&b)for(S=(m.pointXOffset||0)+(m.barW||0)/2,l=m.currentDataGrouping,s=y[b-1].x+(l?l.totalRange:0),n(u,function(t,e){return t.x-e.x}),x="plot"+x[0].toUpperCase()+x.substr(1);b--&&u[g]&&(r=y[b],t=u[g],t.y=r.y,!(r.x<=t.x&&void 0!==r[x]&&(t.x<=s&&(t.plotY=r[x],r.x<t.x&&!v&&(a=y[b+1],a&&void 0!==a[x]&&(h=(t.x-r.x)/(a.x-r.x),t.plotY+=h*(a[x]-r[x]),t.y+=h*(a.y-r.y)))),g--,b++,0>g))););e(u,function(t,e){var i;void 0===t.plotY&&(t.x>=w.min&&t.x<=w.max?t.plotY=p.chartHeight-k.bottom-(k.opposite?k.height:0)+k.offset-M.top:t.shapeArgs={}),t.plotX+=S,o=u[e-1],o&&o.plotX===t.plotX&&(void 0===o.stackIndex&&(o.stackIndex=0),i=o.stackIndex+1),t.stackIndex=i})}};return o}(e);return function(t,e){function i(t){u[t+"pin"]=function(e,i,n,o,r){var s,a,l=r&&r.anchorX,h=r&&r.anchorY;return"circle"===t&&o>n&&(e-=Math.round((o-n)/2),n=o),s=u[t](e,i,n,o),l&&h&&(a=i>h?i:i+o,s.push("M","circle"===t?s[1]-s[4]:s[1]+s[4]/2,a,"L",l,h),s=s.concat(u.circle(l-1,h-1,2,2))),s}}var n=t.addEvent,o=t.each,r=t.merge,s=t.noop,a=t.Renderer,l=t.Series,h=t.seriesType,c=t.SVGRenderer,d=t.TrackerMixin,p=t.VMLRenderer,u=c.prototype.symbols;h("flags","column",{pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd6eb"}},style:{fontSize:"11px",fontWeight:"bold"}},{sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:l.prototype.init,pointAttribs:function(t,e){var i=this.options,n=t&&t.color||this.color,o=i.lineColor,r=t&&t.lineWidth,s=t&&t.fillColor||i.fillColor;return e&&(s=i.states[e].fillColor,o=i.states[e].lineColor,r=i.states[e].lineWidth),{fill:s||n,stroke:o||n,"stroke-width":r||i.lineWidth||0}},translate:e.translate,drawPoints:function(){var e,i,n,s,a,l,h,c,d,p,u=this,g=u.points,f=u.chart,m=f.renderer,x=u.options,v=x.y,y=u.yAxis,b={},k=[];for(s=g.length;s--;)a=g[s],p=a.plotX>u.xAxis.len,e=a.plotX,h=a.stackIndex,n=a.options.shape||x.shape,i=a.plotY,void 0!==i&&(i=a.plotY+v-(void 0!==h&&h*x.stackDistance)),a.anchorX=h?void 0:a.plotX,c=h?void 0:a.plotY,l=a.graphic,void 0!==i&&e>=0&&!p?(l||(l=a.graphic=m.label("",null,null,n,null,null,x.useHTML).attr(u.pointAttribs(a)).css(r(x.style,a.style)).attr({align:"flag"===n?"left":"center",width:x.width,height:x.height,"text-align":x.textAlign}).addClass("highcharts-point").add(u.markerGroup),a.graphic.div&&(a.graphic.div.point=a),l.shadow(x.shadow),l.isNew=!0),e>0&&(e-=l.strokeWidth()%2),d={y:i,anchorY:c},x.allowOverlapX&&(d.x=e,d.anchorX=a.anchorX),l.attr({text:a.options.title||x.title||"A"})[l.isNew?"attr":"animate"](d),x.allowOverlapX||(b[a.plotX]?b[a.plotX].size=Math.max(b[a.plotX].size,l.width):b[a.plotX]={align:0,size:l.width,target:e,anchorX:e}),a.tooltipPos=f.inverted?[y.len+y.pos-f.plotLeft-i,u.xAxis.len-e]:[e,i+y.pos-f.plotTop]):l&&(a.graphic=l.destroy());x.allowOverlapX||(t.objectEach(b,function(t){t.plotX=t.anchorX,k.push(t)}),t.distribute(k,this.xAxis.len),o(g,function(t){var e=t.graphic&&b[t.plotX];e&&(t.graphic[t.graphic.isNew?"attr":"animate"]({x:e.pos,anchorX:t.anchorX}),t.graphic.isNew=!1)})),x.useHTML&&t.wrap(u.markerGroup,"on",function(e){return t.SVGElement.prototype.on.apply(e.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})},drawTracker:function(){var t=this,e=t.points;d.drawTrackerPoint.apply(this),o(e,function(t){var i=t.graphic;i&&n(i.element,"mouseover",function(){t.stackIndex>0&&!t.raised&&(t._y=i.y,i.attr({y:t._y-8}),t.raised=!0),o(e,function(e){e!==t&&e.raised&&e.graphic&&(e.graphic.attr({y:e._y}),e.raised=!1)})})})},animate:s,buildKDTree:s,setClip:s}),u.flag=function(t,e,i,n,o){var r=o&&o.anchorX||t,s=o&&o.anchorY||e;return u.circle(r-1,s-1,2,2).concat(["M",r,s,"L",t,e+n,t,e,t+i,e,t+i,e+n,t,e+n,"Z"])},i("circle"),i("square"),a===p&&o(["flag","circlepin","squarepin"],function(t){p.prototype.symbols[t]=u[t]})}(e,n),function(t){function e(t,e,i){this.init(t,e,i)}var i,n=t.addEvent,o=t.Axis,r=t.correctFloat,s=t.defaultOptions,a=t.defined,l=t.destroyObjectProperties,h=t.each,c=t.fireEvent,d=t.hasTouch,p=t.isTouchDevice,u=t.merge,g=t.pick,f=t.removeEvent,m=t.svg,x=t.wrap,v={height:p?20:14,barBorderRadius:0,buttonBorderRadius:0,liveRedraw:m&&!p,margin:10,minWidth:6,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:1,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"#333333",trackBackgroundColor:"#f2f2f2",trackBorderColor:"#f2f2f2",trackBorderWidth:1};s.scrollbar=u(!0,v,s.scrollbar),t.swapXY=i=function(t,e){var i,n,o=t.length;if(e)for(i=0;o>i;i+=3)n=t[i+1],t[i+1]=t[i+2],t[i+2]=n;return t},e.prototype={init:function(t,e,i){this.scrollbarButtons=[],this.renderer=t,this.userOptions=e,this.options=u(v,e),this.chart=i,this.size=g(this.options.size,this.options.height),e.enabled&&(this.render(),this.initEvents(),this.addEvents())},render:function(){var t,e=this,n=e.renderer,o=e.options,r=e.size;e.group=t=n.g("scrollbar").attr({zIndex:o.zIndex,translateY:-99999}).add(),e.track=n.rect().addClass("highcharts-scrollbar-track").attr({x:0,r:o.trackBorderRadius||0,height:r,width:r}).add(t),e.track.attr({fill:o.trackBackgroundColor,stroke:o.trackBorderColor,"stroke-width":o.trackBorderWidth}),this.trackBorderWidth=e.track.strokeWidth(),e.track.attr({y:-this.trackBorderWidth%2/2}),e.scrollbarGroup=n.g().add(t),e.scrollbar=n.rect().addClass("highcharts-scrollbar-thumb").attr({height:r,width:r,r:o.barBorderRadius||0}).add(e.scrollbarGroup),e.scrollbarRifles=n.path(i(["M",-3,r/4,"L",-3,2*r/3,"M",0,r/4,"L",0,2*r/3,"M",3,r/4,"L",3,2*r/3],o.vertical)).addClass("highcharts-scrollbar-rifles").add(e.scrollbarGroup),e.scrollbar.attr({fill:o.barBackgroundColor,stroke:o.barBorderColor,"stroke-width":o.barBorderWidth}),e.scrollbarRifles.attr({stroke:o.rifleColor,"stroke-width":1}),e.scrollbarStrokeWidth=e.scrollbar.strokeWidth(),e.scrollbarGroup.translate(-e.scrollbarStrokeWidth%2/2,-e.scrollbarStrokeWidth%2/2),e.drawScrollbarButton(0),e.drawScrollbarButton(1)},position:function(t,e,i,n){var o=this,r=o.options,s=r.vertical,a=n,l=0,h=o.rendered?"animate":"attr";o.x=t,o.y=e+this.trackBorderWidth,o.width=i,o.height=n,o.xOffset=a,o.yOffset=l,s?(o.width=o.yOffset=i=l=o.size,o.xOffset=a=0,o.barWidth=n-2*i,o.x=t+=o.options.margin):(o.height=o.xOffset=n=a=o.size,o.barWidth=i-2*n,o.y=o.y+o.options.margin),o.group[h]({translateX:t,translateY:o.y}),o.track[h]({width:i,height:n}),o.scrollbarButtons[1][h]({translateX:s?0:i-a,translateY:s?n-l:0})},drawScrollbarButton:function(t){var e,n,o=this,r=o.renderer,s=o.scrollbarButtons,a=o.options,l=o.size;e=r.g().add(o.group),s.push(e),n=r.rect().addClass("highcharts-scrollbar-button").add(e),n.attr({stroke:a.buttonBorderColor,"stroke-width":a.buttonBorderWidth,fill:a.buttonBackgroundColor}),n.attr(n.crisp({x:-.5,y:-.5,width:l+1,height:l+1,r:a.buttonBorderRadius},n.strokeWidth())),n=r.path(i(["M",l/2+(t?-1:1),l/2-3,"L",l/2+(t?-1:1),l/2+3,"L",l/2+(t?2:-2),l/2],a.vertical)).addClass("highcharts-scrollbar-arrow").add(s[t]),n.attr({fill:a.buttonArrowColor})},setRange:function(t,e){var i,n,o,s,l,h=this,c=h.options,d=c.vertical,p=c.minWidth,u=h.barWidth,g=this.rendered&&!this.hasDragged?"animate":"attr";a(u)&&(t=Math.max(t,0),i=Math.ceil(u*t),n=u*Math.min(e,1),h.calculatedWidth=s=r(n-i),p>s&&(i=(u-p+s)*t,s=p),o=Math.floor(i+h.xOffset+h.yOffset),l=s/2-.5,h.from=t,h.to=e,d?(h.scrollbarGroup[g]({translateY:o}),h.scrollbar[g]({height:s}),h.scrollbarRifles[g]({translateY:l}),h.scrollbarTop=o,h.scrollbarLeft=0):(h.scrollbarGroup[g]({translateX:o}),h.scrollbar[g]({width:s}),h.scrollbarRifles[g]({translateX:l}),h.scrollbarLeft=o,h.scrollbarTop=0),12>=s?h.scrollbarRifles.hide():h.scrollbarRifles.show(!0),c.showFull===!1&&(0>=t&&e>=1?h.group.hide():h.group.show()),h.rendered=!0)},initEvents:function(){var t=this;t.mouseMoveHandler=function(e){var i,n,o,r=t.chart.pointer.normalize(e),s=t.options,a=s.vertical?"chartY":"chartX",l=t.initPositions;!t.grabbedCenter||e.touches&&0===e.touches[0][a]||(n=t.cursorToScrollbarPosition(r)[a],i=t[a],o=n-i,t.hasDragged=!0,t.updatePosition(l[0]+o,l[1]+o),t.hasDragged&&c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}))},t.mouseUpHandler=function(e){t.hasDragged&&c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}),t.grabbedCenter=t.hasDragged=t.chartX=t.chartY=null},t.mouseDownHandler=function(e){var i=t.chart.pointer.normalize(e),n=t.cursorToScrollbarPosition(i);t.chartX=n.chartX,t.chartY=n.chartY,t.initPositions=[t.from,t.to],t.grabbedCenter=!0},t.buttonToMinClick=function(e){var i=r(t.to-t.from)*t.options.step;t.updatePosition(r(t.from-i),r(t.to-i)),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})},t.buttonToMaxClick=function(e){var i=(t.to-t.from)*t.options.step;t.updatePosition(t.from+i,t.to+i),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})},t.trackClick=function(e){var i=t.chart.pointer.normalize(e),n=t.to-t.from,o=t.y+t.scrollbarTop,r=t.x+t.scrollbarLeft;t.options.vertical&&i.chartY>o||!t.options.vertical&&i.chartX>r?t.updatePosition(t.from+n,t.to+n):t.updatePosition(t.from-n,t.to-n),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})}},cursorToScrollbarPosition:function(t){var e=this,i=e.options,n=i.minWidth>e.calculatedWidth?i.minWidth:0;return{chartX:(t.chartX-e.x-e.xOffset)/(e.barWidth-n),chartY:(t.chartY-e.y-e.yOffset)/(e.barWidth-n)}},updatePosition:function(t,e){e>1&&(t=r(1-r(e-t)),e=1),0>t&&(e=r(e-t),t=0),this.from=t,this.to=e},update:function(t){this.destroy(),this.init(this.chart.renderer,u(!0,this.options,t),this.chart)},addEvents:function(){var t,e=this.options.inverted?[1,0]:[0,1],i=this.scrollbarButtons,o=this.scrollbarGroup.element,r=this.track.element,s=this.mouseDownHandler,a=this.mouseMoveHandler,l=this.mouseUpHandler;t=[[i[e[0]].element,"click",this.buttonToMinClick],[i[e[1]].element,"click",this.buttonToMaxClick],[r,"click",this.trackClick],[o,"mousedown",s],[o.ownerDocument,"mousemove",a],[o.ownerDocument,"mouseup",l]],d&&t.push([o,"touchstart",s],[o.ownerDocument,"touchmove",a],[o.ownerDocument,"touchend",l]),h(t,function(t){n.apply(null,t)}),this._events=t},removeEvents:function(){h(this._events,function(t){f.apply(null,t)}),this._events.length=0},destroy:function(){var t=this.chart.scroller;this.removeEvents(),h(["track","scrollbarRifles","scrollbar","scrollbarGroup","group"],function(t){this[t]&&this[t].destroy&&(this[t]=this[t].destroy())},this),t&&this===t.scrollbar&&(t.scrollbar=null,l(t.scrollbarButtons))}},x(o.prototype,"init",function(t){var i=this;t.apply(i,Array.prototype.slice.call(arguments,1)),i.options.scrollbar&&i.options.scrollbar.enabled&&(i.options.scrollbar.vertical=!i.horiz,i.options.startOnTick=i.options.endOnTick=!1,i.scrollbar=new e(i.chart.renderer,i.options.scrollbar,i.chart),n(i.scrollbar,"changed",function(t){var e,n,o=Math.min(g(i.options.min,i.min),i.min,i.dataMin),r=Math.max(g(i.options.max,i.max),i.max,i.dataMax),s=r-o;i.horiz&&!i.reversed||!i.horiz&&i.reversed?(e=o+s*this.to,n=o+s*this.from):(e=o+s*(1-this.from),n=o+s*(1-this.to)),i.setExtremes(n,e,!0,!1,t)}))}),x(o.prototype,"render",function(t){var e,i,n,o=this,r=Math.min(g(o.options.min,o.min),o.min,g(o.dataMin,o.min)),s=Math.max(g(o.options.max,o.max),o.max,g(o.dataMax,o.max)),l=o.scrollbar,h=o.titleOffset||0;t.apply(o,Array.prototype.slice.call(arguments,1)),l&&(o.horiz?(l.position(o.left,o.top+o.height+2+o.chart.scrollbarsOffsets[1]+(o.opposite?0:h+o.axisTitleMargin+o.offset),o.width,o.height),e=1):(l.position(o.left+o.width+2+o.chart.scrollbarsOffsets[0]+(o.opposite?h+o.axisTitleMargin+o.offset:0),o.top,o.width,o.height),e=0),(!o.opposite&&!o.horiz||o.opposite&&o.horiz)&&(o.chart.scrollbarsOffsets[e]+=o.scrollbar.size+o.scrollbar.options.margin),isNaN(r)||isNaN(s)||!a(o.min)||!a(o.max)?l.setRange(0,0):(i=(o.min-r)/(s-r),n=(o.max-r)/(s-r),o.horiz&&!o.reversed||!o.horiz&&o.reversed?l.setRange(i,n):l.setRange(1-n,1-i)))}),x(o.prototype,"getOffset",function(t){var e=this,i=e.horiz?2:1,n=e.scrollbar;t.apply(e,Array.prototype.slice.call(arguments,1)),n&&(e.chart.scrollbarsOffsets=[0,0],e.chart.axisOffset[i]+=n.size+n.options.margin)}),x(o.prototype,"destroy",function(t){this.scrollbar&&(this.scrollbar=this.scrollbar.destroy()),t.apply(this,Array.prototype.slice.call(arguments,1))}),t.Scrollbar=e}(e),function(t){function e(t){this.init(t)}var i,n=t.addEvent,o=t.Axis,r=t.Chart,s=t.color,a=t.defaultDataGroupingUnits,l=t.defaultOptions,h=t.defined,c=t.destroyObjectProperties,d=t.each,p=t.erase,u=t.error,g=t.extend,f=t.grep,m=t.hasTouch,x=t.isArray,v=t.isNumber,y=t.isObject,b=t.merge,k=t.pick,M=t.removeEvent,w=t.Scrollbar,S=t.Series,A=t.seriesTypes,T=t.wrap,P=[].concat(a),C=function(t){var e=f(arguments,v);return e.length?Math[t].apply(0,e):void 0};P[4]=["day",[1,2,3,4]],P[5]=["week",[1,2,3]],i=void 0===A.areaspline?"line":"areaspline",g(l,{navigator:{height:40,margin:25,maskInside:!0,handles:{width:7,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:s("#6685c2").setOpacity(.3).get(),outlineColor:"#cccccc",outlineWidth:1,series:{type:i,fillOpacity:.05,lineWidth:1,compare:null,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:P},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},pointRange:0,threshold:null},xAxis:{overscroll:0,className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#999999"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}}),t.Renderer.prototype.symbols["navigator-handle"]=function(t,e,i,n,o){var r=o.width/2,s=Math.round(r/3)+.5,a=o.height;return["M",-r-1,.5,"L",r,.5,"L",r,a+.5,"L",-r-1,a+.5,"L",-r-1,.5,"M",-s,4,"L",-s,a-3,"M",s-1,4,"L",s-1,a-3]},e.prototype={drawHandle:function(t,e,i,n){var o=this,r=o.navigatorOptions.handles.height;o.handles[e][n](i?{translateX:Math.round(o.left+o.height/2),translateY:Math.round(o.top+parseInt(t,10)+.5-r)}:{translateX:Math.round(o.left+parseInt(t,10)),translateY:Math.round(o.top+o.height/2-r/2-1)})},drawOutline:function(t,e,i,n){var o,r,s=this,a=s.navigatorOptions.maskInside,l=s.outline.strokeWidth(),h=l/2,c=l%2/2,d=s.outlineHeight,p=s.scrollbarHeight,u=s.size,g=s.left-p,f=s.top;i?(g-=h,o=f+e+c,e=f+t+c,r=["M",g+d,f-p-c,"L",g+d,o,"L",g,o,"L",g,e,"L",g+d,e,"L",g+d,f+u+p].concat(a?["M",g+d,o-h,"L",g+d,e+h]:[])):(t+=g+p-c,e+=g+p-c,f+=h,r=["M",g,f,"L",t,f,"L",t,f+d,"L",e,f+d,"L",e,f,"L",g+u+2*p,f].concat(a?["M",t-h,f,"L",e+h,f]:[])),s.outline[n]({d:r})},drawMasks:function(t,e,i,n){var o,r,s,a,l=this,h=l.left,c=l.top,p=l.height;i?(s=[h,h,h],a=[c,c+t,c+e],r=[p,p,p],o=[t,e-t,l.size-e]):(s=[h,h+t,h+e],a=[c,c,c],r=[t,e-t,l.size-e],o=[p,p,p]),d(l.shades,function(t,e){t[n]({x:s[e],y:a[e],width:r[e],height:o[e]})})},renderElements:function(){var t,e=this,i=e.navigatorOptions,n=i.maskInside,o=e.chart,r=o.inverted,s=o.renderer;e.navigatorGroup=t=s.g("navigator").attr({zIndex:8,visibility:"hidden"}).add();var a={cursor:r?"ns-resize":"ew-resize"};d([!n,n,!n],function(n,o){e.shades[o]=s.rect().addClass("highcharts-navigator-mask"+(1===o?"-inside":"-outside")).attr({fill:n?i.maskFill:"rgba(0,0,0,0)"}).css(1===o&&a).add(t)}),e.outline=s.path().addClass("highcharts-navigator-outline").attr({"stroke-width":i.outlineWidth,stroke:i.outlineColor}).add(t),i.handles.enabled&&d([0,1],function(n){i.handles.inverted=o.inverted,e.handles[n]=s.symbol(i.handles.symbols[n],-i.handles.width/2-1,0,i.handles.width,i.handles.height,i.handles),e.handles[n].attr({zIndex:7-n}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][n]).add(t);var r=i.handles;e.handles[n].attr({fill:r.backgroundColor,stroke:r.borderColor,"stroke-width":r.lineWidth}).css(a)})},update:function(t){d(this.series||[],function(t){t.baseSeries&&delete t.baseSeries.navigatorSeries}),this.destroy();var e=this.chart.options;b(!0,e.navigator,this.options,t),this.init(this.chart)},render:function(e,i,n,o){var r,s,a,l,c,d,p,u,g,f,m=this,x=m.chart,y=m.scrollbarHeight,b=m.xAxis,M=b.fake?x.xAxis[0]:b,w=m.navigatorEnabled,S=m.rendered,A=x.inverted,T=x.xAxis[0].minRange,P=x.xAxis[0].options.maxRange;if(!this.hasDragged||h(n)){if(!v(e)||!v(i)){if(!S)return;n=0,o=k(b.width,M.width)}m.left=k(b.left,x.plotLeft+y+(A?x.plotWidth:0)),m.size=d=l=k(b.len,(A?x.plotHeight:x.plotWidth)-2*y),r=A?y:l+2*y,n=k(n,b.toPixels(e,!0)),o=k(o,b.toPixels(i,!0)),v(n)&&1/0!==Math.abs(n)||(n=0,o=r),u=b.toValue(n,!0),g=b.toValue(o,!0),f=Math.abs(t.correctFloat(g-u)),T>f?this.grabbedLeft?n=b.toPixels(g-T,!0):this.grabbedRight&&(o=b.toPixels(u+T,!0)):h(P)&&f>P&&(this.grabbedLeft?n=b.toPixels(g-P,!0):this.grabbedRight&&(o=b.toPixels(u+P,!0))),m.zoomedMax=Math.min(Math.max(n,o,0),d),m.zoomedMin=Math.min(Math.max(m.fixedWidth?m.zoomedMax-m.fixedWidth:Math.min(n,o),0),d),m.range=m.zoomedMax-m.zoomedMin,d=Math.round(m.zoomedMax),c=Math.round(m.zoomedMin),w&&(m.navigatorGroup.attr({visibility:"visible"}),p=S&&!m.hasDragged?"animate":"attr",m.drawMasks(c,d,A,p),m.drawOutline(c,d,A,p),m.navigatorOptions.handles.enabled&&(m.drawHandle(c,0,A,p),m.drawHandle(d,1,A,p))),m.scrollbar&&(A?(a=m.top-y,s=m.left-y+(w||!M.opposite?0:(M.titleOffset||0)+M.axisTitleMargin),y=l+2*y):(a=m.top+(w?m.height:-y),s=m.left-y),m.scrollbar.position(s,a,r,y),m.scrollbar.setRange(m.zoomedMin/l,m.zoomedMax/l)),m.rendered=!0}},addMouseEvents:function(){var t,e,i=this,o=i.chart,r=o.container,s=[];i.mouseMoveHandler=t=function(t){i.onMouseMove(t)},i.mouseUpHandler=e=function(t){i.onMouseUp(t)},s=i.getPartsEvents("mousedown"),s.push(n(r,"mousemove",t),n(r.ownerDocument,"mouseup",e)),m&&(s.push(n(r,"touchmove",t),n(r.ownerDocument,"touchend",e)),s.concat(i.getPartsEvents("touchstart"))),i.eventsToUnbind=s,i.series&&i.series[0]&&s.push(n(i.series[0].xAxis,"foundExtremes",function(){o.navigator.modifyNavigatorAxisExtremes()}))},getPartsEvents:function(t){var e=this,i=[];return d(["shades","handles"],function(o){d(e[o],function(r,s){i.push(n(r.element,t,function(t){e[o+"Mousedown"](t,s)}))})}),i},shadesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i,n,o,r=this,s=r.chart,a=r.xAxis,l=r.zoomedMin,c=r.left,d=r.size,p=r.range,u=t.chartX;s.inverted&&(u=t.chartY,c=r.top),1===e?(r.grabbedCenter=u,r.fixedWidth=p,r.dragOffset=u-l):(o=u-c-p/2,0===e?o=Math.max(0,o):2===e&&o+p>=d&&(o=d-p,i=r.getUnionExtremes().dataMax),o!==l&&(r.fixedWidth=p,n=a.toFixedRange(o,o+p,null,i),h(n.min)&&s.xAxis[0].setExtremes(Math.min(n.min,n.max),Math.max(n.min,n.max),!0,null,{trigger:"navigator"})))},handlesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i=this,n=i.chart,o=n.xAxis[0],r=n.inverted&&!o.reversed||!n.inverted&&o.reversed;0===e?(i.grabbedLeft=!0,i.otherHandlePos=i.zoomedMax,i.fixedExtreme=r?o.min:o.max):(i.grabbedRight=!0,i.otherHandlePos=i.zoomedMin,i.fixedExtreme=r?o.max:o.min),n.fixedRange=null},onMouseMove:function(t){var e,i=this,n=i.chart,o=i.left,r=i.navigatorSize,s=i.range,a=i.dragOffset,l=n.inverted;t.touches&&0===t.touches[0].pageX||(t=n.pointer.normalize(t),e=t.chartX,l&&(o=i.top,e=t.chartY),i.grabbedLeft?(i.hasDragged=!0,i.render(0,0,e-o,i.otherHandlePos)):i.grabbedRight?(i.hasDragged=!0,i.render(0,0,i.otherHandlePos,e-o)):i.grabbedCenter&&(i.hasDragged=!0,a>e?e=a:e>r+a-s&&(e=r+a-s),i.render(0,0,e-a,e-a+s)),i.hasDragged&&i.scrollbar&&i.scrollbar.options.liveRedraw&&(t.DOMType=t.type,setTimeout(function(){i.onMouseUp(t)},0)))},onMouseUp:function(t){var e,i,n,o=this,r=o.chart,s=o.xAxis,a=o.scrollbar,l=t.DOMEvent||t;(!o.hasDragged||a&&a.hasDragged)&&"scrollbar"!==t.trigger||(o.zoomedMin===o.otherHandlePos?e=o.fixedExtreme:o.zoomedMax===o.otherHandlePos&&(i=o.fixedExtreme),o.zoomedMax===o.size&&(i=o.getUnionExtremes().dataMax),n=s.toFixedRange(o.zoomedMin,o.zoomedMax,e,i),h(n.min)&&r.xAxis[0].setExtremes(Math.min(n.min,n.max),Math.max(n.min,n.max),!0,o.hasDragged?!1:null,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:l})),"mousemove"!==t.DOMType&&(o.grabbedLeft=o.grabbedRight=o.grabbedCenter=o.fixedWidth=o.fixedExtreme=o.otherHandlePos=o.hasDragged=o.dragOffset=null)},removeEvents:function(){this.eventsToUnbind&&(d(this.eventsToUnbind,function(t){t()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()},removeBaseSeriesEvents:function(){var t=this.baseSeries||[];this.navigatorEnabled&&t[0]&&(this.navigatorOptions.adaptToUpdatedData!==!1&&d(t,function(t){M(t,"updatedData",this.updatedDataHandler)},this),t[0].xAxis&&M(t[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))},init:function(t){var e=t.options,i=e.navigator,r=i.enabled,s=e.scrollbar,a=s.enabled,l=r?i.height:0,h=a?s.height:0;this.handles=[],this.shades=[],this.chart=t,this.setBaseSeries(),this.height=l,this.scrollbarHeight=h,this.scrollbarEnabled=a,this.navigatorEnabled=r,this.navigatorOptions=i,this.scrollbarOptions=s,this.outlineHeight=l+h,this.opposite=k(i.opposite,!r&&t.inverted);var c=this,d=c.baseSeries,p=t.xAxis.length,u=t.yAxis.length,g=d&&d[0]&&d[0].xAxis||t.xAxis[0];t.extraMargin={type:c.opposite?"plotTop":"marginBottom",value:(r||!t.inverted?c.outlineHeight:0)+i.margin},t.inverted&&(t.extraMargin.type=c.opposite?"marginRight":"plotLeft"),t.isDirtyBox=!0,c.navigatorEnabled?(c.xAxis=new o(t,b({breaks:g.options.breaks,ordinal:g.options.ordinal},i.xAxis,{id:"navigator-x-axis",yAxis:"navigator-y-axis",isX:!0,type:"datetime",index:p,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1},t.inverted?{offsets:[h,0,-h,0],width:l}:{offsets:[0,-h,0,h],height:l})),c.yAxis=new o(t,b(i.yAxis,{id:"navigator-y-axis",alignTicks:!1,offset:0,index:u,zoomEnabled:!1},t.inverted?{width:l}:{height:l})),d||i.series.data?c.updateNavigatorSeries():0===t.series.length&&T(t,"redraw",function(e,i){t.series.length>0&&!c.series&&(c.setBaseSeries(),t.redraw=e),e.call(t,i)}),c.renderElements(),c.addMouseEvents()):c.xAxis={translate:function(e,i){var n=t.xAxis[0],o=n.getExtremes(),r=n.len-2*h,s=C("min",n.options.min,o.dataMin),a=C("max",n.options.max,o.dataMax)-s;return i?e*a/r+s:r*(e-s)/a},toPixels:function(t){return this.translate(t)},toValue:function(t){return this.translate(t,!0)},toFixedRange:o.prototype.toFixedRange,fake:!0},t.options.scrollbar.enabled&&(t.scrollbar=c.scrollbar=new w(t.renderer,b(t.options.scrollbar,{margin:c.navigatorEnabled?0:10,vertical:t.inverted}),t),n(c.scrollbar,"changed",function(e){var i=c.size,n=i*this.to,o=i*this.from;c.hasDragged=c.scrollbar.hasDragged,c.render(0,0,o,n),(t.options.scrollbar.liveRedraw||"mousemove"!==e.DOMType)&&setTimeout(function(){c.onMouseUp(e)})})),c.addBaseSeriesEvents(),c.addChartEvents()},getUnionExtremes:function(t){var e,i=this.chart.xAxis[0],n=this.xAxis,o=n.options,r=i.options;return t&&null===i.dataMin||(e={dataMin:k(o&&o.min,C("min",r.min,i.dataMin,n.dataMin,n.min)),dataMax:k(o&&o.max,C("max",r.max,i.dataMax,n.dataMax,n.max))}),e},setBaseSeries:function(t,e){var i=this.chart,n=this.baseSeries=[];t=t||i.options&&i.options.navigator.baseSeries||0,d(i.series||[],function(e,i){e.options.isInternal||!e.options.showInNavigator&&(i!==t&&e.options.id!==t||e.options.showInNavigator===!1)||n.push(e)}),this.xAxis&&!this.xAxis.fake&&this.updateNavigatorSeries(e)},updateNavigatorSeries:function(e){var i,n,o,r=this,s=r.chart,a=r.baseSeries,h=r.navigatorOptions.series,c={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0},p=r.series=t.grep(r.series||[],function(e){var i=e.baseSeries;return t.inArray(i,a)<0?(i&&(M(i,"updatedData",r.updatedDataHandler),delete i.navigatorSeries),e.destroy(),!1):!0});a&&a.length&&d(a,function(t){var d=t.navigatorSeries,u=g({color:t.color},x(h)?l.navigator.series:h);if(!d||r.navigatorOptions.adaptToUpdatedData!==!1){c.name="Navigator "+a.length,i=t.options||{},o=i.navigatorOptions||{},n=b(i,c,u,o);var f=o.data||u.data;r.hasNavigatorData=r.hasNavigatorData||!!f,n.data=f||i.data&&i.data.slice(0),d&&d.options?d.update(n,e):(t.navigatorSeries=s.initSeries(n),t.navigatorSeries.baseSeries=t,p.push(t.navigatorSeries))}}),(h.data&&(!a||!a.length)||x(h))&&(r.hasNavigatorData=!1,h=t.splat(h),d(h,function(t,e){c.name="Navigator "+(p.length+1),n=b(l.navigator.series,{color:s.series[e]&&!s.series[e].options.isInternal&&s.series[e].color||s.options.colors[e]||s.options.colors[0]},c,t),n.data=t.data,n.data&&(r.hasNavigatorData=!0,p.push(s.initSeries(n)))})),this.addBaseSeriesEvents()},addBaseSeriesEvents:function(){var t=this,e=t.baseSeries||[];e[0]&&e[0].xAxis&&n(e[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes),d(e,function(e){n(e,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)}),n(e,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)}),this.navigatorOptions.adaptToUpdatedData!==!1&&e.xAxis&&n(e,"updatedData",this.updatedDataHandler),n(e,"remove",function(){this.navigatorSeries&&(p(t.series,this.navigatorSeries),this.navigatorSeries.remove(!1),delete this.navigatorSeries)})},this)},modifyNavigatorAxisExtremes:function(){var t,e=this.xAxis;e.getExtremes&&(t=this.getUnionExtremes(!0),!t||t.dataMin===e.min&&t.dataMax===e.max||(e.min=t.dataMin,e.max=t.dataMax))},modifyBaseAxisExtremes:function(){var t,e,i=this,n=i.chart.navigator,o=i.getExtremes(),r=o.min,s=o.max,a=o.dataMin,l=o.dataMax,h=s-r,c=n.stickToMin,d=n.stickToMax,p=i.options.overscroll,u=n.series&&n.series[0],g=!!i.setExtremes,f=i.eventArgs&&"rangeSelectorButton"===i.eventArgs.trigger;f||(c&&(e=a,t=e+h),d&&(t=l+p,c||(e=Math.max(t-h,u&&u.xData?u.xData[0]:-Number.MAX_VALUE))),g&&(c||d)&&v(e)&&(i.min=i.userMin=e,i.max=i.userMax=t)),n.stickToMin=n.stickToMax=null},updatedDataHandler:function(){var t=this.chart.navigator,e=this,i=this.navigatorSeries;t.stickToMax=Math.round(t.zoomedMax)>=Math.round(t.size),t.stickToMin=v(e.xAxis.min)&&e.xAxis.min<=e.xData[0]&&(!this.chart.fixedRange||!t.stickToMax),i&&!t.hasNavigatorData&&(i.options.pointStart=e.xData[0],i.setData(e.options.data,!1,null,!1))},addChartEvents:function(){n(this.chart,"redraw",function(){var t=this.navigator,e=t&&(t.baseSeries&&t.baseSeries[0]&&t.baseSeries[0].xAxis||t.scrollbar&&this.xAxis[0]);e&&t.render(e.min,e.max)})},destroy:function(){this.removeEvents(),this.xAxis&&(p(this.chart.xAxis,this.xAxis),p(this.chart.axes,this.xAxis)),this.yAxis&&(p(this.chart.yAxis,this.yAxis),p(this.chart.axes,this.yAxis)),d(this.series||[],function(t){t.destroy&&t.destroy()}),d(["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"],function(t){this[t]&&this[t].destroy&&this[t].destroy(),this[t]=null},this),d([this.handles],function(t){c(t)},this)}},t.Navigator=e,T(o.prototype,"zoom",function(t,e,i){var n,o,r=this.chart,s=r.options,a=s.chart.zoomType,l=s.navigator,c=s.rangeSelector;return this.isXAxis&&(l&&l.enabled||c&&c.enabled)&&("x"===a?r.resetZoomButton="blocked":"y"===a?o=!1:"xy"===a&&this.options.range&&(n=this.previousZoom,h(e)?this.previousZoom=[this.min,this.max]:n&&(e=n[0],i=n[1],delete this.previousZoom))),void 0!==o?o:t.call(this,e,i)}),T(r.prototype,"init",function(t,i,o){n(this,"beforeRender",function(){var t=this.options;(t.navigator.enabled||t.scrollbar.enabled)&&(this.scroller=this.navigator=new e(this))}),t.call(this,i,o)}),T(r.prototype,"setChartSize",function(t){var e,i,n,o,r=this.legend,s=this.navigator;t.apply(this,[].slice.call(arguments,1)),s&&(i=r&&r.options,n=s.xAxis,o=s.yAxis,e=s.scrollbarHeight,this.inverted?(s.left=s.opposite?this.chartWidth-e-s.height:this.spacing[3]+e,s.top=this.plotTop+e):(s.left=this.plotLeft+e,s.top=s.navigatorOptions.top||this.chartHeight-s.height-e-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(i&&"bottom"===i.verticalAlign&&i.enabled&&!i.floating?r.legendHeight+k(i.margin,10):0)),n&&o&&(this.inverted?n.options.left=o.options.left=s.left:n.options.top=o.options.top=s.top,n.setAxisSize(),o.setAxisSize()))}),T(S.prototype,"addPoint",function(t,e,i,n,o){var r=this.options.turboThreshold;r&&this.xData.length>r&&y(e,!0)&&this.chart.navigator&&u(20,!0),t.call(this,e,i,n,o)}),T(r.prototype,"addSeries",function(t,e,i,n){var o=t.call(this,e,!1,n);return this.navigator&&this.navigator.setBaseSeries(null,!1),k(i,!0)&&this.redraw(),o}),T(S.prototype,"update",function(t,e,i){t.call(this,e,!1),this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1),k(i,!0)&&this.chart.redraw()}),r.prototype.callbacks.push(function(t){var e,i=t.navigator;i&&(e=t.xAxis[0].getExtremes(),i.render(e.min,e.max))})}(e),function(t){function e(t){this.init(t)}var i=t.addEvent,n=t.Axis,o=t.Chart,r=t.css,s=t.createElement,a=t.dateFormat,l=t.defaultOptions,h=l.global.useUTC,c=t.defined,d=t.destroyObjectProperties,p=t.discardElement,u=t.each,g=t.extend,f=t.fireEvent,m=t.Date,x=t.isNumber,v=t.merge,y=t.pick,b=t.pInt,k=t.splat,M=t.wrap;g(l,{rangeSelector:{verticalAlign:"top",buttonTheme:{"stroke-width":0,width:28,height:18,padding:2,zIndex:7},floating:!1,x:0,y:0,height:void 0,inputPosition:{align:"right",x:0,y:0},buttonPosition:{align:"left",x:0,y:0},labelStyle:{color:"#666666"}}}),l.lang=v(l.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"}),e.prototype={clickButton:function(t,e){var o,r,s,a,l,c,d,p=this,g=p.chart,f=p.buttonOptions[t],m=g.xAxis[0],v=g.scroller&&g.scroller.getUnionExtremes()||m||{},b=v.dataMin,M=v.dataMax,w=m&&Math.round(Math.min(m.max,y(M,m.max))),S=f.type,A=f._range,T=f.dataGrouping;if(null!==b&&null!==M){if(g.fixedRange=A,T&&(this.forcedDataGrouping=!0,n.prototype.setDataGrouping.call(m||{chart:this.chart},T,!1)),"month"===S||"year"===S)m?(c={range:f,max:w,dataMin:b,dataMax:M},o=m.minFromRange.call(c),x(c.newMax)&&(w=c.newMax)):A=f;else if(A)o=Math.max(w-A,b),w=Math.min(o+A,M);else if("ytd"===S){if(!m)return void i(g,"beforeRender",function(){p.clickButton(t)});void 0===M&&(b=Number.MAX_VALUE,M=Number.MIN_VALUE,u(g.series,function(t){var e=t.xData;b=Math.min(e[0],b),M=Math.max(e[e.length-1],M)}),e=!1),d=p.getYTDExtremes(M,b,h),o=s=d.min,w=d.max}else"all"===S&&m&&(o=b,w=M);o+=f._offsetMin,w+=f._offsetMax,p.setSelected(t),m?m.setExtremes(o,w,y(e,1),null,{trigger:"rangeSelectorButton",rangeSelectorButton:f}):(r=k(g.options.xAxis)[0],l=r.range,r.range=A,a=r.min,r.min=s,i(g,"load",function(){r.range=l,r.min=a}))}},setSelected:function(t){this.selected=this.options.selected=t},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(t){var e=this,n=t.options.rangeSelector,o=n.buttons||[].concat(e.defaultButtons),r=n.selected,s=function(){var t=e.minInput,i=e.maxInput;t&&t.blur&&f(t,"blur"),i&&i.blur&&f(i,"blur")};e.chart=t,e.options=n,e.buttons=[],t.extraTopMargin=n.height,e.buttonOptions=o,this.unMouseDown=i(t.container,"mousedown",s),this.unResize=i(t,"resize",s),u(o,e.computeButtonRange),void 0!==r&&o[r]&&this.clickButton(r,!1),i(t,"load",function(){t.xAxis&&t.xAxis[0]&&i(t.xAxis[0],"setExtremes",function(i){this.max-this.min!==t.fixedRange&&"rangeSelectorButton"!==i.trigger&&"updatedData"!==i.trigger&&e.forcedDataGrouping&&this.setDataGrouping(!1,!1)})})},updateButtonStates:function(){var t=this,e=this.chart,i=e.xAxis[0],n=Math.round(i.max-i.min),o=!i.hasVisibleSeries,r=864e5,s=e.scroller&&e.scroller.getUnionExtremes()||i,a=s.dataMin,l=s.dataMax,c=t.getYTDExtremes(l,a,h),d=c.min,p=c.max,g=t.selected,f=x(g),m=t.options.allButtonsEnabled,v=t.buttons;u(t.buttonOptions,function(t,e){var s,h,c=t._range,u=t.type,x=t.count||1,y=v[e],b=0,k=t._offsetMax-t._offsetMin,M=e===g,w=c>l-a,S=c<i.minRange,A=!1,T=!1,P=c===n;("month"===u||"year"===u)&&n+36e5>={month:28,year:365}[u]*r*x+k&&n-36e5<={month:31,year:366}[u]*r*x+k?P=!0:"ytd"===u?(P=p-d+k===n,A=!M):"all"===u&&(P=i.max-i.min>=l-a,T=!M&&f&&P),s=!m&&(w||S||T||o),h=M&&P||P&&!f&&!A,s?b=3:h&&(f=!0,b=2),y.state!==b&&y.setState(b)})},computeButtonRange:function(t){var e=t.type,i=t.count||1,n={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};n[e]?t._range=n[e]*i:("month"===e||"year"===e)&&(t._range=24*{month:30,year:365}[e]*36e5*i),t._offsetMin=y(t.offsetMin,0),t._offsetMax=y(t.offsetMax,0),t._range+=t._offsetMax-t._offsetMin},setInputValue:function(t,e){var i=this.chart.options.rangeSelector,n=this[t+"Input"];c(e)&&(n.previousValue=n.HCTime,n.HCTime=e),n.value=a(i.inputEditDateFormat||"%Y-%m-%d",n.HCTime),this[t+"DateBox"].attr({text:a(i.inputDateFormat||"%b %e, %Y",n.HCTime)})},showInput:function(t){var e=this.inputGroup,i=this[t+"DateBox"];r(this[t+"Input"],{left:e.translateX+i.x+"px",top:e.translateY+"px",width:i.width-2+"px",height:i.height-2+"px",border:"2px solid silver"})},hideInput:function(t){r(this[t+"Input"],{border:0,width:"1px",height:"1px"}),this.setInputValue(t)},drawInput:function(t){function e(){var t=i.value,e=(u.inputDateParser||Date.parse)(t),n=c.xAxis[0],o=c.scroller&&c.scroller.xAxis?c.scroller.xAxis:n,r=o.dataMin,s=o.dataMax;e!==i.previousValue&&(i.previousValue=e,x(e)||(e=t.split("-"),e=Date.UTC(b(e[0]),b(e[1])-1,b(e[2]))),x(e)&&(h||(e+=60*(new Date).getTimezoneOffset()*1e3),y?e>a.maxInput.HCTime?e=void 0:r>e&&(e=r):e<a.minInput.HCTime?e=void 0:e>s&&(e=s),void 0!==e&&n.setExtremes(y?e:n.min,y?n.max:e,void 0,void 0,{trigger:"rangeSelectorInput"})))}var i,n,o,a=this,c=a.chart,d=c.renderer.style||{},p=c.renderer,u=c.options.rangeSelector,f=l.lang,m=a.div,y="min"===t,k=this.inputGroup;this[t+"Label"]=n=p.label(f[y?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).addClass("highcharts-range-label").attr({padding:2}).add(k),k.offset+=n.width+5,this[t+"DateBox"]=o=p.label("",k.offset).addClass("highcharts-range-input").attr({padding:2,width:u.inputBoxWidth||90,height:u.inputBoxHeight||17,stroke:u.inputBoxBorderColor||"#cccccc","stroke-width":1,"text-align":"center"}).on("click",function(){a.showInput(t),a[t+"Input"].focus()}).add(k),k.offset+=o.width+(y?10:0),this[t+"Input"]=i=s("input",{name:t,className:"highcharts-range-selector",type:"text"},{top:c.plotTop+"px"},m),n.css(v(d,u.labelStyle)),o.css(v({color:"#333333"},d,u.inputStyle)),r(i,g({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:d.fontSize,fontFamily:d.fontFamily,top:"-9999em"},u.inputStyle)),i.onfocus=function(){a.showInput(t)},i.onblur=function(){a.hideInput(t)},i.onchange=e,i.onkeypress=function(t){13===t.keyCode&&e()}},getPosition:function(){var t=this.chart,e=t.options.rangeSelector,i="top"===e.verticalAlign?t.plotTop-t.axisOffset[0]:0;return{buttonTop:i+e.buttonPosition.y,inputTop:i+e.inputPosition.y-10}},getYTDExtremes:function(t,e,i){var n,o=new m(t),r=o[m.hcGetFullYear](),s=i?m.UTC(r,0,1):+new m(r,0,1);return n=Math.max(e||0,s),o=o.getTime(),{max:Math.min(t||o,o),min:n}},render:function(t,e){var i,n,o,r,a,h,c,d=this,p=d.chart,g=p.renderer,f=p.container,m=p.options,x=m.exporting&&m.exporting.enabled!==!1&&m.navigation&&m.navigation.buttonOptions,v=l.lang,b=d.div,k=m.rangeSelector,M=k.floating,w=d.buttons,S=d.inputGroup,A=k.buttonTheme,T=k.buttonPosition,P=k.inputPosition,C=k.inputEnabled,L=A&&A.states,O=p.plotLeft,D=d.buttonGroup,I=d.rendered,B=d.options.verticalAlign,z=p.legend,E=z&&z.options,R=T.y,G=P.y,X=I||!1,W=0,H=0;if(k.enabled!==!1){if(I||(d.group=n=g.g("range-selector-group").attr({zIndex:7}).add(),d.buttonGroup=D=g.g("range-selector-buttons").add(n),d.zoomText=g.text(v.rangeSelectorZoom,y(O+T.x,O),15).css(k.labelStyle).add(D),i=y(O+T.x,O)+d.zoomText.getBBox().width+5,u(d.buttonOptions,function(t,e){w[e]=g.button(t.text,i,0,function(){var i,n=t.events&&t.events.click;n&&(i=n.call(t)),i!==!1&&d.clickButton(e),d.isActive=!0},A,L&&L.hover,L&&L.select,L&&L.disabled).attr({"text-align":"center"}).add(D),i+=w[e].width+y(k.buttonSpacing,5)}),C!==!1&&(d.div=b=s("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(b,f),d.inputGroup=S=g.g("input-group").add(n),S.offset=0,d.drawInput("min"),d.drawInput("max"))),O=p.plotLeft-p.spacing[3],d.updateButtonStates(),x&&this.titleCollision(p)&&"top"===B&&"right"===T.align&&T.y+D.getBBox().height-12<(x.y||0)+x.height&&(W=-40),"left"===T.align?c=T.x-p.spacing[3]:"right"===T.align&&(c=T.x+W-p.spacing[1]),D.align({y:T.y,width:D.getBBox().width,align:T.align,x:c},!0,p.spacingBox),d.group.placed=X,d.buttonGroup.placed=X,C!==!1){var N,Y,F,j;W=x&&this.titleCollision(p)&&"top"===B&&"right"===P.align&&P.y-S.getBBox().height-12<(x.y||0)+x.height+p.spacing[0]?-40:0,"left"===P.align?c=O:"right"===P.align&&(c=-Math.max(p.axisOffset[1],-W)),S.align({y:P.y,width:S.getBBox().width,align:P.align,x:P.x+c-2},!0,p.spacingBox),N=S.alignAttr.translateX+S.alignOptions.x-W+S.getBBox().x+2,Y=S.alignOptions.width,F=D.alignAttr.translateX+D.getBBox().x,j=D.getBBox().width+20,(P.align===T.align||F+j>N&&N+Y>F&&R<G+S.getBBox().height)&&S.attr({translateX:S.alignAttr.translateX+(p.axisOffset[1]>=-W?0:-W),translateY:S.alignAttr.translateY+D.getBBox().height+10}),d.setInputValue("min",t),d.setInputValue("max",e),d.inputGroup.placed=X}d.group.align({verticalAlign:B},!0,p.spacingBox),o=d.group.getBBox().height+20,r=d.group.alignAttr.translateY,"bottom"===B&&(a=E&&"bottom"===E.verticalAlign&&E.enabled&&!E.floating?z.legendHeight+y(E.margin,10):0,o=o+a-20,H=r-o-(M?0:k.y)-10),"top"===B?(M&&(H=0),p.titleOffset&&(H=p.titleOffset+p.options.title.margin),H+=p.margin[0]-p.spacing[0]||0):"middle"===B&&(G===R?H=0>G?r+h:r:(G||R)&&(0>G||0>R?H-=Math.min(G,R):H=r-o+h)),d.group.translate(k.x,k.y+Math.floor(H)),C!==!1&&(d.minInput.style.marginTop=d.group.translateY+"px",d.maxInput.style.marginTop=d.group.translateY+"px"),d.rendered=!0}},getHeight:function(){var t,e=this,i=e.options,n=e.group,o=i.inputPosition,r=i.buttonPosition,s=i.y,a=r.y,l=o.y,h=0;return h=n?n.getBBox(!0).height+13+s:0,t=Math.min(l,a),(0>l&&0>a||l>0&&a>0)&&(h+=Math.abs(t)),h},titleCollision:function(t){return!(t.options.title.text||t.options.subtitle.text)},update:function(t){var e=this.chart;v(!0,e.options.rangeSelector,t),this.destroy(),this.init(e),e.rangeSelector.render()},destroy:function(){var i=this,n=i.minInput,o=i.maxInput;i.unMouseDown(),i.unResize(),d(i.buttons),n&&(n.onfocus=n.onblur=n.onchange=null),o&&(o.onfocus=o.onblur=o.onchange=null),t.objectEach(i,function(t,n){t&&"chart"!==n&&(t.destroy?t.destroy():t.nodeType&&p(this[n])),t!==e.prototype[n]&&(i[n]=null)},this)}},n.prototype.toFixedRange=function(t,e,i,n){var o=this.chart&&this.chart.fixedRange,r=y(i,this.translate(t,!0,!this.horiz)),s=y(n,this.translate(e,!0,!this.horiz)),a=o&&(s-r)/o;return a>.7&&1.3>a&&(n?r=s-o:s=r+o),x(r)&&x(s)||(r=s=void 0),{min:r,max:s}},n.prototype.minFromRange=function(){var t,e,i,n=this.range,o=n.type,r={month:"Month",year:"FullYear"}[o],s=this.max,a=function(t,e){var i=new Date(t),n=i["get"+r]();return i["set"+r](n+e),n===i["get"+r]()&&i.setDate(0),i.getTime()-t};return x(n)?(t=s-n,i=n):(t=s+a(s,-n.count),this.chart&&(this.chart.fixedRange=s-t)),e=y(this.dataMin,Number.MIN_VALUE),x(t)||(t=e),e>=t&&(t=e,void 0===i&&(i=a(t,n.count)),this.newMax=Math.min(t+i,this.dataMax)),x(s)||(t=void 0),t},M(o.prototype,"init",function(t,n,o){i(this,"init",function(){this.options.rangeSelector.enabled&&(this.rangeSelector=new e(this))}),t.call(this,n,o)}),M(o.prototype,"render",function(t,e,i){var n,o=this,r=o.axes,s=o.rangeSelector;s&&(u(r,function(t){t.updateNames(),t.setScale()}),o.getAxisMargins(),s.render(),n=s.options.verticalAlign,s.options.floating||("bottom"===n?this.extraBottomMargin=!0:"middle"!==n&&(this.extraTopMargin=!0))),t.call(this,e,i)}),M(o.prototype,"update",function(e,i,n,o){var r,s=this,a=s.rangeSelector;this.extraBottomMargin=!1,this.extraTopMargin=!1,a&&(a.render(),r=i.rangeSelector&&i.rangeSelector.verticalAlign||a.options&&a.options.verticalAlign,a.options.floating||("bottom"===r?this.extraBottomMargin=!0:"middle"!==r&&(this.extraTopMargin=!0))),e.call(this,t.merge(!0,i,{chart:{marginBottom:y(i.chart&&i.chart.marginBottom,s.margin.bottom),spacingBottom:y(i.chart&&i.chart.spacingBottom,s.spacing.bottom)}}),n,o)}),M(o.prototype,"redraw",function(t,e,i){var n,o=this,r=o.rangeSelector;r&&!r.options.floating&&(r.render(),n=r.options.verticalAlign,"bottom"===n?this.extraBottomMargin=!0:"middle"!==n&&(this.extraTopMargin=!0)),t.call(this,e,i)}),o.prototype.adjustPlotArea=function(){var t,e=this,i=e.rangeSelector;this.rangeSelector&&(t=i.getHeight(),this.extraTopMargin&&(this.plotTop+=t),this.extraBottomMargin&&(this.marginBottom+=t))},o.prototype.callbacks.push(function(t){function e(){n=t.xAxis[0].getExtremes(),x(n.min)&&s.render(n.min,n.max)}var n,o,r,s=t.rangeSelector;s&&(r=i(t.xAxis[0],"afterSetExtremes",function(t){s.render(t.min,t.max)}),o=i(t,"redraw",e),e()),i(t,"destroy",function(){s&&(o(),r())})}),t.RangeSelector=e}(e),function(t){var e=t.arrayMax,i=t.arrayMin,n=t.Axis,o=t.Chart,r=t.defined,s=t.each,a=t.extend,l=t.format,h=t.grep,c=t.inArray,d=t.isNumber,p=t.isString,u=t.map,g=t.merge,f=t.pick,m=t.Point,x=t.Renderer,v=t.Series,y=t.splat,b=t.SVGRenderer,k=t.VMLRenderer,M=t.wrap,w=v.prototype,S=w.init,A=w.processData,T=m.prototype.tooltipFormatter;t.StockChart=t.stockChart=function(e,i,n){var r,s=p(e)||e.nodeName,a=arguments[s?1:0],l=a.series,h=t.getOptions(),c=f(a.navigator&&a.navigator.enabled,h.navigator.enabled,!0),d=c?{startOnTick:!1,endOnTick:!1}:null,m={marker:{enabled:!1,radius:2}},x={shadow:!1,borderWidth:0};return a.xAxis=u(y(a.xAxis||{}),function(t){return g({minPadding:0,maxPadding:0,overscroll:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},h.xAxis,t,{type:"datetime",categories:null},d)}),a.yAxis=u(y(a.yAxis||{}),function(t){return r=f(t.opposite,!0),g({labels:{y:-2},opposite:r,showLastLabel:!1,title:{text:null}},h.yAxis,t)}),a.series=null,a=g({chart:{panning:!0,pinchType:"x"},navigator:{enabled:c},scrollbar:{enabled:f(h.scrollbar.enabled,!0)},rangeSelector:{enabled:f(h.rangeSelector.enabled,!0)},title:{text:null},tooltip:{split:f(h.tooltip.split,!0),crosshairs:!0},legend:{enabled:!1},plotOptions:{line:m,spline:m,area:m,areaspline:m,arearange:m,areasplinerange:m,column:x,columnrange:x,candlestick:x,ohlc:x}},a,{isStock:!0}),a.series=l,s?new o(e,a,n):new o(a,i)},M(n.prototype,"autoLabelAlign",function(t){var e,i=this.chart,n=this.options,o=i._labelPanes=i._labelPanes||{},r=this.options.labels;return this.chart.options.isStock&&"yAxis"===this.coll&&(e=n.top+","+n.height,!o[e]&&r.enabled)?(15===r.x&&(r.x=0),void 0===r.align&&(r.align="right"),o[e]=this,"right"):t.apply(this,[].slice.call(arguments,1))}),M(n.prototype,"destroy",function(t){var e=this.chart,i=this.options&&this.options.top+","+this.options.height;return i&&e._labelPanes&&e._labelPanes[i]===this&&delete e._labelPanes[i],t.apply(this,Array.prototype.slice.call(arguments,1))}),M(n.prototype,"getPlotLinePath",function(e,i,n,o,a,l){function h(t){var e="xAxis"===t?"yAxis":"xAxis",i=M.options[e];return d(i)?[S[e][i]]:p(i)?[S.get(i)]:u(w,function(t){return t[e]})}var g,m,x,v,y,b,k,M=this,w=this.isLinked&&!this.series?this.linkedParent.series:this.series,S=M.chart,A=S.renderer,T=M.left,P=M.top,C=[],L=[];return"xAxis"!==M.coll&&"yAxis"!==M.coll?e.apply(this,[].slice.call(arguments,1)):(L=h(M.coll),y=M.isXAxis?S.yAxis:S.xAxis,s(y,function(t){if(r(t.options.id)?-1===t.options.id.indexOf("navigator"):!0){var e=t.isXAxis?"yAxis":"xAxis",i=r(t.options[e])?S[e][t.options[e]]:S[e][0];M===i&&L.push(t)}}),b=L.length?[]:[M.isXAxis?S.yAxis[0]:S.xAxis[0]],s(L,function(e){-1!==c(e,b)||t.find(b,function(t){return t.pos===e.pos&&t.len&&e.len})||b.push(e)}),k=f(l,M.translate(i,null,null,o)),d(k)&&(M.horiz?s(b,function(t){var e;m=t.pos,v=m+t.len,g=x=Math.round(k+M.transB),(T>g||g>T+M.width)&&(a?g=x=Math.min(Math.max(T,g),T+M.width):e=!0),e||C.push("M",g,m,"L",x,v)}):s(b,function(t){var e;g=t.pos,x=g+t.len,m=v=Math.round(P+M.height-k),(P>m||m>P+M.height)&&(a?m=v=Math.min(Math.max(P,m),M.top+M.height):e=!0),e||C.push("M",g,m,"L",x,v)})),C.length>0?A.crispPolyLine(C,n||1):null)}),b.prototype.crispPolyLine=function(t,e){var i;for(i=0;i<t.length;i+=6)t[i+1]===t[i+4]&&(t[i+1]=t[i+4]=Math.round(t[i+1])-e%2/2),t[i+2]===t[i+5]&&(t[i+2]=t[i+5]=Math.round(t[i+2])+e%2/2);return t},x===k&&(k.prototype.crispPolyLine=b.prototype.crispPolyLine),M(n.prototype,"hideCrosshair",function(t,e){t.call(this,e),this.crossLabel&&(this.crossLabel=this.crossLabel.hide())}),M(n.prototype,"drawCrosshair",function(t,e,i){if(t.call(this,e,i),r(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var n,o,s,h,c,d,p=this.chart,u=this.options.crosshair.label,g=this.horiz,m=this.opposite,x=this.left,v=this.top,y=this.crossLabel,b=u.format,k="",M="inside"===this.options.tickPosition,w=this.crosshair.snap!==!1,S=0;e||(e=this.cross&&this.cross.e),c=g?"center":m?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",y||(y=this.crossLabel=p.renderer.label(null,null,null,u.shape||"callout").addClass("highcharts-crosshair-label"+(this.series[0]&&" highcharts-color-"+this.series[0].colorIndex)).attr({align:u.align||c,padding:f(u.padding,8),r:f(u.borderRadius,3),zIndex:2}).add(this.labelGroup),y.attr({fill:u.backgroundColor||this.series[0]&&this.series[0].color||"#666666",stroke:u.borderColor||"","stroke-width":u.borderWidth||0}).css(a({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},u.style))),g?(n=w?i.plotX+x:e.chartX,o=v+(m?0:this.height)):(n=m?this.width+x:0,o=w?i.plotY+v:e.chartY),b||u.formatter||(this.isDatetimeAxis&&(k="%b %d, %Y"),b="{value"+(k?":"+k:"")+"}"),d=w?i[this.isXAxis?"x":"y"]:this.toValue(g?e.chartX:e.chartY),y.attr({text:b?l(b,{value:d}):u.formatter.call(this,d),x:n,y:o,visibility:"visible"}),s=y.getBBox(),g?(M&&!m||!M&&m)&&(o=y.y-s.height):o=y.y-s.height/2,h=g?{left:x-s.x,right:x+this.width-s.x}:{left:"left"===this.labelAlign?x:0,right:"right"===this.labelAlign?x+this.width:p.chartWidth},y.translateX<h.left&&(S=h.left-y.translateX),y.translateX+s.width>=h.right&&(S=-(y.translateX+s.width-h.right)),y.attr({x:n+S,y:o,anchorX:g?n:this.opposite?0:p.chartWidth,anchorY:g?this.opposite?p.chartHeight:0:o+s.height/2})}}),w.init=function(){S.apply(this,arguments),this.setCompare(this.options.compare)},w.setCompare=function(t){this.modifyValue="value"===t||"percent"===t?function(e,i){var n=this.compareValue;return void 0!==e&&void 0!==n?("value"===t?e-=n:e=100*(e/n)-(100===this.options.compareBase?0:100),i&&(i.change=e),e):void 0}:null,this.userOptions.compare=t,this.chart.hasRendered&&(this.isDirty=!0)},w.processData=function(){var t,e,i,n,o,r=this,s=-1,a=r.options.compareStart===!0?0:1;if(A.apply(this,arguments),r.xAxis&&r.processedYData)for(e=r.processedXData,i=r.processedYData,n=i.length,r.pointArrayMap&&(s=c("close",r.pointArrayMap),-1===s&&(s=c(r.pointValKey||"y",r.pointArrayMap))),t=0;n-a>t;t++)if(o=i[t]&&s>-1?i[t][s]:i[t],d(o)&&e[t+a]>=r.xAxis.min&&0!==o){r.compareValue=o;break}},M(w,"getExtremes",function(t){var n;t.apply(this,[].slice.call(arguments,1)),this.modifyValue&&(n=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=i(n),this.dataMax=e(n))}),n.prototype.setCompare=function(t,e){this.isXAxis||(s(this.series,function(e){e.setCompare(t)}),f(e,!0)&&this.chart.redraw())},m.prototype.tooltipFormatter=function(e){var i=this;return e=e.replace("{point.change}",(i.change>0?"+":"")+t.numberFormat(i.change,f(i.series.tooltipOptions.changeDecimals,2))),T.apply(this,[e])},M(v.prototype,"render",function(t){this.chart.is3d&&this.chart.is3d()||this.chart.polar||!this.xAxis||this.xAxis.isRadial||(!this.clipBox&&this.animate?(this.clipBox=g(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]?this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}):this.clipBox&&(this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len)),t.call(this)}),M(o.prototype,"getSelectedPoints",function(t){var e=t.call(this);return s(this.series,function(t){t.hasGroupedData&&(e=e.concat(h(t.points||[],function(t){return t.selected})))}),e}),M(o.prototype,"update",function(t,e){return"scrollbar"in e&&this.navigator&&(g(!0,this.options.scrollbar,e.scrollbar),this.navigator.update({},!1),delete e.scrollbar),t.apply(this,Array.prototype.slice.call(arguments,1))})}(e),e});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(t){var i=t.deg2rad,a=t.isNumber,e=t.pick,o=t.relativeLength;t.CenteredSeriesMixin={getCenter:function(){var t,i,a,r=this.options,s=this.chart,n=2*(r.slicedOffset||0),l=s.plotWidth-2*n,h=s.plotHeight-2*n,p=r.center,c=[e(p[0],"50%"),e(p[1],"50%"),r.size||"100%",r.innerSize||0],d=Math.min(l,h);for(i=0;4>i;++i)a=c[i],t=2>i||2===i&&/%$/.test(a),c[i]=o(a,[l,h,d,c[2]][i])+(t?n:0);return c[3]>c[2]&&(c[3]=c[2]),c},getStartAndEndRadians:function(t,e){var o=a(t)?t:0,r=a(e)&&e>o&&360>e-o?e:o+360,s=-90;return{start:i*(o+s),end:i*(r+s)}}}}(t),function(t){function i(t,i){this.init(t,i)}var a=t.CenteredSeriesMixin,e=t.each,o=t.extend,r=t.merge,s=t.splat;o(i.prototype,{coll:"pane",init:function(t,i){this.chart=i,this.background=[],i.pane.push(this),this.setOptions(t)},setOptions:function(t){this.options=t=r(this.defaultOptions,this.chart.angular?{background:{}}:void 0,t)},render:function(){var t,i,a=this.options,e=this.options.background,o=this.chart.renderer;if(this.group||(this.group=o.g("pane-group").attr({zIndex:a.zIndex||0}).add()),this.updateCenter(),e)for(e=s(e),t=Math.max(e.length,this.background.length||0),i=0;t>i;i++)e[i]&&this.axis?this.renderBackground(r(this.defaultBackgroundOptions,e[i]),i):this.background[i]&&(this.background[i]=this.background[i].destroy(),this.background.splice(i,1))},renderBackground:function(t,i){var a="animate";this.background[i]||(this.background[i]=this.chart.renderer.path().add(this.group),a="attr"),this.background[i][a]({d:this.axis.getPlotBandPath(t.from,t.to,t)}).attr({fill:t.backgroundColor,stroke:t.borderColor,"stroke-width":t.borderWidth,class:"highcharts-pane "+(t.className||"")})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},updateCenter:function(t){this.center=(t||this.axis||{}).center=a.getCenter.call(this)},update:function(t,i){r(!0,this.options,t),this.setOptions(this.options),this.render(),e(this.chart.axes,function(t){t.pane===this&&(t.pane=null,t.update({},i))},this)}}),t.Pane=i}(t),function(t){var i,a,e=t.Axis,o=t.each,r=t.extend,s=t.map,n=t.merge,l=t.noop,h=t.pick,p=t.pInt,c=t.Tick,d=t.wrap,u=e.prototype,g=c.prototype;i={getOffset:l,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:l,setCategories:l,setTitle:l},a={defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null,style:{textOverflow:"none"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(t){var i=this.options=n(this.defaultOptions,this.defaultRadialOptions,t);i.plotBands||(i.plotBands=[])},getOffset:function(){u.getOffset.call(this),this.chart.axisOffset[this.side]=0},getLinePath:function(t,i){var a,e,o=this.center,r=this.chart,s=h(i,o[2]/2-this.offset);return this.isCircular||void 0!==i?(e=this.chart.renderer.symbols.arc(this.left+o[0],this.top+o[1],s,s,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0}),e.xBounds=[this.left+o[0]],e.yBounds=[this.top+o[1]-s]):(a=this.postTranslate(this.angleRad,s),e=["M",o[0]+r.plotLeft,o[1]+r.plotTop,"L",a.x,a.y]),e},setAxisTranslation:function(){u.setAxisTranslation.call(this),this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)},beforeSetTickPositions:function(){this.autoConnect=this.isCircular&&void 0===h(this.userMax,this.options.max)&&this.endAngleRad-this.startAngleRad===2*Math.PI,this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){u.setAxisSize.call(this),this.isRadial&&(this.pane.updateCenter(this),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*h(this.sector,1)/2)},getPosition:function(t,i){return this.postTranslate(this.isCircular?this.translate(t):this.angleRad,h(this.isCircular?i:this.translate(t),this.center[2]/2)-this.offset)},postTranslate:function(t,i){var a=this.chart,e=this.center;return t=this.startAngleRad+t,{x:a.plotLeft+e[0]+Math.cos(t)*i,y:a.plotTop+e[1]+Math.sin(t)*i}},getPlotBandPath:function(t,i,a){var e,o,r,n,l=this.center,c=this.startAngleRad,d=l[2]/2,u=[h(a.outerRadius,"100%"),a.innerRadius,h(a.thickness,10)],g=Math.min(this.offset,0),f=/%$/,m=this.isCircular;return"polygon"===this.options.gridLineInterpolation?n=this.getPlotLinePath(t).concat(this.getPlotLinePath(i,!0)):(t=Math.max(t,this.min),i=Math.min(i,this.max),m||(u[0]=this.translate(t),u[1]=this.translate(i)),u=s(u,function(t){return f.test(t)&&(t=p(t,10)*d/100),t}),"circle"!==a.shape&&m?(e=c+this.translate(t),o=c+this.translate(i)):(e=-Math.PI/2,o=1.5*Math.PI,r=!0),u[0]-=g,u[2]-=g,n=this.chart.renderer.symbols.arc(this.left+l[0],this.top+l[1],u[0],u[0],{start:Math.min(e,o),end:Math.max(e,o),innerR:h(u[1],u[0]-u[2]),open:r})),n},getPlotLinePath:function(t,i){var a,e,r,s,n=this,l=n.center,h=n.chart,p=n.getPosition(t);return n.isCircular?s=["M",l[0]+h.plotLeft,l[1]+h.plotTop,"L",p.x,p.y]:"circle"===n.options.gridLineInterpolation?(t=n.translate(t),t&&(s=n.getLinePath(0,t))):(o(h.xAxis,function(t){t.pane===n.pane&&(a=t)}),s=[],t=n.translate(t),r=a.tickPositions,a.autoConnect&&(r=r.concat([r[0]])),i&&(r=[].concat(r).reverse()),o(r,function(i,o){e=a.getPosition(i,t),s.push(o?"L":"M",e.x,e.y)})),s},getTitlePosition:function(){var t=this.center,i=this.chart,a=this.options.title;return{x:i.plotLeft+t[0]+(a.x||0),y:i.plotTop+t[1]-{high:.5,middle:.25,low:0}[a.align]*t[2]+(a.y||0)}}},d(u,"init",function(t,e,o){var s,l,p=e.angular,c=e.polar,d=o.isX,u=p&&d,g=e.options,f=o.pane||0,m=this.pane=e.pane&&e.pane[f],y=m&&m.options;p?(r(this,u?i:a),s=!d,s&&(this.defaultRadialOptions=this.defaultRadialGaugeOptions)):c&&(r(this,a),s=d,this.defaultRadialOptions=d?this.defaultRadialXOptions:n(this.defaultYAxisOptions,this.defaultRadialYOptions)),p||c?(this.isRadial=!0,e.inverted=!1,g.chart.zoomType=null):this.isRadial=!1,m&&s&&(m.axis=this),t.call(this,e,o),!u&&m&&(p||c)&&(l=this.options,this.angleRad=(l.angle||0)*Math.PI/180,this.startAngleRad=(y.startAngle-90)*Math.PI/180,this.endAngleRad=(h(y.endAngle,y.startAngle+360)-90)*Math.PI/180,this.offset=l.offset||0,this.isCircular=s)}),d(u,"autoLabelAlign",function(t){return this.isRadial?void 0:t.apply(this,[].slice.call(arguments,1))}),d(g,"getPosition",function(t,i,a,e,o){var r=this.axis;return r.getPosition?r.getPosition(a):t.call(this,i,a,e,o)}),d(g,"getLabelPosition",function(t,i,a,e,o,r,s,n,l){var p,c=this.axis,d=r.y,u=20,g=r.align,f=(c.translate(this.pos)+c.startAngleRad+Math.PI/2)/Math.PI*180%360;return c.isRadial?(p=c.getPosition(this.pos,c.center[2]/2+h(r.distance,-25)),"auto"===r.rotation?e.attr({rotation:f}):null===d&&(d=c.chart.renderer.fontMetrics(e.styles.fontSize).b-e.getBBox().height/2),null===g&&(c.isCircular?(this.label.getBBox().width>c.len*c.tickInterval/(c.max-c.min)&&(u=0),g=f>u&&180-u>f?"left":f>180+u&&360-u>f?"right":"center"):g="center",e.attr({align:g})),p.x+=r.x,p.y+=d):p=t.call(this,i,a,e,o,r,s,n,l),p}),d(g,"getMarkPath",function(t,i,a,e,o,r,s){var n,l,h=this.axis;return h.isRadial?(n=h.getPosition(this.pos,h.center[2]/2+e),l=["M",i,a,"L",n.x,n.y]):l=t.call(this,i,a,e,o,r,s),l})}(t),function(t){var i=t.each,a=t.noop,e=t.pick,o=t.defined,r=t.Series,s=t.seriesType,n=t.seriesTypes,l=r.prototype,h=t.Point.prototype;s("arearange","area",{lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0}},{pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(t){return[t.low,t.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(t){var i=this.chart,a=this.xAxis.postTranslate(t.rectPlotX,this.yAxis.len-t.plotHigh);t.plotHighX=a.x-i.plotLeft,t.plotHigh=a.y-i.plotTop,t.plotLowX=t.plotX},translate:function(){var t=this,a=t.yAxis,e=!!t.modifyValue;n.area.prototype.translate.apply(t),i(t.points,function(i){var o=i.low,r=i.high,s=i.plotY;null===r||null===o?(i.isNull=!0,i.plotY=null):(i.plotLow=s,i.plotHigh=a.translate(e?t.modifyValue(r,i):r,0,1,0,1),e&&(i.yBottom=i.plotHigh))}),this.chart.polar&&i(this.points,function(i){t.highToXY(i),i.tooltipPos=[(i.plotHighX+i.plotLowX)/2,(i.plotHigh+i.plotLow)/2]})},getGraphPath:function(t){var i,a,o,r,s,l,h,p=[],c=[],d=n.area.prototype.getGraphPath,u=this.options,g=this.chart.polar&&u.connectEnds!==!1,f=u.connectNulls,m=u.step;for(t=t||this.points,i=t.length,i=t.length;i--;)a=t[i],a.isNull||g||f||t[i+1]&&!t[i+1].isNull||c.push({plotX:a.plotX,plotY:a.plotY,doCurve:!1}),o={polarPlotY:a.polarPlotY,rectPlotX:a.rectPlotX,yBottom:a.yBottom,plotX:e(a.plotHighX,a.plotX),plotY:a.plotHigh,isNull:a.isNull},c.push(o),p.push(o),a.isNull||g||f||t[i-1]&&!t[i-1].isNull||c.push({plotX:a.plotX,plotY:a.plotY,doCurve:!1});return s=d.call(this,t),m&&(m===!0&&(m="left"),u.step={left:"right",center:"center",right:"left"}[m]),l=d.call(this,p),h=d.call(this,c),u.step=m,r=[].concat(s,l),this.chart.polar||"M"!==h[0]||(h[0]="L"),this.graphPath=r,this.areaPath=s.concat(h),r.isArea=!0,r.xMap=s.xMap,this.areaPath.xMap=s.xMap,r},drawDataLabels:function(){var t,i,a,e=this.data,o=e.length,r=[],s=this.options.dataLabels,n=s.align,h=s.verticalAlign,p=s.inside,c=this.chart.inverted;if(s.enabled||this._hasPointLabels){for(t=o;t--;)i=e[t],i&&(a=p?i.plotHigh<i.plotLow:i.plotHigh>i.plotLow,i.y=i.high,i._plotY=i.plotY,i.plotY=i.plotHigh,r[t]=i.dataLabel,i.dataLabel=i.dataLabelUpper,i.below=a,c?n||(s.align=a?"right":"left"):h||(s.verticalAlign=a?"top":"bottom"),s.x=s.xHigh,s.y=s.yHigh);for(l.drawDataLabels&&l.drawDataLabels.apply(this,arguments),t=o;t--;)i=e[t],i&&(a=p?i.plotHigh<i.plotLow:i.plotHigh>i.plotLow,i.dataLabelUpper=i.dataLabel,i.dataLabel=r[t],i.y=i.low,i.plotY=i._plotY,i.below=!a,c?n||(s.align=a?"left":"right"):h||(s.verticalAlign=a?"bottom":"top"),s.x=s.xLow,s.y=s.yLow);l.drawDataLabels&&l.drawDataLabels.apply(this,arguments)}s.align=n,s.verticalAlign=h},alignDataLabel:function(){n.column.prototype.alignDataLabel.apply(this,arguments)},drawPoints:function(){var t,i,a=this,e=a.points.length;for(l.drawPoints.apply(a,arguments),i=0;e>i;)t=a.points[i],t.lowerGraphic=t.graphic,t.graphic=t.upperGraphic,t._plotY=t.plotY,t._plotX=t.plotX,t.plotY=t.plotHigh,o(t.plotHighX)&&(t.plotX=t.plotHighX),i++;for(l.drawPoints.apply(a,arguments),i=0;e>i;)t=a.points[i],t.upperGraphic=t.graphic,t.graphic=t.lowerGraphic,t.plotY=t._plotY,t.plotX=t._plotX,i++},setStackedPoints:a},{setState:function(){var t=this.state,i=this.series,a=i.chart.polar;o(this.plotHigh)||(this.plotHigh=i.yAxis.toPixels(this.high,!0)),o(this.plotLow)||(this.plotLow=this.plotY=i.yAxis.toPixels(this.low,!0)),h.setState.apply(this,arguments),this.graphic=this.upperGraphic,this.plotY=this.plotHigh,a&&(this.plotX=this.plotHighX),this.state=t,i.stateMarkerGraphic&&(i.lowerStateMarkerGraphic=i.stateMarkerGraphic,i.stateMarkerGraphic=i.upperStateMarkerGraphic),h.setState.apply(this,arguments),this.plotY=this.plotLow,this.graphic=this.lowerGraphic,a&&(this.plotX=this.plotLowX),i.stateMarkerGraphic&&(i.upperStateMarkerGraphic=i.stateMarkerGraphic,i.stateMarkerGraphic=i.lowerStateMarkerGraphic,i.lowerStateMarkerGraphic=void 0)},haloPath:function(){var t=this.series.chart.polar,i=[];return this.plotY=this.plotLow,t&&(this.plotX=this.plotLowX),i=h.haloPath.apply(this,arguments),this.plotY=this.plotHigh,t&&(this.plotX=this.plotHighX),i=i.concat(h.haloPath.apply(this,arguments))},destroy:function(){return this.upperGraphic&&(this.upperGraphic=this.upperGraphic.destroy()),h.destroy.apply(this,arguments)}})}(t),function(t){var i=t.seriesType,a=t.seriesTypes;i("areasplinerange","arearange",null,{getPointSpline:a.spline.prototype.getPointSpline})}(t),function(t){var i=t.defaultPlotOptions,a=t.each,e=t.merge,o=t.noop,r=t.pick,s=t.seriesType,n=t.seriesTypes,l=n.column.prototype,h={pointRange:null,marker:null,states:{hover:{halo:!1}}};s("columnrange","arearange",e(i.column,i.arearange,h),{translate:function(){function t(t){return Math.min(Math.max(-d,t),d)}var i,e,o=this,s=o.yAxis,n=o.xAxis,h=n.startAngleRad,p=o.chart,c=o.xAxis.isRadial,d=Math.max(p.chartWidth,p.chartHeight)+999;l.translate.apply(o),a(o.points,function(a){var l,d,u,g=a.shapeArgs,f=o.options.minPointLength;a.plotHigh=e=t(s.translate(a.high,0,1,0,1)),a.plotLow=t(a.plotY),u=e,d=r(a.rectPlotY,a.plotY)-e,Math.abs(d)<f?(l=f-d,d+=l,u-=l/2):0>d&&(d*=-1,u-=d),c?(i=a.barX+h,a.shapeType="path",a.shapeArgs={d:o.polarArc(u+d,u,i,i+a.pointWidth)}):(g.height=d,g.y=u,a.tooltipPos=p.inverted?[s.len+s.pos-p.plotLeft-u-d/2,n.len+n.pos-p.plotTop-g.x-g.width/2,d]:[n.left-p.plotLeft+g.x+g.width/2,s.pos-p.plotTop+u+d/2,d])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:o,getSymbol:o,crispCol:l.crispCol,drawPoints:l.drawPoints,drawTracker:l.drawTracker,getColumnMetrics:l.getColumnMetrics,pointAttribs:l.pointAttribs,animate:function(){return l.animate.apply(this,arguments)},polarArc:function(){return l.polarArc.apply(this,arguments)},translate3dPoints:function(){return l.translate3dPoints.apply(this,arguments)},translate3dShapes:function(){return l.translate3dShapes.apply(this,arguments)}},{setState:l.pointClass.prototype.setState})}(t),function(t){var i=t.each,a=t.isNumber,e=t.merge,o=t.noop,r=t.pick,s=t.pInt,n=t.Series,l=t.seriesType,h=t.TrackerMixin;l("gauge","line",{dataLabels:{enabled:!0,defer:!1,y:15,borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2,borderWidth:1,borderColor:"#cccccc"},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1},{angular:!0,directTouch:!0,drawGraph:o,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var t=this,o=t.yAxis,n=t.options,l=o.center;t.generatePoints(),i(t.points,function(t){var i=e(n.dial,t.dial),h=s(r(i.radius,80))*l[2]/200,p=s(r(i.baseLength,70))*h/100,c=s(r(i.rearLength,10))*h/100,d=i.baseWidth||3,u=i.topWidth||1,g=n.overshoot,f=o.startAngleRad+o.translate(t.y,null,null,null,!0);a(g)?(g=g/180*Math.PI,f=Math.max(o.startAngleRad-g,Math.min(o.endAngleRad+g,f))):n.wrap===!1&&(f=Math.max(o.startAngleRad,Math.min(o.endAngleRad,f))),f=180*f/Math.PI,t.shapeType="path",t.shapeArgs={d:i.path||["M",-c,-d/2,"L",p,-d/2,h,-u/2,h,u/2,p,d/2,-c,d/2,"z"],translateX:l[0],translateY:l[1],rotation:f},t.plotX=l[0],t.plotY=l[1]})},drawPoints:function(){var t=this,a=t.yAxis.center,o=t.pivot,s=t.options,n=s.pivot,l=t.chart.renderer;i(t.points,function(i){var a=i.graphic,o=i.shapeArgs,r=o.d,n=e(s.dial,i.dial);a?(a.animate(o),o.d=r):(i.graphic=l[i.shapeType](o).attr({rotation:o.rotation,zIndex:1}).addClass("highcharts-dial").add(t.group),i.graphic.attr({stroke:n.borderColor||"none","stroke-width":n.borderWidth||0,fill:n.backgroundColor||"#000000"}))}),o?o.animate({translateX:a[0],translateY:a[1]}):(t.pivot=l.circle(0,0,r(n.radius,5)).attr({zIndex:2}).addClass("highcharts-pivot").translate(a[0],a[1]).add(t.group),t.pivot.attr({"stroke-width":n.borderWidth||0,stroke:n.borderColor||"#cccccc",fill:n.backgroundColor||"#000000"}))},animate:function(t){var a=this;t||(i(a.points,function(t){var i=t.graphic;i&&(i.attr({rotation:180*a.yAxis.startAngleRad/Math.PI}),i.animate({rotation:t.shapeArgs.rotation},a.options.animation))}),a.animate=null)},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",this.options.zIndex,this.chart.seriesGroup),n.prototype.render.call(this),this.group.clip(this.chart.clipRect)},setData:function(t,i){n.prototype.setData.call(this,t,!1),this.processData(),this.generatePoints(),r(i,!0)&&this.chart.redraw()},drawTracker:h&&h.drawTrackerPoint},{setState:function(t){this.state=t}})}(t),function(t){var i=t.each,a=t.noop,e=t.pick,o=t.seriesType,r=t.seriesTypes;o("boxplot","column",{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,states:{hover:{brightness:-.3}},whiskerWidth:2},{pointArrayMap:["low","q1","median","q3","high"],toYData:function(t){return[t.low,t.q1,t.median,t.q3,t.high]},pointValKey:"high",pointAttribs:function(t){var i=this.options,a=t&&t.color||this.color;return{fill:t.fillColor||i.fillColor||a,stroke:i.lineColor||a,"stroke-width":i.lineWidth||0}},drawDataLabels:a,translate:function(){var t=this,a=t.yAxis,e=t.pointArrayMap;r.column.prototype.translate.apply(t),i(t.points,function(t){i(e,function(i){null!==t[i]&&(t[i+"Plot"]=a.translate(t[i],0,1,0,1))})})},drawPoints:function(){var t,a,o,r,s,n,l,h,p,c,d,u,g,f=this,m=f.points,y=f.options,x=f.chart,b=x.renderer,P=0,M=f.doQuartiles!==!1,v=f.options.whiskerLength;i(m,function(i){var m,x=i.graphic,k=x?"animate":"attr",w=i.shapeArgs,A={},L={},C={},S=i.color||f.color;void 0!==i.plotY&&(p=w.width,c=Math.floor(w.x),d=c+p,u=Math.round(p/2),t=Math.floor(M?i.q1Plot:i.lowPlot),a=Math.floor(M?i.q3Plot:i.lowPlot),o=Math.floor(i.highPlot),r=Math.floor(i.lowPlot),x||(i.graphic=x=b.g("point").add(f.group),i.stem=b.path().addClass("highcharts-boxplot-stem").add(x),v&&(i.whiskers=b.path().addClass("highcharts-boxplot-whisker").add(x)),M&&(i.box=b.path(h).addClass("highcharts-boxplot-box").add(x)),i.medianShape=b.path(n).addClass("highcharts-boxplot-median").add(x)),A.stroke=i.stemColor||y.stemColor||S,A["stroke-width"]=e(i.stemWidth,y.stemWidth,y.lineWidth),A.dashstyle=i.stemDashStyle||y.stemDashStyle,i.stem.attr(A),v&&(L.stroke=i.whiskerColor||y.whiskerColor||S,L["stroke-width"]=e(i.whiskerWidth,y.whiskerWidth,y.lineWidth),i.whiskers.attr(L)),M&&(m=f.pointAttribs(i),i.box.attr(m)),C.stroke=i.medianColor||y.medianColor||S,C["stroke-width"]=e(i.medianWidth,y.medianWidth,y.lineWidth),i.medianShape.attr(C),l=i.stem.strokeWidth()%2/2,P=c+u+l,i.stem[k]({d:["M",P,a,"L",P,o,"M",P,t,"L",P,r]}),M&&(l=i.box.strokeWidth()%2/2,t=Math.floor(t)+l,a=Math.floor(a)+l,c+=l,d+=l,i.box[k]({d:["M",c,a,"L",c,t,"L",d,t,"L",d,a,"L",c,a,"z"]})),v&&(l=i.whiskers.strokeWidth()%2/2,o+=l,r+=l,g=/%$/.test(v)?u*parseFloat(v)/100:v/2,i.whiskers[k]({d:["M",P-g,o,"L",P+g,o,"M",P-g,r,"L",P+g,r]})),s=Math.round(i.medianPlot),l=i.medianShape.strokeWidth()%2/2,s+=l,i.medianShape[k]({d:["M",c,s,"L",d,s]}))})},setStackedPoints:a})}(t),function(t){var i=t.each,a=t.noop,e=t.seriesType,o=t.seriesTypes;e("errorbar","boxplot",{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null},{type:"errorbar",pointArrayMap:["low","high"],toYData:function(t){return[t.low,t.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:o.arearange?function(){var t=this.pointValKey;o.arearange.prototype.drawDataLabels.call(this),i(this.data,function(i){i.y=i[t]})}:a,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||o.column.prototype.getColumnMetrics.call(this)}})}(t),function(t){var i=t.correctFloat,a=t.isNumber,e=t.pick,o=t.Point,r=t.Series,s=t.seriesType,n=t.seriesTypes;s("waterfall","column",{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}},{pointValKey:"y",translate:function(){var t,a,o,r,s,l,h,p,c,d,u,g,f,m=this,y=m.options,x=m.yAxis,b=e(y.minPointLength,5),P=b/2,M=y.threshold,v=y.stacking;for(n.column.prototype.translate.apply(m),c=d=M,o=m.points,a=0,t=o.length;t>a;a++)r=o[a],p=m.processedYData[a],s=r.shapeArgs,l=v&&x.stacks[(m.negStacks&&M>p?"-":"")+m.stackKey],g=m.getStackIndicator(g,r.x,m.index),u=l?l[r.x].points[g.key]:[0,p],r.isSum?r.y=i(p):r.isIntermediateSum&&(r.y=i(p-d)),h=Math.max(c,c+r.y)+u[0],s.y=x.translate(h,0,1,0,1),r.isSum?(s.y=x.translate(u[1],0,1,0,1),s.height=Math.min(x.translate(u[0],0,1,0,1),x.len)-s.y):r.isIntermediateSum?(s.y=x.translate(u[1],0,1,0,1),s.height=Math.min(x.translate(d,0,1,0,1),x.len)-s.y,d=u[1]):(s.height=p>0?x.translate(c,0,1,0,1)-s.y:x.translate(c,0,1,0,1)-x.translate(c-p,0,1,0,1),c+=l&&l[r.x]?l[r.x].total:p),s.height<0&&(s.y+=s.height,s.height*=-1),r.plotY=s.y=Math.round(s.y)-m.borderWidth%2/2,s.height=Math.max(Math.round(s.height),.001),r.yBottom=s.y+s.height,s.height<=b&&!r.isNull?(s.height=b,s.y-=P,r.plotY=s.y,r.minPointLengthOffset=r.y<0?-P:P):r.minPointLengthOffset=0,f=r.plotY+(r.negative?s.height:0),m.chart.inverted?r.tooltipPos[0]=x.len-f:r.tooltipPos[1]=f},processData:function(t){var a,e,o,s,n,l,h,p=this,c=p.options,d=p.yData,u=p.options.data,g=d.length,f=c.threshold||0;for(o=e=s=n=f,h=0;g>h;h++)l=d[h],a=u&&u[h]?u[h]:{},"sum"===l||a.isSum?d[h]=i(o):"intermediateSum"===l||a.isIntermediateSum?d[h]=i(e):(o+=l,e+=l),s=Math.min(o,s),n=Math.max(o,n);r.prototype.processData.call(this,t),p.options.stacking||(p.dataMin=s,p.dataMax=n)},toYData:function(t){return t.isSum?0===t.x?null:"sum":t.isIntermediateSum?0===t.x?null:"intermediateSum":t.y},pointAttribs:function(t,i){var a,e=this.options.upColor;return e&&!t.options.color&&(t.color=t.y>0?e:null),a=n.column.prototype.pointAttribs.call(this,t,i),delete a.dashstyle,a},getGraphPath:function(){return["M",0,0]},getCrispPath:function(){var t,i,a,e,o=this.data,r=o.length,s=this.graph.strokeWidth()+this.borderWidth,n=Math.round(s)%2/2,l=this.yAxis.reversed,h=[];for(a=1;r>a;a++)i=o[a].shapeArgs,t=o[a-1].shapeArgs,e=["M",t.x+t.width,t.y+o[a-1].minPointLengthOffset+n,"L",i.x,t.y+o[a-1].minPointLengthOffset+n],(o[a-1].y<0&&!l||o[a-1].y>0&&l)&&(e[2]+=t.height,e[5]+=t.height),h=h.concat(e);return h},drawGraph:function(){r.prototype.drawGraph.call(this),this.graph.attr({d:this.getCrispPath()})},setStackedPoints:function(){var t,i,a=this,e=a.options;for(r.prototype.setStackedPoints.apply(a,arguments),t=a.stackedYData?a.stackedYData.length:0,i=1;t>i;i++)e.data[i].isSum||e.data[i].isIntermediateSum||(a.stackedYData[i]+=a.stackedYData[i-1])},getExtremes:function(){return this.options.stacking?r.prototype.getExtremes.apply(this,arguments):void 0}},{getClassName:function(){var t=o.prototype.getClassName.call(this);return this.isSum?t+=" highcharts-sum":this.isIntermediateSum&&(t+=" highcharts-intermediate-sum"),t},isValid:function(){return a(this.y,!0)||this.isSum||this.isIntermediateSum}})}(t),function(t){var i=t.LegendSymbolMixin,a=t.noop,e=t.Series,o=t.seriesType,r=t.seriesTypes;o("polygon","scatter",{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0},{type:"polygon",getGraphPath:function(){for(var t=e.prototype.getGraphPath.call(this),i=t.length+1;i--;)(i===t.length||"M"===t[i])&&i>0&&t.splice(i,0,"z");return this.areaPath=t,t},drawGraph:function(){this.options.fillColor=this.color,r.area.prototype.drawGraph.call(this)},drawLegendSymbol:i.drawRectangle,drawTracker:e.prototype.drawTracker,setStackedPoints:a})}(t),function(t){var i=t.arrayMax,a=t.arrayMin,e=t.Axis,o=t.color,r=t.each,s=t.isNumber,n=t.noop,l=t.pick,h=t.pInt,p=t.Point,c=t.Series,d=t.seriesType,u=t.seriesTypes;d("bubble","scatter",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",bubblePadding:!0,zoneAxis:"z",directTouch:!0,pointAttribs:function(t,i){var a=this.options.marker,e=l(a.fillOpacity,.5),r=c.prototype.pointAttribs.call(this,t,i);return 1!==e&&(r.fill=o(r.fill).setOpacity(e).get("rgba")),r},getRadii:function(t,i,a,e){var o,r,s,n,l,h=this.zData,p=[],c=this.options,d="width"!==c.sizeBy,u=c.zThreshold,g=i-t;for(r=0,o=h.length;o>r;r++)n=h[r],c.sizeByAbsoluteValue&&null!==n&&(n=Math.abs(n-u),i=Math.max(i-u,Math.abs(t-u)),t=0),null===n?l=null:t>n?l=a/2-1:(s=g>0?(n-t)/g:.5,d&&s>=0&&(s=Math.sqrt(s)),l=Math.ceil(a+s*(e-a))/2),p.push(l);this.radii=p},animate:function(t){var i=this.options.animation;t||(r(this.points,function(t){var a,e=t.graphic;e&&e.width&&(a={x:e.x,y:e.y,width:e.width,height:e.height},e.attr({x:t.plotX,y:t.plotY,width:1,height:1}),e.animate(a,i))}),this.animate=null)},translate:function(){var i,a,e,o=this.data,r=this.radii;for(u.scatter.prototype.translate.call(this),i=o.length;i--;)a=o[i],e=r?r[i]:0,s(e)&&e>=this.minPxSize/2?(a.marker=t.extend(a.marker,{radius:e,width:2*e,height:2*e}),a.dlBox={x:a.plotX-e,y:a.plotY-e,width:2*e,height:2*e}):a.shapeArgs=a.plotY=a.dlBox=void 0},alignDataLabel:u.column.prototype.alignDataLabel,buildKDTree:n,applyZones:n},{haloPath:function(t){return p.prototype.haloPath.call(this,0===t?0:(this.marker?this.marker.radius||0:0)+t)},ttBelow:!1}),e.prototype.beforePadding=function(){var t=this,e=this.len,o=this.chart,n=0,p=e,c=this.isXAxis,d=c?"xData":"yData",u=this.min,g={},f=Math.min(o.plotWidth,o.plotHeight),m=Number.MAX_VALUE,y=-Number.MAX_VALUE,x=this.max-u,b=e/x,P=[];r(this.series,function(e){var s,n=e.options;!e.bubblePadding||!e.visible&&o.options.chart.ignoreHiddenSeries||(t.allowZoomOutside=!0,P.push(e),c&&(r(["minSize","maxSize"],function(t){var i=n[t],a=/%$/.test(i);i=h(i),g[t]=a?f*i/100:i}),e.minPxSize=g.minSize,e.maxPxSize=Math.max(g.maxSize,g.minSize),s=e.zData,s.length&&(m=l(n.zMin,Math.min(m,Math.max(a(s),n.displayNegative===!1?n.zThreshold:-Number.MAX_VALUE))),y=l(n.zMax,Math.max(y,i(s))))))}),r(P,function(i){var a,e=i[d],o=e.length;if(c&&i.getRadii(m,y,i.minPxSize,i.maxPxSize),x>0)for(;o--;)s(e[o])&&t.dataMin<=e[o]&&e[o]<=t.dataMax&&(a=i.radii[o],n=Math.min((e[o]-u)*b-a,n),p=Math.max((e[o]-u)*b+a,p))}),P.length&&x>0&&!this.isLog&&(p-=e,b*=(e+n-p)/e,r([["min","userMin",n],["max","userMax",p]],function(i){void 0===l(t.options[i[0]],t[i[1]])&&(t[i[0]]+=i[2]/b)}))}}(t),function(t){function i(t,i){var a,e=this.chart,o=this.options.animation,r=this.group,s=this.markerGroup,n=this.xAxis.center,l=e.plotLeft,h=e.plotTop;e.polar?e.renderer.isSVG&&(o===!0&&(o={}),i?(a={translateX:n[0]+l,translateY:n[1]+h,scaleX:.001,scaleY:.001},r.attr(a),s&&s.attr(a)):(a={translateX:l,translateY:h,scaleX:1,scaleY:1},r.animate(a,o),s&&s.animate(a,o),this.animate=null)):t.call(this,i)}var a,e=t.each,o=t.pick,r=t.Pointer,s=t.Series,n=t.seriesTypes,l=t.wrap,h=s.prototype,p=r.prototype;h.searchPointByAngle=function(t){var i=this,a=i.chart,e=i.xAxis,o=e.pane.center,r=t.chartX-o[0]-a.plotLeft,s=t.chartY-o[1]-a.plotTop;return this.searchKDTree({clientX:180+Math.atan2(r,s)*(-180/Math.PI)})},h.getConnectors=function(t,i,a,e){var o,r,s,n,l,h,p,c,d,u,g,f,m,y,x,b,P,M,v,k,w,A=1.5,L=A+1,C=e?1:0;return o=i>=0&&i<=t.length-1?i:0>i?t.length-1+i:0,r=0>o-1?t.length-(1+C):o-1,s=o+1>t.length-1?C:o+1,n=t[r],l=t[s],h=n.plotX,p=n.plotY,c=l.plotX,d=l.plotY,u=t[o].plotX,g=t[o].plotY,m=(A*u+h)/L,y=(A*g+p)/L,x=(A*u+c)/L,b=(A*g+d)/L,P=Math.sqrt(Math.pow(m-u,2)+Math.pow(y-g,2)),M=Math.sqrt(Math.pow(x-u,2)+Math.pow(b-g,2)),v=Math.atan2(y-g,m-u),k=Math.atan2(b-g,x-u),w=Math.PI/2+(v+k)/2,Math.abs(v-w)>Math.PI/2&&(w-=Math.PI),m=u+Math.cos(w)*P,y=g+Math.sin(w)*P,x=u+Math.cos(Math.PI+w)*M,b=g+Math.sin(Math.PI+w)*M,f={rightContX:x,rightContY:b,leftContX:m,leftContY:y,plotX:u,plotY:g},a&&(f.prevPointCont=this.getConnectors(t,r,!1,e)),f},l(h,"buildKDTree",function(t){this.chart.polar&&(this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.options.findNearestPointBy="xy"),t.apply(this)}),h.toXY=function(t){var i,a,e=this.chart,o=t.plotX,r=t.plotY;t.rectPlotX=o,t.rectPlotY=r,i=this.xAxis.postTranslate(t.plotX,this.yAxis.len-r),t.plotX=t.polarPlotX=i.x-e.plotLeft,t.plotY=t.polarPlotY=i.y-e.plotTop,this.kdByAngle?(a=(o/Math.PI*180+this.xAxis.pane.options.startAngle)%360,0>a&&(a+=360),t.clientX=a):t.clientX=t.plotX},n.spline&&(l(n.spline.prototype,"getPointSpline",function(t,i,a,e){var o,r;return this.chart.polar?e?(r=this.getConnectors(i,e,!0,this.connectEnds),o=["C",r.prevPointCont.rightContX,r.prevPointCont.rightContY,r.leftContX,r.leftContY,r.plotX,r.plotY]):o=["M",a.plotX,a.plotY]:o=t.call(this,i,a,e),o}),n.areasplinerange&&(n.areasplinerange.prototype.getPointSpline=n.spline.prototype.getPointSpline)),l(h,"translate",function(t){var i,a,e=this.chart;if(t.call(this),e.polar&&(this.kdByAngle=e.tooltip&&e.tooltip.shared,!this.preventPostTranslate))for(i=this.points,a=i.length;a--;)this.toXY(i[a])}),l(h,"getGraphPath",function(t,i){var a,o,r,s=this;if(this.chart.polar){for(i=i||this.points,a=0;a<i.length;a++)if(!i[a].isNull){o=a;break}this.options.connectEnds!==!1&&void 0!==o&&(this.connectEnds=!0,i.splice(i.length,0,i[o]),r=!0),e(i,function(t){void 0===t.polarPlotY&&s.toXY(t)})}var n=t.apply(this,[].slice.call(arguments,1));return r&&i.pop(),n}),l(h,"animate",i),n.column&&(a=n.column.prototype,a.polarArc=function(t,i,a,e){var r=this.xAxis.center,s=this.yAxis.len;return this.chart.renderer.symbols.arc(r[0],r[1],s-i,null,{start:a,end:e,innerR:s-o(t,s)})},l(a,"animate",i),l(a,"translate",function(t){var i,a,e,o,r=this.xAxis,s=r.startAngleRad;if(this.preventPostTranslate=!0,t.call(this),r.isRadial)for(a=this.points,o=a.length;o--;)e=a[o],i=e.barX+s,e.shapeType="path",e.shapeArgs={d:this.polarArc(e.yBottom,e.plotY,i,i+e.pointWidth)},this.toXY(e),e.tooltipPos=[e.plotX,e.plotY],e.ttBelow=e.plotY>r.center[1]}),l(a,"alignDataLabel",function(t,i,a,e,o,r){if(this.chart.polar){var s,n,l=i.rectPlotX/Math.PI*180;null===e.align&&(s=l>20&&160>l?"left":l>200&&340>l?"right":"center",e.align=s),null===e.verticalAlign&&(n=45>l||l>315?"bottom":l>135&&225>l?"top":"middle",e.verticalAlign=n),h.alignDataLabel.call(this,i,a,e,o,r)}else t.call(this,i,a,e,o,r)})),l(p,"getCoordinates",function(t,i){var a=this.chart,o={xAxis:[],yAxis:[]};return a.polar?e(a.axes,function(t){var e=t.isXAxis,r=t.center,s=i.chartX-r[0]-a.plotLeft,n=i.chartY-r[1]-a.plotTop;o[e?"xAxis":"yAxis"].push({axis:t,value:t.translate(e?Math.PI-Math.atan2(s,n):Math.sqrt(Math.pow(s,2)+Math.pow(n,2)),!0)})}):o=t.call(this,i),o}),l(t.Chart.prototype,"getAxes",function(i){this.pane||(this.pane=[]),e(t.splat(this.options.pane),function(i){new t.Pane(i,this)},this),i.call(this)}),l(t.Chart.prototype,"drawChartBox",function(t){t.call(this),e(this.pane,function(t){t.render()})}),l(t.Chart.prototype,"get",function(i,a){return t.find(this.pane,function(t){return t.options.id===a})||i.call(this,a)})}(t)});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(t){function e(t,e,i,s){return{x:s.cosB*t-s.sinB*i,y:-s.sinA*s.sinB*t+s.cosA*e-s.cosB*s.sinA*i,z:s.cosA*s.sinB*t+s.sinA*e+s.cosA*s.cosB*i}}function i(t,e,i){var s=i>0&&i<Number.POSITIVE_INFINITY?i/(t.z+e.z+i):1;return{x:t.x*s,y:t.y*s}}var s=t.deg2rad,o=t.pick;t.perspective=function(r,a,n){var l=a.options.chart.options3d,h=n?a.inverted:!1,p={x:a.plotWidth/2,y:a.plotHeight/2,z:l.depth/2,vd:o(l.depth,1)*o(l.viewDistance,0)},c=a.scale3d||1,y=s*l.beta*(h?-1:1),x=s*l.alpha*(h?-1:1),d={cosA:Math.cos(x),cosB:Math.cos(-y),sinA:Math.sin(x),sinB:Math.sin(-y)};return n||(p.x+=a.plotLeft,p.y+=a.plotTop),t.map(r,function(t){var s=e((h?t.y:t.x)-p.x,(h?t.x:t.y)-p.y,(t.z||0)-p.z,d),o=i(s,p,p.vd);return o.x=o.x*c+p.x,o.y=o.y*c+p.y,o.z=s.z*c+p.z,{x:h?o.y:o.x,y:h?o.x:o.y,z:o.z}})},t.pointCameraDistance=function(t,e){var i=e.options.chart.options3d,s={x:e.plotWidth/2,y:e.plotHeight/2,z:o(i.depth,1)*o(i.viewDistance,0)+i.depth},r=Math.sqrt(Math.pow(s.x-t.plotX,2)+Math.pow(s.y-t.plotY,2)+Math.pow(s.z-t.plotZ,2));return r},t.shapeArea=function(t){var e,i,s=0;for(e=0;e<t.length;e++)i=(e+1)%t.length,s+=t[e].x*t[i].y-t[i].x*t[e].y;return s/2},t.shapeArea3d=function(e,i,s){return t.shapeArea(t.perspective(e,i,s))}}(t),function(t){function e(t,i,s,o,r,a,n,l){var h=[],p=a-r;return a>r&&a-r>Math.PI/2+1e-4?(h=h.concat(e(t,i,s,o,r,r+Math.PI/2,n,l)),h=h.concat(e(t,i,s,o,r+Math.PI/2,a,n,l))):r>a&&r-a>Math.PI/2+1e-4?(h=h.concat(e(t,i,s,o,r,r-Math.PI/2,n,l)),h=h.concat(e(t,i,s,o,r-Math.PI/2,a,n,l))):["C",t+s*Math.cos(r)-s*v*p*Math.sin(r)+n,i+o*Math.sin(r)+o*v*p*Math.cos(r)+l,t+s*Math.cos(a)+s*v*p*Math.sin(a)+n,i+o*Math.sin(a)-o*v*p*Math.cos(a)+l,t+s*Math.cos(a)+n,i+o*Math.sin(a)+l]}var i=Math.cos,s=Math.PI,o=Math.sin,r=t.animObject,a=t.charts,n=t.color,l=t.defined,h=t.deg2rad,p=t.each,c=t.extend,y=t.inArray,x=t.map,d=t.merge,f=t.perspective,u=t.pick,z=t.SVGElement,b=t.SVGRenderer,g=t.wrap,v=4*(Math.sqrt(2)-1)/3/(s/2);b.prototype.toLinePath=function(t,e){var i=[];return p(t,function(t){i.push("L",t.x,t.y)}),t.length&&(i[0]="M",e&&i.push("Z")),i},b.prototype.toLineSegments=function(t){var e=[],i=!0;return p(t,function(t){e.push(i?"M":"L",t.x,t.y),i=!i}),e},b.prototype.face3d=function(e){var i=this,s=this.createElement("path");return s.vertexes=[],s.insidePlotArea=!1,s.enabled=!0,g(s,"attr",function(e,s){if("object"==typeof s&&(l(s.enabled)||l(s.vertexes)||l(s.insidePlotArea))){this.enabled=u(s.enabled,this.enabled),this.vertexes=u(s.vertexes,this.vertexes),this.insidePlotArea=u(s.insidePlotArea,this.insidePlotArea),delete s.enabled,delete s.vertexes,delete s.insidePlotArea;var o=a[i.chartIndex],r=f(this.vertexes,o,this.insidePlotArea),n=i.toLinePath(r,!0),h=t.shapeArea(r),p=this.enabled&&h>0?"visible":"hidden";s.d=n,s.visibility=p}return e.apply(this,[].slice.call(arguments,1))}),g(s,"animate",function(e,s){if("object"==typeof s&&(l(s.enabled)||l(s.vertexes)||l(s.insidePlotArea))){this.enabled=u(s.enabled,this.enabled),this.vertexes=u(s.vertexes,this.vertexes),this.insidePlotArea=u(s.insidePlotArea,this.insidePlotArea),delete s.enabled,delete s.vertexes,delete s.insidePlotArea;var o=a[i.chartIndex],r=f(this.vertexes,o,this.insidePlotArea),n=i.toLinePath(r,!0),h=t.shapeArea(r),p=this.enabled&&h>0?"visible":"hidden";s.d=n,this.attr("visibility",p)}return e.apply(this,[].slice.call(arguments,1))}),s.attr(e)},b.prototype.polyhedron=function(t){var e=this,i=this.g(),s=i.destroy;return i.attr({"stroke-linejoin":"round"}),i.faces=[],i.destroy=function(){for(var t=0;t<i.faces.length;t++)i.faces[t].destroy();return s.call(this)},g(i,"attr",function(t,s,o,r,a){if("object"==typeof s&&l(s.faces)){for(;i.faces.length>s.faces.length;)i.faces.pop().destroy();for(;i.faces.length<s.faces.length;)i.faces.push(e.face3d().add(i));for(var n=0;n<s.faces.length;n++)i.faces[n].attr(s.faces[n],null,r,a);delete s.faces}return t.apply(this,[].slice.call(arguments,1))}),g(i,"animate",function(t,s,o,r){if(s&&s.faces){for(;i.faces.length>s.faces.length;)i.faces.pop().destroy();for(;i.faces.length<s.faces.length;)i.faces.push(e.face3d().add(i));for(var a=0;a<s.faces.length;a++)i.faces[a].animate(s.faces[a],o,r);delete s.faces}return t.apply(this,[].slice.call(arguments,1))}),i.attr(t)},b.prototype.cuboid=function(t){var e=this.g(),i=e.destroy,s=this.cuboidPath(t);return e.attr({"stroke-linejoin":"round"}),e.front=this.path(s[0]).attr({class:"highcharts-3d-front"}).add(e),e.top=this.path(s[1]).attr({class:"highcharts-3d-top"}).add(e),e.side=this.path(s[2]).attr({class:"highcharts-3d-side"}).add(e),e.fillSetter=function(t){return this.front.attr({fill:t}),this.top.attr({fill:n(t).brighten(.1).get()}),this.side.attr({fill:n(t).brighten(-.1).get()}),this.color=t,e.fill=t,this},e.opacitySetter=function(t){return this.front.attr({opacity:t}),this.top.attr({opacity:t}),this.side.attr({opacity:t}),this},e.attr=function(t,e,i,s){if("string"==typeof t&&"undefined"!=typeof e){var o=t;t={},t[o]=e}if(!t.shapeArgs&&!l(t.x))return z.prototype.attr.call(this,t,void 0,i,s);var r=t.shapeArgs||t,a=this.renderer.cuboidPath(r);return this.front.attr({d:a[0]}),this.top.attr({d:a[1]}),this.side.attr({d:a[2]}),this},e.animate=function(t,e,i){if(l(t.x)&&l(t.y)){var s=this.renderer.cuboidPath(t);this.front.animate({d:s[0]},e,i),this.top.animate({d:s[1]},e,i),this.side.animate({d:s[2]},e,i),this.attr({zIndex:-s[3]})}else t.opacity?(this.front.animate(t,e,i),this.top.animate(t,e,i),this.side.animate(t,e,i)):z.prototype.animate.call(this,t,e,i);return this},e.destroy=function(){return this.front.destroy(),this.top.destroy(),this.side.destroy(),i.call(this)},e.attr({zIndex:-s[3]}),e},t.SVGRenderer.prototype.cuboidPath=function(e){function i(t){return Y[t]}var s,o,r,n,l,h,p,c,y,d,u,z,b,g=e.x,v=e.y,m=e.z,M=e.height,A=e.width,P=e.depth,k=a[this.chartIndex],L=k.options.chart.options3d,S=L.alpha,I=1e4,w=10,D=100,F=0,Y=[{x:g,y:v,z:m},{x:g+A,y:v,z:m},{x:g+A,y:v+M,z:m},{x:g,y:v+M,z:m},{x:g,y:v+M,z:m+P},{x:g+A,y:v+M,z:m+P},{x:g+A,y:v,z:m+P},{x:g,y:v,z:m+P}];Y=f(Y,k,e.insidePlotArea);var X=function(e,s){var o=[[],-1];return e=x(e,i),s=x(s,i),t.shapeArea(e)<0?o=[e,0]:t.shapeArea(s)<0&&(o=[s,1]),o};return s=[3,2,1,0],o=[7,6,5,4],p=X(s,o),c=p[0],u=p[1],r=[1,6,7,0],n=[4,5,2,3],p=X(r,n),y=p[0],z=p[1],h=[1,2,5,6],l=[0,7,4,3],p=X(h,l),d=p[0],b=p[1],1===b?F+=I*(1e3-g):b||(F+=I*g),F+=w*(!z||S>=0&&180>=S||360>S&&S>357.5?k.plotHeight-v:10+v),1===u?F+=D*m:u||(F+=D*(1e3-m)),F=-Math.round(F),[this.toLinePath(c,!0),this.toLinePath(y,!0),this.toLinePath(d,!0),F]},t.SVGRenderer.prototype.arc3d=function(t){function e(t){var e=!1,i={};t=d(t);for(var s in t)-1!==y(s,o)&&(i[s]=t[s],delete t[s],e=!0);return e?i:!1}var i=this.g(),s=i.renderer,o=["x","y","r","innerR","start","end"];return t=d(t),t.alpha*=h,t.beta*=h,i.top=s.path(),i.side1=s.path(),i.side2=s.path(),i.inn=s.path(),i.out=s.path(),i.onAdd=function(){var t=i.parentGroup,e=i.attr("class");i.top.add(i),p(["out","inn","side1","side2"],function(s){i[s].attr({class:e+" highcharts-3d-side"}).add(t)})},p(["addClass","removeClass"],function(t){i[t]=function(){var e=arguments;p(["top","out","inn","side1","side2"],function(s){i[s][t].apply(i[s],e)})}}),i.setPaths=function(t){var e=i.renderer.arc3dPath(t),s=100*e.zTop;i.attribs=t,i.top.attr({d:e.top,zIndex:e.zTop}),i.inn.attr({d:e.inn,zIndex:e.zInn}),i.out.attr({d:e.out,zIndex:e.zOut}),i.side1.attr({d:e.side1,zIndex:e.zSide1}),i.side2.attr({d:e.side2,zIndex:e.zSide2}),i.zIndex=s,i.attr({zIndex:s}),t.center&&(i.top.setRadialReference(t.center),delete t.center)},i.setPaths(t),i.fillSetter=function(t){var e=n(t).brighten(-.1).get();return this.fill=t,this.side1.attr({fill:e}),this.side2.attr({fill:e}),this.inn.attr({fill:e}),this.out.attr({fill:e}),this.top.attr({fill:t}),this},p(["opacity","translateX","translateY","visibility"],function(t){i[t+"Setter"]=function(t,e){i[e]=t,p(["out","inn","side1","side2","top"],function(s){i[s].attr(e,t)})}}),g(i,"attr",function(t,s){var o;return"object"==typeof s&&(o=e(s),o&&(c(i.attribs,o),i.setPaths(i.attribs))),t.apply(this,[].slice.call(arguments,1))}),g(i,"animate",function(t,s,o,a){var n,l,h,p=this.attribs;return delete s.center,delete s.z,delete s.depth,delete s.alpha,delete s.beta,h=r(u(o,this.renderer.globalAnimation)),h.duration&&(n=e(s),s.dummy=i.dummy++,n&&(l=n,h.step=function(t,e){function i(t){return p[t]+(u(l[t],p[t])-p[t])*e.pos}"dummy"===e.prop&&e.elem.setPaths(d(p,{x:i("x"),y:i("y"),r:i("r"),innerR:i("innerR"),start:i("start"),end:i("end")}))}),o=h),t.call(this,s,o,a)}),i.dummy=0,i.destroy=function(){this.top.destroy(),this.out.destroy(),this.inn.destroy(),this.side1.destroy(),this.side2.destroy(),z.prototype.destroy.call(this)},i.hide=function(){this.top.hide(),this.out.hide(),this.inn.hide(),this.side1.hide(),this.side2.hide()},i.show=function(){this.top.show(),this.out.show(),this.inn.show(),this.side1.show(),this.side2.show()},i},b.prototype.arc3dPath=function(t){function r(t){return t%=2*Math.PI,t>Math.PI&&(t=2*Math.PI-t),t}var a=t.x,n=t.y,l=t.start,h=t.end-1e-5,p=t.r,c=t.innerR,y=t.depth,x=t.alpha,d=t.beta,f=Math.cos(l),u=Math.sin(l),z=Math.cos(h),b=Math.sin(h),g=p*Math.cos(d),v=p*Math.cos(x),m=c*Math.cos(d),M=c*Math.cos(x),A=y*Math.sin(d),P=y*Math.sin(x),k=["M",a+g*f,n+v*u];k=k.concat(e(a,n,g,v,l,h,0,0)),k=k.concat(["L",a+m*z,n+M*b]),k=k.concat(e(a,n,m,M,h,l,0,0)),k=k.concat(["Z"]);var L=d>0?Math.PI/2:0,S=x>0?0:Math.PI/2,I=l>-L?l:h>-L?-L:l,w=s-S>h?h:s-S>l?s-S:h,D=2*s-S,F=["M",a+g*i(I),n+v*o(I)];F=F.concat(e(a,n,g,v,I,w,0,0)),h>D&&D>l?(F=F.concat(["L",a+g*i(w)+A,n+v*o(w)+P]),F=F.concat(e(a,n,g,v,w,D,A,P)),F=F.concat(["L",a+g*i(D),n+v*o(D)]),F=F.concat(e(a,n,g,v,D,h,0,0)),F=F.concat(["L",a+g*i(h)+A,n+v*o(h)+P]),F=F.concat(e(a,n,g,v,h,D,A,P)),F=F.concat(["L",a+g*i(D),n+v*o(D)]),F=F.concat(e(a,n,g,v,D,w,0,0))):h>s-S&&s-S>l&&(F=F.concat(["L",a+g*Math.cos(w)+A,n+v*Math.sin(w)+P]),F=F.concat(e(a,n,g,v,w,h,A,P)),F=F.concat(["L",a+g*Math.cos(h),n+v*Math.sin(h)]),F=F.concat(e(a,n,g,v,h,w,0,0))),F=F.concat(["L",a+g*Math.cos(w)+A,n+v*Math.sin(w)+P]),F=F.concat(e(a,n,g,v,w,I,A,P)),F=F.concat(["Z"]);var Y=["M",a+m*f,n+M*u];Y=Y.concat(e(a,n,m,M,l,h,0,0)),Y=Y.concat(["L",a+m*Math.cos(h)+A,n+M*Math.sin(h)+P]),Y=Y.concat(e(a,n,m,M,h,l,A,P)),Y=Y.concat(["Z"]);var X=["M",a+g*f,n+v*u,"L",a+g*f+A,n+v*u+P,"L",a+m*f+A,n+M*u+P,"L",a+m*f,n+M*u,"Z"],Z=["M",a+g*z,n+v*b,"L",a+g*z+A,n+v*b+P,"L",a+m*z+A,n+M*b+P,"L",a+m*z,n+M*b,"Z"],T=Math.atan2(P,-A),V=Math.abs(h+T),W=Math.abs(l+T),C=Math.abs((l+h)/2+T);V=r(V),W=r(W),C=r(C);var G=1e5,O=C*G,R=W*G,B=V*G;return{top:k,zTop:Math.PI*G+1,out:F,zOut:Math.max(O,R,B),inn:Y,zInn:Math.max(O,R,B),side1:X,zSide1:.99*B,side2:Z,zSide2:.99*R}}}(t),function(t){function e(t,e){var i,o=t.plotLeft,a=t.plotWidth+o,n=t.plotTop,l=t.plotHeight+n,h=o+t.plotWidth/2,p=n+t.plotHeight/2,c={minX:Number.MAX_VALUE,maxX:-Number.MAX_VALUE,minY:Number.MAX_VALUE,maxY:-Number.MAX_VALUE},y=1;return i=[{x:o,y:n,z:0},{x:o,y:n,z:e}],s([0,1],function(t){i.push({x:a,y:i[t].y,z:i[t].z})}),s([0,1,2,3],function(t){i.push({x:i[t].x,y:l,z:i[t].z})}),i=r(i,t,!1),s(i,function(t){c.minX=Math.min(c.minX,t.x),c.maxX=Math.max(c.maxX,t.x),c.minY=Math.min(c.minY,t.y),c.maxY=Math.max(c.maxY,t.y)}),o>c.minX&&(y=Math.min(y,1-Math.abs((o+h)/(c.minX+h))%1)),a<c.maxX&&(y=Math.min(y,(a-h)/(c.maxX-h))),n>c.minY&&(y=c.minY<0?Math.min(y,(n+p)/(-c.minY+n+p)):Math.min(y,1-(n+p)/(c.minY+p)%1)),l<c.maxY&&(y=Math.min(y,Math.abs((l-p)/(c.maxY-p)))),y}var i=t.Chart,s=t.each,o=t.merge,r=t.perspective,a=t.pick,n=t.wrap;i.prototype.is3d=function(){return this.options.chart.options3d&&this.options.chart.options3d.enabled},i.prototype.propsRequireDirtyBox.push("chart.options3d"),i.prototype.propsRequireUpdateSeries.push("chart.options3d"),n(i.prototype,"initSeries",function(t,e){var i=e.type||this.options.chart.type||this.options.chart.defaultSeriesType;return this.is3d()&&"scatter"===i&&(e.type="scatter3d"),t.call(this,e)}),t.wrap(t.Chart.prototype,"isInsidePlot",function(t){return this.is3d()||t.apply(this,[].slice.call(arguments,1))});var l=t.getOptions(),h={chart:{options3d:{enabled:!1,alpha:0,beta:0,depth:100,fitToPlot:!0,viewDistance:25,axisLabelPosition:"default",frame:{visible:"default",size:1,bottom:{},top:{},left:{},right:{},back:{},front:{}}}}};o(!0,l,h),n(i.prototype,"setClassName",function(t){t.apply(this,[].slice.call(arguments,1)),this.is3d()&&(this.container.className+=" highcharts-3d-chart")}),t.wrap(t.Chart.prototype,"setChartSize",function(t){var i=this,s=i.options.chart.options3d;if(t.apply(i,[].slice.call(arguments,1)),i.is3d()){var o=i.inverted,r=i.clipBox,a=i.margin,n=o?"y":"x",l=o?"x":"y",h=o?"height":"width",p=o?"width":"height";r[n]=-(a[3]||0),r[l]=-(a[0]||0),r[h]=i.chartWidth+(a[3]||0)+(a[1]||0),r[p]=i.chartHeight+(a[0]||0)+(a[2]||0),i.scale3d=1,s.fitToPlot===!0&&(i.scale3d=e(i,s.depth))}}),n(i.prototype,"redraw",function(t){this.is3d()&&(this.isDirtyBox=!0,this.frame3d=this.get3dFrame()),t.apply(this,[].slice.call(arguments,1))}),n(i.prototype,"render",function(t){this.is3d()&&(this.frame3d=this.get3dFrame()),t.apply(this,[].slice.call(arguments,1))}),n(i.prototype,"renderSeries",function(t){var e,i=this.series.length;if(this.is3d())for(;i--;)e=this.series[i],e.translate(),e.render();else t.call(this)}),n(i.prototype,"drawChartBox",function(e){if(this.is3d()){var i=this,s=i.renderer,o=this.options.chart.options3d,r=i.get3dFrame(),a=this.plotLeft,n=this.plotLeft+this.plotWidth,l=this.plotTop,h=this.plotTop+this.plotHeight,p=0,c=o.depth,y=a-(r.left.visible?r.left.size:0),x=n+(r.right.visible?r.right.size:0),d=l-(r.top.visible?r.top.size:0),f=h+(r.bottom.visible?r.bottom.size:0),u=p-(r.front.visible?r.front.size:0),z=c+(r.back.visible?r.back.size:0),b=i.hasRendered?"animate":"attr";this.frame3d=r,this.frameShapes||(this.frameShapes={bottom:s.polyhedron().add(),top:s.polyhedron().add(),left:s.polyhedron().add(),right:s.polyhedron().add(),back:s.polyhedron().add(),front:s.polyhedron().add()}),this.frameShapes.bottom[b]({class:"highcharts-3d-frame highcharts-3d-frame-bottom",zIndex:r.bottom.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.bottom.color).brighten(.1).get(),vertexes:[{x:y,y:f,z:u},{x:x,y:f,z:u},{x:x,y:f,z:z},{x:y,y:f,z:z}],enabled:r.bottom.visible},{fill:t.color(r.bottom.color).brighten(.1).get(),vertexes:[{x:a,y:h,z:c},{x:n,y:h,z:c},{x:n,y:h,z:p},{x:a,y:h,z:p}],enabled:r.bottom.visible},{fill:t.color(r.bottom.color).brighten(-.1).get(),vertexes:[{x:y,y:f,z:u},{x:y,y:f,z:z},{x:a,y:h,z:c},{x:a,y:h,z:p}],enabled:r.bottom.visible&&!r.left.visible},{fill:t.color(r.bottom.color).brighten(-.1).get(),vertexes:[{x:x,y:f,z:z},{x:x,y:f,z:u},{x:n,y:h,z:p},{x:n,y:h,z:c}],enabled:r.bottom.visible&&!r.right.visible},{fill:t.color(r.bottom.color).get(),vertexes:[{x:x,y:f,z:u},{x:y,y:f,z:u},{x:a,y:h,z:p},{x:n,y:h,z:p}],enabled:r.bottom.visible&&!r.front.visible},{fill:t.color(r.bottom.color).get(),vertexes:[{x:y,y:f,z:z},{x:x,y:f,z:z},{x:n,y:h,z:c},{x:a,y:h,z:c}],enabled:r.bottom.visible&&!r.back.visible}]}),this.frameShapes.top[b]({class:"highcharts-3d-frame highcharts-3d-frame-top",zIndex:r.top.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.top.color).brighten(.1).get(),vertexes:[{x:y,y:d,z:z},{x:x,y:d,z:z},{x:x,y:d,z:u},{x:y,y:d,z:u}],enabled:r.top.visible},{fill:t.color(r.top.color).brighten(.1).get(),vertexes:[{x:a,y:l,z:p},{x:n,y:l,z:p},{x:n,y:l,z:c},{x:a,y:l,z:c}],enabled:r.top.visible},{fill:t.color(r.top.color).brighten(-.1).get(),vertexes:[{x:y,y:d,z:z},{x:y,y:d,z:u},{x:a,y:l,z:p},{x:a,y:l,z:c}],enabled:r.top.visible&&!r.left.visible},{fill:t.color(r.top.color).brighten(-.1).get(),vertexes:[{x:x,y:d,z:u},{x:x,y:d,z:z},{x:n,y:l,z:c},{x:n,y:l,z:p}],enabled:r.top.visible&&!r.right.visible},{fill:t.color(r.top.color).get(),vertexes:[{x:y,y:d,z:u},{x:x,y:d,z:u},{x:n,y:l,z:p},{x:a,y:l,z:p}],enabled:r.top.visible&&!r.front.visible},{fill:t.color(r.top.color).get(),vertexes:[{x:x,y:d,z:z},{x:y,y:d,z:z},{x:a,y:l,z:c},{x:n,y:l,z:c}],enabled:r.top.visible&&!r.back.visible}]}),this.frameShapes.left[b]({class:"highcharts-3d-frame highcharts-3d-frame-left",zIndex:r.left.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.left.color).brighten(.1).get(),vertexes:[{x:y,y:f,z:u},{x:a,y:h,z:p},{x:a,y:h,z:c},{x:y,y:f,z:z}],enabled:r.left.visible&&!r.bottom.visible},{fill:t.color(r.left.color).brighten(.1).get(),vertexes:[{x:y,y:d,z:z},{x:a,y:l,z:c},{x:a,y:l,z:p},{x:y,y:d,z:u}],enabled:r.left.visible&&!r.top.visible},{fill:t.color(r.left.color).brighten(-.1).get(),vertexes:[{x:y,y:f,z:z},{x:y,y:d,z:z},{x:y,y:d,z:u},{x:y,y:f,z:u}],enabled:r.left.visible},{fill:t.color(r.left.color).brighten(-.1).get(),vertexes:[{x:a,y:l,z:c},{x:a,y:h,z:c},{x:a,y:h,z:p},{x:a,y:l,z:p}],enabled:r.left.visible},{fill:t.color(r.left.color).get(),vertexes:[{x:y,y:f,z:u},{x:y,y:d,z:u},{x:a,y:l,z:p},{x:a,y:h,z:p}],enabled:r.left.visible&&!r.front.visible},{fill:t.color(r.left.color).get(),vertexes:[{x:y,y:d,z:z},{x:y,y:f,z:z},{x:a,y:h,z:c},{x:a,y:l,z:c}],enabled:r.left.visible&&!r.back.visible}]}),this.frameShapes.right[b]({class:"highcharts-3d-frame highcharts-3d-frame-right",zIndex:r.right.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.right.color).brighten(.1).get(),vertexes:[{x:x,y:f,z:z},{x:n,y:h,z:c},{x:n,y:h,z:p},{x:x,y:f,z:u}],enabled:r.right.visible&&!r.bottom.visible},{fill:t.color(r.right.color).brighten(.1).get(),vertexes:[{x:x,y:d,z:u},{x:n,y:l,z:p},{x:n,y:l,z:c},{x:x,y:d,z:z}],enabled:r.right.visible&&!r.top.visible},{fill:t.color(r.right.color).brighten(-.1).get(),vertexes:[{x:n,y:l,z:p},{x:n,y:h,z:p},{x:n,y:h,z:c},{x:n,y:l,z:c}],enabled:r.right.visible},{fill:t.color(r.right.color).brighten(-.1).get(),vertexes:[{x:x,y:f,z:u},{x:x,y:d,z:u},{x:x,y:d,z:z},{x:x,y:f,z:z}],enabled:r.right.visible},{fill:t.color(r.right.color).get(),vertexes:[{x:x,y:d,z:u},{x:x,y:f,z:u},{x:n,y:h,z:p},{x:n,y:l,z:p}],enabled:r.right.visible&&!r.front.visible},{fill:t.color(r.right.color).get(),vertexes:[{x:x,y:f,z:z},{x:x,y:d,z:z},{x:n,y:l,z:c},{x:n,y:h,z:c}],enabled:r.right.visible&&!r.back.visible}]}),this.frameShapes.back[b]({class:"highcharts-3d-frame highcharts-3d-frame-back",zIndex:r.back.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.back.color).brighten(.1).get(),vertexes:[{x:x,y:f,z:z},{x:y,y:f,z:z},{x:a,y:h,z:c},{x:n,y:h,z:c}],enabled:r.back.visible&&!r.bottom.visible},{fill:t.color(r.back.color).brighten(.1).get(),vertexes:[{x:y,y:d,z:z},{x:x,y:d,z:z},{x:n,y:l,z:c},{x:a,y:l,z:c}],enabled:r.back.visible&&!r.top.visible},{fill:t.color(r.back.color).brighten(-.1).get(),vertexes:[{x:y,y:f,z:z},{x:y,y:d,z:z},{x:a,y:l,z:c},{x:a,y:h,z:c}],enabled:r.back.visible&&!r.left.visible},{fill:t.color(r.back.color).brighten(-.1).get(),vertexes:[{x:x,y:d,z:z},{x:x,y:f,z:z},{x:n,y:h,z:c},{x:n,y:l,z:c}],enabled:r.back.visible&&!r.right.visible},{fill:t.color(r.back.color).get(),vertexes:[{x:a,y:l,z:c},{x:n,y:l,z:c},{x:n,y:h,z:c},{x:a,y:h,z:c}],enabled:r.back.visible},{fill:t.color(r.back.color).get(),vertexes:[{x:y,y:f,z:z},{x:x,y:f,z:z},{x:x,y:d,z:z},{x:y,y:d,z:z}],enabled:r.back.visible}]}),this.frameShapes.front[b]({class:"highcharts-3d-frame highcharts-3d-frame-front",zIndex:r.front.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.front.color).brighten(.1).get(),vertexes:[{x:y,y:f,z:u},{x:x,y:f,z:u},{x:n,y:h,z:p},{x:a,y:h,z:p}],enabled:r.front.visible&&!r.bottom.visible},{fill:t.color(r.front.color).brighten(.1).get(),vertexes:[{x:x,y:d,z:u},{x:y,y:d,z:u},{x:a,y:l,z:p},{x:n,y:l,z:p}],enabled:r.front.visible&&!r.top.visible},{fill:t.color(r.front.color).brighten(-.1).get(),vertexes:[{x:y,y:d,z:u},{x:y,y:f,z:u},{x:a,y:h,z:p},{x:a,y:l,z:p}],enabled:r.front.visible&&!r.left.visible},{fill:t.color(r.front.color).brighten(-.1).get(),vertexes:[{x:x,y:f,z:u},{x:x,y:d,z:u},{x:n,y:l,z:p},{x:n,y:h,z:p}],enabled:r.front.visible&&!r.right.visible},{fill:t.color(r.front.color).get(),vertexes:[{x:n,y:l,z:p},{x:a,y:l,z:p},{x:a,y:h,z:p},{x:n,y:h,z:p}],enabled:r.front.visible},{fill:t.color(r.front.color).get(),vertexes:[{x:x,y:f,z:u},{x:y,y:f,z:u},{x:y,y:d,z:u},{x:x,y:d,z:u}],enabled:r.front.visible}]})}return e.apply(this,[].slice.call(arguments,1))}),i.prototype.retrieveStacks=function(t){var e,i=this.series,o={},r=1;return s(this.series,function(s){e=a(s.options.stack,t?0:i.length-1-s.index),o[e]?o[e].series.push(s):(o[e]={series:[s],position:r},r++)}),o.totalStacks=r+1,o},i.prototype.get3dFrame=function(){var e=this,i=e.options.chart.options3d,o=i.frame,n=e.plotLeft,l=e.plotLeft+e.plotWidth,h=e.plotTop,p=e.plotTop+e.plotHeight,c=0,y=i.depth,x=function(i){var s=t.shapeArea3d(i,e);return s>.5?1:-.5>s?-1:0},d=x([{x:n,y:p,z:y},{x:l,y:p,z:y},{x:l,y:p,z:c},{x:n,y:p,z:c}]),f=x([{x:n,y:h,z:c},{x:l,y:h,z:c},{x:l,y:h,z:y},{x:n,y:h,z:y}]),u=x([{x:n,y:h,z:c},{x:n,y:h,z:y},{x:n,y:p,z:y},{x:n,y:p,z:c}]),z=x([{x:l,y:h,z:y},{x:l,y:h,z:c},{x:l,y:p,z:c},{x:l,y:p,z:y}]),b=x([{x:n,y:p,z:c},{x:l,y:p,z:c},{x:l,y:h,z:c},{x:n,y:h,z:c}]),g=x([{x:n,y:h,z:y},{x:l,y:h,z:y},{x:l,y:p,z:y},{x:n,y:p,z:y}]),v=!1,m=!1,M=!1,A=!1,P=!1,k=!0;s([].concat(e.xAxis,e.yAxis,e.zAxis),function(t){t&&(t.horiz?t.opposite?m=!0:v=!0:t.opposite?A=!0:M=!0)});var L=function(t,e,i){for(var s=["size","color","visible"],o={},r=0;r<s.length;r++)for(var n=s[r],l=0;l<t.length;l++)if("object"==typeof t[l]){var h=t[l][n];if(void 0!==h&&null!==h){o[n]=h;break}}var p=i;return o.visible===!0||o.visible===!1?p=o.visible:"auto"===o.visible&&(p=e>0),{size:a(o.size,1),color:a(o.color,"none"),frontFacing:e>0,visible:p}},S={bottom:L([o.bottom,o.top,o],d,v),top:L([o.top,o.bottom,o],f,m),left:L([o.left,o.right,o.side,o],u,M),right:L([o.right,o.left,o.side,o],z,A),back:L([o.back,o.front,o],g,k),front:L([o.front,o.back,o],b,P)};if("auto"===i.axisLabelPosition){var I=function(t,e){return t.visible!==e.visible||t.visible&&e.visible&&t.frontFacing!==e.frontFacing},w=[];I(S.left,S.front)&&w.push({y:(h+p)/2,x:n,z:c,xDir:{x:1,y:0,z:0}}),I(S.left,S.back)&&w.push({y:(h+p)/2,x:n,z:y,xDir:{x:0,y:0,z:-1}}),I(S.right,S.front)&&w.push({y:(h+p)/2,x:l,z:c,xDir:{x:0,y:0,z:1}}),I(S.right,S.back)&&w.push({y:(h+p)/2,x:l,z:y,xDir:{x:-1,y:0,z:0}});var D=[];I(S.bottom,S.front)&&D.push({x:(n+l)/2,y:p,z:c,xDir:{x:1,y:0,z:0}}),I(S.bottom,S.back)&&D.push({x:(n+l)/2,y:p,z:y,xDir:{x:-1,y:0,z:0}});var F=[];I(S.top,S.front)&&F.push({x:(n+l)/2,y:h,z:c,xDir:{x:1,y:0,z:0}}),I(S.top,S.back)&&F.push({x:(n+l)/2,y:h,z:y,xDir:{x:-1,y:0,z:0}});var Y=[];I(S.bottom,S.left)&&Y.push({z:(c+y)/2,y:p,x:n,xDir:{x:0,y:0,z:-1}}),I(S.bottom,S.right)&&Y.push({z:(c+y)/2,y:p,x:l,xDir:{x:0,y:0,z:1}});var X=[];I(S.top,S.left)&&X.push({z:(c+y)/2,y:h,x:n,xDir:{x:0,y:0,z:-1}}),I(S.top,S.right)&&X.push({z:(c+y)/2,y:h,x:l,xDir:{x:0,y:0,z:1}});var Z=function(t,i,s){if(0===t.length)return null;if(1===t.length)return t[0];for(var o=0,a=r(t,e,!1),n=1;n<a.length;n++)s*a[n][i]>s*a[o][i]?o=n:s*a[n][i]===s*a[o][i]&&a[n].z<a[o].z&&(o=n);return t[o]};S.axes={y:{left:Z(w,"x",-1),right:Z(w,"x",1)},x:{top:Z(F,"y",-1),bottom:Z(D,"y",1)},z:{top:Z(X,"y",-1),bottom:Z(Y,"y",1)}}}else S.axes={y:{left:{x:n,z:c,xDir:{x:1,y:0,z:0}},right:{x:l,z:c,xDir:{x:0,y:0,z:1}}},x:{top:{y:h,z:c,xDir:{x:1,y:0,z:0}},bottom:{y:p,z:c,xDir:{x:1,y:0,z:0}}},z:{top:{x:M?l:n,y:h,xDir:M?{x:0,y:0,z:1}:{x:0,y:0,z:-1}},bottom:{x:M?l:n,y:p,xDir:M?{x:0,y:0,z:1}:{x:0,y:0,z:-1}}}};return S},t.Fx.prototype.matrixSetter=function(){var e;if(this.pos<1&&(t.isArray(this.start)||t.isArray(this.end))){var i=this.start||[1,0,0,1,0,0],s=this.end||[1,0,0,1,0,0];e=[];for(var o=0;6>o;o++)e.push(this.pos*s[o]+(1-this.pos)*i[o])}else e=this.end;this.elem.attr(this.prop,e,null,!0)}}(t),function(t){function e(t,e,i){if(!t.chart.is3d()||"colorAxis"===t.coll)return e;var s,o=t.chart,a=r*o.options.chart.options3d.alpha,n=r*o.options.chart.options3d.beta,l=p(i&&t.options.title.position3d,t.options.labels.position3d),y=p(i&&t.options.title.skew3d,t.options.labels.skew3d),x=o.frame3d,d=o.plotLeft,f=o.plotWidth+d,u=o.plotTop,z=o.plotHeight+u,b=!1,g=0,v=0,m={x:0,y:1,z:0};if(e=t.swapZ({x:e.x,y:e.y,z:0}),t.isZAxis)if(t.opposite){if(null===x.axes.z.top)return{};v=e.y-u,e.x=x.axes.z.top.x,e.y=x.axes.z.top.y,s=x.axes.z.top.xDir,b=!x.top.frontFacing}else{if(null===x.axes.z.bottom)return{};v=e.y-z,e.x=x.axes.z.bottom.x,e.y=x.axes.z.bottom.y,s=x.axes.z.bottom.xDir,b=!x.bottom.frontFacing}else if(t.horiz)if(t.opposite){if(null===x.axes.x.top)return{};v=e.y-u,e.y=x.axes.x.top.y,e.z=x.axes.x.top.z,s=x.axes.x.top.xDir,b=!x.top.frontFacing}else{if(null===x.axes.x.bottom)return{};v=e.y-z,e.y=x.axes.x.bottom.y,e.z=x.axes.x.bottom.z,s=x.axes.x.bottom.xDir,b=!x.bottom.frontFacing}else if(t.opposite){if(null===x.axes.y.right)return{};g=e.x-f,e.x=x.axes.y.right.x,e.z=x.axes.y.right.z,s=x.axes.y.right.xDir,s={x:s.z,y:s.y,z:-s.x}}else{if(null===x.axes.y.left)return{};g=e.x-d,e.x=x.axes.y.left.x,e.z=x.axes.y.left.z,s=x.axes.y.left.xDir}if("chart"===l);else if("flap"===l)if(t.horiz){var M=Math.sin(a),A=Math.cos(a);t.opposite&&(M=-M),b&&(M=-M),m={x:s.z*M,y:A,z:-s.x*M}}else s={x:Math.cos(n),y:0,z:Math.sin(n)};else if("ortho"===l)if(t.horiz){var P=Math.sin(a),k=Math.cos(a),L=Math.sin(n),S=Math.cos(n),I={x:L*k,y:-P,z:-k*S};m={x:s.y*I.z-s.z*I.y,y:s.z*I.x-s.x*I.z,z:s.x*I.y-s.y*I.x};var w=1/Math.sqrt(m.x*m.x+m.y*m.y+m.z*m.z);b&&(w=-w),m={x:w*m.x,y:w*m.y,z:w*m.z}}else s={x:Math.cos(n),y:0,z:Math.sin(n)};else t.horiz?m={x:Math.sin(n)*Math.sin(a),y:Math.cos(a),z:-Math.cos(n)*Math.sin(a)}:s={x:Math.cos(n),y:0,z:Math.sin(n)};e.x+=g*s.x+v*m.x,e.y+=g*s.y+v*m.y,e.z+=g*s.z+v*m.z;var D=h([e],t.chart)[0];if(y){var F=c(h([e,{x:e.x+s.x,y:e.y+s.y,z:e.z+s.z},{x:e.x+m.x,y:e.y+m.y,z:e.z+m.z}],t.chart))<0;F&&(s={x:-s.x,y:-s.y,z:-s.z});var Y=h([{x:e.x,y:e.y,z:e.z},{x:e.x+s.x,y:e.y+s.y,z:e.z+s.z},{x:e.x+m.x,y:e.y+m.y,z:e.z+m.z}],t.chart);D.matrix=[Y[1].x-Y[0].x,Y[1].y-Y[0].y,Y[2].x-Y[0].x,Y[2].y-Y[0].y,D.x,D.y],D.matrix[4]-=D.x*D.matrix[0]+D.y*D.matrix[2],D.matrix[5]-=D.x*D.matrix[1]+D.y*D.matrix[3]}else D.matrix=null;return D}var i,s=t.Axis,o=t.Chart,r=t.deg2rad,a=t.each,n=t.extend,l=t.merge,h=t.perspective,p=t.pick,c=t.shapeArea,y=t.splat,x=t.Tick,d=t.wrap,f={labels:{position3d:"offset",skew3d:!1},title:{position3d:null,skew3d:null}};l(!0,s.prototype.defaultOptions,f),d(s.prototype,"setOptions",function(t,e){var i;t.call(this,e),this.chart.is3d&&this.chart.is3d()&&"colorAxis"!==this.coll&&(i=this.options,i.tickWidth=p(i.tickWidth,0),i.gridLineWidth=p(i.gridLineWidth,1))}),d(s.prototype,"getPlotLinePath",function(t){var e=t.apply(this,[].slice.call(arguments,1));if(!this.chart.is3d()||"colorAxis"===this.coll)return e;if(null===e)return e;var i=this.chart,s=i.options.chart.options3d,o=this.isZAxis?i.plotWidth:s.depth,r=i.frame3d,a=[this.swapZ({x:e[1],y:e[2],z:0}),this.swapZ({x:e[1],y:e[2],z:o}),this.swapZ({x:e[4],y:e[5],z:0}),this.swapZ({x:e[4],y:e[5],z:o})],n=[];return this.horiz?this.isZAxis?(r.left.visible&&n.push(a[0],a[2]),r.right.visible&&n.push(a[1],a[3]),r.top.visible&&n.push(a[0],a[1]),r.bottom.visible&&n.push(a[2],a[3])):(r.front.visible&&n.push(a[0],a[2]),r.back.visible&&n.push(a[1],a[3]),r.top.visible&&n.push(a[0],a[1]),r.bottom.visible&&n.push(a[2],a[3])):(r.front.visible&&n.push(a[0],a[2]),r.back.visible&&n.push(a[1],a[3]),r.left.visible&&n.push(a[0],a[1]),r.right.visible&&n.push(a[2],a[3])),n=h(n,this.chart,!1),this.chart.renderer.toLineSegments(n)}),d(s.prototype,"getLinePath",function(t){return this.chart.is3d()&&"colorAxis"!==this.coll?[]:t.apply(this,[].slice.call(arguments,1))}),d(s.prototype,"getPlotBandPath",function(t){if(!this.chart.is3d()||"colorAxis"===this.coll)return t.apply(this,[].slice.call(arguments,1));var e=arguments,i=e[1],s=e[2],o=[],r=this.getPlotLinePath(i),a=this.getPlotLinePath(s);if(r&&a)for(var n=0;n<r.length;n+=6)o.push("M",r[n+1],r[n+2],"L",r[n+4],r[n+5],"L",a[n+4],a[n+5],"L",a[n+1],a[n+2],"Z");return o}),d(x.prototype,"getMarkPath",function(t){var i=t.apply(this,[].slice.call(arguments,1)),s=[e(this.axis,{x:i[1],y:i[2],z:0}),e(this.axis,{x:i[4],y:i[5],z:0})];return this.axis.chart.renderer.toLineSegments(s)}),d(x.prototype,"getLabelPosition",function(t){var i=t.apply(this,[].slice.call(arguments,1));return e(this.axis,i)}),d(s.prototype,"getTitlePosition",function(t){var i=t.apply(this,[].slice.call(arguments,1));return e(this,i,!0)}),d(s.prototype,"drawCrosshair",function(t){var e=arguments;this.chart.is3d()&&"colorAxis"!==this.coll&&e[2]&&(e[2]={plotX:e[2].plotXold||e[2].plotX,plotY:e[2].plotYold||e[2].plotY}),t.apply(this,[].slice.call(e,1))}),d(s.prototype,"destroy",function(t){a(["backFrame","bottomFrame","sideFrame"],function(t){this[t]&&(this[t]=this[t].destroy())},this),t.apply(this,[].slice.call(arguments,1))}),s.prototype.swapZ=function(t,e){if(this.isZAxis){var i=e?0:this.chart.plotLeft;return{x:i+t.z,y:t.y,z:t.x-i}}return t},i=t.ZAxis=function(){this.init.apply(this,arguments)},n(i.prototype,s.prototype),n(i.prototype,{isZAxis:!0,setOptions:function(t){t=l({offset:0,lineWidth:0},t),s.prototype.setOptions.call(this,t),this.coll="zAxis"},setAxisSize:function(){s.prototype.setAxisSize.call(this),this.width=this.len=this.chart.options.chart.options3d.depth,this.right=this.chart.chartWidth-this.width-this.left},getSeriesExtremes:function(){var t=this,e=t.chart;t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.ignoreMinPadding=t.ignoreMaxPadding=null,t.buildStacks&&t.buildStacks(),a(t.series,function(i){if(i.visible||!e.options.chart.ignoreHiddenSeries){var s,o=i.options,r=o.threshold;t.hasVisibleSeries=!0,t.positiveValuesOnly&&0>=r&&(r=null),s=i.zData,s.length&&(t.dataMin=Math.min(p(t.dataMin,s[0]),Math.min.apply(null,s)),t.dataMax=Math.max(p(t.dataMax,s[0]),Math.max.apply(null,s)))}})}}),d(o.prototype,"getAxes",function(t){var e=this,s=this.options,o=s.zAxis=y(s.zAxis||{});t.call(this),e.is3d()&&(this.zAxis=[],a(o,function(t,s){t.index=s,t.isX=!0;var o=new i(e,t);o.setScale()}))})}(t),function(t){var e=t.perspective,i=t.pick,s=t.wrap;s(t.Series.prototype,"translate",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.translate3dPoints()}),t.Series.prototype.translate3dPoints=function(){var t,s,o,r,a,n=this,l=n.chart,h=i(n.zAxis,l.options.zAxis[0]),p=[];for(a=0;a<n.data.length;a++)t=n.data[a],h&&h.translate?(r=h.isLog&&h.val2lin?h.val2lin(t.z):t.z,t.plotZ=h.translate(r),t.isInside=t.isInside?r>=h.min&&r<=h.max:!1):t.plotZ=0,p.push({x:i(t.plotXold,t.plotX),y:i(t.plotYold,t.plotY),z:i(t.plotZold,t.plotZ)});for(s=e(p,l,!0),a=0;a<n.data.length;a++)t=n.data[a],o=s[a],t.plotXold=t.plotX,t.plotYold=t.plotY,t.plotZold=t.plotZ,t.plotX=o.x,t.plotY=o.y,t.plotZ=o.z}}(t),function(t){function e(t){var e=t.apply(this,[].slice.call(arguments,1));return this.chart.is3d&&this.chart.is3d()&&(e.stroke=this.options.edgeColor||e.fill,e["stroke-width"]=o(this.options.edgeWidth,1)),e}var i=t.each,s=t.perspective,o=t.pick,r=t.Series,a=t.seriesTypes,n=t.inArray,l=t.svg,h=t.wrap;h(a.column.prototype,"translate",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.translate3dShapes()}),a.column.prototype.translate3dPoints=function(){},a.column.prototype.translate3dShapes=function(){var t=this,e=t.chart,o=t.options,r=o.depth||25,a=o.stacking?o.stack||0:t.index,n=a*(r+(o.groupZPadding||1)),l=t.borderWidth%2?.5:0;e.inverted&&!t.yAxis.reversed&&(l*=-1),o.grouping!==!1&&(n=0),n+=o.groupZPadding||1,i(t.data,function(o){if(null!==o.y){var a,h=o.shapeArgs,p=o.tooltipPos,c=[["x","width"],["y","height"]];i(c,function(e){if(a=h[e[0]]-l,0>a&&(h[e[1]]+=h[e[0]]+l,h[e[0]]=-l,a=0),a+h[e[1]]>t[e[0]+"Axis"].len&&0!==h[e[1]]&&(h[e[1]]=t[e[0]+"Axis"].len-h[e[0]]),0!==h[e[1]]&&(h[e[0]]>=t[e[0]+"Axis"].len||h[e[0]]+h[e[1]]<=l))for(var i in h)h[i]=0}),o.shapeType="cuboid",h.z=n,h.depth=r,h.insidePlotArea=!0,p=s([{x:p[0],y:p[1],z:n}],e,!0)[0],o.tooltipPos=[p.x,p.y]}}),t.z=n},h(a.column.prototype,"animate",function(t){if(this.chart.is3d()){var e=arguments,s=e[1],o=this.yAxis,r=this,a=this.yAxis.reversed;l&&(s?i(r.data,function(t){null!==t.y&&(t.height=t.shapeArgs.height,t.shapey=t.shapeArgs.y,t.shapeArgs.height=1,a||(t.shapeArgs.y=t.stackY?t.plotY+o.translate(t.stackY):t.plotY+(t.negative?-t.height:t.height)))}):(i(r.data,function(t){null!==t.y&&(t.shapeArgs.height=t.height,t.shapeArgs.y=t.shapey,t.graphic&&t.graphic.animate(t.shapeArgs,r.options.animation))}),this.drawDataLabels(),r.animate=null))}else t.apply(this,[].slice.call(arguments,1))}),h(a.column.prototype,"plotGroup",function(t,e,i,s,o,r){return this.chart.is3d()&&r&&!this[e]&&(this.chart.columnGroup||(this.chart.columnGroup=this.chart.renderer.g("columnGroup").add(r)),this[e]=this.chart.columnGroup,this.chart.columnGroup.attr(this.getPlotBox()),this[e].survive=!0),t.apply(this,Array.prototype.slice.call(arguments,1))}),h(a.column.prototype,"setVisible",function(t,e){var s,o=this;o.chart.is3d()&&i(o.data,function(t){t.visible=t.options.visible=e=void 0===e?!t.visible:e,s=e?"visible":"hidden",o.options.data[n(t,o.data)]=t.options,t.graphic&&t.graphic.attr({visibility:s})}),t.apply(this,Array.prototype.slice.call(arguments,1))}),h(a.column.prototype,"init",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var e=this.options,i=e.grouping,s=e.stacking,r=o(this.yAxis.options.reversedStacks,!0),a=0;if(void 0===i||i){var n,l=this.chart.retrieveStacks(s),h=e.stack||0;for(n=0;n<l[h].series.length&&l[h].series[n]!==this;n++);a=10*(l.totalStacks-l[h].position)+(r?n:-n),this.xAxis.reversed||(a=10*l.totalStacks-a)}e.zIndex=a}}),h(a.column.prototype,"pointAttribs",e),a.columnrange&&(h(a.columnrange.prototype,"pointAttribs",e),a.columnrange.prototype.plotGroup=a.column.prototype.plotGroup,a.columnrange.prototype.setVisible=a.column.prototype.setVisible),h(r.prototype,"alignDataLabel",function(t){if(this.chart.is3d()&&("column"===this.type||"columnrange"===this.type)){var e=this,i=e.chart,o=arguments,r=o[4],a={x:r.x,y:r.y,z:e.z};a=s([a],i,!0)[0],r.x=a.x,r.y=a.y}t.apply(this,[].slice.call(arguments,1))}),h(t.StackItem.prototype,"getStackBox",function(e,i){var s=e.apply(this,[].slice.call(arguments,1));if(i.is3d()){var o={x:s.x,y:s.y,z:0};o=t.perspective([o],i,!0)[0],s.x=o.x,s.y=o.y}return s})}(t),function(t){var e=t.deg2rad,i=t.each,s=t.pick,o=t.seriesTypes,r=t.svg,a=t.wrap;a(o.pie.prototype,"translate",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var s=this,o=s.options,r=o.depth||0,a=s.chart.options.chart.options3d,n=a.alpha,l=a.beta,h=o.stacking?(o.stack||0)*r:s._i*r;h+=r/2,o.grouping!==!1&&(h=0),i(s.data,function(t){var i,a=t.shapeArgs;t.shapeType="arc3d",a.z=h,a.depth=.75*r,a.alpha=n,a.beta=l,a.center=s.center,i=(a.end+a.start)/2,t.slicedTranslation={translateX:Math.round(Math.cos(i)*o.slicedOffset*Math.cos(n*e)),translateY:Math.round(Math.sin(i)*o.slicedOffset*Math.cos(n*e))}})}}),a(o.pie.prototype.pointClass.prototype,"haloPath",function(t){var e=arguments;return this.series.chart.is3d()?[]:t.call(this,e[1])}),a(o.pie.prototype,"pointAttribs",function(t,e,i){var o=t.call(this,e,i),r=this.options;return this.chart.is3d()&&(o.stroke=r.edgeColor||e.color||this.color,o["stroke-width"]=s(r.edgeWidth,1)),o}),a(o.pie.prototype,"drawPoints",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&i(this.points,function(t){var e=t.graphic;e&&e[t.y&&t.visible?"show":"hide"]()})}),a(o.pie.prototype,"drawDataLabels",function(t){if(this.chart.is3d()){var s=this,o=s.chart,r=o.options.chart.options3d;i(s.data,function(t){var s=t.shapeArgs,o=s.r,a=(s.alpha||r.alpha)*e,n=(s.beta||r.beta)*e,l=(s.start+s.end)/2,h=t.labelPos,p=[0,2,4],c=-o*(1-Math.cos(a))*Math.sin(l),y=o*(Math.cos(n)-1)*Math.cos(l);i(p,function(t){h[t]+=y,h[t+1]+=c})})}t.apply(this,[].slice.call(arguments,1))}),a(o.pie.prototype,"addPoint",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.update(this.userOptions,!0)}),a(o.pie.prototype,"animate",function(t){if(this.chart.is3d()){var e,i=arguments,s=i[1],o=this.options.animation,a=this.center,n=this.group,l=this.markerGroup;r&&(o===!0&&(o={}),s?(n.oldtranslateX=n.translateX,n.oldtranslateY=n.translateY,e={translateX:a[0],translateY:a[1],scaleX:.001,scaleY:.001},n.attr(e),l&&(l.attrSetters=n.attrSetters,l.attr(e))):(e={translateX:n.oldtranslateX,translateY:n.oldtranslateY,scaleX:1,scaleY:1},n.animate(e,o),l&&l.animate(e,o),this.animate=null))}else t.apply(this,[].slice.call(arguments,1))})}(t),function(t){var e=t.Point,i=t.seriesType,s=t.seriesTypes;i("scatter3d","scatter",{tooltip:{pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>z: <b>{point.z}</b><br/>"}},{pointAttribs:function(e){var i=s.scatter.prototype.pointAttribs.apply(this,arguments);return this.chart.is3d()&&e&&(i.zIndex=t.pointCameraDistance(e,this.chart)),i},axisTypes:["xAxis","yAxis","zAxis"],pointArrayMap:["x","y","z"],parallelArrays:["x","y","z"],directTouch:!0},{applyOptions:function(){return e.prototype.applyOptions.apply(this,arguments),void 0===this.z&&(this.z=0),this}})}(t),function(t){var e=t.Axis,i=t.SVGRenderer,s=t.VMLRenderer;s&&(t.setOptions({animate:!1}),s.prototype.face3d=i.prototype.face3d,s.prototype.polyhedron=i.prototype.polyhedron,s.prototype.cuboid=i.prototype.cuboid,s.prototype.cuboidPath=i.prototype.cuboidPath,s.prototype.toLinePath=i.prototype.toLinePath,s.prototype.toLineSegments=i.prototype.toLineSegments,s.prototype.createElement3D=i.prototype.createElement3D,s.prototype.arc3d=function(t){var e=i.prototype.arc3d.call(this,t);return e.css({zIndex:e.zIndex}),e},t.VMLRenderer.prototype.arc3dPath=t.SVGRenderer.prototype.arc3dPath,t.wrap(e.prototype,"render",function(t){t.apply(this,[].slice.call(arguments,1)),this.sideFrame&&(this.sideFrame.css({zIndex:0}),this.sideFrame.front.attr({fill:this.sideFrame.color})),this.bottomFrame&&(this.bottomFrame.css({zIndex:1}),this.bottomFrame.front.attr({fill:this.bottomFrame.color})),this.backFrame&&(this.backFrame.css({zIndex:0}),this.backFrame.front.attr({fill:this.backFrame.color}))}))}(t)});
!function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){var t=function(e){var t=e.each,s=e.Series,i=e.addEvent,n=e.fireEvent,a=e.wrap,r=e.noop,o={init:function(){s.prototype.init.apply(this,arguments),this.initialised=!1,this.baseSeries=null,this.eventRemovers=[],this.addEvents()},setDerivedData:r,setBaseSeries:function(){var e=this.chart,t=this.options.baseSeries,s=t&&(e.series[t]||e.get(t));this.baseSeries=s||null},addEvents:function(){var e,t=this;e=i(this.chart,"seriesLinked",function(){t.setBaseSeries(),t.baseSeries&&!t.initialised&&(t.setDerivedData(),t.addBaseSeriesEvents(),t.initialised=!0)}),this.eventRemovers.push(e)},addBaseSeriesEvents:function(){var e,t,s=this;e=i(s.baseSeries,"updatedData",function(){s.setDerivedData()}),t=i(s.baseSeries,"destroy",function(){s.baseSeries=null,s.initialised=!1}),s.eventRemovers.push(e,t)},destroy:function(){t(this.eventRemovers,function(e){e()}),s.prototype.destroy.apply(this,arguments)}};return a(e.Chart.prototype,"linkSeries",function(e){e.call(this),n(this,"seriesLinked")}),o}(e);!function(e,t){var s=e.each,i=e.correctFloat,n=e.seriesType,a=e.merge;n("pareto","line",{zIndex:3},a(t,{setDerivedData:function(){if(this.baseSeries.yData.length>1){var e=this.baseSeries.xData,t=this.baseSeries.yData,s=this.sumPointsPercents(t,e,null,!0);this.setData(this.sumPointsPercents(t,e,s,!1),!1)}},sumPointsPercents:function(e,t,n,a){var r,o=0,u=0,h=[];return s(e,function(e,s){null!==e&&(a?o+=e:(r=e/n*100,h.push([t[s],i(u+r)]),u+=r))}),a?o:h}}))}(e,t)});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){var e=function(){var t=function(t){return"function"==typeof t},e=function(e){var i=this,o=i.graphic,n=e.animate,r=e.attr,a=e.onComplete,l=e.css,s=e.group,h=e.renderer,c=e.shapeArgs,d=e.shapeType;i.shouldDraw()?(o||(i.graphic=o=h[d](c).add(s)),o.css(l).attr(r).animate(n,void 0,a)):o&&o.animate(n,void 0,function(){i.graphic=o=o.destroy(),t(a)&&a()}),o&&o.addClass(i.getClassName(),!0)};return e}();!function(t,e){var i=t.each,o=t.extend,n=t.isArray,r=t.isNumber,a=t.isObject,l=t.Series,s=function(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)},h=function(e,i){var o,n=!1,r=e.rect;return e.lastCollidedWith&&(o=e.lastCollidedWith.rect,n=s(r,o),n||delete e.lastCollidedWith),n||(n=!!t.find(i,function(t){var i;return o=t.rect,i=s(r,o),i&&(e.lastCollidedWith=t),i})),n},c=function(t,e){var i=e.field,o=!1,n=i.width*i.width+i.height*i.height,r=.2*t;return 1e4>=t&&(o={x:r*Math.cos(r),y:r*Math.sin(r)},Math.min(Math.abs(o.x),Math.abs(o.y))<n||(o=!1)),o},d=function(t){var e=Math.ceil((Math.sqrt(t)-1)/2),i=2*e+1,o=Math.pow(i,2),n=function(t){return"boolean"==typeof t},r=!1;return i-=1,1e4>=t&&(n(r)&&t>=o-i&&(r={x:e-(o-t),y:-e}),o-=i,n(r)&&t>=o-i&&(r={x:-e,y:-e+(o-t)}),o-=i,n(r)&&(r=t>=o-i?{x:-e+(o-t),y:e}:{x:e,y:e-(o-t-i)}),r.x*=5,r.y*=5),r},u=function(t,e){var i=d(t,e),o=e.field;return i&&(i.x*=o.ratio),i},p=function(t){return Math.round(t*(Math.random()+.5)/2)},f=function(t,e,i){var o=2*Math.max(Math.abs(i.top),Math.abs(i.bottom)),n=2*Math.max(Math.abs(i.left),Math.abs(i.right)),r=1/n*t,a=1/o*e;return Math.min(r,a)},g=function(t,e){var i=t/e;return{width:256*i,height:256,ratio:i}},m=function(t,e,i){var o=i-e,n=o/(t-1),r=Math.floor(Math.random()*t);return e+r*n},x=function(t,e){var i=t.getBBox(),o={left:-(e.width/2),right:e.width/2,top:-(e.height/2),bottom:e.height/2};return!(o.left<i.x&&o.right>i.x+i.width&&o.top<i.y&&o.bottom>i.y+i.height)},y=function(t,e){for(var i=e.placed,n=e.element,r=e.field,l=e.clientRect,s=e.spiral,c=1,d={x:0,y:0},u=t.rect=o({},l);(h(t,i)||x(n,r))&&d!==!1;)d=s(c,{field:r}),a(d)&&(u.left=l.left+d.x,u.right=u.left+u.width,u.top=l.top+d.y,u.bottom=u.top+u.height),c++;return d},v=function(t,e){return(!r(t.left)||t.left>e.left)&&(t.left=e.left),(!r(t.right)||t.right<e.right)&&(t.right=e.right),(!r(t.top)||t.top>e.top)&&(t.top=e.top),(!r(t.bottom)||t.bottom<e.bottom)&&(t.bottom=e.bottom),t},b={animation:{duration:500},borderWidth:0,clip:!1,colorByPoint:!0,placementStrategy:"center",rotation:{from:0,orientations:2,to:90},showInLegend:!1,spiral:"rectangular",style:{fontFamily:"sans-serif",fontWeight:"900"},tooltip:{followPointer:!0,pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.weight}</b><br/>'}},w={animate:l.prototype.animate,bindAxes:function(){var t={endOnTick:!1,gridLineWidth:0,lineWidth:0,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};l.prototype.bindAxes.call(this),o(this.yAxis.options,t),o(this.xAxis.options,t)},deriveFontSize:function(t){var e=25;return Math.floor(e*t)},drawPoints:function(){var t,e=this,n=e.hasRendered,r=e.xAxis,l=e.yAxis,s=e.chart,h=e.group,c=e.options,d=c.animation,u=s.renderer,p=u.text().add(h),m=[],x=e.placementStrategy[c.placementStrategy],b=e.spirals[c.spiral],w=c.rotation,M=e.points.map(function(t){return t.weight}),A=Math.max.apply(null,M),W=g(r.len,l.len),C=e.points.sort(function(t,e){return e.weight-t.weight});i(C,function(t){var i,r,l,s=1/A*t.weight,f=o({fontSize:e.deriveFontSize(s)+"px",fill:t.color},c.style),g=x(t,{data:C,field:W,placed:m,rotation:w}),M={align:"center",x:g.x,y:g.y,text:t.name,rotation:g.rotation};p.css(f).attr(M),t.clientRect=l=o({},p.element.getBoundingClientRect()),r=y(t,{clientRect:l,element:p,field:W,placed:m,spiral:b}),a(r)?(M.x+=r.x,M.y+=r.y,o(g,{left:M.x-l.width/2,right:M.x+l.width/2,top:M.y-l.height/2,bottom:M.y+l.height/2}),W=v(W,g),m.push(t),t.isNull=!1):t.isNull=!0,d&&(i={x:M.x,y:M.y},n?(delete M.x,delete M.y):(M.x=0,M.y=0)),t.draw({animate:i,attr:M,css:f,group:h,renderer:u,shapeArgs:void 0,shapeType:"text"})}),p=p.destroy(),t=f(r.len,l.len,W),e.group.attr({scaleX:t,scaleY:t})},hasData:function(){var t=this;return a(t)&&t.visible===!0&&n(t.points)&&t.points.length>0},placementStrategy:{random:function(t,e){var i=e.field,o=e.rotation;return{x:p(i.width)-i.width/2,y:p(i.height)-i.height/2,rotation:m(o.orientations,o.from,o.to)}},center:function(t,e){var i=e.rotation;return{x:0,y:0,rotation:m(i.orientations,i.from,i.to)}}},pointArrayMap:["weight"],spirals:{archimedean:c,rectangular:u,square:d},getPlotBox:function(){var t=this,e=t.chart,i=e.inverted,o=t[i?"yAxis":"xAxis"],n=t[i?"xAxis":"yAxis"],r=o?o.len:e.plotWidth,a=n?n.len:e.plotHeight,l=o?o.left:e.plotLeft,s=n?n.top:e.plotTop;return{translateX:l+r/2,translateY:s+a/2,scaleX:1,scaleY:1}}},M={draw:e,shouldDraw:function(){var t=this;return!t.isNull}};t.seriesType("wordcloud","column",b,w,M)}(t,e)});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(t){var e=t.seriesType,n=t.seriesTypes,i=t.noop,o=t.each;e("funnel","pie",{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,size:!0,dataLabels:{connectorWidth:1},states:{select:{color:"#c0c0c0",borderColor:"#000000",shadow:!1}}},{animate:i,translate:function(){var t,e,n,a,s,r,l,c,h,p,d,u=function(t,e){return/%$/.test(t)?e*parseInt(t,10)/100:parseInt(t,10)},f=0,g=this,b=g.chart,y=g.options,v=y.reversed,m=y.ignoreHiddenPoint,w=b.plotWidth,L=b.plotHeight,k=0,H=y.center,W=u(H[0],w),P=u(H[1],L),Y=u(y.width,w),X=u(y.height,L),A=u(y.neckWidth,w),T=u(y.neckHeight,L),x=P-X/2+X-T,D=g.data,I="left"===y.dataLabels.position?1:0;g.getWidthAt=e=function(t){var e=P-X/2;return t>x||X===T?A:A+(Y-A)*(1-(t-e)/(X-T))},g.getX=function(t,n){return W+(n?-1:1)*(e(v?2*P-t:t)/2+y.dataLabels.distance)},g.center=[W,P,X],g.centerX=W,o(D,function(t){m&&t.visible===!1||(f+=t.y)}),o(D,function(o){d=null,a=f?o.y/f:0,r=P-X/2+k*X,h=r+a*X,t=e(r),s=W-t/2,l=s+t,t=e(h),c=W-t/2,p=c+t,r>x?(s=c=W-A/2,l=p=W+A/2):h>x&&(d=h,t=e(x),c=W-t/2,p=c+t,h=x),v&&(r=2*P-r,h=2*P-h,d=d?2*P-d:null),n=["M",s,r,"L",l,r,p,h],d&&n.push(p,d,c,d),n.push(c,h,"Z"),o.shapeType="path",o.shapeArgs={d:n},o.percentage=100*a,o.plotX=W,o.plotY=(r+(d||h))/2,o.tooltipPos=[W,o.plotY],o.slice=i,o.half=I,m&&o.visible===!1||(k+=a)})},drawPoints:n.column.prototype.drawPoints,sortByAngle:function(t){t.sort(function(t,e){return t.plotY-e.plotY})},drawDataLabels:function(){var t,e,i,o,a,s=this.data,r=this.options.dataLabels.distance,l=s.length;for(this.center[2]-=2*r;l--;)i=s[l],t=i.half,e=t?1:-1,a=i.plotY,o=this.getX(a,t),i.labelPos=[0,a,o+(r-5)*e,a,o+r*e,a,t?"right":"left",0];n.pie.prototype.drawDataLabels.call(this)}}),e("pyramid","funnel",{neckWidth:"0%",neckHeight:"0%",reversed:!0})}(t)});
!function(r){function t(r,t){for(var e,n,o,a=[],s="y",i=0,n=r.length-(t-1);n>i;i++){e=0;for(var g=0;t>g;g++)e+=r[i+g][s];o=e/t,a.push([r[i].x+(t-1),o])}var h="y = Ai + Ai+1";return{equation:[1,1],points:a,string:h}}function e(r){var t=[0,0,0,0,0,0],e=0,n=[];for(g=r.length;g>e;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][0]*r[e][0]*r[e][1],t[3]+=r[e][1]*Math.log(r[e][1]),t[4]+=r[e][0]*r[e][1]*Math.log(r[e][1]),t[5]+=r[e][0]*r[e][1]);for(var o=t[1]*t[2]-t[5]*t[5],a=Math.pow(Math.E,(t[2]*t[3]-t[5]*t[4])/o),s=(t[1]*t[4]-t[5]*t[3])/o,i=0,g=r.length;g>i;i++){var h=[r[i][0],a*Math.pow(Math.E,s*r[i][0])];n.push(h)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var u="y = "+Math.round(100*a)/100+"e^("+Math.round(100*s)/100+"x)";return{equation:[a,s],points:n,string:u}}function n(r){var t=[0,0,0,0,0],e=0,n=[];for(r.length;e<r.length;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][0]*r[e][0],t[3]+=r[e][0]*r[e][1],t[4]+=r[e][1]*r[e][1]);for(var o=(e*t[3]-t[0]*t[1])/(e*t[2]-t[0]*t[0]),a=t[1]/e-o*t[0]/e,s=0,i=r.length;i>s;s++){var g=[r[s][0],r[s][0]*o+a];n.push(g)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var h="y = "+Math.round(100*o)/100+"x + "+Math.round(100*a)/100;return{equation:[o,a],points:n,string:h}}function o(r){var t=[0,0,0,0],e=0,n=[];for(i=r.length;i>e;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=Math.log(r[e][0]),t[1]+=r[e][1]*Math.log(r[e][0]),t[2]+=r[e][1],t[3]+=Math.pow(Math.log(r[e][0]),2));for(var o=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]),a=(t[2]-o*t[0])/e,s=0,i=r.length;i>s;s++){var g=[r[s][0],a+o*Math.log(r[s][0])];n.push(g)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var h="y = "+Math.round(100*a)/100+" + "+Math.round(100*o)/100+" ln(x)";return{equation:[a,o],points:n,string:h}}function a(r){var t=[0,0,0,0],e=0,n=[];for(i=r.length;i>e;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=Math.log(r[e][0]),t[1]+=Math.log(r[e][1])*Math.log(r[e][0]),t[2]+=Math.log(r[e][1]),t[3]+=Math.pow(Math.log(r[e][0]),2));for(var o=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]),a=Math.pow(Math.E,(t[2]-o*t[0])/e),s=0,i=r.length;i>s;s++){var g=[r[s][0],a*Math.pow(r[s][0],o)];n.push(g)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var h="y = "+Math.round(100*a)/100+"x^"+Math.round(100*o)/100;return{equation:[a,o],points:n,string:h}}function s(r,t){"undefined"==typeof t&&(t=2);for(var e=[],n=[],o=[],a=0,s=0,i=0,h=t+1;h>i;i++){for(var u=0,l=r.length;l>u;u++)r[u].x&&(r[u][0]=r[u].x,r[u][1]=r[u].y),r[u][1]&&(a+=Math.pow(r[u][0],i)*r[u][1]);e.push(a),a=0;for(var f=[],p=0;h>p;p++){for(var u=0,l=r.length;l>u;u++)r[u][1]&&(s+=Math.pow(r[u][0],i+p));f.push(s),s=0}n.push(f)}n.push(e);for(var v=g(n,h),i=0,l=r.length;l>i;i++){for(var d=0,M=0;M<v.length;M++)d+=v[M]*Math.pow(r[i][0],M);o.push([r[i][0],d])}o.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});for(var c="y = ",i=v.length-1;i>=0;i--)c+=i>1?Math.round(100*v[i])/100+"x^"+i+" + ":1==i?Math.round(100*v[i])/100+"x + ":Math.round(100*v[i])/100;return{equation:v,points:o,string:c}}function i(r,t){function e(r){var t,e={},n=r.length,o=[];for(t=0;n>t;t+=1)e[r[t]]=r[t];for(t in e)o.push(e[t]);return o}function n(r){var t=1-r*r*r;return t*t*t}var t=t||.25,o=r.map(function(r){return r[0]}),a=e(o);2/a.length>t&&(t=Math.min(2/a.length,1));var s=r.map(function(r){return r[1]}),i=[],g=0,h=Math.floor(t*o.length)-1;for(var u in o){var l=o[u];u>0&&h<o.length-1&&o[h+1]-o[u]<o[u]-o[g]&&(g++,h++);var f;f=o[u]-o[g]>o[h]-o[u]?g:h;for(var p=Math.abs(1/(o[f]-l)),v=0,d=0,M=0,c=0,y=0,S=g;h>=S;){var x,m=o[S],w=s[S];x=u>S?l-m:m-l;var q=n(x*p),b=m*q;v+=q,d+=b,M+=m*b,c+=w*q,y+=w*b,S++}var A,L=d/v,E=c/v,I=y/v,k=M/v;A=k==L*L?0:(I-L*E)/(k-L*L);var F=E-A*L;i[u]=A*l+F}return{equation:"",points:o.map(function(r,t){return[r,i[t]]}),string:""}}function g(r,t){var e=0,n=0,o=0,a=0,s=0,i=r.length-1,g=new Array(t);for(e=0;i>e;e++){for(a=e,n=e+1;i>n;n++)Math.abs(r[e][n])>Math.abs(r[e][a])&&(a=n);for(o=e;i+1>o;o++)s=r[o][e],r[o][e]=r[o][a],r[o][a]=s;for(n=e+1;i>n;n++)for(o=i;o>=e;o--)r[o][n]-=r[o][e]*r[e][n]/r[e][e]}for(n=i-1;n>=0;n--){for(s=0,o=n+1;i>o;o++)s+=r[o][n]*g[o];g[n]=(r[i][n]-s)/r[n][n]}return g}function h(r,t){var e,n,o,a;for(e=n=o=a=0,e=0;e<r.length;e++)a+=r[e][1]/r.length;for(e=0;e<r.length;e++)o+=Math.pow(r[e][1]-t[e][1],2),n+=Math.pow(r[e][1]-a,2);return 1-o/n}r.wrap(r.Chart.prototype,"init",function(r){var g=arguments[1].series,u=arguments[1].legend,l=arguments[1].colors||[],f=[],p=0;for(p=0;p<g.length;p++){var v=g[p];if(v.regression&&!v.rendered){v.regressionSettings=v.regressionSettings||{},v.regressionSettings.tooltip=v.regressionSettings.tooltip||{},v.regressionSettings.dashStyle=v.regressionSettings.dashStyle||"solid",v.regressionSettings.showInLegend=v.regressionSettings.showInLegend||u.enabled;var d,M=v.regressionSettings.type||"linear",c={data:[],color:v.color,yAxis:v.yAxis,lineWidth:2,marker:{enabled:!1},isRegressionLine:!0,type:v.regressionSettings.linetype||"spline",name:v.regressionSettings.name||"Equation: %eq",color:v.regressionSettings.color||l[p]||"",dashStyle:v.regressionSettings.dashStyle||"solid",showInLegend:v.regressionSettings.showInLegend,tooltip:{valueSuffix:v.regressionSettings.tooltip.valueSuffix||" "}};if("linear"==M)d=n(v.data),c.type="line";else if("exponential"==M)d=e(v.data);else if("polynomial"==M){var y=v.regressionSettings.order||2;d=s(v.data,y)}else if("logarithmic"==M)d=o(v.data);else if("loess"==M){var S=v.regressionSettings.loessSmooth||25;d=i(v.data,S/100)}else if("power"==M)d=a(v.data);else{if("average"!=M)break;var x=v.regressionSettings.period||v.regressionSettings.order||2;d=t(v.data,x)}"average"!==M&&(d.rSquared=h(v.data,d.points).toFixed(2),d.rValue=Math.sqrt(d.rSquared,2).toFixed(2),c.name=c.name.replace("%r2",d.rSquared),c.name=c.name.replace("%r",d.rValue),c.name=c.name.replace("%eq",d.string)),c.data=d.points,c.regressionOutputs=d,f.push(c),arguments[1].series[p].rendered=!0}}arguments[1].series=g.concat(f),r.apply(this,Array.prototype.slice.call(arguments,1))})}(Highcharts);
!function(t){function i(t,i){return this.userOptions=h(t),this.name=t.name||t,this.parent=i,this}function e(t){for(var i=t.length,e=0;i--;)e+=t[i];return e}function s(t,i,e,a,o){var n,h=t.length;for(o||(o=0),e.depth||(e.depth=0);h--;)n=t[h],a&&"object"==typeof n&&(n.parent=a),n.categories?s(n.categories,i,e,n,o+1):r(i,n,a);e.depth=d(e.depth,o)}function r(t,e,s){for(t.unshift(new i(e,s));s;)s.leaves++||(s.leaves=1),s=s.parent}function a(t,i,e){i[0]===i[2]&&(i[0]=i[2]=c(i[0])-e%2/2),i[1]===i[3]&&(i[1]=i[3]=c(i[1])+e%2/2),t.push("M",i[0],i[1],"L",i[2],i[3])}function o(t,i){return t.getPosition(t.axis.horiz,i,t.axis.tickmarkOffset)}function n(t,i,e){for(var s,r=t.length;r--;)s=t[r][i],s&&n(s,i,e),e(t[r])}function h(t){return JSON.parse(JSON.stringify(t))}var l=void 0,c=Math.round,p=Math.min,d=Math.max,u=t.merge,g=t.pick,f=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||t.inArray,x=t.Axis.prototype,b=t.Tick.prototype,y=x.init,v=x.render,k=x.setCategories,G=b.getLabelSize,z=b.addLabel,S=b.destroy,m=b.render;i.prototype.toString=function(){for(var t=[],i=this;i;)t.push(i.name),i=i.parent;return t.join(" ")},x.init=function(t,i){y.call(this,t,i),"object"==typeof i&&i.categories&&this.setupGroups(i)},x.setupGroups=function(t){var i,e=[],r={};i=h(t.categories),s(i,e,r),this.categoriesTree=i,this.categories=e,this.isGrouped=0!==r.depth,this.labelsDepth=r.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=t.tickLength||this.tickLength||null,this.tickWidth=g(t.tickWidth,this.isXAxis?1:0),this.directionFactor=[-1,1,1,-1][this.side],this.options.lineWidth=g(t.lineWidth,1)},x.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===l&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,v.call(this),!this.isGrouped)return void(this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}));var t,i=this,e=i.options,s=i.top,r=i.left,a=r+i.width,o=s+i.height,h=i.hasVisibleSeries||("function"==typeof i.hasData?i.hasData():i.hasData),c=i.labelsDepth,p=i.labelsGrid,d=i.horiz,u=i.labelsGridPath,g=e.drawHorizontalBorders===!1?c+1:0,f=i.opposite?d?s:a:d?o:r,x=i.tickWidth;for(i.userTickLength&&(c-=1),p||(p=i.labelsGrid=i.chart.renderer.path().attr({strokeWidth:x,"stroke-width":x,stroke:e.tickColor}).add(i.axisGroup));c>=g;)f+=i.groupSize(g),t=d?[r,f,a,f]:[f,s,f,o],g++;p.attr({d:u,visibility:h?"visible":"hidden"}),i.labelGroup.attr({visibility:h?"visible":"hidden"}),n(i.categoriesTree,"categories",function(t){var e=t.tick;e&&(e.startAt+e.leaves-1<i.min||e.startAt>i.max?(e.label.hide(),e.destroyed=0):e.label.attr({visibility:h?"visible":"hidden"}))})},x.setCategories=function(t,i){this.categories&&this.cleanGroups(),this.setupGroups({categories:t}),this.categories=this.userOptions.categories=t,k.call(this,this.categories,i)},x.cleanGroups=function(){var t,i=this.ticks;for(t in i)i[t].parent&&delete i[t].parent;n(this.categoriesTree,"categories",function(t){var i,e=t.tick;if(e){e.label.destroy();for(i in e)delete e[i];delete t.tick}}),this.labelsGrid=null},x.groupSize=function(t,i){var s=this.labelsSizes,r=this.directionFactor,a=this.options.labels.groupedOptions?this.options.labels.groupedOptions[t-1]:!1,o=0;return a&&(o=-1==r?a.x?a.x:0:a.y?a.y:0),i!==l&&(s[t]=d(s[t]||0,i+10+Math.abs(o))),t===!0?e(s)*r:s[t]?s[t]*r:0},b.addLabel=function(){var t;z.call(this),this.axis.categories&&(t=this.axis.categories[this.pos])&&(this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:t.name})),this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(t))},b.addGroupedLabels=function(t){for(var i,e,s,r,a=this,o=this.axis,n=o.chart,h=o.options.labels,l=h.useHTML,c=h.style,p=h.groupedOptions,d={align:"center",rotation:h.rotation,x:0,y:0},g=o.horiz?"height":"width",f=0;a;){if(f>0&&!t.tick){this.value=t.name;var x=h.formatter?h.formatter.call(this,t):t.name,b=p&&p[f-1],y=b?u(d,p[f-1]):d,v=b&&p[f-1].style?u(c,p[f-1].style):c;delete y.style,e=this.axis.width/this.axis.categories.length*t.leaves-20,s=parseInt(v.fontSize)*x.length,s=s>e?s-e:0,s=0==s?0:s/parseInt(v.fontSize),r=x=x.trim(),x=x.substring(0,x.length-s),x=x.split("...")[0],x+=r!=x&&-1===x.indexOf("...")?"...":"",i=n.renderer.text(x,0,0,l|!0).attr(y).css(v).add(o.labelGroup),a.startAt=this.pos,a.childCount=t.categories.length,a.leaves=t.leaves,a.visible=this.childCount,a.label=i,a.labelOffsets=-1!==n.options.chart.type.indexOf("bar")?{x:y.x-5,y:y.y}:{x:y.x,y:y.y+10},t.tick=a}o.groupSize(f,a.label.getBBox()[g]),t=t.parent,a=t?a.parent=t.tick||{}:null,f++}},b.render=function(t,i,e){function s(t,i){var e=0;return k?(e=f(i.name,i.parent.categories),e=0>e?0:e):e}m.call(this,t,i,e);var r=this.axis.categories[this.pos];if(this.axis.isGrouped&&r&&!(this.pos>this.axis.max)){var n,h,l,c,u,g,x=this,b=x,y=x.axis,v=x.pos,k=x.isFirst,G=y.max,z=y.min,S=y.horiz,L=(y.categories[v],y.labelsGridPath),O=y.groupSize(0),A=(y.tickLength||O,y.tickWidth),w=(y.directionFactor,o(x,v)),T=S?w.y:w.x,F=y.chart.renderer.fontMetrics(y.options.labels.style.fontSize).b,M=1,W=S&&w.x===y.pos+y.len||!S&&w.y===y.pos?-1:0;for(k&&(n=S?[y.left,w.y,y.left,w.y+y.groupSize(!0)]:y.isXAxis?[w.x,y.top,w.x+y.groupSize(!0),y.top]:[w.x,y.top+y.len,w.x+y.groupSize(!0),y.top+y.len],a(L,n,A)),S&&y.left<w.x?a(L,[w.x-W,w.y,w.x-W,w.y+O],A):!S&&y.top<=w.y&&a(L,[w.x,w.y+W,w.x+O,w.y+W],A),O=T+O;b=b.parent;){var N=s(b,r,x),B=b.labelOffsets.x,C=b.labelOffsets.y;l=o(x,d(b.startAt-1,z-1)),c=o(x,p(b.startAt+b.leaves-1-N,G)),g=b.label.getBBox(0),h=y.groupSize(M),W=S&&c.x===y.pos+y.len||!S&&c.y===y.pos?-1:0,u=S?{x:(l.x+c.x)/2+B,y:O+h/2+F-g.height/2-4+C/2}:{x:O+h/2+B,y:(l.y+c.y-g.height)/2+F+C},isNaN(u.x)||isNaN(u.y)||(b.label.attr(u),L&&(S&&y.left<c.x?a(L,[c.x-W,O,c.x-W,O+h],A):!S&&y.top<=c.y&&a(L,[O,c.y+W,O+h,c.y+W],A))),O+=h,M++}}},b.destroy=function(){for(var t=this;t=t.parent;)t.destroyed++||(t.destroyed=1);S.call(this)},b.getLabelSize=function(){if(this.axis.isGrouped===!0){var t=G.call(this)+10,i=this.axis.labelsSizes[0];return t>i&&(this.axis.labelsSizes[0]=t),e(this.axis.labelsSizes)}return G.call(this)}}(Highcharts);
function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var f={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var a in f)e==a&&(e=f[a]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],t=0;t<r.length;t++){var d=r[t].re,l=r[t].process,i=d.exec(e);if(i){var n=l(i);this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),f=this.g.toString(16),a=this.b.toString(16);return 1==e.length&&(e="0"+e),1==f.length&&(f="0"+f),1==a.length&&(a="0"+a),"#"+e+f+a},this.getHelpXML=function(){for(var e=new Array,a=0;a<r.length;a++)for(var t=r[a].example,d=0;d<t.length;d++)e[e.length]=t[d];for(var l in f)e[e.length]=l;var i=document.createElement("ul");i.setAttribute("id","rgbcolor-examples");for(var a=0;a<e.length;a++)try{var n=document.createElement("li"),o=new RGBColor(e[a]),s=document.createElement("div");s.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),s.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[a]+" -> "+o.toRGB()+" -> "+o.toHex());n.appendChild(s),n.appendChild(c),i.appendChild(n)}catch(e){}return i}}
!function(t,e){"undefined"!=typeof define&&define.amd?define("canvgModule",["rgbcolor","stackblur"],e):"undefined"!=typeof module&&module.exports&&(module.exports=e(require("rgbcolor"),require("stackblur"))),t.canvg=e(t.RGBColor,t.stackBlur)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=[0,0,0],i=function(i,n){var s=t.match(i);null!=s&&(e[n]+=s.length,t=t.replace(i," "))};return t=t.replace(/:not\(([^\)]*)\)/g,"     $1 "),t=t.replace(/{[\s\S]*/gm," "),i(r,1),i(o,0),i(h,1),i(l,2),i(u,1),i(c,1),t=t.replace(/[\*\s\+>~]/g," "),t=t.replace(/[#\.]/g," "),i(f,2),e.join("")}function n(n){var a={opts:n};a.FRAMERATE=30,a.MAX_VIRTUAL_PIXELS=3e4,a.log=function(){},1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(t){}),a.init=function(t){var e=0;a.UniqueId=function(){return e++,"canvg"+e},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=t,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var t=0;t<a.Images.length;t++)if(!a.Images[t].loaded)return!1;return!0},a.trim=function(t){return t=t||"",t.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},a.ajax=function(t){var e;return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e?(e.open("GET",t,!1),e.send(null),e.responseText):null},a.parseXml=function(t){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,e.loadXml(t,i),e}if(!window.DOMParser){t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}try{var n=new DOMParser;return n.parseFromString(t,"image/svg+xml")}catch(e){return n=new DOMParser,n.parseFromString(t,"text/xml")}},a.Property=function(t,e){this.name=t,this.value=e},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},a.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},a.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},a.Property.prototype.addOpacity=function(e){var i=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var n=new t(this.value);n.ok&&(i="rgba("+n.r+", "+n.g+", "+n.b+", "+e.numValue()+")")}return new a.Property(this.name,i)},a.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),a.Definitions[t]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(t,e){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(a.ctx,t,e);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var n=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),n.hasValue()&&(i.attribute("patternTransform",!0).value=n.value)}return i.createPattern(a.ctx,t)}return null},a.Property.prototype.getDPI=function(){return 96},a.Property.prototype.getEM=function(t){var e=12,i=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);return i.hasValue()&&(e=i.toPixels(t)),e},a.Property.prototype.getUnits=function(){var t=this.value+"";return t.replace(/[0-9\.\-]/g,"")},a.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/em$/))return this.numValue()*this.getEM(t);if(i.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(t);if(i.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(t);var n=this.numValue();return e&&1>n?n*a.ViewPort.ComputeSize(t):n},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var r={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?r[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,i,n,s,r){var o=null!=r?this.Parse(r):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:s||o.fontFamily,fontSize:n||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:i||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var i={},n=a.trim(a.compressSpaces(e||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},r="",o=0;o<n.length;o++)s.fontStyle||-1==t.Styles.indexOf(n[o])?s.fontVariant||-1==t.Variants.indexOf(n[o])?s.fontWeight||-1==t.Weights.indexOf(n[o])?s.fontSize?"inherit"!=n[o]&&(r+=n[o]):("inherit"!=n[o]&&(i.fontSize=n[o].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0):("inherit"!=n[o]&&(i.fontWeight=n[o]),s.fontStyle=s.fontVariant=s.fontWeight=!0):("inherit"!=n[o]&&(i.fontVariant=n[o]),s.fontStyle=s.fontVariant=!0):("inherit"!=n[o]&&(i.fontStyle=n[o]),s.fontStyle=!0);return""!=r&&(i.fontFamily=r),i}},a.ToNumberArray=function(t){for(var e=a.trim(a.compressSpaces((t||"").replace(/,/g," "))).split(" "),i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return e},a.Point=function(t,e){this.x=t,this.y=e},a.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},a.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],i=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=i},a.CreatePoint=function(t){var e=a.ToNumberArray(t);return new a.Point(e[0],e[1])},a.CreatePath=function(t){for(var e=a.ToNumberArray(t),i=[],n=0;n<e.length;n+=2)i.push(new a.Point(e[n],e[n+1]));return i},a.BoundingBox=function(t,e,i,n){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,i,n,s,a){var r=t+2/3*(i-t),o=e+2/3*(n-e),h=r+1/3*(s-t),l=o+1/3*(a-e);this.addBezierCurve(t,e,r,h,o,l,s,a)},this.addBezierCurve=function(t,e,i,n,s,a,r,o){var h=[t,e],l=[i,n],u=[s,a],c=[r,o];this.addPoint(h[0],h[1]),this.addPoint(c[0],c[1]);for(var f=0;1>=f;f++){var p=function(t){return Math.pow(1-t,3)*h[f]+3*Math.pow(1-t,2)*t*l[f]+3*(1-t)*Math.pow(t,2)*u[f]+Math.pow(t,3)*c[f]},d=6*h[f]-12*l[f]+6*u[f],m=-3*h[f]+9*l[f]-9*u[f]+3*c[f],y=3*l[f]-3*h[f];if(0!=m){var v=Math.pow(d,2)-4*y*m;if(!(0>v)){var g=(-d+Math.sqrt(v))/(2*m);g>0&&1>g&&(0==f&&this.addX(p(g)),1==f&&this.addY(p(g)));var x=(-d-Math.sqrt(v))/(2*m);x>0&&1>x&&(0==f&&this.addX(p(x)),1==f&&this.addY(p(x)))}}else{if(0==d)continue;var b=-y/d;b>0&&1>b&&(0==f&&this.addX(p(b)),1==f&&this.addY(p(b)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(i,n)},a.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=a.ToNumberArray(t);this.angle=new a.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=a.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],i=this.m[2],n=this.m[4],s=this.m[1],a=this.m[3],r=this.m[5],o=0,h=0,l=1,u=1/(e*(a*l-r*h)-i*(s*l-r*o)+n*(s*h-a*o));t.transform(u*(a*l-r*h),u*(r*o-s*l),u*(n*h-i*l),u*(e*l-n*o),u*(i*r-n*a),u*(n*s-e*r))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new a.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;e>=0;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var i=a.trim(a.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),n=0;n<i.length;n++){var s=a.trim(i[n].split("(")[0]),r=i[n].split("(")[1].replace(")",""),o=this.Type[s];if("undefined"!=typeof o){var h=new o(r);h.type=s,this.transforms.push(h)}}},a.AspectRatio=function(t,e,i,n,s,r,o,h,l,u){e=a.compressSpaces(e),e=e.replace(/^defer\s/,"");var c=e.split(" ")[0]||"xMidYMid",f=e.split(" ")[1]||"meet",p=i/n,d=s/r,m=Math.min(p,d),y=Math.max(p,d);"meet"==f&&(n*=m,r*=m),"slice"==f&&(n*=y,r*=y),l=new a.Property("refX",l),u=new a.Property("refY",u),l.hasValue()&&u.hasValue()?t.translate(-m*l.toPixels("x"),-m*u.toPixels("y")):(c.match(/^xMid/)&&("meet"==f&&m==d||"slice"==f&&y==d)&&t.translate(i/2-n/2,0),c.match(/YMid$/)&&("meet"==f&&m==p||"slice"==f&&y==p)&&t.translate(0,s/2-r/2),c.match(/^xMax/)&&("meet"==f&&m==d||"slice"==f&&y==d)&&t.translate(i-n,0),c.match(/YMax$/)&&("meet"==f&&m==p||"slice"==f&&y==p)&&t.translate(0,s-r)),"none"==c?t.scale(p,d):"meet"==f?t.scale(m,m):"slice"==f&&t.scale(y,y),t.translate(null==o?0:-o,null==h?0:-h)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var i=this.attributes[t];return null!=i?i:(1==e&&(i=new a.Property(t,""),this.attributes[t]=i),i||a.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return a.EmptyProperty},this.style=function(t,e,i){var n=this.styles[t];if(null!=n)return n;var s=this.attribute(t);if(null!=s&&s.hasValue())return this.styles[t]=s,s;if(1!=i){var r=this.parent;if(null!=r){var o=r.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(n=new a.Property(t,""),this.styles[t]=n),n||a.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var i=this.style("filter").getDefinition();null!=i&&i.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var i=t;e&&(i=a.CreateElement(t)),i.parent=this,"title"!=i.type&&this.children.push(i)},this.addStylesFromStyleDefinition=function(){for(var e in a.Styles)if("@"!=e[0]&&s(t,e)){var i=a.Styles[e],n=a.StylesSpecificity[e];if(null!=i)for(var r in i){var o=this.stylesSpecificity[r];"undefined"==typeof o&&(o="000"),n>o&&(this.styles[r]=i[r],this.stylesSpecificity[r]=n)}}};var e=new RegExp("^[A-Z-]+$"),i=function(t){return e.test(t)?t.toLowerCase():t};if(null!=t&&1==t.nodeType){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n],o=i(r.nodeName);this.attributes[o]=new a.Property(o,r.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var h=this.attribute("style").value.split(";"),n=0;n<h.length;n++)if(""!=a.trim(h[n])){var l=h[n].split(":"),u=a.trim(l[0]),c=a.trim(l[1]);this.styles[u]=new a.Property(u,c)}this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this);for(var n=0;n<t.childNodes.length;n++){var f=t.childNodes[n];if(1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&(3==f.nodeType||4==f.nodeType)){var p=f.value||f.text||f.textContent||"";""!=a.compressSpaces(p)&&this.addChild(new a.Element.tspan(f),!1)}}}},a.Element.RenderedElementBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.setContext=function(t){if(this.style("fill").isUrlDefinition()){var e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=e&&(t.fillStyle=e)}else if(this.style("fill").hasValue()){var i=this.style("fill");"currentColor"==i.value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("fill-opacity").hasValue()){var i=new a.Property("fill",t.fillStyle);i=i.addOpacity(this.style("fill-opacity")),t.fillStyle=i.value}if(this.style("stroke").isUrlDefinition()){var e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=e&&(t.strokeStyle=e)}else if(this.style("stroke").hasValue()){var n=this.style("stroke");"currentColor"==n.value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.strokeStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("stroke-opacity").hasValue()){var n=new a.Property("stroke",t.strokeStyle);n=n.addOpacity(this.style("stroke-opacity")),t.strokeStyle=n.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var r=a.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof t.setLineDash?t.setLineDash(r):"undefined"!=typeof t.webkitLineDash?t.webkitLineDash=r:"undefined"==typeof t.mozDash||1==r.length&&0==r[0]||(t.mozDash=r);var o=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof t.lineDashOffset?t.lineDashOffset=o:"undefined"!=typeof t.webkitLineDashOffset?t.webkitLineDashOffset=o:"undefined"!=typeof t.mozDashOffset&&(t.mozDashOffset=o)}if("undefined"!=typeof t.font&&(t.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()){var h=new a.Transform(this.style("transform",!1,!0).value);h.apply(t)}if(this.style("clip-path",!1,!0).hasValue()){var l=this.style("clip-path",!1,!0).getDefinition();null!=l&&l.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new a.BoundingBox},this.renderChildren=function(t){this.path(t),a.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()){var i=this.style("marker-start").getDefinition();i.render(t,e[0][0],e[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var i=this.style("marker-mid").getDefinition(),n=1;n<e.length-1;n++)i.render(t,e[n][0],e[n][1]);if(this.style("marker-end").isUrlDefinition()){var i=this.style("marker-end").getDefinition();i.render(t,e[e.length-1][0],e[e.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,"undefined"!=typeof t.font&&"undefined"!=typeof window.getComputedStyle&&(t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")),this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=a.ViewPort.width(),i=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){e=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var n=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(n=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(n,s),t.lineTo(e,s),t.lineTo(e,i),t.lineTo(n,i),t.closePath(),t.clip())}if(a.ViewPort.SetCurrent(e,i),this.attribute("viewBox").hasValue()){var r=a.ToNumberArray(this.attribute("viewBox").value),o=r[0],h=r[1];e=r[2],i=r[3],a.AspectRatio(t,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),e,a.ViewPort.height(),i,o,h,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(r[2],r[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),r=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=r),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(r=o),r=Math.min(r,n/2),o=Math.min(o,s/2),null!=t&&(t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+o),t.lineTo(e+n,i+s-o),t.quadraticCurveTo(e+n,i+s,e+n-r,i+s),t.lineTo(e+r,i+s),t.quadraticCurveTo(e,i+s,e,i+s-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+r,i),t.closePath()),new a.BoundingBox(e,i,e+n,i+s)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),n=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!0),t.closePath()),new a.BoundingBox(e-n,i-n,e+n,i+n)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=4*((Math.sqrt(2)-1)/3),i=this.attribute("rx").toPixels("x"),n=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(s,r-n),t.bezierCurveTo(s+e*i,r-n,s+i,r-e*n,s+i,r),t.bezierCurveTo(s+i,r+e*n,s+e*i,r+n,s,r+n),t.bezierCurveTo(s-e*i,r+n,s-i,r+e*n,s-i,r),t.bezierCurveTo(s-i,r-e*n,s-e*i,r-n,s,r-n),t.closePath()),new a.BoundingBox(s-i,r-n,s+i,r+n)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(t){this.base=a.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new a.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(t){this.base=a.Element.PathElementBase,this.base(t),this.points=a.CreatePath(this.attribute("points").value),this.path=function(t){var e=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)e.addPoint(this.points[i].x,this.points[i].y),null!=t&&t.lineTo(this.points[i].x,this.points[i].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return t.length>0&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(t){this.base=a.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(t){this.base=a.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var i=0;2>i;i++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),e=e.replace(/([0-9])([+\-])/gm,"$1 $2");for(var i=0;2>i;i++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=a.compressSpaces(e),e=a.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t,t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t,t},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var t=new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,i){null!=i&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var i=new a.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var n=e.getAsCurrentPoint();for(e.addMarker(n),i.addPoint(n.x,n.y),null!=t&&t.moveTo(n.x,n.y),e.start=e.current;!e.isCommandOrEnd();){var n=e.getAsCurrentPoint();e.addMarker(n,e.start),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"L":case"l":for(;!e.isCommandOrEnd();){var s=e.current,n=e.getAsCurrentPoint();e.addMarker(n,s),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var r=new a.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();){var r=new a.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar());e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,h=e.getPoint(),l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,h),i.addBezierCurve(o.x,o.y,h.x,h.y,l.x,l.y,u.x,u.y),null!=t&&t.bezierCurveTo(h.x,h.y,l.x,l.y,u.x,u.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();){var o=e.current,h=e.getReflectedControlPoint(),l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,h),i.addBezierCurve(o.x,o.y,h.x,h.y,l.x,l.y,u.x,u.y),null!=t&&t.bezierCurveTo(h.x,h.y,l.x,l.y,u.x,u.y)}break;case"Q":case"q":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y),null!=t&&t.quadraticCurveTo(l.x,l.y,u.x,u.y)}break;case"T":case"t":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getReflectedControlPoint();e.control=l;var u=e.getAsCurrentPoint();e.addMarker(u,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y),null!=t&&t.quadraticCurveTo(l.x,l.y,u.x,u.y)}break;case"A":case"a":for(;!e.isCommandOrEnd();){var o=e.current,c=e.getScalar(),f=e.getScalar(),p=e.getScalar()*(Math.PI/180),d=e.getScalar(),m=e.getScalar(),u=e.getAsCurrentPoint(),y=new a.Point(Math.cos(p)*(o.x-u.x)/2+Math.sin(p)*(o.y-u.y)/2,-Math.sin(p)*(o.x-u.x)/2+Math.cos(p)*(o.y-u.y)/2),v=Math.pow(y.x,2)/Math.pow(c,2)+Math.pow(y.y,2)/Math.pow(f,2);v>1&&(c*=Math.sqrt(v),f*=Math.sqrt(v));var g=(d==m?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(y.y,2)-Math.pow(f,2)*Math.pow(y.x,2))/(Math.pow(c,2)*Math.pow(y.y,2)+Math.pow(f,2)*Math.pow(y.x,2)));isNaN(g)&&(g=0);var x=new a.Point(g*c*y.y/f,g*-f*y.x/c),b=new a.Point((o.x+u.x)/2+Math.cos(p)*x.x-Math.sin(p)*x.y,(o.y+u.y)/2+Math.sin(p)*x.x+Math.cos(p)*x.y),P=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(P(t)*P(e))},w=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},C=w([1,0],[(y.x-x.x)/c,(y.y-x.y)/f]),B=[(y.x-x.x)/c,(y.y-x.y)/f],M=[(-y.x-x.x)/c,(-y.y-x.y)/f],T=w(B,M);E(B,M)<=-1&&(T=Math.PI),E(B,M)>=1&&(T=0);var V=1-m?1:-1,S=C+V*(T/2),k=new a.Point(b.x+c*Math.cos(S),b.y+f*Math.sin(S));if(e.addMarkerAngle(k,S-V*Math.PI/2),e.addMarkerAngle(u,S-V*Math.PI),i.addPoint(u.x,u.y),null!=t){var E=c>f?c:f,A=c>f?1:c/f,D=c>f?f/c:1;t.translate(b.x,b.y),t.rotate(p),t.scale(A,D),t.arc(0,0,E,C,C+T,1-m),t.scale(1/A,1/D),t.rotate(-p),t.translate(-b.x,-b.y)}}break;case"Z":case"z":null!=t&&t.closePath(),e.current=e.start}return i},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),i=[],n=0;n<t.length;n++)i.push([t[n],e[n]]);return i}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(t){this.base=a.Element.ElementBase,this.base(t),this.createPattern=function(t){var e=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),n=new a.Element.svg;n.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),n.attributes.width=new a.Property("width",e+"px"),n.attributes.height=new a.Property("height",i+"px"),n.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),n.children=this.children;var s=document.createElement("canvas");s.width=e,s.height=i;var r=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&r.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var o=-1;1>=o;o++)for(var h=-1;1>=h;h++)r.save(),n.attributes.x=new a.Property("x",o*s.width),n.attributes.y=new a.Property("y",h*s.height),n.render(r),r.restore();var l=t.createPattern(s,"repeat");return l}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(t){this.base=a.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,i){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var n=new a.Element.svg;n.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),n.attributes.refX=new a.Property("refX",this.attribute("refX").value),n.attributes.refY=new a.Property("refY",this.attribute("refY").value),n.attributes.width=new a.Property("width",this.attribute("markerWidth").value),n.attributes.height=new a.Property("height",this.attribute("markerHeight").value),n.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),n.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),n.children=this.children,n.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-i),t.translate(-e.x,-e.y)}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(t){this.base=a.Element.ElementBase,this.base(t),this.render=function(){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var i=this.attributesToInherit[e];!this.attribute(i).hasValue()&&t.attribute(i).hasValue()&&(this.attribute(i,!0).value=t.attribute(i).value)}},this.createGradient=function(t,e,i){var n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));var s=function(t){if(i.hasValue()){var e=new a.Property("color",t);return e.addOpacity(i).value}return t},r=this.getGradient(t,e);if(null==r)return s(n.stops[n.stops.length-1].color);for(var o=0;o<n.stops.length;o++)r.addColorStop(n.stops[o].offset,s(n.stops[o].color));if(this.attribute("gradientTransform").hasValue()){var h=a.ViewPort.viewPorts[0],l=new a.Element.rect;l.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),l.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),l.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),l.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var u=new a.Element.g;u.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),u.children=[l];var c=new a.Element.svg;c.attributes.x=new a.Property("x",0),c.attributes.y=new a.Property("y",0),c.attributes.width=new a.Property("width",h.width),c.attributes.height=new a.Property("height",h.height),c.children=[u];var f=document.createElement("canvas");f.width=h.width,f.height=h.height;var p=f.getContext("2d");return p.fillStyle=r,c.render(p),p.createPattern(f,"no-repeat")}return r}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var i="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),a="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return n==a&&s==r?null:t.createLinearGradient(n,s,a,r)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var i=e.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),a=n,r=s;this.attribute("fx").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"==this.gradientUnits()?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(a,r,0,n,s,o)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(t){this.base=a.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(t){this.base=a.Element.ElementBase,this.base(t),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var i=this.calcValue();if(this.attribute("type").hasValue()){var n=this.attribute("type").value;i=n+"("+i+")"}this.getProperty().value=i,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),i=Math.floor(e),n=Math.ceil(e);t.from=new a.Property("from",parseFloat(this.values.value[i])),t.to=new a.Property("to",parseFloat(this.values.value[n])),t.progress=(e-i)/(n-i)}else t.from=this.from,t.to=this.to;return t}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress(),e=t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress;return e+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),i=new t(e.from.value),n=new t(e.to.value);if(i.ok&&n.ok){var s=i.r+(n.r-i.r)*e.progress,a=i.g+(n.g-i.g)*e.progress,r=i.b+(n.b-i.b)*e.progress;return"rgb("+parseInt(s,10)+","+parseInt(a,10)+","+parseInt(r,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=a.ToNumberArray(t.from.value),i=a.ToNumberArray(t.to.value),n="",s=0;s<e.length;s++)n+=e[s]+(i[s]-e[s])*t.progress+" ";return n}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(t){this.base=a.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"font-face"==i.type?(this.fontFace=i,i.style("font-family").hasValue()&&(a.Definitions[i.style("font-family").value]=this)):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(t){this.base=a.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(t){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(t,e-i,t+Math.floor(2*i/3)*this.children[0].getText().length,e)},this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,i){var n=this.style("text-anchor").valueOrDefault("start");if("start"!=n){for(var s=0,a=i;a<e.children.length;a++){var r=e.children[a];if(a>i&&r.attribute("x").hasValue())break;r.measureTextRecursive&&(s+=r.measureTextRecursive(t))}return-1*("end"==n?s:s/2)}return 0},this.renderChild=function(t,e,i,n){var s=i.children[n];s.attribute("x").hasValue()?(s.x=s.attribute("x").toPixels("x")+e.getAnchorDelta(t,i,n),s.attribute("dx").hasValue()&&(s.x+=s.attribute("dx").toPixels("x"))):(s.attribute("dx").hasValue()&&(e.x+=s.attribute("dx").toPixels("x")),s.x=e.x),e.x=s.x+s.measureText(t),s.attribute("y").hasValue()?(s.y=s.attribute("y").toPixels("y"),s.attribute("dy").hasValue()&&(s.y+=s.attribute("dy").toPixels("y"))):(s.attribute("dy").hasValue()&&(e.y+=s.attribute("dy").toPixels("y")),s.y=e.y),e.y=s.y,s.render(t);for(var n=0;n<s.children.length;n++)e.renderChild(t,e,s,n)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,i){var n=e[i],s=null;if(t.isArabic){var a="isolated";(0==i||" "==e[i-1])&&i<e.length-2&&" "!=e[i+1]&&(a="terminal"),i>0&&" "!=e[i-1]&&i<e.length-2&&" "!=e[i+1]&&(a="medial"),i>0&&" "!=e[i-1]&&(i==e.length-1||" "==e[i+1])&&(a="initial"),"undefined"!=typeof t.glyphs[n]&&(s=t.glyphs[n][a],null==s&&"glyph"==t.glyphs[n].type&&(s=t.glyphs[n]))}else s=t.glyphs[n];return null==s&&(s=t.missingGlyph),s},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y);else{var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),n=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),s=this.getText();e.isRTL&&(s=s.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<s.length;o++){var h=this.getGlyph(e,s,o),l=i/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(l,-l);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/i,"italic"==n&&t.transform(1,0,.4,1,0,0),h.render(t),"italic"==n&&t.transform(1,0,-.4,1,0,0),t.lineWidth=u,t.scale(1/l,-1/l),t.translate(-this.x,-this.y),this.x+=i*(h.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,"undefined"==typeof r[o]||isNaN(r[o])||(this.x+=r[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),i=0;i<this.children.length;i++)e+=this.children[i].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),n=0,s=this.getText();e.isRTL&&(s=s.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<s.length;o++){var h=this.getGlyph(e,s,o);n+=(h.horizAdvX||e.horizAdvX)*i/e.fontFace.unitsPerEm,"undefined"==typeof r[o]||isNaN(r[o])||(n+=r[o])}return n}var l=a.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t);var u=t.measureText(l).width;return t.restore(),u}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(t){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(t),this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(t){this.base=a.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();return null!=t?t.children[0].getText():void 0}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(t){this.base=a.Element.TextElementBase,this.base(t),this.hasText=t.childNodes.length>0;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(this.children.length>0){var i=new a.Element.g;i.children=this.children,i.parent=this,i.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.textPath=function(t){this.base=a.Element.TextElementBase,this.base(t);var e=this.getHrefAttribute().getDefinition();this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.renderChildren=function(t){this.setTextData(t),t.save();var e=this.parent.style("text-decoration").value,i=this.fontSize(),n=this.glyphInfo,s=t.fillStyle;"underline"===e&&t.beginPath();for(var r=0;r<n.length;r++){var o=n[r].p0,h=n[r].p1,l=n[r].text;t.save(),t.translate(o.x,o.y),t.rotate(n[r].rotation),""!=t.fillStyle&&t.fillText(a.compressSpaces(l),0,0),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(l),0,0),t.restore(),"underline"===e&&(0===r&&t.moveTo(o.x,o.y+i/8),t.lineTo(h.x,h.y+i/5))}"underline"===e&&(t.lineWidth=i/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()},this.path=function(t){var e=this.dataArray;null!=t&&t.beginPath();for(var i=0;i<e.length;i++){var n=e[i].command,s=e[i].points;switch(n){case"L":null!=t&&t.lineTo(s[0],s[1]);break;case"M":null!=t&&t.moveTo(s[0],s[1]);break;case"C":null!=t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":null!=t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var a=s[0],r=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=s[6],f=s[7],p=o>h?o:h,d=o>h?1:o/h,m=o>h?h/o:1;null!=t&&(t.translate(a,r),t.rotate(c),t.scale(d,m),t.arc(0,0,p,l,l+u,1-f),t.scale(1/d,1/m),t.rotate(-c),t.translate(-a,-r));break;case"z":null!=t&&t.closePath()}}},this.getText=function(){return this.text},this.fontSize=function(){return this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize)},this.measureText=function(t,e){var i=this.parent.style("font-family").getDefinition();if(e=e||this.getText(),null!=i){var n=this.fontSize(),s=0;i.isRTL&&(e=e.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<e.length;o++){var h=this.getGlyph(i,e,o);s+=(h.horizAdvX||i.horizAdvX)*n/i.fontFace.unitsPerEm,"undefined"==typeof r[o]||isNaN(r[o])||(s+=r[o])}return s}var l=a.compressSpaces(e);if(!t.measureText)return 10*l.length;t.save(),this.setContext(t);var u=t.measureText(l).width;return t.restore(),u},this.setTextData=function(t){if(!this.hasOwnProperty("glyphInfo")){var e=this,i=this.getText().split(""),n=this.getText().split(" ").length-1,s=a.ToNumberArray(this.parent.attribute("dx").valueOrDefault("0")),r=this.parent.style("letter-spacing").numValueOrDefault(0),o=this.parent.style("text-anchor").valueOrDefault("start");this.letterSpacingCache=[];for(var h=0;h<this.getText().length;h++)this.letterSpacingCache.push(void 0!==s[h]?s[h]:r);var l=this.letterSpacingCache.reduce(function(t,e){return t+e||0},0);this.textWidth=this.measureText(t),this.textHeight=this.fontSize();var u=Math.max(this.textWidth+l,0);this.glyphInfo=[];var c=this.getPathLength(),f=this.style("startOffset").numValueOrDefault(0)*c,p=0;("middle"===o||"center"===o)&&(p=-u/2),("end"===o||"right"===o)&&(p=-u),p+=f;for(var d=function(t){return t=t||0,e.letterSpacingCache[t]||0},m=function(i,s){var a=e.measureText(t,i);" "===i&&"justify"===o&&c>u&&(a+=(c-u)/n),s>-1&&(p+=d(s));var r=e.textHeight/20,h={p0:e.getEquidistantPointOnPath(p,r),p1:e.getEquidistantPointOnPath(p+a,r)};return p+=a,h},h=0;h<i.length;h++){var y=m(i[h],h);if(void 0!==y.p0&&void 0!==y.p1){var v=e.getLineLength(y.p0.x,y.p0.y,y.p1.x,y.p1.y),g=0,x=e.getPointOnLine(g+v/2,y.p0.x,y.p0.y,y.p1.x,y.p1.y),b=Math.atan2(y.p1.y-y.p0.y,y.p1.x-y.p0.x);this.glyphInfo.push({transposeX:x.x,transposeY:x.y,text:i[h],rotation:b,p0:y.p0,p1:y.p1})}}}},this.parsePathData=function(t){if(this.pathLength=void 0,!t)return[];var e=[],i=t.PathParser;for(i.reset();!i.isEnd();){var n=[],s=null,r=i.current?i.current.x:0,o=i.current?i.current.y:0;i.nextCommand();var h=i.command.toUpperCase();switch(i.command){case"M":case"m":var l=i.getAsCurrentPoint();for(n.push(l.x,l.y),i.start=i.current;!i.isCommandOrEnd();){var l=i.getAsCurrentPoint();n.push(l.x,l.y),s="L"}break;case"L":case"l":for(;!i.isCommandOrEnd();){var l=i.getAsCurrentPoint();n.push(l.x,l.y)}s="L";break;case"H":case"h":for(;!i.isCommandOrEnd();){var u=new a.Point((i.isRelativeCommand()?i.current.x:0)+i.getScalar(),i.current.y);n.push(u.x,u.y),i.current=u}s="L";break;case"V":case"v":for(;!i.isCommandOrEnd();){var u=new a.Point(i.current.x,(i.isRelativeCommand()?i.current.y:0)+i.getScalar());n.push(u.x,u.y),i.current=u}s="L";break;case"C":case"c":for(;!i.isCommandOrEnd();){var c=i.getPoint(),f=i.getAsControlPoint(),p=i.getAsCurrentPoint();n.push(c.x,c.y,f.x,f.y,p.x,p.y)}break;case"S":case"s":for(;!i.isCommandOrEnd();){var c=i.getReflectedControlPoint(),f=i.getAsControlPoint(),p=i.getAsCurrentPoint();n.push(c.x,c.y,f.x,f.y,p.x,p.y)}s="C";break;case"Q":case"q":for(;!i.isCommandOrEnd();){var f=i.getAsControlPoint(),p=i.getAsCurrentPoint();n.push(f.x,f.y,p.x,p.y)}break;case"T":case"t":for(;!i.isCommandOrEnd();){var f=i.getReflectedControlPoint();i.control=f;var p=i.getAsCurrentPoint();n.push(f.x,f.y,p.x,p.y)}s="Q";break;case"A":case"a":for(;!i.isCommandOrEnd();){var d=i.current,m=i.getScalar(),y=i.getScalar(),v=i.getScalar()*(Math.PI/180),g=i.getScalar(),x=i.getScalar(),p=i.getAsCurrentPoint(),b=new a.Point(Math.cos(v)*(d.x-p.x)/2+Math.sin(v)*(d.y-p.y)/2,-Math.sin(v)*(d.x-p.x)/2+Math.cos(v)*(d.y-p.y)/2),P=Math.pow(b.x,2)/Math.pow(m,2)+Math.pow(b.y,2)/Math.pow(y,2);P>1&&(m*=Math.sqrt(P),y*=Math.sqrt(P));var E=(g==x?-1:1)*Math.sqrt((Math.pow(m,2)*Math.pow(y,2)-Math.pow(m,2)*Math.pow(b.y,2)-Math.pow(y,2)*Math.pow(b.x,2))/(Math.pow(m,2)*Math.pow(b.y,2)+Math.pow(y,2)*Math.pow(b.x,2)));isNaN(E)&&(E=0);var w=new a.Point(E*m*b.y/y,E*-y*b.x/m),C=new a.Point((d.x+p.x)/2+Math.cos(v)*w.x-Math.sin(v)*w.y,(d.y+p.y)/2+Math.sin(v)*w.x+Math.cos(v)*w.y),B=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},M=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(B(t)*B(e))},T=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(M(t,e))},V=T([1,0],[(b.x-w.x)/m,(b.y-w.y)/y]),S=[(b.x-w.x)/m,(b.y-w.y)/y],k=[(-b.x-w.x)/m,(-b.y-w.y)/y],A=T(S,k);M(S,k)<=-1&&(A=Math.PI),M(S,k)>=1&&(A=0),0===x&&A>0&&(A-=2*Math.PI),1===x&&0>A&&(A+=2*Math.PI),n=[C.x,C.y,m,y,V,A,v,x]}break;case"Z":case"z":i.current=i.start}e.push("Z"!==h?{command:s||h,points:n,start:{x:r,y:o},pathLength:this.calcLength(r,o,s||h,n)}:{command:"z",points:[],start:void 0,pathLength:0})}return e},this.getPathLength=function(){if(void 0===this.pathLength||null===this.pathLength||isNaN(this.pathLength)){this.pathLength=0;for(var t=0;t<this.dataArray.length;t++)this.dataArray[t].pathLength>0&&(this.pathLength+=this.dataArray[t].pathLength)}return this.pathLength},this.getPointOnPath=function(t){var e=0,i=this.getPathLength(),n=void 0;if(-5e-5>t||t-5e-5>i)return void 0;for(var s=0;s<this.dataArray.length;s++){var a=this.dataArray[s];{if(!a||!(a.pathLength<5e-5||e+a.pathLength+5e-5<t)){var r=t-e,o=void 0;switch(a.command){case"L":n=this.getPointOnLine(r,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case"A":var h=a.points[4],l=a.points[5],u=a.points[4]+l;if(o=h+r/a.pathLength*l,0>l&&u>o||l>=0&&o>u)break;n=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],o,a.points[6]);break;case"C":o=r/a.pathLength,o>1&&(o=1),n=this.getPointOnCubicBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case"Q":o=r/a.pathLength,o>1&&(o=1),n=this.getPointOnQuadraticBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}if(void 0!==n&&n!=={})return n;break}e+=a.pathLength}}},this.buildEquidistantCache=function(t,e){var i=this.getPathLength();if(e=e||.25,t=t||i/100,this.equidistantCache=this.equidistantCache||{},!this.equidistantCache.hasOwnProperty("points")||this.equidistantCache.step!=t||this.equidistantCache.precision!=e){this.equidistantCache={step:t,precision:e,points:[]};for(var n=0,s=0;i>=s;s+=e){var a=this.getPointOnPath(s),r=this.getPointOnPath(s+e);void 0!==a&&void 0!==r&&(n+=this.getLineLength(a.x,a.y,r.x,r.y),n>=t&&(this.equidistantCache.points.push({x:a.x,y:a.y,distance:s}),n-=t))}}},this.getEquidistantPointOnPath=function(t,e,i){if(this.buildEquidistantCache(e,i),0>t||t-this.getPathLength()>5e-5)return void 0;var n=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[n]||void 0},this.getLineLength=function(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))},this.getPointOnLine=function(t,e,i,n,s,a,r){void 0===a&&(a=e),void 0===r&&(r=i);var o=(s-i)/(n-e+1e-8),h=Math.sqrt(t*t/(1+o*o));e>n&&(h*=-1);var l,u=o*h;if(n===e)l={x:a,y:r+u};else if((r-i)/(a-e+1e-8)===o)l={x:a+h,y:r+u};else{var c,f,p=this.getLineLength(e,i,n,s);if(1e-8>p)return void 0;var d=(a-e)*(n-e)+(r-i)*(s-i);d/=p*p,c=e+d*(n-e),f=i+d*(s-i);var m=this.getLineLength(a,r,c,f),y=Math.sqrt(t*t-m*m);h=Math.sqrt(y*y/(1+o*o)),e>n&&(h*=-1),u=o*h,l={x:c+h,y:f+u}}return l},this.getPointOnCubicBezier=function(t,e,i,n,s,a,r,o,h){function l(t){return t*t*t}function u(t){return 3*t*t*(1-t)}function c(t){return 3*t*(1-t)*(1-t)}function f(t){return(1-t)*(1-t)*(1-t)}var p=o*l(t)+a*u(t)+n*c(t)+e*f(t),d=h*l(t)+r*u(t)+s*c(t)+i*f(t);return{x:p,y:d}},this.getPointOnQuadraticBezier=function(t,e,i,n,s,a,r){function o(t){return t*t}function h(t){return 2*t*(1-t)}function l(t){return(1-t)*(1-t)}var u=a*o(t)+n*h(t)+e*l(t),c=r*o(t)+s*h(t)+i*l(t);return{x:u,y:c}},this.getPointOnEllipticalArc=function(t,e,i,n,s,a){var r=Math.cos(a),o=Math.sin(a),h={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:t+(h.x*r-h.y*o),y:e+(h.x*o+h.y*r)}},this.calcLength=function(t,e,i,n){var s,a,r,o;switch(i){case"L":return this.getLineLength(t,e,n[0],n[1]);case"C":for(s=0,a=this.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),o=.01;1>=o;o+=.01)r=this.getPointOnCubicBezier(o,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return s;case"Q":for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),o=.01;1>=o;o+=.01)r=this.getPointOnQuadraticBezier(o,t,e,n[0],n[1],n[2],n[3]),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return s;case"A":s=0;var h=n[4],l=n[5],u=n[4]+l,c=Math.PI/180;if(Math.abs(h-u)<c&&(c=Math.abs(h-u)),a=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),0>l)for(o=h-c;o>u;o-=c)r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;else for(o=h+c;u>o;o+=c)r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],u,0),s+=this.getLineLength(a.x,a.y,r.x,r.y)}return 0},this.dataArray=this.parsePathData(e)},a.Element.textPath.prototype=new a.Element.TextElementBase,a.Element.image=function(t){this.base=a.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var i=e.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,i)this.img=a.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var n=this;this.img.onload=function(){n.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+e+'" not found'),n.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");0!=s&&0!=r&&(t.save(),i?t.drawSvg(this.img,e,n,s,r):(t.translate(e,n),a.AspectRatio(t,this.attribute("preserveAspectRatio").value,s,this.img.width,r,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");return new a.BoundingBox(t,e,t+i,e+n)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new a.BoundingBox,e=0;e<this.children.length;e++)t.addBoundingBox(this.children[e].getBoundingBox());return t}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.render=function(){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var e="",n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),e=a.compressSpaces(e);for(var s=e.split("}"),n=0;n<s.length;n++)if(""!=a.trim(s[n]))for(var r=s[n].split("{"),o=r[0].split(","),h=r[1].split(";"),l=0;l<o.length;l++){var u=a.trim(o[l]);if(""!=u){for(var c=a.Styles[u]||{},f=0;f<h.length;f++){var p=h[f].indexOf(":"),d=h[f].substr(0,p),m=h[f].substr(p+1,h[f].length-p);null!=d&&null!=m&&(c[a.trim(d)]=new a.Property(a.trim(d),a.trim(m)))}if(a.Styles[u]=c,a.StylesSpecificity[u]=i(u),"@font-face"==u)for(var y=c["font-family"].value.replace(/"/g,""),v=c.src.value.split(","),g=0;g<v.length;g++)if(v[g].indexOf('format("svg")')>0)for(var x=v[g].indexOf("url"),b=v[g].indexOf(")",x),P=v[g].substr(x+5,b-x-6),E=a.parseXml(a.ajax(P)),w=E.getElementsByTagName("font"),C=0;C<w.length;C++){var B=a.CreateElement(w[C]);a.Definitions[y]=B}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.getBoundingBox=function(){return null!=e?e.getBoundingBox():void 0},this.renderChildren=function(t){if(null!=e){var i=e;"symbol"==e.type&&(i=new a.Element.svg,i.type="svg",i.attributes.viewBox=new a.Property("viewBox",e.attribute("viewBox").value),i.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),i.attributes.overflow=new a.Property("overflow",e.attribute("overflow").value),i.children=e.children),"svg"==i.type&&(this.attribute("width").hasValue()&&(i.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(i.attributes.height=new a.Property("height",this.attribute("height").value)));var n=i.parent;i.parent=null,i.render(t),i.parent=n}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");if(0==s&&0==r){for(var o=new a.BoundingBox,h=0;h<this.children.length;h++)o.addBoundingBox(this.children[h].getBoundingBox());var i=Math.floor(o.x1),n=Math.floor(o.y1),s=Math.floor(o.width()),r=Math.floor(o.height())}var l=e.attribute("mask").value;e.attribute("mask").value="";var u=document.createElement("canvas");u.width=i+s,u.height=n+r;var c=u.getContext("2d");this.renderChildren(c);var f=document.createElement("canvas");f.width=i+s,f.height=n+r;var p=f.getContext("2d");e.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=c.createPattern(u,"no-repeat"),p.fillRect(0,0,i+s,n+r),t.fillStyle=p.createPattern(f,"no-repeat"),t.fillRect(0,0,i+s,n+r),e.attribute("mask").value=l},this.render=function(){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var i=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},e.call(t);for(var n=0;n<this.children.length;n++){var s=this.children[n];if("undefined"!=typeof s.path){var r=null;s.style("transform",!1,!0).hasValue()&&(r=new a.Transform(s.style("transform",!1,!0).value),r.apply(t)),s.path(t),CanvasRenderingContext2D.prototype.closePath=i,r&&r.unapply(t)}}i.call(t),t.clip(),CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=i},this.render=function(){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=e.getBoundingBox(),n=Math.floor(i.x1),s=Math.floor(i.y1),a=Math.floor(i.width()),r=Math.floor(i.height()),o=e.style("filter").value;e.style("filter").value="";for(var h=0,l=0,u=0;u<this.children.length;u++){var c=this.children[u].extraFilterDistance||0;h=Math.max(h,c),l=Math.max(l,c)}var f=document.createElement("canvas");f.width=a+2*h,f.height=r+2*l;var p=f.getContext("2d");p.translate(-n+h,-s+l),e.render(p);for(var u=0;u<this.children.length;u++)"function"==typeof this.children[u].apply&&this.children[u].apply(p,0,0,a+2*h,r+2*l);t.drawImage(f,0,0,a+2*h,r+2*l,n-h,s-l,a+2*h,r+2*l),e.style("filter",!0).value=o},this.render=function(){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(t){function e(t,e,i,n,s,a){return t[i*n*4+4*e+a]}function i(t,e,i,n,s,a,r){t[i*n*4+4*e+a]=r}function n(t,e){var i=s[t];return i*(0>i?e-255:e)}this.base=a.Element.ElementBase,this.base(t);var s=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var r=s[0];s=[.213+.787*r,.715-.715*r,.072-.072*r,0,0,.213-.213*r,.715+.285*r,.072-.072*r,0,0,.213-.213*r,.715-.715*r,.072+.928*r,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var o=s[0]*Math.PI/180,h=function(t,e,i){return t+Math.cos(o)*e+Math.sin(o)*i};s=[h(.213,.787,-.213),h(.715,-.715,-.715),h(.072,-.072,.928),0,0,h(.213,-.213,.143),h(.715,.285,.14),h(.072,-.072,-.283),0,0,h(.213,-.213,-.787),h(.715,-.715,.715),h(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(t,s,a,r,o){for(var h=t.getImageData(0,0,r,o),a=0;o>a;a++)for(var s=0;r>s;s++){var l=e(h.data,s,a,r,o,0),u=e(h.data,s,a,r,o,1),c=e(h.data,s,a,r,o,2),f=e(h.data,s,a,r,o,3);i(h.data,s,a,r,o,0,n(0,l)+n(1,u)+n(2,c)+n(3,f)+n(4,1)),i(h.data,s,a,r,o,1,n(5,l)+n(6,u)+n(7,c)+n(8,f)+n(9,1)),i(h.data,s,a,r,o,2,n(10,l)+n(11,u)+n(12,c)+n(13,f)+n(14,1)),i(h.data,s,a,r,o,3,n(15,l)+n(16,u)+n(17,c)+n(18,f)+n(19,1))}t.clearRect(0,0,r,o),t.putImageData(h,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(t){this.base=a.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,i,n,s,r){return"undefined"==typeof e.canvasRGBA?void a.log("ERROR: StackBlur.js must be included for blur to work"):(t.canvas.id=a.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas.id,i,n,s,r,this.blurRadius),void document.body.removeChild(t.canvas))}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(t){a.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var i=null;return i="undefined"!=typeof a.Element[e]?new a.Element[e](t):new a.Element.MISSING(t),i.type=t.nodeName,i},a.load=function(t,e){a.loadXml(t,a.ajax(e))},a.loadXml=function(t,e){a.loadXmlDoc(t,a.parseXml(e))},a.loadXmlDoc=function(t,e){a.init(t);var i=function(e){for(var i=t.canvas;i;)e.x-=i.offsetLeft,e.y-=i.offsetTop,i=i.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e};1!=a.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=i(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=i(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onmousemove(e.x,e.y)});var n=a.CreateElement(e.documentElement);n.root=!0,n.addStylesFromStyleDefinition();var s=!0,r=function(){a.ViewPort.Clear(),t.canvas.parentNode&&a.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=a.opts.ignoreDimensions&&(n.style("width").hasValue()&&(t.canvas.width=n.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),n.style("height").hasValue()&&(t.canvas.height=n.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var i=t.canvas.clientWidth||t.canvas.width,r=t.canvas.clientHeight||t.canvas.height;if(1==a.opts.ignoreDimensions&&n.style("width").hasValue()&&n.style("height").hasValue()&&(i=n.style("width").toPixels("x"),r=n.style("height").toPixels("y")),a.ViewPort.SetCurrent(i,r),null!=a.opts.offsetX&&(n.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(n.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var o=null,h=null,l=a.ToNumberArray(n.attribute("viewBox").value);null!=a.opts.scaleWidth&&(n.attribute("width").hasValue()?o=n.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(l[2])||(o=l[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(n.attribute("height").hasValue()?h=n.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(l[3])||(h=l[3]/a.opts.scaleHeight)),null==o&&(o=h),null==h&&(h=o),n.attribute("width",!0).value=a.opts.scaleWidth,n.attribute("height",!0).value=a.opts.scaleHeight,n.style("transform",!0,!0).value+=" scale("+1/o+","+1/h+")"}1!=a.opts.ignoreClear&&t.clearRect(0,0,i,r),n.render(t),s&&(s=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(e))},o=!0;a.ImagesLoaded()&&(o=!1,r()),a.intervalID=setInterval(function(){var t=!1;if(o&&a.ImagesLoaded()&&(o=!1,t=!0),1!=a.opts.ignoreMouse&&(t|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var e=0;e<a.Animations.length;e++)t|=a.Animations[e].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(t=!0),t&&(r(),a.Mouse.runEvents())},1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInPath&&e.isPointInPath(n.x,n.y)&&(this.eventElements[i]=t)}},this.checkBoundingBox=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInBox(n.x,n.y)&&(this.eventElements[i]=t)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],i=this.eventElements[t];i;)e.run(i),i=i.parent;this.events=[],this.eventElements=[]}},a}var s,a=function(t,e,i){if(null!=t||null!=e||null!=i){"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var s=n(i||{});(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=s);var r=t.getContext("2d");"undefined"!=typeof e.documentElement?s.loadXmlDoc(r,e):"<"==e.substr(0,1)?s.loadXml(r,e):s.load(r,e)}else for(var o=document.querySelectorAll("svg"),h=0;h<o.length;h++){var l=o[h],u=document.createElement("canvas");u.width=l.clientWidth,u.height=l.clientHeight,l.parentNode.insertBefore(u,l),l.parentNode.removeChild(l);var c=document.createElement("div");c.appendChild(l),a(u,c.innerHTML)}};"undefined"!=typeof Element.prototype.matches?s=function(t,e){return t.matches(e)}:"undefined"!=typeof Element.prototype.webkitMatchesSelector?s=function(t,e){return t.webkitMatchesSelector(e)}:"undefined"!=typeof Element.prototype.mozMatchesSelector?s=function(t,e){return t.mozMatchesSelector(e)}:"undefined"!=typeof Element.prototype.msMatchesSelector?s=function(t,e){return t.msMatchesSelector(e)}:"undefined"!=typeof Element.prototype.oMatchesSelector?s=function(t,e){return t.oMatchesSelector(e)}:(("function"==typeof jQuery||"function"==typeof Zepto)&&(s=function(t,e){return $(t).is(e)}),"undefined"==typeof s&&(s=Sizzle.matchesSelector));var r=/(\[[^\]]+\])/g,o=/(#[^\s\+>~\.\[:]+)/g,h=/(\.[^\s\+>~\.\[:]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,u=/(:[\w-]+\([^\)]*\))/gi,c=/(:[^\s\+>~\.\[:]+)/g,f=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,i,n,s,r){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:i,scaleWidth:n,scaleHeight:s};for(var h in r)r.hasOwnProperty(h)&&(o[h]=r[h]);a(this.canvas,t,o)}),a});
function createVirtualChart(e){var t=new RequestParameters(6010),r=new AjaxRequest;t.setParameters(WorkSheets.getAssociatedActiveSheetName(),e),r.init("POST",t.getURL(),!0,t.getParametersAsString()),r.sendRequest()}function sendApiResponse(e){try{if(e.rangeData){var t=0;RangeHighlighter.clearAllColorSelection(),$.each(e.rangeData,function(e){RangeHighlighter.drawColorSelectionWithRangeName(e,colorLimit[t].substring(1,colorLimit[t++].length))})}}catch(e){}try{e.RID=RESOURCE_ID,self.parent.opener.postMessage(e,"https://"+document.domain)}catch(e){}}function InsertChartSaveToMyAccountDialog(){$("#SaveToMyAccountforImageandChartDlgMsg").html(jsMsg["Publish.SaveToMyAccount"]);var e={width:"450px",modal:!0,title:jsMsg.SaveToMyAccount,closeOnEscape:!1,close:function(){return!1},buttons:[{text:jsMsg.SaveToMyAccount,click:function(){sheetdialog.close(),saveToMyAccount.getDetails()}},{text:jsMsg.Cancel,click:function(){sheetdialog.close()}}]},t="";t=$("#SaveToMyAccforImageandChartContainer").html(),sheetdialog.open(t,e)}function setChartPermission(){var e=!1,t=!1,r=!1;switch(getViewType()){case"SHARE_VIEW":if(!ALLOW_TO_WRITE)break;case"NEW_VIEW":case"OPEN_VIEW":ALLOW_TO_WRITE&&(e=!0,t=!0);break;case"REMOTE_SAVE_VIEW":isReadOnlyViewMode||(e=!0,t=!0,r=!0);break;case"REMOTE_VIEW":e=!1,t=!1,r=!1;break;case"PUBLIC_VIEW":isReadOnlyViewMode||(e=!0,t=!0,r=!0)}ole.setObjectProperties("chart",{permissions:{isDraggable:e,isResizable:t,isEditable:r}})}!function(e){!function(e){{var t=(e.defaultOptions,e.doc),r=e.Chart,s=e.createElement,i=e.discardElement,n=(e.css,e.merge),a=e.each,o=e.extend;e.SVGRenderer}o(r.prototype,{SVGRenderer:function(e,t){var r=e.match(/<\/svg>(.*?$)/);return r&&r[1]&&(r='<foreignObject x="0" y="0" width="'+t.chart.width+'" height="'+t.chart.height+'"><body xmlns="ht""tp://www.w3.org/1999/xhtml">'+r[1]+"</body></foreignObject>",e=e.replace("</svg>",r+"</svg>")),e=e.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="ht""tp://www.w3.org/1999/xlink" ').replace(/(|NS[0-9]+:)href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g," ").replace(/&shy;/g,"­")},getChartHTML:function(){return this.container.innerHTML},getSVG:function(r){var l,c,h,p,u,g,d,x,y=this,f=n(y.options,r);return c=s("div",null,{position:"absolute",top:"-9999em",width:y.chartWidth+"px",height:y.chartHeight+"px"},t.body),d=y.renderTo.style.width,x=y.renderTo.style.height,u=f.chart.width||/px$/.test(d)&&parseInt(d,10)||600,g=f.chart.height||/px$/.test(x)&&parseInt(x,10)||400,o(f.chart,{animation:!1,renderTo:c,forExport:!0,renderer:"SVGRenderer",width:u,height:g}),delete f.data,f.series=[],a(y.series,function(e){p=n(e.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:e.visible}),p.isInternal||f.series.push(p)}),a(y.axes,function(t){t.userOptions.internalKey||(t.userOptions.internalKey=e.uniqueKey())}),l=new e.Chart(f,y.callback),r&&a(["xAxis","yAxis","series"],function(e){var t={};r[e]&&(t[e]=r[e],l.update(t))}),a(y.axes,function(t){var r=e.find(l.axes,function(e){return e.options.internalKey===t.userOptions.internalKey}),s=t.getExtremes(),i=s.userMin,n=s.userMax;!r||void 0===i&&void 0===n||r.setExtremes(i,n,!0,!1)}),h=l.getChartHTML(),f=null,l.destroy(),i(c),h}})}(e),e.Legend.prototype.getAllItems=function(){{var t=[],r=e.each;e.pick,e.defined}r(this.chart.series,function(e){var r=e&&e.options;e&&r.showInLegend&&(t=t.concat(e.legendItems||("point"===r.legendType?e.data:e)))});var s=[];return r(t,function(e){!e.series||-1===e.series.chart.options.chart.type.indexOf("pie")&&-1===e.series.chart.options.chart.type.indexOf("funnel")?s.push(e):e.y&&s.push(e)}),s},e.Axis.prototype.log2lin=function(e){var t,r=this.userOptions&&this.userOptions.baseValue||10,s=0>e,i=Math.abs(e);return r>i&&(i+=(r-i)/r),t=Math.log(i)/Math.log(r),s?-t:t},e.Axis.prototype.lin2log=function(e){var t=this.userOptions&&this.userOptions.baseValue||10,r=0>e,s=Math.abs(e),i=Math.pow(t,s);return t>i&&(i=t*(i-1)/(t-1)),r?-i:i},e.seriesTypes.wordcloud.prototype.deriveFontSize=function(e){var t=26,r=Math.floor(t*e),s=8>r?8:r;return s};var t=function(e,t){t.field,t.rotation;return{x:0,y:0}};e.seriesTypes.wordcloud.prototype.placementStrategy.random=t}(Highcharts),Highcharts.SparkLine=function(e,t,r){var s="string"==typeof e||e.nodeName,i=arguments[s?1:0],n={chart:{renderTo:i.chart&&i.chart.renderTo||this,backgroundColor:null,borderWidth:0,type:"area",margin:[2,0,2,0],width:120,height:20,style:{overflow:"visible"},skipClone:!0},title:{text:""},credits:{enabled:!1},xAxis:{labels:{enabled:!1},title:{text:null},startOnTick:!1,endOnTick:!1,tickPositions:[]},yAxis:{endOnTick:!1,startOnTick:!1,labels:{enabled:!1},title:{text:null},tickPositions:[0]},legend:{enabled:!1},tooltip:{backgroundColor:null,borderWidth:0,shadow:!1,useHTML:!0,hideDelay:0,shared:!0,padding:0,valueSuffix:"",positioner:function(e,t,r){return{x:r.plotX-e/2,y:r.plotY-t}}},plotOptions:{series:{animation:!1,lineWidth:1,shadow:!1,states:{hover:{lineWidth:1}},marker:{radius:1,states:{hover:{radius:2}}},fillOpacity:.25},column:{negativeColor:"#910000",borderColor:"silver"}}};return i=Highcharts.merge(n,i),s?new Highcharts.Chart(e,i,r):new Highcharts.Chart(i,t)},Highcharts.wrap(Highcharts.seriesTypes.column.prototype,"init",function(e){if(e.apply(this,[].slice.call(arguments,1)),this.chart.options3d&&this.chart.options3d.enabled){var t=this.options,r=t.grouping,s=t.stacking,i=this.yAxis.options.reversedStacks,n=0;if(void 0===r||r){var a,o=this.chart.retrieveStacks(s),l=t.stack||0;for(a=0;a<o[l].series.length&&o[l].series[a]!==this;a++);n=10*o.totalStacks-10*(o.totalStacks-o[l].position)-(i?a:-a)}t.zIndex=n}});var StyleObject={},chartGlance=function(e,t){var r=!1,s=function(){return r},n=function(e){r=e},a=function(e){if(e.yAxis&&e.yAxis.length>=1)for(var t=0;t<e.yAxis.length;t++)e.yAxis[t].min&&(e.yAxis[t].min=parseFloat(e.yAxis[t].min)),e.yAxis[t].max&&(e.yAxis[t].max=parseFloat(e.yAxis[t].max)),e.yAxis[t].tickInterval&&(e.yAxis[t].tickInterval=parseFloat(e.yAxis[t].tickInterval));if(e.xAxis[0]&&e.xAxis.length>=1)for(var t=0;t<e.xAxis.length;t++)e.xAxis[t].labels&&e.xAxis[t].labels.rotation&&(e.xAxis[t].labels.rotation=parseInt(e.xAxis[t].labels.rotation));else e.xAxis&&e.xAxis.labels&&e.xAxis.labels.rotation&&(e.xAxis.labels.rotation=parseInt(e.xAxis.labels.rotation));return e},o=function(e){e.title.style.cursor="pointer",e.xAxis.title?e.xAxis.title.style.cursor="pointer":e.xAxis[0].title.style.cursor="pointer";for(var t=0;t<e.yAxis.length;t++)e.yAxis[t].title.style.cursor="pointer",e.yAxis[t].labels.style?e.yAxis[t].labels.style.cursor="pointer":e.yAxis[t].labels.style={cursor:"pointer"};return e.chart.plotBackgroundColor||(e.chart.plotBackgroundColor="transparent"),e.subtitle&&(e.subtitle.style.cursor="pointer"),e},l=function(e){var t=Object.keys(Chart.container).length>=1?!0:!1;t&&!s()&&(n(!0),$.ui.utils.initComponents($("#OLEBoxFormat")),$.ui.utils.initComponents($("#OLEBoxFormat_fonts")),$.ui.utils.initComponents($("#chartmenucustomcolorDropDown")),$("#chartMenucPallateCode li").unbind("click",function(){chartOnLoad.colorPallateCallback(e,this)}).bind("click",function(){chartOnLoad.colorPallateCallback(e,this)}))},c=function(e,t){e&&t&&Highcharts.setOptions({lang:{decimalPoint:e,thousandsSep:t}})},h=function(e){delete e.title.style.cursor,e.xAxis.title?delete e.xAxis.title.style.cursor:delete e.xAxis[0].title.style.cursor,delete e.subtitle.style.cursor;for(var t=0;t<e.yAxis.length;t++)delete e.yAxis[t].title.style.cursor,e.yAxis[t].labels.style&&delete e.yAxis[t].labels.style.cursor;return e},p=function(e,t,r,s,i){return e.plotOptions.series.minPointLength=2,e.chart.spacingTop=t,e.chart.spacingBottom=r,e.chart.spacingLeft=s,e.chart.spacingRight=Math.max(i,20),e},u=function(e){return parseInt(x(e).substring(0,2),16)},g=function(e){return parseInt(x(e).substring(2,4),16)},d=function(e){return parseInt(x(e).substring(4,6),16)},x=function(e){return"#"==e.charAt(0)?e.substring(1,7):e},y=function(e){var t,r,s,i=1;if("rgba"==e.slice(0,4)){var n=e.split(",");t=parseInt(n[0].substring(5)),r=parseInt(n[1]),s=parseInt(n[2]),i=parseFloat(n[3])}else if("rgb("==e.slice(0,4)){var n=e.split(",");t=parseInt(n[0].substring(4)),r=parseInt(n[1]),s=parseInt(n[2])}else"#"==e.charAt(0)&&(t=u(e),r=g(e),s=d(e));var a=Math.round(255*(1-i)+i*t),o=Math.round(255*(1-i)+i*r),l=Math.round(255*(1-i)+i*s);return"rgb("+a+","+o+","+l+")"},f=function(e){if(null==e||"undefined"==typeof e||-1!==e.indexOf("transparent"))return e;var t,r,s,i;if("#"===e.charAt(0)){var n=e.slice(1);t=parseInt(n.slice(0,2),16),r=parseInt(n.slice(2,4),16),s=parseInt(n.slice(4,6),16)}else if("rgb("===e.slice(0,4)||"rgba"===e.slice(0,4)){var a=e.split("(")[1].split(")")[0].split(",");t=a[0],r=a[1],s=a[2],i=a[3]}if("undefined"!=typeof opacity&&null!=opacity)return"rgba("+t+","+r+","+s+","+opacity+")";var o="";return o="rgb("+t+","+r+","+s+")"},b=function(e){if(e.split(".").length<=1)return!1;if(0===e.indexOf("'")&&e.split("'").length>2){var t=e.split("'");e=t[1]+t[2]}var r=e.split(".")[1].split(":");r.length>1&&r[0]===r[1]&&(e=e.split(":")[0]);var s=new RegExp("^[']*"+WorkSheets.getActiveSheetName().toUpperCase()+"[']*[0-9]*[.][A-Z]+[A-Z]*[1-9]+[0-9]*$");if(s.test(e.toUpperCase()))return!0;if(-1!==WorkSheets._sheetNamesMetaList[0].indexOf(e.split(".")[0].replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))){e=e.split(".")[1];var i=new RegExp("^[A-Z]+[A-Z]*[1-9]+[0-9]*$");if(i.test(e.toUpperCase()))return!0}return!1},m=function(e){var t=new RegExp("^[-]?[0-9]*[.][0-9]*$"),r=new RegExp("^[-]?[0-9]*$");return t.test(e)||r.test(e)?!0:!1},O=function(e,t,r,s,i,n){{var a,o=chartOnLoad.getInstanceByChartId(i);o.co.options}if("COLS"===o.seriesIn)for(var l=t,c=0;s>=l;l++)a="NOFILL"===n?"transparent":colorLimit[c%colorLimit.length],o.fcl&&l==t||(o.frl?updateRangeFormat(e+1,l,r,l,"backgroundColor",a):updateRangeFormat(e,l,r,l,"backgroundColor",a),c++);else for(var l=e,c=0;r>=l;l++)a="NOFILL"===n?"transparent":colorLimit[c%colorLimit.length],o.frl&&l===e||(o.fcl?updateRangeFormat(l,t+1,l,s,"backgroundColor",a):updateRangeFormat(l,t,l,s,"backgroundColor",a),c++)},A=function(e,t,r){e=e.replace(/\$/g,"").replace(/!/g,".").replace(",",";");for(var s=e.split(";"),i=0;i<s.length;i++){var n=s[i].split(".")[1],a=n.split(":"),o=parseInt(a[0].charAt(0),36)-10,l=parseInt(a[0].substring(1))-1,c=parseInt(a[1].charAt(0),36)-10,h=parseInt(a[1].substring(1))-1;O(l,o,h,c,t,r)}},v=function(e){var t=e.colors;if(e&&-1===e.chart.type.indexOf("waterfall")&&e.series&&e.series.length>=1)if(-1!==e.chart.type.indexOf("pie")||-1!==e.chart.type.indexOf("funnel"))for(var r=e.series.length,s=0;r>s;s++)for(var i=e.series[s].data.length,n=0;i>n;n++)e.series[s].data[n].color||(e.series[s].data[n].color=t[n%t.length]);else for(var r=e.series.length,s=0;r>s;s++)e.series[s].color||e.series[s].hasOwnProperty("isRegressionLine")||(e.series[s].color=t[s%t.length]);return e},C=function(e){var t=e.lineStyles;if(t)for(var r=0;r<t.length;r++){var s=t[r],i=s.seriesIndex,n=s.lineStyleType;!e.series[i]||e.series[i].hasOwnProperty("isRegressionLine")||"line"!==e.series[i].type&&"spline"!==e.series[i].type&&"line"!==e.chart.type?e.series[i-e.series.length].hasOwnProperty("regressionSettings")&&(e.series[i-e.series.length].regressionSettings.dashStyle=n):e.series[i].dashStyle=n}return e},S=function(e){var t=e.legend.itemStyle?e.legend.itemStyle.color:null;return t?(e.legend.itemHoverStyle={color:chartGlance.getRGBA(t,"0.7")},e.legend.itemHiddenStyle={color:chartGlance.getRGBA(t,"0.5")}):e.legend.itemStyle={color:"#000000",fontWeight:"normal",fontStyle:"normal"},e},L=function(e){for(var t=e.yAxis.length>=1&&e.yAxis[0].gridLineColor?e.yAxis[0].gridLineColor:null,r=e.yAxis.length>=1&&e.yAxis[0].minorGridLineColor?e.yAxis[0].minorGridLineColor:f(t,"0.5"),s=0;s<e.yAxis.length;s++)e.yAxis[s].minorGridLineColor=r,e.yAxis[s].gridLineColor=t;return e},k=function(e){if(e.title.text&&(e.title.text="undefined"==typeof ZSEC?unescape(e.title.text):ZSEC.Encoder.encodeForHTML(unescape(e.title.text))),e.subtitle.text&&(e.subtitle.text="undefined"==typeof ZSEC?unescape(e.subtitle.text):ZSEC.Encoder.encodeForHTML(unescape(e.subtitle.text))),e.xAxis.title&&e.xAxis.title.text?e.xAxis.title.text="undefined"==typeof ZSEC?unescape(e.xAxis.title.text):ZSEC.Encoder.encodeForHTML(unescape(e.xAxis.title.text)):e.xAxis[0]&&e.xAxis[0].title&&e.xAxis[0].title.text&&(e.xAxis[0].title.text="undefined"==typeof ZSEC?unescape(e.xAxis[0].title.text):ZSEC.Encoder.encodeForHTML(unescape(e.xAxis[0].title.text))),e.yAxis)for(var t=0;t<e.yAxis.length;t++)e.yAxis[t].title.text="undefined"==typeof ZSEC?unescape(e.yAxis[t].title.text):ZSEC.Encoder.encodeForHTML(unescape(e.yAxis[t].title.text));return e},T=function(e){if(e.title.text&&(e.title.text=chartPreview.decodeHTMLContent(e.title.text)),e.subtitle.text&&(e.subtitle.text=chartPreview.decodeHTMLContent(e.subtitle.text)),e.xAxis.title&&e.xAxis.title.text?e.xAxis.title.text=chartPreview.decodeHTMLContent(e.xAxis.title.text):e.xAxis[0]&&e.xAxis[0].title&&e.xAxis[0].title.text&&(e.xAxis[0].title.text=chartPreview.decodeHTMLContent(e.xAxis[0].title.text)),e.yAxis)for(var t=0;t<e.yAxis.length;t++)e.yAxis[t].title.text=chartPreview.decodeHTMLContent(e.yAxis[t].title.text);return e},I=function(e){try{if(e.title.style&&(e.title.style.useHtml="true",e.title.style.marginRight=30,e.title.style.marginLeft=30),e.subtitle.style&&(e.subtitle.style.useHtml="true",e.subtitle.style.marginRight=30,e.subtitle.style.marginLeft=30),e.xAxis.title&&e.xAxis.title.style){e.xAxis.title.style.textOverflow="ellipsis",e.xAxis.title.style.whiteSpace="nowrap",e.xAxis.title.style.overflow="hidden",e.xAxis.labels.groupedOptions=[];for(var t=0;t<=w(e);t++)e.xAxis.labels.groupedOptions.push({rotation:0})}else{e.xAxis[0].title.style.textOverflow="ellipsis",e.xAxis[0].title.style.whiteSpace="nowrap",e.xAxis[0].title.style.overflow="hidden",e.xAxis[0].labels.groupedOptions=[];for(var t=0;t<=w(e);t++)e.xAxis[0].labels.groupedOptions.push({rotation:0})}if(e.yAxis[0].title.style)for(var t=0;t<e.yAxis.length;t++)e.yAxis[t].title.style.textOverflow="ellipsis",e.yAxis[t].title.style.whiteSpace="nowrap",e.yAxis[t].title.style.overflow="hidden"}catch(e){}return e},w=function(e,t){var r,s=0;try{var i=e.series&&e.series[0]&&e.series[0].hasOwnProperty("regressionSettings")?1:0;if(t||e.xAxis&&e.xAxis.categories&&e.xAxis.categories[i]&&"object"==typeof e.xAxis.categories[i])for(r=e.xAxis.categories[i],s=0;"object"==typeof r;s++)r=r.categories[0];else if(t||e.xAxis[0]&&e.xAxis[0].categories[i]&&"object"==typeof e.xAxis[0].categories[i])for(r=e.xAxis[0].categories[i],s=0;"object"==typeof r;s++)r=r.categories[0]}catch(e){}return s},F=function(e){if(!e.chart.customChartType||e.chart.customChartType&&-1===e.chart.customChartType.indexOf("bullet"))return e;try{var t,r,s=Math.max(0,e.series.length-2),i=.2,n=.9,a=e.colors,o=e.colorOptions.colorTheme,l=o.isReversed;l="string"==typeof l?"true"==l?!0:!1:l;var c=e.series.length-s;s>0&&-1==o.name.indexOf("COLORFUL")&&(t=R(a[2],void 0,s,!1,!1,!0),r=a.slice(0,2),l&&(t=t.reverse(),r=r.reverse()),t=t.concat(r),e.colors=t);for(var h=e.plotOptions[e.chart.type].showInLegend,p=0;p<e.series.length;p++)delete e.series[p].maxPointWidth,e.series[p].pointPadding=.2,e.series[p].color=e.colors[p],0>n&&(n=.9),n-=i,s>p?(e.series[p].stacking=!1,e.series[p].grouping=!1,e.series[p].zIndex=--c):p==s?(e.series[p].pointPadding=.4,e.series[p].showInLegend=h,e.series[p].zIndex=p):p>s&&(e.series[p].type="boxplot",e.series[p].pointPadding=.3,e.series[p].zIndex=p,e.plotOptions.boxplot={lineWidth:3,medianWidth:0,stemWidth:0,whiskerWidth:0,showInLegend:h})}catch(e){}return e},R=function(e,t,r,s,n,a){var o=[];if(s){var l=e.length,c=Math.min(Math.ceil(r/l),3);o.push(SheetChartColor(e).getColorCombination(c))}else{var h=a?r:r+2,p=0,u=1/h;for(i=0;r>i;i+=1)o.push(n?SheetChartColor(e).darken(p).getColor():SheetChartColor(e).brighten(p).getColor()),p+=u}return o},H=function(e){var t=e.chart.type;return-1!==t.indexOf("pie")||-1!==t.indexOf("funnel")||-1!==t.indexOf("waterfall")?nt(e.series)[1]:e.chart.customChartType&&-1!==e.chart.customChartType.indexOf("bullet")?3:e.series.length},M=function(e){var t=e.chart.type,r=e.colorOptions.colorTheme;if(e.colorOptions={},e.colorOptions.colorTheme=r,-1!==t.indexOf("pie")||-1!==t.indexOf("funnel")||-1!==t.indexOf("waterfall"))for(var s=0;s<e.series.length;s++)for(var i=0;i<e.series[s].data.length;i++)e.series[s].data[i].color&&delete e.series[s].data[i].color;else for(var s=0;s<e.series.length;s++)e.series[s].color&&delete e.series[s].color;return e},E=function(e,t,r,s,i,n){try{var a;StyleObject&&StyleObject.colorObject&&(a=JSON.stringify(StyleObject.colorObject.colorTheme?StyleObject.colorObject.colorTheme:{}),StyleObject.colorObject={},StyleObject.colorObject.colorTheme=JSON.parse(a));var o=e.colorOptions.colorTheme;if(t=t||o.basecolor,s=s||o.name,i=i||o.isReversed,n||(e.colorOptions.colorTheme.name=s,e.colorOptions.colorTheme.basecolor=t,e.colorOptions.colorTheme.isReversed=i),-1!==s.indexOf("COLORFUL")){var l=H(e),c=R(t,r,l,!0);return e.colors=c[0],e}var l=H(e),h=!e.chart.customChartType||-1===e.chart.customChartType.indexOf("bullet")&&-1===e.chart.customChartType.indexOf("groupedChart")?!1:!0,c=R(t,r,l,!1,!1,h);i="string"==typeof i?"true"==i?!0:!1:i,c=i?c.reverse():c,e.colors=c}catch(e){}return e},P=function(e){if(!e.chart.customChartType||e.chart.customChartType&&-1===e.chart.customChartType.indexOf("groupedChart"))return e;var t,r=(e.series.length?e.series.length:t?5:e.series[0].data.length,2==e.series.length?.3:.1);e.plotOptions[e.chart.type].grouping=!1,e.plotOptions[e.chart.type].groupPadding=0;for(var s=0;s<e.series.length;s++)e.series[s].pointPadding=r,r+=.1;return e},G=function(e){return e},W=function(e){if(-1!==e.chart.type.indexOf("line")){var t=0;for(i=0;i<e.series.length;i++)"pie"!=e.series[i].type?e.series[i].showInLegend=e.plotOptions[e.chart.type].showInLegend:(t++,e.series[i].showInLegend=!1);t==e.series.length&&(e.series[0].showInLegend=!0)}return e},D=function(e){try{e.series.length>=1&&-1!==e.chart.type.indexOf("waterfall")&&(e.series[0].upColor=e.colors[0],e.series[0].color=e.colors[1])}catch(e){}return e},j=function(e){var t=e.series;if(e.yAxis.length>1)for(var r=0;r<t.length;r++)e.yAxis[r]&&e.yAxis[r].labels&&(e.yAxis[r].labels.isAxisDirty||(e.yAxis[r].labels.style.color=t[r].color),e.yAxis[r].title.isAxisDirty||(e.yAxis[r].title.style.color=t[r].color));return e},B=function(e){for(var t=e.series,r=e.yAxis,s=0;s<r.length;s++)if(e.yAxis[s]&&e.yAxis[s].plotLines)for(var i=e.yAxis[s].plotLines,n=0;n<i.length;n++)e.yAxis[s].plotLines[n].isPlColorChanged||(e.yAxis[s].plotLines[n].color=t[s].color?t[s].color:"");return e},N=function(e,r){return"string"!=typeof e?e:{radialGradient:{cx:.5,cy:.3,r:.7},stops:[[0,r?t.Color(e).brighten(-.2).get("rgb"):e],[1,r?e:t.Color(e).brighten(-.2).get("rgb")]]}},U=function(e,r){return"string"!=typeof e?e:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,r?t.Color(e).brighten(-.2).get("rgb"):e],[1,r?e:t.Color(e).brighten(-.2).get("rgb")]]}},V=function(e){if("object"==typeof e){var r=e.stops[0][1],s=e.stops[1][1];return t.Color(r).brighten(-.2).get("rgb")==s?r:s}return e},_=function(e,t,r){return-1!==t.indexOf("radial")?N(e,r):U(e,r)},z=function(e,t){var r=t&&t.enabled&&t.ias,s=t&&t.enabled&&(t.canvas||t.iab);s&&(e.chart.backgroundColor=_(e.chart.backgroundColor||"#FFFFFF",t.gType||t.cgType,t.isReversed||t.cgReversed),e.chart.plotBackgroundColor=null);for(var i=e.series,n=i?i.length:0,a=0;n>a;a++){var o=i[a].data,l=o?o.length:0,c=i[a].color||e.colors[a%e.colors];r&&(i[a].color=_(c,t.gType||t.sgType,t.isReversed||t.sgReversed));for(var h=0;l>h;h++){var p=o[h];p.color&&r&&(p.color=_(p.color,t.gType||t.sgType,t.isReversed||t.sgReversed)),p.borderWidth=1,p.borderColor=chartGlance.getRGBA("HISTOGRAM"===e.chart.type.toUpperCase()||-1!==e.chart.type.toUpperCase().indexOf("DOUGHNUT")?"#FFFFFF":V(p.color||c))}}return e},Y=function(e,t,r){try{var s=e.colorOptions,i=s.colorTheme;if(e=G(e),e=W(e),e=E(e,i.basecolor,void 0,i.name,i.isReversed,!0),e=D(e),e=F(e),e=P(e),e=k(e),e=I(e),e=a(e),e=v(e),e=j(e),e=B(e),e=h(e),e=S(e),e=L(e),e=C(e),e=tt(e),t||(e.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:e.legend.itemStyle.color})}}),e.chart.style||(e.chart.style={fontFamily:"Arial"}),-1!==e.chart.type.indexOf("pie")||-1!==e.chart.type.indexOf("funnel")||-1!==e.chart.type.indexOf("waterfall"))for(var n=e.colorOptions,o=n.seriesColors,l=o?o.length:0,c=0;l>c;c++)for(var p=o[c],u=0;u<e.series.length;u++){var g=isUndefined(p.sIndex)?-1:parseInt(p.sIndex);e.series[u].data[parseInt(g)]&&(e.series[u].data[parseInt(g)].color=p.color)}else for(var n=e.colorOptions,o=n.seriesColors,l=o?o.length:0,c=0;l>c;c++){var p=o[c],g="undefined"!=typeof p.sIndex?parseInt(p.sIndex):-1;e.series[g]?e.series[g].color=p.color:e.series&&e.series.length>=1&&e.series[0].regressionSettings&&e.series[g-parseInt(e.series.length)]&&(e.series[g-parseInt(e.series.length)].regressionSettings.color=n[keys[c]])}if(-1!==e.chart.type.indexOf("pie")||-1!==e.chart.type.indexOf("funnel")||e.chart.polar?e.chart.plotBackgroundColor&&(e.chart.plotBackgroundColor=null):e.chart.plotBackgroundColor||(e.chart.plotBackgroundColor=e.chart.backgroundColor),e.series.length>=1&&!e.series[0].type,e=Z(e),e=z(e,r),!t)for(var d=0;d<e.series.length;d++)chartPreview.setDashStyle(d,e.series[d].dashStyle)}catch(e){}return e},Z=function(e){var t=e.colorOptions,r=t&&t.pointColors?t.pointColors:null;if(!r)return e;for(var s=r.length,i=0;s>i;i++)for(var n=r[i],a=n.points?n.points.length:0,o=0;a>o;o++){var l=n.points[o],c=l.pIndex,h=n.sIndex,p=l.color;e.series[h].data[c].color=p}return e},K=function(e){return e},q=function(e,t,r){try{(t||e.xAxis.categories&&e.xAxis.categories[0]&&"object"==typeof e.xAxis.categories[0])&&-1===e.chart.type.indexOf("bar")&&(e.xAxis.labels.rotation=-90,r||($("#xAxisStaggerLines").hide(),$("#slant").zcombo("setValue","-90")))}catch(e){}return e},X=function(e,t,r,s){try{var i=e.series&&e.series[0]&&e.series[0].hasOwnProperty("regressionSettings")?1:0;t||e.xAxis.categories&&e.xAxis.categories[i]&&"object"==typeof e.xAxis.categories[i]?w(e)>=1&&(e.xAxis.tickmarkPlacement="between",e.xAxis.labels.step=1,e.xAxis.labels.rotation=-1!==e.chart.type.indexOf("bar")?null:-90,delete e.xAxis.labels.staggerLines,r||($("#xAxisStaggerLines").hide(),$("#xAxisSlant").hide()),e.chart.options3d&&e.chart.options3d.enabled&&-1===e.chart.type.indexOf("pie")&&(e.chart.options3d.beta=0,e.chart.options3d.alpha=0)):s||(e.xAxis.tickmarkPlacement?e.xAxis.tickmarkPlacement="on":e.xAxis[0].tickmarkPlacement="on",r||($("#xAxisStaggerLines").show(),$("#xAxisSlant").show()))}catch(e){}return e},J=function(e){try{-1!==e.chart.type.indexOf("pie")&&e.series.length>1&&e.series[0].hasOwnProperty("innerSize")&&e.plotOptions.series.hasOwnProperty("dataLabels")&&(e.plotOptions.series.dataLabels.connectorColor="#000000"),e.xAxis&&e.xAxis.title?e.xAxis.title.hasOwnProperty("offset")&&delete e.xAxis.title.offset:e.xAxis&&e.xAxis.length>=1&&e.xAxis[0].title&&e.xAxis[0].title.hasOwnProperty("offset")&&delete e.xAxis[0].title.offset}catch(e){}return e},Q=function(e){try{(-1!==e.chart.type.indexOf("bubble")||-1!==e.chart.type.indexOf("scatter"))&&e.legend.hasOwnProperty("verticalAlign")&&-1!==e.legend.verticalAlign.indexOf("top")&&(e.legend.y=""!==e.title.text&&""!==e.subtitle.text?50:""!==e.title.text||""!==e.subtitle.text?30:0),e=K(e)}catch(e){}return e},et=function(e){try{-1===e.chart.type.indexOf("pie")&&-1===e.chart.type.indexOf("funnel")||1!=e.series.length||(e.plotOptions.series.point={events:{mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:e.legend.itemStyle.color})}}})}catch(e){}return e},tt=function(e){try{var t,r=e.series.length;if((-1!==e.chart.type.indexOf("scatter")||-1!==e.chart.type.indexOf("column")||-1!==e.chart.type.indexOf("bar")||-1!==e.chart.type.indexOf("line")||-1!==e.chart.type.indexOf("spline")||-1!==e.chart.type.indexOf("area"))&&e.series.length>0)for(t=0;r>t;t++)e.series[t].regressionSettings&&(e.series[t].regressionSettings.showInLegend=e.plotOptions[e.chart.type].showInLegend)}catch(e){}return e},rt=function(e){try{var t,r=e.series.length,s=e.colors;if((-1!==e.chart.type.indexOf("scatter")||-1!==e.chart.type.indexOf("column")||-1!==e.chart.type.indexOf("bar")||-1!==e.chart.type.indexOf("line")||-1!==e.chart.type.indexOf("spline")||-1!==e.chart.type.indexOf("area"))&&e.series.length>0)for(t=0;r>t;t++)e.series[t].hasOwnProperty("regressionSettings")&&(e.series[t].regressionSettings.color=s[t%s.length],e.series[t].regressionSettings.showInLegend=e.plotOptions[e.chart.type].showInLegend)}catch(e){}return e},st=function(e,t,r,s,i){e.series[i].dataLabels={formatter:function(){var e=s?s:"",t=this.point.decimals;return this.y>=0?"%"===e?Highcharts.numberFormat(this.y,t)+e:e+Highcharts.numberFormat(this.y,t):"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:"-"+e+Highcharts.numberFormat(Math.abs(this.y),t)}}},it=function(e,t){e.id==t&&e.setVisible(e.visible?!1:!0)},nt=function(e){var t,r=0,s=[];if(null!=e){for(var i=0;i<e.length;i++)null!=e[i]&&e[i].data&&e[i].data.length>r&&(t=i,r=e[i].data.length);s[0]=t,s[1]=r}return s},at=function(e,t){for(var r,s=e.series.length,i=e.colors,n=0;s>n;n++)if(r=null!=e.series[n]&&e.series[n].data?e.series[n].data.length:0,t>r)for(var a=0;r>a;a++)e.series[n].data[a].color=i[(e.series[n].data[a].id-1)%i.length];return e},ot=function(e,t){if(e.plotOptions.series.minPointLength=2,null==e.series)return e;-1!==e.chart.type.indexOf("funnel")&&(e.chart.marginRight=e.plotOptions.series.dataLabels&&e.plotOptions.series.dataLabels.enabled?100:10);var r=nt(e.series),s=r[0],i=r[1];if(e=at(e,i),e.series.length>0&&-1!==e.chart.type.indexOf("pie")){if(null!=e.series[0]&&e.series[0].hasOwnProperty("innerSize")){var n,a=e.series.length;for(1==e.series.length&&(e.plotOptions.pie.borderWidth=0),n=0;a>n;n++)s!==n&&(e.series[n].showInLegend=!1),3==n?e.series[n].size="40%":2==n&&(e.series[n].innerSize="55%")}2==a&&(e.series[1].size="70%"),-1!==e.chart.type.indexOf("pie")&&null!=e.series[0]&&e.series[0].hasOwnProperty("innerSize")&&!t&&(e.plotOptions.series.point={events:{legendItemClick:function(){var t,r=this.id,i=e.series.length;for(t=0;i>t;t++)if(s!=t)for(var n=this.series.chart.series[t].data,a=0;a<n.length;a++)it(n[a],r)},click:function(e){chartPreview.applyContextualToolbar(e,this,ole.isActive()?ole.getCurrObj().id:null,"series")},mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:e.legend.itemStyle.color})}}})}return 1!=e.series.length||t||(e=et(e)),e},lt=function(e,t,r){var s=e.yAxis[t].scaleFactor||1,i=e.yAxis[t].prefix||"",n=e.yAxis[t].suffix||"";e.yAxis[t].labels={enabled:e.yAxis[t].labels.enabled,style:e.yAxis[t].labels.style,isAxisDirty:e.yAxis[t].labels.isAxisDirty,formatter:function(){var e=this.value;return 0>e?"%"==r?"-  "+i+Highcharts.numberFormat(Math.abs(e)*s,-1)+r+n:"-  "+i+r+Highcharts.numberFormat(Math.abs(e)*s,-1)+n:"%"==r?i+Highcharts.numberFormat(Math.abs(e)*s,-1)+r+n:i+r+Highcharts.numberFormat(Math.abs(e)*s,-1)+n}}},ct=function(e,t){e="string"==typeof e?JSON.parse(e):e;var r=0;for(var s in e)r++;var i=e?e:{},n=r-t;return n>0&&(i=ht(i,n,r)),i},ht=function(e,t,r){for(var s=[],i=t,n=0;r>i;i++,n++)s[n]=e[i];return s},pt=function(e,t,r,s){var i="string"==typeof e?JSON.parse(e):e,n=Object.keys(i).length,a=s||previousChartType,o=["COL","BAR","XYLINE","XYAREA","COMBOCHART","STEPCHART","SPLINE","COL3D","BAR3D"];if(-1!==$.inArray(a,o))return n>t&&i[t]?i[t]:"";for(var l=0;l<Object.keys(e).length;l++)if(e[l])return e[l];return""},ut=function(e,t,r,s,i,n,a,o,l,c,h,p){i=i?i:null,n=n?n:null,p=p?p:null,chartGlance.setLocaleOptions(i,n);var u=xt(e.chart.type),g=ct(r,e.series?e.series.length:0),d=e.chart.type;if(g&&!h){e.aggregation.enabled&&"COUNT"===e.aggregation.type&&(g[0]="");for(var x=0;x<e.yAxis.length;x++){var y=chartGlance.pickCurrency(g,x,c,u);lt(e,x,y)}}"scatter"!==d&&"bubble"!==d||!s||(e.xAxis.labels={formatter:function(){var e=this.value,t=s;return 0>e?"-  "+Highcharts.numberFormat(Math.abs(e),-1)+t:Highcharts.numberFormat(this.value,-1)+t}});var f=0;try{f=e.series.length*e.series[0].data.length}catch(e){f=1}if("N"!==t&&1e3>f)if("V"===t){if(c&&e.series.length>1)for(var x=0;x<e.series.length;x++)st(e,i,n,pt(g,x,c,u),x);e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},cSymbol:g?g:"",precision:p,isSingleYaxis:c,chartType:u,formatter:function(){var e=chartGlance.pickCurrency(this.series.options.dataLabels.cSymbol,this.series.index,this.series.options.dataLabels.isSingleYaxis,this.series.options.dataLabels.chartType),t=this.point.decimals;return this.y>=0?"%"===e?Highcharts.numberFormat(this.y,-1)+e:e+Highcharts.numberFormat(this.y,-1):"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),-1)+e:"-"+e+Highcharts.numberFormat(Math.abs(this.y),t)}}}else"L"===t?e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key}}:"S"===t?e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name}}:"S_V"===t?e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},cSymbol:g?g:"",precision:p,isSingleYaxis:c,chartType:u,formatter:function(){var e=chartGlance.pickCurrency(this.series.options.dataLabels.cSymbol,this.series.index,this.series.options.dataLabels.isSingleYaxis,this.series.options.dataLabels.chartType),t=this.point.decimals;return this.y>=0?"%"===e?this.series.name+" ("+Highcharts.numberFormat(this.y,t)+e+")":this.series.name+" ("+e+Highcharts.numberFormat(this.y,t)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:this.series.name+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),t)+")"}}:"L_V"===t?e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},cSymbol:g?g:"",isSingleYaxis:c,chartType:u,formatter:function(){var e=chartGlance.pickCurrency(this.series.options.dataLabels.cSymbol,this.series.index,this.series.options.dataLabels.isSingleYaxis,this.series.options.dataLabels.chartType),t=this.point.decimals;return this.y>=0?"%"===e?this.key+" ("+Highcharts.numberFormat(this.y,t)+e+")":this.key+" ("+e+Highcharts.numberFormat(this.y,t)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:this.key+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),t)+")"}}:"P"===t?("funnel"===e.chart.type||"pie"===e.chart.type||e.plotOptions.series.stacking&&(-1!==e.plotOptions.series.stacking.indexOf("normal")||-1!==e.plotOptions.series.stacking.indexOf("percent")))&&(e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return Highcharts.numberFormat(this.percentage,2)+"%"}}):"L_P"!==t||"funnel"!==e.chart.type&&"pie"!==e.chart.type&&(!e.plotOptions.series.stacking||-1===e.plotOptions.series.stacking.indexOf("normal")&&-1===e.plotOptions.series.stacking.indexOf("percent"))?"V_P"!==t||"funnel"!==e.chart.type&&"pie"!==e.chart.type&&(!e.plotOptions.series.stacking||-1===e.plotOptions.series.stacking.indexOf("normal")&&-1===e.plotOptions.series.stacking.indexOf("percent"))?"S_P"!==t||"funnel"!==e.chart.type&&"pie"!==e.chart.type&&(!e.plotOptions.series.stacking||-1===e.plotOptions.series.stacking.indexOf("normal")&&-1===e.plotOptions.series.stacking.indexOf("percent"))?"B"===t?"bubble"===e.chart.type&&(e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.point.z}}):e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"}}:e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name?this.series.name+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}}:e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.y?this.y+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}}:e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key?this.key+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};else e.plotOptions.series.dataLabels={enabled:!1};return e},gt=function(e,t,r,s,i){var n=xt(e.chart.type),a=e.isSingleYaxis;return e.tooltip.enabled&&e.series&&e.series.length>=1&&(!e.chart.customChartType||-1===e.chart.customChartType.indexOf("bullet")&&-1===e.chart.customChartType.indexOf("grouped")?-1===e.chart.type.indexOf("scatter")&&-1===e.chart.type.indexOf("column")&&-1===e.chart.type.indexOf("bar")&&-1===e.chart.type.indexOf("line")&&-1===e.chart.type.indexOf("spline")&&-1===e.chart.type.indexOf("area")&&-1===e.chart.type.indexOf("spline")||e.isStockChart?(-1!==e.chart.type.indexOf("pie")||-1!==e.chart.type.indexOf("funnel"))&&(e.tooltip={backgroundColor:"#FFFFFF",shape:"square",enabled:!0,cSymbol:s,precision:i,charttype:n,formatter:function(){{var t=e.tooltip.cSymbol;e.tooltip.precision}currencies=ct(t,e.series?e.series.length:0);var r,s=e.tooltip.charttype,i="";i+=this.point.name,i+="<br />",i+='<span style="color:'+this.point.color+'">●</span>'+this.series.name,r=parseFloat(this.y),r=Highcharts.numberFormat(Math.abs(r),this.point.decimals),i+=": ",this.y<0&&(i+="-");var n="";n=e.aggregation.enabled&&"COUNT"!==e.aggregation.type||!e.aggregation.enabled?chartGlance.pickCurrency(currencies,this.series.index,a,s):"";var o=n&&"%"!==n?n:"",l=n&&"%"===n?n:"";return i+="<b>"+o+"</b>"+r+"<b>"+l+"</b><br />"}}):e.tooltip={backgroundColor:"#FFFFFF",shape:"square",enabled:!0,cSymbol:s,precision:i,charttype:n,formatter:function(){var t=e.tooltip.cSymbol,r=(e.tooltip.precision,e.tooltip.charttype);currencies=ct(t,e.series?e.series.length:0);var s,i="";if(e.series&&e.series[0].hasOwnProperty("regressionSettings")){i+=this.series.name,s=parseFloat(this.y),s=Highcharts.numberFormat(Math.abs(s),this.point.decimals),-1!==e.chart.type.indexOf("scatter")?(i+="<br> x : ",this.x<0&&(i+="-"),i+=Highcharts.numberFormat(Math.abs(parseFloat(this.x)),this.point.decimals),i+="<br> y : "):i+=": ",this.y<0&&(i+="-");var n="";n=e.aggregation.enabled&&"COUNT"!==e.aggregation.type||!e.aggregation.enabled?chartGlance.pickCurrency(currencies,this.series.index,a,r):"",n&&"%"!==n&&(i+="<b>"+n+"</b>"),i+="<b>"+s+"</b><br>"}else{var i="",n="";n=e.aggregation.enabled&&"COUNT"!==e.aggregation.type||!e.aggregation.enabled?chartGlance.pickCurrency(currencies,this.series.index,a,r):"",i+='<span style="color:'+this.series.color+'">●</span> '+this.series.name,suffix=this.series.tooltipOptions.valueSuffix||"%"==n?n:"",s=parseFloat(this.y),s=Highcharts.numberFormat(Math.abs(s),-1),-1!==e.chart.type.indexOf("scatter")?(i+="<br> x : ",this.x<0&&(i+="-"),i+=Highcharts.numberFormat(Math.abs(parseFloat(this.x)),this.point.decimals),i+="<br> y : "):i+=": ",this.y<0&&(i+="-"),n&&"%"!==n&&(i+="<b>"+n+"</b>"),i+="<b>"+s+"</b>",i+=suffix+"<br>"}return i}}:e.tooltip={backgroundColor:"#FFFFFF",shape:"square",enabled:!0,shared:!0,cSymbol:s,precision:i,charttype:n,pointFormatter:function(){{var t=e.tooltip.charttype,r=e.tooltip.cSymbol;e.tooltip.precision}currencies=ct(r,e.series?e.series.length:0);var s="",i="";return i=e.aggregation.enabled&&"COUNT"!==e.aggregation.type||!e.aggregation.enabled?chartGlance.pickCurrency(currencies,this.series.index,a,t):"",s+='<span style="color:'+this.series.color+'">●</span> '+this.series.name,suffix=this.series.tooltipOptions.valueSuffix||"%"==i?i:"",value=parseFloat(this.y),value=Highcharts.numberFormat(Math.abs(value),this.decimals),s+=": ",this.y<0&&(s+="-"),i&&"%"!==i&&(s+="<b>"+i+"</b>"),s+="<b>"+value+"</b>",s+=suffix+"<br>"}}),e},dt=function(e,t){var r=!1,s={};return s.doRefresh=r,s.chartOptions=t,s},xt=function(e){var t;switch(e){case"column":t="COL";break;case"stackedcol":t="STACKEDCOL";break;case"stackedcolpercent":t="STACKEDCOL_PERCENT";break;case"bar":t="BAR";break;case"stackedbar":t="STACKEDBAR";break;case"stackedbarpercent":t="STACKEDBAR_PERCENT";break;case"stackedcolumn":t="STACKEDCOL";break;case"stackedarea":t="XYSTACKEDAREA";break;case"line":t="XYLINE";break;case"scatter":t="SCATTER";break;case"bubble":t="BUBBLE";break;case"pie":t="PIE";break;case"area":t="XYAREA";break;case"spline":t="SPLINE";break;case"doughnut":t="DOUGHNUT";break;case"semidoughnut":t="SEMIDOUGHNUT";break;case"stackedxyarea":t="XYSTACKEDAREA";break;case"stepline":t="STEPCHART";break;default:t=e}return t};return{applyDataLabels:ut,removeUnwantedProperties:dt,applyTooltip:gt,appendDataLables:st,applySharedLegendInPie:ot,applyChartSpacing:p,applyregressionColorIndex:rt,advanceChartSettingsInLegend:Q,applyPointVisibility:it,advanceDataLabelSetting:J,isRange:b,focusDataRange:A,isNumber:m,applyLegendDragging:K,applyGrouping:X,getMaximumSeriesLength:nt,handleChartStyle:Y,getRGBA:f,applyPointerCursor:o,removeCursorPointer:h,settingDefaultColorIndex:v,applyregressionLegendPosition:tt,initCustomizationUi:l,defaultGroupingSlat:q,getGroupingDepth:w,decodeChartEncodedString:k,updateChartTheme:E,resetChartColorCode:M,setLocaleOptions:c,getRGBAToRGB:y,applySeriesColorToAxis:j,filterCurrency:ct,pickCurrency:pt,getColorCodeFromGradient:V,decodeHTMLForAllTitles:T}}(jQuery,Highcharts);
var Chart=function(){var e=arguments[0].isStockChart;return e?Highcharts.StockChart.apply(this,arguments):void Highcharts.Chart.apply(this,arguments)};Chart.clearInstance=function(){this.container={}};var chartMenuData="";ole.createObjectProperties("chart",{selectLayer:"OLESelectLayer",menuData:chartMenuData,minHeight:100,minWidth:100,hasOrdering:!1,contextMenu:"ChartConetextMenu",cloneOnCTRLDrag:!1,resizeCorners:"all"}),Chart.prototype=Highcharts.Chart.prototype,Chart.affect={},Chart.container={},Chart.state={},Chart.selection={},Chart.axisOptions={},Chart.dashStyle={},Chart.axisOptionsObj={},Chart.depthHeaders={},Chart.depthHeaderVals={},Chart.depthOperations={},Chart.depthIndices={};var chartOnLoad=function(){function e(e){var t=-1!==e.indexOf("preview"),r=-1!==e.indexOf("explore"),a=!(t||r);return a}var t,r,a=function(e,t,r,a){Chart.selection[e]||(Chart.selection[e]={}),Chart.selection[e][t]||(Chart.selection[e][t]={}),o(e,t),Chart.selection[e][t].ClickCount=r,Chart.selection[e][t].SelectionType=a},o=function(e,t){if(Chart.selection[e])for(var r in Chart.selection[e])r!=t&&(Chart.selection[e][r].ClickCount=0)},n=function(){Chart.selection={}},c=function(e){return Chart.selection?Chart.selection[e]:null},s=function(e,t,r){Chart.state[e]||(Chart.state[e]={}),Chart.state[e].chartId||(Chart.state[e][t]=[]),Chart.state[e][t].push(r)},h=function(e,t){return Chart.state[e]&&Chart.state[e][t]?Chart.state[e][t][0]:!1},l=function(e,t,r){Chart.axisOptions[t]||(Chart.axisOptions[t]={}),Chart.axisOptions[t].chartId||(Chart.axisOptions[t][e]=[]),Chart.axisOptions[t][e].push(r)},p=function(e,t,r){Chart.depthIndices[t]||(Chart.depthIndices[t]={}),Chart.depthIndices[t][e]||(Chart.depthIndices[t][e]=[]),Chart.depthIndices[t][e].push(r)},d=function(e,t){Chart.depthIndices[t]||(Chart.depthIndices[t]={}),Chart.depthIndices[t][e]=[]},v=function(e,t){return Chart.depthIndices[t]&&Chart.depthIndices[t][e]?Chart.depthIndices[t][e]:[]},u=function(e,t,r){Chart.axisOptionsObj[t]||(Chart.axisOptionsObj[t]={}),Chart.axisOptionsObj[t].chartId||(Chart.axisOptionsObj[t][e]=[]),Chart.axisOptionsObj[t][e].push(r)},C=function(e,t,r,a){Chart.dashStyle[t]||(Chart.dashStyle[t]={}),Chart.dashStyle[t][e]||(Chart.dashStyle[t][e]={});var o=Chart.dashStyle[t][e];o||(o={}),o[r]=a,Chart.dashStyle[t][e]=o},g=function(e,t,r,a){Chart.depthHeaders[t]||(Chart.depthHeaders[t]={}),Chart.depthHeaderVals[t]||(Chart.depthHeaderVals[t]={}),Chart.depthHeaders[t].chartId||(Chart.depthHeaders[t][e]=[]),Chart.depthHeaderVals[t].chartId||(Chart.depthHeaderVals[t][e]=[]),null!==r&&(Chart.depthHeaders[t][e]=r,Chart.depthHeaderVals[t][e]=a)},f=function(e,t,r){Chart.depthOperations[t]||(Chart.depthOperations[t]={}),Chart.depthOperations[t].chartId||(Chart.depthOperations[t][e]=[]),Chart.depthOperations[t][e]=r},y=function(e,t){return Chart.depthHeaderVals[t]&&Chart.depthHeaderVals[t][e]?Chart.depthHeaderVals[t][e]:[]},m=function(e,t){return Chart.depthOperations[t]&&Chart.depthOperations[t][e]?Chart.depthOperations[t][e]:[]},x=function(e,t){return Chart.depthHeaders[t]&&Chart.depthHeaders[t][e]?Chart.depthHeaders[t][e]:null},O=function(e,t){return Chart.axisOptions[t]&&Chart.axisOptions[t][e]?Chart.axisOptions[t][e][0]:0},b=function(e,t){return Chart.axisOptionsObj[t]&&Chart.axisOptionsObj[t][e]?Chart.axisOptionsObj[t][e][0]:null},P=function(e,t){if(Chart.dashStyle[t]&&Chart.dashStyle[t][e]){var r=Chart.dashStyle[t][e];return r}return{}},S=function(e,t){for(Chart.affect[e]||(Chart.affect[e]={}),Chart.affect[e].chartId||(Chart.affect[e].chartId=[]),i=0;i<Chart.affect[e].chartId.length;i++)if(Chart.affect[e].chartId[i]==t)return;Chart.affect[e].chartId.push(t)},T=function(e){return Chart.affect[e]},I=function(e,t,r){var a=r.co.chart.renderTo;-1!==r.co.chart.renderTo.indexOf("preview")&&-1!==r.type.indexOf("TIME")&&(r.co.rangeSelector={},r.co.rangeSelector.selected=1,r.co.rangeSelector.inputPosition={x:-1e3}),r.co.chart.resetZoomButton={},r.co.chart.resetZoomButton.theme={},r.co.chart.resetZoomButton.theme.states={},r.co.chart.resetZoomButton.theme.states.hover={fill:"#f0f0f0",stroke:"#DDDDDD"};var o;try{o=new Chart(r.co)}catch(e){}-1===r.type.indexOf("COMBOCHART")&&-1===r.type.indexOf("LINE")&&-1===r.type.indexOf("SCATTER")&&-1===r.type.indexOf("BUBBLE")||r.co.yAxis[0].min||w(o),r.co=o,-1===a.indexOf("preview")&&(Ct(t),gt(t),tt(t)),k(e,t,r)},w=function(e){try{if(e){var t=e.yAxis[0].getExtremes();t&&t.min<0&&t.dataMin>=0&&!e.options.yAxis[0].min?e.yAxis[0].setExtremes(.02,void 0,!0):!e.options.yAxis[0].min&&t.min>t.dataMin&&e.yAxis[0].setExtremes(void 0,void 0,!0)}}catch(e){}},A=function(e){delete Chart.container[e]},L=function(e){delete Chart.affect[e]},R=function(e,t){Chart.container[e]&&(delete Chart.container[e][t],ole.remove(t,!1))},G=function(e,t){Chart.affect[e]||(Chart.affect[e]={}),Chart.affect[e].isChartReaded=t},M=function(e){delete Chart.affect[e].chartId},E=function(e,t,r){Chart.container[e][t]&&(Chart.container[e][t].co=r)},k=function(e,t,r){_(t),Chart.container[e]||(Chart.container[e]={}),Chart.container[e][t]=r},F=function(e,t,r,a){return a?e=B(t,r):(Object.keys(t).forEach(function(r){e[r]=t[r]}),Object.keys(r).forEach(function(t){e[t]=r[t]})),e},B=function(e,t){return t&&Object.keys(t).forEach(function(r){e[r]="object"==typeof t[r]&&e[r]?this.mergeRecursively(e[r],t[r]):t[r]}.bind(this)),e},_=function(e){for(var t in Chart.container)Chart.container[t]&&Chart.container[t][e]&&delete Chart.container[t][e]},z=function(e){return Chart.container[e]},H=function(t){var r=z(t);if(r)for(var a in r)if(e(a)){sheetObjectsPane.appendChild(Chart.container[t][a].co.renderTo);var o=Chart.container[t][a].co.renderTo.id;chartOnLoad.getInstanceByChartId(o).co.reflow(),ole.init(o),ole(o).sRow=j(o).sr,ole(o).sCol=j(o).sc,ole(o).sRowDiff=j(o).srd,ole(o).sColDiff=j(o).scd}},D=function(e){return Chart.container[WorkSheets.getAssociatedActiveSheetName()]?Chart.container[WorkSheets.getAssociatedActiveSheetName()][e]:null},j=function(e){if(Chart.container&&0!=Chart.container.length)for(var t in Chart.container)for(var r in Chart.container[t])if(Chart.container[t][r]&&r==e)return Chart.container[t][r];return null},U=function(e,t){$($($("#"+e).find(".highcharts-yaxis")[t-1]).find("text")[0]).on("click",function(r){chartPreview.applyContextualToolbar(r,this,e,"yAxisTitle."+t),r.stopPropagation()}).on("mouseover",function(){chartPreview.applyRectSvg(e,"yAxisTitle."+t,"hoverRect")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}),$($("#"+e).find(".highcharts-yaxis-labels")[t-1]).on("mouseover",function(){chartPreview.applyRectSvg(e,"yAxisLabel."+t,"hoverRect"),$(this).css("cursor","pointer")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}).on("click",function(r){chartPreview.applyContextualToolbar(r,this,e,"yAxisLabel."+t),r.stopPropagation()})},N=function(e,t,r){return e.yAxis[t-1].plotLines[r-1].events={mouseover:function(){$(this).css("cursor","pointer"),chartPreview.applyRectSvg(e.chart.renderTo,"plotLine."+t+"_"+r,"hoverRect")},mouseout:function(){chartPreview.removeRectSvg(e.chart.renderTo,"hoverRect")},click:function(){chartPreview.applyContextualToolbar(event,this,e.chart.renderTo,"plotLine."+t+"_"+r),event.stopPropagation()}},e},W=function(e,t){return e.xAxis[0]?e.xAxis[0].plotLines[t-1].events={mouseover:function(){$(this).css("cursor","pointer"),chartPreview.applyRectSvg(e.chart.renderTo,"xplotLine.0_"+t,"hoverRect")},mouseout:function(){chartPreview.removeRectSvg(e.chart.renderTo,"hoverRect")},click:function(){chartPreview.applyContextualToolbar(event,this,e.chart.renderTo,"xplotLine.0_"+t),event.stopPropagation()}}:e.xAxis.plotLines[t-1].events={mouseover:function(){$(this).css("cursor","pointer"),chartPreview.applyRectSvg(e.chart.renderTo,"xplotLine.0_"+t,"hoverRect")},mouseout:function(){chartPreview.removeRectSvg(e.chart.renderTo,"hoverRect")},click:function(){chartPreview.applyContextualToolbar(event,this,e.chart.renderTo,"xplotLine.0_"+t),event.stopPropagation()}},e},Y=function(e){try{{var t=j(e).co.yAxis.length;j(e).co.options.xAxis[0].plotLines?j(e).co.options.xAxis[0].plotLines.length:0}}catch(e){}$("#"+e).find(".highcharts-subtitle").on("click",function(t){chartPreview.applyContextualToolbar(t,this,e,"subTitle"),t.stopPropagation()}),$("#"+e).find(".highcharts-background").data("events")||$("#"+e).find(".highcharts-background").on("click",function(t){ut(t,e),t.stopPropagation()}),$("#"+e).find(".highcharts-subtitle").on("mouseover",function(){chartPreview.applyRectSvg(e,"subTitle","hoverRect")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}),$("#"+e).find(".highcharts-title").on("click",function(t){chartPreview.applyContextualToolbar(t,this,e,"chartTitle"),t.stopPropagation()}),$("#"+e).find(".highcharts-title").on("mouseover",function(){chartPreview.applyRectSvg(e,"chartTitle","hoverRect")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}),$($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).on("mouseover",function(){chartPreview.applyRectSvg(e,"xAxisTitle","hoverRect")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}),$($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).on("click",function(t){chartPreview.applyContextualToolbar(t,this,e,"xAxisTitle"),t.stopPropagation()});for(var r=1;t>=r;r++)U(e,r);$($("#"+e).find(".highcharts-xaxis-labels")[0]).find("text").on("click",function(t){chartPreview.applyContextualToolbar(t,this,e,"xAxisLabel"),t.stopPropagation()}),$($("#"+e).find(".highcharts-xaxis-labels")[0]).find("text").on("mouseover",function(){chartPreview.applyRectSvg(e,"xAxisLabel","hoverRect"),$(this).css("cursor","pointer")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}),$("#"+e).find(".highcharts-legend").on("mouseover",function(){chartPreview.applyRectSvg(e,"chartLegend","hoverRect"),$(this).css("cursor","pointer")}).on("mouseout",function(){chartPreview.removeRectSvg(e,"hoverRect")}),$("#"+e).find(".highcharts-legend").on("click",function(t){chartPreview.applyContextualToolbar(t,this,e,"chartLegend"),t.stopPropagation()})},V=function(e){return chartPreview.getChartMode(e.chart.renderTo)||(-1!==e.chart.type.indexOf("pie")||-1!==e.chart.type.indexOf("funnel")||e.chart.polar||e.chart.events&&delete e.chart.events.click,-1===e.chart.type.indexOf("pie")&&-1===e.chart.type.indexOf("waterfall")&&-1===e.chart.type.indexOf("funnel")?(e.plotOptions.series.cursor="auto",e.plotOptions.series.events={mouseOver:function(){this.update({shadow:{color:this.color,width:5,offsetX:0,offsetY:0},shadow:!0}),this.legendItem&&this.legendItem.css({color:"red"})},mouseOut:function(){this.update({shadow:!1}),this.legendItem&&this.legendItem.css({color:"black"})}},e.plotOptions.series.point&&e.plotOptions.series.point.events&&delete e.plotOptions.series.point.events.click):-1!==e.chart.type.indexOf("pie")&&e.series.length>1?(e.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:"red"})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:"black"})}},e.plotOptions.series.point&&e.plotOptions.series.point.events&&delete e.plotOptions.series.point.events.legendItemClick):-1===e.chart.type.indexOf("pie")&&-1===e.chart.type.indexOf("waterfall")&&-1===e.chart.type.indexOf("funnel")||1!==e.series.length||(e.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:"red"})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:"black"})}},e.plotOptions.series.point&&e.plotOptions.series.point.events&&(delete e.plotOptions.series.point.events.click,delete e.plotOptions.series.point.events.legendItemClick)),delete e.title.events,e.xAxis.title?delete e.xAxis.title.events:delete e.xAxis[0].title.events),e},q=function(e,t){if(!t)return t;var r=e.plotOptions.series.events||e.plotOptions.series.point.events;return!("object"==typeof r&t)},Z=function(e){var t=e.co?e.co:e,r=chartPreview.getChartMode(t.chart.renderTo);return q(t,r)&&(t=chartGlance.applyPointerCursor(t),t=X(t),e.co?e.co=t:e=t),e},J=function(e){if(e){var t=chartOnLoad.getInstanceByChartId(e)&&chartOnLoad.getInstanceByChartId(e).co?chartOnLoad.getInstanceByChartId(e).co.options:null;if(t){var r=chartPreview.getChartMode(e);q(t,r)&&r&&Y(e)}}},X=function(e){var t=e.yAxis.length,r=e.xAxis[0]?e.xAxis[0]:e.xAxis,a=r.plotLines?r.plotLines.length:0;-1!==e.chart.type.indexOf("pie")||-1!==e.chart.type.indexOf("funnel")||e.chart.polar||(e.chart.events={click:function(t){chartPreview.applyContextualToolbar(t,this,e.chart.renderTo,"chartArea")}}),-1!==e.chart.type.indexOf("area")||-1!==e.chart.type.indexOf("line")?(e.plotOptions.series.cursor="pointer",e.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:e.legend.itemStyle.color})},legendItemClick:function(){return!1}}):-1===e.chart.type.indexOf("pie")&&-1===e.chart.type.indexOf("waterfall")&&-1===e.chart.type.indexOf("funnel")?(e.plotOptions.series.cursor="pointer",e.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:e.legend.itemStyle.color})},legendItemClick:function(){return!1}}):-1!==e.chart.type.indexOf("pie")&&e.series.length>1?(e.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})}},e.plotOptions.series.point={events:{mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:e.legend.itemStyle.color})},legendItemClick:function(){return!1}}}):-1===e.chart.type.indexOf("pie")&&-1===e.chart.type.indexOf("waterfall")&&-1===e.chart.type.indexOf("funnel")||1!==e.series.length||(e.plotOptions.series.cursor="pointer",e.plotOptions.series.events=-1!==e.chart.type.indexOf("waterfall")?{mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})},legendItemClick:function(){return!1}}:{mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(e.legend.itemStyle.color,"0.7")})}},e.plotOptions.series.point={events:{click:function(t){chartPreview.applyContextualToolbar(t,this,e.chart.renderTo,"series")},legendItemClick:function(){return!1}}}),e.plotOptions.series.point||(e.plotOptions.series.point={events:{}}),e.plotOptions.series.point.events.click=function(t){var r=this.series,a=this,o=a?a.index:void 0,i=r?r.index:void 0;chartPreview.applyContextualToolbar(t,this,e.chart.renderTo,"series",o,i)};for(var o=1;a>=o;o++)e=W(e,o);for(var o=1;t>=o;o++){var i=e.yAxis[o-1].plotLines;if(i&&null!=i&&i.length>0)for(var n=1;n<=i.length;n++)e=N(e,o,n)}return Y(e.chart.renderTo),e},Q=function(e){var t,r,a=e.chartdetails,o={},i=[],n=WorkSheets.getAssociatedActiveSheetName();if(a){for(var c,s=0;s<a.length;s++)c=a[s],t=c.asn,r=c.id,t==n&&i.push(r);o.itr=!0,o.chartIdList=i,o.osc={},xt(o,!0),K(n)}},K=function(e){if(Chart.container&&0!=Chart.container.length)for(var t in Chart.container)for(var r in Chart.container[t])Chart.container[t][r]&&t!=e&&(S(t,r),R(t,r))},et=function(e,t){var r,a,o=e.co,i=e.sr,n=e.sc,c=e.srd,s=e.scd;0>=i&&0>=n?(r=parseInt(e.left),a=parseInt(e.top),i=findRowInYPos(a),n=findColInXPos(r),c=a-getRowTop(i),s=r-getColLeft(n)):(r=parseInt(getColLeft(n))+parseInt(s),a=parseInt(getRowTop(i))+parseInt(c),e.left=r,e.top=a);var h=e.wd,l=e.ht;e.srd=c,e.scd=s;var p=e.isPivotChart,d=o.chart.renderTo,v=e.legendPos,u=1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(o.chart.backgroundColor)),C=(chartGlance.removeUnwantedProperties(d,o,h,l,v),e.asn),g=r,f=a;if(!document.getElementById(d)){var y=document.createElement("div");y.id=d,y.objType="chart",y.isPivotChart=e.isPivotChart;var m=isRTL?"px;right:":"px;left:";y.style.cssText=t?"position:absolute;top:"+f+m+g+"px;height:"+l+"px;width:"+h+"px;z-index:11;cursor:default;border: 1px solid "+chartGlance.getRGBA("rgb(222,222,222)",u)+";overflow: hidden;-moz-box-sizing :content-box;":"position:absolute;top:"+f+m+g+"px;height:"+l+"px;width:"+h+"px;z-index:11;cursor:default;border: 1px solid #FFFFFF;overflow: hidden;-moz-box-sizing :content-box;",y.style.direction="ltr",sheetObjectsPane.appendChild(y)}ole.setObjectProperties("chart",{permissions:{isDraggable:!0,isResizable:!0,isEditable:!0}}),ole.init(d,e.top,e.left,e.ht,e.wd),o.plotOptions.series||(o.plotOptions.series={}),ole(d).sRow=i,ole(d).sCol=n,ole(d).sRowDiff=c,ole(d).sColDiff=s,tt(d),gt(d),appEvent.trigger("chart.oleaction",[]),o=chartGlance.applySharedLegendInPie(o),o=chartGlance.applyregressionColorIndex(o),o=chartGlance.advanceDataLabelSetting(o),o=chartGlance.applyTooltip(o,e.frl,e.fcl,e.currency),o=chartGlance.applyGrouping(o,e.grouping),o=chartGlance.advanceChartSettingsInLegend(o),o=-1!==o.chart.type.indexOf("pie")||-1!==o.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(o,10,15,10,10):chartGlance.applyChartSpacing(o,30,30,30,30),-1!==o.chart.type.indexOf("funnel")&&(o.plotOptions.tooltipYes={useHTML:!0}),o=chartGlance.handleChartStyle(o,!1,e.gradient),PivotChartUtility.findTotalNoOfFilterRequired(d,e.pivotId,!0,e.isPivotChart),o=PivotChartUtility.setLegendBoundary(o,p,v,l),o.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(o.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:o.legend.itemStyle.color})}},t||(o=chartGlance.applyPointerCursor(o),o=X(o),o.chart.zoomType&&(chartPreview.setRemovedZoomType(o.chart.zoomType),o.chart.zoomType="none"),o.tooltip&&(chartPreview.setRemovedTooltipValue(o.tooltip.enabled),o.tooltip.enabled=!1),-1!==o.chart.type.indexOf("pie")&&(o.plotOptions[o.chart.type].allowPointSelect=!1)),ct(d),I(C,d,e),t||(Y(d),PivotChartUtility.genratePivotChartFilterJson(d,chartOnLoad.getInstanceByChartId(d).pivotId))},tt=function(e){!jsVERSION_VIEW&&READ_WRITE&&$("#"+e).bind("contextmenu",function(t){if(jsVERSION_VIEW)return void stopEvent(t);getObj(e).style.border="1px solid #FFFFFF",$("#"+chartPreview.getOleLayer()).css("background-color","#FFF"),ole(e)._setSelectLayer().positionActionBar(),chartPreview.hideContextualToolbar();var r=getCursorPos(t),a=r.x,o=r.y;sheetMenu.resetMenuOptions();var i=chart.createChartContextMenu(),n={target:$(this),position:[a,o],clearcache:!0};$("#chartMoveToSubMenu").remove(),sheetMenu.showMenu("chartRMenu",i,n),ole.contextMenuStatus=!0,$("#pivottw").is(":visible")&&$("#pivottw").hide();var c=chartOnLoad.getInstanceByChartId(e),s=c.isPivotChart;if(!s){if($("#chartMenu").show(),$("#menutabs").ztab("getSelectedTab")[0]){var l=$("#menutabs").ztab("getSelectedTab")[0].id;"chartMenu"!==l&&"pivottw"!==l&&(selectedmenutab=$("#menutabs").ztab("getSelectedTab")[0].id)}initializeToolbar("#chartTab"),ZComponentTabs.setSelectedTab("chartMenu")}var p=at();$.ui.zmenu.createMenu("chartMoveToSubMenu",p,n),$("#chartMoveToSubMenu").unbind("menuitemclicked").bind("menuitemclicked",function(e,t){contextMenu._bindrclickevent(e,t)}),chartOnLoad.chartFormatePainter(),browser_ie&&(t=window.event),chartPreview.setChartMode(h(WorkSheets.getAssociatedActiveSheetName(),e),e),stopEvent(t),previousChartType=j(e).type})},rt=function(){$("#chtpastestyle").disable(),chartPreview.isCopiedStyle()&&$("#chtpastestyle").enable()},at=function(){var e=[];$("#chtmove").enable();var t=WorkSheets._sheetNamesMetaList[0],r=WorkSheets._sheetNamesMetaList[1];if(1==t.length)return $("#chtmove").disable(),e;for(var a=0;a<t.length;a++)if(r[a]!==WorkSheets.getAssociatedActiveSheetName()){var o="chartMoveList"+parseInt(r[a]);e.push({id:o,data:"{label:'"+t[a]+"', appData:{dynamic:true, callback: 'chart.MoveToNewSheet', arg:'"+o+", true'}}"})}return e},ot=function(e){{var t=ole.getCurrObj().type;ole.getCurrObj().id}"chart"===t&&-1!==e.type.indexOf("dblclick")&&event.stopPropagation()},it=function(e){var t,r=ole.getCurrObj().type;"chart"===r?t=chart.createChartContextMenu():"img"===r?t=createImageContextMenu():"button"===r&&(t=createButtonContextMenu());var a={target:$(ole.currObj.getSelectLayer()).children(".oleMenuList"),position:e,clearcache:!0};$("#chartMoveToSubMenu").remove(),sheetMenu.showMenu("chartRMenu",t,a),"chart"===r&&chartOnLoad.chartFormatePainter();var o=null;"chart"===r&&(o=chartOnLoad.createSubMenu()),"chart"===r&&$.ui.zmenu.createMenu("chartMoveToSubMenu",o,a),"chart"===r&&$("#chartMoveToSubMenu").unbind("menuitemclicked").bind("menuitemclicked",function(e,t){contextMenu._bindrclickevent(e,t)})},nt=function(e){if(null!==e){if(chartPreview.setChartMode(!0),chartPreview.setCurrentChartId(e),void 0!==st()&&st()!==e)try{$("#"+st()).css("border","1px solid "+chartGlance.getRGBA("rgb(222,222,222)",1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(chartOnLoad.getInstanceByChartId(st()).co.options.chart.backgroundColor)))),chartPreview.removeRectSvg(st()),chartPreview.hideContextualToolbar()}catch(e){}ct(e);var t=chartPreview.getHCInstance(e),r=t.options;(-1!==r.chart.type.indexOf("pie")||-1!==chartPreview.getAllChartTypesInComboChart(r,r.type).indexOf("pie"))&&(r.plotOptions.pie.allowPointSelect=!1),r=-1!==r.chart.type.indexOf("pie")||-1!==r.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(r,10,15,10,10):chartGlance.applyChartSpacing(r,30,30,30,30),r&&(chartPreview.setRemovedTooltipValue(r.tooltip.enabled),r.tooltip.enabled=!1,chartPreview.setRemovedZoomType(r.chart.zoomType),r.chart.zoomType?r.chart.zoomType="none":null,r=chartGlance.applyPointerCursor(r),r=X(r),r=chartGlance.advanceDataLabelSetting(r,!1),PivotChartUtility.findTotalNoOfFilterRequired(e,chartOnLoad.getInstanceByChartId(e).pivotId),r=PivotChartUtility.setLegendBoundary(r,chartOnLoad.getInstanceByChartId(e).isPivotChart,chartOnLoad.getInstanceByChartId(e).legendPos,chartOnLoad.getInstanceByChartId(e).ht),r.plotOptions.series.animation=!1,t.refreshChart(r,!0),Ct(r.chart.renderTo),Y(r.chart.renderTo),appEvent.trigger("chart.dblclick",[r.chart.renderTo]))}},ct=function(e){t=e},st=function(){return t},ht=function(){return r?r:"canvas"},lt=function(e){r=e},pt=function(e){$("#"+chartPreview.getOleLayer()).on("mousedown",function(){ole&&ole.isActive()&&ole.getCurrObj()&&ole.getCurrObj().id==e&&$("#"+e).css("border","1px solid lightgray")}).on("mouseup",function(){ole&&ole.isActive()&&ole.getCurrObj()&&ole.getCurrObj().id==e&&$("#"+e).css("border","1px solid #FFF")}),$("#"+e+" .highcharts-container").on("mousedown",function(t){if(ole&&ole.isActive()&&ht()&&ht()&&-1!==ht().indexOf("canvas")){if(!chartPreview.getChartMode(e)&&j(e)&&j(e).co&&-1===j(e).co.options.chart.type.indexOf("pie")&&(-1===j(e).co.options.chart.type.indexOf("bar")||-1===j(e).co.options.chart.type.indexOf("column"))&&j(e).co.options.chart.options3d&&j(e).co.options.chart.options3d.enabled)return;this.objType="chart",$(this).css("cursor","move"),$("#"+e).css("border","1px solid lightgray"),ole.startDrag(t),t.stopPropagation()}else lt("canvas")}).on("mouseup",function(){$(this).css("cursor","auto"),ole&&ole.isActive()&&ole.getCurrObj()&&ole.getCurrObj().id==e&&$("#"+e).css("border","1px solid #FFF")}),$($("#"+e+" .highcharts-background").next()).on("mousedown",function(){chartPreview.getChartMode(e)||-1===j(e).co.options.chart.type.indexOf("pie")&&-1===j(e).co.options.chart.type.indexOf("funnel")&&lt("plotArea")}),$("#"+e+" .highcharts-series").on("mousedown",function(e){lt("series"),e.stopPropagation()}),$("#"+e+" .highcharts-navigator").on("mousedown",function(){chartPreview.getChartMode(e)||lt("highcharts-navigator")}),$("#"+e+" .highcharts-navigator-handle-right").on("mousedown",function(){chartPreview.getChartMode(e)||lt("highcharts-navigator")}),$("#"+e+" .highcharts-navigator-handle-left").on("mousedown",function(){chartPreview.getChartMode(e)||lt("highcharts-navigator")})},dt=function(e){if(ole.isActive()){var t=ole.getCurrObj().id;-1===e.indexOf("edit")||chartPreview.getChartMode(t)?-1!==e.indexOf("view")&&chartPreview.getChartMode(t)&&(chartPreview.setChartMode(!1,t),chartPreview.hideContextualToolbar(t),chartPreview.setRemoveSpecificChartFeature(t)):(chartPreview.setChartMode(!0),nt(t),chartPreview.resetPreviousEventWith("canvas")),PivotChartUtility.genratePivotChartFilterJson(t,chartOnLoad.getInstanceByChartId(t).pivotId)}},vt=function(e,t){var r=ole.getCurrObj()?ole.getCurrObj().id:e;chartPreview.changeChartTheme(r,t,void 0,!0)},ut=function(e,t){var r=t;if(Filter.hideFilterOptions(),!jsVERSION_VIEW&&READ_WRITE){chartGlance.initCustomizationUi(r),$(".cMenuPaletteHolder").hide(),$("#"+chartPreview.getOleLayer()).css("background-color","#FFF"),getObj(r).style.border="1px solid #FFFFFF",$("#pivottw").is(":visible")&&$("#pivottw").hide();var a=chartOnLoad.getInstanceByChartId(t),o=a.isPivotChart;if(o)$("#chartMenu").is(":visible")&&$("#chartMenu").hide(),$("#pivotChartMenu").show(),initializeToolbar("#pivotChartTab"),ZComponentTabs.setSelectedTab("pivotChartMenu");else{if($("#pivotChartMenu").is(":visible")&&$("#pivotChartMenu").hide(),$("#chartMenu").show(),$("#menutabs").ztab("getSelectedTab")[0]){var i=$("#menutabs").ztab("getSelectedTab")[0].id;"chartMenu"!==i&&"pivottw"!==i&&(selectedmenutab=$("#menutabs").ztab("getSelectedTab")[0].id)}initializeToolbar("#chartTab"),ZComponentTabs.setSelectedTab("chartMenu")}ole(r)._setSelectLayer().positionActionBar(),ole.isActive()&&($.ZContextMenu.hideMenu(),$.ZContextMenu.colorpalette.hide(),sheetMenu.currMenu&&sheetMenu.currMenu.zmenu("hide"))}if(previousChartType=j(t).type,$("#chartRMenu").hide(),void 0!==st()&&st()!==r&&(chartOnLoad.getInstanceByChartId(st())&&chartOnLoad.getInstanceByChartId(st()).co&&$("#"+st()).css("border","1px solid "+chartGlance.getRGBA("rgb(222,222,222)",1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(chartOnLoad.getInstanceByChartId(st()).co.options.chart.backgroundColor)))),chartPreview.removeRectSvg(st()),chartPreview.hideContextualToolbar()),chartPreview.setChartMode(h(WorkSheets.getAssociatedActiveSheetName(),t),t),chartPreview.getChartMode(t)){var n=chartPreview.getPreviousEventType();-1!==n.indexOf("canvas")?(chartPreview.applyContextualToolbar(e,null,t,"canvas"),$($("#"+ole.getCurrObj().id).find(".highcharts-xaxis-labels")[0]).find("text").data("events")&&!$($("#"+ole.getCurrObj().id).find(".highcharts-xaxis-labels")[0]).find("text").data("events").mouseover&&$($("#"+ole.getCurrObj().id).find(".highcharts-xaxis-labels")[0]).find("text").on("mouseover",function(){chartPreview.applyRectSvg(ole.getCurrObj().id,"xAxisLabel","hoverRect"),$(this).css("cursor","pointer")}).on("mouseout",function(){chartPreview.removeRectSvg(ole.getCurrObj().id,"hoverRect")})):(chartPreview.resetPreviousEventWith("canvas"),chartPreview.getChartMode(t)&&-1===n.indexOf("canvas")&&-1===n.indexOf("stopPropagation")&&(chartPreview.resetPreviousEventWith(chartPreview.getPreviousEventType()),chartPreview.applyRectSvg(t,chartPreview.getChartCustomizationEventType()))),ct(r)}e.stopPropagation()},Ct=function(e){"preview"!==e&&(pt(e),$("#"+e+" .highcharts-container").on("click",function(t){RangeHighlighter.clearAllColorSelection(),ProtectedRanges.isSheetLocked(WorkSheets.getActiveSheetName())||ut(t,e)}))},gt=function(e){"preview"!==e&&$(".highcharts-container").on("dblclick",function(e){var t=this.parentNode.id;if(!jsVERSION_VIEW&&READ_WRITE){if(getObj(t).style.border="1px solid #FFFFFF",$("#pivottw").is(":visible")&&$("#pivottw").hide(),$("#chartMenu").show(),$("#menutabs").ztab("getSelectedTab")[0]){var r=$("#menutabs").ztab("getSelectedTab")[0].id;"chartMenu"!==r&&"pivottw"!==r&&(selectedmenutab=$("#menutabs").ztab("getSelectedTab")[0].id)}initializeToolbar("#chartTab"),ZComponentTabs.setSelectedTab("chartMenu"),ole(t)._setSelectLayer().positionActionBar()}e.stopPropagation()})},ft=function(e,t){e&&t&&Highcharts.setOptions({lang:{decimalPoint:e,thousandsSep:t}}),yt()},yt=function(){if(Chart.container&&0!=Chart.container.length)for(var e in Chart.container)for(var t in Chart.container[e]){var r=chartPreview.getHCInstance(t);r&&r.redraw(!0)}},mt=function(e,t){if(Chart.container&&0!=Chart.container.length)for(var r in Chart.container)for(var a in Chart.container[r])Chart.container[r][a]&&r!=t&&a==e&&R(r,a)},xt=function(e,t){var r=WorkSheets.getAssociatedActiveSheetName(),a=e.chartdetails,o=e.iura,i=e.osc;if(i&&0!=i.length)for(var n in i)for(var c in i[n])"function"!=typeof i&&"string"==typeof i[n][c]&&"function"!==i[n]&&(S(n,i[n][c]),ole.remove(i[n][c],!1),R(n,i[n][c]));var s=e.itr;if(s){var h=e.chartIdList;if(h){var l=new AjaxRequest,p=new RequestParameters(ActionConstants.CHART_REFRESH);p.setParameters(WorkSheets.getAssociatedActiveSheetName(),JSON.stringify(h)),l.init("POST",p.getURL(),!0,p.getParametersAsString()),l.addEventListener("onComplete",function(e){var t=JSON.parse(e.responseText);t&&!isUndefined(t[ActionConstants.CHART])&&chartOnLoad.updateChartJson(t[ActionConstants.CHART])}),l.sendRequest()}}var d,v;if(e.a===ActionConstants.POST_DOC_LOAD&&(d=e.ds,v=e.ts,ft(d,v)),a)switch(e.a){case ActionConstants.SHEET_RENAME:case ActionConstants.SWITCH_SHEET:case ActionConstants.POST_DOC_LOAD:if(a){G(WorkSheets.getAssociatedActiveSheetName(),!0),M(r);for(var c in a){var u=a[c];if(u){var C=u.sr,g=u.sc,f=u.srd,y=u.scd,m=u.left,x=u.top;if(-1==C&&-1==g&&-1==f&&-1==y){g=findColInXPos(m,!0),C=findRowInYPos(x,!0),y=m-getColLeft(g),f=x-getRowTop(C);var l=new AjaxRequest,O=new RequestParameters(ActionConstants.CHART_UPDATE);O.setParameters(u.asn,u.id,C,g,f,y,m,x),l.init("POST",O.getURL(),!0,O.getParametersAsString()),l.sendRequest(),u.sr=C,u.sc=g,u.srd=f,u.scd=y}var b=u.asn;r==b&&(u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,et(u,!0),chartPreview.setChartMode(!1,u.id),chartPreview.hideContextualToolbar(u.id),chartPreview.setRemoveSpecificChartFeature(u.id),PivotChartUtility.genratePivotChartFilterJson(u.id,chartOnLoad.getInstanceByChartId(u.id).pivotId))}}}else G(WorkSheets.getAssociatedActiveSheetName(),e.isChartAvailable);break;case ActionConstants.SHEET_REMOVE:if(a)for(var c in a){var u=a[c];if(u){var C=u.sr,g=u.sc,f=u.srd,y=u.scd,m=u.left,x=u.top,P=u.id;if(-1==C&&-1==g&&-1==f&&-1==y){g=findColInXPos(m,!0),C=findRowInYPos(x,!0),y=m-getColLeft(g),f=x-getRowTop(C);var l=new AjaxRequest,O=new RequestParameters(ActionConstants.CHART_UPDATE);O.setParameters(u.asn,u.id,C,g,f,y,m,x),l.init("POST",O.getURL(),!0,O.getParametersAsString()),l.sendRequest(),u.sr=C,u.sc=g,u.srd=f,u.scd=y}var b=u.asn;r==b?(u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,et(u,!0),chartPreview.setChartMode(!1,u.id),chartPreview.hideContextualToolbar(u.id),chartPreview.setRemoveSpecificChartFeature(u.id),G(WorkSheets.getAssociatedActiveSheetName(),!0)):(S(b,P),R(b,P))}}break;case ActionConstants.MACRO_SAVE_RUN:case ActionConstants.MACRO_RUN:for(var c in a){var u=a[c];if(u.a===ActionConstants.CHART_DELETE)St(u,r);else if("function"!=typeof u){var C=u.sr,g=u.sc,f=u.srd,y=u.scd,m=parseInt(u.left),x=parseInt(u.top),T=parseInt(u.ht),I=parseInt(u.wd),P=u.id;if(-1==C&&-1==g&&-1==f&&-1==y){g=findColInXPos(m),C=findRowInYPos(x),y=m-getColLeft(g),f=x-getRowTop(C);var l=new AjaxRequest,O=new RequestParameters(ActionConstants.CHART_UPDATE);O.setParameters(u.asn,u.id,C,g,f,y,m,x),l.init("POST",O.getURL(),!0,O.getParametersAsString()),l.sendRequest(),u.sr=C,u.sc=g,u.srd=f,u.scd=y}var b=u.asn;if(r==b)if(u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,chartPreview.getHCInstance(P)){var w=chartPreview.getHCInstance(P);previousChartType=u.type,(j(P).left!==m||j(P).top!==x)&&OLE[P].moveTo(m,x),(j(P).ht!==T||j(P).wd!==I)&&(OLE[P].resizeTo(I,T),w.setSize(I,T)),u.co=chartGlance.applySharedLegendInPie(u.co),u.co=chartGlance.applyregressionColorIndex(u.co),u.co=chartGlance.advanceChartSettingsInLegend(u.co),u.co=chartGlance.applyTooltip(u.co),u.co=chartGlance.advanceDataLabelSetting(u.co),PivotChartUtility.findTotalNoOfFilterRequired(P,u.pivotId),u.co=PivotChartUtility.setLegendBoundary(u.co,u.isPivotChart,u.legendPos,u.ht),-1!==u.co.chart.type.indexOf("pie")||-1!==u.co.chart.type.indexOf("funnel")?chartOptions=chartGlance.applyChartSpacing(u.co,10,15,10,10):u.co=chartGlance.applyChartSpacing(u.co,30,30,30,30),-1!==u.seriesIn.indexOf("COLS")&&(u.co=chartGlance.applyGrouping(u.co,u.grouping)),u.co=chartGlance.handleChartStyle(u.co,!1,u.gradient),chartPreview.getChartMode(u.co.chart.renderTo)&&(u.co=chartGlance.applyPointerCursor(u.co),u.co=X(u.co),chartPreview.setRemovedTooltipValue(u.co.tooltip.enabled),u.co.tooltip.enabled=!1,u.co.chart.zoomType&&(chartPreview.setRemovedZoomType(u.co.chart.zoomType),u.co.chart.zoomType="none")),w.refreshChart(u),chartPreview.getChartMode(P)&&Y(P),PivotChartUtility.genratePivotChartFilterJson(u.id,chartOnLoad.getInstanceByChartId(u.id).pivotId)}else et(u)}}break;case ActionConstants.CHART_NEW:if(a)for(var c in a){var u=a[c];if(u){var b=u.asn;if(r==b){u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,chartGlance.initCustomizationUi();var P=u.id;et(u,!0),t?($("#pivottw").is(":visible")&&$("#pivottw").hide(),u.isPivotChart?($("#chartMenu").hide(),$("#pivotChartMenu").show()):($("#pivotChartMenu").hide(),$("#chartMenu").show()),initializeToolbar("#chartTab"),ZComponentTabs.setSelectedTab("chartMenu"),getObj(u.id).style.border="1px solid #FFFFFF",ole(u.id)._setSelectLayer(),ole.isActive()&&(chartPreview.setChartMode(!1,ole.getCurrObj().id),$("#"+chartPreview.getOleLayer()).css("background-color","#FFF"))):chartPreview.setChartMode(!1,P),PivotChartUtility.genratePivotChartFilterJson(P,chartOnLoad.getInstanceByChartId(P).pivotId)}else S(b,a.id)}}break;case ActionConstants.CHART_MOVE:if(!t||o)for(var c in a){var u=a[c];if(u){var b=u.asn;if(r==b){var P=u.id,m=u.left,x=u.top;ole.isSelected(P)?(OLE[P].setLeft(m)._setSelectLayer(!0).positionActionBar(),OLE[P].setTop(x)._setSelectLayer(!0).positionActionBar()):ole.isFocussed(P)?(OLE[P].setLeft(m).setFocusLayer(),OLE[P].setTop(x).setFocusLayer()):(OLE[P].setLeft(m),OLE[P].setTop(x)),o&&t&&ole(u.id)._setSelectLayer()}PivotChartUtility.genratePivotChartFilterJson(u.id)}}break;case ActionConstants.CHART_DELETE:var A=e.dpc;if(!t||o||A)for(var c in a){var u=a[c];if(u&&!u.co)St(u,r);else if(u&&u.co){var L={};L.iura=e.iura,L.ipda=!1,L.chartdetails=[],L.chartdetails[0]=u,L.a=0,xt(L,!1)}}break;case ActionConstants.CHART_RESIZE:for(var c in a){var u=a[c];if(u){var b=u.asn;if(r==b){var P=u.id,m=u.left,x=u.top,T=parseInt(u.ht),I=parseInt(u.wd);if(ole.isSelected(P)?(OLE[P].moveTo(m,x)._setSelectLayer(!0).positionActionBar(),OLE[P].resizeTo(I,T)._setSelectLayer(!0).positionActionBar(),ole(P).sRow=u.sr,ole(P).sCol=u.sc,ole(P).sRowDiff=u.srd,ole(P).sColDiff=u.scd):ole.isFocussed(P)?(OLE[P].moveTo(m,x).setFocusLayer(),OLE[P].resizeTo(I,T).setFocusLayer()):(OLE[P].moveTo(m,x),OLE[P].resizeTo(I,T)),u.co){var E=chartPreview.getHCInstance(P);u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=chartGlance.applySharedLegendInPie(u.co),u.co=chartGlance.applyregressionColorIndex(u.co),u.co=chartGlance.advanceChartSettingsInLegend(u.co),u.co=chartGlance.applyTooltip(u.co),u.co=chartGlance.advanceDataLabelSetting(u.co),PivotChartUtility.findTotalNoOfFilterRequired(P,u.pivotId),u.co=PivotChartUtility.setLegendBoundary(u.co,u.isPivotChart,u.legendPos,u.ht),-1!==u.co.chart.type.indexOf("pie")||-1!==u.co.chart.type.indexOf("funnel")?chartOptions=chartGlance.applyChartSpacing(u.co,10,15,10,10):u.co=chartGlance.applyChartSpacing(u.co,30,30,30,30),-1!==u.seriesIn.indexOf("COLS")&&(u.co=chartGlance.applyGrouping(u.co,u.grouping)),u.co=chartGlance.handleChartStyle(u.co,!1,u.gradient),chartPreview.getChartMode(u.co.chart.renderTo)&&(u.co=chartGlance.applyPointerCursor(u.co),u.co=X(u.co),chartPreview.setRemovedTooltipValue(u.co.tooltip.enabled),u.co.tooltip.enabled=!1,u.co.chart.zoomType&&(chartPreview.setRemovedZoomType(u.co.chart.zoomType),u.co.chart.zoomType="none")),E.refreshChart(u),chartPreview.getChartMode(P)&&Y(P)}chartPreview.getHCInstance(P).setSize(I,T),"wordcloud"===chartPreview.getHCInstance(P).options.chart.type&&chartPreview.getHCInstance(P).redraw(),chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).co&&chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).co.options.legend.enabled&&chartPreview.getHCInstance(P).legend.render(),PivotChartUtility.genratePivotChartFilterJson(P,chartOnLoad.getInstanceByChartId(P).pivotId),chartOnLoad.getInstanceByChartId(P).isPivotChart&&setTimeout(function(){PivotChartUtility.repositionFilter(P)},500)}}}break;case ActionConstants.CHART_EDIT:for(var c in a){var u=a[c];if("function"!=typeof a[c]&&u){var b=u.asn;if(b==r){var P=u.id,w=chartPreview.getHCInstance(P);u.co=chartGlance.applyregressionColorIndex(u.co),u.co=chartGlance.advanceChartSettingsInLegend(u.co),u.co=chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency),u.co=-1!==u.co.chart.type.indexOf("pie")||-1!==u.co.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(u.co,10,15,10,10):chartGlance.applyChartSpacing(u.co,30,30,30,30),-1!==u.seriesIn.indexOf("COLS")&&(u.co=chartGlance.applyGrouping(u.co,u.grouping)),u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=chartGlance.applySharedLegendInPie(u.co),u.co=chartGlance.advanceDataLabelSetting(u.co),PivotChartUtility.findTotalNoOfFilterRequired(P,u.pivotId),u.co=PivotChartUtility.setLegendBoundary(u.co,u.isPivotChart,u.legendPos,u.ht),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,u.co=chartGlance.handleChartStyle(u.co,!1,u.co),chartPreview.getChartMode(P)&&(u.co=X(u.co),u.co=chartGlance.applyPointerCursor(u.co),u.co.tooltip.enabled=!1,u.co.chart.zoomType&&(u.co.chart.zoomType="none"),-1!==u.co.chart.type.indexOf("pie")&&(u.co.plotOptions[u.co.chart.type].allowPointSelect=!1)),w.refreshChart(u),getObj(u.id).style.border=ole.isActive()&&ole.getCurrObj().id==u.id?"1px solid #FFFFFF":"1px solid lightgray",chartPreview.getChartMode(P)&&(chartPreview.toggleRectSvg(P,chartPreview.getChartCustomizationEventType()),Y(P),setTimeout(chartPreview.toggleRectSvg(P,chartPreview.getChartCustomizationEventType()),3e3)),PivotChartUtility.genratePivotChartFilterJson(u.id,chartOnLoad.getInstanceByChartId(u.id).pivotId)}else S(b,P),R(b,P);o&&t&&ole(u.id)._setSelectLayer()}}break;case ActionConstants.CHART_PUBLISH:for(var c in a){var u=a[c];if(u){var b=u.asn;if(r===b){var k=u.pcn;!o&&t&&chart.showPublishURLDialog(k),j(u.id).pcn=k,$("#pic_publish_link_span").hide(),$("#pic_publish_revert_span").show(),$("#pic_publish_showlink_span").show()}}}break;case ActionConstants.CHART_UNPUBLISH:for(var c in a){var u=a[c];if(u){var b=u.asn;r===b&&(j(u.id).pcn=null,$("#pic_publish_revert_span").hide(),$("#pic_publish_showlink_span").hide(),$("#pic_publish_link_span").show())}}break;case ActionConstants.CHART_MOVE_TO_NEW_SHEET:if(chartOLEAction.backToPreviousToolbar(),a&&a.length>0)for(var c in a){var u=a[c];if(u){mt(u.id,u.asn);var P=u.id,b=u.asn;r==b?(u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,chartGlance.initCustomizationUi(),et(u),t?($("#pivottw").is(":visible")&&$("#pivottw").hide(),ole(u.id)._setSelectLayer(),ole.isActive()&&(chartPreview.setChartMode(!0,P),$("#"+chartPreview.getOleLayer()).css("background-color","#FFF"))):chartPreview.setChartMode(!1,P)):S(b,P)}}else if(i&&0!=i.length){var F,B;for(var n in i)for(var c in i[n])"function"!=typeof i&&"string"==typeof i[n][c]&&"function"!==i[n]&&(o&&Chart.container[WorkSheets.getAssociatedActiveSheetName()][i[n][c]]&&(F=parseInt(Chart.container[WorkSheets.getAssociatedActiveSheetName()][i[n][c]].sr),B=parseInt(Chart.container[WorkSheets.getAssociatedActiveSheetName()][i[n][c]].sc)),ole.remove(i[n][c],!1),R(WorkSheets.getAssociatedActiveSheetName(),i[n][c]));if(o&&t){var _=WorkSheets.getSheetNameFromCode(n);Goto.doGoto(_,F,F,B,B,!0)}}break;case ActionConstants.CHART_QUICK_EDIT:for(var c in a)if("function"!=typeof a[c]){var P=a[c].chartId;switch(a[c].subAction){case 101:a[c].asn!=WorkSheets.getAssociatedActiveSheetName()||t&&!o||(chartPreview.ctLegendPos(a[c].value,P),chartPreview.getChartMode(P)&&(chartOnLoad.overrideHighchartsEvent(P),chartPreview.toggleRectSvg(P,chartPreview.getChartCustomizationEventType())));break;case 102:a[c].asn!=WorkSheets.getAssociatedActiveSheetName()||t&&!o||chartPreview.changedataLabels(a[c].value,P);break;case 103:a[c].asn!=WorkSheets.getAssociatedActiveSheetName()||t&&!o||chartPreview.setMajorGrid(P,a[c].value);break;case 104:a[c].asn!=WorkSheets.getAssociatedActiveSheetName()||t&&!o||chartPreview.setMinorGrid(P,a[c].value);break;case 105:a[c].asn!=WorkSheets.getAssociatedActiveSheetName()||t&&!o||chartPreview.setAnimation(a[c].value?"animationYes":"animationNo",P);break;case 106:a[c].asn!=WorkSheets.getAssociatedActiveSheetName()||t&&!o||chartPreview.setTooltip(a[c].value?"tooltipYes":"tooltipNo",P);break;case 107:if(a[c].asn==WorkSheets.getAssociatedActiveSheetName()){var w=chartPreview.getHCInstance(P),u=a[c].value;if(u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,u.co=chartGlance.applyregressionColorIndex(u.co),u.co=chartGlance.advanceChartSettingsInLegend(u.co),u.co=chartGlance.applySharedLegendInPie(u.co),u.co=chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency),u.co.plotOptions.series.animation=!1,"COMBOCHART"===u.chartType)for(var c=0;c<u.co.series.length;c++)u.co="pie"===u.co.series[c].type?chartGlance.applyChartSpacing(u.co,10,15,10,10):chartGlance.applyChartSpacing(u.co,30,30,30,30);else u.co=-1!==u.co.chart.type.indexOf("pie")||-1!==u.co.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(u.co,10,15,10,10):chartGlance.applyChartSpacing(u.co,30,30,30,30);-1!==u.seriesIn.indexOf("COLS")&&(u.co=chartGlance.applyGrouping(u.co,u.grouping)),u.co=chartGlance.advanceDataLabelSetting(u.co),u.co=chartGlance.applyregressionColorIndex(u.co),u.co=chartGlance.handleChartStyle(u.co,!1,u.gradient),PivotChartUtility.findTotalNoOfFilterRequired(P,u.pivotId),u.co=PivotChartUtility.setLegendBoundary(u.co,u.isPivotChart,u.legendPos,u.ht),chartPreview.getChartMode(P)&&(u.co=X(u.co),u.co=chartGlance.applyPointerCursor(u.co),u.co.tooltip.enabled=!1,u.co.chart.zoomType&&(u.co.chart.zoomType="none"),(-1!==u.co.chart.type.indexOf("pie")||-1!==chartPreview.getAllChartTypesInComboChart(u.co,u.type).indexOf("pie"))&&(u.co.plotOptions.pie.allowPointSelect=!1)),w.refreshChart(u),getObj(u.id).style.border="1px solid #FFFFFF",chartPreview.getChartMode(P)&&Y(P),PivotChartUtility.genratePivotChartFilterJson(u.id,chartOnLoad.getInstanceByChartId(u.id).pivotId)}}}chartPreview.hideContextualToolbar();break;case ActionConstants.CHART_PASTE_STYLE:case ActionConstants.CHART_QUICK_STYLE:for(var c=0;c<a.length;c++){var u=a[c];if(u){var b=u.asn;if(b==r){var P=u.id,w=chartPreview.getHCInstance(P);u.co=chartGlance.applyregressionColorIndex(u.co),u.co=chartGlance.advanceChartSettingsInLegend(u.co),u.co=chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency),u.co=-1!==u.co.chart.type.indexOf("pie")||-1!==u.co.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(u.co,10,15,10,10):chartGlance.applyChartSpacing(u.co,30,30,30,30),-1!==u.seriesIn.indexOf("COLS")&&(u.co=chartGlance.applyGrouping(u.co,u.grouping)),u.co=chartGlance.applyDataLabels(u.co,u.lf,u.currency,u.xAxisSymbol,d,v,u.zAxisSymbol,u.secYAxisSymbol,u.type,u.isSingleYaxis,u.precision),u.co=chartGlance.applySharedLegendInPie(u.co),u.co=chartGlance.advanceDataLabelSetting(u.co);var z=u.co.chart.renderTo;u.co=u.currency&&"%"!==u.currency?chartGlance.applyTooltip(u.co,u.frl,u.fcl,u.currency):u.co,u.co=chartGlance.handleChartStyle(u.co,!1,u.gradient),PivotChartUtility.findTotalNoOfFilterRequired(P,u.pivotId),u.co=PivotChartUtility.setLegendBoundary(u.co,u.isPivotChart,u.legendPos,u.ht),u.co.plotOptions.series.animation=!1,chartPreview.getChartMode(z)&&(u.co=chartGlance.applyPointerCursor(u.co),u.co=X(u.co),u.co.tooltip.enabled=!1,u.co.chart.zoomType&&(u.co.chart.zoomType="none"),(-1!==u.co.chart.type.indexOf("pie")||-1!==chartPreview.getAllChartTypesInComboChart(u.co,u.type).indexOf("pie"))&&(u.co.plotOptions.pie.allowPointSelect=!1)),w.refreshChart(u),chartPreview.getChartMode(z)&&(chartPreview.toggleRectSvg(z,chartPreview.getChartCustomizationEventType()),Y(z),setTimeout(chartPreview.toggleRectSvg(z,chartPreview.getChartCustomizationEventType()),3e3)),PivotChartUtility.genratePivotChartFilterJson(u.id,chartOnLoad.getInstanceByChartId(u.id).pivotId)}else S(b,P),R(b,P)}}break;case ActionConstants.INSERT_ROW:case ActionConstants.INSERT_COL:case ActionConstants.DELETE_ROW:case ActionConstants.DELETE_COL:case ActionConstants.SUBMIT:case ActionConstants.CHART_REFRESH:default:Ot(r,a,0,d,v,t)}},Ot=function(e,t,r,a,o,i){var n=r<t.length?t[r]:null;null!=n&&bt(e,n,a,o,i).then(function(){Ot(e,t,++r,a,o,i)})},bt=function(e,t,r,a,o){return new Promise(function(i){if(t.vci&&(sendApiResponse(t),setTimeout(function(){i()},20)),t){var n=t.asn,c=t.id;if(ole&&ole.isActive()||!getObj(c)||(getObj(c).style.border="1px solid "+chartGlance.getRGBA("rgb(222,222,222)",1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(t.co.chart.backgroundColor)))),e==n){var s=t.co;s=chartGlance.applyDataLabels(t.co,t.lf,t.currency,t.xAxisSymbol,r,a,t.zAxisSymbol,t.secYAxisSymbol,t.type,t.isSingleYaxis,t.precision),s=chartGlance.applySharedLegendInPie(t.co),PivotChartUtility.findTotalNoOfFilterRequired(c,t.pivotId),t.co=PivotChartUtility.setLegendBoundary(t.co,t.isPivotChart,t.legendPos,t.ht),s=t.currency&&"%"!==t.currency?chartGlance.applyTooltip(s,t.frl,t.fcl,t.currency):s;var h=chartPreview.getHCInstance(c),l="datetime"===s.xAxis.type||h&&"datetime"===h.options.xAxis[0].type,p=s.series,d=h?h.series.length:0,v=p.length,u=v*(p[0]?p[0].data.length:1),C=chartOnLoad.getInstanceByChartId(c),g="waterfall"===s.chart.type||u>300||chartOnLoad.getInstanceByChartId(c)&&t.secYAxisSymbol!==chartOnLoad.getInstanceByChartId(c).secYAxisSymbol||t.co.yAxis.length>20;if(t.grouping||g||l||d!==v||!C||t.currency!==C.currency||t.xAxisSymbol!==C.xAxisSymbol){if(h){var f=t.co.chart.type,y=t.co.chart.renderTo;void 0==t.co.plotOptions[f].animation&&(t.co.plotOptions[f].animation={}),t.co=-1!==t.co.chart.type.indexOf("pie")||-1!==t.co.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(t.co,10,15,10,10):chartGlance.applyChartSpacing(t.co,30,30,30,30),-1!==t.seriesIn.indexOf("COLS")&&(t.co=chartGlance.applyGrouping(t.co,t.grouping)),t.co.plotOptions[f].animation.duration=0,t.co.series&&t.co.series.length>=1&&t.co.series[0].hasOwnProperty("regressionSettings")&&(t.co.plotOptions.series.animation=!1),t.co=chartGlance.applyregressionColorIndex(t.co),t.co=chartGlance.advanceChartSettingsInLegend(t.co),t.co=chartGlance.applySharedLegendInPie(t.co),t.co=chartGlance.advanceDataLabelSetting(t.co),t.co=chartGlance.applyTooltip(t.co,t.fcl,t.frl,t.currency),t.co=chartGlance.handleChartStyle(t.co,!1,t.gradient),PivotChartUtility.findTotalNoOfFilterRequired(c,t.pivotId),t.co=PivotChartUtility.setLegendBoundary(t.co,t.isPivotChart,t.legendPos,t.ht),t.co.plotOptions.series.animation=!1,chartPreview.getChartMode(y)&&(t.co=chartGlance.applyPointerCursor(t.co),chartPreview.setRemovedTooltipValue(t.co.tooltip.enabled),t.co.tooltip.enabled=!1,h.options.chart.zoomType&&(chartPreview.setRemovedZoomType(t.co.chart.zoomType),t.co.chart.zoomType="none"),-1!==t.co.chart.type.indexOf("pie")&&(t.co.plotOptions[t.co.chart.type].allowPointSelect=!1),t.co=chartOnLoad.applyChartEvents(t.co)),h.refreshChart(t),chartPreview.removeRectSvg(y,chartPreview.getChartCustomizationEventType()),chartPreview.getChartMode(y)&&Y(y),PivotChartUtility.genratePivotChartFilterJson(t.id,chartOnLoad.getInstanceByChartId(t.id).pivotId)}else if(t){var n=t.asn;if(e==n){t.co=chartGlance.applyDataLabels(t.co,t.lf,t.currency,t.xAxisSymbol,r,a,t.zAxisSymbol,t.secYAxisSymbol,t.type,t.isSingleYaxis,t.precision),t.co=t.currency&&"%"!==t.currency?chartGlance.applyTooltip(t.co,t.frl,t.fcl,t.currency):t.co,chartGlance.initCustomizationUi();var c=t.id;et(t,!0),o?($("#pivottw").is(":visible")&&$("#pivottw").hide(),t.isPivotChart?($("#chartMenu").hide(),$("#pivotChartMenu").show()):($("#pivotChartMenu").hide(),$("#chartMenu").show()),initializeToolbar("#chartTab"),ZComponentTabs.setSelectedTab("chartMenu"),getObj(t.id).style.border="1px solid #FFFFFF",ole(t.id)._setSelectLayer(),ole.isActive()&&(chartPreview.setChartMode(!1,ole.getCurrObj().id),$("#"+chartPreview.getOleLayer()).css("background-color","#FFF"))):chartPreview.setChartMode(!1,c),PivotChartUtility.genratePivotChartFilterJson(c,chartOnLoad.getInstanceByChartId(c).pivotId)}else S(n,t.id)}}else{var m=s.xAxis,x=s.xAxis.title.style,O=s.yAxis[0].title.style;if(h.options.plotOptions.series.animation=!1,-1!==$.inArray(t.type,multiAxisCharts)&&(s=chartGlance.applySeriesColorToAxis(s)),s=chartGlance.applyCustomizationToPlotLines(s),h.yAxis[0].update({title:{text:s.yAxis[0].title.text,style:O}}),h.xAxis[0].update({title:{text:s.xAxis.title.text,style:x}}),s.yAxis.length>=2&&h.yAxis[1])for(var b=1;b<s.yAxis.length;b++){var P=s.yAxis[b].title.style;h.yAxis[b].update({title:{text:s.yAxis[b].title.text,style:P}})}h.setTitle({text:s.title.text}),h.setTitle(null,{text:s.subtitle.text}),h.xAxis[0].update({type:m.type}),h.xAxis[0].setCategories(m.categories),h.yAxis[0].update({labels:s.yAxis[0].labels}),(-1!==t.co.chart.type.indexOf("pie")||-1!==t.co.chart.type.indexOf("funnel"))&&(p=chartGlance.handleChartStyle(t.co,!1,t.gradient).series);for(var T=0,I=p.length;I>T;T++)T!==I-1?h.series[T].setData(p[T].data,!0):h.series[T].setData(p[T].data,!0),h.series[T].update({name:p[T].name});(-1!==t.type.indexOf("LINE")||-1!==t.type.indexOf("SCATTER")||-1!==t.type.indexOf("BUBBLE"))&&w(chartOnLoad.getInstanceByChartId(c).co);var A=chartPreview.getHCInstance(t.co.chart.renderTo);chartPreview.getChartMode(c)&&(s=chartGlance.applyPointerCursor(t.co),chartPreview.setRemovedTooltipValue(t.co.tooltip.enabled),A.options.tooltip.enabled=!1,A.options.chart.zoomType&&(A.options.chart.zoomType="none",chartPreview.setRemovedZoomType(t.co.chart.zoomType)),(-1!==t.co.chart.type.indexOf("pie")||-1!==chartPreview.getAllChartTypesInComboChart(t.co,t.type).indexOf("pie"))&&(t.co.plotOptions.pie.allowPointSelect=!1),A.userOptions=chartOnLoad.applyChartEvents(A.userOptions)),A.options.series=t.co.series,A.userOptions=chartGlance.applyGrouping(t.co,t.grouping),A.userOptions.series=chartGlance.handleChartStyle(t.co,!1,t.gradient).series,chartOnLoad.updateHCInstance(WorkSheets.getAssociatedActiveSheetName(),A.options.chart.renderTo,A),chartPreview.removeRectSvg(t.co.chart.renderTo,chartPreview.getChartCustomizationEventType()),chartPreview.getChartMode(c)&&Y(c),PivotChartUtility.genratePivotChartFilterJson(t.id,chartOnLoad.getInstanceByChartId(t.id).pivotId),chartOnLoad.getInstanceByChartId(t.id).isPivotChart&&setTimeout(PivotChartUtility.repositionFilter(t.id),500)}}else S(n,c),R(n,c)}setTimeout(function(){i()},20)})},Pt=function(e,t,r,a){var o,i;t||r?(i=parseInt(getColLeft(r)),o=parseInt(getRowTop(t))):(o=parseInt(Math.round(sheet.offsetHeight/2-165+getSheetScrollTop()+20)),i=parseInt(Math.round(sheet.offsetWidth/2-225+getNormalizedScrollLeft())),t=findRowInYPos(o),r=findColInXPos(i)),chart.cloneChart(e,!0,t,r,0,0,o,i,!0,a)},St=function(e,t){if("function"!=typeof e){var r=e.asn,a=e.id;t===r?(ole.currObj&&ole.currObj.id==a&&(getObj("OLETextarea").blur(),chartOLEAction.backToPreviousToolbar()),ole.remove(a,!1),ole.conf.onblur(),R(r,a),activateCellField()):R(r,a)}},Tt=function(){-1!==previousChartType.indexOf("PIE")?($("#ctpercentandvalue").show(),$("#ctpercent").show(),$("#bubblesize").hide()):-1!==previousChartType.indexOf("BUBBLE")?($("#bubblesize").show(),$("#ctpercentandvalue").hide(),$("#ctpercent").hide()):(-1!==previousChartType.indexOf("COL")||-1!==previousChartType.indexOf("BAR")||-1!==previousChartType.indexOf("LINE")||-1!==previousChartType.indexOf("AREA"))&&($("#bubblesize").hide(),$("#ctpercentandvalue").hide(),$("#ctpercent").hide())},It=function(e){var t=e.min,r=e.max,a=(r-t)/200;return Math.round(a)};return appEvent.on("chart.onLoad",function(e,t){xt(e,t)}),appEvent.on("chart.rightclick",function(e){tt(e)}),appEvent.on("chart.click",function(e){Ct(e)}),appEvent.on("chart.dblclick",function(e){gt(e)}),appEvent.on("wms.messageprocessed",function(e){ChartClip.updateResponse(e)}),appEvent.on("chart.insert.server.copystyles",function(e){ChartClip.updateResponse(e)}),{getSheetCharts:z,renderSheetCharts:H,getAffectInfo:T,createNew:I,getInstance:D,updateHCInstance:E,addInstance:k,addAffectId:S,removeChart:R,dataLabelDropdown:Tt,updateChartJson:xt,doClickHandling:Ct,showOleMenu:it,preventDefault:ot,removeSheetCharts:A,setLocaleOptions:ft,getIntervalValue:It,setPositiveExtreme:w,renderChart:et,removeSheetAffectCharts:L,removeSpecificChartFeature:nt,setLastClickType:lt,clickOpertionOnChartContainer:ut,overrideHighchartsEvent:Y,changeChartMode:dt,removeCustomEvents:V,addChartStateById:s,getChartStateById:h,doClickHandling:Ct,applyChartEvents:X,createSubMenu:at,getInstanceByChartId:j,chartFormatePainter:rt,syncAndHandleUnwantedRemovedChartEvents:Z,syncAndHandleUnwantedRemovedOverideEvent:J,reloadChartsInfo:Q,updateChartSelectionById:a,resetChartSelectionById:n,getChartSelectionById:c,colorPallateCallback:vt,addAxisOptionsIndex:l,getAxisOptionsIndex:O,addDashStyle:C,getDashStyle:P,addAxisOptionsObj:u,getAxisOptionsObj:b,addDepthHeaders:g,getDepthHeaders:x,getDepthVals:y,getDepthOperations:m,addDepthOperations:f,addDepthIndices:p,getDepthIndices:v,submitChartFromExplore:Pt,clearDepthIndices:d,mergeOptions:F,mergeRecursively:B}}(jQuery);
var PivotChartUtility=function(){var t=100,e=30,n=0,r=0,i=0,a=function(t,e){e.chartId=t,e=w(e);var n=g(t,e.pft);u(t,e,n)},o=function(n,r){if(t=100,-1!==r.indexOf("row"))return $("#"+n).height()-30;if(-1!==r.indexOf("column")){var i=chartOnLoad.getInstanceByChartId(n).legendPos;if(2>=i||4==i)return l=parseInt($("#"+n).width())-t,s=parseInt($("#"+n).height())/2-p()*e/2,{top:s,left:l};var a=$("#"+n).find(".highcharts-legend").attr("transform");if(!a)return;var o=a.split("(")[1].split(",");o.length<=1&&(o=a.split("(")[1].split(" "));{var s=parseInt(o[1]),l=parseInt(o[0]);p()}i>=3&&(s-=p()*(e-8),l-=10);var c=chartOnLoad.getInstanceByChartId(n).co,d=c.options.legend.itemStyle;return d.font=c.options.chart.style&&c.options.chart.style.fontFamily?c.options.chart.style.fontFamily:"Arial",t=Math.max(t,chartPreview.calculateLegendWidth(n,d)),{top:Math.max(5,s),left:l}}},s=function(t){var e=chartOnLoad.getInstanceByChartId(t);if(e&&-1===t.indexOf("preview")&&(isPivotChart=e.isPivotChart)){var n=document.getElementById("pivotRowFilterContainer"+t),r=document.getElementById("pivotPageFilterContainer"+t),i=document.getElementById("pivotColumnFilterContainer"+t),a=O(t,"row");$(n).css("top",a+"px"),$(r).css("margin-left","30px").css("margin-top","5px");var s;s=o(t,"column"),s&&$(i).css("top",s.top+"px").css("left",s.left+15+"px")}},l=function(t,e,a,o){var s=!1;n=r=i=0;var l=chartOnLoad.getInstanceByChartId(t);if((a||l&&-1===t.indexOf("preview"))&&(s=l?l.isPivotChart:o)){var p=PivotUtil.getPivotAllFilterDetailsByPivotId(e);if(p){var f=I(t,e,!0);c(p,f),d(p,f),h(p)}}},c=function(t,e){for(var r=0,i=0;i<t.length;i++)if(-1!==t[i].pft.indexOf("column")){var a=t[i][JSONConstants.PIVOT_FIELD_TYPE],o=t[i][JSONConstants.HEADER_INDEX];e&&a===e[JSONConstants.PIVOT_FIELD_TYPE]&&o===e[JSONConstants.HEADER_INDEX]||r++}n=r},p=function(){return n},d=function(t,e){for(var n=0,i=0;i<t.length;i++)if(-1!==t[i].pft.indexOf("row")){var a=t[i][JSONConstants.PIVOT_FIELD_TYPE],o=t[i][JSONConstants.HEADER_INDEX];e&&a===e[JSONConstants.PIVOT_FIELD_TYPE]&&o===e[JSONConstants.HEADER_INDEX]||n++}r=n},f=function(){return r},h=function(t){for(var e=0,n=0;n<t.length;n++)-1!==t[n].pft.indexOf("page")&&e++;i=e},v=function(){return i},u=function(e,n,r){var i=n[JSONConstants.PIVOT_FIELD_TYPE],a=n[JSONConstants.HEADER_INDEX],o=I(e),s="fT_"+n.pft+"cID"+e+"R"+n.row+"C"+n.col;if(void 0!=$("#"+s)[0]&&$("#"+s).remove(),!o||i!==o[JSONConstants.PIVOT_FIELD_TYPE]||a!==o[JSONConstants.HEADER_INDEX]){var l=document.createElement("div");l.id="fT_"+n.pft+"cID"+e+"R"+n.row+"C"+n.col,$(l).css("height","20px"),l.className="pvtChrtDlg";var c=document.createElement("img"),p=$($("#"+e).find(".highcharts-legend")[0]).children()[0],d=chartOnLoad.getInstanceByChartId(e),f=d?d.legendPos:-1,h=p&&f&&(3==f||5==f)?parseInt(p.getAttribute("width")):t;-1!==n.pft.indexOf("column")?($(l).css("width",h-20+"px"),$(l).addClass("colPvtHeader")):$(l).css("width","70px"),c.src=IMAGE_PATH+n[JSONConstants.PIVOT_ICON_TYPE]+".png",$(l).attr("data-pivot",n.cellValue),$(l).append($(c)),$(r).append($(l)),$(l).bind("click",function(){chartPreview.hideContextualToolbar(),Filter.showFilterOptions(!1,n.col,!0,n,$(l))})}},g=function(t,e){return-1!==e.indexOf("row")?C(t,e):-1!==e.indexOf("column")?E(t,e):m(t,e)},I=function(t,e,n){if(e||n||(e=chartOnLoad.getInstanceByChartId(t).pivotId),!e)return void 0;var r=PivotUtil.getPivotChartAttributesByPivotId(e),i=r[JSONConstants.ROW_FIELDS],a=r[JSONConstants.COLUMN_FIELDS];return PivotUtil.getValueObj(i,a)},C=function(t,e){var n=document.getElementById("pivotRowFilterContainer"+t);if(n)return n;n=document.createElement("div"),n.id="pivotRowFilterContainer"+t,n.className="pvtChrtFlt";var r=O(t,e);return $(n).css("top",r+"px").css("margin-left","30px"),$("#"+t).append($(n)),n},O=function(t,e){return-1!==e.indexOf("row")?$("#"+t).height()-30:void 0},m=function(t){var e=document.getElementById("pivotPageFilterContainer"+t);return e?e:(e=document.createElement("div"),e.id="pivotPageFilterContainer"+t,e.className="pvtChrtFlt",$(e).css("margin-left","30px").css("margin-top","5px"),$("#"+t).append($(e)),e)},E=function(e,n){var r,i=document.getElementById("pivotColumnFilterContainer"+e);if(i)return i;i=document.createElement("div"),i.id="pivotColumnFilterContainer"+e,i.className="pvtChrtFlt";var a=chartOnLoad.getInstanceByChartId(e).legendPos;return(r=o(e,n))?(2!==a&&1!==a?$(i).css("width",t+"px"):$(i).css("width",""),$(i).css("top",r.top+"px").css("left",r.left+15+"px"),$("#"+e).append($(i)),i):void 0},P=function(t){$("#pivotRowFilterContainer"+t).remove(),$("#pivotColumnFilterContainer"+t).remove(),$("#pivotPageFilterContainer"+t).remove()},x=function(t,e,n){var r=n,i=$(r).position(),a=$(r).width(),o=$($(n).parent()).position(),s=$($($(n).parent()).parent()).position(),l=parseInt(i.left)+a+parseInt(o.left)+parseInt(s.left)+45-getSheetScrollLeft(),c=parseInt(i.top)+parseInt(o.top)+parseInt(s.top)+170-getSheetScrollTop();-1!==e.pft.indexOf("page")?(c+=5,l-=46):-1!==e.pft.indexOf("row")&&(l-=46),$("#bannerHolder").is(":visible")&&(c+=$("#bannerHolder").height());var p=$(t).height(),d=$(t).width();window.innerWidth<=l+d&&(l=l-d-$(r).width(),(-1!==e.pft.indexOf("row")||-1!==e.pft.indexOf("page"))&&(l+=155)),window.innerHeight<=c+p&&(c=c-p-$(r).height()-15),$(t).css({left:l+"px",zIndex:1e4+BASEZINDEX,top:c+"px"})},w=function(t){return t.cellValue=y(t.pft,t),t},y=function(t,e){for(var n,r,i,a,o=e.pfbd,s=0;s<o.length;s++)if(n=o[s].ra,r=n.split(".")[1],i=parseInt(r.charAt(0),36)-10,a=parseInt(r.substring(1))-1,i===e.col&&a===e.row)return o[s].rv?o[s].rv:" "},F=function(t,e){var n=!1,r=chartOnLoad.getInstanceByChartId(t);if(r&&-1===t.indexOf("preview")&&(n=r.isPivotChart)){P(t),e||(e=r.pivotId);var i=PivotUtil.getPivotAllFilterDetailsByPivotId(e);!i||i&&0==i.length||N(t,e,i)}},N=function(t,e,n){var r=[],i=PivotUtil.getPivotAllFilterButtonDetailsByPivotId(e),a=i.split(" ");if(a.length>n.length){for(var o,s=[],l=a.length/n.length,c=0;c<a.length;c+=l){o="";for(var p=c;c+l>p;p++)o+=a[p],c+l>p+1&&(o+=" ");o=o.replace(/["']/g,""),s.push(o)}a=s}var d,f;d=new AjaxRequest,f=new RequestParameters(ActionConstants.PIVOT_CHART_BUTTON_DETAILS),f.setParameters(WorkSheets.getAssociatedActiveSheetName(),JSON.stringify(a)),d.init("POST",f.getURL(),!0,f.getParametersAsString()),d.sendRequest(),d.addEventListener("onComplete",function(i){var o=parseJSON(i.responseText);r=o.pivotBottonRef.crv,S(t,e,n,r,a)})},S=function(t,e,n,r,i){if(r.length==i.length){var o=I(t,e,!0);c(n,o);for(var s=0;s<n.length;s++)n[s].pfbd=r,n[s].pivotId=e,n[s].asn=pivot.Collection.get(e).attributes.asn,a(t,n[s])}},T=function(t,e,n){if(n){var r,i;r=10,i=15,t=D(t,e,i,r)}else t=D(t,e,50,90);return t},D=function(t,e,n,r){return v()&&(t.chart.spacingTop=n),f()&&(t.chart.spacingBottom=n),isUndefined(t.legend.enabled)||t.legend.enabled||(r=-1===t.chart.type.indexOf("pie")&&-1===t.chart.type.indexOf("funnel")?30:10),p()&&(2>=e||4==e)&&(4!=e&&(t.chart.spacingLeft=50),t.chart.spacingRight=90),t},_=function(t,e){return t=T(t,e,!0)},A=function(t,n,r){return-1!==t.chart.renderTo.indexOf("preview")?t=_(t,r):(t=-1!==t.chart.type.indexOf("pie")||-1!==t.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(t,10,15,15,15):chartGlance.applyChartSpacing(t,30,30,30,30),n&&(r>=3&&(t.legend.y=5==r?e/2*p():0),r>=3&&p()&&(t.legend.maxHeight=parseInt($("#"+t.chart.renderTo).height())-Math.min(3,p())*e-100),(3==r||5==r)&&p()>=4&&(t.legend.y+=20),t=T(t,r,!1)),t)};return{repositionFilter:s,findTotalNoOfFilterRequired:l,showFilterMenu:x,genratePivotChartFilterJson:F,setLegendBoundary:A,clearAll:P}}(jQuery);
var chartStyleClip,chartClipOperation,ChartClip=function(t){this.docid=DOCUMENT_ID,this.sheetName=CURRSHEETNAME,this.a=t,this.ver=DOCUMENT_VERSION,this.ttl=-1,this.ttlTimer=null,this.chartId=null,this.aOwner=null};ChartClip.prototype={setDocId:function(t){this.docid=t},setChartId:function(t){this.chartId=t},setActionOwner:function(t){this.aOwner=t},isSameDocument:function(){return this.docid==DOCUMENT_ID&&-1!=this.a},setSheetName:function(t){this.sheetName=t},isSameSheet:function(){return this.isSameDocument()&&this.sheetName==CURRSHEETNAME},resetAction:function(){this.a=-1}},ChartClip.setObjectProperties=function(t){t.isRelatedToDesign?(chartStyleClip=new ChartDesignClip(ActionConstants.CHART_COPY_STYLE),chartStyleClip.setDocId(t.docId),chartStyleClip.setSheeCode(t.asn),chartStyleClip.setChartId(t.chartId),chartStyleClip.setActionOwner(t.aOwner)):(chartClipOperation=new ChartClipOperation(t.a),chartClipOperation.setDocId(t.docId),chartClipOperation.setSheeCode(t.asn),chartClipOperation.setChartId(t.chartId),chartClipOperation.setActionOwner(t.aOwner))},ChartClip.updateResponse=function(t){t.copiedStyle?isUndefined(chartStyleClip)?(chartStyleClip=new ChartDesignClip(ActionConstants.CHART_COPY_STYLE),chartStyleClip.setChartId(t.copiedStyle.sCid),chartStyleClip.setActionOwner(t.copiedStyle.zuid),chartStyleClip.updateResponse(t)):chartStyleClip.updateResponse(t):t.csc&&(isUndefined(chartClipOperation)?(chartClipOperation=new ChartClipOperation(ActionConstants.CHART_COPY_CLIP),chartClipOperation.setChartId(t.csc.sCid),chartClipOperation.setActionOwner(t.csc.zuid),chartClipOperation.updateResponse(t)):chartClipOperation.updateResponse(t))};var ChartDesignClip=function(t){ChartClip.call(this,t),this.init()};ChartDesignClip.prototype=Object.create(ChartClip.prototype),ChartDesignClip.prototype.constructor=ChartDesignClip,ChartDesignClip.prototype.init=function(){this.startTime=null,this.copyStatus=!1,this.pasteStatus=!1,this.currentChartId=null,this.sheetCode=null,this.clearTTL()},ChartDesignClip.prototype.setStatus=function(t){this.copyStatus=-1!=this.a?!0:!1,this.setActionOwner(t.zuid),this.enableOrDisablePasteOption(t.isPasteEnable)},ChartDesignClip.prototype.setCurrentChartId=function(t){this.currentChartId=t},ChartDesignClip.prototype.setSheeCode=function(t){this.sheetCode=t},ChartDesignClip.prototype.enableOrDisablePasteOption=function(t){this.pasteStatus=t,chartPreview.enableOrDisablePasteOption(this.pasteStatus&&this.aOwner==zuid)},ChartDesignClip.prototype.getClipObject=function(){return isUndefined(chartStyleClip)&&(chartStyleClip=new ChartDesignClip(-1)),chartStyleClip},ChartDesignClip.prototype.copyClip=function(){var t=new AjaxRequest,e=new RequestParameters(ActionConstants.CHART_COPY_STYLE);e.setParameters(this.sheetCode,this.chartId),t.init("POST",e.getURL(),!0,e.getParametersAsString()),t.sendRequest()},ChartDesignClip.prototype.pasteClip=function(){if(chartStyleClip.getClipObject().hasClip()){var t=new AjaxRequest,e=new RequestParameters(ActionConstants.CHART_PASTE_STYLE);e.setParameters(WorkSheets.getAssociatedActiveSheetName(),this.currentChartId,this.chartId),t.init("POST",e.getURL(),!0,e.getParametersAsString()),actionManager.addRequest(t)}},ChartDesignClip.prototype.setTTL=function(t){this.ttl=1e3*t,this.startTime=(new Date).getTime(),this.ttl>0&&(this.ttlTimer=setTimeout(function(){chartStyleClip.getClipObject().hasClip()&&chartStyleClip.getClipObject().removeClip()},this.ttl))},ChartDesignClip.prototype.getTTL=function(){var t=this.ttl-((new Date).getTime()-this.startTime);return t>=0?(t/6e4).toFixed(1):-1},ChartDesignClip.prototype.removeClip=function(){-1!=this.a&&(this.resetAction(),this.init(),chartPreview.enableOrDisablePasteOption(this.pasteStatus&&this.aOwner==zuid))},ChartDesignClip.prototype.clearTTL=function(){clearTimeout(this.ttlTimer)},ChartDesignClip.prototype.hasClip=function(){return-1!=this.a},ChartDesignClip.prototype.updateResponse=function(t){var e=t.copiedStyle;e&&(this.setStatus(e),this.setTTL(e.ttl))};var ChartClipOperation=function(t){ChartClip.call(this,t),this.init()};ChartClipOperation.prototype=Object.create(ChartClip.prototype),ChartClipOperation.prototype.constructor=ChartClipOperation,ChartClipOperation.prototype.init=function(){this.cutSatus=!1,this.copyStatus=!1,this.pasteStatus=!1,this.sheetCode=null,this.chartId=null,this.clearTTL()},ChartClipOperation.prototype.setCutStatus=function(t){this.cutSatus=t},ChartClipOperation.prototype.setCopyStatus=function(t){this.copyStatus=t},ChartClipOperation.prototype.setPasteStatus=function(t){this.pasteStatus=t},ChartClipOperation.prototype.setStatus=function(t){-1!=this.a?(t.isSoldCopy?this.setCutStatus(!0):this.setCopyStatus(!0),this.setPasteStatus(!0)):(this.setCopyStatus(!1),this.setCutStatus(!1),this.setPasteStatus(!1)),this.setActionOwner(t.zuid),this.enableOrDisablePasteOption(t.isPasteEnable)},ChartClipOperation.prototype.setSheeCode=function(t){this.sheetCode=t},ChartClipOperation.prototype.enableOrDisablePasteOption=function(t){this.pasteStatus=t,this.cutStatus||this.copyStatus?0!=$("#pasteButton").length&&(menutabListener.doAction(TOOLBAR.HOME,{id:"pasteButton",action:"enable",callback:button_enable,args:["pasteButton"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"pasteButtonDropDown",action:"disable",callback:button_disable,args:["pasteButtonDropDown"]})):menutabListener.doAction(TOOLBAR.HOME,{id:"pasteButton",action:"disable",callback:button_disable,args:["pasteButton"]})},ChartClipOperation.getClipObject=function(){return isUndefined(chartClipOperation)&&(chartClipOperation=new ChartClipOperation(-1)),chartClipOperation},ChartClipOperation.prototype.copyClip=function(){var t={};t.isSoldCopy=this.cutSatus,t.a=ActionConstants.CHART_COPY_CLIP,t.ttl=900,t.aOwner=zuid;var e=ole.getCurrObj().id,i=chartOnLoad.getInstanceByChartId(e),a="ChartTitle";try{a=i.co.options.title.text}catch(t){}var s={chartId:e,extn:"png",fileName:a,height:i.wd,width:i.ht},r=chartPreview.downloadAs(s,!0),n=document.createDocumentFragment();n.appendChild(r);var o=document.getElementById("cpDiv");o.innerHTML="",o.appendChild(n),o.focus();var p=document.getSelection();p.selectAllChildren(o),chartClipOperation.updateResponse(t),chartClipOperation.setSheeCode(WorkSheets.getAssociatedActiveSheetName()),$("#"+chartPreview.getOleLayer()).css("border-style","none"),$($("#"+chartPreview.getOleLayer()).find(".oleresize")).css("display","none");var h=$("#"+chartPreview.getOleLayer()).position();$("#fCROD").css("display","block").css("left",h.left-1+"px").css("z-index",$("#"+chartPreview.getOleLayer()).css("z-index")).css("top",h.top-1+"px").css("height",$("#"+chartPreview.getOleLayer()).height()+2+"px").css("width",$("#"+chartPreview.getOleLayer()).width()+2+"px")},ChartClipOperation.prototype.pasteClip=function(){if(ChartClipOperation.getClipObject().hasClip()&&READ_WRITE)if(chartOnLoad.getInstanceByChartId(this.chartId)){var t,e,i,a,s,r;if(i=isCellRange()?getCellRange().startRow:ActiveCellInfo.getActiveRow(),a=isCellRange()?getCellRange().startCol:ActiveCellInfo.getActiveCol(),t=getRowTop(i),e=getColLeft(a),s=r=0,!this.cutSatus)return void chart.cloneChart(this.chartId,!0,i,a,s,r,t,e);var n=new AjaxRequest,o=new RequestParameters(chartClipOperation.isSameSheet()?ActionConstants.CHART_MOVE:ActionConstants.CHART_MOVE_TO_NEW_SHEET);chartClipOperation.isSameSheet()?(chartOnLoad.clickOpertionOnChartContainer(event,this.chartId),OLE[this.chartId].setLeft(e)._setSelectLayer(!0).positionActionBar(),OLE[this.chartId].setTop(t)._setSelectLayer(!0).positionActionBar(),$("#"+this.chartId).css("top",t+"px").css("left",e+"px"),chartOLEAction.moveChart(this.chartId,e,t,0,0)):(position={},position.top=t,position.left=e,position.sr=i,position.sc=a,o.setParameters(this.sheetCode,this.chartId,WorkSheets.getAssociatedActiveSheetName(),JSON.stringify(position)),n.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(n)),ChartClipOperation.getClipObject().removeClip()}else showAlertDialog(jsMsg["Error.Operation.Not.Permissable"]),ChartClipOperation.getClipObject().removeClip();else if(ProtectedRanges.isSheetLocked(WorkSheets.getAssociatedActiveSheetName()))return void showAlertDialog(jsMsg["Error.Operation.Not.Permissable"])},ChartClipOperation.prototype.setTTL=function(t){this.ttl=1e3*t,this.startTime=(new Date).getTime(),this.ttl>0&&(this.ttlTimer=setTimeout(function(){ChartClipOperation.getClipObject().hasClip()&&ChartClipOperation.getClipObject().removeClip()},this.ttl))},ChartClipOperation.prototype.getTTL=function(){var t=this.ttl-((new Date).getTime()-this.startTime);return t>=0?(t/6e4).toFixed(1):-1},ChartClipOperation.prototype.removeClip=function(){-1!=this.a&&(this.resetAction(),this.init(),this.enableOrDisablePasteOption(this.pasteStatus&&this.aOwner==zuid))},ChartClipOperation.prototype.clearTTL=function(){clearTimeout(this.ttlTimer)},ChartClipOperation.prototype.hasClip=function(){return-1!=this.a},ChartClipOperation.prototype.updateResponse=function(t){var e=t;e&&(this.setStatus(e),this.setTTL(e.ttl))};
var parseInteger=function(r,e){return parseInt(r,e||10)},SheetChartColor=function(r){return this instanceof SheetChartColor?(this.rgba=void 0,this.color=void 0,this.defaultRGBA=void 0,this.depth=void 0,this.generatedColor=void 0,this.lowerLimit=7,this.colorRange=void 0,void this.init(r)):new SheetChartColor(r)};SheetChartColor.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(r){return[parseInteger(r[1]),parseInteger(r[2]),parseInteger(r[3]),parseFloat(r[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(r){return[parseInteger(r[1],16),parseInteger(r[2],16),parseInteger(r[3],16),1]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(r){return[parseInteger(r[1]),parseInteger(r[2]),parseInteger(r[3]),1]}}],names:{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",transparent:"#ffffff",default:"#ffffff"},init:function(r){if("object"==typeof r){var e,t,n,i,s,a=[];for(t=this.parsers.length-1,s=0,i=r.length;i>s;)t=0>t?2:t,n=n=this.parsers[t],e=n.regex.exec(r[s]),e&&(a.push(n.parse(e)),s++),t--;this.colorRange=a||[],this.defaultRGBA=JSON.parse(JSON.stringify(a))||[]}else{var e,o,t,n;for(this.color=r=this.names[r]||r,t=this.parsers.length;t--&&!o;)n=this.parsers[t],e=n.regex.exec(r),e&&(o=n.parse(e));this.rgba=o||[],this.defaultRGBA=JSON.parse(JSON.stringify(o))||[]}},polynomial:function(r){for(var e=arguments.length-1,t=arguments[e];e>1;)t=t*r+arguments[--e];return t},erf:function(r){var e=this.polynomial(Math.abs(r),1,.278393,.230389,972e-6,.078108);return e*=e,e*=e,e=1-1/e,0>r?-e:e},getColorCombination:function(r){var e,t=this.colorRange,n=1/r,i=0,s=[],a=0;this.generatedColor=[];for(var o=0;r>o;o++){for(var h=0;o>0&&h<t.length;h++,a++)e=t[h],s.push(o%2==0?this.getBrighten(e,this.erf(i),a%3):this.getDarken(e,this.erf(i),a%3));0==o&&(s=JSON.parse(JSON.stringify(t)));for(var g=0;g<s.length;g++)this.generatedColor.push(this.getRGB(s[g]));t=JSON.parse(JSON.stringify(this.defaultRGBA)),i=i>.6?.3:i,i+=n,s=[]}return this.generatedColor},getRGB:function(r){return"rgb("+r[0]+","+r[1]+","+r[2]+")"},getColor:function(r){var e,t=this.color,n=this.rgba;return e=n&&n[0]?"rgb"===r||!r&&1===n[3]?"rgb("+n[0]+","+n[1]+","+n[2]+")":"a"===r?n[3]:"rgba("+n.join(",")+")":t},getBrighten:function(r,e,t){for(var t=0;2>=t;t++)r[t]=parseInteger(e*r[t]+255*(1-e)),r[t]<0&&(r[t]=0),r[t]>255&&(r[t]=255);return r},getDarken:function(r,e,t){for(var t=0;2>=t;t++)r[t]=parseInteger(e*r[t]+100*(1-e)),r[t]<0&&(r[t]=0),r[t]>255&&(r[t]=255);return r},isLuminance:function(){var r=this.rgba,e=.2126*r[0]+.7152*r[1]+.0722*r[2];return 40>e?!0:!1},brighten:function(r){var e,t=this.rgba;if(r&&0!==r)for(e=0;3>e;e++)t[e]+=parseInteger(r*(255-t[e])),t[e]<0&&(t[e]=0),t[e]>255&&(t[e]=255);return this},darken:function(r){var e,t=this.rgba;if(r&&0!==r)for(e=0;3>e;e++)t[e]+=parseInteger(r*(150-t[e])),t[e]<0&&(t[e]=0),t[e]>255&&(t[e]=255);return this},setOpacity:function(r){return this.rgba[3]=r,this},getLinerGradient:function(r){var e;return this.setDepth(r),this.brightenNColors(),e=this.getNColorCode(),e=e.slice(0,r),this.generateLinearGradient(e,r)},generateLinearGradient:function(r,e){for(var t="linear-gradient(to right, ",n=e,i=100/n,s=0;n>s;s++)t+=r[s]+" "+Math.round(i*s)+"% ,"+r[s]+" "+Math.round(i*(s+1))+"%, ";return t=t.substring(0,t.lastIndexOf(","))+")"},brightenNColors:function(){var r,e,t=(this.rgba,Math.max(this.depth,this.lowerLimit));for(t+=2,r=0;t>r;r++)e=this.brighten(r/t).getColor(),e&&(this.generatedColor||(this.generatedColor=[]),this.generatedColor.push(e),e=void 0);return this},getNColorCode:function(){return this.generatedColor},setDepth:function(r){return this.depth=r,this}};
var previousChartType="COL",isAggregateOn=!1,aggregateOperation="COUNT",isChartDialogOpened=!1,previousChartThemeName=null,UNPROCESSED={},prevAgg=!1,prevAggOp="COUNT",prevChType="",decTable=null,splitRanges=null,declTableArr=null,aggObject=null,multiAxisCharts=["COL","BAR","XYLINE","XYAREA","COMBOCHART","STEPCHART","SPLINE","COL3D","BAR3D"],recChartProperties={},chart=function(){var e,t,a,a,r,n,o=WorkSheets.getAssociatedActiveSheetName(),s=!1,l=!0,c=(new Array,function(e){for(var t=e.split(";"),a=!1,r=0;r<t.length;r++)if(NamedRange.isNamedRange(t[r]))a=!0;else{if(!isValidRangeGlobal(t[r]))return void showAlertDialog(jsMsg.InvalidRange);a=!0}return a}),d=function(){return s},h=function(){return a},p=function(e){g(e)?$("#appedingWay").show():$("#appedingWay").hide()},g=function(e){e=e.replace(",",";");var t=e.split(";");if(t.length<=1)return!1;for(var a=0;a<t.length;a++)""!==t[a]&&c(t[a],"submit")||(delete t[a],t.length--);return t.length>1?!0:!1},u=function(e,t){for(var e in Chart.container)Chart.container[e]&&Chart.container[e][t]&&delete Chart.container[e][t]},b=function(e,t){for(var e in Chart.container)for(var a=1;Chart.container[e]&&Chart.container[e][t+a];a++)delete Chart.container[e][t+a]},v=function(e,t){for(var e in Chart.container)if(Chart.container[e])for(var a=Object.keys(Chart.container[e]),r=a.length,n=0;r>n;n++)-1!==a[n].indexOf(t)&&Chart.container[e][a[n]]&&delete Chart.container[e][a[n]]},f=function(e,t,a){var r,n=new Array,i=new Array;if(!chartOnLoad.getInstanceByChartId(e)||!chartOnLoad.getInstanceByChartId(e).co)return n[0]={},n[0].yLabel=!0,n;i=chartOnLoad.getInstanceByChartId(e).co.yAxis,r=chartOnLoad.getInstanceByChartId(e).co.options.cellRef;for(var o=chartPreview.getAxisOptions(),s=0;s<i.length;s++){n[s]={};var l=o&&o[s]?o[s].yAxistitle:null;n[s].yLabel=o&&o[s]?o[s].yLabel:!0,n[s].yMin=o&&o[s]?o[s].yMin:null,n[s].yMax=o&&o[s]?o[s].yMax:null,n[s].yInterval=o&&o[s]?o[s].yInterval:null,n[s].plotLines=o&&o[s]?o[s].plotLines:new Array,n[s].majorGridLineWidth=o&&o[s]?o[s].majorGridLineWidth:1,n[s].minorTickInterval=o&&o[s]?o[s].minorTickInterval:null,a&&(l=r["ytitleRange"+s]?r["ytitleRange"+s]:chartPreview.decodeHTMLContent(i[s].userOptions.title.text),n[s].yLabel=i[s].userOptions.labels.enabled,n[s].yMin=i[s].userOptions.min,n[s].yMax=i[s].userOptions.max,n[s].yInterval=i[s].userOptions.tickInterval,n[s].plotLines=i[s].userOptions.plotLines?i[s].userOptions.plotLines:new Array,n[s].majorGridLineWidth=i[s].userOptions.gridLineWidth&&""!=i[s].userOptions.gridLineWidth?i[s].userOptions.gridLineWidth:0,n[s].minorTickInterval=i[s].userOptions.minorTickInterval?i[s].userOptions.minorTickInterval:""),n[s].yAxistitle=l||"",y(n[s])}return n},y=function(e){for(var t=e.plotLines,a=0;a<t.length;a++)delete t[a].events},C=function(n,i){var l,d;if(r="",!s){if(l=getObj("dataRange").value.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";"),!c(l,"submit"))return!1;p(l)}if(-1!==getObj("preview").style.display.indexOf("none")&&!i)return!1;"EDIT"===chartDialogState&&(d=chartOnLoad.getInstanceByChartId(a),d.top=d.top?d.top:parseInt(Math.round(sheet.offsetHeight/2-165+getSheetScrollTop()+20)),d.left=d.left?d.left:parseInt(Math.round(sheet.offsetWidth/2-225+getNormalizedScrollLeft()))),bt(previousChartType),$("#option").enable(),$("#axisOptions11").enable();var h=$("#rows").is(":checked")?"ROWS":"COLS",g=-1!==previousChartType.indexOf("1")?previousChartType.replace(/[0-1]/g,""):previousChartType,u="COLS"===h?$("#frl").is(":checked"):"ROWS"!==h||-1===previousChartType.indexOf("SCATTER")&&-1===previousChartType.indexOf("TIME")&&-1===previousChartType.indexOf("POLAR")&&-1===previousChartType.indexOf("BUBBLE")?$("#frl").is(":checked"):!1,v="ROWS"===h?$("#fcl").is(":checked"):"COLS"!==h||-1===previousChartType.indexOf("SCATTER")&&-1===previousChartType.indexOf("TIME")&&-1===previousChartType.indexOf("POLAR")&&-1===previousChartType.indexOf("BUBBLE")?$("#fcl").is(":checked"):!1,f=parseInt("EDIT"!==chartDialogState?Math.round(sheet.offsetHeight/2-165+getSheetScrollTop()+20):d.top),y=parseInt("EDIT"!==chartDialogState?Math.round(sheet.offsetWidth/2-225+getNormalizedScrollLeft()):d[isRTL?"right":"left"]),C=370,x=600,m=$("#dataLabels").zcombo("getValue"),T=findColInXPos(y),A=findRowInYPos(f),L=y-getColLeft(T),I=f-getRowTop(A),w=E(),P=-1!==$.inArray(g,multiAxisCharts)?$("#multiyaxisYes").is(":checked"):!1,k=chartGlance.isRange(getObj("chartTitle").value)?getObj("chartTitle").value:escape(getObj("chartTitle").value),j=chartGlance.isRange(getObj("chartSubTitle").value)?getObj("chartSubTitle").value:escape(getObj("chartSubTitle").value),_=chartGlance.isRange(getObj("xAxisTitle").value)?getObj("xAxisTitle").value:escape(getObj("xAxisTitle").value),B=(S(),$("#tooltipToggle").is(":checked")),D=$("#zoomToggle").is(":checked")?"xy":"",N=$("#animationToggle").is(":checked"),M=$("#trendlineTypes").zcombo("getValue"),z=ole.getCurrObj()?ole.getCurrObj().id:"preview",H=ha(chartDialogState,h,z),U=pa(z),V=$("#autoExpandToggle").is(":checked"),G=-1===M.indexOf("Average")?parseInt($("#trendlineDegree").zcombo("getValue"))||2:parseInt($("#trendlinePeriod").val())||2,W=-1===M.indexOf("None")?!0:!1,F=getObj("threshold").value;F=F?parseFloat(F).toFixed(2):null;var Y,q=!1,J=$("#glMajor").is(":checked")?1:0,X=$("#glMinor").is(":checked")?"auto":"",K=$("#xAxisLabelToggle").is(":checked"),Z=$("#yAxisLabelToggle").is(":checked"),Q=""===$("#slant").zcombo("getValue")?void 0:parseInt($("#slant").zcombo("getValue")),et=" "===$("#StaggerLines").zcombo("getValue")?void 0:parseInt($("#StaggerLines").zcombo("getValue")),tt=$("#hideCellsToggle").is(":checked"),at="",rt=$("#combineRange").zcombo("getValue"),nt=new Array,it=new Array,ot=[],it=null,z=null;chartPreview.frameAxisOptions(0,"preview"),"EDIT"==chartDialogState?(z=a||ole.getCurrObj().id,d.co.yAxis&&1==d.co.yAxis.length&&1==P&&(z="preview"),it=chart.getAxisOptionsSaved(z,!0,!1)):(z="preview",it=chart.getAxisOptionsSaved("preview",!0,!1)),"COMBOCHART"===previousChartType&&(Y=$("#markerToggle").is(":checked")),-1===previousChartType.indexOf("LINE")&&-1===previousChartType.indexOf("STEP")&&-1===previousChartType.indexOf("AREA")||-1!==previousChartType.indexOf("SCATTER")||(Y=$("#markerToggle").is(":checked"));var st=ActionConstants.CHART_NEW;if(n||!i)st=ActionConstants.CHART_PREVIEW,"COMBOCHART"==g&&"EDIT"!=chartDialogState?(nt.push("COL"),ot=[]):"COMBOCHART"==g&&"EDIT"==chartDialogState&&(chartOnLoad.getInstanceByChartId("preview")&&isUndefined(chartOnLoad.getInstanceByChartId("preview").co.options.comboChartTypes)?nt.push("COL"):isUndefined(chartOnLoad.getInstanceByChartId(z).co.options.comboChartTypes)?nt.push("COL"):nt=Object.values(chartOnLoad.getInstanceByChartId(z).co.options.comboChartTypes)),!chartOnLoad.getInstanceByChartId("preview")||"COMBOCHART"!==chartOnLoad.getInstanceByChartId("preview").type&&"COMBOCHART"==g?ot="EDIT"==chartDialogState?chartOnLoad.getInstanceByChartId(z).co.options.lineStyles:[]:!chartOnLoad.getInstanceByChartId("preview")||isUndefined(chartOnLoad.getInstanceByChartId("preview").co)||isUndefined(chartOnLoad.getInstanceByChartId("preview").co.options.lineStyles)||(ot=chartOnLoad.getInstanceByChartId("preview").co.options.lineStyles);else if("EDIT"===chartDialogState){if(st=ActionConstants.CHART_EDIT,"COMBOCHART"==g&&0==nt.length){var at=ole.getCurrObj()?ole.getCurrObj().id:"preview";isUndefined(chartOnLoad.getInstanceByChartId(at).co.options.comboChartTypes)||(nt=Object.values(chartOnLoad.getInstanceByChartId(at).co.options.comboChartTypes))}chartOnLoad.getInstanceByChartId(at)&&"COMBOCHART"!==chartOnLoad.getInstanceByChartId(at).type&&"COMBOCHART"==g?ot=[]:chartOnLoad.getInstanceByChartId(at)&&!isUndefined(chartOnLoad.getInstanceByChartId(at).co.options.lineStyles)&&(ot=chartOnLoad.getInstanceByChartId(at).co.options.lineStyles);var lt=aa(chartOnLoad.getInstanceByChartId(z).co.options);lt.colorObject.colorTheme=StyleObject.colorObject.colorTheme,StyleObject=lt,at=d.id,C=d.ht,x=d.wd}else"COMBOCHART"==g&&st==ActionConstants.CHART_NEW&&nt.push("COL");var ct=new RequestParameters(st),dt=new AjaxRequest;if(ct.setParameters(o,at,g,l,h,u,v,w,A,T,I,L,y,f,x,C,k,j,_,B,D,N,W,q,J,X,K,Z,P,tt,Q,m,et,rt,Y,M,F,G,V,JSON.stringify(StyleObject),s,e,!1,JSON.stringify(nt),JSON.stringify(it),JSON.stringify(ot),JSON.stringify(H),JSON.stringify(U),!1),dt.init("POST",ct.getURL(),!0,ct.getParametersAsString()),n)dt.addEventListener("onComplete",function(e){var t=parseJSON(e.responseText);if(t){var a=t.chartOptions.co,r=a&&a.co?a.co.cellRef.headerRange:null,n=a&&a.co?a.co.aggregation:null,i=n?n.dateOperations:null,o=a&&a.co?a.co.filter:null;if(a.co){if($("#createChart").enable(),s&&$("#dataRange").disable(),a.grouping&&(a.co=chartGlance.applyGrouping(a.co,a.grouping)),R(a.co.yAxis),n.enabled&&r&&null!==r){var l=r.split(";");chartPreview.setDepthHeaders(l);var c=null!=i?i.split(","):null;chartPreview.setDepthOperations(c)}if(rangeSelectorChart.getDataRangeChanged()){Lt();var l;r&&null!==r&&(l=r.split(";")),$("#aggreoperation").zcombo("setValue",n.type),It(a.seriesIn,a.dataRange,l,i,o),rangeSelectorChart.setDataRangeChanged(!1)}a.co=Ht(t.chartOptions.co,!0,!1),a.co=chartGlance.applyregressionColorIndex(a.co),a.co=chartGlance.applyDataLabels(a.co,$("#dataLabels").zcombo("getValue"),a.currency,a.xAxisSymbol),a.co=chartGlance.advanceDataLabelSetting(a.co),a.co=chartGlance.applySharedLegendInPie(a.co),a.co=chartGlance.advanceChartSettingsInLegend(a.co),a.co=chartGlance.applyTooltip(a.co),a.co=chartGlance.handleChartStyle(a.co,!1,a.gradient),a.co=chartGlance.applyGrouping(a.co,a.grouping),a.co=chartGlance.defaultGroupingSlat(a.co,a.grouping),a.co=a.currency&&"%"!==a.currency&&"TIMELINE"!==a.type?chartGlance.applyTooltip(a.co,a.frl,a.fcl,a.currency):a.co,chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),"preview",a),chartOnLoad.getInstanceByChartId("preview").co&&(StyleObject=aa(chartOnLoad.getInstanceByChartId("preview").co.options))}else Tt(a.reason)}$(".addSubDiv").find("span:first").removeClass("generate"),$(".addSubDiv").attr("disabled",!1)}),dt.sendRequest();else if(i){if((st===ActionConstants.CHART_EDIT||st===ActionConstants.CHART_NEW)&&o!==WorkSheets.getAssociatedActiveSheetName())return b(WorkSheets.getAssociatedActiveSheetName(),"preview"),t=dt,appEvent.on("viewport.afterUpdate",O),void showsheet("sheetdiv-"+o,"open",!1,!1);actionManager.addRequest(dt),StyleObject={},sheetdialog.close()}},O=function(){actionManager.addRequest(t),t="",appEvent.off("viewport.afterUpdate",O),sheetdialog.close()},x=function(){var e=la();null!=e&&e.clearCache(),sa(null)},m=function(){isChartDialogOpened=!1,x(),chartPreview.setPreviewVariable(!0),u(WorkSheets.getAssociatedActiveSheetName(),"preview"),b(WorkSheets.getAssociatedActiveSheetName(),"preview"),"EDIT"===chartDialogState&&!ole.isActive()&&getObj(a)&&(getObj(a).style.border="1px solid "+chartGlance.getRGBA("rgb(222,222,222)",1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(chartOnLoad.getInstanceByChartId(a).co.options.chart.backgroundColor)))),UNPROCESSED={},sheetdialog.close(),resetCellRangeFill("chartDialog"),clearCellRangeFill()},T=function(e){e=""===e?ole.getCurrObj().id:e,appEvent.trigger("chart.revert_publish",[]),$("#chartPubBtn").attr("disabled",!0);var t=new AjaxRequest,a=new RequestParameters(ActionConstants.CHART_PUBLISH);a.setParameters(WorkSheets.getAssociatedActiveSheetName(),e),t.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(t)},A=function(e){e=""===e?ole.getCurrObj().id:e,sheetdialog.close();var t=new AjaxRequest,a=new RequestParameters(ActionConstants.CHART_UNPUBLISH);a.setParameters(WorkSheets.getAssociatedActiveSheetName(),e),t.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(t)},L=function(e){e=""===e?ole.getCurrObj().id:e;var t=chartOnLoad.getInstanceByChartId(e);t&&w(t.pcn)},S=function(){for(var e=$("#xAxis #xplotLineValue"),t=[],a=0;a<e.length;a++)t[a]=$(e[a]).val()&&!isNaN($(e[a]).val())?$(e[a]).val():void 0;return t},I=function(e){var t=[];if(e.xAxis[0].plotLines)for(var a=e.xAxis[0].plotLines,r=0;r<a.length;r++)t[r]=a[r];return t},R=function(e){var t=e.length,a=$("#yaxisMulti");$(a).find("option.RA").remove();for(var r=1;t>r;r++)$("<option/>",{id:"RA"+r,value:"RA"+r,text:jsMsg["Chart.SelectedAxis.RightAxis"]+""+r,class:"RA"}).appendTo(a);$("#yaxisMulti").zcombo("refresh")},w=function(e){$("#chartPubBtn").attr("disabled",!1);var t=getServerPath()+ctxpath+"publicgraphs/"+e,a=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id),r=new RequestParameters(ActionConstants.JSP_CHART_MAKE_PUBLIC);r.setParameters(t,a.ht,a.wd,a.co.options.title.text);var n={autoOpen:!1,width:510,resizable:!1,modal:!0,title:jsMsg.PublishChart};n.title=jsMsg.PublishedChart+" URL";var i=r.getURL()+"?"+r.getParametersAsString();sheetdialog.open("PublishChartDialog",n,void 0,void 0,i)},E=function(e){var t=1;return e||(e=$("#legend").zcombo("getValue")),"Bottom"==e?t=1:"Left"==e?t=4:"Right"==e?t=3:"Top"==e?t=2:"None"==e?t=0:"TopRight"==e&&(t=5),t},P=function(){showTab="",chartDialogState="ADD",chartPreview.setAxisOptions(null),chartPreview.setAxisOptionsIndex(0),chartPreview.setDepthHeaders(null,null),j()},k=function(){showTab="",chartDialogState="PIVOT_ADD",j()},j=function(e,t){isChartDialogOpened=!0,s=!1,StyleObject={},chartPreview.setDepthOperations(null),chartPreview.setCurrentSheetId(WorkSheets.getAssociatedActiveSheetName());var a={width:1020,title:jsMsg.AddChart,close:function(){m()}};if("EDIT"==chartDialogState){var r=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id);s=r.isPivotChart,a.title=s?jsMsg["DialogTitle.EditPivotChart"]:jsMsg.EditChart}"PIVOT_ADD"==chartDialogState&&(a.title=jsMsg["DialogTitle.AddPivotChart"]),sheetdialog.open("chartdialog",a,{init:function(){_(t),xt(),$("#chartSubTitle").focus(function(){var e=this;RangeSelector.on({el:e,single:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){appEvent.trigger("chart.subtitle",[])}})}),$("#chartTitle").focus(function(){var e=this;RangeSelector.on({el:e,single:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){appEvent.trigger("chart.title",[])}})}),$("[id^=yAxisTitle]").focus(function(){var e=this;RangeSelector.on({el:e,single:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){appEvent.trigger("chart.yAxistitle",[])}})}),$("#xAxisTitle").focus(function(){var e=this;RangeSelector.on({el:e,single:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){appEvent.trigger("chart.xAxistitle",[])}})}),$("#dataRange").focus(function(){var e=this;RangeSelector.on({el:e,disableArrowSupport:!1,multiRangeSelection:!0,appendSheetName:!0,callback:function(){appEvent.trigger("chart.callback",[])}})})},set:function(e,t){var a=e.action;appEvent.trigger("chart.zcombo",[a,t]),appEvent.trigger("chart.zspinner",[a,t])},destroy:function(){RangeSelector.off()}})},_=function(){$("#chart li").click(function(){Wt(this,$(this).index())});var t=new ChartAggregation;t.init(),sa(t);{var n,i=$("#rows").is(":checked")?"ROWS":"COLS";"COLS"===i?$("#frl").is(":checked"):"ROWS"!==i||-1===previousChartType.indexOf("SCATTER")&&-1===previousChartType.indexOf("TIME")&&-1===previousChartType.indexOf("POLAR")&&-1===previousChartType.indexOf("BUBBLE")?$("#frl").is(":checked"):!1,"ROWS"===i?$("#fcl").is(":checked"):"COLS"!==i||-1===previousChartType.indexOf("SCATTER")&&-1===previousChartType.indexOf("TIME")&&-1===previousChartType.indexOf("POLAR")&&-1===previousChartType.indexOf("BUBBLE")?$("#fcl").is(":checked"):!1}if("PIVOT_ADD"===chartDialogState?(s=!0,previousChartType="COL1",e=pivotId):(previousChartType="COL",isAggregateOn=!1,aggregateOperation="COUNT",n=getCellRange()),s&&($("#chartGeneral").hide(),$("#chartTypes").show(),$("#chartTypes #cTdR").show(),$(".chartMenu #type").hide(),$("#chartTypes #chartContainer").css("margin-top","10px"),$("#chartTypes #chartContainer .chartTypeCont").css("height","263px")),n=getCellRange(),$("#aggregationDiv").hide(),rangeSelectorChart.setDataRangeChanged(!1),"ADD"===chartDialogState||"PIVOT_ADD"===chartDialogState){var c=document.createElement("div");$(c).attr("class","divTableRow"),$(c).attr("id","recommendChartPreview"),$(c).appendTo("#chartRecommend");var d;if(s)o=WorkSheets.getAssociatedActiveSheetName(),d=new RequestParameters(ActionConstants.PIVOT_CHART_DETAILS),d.setParameters(WorkSheets.getAssociatedActiveSheetName(),void 0,s,e);else{$("#dataRange").val(CellUtils.constructCellName(n.startRow,n.startCol,n.endRow,n.endCol,!1,CURRSHEETNAME)),o=WorkSheets.getAssociatedActiveSheetName(),l=!0;var h=n.startRow,u=n.startCol,b=n.endRow,v=n.endCol;d=new RequestParameters(ActionConstants.CHART_DETAILS),d.setParameters(WorkSheets.getAssociatedActiveSheetName(),h,u,b,v)}var f=new AjaxRequest;f.init("POST",d.getURL(),!0,d.getParametersAsString()),f.addEventListener("onComplete",function(t){new Promise(function(a){var n=parseJSON(t.responseText),i=n.response_array.co&&!n.response_array.co.length?n.response_array.co:n.response_array.co[0],o=i.co;if(null===o&&n.response_array.co&&i.reason&&i.reason.ice){Lt();var l=i.reason.dataRange,c=i.reason.seriesIn;return getObj("columns").checked=!0,It(c,l,null,null,null),Tt(i.reason),!1}r=previousChartType=i.type;var d;if(s){previousChartType="COL";var h=pivot.Collection.get(e).attributes,g=h.asn,u=WorkSheets.getSheetNameFromCode(g),b=getCellLabel(h.sr,h.sc)+":"+getCellLabel(h.er,h.ec);$("#pivotdataRange").val(u+"."+b),getObj("xAxisTitle").value=o.xAxis.title.text?o.xAxis.title.text:"",getObj("yAxisTitle").value=o.yAxis[0].title.text?o.yAxis[0].title.text:"",$("#rangeInpSpan").hide(),$("#autoExpand").hide(),$("#hiddenCells").hide(),$("#setOfScatterChart").hide(),$("#setOfBubbleChart").hide(),$("#setOfStockChart").hide(),$("#setOfTimeSeriesChart").hide(),getObj(previousChartType).className="chartSubTypeSel"}else $("#dataRange").val(i.dataRange),p(i.dataRange),$("#dataRange").attr("title",getObj("dataRange").value),$("#rangeInpSpan").show(),$("#autoExpand").show(),$("#hiddenCells").show();"COMBOCHART"==i.type&&(i.isSingleYaxis=!0,i.co.yAxis.push(JSON.parse(JSON.stringify(i.co.yAxis[0]))),i.co.yAxis[1].opposite=!0,i.co.series[1].yAxis=1,R(i.co.yAxis)),$("#dataLabels").zcombo("setValue",i.lf?i.lf:"N");{var v=document.getElementById("chartThemePallate");v.dataset.name,v.dataset.basecolor,v.dataset.reversed}if(At(o),o=chartGlance.applyregressionColorIndex(o),o=chartGlance.applyDataLabels(o,i.lf?i.lf:"N",i.currency,i.xAxisSymbol),o=chartGlance.advanceDataLabelSetting(o),o=chartGlance.applySharedLegendInPie(o),o=chartGlance.advanceChartSettingsInLegend(o),o=chartGlance.applyTooltip(o,i.frl,i.fcl,i.currency),o=chartGlance.handleChartStyle(o,!1,i.gradient),o=chartGlance.applyGrouping(o,n.response_array.co.grouping),o=ut(o,!0),i.co=Ht(i,!1,!1),d=i.co.plotOptions.series.marker.enabled,getObj("xAxisTitle").value=i.co.cellRef.xtitleRange?i.co.cellRef.xtitleRange.split(":")[0]:i.co.xAxis.title.text?i.co.xAxis.title.text:"",getObj("yAxisTitle").value=i.co.cellRef.ytitleRange?i.co.cellRef.ytitleRange.split(":")[0]:i.co.yAxis[0].title.text?i.co.yAxis[0].title.text:"",i.co.yAxis&&i.co.yAxis.length>1)for(var f=1;f<i.co.yAxis.length;f++)getObj("yAxisTitle"+f)&&(getObj("yAxisTitle"+f).value=i.co.cellRef["yRightTitle"+f]?i.co.cellRef["yRightTitle"+f].split(":")[0]:i.co.yAxis[f].title.text?i.co.yAxis[f].title.text:"");getObj("chartTitle").value=i.co.cellRef.titleRange?i.co.cellRef.titleRange.split(":")[0]:i.co.title.text?i.co.title.text:"",getObj("chartSubTitle").value=i.co.cellRef.subtitleRange?i.co.cellRef.subtitleRange.split(":")[0]:i.co.subtitle.text?i.co.subtitle.text:"",mt(n),Bt();var y=i.lf?i.lf:"N";$("#dataLabels").zcombo("setValue",y),$("#lineMarkers").hide(),$("#multiAxis").hide(),$("#threshold").attr("disabled","disabled"),$("#thresholdD").disable(),$("#isMultiYAxis").hide(),$("#RA").hide(),$("#tltypes").show(),$("#legend").zcombo("setValue",Mt("undefined"!=typeof i.legendPos?i.legendPos:3)),$("#trendlineTypes").zcombo("setValue","None"),Dt(previousChartType),Nt(i.type,i.isSingleYaxis||!1),chartPreview.enableDisableFilterColumns(!0),isAggregateOn=i.aggregation.enabled,i.aggregation.enabled&&B(isAggregateOn,"ADD",i),d||$("#markerToggle").prop("checked",!1),chartOnLoad.getInstanceByChartId("preview")&&-1===chartDialogState.indexOf("PIVOT")&&setTimeout(function(){a(t)},100)}).then(function(e){var t=parseJSON(e.responseText).response_array.co;return t&&(!t.length||t.length<=1)?(M(),void $("#rchart").hide()):($("#recommendChartPreview").empty(),t.shift(),void st(t,1))})}),f.sendRequest(),appEvent.trigger("chart.change",[])}else if("EDIT"===chartDialogState){o=WorkSheets.getAssociatedActiveSheetName();var y=ole.currObj.id;a=ole.getCurrObj().id,$t(y);{new Promise(function(t){if(l){var a=new RequestParameters(ActionConstants.CHART_PREVIEW),n=new AjaxRequest;if(a.setParameters(WorkSheets.getAssociatedActiveSheetName(),y,null,chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).dataRange),n.init("POST",a.getURL(),!0,a.getParametersAsString()),n.addEventListener("onComplete",function(t){var a=parseJSON(t.responseText);if(a){var n=a.chartOptions.co;decTable=n.co.decTable,previousChartType=n.type,getObj("xAxisTitle").value=n.co.cellRef.xtitleRange?n.co.cellRef.xtitleRange.split(":")[0]:n.co.xAxis.title.text?n.co.xAxis.title.text:"",getObj("chartTitle").value=n.co.cellRef.titleRange?n.co.cellRef.titleRange.split(":")[0]:n.co.title.text?n.co.title.text:"",getObj("chartSubTitle").value=n.co.cellRef.subtitleRange?n.co.cellRef.subtitleRange.split(":")[0]:n.co.subtitle.text?n.co.subtitle.text:"";{n.co.xAxis.labels.enabled?$("#xAxisLabelToggle").prop("checked",!0):$("#xAxisLabelToggle").prop("checked",!1),n.co.yAxis[0].labels.enabled?$("#yAxisLabelToggle").prop("checked",!0):$("#yAxisLabelToggle").prop("checked",!1),n.co.plotOptions.series.animation?$("#animationToggle").prop("checked",!0):$("#animationToggle").prop("checked",!1)}if(n.isSingleYaxis){if(-1!==$.inArray(previousChartType,multiAxisCharts)){{n.isSingleYaxis?$("#multiyaxisYes").prop("checked",!0):$("#multiyaxisYes").prop("checked",!1)}if($("#multiyaxisYes").is(":checked")){$("#multiAxis").show();for(var i=0;i<n.co.yAxis.length;i++)chartPreview.assignValues(i,n.co,!1)}else $("#multiAxis").hide()}}else chartPreview.assignValues(0,n.co,!1);if(-1!==$.inArray(chartOnLoad.getInstanceByChartId(y.trim()).type,multiAxisCharts)&&n.co.yAxis[1]){n.co.yAxis[1].labels.enabled?$("#yaxisLabYes1").prop("checked",!0):$("#yaxisLabYes1").prop("checked",!1)}var o=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id);if(r=o.type,s=n.isPivotChart){e=n.pivotId;var l=pivot.Collection.get(e).attributes,c=l.asn,d=WorkSheets.getSheetNameFromCode(c),h=getCellLabel(l.sr,l.sc)+":"+getCellLabel(l.er,l.ec);$("#pivotdataRange").val(d+"."+h),$("#rangeInpSpan").hide()}else getObj("dataRange").value=a.chartOptions.co.dataRange,$("#dataRange").attr("title",getObj("dataRange").value),g(a.chartOptions.co.dataRange)?$("#appedingWay").show():$("#appedingWay").hide(),$("#rangeInpSpan").show(),e=void 0;noOfAxis=a.chartOptions.co.co.yAxis.length;var p=$("#yaxisMulti");$(p).find("option.RA").remove();for(var i=1;noOfAxis>i;i++)$("<option/>",{id:"RA"+i,value:"RA"+i,text:jsMsg["Chart.SelectedAxis.RightAxis"]+""+i,class:"RA"}).appendTo(p);chartPreview.setAxisOptionsIndex(0),n.co=chartGlance.applyTooltip(n.co);var u=(n.co.xAxis.labels.enabled?$("#xAxisLabelToggle").prop("checked",!0):$("#xAxisLabelToggle").prop("checked",!1),n.co.yAxis[0].labels.enabled?$("#yAxisLabelToggle").prop("checked",!0):$("#yAxisLabelToggle").prop("checked",!1),n.co.plotOptions.series.animation?$("#animationToggle").prop("checked",!0):$("#animationToggle").prop("checked",!1),chartOnLoad.getInstanceByChartId(y.trim()).ae?$("#autoExpandToggle").prop("checked",!0):$("#autoExpandToggle").prop("checked",!1),$("#trendlineTypes").zcombo("getValue")),o=(-1===u.indexOf("None")?!0:!1,chartOnLoad.getInstanceByChartId(ole.getCurrObj().id));if($.inArray(n.type,multiAxisCharts)>=0){$("#thresholdD").enable(),$("#threshold").removeAttr("disabled");var b=n.co.plotOptions.series.threshold;getObj("threshold").value=void 0===b||""===b?"":+parseFloat(b).toFixed(2)}else $("#threshold").attr("disabled","disabled"),$("#thresholdD").disable();-1!==o.seriesIn.indexOf("COLS")&&(n.co=chartGlance.applyGrouping(n.co,o.grouping));{n.co.tooltip.enabled?$("#tooltipToggle").prop("checked",!0):$("#tooltipToggle").prop("checked",!1),"xy"===n.co.chart.zoomType?$("#zoomToggle").prop("checked",!0):$("#zoomToggle").prop("checked",!1)}n.co=chartGlance.applyDataLabels(n.co,o.lf,o.currency,o.xAxisSymbol,void 0,void 0,o.zAxisSymbol,o.secYAxisSymbol,o.type,o.isSingleYaxis),n.co=chartGlance.applySharedLegendInPie(n.co),n.co=chartGlance.advanceDataLabelSetting(n.co),n.co=chartGlance.advanceChartSettingsInLegend(n.co),n.co=chartGlance.applyregressionColorIndex(n.co),n.co=chartGlance.handleChartStyle(n.co,!1,n.gradient),n.co=ut(n.co,!0),n.co=n.currency&&"%"!==n.currency?chartGlance.applyTooltip(n.co,n.frl,n.fcl,n.currency):n.co,n.co.series.length>100?(n.co.legend.enabled=!1,$("#legendArea").disable()):$("#legendArea").enable(),previousChartType=n.type,n.co.chart.renderTo="preview",chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),"preview",n),chartOnLoad.getInstanceByChartId("preview").co&&chartOnLoad.getInstanceByChartId("preview").co.options&&(StyleObject=aa(chartOnLoad.getInstanceByChartId("preview").co.options)),s||B(n.aggregation.enabled,"EDIT",n),Nt(n.type,n.isSingleYaxis||!1),appEvent.trigger("chart.change",[])}}),n.sendRequest(),chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).dataRange&&-1===chartDialogState.indexOf("PIVOT"))var i=setInterval(function(){chartOnLoad.getInstanceByChartId("preview")&&(clearInterval(i),t())},100)}}).then(function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).dataRange;if(e&&-1===chartDialogState.indexOf("PIVOT")){var t=document.createElement("div");$(t).attr("class","divTableRow"),$(t).attr("id","recommendChartPreview"),$(t).appendTo("#chartRecommend"),$("#recommendChartPreview").empty(),chartPreview.doRecommendationChart(!1)}})}}"EDIT"==chartDialogState&&Wt(s?getObj("type"):getObj("general")),Xt=getObj("chartAlert")},B=function(e,t,a){if("ADD"===t){var r=a.co&&a.co.cellRef?a.co.cellRef.headerRange:null,n=a&&a.aggregation?a.aggregation.dateOperations:null,i=a&&a.aggregation?a.aggregation.colheaders:null,o=a&&a.aggregation?a.aggregation.rowheaders:null,s=i||o,l=null!=s?s.split(";"):null;if(e){$("#aggreoperation").zcombo("setValue",a.aggregation.type),$("#aggreoperations").show();var c=chartOnLoad.getInstanceByChartId("preview");It(c.seriesIn,c.dataRange,l,null),$("#aggregation").text(da())}else It(a.seriesIn,a.dataRange,null,null),$("#aggregation").text(da()),$("#aggreoperations").hide(),$("#depthD").hide()}else if("EDIT"==t){var r=a.co&&a.co.options.cellRef?a.co.options.cellRef.headerRange:null,n=a.co&&a.co.options.aggregation?a.co.options.aggregation.dateOperations:null,d=a.co&&a.co.options.filter?a.co.options.filter:null;if(Lt(),e){if($("#aggreoperations").show(),$("#aggreoperation").zcombo("setValue",a.aggregation.type),$("#aggreoperation").zcombo("refresh"),r&&null!==r){var l=r.split(";");chartPreview.setDepthHeaders(l),It(a.seriesIn,a.dataRange,l,n,d)}}else It(a.seriesIn,a.dataRange,null,null,d),$("#aggregation").text(da())}},D=function(e){var t;switch(e){case"COL":t=jsMsg["Chart.Type.Column"];break;case"BAR":t=jsMsg.Bar;break;case"STACKEDCOL":t=jsMsg.StackedColumn;break;case"STACKEDBAR":t=jsMsg.StackedBar;break;case"XYSTACKEDAREA":t=jsMsg.StackedArea;break;case"XYLINE":t=jsMsg.Line;break;case"SCATTER":t=jsMsg.Scatter;break;case"BUBBLE":t=jsMsg.Bubble;break;case"PIE":t=jsMsg.Pie;break;case"COMBOCHART":t=jsMsg["Chart.Type.Combo"];break;default:t=e}return t},N=function(e){var t;switch(e){case"column":t="COL";break;case"stackedcol":t="STACKEDCOL";break;case"stackedcolpercent":t="STACKEDCOL_PERCENT";break;case"bar":t="BAR";break;case"stackedbar":t="STACKEDBAR";break;case"stackedbarpercent":t="STACKEDBAR_PERCENT";break;case"stackedcolumn":t="STACKEDCOL";break;case"stackedarea":t="XYSTACKEDAREA";break;case"line":t="XYLINE";break;case"scatter":t="SCATTER";break;case"bubble":t="BUBBLE";break;case"pie":t="PIE";break;case"area":t="XYAREA";break;case"spline":t="SPLINE";break;case"doughnut":t="DOUGHNUT";break;case"semidoughnut":t="SEMIDOUGHNUT";break;case"stackedxyarea":t="XYSTACKEDAREA";break;case"stepline":t="STEPCHART";break;default:t=e}return t},M=function(){$("#chartRecAlert1").css("display","block")},z=function(e,t,a,r,n){var i=new Array,o=H(t,e);G(t,o,i,e,a,r,n)},H=function(e,t){var a=[],r=[],n=$("#combineRange").zcombo("getValue"),i=-1!==e.indexOf(",")?",":";";if(i?a=e.split(i):a.push(e),a.length>1)if("COLS"==t&&"VERTICAL"==n||"ROWS"==t&&"HORIZONTAL"==n)r.push(getDataFrom2DRangeText(a[0]));else for(var o=0;o<a.length;o++)r.push(getDataFrom2DRangeText(a[o]));else r.push(getDataFrom2DRangeText(a[0]));return r},U=function(e,t){return 0==$(".aggHldr").length?(depthDragDrop.addNewDepthHeader(0),depthDragDrop.addNewDepthHeader(1),depthDragDrop.addNewDepthHeader(2)):(label="COLS"==e?$("#frl").is(":checked"):$("#fcl").is(":checked"),depthDragDrop.refreshAllCombos(null,!1,label)),t},V=function(e,t){var a="",r=$("#combineRange").zcombo("getValue"),n=";";return n?ranges=t.split(n):ranges.push(t),a="COLS"==e&&"VERTICAL"==r||"ROWS"==e&&"HORIZONTAL"==r?ranges[0]:t},G=function(e,t,a,r,n,i,s){var l=new RequestParameters(ActionConstants.FETCH_DECLARATIVE_TABLE),r=$("#rows").is(":checked")?"ROWS":"COLS",c="COLS"==r?!0:!1;e=e?e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";"):null;var d=V(r,e),h=new AjaxRequest;l.setParameters(o,d,c),h.init("POST",l.getURL(),!0,l.getParametersAsString()),h.addEventListener("onComplete",function(e){var o=parseJSON(e.response);declTableArr=o.decTable?o.decTable:null;var l=la();a=l.processAggregation(r,declTableArr,t,a),$("#aggregationTemplate").empty(),(null==n||0==n.length)&&(a=U(r,a)),null!=n&&(n=tt(n,t)),W(s),Rt(n,i),$("#aggregation").text(da())}),h.sendRequest()},W=function(e){K(),isUndefined(e)||null==e?(J(),Y()):($("#filterType").zcombo("setValue",e.type),$("#filterSpinner").zspinner("setValue",e.limit),e.limitByName?$("#filterColumns").zcombo("setValue",e.limitByName):$("#filterColumns").zcombo("setSelectedIndex",1))},F=function(){},Y=function(){$("#filterSpinner").zspinner("disable"),$("#filterColumns").zcombo("disable")},q=function(){$("#filterSpinner").zspinner("enable"),$("#filterColumns").zcombo("enable")},J=function(){$("#filterType").zcombo("setValue","NONE"),$("#filterSpinner").val(0),$("#filterColumns").zcombo("setValue","NONE")},X=function(){$("#filterSpinner").zspinner("setValue",0),$("#filterColumns").zcombo("setSelectedIndex",0)},K=function(e){Q();var t=et(e);if(null!=t&&t.length>0){for(var a=$("#filterColumns"),r=0;r<t.length;r++){var n=t[r].headerName||t[r].headerLabel,i=(t[r].headerRange,Z());-1==$.inArray(n,i)&&$("<option/>",{id:"filter_"+n,value:n,text:n}).appendTo(a)}chartPreview.enableDisableFilterColumns(!1,0==$("#filterColumns option").length)}else chartPreview.enableDisableFilterColumns(!0);$("#filterColumns").zcombo("refresh")},Z=function(){var e=chartPreview.getDepthHeaders(),t=[];if(e)for(var a=0;a<e.length;a++)t.push(Et(e[a]));return t},Q=function(){$("[id^='filter_']").remove()},et=function(){var e=[],t=chartPreview.getDepthIndices()[1];if(!isUndefined(t))for(var a=0;a<t.length;a++)for(var r=t[a],n=Object.keys(r),i=0;i<n.length;i++)if("NUMBER"==r[n[i]].type||"DECIMAL"==r[n[i]].type||"CURRENCY"==r[n[i]].type||"PERCENTAGE"==r[n[i]].type){var o={};o.headerName=r[n[i]].headerValue,o.headerLabel=r[n[i]].headerLabel,o.headerRange=r[n[i]].headerRange,e.push(o)}return e},tt=function(e,t){for(var a=0;a<e.length;){for(var r=CellUtils.getRangeFromCellLbl(e[a]),n=new Range(r.startRow,r.startCol,r.endRow,r.endCol),i=!1,o=0;o<t.length;o++){var s=new Range(t[o].sR,t[o].sC,t[o].eR,t[o].eC);if(s.subset(n)){i=!0;break}}i?a++:e.splice(a,1)}return e},at=function(e,t,a,i,s,c,d){var h,p=new RequestParameters(ActionConstants.GET_CHART_RECOMMENDATION),g=new AjaxRequest;p.setParameters(o,e,t,a,i,s,c,!1,!1),g.init("POST",p.getURL(),!0,p.getParametersAsString()),g.addEventListener("onComplete",function(e){var t=parseJSON(e.responseText).response_array.co;return $("#recommendChartPreview").empty(),t&&(!t.length||t.length<=1)?void M():(h&&h.reject(),void(h=new Promise(function(e){var a=t.shift();d&&((""!==previousChartType||a.type!==previousChartType)&&($("#"+previousChartType).removeClass("chartSubTypeSel"),$("#"+previousChartType).addClass("chartSubType")),r=previousChartType=a.type,Dt(previousChartType),l&&("COMBOCHART"==a.type&&(a.isSingleYaxis=!0,a.co.yAxis.push(JSON.parse(JSON.stringify(a.co.yAxis[0]))),a.co.yAxis[1].opposite=!0,a.co.series[1].yAxis=1,R(a.co.yAxis)),Nt(a.type,a.isSingleYaxis||!1),a.co=Ht(a,!1,!0),a.co.chart.renderTo="preview",a.co=chartGlance.applyregressionColorIndex(a.co),a.co=chartGlance.applyDataLabels(a.co,$("#dataLabels").zcombo("getValue"),a.currency,a.xAxisSymbol),a.co=chartGlance.advanceDataLabelSetting(a.co),a.co=chartGlance.applySharedLegendInPie(a.co),a.co=chartGlance.advanceChartSettingsInLegend(a.co),a.co=chartGlance.applyTooltip(a.co),a.co=chartGlance.handleChartStyle(a.co,!1,a.gradient),a.co=chartGlance.applyGrouping(a.co,a.grouping,!1,!0),a.co=chartGlance.defaultGroupingSlat(a.co,a.grouping,!1),a.co=chartGlance.applyChartSpacing(a.co,10,10,10,10),a.co=a.currency&&"%"!==a.currency&&"TIMELINE"!==a.type?chartGlance.applyTooltip(a.co,a.frl,a.fcl,a.currency):a.co,a.co=ut(a.co,!0),chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),"preview",a))),ht=!1,$("#chartRecAlert1").css("display","none"),l&&chartOnLoad.getInstanceByChartId("preview")&&-1===chartDialogState.indexOf("PIVOT")?setTimeout(function(){e()},100):l||-1!==chartDialogState.indexOf("PIVOT")||setTimeout(function(){e()},100)}).then(function(){$("#chartGeneral").is(":visible")?(st(t,1),n="preview1",bt(previousChartType)):rt("renderRecommendation",ot,t,{startIndex:1})})))}),g.sendRequest()},rt=function(e,t,a,r){UNPROCESSED[e]||(UNPROCESSED[e]=[]);var n={};n.fn=t,n.parameters=a,n.optional=r,UNPROCESSED[e].push(n)},nt=function(e){var t,a=UNPROCESSED[e];if(a)for(var r in a){t=a[r];var n=t.parameters,i=t.optional;try{t.fn(n,i)}catch(e){}}delete UNPROCESSED[e]},it=function(e){-1!==e.indexOf("renderRecommendation")&&"EDIT"===chartDialogState&&nt(e)},ot=function(e,t){var a=e,r=1|t.startIndex;st(a,r),n="preview1",bt(previousChartType)},st=function(e,t){var a=e.shift();a&&a.co?(a=lt(a),dt(a,t).then(function(){st(e,++t)})):!a&&$("#recommendChartPreview")&&$("#recommendChartPreview").children().size()>=t&&$($("#recommendChartPreview").children().splice(--t)).remove()},lt=function(e){var t=Math.min(10,e.co.series.length);e.co.series=e.co.series.splice(0,t);for(var a=0;t>a;a++){var r=Math.min(50,e.co.series[a].data.length);e.co.series[a].data=e.co.series[a].data.splice(0,r)}return e.co.xAxis.categories=null,e},ct=function(){chartPreview.frameAxisOptions(chartPreview.getAxisOptionsIndex()),chart.createChart(!1,!1)},dt=function(e,t){return new Promise(function(a){var r,i,o,s=e;i="preview"+t,o=s.type;var l=e.co.title.text,c={};c.title=l,recChartProperties[i]=c,e.co.title.text="",r=document.createElement("div");var d=document.createElement("div"),h=document.createElement("div");1==t?(n=i,ht=!0):ht=!1;{var p=document.getElementById("chartThemePallate");p.dataset.name,p.dataset.basecolor,p.dataset.reversed}h.className="recChartName",h.id="tooltip"+t,h.innerHTML=D(o),d.className="recWrapper",$(r).attr("class","divTableRow"),$(r).attr("id",i),r.className="recChartDiv",ht&&$(d).css("border-color","rgb(25, 175, 92)"),$(r).appendTo($(d)),$(h).appendTo($(d)),$(d).appendTo("#recommendChartPreview");var g=s.lf?s.lf:"N";"COMBOCHART"==s.type&&(s.isSingleYaxis=!0,s.co.yAxis.push(JSON.parse(JSON.stringify(s.co.yAxis[0]))),s.co.yAxis[1].opposite=!0,s.co.series[1]&&(s.co.series[1].yAxis=1)),s.co=Ht(s,!1),s.co.chart.renderTo=i,s.co.legend.enabled=!1,s.co=chartGlance.applyregressionColorIndex(s.co),s.co=chartGlance.applyDataLabels(s.co,g,s.currency,s.xAxisSymbol),s.co=chartGlance.advanceDataLabelSetting(s.co),s.co=chartGlance.applySharedLegendInPie(s.co),s.co=chartGlance.advanceChartSettingsInLegend(s.co),s.co=chartGlance.applyTooltip(s.co),s.co=chartGlance.handleChartStyle(s.co,!1,s.gradient),s.co=chartGlance.applyGrouping(s.co,s.grouping,!1,!0),s.co=chartGlance.defaultGroupingSlat(s.co,s.grouping,!1),s.co=s.currency&&"%"!==s.currency&&"TIMELINE"!==s.type?chartGlance.applyTooltip(s.co,s.frl,s.fcl,s.currency):s.co,s.co=ut(s.co,!1),chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),i,s),Ct(i),Ot(h.id,i),chartOnLoad.getInstanceByChartId(i)&&setTimeout(function(){a()},10)})},ht=!1,pt=!1,gt=function(e){return e},ut=function(e,t){if(t)e.title.text=gt(e.title.text,"chartTitle",41);else{if(e.title.style.fontSize="10px",e.title.text=gt(e.title.text,"chartTitle"),e.tooltip.enabled=!1,e.plotOptions.series.animation=!1,e.plotOptions.series.dataLabels&&(e.plotOptions.series.dataLabels.enabled=!1),e.xAxis&&e.xAxis.labels&&(e.xAxis.lineWidth=0,e.xAxis.tickLength=0,e.xAxis.labels.enabled=!1,e.chart.zoomType="none"),e.yAxis&&e.yAxis[0].labels)for(var a=0;a<e.yAxis.length;a++)e.yAxis[a].labels.enabled=!1;e.plotOptions.series.allowPointSelect=!1}return e},bt=function(e){if($("#"+n).parent().css("border-color","#d4d4d4"),pt=!0,previousChartType&&chartOnLoad.getInstanceByChartId(n)){e=e.replace(/[0-9]/g,"");var t=$("#dataRange").val(),a=chartOnLoad.getInstanceByChartId(n).dataRange,r=chartOnLoad.getInstanceByChartId(n).type,i=chartOnLoad.getInstanceByChartId(n).aggregation.enabled,o=chartOnLoad.getInstanceByChartId(n).aggregation.type,s=chartOnLoad.getInstanceByChartId(n).isSingleYaxis||!1,l=(chartOnLoad.getInstanceByChartId(n).type,$("#multiyaxisYes").is(":checked"));r=-1!==r.indexOf("BUBBLE")?"BUBBLECHART":r,e==r&&t==a&&isAggregateOn===i&&o===aggregateOperation?-1!==r.indexOf("COMBOCHART")?s==l&&($("#"+n).parent().css("border-color","#01975B"),pt=!1):($("#"+n).parent().css("border-color","#01975B"),pt=!1):($("#"+n).parent().css("border-color","#d4d4d4"),pt=!0)}},vt=function(e){{var t=chartPreview.getHCInstance(e),a=chartOnLoad.getInstanceByChartId(e),r=a.dataRange,i=(chartOnLoad.getInstanceByChartId("preview")?!0:!1,chartOnLoad.getInstanceByChartId("preview")?chartOnLoad.getInstanceByChartId("preview").dataRange:""),o=chartOnLoad.getInstance(e).aggregation.enabled,s=chartOnLoad.getInstance(e).aggregation.type,l=(t.userOptions,chartOnLoad.getInstance(e).type);chartOnLoad.getInstance(e).co.options.cellRef.headerRange}if(previousChartType===l&&i===r&&s===aggregateOperation&&o===isAggregateOn)return $("#"+e).parent().css("border-color","#01975B"),void(n=e);if(""!==previousChartType&&($("#"+previousChartType).removeClass("chartSubTypeSel"),$("#"+previousChartType).addClass("chartSubType")),pt=!1,$("#"+n).parent().css("border-color","#d4d4d4"),$("#"+e).parent().css("border-color","#01975B"),n=e,previousChartType=-1===l.indexOf("BUBBLE")?l:"BUBBLECHART",o||(o=!1),o){$("#aggregation").text(da());{a.co.options.aggregation}r!==i?(rangeSelectorChart.setDataRangeChanged(!0),ft(a,!0)):ft(a,!1)}else $("#aggregation").text(jsMsg.None),chartPreview.resetAggregation();getObj("dataRange").value!==a.dataRange&&rangeSelectorChart.setDataRangeChanged(!0),$("#aggreoperation").zcombo("setValue",s),$("#aggreoperation").zcombo("refresh"),isAggregateOn=o,aggregateOperation=s,Bt(),$("#dataRange").val(a.dataRange),$("#chartTitle").val(recChartProperties[e].title),Dt(previousChartType),Nt(a.type,a.isSingleYaxis),g($("#dataRange").val())?($("#appedingWay").show(),$("#combineRange").zcombo("setValue",a.cR)):$("#appedingWay").hide(),getObj("fcl").checked=a.fcl,getObj("frl").checked=a.frl;var c=a.seriesIn;"COLS"==c?getObj("columns").checked=!0:getObj("rows").checked=!0,C(!0)},ft=function(e,t){var a=e.aggregation,r=(e.co.options.cellRef,e.aggregation.colheaders||e.aggregation.rowheaders),n=r?r.split(";"):null,i=a.dateOperations;if(a.enabled){var o=a.type;if($("#aggreoperation").zcombo("setValue",o),null!=n)if(t){var s=null!=i?i.split(","):null;chartPreview.setDepthOperations(s),chartPreview.setDepthHeaders(n)}else Rt(n,a.dateOperations)}},yt=function(e){e=e?e:ole.getCurrObj().id;var t=chartOnLoad.getInstanceByChartId(e),a="ChartTitle";try{a=t.co.options.title.text}catch(e){}var r={chartId:e,extn:"png",fileName:chartPreview.decodeHTMLContent(a),height:t.wd,width:t.ht};chartPreview.downloadAs(r)},Ct=function(e){$("#"+e+" .highcharts-container").on("click",function(){vt(e)})},Ot=function(e,t){$("#"+e).on("click",function(){vt(t)})},xt=function(){var e=sheetdialog.getOpenedDialog();l||(getObj("preview").style.display="none",e.css({width:486})),$("#dateFilters").on("menuitemclicked",function(e,t){var a=$(t.menuitem),r=$(t.currentTarget);depthDragDrop.changeDateOperations(a,r)})},mt=function(e){var t=e.response_array,a=t.co&&!t.co.length?t.co:t.co[0];if(t.co){getObj("frl").checked=t.frl||a.frl,getObj("fcl").checked=t.fcl||a.fcl,$("#fcl").is(":disabled")&&(getObj("fcl").checked=!0),$("#frl").is(":disabled")&&(getObj("frl").checked=!0),t.title&&(getObj("chartTitle").value=t.title);var r=t.si||a.seriesIn;"COLS"===r.toUpperCase()?getObj("columns").checked=!0:getObj("rows").checked=!0,chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),"preview",a),chartOnLoad.getInstanceByChartId("preview").co&&chartOnLoad.getInstanceByChartId("preview").co.options&&(StyleObject=aa(chartOnLoad.getInstanceByChartId("preview").co.options))}else Tt(t.co.reason)},Tt=function(e){$("#createChart").disable(),$("#option").disable(),$("#axisOptions11").disable();var t="";if(e.ice)t=replaceParams(jsMsg["Chart.Cells.Count.Exceeded"],new Array("3000"));else if(!e.iad){var a="BUBBLECHART"===e.type?2:4,r=jsMsg.Bubble;-1!==e.type.indexOf("CANDLESTICK")?r=jsMsg.CandleStick:-1!==e.type.indexOf("OHLC")?r=jsMsg.OHLC:-1!==e.type.indexOf("SCATTER")?r=jsMsg.Scatter:-1!==e.type.indexOf("BUBBLECHART")?r=jsMsg.Bubble:-1!==e.type.indexOf("TIMELINE")?r=jsMsg["Chart.Time.Line"]:-1!==e.type.indexOf("TIMEAREA")?r=jsMsg["Chart.Time.Area"]:-1!==e.type.indexOf("WATERFALL")?r=jsMsg["Chart.Type.Waterfall"]:-1!==e.type.indexOf("COMBOCHART")&&(r=jsMsg["Chart.Type.Combo"]),t=e.isPivotChart?replaceParams(jsMsg["PivotChart.Not.Allowed"],new Array(r)):replaceParams(jsMsg["Chart.Preview.Not.Allowed"],new Array(r,a))}getObj("preview").innerHTML="",getObj("preview").hasChildNodes()&&getObj("preview").removeChild(Xt),getObj("preview").appendChild(Xt),$("#chartAlert").show(),Xt.style.display="",Xt.children[0].children[0].children[1].innerHTML=t},At=function(e){var t=e.colorOptions,a=t.colorTheme,r=a.name;chartPreview.generateMonochromaticShades(r,!0);var n=a.isReversed,i=a.basecolor,o=".cPaletteCode li[data-name ="+r+"]",s=-1!==r.indexOf("CUSTOM")||-1!==r.indexOf("SHEET-OFFICE-MONOCHORMATIC-THEME")?SheetChartColor(i).getLinerGradient(6):$(o).css("background-image");-1!==r.indexOf("CUSTOM")?$($("#chartcustomcolorDropDown span")[0]).css("background",i):null,$("#chartThemePallate").css("background-image",s),$("#chartThemePallate").attr("data-name",r),$("#chartThemePallate").attr("data-basecolor",i),$("#chartThemePallate").attr("data-reversed",n)},$t=function(e){var t=chartOnLoad.getInstanceByChartId(e.trim()),a=t.co.options;previousChartType=_t(t.type);a.cellRef.headerRange;getObj("frl").checked=t.frl,getObj("fcl").checked=t.fcl,Bt();var r=t.seriesIn;"COLS"==r?getObj("columns").checked=!0:getObj("rows").checked=!0,Dt(previousChartType),$("#threshold").attr("disabled","disabled"),$("#thresholdD").disable();a.legend.floating;At(a),$("#legend").zcombo("setValue",Mt(t.legendPos)),$("#dataLabels").zcombo("setValue",t.lf);for(var n=!1,i=0,o=0;o<a.series.length;o++)if(n=a.series[o].hasOwnProperty("regressionSettings")){i=o;break}if(a.series&&a.series.length>1&&n){$("#trendlineTypes").zcombo("setValue",a.series[i].regressionSettings.type.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})),$("#tltypes").show(),$("#trendlineDegree").zcombo("setValue",a.series[i].regressionSettings.order&&-1!==a.series[i].regressionSettings.type.indexOf("polynomial")?a.series[i].regressionSettings.order:2),-1!==a.series[i].regressionSettings.type.indexOf("polynomial")?$("#tldegree").show():$("#tldegree").hide(),-1!==a.series[i].regressionSettings.type.indexOf("average")?$("#tlperiod").show():$("#tlperiod").hide();var s=chartGlance.getMaximumSeriesLength(a.series);$("#trendlinePeriod").zspinner("setMaxValue",s[1]>2?s[1]-1:2),$("#trendlinePeriod").zspinner("setValue",a.series[i].regressionSettings.order&&-1!==a.series[i].regressionSettings.type.indexOf("average")?a.series[i].regressionSettings.order:2)}else $("#trendlineTypes").zcombo("setValue","None"),-1!==previousChartType.indexOf("BULLET")||-1===a.chart.type.indexOf("scatter")&&-1===a.chart.type.indexOf("column")&&-1===a.chart.type.indexOf("bar")&&-1===a.chart.type.indexOf("line")&&-1===a.chart.type.indexOf("spline")&&-1===a.chart.type.indexOf("area")?$("#tltypes").hide():($("#tltypes").show(),$("#trendlineDegree").zcombo("setValue",t.order?t.order:2),$("#trendlinePeriod").zspinner("setValue",t.order?t.order:2));1===a.yAxis[0].gridLineWidth?$("#glMajor").attr("checked",!0):$("#glMajor").attr("checked",!1),"auto"===a.yAxis[0].minorTickInterval?$("#glMinor").attr("checked",!0):$("#glMinor").attr("checked",!1),t.ihc===!0?$("#hideCellsToggle").prop("checked",!0):$("#hideCellsToggle").prop("checked",!1);$("#combineRange").zcombo("setValue",t.cR);a.xAxis[0].labels.enabled?$("#xAxisLabelToggle").prop("checked",!0):$("#xAxisLabelToggle").prop("checked",!1);a.xAxis[0].labels.enabled||($("#xAxisSlant").disable(),$("#staggerLines").disable(),$("#slant").zcombo("disable"),$("#StaggerLines").zcombo("disable"));var l=a.xAxis[0].plotLines?a.xAxis[0].plotLines:null;if(null!=l)for(var o=0;o<l.length;o++)null!=l[o].value&&chartPreview.assignXAxisPlotLine(o,l[o].value);if($("#slant").zcombo("setValue","string"!=typeof parseInt(a.xAxis[0].labels.rotation)&&"undefined"!=typeof a.xAxis[0].labels.rotation?a.xAxis[0].labels.rotation:""),$("#StaggerLines").zcombo("setValue",a.xAxis[0].labels.staggerLines&&a.xAxis[0].labels.staggerLines>1?a.xAxis[0].labels.staggerLines:" "),(-1!==previousChartType.indexOf("LINE")||-1!==previousChartType.indexOf("STEP")||-1!==previousChartType.indexOf("AREA"))&&-1===previousChartType.indexOf("SCATTER")){a.plotOptions.series.marker.enabled?$("#markerToggle").prop("checked",!0):$("#markerToggle").prop("checked",!1)}},Lt=function(){$("#aggreoperation").zcombo("setValue","COUNT");for(var e=$(".aggHldr"),t=0;t<e.length;t++)$(e[t]).remove();depthDragDrop.enableLabelCheckBox()},St=function(e){if(null!=e)for(var t=0;t<e.length;t++){var a=$(".aggHldr");if("NONE"!==e[t]){var r=$(a[t]).find(".depthHeaders").find("select:eq(1)");if(r.length>0){var n=e[t].split("-");null!=n&&null!=n[1]&&($(r).zcombo("setValue",n[1]),$(r).zcombo("refresh"))}}}},It=function(e,t,a,r,n){z(e,t,a,r,n)},Rt=function(e,t){var a="",r=getObj("columns").checked?"COLS":"ROWS",n=$("#frl").is(":checked"),i=$("#fcl").is(":checked");if(null!=e){for(var o=[],s=0;s<e.length;s++){var l=e[s],c=Et(l),d=Pt(l);if(null!=c){var h=c,p=h.split(" ");a+=s>0?s==e.length-1?p[1]:p[1]+" & ":e.length>1?c+" & ":c;{kt(l)}c="COLS"==r?n?c:d:i?c:d,o.push(c)}}depthDragDrop.addExistingDepthHeader(o);var g=null!=t?t.split(","):null;chartPreview.setDepthOperations(g),St(g)}},wt=function(e){for(var t=chartPreview.getDepthIndices(),a=t[0],r=0;r<a.length;r++)for(var n=0;n<a[r].length;n++){var i=a[r][n];if(-1!==e.indexOf(i.headerValue))return i.headerLabel}return null},Et=function(e){for(var t=chartPreview.getDepthIndices(),a=t[0],r=0;r<a.length;r++)for(var n=0;n<a[r].length;n++){var i=a[r][n];if(e=e.replace(/\'/g,""),-1!==e.indexOf(i.headerRange))return i.headerValue||i.headerLabel}return null},Pt=function(e){for(var t=chartPreview.getDepthIndices(),a=t[0],r=0;r<a.length;r++)for(var n=0;n<a[r].length;n++){var i=a[r][n];if(e=e.replace(/\'/g,""),-1!==e.indexOf(i.headerRange))return i.headerLabel}return null},kt=function(e){for(var t=chartPreview.getDepthIndices(),a=t[0],r=0;r<a.length;r++)for(var n=0;n<a[r].length;n++){var i=a[r][n];if(e=e.replace(/\'/g,""),-1!==e.indexOf(i.headerRange))return i.type}return a[0][0].type},jt=function(e,t,a){return isChartDialogOpened?void 0:(chartDialogState="EDIT",chartPreview.hideContextualToolbar(),sheetMenu&&sheetMenu.currMenu&&sheetMenu.currMenu.zmenu("hide"),a=a?a:"options",void j(t,a))},_t=function(e){return"XYLINE_SHAPES"===e&&(e="XYLINE"),getObj(e).className="chartSubTypeSel",e},Bt=function(){var e=$("#dataLabels").zcombo("getValue"),t=previousChartType.toLowerCase();if(-1!==t.indexOf("ohlc")||-1!==t.indexOf("candlestick")||0===t.indexOf("polar")||0===t.indexOf("spider")){var a=$("#dataLabels");$("#dataLabels_series").length&&$("#dataLabels_series").remove(),$("#dataLabels_bubble_size").length&&$("#dataLabels_bubble_size").remove(),$("#dataLabels_percent").length&&$("#dataLabels_percent").remove(),$("#dataLabels_series_value").length&&$("#dataLabels_series_value").remove(),$("#dataLabels_label_value").length&&$("#dataLabels_label_value").remove(),$("#dataLabels_series_percent").length&&$("#dataLabels_series_percent").remove(),$("#dataLabels_value_percent").length&&$("#dataLabels_value_percent").remove(),$("#dataLabels_label_percent").length&&$("#dataLabels_label_percent").remove(),a.zcombo("refresh")}else{getObj("dataLabelsTR").style.display="";var a=$("#dataLabels");0==$("#dataLabels_series").length&&$("<option/>",{id:"dataLabels_series",value:"S",text:jsMsg.ShowSerie}).appendTo(a),-1!==t.indexOf("pie")||-1!==t.indexOf("doughnut")||-1!==t.indexOf("funnel")?($("#dataLabels_bubble_size").length&&$("#dataLabels_bubble_size").remove(),$("#dataLabels_series_value").length&&$("#dataLabels_series_value").remove(),$("#dataLabels_label_value").length&&$("#dataLabels_label_value").remove(),$("#dataLabels_label_percent").length&&$("#dataLabels_label_percent").remove(),$("#dataLabels_value_percent").length&&$("#dataLabels_value_percent").remove(),$("#dataLabels_series_percent").length&&$("#dataLabels_series_percent").remove(),$("#dataLabels_percent").length&&$("#dataLabels_label_percent").remove(),0===$("#dataLabels_percent").length&&$("<option/>",{id:"dataLabels_percent",value:"P",text:jsMsg.ShowPercent}).appendTo(a)):-1!==t.indexOf("bubble")?($("#dataLabels_percent").length&&$("#dataLabels_percent").remove(),$("#dataLabels_series_value").length&&$("#dataLabels_series_value").remove(),$("#dataLabels_label_value").length&&$("#dataLabels_label_value").remove(),$("#dataLabels_series_percent").length&&$("#dataLabels_series_percent").remove(),$("#dataLabels_value_percent").length&&$("#dataLabels_value_percent").remove(),$("#dataLabels_label_percent").length&&$("#dataLabels_label_percent").remove(),0===$("#dataLabels_bubble_size").length&&$("<option/>",{id:"dataLabels_bubble_size",value:"B",text:jsMsg.ShowBubbleSize}).appendTo(a)):-1!==t.indexOf("stack")?($("#dataLabels_bubble_size").length&&$("#dataLabels_bubble_size").remove(),$("#dataLabels_series_value").length&&$("#dataLabels_series_value").remove(),$("#dataLabels_label_value").length&&$("#dataLabels_label_value").remove(),0===$("#dataLabels_percent").length&&$("<option/>",{id:"dataLabels_percent",value:"P",text:jsMsg.ShowPercent}).appendTo(a)):($("#dataLabels_percent").length&&$("#dataLabels_percent").remove(),$("#dataLabels_series_percent").length&&$("#dataLabels_series_percent").remove(),$("#dataLabels_value_percent").length&&$("#dataLabels_value_percent").remove(),$("#dataLabels_label_percent").length&&$("#dataLabels_label_percent").remove(),$("#dataLabels_bubble_size").length&&$("#dataLabels_bubble_size").remove()),-1===t.indexOf("bubble")&&(0===$("#dataLabels_label_value").length&&$("<option/>",{id:"dataLabels_label_value",value:"L_V",text:jsMsg.ShowLabelValue}).appendTo(a),0===$("#dataLabels_series_value").length&&$("<option/>",{id:"dataLabels_series_value",value:"S_V",text:jsMsg.ShowSeriesValue}).appendTo(a)),(-1!==t.indexOf("pie")||-1!==t.indexOf("doughnut")||-1!==t.indexOf("funnel")||-1!==t.indexOf("stack"))&&(0===$("#dataLabels_label_percent").length&&$("<option/>",{id:"dataLabels_label_percent",value:"L_P",text:jsMsg.ShowLabelPercent}).appendTo(a),0===$("#dataLabels_value_percent").length&&$("<option/>",{id:"dataLabels_value_percent",value:"V_P",text:jsMsg.ShowValuePercentage}).appendTo(a),0===$("#dataLabels_series_percent").length&&$("<option/>",{id:"dataLabels_series_percent",value:"S_P",text:jsMsg.ShowSeriesPercentage}).appendTo(a)),a.zcombo("refresh"),a.zcombo("setValue",e)}},Dt=function(e){$("#autoExpand").show(),$("#hiddenCells").show(),$("#axis").show(),$("#chartZoom").show(),$("#threshold").attr("disabled","disabled"),$("thresholdD").disable(),$("#gLines").show(),$("#tltypes").hide(),$("#staggerLines").show(),$("#lineMarkers").hide(),$("#RA").hide(),$("#multiAxis").hide(),$("#isMultiYAxis").hide();var t=getObj("columns").checked?"COLS":"ROWS",a=depthDragDrop.checkIfAggregationEnabled();getObj("fcl").disabled=!1,getObj("frl").disabled=!1,-1!==e.indexOf("SCATTER")||-1!==e.indexOf("TIME")||-1!==e.indexOf("BUBBLE")||-1!==e.indexOf("POLAR")?"COLS"==t?(getObj("fcl").disabled=!0,getObj("frl").disabled=!1):(getObj("frl").disabled=!0,getObj("fcl").disabled=!1):-1===e.indexOf("LINE")&&-1===e.indexOf("STEP")&&-1===e.indexOf("AREA")||-1!==e.indexOf("SCATTER")?-1!==e.indexOf("COMBO")?$("#lineMarkers").show():-1!==e.indexOf("PIE")||-1!==e.indexOf("DOUGHNUT")||-1!==e.indexOf("FUNNEL")?($("#axis").hide(),$("#chartZoom").hide(),$("#gLines").hide(),$("#thresholdD").disable(),$("#threshold").attr("disabled","disabled")):-1!==e.indexOf("BAR")&&$("#staggerLines").hide():$("#lineMarkers").show(),-1===!e.indexOf("BULLET")||-1===e.indexOf("SCATTER")&&-1===e.indexOf("LINE")&&-1===e.indexOf("STEP")&&-1===e.indexOf("COL")&&-1===e.indexOf("BAR")&&-1===e.indexOf("AREA")&&-1===e.indexOf("SPLINE")?($("#trendlineTypes").zcombo("setValue","None"),$("#trendlineDegree").zcombo("setValue",2),$("#tltypes").hide(),$("#tldegree").hide(),$("#tlperiod").hide()):$("#tltypes").show(),(-1!==e.indexOf("SPIDERWEB")||-1!==e.indexOf("POLAR"))&&$("#chartZoom").hide(),$.inArray(e,multiAxisCharts)>=0?($("#threshold").removeAttr("disabled"),$("#thresholdD").enable()):($("#threshold").attr("disabled","disabled"),$("#thresholdD").disable()),-1!==e.indexOf("FUNNEL")?$("#animationD").hide():$("#animationD").show(),-1!==e.indexOf("BAR")?($("#xAxisTitle").attr("placeholder","Vertical Axis"),$("#yAxisTitle").attr("placeholder","Horizontal Axis")):($("#xAxisTitle").attr("placeholder","Horizontal Axis"),$("#yAxisTitle").attr("placeholder","Left Vertical Axis")),s&&($("#autoExpand").hide(),$("#hiddenCells").hide()),a&&("COLS"==t?(getObj("fcl").checked=!0,getObj("fcl").disabled=!0,getObj("frl").disabled=!1):(getObj("frl").checked=!0,getObj("frl").disabled=!0,getObj("fcl").disabled=!1))},Nt=function(e,t){-1!==$.inArray(e,multiAxisCharts)&&($("#isMultiYAxis").show(),t?$("#multiAxis").show():($("#RA").hide(),$("#LA").show()),$("#multiyaxisYes").prop("checked",t))},Mt=function(e){var t="None";return 1===e?t="Bottom":2===e?t="Top":3===e?t="Right":4===e?t="Left":5===e&&(t="TopRight"),"None"===t&&$("#floating").disable(),t},zt=function(e,t){var a=t?!1:!0;C(e,a)},Ht=function(e,t,a){if((-1!==e.type.toUpperCase().indexOf("LINE")||-1!==e.type.toUpperCase().indexOf("SPLINE")||-1!==e.type.toUpperCase().indexOf("STEP")||-1!==e.type.toUpperCase().indexOf("AREA"))&&e.co.series&&e.co.series.length>=1&&e.co.series[0].data.length>=10&&(e.co.plotOptions.series.marker.enabled=!1,t&&$("#markerToggle").prop("checked",!1)),a){var r=e.co.series.length;r>10?(e.co.legend.enabled=!1,$("#legend").zcombo("setValue","None")):e.co.plotOptions[e.co.chart.type].showInLegend&&$("#legend").zcombo("setValue","Right")}return e.co},Ut=function(){if(null==previousChartThemeName&&-1!==previousChartType.indexOf("BULLET")&&"EDIT"!==chartDialogState){var e=-1!==StyleObject.colorObject.colorTheme.name.indexOf("SHEET-OFFICE-MONOCHORMATIC-THEME")?StyleObject.colorObject.colorTheme.name:"SHEET-OFFICE-MONOCHORMATIC-THEME1",t=".colorpaletteDialogMonochromatic li[data-name = "+e+"]";chartPreview.generateMonochromaticShades("SHEET-OFFICE-COLORFUL-THEME1",!0);var a=$(t),r=$(a).data();previousChartThemeName=$("#chartThemePallate").attr("data-name"),$("#chartThemePallate").css("background-image",$(t).css("background-image")),$("#chartThemePallate").attr("data-name",r.name),$("#chartThemePallate").attr("data-basecolor",r.basecolor),$("#chartThemePallate").attr("data-reversed",!1),chartOnLoad.getInstanceByChartId("preview")&&chartOnLoad.getInstanceByChartId("preview").co&&(StyleObject=aa(chartOnLoad.getInstanceByChartId("preview").co.options),StyleObject.colorObject.colorTheme.name=r.name,StyleObject.colorObject.colorTheme.isReversed=!1,StyleObject.colorObject.colorTheme.basecolor=r.basecolor)}else if(-1===previousChartType.indexOf("BULLET")&&null!=previousChartThemeName){var t=".colorpaletteDialog li[data-name = "+previousChartThemeName+"]";chartPreview.generateMonochromaticShades(previousChartThemeName,!0);var a=$(t),r=$(a).data();$("#chartThemePallate").css("background-image",$(t).css("background-image")),$("#chartThemePallate").attr("data-name",r.name),$("#chartThemePallate").attr("data-basecolor",r.basecolor),$("#chartThemePallate").attr("data-reversed",!1),chartOnLoad.getInstanceByChartId("preview")&&chartOnLoad.getInstanceByChartId("preview").co&&(StyleObject=aa(chartOnLoad.getInstanceByChartId("preview").co.options),StyleObject.colorObject.colorTheme.name=r.name,StyleObject.colorObject.colorTheme.isReversed=!1,StyleObject.colorObject.colorTheme.basecolor=r.basecolor),previousChartThemeName=null}},Vt=function(e){if(!previousChartType||previousChartType!==e.id){""!==previousChartType&&($("#"+previousChartType).removeClass("chartSubTypeSel"),$("#"+previousChartType).addClass("chartSubType"));var t=e.id;getObj(t).className="chartSubTypeSel",previousChartType=t,Bt(),Dt(previousChartType);var a=chartOnLoad.getInstanceByChartId("preview")?chartOnLoad.getInstanceByChartId("preview").isSingleYaxis:!1;Nt(previousChartType,a),Ut(),getObj("chartType").value=""===getObj("chartType").value?"BAR_Y":e.id,C(!0)}},Gt=function(){var e="#setOfColumnChart";return-1!==previousChartType.indexOf("COL")&&-1==previousChartType.indexOf("BULLET")?e="#setOfColumnChart":-1!==previousChartType.indexOf("TIMELINE")||-1!==previousChartType.indexOf("TIMEAREA")?e="#setOfTimeSeriesChart":-1!==previousChartType.indexOf("BAR")&&-1==previousChartType.indexOf("BULLET")?e="#setOfBarChart":-1!==previousChartType.indexOf("AREA")?e="#setOfAreaChart":-1!==previousChartType.indexOf("XYLINE")?e="#setOfLineChart":-1!==previousChartType.indexOf("PIE")||-1!==previousChartType.indexOf("DOUGHNUT")||-1!==previousChartType.indexOf("SEMIDOUGHNUT")?e="#setOfPieChart":-1!==previousChartType.indexOf("SCATTER")?e="#setOfScatterChart":-1!==previousChartType.indexOf("BUBBLE")?e="#setOfBubbleChart":-1!==previousChartType.indexOf("POLAR")||-1!==previousChartType.indexOf("SPIDERWEB")?e="#setOfWebChart":-1!==previousChartType.indexOf("CANDLESTICK")||-1!==previousChartType.indexOf("OHLCCHART")?e="#setOfStockChart":-1!==previousChartType.indexOf("COMBOCHART")||-1!==previousChartType.indexOf("WATERFALL")||-1!==previousChartType.indexOf("FUNNEL")?e="#setOfExtraChart":-1!==previousChartType.indexOf("BULLET")&&(e="#setOfGaugeChart"),e},Wt=function(e,t){var a=t||$(e).index();switch($(e).addClass("selected"),Ft(a),s&&0==a&&(a=1),a){case 0:$("#chartGeneral").show(),Yt(),it("renderRecommendation");break;case 1:$("#chartTypes").show(),s&&($("#setOfScatterChart").hide(),$("#setOfBubbleChart").hide(),$("#setOfStockChart").hide(),$("#setOfTimeSeriesChart").hide()),RangeSelector.off(),qt(e);break;case 2:$("#option").show(),RangeSelector.off();break;case 3:$("#axisOptions11").show(),RangeSelector.off();break;case 4:$("#Advanced").show();break;case 5:$("#chartRecommend").show(),RangeSelector.off()}},Ft=function(e){var t=["chartGeneral","chartTypes","option","axisOptions11","Advanced"];for(i=0;i<t.length;i++)e!==i&&$("#"+t[i]).hide();var a=$("#chart li").length;for(i=0;a>i;i++)e!==i&&($("#chart li")[i].className="")},Yt=function(){$("#"+previousChartType).addClass("chartSubType"),$("#"+previousChartType).removeClass("chartSubTypeSel"),0===previousChartType.indexOf("COL")&&-1===previousChartType.indexOf("3D")?previousChartType="COL":0===previousChartType.indexOf("BAR")&&-1===previousChartType.indexOf("3D")?previousChartType="BAR":0!==previousChartType.indexOf("PIE")&&0!==previousChartType.toLowerCase().indexOf("DOUGHNUT")||-1!==previousChartType.indexOf("3D")?0===previousChartType.indexOf("SCATTER")?previousChartType="SCATTER":0===previousChartType.indexOf("XYAREA")?previousChartType="XYAREA":0===previousChartType.indexOf("XYLINE")&&-1===previousChartType.indexOf("SCATTER")&&(previousChartType="XYLINE"):previousChartType="PIE",$("#"+previousChartType).addClass("chartSubTypeSel"),$("#"+previousChartType).removeClass("chartSubType")},qt=function(){$("#"+previousChartType).addClass("chartSubType"),$("#"+previousChartType).removeClass("chartSubTypeSel");-1!==previousChartType.indexOf("3D")?$("#chartContainer").ztab("selectTab",1):$("#chartContainer").ztab("selectTab",0);switch(previousChartType){case"COL":var e=getObj("setOfColumnChart").children[1].children[0].id;$("#"+e).removeClass("chartSubType"),$("#"+e).addClass("chartSubTypeSel"),getObj("chartType").value=e,previousChartType=e;break;case"BAR":var e=getObj("setOfBarChart").children[1].children[0].id;$("#"+e).removeClass("chartSubType"),$("#"+e).addClass("chartSubTypeSel"),getObj("chartType").value=e,previousChartType=e;break;case"XYLINE":var e=getObj("setOfLineChart").children[1].children[0].id;$("#"+e).removeClass("chartSubType"),$("#"+e).addClass("chartSubTypeSel"),getObj("chartType").value=e,previousChartType=e;break;case"PIE":var e=getObj("setOfPieChart").children[1].children[0].id;$("#"+e).removeClass("chartSubType"),$("#"+e).addClass("chartSubTypeSel"),getObj("chartType").value=e,previousChartType=e;break;case"XYAREA":var e=getObj("setOfAreaChart").children[1].children[0].id;$("#"+e).removeClass("chartSubType"),$("#"+e).addClass("chartSubTypeSel"),getObj("chartType").value=e,previousChartType=e;break;case"SCATTER":var e=getObj("setOfScatterChart").children[1].children[0].id;$("#"+e).removeClass("chartSubType"),$("#"+e).addClass("chartSubTypeSel"),getObj("chartType").value=e,previousChartType=e;break;default:getObj(previousChartType).className="chartSubTypeSel"}var t=Gt();$("#2d").scrollTop($(t).position().top-40+$("#2d").scrollTop())},Jt=function(e){var t=[],a=ole.getCurrObj().id;return e||(t.push({id:"chttype",data:"{label:'"+jsMsg.Edit+"...', appData:{dynamic:true, callback: 'chart.showChartTab', arg:'chartType, "+a+"'}}"}),t.push({id:"chtstyle",data:"{submenu : '#chartStylesSubMenu' ,label:'"+jsMsg["Chart.Styles"]+"', appData:{dynamic:true, callback: '', arg: '"+a+", true'}}"}),t.push({id:"chtsep1",mtype:"separator"})),t.push({id:"chtmove",data:"{submenu : '#chartMoveToSubMenu' ,label:'"+jsMsg["Chart.MoveChart"]+"', appData:{dynamic:true, callback: '', arg: '"+a+", true'}}"}),t.push({id:"chtclone",data:"{label:'"+jsMsg["Chart.Clone"]+"', appData:{dynamic:true, callback: 'chart.cloneChart', arg: '"+a+"'}}"}),t.push({id:"chtdel",data:"{label:'"+jsMsg.Delete+"', appData:{dynamic:true, callback: 'chartOLEAction.removeChart', arg: '"+a+", true'}}"}),t.push({id:"chtsep2",mtype:"separator"}),t.push({id:"chtsaveasimg",data:"{label:'"+jsMsg["Image.SaveAsImage"]+"', appData:{dynamic:true, callback: 'chart.saveChartAsImage', arg:'"+a+"'}}"}),t};appEvent.on("doMenuItemBinding",function(){$("#colorPallateMenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id),t=e.co.options.colorOptions,a=t.colorTheme;$("#colorPallateMenu").length>1&&$($("#colorPallateMenu").splice(1)).remove();var r=a.name,n=a.isReversed,i=".cPaletteCode li[data-name ="+r+"]",o="data-reversed";new Promise(function(e){$($(".cPaletteCode li")).removeClass("active"),e()}).then(function(){for(var e=$(i),t=0;t<e.length;t++){var a=$(e[t]).attr(o);"string"==typeof n&&(n="true"==n?!0:!1),"string"==typeof a&&(a="true"==a?!0:!1),a==n&&e[t].classList.add("active")}})}),$("#columnchartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#columnchartmenu").zmenu("checkAllItems",!1),$("#columnchartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#barchartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#barchartmenu").zmenu("checkAllItems",!1),$("#barchartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#linechartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#linechartmenu").zmenu("checkAllItems",!1),$("#linechartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#piechartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#piechartmenu").zmenu("checkAllItems",!1),$("#piechartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#scatterchartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#scatterchartmenu").zmenu("checkAllItems",!1),$("#scatterchartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#areachartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#areachartmenu").zmenu("checkAllItems",!1),$("#areachartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#morechartmenu").bind("menubeforeshow",function(){var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type+2;$("#morechartmenu").zmenu("checkAllItems",!1),$("#morechartmenu").zmenu("check",e),$("#chartRMenu").hide()}),$("#legendctmenu").bind("menubeforeshow",function(){var e="legendct"+chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).legendPos;$("#legendctmenu").zmenu("checkAllItems",!1),$("#legendctmenu").zmenu("check",e),$("#legendctmenu").zmenu("changeIcon",e,"ui-icon-check"),$("#chartRMenu").hide()}),$("#publichchartmenu").bind("menubeforeshow",function(){$("#chartRMenu").hide();var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).pcn;e?($("#chartUnPublish").show(),$("#showChartPublishedURL").enable(),$("#publichChart").hide()):($("#chartUnPublish").hide(),$("#showChartPublishedURL").disable(),$("#publichChart").show())}),$("#datalabelctmenu").bind("menubeforeshow",function(){$("#chartRMenu").hide();var e=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id),t="lf_"+e.lf;$("#datalabelctmenu").zmenu("checkAllItems",!1),$("#datalabelctmenu").zmenu("check",t),$("#datalabelctmenu").zmenu("changeIcon",t,"ui-icon-check");var a=e.type;-1!==a.indexOf("PIE")||-1!==a.indexOf("DOUGHNUT")||-1!==a.indexOf("FUNNEL")?($("#lf_L_P").show(),$("#lf_P").show(),$("#lf_B").hide(),$("#lf_S").show(),$("#lf_S_V").show(),$("#lf_L_V").show(),$("#lf_S_P").show(),$("#lf_V_P").show()):-1!==a.indexOf("BUBBLE")?($("#lf_B").show(),$("#lf_L_P").hide(),$("#lf_P").hide(),$("#lf_S").show(),$("#lf_S_V").hide(),$("#lf_L_V").hide(),$("#lf_S_P").hide(),$("#lf_V_P").hide()):(-1!==a.indexOf("COL")||a.indexOf("STEP")||a.indexOf("SCATTER")||-1!==a.indexOf("BAR")||-1!==a.indexOf("LINE")||-1!==a.indexOf("AREA")||-1!==a.indexOf("WATERFALL")||-1!==a.indexOf("COMBO")||-1!==a.indexOf("AREA"))&&($("#lf_B").hide(),$("#lf_P").hide(),$("#lf_L_P").hide(),$("#lf_S").show(),$("#lf_S_V").show(),$("#lf_L_V").show(),$("#lf_S_P").hide(),$("#lf_V_P").hide(),-1!==a.indexOf("STACK")&&($("#lf_P").show(),$("#lf_S_P").show(),$("#lf_V_P").show(),$("#lf_L_P").show()))})});var Xt,Kt=function(){var e=[],t=ole.getCurrObj().id;e.push({data:"{label:'"+jsMsg["Image.SaveAsImage"]+"', appData:{dynamic:true, callback: 'insertImage.saveImage', arg:'"+t+"'}}"}),e.push({data:"{label:'"+jsMsg.Delete+"', appData:{dynamic:true, callback: 'ole.remove', arg: '"+t+", true'}}"});var a={target:$("#chart_actionBar_moreActions"),clearcache:!0,menuoptions:{type:"text_only"}};sheetMenu.showMenu("chartMoreMenu",e,a)},Zt=function(e){var e=e[0],t=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id)?chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type:"";if(e.id!==t+"2"&&e.id!==t){{var a=ole.getCurrObj().id;getObj(null!==getObj(previousChartType+"2")?previousChartType+"2":previousChartType)}previousChartType=e.id;var r=previousChartType.replace(/[0-2]/g,"");chartPreview.chartQuickEditRequest(a,107,r)}},Qt=function(e){if("normalImage"===e){$("#"+e).addClass("selected"),$("#interactImage").removeClass("selected");var t=$("#publicurltext").text();-1===t.indexOf(".png")&&(getObj("publicurltext").href=t.trim()+".png",getObj("publicurltext").innerHTML=t.trim()+".png");var a=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id),t=getServerPath()+ctxpath+"publicgraphs/"+a.pcn,r="<img title='"+a.co.options.title.text+"' src='"+t+".png'>";getObj("publishurltext").value=r}else{$("#"+e).addClass("selected"),$("#normalImage").removeClass();var t=$("#publicurltext").text();-1!==t.indexOf(".png")&&(getObj("publicurltext").innerHTML=t.replace(".png",""),getObj("publicurltext").href=t.replace(".png",""));var a=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id),t=getServerPath()+ctxpath+"publicgraphs/"+a.pcn,n="<iframe width='"+a.wd+"' height='"+a.ht+'\' style="border:1px solid #ccc" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" src=\''+t+"'> </iframe>";getObj("publishurltext").value=n}},ea=function(e){var t=$(e).find("select[id^='depthHeaders']").attr("id"),a=t.substr(-1);return a},ta=function(e,t){$(".aggClose").bind("click",function(e){var t=$(e.target).attr("index");chartPreview.createDepthHeader(t,"remove")}),$.ui.utils.initComponents($(e).find("#dateFilters"+t)),$(e).find("#depthHeaders"+t).bind("combochange",function(e){var t=chartPreview.calculateDepthHeaders(e.target,!1);-1!==t&&chart.createChart(!0)}),$(e).find("#dateFilters"+t).bind("combochange",function(){chartPreview.calculateDepthOperations(),chart.createChart(!0)})},aa=function(e){var t={};if(t.chart={},t.yAxis=[],t.xAxis={},t.chartTitle={},t.chartSubTitle={},t.chartLegend={},t.colorObject={},e.chart.backgroundColor&&(t.chart.backgroundColor=chartGlance.getColorCodeFromGradient(e.chart.backgroundColor)),e.chart.plotBackgroundColor&&(t.chart.plotBackgroundColor=e.chart.plotBackgroundColor),e.chart.style&&(t.chart.style=e.chart.style),e.legend.itemStyle&&(t.chartLegend=e.legend.itemStyle),e.title.style&&(t.chartTitle.style=e.title.style),e.subtitle&&e.subtitle.style&&(t.chartSubTitle.style=e.subtitle.style),e.colorOptions&&(t.colorObject=e.colorOptions),e.xAxis&&e.xAxis.title&&e.xAxis.title.style){if(t.xAxis.style=e.xAxis.title.style,e.xAxis.labels.style&&(t.xAxis.labelStyle=e.xAxis.labels.style),e.xAxis.plotLines){t.xAxis.plotLines=[];for(var a=0;a<e.xAxis.plotLines.length;a++)t.xAxis.plotLines[a]={},t.xAxis.plotLines[a].index=a,t.xAxis.plotLines[a].xplotLine=e.xAxis.plotLines[a].color,t.xAxis.plotLines[a].xplotLineStyle=e.xAxis.plotLines[a].dashStyle,t.xAxis.plotLines[a].xplotLineTitle=e.xAxis.plotLines[a].label.style,t.xAxis.plotLines[a].xplotLineTitleText=e.xAxis.plotLines[a].label.text}}else if(e.xAxis[0]&&e.xAxis[0].title&&e.xAxis[0].title.style&&(t.xAxis.style=e.xAxis[0].title.style,e.xAxis[0].labels.style&&(t.xAxis.labelStyle=e.xAxis[0].labels.style),e.xAxis[0].plotLines)){t.xAxis.plotLines=[];for(var a=0;a<e.xAxis[0].plotLines.length;a++)t.xAxis.plotLines[a]={},t.xAxis.plotLines[a].index=a,t.xAxis.plotLines[a].xplotLine=e.xAxis[0].plotLines[a].color,t.xAxis.plotLines[a].xplotLineStyle=e.xAxis[0].plotLines[a].dashStyle,t.xAxis.plotLines[a].xplotLineTitle=e.xAxis[0].plotLines[a].label.style,t.xAxis.plotLines[a].xplotLineTitleText=e.xAxis[0].plotLines[a].label.text}if(e.yAxis&&e.yAxis.length>=1)for(var a=0;a<e.yAxis.length;a++)if(t.yAxis[a]={},t.yAxis[a].index=a,e.yAxis[a].title.style&&e.yAxis[a].title.isAxisDirty&&(t.yAxis[a].style=e.yAxis[a].title.style),e.yAxis[a].gridLineColor&&(t.yAxis[a].gridLineColor=e.yAxis[a].gridLineColor),e.yAxis[a].labels.style&&e.yAxis[a].title.isAxisDirty&&(t.yAxis[a].labelStyle=e.yAxis[a].labels.style),e.yAxis[a].plotLines){t.yAxis[a].plotLines=[];for(var r=0;r<e.yAxis[a].plotLines.length;r++)t.yAxis[a].plotLines[r]={},t.yAxis[a].plotLines[r].index=r,t.yAxis[a].plotLines[r].plotLine=e.yAxis[a].plotLines[r].color,t.yAxis[a].plotLines[r].plotLineStyle=e.yAxis[a].plotLines[r].dashStyle,e.yAxis[a].plotLines[r].label&&(t.yAxis[a].plotLines[r].plotLineTitle=e.yAxis[a].plotLines[r].label.style,t.yAxis[a].plotLines[r].plotLineTitleText=e.yAxis[a].plotLines[r].label.text)}var n,i,o,s=document.getElementById("chartThemePallate"),l={};return s?(n=s.dataset.name,i=s.dataset.basecolor,o=s.dataset.reversed,l.name=n,l.isReversed=o,l.basecolor=i):l=e.colorOptions.colorTheme,t.colorObject.colorTheme=l,t},ra=function(){var e=parseInt(ole.getCurrObj().id),t=!0,a=WorkSheets.getAssociatedActiveSheetName();ole.remove(e,!1),u(a,e),insertSheet("add",void 0,void 0,void 0,void 0,t,a,e)},na=function(e){var t=$("#"+e).text();if(ProtectedRanges.isSheetLocked(t))return void showAlertDialog(jsMsg["Error.Operation.Not.Permissable"]);if(WorkSheets.isNameExists(t))t=WorkSheets.getSheetCodeFromName(t);else{var r=parseInt(e.match(/-?\d+\.?\d*/)[0],10);t=r+"#"}var n=ole.getCurrObj().id,i=chartOnLoad.getInstanceByChartId(n);a=n;var o=parseInt(i.sr),s=parseInt(i.sc);previosSheetName=i.asn;var l=new RequestParameters(ActionConstants.CHART_MOVE_TO_NEW_SHEET),c=new AjaxRequest;l.setParameters(WorkSheets.getAssociatedActiveSheetName(),n,t,null),c.init("POST",l.getURL(),!0,l.getParametersAsString()),c.addEventListener("onComplete",function(){chartOLEAction.backToPreviousToolbar(),ia(previosSheetName,a),Goto.doGoto(WorkSheets.getSheetNameFromCode(t),o,o,s,s,!0)}),actionManager.addRequest(c)},ia=function(){ole.remove(a,!1),$("#chartMenu").hide(),$("#pivotChartMenu").hide(),chartOnLoad.removeChart(previosSheetName,a)},oa=function(e,t){var a=50;return parseInt(e)+a+t>window.innerWidth&&(a=-50),parseInt(e)+a},sa=function(e){aggObject=e,aggObject&&null!=aggObject&&aggObject.init()},la=function(){return aggObject},ca=function(e,t){var a=50;return parseInt(e)+a+t>window.innerHeight&&(a=-50),parseInt(e)+a},da=function(){var e=$(".aggHldr"),t="";if(void 0==e||0==e.length)return jsMsg.None;for(var a=0;a<e.length;a++){var r=$(e[a]).find(".depthHeaders").find("select:first").zcombo("getValue");if("choose"!=r)if(""==t)t+=r+" &";else{var n=r?r:"";""!==n&&(t+=" "+n+" &")}}return t&&(t=t.replace(/\&$/,"")),t},ha=function(e,t,a){var r=(new Array,new Array,null);return chartOnLoad.getInstanceByChartId(a)&&chartOnLoad.getInstanceByChartId(a).co&&chartOnLoad.getInstanceByChartId(a).co.options&&(r=chartOnLoad.getInstanceByChartId(a).co.options.aggregation),r||{}},pa=function(e){var t=($("#rows").is(":checked")?"ROWS":"COLS",null);return chartOnLoad.getInstanceByChartId(e)&&chartOnLoad.getInstanceByChartId(e).co&&chartOnLoad.getInstanceByChartId(e).co.options&&(t=chartOnLoad.getInstanceByChartId(e).co.options.filter),t},ga=function(e,t,a,r,n,i,o,s,l,c){var d,h,p,g,u,b,v=chartOnLoad.getInstanceByChartId(e),f=l?!1:!0,y=v.co.options,C=(v.asn,v.cR),O=v.dataRange,x=v.type,m="",T=v.seriesIn,A=v.frl,$=v.fcl,L=v.legendPos,S=v.isPivotChart,R=v.pivotId,w=v.wd?v.wd:550,E=v.ht?v.ht:330;t?(d=s,h=o,p=a,g=r,u=n,b=i):(d=oa(v[isRTL?"right":"left"]?v[isRTL?"right":"left"]:ole.getCurrObj()[isRTL?"right":"left"],w),h=ca(v.top?v.top:ole.getCurrObj().top,E),p=findRowInYPos(h),g=findColInXPos(d),u=h-getRowTop(p),b=d-getColLeft(g));var P=c?c:y.cellRef.titleRange?y.cellRef.titleRange:chartPreview.decodeHTMLContent(y.title.text),k=y.cellRef.subtitleRange?y.cellRef.subtitleRange:chartPreview.decodeHTMLContent(y.subtitle.text),j=y.cellRef.xtitleRange?y.cellRef.xtitleRange:chartPreview.decodeHTMLContent(y.xAxis[0].title.text),_=(y.cellRef.ytitleRange?y.cellRef.ytitleRange:chartPreview.decodeHTMLContent(y.yAxis[0].title.text),y.yAxis[0].plotLines?y.yAxis[0].plotLines.value:null,y.yAxis[0].yMin?y.yAxis[0].yMin:null,y.yAxis[0].yMax?y.yAxis[0].yMax:null,y.yAxis[0].yInterval?y.yAxis[0].yInterval:null,y.tooltip.enabled),B="xy"===y.chart.zoomType?"xy":"",D=y.plotOptions.series.animation,N=v.tl,M=v.tlType,z=v.order,H=!1,U=y.yAxis[0].gridLineWidth?y.yAxis[0].gridLineWidth:null,V=(y.yAxis[0].majorTickInterval?!0:!1,y.yAxis[0].minorTickInterval?y.yAxis[0].minorTickInterval:""),G=y.xAxis[0].labels.enabled,W=y.yAxis[0].labels.enabled,F=v.isSingleYaxis,Y=v.ihc,q="string"!=typeof parseInt(y.xAxis[0].labels.rotation)&&"undefined"!=typeof y.xAxis[0].labels.rotation?y.xAxis[0].labels.rotation:null,J=y.xAxis[0].labels.staggerLines?parseInt(y.xAxis[0].labels.staggerLines):null,X=v.lf,K=(y.yAxis[1]&&y.cellRef.yRightTitle?y.cellRef.yRightTitle:y.yAxis[1]&&y.yAxis[1].title?escape(y.yAxis[1].title.text):"",y.yAxis[1]&&y.yAxis[1].plotLines?y.yAxis[1].plotLines.value:null,y.yAxis[1]&&y.yAxis[1].yMin?y.yAxis[1].yMin:null,y.yAxis[1]&&y.yAxis[1].yMax?y.yAxis[1].yMax:null,y.yAxis[1]&&y.yAxis[1].yInterval?y.yAxis[1].yInterval:null,y.yAxis[1]&&y.yAxis[1].labels?y.yAxis[1].labels.enabled:!1,y.plotOptions.series&&y.plotOptions.series.marker?y.plotOptions.series.marker.enabled:!1),Z=y.plotOptions.series.threshold,Q=aa(y),et=v.ae?v.ae:!0,tt={};tt.enabled=v.aggregation.enabled,tt.type=v.aggregation.type?v.aggregation.type.toUpperCase():"";{var at=null,rt=(I(y),null);new Array,new Array}"COLS"==T?at=v.co.options.cellRef?v.co.options.cellRef.headerRange:null:rt=v.co.options.cellRef?v.co.options.cellRef.headerRange:null,tt.colheaders=at,tt.rowheaders=rt,tt.dateOperations=v.co.options.aggregation.dateOperations;var nt={};nt.type=y.filter?y.filter.type:"NONE",nt.limit=y.filter?y.filter.limit:0,nt.limitBy=v.co.options.cellRef?v.co.options.cellRef.filterColumn:"NONE",nt.limitByName=y.filter?y.filter.limitByName:"NONE";var it=new Array;isUndefined(y.comboChartTypes)||(it=Object.values(y.comboChartTypes));var ot=chart.getAxisOptionsSaved(e,!1,!0),st=isUndefined(y.lineStyles)?[]:y.lineStyles,lt=new RequestParameters(ActionConstants.CHART_NEW),ct=new AjaxRequest;lt.setParameters(WorkSheets.getAssociatedActiveSheetName(),m,x,O,T,A,$,L,p,g,u,b,d,h,w,E,P,k,j,_,B,D,N,H,U,V,G,W,F,Y,q,X,J,C,K,M,Z,z,et,JSON.stringify(Q),S,R,f,JSON.stringify(it),JSON.stringify(ot),JSON.stringify(st),JSON.stringify(tt),JSON.stringify(nt),!1),ct.init("POST",lt.getURL(),!0,lt.getParametersAsString()),actionManager.addRequest(ct)};return{addChart:P,addPivotChart:k,createChart:zt,changeChartType:Vt,removeInstance:u,showPublishURLDialog:w,close:m,createChartContextMenu:Jt,cloneChart:ga,quickEdit:Zt,getLegendPosition:E,showChartDialog:j,showChartTab:jt,createNewChartSheet:ra,publish:T,unPublish:A,MoveToNewSheet:na,showPublishURL:L,showChartMoreActionsMenu:Kt,togglePublishChartURLTab:Qt,constructChartStyleObject:aa,doRecommendationChart:at,isValidRange:c,getChartCodeFromChartName:N,getAxisOptionsSaved:f,createEditChart:ct,bindEventsforDepthHeaders:ta,loadDepthIndicesInSelect:z,getDepthHeaderIndex:ea,loadDepthHeaders:It,unloadDepthHeaders:Lt,loadDepthOperations:St,getAggregationValue:da,getPivotChart:d,showHideCombineRange:g,setRecommedationSelection:bt,getXAxisPlotLines:S,handleLineMarker:Ht,alertForInvalidRange:Tt,setAggregationObject:sa,getAggregationObject:la,getPreviousChartId:h,fetchDeclarativeTable:G,removeAllRecommendedInstance:b,removeAllExploreInstance:v,setAggregationOptions:B,setFilterOptions:W,resetFilterOptions:X,getAggregationInputObject:ha,loadNumericColumnsInFilter:K,getDataRanges:H,getNumericColumnsFromDecTable:et,showHideChartOptions:Wt,getFilterInputObject:pa,saveChartAsImage:yt,unloadExistingColumnsInFilter:Q,disableFilterColumns:Y,enableFilterColumns:q,changeDateOperations:F,getHeaderLabelFromHeaderValue:wt}}(jQuery);
Chart.prototype.refreshChart=function(e,t,i,a,r){var n=e.co?e.co.chart.renderTo:e.chart?e.chart.renderTo:null;if(n&&(e=chartOnLoad.syncAndHandleUnwantedRemovedChartEvents(e)),t&&!a)try{var s=new Chart(e);chartOnLoad.updateHCInstance(WorkSheets.getAssociatedActiveSheetName(),e.chart.renderTo,s)}catch(e){}else if(t&&a){var s=e;chartOnLoad.updateHCInstance(WorkSheets.getAssociatedActiveSheetName(),s.options.chart.renderTo,s)}else try{if(appEvent.trigger("chart.rightclick",[e.id]),!i){var o=e.legendPos,l=e.isPivotChart,c={};r?c.chartOptions=e.co:c=chartGlance.removeUnwantedProperties(e.id,e.co,e.wd,e.ht,e.legendPos),e.co=c.chartOptions,PivotChartUtility.findTotalNoOfFilterRequired(e.id,e.pivotId),e.co=PivotChartUtility.setLegendBoundary(e.co,l,o,e.ht)}var s=new Chart(e.co);-1===e.type.indexOf("LINE")&&-1===e.type.indexOf("SCATTER")&&-1===e.type.indexOf("BUBBLE")||e.co.yAxis[0].min||chartOnLoad.setPositiveExtreme(s),e.co=s,appEvent.trigger("chart.click",[e.id]),appEvent.trigger("chart.dblclick",[e.id]);var d=chartOnLoad.getInstanceByChartId(e.id)||{},h={};chartOnLoad.mergeOptions(h,d,e,!1),chartOnLoad.addInstance(WorkSheets.getAssociatedActiveSheetName(),e.id,h)}catch(e){}chartOnLoad.syncAndHandleUnwantedRemovedOverideEvent(n)},Chart.prototype.destroyChart=function(){this.destroy()},Chart.prototype.setFloatingOption=function(e){var t=this.options;this.destroyChart(),t.legend.floating=e,this.refreshChart(t,!0)},Chart.prototype.updateChartTheme=function(e,t,i,a,r){var n=this.options;this.destroyChart(),t="string"==typeof t&&-1!==t.indexOf("[")?JSON.parse(t):t,n=chartGlance.resetChartColorCode(n),n.colorOptions.colorTheme.basecolor=t,n.colorOptions.colorTheme.name=a,n.colorOptions.colorTheme.isReversed=r,n=chartGlance.applySharedLegendInPie(n),n=chartGlance.handleChartStyle(n),n=chartGlance.decodeHTMLForAllTitles(n),n.plotOptions.series.animation=!1,chartPreview.getChartMode(n.chart.renderTo)&&(n=chartGlance.applyPointerCursor(n),n=chartOnLoad.applyChartEvents(n),n.chart.zoomType&&(chartPreview.setRemovedZoomType(n.chart.zoomType),n.chart.zoomType="none"),n.tooltip&&(chartPreview.setRemovedTooltipValue(n.tooltip.enabled),n.tooltip.enabled=!1),-1!==n.chart.type.indexOf("pie")&&(n.plotOptions[n.chart.type].allowPointSelect=!1));try{this.refreshChart(n,!0),-1==n.chart.renderTo.indexOf("preview")&&(chartOnLoad.doClickHandling(n.chart.renderTo),chartPreview.getChartMode(n.chart.renderTo)&&(chartOnLoad.overrideHighchartsEvent(n.chart.renderTo),chartPreview.toggleRectSvg(e,chartPreview.getChartCustomizationEventType())),PivotChartUtility.genratePivotChartFilterJson(n.chart.renderTo,chartOnLoad.getInstanceByChartId(n.chart.renderTo).pivotId),appEvent.trigger("chart.dblclick",[e]))}catch(e){}},Chart.prototype.setLegendPosition=function(e,t,a,r,n,s){var o=this.options;if(this.destroyChart(),t&&(o.legend.layout=t),a&&(o.legend.align=a),r&&(o.legend.verticalAlign=r),o.legend.maxHeight="bottom"!==r&&"top"!==r||"vertical"===t?null:55,o.legend.y=n.y,o.plotOptions[o.chart.type].showInLegend=s,-1!==o.chart.type.indexOf("scatter")||-1!==o.chart.type.indexOf("column")||-1!==o.chart.type.indexOf("bar")||-1!==o.chart.type.indexOf("line")||-1!==o.chart.type.indexOf("spline")||-1!==o.chart.type.indexOf("area"))if(o.series.length>0&&o.series[0].hasOwnProperty("regressionSettings")){for(i=0;i<o.series.length/2;i++)o.series[i].regressionSettings&&(o.series[i].regressionSettings.showInLegend=s);for(i=o.series.length/2;i<o.series.length;i++)o.series[i].showInLegend=s}else if(-1!==o.chart.type.indexOf("line"))for(i=0;i<o.series.length;i++)"pie"!==o.series[i].type&&(o.series[i].showInLegend=o.plotOptions[o.chart.type].showInLegend);if(o.chart.customChartType&&(o.plotOptions.boxplot.showInLegend=s),o.plotOptions[o.chart.type].showInLegend){var l=chartOnLoad.getInstanceByChartId(e).type;o.legend.itemStyle||(o.legend.itemStyle={fontWeight:"normal"}),o.legend.reversed=l&&-1!==l.indexOf("STACKED")&&-1!==t.indexOf("vertical")?!0:!1}o.legend.enabled=s,PivotChartUtility.findTotalNoOfFilterRequired(e,chartOnLoad.getInstanceByChartId(e).pivotId),newChartoptions=PivotChartUtility.setLegendBoundary(o,chartOnLoad.getInstanceByChartId(e).isPivotChart,chartOnLoad.getInstanceByChartId(e).legendPos,chartOnLoad.getInstanceByChartId(e).ht),o=chartGlance.applyregressionLegendPosition(o),o.legend.enabled=s,o.plotOptions.series.animation=!1,o=chartGlance.applySharedLegendInPie(o),chartPreview.getChartMode(o.chart.renderTo)&&(o=chartGlance.applyPointerCursor(o),o=chartOnLoad.applyChartEvents(o),o.chart.zoomType&&(chartPreview.setRemovedZoomType(o.chart.zoomType),o.chart.zoomType="none"),o.tooltip&&(chartPreview.setRemovedTooltipValue(o.tooltip.enabled),o.tooltip.enabled=!1),-1!==o.chart.type.indexOf("pie")&&(o.plotOptions[o.chart.type].allowPointSelect=!1)),this.refreshChart(o,!0),chartOnLoad.doClickHandling(o.chart.renderTo),chartPreview.getChartMode(o.chart.renderTo)&&(chartOnLoad.overrideHighchartsEvent(o.chart.renderTo),chartPreview.toggleRectSvg(e,chartPreview.getChartCustomizationEventType())),PivotChartUtility.genratePivotChartFilterJson(o.chart.renderTo,chartOnLoad.getInstanceByChartId(o.chart.renderTo).pivotId),appEvent.trigger("chart.dblclick",[e])},Chart.prototype.setChartDataLabels=function(e,t){var i=this.options;this.destroyChart();var a=chartOnLoad.getInstanceByChartId(t);switch(e){case"N":i.plotOptions.series.dataLabels={enabled:!1};break;case"V":if("COMBOCHART"===a.type&&a.isSingleYaxis){var r=a.currency,n=chartGlance.filterCurrency(r,i.series?i.series.length:0);if(i.series.length>1)for(var s=0;s<i.series.length;s++)chartGlance.appendDataLables(i,void 0,void 0,chartGlance.pickCurrency(n,s,a.isSingleYaxis),s)}var r=chartOnLoad.getInstanceByChartId(t).currency,n=chartGlance.filterCurrency(r,i.series?i.series.length:0);i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},cSymbol:o?o:"",formatter:function(){var e=a.aggregation.enabled&&"COUNT"!==a.aggregation.type||!a.aggregation.enabled?chartGlance.pickCurrency(n,this.series.index,a.isSingleYaxis):"",t=t,i=i,r=this.point.decimals;return this.y>=0?"%"===e?Highcharts.numberFormat(this.y,r,t,i)+e:e+Highcharts.numberFormat(this.y,r,t,i):"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),r,t,i)+e:"-"+e+Highcharts.numberFormat(Math.abs(this.y),r,t,i)}};break;case"L":if("COMBOCHART"===a.type&&a.isSingleYaxis)for(var s=0;s<i.series.length;s++)i.series[s].dataLabels={};i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return this.key}};break;case"P":i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return Highcharts.numberFormat(this.percentage,2,".")+" %"}};break;case"S":i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return this.series.name}};break;case"S_V":var o=chartOnLoad.getInstanceByChartId(t).currency,n=chartGlance.filterCurrency(o,i.series?i.series.length:0);i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},cSymbol:o?o:"",formatter:function(){var e=a.aggregation.enabled&&"COUNT"!==a.aggregation.type||!a.aggregation.enabled?chartGlance.pickCurrency(n,this.series.index,a.isSingleYaxis):"",t=t,i=i,r=this.point.decimals;return this.y>=0?"%"===e?this.series.name+" ("+Highcharts.numberFormat(this.y,r,t,i)+e+")":this.series.name+" ("+e+Highcharts.numberFormat(this.y,r,t,i)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),r,t,i)+e:this.series.name+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),r,t,i)+")"}};break;case"L_V":var o=chartOnLoad.getInstanceByChartId(t).currency,n=chartGlance.filterCurrency(o,i.series?i.series.length:0);i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},cSymbol:o?o:"",formatter:function(){var e=a.aggregation.enabled&&"COUNT"!==a.aggregation.type||!a.aggregation.enabled?chartGlance.pickCurrency(n,this.series.index,a.isSingleYaxis):"",t=t,i=i,r=this.point.decimals;return this.y>=0?"%"===e?this.key+" ("+Highcharts.numberFormat(this.y,r,t,i)+e+")":this.key+" ("+e+Highcharts.numberFormat(this.y,r,t,i)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),r,t,i)+e:this.key+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),r,t,i)+")"}};break;case"L_P":i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return this.key?this.key+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"S_P":i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return this.series.name?this.series.name+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"V_P":i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return this.y?this.y+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"B":i.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:""},formatter:function(){return this.point.z}}}i=chartGlance.advanceDataLabelSetting(i),i=chartGlance.applySharedLegendInPie(i),i.plotOptions.series.animation=!1,chartPreview.getChartMode(i.chart.renderTo)&&(i=chartGlance.applyPointerCursor(i),i=chartOnLoad.applyChartEvents(i),i.chart.zoomType&&(chartPreview.setRemovedZoomType(i.chart.zoomType),i.chart.zoomType="none"),i.tooltip&&(chartPreview.setRemovedTooltipValue(i.tooltip.enabled),i.tooltip.enabled=!1),-1!==i.chart.type.indexOf("pie")&&(i.plotOptions[i.chart.type].allowPointSelect=!1)),this.refreshChart(i,!0),chartOnLoad.doClickHandling(i.chart.renderTo),chartPreview.getChartMode(i.chart.renderTo)&&chartOnLoad.overrideHighchartsEvent(i.chart.renderTo),PivotChartUtility.genratePivotChartFilterJson(i.chart.renderTo,chartOnLoad.getInstanceByChartId(i.chart.renderTo).pivotId),appEvent.trigger("chart.dblclick",[t])},Chart.prototype.setXLabelsRotation=function(e){var t=this.options;this.destroyChart(),t.xAxis[0].labels.rotation=""===e?null:parseInt(e),t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.updateStagger=function(e){var t=this.options;this.destroyChart(),t.xAxis[0].labels.staggerLines=" "===e?null:e,t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.setMainTitle=function(e){var t=this.options.title.text;this.setTitle({text:ZSEC.Encoder.encodeForHTML(e)});var i=this.options.legend.verticalAlign;if("top"===i&&(e&&!t||!e&&t)){var a=this.options.subtitle.text,r=e&&a?40:e||a?25:0;this.options.legend.y=r,this.options.plotOptions.series.animation=!1,this.refreshChart(this.options,!0)}},Chart.prototype.setChartThreshold=function(e){""!==e?(this.options.plotOptions.series.threshold=e,this.options.plotOptions.series.negativeColor="#FF0000"):(delete this.options.plotOptions.series.threshold,delete this.options.plotOptions.series.negativeColor),this.refreshChart(this.options,!0)},Chart.prototype.setSubTitle=function(e){var t=this.options.subtitle.text;this.setTitle(null,{text:ZSEC.Encoder.encodeForHTML(e)});var i=this.options.legend.verticalAlign;if("top"===i&&(e&&!t||!e&&t)){var a=this.options.title.text,r=a&&e?40:a||e?25:0;this.options.legend.y=r,this.options.plotOptions.series.animation=!1,this.refreshChart(this.options,!0)}},Chart.prototype.setTooltipOption=function(e){var t=this.options;this.destroyChart(),t.tooltip.enabled=e,t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.setAnimation=function(e){var t=this.options;this.destroyChart(),t.plotOptions.series.animation=e,this.refreshChart(t,!0)},Chart.prototype.setTrendlineTypes=function(e){if(-1!==e.indexOf("none")||this.options.series[0].hasOwnProperty("regressionSettings")){var t=this.options;this.destroyChart();var i,a=t.series.length/2,r=t.series.length/2,n=0,s=t.legend.enabled;if(-1!==e.indexOf("none")){$("#trendlineDegree").zcombo("setValue",2),$("#tldegree").hide(),$("#trendlinePeriod").zspinner("setValue",2),$("#tlperiod").hide();for(var o=0,a=0;a<t.series.length;a++)t.series[a].hasOwnProperty("isRegressionLine")&&(o++,delete t.series[a]);t.series.length=t.series.length-o}else{if(-1!==e.indexOf("polynomial")?$("#tldegree").show():($("#trendlineDegree").zcombo("setValue",2),$("#tldegree").hide()),-1!==e.indexOf("average")){$("#tlperiod").show();var l=chartGlance.getMaximumSeriesLength(t.series);$("#trendlinePeriod").zspinner("setMaxValue",l[1]>2?l[1]-1:2)}else $("#trendlinePeriod").zspinner("setValue",2),$("#tlperiod").hide();if(t.series[t.series.length-1].hasOwnProperty("isRegressionLine")){for(;a<parseInt(r);a++)delete t.series[a];t.series.length=Math.round(r)}if(-1===e.indexOf("none"))for(var c=$("#trendlinePeriod").val();n<t.series.length;n++)i=t.series[n].name,void 0===i&&(i="Series "+(n+1)),t.series[n].regression=!0,t.series[n].regressionSettings={regression:!0,type:e,_colorIndex:n,order:2,dashStyle:"ShortDot",name:i+" Trendline",period:c,showInLegend:s},t.series[n].hasOwnProperty("rendered")&&(t.series[n].rendered=!1)}t.plotOptions.series.animation=!0,this.refreshChart(t,!0)}else if(chart.createChart(!0),-1!==e.indexOf("polynomial")&&($("#trendlineDegree").zcombo("setValue",2),$("#tldegree").show()),-1!==e.indexOf("average")){$("#trendlinePeriod").val(2);var l=chartGlance.getMaximumSeriesLength(this.options.series);$("#trendlinePeriod").zspinner("setMaxValue",l[1]>2?l[1]-1:2),$("#tlperiod").show()}},Chart.prototype.setTrendlineDegree=function(e){var t=this.options;this.destroyChart();var i,a,r=t.series.length/2,n=t.series.length/2,s=0;if(t.series[t.series.length-1].hasOwnProperty("isRegressionLine")){for(;n>r;r++)delete t.series[r];t.series.length=n}for(;s<t.series.length;s++)i=t.series[s].name,void 0===i&&(i="Series "+(s+1)),a=t.series[0].regressionSettings.type,t.series[s].regression=!0,t.series[s].regressionSettings={regression:!0,type:a,_colorIndex:s,order:parseInt(e),dashStyle:"ShortDot",name:i+" Trendline"},t.series[s].hasOwnProperty("rendered")&&(t.series[s].rendered=!1);t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.setZoom=function(e){var t=this.options;this.destroyChart(),t.chart.zoomType=e,t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.setMajorGrid=function(e){var t=this.options;this.destroyChart(),t.yAxis[0].gridLineWidth=e;for(var i=0;i<t.yAxis.length;i++)t.yAxis[i].gridLineWidth=e;t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.setMinorGrid=function(e){var t=this.options;this.destroyChart(),t.yAxis[0].minorTickInterval=e,t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.setMarkers=function(e){var t=this.options;this.destroyChart(),t.plotOptions.series.marker||(t.plotOptions.series.marker={}),t.plotOptions.series.animation=!1,t.plotOptions.series.marker.enabled=e,this.refreshChart(t,!0)},Chart.prototype.setXAxisTitle=function(e){if(this.xAxis[0].setTitle({text:ZSEC.Encoder.encodeForHTML(e)}),chartOnLoad.getInstanceByChartId("preview").grouping){var t=this.options,i=t.xAxis.categories?t.xAxis.categories:t.xAxis[0].categories;this.xAxis[0].setCategories(i);var a=t.chart.renderTo,r=$("#"+a).find("svg").siblings(),n=r.splice(0,r.length-1);$(n).remove()}},Chart.prototype.setXLabels=function(e){var t=this.options;this.destroyChart(),e?(t.xAxis[0].tickLength=10,t.xAxis[0].lineWidth=1,$("#xAxisSlant").enable(),$("#slant").zcombo("enable"),$("#xAxisStaggerLines").enable(),$("#StaggerLines").zcombo("enable")):(t.xAxis[0].tickLength=0,t.xAxis[0].lineWidth=0,$("#xAxisSlant").disable(),$("#slant").zcombo("disable"),$("#xAxisStaggerLines").disable(),$("#StaggerLines").zcombo("disable")),t.plotOptions.series.animation=!1,t.xAxis[0].labels.enabled=e,this.refreshChart(t,!0)},Chart.prototype.setYAxisTitle=function(e){this.yAxis[0].setTitle({text:ZSEC.Encoder.encodeForHTML(e)})},Chart.prototype.setYLabels=function(e){var t=this.options;this.destroyChart(),t.yAxis[0].labels.enabled=e,t.plotOptions.series.animation=!1,this.refreshChart(t,!0)},Chart.prototype.updatePlotValue=function(e,t,i,a){var r=chartOnLoad.getInstance("preview"),n=r?r.co.options.series:[];if(a){var s=r&&r.co.options.yAxis[e].plotLines&&r.co.options.yAxis[e].plotLines[i]?r.co.options.yAxis[e].plotLines[i].color:null,o=r&&r.co.options.yAxis[e].plotLines&&r.co.options.yAxis[e].plotLines[i]?r.co.options.yAxis[e].plotLines[i].dashStyle:null;if(""===t)return void this.yAxis[e].removePlotLine("plot-line"+e+"_"+i);var l=s?s:n[e]?n[e].color:"#FF0000",c=o?o:"shortDash";void 0===r.co.options.yAxis[e].plotLines?(this.yAxis[e].plotLines="",this.yAxis[e].addPlotLine({value:t,color:l,dashStyle:c,width:2,id:"plot-line"+e+"_"+i})):(this.yAxis[e].removePlotLine("plot-line"+e+"_"+i),this.yAxis[e].addPlotLine({value:t,color:l,dashStyle:c,width:2,id:"plot-line"+e+"_"+i}))}else{if(""===t)return void this.xAxis[0].removePlotLine("xplot-line0_"+i);var l="#FF0000";void 0===r.co.options.xAxis[0].plotLines?(this.xAxis[0].plotLines="",this.xAxis[0].addPlotLine({value:t,color:l,dashStyle:c,width:2,id:"xplot-line0_"+i})):(this.xAxis[0].removePlotLine("xplot-line0_"+i),this.xAxis[0].addPlotLine({value:t,color:l,dashStyle:c,width:2,id:"xplot-line0_"+i}))}},Chart.prototype.updateYminValue=function(e,t,i){i=""!==i?parseFloat(i):null,this.yAxis[t].update({min:i})},Chart.prototype.updateYmaxValue=function(e,t,i){i=""!==i?parseFloat(i):null,this.yAxis[t].update({max:i})},Chart.prototype.updateYintValue=function(e,t,i){if(i=""!==i?parseFloat(i):null,null!==i){var a=chartOnLoad.getIntervalValue(this.yAxis[t].getExtremes(),i);if(a>i)return showAlertDialog(replaceParams(jsMsg["Chart.YAxis.Interval"],new Array(a.toString()))),void $("#"+t).focus()}this.yAxis[t].update({tickInterval:i})},Chart.prototype.getIntervalValue=function(e){return this.yAxis[e]?this.yAxis[e].getExtremes():null},Chart.prototype.setYAxisSecTitle=function(e){var t=chartPreview.getAxisOptionsIndex(),i=chartOnLoad.getInstanceByChartId("preview")&&-1!==chartOnLoad.getInstanceByChartId("preview").type.indexOf("BAR")?0:270;this.yAxis[t].setTitle({text:ZSEC.Encoder.encodeForHTML(e),rotation:i})},Chart.prototype.setYLabelsSec=function(e){var t=this.options;this.destroyChart(),t.yAxis[chartPreview.getAxisOptionsIndex()].labels.enabled=e,t.plotOptions.series.animation=!1,this.refreshChart(t,!0)};var chartPreview=function(){function e(e){e.title.text=chartPreview.decodeHTMLContent(e.title.text),e.subtitle.text=chartPreview.decodeHTMLContent(e.subtitle.text);for(var t=e.xAxis.length,i=0;t>i;i++)e.xAxis[i].title.text=chartPreview.decodeHTMLContent(e.xAxis[i].title.text);t=e.yAxis.length;for(var i=0;t>i;i++)e.yAxis[i].title.text=chartPreview.decodeHTMLContent(e.yAxis[i].title.text);return e}var t,a,r,n,s,o,l,c,d,h,p,g,u,f,v=!0,x=!1,y=!1,b=!1,A=!0,m="xy",O="1px solid lightgray",C=0,L="",S="",I="",T="",w="",k="",P=0,R=new Array,E=function(e){g=e},B=function(){return g},N=function(e){return Chart.container[WorkSheets.getAssociatedActiveSheetName()]&&Chart.container[WorkSheets.getAssociatedActiveSheetName()][e]?Chart.container[WorkSheets.getAssociatedActiveSheetName()][e].co:null},F=function(e){var t=WorkSheets.getAssociatedActiveSheetName(),i=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!i&&v)i="preview";else if(!i&&!v)return;chartOnLoad.addAxisOptionsIndex(i,t,e)},W=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!t&&v)t="preview";else if(!t&&!v)return;return P=chartOnLoad.getAxisOptionsIndex(t,e)},M=function(e){var t=WorkSheets.getAssociatedActiveSheetName(),i=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!i&&v)i="preview";else if(!i&&!v)return;chartOnLoad.addDepthIndices(i,t,e)},D=function(e,t){var i=$(t).parent().parent().attr("datatype"),a=$(t).val(),r=$(t).attr("label");if("checked"==$(t).attr("checked")){var n=depthDragDrop.loadDraggableComponent(a,i,r);-1==n&&$(t).attr("checked",!1)}else depthDragDrop.removeDraggableComponent(r,i)},H=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;return t||(t="preview"),depthIndices=chartOnLoad.getDepthIndices(t,e)},z=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;t||(t="preview"),chartOnLoad.clearDepthIndices(t,e)},j=function(e){var t=WorkSheets.getAssociatedActiveSheetName(),i=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!i&&v)i="preview";else if(!i&&!v)return;chartOnLoad.addAxisOptionsObj(i,t,e)},G=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!t&&v)t="preview";else if(!t&&!v)return;return R=chartOnLoad.getAxisOptionsObj(t,e)},V=function(e){return null!==chartOnLoad.getInstanceByChartId(e)?"COMBOCHART"===chartOnLoad.getInstanceByChartId(e).type:null},U=function(e,t){var i=new Array,a=e.chart.renderTo,r=chartOnLoad.getInstanceByChartId(a)&&-1!==chartOnLoad.getInstanceByChartId(a).type.indexOf("COMBOCHART");if(t=t?t:e.comboChartTypes||r?"COMBOCHART":"","COMBOCHART"===t)for(var n=e.series,s=0;s<n.length;s++)i.push(n[s].type);return i},_=function(e){var t=new Array,i=e.chart.renderTo,a=chartOnLoad.getInstanceByChartId(i)&&-1!==chartOnLoad.getInstanceByChartId(i).type.indexOf("COMBOCHART");if(chartType=e.comboChartTypes||a?"COMBOCHART":e.chart.type,"COMBOCHART"===chartType){for(var r=e.series,n=0;n<r.length;n++)t.push(r[n].type);return t}return chartType},Y=function(e){h=e},q=function(){return h};appEvent.on("sheet.horizontallyScrolled sheet.verticallyScrolled",function(){chartPreview.hideContextualToolbar(r,!0)}),appEvent.on("body.mousedown",function(e){chartPreview.hideColorPallate(e)}),appEvent.on("chart.zcombo",function(e,t){yt(e,t)}),appEvent.on("chart.zspinner",function(e,t){ft(e,t)}),appEvent.on("chart.callback",function(){rangeSelectorChart.setDataRangeChanged(!0),Ea()}),appEvent.on("chart.depthHeaders",function(){ja("depthHeaders")}),appEvent.on("chart.title",function(){ja("chartTitle")}),appEvent.on("chart.subtitle",function(){ja("chartSubTitle")}),appEvent.on("chart.xAxistitle",function(){ja("xAxisTitle")}),appEvent.on("chart.yAxistitle",function(){ja("yAxisTitle")}),appEvent.on("chart.yAxistitle1",function(){ja("yAxisTitle1")}),appEvent.on("chart.change",function(){var e=$("#chartDialog").find(":input");e.bind("change",function(){ut(this)}),$("#previewAn").bind("click",function(){ka()}),$("#chartTitle").bind("keyup",function(){ti("preview")}),$("#chartSubTitle").bind("keyup",function(){ni("preview")}),$("#threshold").bind("keyup",function(){si("preview")}),$("#xAxisTitle").bind("keyup",function(){Ci("preview")}),$("[id^=plotLineValue]").bind("keyup",function(){Wi(this,!0)}),$("[id^=xplotLineValue]").bind("keyup",function(){Wi(this,!1)}),$("[id^=yAxisTitle]").bind("keyup",function(){zi("preview")}),$("#tooltipToggle").change(function(){oi($("#tooltipToggle").is(":checked"),"preview")}),$("#animationToggle").change(function(){yi($("#animationToggle").is(":checked"),"preview")}),$("#zoomToggle").change(function(){bi($("#zoomToggle").is(":checked"),"preview")}),$("#markerToggle").change(function(){Oi($("#markerToggle").is(":checked"),"preview")}),$("#xAxisLabelToggle").change(function(){$i($("#xAxisLabelToggle").is(":checked"),"preview")}),$("#xAxisReverse").change(function(){chart.createChart(!0)}),$("[id^=yAxisReverse]").change(function(){chart.createChart(!0)}),$("[id^=yAxisLogarithmic]").change(function(){chart.createChart(!0)}),$("[id^=baseValue]").change(function(){chart.createChart(!0)}),$("#yAxisLabelToggle").change(function(){Ni($("#yAxisLabelToggle").is(":checked"),"preview")}),$("#hideCellsToggle").change(function(){chart.createChart(!0)}),$("#clickAgg1").click(function(){chartPreview.showAggregationTab()}),$("[id^='yaxisLabYes']").change(function(){ji($("#yaxisLabYes"+chartPreview.getAxisOptionsIndex()).is(":checked"),"preview")}),$("#multiyaxisYes").change(function(){Li($("#multiyaxisYes").is(":checked"),"preview")}),$("#options").click(function(){$("#chartTitle").focus()}),$("#general").click(function(){$("#dataRange").focus()}),$("#axis").click(function(){$("#xAxisTitle").focus()}),$("#chartThemePallate").bind("click",function(){$(".cDialogPaletteHolder").show();var e=document.getElementById("chartThemePallate"),t=e.dataset.name,i=e.dataset.basecolor,a="true"==e.dataset.reversed?!0:!1,r=".colorpaletteDialog li[data-name="+t+"]",n=$("#colorpaletteContainer").find(".active");if($(n).removeClass("active"),-1!==t.indexOf("CUSTOM"))$(".colorCustomPallete").addClass("active"),$(".colorCustomPallete").css("background-image",SheetChartColor(i).getLinerGradient(6)),$(".colorCustomPallete").attr("data-basecolor",i);else{var s=$(r);$(s).addClass("active")}-1==t.indexOf("COLORFUL")&&(Ct(a),$("#customColorToggle").prop("checked",a))}),$("#customColorToggle").click(function(){$t($("#customColorToggle").is(":checked"))}),$(".colorDialogCustomPallete").bind("click",function(){var e=$("#colorpaletteContainer").find(".active");$(e).removeClass("active"),chartPreview.changeChartTheme("preview",this,e,!1)}),$("#chartcustomcolorDropDown").bind("colorpalettecolorselected",function(e,t){var i=t.color,a=SheetChartColor(i).getLinerGradient(6);$(".colorCustomPallete").css("background-image",a),$(".colorCustomPallete").attr("data-basecolor",i),$($("#chartcustomcolorDropDown span")[0]).css("background",i);var r=$("#colorpaletteContainer").find(".active");$(r).hasClass("colorCustomPallete")||$(r).removeClass("active");var n=document.getElementsByClassName("colorDialogCustomPallete")[0];chartPreview.changeChartTheme("preview",n,r,!1),e.stopPropagation()}).bind("colorpaletteshow",function(e,t){var i=$($("#chartcustomcolorDropDown span")[0]).css("background");$(t.colorpalette[0]).zcolorpalette("setColor",chartGlance.getRGBAToRGB(i))}),$(document).mousedown(function(e){for(var t=["togglecustomColor","customColorToggle","cPaletteHolder","cPaletteCode","ui-zadvcolorpalette-bar","ui-zspinner-down","ui-zspinner-up","ui-zadvcolorpalette-spinnerpane","ui-zspinner-content","ui-zadvcolorpalette-swatchmain","ui-zcolorpalette-colors-container","ui-zcolorpalette-morecolors-text","ui-zcolorpalette-shadecontainer","ui-dialog","ui-button","ui-button-icon-primary"],i=0;i<t.length;i++)if(e.target.parentElement&&($(e.target.parentElement).hasClass(t[i])||e.target.parentElement.parentElement&&$(e.target.parentElement.parentElement).hasClass(t[i]))&&!$(e.target).hasClass("cPaletteClose"))return;$(".cDialogPaletteHolder").hide()}),$(".colorpaletteDialog li").on("click",function(){var e=$("#colorpaletteContainer").find(".active");$(e).removeClass("active"),chartPreview.changeChartTheme("preview",this,e,!1)})}),$("#chartFontColorDropDown,#chartFontColor2").bind("colorpalettecolorselected",function(e,t){var i=-1!==t.color.indexOf("transparent")?"#000000":-1!==t.color.indexOf("default")?"#000000":t.color;ai(i),ei(r)}).bind("colorpaletteshow",function(e,t){$(t.colorpalette[0]).zcolorpalette("setColor",chartGlance.getRGBAToRGB(p)),$($(".ui-zcolorpalette-default").children(0).children("span")[0]).css("background-color","#000000"),$($(".ui-zcolorpalette-default").children(0).children("span")[0]).removeClass("ui-icon-transparent")}).bind("colorpalettehide",function(){O="none",$($(".ui-zcolorpalette-default").children(0).children("span")[0]).addClass("ui-icon-transparent").css("border",O)}),$("#chartFontSize").bind("combochange",function(e,t){Jt(r,t.value)}),$("#linetypeeditmenufonts").bind("click",function(e){var t="LI"==$($(e)[0].srcElement).prop("tagName")?$($(e)[0].srcElement).attr("id"):$($($(e)[0].srcElement).parents("li")).attr("id");qt(r,t)}),$("#chartfontfamilys").bind("combochange",function(e,t){X(r,t.value)}),$("#chartbgcolorDropDown,#chartbgcolor2, #chartbgcolorFonts2").bind("colorpalettecolorselected",function(e,t){var i=-1!==t.color.indexOf("transparent")?"#FFFFFF":-1!==t.color.indexOf("default")?"#FFFFFF":t.color;-1!==s.indexOf("series")&&-1!==i.indexOf("#FFFFFF")&&(i=$($(".ui-zcolorpalette-default").children(0).children("span")[0]).css("background-color")),ai(i),gt(!1)}).bind("colorpaletteshow",function(e,i){var o,d="#FFFFFF";if(-1!==s.indexOf("series")){o=a.color?a.color:t.color,o||(o=n);var h=chartOnLoad.getInstanceByChartId(r),p=h.co.options.colors;d=p[(l?l:c)%p.length]}else-1!==s.indexOf("chartArea")?o=N(r).userOptions.chart.plotBackgroundColor:-1!==s.indexOf("canvas")&&(o=chartGlance.getColorCodeFromGradient(N(r).userOptions.chart.backgroundColor));o&&$(i.colorpalette[0]).zcolorpalette("setColor",chartGlance.getRGBAToRGB(o)),$($(".ui-zcolorpalette-default").children(0).children("span")[0]).css("background-color",d).css("border",O),$($(".ui-zcolorpalette-default").children(0).children("span")[0]).removeClass("ui-icon-transparent")}).bind("colorpalettehide",function(){$($(".ui-zcolorpalette-default").children(0).children("span")[0]).addClass("ui-icon-transparent").css("border",O)}),$("#GridColorDropDown,#chartgridcolor2").bind("colorpalettecolorselected",function(e,t){var i=-1!==t.color.indexOf("transparent")?"rgb(222,222,222)":-1!==t.color.indexOf("default")?"rgb(222,222,222)":t.color;ai(i),Yt(r)}).bind("colorpaletteshow",function(e,t){var i;i=N(r).userOptions.yAxis[0].gridLineColor,i&&$(t.colorpalette[0]).zcolorpalette("setColor",chartGlance.getRGBAToRGB(i)),$($(".ui-zcolorpalette-default").children(0).children("span")[0]).css("background-color","rgb(222,222,222").css("border",O),$($(".ui-zcolorpalette-default").children(0).children("span")[0]).removeClass("ui-icon-transparent")}).bind("colorpalettehide",function(){$($(".ui-zcolorpalette-default").children(0).children("span")[0]).addClass("ui-icon-transparent").css("border",O)}),$("#customTitle").bind("change",function(){Gt(r)}),$("#chartbold").click(function(){Ut(r)}),$("#chartmenucustomcolorDropDown").bind("colorpalettecolorselected",function(e,t){var i=t.color,a=SheetChartColor(i).getLinerGradient(6);$(".colorMenuCustomPallete").css("background-image",a),$(".colorMenuCustomPallete").attr("data-basecolor",i);var r=$(".cMenuPaletteHolder").find(".active"),n=document.getElementsByClassName("colorMenuCustomPallete")[0];chartPreview.changeChartTheme(ole.getCurrObj().id,n,r,!0),$(".cMenuPaletteHolder").hide()}).bind("colorpaletteshow",function(e,t){var i=$($("#chartmenucustomcolorDropDown span")[0]).css("background");$(t.colorpalette[0]).zcolorpalette("setColor",chartGlance.getRGBAToRGB(i))}),$(".cMenuPaletteHolder li,.colorMenuCustomPallete").click(function(){var e=$(".cMenuPaletteHolder").find(".active");$(e)[0]!=$(this)[0]&&$(e).removeClass("active"),chartPreview.changeChartTheme(ole.getCurrObj().id,this,e,!0),$(".cMenuPaletteHolder").toggle()}),$("#customMenuColorToggle").click(function(){$t($("#customMenuColorToggle").is(":checked"),ole.getCurrObj().id,!0)}),$("#chartitalic").click(function(){_t(r)}),$("#slant1").bind("combochange",function(e,t){Vt(r,t.value)}),$("#min").bind("change",function(){Xt(r)}),$("#max").bind("change",function(){Kt(r)}),$("#interval").bind("change",function(){Zt(r)}),$("#legend1").bind("combochange",function(e,t){Gi(),kt(t.value,r,"true")}),$("#colorSlider").bind("zsliderchange",function(e,t){Qt(r,t.value)}),$("#charttypemenu").on("click",function(e){var t=$($(e)[0].target).parents("li").attr("id"),i=new Array,a=ole.getCurrObj().id,r=chartOnLoad.getInstanceByChartId(a).co.series,n=-1!==chartOnLoad.getInstanceByChartId(a).type.indexOf("TIME"),s=-1!==chartOnLoad.getInstanceByChartId(a).type.indexOf("BULLET"),o=!1,l=!1,c=-1!==t.indexOf("col")?"col":-1!==t.indexOf("bar")?"bar":-1!==t.indexOf("area")?"area":"";if(o=J(t,r,"stacked",c),s)for(var d=0;d<r.length;d++)i.push(chart.getChartCodeFromChartName(t));else{if(n)return void Et(a,107,chart.getChartCodeFromChartName(t).toUpperCase());for(var d=0;d<r.length;d++)if(r[d].type!==L||r[d].index!==w||r[d].userOptions.hasOwnProperty("isRegressionLine")){if(!r[d].userOptions.hasOwnProperty("isRegressionLine")){var h=r[d].type;h="pie"==h&&r[d].userOptions&&"doughnut"==r[d].userOptions.major?"doughnut":h,h="pie"==h&&r[d].userOptions&&"semidoughnut"==r[d].userOptions.major?"semidoughnut":h;var p="column"==h&&"normal"==r[d].options.stacking?"col":"";if(p="bar"==h&&"normal"==r[d].options.stacking?"bar":p,p="area"==h&&"normal"==r[d].options.stacking?"area":p,h="line"==h&&1==r[d].options.step?"stepline":h,""==p||-1===p.indexOf("col")&&-1===p.indexOf("bar")&&-1===p.indexOf("area")){if(""!=c&&(-1!==c.indexOf("col")||-1!==c.indexOf("bar")||-1!==c.indexOf("area"))){o=J(t,r,"stacked",c);var g=Q(o,l,chart.getChartCodeFromChartName(r[d].type).toLowerCase(),c);h=-1!==g.indexOf("col")||-1!==g.indexOf("bar")||-1!==g.indexOf("area")?g:h}}else o=J(t,r,"stacked",p),h=Q(o,l,chart.getChartCodeFromChartName(r[d].type).toLowerCase(),p);i.push(chart.getChartCodeFromChartName(h))}}else""!=c&&(t=Q(o,l,t,c)),i.push(chart.getChartCodeFromChartName(t))}previousChartType="COMBOCHART",Et(a,107,i.join().toUpperCase())}),$("#linetypeeditmenu").on("click",function(e){var i="LI"==$($(e)[0].srcElement).prop("tagName")?$($(e)[0].srcElement).attr("id"):$($($(e)[0].srcElement).parents("li")).attr("id"),a=ole.getCurrObj().id,r=(chartOnLoad.getInstanceByChartId(a).co,isUndefined(c)?t.index:c),n=[{dashStyle:i,sIndex:r}];chartPreview.setDashStyle(r,i);var s=new AjaxRequest,o=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);o.setParameters(WorkSheets.getAssociatedActiveSheetName(),a,121,JSON.stringify(n)),s.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(s)});var J=function(e,t,i,a){var r=!1;if(-1!==e.indexOf(a)&&-1!==e.indexOf(i))r=!0;else if(-1==e.indexOf(a)){for(var n=0;n<t.length;n++)if(t[n].options.stacking&&("stacked"===i&&"normal"===t[n].options.stacking||"percent"===i&&"percent"===t[n].options.stacking)){r=!0;break}}else-1!==e.indexOf(a)&&-1===e.indexOf(i)&&(r=!1);return r},Q=function(e,t,i,a){if(-1===i.indexOf(a))return i;if(e&&t){if(-1!==i.indexOf("stacked")&&-1!==i.indexOf("percent"))return i;if(-1==i.indexOf("stacked"))return"stacked"+i+"percent";if(-1!=i.indexOf("stacked")&&-1==i.indexOf("percent"))return i+"percent"}else if(e){if(-1!==i.indexOf("stacked"))return i;if(-1==i.indexOf("stacked"))return"stacked"+i}else if(!e||!t)return i},X=function(e,t){var i=N(e),a=i.userOptions;a.chart.style?a.chart.style.fontFamily=t:a.chart.style={fontFamily:t};var r=[{style:a.chart.style}],n=new AjaxRequest,s=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);s.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,114,JSON.stringify(r)),n.init("POST",s.getURL(),!0,s.getParametersAsString()),actionManager.addRequest(n),a.plotOptions.series.animation=!1,i.refreshChart(a,!0),chartOnLoad.doClickHandling(a.chart.renderTo),appEvent.trigger("chart.dblclick",[e])},K=function(e,t){x=e;var i=WorkSheets.getAssociatedActiveSheetName(),a=t||(ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null);a&&(chartOnLoad.addChartStateById(i,a,e),e?($("#"+q()+" > #OleEditModeMenu").addClass("oleChartActive1"),$("#"+q()+" > #OleViewModeMenu").removeClass("oleChartActive1")):($("#"+q()+"> #OleViewModeMenu").addClass("oleChartActive1"),$("#"+q()+"> #OleEditModeMenu").removeClass("oleChartActive1")))},Z=function(e){d="",d=e},et=function(e){for(var t=["toggleMenuCustomCheckBox","colorMenuCustomPallete","cPaletteHolder","cPaletteCode","ui-zadvcolorpalette-bar","ui-zspinner-down","ui-zspinner-up","ui-zadvcolorpalette-spinnerpane","ui-zspinner-content","ui-zadvcolorpalette-swatchmain","ui-zcolorpalette-colors-container","ui-zcolorpalette-morecolors-text","ui-zcolorpalette-shadecontainer","ui-button-icon-primary"],i=0;i<t.length;i++)if(e&&e.target&&e.target.parentElement&&("chartColPallate"==e.target.parentElement.id||"pivotchartColPallate"==e.target.parentElement.id||"chartmenucustomcolorDropDown"==e.target.parentElement.id||$(e.target.parentElement).hasClass(t[i])||e.target.parentElement.parentElement&&$(e.target.parentElement.parentElement).hasClass(t[i])))return;$(".cMenuPaletteHolder").hide()},tt=function(e){var t=WorkSheets.getAssociatedActiveSheetName(),i=e||(ole.isActive()?ole.getCurrObj().id:""),a=chartOnLoad.getChartStateById(t,i);return a},it=function(e,t,i){var a=chartOnLoad.getInstanceByChartId(i);return"series"===e&&t&&"pie"===a.co.series[t].type},at=function(){return d&&-1!==d.indexOf("canvas")?"canvas":"stopPropagation"},rt=function(){return x},nt=function(e){y=e},st=function(){return y?y:!1},ot=function(){return m?m:"none"},lt=function(e){m=e},ct=function(e,t){var i=WorkSheets.getAssociatedActiveSheetName(),a=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!a&&v)a="preview";else if(!a&&!v)return;chartOnLoad.addDashStyle(a,i,e,t)},dt=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()?ole.getCurrObj().id:null;if(!t&&v)t="preview";else if(!t&&!v)return;return dashStyle=chartOnLoad.getDashStyle(t,e)},ht=function(e){A=e,Gi()},pt=function(){return A},gt=function(e){if(!e){var i=chartGlance.getRGBA(n,parseFloat(parseFloat((100-$("#colorSlider").zslider("getValue"))/100).toFixed(1)));ai(i)}if(-1!==s.indexOf("chartArea")){var o=N(r);n=n?n:"#FFFFFF",o.update({chart:{plotBackgroundColor:n}});var d=[{pbc:n}],h=new AjaxRequest,p=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);-1===N(r).options.chart.type.indexOf("pie")&&-1===N(r).options.chart.type.indexOf("funnel")&&p.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,109,JSON.stringify(d)),h.init("POST",p.getURL(),!0,p.getParametersAsString()),actionManager.addRequest(h)}else if(-1!==s.indexOf("canvas")){var o=N(r);n=n?n:"#FFFFFF",o.update({chart:{backgroundColor:n}});var d=[{cbc:n}],h=new AjaxRequest,p=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);p.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,108,JSON.stringify(d)),h.init("POST",p.getURL(),!0,p.getParametersAsString()),actionManager.addRequest(h)}else if(-1!==s.indexOf("xplotLine")){var o=N(r);n=n?n:"#FFFFFF";var g=s.split(".")[1],u=0,f=g.split("_")[1]-1,v=chartOnLoad.getInstance(r).co.options.xAxis[0].plotLines;v[f].color=n,o.xAxis[0].update({plotLines:v});var d=[{isYAxis:!1,cbc:n,index:u,plIndex:f}],h=new AjaxRequest,p=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);p.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,135,JSON.stringify(d)),h.init("POST",p.getURL(),!0,p.getParametersAsString()),actionManager.addRequest(h)}else if(-1!==s.indexOf("plotLine")){var o=N(r);n=n?n:"#FFFFFF";var g=s.split(".")[1],x=g.split("_")[0]-1,f=g.split("_")[1]-1,v=chartOnLoad.getInstance(r).co.options.yAxis[x].plotLines;v[f].color=n,o.yAxis[x].update({plotLines:v});var d=[{isYAxis:!0,cbc:n,index:x,plIndex:f}],h=new AjaxRequest,p=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);p.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,135,JSON.stringify(d)),h.init("POST",p.getURL(),!0,p.getParametersAsString()),actionManager.addRequest(h)}else if(-1!==s.indexOf("series")){var d=[],o=N(r),y="",b=!0;y=o.options.chart.type,V(r)&&(y=o.options.series[t.index||c].type,b=chartPreview.isPieChart(o.options,c)),d=!b||-1===y.indexOf("pie")&&-1===y.indexOf("funnel")&&-1===y.indexOf("waterfall")?b?[{pIndex:a.index||l,cValue:n,sIndex:t.index||c,isSeriesLevel:ga(r,c)}]:[{pIndex:a.index||l,cValue:n,sIndex:t.index||c,isSeriesLevel:!1}]:[{pIndex:a.index||l,cValue:n,sIndex:a.index||l,isSeriesLevel:!0}];var h=new AjaxRequest,p=new RequestParameters(ActionConstants.CHART_QUICK_STYLE);p.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,112,JSON.stringify(d)),h.init("POST",p.getURL(),!0,p.getParametersAsString()),actionManager.addRequest(h),h.addEventListener("onComplete",function(){var e=N(r),i=e.userOptions,s=!ga(r,c),o="",d=chartOnLoad.getInstanceByChartId(r);o=i.chart.type,"COMBOCHART"===d.type&&(o=i.series[t.index||c]?i.series[t.index||c].type:"");var s=!ga(r,c);if(-1!==o.indexOf("pie"))if("COMBOCHART"===d.type)i.series[t.index||c].data[a.index||l].color=n,e.series[t.index||c].data[a.index||l].update({color:n});else for(var h=0;h<i.series.length&&!s;h++)i.series[h].data[a.index||l].color=n,e.series[h].data[a.index||l].update({color:n});else-1!==i.chart.type.indexOf("funnel")||-1!==i.chart.type.indexOf("waterfall")?(i.series[0].data[a.index||l].color=n,e.series[0].data[a.index||l].update({color:n})):s?(i.series[t.index||c].data[a.index||l].color=n,e.series[t.index||c].data[a.index||l].update({color:n})):(i.series[t.index||c].color=n,e.series[t.index||c].update({color:n}));i.plotOptions.series.animation=!1,e.refreshChart(e,!0,void 0,!0)})}var A="3px solid "+chartGlance.getRGBA(n,1);$("#chartbgcolor2").css("border-bottom",A)},ut=function(e){switch(e.id){case"frl":case"fcl":chart.createChart(!0),xt(e.id),za(!1);break;case"includeCells":case"dntIncludeCells":case"horizontal":case"vertical":chart.createChart(!0),za(!1);break;case"rows":case"columns":Ca(e);break;case"threshold":si("preview");break;case"floating":mt("preview");break;case"chartTitle":ti("preview");break;case"chartSubTitle":ni("preview");break;case"tooltipYes":case"tooltipNo":oi(e.id,"preview");break;case"animationYes":case"animationNo":yi(e.id,"preview");break;case"zoomYes":case"zoomNo":bi(e.id,"preview");break;case"glMajor":Ai("preview",e);break;case"glMinor":mi("preview",e);break;case"xAxisTitle":Ci("preview");break;case"xaxisLabYes":case"xaxisLabNo":$i(e.id,"preview");break;case"markersYes":case"markersNo":Oi("preview",e.id);break;case"previewAnchor":ka();break;case"trendlinePeriod":Pt(e.value,"preview");break;case"dataRange":rangeSelectorChart.setDataRangeChanged(!0),Ea()}if(-1!==e.id.indexOf("plotLineValue")){var t=$(e).attr("index");Fi("preview",e.id,t,!0)}else if(-1!==e.id.indexOf("xplotLineValue")){var t=$(e).attr("index");Fi("preview",e.id,t,!1)}else-1!==e.id.indexOf("ymin")?Mi("preview",e.id):-1!==e.id.indexOf("ymax")?Di("preview",e.id):-1!==e.id.indexOf("yinterval")?Hi("preview",e.id):-1!==e.id.indexOf("yAxisTitle")?"yAxisTitle"==e.id?Bi("preview"):zi("preview"):(-1!==e.id.indexOf("yaxisLabYes")||-1!==e.id.indexOf("yaxisLabNo"))&&ji(e.id,"preview")},ft=function(e,t){if(v)switch(e){case"changeTrendlinePeriod":Pt(t,"preview");break;case"changeFilterLimit":if(0==t){showAlertDialog(jsMsg["Chart.Filter.invalidLimit"]);var i=chartOnLoad.getInstanceByChartId("preview");if(i){var a=i.co.options.filter?i.co.options.filter:null,r=a?a.limit:0;$("#filterSpinner").zspinner("setValue",r),$("#filterSpinner").focus()}return}vt()&&chart.createChart(!0)}},vt=function(){var e=!1;if(!chartOnLoad.getInstanceByChartId("preview"))return!0;var t=chartOnLoad.getInstanceByChartId("preview").co.options.filter;return t&&"NONE"!=t.type?e=t&&t.type===$("#filterType").zcombo("getValue")&&parseInt(t.limit)===$("#filterSpinner").zspinner("getValue")&&t.limitByName===$("#filterColumns").zcombo("getValue")?!1:!0:"NONE"!==$("#filterType").zcombo("getValue")&&parseInt($("#filterSpinner").zspinner("getValue"))>0&&parseInt($("#filterSpinner").zspinner("getValue"))<=10&&"NONE"!==$("#filterColumns").zcombo("getValue")&&(e=!0),e},xt=function(){var e=getObj("columns").checked?"COLS":"ROWS",t=(chartPreview.getDepthIndices()[0],!1);t="COLS"==e?$("#frl").is(":checked"):$("#fcl").is(":checked"),t=isUndefined(t)?!0:t,depthDragDrop.refreshAllCombos(null,!1,t,!0,!0)},yt=function(e,t){switch(e){case"changeLegend":kt(t,"preview");break;case"changeTrendLine":Rt(t,"preview");break;case"changeDataLabelss":Bt(t,"preview");break;case"changeTrendLineDegree":Pt(t,"preview");break;case"changeLabelRotation":Ft(t,"preview");break;case"changeStaggerLines":Wt(t,"preview");break;case"toggleYaxis":Si(t);break;case"changeCombineRange":Ot();break;case"aggreOperationChanged":depthDragDrop.checkIfAggregationEnabled()&&_a(),depthDragDrop.calculateHeaders(".aggHldr",!0);break;case"aggregationChanged":li("NONE"!==$("#aggregation").zcombo("getValue"),"preview");break;case"filterColumnChanged":vt()&&chart.createChart(!0);break;case"binningTypeChanged":chart.createChart(!0);break;case"filterTypeChanged":depthDragDrop.checkIfAggregationEnabled()&&"COUNT"==$("#aggreoperation").zcombo("getValue")&&(chart.unloadExistingColumnsInFilter(),Ya()),"NONE"==t?(chart.resetFilterOptions(),chart.disableFilterColumns()):(chart.enableFilterColumns(),bt()),vt()&&chart.createChart(!0)}if(!v){var i=$("#trendlineTypes").val();null!==i&&-1===i.toLowerCase().indexOf("polynomial")?($("#trendlineDegree").zcombo("setValue",2),$("#tldegree").hide()):$("#tldegree").show(),null!==i&&-1===i.toLowerCase().indexOf("average")?($("#trendLinePeriod").zspinner("setValue",2),$("#tlperiod").hide()):$("#tlperiod").show()}},bt=function(){$("#filterSpinner").zspinner("setValue","5"),$("#filterColumns").zcombo("setSelectedIndex",1)},At=function(e,t){e?($("#filterColumns").zcombo("hide"),$("#filterSpinner").parent().hide()):(t||($("#filterColumns").zcombo("show"),$("#filterColumns").zcombo("refresh")),$("#filterSpinner").parent().show())},mt=function(e){var t=$("#floating").is(":checked");N(e).setFloatingOption(t)},Ot=function(){var e=chartOnLoad.getInstanceByChartId("preview");rangeSelectorChart.setDataRangeChanged(!0),e.aggregation.enabled?Wa(e.dataRange):(chart.createChart(!0),za(!1))},Ct=function(e,t){for(var i,a=t?$("#chartMenuCPalletteCode").children():$("#chartDialogCPalletteCode").children(),r=0;r<a.length;r++)i=a[r],i.setAttribute("data-reversed",e);if(t)$(".colorMenuCustomPallete").attr("data-reversed",e);else{$(".colorCustomPallete").attr("data-reversed",e);var n=document.getElementById("chartThemePallate");-1==n.dataset.name.indexOf("COLORFUL")&&$("#chartThemePallate").attr("data-reversed",e)}},$t=function(e,t,i){Ct(e,i),t=t?t:"preview",chartObj=N(t);var a,r,n,s=chartObj.options,o=s.colorOptions.colorTheme;if(i)a=o.name,r=o.basecolor,n=e;else{var l=document.getElementById("chartThemePallate");a=l.dataset.name,r=l.dataset.basecolor,n=e}-1==a.indexOf("COLORFUL")&&(chartObj.updateChartTheme(t,r,void 0,a,e),i&&wt(t,a,r,e))},Lt=function(e){var t=/\d+/g,i=e.match(t);return-1!==e.indexOf("COLORFUL")?e:-1!==e.indexOf("CUSTOM")?"SHEET-OFFICE-COLORFUL-THEME1":i>=1&&6>=i?"SHEET-OFFICE-COLORFUL-THEME1":i>=7&&12>=i?"SHEET-OFFICE-COLORFUL-THEME2":i>=13&&18>=i?"SHEET-OFFICE-COLORFUL-THEME3":"SHEET-OFFICE-COLORFUL-THEME4"},St=function(){var e={};return e["SHEET-OFFICE-COLORFUL-THEME1"]={startIndex:1,endIndex:6,basecolor:["#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"]},e["SHEET-OFFICE-COLORFUL-THEME2"]={startIndex:7,endIndex:12,basecolor:["#a0ce3a","#49bfc9","#f99a00","#ef4e31","#bf3870","#fecd44"]},e["SHEET-OFFICE-COLORFUL-THEME3"]={startIndex:13,endIndex:18,basecolor:["#d79a49","#db6e51","#7ebea3","#e6d561","#6ea2b7","#76566e"]},e["SHEET-OFFICE-COLORFUL-THEME4"]={startIndex:19,endIndex:24,basecolor:["#764852","#cbc4bc","#cf6c59","#e4bb61","#81a077","#e19351"]},e["SHEET-OFFICE-COLORFUL-THEME5"]={startIndex:25,endIndex:30,basecolor:["#3F8CE8","#63CA60","#F3C041","#ED8F32","#E64285","#C35ADD"]},e["SHEET-OFFICE-COLORFUL-THEME6"]={startIndex:31,endIndex:35,basecolor:["#3498DB","#2ECC71","#F1C40F","#E67E22","#EE4675","#9B59B6"]},e},It=function(e,t){e=Lt(e);var a,r=St(),n=r[e],s="SHEET-OFFICE-MONOCHORMATIC-THEME",o="",l=$(t?".colorpaletteDialogMonochromatic li":".colorpaletteMenuMonochromatic li");for(i=n.startIndex;i<=n.endIndex;i++)a=n.basecolor[i-n.startIndex],o=SheetChartColor(a).getLinerGradient(6),$(l[i-n.startIndex]).attr({"data-basecolor":a,"data-name":s+i}).css("background-image",o)},Tt=function(e,t,i,a){var r=$(t).css("background-image");e=e?e:"preview";var n=t.dataset.basecolor,s=t.dataset.name,o=N(e),l=t.dataset.reversed;-1!==s.indexOf("COLORFUL")&&It(s,-1!==e.indexOf("preview")),a||($("#chartThemePallate").css("background-image",r),$("#chartThemePallate").attr("data-name",s),$("#chartThemePallate").attr("data-basecolor",n),$("#chartThemePallate").attr("data-reversed",l),StyleObject.colorObject.colorTheme.name=s,StyleObject.colorObject.colorTheme.basecolor=n,StyleObject.colorObject.colorTheme.isReversed=l),$(t).addClass("active"),o&&(o.updateChartTheme(e,n,void 0,s,l),a&&wt(e,s,n,l))},wt=function(e,t,i,a){var r=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),s=[{isReversed:a,pallateName:t,basecolor:i}];n.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,133,JSON.stringify(s)),r.init("POST",n.getURL(),!0,n.getParametersAsString()),actionManager.addRequest(r)},kt=function(e,t,i){t=""===t?ole.getCurrObj().id:t;var a,r,n,s=N(t),o=!0;$("#floating").enable();var l={x:0,y:0};switch(e){case"Top":case 2:a="horizontal",r="center",n="top";var c=chartOnLoad.getInstanceByChartId(t).co.options.title.text?chartOnLoad.getInstanceByChartId(t).co.options.title.text:"",d=chartOnLoad.getInstanceByChartId(t).co.options.subtitle.text?chartOnLoad.getInstanceByChartId(t).co.options.subtitle.text:"";l.y=d&&c?40:d||c?25:0,chartOnLoad.getInstanceByChartId(t).legendPos=2;break;case"Bottom":case 1:a="horizontal",r="center",n="bottom",chartOnLoad.getInstanceByChartId(t).legendPos=1;break;case"Left":case 4:a="vertical",r="left",n="middle",chartOnLoad.getInstanceByChartId(t).legendPos=4;break;case"Right":case 3:a="vertical",r="right",n="middle",chartOnLoad.getInstanceByChartId(t).legendPos=3;break;case"TopRight":case 5:a="vertical",r="right",n="top",chartOnLoad.getInstanceByChartId(t).legendPos=5;break;case"None":case 0:$("#floating").disable(),o=!1,chartOnLoad.getInstanceByChartId(t).legendPos=0}s.setLegendPosition(t,a,r,n,l,o);var h=chartOnLoad.getInstanceByChartId(t);(-1!==h.type.indexOf("LINE")||-1!==h.type.indexOf("SCATTER")||-1!==h.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t)),"true"==i&&Et(t,101,chartOnLoad.getInstanceByChartId(t).legendPos)},Pt=function(e,t){if(v){var i=N(t);i.setTrendlineDegree(e);var a=chartOnLoad.getInstanceByChartId(t);(-1!==a.type.indexOf("LINE")||-1!==a.type.indexOf("SCATTER")||-1!==a.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t))}},Rt=function(e,t){if(v){var i,a=N(t);switch(e){case"None":i="none";break;case"Linear":i="linear";break;case"Power":i="power";break;case"Exponential":i="exponential";break;case"Logarithmic":i="logarithmic";break;case"Polynomial":i="polynomial";break;case"Average":i="average"}a.setTrendlineTypes(i);var r=chartOnLoad.getInstanceByChartId(t);(-1!==r.type.indexOf("LINE")||-1!==r.type.indexOf("SCATTER")||-1!==r.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t))}},Et=function(e,t,i){{var a=new AjaxRequest,r=new RequestParameters(ActionConstants.CHART_QUICK_EDIT);chartOnLoad.getInstanceByChartId(e)}r.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,t,i),a.init("POST",r.getURL(),!0,r.getParametersAsString()),actionManager.addRequest(a)},Bt=function(e,t,i){t=""===t?ole.getCurrObj().id:t,chartOnLoad.getInstanceByChartId(t).lf=e,N(t).setChartDataLabels(e,t);var a=chartOnLoad.getInstanceByChartId(t);(-1!==a.type.indexOf("LINE")||-1!==a.type.indexOf("SCATTER")||-1!==a.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t)),"true"==i&&Et(t,102,e)},Nt=function(e){depthDragDrop.changeDateOperations(e)},Ft=function(e,t){N(t).setXLabelsRotation(e)},Wt=function(e,t){N(t).updateStagger(e)},Mt=function(){return b},Dt=function(e){b=e},Ht=function(e){e=void 0!=e?e:ole.getCurrObj().id;var t={};t.docId=$($("#DOCUMENT_ID")[0]).val(),t.asn=WorkSheets.getAssociatedActiveSheetName(),t.aOwner=zuid,t.chartId=e,t.isRelatedToDesign=!0,ChartClip.setObjectProperties(t),chartStyleClip.copyClip()},zt=function(e){e=void 0!=e?e:ole.getCurrObj().id,chartStyleClip.setCurrentChartId(e),chartStyleClip.pasteClip()},jt=function(e){e=void 0!=e?e:ole.getCurrObj().id,la();var t=new AjaxRequest,i=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),a=[{cStyle:"default"}];i.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,128,JSON.stringify(a)),t.init("POST",i.getURL(),!0,i.getParametersAsString()),actionManager.addRequest(t)},Gt=function(e){var t=new AjaxRequest,i=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),a=null,n=N(e),o=n.userOptions,l=$("#customTitle").val();if(l=chartGlance.isRange(l)?l:escape(l),-1!==s.indexOf("chartTitle"))a=[{title:l}],i.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,122,JSON.stringify(a));else if(-1!==s.indexOf("subTitle"))a=[{title:l}],i.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,123,JSON.stringify(a));else if(-1!==s.indexOf("xAxisTitle"))a=[{title:l}],i.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,115,JSON.stringify(a));else if(-1!==s.indexOf("yAxisTitle")){{var c=s.split(".")[1]-1;o.yAxis[c].title}a=[{title:l,index:c}],i.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,116,JSON.stringify(a))}else if(-1!==s.indexOf("xplotLine")){var d=s.split(".")[1],h=0,p=d.split("_")[1]-1;a=[{isYAxis:!1,title:l,index:h,plIndex:p}],i.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,134,JSON.stringify(a))}else if(-1!==s.indexOf("plotLine")){var d=s.split(".")[1],c=d.split("_")[0]-1,p=d.split("_")[1]-1;a=[{isYAxis:!0,title:l,index:c,plIndex:p}],i.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,134,JSON.stringify(a))}null!=a&&(t.init("POST",i.getURL(),!0,i.getParametersAsString()),actionManager.addRequest(t)),0==$("#customTitle").val().length&&(Ui(e),Gi(e))},Vt=function(e,t){var i=N(e),a=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),s=[];t=parseInt(t),s.push({slant:isNaN(t)?"auto":t}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,129,JSON.stringify(s));var o=i.options.xAxis[0].labels;o.rotation=isNaN(t)?null:t,i.xAxis[0].update({labels:o}),a.init("POST",n.getURL(),!0,n.getParametersAsString()),actionManager.addRequest(a)},Ut=function(e){var t=N(e),i=new AjaxRequest,a=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),n=[];if(-1!==s.indexOf("chartTitle")){var o=t.options.title.style;o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),n.push({style:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,119,JSON.stringify(n)),t.setTitle({style:o})}else if(-1!==s.indexOf("subTitle")){var o=t.options.subtitle.style;o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),n.push({style:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,120,JSON.stringify(n)),t.setTitle(null,{style:o})}else if(-1!==s.indexOf("xAxisTitle")){var o=t.options.xAxis[0].title.style;o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),n.push({style:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,117,JSON.stringify(n)),t.xAxis[0].update({style:o}),n.push(o)}else if(-1!==s.indexOf("xAxisLabel")){var o=t.options.xAxis[0].labels.style?t.options.xAxis[0].labels.style:{};o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),n.push({style:o});var l=t.options.xAxis[0].labels;l.style=o,t.xAxis[0].update({labels:l}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,127,JSON.stringify(n)),n.push(o)}else if(-1!==s.indexOf("yAxisTitle")){var c=s.split(".")[1],o=t.options.yAxis[c-1].title.style;o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),n=[{style:o,index:c-1}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,118,JSON.stringify(n)),t.yAxis[c-1].update({style:o})}else if(-1!==s.indexOf("yAxisLabel")){var c=s.split(".")[1],o=t.options.yAxis[c-1].labels.style?t.options.yAxis[c-1].labels.style:{};o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive"));var l=t.options.yAxis[c-1].labels;l.style=o,t.yAxis[c-1].update({labels:l}),n=[{style:o,index:c-1}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,126,JSON.stringify(n))}else if(-1!==s.indexOf("chartLegend")){var o=t.options.legend.itemStyle;o.fontWeight&&-1!==o.fontWeight.indexOf("bold")?(o.fontWeight="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(o.fontWeight="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),n.push({style:o});var d=t.options;d.legend.itemStyle.fontWeight=o.fontWeight,d.plotOptions.series.animation=!1,t.refreshChart(d,!0),appEvent.trigger("chart.click",[e]),appEvent.trigger("chart.dblclick",[e]),chartOnLoad.overrideHighchartsEvent(e),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,125,JSON.stringify(n))}else if(-1!==s.indexOf("xplotLine")){var h=s.split(".")[1],p=0,g=h.split("_")[1]-1,u=t.options.xAxis[0].plotLines,f=u[g].label.style&&u[g].label.style.fontWeight;f&&-1!==f.indexOf("bold")?(f="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(f="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),u[g].label.style.fontWeight=f,n=[{isYAxis:!1,style:u[g].label.style,index:p,plIndex:g}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(n)),t.xAxis[0].update({plotLines:u})}else if(-1!==s.indexOf("plotLine")){var h=s.split(".")[1],c=h.split("_")[0]-1,g=h.split("_")[1]-1,u=t.options.yAxis[c].plotLines,f=u[g].label.style&&u[g].label.style.fontWeight;f&&-1!==f.indexOf("bold")?(f="normal",$('label[for = "chartbold"]').removeClass("oleChartActive")):(f="bold",$('label[for = "chartbold"]').addClass("oleChartActive")),u[g].label.style.fontWeight=f,n=[{isYAxis:!0,style:u[g].label.style,index:c,plIndex:g}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(n)),t.yAxis[c].update({plotLines:u})}i.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(i)},_t=function(e){var t=N(e),i=new AjaxRequest,a=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),n=[];if(-1!==s.indexOf("chartTitle")){var o=t.options.title.style;o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),t.setTitle({style:o}),n.push({style:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,119,JSON.stringify(n))}else if(-1!==s.indexOf("subTitle")){var o=t.options.subtitle.style;o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),t.setTitle(null,{style:o}),n.push({style:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,120,JSON.stringify(n))}else if(-1!==s.indexOf("xAxisTitle")){var o=t.options.xAxis[0].title.style;o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),n.push({style:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,117,JSON.stringify(n)),t.xAxis[0].update({style:o})}else if(-1!==s.indexOf("xAxisLabel")){var o=t.options.xAxis[0].labels.style?t.options.xAxis[0].labels.style:{};o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),n.push({style:o});var l=t.options.xAxis[0].labels;l.style=o,t.xAxis[0].update({labels:l}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,127,JSON.stringify(n)),n.push(o)}else if(-1!==s.indexOf("yAxisTitle")){var c=s.split(".")[1],o=t.options.yAxis[c-1].title.style;o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),n=[{style:o,index:c-1}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,118,JSON.stringify(n)),t.yAxis[c-1].update({style:o})}else if(-1!==s.indexOf("yAxisLabel")){var c=s.split(".")[1],o=t.options.yAxis[c-1].labels.style?t.options.yAxis[c-1].labels.style:{};o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive"));var l=t.options.yAxis[c-1].labels;l.style=o,t.yAxis[c-1].update({labels:l}),n=[{style:o,index:c-1}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,126,JSON.stringify(n))}else if(-1!==s.indexOf("chartLegend")){var o=t.options.legend.itemStyle;o.fontStyle&&-1!==o.fontStyle.indexOf("italic")?(o.fontStyle="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(o.fontStyle="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),n.push({style:o});var d=t.options;d.legend.itemStyle.fontStyle=o.fontStyle,d.plotOptions.series.animation=!1,t.refreshChart(d,!0),appEvent.trigger("chart.click",[e]),appEvent.trigger("chart.dblclick",[e]),chartOnLoad.overrideHighchartsEvent(e),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,125,JSON.stringify(n))}else if(-1!==s.indexOf("xplotLine")){var h=s.split(".")[1],p=0,g=h.split("_")[1]-1,u=t.options.xAxis[0].plotLines,f=u[g].label.style&&u[g].label.style.fontStyle;f&&-1!==f.indexOf("italic")?(f="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(f="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),u[g].label.style.fontStyle=f,n=[{isYAxis:!1,style:u[g].label.style,index:p,plIndex:g}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(n)),t.xAxis[0].update({plotLines:u})}else if(-1!==s.indexOf("plotLine")){var h=s.split(".")[1],c=h.split("_")[0]-1,g=h.split("_")[1]-1,u=t.options.yAxis[c].plotLines,f=u[g].label.style&&u[g].label.style.fontStyle;f&&-1!==f.indexOf("italic")?(f="normal",$('label[for = "chartitalic"]').removeClass("oleChartActive")):(f="italic",$('label[for = "chartitalic"]').addClass("oleChartActive")),u[g].label.style.fontStyle=f,n=[{isYAxis:!0,style:u[g].label.style,index:c,plIndex:g}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(n)),t.yAxis[c].update({plotLines:u})}i.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(i)},Yt=function(e){var t=N(e),i=new AjaxRequest,a=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),s=[],o=(t.userOptions,0);s.push({glColor:n,index:o}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,124,JSON.stringify(s)),t.yAxis[0].update({gridLineColor:n,minorGridLineColor:chartGlance.getRGBA(n,.5)}),i.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(i),$("#chartgridcolor2").css("border-bottom","3px solid "+n)},qt=function(e,t){{var i=N(e),a=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),o=[];N(e).userOptions}if(-1!==s.indexOf("xplotLine")){var l=s.split(".")[1],c=0,d=l.split("_")[1]-1,h=i.options.xAxis[0].plotLines;h[d].dashStyle=t,i.xAxis[0].update({plotLines:h}),o.push({isYAxis:!1,dashStyle:h[d].dashStyle,index:c,plIndex:d}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,135,JSON.stringify(o))}else if(-1!==s.indexOf("plotLine")){var l=s.split(".")[1],p=l.split("_")[0]-1,d=l.split("_")[1]-1,h=i.options.yAxis[p].plotLines;h[d].dashStyle=t,i.yAxis[p].update({plotLines:h}),o.push({isYAxis:!0,dashStyle:h[d].dashStyle,index:p,plIndex:d}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,135,JSON.stringify(o))}a.init("POST",n.getURL(),!0,n.getParametersAsString()),actionManager.addRequest(a),$("#linetypeeditmenufonts ."+t).toggleClass("ui-state-active")},Jt=function(e,t){var i=N(e),a=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),o=[],l=N(e).userOptions;if(-1!==s.indexOf("chartTitle")){var c=i.options.title.style;c.fontSize=t,i.setTitle({style:c}),o.push({style:c}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,119,JSON.stringify(o))}else if(-1!==s.indexOf("subTitle")){var c=i.options.subtitle.style;c.fontSize=t,i.setTitle(null,{style:c}),o.push({style:c}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,120,JSON.stringify(o))}else if(-1!==s.indexOf("xAxisTitle")){var c=i.options.xAxis[0].title.style;c.fontSize=t,i.xAxis[0].update({style:c}),o.push({style:c}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,117,JSON.stringify(o))}else if(-1!==s.indexOf("xAxisLabel")){var c=i.options.xAxis[0].labels.style?i.options.xAxis[0].labels.style:{};c.fontSize=t,o.push({style:c});var d=i.options.xAxis[0].labels;d.style=c,i.xAxis[0].update({labels:d}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,127,JSON.stringify(o)),o.push(c)}else if(-1!==s.indexOf("yAxisTitle")){var h=s.split(".")[1];if(!i.options.yAxis[h-1])return;var c=i.options.yAxis[h-1].title.style;c.fontSize=t,o=[{style:c,index:h-1}],n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,118,JSON.stringify(o)),i.yAxis[h-1].update({style:c})}else if(-1!==s.indexOf("yAxisLabel")){var h=s.split(".")[1];if(!i.options.yAxis[h-1])return;var c=i.options.yAxis[h-1].labels.style?i.options.yAxis[h-1].labels.style:{};c.fontSize=t;var d=i.options.yAxis[h-1].labels;d.style=c,i.yAxis[h-1].update({labels:d}),o=[{style:c,index:h-1}],n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,126,JSON.stringify(o))}else if(-1!==s.indexOf("chartLegend")){var c=i.options.legend.itemStyle;c.fontSize=t,o.push({style:c});var l=i.options;l.legend.itemStyle.fontSize=c.fontSize,l.plotOptions.series.animation=!1,i.refreshChart(l,!0),appEvent.trigger("chart.click",[e]),appEvent.trigger("chart.dblclick",[e]),chartOnLoad.overrideHighchartsEvent(e),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,125,JSON.stringify(o))}else if(-1!==s.indexOf("xplotLine")){var p=s.split(".")[1],g=0,u=p.split("_")[1]-1,f=i.options.xAxis[0].plotLines;f[u].label.style.fontSize=t,i.xAxis[0].update({plotLines:f}),o.push({isYAxis:!1,style:f[u].label.style,index:g,plIndex:u}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(o))}else if(-1!==s.indexOf("plotLine")){var p=s.split(".")[1],h=p.split("_")[0]-1,u=p.split("_")[1]-1,f=i.options.yAxis[h].plotLines;f[u].label.style.fontSize=t,i.yAxis[h].update({plotLines:f}),o.push({isYAxis:!0,style:f[u].label.style,index:h,plIndex:u}),n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(o))}a.init("POST",n.getURL(),!0,n.getParametersAsString()),actionManager.addRequest(a),$("#chartFontSize").zcombo("setValue",t)},Qt=function(e,i){var n,o,d=parseFloat(parseFloat((100-i)/100).toFixed(2));if(-1!==s.indexOf("chartArea")){var h=N(r),p=h.userOptions;n=-1===p.chart.type.indexOf("pie")&&-1===p.chart.type.indexOf("funnel")?p.chart.plotBackgroundColor:chartGlance.getColorCodeFromGradient(p.chart.backgroundColor),o=chartGlance.getRGBA(n,d),ai(o),gt(!0)}else if(-1!==s.indexOf("canvas")){var h=N(r),p=h.userOptions;n=chartGlance.getColorCodeFromGradient(p.chart.backgroundColor),o=chartGlance.getRGBA(n,d),ai(o),gt(!0)}else if(-1!==s.indexOf("series")){var h=N(r),g=h.userOptions,u=!ga(r,c),f=g.colors;n=-1!==g.chart.type.indexOf("pie")?g.series[0].data[a.index||l].color?g.series[0].data[a.index||l].color:f[a.index||l]:-1!==g.chart.type.indexOf("funnel")||-1!==g.chart.type.indexOf("waterfall")?g.series[0].data[a.index||l].color?g.series[0].data[a.index||l].color:f[a.index||l]:u?g.series[t.index||c].data[a.index||l].color?g.series[t.index||c].data[a.index||l].color:f[t.index||c]:g.series[t.index||c].color?g.series[t.index||c].color:f[t.index||c],o=chartGlance.getRGBA(n,d),ai(o),gt(!0)}},Xt=function(e){var t=e||ole.getCurrObj().id,i=N(t),a=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),o=[],l=chartGlance.isNumber($("#min").val())?parseFloat($("#min").val()):null,c=s.split(".")[1];return i.yAxis[c-1]?i.yAxis[c-1].getExtremes().max<l&&i.yAxis[c-1].getExtremes().dataMax<l&&l?(showAlertDialog(jsMsg.InvalidRange),void $("#min").val("")):chartGlance.isNumber($("#min").val())?(i.yAxis[c-1].update({min:l}),o=[{min:l,index:c-1}],n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,130,JSON.stringify(o)),a.init("POST",n.getURL(),!0,n.getParametersAsString()),void actionManager.addRequest(a)):(showAlertDialog(jsMsg.InvalidRange),void $("#min").val("")):!1},Kt=function(e){var t=e||ole.getCurrObj().id,i=N(t),a=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),o=[],l=chartGlance.isNumber($("#max").val())?parseFloat($("#max").val()):null,c=s.split(".")[1];return i.yAxis[c-1]?i.yAxis[c-1].getExtremes().min>l&&i.yAxis[c-1].getExtremes().dataMin>l&&l?(showAlertDialog(jsMsg.InvalidRange),void $("#max").val("")):chartGlance.isNumber($("#max").val())?(i.yAxis[c-1].update({max:l}),o=[{max:l,index:c-1}],n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,131,JSON.stringify(o)),a.init("POST",n.getURL(),!0,n.getParametersAsString()),void actionManager.addRequest(a)):(showAlertDialog(jsMsg.InvalidRange),void $("#max").val("")):!1},Zt=function(e){var t=e||ole.getCurrObj().id,i=N(t),a=new AjaxRequest,n=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),o=[],l=chartGlance.isNumber($("#interval").val())?parseFloat($("#interval").val()):null,c=s.split(".")[1];return i.yAxis[c-1]?(l>=0&&i.yAxis[c-1].getExtremes().dataMax>=l||!l)&&chartGlance.isNumber($("#interval").val())?(i.yAxis[c-1].update({min:l}),o=[{interval:l,index:c-1}],n.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,132,JSON.stringify(o)),a.init("POST",n.getURL(),!0,n.getParametersAsString()),void actionManager.addRequest(a)):(showAlertDialog(jsMsg.InvalidRange),void $("#interval").val("")):!1},ei=function(e){var t=N(e),i=new AjaxRequest,a=new RequestParameters(ActionConstants.CHART_QUICK_STYLE),o=[],l=N(e).userOptions;if(-1!==s.indexOf("chartTitle")){var c=t.options.title.style;c.color=n,t.setTitle({style:c}),o.push({style:c}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,119,JSON.stringify(o))}else if(-1!==s.indexOf("subTitle")){var c=t.options.subtitle.style;c.color=n,t.setTitle(null,{style:c}),o.push({style:c}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,120,JSON.stringify(o))}else if(-1!==s.indexOf("xAxisTitle")){var c=t.options.xAxis[0].title.style;c.color=n,t.xAxis[0].update({style:c}),o.push({style:c}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,117,JSON.stringify(o))}else if(-1!==s.indexOf("xAxisLabel")){var c=t.options.xAxis[0].labels.style?t.options.xAxis[0].labels.style:{};c.color=n,o.push({style:c});var d=t.options.xAxis[0].labels;d.style=c,t.xAxis[0].update({labels:d}),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,127,JSON.stringify(o))}else if(-1!==s.indexOf("yAxisTitle")){var h=s.split(".")[1],c=t.options.yAxis[h-1].title.style;c.color=n,o=[{style:c,index:h-1}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,118,JSON.stringify(o)),t.yAxis[h-1].update({style:c})}else if(-1!==s.indexOf("yAxisLabel")){var h=s.split(".")[1],c=t.options.yAxis[h-1].labels.style?t.options.yAxis[h-1].labels.style:{};c.color=n;var d=t.options.yAxis[h-1].labels;d.style=c,t.yAxis[h-1].update({labels:d}),o=[{style:c,index:h-1}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,126,JSON.stringify(o))}else if(-1!==s.indexOf("chartLegend")){var c=t.options.legend.itemStyle;c.color=n,o.push({style:c});var l=t.options;l.legend.itemStyle.color=c.color,l.plotOptions.series.animation=!1,t.refreshChart(l,!0),appEvent.trigger("chart.click",[e]),appEvent.trigger("chart.dblclick",[e]),chartOnLoad.overrideHighchartsEvent(e),a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,125,JSON.stringify(o))}else if(-1!==s.indexOf("xplotLine")){var p=s.split(".")[1],g=0,u=p.split("_")[1]-1,f=t.options.xAxis[0].plotLines;f[u].label.style.color=n,o=[{isYAxis:!1,style:f[u].label.style,index:g,plIndex:u}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(o)),t.xAxis[0].update({plotLines:f})}else if(-1!==s.indexOf("plotLine")){var p=s.split(".")[1],h=p.split("_")[0]-1,u=p.split("_")[1]-1,f=t.options.yAxis[h].plotLines;f[u].label.style.color=n,o=[{isYAxis:!0,style:f[u].label.style,index:h,plIndex:u}],a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,136,JSON.stringify(o)),t.yAxis[h].update({plotLines:f})}i.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(i);var v="3px solid "+n;$("#chartFontColor2").css("border-bottom",v)},ti=function(e,t){v&&(t?N(e)?N(e).setMainTitle(t):Chart.container[B()][e].co.setMainTitle(t):chartGlance.isRange($("#chartTitle").val())?ja("chartTitle"):N(e)?N(e).setMainTitle($("#chartTitle").val()):Chart.container[B()][e].co.setMainTitle($("#chartTitle").val()))},ii=function(e){if(!tt(e)){var t=e||r;K(!1,e),Z("canvas");var i=N(t);if(null!==t&&i){var a=i.options;a=chartOnLoad.removeCustomEvents(a),a.chart.resetZoomButton={},a.chart.resetZoomButton.theme={},a.chart.resetZoomButton.theme.states={},a.chart.resetZoomButton.theme.states.hover={fill:"#f0f0f0",stroke:"#DDDDDD"},a=chartGlance.settingDefaultColorIndex(a),a=-1!==a.chart.type.indexOf("pie")||-1!==a.chart.type.indexOf("funnel")?chartGlance.applyChartSpacing(a,10,15,10,10):chartGlance.applyChartSpacing(a,30,30,30,30),(-1!==a.chart.type.indexOf("pie")||-1!==chartPreview.getAllChartTypesInComboChart(a,a.type).indexOf("pie"))&&(a.plotOptions.pie.allowPointSelect=!0),a.tooltip&&!a.tooltip.enabled&&(a.tooltip.enabled=st()),a.chart.zoomType&&(a.chart.zoomType=ot()),a.plotOptions.series.events={mouseOver:function(){this.legendItem&&this.legendItem.css({color:chartGlance.getRGBA(a.legend.itemStyle.color,"0.7")})},mouseOut:function(){this.legendItem&&this.legendItem.css({color:a.legend.itemStyle.color})}},a=chartGlance.removeCursorPointer(a),a=chartGlance.applySharedLegendInPie(a),a=chartGlance.applyregressionColorIndex(a),a=chartGlance.advanceChartSettingsInLegend(a),a=chartGlance.advanceDataLabelSetting(a),PivotChartUtility.findTotalNoOfFilterRequired(e,chartOnLoad.getInstanceByChartId(e).pivotId),a=PivotChartUtility.setLegendBoundary(a,chartOnLoad.getInstanceByChartId(t).isPivotChart,chartOnLoad.getInstanceByChartId(t).legendPos,chartOnLoad.getInstanceByChartId(e).ht),a.plotOptions.series.animation=!1,i.refreshChart(a,!0),chartOnLoad.doClickHandling(a.chart.renderTo),appEvent.trigger("chart.dblclick",[a.chart.renderTo])}}},ai=function(e){n=e},ri=function(e){var t;if(void 0===e)t=0;else if("rgba"==e.slice(0,4)){var i=e.split(",");t=1-parseFloat(i[3])}else t="rgb("==e.slice(0,4)?0:"#"==e.charAt(0)?0:0;return t},ni=function(e,t){v&&(t?N(e)?N(e).setSubTitle(t):Chart.container[B()][e].co.setSubTitle(t):chartGlance.isRange($("#chartSubTitle").val())?ja("chartSubTitle"):N(e)?N(e).setSubTitle($("#chartSubTitle").val()):Chart.container[B()][e].co.setSubTitle($("#chartSubTitle").val()))},si=function(e){if(v){N(e).setChartThreshold($("#threshold").val());var t=chartOnLoad.getInstanceByChartId(e);(-1!==t.type.indexOf("LINE")||-1!==t.type.indexOf("SCATTER")||-1!==t.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(e))}},oi=function(e,t){if(v){N(t).setTooltipOption(e);var i=chartOnLoad.getInstanceByChartId(t);(-1!==i.type.indexOf("LINE")||-1!==i.type.indexOf("SCATTER")||-1!==i.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t))}},li=function(e){e?$("#aggreoperations").show():(chartPreview.setDepthHeaders(null),chartPreview.setDepthOperations(null),chart.unloadDepthHeaders()),$("#aggreoperation").zcombo("refresh"),chart.createChart(!0)},ci=function(e){var t=0,i=-1!==$("#yaxisMulti").zcombo("getValue").indexOf("RA")?"RA":"LA";t=e?$("#"+i+" .pl").length-1:$(".xpl").length-1,e?""!==t&&vi(i,t,!0):""!==t&&vi(i,t,!1)},di=function(e,t){var i=[],a="",r=e?"plotLineValue":"xplotLineValue";if(e){var n=-1!==$("#yaxisMulti").zcombo("getValue").indexOf("RA")?"RA":"LA";i=$("#"+n).find(".pl"),3==i.length&&("LA"===n?$("#"+n).find(".yplAddBtn").show():$("#"+n).find(".yplAddBtn1").show())}else i=$(".xpl"),3==i.length&&$("#xAxis").find(".xplAddBtn").show();for(var s=0;s<i.length;s++){var o=$(e?".plotLine"+t:".xplotLine"+t);$(o).is($(i[s]))&&(a=$(i[s]).find("#"+r).val(),$(i[s]).remove())}if(e&&Ri(chartPreview.getAxisOptionsIndex()),void 0!==a&&null!==a&&""!==a){var l=chartPreview.getHCInstance("preview"),c=e?chartPreview.getAxisOptionsIndex():0;l.updatePlotValue(c,"",t,e),chart.createChart(!0)}},hi=function(e,t){var i=new Array;if(!isUndefined(e))for(var a=0;a<e.length;a++)i.push(fi(e[a]));chartPreview.setDepthHeaders(i),chartPreview.calculateDepthOperations(),chartPreview.reloadFilterComboIfRequired(),gi()&&pi(t)},pi=function(e){var t=chart.getAggregationObject();t&&null!==t&&e&&(chart.setAggregationRequest(!0),t.queueRequestFtn(!0))},gi=function(){var e=!1;if(null==chartOnLoad.getInstanceByChartId("preview"))return!0;var t=chartOnLoad.getInstanceByChartId("preview").co.options.aggregation,i=chartOnLoad.getInstanceByChartId("preview").seriesIn,a="COLS"==i?t.colheaders:t.rowheaders,r=a?a.split(";"):[];if(null!=chartPreview.getDepthHeaders()&&chartPreview.getDepthHeaders().length>0){if(e=!ui(r,chartPreview.getDepthHeaders()))return!0}else{if(0==r.length&&(null==chartPreview.getDepthHeaders||0==chartPreview.getDepthHeaders().length))return!1;if(r.length>0&&(null==chartPreview.getDepthHeaders()||0==chartPreview.getDepthHeaders().length))return!0}var n=t.dateOperations,s=n?n.split(","):[];if(null!=chartPreview.getDepthOperations()&&chartPreview.getDepthOperations().length>0&&(e=!ui(s,chartPreview.getDepthOperations())))return!0;var o=t.type,l=$("#aggreoperation").zcombo("getValue");return o!==l?(e=!0,!0):!1},ui=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},fi=function(e){var t=chartPreview.getDepthIndices(),i=e.split(";"),a=i[0];if(t&&t[0]&&t[0].length>0){for(var r=t[0][a],n=0;n<r.length;n++){var s=r[n];if(s.headerLabel===i[1])return s.headerRange}return r[0].headerRange}},vi=function(e,t,i){var a=parseInt(t)+1,r=0!==chartPreview.getAxisOptionsIndex()?chartPreview.getAxisOptionsIndex():"";if(i){var n=document.createElement("div");$(n).addClass("plotLine"+a),$(n).addClass("divTableRow"),$(n).addClass("pl");var s=document.createElement("div");$(s).addClass("divTableCol"),$(s).addClass("label"),$(s).appendTo(n),s=document.createElement("div"),$(s).addClass("divTableCol");var o=document.createElement("input");$(o).attr("type","text"),$(o).css("width","84%"),$(o).addClass("textField"),$(o).addClass("plotLineValue"),$(o).attr("name","plotLine"),$(o).attr("id","plotLineValue"+r),$(o).attr("maxlength","250"),$(o).attr("index",a),$(o).on("keyup",function(){chartPreview.updatePlotLineMultiple(this,!0)}),$(o).appendTo(s);var l=document.createElement("span");$(l).addClass("closeIconHover"),o=document.createElement("input"),$(o).attr("id","deletebutton"),$(o).addClass("closeIconSmall"),$(o).attr("type","button"),$(o).css("display","inline-block"),$(o).on("click",function(){chartPreview.deletePlotLine(!0,a)}),$(o).appendTo(l),$(l).appendTo(s),$(s).appendTo(n),$(n).insertAfter("#"+e+" .pl:last"),a>=2&&("LA"===e?$(".yplAddBtn").hide():$(".yplAddBtn1").hide())}else{var n=document.createElement("div");$(n).addClass("xplotLine"+a),$(n).addClass("divTableRow"),$(n).addClass("xpl");var s=document.createElement("div");$(s).addClass("divTableCol"),$(s).addClass("label"),$(s).appendTo(n),s=document.createElement("div"),$(s).addClass("divTableCol");var o=document.createElement("input");$(o).attr("type","text"),$(o).css("width","84%"),$(o).addClass("textField"),$(o).addClass("xplotLineValue"),$(o).attr("name","xplotLine"),$(o).attr("id","xplotLineValue"+r),$(o).attr("maxlength","250"),$(o).attr("index",a),$(o).on("keyup",function(){chartPreview.updatePlotLineMultiple(this,!1)}),$(o).appendTo(s);var l=document.createElement("span");$(l).addClass("closeIconHover"),o=document.createElement("input"),$(o).attr("id","deletebutton"),$(o).addClass("closeIconSmall"),$(o).attr("type","button"),$(o).css("display","inline-block"),$(o).on("click",function(){chartPreview.deletePlotLine(!1,a)}),$(o).appendTo(l),$(l).appendTo(s),$(s).appendTo(n),$(plotLineDom).insertAfter(".xpl:last"),a>=2&&$(".xplAddBtn").hide()}},xi=function(e,t,i,a){var r=parseInt(i)-1,n=0!==t?t:"";if(a){var s=document.createElement("div");$(s).addClass("plotLine"+i),$(s).addClass("divTableRow"),$(s).addClass("pl");var o=document.createElement("div");$(o).addClass("divTableCol"),$(o).addClass("label"),$(o).appendTo(s),o=document.createElement("div"),$(o).addClass("divTableCol");var l=document.createElement("input");$(l).attr("type","text"),$(l).css("width","84%"),$(l).addClass("textField"),$(l).addClass("plotLineValue"),$(l).attr("name","plotLine"),$(l).attr("id","plotLineValue"+n),$(l).attr("maxlength","250"),$(l).attr("index",i),$(l).on("keyup",function(){chartPreview.updatePlotLineMultiple(this,!0)}),$(l).appendTo(o);var c=document.createElement("span");$(c).addClass("closeIconHover"),l=document.createElement("input"),$(l).attr("id","deletebutton"),$(l).addClass("closeIconSmall"),$(l).attr("type","button"),$(l).css("display","inline-block"),$(l).on("click",function(){chartPreview.deletePlotLine(!0,i)}),$(l).appendTo(c),$(c).appendTo(o),$(o).appendTo(s),$(s).insertAfter("#"+e+" .plotLine"+r),i>=2&&("LA"===e?$(".yplAddBtn").hide():$(".yplAddBtn1").hide())}else{var s=document.createElement("div");$(s).addClass("xplotLine"+i),$(s).addClass("divTableRow"),$(s).addClass("xpl");var o=document.createElement("div");$(o).addClass("divTableCol"),$(o).addClass("label"),$(o).appendTo(s),o=document.createElement("div"),$(o).addClass("divTableCol");var l=document.createElement("input");$(l).attr("type","text"),$(l).css("width","84%"),$(l).addClass("textField"),$(l).addClass("xplotLineValue"),$(l).attr("name","xplotLine"),$(l).attr("id","xplotLineValue"+n),$(l).attr("maxlength","250"),$(l).attr("index",i),$(l).on("keyup",function(){chartPreview.updatePlotLineMultiple(this,!1)}),$(l).appendTo(o);var c=document.createElement("span");$(c).addClass("closeIconHover"),l=document.createElement("input"),$(l).attr("id","deletebutton"),$(l).addClass("closeIconSmall"),$(l).attr("type","button"),$(l).css("display","inline-block"),$(l).on("click",function(){chartPreview.deletePlotLine(!1,i)}),$(l).appendTo(c),$(c).appendTo(o),$(o).appendTo(s),$(s).insertAfter("#"+e+" .xplotLine"+r),i>=2&&$(".xplAddBtn").hide()}},yi=function(e,t){if(v&&N(t)){N(t).setAnimation(e);var i=chartOnLoad.getInstanceByChartId(t);(-1!==i.type.indexOf("LINE")||-1!==i.type.indexOf("SCATTER")||-1!==i.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t))}},bi=function(e,t){if(v){var i=e?"xy":"";N(t).setZoom(i);var a=chartOnLoad.getInstanceByChartId(t);(-1!==a.type.indexOf("LINE")||-1!==a.type.indexOf("SCATTER")||-1!==a.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t))}},Ai=function(e,t,i){if(v){var a=$("#glMajor").is(":checked");""===e&&(e=ole.getCurrObj().id,a=t.data("checked")),majorGridLineWidth=a?1:0,"true"===i&&Et(e,103,a),N(e).setMajorGrid(majorGridLineWidth)}},mi=function(e,t,i){if(v){var a=$("#glMinor").is(":checked");""===e&&(e=ole.getCurrObj().id,a=t.data("checked"));var r=a?"auto":null;"true"===i&&Et(e,104,a),N(e).setMinorGrid(r)}},Oi=function(e,t){if(v){N(t).setMarkers(e);var i=chartOnLoad.getInstanceByChartId(t);(-1!==i.type.indexOf("LINE")||-1!==i.type.indexOf("SCATTER")||-1!==i.type.indexOf("BUBBLE"))&&chartOnLoad.setPositiveExtreme(N(t))}},Ci=function(e,t){v&&(t?N(e)?N(e).setXAxisTitle(t):Chart.container[B()][e].co.setXAxisTitle(t):chartGlance.isRange($("#xAxisTitle").val())?ja("xAxisTitle"):N(e)?N(e).setXAxisTitle($("#xAxisTitle").val()):Chart.container[B()][e].co.setXAxisTitle($("#xAxisTitle").val()))},$i=function(e,t){v&&N(t).setXLabels(e)},Li=function(e){e?$("#multiAxis").show():$("#multiAxis").hide();-1!==$("#yaxisMulti").zcombo("getValue").indexOf("RA")&&($("#yaxisMulti").zcombo("setValue","LA"),$("#RA").hide(),$("#LA").show()),chart.createChart(!0)},Si=function(e){var t;t=ole&&ole.getCurrObj()?ole.getCurrObj().id:"preview";var i=chartOnLoad.getInstanceByChartId(t).co.options.yAxis,a=chartOnLoad.getInstanceByChartId(t).co.options;if(-1!==e.indexOf("RA")){Ri(null!=$("#LA").attr("currId")?0:null!=$("#RA").attr("currId")?$("#RA").attr("currId"):0),chartPreview.setAxisOptionsIndex(e.substr(2,e.length)),$("#RA").attr("currId",chartPreview.getAxisOptionsIndex()),$("#RA [id^=yAxisTitle]").attr("id","yAxisTitle"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=yaxisLabYes]").attr("id","yaxisLabYes"+chartPreview.getAxisOptionsIndex()),$("#RA [for^=yaxisLabYes]").attr("for","yaxisLabYes"+chartPreview.getAxisOptionsIndex());for(var r=chartPreview.getAxisOptionsIndex(),n=$("#RA .pl"),s=0;s<n.length;s++)$(n[s]).find("[id^=plotLineValue]").attr("id","plotLineValue"+r),$(n[s]).find("[id^=plotLineValue]").attr("index",s);$("#RA [for^=yAxisReverse]").attr("for","yAxisReverse"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=yAxisReverse]").attr("id","yAxisReverse"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=baseValue]").attr("id","baseValue"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=axisType]").attr("id","axisType"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=ymin]").attr("id","ymin"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=ymax]").attr("id","ymax"+chartPreview.getAxisOptionsIndex()),$("#RA [id^=yinterval]").attr("id","yinterval"+chartPreview.getAxisOptionsIndex()),null!=i&&i[e.substr(2,e.length)]?Ti(e.substr(2,e.length),a,!0):Pi(e.substr(2,e.length)),$("#RA").show(),$("#LA").hide()}else null!=$("#RA").attr("currId")&&(Ri($("#RA").attr("currId")),$("#RA").removeAttr("currId")),$("#LA").attr("currId",chartPreview.getAxisOptionsIndex()),chartPreview.setAxisOptionsIndex(0),$("#LA").show(),$("#RA").hide()},Ii=function(e){var t=document.createElement("textarea");return t.innerHTML=unescape(e),t.value},Ti=function(e,t,i){var a=t.cellRef,r=t.yAxis,n=r[e]?r[e]:{};if(0==e){$("#LA #yAxisTitle").val(a["ytitleRange"+e]?a["ytitleRange"+e]:Ii(n.title.text)),$("#LA #yaxisLabYes").val(n.labels.enabled);for(var s=n.plotLines&&n.plotLines.length>0?n.plotLines:"",o=0;o<s.length;o++)o>0&&xi("LA",e,o,!0),$("#LA #plotLineValue[index='"+o+"']").val(s[o].value);$("#LA #ymin").val(n.min),$("#LA #yAxisReverse").val(n.reverse),$("#LA #yAxisLogarithmic").val("logarithmic"===n.axisType),$("#LA #baseValue").val(n.baseValue),$("#LA #ymax").val(n.max),$("#LA #yinterval").val(n.tickInterval)}else{if($("#RA #yAxisTitle"+e).val(a["ytitleRange"+e]?a["ytitleRange"+e]:Ii(n.title.text)),$("#RA #yaxisLabYes"+e).val(n.labels.enabled),i){for(var s=n.plotLines&&n.plotLines.length>0?n.plotLines:"",o=0;o<s.length;o++)o>0&&(0!==$("#RA .plotLine"+o).length?$("#RA #plotLineValue"+e+"[index='"+o+"']").val(s[o].value):xi("RA",e,o,!0)),$("#RA #plotLineValue"+e+"[index='"+o+"']").val(s[o].value);$("#RA .pl").length>1&&$("#RA .pl").length>s.length?wi(e,s.length):""==s&&$("#RA #plotLineValue"+chartPreview.getAxisOptionsIndex()).val("")}$("#RA #ymin"+e).val(n.min),$("#RA #ymax"+e).val(n.max),$("#RA #yAxisReverse"+e).val(n.reverse),$("#RA #yAxisLogarithmic"+e).val("logarithmic"===n.axisType),$("#RA #baseValue"+e).val(n.baseValue),$("#RA #yinterval"+e).val(n.tickInterval)}Ei(e,t)},wi=function(e,t){if(0==t){for(var i=$("#RA .pl"),a=1;a<i.length;a++)$(i[a]).remove();$(i[0]).find("#plotLineValue"+chartPreview.getAxisOptionsIndex()).val(""),$(".yplAddBtn1").show()}else if($("#RA .pl").length>t){for(var i=$("#RA .pl"),a=t;a<i.length;a++)$(i[a]).remove();3>t?$(".yplAddBtn1").show():$(".yplAddBtn1").hide()}},ki=function(e,t){e>0&&xi("xAxis",0,e,!1),$("#xAxis #xplotLineValue[index='"+e+"']").val(t)},Pi=function(e){$("#RA #yAxisTitle"+e).val(""),$("#RA #yaxisLabYes"+e).prop("checked",!0),$("#RA #plotLineValue"+e).val(""),$("#RA #ymin"+e).val(""),$("#RA #ymax"+e).val(""),$("#RA #yinterval"+e).val("")},Ri=function(e){var t=chartPreview.getAxisOptions();null==t&&(t=new Array);var i=void 0!=t[e]?t[e]:{};if(0==e){i.yAxistitle=chartGlance.isRange(getObj("yAxisTitle").value)?getObj("yAxisTitle").value:escape(getObj("yAxisTitle").value),i.yMin=""===getObj("ymin").value||isNaN(getObj("ymin").value)?null:getObj("ymin").value,i.yMax=""===getObj("ymax").value||isNaN(getObj("ymax").value)?null:getObj("ymax").value,i.yInterval=""===getObj("yinterval").value||isNaN(getObj("yinterval").value)?null:getObj("yinterval").value,i.yLabel=$("#yAxisLabelToggle").is(":checked")?!0:!1,i.reverse=$("#yAxisReverse").is(":checked")?!0:!1,i.axisType=$("#yAxisLogarithmic").is(":checked")?"logarithmic":"linear",i.baseValue=$("#LA #baseValue").val(),i.plotLines=new Array;for(var a=$("#LA .plotLineValue"),r=0;r<a.length;r++)i.plotLines[r]={},i.plotLines[r].value=$(a[r]).val()&&!isNaN($(a[r]).val())?$(a[r]).val():void 0}else{i.yAxistitle=v?chartGlance.isRange(getObj("yAxisTitle"+e).value)?getObj("yAxisTitle"+e).value:escape(getObj("yAxisTitle"+e).value):"",i.yMin=v?""===getObj("ymin"+e).value||isNaN(getObj("ymin"+e).value)?null:getObj("ymin"+e).value:null,i.yMax=v?""===getObj("ymax"+e).value||isNaN(getObj("ymax"+e).value)?null:getObj("ymax"+e).value:null,i.yInterval=v?""===getObj("yinterval"+e).value||isNaN(getObj("yinterval"+e).value)?null:getObj("yinterval"+e).value:null,i.yLabel=v?$("#yaxisLabYes"+e).is(":checked")?!0:!1:!0,i.reverse=v?$("#yAxisReverse"+e).is(":checked")?!0:!1:!0,i.axisType=v&&$("#yAxisLogarithmic"+e).is(":checked")?"logarithmic":"linear",i.baseValue=v?$("#RA #baseValue"+e).val():10,i.plotLines=new Array;for(var a=$("#RA .plotLineValue"),r=0;r<a.length;r++)i.plotLines[r]={},i.plotLines[r].value=v&&$(a[r]).val()&&!isNaN($(a[r]).val())?$(a[r]).val():void 0}t[e]=i,chartPreview.setAxisOptions(t)},Ei=function(e,t){var i=t.cellRef,a=t.yAxis[e]?t.yAxis[e]:null;if(null!=a){var r=chartPreview.getAxisOptions();if(null==r&&(r=new Array),void 0==r[e]){var n={};if(0==e){if(n.yAxistitle=i["ytitleRange"+e]?i["ytitleRange"+e]:a.title.text,n.yMin=a.min,n.yMax=a.max,n.yInterval=a.tickInterval,n.yLabel=a.labels.enabled,n.reverse=a.reverse,n.axisType=a.axisType,n.baseValue=a.baseValue,n.plotLines=[],a.plotLines&&a.plotLines.length>0)for(var s=0;s<a.plotLines.length;s++)n.plotLines.push(a.plotLines[s].value);n.majorGridLineWidth=a.gridLineWidth?a.gridLineWidth:"",n.minorTickInterval=a.minorTickInterval?a.minorTickInterval:""}else if(n.yAxistitle=i["ytitleRange"+e]?i["ytitleRange"+e]:a.title.text,n.yMin=a.min,n.yMax=a.max,n.yInterval=a.tickInterval,n.yLabel=a.labels.enabled,n.reverse=a.reverse,n.axisType=a.axisType,n.baseValue=a.baseValue,n.plotLines=[],a.plotLines&&a.plotLines.length>0)for(var s=0;s<a.plotLines.length;s++)n.plotLines.push(a.plotLines[s].value);r[e]=n,chartPreview.setAxisOptions(r)}}},Bi=function(e,t){v&&(t?N(e)?N(e).setYAxisTitle(t):Chart.container[B()][e].co.setYAxisTitle(t):chartGlance.isRange($("#yAxisTitle").val())?ja("yAxisTitle"):N(e)?N(e).setYAxisSecTitle($("#yAxisTitle").val()):Chart.container[B()][e].co.setYAxisTitle($("#yAxisTitle").val()))},Ni=function(e,t){v&&N(t).setYLabels(e)},Fi=function(e,t,i,a){if(v){var r=chartPreview.getAxisOptionsIndex(),n=t;if(!chartGlance.isNumber(n))return;N(e).updatePlotValue(r,n,i,a)}},Wi=function(e,t){var i=$(e).attr("index"),a=$(e).val();Fi("preview",a,i,t)},Mi=function(e,t){if(v){var i=getObj(t).value,a=chartPreview.getAxisOptionsIndex();if(0===a&&chartOnLoad.getInstanceByChartId(e).co.yAxis[0].userMin&&.02===chartOnLoad.getInstanceByChartId(e).co.yAxis[0].userMin)return void chart.createChart(!0);if(!chartGlance.isNumber(i))return;N(e).updateYminValue(e,a,i)}},Di=function(e,t){if(v){var i=getObj(t).value,a=chartPreview.getAxisOptionsIndex();if(!chartGlance.isNumber(i))return;N(e).updateYmaxValue(e,a,i)}},Hi=function(e,t){if(v){var i=getObj(t).value,a=chartPreview.getAxisOptionsIndex();if(!chartGlance.isNumber(i))return;N(e).updateYintValue(e,a,i)}},zi=function(e,t){if(v){var i="";i=0==chartPreview.getAxisOptionsIndex()?"yAxisTitle":"yAxisTitle"+chartPreview.getAxisOptionsIndex(),t?N(e)?N(e).setYAxisSecTitle(t):Chart.container[B()][e].co.setYAxisSecTitle(t):chartGlance.isRange($("#"+i).val())?ja("yAxisTitle"):N(e)?N(e).setYAxisSecTitle($("#"+i).val()):Chart.container[B()][e].co.setYAxisSecTitle($("#"+i).val())}},ji=function(e,t){v&&N(t).setYLabelsSec(e)},Gi=function(e){var t=e||r;ma(t),($("#OLEBoxFormat_fonts").is(":visible")||$("#OLEBoxFormat").is(":visible"))&&($.ZContextMenu.hideMenu(),$.ZContextMenu.colorpalette.hide()),$("#OLEBoxFormat_fonts").is(":visible")&&$("#OLEBoxFormat_fonts").hide(),$("#OLEBoxFormat").is(":visible")&&$("#OLEBoxFormat").hide(),$("#"+r).find(".highcharts-background")&&($("#"+r).find(".highcharts-background").attr("stroke-width","0"),$($("#"+r).find(".highcharts-background").next()).attr("stroke-width","0")),Ui(t)},Vi=function(e,t,i,a){if(-1!==e.indexOf("series")){var r=N(t).options;r.series[a.index].borderColor="#FFF",r.series[a.index].borderWidth=1,r.chart.plotBorderWidth=0,r.plotOptions.series.animation=!1,N(t).refreshChart(r,!0)}else if(-1!==e.indexOf("chartArea")){var r=N(t).options;r.chart.plotBorderColor="#346691",r.chart.plotBorderWidth=2,r.plotOptions.series.animation=!1,N(t).refreshChart(r,!0)}chartOnLoad.doClickHandling(r.chart.renderTo),appEvent.trigger("chart.dblclick",[t])},Ui=function(e,t){var i=t?t:"normal";-1!==i.indexOf("normal")?($("#"+e).find("#titleRect")?$("#"+e).find("#titleRect").remove():null,$("#"+e).find("#subtitleRect")?$("#"+e).find("#subtitleRect").remove():null,$("#"+e).find("#xAxiseRect")?$("#"+e).find("#xAxiseRect").remove():null,$("#"+e).find("#yTitleRect1")?$("#"+e).find("#yTitleRect1").remove():null,$("#"+e).find("#yTitleRect2")?$("#"+e).find("#yTitleRect2").remove():null,$("#"+e).find("#canvas")?$("#"+e).find("#canvas").remove():null,$("#"+e).find("#chartArea")?$("#"+e).find(".highcharts-background").nextAll("#chartArea").remove():null,$("#"+e).find("#chartLegend")?$("#"+e).find("#chartLegend").remove():null,$("#"+e).find("#xplotLineRect")?$("#"+e).find("#xplotLineRect").remove():null,$("#"+e).find("#yplotLineRect")?$("#"+e).find("#yplotLineRect").remove():null,$("#"+r).find(".highcharts-background").attr("stroke-width","0"),$($("#"+r).find(".highcharts-background").next()).attr("stroke-width","0")):$("#"+e).find("#hoverRect").remove()},_i=function(e,t){Ui(e),ole.isActive()&&chartPreview.getChartMode(e)&&t&&ia(e,t)},Yi=function(){return s},qi=function(e,t){var i=document.createElement("canvas"),a=i.getContext("2d");if(t){var r;r=t.fontWeight+" "+t.fontStyle+" "+t.fontSize+" "+t.font,a.font=r}return a.measureText(e)},Ji=function(e){for(var t,i=$("#"+e).find(".highcharts-legend-item"),a=i.length,r=0,n=0;a>n;n++)t=$($($("#"+e).find(".highcharts-legend-item")[n]).children("text")[0]).width(),r=t>=r?t:r;return r+30},Qi=function(e){var t=-1!==e.chart.type.indexOf("bar");if(!t)for(var i=e.series,a=i.length,r=0;a>r;r++)if(i[r]&&i[r].type&&-1!==i[r].type.indexOf("bar"))return!0;return t},Xi=function(e,t){var i=$("#"+e).find(".highcharts-legend-item"),a=(t&&t.fontSize?parseInt(t.fontSize):14,i.length-1),r=0,n=0,s=$("#"+e).find(".highcharts-legend").attr("transform");if(s){var n=parseInt(s.split("(")[1].split(",")[1]);n||(n=parseInt(s.split("(")[1].split(" ")[1]))}var o=$($("#"+e).find(".highcharts-legend-item")[a]).attr("transform"),l=$($("#"+e).find(".highcharts-legend-item")[0]).attr("transform");if(o=parseInt(-1!==o.indexOf(",")?o.split(",")[1]:o.split(" ")[1]),l=parseInt(-1!==l.indexOf(",")?l.split(",")[1]:l.split(" ")[1]),r=o-l+30,40>=r&&(r=40),parseInt($("#"+e).find(".highcharts-background").attr("height"))<=r+n){var c;c=Math.abs(r-parseInt($("#"+e).find(".highcharts-background").attr("height"))),r=r-c-n-(chartOnLoad.getInstanceByChartId(e).isPivotChart?50:20)}return r},Ki=function(e,t,i,a,r,n,s){var o,l,c,d,h,p=t.split(".")[1]-1;if(-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("POLAR")){if(chartPreview.isBarChartApplied(a.options)){if(o=i?i:"xAxiseRect",r.setAttribute("id",o),!$($($("#"+e).find(".highcharts-yaxis")[p]).find("text")[0]).attr("y"))return}else{if(o=i?i:"yTitleRect1",r.setAttribute("id",o),decement=-1!==chartOnLoad.getInstanceByChartId(e).type.indexOf("TIME")?15:20,!$($($("#"+e).find(".highcharts-yaxis")[p]).find("text")[0]).attr("y"))return;r.setAttribute("transform",$($($("#"+e).find(".highcharts-yaxis")[p]).find("text")[0]).attr("transform"))}var g=$($("#"+e).find(".highcharts-yaxis")[p]).find("text")[0].getBBox();l=parseInt(g.x)-5,c=parseInt(g.y)-5,d=parseInt(g.height)+10,h=parseInt(g.width)+10,r.setAttribute("fill","url(#pattern)"),r.setAttribute("x",l),r.setAttribute("y",c),r.setAttribute("width",h),r.setAttribute("height",28),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",o),$(s).append($(r)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}},Zi=function(e,t,i,a,r,n,s){if(-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("POLAR")){var o,l,c,d,h=t.split(".")[1]-1;chartPreview.isBarChartApplied(a.options)?(d=i?i:"xAxiseRect",r.setAttribute("id",d)):(d=i?i:"yTitleRect1",r.setAttribute("id",d));var p=$("#"+e).find(".highcharts-yaxis-labels"),g=p[h].getBBox();o=parseInt(g.x)-8,l=parseInt(g.y),height=parseInt(g.height),c=parseInt(g.width)+16,r.setAttribute("fill","url(#pattern)"),r.setAttribute("x",o),r.setAttribute("y",l),r.setAttribute("width",c),r.setAttribute("height",height),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",d),$(s).append($(r)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}},ea=function(e,t,i,a,r,n,s){if(-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("POLAR")){var o,l,c,d,h=t.split("_")[1]-1;chartPreview.isBarChartApplied(a.options)?(d=i?i:"xplotLineRect",r.setAttribute("id",d)):(d=i?i:"xplotLineRect",r.setAttribute("id",d));var p=$($("#"+e).find("[class^=highcharts-plot-lines]")[0]).find("path"),g=p[h].getBBox();o=parseInt(g.x)-8,l=parseInt(g.y),height=parseInt(g.height),c=parseInt(g.width)+16,r.setAttribute("fill","url(#pattern)"),r.setAttribute("x",o),r.setAttribute("y",l),r.setAttribute("width",c),r.setAttribute("height",height),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",d),$(s).append($(r)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}},ta=function(e,t,i,a,r,n,s){if(-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("POLAR")){var o,l,c,d,h=t.split(".")[1],p=h.split("_")[0]-1,g=h.split("_")[1]-1;chartPreview.isBarChartApplied(a.options)?(d=i?i:"yplotLineRect",r.setAttribute("id",d)):(d=i?i:"yplotLineRect",r.setAttribute("id",d));var u=$("#"+e).find("[class^=highcharts-plot-lines]"),f=$(u[p]).find("path"),v=f[g].getBBox();o=parseInt(v.x),l=parseInt(v.y)-8,height=parseInt(v.height)+16,c=parseInt(v.width),r.setAttribute("fill","url(#pattern)"),r.setAttribute("x",o),r.setAttribute("y",l),r.setAttribute("width",c),r.setAttribute("height",height),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",d),$(s).append($(r)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}},ia=function(e,t,i){if(null!=e){i?Ui(e,"hover"):Ui(e,void 0);var a,n,s,o=N(e),l="http://www.w3.org/2000/svg",c="http://www.w3.org/1999/xlink";if(-1!==t.indexOf("chartArea")||-1!==t.indexOf("canvas"))a=document.createElementNS(l,"rect"),n=document.createElementNS(l,"rect"),a.setAttribute("fill","none"),a.setAttribute("fill-opacity","0.3"),a.setAttribute("stroke","#a5d5c2"),a.setAttribute("stroke-width",1);else{s=document.createElementNS(l,"svg");var d=document.createElementNS(l,"defs"),h=document.createElementNS(l,"pattern"),p=document.createElementNS(l,"image");a=document.createElementNS(l,"rect"),p.setAttributeNS(c,"href",IMAGE_PATH+"Pattern2.png"),p.setAttribute("x","0"),p.setAttribute("y","0"),p.setAttribute("width","5"),p.setAttribute("height","5"),h.setAttribute("x","0"),h.setAttribute("y","0"),h.setAttribute("width","5"),h.setAttribute("height","5"),h.setAttribute("id","pattern"),h.setAttribute("patternUnits","userSpaceOnUse"),i||(a.setAttribute("stroke","#a5d5c2"),a.setAttribute("stroke-width",1)),$(h).append($(p)),$(d).append($(h)),$(s).append($(d))}if(-1!==t.indexOf("chartTitle")){var g=i?i:"titleRect";a.setAttributeNS(null,"id",g);var u,f,v=50,x=20;if(!$("#"+e).find(".highcharts-title").attr("y"))return;var y=$("#"+e).find(".highcharts-title")[0].getBBox();v=parseInt(y.x)-5,x=parseInt(y.y)-5,f=parseInt(y.height)+10,u=parseInt(y.width)+10,a.setAttribute("fill","url(#pattern)"),a.setAttribute("x",v),a.setAttribute("y",x),a.setAttribute("width",u),a.setAttribute("height",f),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",g),$(s).append($(a)),$(s).insertBefore($("#"+e).find(".highcharts-title"))}else if(-1!==t.indexOf("subTitle")){var g=i?i:"subtitleRect";a.setAttribute("id",g);var v,x,u,f;if(!$("#"+e).find(".highcharts-subtitle").attr("y"))return;var y=$("#"+e).find(".highcharts-subtitle")[0].getBBox();v=parseInt(y.x)-5,x=parseInt(y.y)-5,f=parseInt(y.height)+10,u=parseInt(y.width)+10,a.setAttribute("fill","url(#pattern)"),a.setAttribute("x",v),a.setAttribute("y",x),a.setAttribute("width",u),a.setAttribute("height",f),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",g),$(s).append($(a)),$(s).insertBefore($("#"+e).find(".highcharts-subtitle"))}else if(-1!==t.indexOf("xAxisTitle")){if(-1!==chartOnLoad.getInstanceByChartId(e).type.indexOf("SPIDERWEB")||-1!==chartOnLoad.getInstanceByChartId(e).type.indexOf("POLAR"))return;if(chartPreview.isBarChartApplied(o.options)){var v,x,u,g=i?i:"yTitleRect1";if(a.setAttribute("id",g),!$($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).attr("y"))return;a.setAttribute("transform",$($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).attr("transform"))}else{var v,x,u,g=i?i:"xAxiseRect";if(a.setAttribute("id",g),!$($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).attr("y"))return}var y=$($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0].getBBox();v=parseInt(y.x)-5,x=parseInt(y.y)-5,f=parseInt(y.height)+10,u=parseInt(y.width)+10,a.setAttribute("fill","url(#pattern)"),a.setAttribute("x",v),a.setAttribute("y",x),a.setAttribute("width",u),a.setAttribute("height",f),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",g),$(s).append($(a)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}else if(-1!==t.indexOf("yAxisTitle"))Ki(e,t,i,o,a,n,s);else if(-1!==t.indexOf("yAxisLabel")&&-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("TIME"))Zi(e,t,i,o,a,n,s);else if(-1!==t.indexOf("xAxisLabel")){if(-1!==chartOnLoad.getInstanceByChartId(e).type.indexOf("SPIDERWEB")||-1!==chartOnLoad.getInstanceByChartId(e).type.indexOf("POLAR"))return;var b=o.options.legend.itemStyle;if(b.font=o.options.chart.style&&o.options.chart.style.fontFamily?o.options.chart.style.fontFamily:"Arial",chartPreview.isBarChartApplied(o.options)){var b=o.options.legend.itemStyle;b.font=o.options.chart.style&&o.options.chart.style.fontFamily?o.options.chart.style.fontFamily:"Arial";var v,x,u,g=i?i:"yTitleRect1";a.setAttribute("id",g),x=parseInt($("#"+e).find(".highcharts-background").next().attr("y"))-10,u="30px",f=parseInt($("#"+e).find(".highcharts-background").next().attr("height"))+20,$($("#"+e).find(".highcharts-xaxis")[0]).find("text").length>0&&parseInt($($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).attr("x"))<parseInt($("#"+e).find(".highcharts-background").next().attr("x"))?(v=parseInt($($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).attr("x"))+5,u=parseInt($("#"+e).find(".highcharts-background").next().attr("x"))-v):-1===o.options.legend.align.indexOf("left")?(v=parseInt($("#"+e).find(".highcharts-background").attr("x"))+20,u=parseInt($("#"+e).find(".highcharts-background").next().attr("x"))-v):-1!==o.options.legend.align.indexOf("left")&&(v=parseInt($("#"+e).find(".highcharts-legend").attr("transform").split("(")[1])+Ji(e,b),u=parseInt($("#"+e).find(".highcharts-background").next().attr("x"))-v),a.setAttribute("fill","url(#pattern)"),a.setAttribute("x",v),a.setAttribute("y",x),a.setAttribute("width",u),a.setAttribute("height",f),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",g),$(s).append($(a)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}else{var v,x,u,g=i?i:"xAxiseRect",A=$("#"+e).find(".highcharts-legend").attr("transform")?parseInt($("#"+e).find(".highcharts-legend").attr("transform").split(",")[1]):void 0;!A&&$("#"+e).find(".highcharts-legend")&&$("#"+e).find(".highcharts-legend").attr("transform")&&(A=parseInt($("#"+e).find(".highcharts-legend").attr("transform").split(" ")[1])),a.setAttribute("id",g),u=parseInt($("#"+e).find(".highcharts-background").next().attr("width"))+10,v=parseInt($("#"+e).find(".highcharts-background").next().attr("x"))-5,x=parseInt($("#"+e).find(".highcharts-background").next().attr("y"))+parseInt($("#"+e).find(".highcharts-background").next().attr("height"))+2,f=$($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).length>0?parseInt($($($("#"+e).find(".highcharts-xaxis")[0]).find("text")[0]).attr("y"))-x-10:A>x&&-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("TIME")&&1===chartOnLoad.getInstanceByChartId(e).legendPos?parseInt(A)-x-5:-1===chartOnLoad.getInstanceByChartId(e).type.indexOf("TIME")?parseInt($("#"+e).find(".highcharts-background").attr("height"))-x-20:parseInt($($("#"+e).find(".highcharts-navigator").children("rect")).attr("y"))-x-5,a.setAttribute("fill","url(#pattern)"),a.setAttribute("x",v),a.setAttribute("y",x-2),a.setAttribute("width",u),a.setAttribute("height",f),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",g),$(s).append($(a)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}}else if(-1!==t.indexOf("chartLegend")){var g=i?i:"chartLegend";a.setAttributeNS(null,"id",g);var v,x,u,f,m;if(m=$("#"+e).find(".highcharts-legend").attr("transform")?$("#"+e).find(".highcharts-legend").attr("transform"):void 0,!m)return;v=parseInt(m.split("(")[1]),x=parseInt(m.split(",")[1]),x||(x=parseInt(m.split(" ")[1]));var y=$($("#"+e).find(".highcharts-legend")[0]).children()[0];f=parseInt(y.getAttribute("height")),u=parseInt(y.getAttribute("width")),o.options.legend.verticalAlign&&-1!==o.options.legend.verticalAlign.indexOf("bottom")&&-1!==o.options.chart.type.indexOf("funnel")&&(f+=10),a.setAttribute("fill","url(#pattern)"),a.setAttribute("x",v),a.setAttribute("y",x),a.setAttribute("width",u),a.setAttribute("height",f),s.setAttributeNS(null,"width",$("#"+e).find(".highcharts-background").attr("width")),s.setAttributeNS(null,"height",$("#"+e).find(".highcharts-background").attr("height")),s.setAttributeNS(null,"id",g),$(s).append($(a)),$(s).insertAfter($("#"+e).find(".highcharts-background").next())}else if(-1!==t.indexOf("chartArea"))a.setAttribute("fill","none"),a.setAttribute("id","chartArea"),a.setAttribute("fill-opacity","0.3"),a.setAttribute("stroke","#FFF"),a.setAttribute("stroke-width",1),a.setAttribute("x",parseInt($("#"+e).find(".highcharts-background").next().attr("x"))+2),a.setAttribute("y",parseInt($("#"+e).find(".highcharts-background").next().attr("y"))+2),a.setAttribute("width",parseInt($("#"+e).find(".highcharts-background").next().attr("width"))-4),a.setAttribute("height",parseInt($("#"+e).find(".highcharts-background").next().attr("height"))-4),$(a).insertAfter($("#"+e).find(".highcharts-background").next()),$($("#"+r).find(".highcharts-background").next()).attr("stroke","#a5d5c2"),$($("#"+r).find(".highcharts-background").next()).attr("stroke-width","1"),$("#"+r).find(".highcharts-background").attr("stroke-width","0");else if(-1!==t.indexOf("canvas")){var O,C;O=parseFloat($("#"+e).find(".highcharts-background").attr("width"))-parseFloat($("#"+e).width()),C=parseFloat($("#"+e).find(".highcharts-background").attr("height"))-parseFloat($("#"+e).height()),a.setAttribute("id","chartArea"),a.setAttribute("fill","none"),a.setAttribute("fill-opacity","0.3"),a.setAttribute("stroke","#FFF"),a.setAttribute("stroke-width",1),a.setAttribute("x",parseInt($("#"+e).find(".highcharts-background").attr("x"))+3),a.setAttribute("y",parseInt($("#"+e).find(".highcharts-background").attr("y"))+3),a.setAttribute("width",parseInt($("#"+e).find(".highcharts-background").attr("width"))-6-O),a.setAttribute("height",parseInt($("#"+e).find(".highcharts-background").attr("height"))-6-C),n.setAttribute("id","chartArea"),n.setAttribute("fill","none"),n.setAttribute("fill-opacity","0.3"),n.setAttribute("stroke","#a5d5c2"),n.setAttribute("stroke-width",1),n.setAttribute("x",parseInt($("#"+e).find(".highcharts-background").attr("x"))+2),n.setAttribute("y",parseInt($("#"+e).find(".highcharts-background").attr("y"))+2),n.setAttribute("width",parseInt($("#"+e).find(".highcharts-background").attr("width"))-4-O),n.setAttribute("height",parseInt($("#"+e).find(".highcharts-background").attr("height"))-4-C),$(a).insertAfter($("#"+e).find(".highcharts-background").next()),$(n).insertAfter($("#"+e).find(".highcharts-background").next().next()),$($("#"+r).find(".highcharts-background").next()).attr("stroke-width","0")}else-1!==t.indexOf("xplotLine")?ea(e,t,i,o,a,n,s):-1!==t.indexOf("plotLine")&&ta(e,t,i,o,a,n,s)}},aa=function(e){var t;switch(e){case 2:t="Top";break;case 1:t="Bottom";break;case 4:t="Left";break;case 5:t="TopRight";break;case 3:t="Right";break;case 0:t="None"}return t},ra=function(e,t,i){var a,r,n=$("#"+i);if(window.innerWidth<e+n.innerWidth()+n.outerWidth(!0)/2){-1!==s.indexOf("series")?(a=0,r=0):-1!==s.indexOf("canvas")||-1!==s.indexOf("chartArea")?(a=20,r=15):(a=32,r=27);var o=e+n.innerWidth()+n.outerWidth(!0)-50-window.innerWidth;$("#"+i).css("left",e-o/2+r),$(".arrow_border_two").css("left",n.width()/2+o/2+5-a),$(".arrow_border_one").css("left",n.width()/2+o/2+5-a)}else $(".arrow_border_two").css("left","50%"),$(".arrow_border_one").css("left","50%"),$("#"+i).css("left",e);$("#"+i).css("top",t).show()},na=function(e,t,i,a,n){var s,l="Solid";Ui(r),($("#OLEBoxFormat_fonts").is(":visible")||$("#OLEBoxFormat").is(":visible"))&&($.ZContextMenu.hideMenu(),$.ZContextMenu.colorpalette.hide()),$("#chartfontFamilyContainer").hide(),$("#gridContainer").hide(),$(".olboxformat_text").show(),$("#max").hide(),$("#interval").hide(),$("#min").hide(),$("#slantContainer").hide(),$("#legendContainer").hide(),$("#titleContainer").hide(),$("#minMaxContainer").hide(),$("#bgColorFonts").hide(),$("#lineTypeEditFonts").hide(),$("#minMaxContainer").removeClass("half");var c=chartOnLoad.getInstanceByChartId(ole.getCurrObj().id)&&-1!==chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).type.indexOf("TIME");if(-1!==i.indexOf("series"))o="OLEBoxFormat",$("#OLEBoxFormat_fonts").hide(),$("#chartFontSize2").hide(),$("#formatData1").hide(),$("#chartfontFamily").hide(),$("#GridColorGroup").hide(),s="3px solid "+chartGlance.getRGBA(u,1),$("#chartbgcolor2").css("border-bottom",s),$("#colorSlider").zslider("setValue",100*ri(u)),$("#chartTypeEdit").hide(),$("li[name='chartType']").removeClass("ui-state-active"),$("li[name='lineType']").removeClass("ui-state-active"),"line"==L||"spline"==L||""==L?(k?$("."+k).toggleClass("ui-state-active"):$(".Solid").toggleClass("ui-state-active"),$("#lineTypeEdit").show()):$("#lineTypeEdit").hide(),"polar"!==L&&-1!==chartPreview.getChartTypes(chartOnLoad.getInstanceByChartId(r).co.userOptions).indexOf("bar")&&""!==L?($("li#chartTypesEditCol").hide(),$("li#col").hide(),$("li#stackedcol").hide(),$("li#stackedcolpercent").hide(),$("li#chartTypesEditBar").show(),$("li#bar").show(),$("li#stackedbar").show(),$("li#stackedbarpercent").show(),$("#chartTypeEdit").show(),c||(S||I||T?"column"!=L&&"bar"!=L&&"area"!=L||!S?"line"==L&&I?$(".step"+L).toggleClass("ui-state-active"):"pie"==L&&T&&$("."+T).toggleClass("ui-state-active"):$("."+L+"stacked").toggleClass("ui-state-active"):$("."+L).toggleClass("ui-state-active"))):"polar"!==L&&-1!==chartPreview.getChartTypes(chartOnLoad.getInstanceByChartId(r).co.userOptions).indexOf("column")&&""!==L?($("li#chartTypesEditBar").hide(),$("li#bar").hide(),$("li#stackedbar").hide(),$("li#stackedbarpercent").hide(),$("li#chartTypesEditCol").show(),$("li#col").show(),$("li#stackedcol").show(),$("li#stackedcolpercent").show(),$("#chartTypeEdit").show(),c||(S||I||T?"column"!=L&&"bar"!=L&&"area"!=L||!S?"line"==L&&I?$(".step"+L).toggleClass("ui-state-active"):"pie"==L&&T&&$("."+T).toggleClass("ui-state-active"):$("."+L+"stacked").toggleClass("ui-state-active"):$("."+L).toggleClass("ui-state-active"))):"polar"===L||-1!=chartPreview.getChartTypes(chartOnLoad.getInstanceByChartId(r).co.userOptions).indexOf("bar")||-1!=chartPreview.getChartTypes(chartOnLoad.getInstanceByChartId(r).co.userOptions).indexOf("column")||-1===L.indexOf("line")&&-1===L.indexOf("pie")&&-1===L.indexOf("area")||($("li#chartTypesEditCol").show(),$("li#col").show(),$("li#stackedcol").show(),$("li#stackedcolpercent").show(),$("li#chartTypesEditBar").show(),$("li#bar").show(),$("li#stackedbar").show(),$("li#stackedbarpercent").show(),$("#chartTypeEdit").show(),c||(S||I||T?"column"!=L&&"bar"!=L&&"area"!=L||!S?"line"==L&&I?$(".step"+L).toggleClass("ui-state-active"):"pie"==L&&T&&$("."+T).toggleClass("ui-state-active"):$("."+L+"stacked").toggleClass("ui-state-active"):$("."+L).toggleClass("ui-state-active"))),$("#"+r).find(".highcharts-background").attr("stroke-width","0"),$($("#"+r).find(".highcharts-background").next()).attr("stroke-width","0"),ra(e,t,"OLEBoxFormat","series");else if(-1!==i.indexOf("chartArea")){ia(r,i),o="OLEBoxFormat",$("#OLEBoxFormat_fonts").hide(),$("#chartFontSize2").hide(),$("#formatData1").hide(),$("#chartfontFamily").hide(),$("#GridColorGroup").show(),$("#gridContainer").show(),$("#lineTypeEdit").hide(),$("#chartTypeEdit").hide();var d=chartGlance.getColorCodeFromGradient(N(r).userOptions.chart.plotBackgroundColor);s="3px solid "+chartGlance.getRGBA(d,1),$("#colorSlider").zslider("setValue",100*ri(chartGlance.getColorCodeFromGradient(N(r).userOptions.chart.plotBackgroundColor))),$("#chartgridcolor2").css("border-bottom","3px solid "+N(r).userOptions.yAxis[0].gridLineColor),d?$("#chartbgcolor2").css("border-bottom",s):$("#chartbgcolor2").css("border-bottom","3px solid #FFF"),ra(e,t,"OLEBoxFormat")}else if(-1===i.indexOf("canvas")){ole.isActive()&&ole.getCurrObj().id===r||(chartOnLoad.clickOpertionOnChartContainer(n,r),Z("canvas")),$(".olboxformat_text").show(),$("#lineTypeEdit").hide(),$("#chartTypeEdit").hide();var h,g,v,x=N(r),s="3px solid ";if(f="3px solid ",o="OLEBoxFormat_fonts",$("#OLEBoxFormat").hide(),$("#formatData1").show(),-1!==i.indexOf("chartTitle")){ia(r,i);var y=x.options.title.style;v=x.options.title.text,s+=chartGlance.getRGBA(y.color,1),p=y.color,h=y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y.fontSize,$("#titleContainer").show()}else if(-1!==i.indexOf("xAxisTitle")){if(-1!==chartOnLoad.getInstanceByChartId(r).type.indexOf("SPIDERWEB")||-1!==chartOnLoad.getInstanceByChartId(r).type.indexOf("POLAR"))return;ia(r,i);var y=x.options.xAxis[0].title.style;v=x.options.xAxis[0].title.text,s+=chartGlance.getRGBA(y.color,1),h=y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y.fontSize||"12px",p=y.color,$("#titleContainer").show()}else if(-1!==i.indexOf("yAxisTitle")){if(-1!==chartOnLoad.getInstanceByChartId(r).type.indexOf("SPIDERWEB")||-1!==chartOnLoad.getInstanceByChartId(r).type.indexOf("POLAR"))return;ia(r,i);var b=i.split(".")[1]-1,y=x.options.yAxis[b].title.style;v=x.options.yAxis[b].title.text,s+=chartGlance.getRGBA(y.color,1),h=y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y.fontSize||"12px",p=y.color,$("#titleContainer").show()}else if(-1!==i.indexOf("subTitle")){ia(r,i);var y=x.options.subtitle.style;v=x.options.subtitle.text,s+=chartGlance.getRGBA(y.color,1),h=y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y.fontSize,p=y.color,$("#titleContainer").show()}else if(-1!==i.indexOf("yAxisLabel")){-1===chartOnLoad.getInstanceByChartId(r).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstanceByChartId(r).type.indexOf("POLAR")&&ia(r,i);var b=i.split(".")[1]-1,y=x.options.yAxis[b].labels.style;v="",s+=chartGlance.getRGBA(y&&y.color?y.color:"#000000",1),h=y&&y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y&&y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y&&y.fontSize?y.fontSize:"12px",p=y&&y.color?y.color:"#000000",-1===chartOnLoad.getInstanceByChartId(r).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstanceByChartId(r).type.indexOf("POLAR")?($("#min").val(isNaN(x.options.yAxis[b].min)?"":x.options.yAxis[b].min),$("#max").val(isNaN(x.options.yAxis[b].max)?"":x.options.yAxis[b].max),$("#interval").val(isNaN(x.options.yAxis[b].tickInterval)?"":x.options.yAxis[b].tickInterval),$("#minMaxContainer").show(),$("#minMaxContainer").addClass("half"),$("#min").show(),$("#max").show(),$("#interval").show(),document.getElementById("min").focus()):t+=30}else if(-1!==i.indexOf("xAxisLabel")){ia(r,i);var y=x.options.xAxis[0].labels.style;v="",s+=chartGlance.getRGBA(y&&y.color?y.color:"#000000",1),h=y&&y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y&&y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y&&y.fontSize?y.fontSize:"12px",p=y&&y.color?y.color:"#000000",$("#slant1").zcombo("setValue","string"!=typeof parseInt(x.options.xAxis[0].labels.rotation)&&"undefined"!=typeof x.options.xAxis[0].labels.rotation?x.options.xAxis[0].labels.rotation:""),!chartOnLoad.getInstanceByChartId(r).grouping||chartGlance.getGroupingDepth(x.options)<1?$("#slantContainer").show():e+=29}else if(-1!==i.indexOf("chartLegend")){ia(r,i);var y=x.options.legend.itemStyle;v="",s+=chartGlance.getRGBA(y&&y.color?y.color:"#000000",1),h=y.fontWeight&&-1!==y.fontWeight.indexOf("bold")?!0:!1,g=y.fontStyle&&-1!==y.fontStyle.indexOf("italic")?!0:!1,size=y.fontSize,p=y.color||"#000000",$("#legendContainer").show()}else if(-1!==i.indexOf("plotLine")||-1!==i.indexOf("xplotLine")){-1===chartOnLoad.getInstance(r).type.indexOf("SPIDERWEB")&&-1===chartOnLoad.getInstance(r).type.indexOf("POLAR")&&ia(r,i);var A=-1!==i.indexOf("xplotLine")?!1:!0,m=i.split(".")[1],O=A?m.split("_")[0]-1:0,C=m.split("_")[1]-1,w=A?x.options.yAxis[O].plotLines[C]:x.options.xAxis[0].plotLines[C];v=w.label?w.label.text:"",s+=chartGlance.getRGBA(w.label&&w.label.style?w.label.style.color:"#000000",1),h=w.label.style&&w.label.style.fontWeight&&-1!==w.label.style.fontWeight.indexOf("bold")?!0:!1,g=w.label.style&&w.label.style.fontStyle&&-1!==w.label.style.fontStyle.indexOf("italic")?!0:!1,size=w.label&&w.label.style&&w.label.style.fontSize?w.label.style.fontSize:"12px",f+=chartGlance.getRGBA(w&&w.color?w.color:"#000000",1),l=w.dashStyle?w.dashStyle:"Solid",$("#minMaxContainer").hide(),$("#legend1").hide(),$("#formatData1").show(),$("#titleContainer").show(),$("#chartFontColor2").show(),$("#bgColorFonts").show(),$("#lineTypeEditFonts").show()}$("#"+r).find(".highcharts-background").attr("stroke-width","0"),$($("#"+r).find(".highcharts-background").next()).attr("stroke-width","0"),s?$("#chartFontColor2").css("border-bottom",s):$("#chartFontColor2").css("border-bottom","3px solid #FFF"),h?$('label[for = "chartbold"]').addClass("oleChartActive"):$('label[for = "chartbold"]').removeClass("oleChartActive"),g?$('label[for = "chartitalic"]').addClass("oleChartActive"):$('label[for = "chartitalic"]').removeClass("oleChartActive"),$("#chartFontSize").zcombo("setValue",size),$("#legend1").zcombo("setValue",aa(chartOnLoad.getInstanceByChartId(r).legendPos)),$("#customTitle").val(chartPreview.decodeHTMLContent(v)),f?$("#chartbgcolorFonts2").css("border-bottom",f):$("#chartbgcolorFonts2").css("border-bottom","3px solid #FFF"),$("#linetypeeditmenufonts [name='lineType']").removeClass("ui-state-active"),$("#linetypeeditmenufonts ."+l).toggleClass("ui-state-active"),ra(e,t,"OLEBoxFormat_fonts","chartArea"),document.getElementById("customTitle").focus()}else if(1!==i.indexOf("canvas")){ia(r,i),o="OLEBoxFormat",$("#OLEBoxFormat_fonts").hide(),$("#chartFontSize2").hide(),$("#lineTypeEdit").hide(),$("#chartTypeEdit").hide();var P=chartOnLoad.getInstanceByChartId(r),R=(P.co.options,chartGlance.getColorCodeFromGradient(N(r).userOptions.chart.backgroundColor));if(s="3px solid "+chartGlance.getRGBA(R,1),R?$("#chartbgcolor2").css("border-bottom",s):$("#chartbgcolor2").css("border-bottom","3px solid #FFF"),$("#chartfontFamily").show(),N(r).userOptions.chart.style){var E=N(r).userOptions.chart.style.fontFamily;E=E?E:"Arial",$("#chartfontfamilys").zcombo("setValue",E)}$("#chartfontFamilyContainer").show(),$("#colorSlider").zslider("setValue",100*ri(chartGlance.getColorCodeFromGradient(N(r).userOptions.chart.backgroundColor))),ra(e,t,"OLEBoxFormat","canvas")}},sa=function(e,t,i){var a,n;-1!==t.indexOf("series")?(n="bar"==L||"pie"==L||"area"==L||"column"==L||"boxplot"==L?parseInt(e.pageX)-63:"line"==L||"spline"==L?parseInt(e.pageX)-80:""==L?parseInt(e.pageX)-64:parseInt(e.pageX)-45,a=parseInt(e.pageY)-43):-1!==t.indexOf("chartArea")?(ole.isActive()&&ole.getCurrObj().id===r||(chartOnLoad.clickOpertionOnChartContainer(e,r),Z("chartArea")),n=parseInt(e.pageX)-64,a=parseInt(e.pageY)-40):-1!==t.indexOf("yAxisTitle")?(n=parseInt(e.pageX)-87,a=parseInt(e.pageY)-70):-1!==t.indexOf("xAxisTitle")?(n=parseInt(e.pageX)-87,a=parseInt(e.pageY)-70):-1!==t.indexOf("yAxisLabel")?(n=parseInt(e.pageX)-85,a=parseInt(e.pageY)-70):-1!==t.indexOf("xAxisLabel")?(n=parseInt(e.pageX)-115,a=parseInt(e.pageY)-48):-1!==t.indexOf("subTitle")?(n=parseInt(e.pageX)-87,a=parseInt(e.pageY)-75):-1!==t.indexOf("chartTitle")?(n=parseInt(e.pageX)-87,a=parseInt(e.pageY)-75):-1!==t.indexOf("chartLegend")?(n=parseInt(e.pageX)-119,a=parseInt(e.pageY)-48):-1!==t.indexOf("xplotLine")?(n=parseInt(e.pageX)-121,a=parseInt(e.pageY)-66):-1!==t.indexOf("plotLine")?(n=parseInt(e.pageX)-117,a=parseInt(e.pageY)-66):(n=parseInt(e.pageX)-85,a=parseInt(e.pageY)-43),na(n,a,t,i,e)},oa=function(e){r=e},la=function(){s="reset"},ca=function(e){C=e},da=function(e){C+=1,chartOnLoad.updateChartSelectionById(e,c,C,C-1==0?"series":"point")},ha=function(e){var t=chartOnLoad.getChartSelectionById(e),i=t&&t[c]?t[c]:null,a=i?i.ClickCount:0;return ca(a),0==a},pa=function(e){var t=$("#"+e),i=t.offset(),a=t.height();$(".cMenuPaletteHolder").css({top:i.top+a+"px",left:i.left+"px",right:"auto","z-index":"1256"});var r=N(ole.getCurrObj().id),n=r.options,s=n.colorOptions.colorTheme,o=s.isReversed,l=s.name,c=s.basecolor;It(l,!1);var d=".colorpaletteMenu li[data-name="+l+"]",h=$(".cMenuPaletteHolder").find(".active");if($(h).removeClass("active"),-1!==l.indexOf("CUSTOM"))$(".colorMenuCustomPallete").addClass("active"),$(".colorMenuCustomPallete").css("background-image",SheetChartColor(c).getLinerGradient(6)),$(".colorMenuCustomPallete").attr("data-basecolor",c),$($("#chartmenucustomcolorDropDown span")[0]).css("background",c);else{var p=$(d);$(p).addClass("active")}-1==l.indexOf("COLORFUL")&&(Ct(o,!0),$("#customMenuColorToggle").prop("checked",o)),$(".cMenuPaletteHolder").toggle()},ga=function(e,t){var i=chartOnLoad.getChartSelectionById(e),a=i&&i[t]?i[t]:null,r=a?a.SelectionType:"series";return-1!==r.indexOf("series")},ua=function(e,t){return e.series[t]?"pie"!==e.series[t].type:null},fa=function(e,t,i){var a=chartPreview.getHCInstance(e);try{if(!a)return;if(!isUndefined(t)){var r=chartPreview.getDashStyle();isUndefined(r)&&isUndefined(r.sIndex)&&(r[t]="solid"),(isUndefined(a.series[t].type)||"pie"!==a.series[t].type)&&a.series[t].update({dashStyle:r[t]}),a.series[t].update({borderWidth:-1!==a.options.chart.type.indexOf("pie")?1:0,borderColor:-1!==a.options.chart.type.indexOf("pie")?"#FFFFFF":"#000000"})}isUndefined(t)||isUndefined(i)||a.series[t].data[i].update({borderWidth:-1!==a.options.chart.type.indexOf("pie")?1:0,borderColor:-1!==a.options.chart.type.indexOf("pie")?"#FFFFFF":"#000000"})}catch(e){}},va=function(e){var t=!ga(r,c),i=e.options,a=t?e.series[c].data[l].color:e.series[c].color,n=i.chart.plotBackgroundColor?i.chart.plotBackgroundColor:chartGlance.getColorCodeFromGradient(i.chart.backgroundColor),s=SheetChartColor(a).isLuminance(),o=SheetChartColor(n).isLuminance();return s||o?"#FFFFFF":"#000000"},xa=function(e,t){var i,a=$("#"+e).find(".highcharts-series-"+t),r=a[0];try{i=$(r).children()}catch(e){}for(var n,s=i.length,o=0;s>o;o++)n=i[o],$(n).attr("class","animateLinePath")},ya=function(e,t){var i,a=$("#"+e).find(".highcharts-series-"+t),r=a[0];try{i=$(r).children()}catch(e){}for(var n,s=i.length,o=0;s>o;o++)n=i[o],$(n).attr("class","")},ba=function(e,t,i,a){if(-1!==a.indexOf("series")){var r=chartPreview.getHCInstance(e);if(!r)return;var n=r.options;if(t){var s=n.series[t]&&n.series[t].dashStyle?n.series[t].dashStyle:"solid";ct(t,s)}ha(e)?r.series[t].update({borderWidth:.7,borderColor:va(r,t,i)}):r.series[t].data[i].update({borderWidth:.7,borderColor:va(r,t,i)}),xa(e,t)}},Aa=function(e,t,i){-1!==i.indexOf("series")?(ba(e,t,l,i),da(e)):ma(e)},ma=function(e){try{if(!e)return;var t=null;t=chartOnLoad.getInstanceByChartId(e).co.userOptions.chart.type,isUndefined(t)||-1!==t.indexOf("pie")||-1!==t.indexOf("funnel")||-1!==t.indexOf("waterfall")||(ya(e,c),fa(e,c,l)),chartOnLoad.resetChartSelectionById(e),ca(0)}catch(e){}},Oa=function(e,i,n,o,d,h){if(tt(n)&&pt()){L="",w="",k="",Z(-1===o.indexOf("canvas")&&-1===o.indexOf("Title")&&-1===o.indexOf("Label")||!ole.isActive()?"stopPropagation":"canvas"),oa(n);var p=c,g=l;ya(n,c),-1===o.indexOf("canvas")&&-1===o.indexOf("subTitle")&&(t=i.series,a=i,l=d,c=h,u=null!==i.color?i.color:i.series?i.series.color:null,!i.series||i.series.userOptions&&i.series.userOptions.hasOwnProperty("isRegressionLine")||(L=i.series.chart&&i.series.chart.polar?"polar":i.series.type,("line"===i.series.type||"spline"===i.series.type)&&(k=i.series.userOptions.dashStyle),w=i.series.index,S=i.series.options?i.series.options.stacking:void 0,I=i.series.options?i.series.options.step:void 0,T=i.series.options?i.series.options.major:void 0),i&&i.series&&i.series.userOptions&&i.series.userOptions.hasOwnProperty("isRegressionLine")&&(k=i.series.userOptions.dashStyle)),r=n,s=o;var f=chartOnLoad.getInstanceByChartId(n).co.options.chart.type;if(fa(n,p,g),-1===f.indexOf("pie")&&-1===f.indexOf("funnel")&&-1===f.indexOf("waterfall")&&!chartPreview.isIndexPie(s,c,n))try{Aa(n,c,o)}catch(e){}Ui(n),sa(e,s,null)}else K(!1)},Ca=function(){isAggregateOn=!1;var e=(getObj("columns").checked?"COLS":"ROWS",getObj("dataRange").value,ole.getCurrObj()&&ole.getCurrObj().id||"preview"),t={};t.enabled=!1,t.colheaders=void 0,t.rowheaders=void 0,t.dateOperations="NONE,NONE,NONE",t.type="COUNT",chartOnLoad.getInstanceByChartId(e).co.options.aggregation=t,chart.createChart(!0),("SCATTER"===previousChartType||"BUBBLECHART"===previousChartType||"POLAR"===previousChartType||-1!==previousChartType.indexOf("TIME"))&&wa(previousChartType),za(!1)},$a=function(e,t){var i=WorkSheets.getAssociatedActiveSheetName(),a=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;a||(a="preview"),chartOnLoad.addDepthHeaders(a,i,e,t)},La=function(e){var t=WorkSheets.getAssociatedActiveSheetName(),i=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;i||(i="preview"),chartOnLoad.addDepthOperations(i,t,e)},Sa=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;return t||(t="preview"),depthHeaders=chartOnLoad.getDepthHeaders(t,e)},Ia=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;return t||(t="preview"),depthOperations=chartOnLoad.getDepthOperations(t,e)},Ta=function(){var e=WorkSheets.getAssociatedActiveSheetName(),t=ole&&ole.getCurrObj()&&ole.isActive()?ole.getCurrObj().id:null;if(!t&&v)t="preview";else if(!t&&!v)return;return depthVals=chartOnLoad.getDepthVals(t,e)},wa=function(){var e=getObj("columns").checked?"COLS":"ROWS";"COLS"==e?(getObj("fcl").disabled=!0,getObj("frl").disabled=!1):(getObj("frl").disabled=!0,getObj("fcl").disabled=!1)},ka=function(){v=!v,$("#previewAn").unbind();v?$("div.prvButton span").removeClass("prvExp"):$("div.prvButton span").addClass("prvExp");if(setTimeout(function(){Ra(v)},1e3),v){var e=sheetdialog.getOpenedDialog();if(window.innerWidth<=e.position().left+e.width()+500){var t="-="+(e.position().left+e.width()+520-window.innerWidth);e.animate({left:t},100,"easeInOutQuart")}e.animate({width:1020},1e3,"easeInOutQuart"),setTimeout(function(){Pa()},1e3)}else{var e=sheetdialog.getOpenedDialog();e.animate({width:510},1e3,"easeInOutQuart"),getObj("preview").style.display="none",chart.removeInstance(WorkSheets.getAssociatedActiveSheetName(),"preview")}},Pa=function(){getObj("preview").style.display="",$("#preview").empty(),chart.createChart(v)},Ra=function(){$("#previewAn").bind("click",function(){ka()})},Ea=function(){var e=getObj("dataRange").value.replace(/\$/g,"").replace(/!/g,".").replace(/\,/g,";");Wa(e)},Ba=function(t,i){function a(){if(i)return s.src=o.toDataURL("image/"+t.extn),s;var e=document.createElement("a");e.href=o.toDataURL("image/"+t.extn),e.download=t.fileName+"."+t.extn;var a=document.body;a.appendChild(e),e.click(),a.removeChild(e)}{var r=chartPreview.getHCInstance(t.chartId),n=r.getSVG(e(r.userOptions)),s=document.createElement("img"),o=document.createElement("canvas");o.getContext("2d")}return o.height=t.height,o.width=t.width,canvg(o,n,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){a()}}),i?s:void 0},Na=function(e,t){var i=chart.getNumericColumnsFromDecTable(e),a=$("#filterColumns option").length>0?$("#filterColumns").zcombo("getValue"):null,r=Fa(i,a);if(-1!==r)for(var n=Ha(r,e),s=!1,o=0;o<t.length;o++){var l=t[o];if("COLS"==e&&n>=l.sC&&n<=l.eC){s=!0;break}if("ROWS"==e&&n>=l.sR&&n<=l.eR){s=!0;break}}s||($("#filterType").zcombo("setValue","NONE"),chart.resetFilterOptions(),chart.disableFilterColumns())},Fa=function(e,t){if(null==t||""==t)return-1;for(var i=0;i<e.length;i++)if(e[i].headerName===t)return e[i].headerRange;return-1},Wa=function(e){var t=e.split(";"),i=chartPreview.getDepthHeaders(),a=$("#rows").is(":checked")?"ROWS":"COLS",r=chart.getDataRanges(e,a);Na(a,r),Ma(i,r,a,t)},Ma=function(e,t,i,a){if(null!=e){for(var r=0;r<e.length;){var n=Ha(e[r],i);if(-1!=n){for(var s=!1,o=0;o<t.length;o++){var l=t[o];if("COLS"==i&&n>=l.sC&&n<=l.eC){s=!0;break}if("ROWS"==i&&n>=l.sR&&n<=l.eR){s=!0;break}}s?r++:e.splice(r,1)}else r++}e=Da(e,i,t[0])}chart.createChart(v,!0),toggleCombineRangeOption=a.length>1?$("#appedingWay").show():$("#appedingWay").hide(),za(!1)},Da=function(e,t,i){var a=getObj("dataRange").value.replace(/\$/g,"").replace(/!/g,".").replace(/\,/g,";"),r=a.split("."),n=[];if(null!=e&&e.length>0)for(var s=0;s<e.length;s++)if("COLS"==t){var o=getDataFrom2DRangeText(e[s]),l=r[0]+"."+getCellLabel(i.sR,o.sC);n.push(l)}else{var o=getDataFrom2DRangeText(e[s]),l=r[0]+"."+getCellLabel(o.sR,i.sC);n.push(l)}chartPreview.setDepthHeaders(n,null)},Ha=function(e,t){var i=-1;if(null!=e){var a=CellUtils.getRangeFromCellLbl(e);i="COLS"===t?a.startCol:a.startRow}return i},za=function(e){if(-1===chartDialogState.indexOf("PIVOT")){var t=getObj("dataRange").value.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");if(!chart.isValidRange(t,"submit"))return!1;var i=$("#rows").is(":checked")?"ROWS":"COLS",a="COLS"===i?$("#frl").is(":checked"):"ROWS"!==i||-1===previousChartType.indexOf("SCATTER")&&-1===previousChartType.indexOf("TIME")&&-1===previousChartType.indexOf("POLAR")&&-1===previousChartType.indexOf("BUBBLE")?$("#frl").is(":checked"):!1,r="ROWS"===i?$("#fcl").is(":checked"):"COLS"!==i||-1===previousChartType.indexOf("SCATTER")&&-1===previousChartType.indexOf("TIME")&&-1===previousChartType.indexOf("POLAR")&&-1===previousChartType.indexOf("BUBBLE")?$("#fcl").is(":checked"):!1,n=$("#combineRange").zcombo("getValue"),s=$("#hideCellsToggle").is(":checked"),o=null!=chartPreview.getDepthHeaders()&&chartPreview.getDepthHeaders().length>0;chart.doRecommendationChart(t,i,n,a,r,s,e,o)}},ja=function(e){var t;if("chartTitle"===e?t=getObj("chartTitle").value:"chartSubTitle"===e?t=getObj("chartSubTitle").value:"xAxisTitle"===e?t=getObj("xAxisTitle").value:"yAxisTitle"===e&&(0==chartPreview.getAxisOptionsIndex()?t=getObj("yAxisTitle").value:(e="yAxisTitle"+chartPreview.getAxisOptionsIndex(),t=getObj("yAxisTitle"+chartPreview.getAxisOptionsIndex()).value)),-1!==t.indexOf("'")&&t.split("'").length>2){var i=t.split("'");t=i[1]+i[2],$("#"+e).val(t)}var a=t.split(":");Ga(a[0],e)},Ga=function(e,t){var i,a=""!==e?e.split(".")[1]:"";if(""!==a){var r=parseInt(a.charAt(0),36)-10,n=parseInt(a.substring(1))-1;if(WorkSheets.getActiveSheetName().toUpperCase()!==e.split(".")[0].toUpperCase()||null===getCell(n,r)||null==chartPreview.getHCInstance("preview")){var s=new AjaxRequest,o=new RequestParameters(ActionConstants.CHART_CELL_REF);return o.setParameters(WorkSheets.getAssociatedActiveSheetName(),e),s.init("POST",o.getURL(),!0,o.getParametersAsString()),s.sendRequest(s),void s.addEventListener("onComplete",function(e){var a=parseJSON(e.responseText),r=a.cellRef;i=r.crv.rv?r.crv.rv:" ","chartTitle"===t?ti("preview",i):"chartSubTitle"===t?ni("preview",i):"xAxisTitle"===t?Ci("preview",i):"yAxisTitle"===t?Bi("preview",i):"yAxisTitle1"===t&&zi("preview",i)})}i=getCell(n,r).getAttribute("cv")?getCell(n,r).getAttribute("cv"):" ","chartTitle"===t?ti("preview",i):"chartSubTitle"===t?ni("preview",i):"xAxisTitle"===t?Ci("preview",i):-1!==t.indexOf("yAxisTitle")&&zi("preview",i)}},Va=function(){for(var e=new Array,t=$(".aggHldr"),i=0;i<t.length;i++){var a=t[i],r=$(a).find(".depthHeaders").find("select:eq(1)");if(r.length>0){var n=$(r).zcombo("getValue");e.push(0!==$(r).zcombo("getSelectedIndex")?"DATE-"+n:"NONE")}else{var s=$(a).find(".depthHeaders").find("select:first");"choose"!==$(s).zcombo("getValue")&&e.push("NONE")}}chartPreview.setDepthOperations(e)},Ua=function(){var e=0;$(".aggHldr").each(function(t,i){id=$(i).find(".depthHeaders").find("select:first").attr("id");var a=id.substring(id.length-1,id.length);parseInt(a)>parseInt(e)&&(e=a)}),depthDragDrop.addNewDepthHeader(parseInt(e)+1)},_a=function(){if(!chartOnLoad.getInstanceByChartId("preview"))return!0;var e=$("#aggreoperation").zcombo("getValue"),t=chartOnLoad.getInstanceByChartId("preview").co.options.aggregation,i=chartOnLoad.getInstanceByChartId("preview").seriesIn,a="COLS"==i?t.colheaders:t.rowheaders,r=[];r=a?a.split(";"):[];var n=depthDragDrop.checkIfAggregationEnabled(),s="NONE"!==$("#filterType").zcombo("getValue"),o=!1,l=!1;if(t?(n&&(o=!0),l=r.length>0&&(null==chartPreview.getDepthHeaders()||0==chartPreview.getDepthHeaders().length)?!0:!1):o=!0,l){var c;return s&&(c=$("#filterColumns").zcombo("getValue")),chart.loadNumericColumnsInFilter(),void(s&&$("#filterColumns").zcombo("setValue",c))}o&&("COUNT"==e?(chart.unloadExistingColumnsInFilter(),Ya(),s&&$("#filterColumns").zcombo("setSelectedIndex",1)):(chart.loadNumericColumnsInFilter(),s&&$("#filterColumns").zcombo("setSelectedIndex",1)))},Ya=function(){var e=chart.getAggregationValue(),t=jsMsg["Chart.Aggregation.Legends.countof"]+" "+e,i=$("#filterColumns");$("<option/>",{id:"filter_"+t,value:t,text:t}).appendTo(i),$(i).zcombo("refresh")},qa=function(e){var t=$(e).parent();depthDragDrop.deleteDepthHeader(t)},Ja=function(){chart.showHideChartOptions($("#aggreFilter"))},Qa=function(){$("#recommendWrapper").css("display","block"),$("#aggregationDiv").hide()},Xa=function(e){v=e},Ka=function(){return v},Za=function(){chartPreview.setDepthHeaders(null),chartPreview.setDepthOperations(null),$("#aggreoperation").zcombo("setValue","COUNT"),$("#aggreoperation").zcombo("refresh"),depthDragDrop.enableLabelCheckBox(),depthDragDrop.removeAllSelectComponents(),_a()},er=function(e){RangeSelector.on({el:e,single:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){appEvent.trigger("chart.depthHeaders",[])}})};return{getHCInstance:N,ctLegendPos:kt,changeChartTheme:Tt,setMajorGrid:Ai,setMinorGrid:mi,setAnimation:yi,setTooltip:oi,changeTrendline:Rt,changeTrendlineDegree:Pt,changedataLabels:Bt,chartQuickEditRequest:Et,setPreviewVariable:Xa,applyContextualToolbar:Oa,hideContextualToolbar:Gi,removeUnwantedStyleProperty:Vi,setRemoveSpecificChartFeature:ii,setCurrentChartId:oa,getPreviousEventType:at,resetPreviousEventWith:Z,getChartCustomizationEventType:Yi,applyRectSvg:ia,isCustomizationMode:rt,setRemovedTooltipValue:nt,setRemovedZoomType:lt,toggleRectSvg:_i,getChartMode:tt,setChartMode:K,removeRectSvg:Ui,getPreviewState:Ka,getTooltipValue:st,getZoomType:ot,setOleLayer:Y,getOleLayer:q,resetChart:jt,setChartCustomizationPermission:ht,getChartPermission:pt,getOpacity:ri,setCurrentSheetId:E,calculateTextMatrics:qi,copyChartStyle:Ht,pasteCopiedStyle:zt,isCopiedStyle:Mt,enableOrDisablePasteOption:Dt,doRecommendationChart:za,calculateLegendHeight:Xi,calculateLegendWidth:Ji,showChartColorPallate:pa,hideColorPallate:et,generateMonochromaticShades:It,isComboChart:V,isPieChart:ua,getAllChartTypesInComboChart:U,getChartTypes:_,isIndexPie:it,frameAxisOptions:Ri,assignValues:Ti,setDashStyle:ct,getDashStyle:dt,getAxisOptionsIndex:W,setAxisOptionsIndex:F,setAxisOptions:j,getAxisOptions:G,setDepthHeaders:$a,getDepthHeaders:Sa,getDepthVals:Ta,createMultiplePlotLines:ci,updatePlotLineMultiple:Wi,assignXAxisPlotLine:ki,rangeSelectorFtn:er,setDepthOperations:La,getDepthOperations:Ia,calculateDepthOperations:Va,setDepthIndices:M,getDepthIndices:H,calculateDepthHeaders:hi,dragCheckBoxes:D,getHeaderRangeFromIndices:fi,deletePlotLine:di,showAggregationTab:Ja,closeAggDialog:Qa,resetAggregation:Za,enableDisableFilterColumns:At,clearDepthIndices:z,addNewDepthHeader:Ua,deleteDepthHeader:qa,checkIfAggregationRequestNeeded:gi,downloadAs:Ba,reloadFilterComboIfRequired:_a,changeDateOperations:Nt,isBarChartApplied:Qi,decodeHTMLContent:Ii}}(jQuery);
function ChartAggregation(){this.id=null,this.queueRequest=null,this.lastResponse=null}function processDepthArray(e,t,a){t=[];if("COLS"==a)for(var r=0;r<e.length;r++){for(var n=e[r],s=[],o=n.sC;o<=n.eC;){var i=getMergeSpanInfo(n.sR,o,a),l=getHeaderValueFromDecTable(r,o);l=null!=l?l:{},i>0&&(l=getSplitRanges(o,a));var g={};g.headerLabel=jsMsg["Sheet.Column"]+" "+getColHeadLabel(o+1),checkIfHeaderAlreadyExists(t,g.headerLabel)||(g.headerValue=l.headerValue,g.type=l.type,g.headerRange=n.sheetName+"."+getCellLabel(n.sR,o),s.push(g)),o+=i+1}t.push(s)}else for(var r=0;r<e.length;r++){for(var n=e[r],s=[],o=n.sR;o<=n.eR;){var i=getMergeSpanInfo(o,n.sC,a),l=getHeaderValueFromDecTable(r,o);l=null!=l?l:{},i>0&&(l=getSplitRanges(o,a));var g={};g.headerLabel=jsMsg["Sheet.Row"]+" "+getRowHeadLabel(o),checkIfHeaderAlreadyExists(t,g.headerLabel)||(g.headerValue=l.headerValue,g.type=l.type,g.headerRange=n.sheetName+"."+getCellLabel(o,n.sC),s.push(g)),o+=i+1}t.push(s)}return t}function processDecTable(e,t){if(decTable=[],null!=t)for(var a=0;a<t.length;a++){var r=isUndefined(t[a])||null==t[a]?[]:Object.keys(t[a]),n=t[a],s=getDataFrom2DRangeText(n.rangeStr);decTable[a]={};for(var o=0;o<r.length;o++)if("splitRanges"!==r[o]&&"rangeStr"!==r[o]){var i={};i.headerValue=n[r[o]].colHead||n[r[o]].rowHead,i.headerLabel="COLS"==e?jsMsg["Sheet.Column"]+" "+getColHeadLabel(parseInt(r[o])+1):jsMsg["Sheet.Row"]+" "+getRowHeadLabel(parseInt(r[o])),i.headerRange="COLS"==e?s.sheetName+"."+getCellLabel(s.sR,parseInt(r[o])):s.sheetName+"."+getCellLabel(parseInt(r[o]),s.sC),i.type=n[r[o]].type,decTable[a][r[o]]=i}}return decTable}function processSplitRanges(e){splitRanges=[];for(var t=0;t<e.length;t++)for(var a=null!=e[t]?Object.keys(e[t]):[],r=e[t],n=0;n<a.length;n++)if("splitRanges"===a[n])for(var s=r[a[n]],o=s.rangeData.headers,i=isUndefined(o)||null==o?[]:Object.keys(o),l=0;l<i.length;l++)splitRanges.push(o[i[l]])}function getMergeSpanInfo(e,t,a){var r=Merge.getCellInfo(e,t);return r?"COLS"==a?r.endCol-r.startCol:r.endRow-r.startRow:0}function getHeaderValueFromDecTable(e,t){var a=decTable;if(!isUndefined(a)&&a.length>e)for(var r=Object.keys(a[e]),n=0;n<r.length;n++)if(r[n]==t)return a[e][r[n]];return null}function checkIfHeaderAlreadyExists(e,t){if(e&&e.length>0)for(var a=0;a<e.length;a++){var r=e[a],n=r.headerLabel;if(n===t)return!0}return!1}function getSplitRanges(e,t){for(var a={},r=0;r<splitRanges.length;r++)"COLS"==t?splitRanges[r].colIndex==e&&(a.headerValue=splitRanges[r].name,a.type="text"):splitRanges[r].rowIndex==e&&(a.headerValue=splitRanges[r].name,a.type="text");return a}var queueRequest=null,counter=0,headerLabel=!1,displayHeaders=null,isAggregatedRequest=!1,slant=null;ChartAggregation.prototype.init=function(){this.id="preview",this.queueRequest=[],this.isAggregatedRequest=!1},ChartAggregation.prototype.setId=function(e){this.id=e},ChartAggregation.prototype.setAggregatedRequest=function(e){this.isAggregatedRequest=e},ChartAggregation.prototype.getAggregatedRequest=function(){return this.isAggregatedRequest},ChartAggregation.prototype.clearCache=function(){this.id=this.queueRequest=null},ChartAggregation.prototype.getQueueRequest=function(){return this.queueRequest},ChartAggregation.prototype.incrQueueRequest=function(){null!=this.queueRequest&&this.queueRequest.push("P")},ChartAggregation.prototype.decrQueueRequest=function(){null!=this.queueRequest&&this.queueRequest.shift()},ChartAggregation.prototype.queueRequestFtn=function(e){0==counter&&($(".aggAdd").find("span:first").addClass("aggregationProgress"),counter++),this.preprocessRequest(e);this.postProcessRequest(e)},ChartAggregation.prototype.resetQueueRequest=function(){this.queueRequest=[]},ChartAggregation.prototype.preprocessRequest=function(e){e&&this.incrQueueRequest()},ChartAggregation.prototype.setSlantValue=function(e){this.slant=e},ChartAggregation.prototype.getSlantValue=function(){return this.slant},ChartAggregation.prototype.postProcessRequest=function(e,t){var a,r;EditChartType="";var n,s=chart.getPivotChart(),o=chart.getPreviousChartId(),i=WorkSheets.getAssociatedActiveSheetName();if(!chart.getPivotChart()){if(a=getObj("dataRange").value.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";"),!chart.isValidRange(a,"submit"))return!1;chart.showHideCombineRange(a)?$("#appedingWay").show():$("#appedingWay").hide()}if(-1!==getObj("preview").style.display.indexOf("none")&&!t)return $(".aggAdd").find("span:first").removeClass("aggregationProgress"),this.resetQueueRequest(),depthDragDrop.calculateHeaders(".destinationDepthHeader:last",!1),!1;"EDIT"===chartDialogState&&(r=chartOnLoad.getInstanceByChartId(o)),chart.setRecommedationSelection(previousChartType),$("#option").enable(),$("#axisOptions11").enable();var l=$("#rows").is(":checked")?"ROWS":"COLS",g=-1!==previousChartType.indexOf("1")?previousChartType.replace(/[0-1]/g,""):previousChartType,c=$("#frl").is(":checked")?!0:!1,h=$("#fcl").is(":checked")?!0:!1,d=parseInt("EDIT"!==chartDialogState?Math.round(sheet.offsetHeight/2-165+getSheetScrollTop()+20):r.top),p=parseInt("EDIT"!==chartDialogState?Math.round(sheet.offsetWidth/2-225+getNormalizedScrollLeft()):r[isRTL?"right":"left"]),u=330,v=550,y=$("#dataLabels").zcombo("getValue"),f=findColInXPos(p),C=findRowInYPos(d),b=p-getColLeft(f),R=d-getRowTop(C),O=chart.getLegendPosition(),A=$("#multiyaxisYes").is(":checked"),I=chartGlance.isRange(getObj("chartTitle").value)?getObj("chartTitle").value:escape(getObj("chartTitle").value),L=chartGlance.isRange(getObj("chartSubTitle").value)?getObj("chartSubTitle").value:escape(getObj("chartSubTitle").value),T=chartGlance.isRange(getObj("xAxisTitle").value)?getObj("xAxisTitle").value:escape(getObj("xAxisTitle").value),S=chart.getXAxisPlotLines(),m=$("#tooltipToggle").is(":checked"),w=$("#zoomToggle").is(":checked")?"xy":"",x=$("#animationToggle").is(":checked"),q=$("#trendlineTypes").zcombo("getValue"),H=ole.getCurrObj().id||"preview",j=chart.getAggregationInputObject(chartDialogState,l,H),D=chart.getFilterInputObject(),E=$("#autoExpandToggle").is(":checked"),P=-1===q.indexOf("Average")?parseInt($("#trendlineDegree").zcombo("getValue"))||2:parseInt($("#trendlinePeriod").val())||2,V=-1===q.indexOf("None")?!0:!1,N=getObj("threshold").value;N=N?parseFloat(N).toFixed(2):null;var k,B=!1,M=$("#glMajor").is(":checked")?1:0,G=$("#glMinor").is(":checked")?"auto":"",z=$("#xAxisLabelToggle").is(":checked"),W=$("#yAxisLabelToggle").is(":checked"),U=""===$("#slant").zcombo("getValue")?void 0:parseInt($("#slant").zcombo("getValue")),F=" "===$("#StaggerLines").zcombo("getValue")?void 0:parseInt($("#StaggerLines").zcombo("getValue")),Q=$("#hideCellsToggle").is(":checked"),J="",_=$("#combineRange").zcombo("getValue"),X=new Array,Y=new Array,K={},Y=null,H=null;if(chartPreview.frameAxisOptions(0,"preview"),"EDIT"==chartDialogState?(H=o||ole.getCurrObj().id,r.co.yAxis&&1==r.co.yAxis.length&&1==A&&(H="preview"),Y=chart.getAxisOptionsSaved(H,!0,!1)):(H="preview",Y=chart.getAxisOptionsSaved("preview",!0,!1)),null==Y&&(Y=new Array),null==Y[0]){if(Y[0]={},Y[0].yAxistitle=chartGlance.isRange(getObj("yAxisTitle").value)?getObj("yAxisTitle").value:escape(getObj("yAxisTitle").value),Y[0].yMin=""===getObj("ymin").value||isNaN(getObj("ymin").value)?null:getObj("ymin").value,Y[0].yMax=""===getObj("ymax").value||isNaN(getObj("ymax").value)?null:getObj("ymax").value,Y[0].yInterval=""===getObj("yinterval").value||isNaN(getObj("yinterval").value)?null:getObj("yinterval").value,null!==Y[0].yInterval&&isPreviewOn&&!isValidInterval("yinterval","0"))return;Y[0].yLabel=$("#yAxisLabelToggle").is(":checked")?!0:!1,Y[0].plotLineValue=getObj("plotLineValue").value&&""!=getObj("plotLineValue").value&&!isNaN(getObj("plotLineValue").value)?getObj("plotLineValue").value:void 0}"COMBOCHART"===previousChartType&&(k=$("#markerToggle").is(":checked")),-1===previousChartType.indexOf("LINE")&&-1===previousChartType.indexOf("STEP")&&-1===previousChartType.indexOf("AREA")||-1!==previousChartType.indexOf("SCATTER")||(k=$("#markerToggle").is(":checked"));var Z=ActionConstants.CHART_NEW;e||!t?(Z=ActionConstants.CHART_PREVIEW,"COMBOCHART"==g&&"EDIT"!=chartDialogState?(X.push("COL"),K={}):"COMBOCHART"==g&&"EDIT"==chartDialogState&&(chartOnLoad.getInstanceByChartId("preview")&&isUndefined(chartOnLoad.getInstanceByChartId("preview").co.options.comboChartTypes)?X.push("COL"):isUndefined(chartOnLoad.getInstanceByChartId(H).co.options.comboChartTypes)?X.push("COL"):X=Object.values(chartOnLoad.getInstanceByChartId(H).co.options.comboChartTypes)),!chartOnLoad.getInstanceByChartId("preview")||"COMBOCHART"!==chartOnLoad.getInstanceByChartId("preview").type&&"COMBOCHART"==g?K="EDIT"==chartDialogState?chartOnLoad.getInstanceByChartId(H).co.options.lineStyles:{}:!chartOnLoad.getInstanceByChartId("preview")||isUndefined(chartOnLoad.getInstanceByChartId("preview").co)||isUndefined(chartOnLoad.getInstanceByChartId("preview").co.options.lineStyles)||(K=chartOnLoad.getInstanceByChartId("preview").co.options.lineStyles)):"EDIT"===chartDialogState?(Z=ActionConstants.CHART_EDIT,"COMBOCHART"==g&&0==X.length&&(isUndefined(chartOnLoad.getInstanceByChartId("preview").co.options.comboChartTypes)||(X=Object.values(chartOnLoad.getInstanceByChartId("preview").co.options.comboChartTypes))),chartOnLoad.getInstanceByChartId("preview")&&"COMBOCHART"!==chartOnLoad.getInstanceByChartId("preview").type&&"COMBOCHART"==g?K={}:chartOnLoad.getInstanceByChartId("preview")&&!isUndefined(chartOnLoad.getInstanceByChartId("preview").co.options.lineStyles)&&(K=chartOnLoad.getInstanceByChartId("preview").co.options.lineStyles),J=r.id,u=r.ht,v=r.wd):"COMBOCHART"==g&&Z==ActionConstants.CHART_NEW&&X.push("COL");var et=this,tt=new RequestParameters(Z),at=new AjaxRequest;if(tt.setParameters(i,J,g,a,l,c,h,O,C,f,R,b,p,d,v,u,I,L,T,m,w,x,V,B,M,G,z,W,A,Q,U,y,F,_,k,q,N,P,E,JSON.stringify(StyleObject),s,n,!1,JSON.stringify(X),JSON.stringify(Y),JSON.stringify(K),JSON.stringify(S),JSON.stringify(j),JSON.stringify(D)),at.init("POST",tt.getURL(),!0,tt.getParametersAsString()),e)at.addEventListener("onComplete",function(t){et.getAggregatedRequest()&&null!=et.queueRequest&&et.queueRequest.length>0?et.preprocessResponse(e,t):$(".aggAdd").find("span:first").removeClass("aggregationProgress")}),at.addEventListener("onServerError",function(){et.decrQueueRequest(),et.postProcessResponse(e,et.lastResponse),$(".aggAdd").find("span:first").removeClass("aggregationProgress")}),at.sendRequest();else if(t){if((Z===ActionConstants.CHART_EDIT||Z===ActionConstants.CHART_NEW)&&i!==WorkSheets.getAssociatedActiveSheetName())return removeAllRecommendedInstance(WorkSheets.getAssociatedActiveSheetName(),"preview"),ajaxRequestLocal=at,appEvent.on("viewport.afterUpdate",_sendServerReq),void showsheet("sheetdiv-"+i,"open",!1,!1);actionManager.addRequest(at),StyleObject={},sheetdialog.close()}},ChartAggregation.prototype.preprocessResponse=function(e,t){if(e){this.decrQueueRequest();var a=this.getQueueRequest(),r=this;r.lastResponse=t,0==a.length&&r.postProcessResponse(e,t)}},ChartAggregation.prototype.postProcessResponse=function(e,t){var a=chart.getPivotChart();if(e){var r=parseJSON(t.responseText);if(r){var n=r.chartOptions.co,s=n&&n.co?n.co.cellRef.headerRange:null,o=n&&n.co?n.co.aggregation:null,i=o?o.dateOperations:null;if(decTable=n&&n.co?n.co.decTable:null,n.co){$("#createChart").enable(),a&&$("#dataRange").disable(),n.grouping&&(n.co=chartGlance.applyGrouping(n.co,n.grouping));var l=n.co.series.length,g=$("#yaxisMulti");$(g).find("option.RA").remove();for(var c=1;l>c;c++)$("<option/>",{id:"RA"+c,value:"RA"+c,text:jsMsg["Chart.SelectedAxis.RightAxis"]+""+c,class:"RA"}).appendTo(g);if($("#yaxisMulti").zcombo("refresh"),o.enabled&&s&&null!==s){var h=s.split(";");chartPreview.setDepthHeaders(h);var d=null!=i?i.split(","):null;chartPreview.setDepthOperations(d)}if(rangeSelectorChart.getDataRangeChanged()){chart.unloadDepthHeaders();var h;s&&null!==s&&(h=s.split(";")),$("#aggreoperation").zcombo("setValue",o.operation),$("#aggreoperation").zcombo("refresh"),chart.loadDepthHeaders(n.seriesIn,n.dataRange,h,i),rangeSelectorChart.setDataRangeChanged(!1)}n.co=chart.handleLineMarker(r.chartOptions.co,!0,!1),n.co=chartGlance.applyregressionColorIndex(n.co),n.co=chartGlance.applyDataLabels(n.co,getObj("dataLabels").value,n.currency,n.xAxisSymbol),n.co=chartGlance.advanceDataLabelSetting(n.co),n.co=chartGlance.applySharedLegendInPie(n.co),n.co=chartGlance.advanceChartSettingsInLegend(n.co),n.co=chartGlance.applyTooltip(n.co),n.co=chartGlance.handleChartStyle(n.co),n.co=chartGlance.applyGrouping(n.co,n.grouping),n.co=chartGlance.defaultGroupingSlat(n.co,n.grouping),n.co=n.currency&&"%"!==n.currency&&"TIMELINE"!==n.type?chartGlance.applyTooltip(n.co,n.frl,n.fcl,n.currency):n.co,chartOnLoad.createNew(WorkSheets.getAssociatedActiveSheetName(),"preview",n),chartOnLoad.getInstanceByChartId("preview").co&&(StyleObject=chart.constructChartStyleObject(chartOnLoad.getInstanceByChartId("preview").co.options))}else chart.alertForInvalidRange(n.reason)}$(".aggAdd").find("span:first").removeClass("aggregationProgress"),$(".aggAdd").attr("disabled",!1),counter=0}},ChartAggregation.prototype.setHeaderLabels=function(e){this.headerLabel=e},ChartAggregation.prototype.getHeaderLabels=function(){return this.headerLabel},ChartAggregation.prototype.setDisplayHeaders=function(e){this.displayHeaders=e},ChartAggregation.prototype.getDisplayHeaders=function(){return this.displayHeaders},ChartAggregation.prototype.resetHeaderLabels=function(){this.headerLabel=!1},ChartAggregation.prototype.processAggregation=function(e,t,a,r){return decTable=processDecTable(e,t),processSplitRanges(t),chartPreview.clearDepthIndices(),r=processDepthArray(a,r,e),chartPreview.setDepthIndices(r),chartPreview.setDepthIndices(decTable),this.displayHeaders=r,r},ChartAggregation.prototype.getNewComboList=function(e,t,a){var r=[];switch(e){case"ADD":for(var n=$(".aggHldr"),s=[],o=0;o<n.length;o++)if($(n[o]).find(".depthHeaders").find("select:first").length>0){var i=$(n[o]).find(".depthHeaders").find("select:first").zcombo("getValue");s.push(i)}r=this.comboList(s,a);break;case"REFRESH":for(var n=$(".aggHldr"),s=[],l=[],o=0;o<n.length;o++){s=[];for(var g=0;g<n.length;g++)o!=g&&s.push($(n[g]).find(".depthHeaders").find("select:first").zcombo("getValue"));l=this.comboList(s,a),r.push(l)}break;case"DELETE":for(var n=$(".aggHldr"),s=[],l=[],o=0;o<n.length;o++){s=[];for(var g=0;g<n.length;g++)o!=g&&s.push($(n[g]).find(".depthHeaders").find("select:first").zcombo("getValue"));l=this.comboList(s,a),r.push(l)}}return r},ChartAggregation.prototype.comboList=function(e,t){for(var a=this.displayHeaders,r=[],n=0;n<a.length;n++)for(var s=0;s<a[n].length;s++){var o=t?a[n][s].headerValue||a[n][s].headerLabel:a[n][s].headerLabel;if(-1==$.inArray(o,e)){var i={};i.rangeIdx=n,i.headerValue=o,i.type=a[n][s].type,i.label=a[n][s].headerLabel,r.push(i)}}return r};
var endCoordinates=[],mouseX,mouseY,comboValues=[],depthDragDrop=function(){var e=function(e){var r=n(e);p(r),t(),a()},t=function(){$("#aggregationTemplate").sortable({revert:!0,stop:function(){$(".aggHldr").length>1&&($("#aggregation").text(chart.getAggregationValue()),H(".aggHldr",!0))}})},a=function(){{var e=$(".aggHldr"),t=chart.getAggregationObject();t.getDisplayHeaders()}e.length+1>3?$(".aggAddMore").hide():$(".aggAddMore").show()},r=function(e){for(var t=$(".aggHldr"),a=0;a<e.length;a++)$(t[a]).find(".depthHeaders").find("select:first").zcombo("setValue",e[a]),m($(t[a]).find(".depthHeaders").find("select:first")),i(t[a],!1,void 0,!1);v()?O():z(),3==$(".aggHldr").length?$(".aggAddMore").hide():$(".aggAddMore").show()},n=function(e){var t="<div class='aggHldr'><div class='aggMove'></div><div class='depthHeaders'></div><span class='aggclose' onclick='chartPreview.deleteDepthHeader(event.target)'> &times;</span>";return $(t).appendTo("#aggregationTemplate"),l($("#aggregationTemplate .aggHldr:last"),e),$("#aggregationTemplate .aggHldr:last .depthHeaders select:first")},l=function(e,t){var a=chart.getAggregationObject(),r=getObj("columns").checked?"COLS":"ROWS",n="COLS"==r?$("#frl").is(":checked"):$("#fcl").is(":checked"),l=a.getNewComboList("ADD",null,n),i="<select style='width:94px;' id='combo"+t+"'></select>";$(i).appendTo($(e).find(".depthHeaders"));var o=$(e).find(".depthHeaders").find("select:first");h(o,l,t,!0,!0)},i=function(e,t,a,r,n){var l=chart.getAggregationObject(),i=$(".aggHldr"),d=[];a=isUndefined(a)?!0:a,d=t?l.getNewComboList("DELETE",e,a):l.getNewComboList("REFRESH",e,a),o(0,i,e,d,r,n)},o=function(e,t,a,r,n,l){e<t.length&&d(e,t,a,r[e],l).then(function(){e++,o(e,t,a,r,n,l)}).then(function(){n&&(m(a),H(".aggHldr",!0))})},d=function(e,t,a,r,n){return new Promise(function(l){var i=$(t[e]).find(".depthHeaders").find("select:first");if(!$(i).is(a)){var o=f(r,$(i).zcombo("getSelectedOption")),d=$(i).attr("id");if(e=d.substring(d.length-1,d.length),n)b(i),h(i,r,e,!1);else for(var u=$(i).find("option"),p=0;p<u.length;p++){var v=$(u[p]).attr("label"),m=s(r,v);m?c(i,v):g(i,v)}$(i).zcombo("setValue",o)}setTimeout(function(){l()},10)})},g=function(e,t){var a=$(e).find("option[label='"+t+"']"),r=$(a).attr("optionfor"),n=$(e).attr("id");$("ul#combo_"+n+"Menu li[index='"+r+"']").hide()},c=function(e,t){var a=$(e).find("option[label='"+t+"']"),r=$(a).attr("optionfor"),n=$(e).attr("id");$("ul#combo_"+n+"Menu li[index='"+r+"']").show()},s=function(e,t){for(var a=!1,r=0;r<e.length&&!(a=e[r].label===t);r++);return a},f=function(e,t){var a=$(t).attr("value"),r=$(t).attr("label");if(isUndefined(e))return a;for(var n=0;n<e.length;n++){var l=e[n];if(l.label==r)return l.headerValue}return a},h=function(e,t,a,r,n){r&&$(e).zcombo();var l="<option id='choose' value='choose'>"+jsMsg["Chart.Aggregation.Select"]+"</option>";if(t.length>0){n||(l="");for(var i=0;i<t.length;i++){var o=t[i].headerValue,d=t[i].type,g=t[i].label,c=t[i].rangeIdx;l+="<option label = '"+g+"' type='"+d+"' id='combo"+a+"_"+o+"' value = '"+o+"' range='"+c+"'>"+o+"</option>"}}$(l).appendTo($(e)),$(e).zcombo("refresh")},u=function(e){chart.getAggregationObject();$(e).remove(),i(null,!0,void 0,!0),v()?O():z(),a()},b=function(e){var t=$(e).attr("id");$("[id^='"+t+"_']").remove(),$(e).zcombo("refresh")},p=function(e){$(e).bind("combochange",function(e){if(v()){if("ADD"==chartDialogState){var t=$("#slant").zcombo("getValue"),a=chart.getAggregationObject();a.setSlantValue(t),$("#slant").zcombo("setValue","")}O()}else z();i(e.target,!1,void 0,!0)})},v=function(){var e=$(".aggHldr");if(null==e||0==e.length)return!1;for(var t=0;t<e.length;t++)if("choose"!==$(e[t]).find(".depthHeaders").find("select:first").zcombo("getValue"))return!0;return!1},m=function(e){var t=$(e).zcombo("getSelectedOption"),a=$(t).attr("type"),r=$(t).attr("value"),n=$(t).attr("label");if("DATE"==a){var l=$(e).parent();if(0==$(l).find(".dateFiltersSelect").length){var i=$("#dateFilters").html();$(i).appendTo(l),$(l).find(".dateFiltersSelect option:first").html(r),$(l).find(".dateFiltersSelect").attr("id",n.replace(/\s/g,"")+"_date"),$(l).find(".dateFiltersSelect option:first").attr("value",r),$(l).find(".dateFiltersSelect").zcombo(),$(l).find(".dateFiltersSelect").bind("combochange",function(){H(".aggHldr",!0)})}}else{var l=$(e).parent();$(l).find(".dateFiltersSelect").length>0&&$(l).find(".dateFiltersSelect").remove()}},H=function(e,t){var a=[],r=$(e);$("#aggregation").text(chart.getAggregationValue());for(var n=0;n<r.length;n++){var l=$(r[n]).find(".depthHeaders").find("select:first"),i=$(l).zcombo("getSelectedOption"),o=$(l).zcombo("getValue");"choose"!==o&&a.push($(i).attr("range")+";"+$(i).attr("label"))}chartPreview.calculateDepthHeaders(a,t)},S=function(){for(var e=[],t=$(".aggHldr"),a=0;a<t.length;a++){var r=$(t[a]).find(".depthHeaders").find("select:first"),n=$(r).zcombo("getSelectedOption"),l=$(r).zcombo("getValue");"Choose"!==l&&e.push($(n).attr("label"))}return e.length},A=function(){for(var e=$(".aggHldr"),t=0;t<e.length;t++)$(e[t]).find(".depthHeaders").find("select:first").zcombo("setValue","choose"),$(e[t]).find(".depthHeaders").find("select:eq(1)").length>0&&$(e[t]).find(".depthHeaders").find(".dateFiltersSelect").remove(),$(e[t]).find(".depthHeaders").find("select:first").zcombo("refresh");$("#aggregation").text(chart.getAggregationValue()),H(".aggHldr",!0)},O=function(){var e=chart.getAggregationObject(),t=$("#rows").is(":checked")?"ROWS":"COLS";null!=e&&("COLS"==t?(e.setHeaderLabels($("#fcl").is(":checked")),$("#fcl").attr("checked",!0),$("#fcl").attr("disabled",!0)):(e.setHeaderLabels($("#frl").is(":checked")),$("#frl").attr("checked",!0),$("#frl").attr("disabled",!0)))},z=function(){var e=$("#rows").is(":checked")?"ROWS":"COLS",t=chart.getAggregationObject();if(null!=t){var a=t.getHeaderLabels();"COLS"==e?($("#fcl").attr("disabled",!1),$("#frl").attr("disabled",!1),$("#fcl").attr("checked",a)):($("#frl").attr("disabled",!1),$("#fcl").attr("disabled",!1),$("#frl").attr("checked",a))}},D=function(){for(var e=$(".aggHldr"),t=0;t<e.length;t++)$(e[t]).find(".depthHeaders").find("select:first").length>0&&u($(e[t]))};return{addNewDepthHeader:e,bindEventsForDepthHeader:p,removeAllSelectComponents:A,calculateHeaders:H,enableLabelCheckBox:z,disableLabelCheckBox:O,deleteDepthHeader:u,getNumberOfHeaders:S,refreshAllCombos:i,addExistingDepthHeader:r,checkIfAggregationEnabled:v,resetAllDepthHeaders:D}}(jQuery);
var dataRangeCallback,dataRangeChanged=!1,rangeSelectorChart=function(){var e=new colorChoser(["5883DA","E5575B","A43FBC","5B9C27","11A9CC","F7900C","BD4F90","2B799C","AC3135","5F5F5F","0D6856","9B8C2B","3FD0B4","F2B405","4B10AC","65765A","9258F1","795011","584A71","EF3964"]),n=function(e){dataRangeChanged=e},a=function(){return dataRangeChanged},t=function(e,n){$(n).parent().remove(),e.stopPropagation()},l=function(e){sheetdialog.close(e),sheetdialog.recallDialog(),RangeHighlighter.clearAllColorSelection()},o=function(){i(""),h(),$(".chMlRange").find("li:last").find(".rangeSelector").focus()},i=function(e){var n=$(".chMlRange");$("<li/>",{class:"rangeLi"}).appendTo(n);var a=$(n).find("li:last");$("<span/>",{class:"chMlDrag"}).appendTo(a),$("<input/>",{class:"rangeSelector",type:"text"}).appendTo(a),$("<span/>",{class:"chMlClose"}).appendTo(a),$(a).find(".chMlClose").html("&times;"),$(a).find(".rangeSelector").val(e)},g=function(){for(var e=$(".chMlRange"),n=$(e).find("li"),a=0;a<n.length;a++)r(n[a])},r=function(n){$(n).find(".rangeSelector").blur(function(){appEvent.off("RangeSelector.onValueChange",c)}),$(n).find(".rangeSelector").focus(function(){var n=this;RangeSelector.on({el:n,directInput:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){var a=$(n).val();a.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(a,e.get(a))}}),appEvent.on("RangeSelector.onValueChange",function(e){c(e)});var a=$(n).val();a.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(a,e.get(a))}),$(n).find(".rangeSelector").change(function(){var n=$(this).val();n.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(n,e.get(n))}),$(n).find(".chMlClose").click(function(e){t(e,e.target)})},c=function(n){n.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(n,e.get(n))},h=function(){var n=$(".chMlRange").find("li:last");$(n).find(".rangeSelector").focus(function(){var n=this;RangeSelector.on({el:n,directInput:!0,disableArrowSupport:!0,appendSheetName:!0,callback:function(){var a=$(n).val();a.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(a,e.get(a))}});var a=$(n).val();a.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(a,e.get(a))}),$(n).find(".rangeSelector").change(function(){var n=$(this).val();n.length>0&&RangeHighlighter.drawColorSelectionWithRangeName(n,e.get(n))}),$(n).find(".chMlClose").click(function(e){t(e,e.target)})},d=function(e){var e=e?e:null;if(null!=e){for(var n=-1!==e.indexOf(",")?",":";",a=e.split(n),t=0;t<a.length;t++){var l=a[t];0==t?l&&null!=l&&""!=l&&$(".chMlRange").find("li:first").find(".rangeSelector").val(l):l&&null!=l&&""!=l&&i(l),g(),$(".chMlRange").find("li:last").find(".rangeSelector").focus()}o()}},f=function(){for(var e=$(".chMlRange"),n="",a=$(e).find("li"),t=0;t<a.length;t++){var l=$(a[t]).find(".rangeSelector").val();l.length>0&&(n+=l+",")}n&&(n=n.replace(/\,$/,""),$("#dataRange").val(n)),sheetdialog.close(),dataRangeChanged=!0,appEvent.trigger(dataRangeCallback,[]),RangeHighlighter.clearAllColorSelection()},s=function(){$(".chMlRange").sortable({revert:!0,stop:function(){}})},u=function(e){dataRangeCallback=e,sheetdialog.hideDialog();var n={width:365,title:jsMsg["Chart.Range.select"],close:function(){l(!0)}};sheetdialog.open("rangeselector",n,{init:function(){var e=$("#dataRange").val();d(e),s()},set:function(){},destroy:function(){}})};return{showRangeSelectorDialog:u,closeRangeDialog:l,addARangeSelector:o,deleteRangeSelector:t,updateDataRange:f,showRangeDetails:d,bindEventForRangeSelector:h,bindEventsForRangeSelectors:g,addNewRangeSelector:i,getDataRangeChanged:a,setDataRangeChanged:n}}(jQuery);
var chartOLEAction=function(){var e,t,o=function(o,a,r){e=250>r?r:void 0,t=250>a?a:void 0},a=function(e,t,o){var a=chartOnLoad.getInstance(e),n=a.co.options,i=a.legendPos,c=a.isPivotChart,s=chartGlance.removeUnwantedProperties(e,n,t,o,i);PivotChartUtility.findTotalNoOfFilterRequired(a.id,a.pivotId,!0,a.isPivotChart),s.chartOptions=PivotChartUtility.setLegendBoundary(s.chartOptions,c,i);var d=!1,h=s.doRefresh,n=s.chartOptions,l=chartPreview.getHCInstance(e);if(h&&!d){chartOnLoad.getInstance(e).co=n;var s=chartOnLoad.getInstance(e);chartPreview.getChartMode(s.co.chart.renderTo)&&(chartOnLoad.getInstance(e).co=chartGlance.applyPointerCursor(s.co),chartPreview.setRemovedTooltipValue(s.co.tooltip.enabled),chartOnLoad.getInstance(e).co.tooltip.enabled=!1,s.co.chart.zoomType&&(chartPreview.setRemovedZoomType(s.co.chart.zoomType),chartOnLoad.getInstance(e).co.chart.zoomType="none")),l.refreshChart(chartOnLoad.getInstance(e),!1,!0),chartPreview.getChartMode(e)&&chartOnLoad.overrideHighchartsEvent(e)}if(!d){var C=chartPreview.getHCInstance(e);chartOnLoad.getInstance(e).grouping&&(C.xAxis[0].setCategories(C.options.xAxis[0].categories),chartPreview.getChartMode(e)&&chartOnLoad.overrideHighchartsEvent(e)),C.setSize(t,o),chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).co&&chartOnLoad.getInstanceByChartId(ole.getCurrObj().id).co.options.legend.enabled&&C.legend.render()}var s=getObj(e),g=parseFloat(s.style.top),u=parseFloat(s.style[isRTL?"right":"left"]),v=findColInXPos(u),p=findRowInYPos(g),O=u-getColLeft(v),f=g-getRowTop(p);r(e,t,o,p,v,f,O,u,g,d)},r=function(e,t,o,a,r,n,i,c,s,d){var h=new AjaxRequest,l=new RequestParameters(ActionConstants.CHART_RESIZE);l.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,t,o,a,r,n,i,c,s,d),h.init("POST",l.getURL(),!0,l.getParametersAsString()),actionManager.addRequest(h)},n=function(){},i=function(e){e=void 0!=e?e:ole.getCurrObj().id;var t={};t.docId=$($("#DOCUMENT_ID")[0]).val(),t.asn=WorkSheets.getAssociatedActiveSheetName(),t.aOwner=zuid,t.chartId=e,t.isRelatedToDesign=!1,t.a=ActionConstants.CHART_COPY_CLIP,ChartClip.setObjectProperties(t),chartClipOperation.setCutStatus(!1),chartClipOperation.copyClip()},c=function(e){e=void 0!=e?e:ole.getCurrObj().id;var t={};t.docId=$($("#DOCUMENT_ID")[0]).val(),t.asn=WorkSheets.getAssociatedActiveSheetName(),t.aOwner=zuid,t.chartId=e,t.isRelatedToDesign=!1,t.a=ActionConstants.CHART_COPY_CLIP,ChartClip.setObjectProperties(t),chartClipOperation.setCutStatus(!0),chartClipOperation.copyClip()},s=function(e,t,o,a,a){ole(e).sCol=findColInXPos(t),ole(e).sRow=findRowInYPos(o),ole(e).sRowDiff="undefined"!=typeof a?a:o-getRowTop(ole(e).sRow),ole(e).sColDiff="undefined"!=typeof i?a:t-getColLeft(ole(e).sCol);var r=ole(e).sRow,n=ole(e).sCol,a=ole(e).sRowDiff,i=ole(e).sColDiff;d(e,r,n,a,i,t,o)},d=function(e,t,o,a,r,n,i){var c=new AjaxRequest,s=new RequestParameters(ActionConstants.CHART_MOVE);s.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,t,o,a,r,n,i),c.init("POST",s.getURL(),!0,s.getParametersAsString()),actionManager.addRequest(c)},h=function(e){l(e)},l=function(e){var t=new AjaxRequest,o=new RequestParameters(ActionConstants.CHART_DELETE);o.setParameters(WorkSheets.getAssociatedActiveSheetName(),e),t.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(t),chartOLEAction.backToPreviousToolbar(),chart.removeInstance(WorkSheets.getAssociatedActiveSheetName(),e)},C=function(e){ole(e).hideContextMenu(),chartOnLoad.getInstance(e)&&chartOnLoad.getInstance(e).co&&$("#"+e).css("border","1px solid "+chartGlance.getRGBA("rgb(222,222,222)",1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(chartOnLoad.getInstance(e).co.options.chart.backgroundColor))))},g=function(){$("#pivotChartMenu").is(":visible")?$("#pivotChartMenu").hide():$("#chartMenu").hide(),$(".cMenuPaletteHolder").hide(),$("#fCROD").css("display","none"),$("#fCROD").css("z-index",""),selectedmenutab&&$("#"+selectedmenutab).is(":visible")||(selectedmenutab="hometw"),$("#pivottw").is(":visible")||ZComponentTabs.setSelectedTab(selectedmenutab),chartPreview.hideContextualToolbar(),ole.getCurrObj()&&"chart"===ole.getCurrObj().type&&getObj(ole.getCurrObj().id)&&(getObj(ole.getCurrObj().id).style.border="1px solid "+chartGlance.getRGBA("rgb(222,222,222)",1-chartPreview.getOpacity(chartGlance.getColorCodeFromGradient(chartOnLoad.getInstance(ole.getCurrObj().id).co.options.chart.backgroundColor))))},u=function(e){var t=e?chartOnLoad.getInstance(e).pcn:chartOnLoad.getInstance(ole.getCurrObj().id).pcn;if(t){var o=showConfirmDialog(jsMsg["Chart.Delete.Confirm"]);if(!o)return!1}ole.remove(ole.getCurrObj().id,!0),ole.conf.onblur()};return ole.setObjectProperties("chart",{onResizeEnd:a,onDragEnd:s,onRemove:h,onObjectSwitch:C,onMove:C,onMoveEnd:s,onDocOpen:C,onResize:n,onCopy:i,onCut:c,onResizeStart:o,dependantsIdAry:["chartTab","pivotChartTab"],onDeselect:g}),{removeChart:u,backToPreviousToolbar:g,moveChart:s,copyChart:i,cutChart:c}}(jQuery);
!function(i){i.widget("ui.zslider",{widgetEventPrefix:"zslider",_EVENTS:{ONCHANGE:"change",ONSLIDE:"slide"},options:{labelDir:"left",orientation:"horizontal",unit:"%",displayText:"inline",widgetBox:!1},_slider:void 0,_create:function(){this.element.hide(),this._createSliderPanel()},_createSliderPanel:function(){this.options.labelDir="tooltip"===this.options.displayText?"":this.options.labelDir,"vertical"!==this.options.orientation||"left"!==this.options.labelDir&&"right"!==this.options.labelDir||(this.options.labelDir="left"===this.options.labelDir?"top":"bottom"),"horizontal"!==this.options.orientation||"top"!==this.options.labelDir&&"bottom"!==this.options.labelDir||(this.options.labelDir="top"===this.options.labelDir?"left":"right");var t=this.options.min=parseFloat(this.element.attr("min")),e=this.options.max=parseFloat(this.element.attr("max")),s=this.options.step=parseFloat(this.element.attr("step")),o=this.options.value?this.options.value:t,l="ui-zslider-panel ui-zslider-"+this.options.orientation+(this.options.widgetBox?" ui-state-default":"");this._sliderpanel=i("<div>").attr({id:this.element.attr("id")+"-zslider",class:l}).insertAfter(this.element),this._slider=i("<div>").appendTo(this._sliderpanel);var n=this,a=i("<span>").addClass("tooltip"===this.options.displayText?" ui-zslider-tooltip":"ui-slider-value ui-slider-value-"+this.options.labelDir).text(o+this.options.unit)["bottom"===this.options.labelDir||"right"===this.options.labelDir?"appendTo":"prependTo"](this._sliderpanel);if("tooltip"===this.options.displayText)if("vertical"===this.options.orientation){var r=this._sliderpanel.offset().left;a.css({left:r>=35?-41:15})}else this._sliderpanel.mouseenter(function(){var t=n._sliderpanel.offset().left,e=(i(window).width()-t,i(window).scrollTop(),Math.round(n._sliderpanel.offset().top)-i(window).scrollTop());e>=35?(a.css({top:-(a.outerHeight(!0)+3)}),a.css({left:-10})):(a.css({top:a.outerHeight(!0)-3}),t>=a.outerHeight(!0)&&a.css({left:-35}))});var h=0,d=0;"inline"===this.options.displayText&&(h="left"===this.options.labelDir||"right"===this.options.labelDir?40:0,d="top"===this.options.labelDir||"bottom"===this.options.labelDir?30:0);var p=this.element.width();if("horizontal"===this.options.orientation?(this._slider.width(p-h),this._sliderpanel.width(p)):(this._sliderpanel.height(this.element.height()),this._sliderpanel.width("inline"===this.options.displayText?30:11),("top"===this.options.labelDir||"bottom"===this.options.labelDir)&&this._slider.addClass("ui-slider-vertical-position"),this._slider.height(this.element.height()-d)),this._slider.slider({orientation:"vertical"===this.options.orientation?"vertical":"horizontal",change:function(i,t){var e=t.value+n.options.unit;a.text(e),n.element.val(t.value),i.originalEvent&&n._triggerEvent(n._EVENTS.ONCHANGE,{value:t.value})},slide:function(i,t){var e=t.value+n.options.unit;n.element.val(t.value),n._triggerEvent(n._EVENTS.ONSLIDE,{value:t.value}),n._showTip(a,u,e)},stop:function(){"tooltip"===n.options.displayText&&a.hide()},range:"min",min:t,max:e,step:s,value:o}),"tooltip"===this.options.displayText){var u=this._slider.find(".ui-slider-handle");u.append(a).hover(function(){a.show()},function(){a.hide()}),a.hide()}},_showTip:function(i,t,e){i.show().text(e)},_triggerEvent:function(i,t){return this._trigger(i,i,t)},setValue:function(i){i||(i=this.options.min),this._slider.slider("value",i)},getValue:function(){return this._slider.slider("value")},disable:function(){i(this.element).attr("disabled","true"),this._sliderpanel.addClass("ui-state-disabled"),this._slider.slider("disable"),this._sliderpanel.find(".ui-button").zbutton("disable")},enable:function(){i(this.element).removeAttr("disabled"),this._sliderpanel.removeClass("ui-state-disabled"),this._slider.slider("enable"),this._sliderpanel.find(".ui-button").zbutton("enable")},widget:function(){return this._sliderpanel},destroy:function(){this.element.show();var t=this._sliderpanel;t.remove(),this.element.off("."+this.widgetName),i.Widget.prototype.destroy.apply(this,arguments)}})}(jQuery);
!function(){var e,n,t,r=3e5,o=2e3,i={},a={},d=[];appEvent.on("request.addedInQue",function(e){u(e),d.push(Math.floor(performance.now()))});var u=function(e){var t=e.substr(e.indexOf("action="),e.length),r=t.substr(0,t.indexOf("&"));n=r.substr(r.indexOf("=")+1,r.length)};appEvent.on("request.dispatchedFromQue",function(){e=performance.now()}),appEvent.on("qaid.returned",function(e){s(e.qaid,e.timeStamp)}),appEvent.on("xaid.returned",function(e,n){c(e,"xaidReached",performance.now()),c(e,"sender",n)}),appEvent.on("response.updatedInClient",function(e,n,t){c(e,"serverActionExecutionTime",n),c(e,"responseGeneratedTime",t),c(e,"updatedInClient",performance.now())}),appEvent.on("refresh.tile",function(e){c(e,"refreshTile",!0);for(var n in i)e>=n&&(a[n]=i[n],a[n].refreshTile=!0,a[n].xaidReached=-1,a[n].updatedInClient=-1,delete i[n])});var p=function(){var e=new XMLHttpRequest;e.open("post",ctxpath+"reporter.do",!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var n="performanceMonitor="+JSON.stringify(a);e.send(n)},s=function(r,o){if("null"!=RESOURCE_ID&&d.length){requestInQue=d.splice(0,1)[0],e=Math.floor(e-requestInQue);var a=Math.floor(performance.now()-requestInQue);i[r]={rid:RESOURCE_ID,collabId:COLLAB_ID,sender:t,zuid:zuid,timeStamp:o,actionConstant:n,requestAddedInQue:requestInQue,requestDispatchedFromQue:e,qaidReached:a,xaidReached:void 0,serverActionExecutionTime:void 0,responseGeneratedTime:void 0,updatedInClient:void 0,refreshTile:void 0}}},c=function(e,n,t){var r=i[e];if(void 0!=r){if("number"==typeof t&&"serverActionExecutionTime"!=n&&"responseGeneratedTime"!=n){var d=r.requestAddedInQue,u=(r[n],Math.floor(t-d));t=u?u:void 0}r[n]=t,"updatedInClient"==n&&t>o?(a[e]=i[e],delete i[e]):"updatedInClient"==n&&o>t&&delete i[e]}};appEvent.on("window.onunload",function(){if(0!==Object.keys(a).length){var e=new FormData;e.append("performanceMonitor",JSON.stringify(a)),navigator.sendBeacon&&navigator.sendBeacon(ctxpath+"reporter.do",e)}}),setInterval(function(){0!==Object.keys(a).length&&(p(),a={})},r)}();
var Tour=function(t){function e(e){var o=e.target,n=t(o).attr("class");"tourCloseBtn"!==n&&"tRmL"!==n&&"clsBtn"!==n&&(e.stopPropagation(),e.preventDefault())}var o=0,n=0,i={highlight:"#fda029",endPointElHeight:38,arrowPointerMiddle:10,notifier:{icon:"cI",color:"#000",toolTip:jsMsg["Iconset.Tour.Tooltip"],endPoint:"#conditionalformat",endPointLevel1:"#databarsmul",startAnimationEffect:""},dialog:[{width:"480px",height:"310px",header:jsMsg["Iconset.Tour.Header"],moreOptionName:jsMsg["Tour.LearnMore"],moreOptionLink:"https://forums.zoho.com/topic/get-set-for-icon-sets",gotItBtnName:"GOT IT",content:jsMsg["Iconset.Tour.Content"],imagePath:"/sheet/styles/grey/images/",image:"tour_icons.png",headerImage:"announcement.png",videoDuration:30,targetMenu:"#formattw",endPoint:""}]},r=function(){a()},s=function(){c()},a=function(){{var e=t("<div>",{id:"tourContiner",class:"tContiner sE",style:"display:none"}),n=t("<div>",{class:"tourHeader"}).appendTo(e),r=t("<div>",{class:"tourBody"}).appendTo(e),s=(t("<div>",{class:"tHc"}).appendTo(n),t("<div>",{class:"tourCloseBtn"}).appendTo(n));t("<div>",{class:"clsBtn"}).appendTo(s)}if(""!=i.dialog[o].content){t("<div>",{class:"tBc"}).html(i.dialog[o].content).appendTo(r)}var a=""!=IMAGE_PATH?IMAGE_PATH:i.dialog[o].imagePath;if(i.dialog[o].image&&""!=i.dialog[o].image){t("<img>",{src:a+i.dialog[o].image}).appendTo(r)}var c=(t("<div>",{class:"tMc"}).appendTo("body"),t("<div>",{class:"tourfooter"}).appendTo(e)),d=t("<div>",{class:"tourBtn"}).appendTo(c),l=t("<button>",{class:"ui-tour-link-lhs",id:"tourPrevBtn"}).appendTo(d),u=t("<button>",{class:"ui-tour-link-rhs",id:"tourNextBtn"}).appendTo(d);t("body").append(e);var h=t("<div>",{id:"trHg",style:"display:none"});t(h).css({left:t(window).width()-60+"px",top:t(window).height()-105+"px"});t("<div>",{class:i.notifier.icon,title:i.notifier.toolTip}).appendTo(h),t("<div>",{class:"tW"}).appendTo(h),t("<div>",{class:"tW1"}).appendTo(h);t("body").append(h),l.on("click",function(){g()}),u.on("click",function(){f()}),s.on("click",function(){C(this)}),t("#trHg").on("click",function(){p()})},c=function(){var e=i.dialog.length,r=i.dialog[o];d(r),l(r),setTimeout(function(){u(r)},1400),setTimeout(function(){t("#tourContiner").css({transform:"scale(.1)",opacity:"1"}),t("#tourContiner").show(),t("#tourContiner").css({transform:"scale(1)",opacity:"1"}),t("#tourContiner").css({width:i.dialog[o].width,height:i.dialog[o].height}),n=new Date},2200),_checkBtnStatus(e)};_checkBtnStatus=function(e){1==e?w():0==o?(t("#tourPrevBtn").disable(),t("#tourNextBtn").enable()):o==e-1?(t("#tourNextBtn").disable(),t("#tourPrevBtn").enable()):(t("#tourNextBtn").enable(),t("#tourPrevBtn").enable())};var d=function(e){var o=e.targetMenu;t(o).trigger("mouseover"),setTimeout(function(){t(o).click()},500)},l=function(e){t(".tourHeader .tHc").text(e.header),t(".tourHeader .tHc").append(" - <span id='tRm' class='tRmL'>"+e.moreOptionName+"</span>"),t(".tourHeader .tHc #tRm").unbind("click").click(function(){T(3,v),window.open(e.moreOptionLink)})},u=function(o){window.addEventListener("click",e,!0),window.addEventListener("mousedown",e,!0),window.addEventListener("contextmenu",e,!0);o.targetMenu;t(i.notifier.endPoint).is(":visible")?(t(i.notifier.endPoint).trigger("click"),setTimeout(function(){t("#trHg").css("opacity","0");var e=t("#tourContiner").width(),o=parseInt(t("#tourContiner").css("left")),n=t(window).width(),r=t(i.notifier.endPointLevel1);t(r).trigger("mouseover");var s=t(r).offset().top,a=t(r).offset().left,c=t(r).width()/2;if(0>a-e/2)t("#tourContiner").css({top:s+i.endPointElHeight,left:8});else if(t("#tourContiner").css({top:s+i.endPointElHeight,left:a+c-e/2}),o=parseInt(t("#tourContiner").css("left")),o+e>n){var d=o+e-n;t("#tourContiner").css("left",o-(d+5))}},500)):(t("#tourContiner").removeClass("sE"),t("#tourContiner").addClass("rOm"),t("#tourContiner").addClass("noPtr"))},f=function(){o++,c()},g=function(){o--,c()},p=function(){T(2),setTimeout(function(){if(t("#trHg").removeClass("tourBounce"),t("#trHg .cI").removeClass("tourIconBounce"),t(i.notifier.endPoint).is(":visible")){var e=t(i.notifier.endPoint).offset().left,o=t(i.notifier.endPoint).offset().top;t("#trHg").css({left:e-9+"px",top:o-9+"px"})}else t("#trHg").hide();t("#trHg").removeClass("cE").addClass("cS")},502),s(),setTimeout(function(){t(".tMc").show()},1500)},h=t(window).width(),m=h-200,v=function(){window.removeEventListener("click",e,!0),window.removeEventListener("mousedown",e,!0),window.removeEventListener("contextmenu",e,!0),t("#tourContiner").css(t(i.dialog[o].endPoint).is(":visible")?{left:m,transform:"scale(.1)",opacity:"0",top:"-180px"}:{transform:"scale(.1)",opacity:"0"}),setTimeout(function(){t("#tourContiner").hide(),t(i.notifier.endPoint).is(":visible")||(t("#tourContiner").addClass("sE"),t("#tourContiner").removeClass("rOm"),t("#tourContiner").removeClass("noPtr")),t("#trHg").hide(),t(".tMc").hide(),t(i.dialog[o].endPoint).is(":visible")&&t(i.dialog[o].endPoint).effect("highlight",{color:i.highlight},200),t(i.notifier.endPoint).trigger("click")},500),setTimeout(function(){t(i.notifier.endPointLevel1).effect("highlight",{color:i.highlight},1e3)},530)},w=function(){t("#tourContiner .tourBtn").hide()},C=function(){T(4,v,H())},H=function(){var t=(new Date-n)/1e3;return t>i.dialog[o].videoDuration?!0:!1},T=function(t,e,o){var n=new getXmlhttp;n.onreadystatechange=function(){4==n.readyState&&e&&e()};var i="action="+t+"&"+csrfParamName+"="+readCookie(csrfCookieName);o&&(i+="&vl="+o),postAjax(n,ctxpath+"zstour.do",i)},P=function(){},E=function(){t("#trHg .tW").addClass("rE1"),t("#trHg .tW1").addClass("rE2")};return r(),UIComponents.executeOnDeferredInit(function(){if(SHOW_TOUR&&(jsSHARE_VIEW||jsOPEN_DOC_VIEW))switch(T(1),i.notifier.startAnimationEffect){case"downBounceRipple":if(t(i.notifier.startPoint).is(":visible"))var e=i.notifier.startPoint,o=t(e).offset().left,n=t(e).offset().top;else var o=t(window).width()-10,n=10;t("#trHg").css({left:o-9,top:n-10}),t("#trHg").addClass("cS"),t("#trHg").show(),setTimeout(function(){t("#trHg").removeClass("cS"),t(i.notifier.startPoint)&&t(i.notifier.startPoint).effect("highlight",{color:i.highlight},500),t("#trHg").css({left:t(window).width()-140+"px",top:t(window).height()-140+"px"}),t("#trHg").addClass("cE")},5e3),setTimeout(function(){t("#trHg").addClass("tourBounce"),t("#trHg .cI").addClass("tourIconBounce")},5900),setTimeout(function(){t("#trHg .tW").addClass("rE1"),t("#trHg .tW1").addClass("rE2")},6e3);break;default:t("#trHg").addClass("cS").show(),t("#trHg").css({}),t("#trHg").removeClass("cS").animate({transform:"scale(1)"},{duration:200,complete:E})}}),{rePlay:P}}(jQuery);
function changeOptionsState(e){var t=$("#importOptions").find("div"),o=$("#importOptions").find("input[type=radio]");return ALLOW_TO_WRITE?void("init"==e?(o.filter(":gt(3)").prop("disabled",!0),t.filter(":gt(3)").prop("disabled",!0)):"disable"==e?(o.prop("disabled",!0),t.prop("disabled",!0)):(o.prop("disabled",!1),t.prop("disabled",!1))):(o.filter(":gt(0)").prop("disabled",!0),void t.filter(":gt(0)").prop("disabled",!0))}function toggleURLInput(e){e?($("#xurl").val(""),$("#xurl").attr("disabled",!1)):$("#xurl").attr("disabled",!0)}function checkState(e){showErrorMsg(!1),toggleNoteMsg(!0),"urlimport"==e.id?(toggleURLInput(!0),Importer.resetAll(),$("p.browseFile").hide()):(toggleURLInput(!1),Importer.clearURLField(),$("p.browseFile").show());var t=document.getElementById("fileimport").checked,o=document.getElementById("importview_holder").style,s=$("div.importView_browse").hasClass("importCancel");t?(o.top="0px",s||$("p.browseFile").show()):s||(o.top="-140px")}function checkFileNameLength(e,t){var o;return t=t.split("\\").pop(),t.length>30?(format=t.split("."),o=t.substr(0,25)+"..."+t.substr(format[0].length-2,format[0].length)):o=t,o}function hasRangeLocks(){return checkLock(0,0,getRowMax()-1,getColMax()-1,ActionConstants.IMPORT_REPLACE_CURRENTSHEET)}function sheetHasLocks(){return ProtectedRanges.isSheetLocked(CURRSHEETNAME)}function documentHasRangeLockOrSheetLock(){return documentHasRangeProtection}function checkForLockRangesInDocument(){var e=new RequestParameters(ActionConstants.IS_LOCK_EXISTS);e.setParameters(WorkSheets.getSheetCodeFromName(clipSheetObject.sheetName));var t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),t.addEventListener("onComplete",function(e){if(""!==e.responseText){var t=parseJSON(e.responseText);documentHasRangeProtection=t.dhpr}}),t.sendRequest()}function checkLock(e,t,o){return ProtectedRanges.isRangeLocked(e,t,getRowMax()-1,getColMax()-1,o,!0)}function showWarningMsg(e,t){e?($("#warningMsg").show(),$("#warningMsg").text(t)):$("#warningMsg").hide()}function showErrorMsg(e,t){e?($("div#eMsg").html(t),$("div#eMsg").show(),$("div.filewrapper").css({border:"1px dashed #f8828d"})):($("div#eMsg").hide(),$("div.filewrapper").css({border:"1px dashed #ccc"}))}function toggleNoteMsg(e){e?$("span#csvNote").css("opacity",1):$("span#csvNote").css("opacity",0)}var Importer=function(){function e(e){Importer.action=e,e==ActionConstants.IMPORT_CREATE_NEW?(S=jsMsg["Import.ProgressMsg.CreateNewSpreadsheet"],r("Import.NewSpreadsheet.InfoBanner")):e==ActionConstants.IMPORT_AS_TEMPLATE?(Importer.isFileImported=!0,S=jsMsg["Import.ProgressMsg.CreateNewTemplate"],r("Import.NewTemplate.InfoBanner")):e==ActionConstants.IMPORT_INSERT_AS_NEW_SHEETS?(S=jsMsg["Import.ProgressMsg.InsertNewSheets"],s()):e==ActionConstants.IMPORT_REPLACE_SPREADSHEET?(S=jsMsg["Import.ProgressMsg.ReplaceSpreadsheet"],s()):e==ActionConstants.IMPORT_REPLACE_CURRENTSHEET?(S=jsMsg["Import.ProgressMsg.ReplaceCurrentSheet"],s()):e==ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET?(S=jsMsg["Import.ProgressMsg.AppendRowsToCurrentSheet"],s()):e==ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL&&(S=jsMsg["Import.ProgressMsg.ReplaceDataStartingAtCell"],o())}function t(){if(!ALLOW_TO_WRITE)return void $("#importOptions").find("div:gt(0)").children().prop("disabled",!0);switch(T.toLowerCase()){case".xls":case".xlsx":case".ods":case".xlsm":case".sxc":$("#importOptions").find("div:lt(3)").children().prop("disabled",!1),$("#importOptions").find("div:gt(3)").children().prop("disabled",!0);break;case".csv":case".tsv":$("#importOptions").find("div").children().prop("disabled",!1),toggleNoteMsg(!1)}$("#importOptions").find("input#replaceData").trigger("ischecked")}function o(){showProgressMessage(S);var e=$("#startCell").val(),t=CellUtils.getCellRef(e),o=CellUtils.getCellPosByLabel(t),s=new RequestParameters(Importer.action);s.setParameters(WorkSheets.getAssociatedActiveSheetName(),M,o.row,o.col,A);var r=new AjaxRequest;r.init("POST",s.getURL(),!0,s.getParametersAsString()),r.addEventListener("onError",function(){showAlertDialog(jsMsg["Error.Internal.Server"])}),actionManager.addRequest(r),setTimeout(hideProgressMessage,2e3)}function s(){showProgressMessage(S);var e=new RequestParameters(Importer.action);e.setParameters(WorkSheets.getAssociatedActiveSheetName(),M,A);var t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),t.addEventListener("onError",function(){showAlertDialog(jsMsg["Error.Internal.Server"])}),actionManager.addRequest(t)}function r(e){var t=window.location,o=t.protocol+"//"+t.host+ctxpath+"open/"+M,s=jsMsg[e]+" <a class='link' target='_blank' href='"+o+"'>"+jsMsg["InfoBanner.ClickHere"]+"</a>";InfoBanner.showBanner(s,!1,"success"),setTimeout(function(){window.open(o,"_blank"),hideProgressMessage()},500)}function i(t,o){$("div.importloader").hide();var s=!1,r=jsMsg["Error.Import"];if(400===t.status||500==t.status)s=!0,"Error.Import.FileSizeExceed"==t.responseText&&(r=jsMsg[t.responseText]);else if(200===t.status){var i=parseJSON(t.responseText);if(null!=i.em){var n=i.em;if(-2==n)s=!0,r=jsMsg["Error.Import.PasswordProtected"];else{s=!0;var a=n.split("#");r=replaceParams(jsMsg[a[0]],new Array(a[1]))}}}s?(f(!1),x?h("error"):g(),showErrorMsg(s,r),$("div.import-close").bind("click",function(){Importer.resetAll()})):(c(i),e(o),sheetdialog.close(),showErrorMsg(s))}function n(e){var t=e.split(".").pop();return t=t.toLowerCase(),-1!==["xlsx","xls","xlsm","ods","sxc","csv","tsv","json"].indexOf(t)}function a(e,t,o,s){var r=new XMLHttpRequest;r.open("POST",ctxpath+L,!0),r.upload.onprogress=function(e){if(e.lengthComputable){var o=e.loaded/e.total;t&&t(100*o-10)}},r.send(e),r.onload=function(){t&&t(500===this.status?0:100);var e=JSON.parse(r.responseText),i=e.em;null!=i&&i?"-2"==i?l():"103"==i&&d():o(this,s)}}function l(){sheetdialog.close();var e={width:358,title:"Password Protected",resizable:!1,autoOpen:!1};sheetdialog.open("encryptedImportDialog",e)}function d(){var e=sheetdialog.getDialogName();if("encryptedImportDialog"===e){{sheetdialog.getOpenedDialog()}$("#wrongPasswordMessage").css("visibility","visible"),document.getElementById("setPassword").select(),document.getElementById("setPassword").focus(),document.getElementById("passwordProtectedImport").disabled=!1}}function c(e){T=e.format,M=e.rid,A=e.fname,P=e.docId}function p(e){$("div.filewrapper").css(e?{border:"1px dashed #3170BE"}:{border:"1px dashed #ccc"})}function g(e){e?($("div.importView_browse").addClass("importCancel"),$("div.filewrapper").css({border:"none"}),$("p.browseFile").hide(),$("div#importLabel").show(),$("div#importLabel").text(A),O||R("enable"),changeOptionsState("enable"),t()):($("div.importView_browse").removeClass("importCancel"),$("div#browseDetails").show(),$("#urlimport").is(":checked")||$("p.browseFile").show(),$("input#content").show(),$("input#content").val(""),$("div#importLabel").hide(),$("div#importLabel").html(""),R("disable"),changeOptionsState("init"),$("div.import_view").removeClass("error"),$("div.filewrapper").css({border:"1px dashed #ccc"}),O=!1,$("#warningMsg").hide(),k=!1)}function u(e){e?($("div#browseDetails").hide(),$("p.browseFile").hide(),$("input#content").hide()):($("div#browseDetails").show(),$("p.browseFile").show(),$("input#content").show())}function m(e){"error"==e?($("div.import_view").addClass("error"),$("div.filewrapper").css({border:"1px dashed #f8828d"})):$("div.import_view").removeClass("error")}function h(e){"success"==e?($("#xurl").css("border-color",""),$("div.importloadercnt").show(),$("div.importloadersuccess").show(),R()):"enable"==e?($("#xurl").css("border-color",""),$("div.importloadersuccess").hide(),$("div.importloadercnt").show(),$("div.importloader").show(),toggleNoteMsg(!0)):"error"==e?($("div.importloadersuccess").hide(),$("#xurl").css("border-color","#f26f7b"),R("disable")):($("div.importloadercnt").hide(),$("div.importloadersuccess").hide(),$("#xurl").css("border-color",""),$("button.ui-zbutton-primary").prop("disabled",!0),R("disable"),changeOptionsState("init"),O=!1,$("#warningMsg").hide(),x=!1)}function v(e){var t=/[^ "]+$/;return t.test(e)?!0:!1}function f(e){var t=$("#importerdialogzdialog").parent().find("button");if(e){var o=$(t[0]);$(o.children()[0]).text(jsMsg["Indication.Importing"]),$(o.children()[1]).addClass("generate"),o.css("padding-left","25px"),$(t[1]).prop("disabled",!0),$(t[1]).addClass("ui-state-disabled")}else{var o=$(t[0]);$(o.children()[0]).text(jsMsg["Import.Button.Label"]),$(o.children()[1]).removeClass("generate"),o.css("padding-left","14px"),$(t[1]).prop("disabled",!1),$(t[1]).removeClass("ui-state-disabled")}}function w(){var e;if(e=1==Importer.isFromTemplateDialog?ActionConstants.IMPORT_AS_TEMPLATE:parseInt($("#importOptions").find("input[type=radio]:checked").attr("value")),ALLOW_TO_WRITE||e==ActionConstants.IMPORT_CREATE_NEW){if(IS_TEAM_RESOURCE&&_.append("srid",RESOURCE_ID),e==ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL){var t=$("#startCell").val();if(!CellUtils.checkCellLbl(t))return showAlertDialog(jsMsg["CellReference.Msg.Invalid"]),void $("#startCell").val("")}if($("#warningMsg").hide(),$("div.import-close").unbind("click"),x){var o=decodeURI($("#xurl").val());$("#xurl").val(encodeURI(o));var s=document.getElementById("importForm1");_=new FormData(s)}_.append("a",e),(".csv"==T.toLowerCase()||".tsv"==T.toLowerCase()&&(e==ActionConstants.IMPORT_INSERT_AS_NEW_SHEETS||e==ActionConstants.IMPORT_REPLACE_CURRENTSHEET||e==ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET||e==ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL))&&_.append("locale",docLocale),_.append(csrfParamName,readCookie(csrfCookieName)),C=e,f(!0),a(_,null,i,e)}}function R(e){var t=$("button.ui-zbutton-primary");"disable"==e?($(t).prop("disabled",!0),$(t).addClass("ui-state-disabled")):($(t).prop("disabled",!1),$(t).removeClass("ui-state-disabled"))}function E(){O?(k||x)&&R("disable"):(k||x)&&R("enable")}function I(){document.getElementById("passwordProtectedImport").disabled=!0;var e=document.getElementById("setPassword").value;_.has("password")?_.set("password",e):_.append("password",e),a(_,null,i,C)}function b(){$("#wrongPasswordMessage").css("visibility","hidden")}var C=ActionConstants.IMPORT_CREATE_NEW,T="none",M=null,A="",L="import.do?proxyURL=newimport",P=null,_=null,S=null,O=!1,x=!1,k=!1;return{hideWrongPasswordMessage:b,passwordImporter:I,showImporter:function(e){Importer.isFromTemplateDialog="true"==e;var t={autoOpen:!1,width:680,modal:!0,resizable:!1,title:jsMsg["Import.Button.Label"],close:function(){Importer.isFromTemplateDialog&&(Importer.isFileImported?($.dialogutil.close("templatedialog"),Importer.isFileImported=!1):setTimeout(function(){sheetdialog.recallDialog()},300),Importer.isFromTemplateDialog=!1)},buttons:[{text:jsMsg["Import.Button.Label"],class:"ui-zbutton-primary",id:"templateCreateButton",click:function(){w()}},{text:jsMsg.Close,click:function(){$(this).zdialog("close")}}]};sheetdialog.open("importerdialog",t,{init:function(){Importer.isFromTemplateDialog&&$("#importOptions").hide(),toggleNoteMsg(!0),O=!1,k=!1,x=!1,changeOptionsState("init"),$("input#replaceData").bind("ischecked",function(){$(this).prop("checked")?($("#scell").css("opacity",1),$("div.ui-widget-overlay").hide(),$("#startCell").val(CellUtils.constructCellName(currRow,currCol,currRow,currCol,!1,CURRSHEETNAME)),$("#startCell").focus()):($("#scell").css("opacity",0),$("#startCell").blur(),$("div.ui-widget-overlay").show(),RangeSelector.off())}),$("#startCell").focus(function(){var e=this;RangeSelector.on({el:e,single:!0,appendSheetName:!0,onupdate:function(e){var t=CellUtils.getCellRef(e),o=CellUtils.getCellPosByLabel(t);sheetHasLocks()||(showWarning=O=checkLock(o.row,o.col,ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL),showWarningMsg(showWarning,jsMsg["Import.WarningLabel.LockMsg1"]),E())}})}),$("div.import-close").bind("click",function(){Importer.resetAll()});var e=$("button.ui-zbutton-primary"),t=$("<span/>");t.appendTo(e),R("disable"),$("#xurl").on("input",function(){0==this.value.length&&(x=!1,$("#xurl").css("border-color","")),Importer.clearURLField(),changeOptionsState("init"),R("disable"),toggleNoteMsg(!0),$("div#eMsg").hide()}),checkForLockRangesInDocument();var o=$('<div id="warningMsg" class="imdM" style="display:none"></div>');o.appendTo($("#importerdialogzdialog").parent())}})},showSelector:function(e){var t=!1,o=jsMsg["Import.WarningLabel.LockMsg1"],s=sheetHasLocks();"replaceSpreadsheet"==e&&documentHasRangeLockOrSheetLock()?(O=t=!0,o=jsMsg["Import.WarningLabel.LockMsg2"]):"replaceCurrSheet"==e&&(s||hasRangeLocks())?O=t=!0:"appendRows"==e?s?O=t=!0:t=O=checkLock(usedCursRow+1,0,ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET):"replaceData"==e?s?O=t=!0:t=O=checkLock(currRow,currCol,ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL):O=t=!1,$("#importOptions").find("input#replaceData").trigger("ischecked"),showWarningMsg(t,o),E()},onenter:function(e){p(!0),e.preventDefault(),e.stopPropagation()},resetAll:function(){g(),$("#urlimport").prop("disabled")&&$("#urlimport").prop("disabled",!1),showErrorMsg(!1),toggleNoteMsg(!0),$("#scell").css("opacity",0)},clearURLField:function(){$("div.import_view").removeClass("error"),$("div.filewrapper").css({border:"1px dashed #ccc"}),h("disable"),$("#scell").css("opacity",0)},attachFile:function(e,t,o){var s,r,i;"local"==t?(s=o,r=o,i=document.getElementById("importForm"),_=new FormData(i)):"drop"==t&&(r=e.dataTransfer.files[0].name,s=e.dataTransfer.files[0],i=document.getElementById("importForm"),_=new FormData(i),_.append("xfile",s)),n(r)?(r=checkFileNameLength("drop",r),A=r,T=r.substring(r.lastIndexOf(".")),m(),u(!0),g(!0),k=!0):m("error")},validateURL:function(e){if("blur"==e.type||"submit"==e.type){e.preventDefault(),e.stopPropagation();var o=$("#xurl").val();if(v(o)){var s=window.location.protocol.replace(/[s:]/g,"");-1==o.indexOf(s)&&(o=s+"://"+o,$("#xurl").val(o));var r=o.substring(o.lastIndexOf("/")+1);if(n(r)){h("success"),m();var i=checkFileNameLength("drop",r);A=i,T=i.substring(i.lastIndexOf(".")),t(),x=!0}else h("error"),m("error")}else h("error")}}}}(),documentHasRangeProtection=!1;appEvent.on("import.response",function(){hideProgressMessage()}),appEvent.on("collab.crossproductmsg",function(e,t){var o=t.ACTION?t.ACTION:t.action;"EX"==e&&"UDSERVER_UPLOAD"==o&&FCImport.updateImportStatus(t)});
var defaulttheme={},manageEditedRules={},manageEditId,loadRuleObj,colorScalesDialogState="ADD",classicDialodState="ADD",colorScalesBag=function(){var e,t,a,l=!1,o={},c=!1,n=function(){U(selectedRangeForDialog())&&i()},i=function(){var e={width:555,allowSheetSwitch:!0,close:function(){"ADD"!==colorScalesDialogState&&(colorScalesDialogState="ADD",manageEditId="",colorScalesBag.isDialogEdited?($.dialogutil.close("cformatmanagedialog"),setTimeout(function(){formatWithConditions.showManageRulesAfterEdit("manageLIElement")},400)):(setTimeout(function(){sheetdialog.recallDialog()},300),colorScalesBag.viewRules=null,colorScalesBag.filterRule=null)),l=!1,sheetdialog.close(),this.isColorEdited=!1,o={},colorScalesBag.rulesRange=null,$("#classicPreview").css("background-image","")}},t="EDIT"===colorScalesDialogState?jsMsg["CFormat.EditRule"]:"COPY"===colorScalesDialogState?jsMsg["CFormat.CopyRule"]:jsMsg["CFormat.NewRule"];e.title=jsMsg["CFormat.ColorScale"]+" - "+t,sheetdialog.open("colorscalesdialog",e,E)},s=function(e){return document.querySelector("#"+e).querySelector(".fCb").style.backgroundColor},r=function(e,t){document.querySelector("#"+e).querySelector(".fCb").style.backgroundColor=t},u=function(e){var t=getObj(e);t.disabled=!0,t.style.opacity=.2,"value2"==e&&($("#input2").disable(),r("input2","transparent"))},d=function(e){var t=getObj(e);t.disabled=!1,t.style.opacity=1},g=function(e){var t=$("#"+e).find("span");t.prop("onclick",null).off("click"),t.css("display","none"),$("#"+e).find("input")[0]&&M($("#"+e).find("input")[0].getAttribute("id"))},v=function(e){var t=$("#"+e).find("span"),a=$("#"+e).find("input")[0].getAttribute("id");t.bind("click",function(){RangeSelector.showRangeSelection(a)}),_(a),t.css("opacity",1),t.css("display","block")},p=function(){if("ADD"===colorScalesDialogState||"MANAGE_ADD"===colorScalesDialogState)r("input1","#5AB187"),r("input3","#FFFFFF"),u("value1"),u("value2"),u("value3"),g("inValue1"),g("inValue2"),g("inValue3"),$("#type2").zcombo("setValue","NONE"),$("#value1").val("(Lowest value)"),$("#value3").val("(Highest value)"),$("#cTxtClr").prop("checked",!1),$("#hdTxt").prop("checked",!1),$("#appliestofieldcs").val(selectedRangeForDialog()),N();else if("EDIT"===colorScalesDialogState||"COPY"===colorScalesDialogState){var e=manageEditedRules[manageEditId.split("_")[1]+"_"+manageEditId.split("_")[2]],t=e.cstyle1;$("#appliestofieldcs").val("EDIT"===colorScalesDialogState?e.datarange:selectedRangeForDialog()),$("#type1").zcombo("setValue",t.cr_ty1),"MINIMUM"===t.cr_ty1&&u("value1"),"MINIMUM"===t.cr_ty1?g("inValue1"):v("inValue1"),$("#value1").val(""===t.cval1?"(Lowest value)":t.cval1),r("input1",t.cs_c1),9===Object.keys(t).length&&($("#type3").zcombo("setValue",t.cr_ty3),"MAXIMUM"===t.cr_ty3&&(u("value3"),g("inValue3")),$("#value3").val(""===t.cval3?"(Highest value)":t.cval3),r("input3",t.cs_c3)),6===Object.keys(t).length?(u("value2"),g("inValue2"),$("#type2").zcombo("setValue","NONE"),$("#type3").zcombo("setValue",t.cr_ty2),"MAXIMUM"===t.cr_ty2&&(g("inValue3"),u("value3")),$("#value3").val(""===t.cval2?"(Highest value)":t.cval2),r("input3",t.cs_c2)):(r("input2",t.cs_c2),$("#type2").zcombo("setValue",t.cr_ty2),$("#value2").val(t.cval2)),N(),e.hcc?($("#cTxtClr").parent().parent().disable(),$("#cTxtClr").disable(),$("#hdTxt").prop("checked",!0)):e.atc&&$("#cTxtClr").prop("checked",!0)}setTimeout(function(){$("#appliestofieldcs").focus()},100)},f=function(){var e=this;RangeSelector.on({el:e,appendSheetName:!0,isAbsoluteRef:!0,callback:function(){colorScalesBag.isDialogEdited=!0},multiRangeSelection:!0})},m=function(){RangeSelector.off()},h=function(){var e=this;RangeSelector.on({el:e,appendSheetName:!0,callback:function(){l=!0},multiRangeSelection:!0})},M=function(e){$("#"+e).unbind("focus"),$("#"+e).bind("focus",m),RangeSelector.off()},_=function(e){$("#"+e).unbind("focus"),$("#"+e).bind("focus",f)},I=function(){$("#appliestofieldcs").bind("focus",h)},E={set:function(e,t){var a=e.action;appEvent.trigger("colorscales.zcombo",[a,t])},init:function(){$("#value1").focus(f),$("#value2").focus(f),$("#value3").focus(f),p(),$("#appliestofieldcs").focus(function(){var e=this;RangeSelector.on({el:e,appendSheetName:!0,callback:function(){l=!0},multiRangeSelection:!0})})},destroy:function(){RangeSelector.off()}},S=function(e){var t=e.split("(")[1].split(")")[0];t=t.split(",");var a=t.map(function(e){return e=parseInt(e).toString(16),1==e.length?"0"+e:e});return"#"+a.join("").toUpperCase()},R=function(e,t){if("midOptions"===e){var a="NONE"===t?"":"PERCENTILE"===t||"PERCENT"===t?"50":"FORMULA"===t?"=":"0";$("#value2").val(a),"NONE"===t?(u("value2"),N(),g("inValue2")):(d("value2"),$("#input2").enable(),("rgba(0, 0, 0, 0)"===s("input2")||"transparent"===s("input2"))&&r("input2",z(s("input1"),s("input3"),3)[1]),v("inValue2"),N()),setTimeout(function(){$("#value2").focus()},210),"Formula"!==t&&$("#value2").select()}else if("minOptions"===e){var a="NUMBER"===t||"PERCENT"===t?"0":"FORMULA"===t?"=":"PERCENTILE"===t?"10":"(Lowest value)";$("#value1").val(a),setTimeout(function(){"FORMULA"===t?$("#value1").focus():$("#value1").focus().select()},210),"MINIMUM"!==t?v("inValue1"):g("inValue1");{"MINIMUM"===t?u("value1"):d("value1")}}else{var a="NUMBER"===t?"0":"FORMULA"===t?"=":"PERCENTILE"===t?"90":"PERCENT"===t?"100":"(Highest value)";$("#value3").val(a),setTimeout(function(){"FORMULA"===t?$("#value3").focus():$("#value3").focus().select()},210);{"MAXIMUM"===t?u("value3"):d("value3")}"MAXIMUM"!==t?v("inValue3"):g("inValue3")}},y=function(e){return defaulttheme[e]},C=function(e){if(sheetdialog.isDialogOpen()&&"apply"!==e){if(this.isColorEdited&&(x(),this.isColorEdited=!1,$("#colorscaledialogtheme").find(".cue").css("display","block")),"custom"===e&&0===Object.keys(o).length)return;var t="custom"===e?o:y("theme"+e);return r("input1",t.cs_c1),2===t.noofcond?("NONE"===$("#type2").zcombo("getValue")||"PERCENTILE"===$("#type2").zcombo("getValue")&&"50"===$("#value2").val()?($("#value2").val(""),$("#type2").zcombo("setValue","NONE"),u("value2")):r("input2",z(convertHex(t.cs_c1),convertHex(t.cs_c2),3)[1]),r("input3",t.cs_c2),$($("#value2").parent().find("span")[0]).css("display","none")):(d("value2"),$("#input2").enable(),"NONE"===$("#type2").zcombo("getValue")&&($("#type2").zcombo("setValue","PERCENTILE"),$("#value2").val("50")),r("input2",t.cs_c2),r("input3",t.cs_c3)),void N()}},F=function(e){var t={};if(e&&"apply"!==e){var a=selectedRangeForDialog();if(!U(a))return;t=y("theme"+e),t.istheme=!0,t.datarange=a}else{var l=$("#appliestofieldcs").val();if(!U(l))return void $("#appliestofieldcs").focus();for(var o=0,c=1;3>=c;c++){o++,2==c&&"NONE"===$("#type2").val()&&c++;var n=$("#type"+c).val();t["cr_ty"+o]=n,t["cval"+o]=encodeURIComponent("MAXIMUM"===n||"MINIMUM"===n?"":convertFormulaReferencing($("#value"+c).val(),1)),t["cs_c"+o]=S(s("input"+c))}t.istheme=!1,t.hcc=$("#hdTxt").is(":checked"),t.atc=$("#cTxtClr").is(":checked"),t.noofrules=1,t.noofcond=o,t.datarange=$("#appliestofieldcs").val().replace(/,/g,";");var l=t.datarange.split(";");t.asn=WorkSheets.getSheetCodeFromName(CellUtils.getSheetNameFromCelLbl(l[0])),"EDIT"===colorScalesDialogState&&(t.csuid=manageEditId.split("_")[1],t.asn=manageEditId.split("_")[2],t.cs_type=manageEditedRules[manageEditId.split("_")[1]+"_"+manageEditId.split("_")[2]].cs_type)}t=JSON.stringify(t),$("#CreateButton").disable();var i=new RequestParameters(ActionConstants.VALIDATE_INPUT_CF);i.setParameters(WorkSheets.getAssociatedActiveSheetName(),"colorscales",t);var r=new AjaxRequest;r.init("POST",i.getURL(),!0,i.getParametersAsString()),r.addEventListener("onComplete",function(e){var a=parseJSON(e.responseText);return $("#CreateButton").enable(),0!=Boolean(a.valinp.isError)?void iconsets.showErrorInClient(a.valinp.errorMsg,a.valinp.type):void D(t)}),r.sendRequest()},b=function(e){var t=defaulttheme[e],a=selectedRangeForDialog();U(a)&&(t.istheme=!0,t.datarange=a,t.asn=WorkSheets.getSheetCodeFromName(CellUtils.getSheetNameFromCelLbl(a)),D(JSON.stringify(t)))},D=function(e){var t="EDIT"===colorScalesDialogState?ActionConstants.CONDITIONAL_FORMAT_EDIT:ActionConstants.COLOR_SCALES_APPLY,a=new RequestParameters(t);a.setParameters(WorkSheets.getAssociatedActiveSheetName(),e);var l=new AjaxRequest;l.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(l),"ADD"!==colorScalesDialogState&&(colorScalesBag.isDialogEdited=!0),sheetdialog.close()},N=function(){for(var e="NONE"===$("#type2").val()?!0:!1,t=e?z(s("input1"),s("input3"),7):z(s("input1"),s("input2"),7,s("input3")),a="linear-gradient(to right, ",l=7,o=100/l,c=0;7>c;c++)a+=t[c]+" "+Math.round(o*c)+"% ,"+t[c]+" "+Math.round(o*(c+1))+"%, ";a=a.substring(0,a.lastIndexOf(","))+")";var n=$("#colorScalePreview");n.css("background-image",a)},A=function(e){var t=e.split("(")[1].split(")")[0];return t=t.split(","),.299*t[0]+.587*t[1]+.114*t[2]},O=function(e){U(selectedRangeForDialog())&&(colorScalesBag.viewRules=$("#selComp").zcombo("getSelectedIndex"),colorScalesBag.filterRule=$("#selRule").zcombo("getValue"),0===colorScalesBag.viewRules&&(colorScalesBag.rulesRange=$("#conditionFilter").val()),sheetdialog.hideDialog(),"colorScale"===e?(colorScalesDialogState="MANAGE_ADD",i()):"classic"===e?(classicDialodState="MANAGE_ADD",formatWithConditions.createClassicRule()):"iconSet"===e&&(iconsets.iconsetDialogState="MANAGE_ADD",iconsets.showIconSetDialog()))},T=function(e,t,a,l,o,c){-1!==e.children()[0].className.indexOf("rE")?L(t,a,e,l,o):-1!==e.children()[0].className.indexOf("rC")?k(t,a,e,l,o):-1!==e.children()[0].className.indexOf("rD")&&P(t,a,e,l,o,c)},U=function(e){for(var t=e.replace(/,/g,";").split(";"),a=0;a<t.length;a++){var l=formatWithConditions.getRangeValues(t[a]);if(!l)return void showAlertDialog(jsMsg["CFormat.InvalidRange"]);var o=l.startRow,c=l.startCol,n=l.endRow,i=l.endCol;if(ProtectedRanges.isRangeLocked(o,c,n,i))return!1}return!0},w=function(){var e=$("#condFormat").children().length;if("all"!==$("#selRule").zcombo("getValue"))for(var t=0;e>t;t++)"none"===$($("#condFormat").children()[t]).css("display")&&e--;return e},P=function(e,t,a,l,o,c){loadRuleObj=manageEditedRules[o+"_"+l];var n=loadRuleObj.datarange;if(U(n)){var i=manageEditedRules[o+"_"+l],n=i.datarange;if(U(n)){var s=w();V(s-1),$("#"+c).parent().addClass("bOr aDd"),setTimeout(function(){$("#"+c).parent().remove(),0===s&&$("#noconditions").show()},1e3);var r=n.split(";");n=formatWithConditions.getRangeValues(r[0]);var u=(n.sheetName,{csuid:o,asn:l,cs_type:i.cs_type,datarange:i.datarange}),d=new RequestParameters(ActionConstants.CONDITIONAL_FORMAT_DELETE);d.setParameters(WorkSheets.getAssociatedActiveSheetName(),JSON.stringify(u));var g=new AjaxRequest;g.init("POST",d.getURL(),!0,d.getParametersAsString()),g.addEventListener("onComplete",function(){}),actionManager.addRequest(g)}}},V=function(e){$("#condFormat").children().length;setTimeout(function(){0===e&&$("#noconditions").show()},2e3),1===e?($("#condFormat").children().on("mousedown",function(e){e.stopPropagation()}),$("#condFormat").children().find(".drag_cue").css("display","none")):($("#condFormat").children().unbind("mousedown"),$("#condFormat").children().find(".drag_cue").css("display","block"))},k=function(e,t,a,l,o){if(U(selectedRangeForDialog()))if(colorScalesBag.viewRules=$("#selComp").zcombo("getSelectedIndex"),colorScalesBag.filterRule=$("#selRule").zcombo("getValue"),0===colorScalesBag.viewRules&&(colorScalesBag.rulesRange=$("#conditionFilter").val()),sheetdialog.hideDialog(),manageEditId=t+"_"+o+"_"+l,"colorscale"===e||"c_s"===e)colorScalesDialogState="COPY",i();else if("iconset"===e||"i_s"===e)iconsets.iconsetDialogState="COPY",iconsets.showIconSetDialog();else if("classic"===e||"c_f"===e){formatWithConditions.showConditionalDialog("iconElement","CFormat.CopyRule"),classicDialodState="COPY";var c=manageEditedRules[o+"_"+l];setTimeout(function(){formatWithConditions.loadExistingRules(c)},100),setTimeout(function(){$("#aR").hide()},10)}},L=function(e,t,l,o,c){loadRuleObj=manageEditedRules[c+"_"+o];var n=loadRuleObj.datarange;U(n)&&(colorScalesBag.viewRules=$("#selComp").zcombo("getSelectedIndex"),colorScalesBag.filterRule=$("#selRule").zcombo("getValue"),0===colorScalesBag.viewRules&&(a=$("#conditionFilter").val()),sheetdialog.hideDialog(),manageEditId=t+"_"+c+"_"+o,"colorscale"===e||"c_s"===e?(colorScalesDialogState="EDIT",i()):"classic"===e||"c_f"===e?(classicDialodState="EDIT",formatWithConditions.showConditionalDialog("iconElement","CFormat.EditRule"),getObj("aR")&&(getObj("aR").style.display="none")):"i_s"===e&&(iconsets.iconsetDialogState="EDIT",iconsets.editIconSetRule(e,t,l,o,c)))},B=function(){var e=sheetdialog.isDialogOpen()&&"colorscalesdialog"==sheetdialog.getDialogName()?"colorscaledialogtheme":"colorscalesm";if("colorscaledialogtheme"===e){var t=$("#colorscaledialogtheme");"none"===$("#classicPreview").css("background-image")&&($(t.find("li")[4]).hide(),$(t.find("li")[5]).hide());var a=!1;t.find(".cstM").css("display","none");for(var l=1;12>=l;l++){var c=defaulttheme["theme"+l];if(7>l&&"NONE"===$("#type2").zcombo("getValue")&&c.cs_c1==S(s("input1"))&&c.cs_c2==S(s("input3"))||l>6&&"NONE"!==$("#type2").zcombo("getValue")&&c.cs_c1==S(s("input1"))&&c.cs_c2==S(s("input2"))&&c.cs_c3==S(s("input3"))){a=!0,t.find(".cstM")[l-1].style.display="block";break}}a||(this.isColorEdited=!0),0===Object.keys(o)||a||(t.find(".cue")[0].style.display="block"),this.isColorEdited&&(x(),this.isColorEdited=!1,a||(t.find(".cue")[0].style.display="block"))}},x=function(){var e=$("#colorscaledialogtheme");$(e.find("li")[4]).show(),$(e.find("li")[5]).show();var t="NONE"===$("#type2").val()?!0:!1;o.noofcond=t?2:3;var a=[];o.cs_c1=s("input1"),o.cr_ty1=$("#type1").zcombo("getValue"),o.cval1="(Lowest value)"===$("#value1").val()?"":$("#value1").val(),t?(o.cs_c2=s("input3"),o.cr_ty2=$("#type3").zcombo("getValue"),o.cval2="(Highest value)"===$("#value3").val()?"":$("#value3").val()):(o.cs_c2=s("input2"),o.cs_c3=s("input3"),o.cr_ty2=$("#type2").zcombo("getValue"),o.cr_ty3=$("#type3").zcombo("getValue"),o.cval2=$("#value2").val(),o.cval3="(Highest value)"===$("#value3").val()?"":$("#value3").val());var a=t?z(s("input1"),s("input3"),7):z(s("input1"),s("input2"),7,s("input3")),l="linear-gradient(to right, ",c=7,n=100/c;if(null!==a){for(var i=0;7>i;i++)l+=a[i]+" "+Math.round(n*i)+"% ,"+a[i]+" "+Math.round(n*(i+1))+"%, ";l=l.substring(0,l.lastIndexOf(","))+")";var r=$("#classicPreview");r.css("background-image",l)}},z=function(e,t,a,l){var o=[];if(3===arguments.length){var c=100/(a-1)*.01,n=e.split("(")[1].split(")")[0];n=n.split(",");var i=t.split("(")[1].split(")")[0];i=i.split(",");for(var s=0;1.1>=s;s+=c){var r=Math.round(parseInt(n[0])+parseInt(i[0]-parseInt(n[0]))*s),u=Math.round(parseInt(n[1])+(parseInt(i[1])-parseInt(n[1]))*s),d=Math.round(parseInt(n[2])+(parseInt(i[2])-parseInt(n[2]))*s),g="rgb("+r+","+u+" ,"+d+")";o.push(g)}}else{if(!e)return null;var c=100/((a-1)/2)*.01,n=e.split("(")[1].split(")")[0];n=n.split(",");var i=t.split("(")[1].split(")")[0];i=i.split(",");var v=l.split("(")[1].split(")")[0];v=v.split(","),o.push(e);for(var s=c;1>s;s+=c){var r=Math.round(parseInt(n[0])+parseInt(i[0]-parseInt(n[0]))*s),u=Math.round(parseInt(n[1])+(parseInt(i[1])-parseInt(n[1]))*s),d=Math.round(parseInt(n[2])+(parseInt(i[2])-parseInt(n[2]))*s),g="rgb("+r+","+u+" ,"+d+")";o.push(g)}o.push(t);for(var s=c;1>s;s+=c){var r=Math.round(parseInt(i[0])+parseInt(v[0]-parseInt(i[0]))*s),u=Math.round(parseInt(i[1])+(parseInt(v[1])-parseInt(i[1]))*s),d=Math.round(parseInt(i[2])+(parseInt(v[2])-parseInt(i[2]))*s),g="rgb("+r+","+u+" ,"+d+")";o.push(g)}o.push(l)}return o},j=function(e){"hdTxt"===e&&$("#hdTxt").is(":checked")?($("#cTxtClr").parent().parent().disable(),$("#cTxtClr").disable()):($("#cTxtClr").parent().parent().enable(),$("#cTxtClr").enable())};return defaulttheme.theme1={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#FFFFFF",noofcond:2,noofrules:1},defaulttheme.theme2={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#FFFFFF",noofcond:2,noofrules:1},defaulttheme.theme3={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#FCD058",noofcond:2,noofrules:1},defaulttheme.theme4={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#FFFFFF",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#5AB187",noofcond:2,noofrules:1},defaulttheme.theme5={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#FFFFFF",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#E07369",noofcond:2,noofrules:1},defaulttheme.theme6={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#FCD058",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#5AB187",noofcond:2,noofrules:1},defaulttheme.theme7={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FCD058",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#E07369",noofcond:3,noofrules:1},defaulttheme.theme8={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#749AC8",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#E07369",noofcond:3,noofrules:1},defaulttheme.theme9={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#E07369",noofcond:3,noofrules:1},defaulttheme.theme10={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FCD058",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#5AB187",noofcond:3,noofrules:1},defaulttheme.theme11={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#749AC8",noofcond:3,noofrules:1},defaulttheme.theme12={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#5AB187",noofcond:3,noofrules:1},appEvent.on("colorscales.zcombo",function(e,t){R(e,t)}),{showColorScalesDialog:i,onApply:C,addRulesInManage:O,editRulesInManage:L,changePreview:N,editConditionalFormat:T,validateInputs:F,unbindEvents:M,bindEvents:_,bindRangeSelector:I,filterRule:e,viewRules:t,rulesRange:a,colorScaleThemeColor:B,isColorEdited:c,checkBoxHandling:j,getGradientColor:z,isRangeValid:U,brightness:A,rangeSelectorOff:g,rangeSelectorOn:v,isDialogEdited:l,applyTheme:b,createColorScale:n}}(jQuery);
var iconsets=function(){var n,t="ADD",e={},o=function(){colorScalesBag.isRangeValid(selectedRangeForDialog())&&c()},c=function(){var n={width:555,allowSheetSwitch:!0,close:function(){"ADD"!==iconsets.iconsetDialogState&&(iconsets.iconsetDialogState="ADD",manageEditId="",colorScalesBag.isDialogEdited?($.dialogutil.close("cformatmanagedialog"),setTimeout(function(){formatWithConditions.showManageRulesAfterEdit("manageLIElement")},400)):(setTimeout(function(){sheetdialog.recallDialog()},300),colorScalesBag.viewRules=null,colorScalesBag.filterRule=null)),colorScalesBag.isDialogEdited=!1,sheetdialog.close()}},t="EDIT"===iconsets.iconsetDialogState?jsMsg["CFormat.EditRule"]:"COPY"===iconsets.iconsetDialogState?jsMsg["CFormat.CopyRule"]:jsMsg["CFormat.NewRule"];n.title=jsMsg["CFormat.IconSets"]+" - "+t,sheetdialog.open("iconsetsdialog",n,s)},s={set:function(n,t){var e=n.action;appEvent.trigger("iconset.zcombo",[e,t])},init:function(){i(),a(),$("#appliestofieldis").focus(function(){var n=this;RangeSelector.on({el:n,appendSheetName:!0,callback:function(){colorScalesBag.isDialogEdited=!0},multiRangeSelection:!0})})},destroy:function(){RangeSelector.off()}},i=function(){if("ADD"===iconsets.iconsetDialogState||"MANAGE_ADD"==iconsets.iconsetDialogState)A(e["3Arrows"]),$("#appliestofieldis").val(selectedRangeForDialog());else if("EDIT"===iconsets.iconsetDialogState||"COPY"==iconsets.iconsetDialogState){var n=manageEditedRules[manageEditId.split("_")[1]+"_"+manageEditId.split("_")[2]];A(n.cstyle1,"EDIT"),I(),S(R()),$("#appliestofieldis").val("COPY"===iconsets.iconsetDialogState?selectedRangeForDialog():n.datarange),$("#rIo").prop("checked",n.rio),$("#hCc").prop("checked",n.hcc),$("#kDiS").prop("checked",n.dis)}setTimeout(function(){$("#appliestofieldis").focus()},210)},a=function(){for(var n=1;4>=n;n++)colorScalesBag.rangeSelectorOn("inputVal"+n)},r=function(t){n=t},_=function(t){$("#"+n).children("span")[0].className=t,S(R())},S=function(n){var t=N(n);"custom"===t?($("#customTag").show(),$(".iTsd").hide()):($("#customTag").hide(),$(".iTsd").show(),I()),$("#iconsetsPreview").attr("setName",t)},l=function(n){var t=e[n];A(t),I(),$("#customTag").hide(),$(".iTsd").show(),$("#iconsetsPreview").attr("setName",t.iconSetName)},I=function(){for(var n=$(".iTsd").children("span"),t=1;5>=t;t++){var e=n[t-1];"table-row"===$("#set"+t).css("display")?(e.style.display="inline-block",e.className=getObj("set"+t).querySelector("span").className+" mR5"):(e.className="",e.style.display="none")}},R=function(){for(var n={},t=0,e=1;5>=e;e++)if("table-row"===$("#set"+e).css("display")){t++;var o=$("#iconsetsrule"+e).children("span")[0].className.replace("iS-","");n["icon_name"+t]=-1==o.indexOf("None")?o.slice(0,-1):"None",n["icon_id"+t]=parseInt("None"!==o?o.slice(-1):-1)}return n.noofcond=t,n},d=function(n){var t=parseInt(n.slice(n.length-1));v(t),setTimeout(function(){$("#value"+t).focus().select()},400)},C=function(n,t){return-1==t?"iS-None":L[n+t]?L[n+t]:"iS-"+n+t},m=function(){$("#createIcon").disable();for(var n={},t=$(".tLm").children("div:visible").length-1,e=t,o=t;o>=1;o--){if("table-row"===$("#set"+o).css("display")){1!=e&&(n["cr_ty"+e]=$("#valueTypes"+(o-1)).zcombo("getValue"),n["cval"+e]=encodeURIComponent(convertFormulaReferencing($("#value"+(o-1)).val(),1)),n["is_c"+e]=$("#cd"+(o-1)).zcombo("getValue"));var c=$("#iconsetsrule"+o).children("span")[0].className.replace("iS-","");n["icon_name"+e]=-1===c.indexOf("None")?c.slice(0,-1):"None",n["icon_id"+e]="None"!==c?c.slice(-1):-1}e--}n.istheme=!1,n.hcc=$("#hCc").is(":checked"),n.rio=$("#rIo").is(":checked"),n.dis=$("#kDiS").is(":checked"),n.noofrules=1,n.noofcond=t,n.datarange=$("#appliestofieldis").val().replace(/,/g,";");var s=n.datarange.split(";")[0];n.asn=WorkSheets.getSheetCodeFromName(CellUtils.getSheetNameFromCelLbl(s[0])),n.iconSetName=N(n),"EDIT"===iconsets.iconsetDialogState&&(n.csuid=manageEditId.split("_")[1],n.asn=manageEditId.split("_")[2],n.cs_type=manageEditedRules[manageEditId.split("_")[1]+"_"+manageEditId.split("_")[2]].cs_type),T(JSON.stringify(n))},g=function(n){if(sheetdialog.isDialogOpen()&&"iconsetsdialog"==sheetdialog.getDialogName())l(n);else{var t=selectedRangeForDialog();if(!colorScalesBag.isRangeValid(t))return;var o=getCellRange();o=getServerRange(o.startRow,o.startCol,o.endRow,o.endCol);var t=CellUtils.constructCellName(o.startRow,o.startCol,o.endRow,o.endCol,!1,CURRSHEETNAME),c=e[n];c.datarange=t,c.asn=WorkSheets.getSheetCodeFromName(CellUtils.getSheetNameFromCelLbl(t)),f(JSON.stringify(c))}},N=function(n){for(var t in e){var o=t,c=e[t];if(n.noofcond===c.noofcond){for(var s=!0,t=1;t<=n.noofcond;t++)(n["icon_id"+t]!=c["icon_id"+t]||n["icon_name"+t]!=c["icon_name"+t])&&(s=!1);if(s)return o}}return"custom"},T=function(n){var t=new RequestParameters(ActionConstants.VALIDATE_INPUT_CF);t.setParameters(WorkSheets.getAssociatedActiveSheetName(),"iconset",n);var e=new AjaxRequest;e.init("POST",t.getURL(),!0,t.getParametersAsString()),e.addEventListener("onComplete",function(t){$("#createIcon").enable();var e=parseJSON(t.responseText);return 0!=Boolean(e.valinp.isError)?void E(e.valinp.errorMsg,e.valinp.type):void f(n)}),e.sendRequest()},E=function(n,t){showAlertDialog("CFormat.InvalidFormula"===n?jsMsg[n]:replaceParams(jsMsg["CFormat.InputErrorPrecent"],new Array(jsMsg["CFormat.CS."+t])))},f=function(n){var t="EDIT"===iconsets.iconsetDialogState?ActionConstants.CONDITIONAL_FORMAT_EDIT:ActionConstants.ICON_SET_APPLY,e=new RequestParameters(t);e.setParameters(WorkSheets.getAssociatedActiveSheetName(),n);var o=new AjaxRequest;o.init("POST",e.getURL(),!0,e.getParametersAsString()),actionManager.addRequest(o),"ADD"!==iconsets.iconsetDialogState&&(colorScalesBag.isDialogEdited=!0),sheetdialog.close()},A=function(n,t){for(var e=$(".tLm").children("div:visible").length-1,o=count=n.noofcond?n.noofcond:Object.keys(n).length/5,c=1;5>=c;c++)if(c>o)$("#set"+c).hide();else{if(o!==e||t){$("#set"+c).show(),$("#cd"+c).zcombo("setValue",n["is_c"+(c+1)]?n["is_c"+(c+1)]:"gteq"),$("#value"+c).val(n["cval"+(c+1)]);var s=n["cr_ty"+(c+1)];if($("#valueTypes"+c).zcombo("setValue",s),c>1){var i=c-1,a="gt"==$("#cd"+i).zcombo("getValue")?">":">=",r=$("#set"+i).find("input")[0].value,_=chartGlance.isNumber(r),S="FORMULA"!==$("#valueTypes"+i).zcombo("getValue")&&_?r:"Formula",l=c===o?a+" "+S:a+" "+S;$("#set"+c).find(".cDt").html(l)}c===o?($("#cd"+c).zcombo("hide"),$("#inputVal"+c).hide(),$("#valueTypes"+c).zcombo("hide"),$("#set"+c).find(".oPand").css("visibility","hidden")):($("#cd"+c).zcombo("show"),$("#inputVal"+c).show(),$("#set"+c).find(".oPand").css("visibility","visible"),$("#valueTypes"+c).zcombo("show"))}getObj("set"+count).querySelector("span").className=C(n["icon_name"+count],n["icon_id"+count]),count--}},u=function(){t="EDIT",c()},v=function(n){var t="gt"==$("#cd"+n).zcombo("getValue")?">":">=",e=jsMsg["CFormat.CS.Formula"];if("FORMULA"!==$("#valueTypes"+n).zcombo("getValue")){var o=$("#value"+n).val();if("FORMULA"!==$("#valueTypes"+n).zcombo("getValue")){var c=chartGlance.isNumber(o);if(c){var s=(parseInt(o),o.length);s>=9?(e=o.substring(0,6)+"...",$("#set"+(n+1)).find(".cDt").attr("title",o)):(e=o,$("#set"+(n+1)).find(".cDt").removeAttr("title"))}}}var i=$("#inputVal"+(n+1)).is(":visible")?t+" "+e:t+" "+e;$("#set"+(n+1)).find(".cDt").html(i)},h=function(){sheetdialog.isDialogOpen()&&"iconsetsdialog"==sheetdialog.getDialogName()?$("#iconsetmenu").addClass("hCmI"):$("#iconsetmenu").removeClass("hCmI")},y=function(n,t,e){var o=C(n,t),c=document.createElement("span");return e&&$(c).addClass("kDis"),(("3Stars"===n||"3HeartRating"==n)&&1==t||-1!==n.indexOf("3Symbols")||-1!==n.indexOf("Smil")||"3Flags"===n||"5Quarters"===n||"2Love"==n&&1==t||"3TrafficLights2"==n||"5Weather"==n)&&$(c).append(document.createElement("span")),$(c).addClass(o?o:n+t),c};e[IconSetConstants.LIKES2]={cr_ty2:"PERCENT",cval2:"50",is_c2:"gteq",noofcond:2,noofrules:1,iconSetName:"2Likes",istheme:!0,icon_name1:"2Likes",icon_id1:0,icon_name2:"2Likes",icon_id2:1},e[IconSetConstants.LOVE2]={cr_ty2:"PERCENT",cval2:"50",is_c2:"gteq",noofcond:2,noofrules:1,iconSetName:"2Love",istheme:!0,icon_name2:"3Heart",icon_id2:0,icon_name1:"2Love",icon_id1:1},e[IconSetConstants.INDICATOR2]={cr_ty2:"PERCENT",cval2:"50",is_c2:"gteq",noofcond:2,noofrules:1,iconSetName:"2Indicators",istheme:!0,icon_name2:"2Indicators",icon_id2:1,icon_name1:"2Indicators",icon_id1:0},e[IconSetConstants.ARROWS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Arrows",istheme:!0,icon_name1:"5Arrows",icon_id1:0,icon_name2:"5Arrows",icon_id2:2,icon_name3:"5Arrows",icon_id3:4},e[IconSetConstants.STARS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Stars",istheme:!0,icon_name1:"3Stars",icon_id1:0,icon_name2:"3Stars",icon_id2:1,icon_name3:"3Stars",icon_id3:2},e[IconSetConstants.SMILEYS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Smileys",istheme:!0,icon_name1:"5Smileys",icon_id1:1,icon_name2:"5Smileys",icon_id2:2,icon_name3:"5Smileys",icon_id3:3},e[IconSetConstants.HEARTRATING3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3HeartRating",istheme:!0,icon_name1:"3HeartRating",icon_id1:0,icon_name2:"3HeartRating",icon_id2:1,icon_name3:"3Heart",icon_id3:0},e[IconSetConstants.TRIANGLES3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Triangles",istheme:!0,icon_name1:"3Triangles",icon_id1:0,icon_name2:"3Triangles",icon_id2:1,icon_name3:"3Triangles",icon_id3:2},e[IconSetConstants.SIGNS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Signs",istheme:!0,icon_name1:"3Signs",icon_id1:0,icon_name2:"3Signs",icon_id2:1,icon_name3:"5TrafficLights",icon_id3:4},e[IconSetConstants.TRAFFICLIGHTS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3TrafficLights",istheme:!0,icon_name1:"5TrafficLights",icon_id1:2,icon_name2:"5TrafficLights",icon_id2:3,icon_name3:"5TrafficLights",icon_id3:4},e[IconSetConstants.TRAFFICLIGHTS32]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3TrafficLights2",istheme:!0,icon_name1:"3TrafficLights2",icon_id1:0,icon_name2:"3TrafficLights2",icon_id2:1,icon_name3:"3TrafficLights2",icon_id3:2},e[IconSetConstants.ARROWSGRAY3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3ArrowsGray",istheme:!0,icon_name1:"5ArrowsGray",icon_id1:0,icon_name2:"5ArrowsGray",icon_id2:2,icon_name3:"5ArrowsGray",icon_id3:4},e[IconSetConstants.ARROWSGRAY4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4ArrowsGray",istheme:!0,icon_name1:"5ArrowsGray",icon_id1:0,icon_name2:"5ArrowsGray",icon_id2:1,icon_name3:"5ArrowsGray",icon_id3:3,icon_name4:"5ArrowsGray",icon_id4:4},e[IconSetConstants.ARROWSGRAY5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5ArrowsGray",istheme:!0,icon_name1:"5ArrowsGray",icon_id1:0,icon_name2:"5ArrowsGray",icon_id2:1,icon_name3:"5ArrowsGray",icon_id3:2,icon_name4:"5ArrowsGray",icon_id4:3,icon_name5:"5ArrowsGray",icon_id5:4},e[IconSetConstants.FLAGS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Flags",istheme:!0,icon_name1:"3Flags",icon_id1:0,icon_name2:"3Flags",icon_id2:1,icon_name3:"3Flags",icon_id3:2},e[IconSetConstants.SYMBOLS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Symbols",istheme:!0,icon_name1:"3Symbols",icon_id1:0,icon_name2:"3Symbols",icon_id2:1,icon_name3:"3Symbols",icon_id3:2},e[IconSetConstants.TRAFFICLIGHTS4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4TrafficLights",istheme:!0,icon_name1:"5TrafficLights",icon_id1:0,icon_name2:"5TrafficLights",icon_id2:2,icon_name3:"5TrafficLights",icon_id3:3,icon_name4:"5TrafficLights",icon_id4:4},e[IconSetConstants.REDTOBLACK4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4RedToBlack",istheme:!0,icon_name1:"5TrafficLights",icon_id1:0,icon_name2:"5TrafficLights",icon_id2:1,icon_name3:"4RedToBlack",icon_id3:2,icon_name4:"5TrafficLights",icon_id4:2},e[IconSetConstants.TRAFFICLIGHTS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5TrafficLights",istheme:!0,icon_name1:"5TrafficLights",icon_id1:0,icon_name2:"5TrafficLights",icon_id2:1,icon_name3:"5TrafficLights",icon_id3:2,icon_name4:"5TrafficLights",icon_id4:3,icon_name5:"5TrafficLights",icon_id5:4},e[IconSetConstants.ARROWS4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4Arrows",istheme:!0,icon_name1:"5Arrows",icon_id1:0,icon_name2:"5Arrows",icon_id2:1,icon_name3:"5Arrows",icon_id3:3,icon_name4:"5Arrows",icon_id4:4},e[IconSetConstants.ARROWS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Arrows",istheme:!0,icon_name1:"5Arrows",icon_id1:0,icon_name2:"5Arrows",icon_id2:1,icon_name3:"5Arrows",icon_id3:2,icon_name4:"5Arrows",icon_id4:3,icon_name5:"5Arrows",icon_id5:4},e[IconSetConstants.QUARTERS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Quarters",istheme:!0,icon_name1:"5Quarters",icon_id1:0,icon_name2:"5Quarters",icon_id2:1,icon_name3:"5Quarters",icon_id3:2,icon_name4:"5Quarters",icon_id4:3,icon_name5:"5TrafficLights",icon_id5:0},e[IconSetConstants.WEATHER5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Weather",istheme:!0,icon_name1:"5Weather",icon_id1:0,icon_name2:"5Weather",icon_id2:1,icon_name3:"5Weather",icon_id3:2,icon_name4:"5Weather",icon_id4:3,icon_name5:"5Weather",icon_id5:4},e[IconSetConstants.SMILEYS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Smileys",istheme:!0,icon_name1:"5Smileys",icon_id1:0,icon_name2:"5Smileys",icon_id2:1,icon_name3:"5Smileys",icon_id3:2,icon_name4:"5Smileys",icon_id4:3,icon_name5:"5Smileys",icon_id5:4},appEvent.on("iconset.zcombo",function(n,t){d(n,t)});var L={};return L[IconSetConstants.IN_3ARROWS0]=L[IconSetConstants.IN_4ARROWS0]=L[IconSetConstants.IN_5ARROWS0]=L[IconSetConstants.IN_4RATING0]=IconSetConstants.IS_5ARROWS0,L[IconSetConstants.IN_3ARROWS1]=L[IconSetConstants.IN_5ARROWS2]=IconSetConstants.IS_5ARROWS2,L[IconSetConstants.IN_3ARROWS2]=L[IconSetConstants.IN_4ARROWS3]=L[IconSetConstants.IN_5ARROWS4]=L[IconSetConstants.IN_4RATING3]=IconSetConstants.IS_5ARROWS4,L[IconSetConstants.IN_3ARROWS3]=L[IconSetConstants.IN_4ARROWS1]=L[IconSetConstants.IN_5ARROWS1]=L[IconSetConstants.IN_4RATING1]=IconSetConstants.IS_5ARROWS1,L[IconSetConstants.IN_3ARROWS4]=L[IconSetConstants.IN_4ARROWS2]=L[IconSetConstants.IN_5ARROWS3]=L[IconSetConstants.IN_4RATING2]=IconSetConstants.IS_5ARROWS3,L[IconSetConstants.IN_3ARROWSGRAY0]=L[IconSetConstants.IN_4ARROWSGRAY0]=L[IconSetConstants.IN_5ARROWSGRAY0]=IconSetConstants.IS_5ARROWSGRAY0,L[IconSetConstants.IN_3ARROWSGRAY1]=L[IconSetConstants.IN_5ARROWSGRAY2]=IconSetConstants.IS_5ARROWSGRAY2,L[IconSetConstants.IN_3ARROWSGRAY2]=L[IconSetConstants.IN_4ARROWSGRAY3]=L[IconSetConstants.IN_5ARROWSGRAY4]=IconSetConstants.IS_5ARROWSGRAY4,L[IconSetConstants.IN_4ARROWSGRAY1]=L[IconSetConstants.IN_5ARROWSGRAY1]=IconSetConstants.IS_5ARROWSGRAY1,L[IconSetConstants.IN_4ARROWSGRAY2]=L[IconSetConstants.IN_5ARROWSGRAY3]=IconSetConstants.IS_5ARROWSGRAY3,L[IconSetConstants.IN_4REDTOBLACK3]=L[IconSetConstants.IN_3TRAFFICLIGHTS10]=L[IconSetConstants.IN_3TRAFFICLIGHTS0]=L[IconSetConstants.IN_4TRAFFICLIGHTS1]=L[IconSetConstants.IN_5TRAFFICLIGHTS2]=IconSetConstants.IS_5TRIFFICLIGHTS2,L[IconSetConstants.IN_3TRAFFICLIGHTS11]=L[IconSetConstants.IN_3TRAFFICLIGHTS1]=L[IconSetConstants.IN_4TRAFFICLIGHTS2]=L[IconSetConstants.IN_5TRAFFICLIGHTS3]=IconSetConstants.IS_5TRIFFICLIGHTS3,L[IconSetConstants.IN_3TRAFFICLIGHTS12]=L[IconSetConstants.IN_3TRAFFICLIGHTS2]=L[IconSetConstants.IN_4TRAFFICLIGHTS3]=L[IconSetConstants.IN_5TRAFFICLIGHTS4]=L[IconSetConstants.IN_3SIGNS2]=IconSetConstants.IS_5TRIFFICLIGHTS4,L[IconSetConstants.IN_4REDTOBLACK0]=L[IconSetConstants.IN_4TRAFFICLIGHTS0]=L[IconSetConstants.IN_5TRAFFICLIGHTS0]=L[IconSetConstants.IN_5RATINGS4]=L[IconSetConstants.IN_5QUARTERS4]=L[IconSetConstants.IN_5BOXES4]=IconSetConstants.IS_5TRIFFICLIGHTS0,L[IconSetConstants.IN_4REDTOBLACK1]=L[IconSetConstants.IN_5TRAFFICLIGHTS1]=IconSetConstants.IS_5TRIFFICLIGHTS1,L[IconSetConstants.IN_3SYMBOLS10]=L[IconSetConstants.IN_3SYMBOLS20]=IconSetConstants.IS_3SYMBOLS0,L[IconSetConstants.IN_3SYMBOLS11]=L[IconSetConstants.IN_3SYMBOLS21]=IconSetConstants.IS_3SYMBOLS1,L[IconSetConstants.IN_3SYMBOLS12]=L[IconSetConstants.IN_3SYMBOLS22]=IconSetConstants.IS_3SYMBOLS2,L[IconSetConstants.IN_3SMILEYS0]=L[IconSetConstants.IN_3COLORSMILIES0]=IconSetConstants.IS_5SMILEYS0,L[IconSetConstants.IN_3SMILEYS1]=L[IconSetConstants.IN_3COLORSMILIES1]=IconSetConstants.IS_5SMILEYS2,L[IconSetConstants.IN_3SMILEYS2]=L[IconSetConstants.IN_3COLORSMILIES2]=IconSetConstants.IS_5SMILEYS4,L[IconSetConstants.IN_5RATINGS0]=L[IconSetConstants.IN_5QUARTERS0]=L[IconSetConstants.IN_5BOXES0]=IconSetConstants.IS_5QUARTERS0,L[IconSetConstants.IN_5RATINGS1]=L[IconSetConstants.IN_5QUARTERS1]=L[IconSetConstants.IN_5BOXES1]=IconSetConstants.IS_5QUARTERS1,L[IconSetConstants.IN_5RATINGS2]=L[IconSetConstants.IN_5QUARTERS2]=L[IconSetConstants.IN_5BOXES2]=IconSetConstants.IS_5QUARTERS2,L[IconSetConstants.IN_5RATINGS3]=L[IconSetConstants.IN_5QUARTERS3]=L[IconSetConstants.IN_5BOXES3]=IconSetConstants.IS_5QUARTERS3,L[IconSetConstants.IN_3HEARTRATING2]=L[IconSetConstants.IN_2LOVE0]=IconSetConstants.IS_3HEART0,{showIconSetDialog:c,changeClickedItem:r,setIconInSelectTag:_,setIconsetInSelectTag:l,validateInputFields:T,constructInputJson:m,createSPAN:y,applyTheme:g,editIconSetRule:u,iconsetDialogState:t,getIconClassName:C,classNameMap:L,changeDisplayValues:v,createIconSet:o,handleCustomTag:h,showErrorInClient:E}}(jQuery);
!function(t){function n(){a=$("#ztb-switch-menu"),i(),o(),p()}function i(){a.unbind(),$("#ztb-apps").remove()}function o(){a.on("click",e)}function p(){var t={allApps:"ALL ZOHO APPS",workPlaceApps:"WORKPLACE APPS",allAppsSwitch:"All Zoho Apps",workPlaceSwitch:"Workplace Apps"},n=window.topApps.init(ctxpath+"api/allapps",t);n.done(function(t){c=t,$(c).hide(),$(c).css("top",a.outerHeight()+"px"),document.body.appendChild(c)})}function e(){a.addClass("ztb-active"),$(c).show()}function s(t){var n=t.target,i=$(n).closest(".zmHApps");!i.length&&$(c).is(":visible")&&(a.removeClass("ztb-active"),$(c).hide())}var c,a;appEvent.on("body.mousedown",s),t.initHamburgerMenu=n}(this);
!function(e){var a=window;a.topApps={};var n=a.topApps,r=function(a){var n,r=e.ajax({url:a,type:"POST",error:function(){},success:function(e){n=e}});return r},s=function(e){return r(e).done(function(){})},p=function(a,r){var p=e.Deferred();return s(a).done(function(e){p.resolve(n.core(e,r))}),p};n.init=p}(jQuery),function(){var e,a=window.topApps,n=function(){return[{category:"SALES & MARKETING",apps:["crm","motivator","campaigns","survey","sites","salesiq","social","contactmanager","forms","sign"],position:1},{category:"HELP DESK SOFTWARE",apps:["support","assist"],position:4},{category:"EMAIL & COLLABORATION",apps:["mail","chat","connect","docs","projects","bugtracker","meeting","showtime","vault","sprints","notebook"],position:3},{category:"BUSINESS PROCESS",apps:["creator","reports","site24x7"],position:2},{category:"FINANCE",apps:["books","invoice","subscriptions","expense","inventory"],position:5},{category:"HUMANRESOURCES",apps:["people","recruit"],position:6}]};e=["mail","chat","connect","docs","showtime","sites","writer","sheet","show"],a.Appsconstants=n,a.workplaceConstants=e}(),function(e){var a,n,r,s=window.topApps,p=function(){var s,p=e(a).find("h4").find("span"),t=e(a).find(".zmHAppSwitch").find("span");for(n=e(a).find(".zmHAppsBlk"),r=n.length,r=t.length,s=0;r>s;s++)t[s].className="active"===t[s].className?"":"active";for(s=0;r>s;s++)p[s].className="active"===p[s].className?"":"active"},t=function(s){a=s;var t,i=function(){var n=e(".zmHamburger");a=document.getElementsByClassName("zmHApps")[0],a&&a.childNodes.length>0&&(e(n).removeClass("zmHactive"),a.parentElement.removeChild(a)),e(document.body).off("click",i)};e(a).on("click",function(s){if(s.stopPropagation(),t=s.target.closest("div"),"zmHAppSwitch clearfix"===t.className&&"SPAN"===s.target.nodeName){n=e(a).find(".zmHAppsBlk"),r=n.length;for(var o=0;r>o;o++)n[o].className="zmHAppsBlk shw"===n[o].className?"zmHAppsBlk":"zmHAppsBlk shw";p()}else("A"===s.target.nodeName||"I"===s.target.nodeName||"SPAN"===s.target.nodeName&&"active"!==s.target.className)&&"undefined"!=typeof window.zmail&&i()}),e(a).bind("wheel",function(n){var r=e(a).find("#workplace"),s=e(a).find("#allapps");n.originalEvent.deltaY<0?"zmHAppsBlk shw"!==r[0].className&&(s.removeClass("shw"),r.addClass("shw"),p()):n.originalEvent.deltaY>0&&"zmHAppsBlk shw"!==s[0].className&&(s.addClass("shw"),r.removeClass("shw"),p())})};s.bindListener=t}(jQuery),function(e){var a,n,r,s,p,t={},i=window.topApps,o=i.Appsconstants();r=["SALES","HELPDESK","EMAIL","BUSINESS","FINANCE","HUMANRESOURCES"],i.getDOMReferenceMap=function(a,n,r){r=r||"ref",a=e(a);var s,p,t,i=e("["+r+"]",a),o={};for(i=i||[],e(a).attr(r)&&i.push(e(a)[0]),s=0,p=i.length;p>s;s++)t=i[s],o[e(t).attr(r)]=e(t)[0],n&&e(t).removeAttr(r);return o};var l=function(e,a){for(var n=0;n<e.length;n++)if(e[n].app_name===a)return e[n]},c=function(a){var n="zwi-"+a.aname,r=i.getWorkPlaceWrapper(a),s=i.getDOMReferenceMap(r);return e(s.work).attr("class",n),s.dom},d=function(a){var n="zAppIco16 "+a.aname,r=i.getAllAppsWrapper(a),s=i.getDOMReferenceMap(r,!0);return e(s.dname).attr("class",n),a.isused&&e(s.url).append('<i class = "zwi-tick"></i>'),s.done},f=function(){a=i.workplaceConstants;for(var r,s,p,t,o=e('<ul class = "zmHAppList clearfix"></ul>'),d="docs",f="cliq",u=0;u<a.length;u++)if(t=l(n.apps,a[u]),"undefined"!=typeof t){r=t.trynow_url,s=t.display_name,p=t.app_name,"Chat"!==s&&"Cliq"!==s||(s="Cliq",p="cliq",r=r.replace(t.app_name,f)),"Sheet"===t.display_name||"Show"===t.display_name?(r=r.replace(t.app_name,d),r=r+"/"+t.app_name+"/new"):"Writer"===t.display_name&&(r+="/documents");var m=c({url:r,dname:s,aname:p});e(o).append(m)}return o[0]},u=function(){var a,t,i,c,f;s=o.length,t=e('<div class = "zmHAppsAll clearfix"></div>');for(var u=0;s>u;u++){f=!1,r.indexOf("SALES")!==u&&r.indexOf("BUSINESS")!==u&&r.indexOf("EMAIL")!==u||(a=e("<div></div>")),i=e('<ul class = "zmHAppList"></ul>').append("<li>"+o[u].category+"</li>");for(var m=0;m<o[u].apps.length;m++)if(p=l(n.apps,o[u].apps[m]),"undefined"!=typeof p){var v=p.app_name;c=p.trynow_url,"chat"===v?(v="cliq",p.display_name="Cliq"):"support"===v?v="desk":"crm"===v&&(c=p.home_url);var A;p.is_used_app===!0&&(f=!0),A=d({url:c,aname:v,dname:p.display_name,isused:f}),e(i).append(e(A))}e(a).append(i),r.indexOf("HELPDESK")!==u&&r.indexOf("FINANCE")!==u&&r.indexOf("HUMANRESOURCES")!==u&&r.indexOf("EMAIL")!==u||e(t).append(a)}return t[0]};t.constructTopBand=function(e,a){n=e;var r=u(),s=f(),p=i.getView(s,r,a);return i.bindListener(p),p},i.core=t.constructTopBand}(jQuery),function(e){var a=window.topApps,n=function(e){return['<li ref="dom"><a target = "_blank" rel = "noreferrer" href='+e.url+'><i ref="work"></i><span>'+e.dname+"</span></a></li>"].join("")},r=function(e){return['<li ref="done"><a ref="url"target = "_blank" rel = "noreferrer" href ='+e.url+'><span ref="dname"></span>'+e.dname+"</li>"].join("")},s=function(n,r,s){var p=['<div ref="wrapper"class="zmHAppsWra"><div id="workplace"class="zmHAppsBlk shw"><div ref="workplace" class = "zmHAppsBundle"></div></div><div ref="allapps"id="allapps"class="zmHAppsBlk"><div></div>'].join(""),t=function(e){var a=e;return['<div ref="wrapper"class = "zmHApps"><h4><span class = "active">'+a.workPlaceApps+"</span><span class>"+a.allApps+'</span></h4><div ref = "appsWrapper"class = "zmHAppSwitch clearfix"><ul><li><span class>'+a.workPlaceSwitch+'</span></li><li><span class = "active">'+a.allAppsSwitch+"</span></li></ul></div></div>"].join("")},i=t(s),o=a.getDOMReferenceMap(p,!0);e(o.workplace).append(n),e(o.allapps).append(r);var l=a.getDOMReferenceMap(i,!0);return e(o.wrapper).insertBefore(l.appsWrapper),l.wrapper};a.getView=s,a.getWorkPlaceWrapper=n,a.getAllAppsWrapper=r}(jQuery);
