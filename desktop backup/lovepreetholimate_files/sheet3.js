function recordMacro(e,o,t){isMacroButtonsInitialised||(isMacroButtonsInitialised=!0,$.ui.utils.initDeferredComponents({zbutton:"#stopmacros,#cancelMacroRecord, #viewMacrosList, #viewRecordedMacro"},10));var a=getCurrentSelectionRange();macroRecorder={},macroRecorder.sr=a.startRow,macroRecorder.sc=a.startCol,macroRecorder.er=a.endRow,macroRecorder.ec=a.endCol,macroRecorder.r=currRow,macroRecorder.c=currCol,macroRecorder.sn=CURRSHEETNAME,macroRecorder.mn=e,macroRecorder.rr=t,macroRecorder.des=encodeURIComponent(o),macroRecorder.actionIds=[],CURRENTLYRECORDEDMACRO=e;var r=new RequestParameters(ActionConstants.MACRO_START_RECORDING);r.setParameters(e);var s=new AjaxRequest;s.init("POST",r.getURL(),!0,r.getParametersAsString()),actionManager.addRequest(s)}function showRecordedMsg(){fadeOut("macroRecordingPanel",50),$("#stopmacros").enable(),fadeIn("macroRecordedPanel",50)}function cancelRecording(e){if(e===ActionConstants.MACRO_CANCEL_RECORDING){var o={buttons:[{text:jsMsg.OK,class:"ui-zbutton-primary",click:function(){widgetmenu.initmacroswidgets("enable"),$("#stoprecordmacro").is("hidden")||menutabListener.doAction(TOOLBAR.MACROS,{id:"macroBuildPort",action:"disable",callback:applyStyle_zbutton,args:["macroBuildPort","hide","stoprecordmacro"]}),hideMacroRecordPanel(),macroRecorder=null,RECORDINGMACRO=!1,sheetdialog.closeNotify()}},{text:jsMsg.Cancel,click:function(){sheetdialog.closeNotify()}}]};sheetdialog.showConfirmDialog(jsMsg.RecordMacroConfirmCancel,o)}}function stopRecording(e){var o=!1;(isCellEdited()||isFormulaCell())&&submitCell(),void 0===e&&(e=ActionConstants.MACRO_STOP_RECORDING),e=1*e;var t=new RequestParameters(e);e===ActionConstants.MACRO_STOP_RECORDING&&(t.setParameters(JSON.stringify(macroRecorder)),$("#stopmacros").disable(),stopDottedProgress(dottedEleId),widgetmenu.initmacroswidgets("enable"),Button.isMacroToBeAssigned&&null!=CURRENTLYRECORDEDMACRO&&RECORDINGMACRO&&(Button.isMacroToBeAssigned=!1,Button(Button.detailsToBeAssigned).sendAssignedMacro("Macros."+CURRENTLYRECORDEDMACRO),Button.detailsToBeAssigned=null));var a=new AjaxRequest;return a.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(a),RECORDINGMACRO=!1,o?void 0:!1}function showRecordedMacro(){isNaN(recordedMacroLineNo)?showMacroEditorDialog("Macros","1",5):showMacroEditorDialog("Macros",recordedMacroLineNo,5),recordedMacroLineNo=""}function showManageMacros(e){var o=getObj("macroPanel");if(o&&"none"!==o.style.display)return void hideMacroRecordPanel(function(){showManageMacros(e)});disableSaveButton();var t="",a=resizeMacrosList;"run"==e?t=jsMsg.RunMacro:"show"==e?(t=jsMsg.Macros,a=showMacrosListTab):("create"==e||"record"==e)&&(t=jsMsg.CreateMacro,a={init:function(){focusModuleName()}});var r=getCurrentSelectionRange(),s=new RequestParameters(ActionConstants.JSP_MANAGE_MACROS);s.setParameters(WorkSheets.getAssociatedActiveSheetName(),r.startRow,r.startCol,r.endRow,r.endCol,e,getViewType());var n=s.getURL()+"?"+s.getParametersAsString(),i={title:t};"run"!=e&&(i.width=500,i.modal=!0,i.close=function(){enableSaveButton()}),sheetdialog.close(),sheetdialog.open("managemacroDialog",i,a,void 0,n)}function insertMacro(e,o,t,a){"undefined"==typeof e&&(e=!1);var r,s="";if(e)r=o;else{var n=getObj("macroname");if(r=n.value.trim(),0==r.length)return showAlertDialog(jsMsg.MacroNameCannotBeEmpty),n.focus(),!1;var i=checkMacroName(r);if(i>0)return showAlertDialog(1==i?jsMsg.MacroNameCannotContainMsg:2==i?jsMsg.MacroNameStartWithMsg:jsMsg.MacroNameInEnglish),n.select(),!1;s=getObj("description").value.trim()}if(0==e){var c=!1;if($("#use_rel_ref").is(":checked")&&(c=!0),"record"==$("#inserttype").val())return recordMacro(r,s,c),!1}var d=new RequestParameters(ActionConstants.MACRO_INSERT);d.setParameters(r,encodeURIComponent(s));var l=new AjaxRequest;if(l.init("POST",d.getURL(),!0,d.getParametersAsString()),l.addEventListener("onComplete",function(){sheetdialog.close()}),actionManager.addRequest(l),e){if(ISMACROEDITOROPEN){var u=window.frames.frame_macrotextid.editArea;if(editAreaLoader.getFile("macrotextid","Macros").text=t,u.files.Macros.compare_edited_text=t,"Macros"==editAreaLoader.getCurrentFile("macrotextid").id&&(u.textarea.value=t,!ISMINDLG)){var m=showConfirmDialog(replaceParams(jsMsg.UserHasBeenInsertedNewMacro,new Array(a,o))+"\n"+jsMsg.DoYouWantToReloadIt);if(m){var g=editAreaLoader.getSelectionRange("macrotextid");u.textarea.focus(),u.display_file(editAreaLoader.getCurrentFile("macrotextid").id),editAreaLoader.setSelectionRange("macrotextid",g.start,g.end)}}}if(ISMINDLG){var M=getModuleIndex("Macros");module_content[M]=t}}return!1}function resizeMacrosList(){getObj("modulsttable").offsetHeight<70&&(getObj("macrosListWithActions").style.height="75px"),positionDialog()}function focusModuleName(e){e||($("#macroContiner .ui-tabs-inner-panel").hide(),$("#macroContiner .ui-tabs-panel").css("border","none")),setTimeout(function(){getObj("macroname").focus()},10),positionDialog()}function showCreateMacroTab(e){e||$("#CreateMacroTab").click(),$("#createmacChld").width($("#createmacCnt").width()),jsVERSION_VIEW||jsPUBLIC_VIEW||jsGUEST_VIEW?($("#createMacroDiv").hide(),$("#information").show(),$("#CreateButton").disable(),$("#closemacro").disable()):focusModuleName(!0)}function showMacrosListTab(e){e||setTimeout(function(){$("#ShowMacroTab").click()},100),(jsVERSION_VIEW||jsPUBLIC_VIEW||jsGUEST_VIEW)&&$("#information").hide()}function showRecordBtn(){var e=getObj("RecordButton");"none"==e.style.display&&(e.style.display="",getObj("CreateButton").style.display="none",getObj("use_rel_ref_tr").style.display=""),$("#inserttype").val("record"),$("#macroname").focus()}function showWriteBtn(){var e=getObj("CreateButton");"none"==e.style.display&&(e.style.display="",getObj("RecordButton").style.display="none",getObj("use_rel_ref_tr").style.display="none"),$("#inserttype").val("create"),$("#macroname").focus()}function blindupcallback(){resetPageDim(),""!=showAferBlind&&setTimeout(evalfunction,10),$("#recordmacro").is(":enabled")||menutabListener.doAction(TOOLBAR.MACROS,{id:"macroBuildPort",action:"enable",callback:applyStyle_zbutton,args:["macroBuildPort","show","stoprecordmacro"]})}function evalfunction(){showAferBlind&&showAferBlind(),showAferBlind=""}function hideMacroRecordPanel(e){showAferBlind="undefined"!=typeof e?e:"",blindUp("macroPanel",blindupcallback),isMacroRecordPanelOpened=!1}function showMacros(){var e=getCurrentSelectionRange(),o=new RequestParameters(ActionConstants.JSP_RUN_MACROS);o.setParameters(WorkSheets.getAssociatedActiveSheetName(),e.startRow,e.startCol,e.endRow,e.endCol);var t={width:300,title:jsMsg.RunMacroListTitle},a=o.getURL()+"?"+o.getParametersAsString();sheetdialog.open("showmacrodialog",t,checkFunctionList,void 0,a)}function checkFunctionList(){if("undefined"!=typeof noofmacros&&0==noofmacros)sheetdialog.close();else{var e=getObj("macrolisttable");if(e.offsetHeight>150){var o=getObj("MacroList1");o.style.maxHeight="200px",o.style.height="200px"}positionDialog()}}function updateMacros(e){for(var o=getObj("MacroList1"),t=o.getElementsByTagName("table")[0];t.rows.length>=1;)t.deleteRow(0);for(var a in e.MACROTABLE)if("undefined"!=typeof e.MACROTABLE[a].MODULENAME){var r=t.insertRow(t.rows.length),s=document.createElement("TD");s.className="macroListView";var n=e.MACROTABLE[a].MACRONAME;s.innerHTML="<a href=\"javascript:runmacro('"+escapeSpecialCharacters(e.MACROTABLE[a].MODULENAME)+"','"+escapeSpecialCharacters(n)+"');\" style='width:100%;' title='"+replaceParams(jsMsg.RunMacroName,new Array(ZSEC.Encoder.encodeForJavaScript(n)))+"'>"+ZSEC.Encoder.encodeForHTML(n)+"</a>",r.appendChild(s)}}function callBack_insertMacro(e,o){var t=e;if(t.indexOf("Failed")<0){var a=JSON.parse(t);if("OLD"!=a.ISMACRO&&Button.isMacroToBeAssigned&&(Button.isMacroToBeAssigned=!1,Button(Button.detailsToBeAssigned).sendAssignedMacro("Macros."+o),Button.detailsToBeAssigned=null),escpeMacroName=escapeSpecialCharacters(o),"OLD"==a.ISMACRO)return showAlertDialog(jsMsg.MacroNameAlreadyExists),"undefined"!=typeof txtmname&&txtmname.select(),!1;if(ISMINDLG&&!ISMACROEDITOROPEN){var r=getModuleIndex("Macros");null!=r&&(module_content[r]+="\nSub "+escpeMacroName+"()\n \nEnd Sub\n")}showMacroEditorDialog("Macros",a.LINENO,5),isSaveButtonEnabled=!0}}function callBack_startRecordMacro(e){if(e.isNew){sheetdialog.close(),RECORDINGMACRO=!0,widgetmenu.initmacroswidgets("disable");var o=getObj("macroRecordedPanel");o.style.opacity="1",o.style.display="none",o.style.filter="alpha(opacity=100)";var t=getObj("macroRecordingPanel");t.style.opacity="1",t.style.display="",$("#stoprecordmacro").is("hidden")?menutabListener.doAction(TOOLBAR.MACROS,{id:"macroBuildPort",action:"enable",callback:applyStyle_zbutton,args:["macroBuildPort","show","stoprecordmacro"]}):menutabListener.doAction(TOOLBAR.MACROS,{id:"macroBuildPort",action:"disable",callback:applyStyle_zbutton,args:["macroBuildPort","hide","stoprecordmacro"]}),t.style.filter="alpha(opacity=100)",(""==dottedEleId||null==getObj(dottedEleId))&&(dottedEleId=addDottedProgress(getObj("recordmsg"))),showDottedProgress(dottedEleId),blindDown("macroPanel",resetPageDim),isMacroRecordPanelOpened=!0}else showAlertDialog(jsMsg.MacroNameAlreadyExists),getObj("macroname").select(),macroRecorder=null}function callBack_stopRecordMacro(e){$("#stoprecordmacro").is("hidden")||menutabListener.doAction(TOOLBAR.MACROS,{id:"macroBuildPort",action:"disable",callback:applyStyle_zbutton,args:["macroBuildPort","hide","stoprecordmacro"]}),setTimeout(showRecordedMsg,500);var o=getObj("stopButtons"),t=e.lineNo;recordedMacroLineNo=isNaN(t)?"1":t,o.style.display="",ISMINDLG&&(ISMACRODOCCHANGE=!0),macroRecorder=null}function assignMacroCallback(){Button[Button.detailsToBeAssigned].isMacroAssigned?($("#assignMacroOptions").parent().hide(),$("#changeMacroOptions").parent().show(),$("#macroAssignedMsgHolder").parent().show(),$("#changeMacroMsgHolder").parent().show(),$("#chooseAMacroMsgHolder").parent().hide(),$("#feButtonAssignedMacroNameHolder").children("b").html(Button[Button.detailsToBeAssigned].macroName),$("#feButtonEditMacroLink").bind("click",function(){showMacroEditorDialog(Button[Button.detailsToBeAssigned].moduleName,Button[Button.detailsToBeAssigned].macroName)})):($("#assignMacroOptions").parent().show(),$("#changeMacroOptions").parent().hide(),$("#macroAssignedMsgHolder").parent().hide(),$("#changeMacroMsgHolder").parent().hide(),$("#chooseAMacroMsgHolder").parent().show());var e=getObj("macroListId").getElementsByTagName("option");Button.isAMacrosListOptionSelected=!1;for(var o=0;o<e.length;o++)Button[Button.detailsToBeAssigned].moduleName+"."+Button[Button.detailsToBeAssigned].macroName==e[o].value&&(e[o].selected=!0,Button.isAMacrosListOptionSelected=!0,getObj("macroAssignedMsgHolder").style.display=""),Button.isAMacrosListOptionSelected||(getObj("macroAssignedMsgHolder").style.display="none");Button.macroListOnLoad()}var showAferBlind="",recordedMacroLineNo="",dottedEleId="",isMacroRecordPanelOpened=!1,CURRENTLYRECORDEDMACRO,isMacroButtonsInitialised=!1,macroRecorder=null;appEvent.on("qaid.returned",function(e){null!=macroRecorder&&macroRecorder.actionIds.push(e.qaid)});
function _Button(e,t){if(getObj(e)&&arguments[2]){var o=getObj(e).parentNode;o&&o.removeChild(getObj(e))}return this.el=getObj("BUTTON").cloneNode(!0),this.el.id=this.id=e,this.el.objType="button",this.isMacroAssigned=!1,this.macroName,this.moduleName,this.isMacroAssigned,this.isInEditMode,sheetObjectsPane.appendChild(this.el),isUndefined(t)||Button.setProps(e,t),this.Label=this.el.getElementsByTagName("TD")[4],this.editableLabel=this.el.getElementsByTagName("TD")[5],this.textElement=this.el.getElementsByTagName("input")[0],this.textElement.onkeydown=function(t){Button(e).setCaption(t)},this}Button=function(){return"undefined"==typeof arguments[0]||null==Button[arguments[0]]?Button.init(arguments[0]):null!=Button[arguments[0]]?Button[arguments[0]]:void 0},Button.dateObj,Button.tempLeft,Button.tempWidth,Button.isMacroToBeAssigned=!1,Button.detailsToBeAssigned,Button.tempEl,Button.menuData,Button.diffX=20,Button.emptySpaceCount,Button.prevObjId,Button.isOnInitialEdit,Button.isInitialSizeChangedOnEdit,Button.isExecuting,Button.elementInEditMode,Button.menuData="<menu id='OLEButtonContextMenu' forElement='OLESelectLayer'><item onclick='Button.editLabel(ole.getCurrObj().id, false);return false;'><![CDATA["+jsMsg["Button.EditLabel"]+"]]></item> <sep></sep><item onclick='ole.currObj.clone(1,parseInt((10 * ole.currObj.cloneCountSinceLastDragOrResize) + ole.currObj.width + 10) ,parseInt((10 * ole.currObj.cloneCountSinceLastDragOrResize) + ole.currObj.height + 10));return false;'><![CDATA["+jsMsg.Clone+"]]></item><item onclick='ole.remove(ole.currObj.id,true);ole.conf.onblur();return false;'><![CDATA["+jsMsg.Delete+"]]></item></menu>",Button.init=function(e,t){Button[e]=new _Button(e,t,arguments[2]),Button[e].setText(t.cap),getObj(e).objType="button",ole.init(e,t.top,t.left,t.ht,t.wd).bringToFront(),ole(e).sCol=findColInXPos(ole(e).left),ole(e).sRow=findRowInYPos(t.top),ole(e).sColDiff=isRTL?ole(e).right-getColLeft(ole(e).sCol):ole(e).left-getColLeft(ole(e).sCol),ole(e).sRowDiff=t.top-getRowTop(ole(e).sRow),Button.setPermission(),Button.setRightClickContextMenu(e)},Button.assignMacroId=null,Button.duplicateid=null,Button.elementBelowCursor=null,Button.tempCursor=null,Button.onCtrlKeyDown=function(){var e=getObj(Button.elementBelowCursor);if(void 0!=e&&null!=e&&!Button[e.id].isInEditMode){var t=ole.getObjectPermissions(e.id,["isDraggable","isResizable"]);ole(e.id).isEnabled&&(t.isDraggable||t.isResizable)&&(e.className+=" feButtonCtrlKeyDown")}},Button.onCtrlKeyUp=function(){var e=getObj(Button.elementBelowCursor);void 0==e||null==e||Button[e.id].isInEditMode||(e.className="feButton")},Button.onBeforeDrag=function(){isUndefined(Button.tempEl)||(Button.tempEl.className="feButton",Button.tempEl=void 0)},Button.onObjectSwitch=function(e){ole(e).hideContextMenu(),Button.closeActionBarMenus(e)},Button.onBeforeLoadActionBar=function(e){Button[e].switchState(Button[e].isMacroAssigned)},Button.onFocusLayerMouseDown=function(){null==Button.elementInEditMode||isUndefined(Button.elementInEditMode)||(ole(Button.elementInEditMode.id).resetActionBarState(),Button.elementInEditMode.switchModes(!1))},Button.ondoubleclick=function(e){var t=getObj("feButtonWidthCalculator");t.innerHTML=ZSEC.Encoder.encodeForHTML(Button[e].textElement.value),ole(e).setWidth(t.offsetWidth+20)._setSelectLayer(),Button.resize(e,ole(e).width,ole(e).height)},Button.onClick=function(e,t){var e,o,n=!1;if(Button[t.id].isInEditMode)Button[t.id].isInEditMode&&(browser_ie?(e=window.event,mouseEventVal=e.button,o=e.srcElement):browser_nn6&&(mouseEventVal=e.which,o=e.target),"INPUT"!=o.tagName&&Button[t.id].switchModes(!0));else if("undefined"!=typeof Button[t.id]&&null!=Button[t.id]){n=window.event?window.event.ctrlKey:e.ctrlKey||2==e.modifiers||3==e.modifiers||e.modifiers>5;var s=!1;!READ_WRITE||isReadOnlyViewMode||"undefined"==typeof Button[t.id].moduleName||""==Button[t.id].moduleName||"null"==Button[t.id].moduleName||!OLE[t.id].isEnabled||jsTRASH_VIEW||isErrorDoc||(runmacro(Button[t.id].moduleName,Button[t.id].macroName,Button[t.id].id,void 0,void 0,void 0,void 0,void 0,!0),s=!0);var i=ole.getObjectPermissions(t.id,["isDraggable","isResizable"]);s||i.isDraggable||i.isResizable||(t.className="feButton")}stopEvt(e)},Button.onMouseDown=function(e,t){var o,e,n;o=window.event?window.event.ctrlKey:e.ctrlKey||2==e.modifiers||3==e.modifiers||e.modifiers>5;var s;browser_ie?(e=window.event,s=e.button,n=e.srcElement):browser_nn6&&(s=e.which,n=e.target);var i=e.metaKey;if(!ole(t.id).isExposed&&((o||i)&&(ole(t.id)._setSelectLayer().positionActionBar(!0),Button.tempEl=t,ole.startDrag(e,!0),t.className="feButton",stopEvt(e)),!o&&1==s)){var a=ole.getObjectPermissions(t.id,["isDraggable","isResizable"]);(Button[t.id].isMacroAssigned||!a.isDraggable&&!a.isResizable)&&(t.className="feButtonMouseDown")}},Button.removeVisuals=function(e){OLE[e]&&(ole(e).isEnabled||(ole(e).el.getElementsByTagName("span")[0].style.display="none",ole(e).el.getElementsByTagName("span")[1].style.opacity=1,browser_ie&&(ole(e).el.getElementsByTagName("span")[1].style.filter="alpha(opacity=100)"),ole(e).setWidth(ole(e).width-16).enable().el.style.cursor="",ole(e).el.className="feButton",Button[e].isExecuting=!1))},Button.visualiseMacroExecution=function(e){ole(e).isEnabled&&(ole(e).el.getElementsByTagName("span")[0].style.display="",browser_ie&&(ole(e).el.getElementsByTagName("span")[1].style.filter="alpha(opacity=20)"),ole(e).disable().setWidth(ole(e).width+16).el.style.cursor="default",Button[e].isExecuting=!0)},Button.onObjMouseOver=function(e){Button.elementBelowCursor=e,Button[e].isMacroAssigned&&!Button[e].isInEditMode&&OLE[e].isEnabled&&(ole(e).el.className="feButton feButtonMouseOver",ole(e).el.style.direction="ltr")},Button.onMouseOut=function(e){var t=Button[e];t.isMacroAssigned&&!t.isExecuting&&(ole(e).el.className="feButton"),Button.elementBelowCursor=null},Button.editMacro=function(e){showMacroEditorDialog(Button(e).moduleName,Button(e).macroName),ole(e).resetActionBarState()},Button.prevKeyCode,Button.sendInfoToServer=function(e){var t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),actionManager.addRequest(t)},Button.handleSelectedObjects=function(e){ole.currObj==OLE[e]?ole(e)._setSelectLayer().positionActionBar(!0):ole.currFocusObj==OLE[e]&&ole(e).setFocusLayer()},Button.addButton=function(e,t){var o=85,n=25,s=Math.round((sheet.offsetHeight-n)/2+getSheetScrollTop()),i=Math.round((sheet.offsetWidth-o)/2+getNormalizedScrollLeft()),a=ole.getObjectsByPositionXYRange("button",i,s,i+50,s+20),l=a?a.length:0;l>0&&(i+=5*l,l%2&&(s+=12));var a=ole.getObjectsByPositionXYRange("button",i,s,i+50,s+20),l=a?a.length:0;l>0&&(i+=5*l,l%2&&(s+=12)),e||(e=!1),t||(t=CURRSHEETNAME),t=WorkSheets.getSheetCodeFromName(t);var r=new RequestParameters(ActionConstants.CTRL_COMP_ADD);r.setParameters(t,i,s,25,85,"dummy1",null,null,null,null),Button.sendInfoToServer(r)},Button.setProps=function(e,t){var o=getObj(e);o.className="feButton feButtonCtrlKeyDown",o.style.display="",o.style.position="absolute",o.style.height=t.ht+"px",o.style[isRTL?"right":"left"]=t.left+"px",o.style.width=t.wd+"px",o.style.top=t.top+"px",o.style.direction="ltr"},Button.onSync=function(e,t){Button[e]=Button[t],Button[e].id=Button[e].el.id=e,Button[e].Label=getObj(e).getElementsByTagName("TD")[4],Button[e].editableLabel=getObj(e).getElementsByTagName("TD")[5],Button[e].textElement=ole(e).el.getElementsByTagName("input")[0],Button[e].textElement.onkeydown=function(t){Button(e).setCaption(t)},Button[e].setContextMenu(),Button[t]=null;var o=CURRSHEETNAME,n=ole(Button[e].id);Button.resize(Button[e].id,n.width,n.height,!1,o)},Button.create=function(e){var t=e.id;Button.init(t,e,!0),Button(t).switchModes(!1).checkMacroAssigned(e)},Button.remove=function(e,t,o){Button.closeActionBarMenus(e),t||(t=!1),o||(o=CURRSHEETNAME),o=WorkSheets.getSheetCodeFromName(o);var n=new RequestParameters(ActionConstants.CTRL_COMP_DELETE);n.setParameters(o,e),Button.sendInfoToServer(n)},Button.clone=function(e,t,o,n,s,i,a,l,r){l||(l=!1),r||(r=CURRSHEETNAME);var u="ACTION=clone&NAME="+this.id+"&CAPTION="+encodeURIComponent(Button(a).caption)+"&HEIGHT="+i+"&WIDTH="+s+"&dummyId="+t+"&afterRTC="+l+"&CLONETYPE="+e+"&SHEETNAME="+encodeURIComponent(r);3==e&&(getObj(t).className=Button[a].isMacroAssigned?"feButton":"feButton feButtonCtrlKeyDown"),Button(a).isMacroAssigned&&(u+="&FUNCTION="+Button(a).moduleName+"."+Button(a).macroName),2!=e&&(u+="&LEFT="+o+"&TOP="+n),Button[t]=new _Button(t),Button(a).isMacroAssigned&&(Button[t].isMacroAssigned=!0,Button[t].setMacroName(Button(a).moduleName,Button(a).macroName),ole(t).setDesignMode(!1)),Button[t].caption=Button(a).caption,ole(Button[t].setContextMenu().id)._setSelectLayer().positionActionBar(),r=WorkSheets.getSheetCodeFromName(r);var d=new RequestParameters(ActionConstants.CTRL_COMP_CLONE);"undefined"!=typeof Button(a).moduleName?d.setParameters(r,o,n,i,s,t,this.id,Button(a).caption,Button(a).moduleName+"."+Button(a).macroName,e):d.setParameters(r,o,n,i,s,t,this.id,Button(a).caption,".",e),Button.sendInfoToServer(d)},Button.move=function(e,t,o,n,s){n||(n=!1),s||(s=CURRSHEETNAME),OLE[e]&&(ole(e).sCol=findColInXPos(t),ole(e).sRow=findRowInYPos(o),ole(e).sRowDiff=o-getRowTop(ole(e).sRow),ole(e).sColDiff=t-getColLeft(ole(e).sCol));var i="ACTION=move&TOP="+o+"&LEFT="+t+"&NAME="+e;n||(i+="&HEIGHT="+ole(e).height+"&WIDTH="+ole(e).width),s=WorkSheets.getSheetCodeFromName(s);var a=new RequestParameters(ActionConstants.CTRL_COMP_MOVE);a.setParameters(s,t,o,ole(e).height,ole(e).width,null,e,null,null,null),Button.sendInfoToServer(a)},Button.resize=function(e,t,o,n,s){n||(n=!1),s||(s=CURRSHEETNAME),OLE[e]&&(ole(e).sCol=findColInXPos(ole(e)[isRTL?"right":"left"]),ole(e).sRow=findRowInYPos(ole(e).top),ole(e).sRowDiff=ole(e).top-getRowTop(ole(e).sRow),ole(e).sColDiff=ole(e)[isRTL?"right":"left"]-getColLeft(ole(e).sCol)),s=WorkSheets.getSheetCodeFromName(s);var i=new RequestParameters(ActionConstants.CTRL_COMP_RESIZE);i.setParameters(s,ole(e)[isRTL?"right":"left"],ole(e).top,o,t,null,e,null,null,null),Button.sendInfoToServer(i)},Button.sendAssignedMacro=function(e,t,o,n){o||(o=!1),n||(n=CURRSHEETNAME),n=WorkSheets.getSheetCodeFromName(n);var s=new RequestParameters(ActionConstants.CTRL_COMP_ASSIGNMACRO);s.setParameters(n,e,t),Button.sendInfoToServer(s)},Button.onmousedownOutside=function(e){Button(e).switchModes(!1).setTextInLabel(),ole(e).resetActionBarState(),Button.assignMacroId=e,Button.prevObjId=e},Button.onSelectLayerMouseDown=function(e,t){if(browser_ie){t=window.event;var o=t.srcElement}else if(browser_nn6)var o=t.target;"textCursor"==o.className?Button.editLabel(e,!1):(Button(e).switchModes(!1).setTextInLabel(),ole(e).resetActionBarState())},Button.closeActionBarMenus=function(e){OLE[e]&&ole(e).hideContextMenu()},Button.onBeforeResize=function(e){return Button(e).switchModes(!1).setTextInLabel(),ole(e).resetActionBarState(),Button.closeActionBarMenus(e),this},Button.getOffsetOnClone=function(e){var t=10*e.cloneCountSinceLastDragOrResize;return t},Button.showMoreActionsMenu=function(){var e=[],t=parseInt(10*ole.currObj.cloneCountSinceLastDragOrResize+ole.currObj.width+10),o=parseInt(10*ole.currObj.cloneCountSinceLastDragOrResize+ole.currObj.height+10);e.push({data:"{label:'"+jsMsg.Clone+"', appData:{dynamic:true, callback:'ole.currObj.clone', arg: '1,"+t+","+o+"'}}"}),e.push({data:"{label:'"+jsMsg.Delete+"', appData:{dynamic:true, callback: 'ole.remove', arg:'"+ole.getCurrObj().id+",true'}}"});var n={target:$("#button_actionBar_moreActions"),clearcache:!0,menuoptions:{type:"text_only"}};sheetMenu.showMenu("buttonMoreMenu",e,n)},Button.showManageMacros=function(e){Button.isMacroToBeAssigned=!0,Button.detailsToBeAssigned=ole.currObj.id,showManageMacros(e)},Button.clearMacroAllocationDetails=function(){Button.isMacroToBeAssigned=!1,Button.detailsToBeAssigned=null},Button.editLabel=function(e,t){if(Button.closeActionBarMenus(e),t){var o=85,n=25;ole.setAsCurrObj(e).setWidth(o).setHeight(n)}sheetMenu.hideOpenedMenu(),Button[e].switchModes(!0,t)},Button.showAssignMacroMenu=function(){Button(ole.currObj.id).switchModes(!1);var e=[];e.push({id:"macroAssingext",data:"{label:'"+jsMsg["Button.AssignExistingMacro"]+"...', appData:{dynamic:true, callback: 'Button.showMacroList', arg:'"+ole.getCurrObj().id+"'}}"}),e.push({id:"macroAssignnew",data:"{submenu : '#assignmacrooptions', label:'"+jsMsg["Button.AssignNewMacro"]+"', appData:{ type : 'change'}}"});var t={target:$("#button_actionBar_assignMacro"),clearcache:!0,menuoptions:{type:"text_only"}};sheetMenu.showMenu("assignMacroMenu",e,t),$("#macroAssingext").enable(),$("#macroAssignnew").enable(),$("#macrowritebt").enable(),$("#macrorecordbt").enable(),RECORDINGMACRO&&($("#macroAssingext").disable(),$("#macroAssignnew").disable(),$("#macrowritebt").disable(),$("#macrorecordbt").disable())},Button.showChangeMacroMenu=function(){Button(ole.currObj.id).switchModes(!1);var e=[];e.push({id:"macroChangeext",data:"{label:'"+jsMsg["Button.AssignExistingMacro"]+"...', appData:{dynamic:true, callback: 'Button.showMacroList', arg:'"+ole.getCurrObj().id+"'}}"}),e.push({id:"macroChangenew",data:"{submenu : '#assignmacrooptions', label:'"+jsMsg["Button.AssignNewMacro"]+"', appData:{ type : 'change'}}"});var t={target:$("#button_actionBar_changeMacro"),clearcache:!0,menuoptions:{type:"text_only"}};sheetMenu.showMenu("changeMacroMenu",e,t),$("#macroChangeext").enable(),$("#macroChangenew").enable(),$("#macrowritebt").enable(),$("#macrorecordbt").enable(),RECORDINGMACRO&&($("#macroChangeext").disable(),$("#macroChangenew").disable(),$("#macrowritebt").disable(),$("#macrorecordbt").disable())},Button.showMacroList=function(e){var t=getCurrentSelectionRange();Button.detailsToBeAssigned=e,Button.isMacroToBeAssigned=!0;var o=new RequestParameters(ActionConstants.JSP_ASSIGN_MACRO);o.setParameters(WorkSheets.getAssociatedActiveSheetName(),t.startRow,t.startCol,t.endRow,t.endCol);var n={width:400,title:jsMsg["Button.ActionBar.AssignMacro"],close:function(){Button.macroListOnLoad()}},s=o.getURL()+"?"+o.getParametersAsString();sheetdialog.open("assignMacroDialog",n,assignMacroCallback,void 0,s)},Button.macroListOnLoad=function(){positionDialog(),"undefined"!=typeof noofmacros&&0==noofmacros?getObj("noMacrosDiv")&&(getObj("noMacrosDiv").style.display="",getObj("macroExistDiv").style.display="none",getObj("assignMacroOkButton").style.display="none",getObj("feButtonDlgBoxHsep").style.display="none"):getObj("noMacrosDiv")&&(getObj("noMacrosDiv").style.display="none",getObj("macroExistDiv").style.display="",getObj("assignMacroOkButton").style.display="")},Button.assignMacro=function(e){var t=getObj("macroListId");return t.options.selectedIndex<0?void showAlertDialog(jsMsg["Button.Alert.AssignMacro"]):(Button(e).sendAssignedMacro(t.options[t.options.selectedIndex].value),void sheetdialog.close())},Button.setPermission=function(){var e=!1,t=!1,o=!1;switch(getViewType()){case"SHARE_VIEW":if(!IS_WHOLE_DOCUMENT_SHARED_IN_READ_WRITE)break;case"NEW_VIEW":case"OPEN_VIEW":ALLOW_TO_WRITE&&(e=!0,t=!0)}ole.setObjectProperties("button",{permissions:{isDraggable:e,isResizable:t,isEditable:o}})},Button.setRightClickContextMenu=function(e){jsVERSION_VIEW||$("#"+e).bind("contextmenu",function(t){ole(e)._setSelectLayer().positionActionBar();var o=getCursorPos(t),n=o.x,s=o.y,i=createButtonContextMenu(),a={target:$(this),position:[n,s],clearcache:!0};sheetMenu.showMenu("buttonRMenu",i,a),ole.contextMenuStatus=!0,$("#buttonRMenu").show(),browser_ie&&(t=window.event),stopEvent(t)})},_Button.prototype={checkMacroAssigned:function(e){this.isMacroAssigned="undefined"!=typeof e.macroName&&""!=e.macroName&&"null"!=e.macroName?!0:!1;var t=ole.getObjectPermissions(this.id,["isDraggable","isResizable"]);return this.isMacroAssigned||!t.isDraggable&&!t.isResizable?(ole(this.setMacroName(e.moduleName,e.macroName).id).setDesignMode(!1),Button(this.id).setContextMenu(),ole(this.id).el.className="feButton"):ole(this.id).el.className="feButton feButtonCtrlKeyDown",this},setMacroName:function(e,t){return this.macroName=t,this.moduleName=e,this},setText:function(e){getObj(this.id);return this.caption=e,this.textElement.value=e,this.Label.childNodes[1].innerHTML=ZSEC.Encoder.encodeForHTML(e),this},insert:function(e){var t=e.id;return Button.init(t,e),this},runMacro:function(){return this.id.isExposed&&""!=this.modulename&&"null"!=this.modulename&&runmacro(this.modulename,this.macroname),this},setCaption:function(e){var t,o,n,s,i,a,l,r,u,d,c;if(browser_ie)var e=window.event;if(a=getObj("feButtonWidthCalculator"),d=e.ctrlKey,c=e.altKey,t=0,o=!1,-1!=getPrintableCharacterKeyCodes().indexOf(e.keyCode)&&(8!=e.keyCode||46!=e.keyCode)&&(n=String.fromCharCode(e.keyCode),a.innerHTML=ZSEC.Encoder.encodeForHTML(this.textElement.value)+n),32==e.keyCode?Button.emptySpaceCount++:(8==e.keyCode||46==e.keyCode)&&(a.innerHTML=ZSEC.Encoder.encodeForHTML(this.textElement.value)),8==e.keyCode){var B=this.textElement.value;" "==B.charAt(getCaretPos(this.textElement)-1)&&Button.emptySpaceCount--}if(46==e.keyCode){var B=this.textElement.value;" "==B.charAt(getCaretPos(this.textElement))&&Button.emptySpaceCount--}l=ole(this.id).width,r=l-Button.diffX,u=a.offsetWidth+4*Button.emptySpaceCount,s=getSelectedText(this.textElement),s.length>0&&(d||c||-1!=getPrintableCharacterKeyCodes().indexOf(e.keyCode)&&(a.innerHTML=ZSEC.Encoder.encodeForHTML(s),i=a.offsetWidth,u-=i),o=!0);var h=parseInt(isRTL?ole(this.id).right:ole(this.id).left);return 27==e.keyCode?(this.setText(this.caption).switchModes(!1),ole(this.id).resetActionBarState().displayAssociativeElements("block","none")._setSelectLayer().positionActionBar(),activateCellField(),this):(13==e.keyCode||ole(this.id).isResizedOnce||(u>=r?(ole(this.id).setWidth(l+6+t).setLeft(h-3-t/2),Button.isInitialSizeChangedOnEdit=!0):r-20>u&&ole(this.id).width>85&&Button.isInitialSizeChangedOnEdit&&-1!=getPrintableCharacterKeyCodes().indexOf(e.keyCode)&&(o?ole(this.id).setWidth(u+20+Button.diffX).setLeft(h+parseInt((l-(u+20+Button.diffX))/2)):ole(this.id).setWidth(l-20).setLeft(h+10))),13==e.keyCode||9==e.keyCode?(this.switchModes(!1).setTextInLabel(),ole(this.id).resetActionBarState().displayAssociativeElements("block","none")._setSelectLayer().positionActionBar(),ole.focus(),this):void(a.innerHTML=""))},setTextInLabel:function(e,t){var o=this.textElement,n=o.value;n=n.trim(),e||(e=!1),t||(t=CURRSHEETNAME),this.caption=n,this.Label.childNodes[1].innerHTML=ZSEC.Encoder.encodeForHTML(n),t=WorkSheets.getSheetCodeFromName(t);var s=new RequestParameters(ActionConstants.CTRL_COMP_SETCAPTION);return s.setParameters(t,ole(this.id)[isRTL?"right":"left"],ole(this.id).top,ole(this.id).height,ole(this.id).width,null,this.id,n,null,null),Button.sendInfoToServer(s),this},switchModes:function(e,t){var o=this.textElement;if(e){if(e){t&&(Button.isOnInitialEdit=!0,Button.isInitialSizeChangedOnEdit=!1),Button.elementInEditMode=this,Button.closeActionBarMenus(this.id),Button.emptySpaceCount=0,this.isInEditMode=!0,this.Label.style.display="none",this.editableLabel.style.display="";var n=o.value.length;ole(this.id).expose(),ole(this.id).displayAssociativeElements("none","none","none"),ole(this.id).el.className+=" feButtonEdit";var s=getObj("feButtonWidthCalculator");s.innerHTML=ZSEC.Encoder.encodeForHTML(o.value),ole(this.id).isResizedOnce||(ole(this.id).width>=85&&ole(this.id).width<s.offsetWidth?ole(this.id).setWidth(s.offsetWidth+30):ole(this.id).width<85&&ole(this.id).setWidth(85));var i=ole(this.id),a=findThirdPaneYPos(),l=findSecondPaneXPos();i.top-a<getSheetScrollTop()?setScrollTop(i.top-a):i.top>getSheetScrollTop()+getSheetHeight()&&setScrollTop(i.top+i.height-getSheetHeight()),i[isRTL?"right":"left"]-l<getNormalizedScrollLeft()?setScrollLeft(i[isRTL?"right":"left"]-l):i[isRTL?"right":"left"]>getNormalizedScrollLeft()+getSheetWidth()&&setScrollLeft(i[isRTL?"right":"left"]+i.width-getSheetWidth()),browser_safari||browser_opera||o.focus(),browser_safari||!browser_ie||browser_opera?setCaretPos(o,n):browser_ie&&setCaretPos(o,n)}}else this.Label.style.display="",this.editableLabel.style.display="none",ole(this.id).mask().el.className="feButton",this.isMacroAssigned||(ole(this.id).el.className+=" feButtonCtrlKeyDown"),this.isInEditMode=!1,Button.emptySpaceCount=0,Button.elementInEditMode=null,Button.isOnInitialEdit&&(ole(this.id).setHeight(parseInt(ole(this.id).height)),Button.isOnInitialEdit=!1),Button.isInitialSizeChangedOnEdit=!0;return this},assignMacro:function(e){return""==e.modulename?(this.isMacroAssigned=!1,this.moduleName="",this.macroName="",this):(ole(e.id).setDesignMode(!1).el.className="feButton",this.moduleName=e.modulename,this.macroName=e.macroname,this.isMacroAssigned=!0,this.switchState(!0),this)},switchState:function(e){var t=ole(this.id).getActionBar();return e?t&&(t.getElementsByTagName("TD")[2].style.display="none",t.getElementsByTagName("TD")[3].style.display="",t.getElementsByTagName("TD")[5].style.display="",t.getElementsByTagName("TD")[6].style.display=""):(t.getElementsByTagName("TD")[2].style.display="",t.getElementsByTagName("TD")[3].style.display="none",t.getElementsByTagName("TD")[5].style.display="none",t.getElementsByTagName("TD")[6].style.display="none"),this},sendAssignedMacro:function(e,t,o){t||(t=!1),o||(o=CURRSHEETNAME),o=WorkSheets.getSheetCodeFromName(o);var n=new RequestParameters(ActionConstants.CTRL_COMP_ASSIGNMACRO);return n.setParameters(o,this.id,e),Button.sendInfoToServer(n),this},assignNewMacro:function(e){return""!=e&&(e="Macros."+e),this.sendAssignedMacro(e)},showContextMenu:function(e){if(browser_ie)var e=window.event;return this.isInEditMode||(ole(this.id)._setSelectLayer().showContextMenu(e).positionActionBar(!0).el.className="feButton"),this},setContextMenu:function(){return is_ie?ole(this.id).el.oncontextmenu=function(){Button(this.id).showContextMenu(event)}:ole(this.id).el.setAttribute("oncontextmenu",'Button("'+this.id+'").showContextMenu(event);'),this}},ole.createObjectProperties("button",{focusLayer:"OLEFocusLayer",selectLayer:"OLESelectLayer",menuData:Button.menuData,minHeight:10,minWidth:10,hasOrdering:!1,contextMenu:"OLEButtonContextMenu",cloneOnCTRLDrag:!0,resizeCorners:["E","S","SE"],onResizeStart:Button.onBeforeResize,onResizeEnd:Button.resize,onDragStart:Button.onBeforeDrag,onDragEnd:Button.move,onRemove:Button.remove,onClone:Button.clone,onSync:Button.onSync,onCtrlKeyDown:Button.onCtrlKeyDown,onCtrlKeyUp:Button.onCtrlKeyUp,onmouseover:Button.onObjMouseOver,onmouseout:Button.onMouseOut,onEditLayerClick:Button.onEditLayerClick,onObjectSwitch:Button.onObjectSwitch,ondoubleclick:Button.ondoubleclick,onMove:Button.closeActionBarMenus,onMoveEnd:Button.move,onedit:Button.editLabel,onDocOpen:Button.closeActionBarMenus,onMouseDownOutsideOLEElements:Button.onmousedownOutside,onBeforeLoadActionBar:Button.onBeforeLoadActionBar,onFocusLayerMouseDown:Button.onFocusLayerMouseDown});
function resetSheetPanesDim(){var e=parseInt(sheet.style.width,10)-secondPaneLeft+"px",t=parseInt(sheet.style.height,10)-thirdPaneTop+"px",s=SHEET.dom.freeze;isColsOnlyFreezed?(colHead.style.width=e,s.setSheetPanesDim("COLS")):isRowsOnlyFreezed?(rowHead.style.height=t,s.setSheetPanesDim("ROWS")):isColsAndRowsFreezed&&(colHead.style.width=e,rowHead.style.height=t,s.setSheetPanesDim("ROWS/COLS")),s.setHCueWidth(),s.setVCueHeight()}function findSecondPaneXPos(){return secondPaneLeft}function findThirdPaneYPos(){return thirdPaneTop}function insertImgorChartIsFreezed(e,t,s){e.style.left=parseInt(t,10)+"px",e.style.top=parseInt(s,10)+"px",sheetObjectsPane.appendChild(e)}function getSheetPaneIds(e,t,s,l){var i=[];return s++,l++,FREEZED_ROW>e&&(FREEZED_COL>t&&i.push(1),l>FREEZED_COL&&i.push(2)),s>FREEZED_ROW&&(FREEZED_COL>t&&i.push(3),l>FREEZED_COL&&i.push(0)),i}var ISFREEZED=!1,FREEZED_ROW=0,FREEZED_COL=0,FREEZE_TYPE="",isRowsOnlyFreezed=!1,isColsOnlyFreezed=!1,isColsAndRowsFreezed=!1,firstPaneLeft=0,firstPaneTop=0,secondPaneLeft=0,secondPaneTop=0,thirdPaneLeft=0,thirdPaneTop=0,fourthPaneLeft=0,fourthPaneTop=0,freezedRowsHeight=0,freezedColsWidth=0,vFreezeCue,hFreezeCue,freezeStatus={},submitBeforeFreeze="",visibleRowsInFrozenRange=[],sheetPane1,sheetPane2,sheetPane3,sheetTable1,sheetTable2,sheetTable3,colHead1,colHeadTable1,rowHead1,rowHeadTable1,currTableId,currTableObj,focusDIV1,focusDIV2,focusDIV3,transSPAN1,transSPAN2,transSPAN3,cellRangeFillDIV1,cellRangeFillDIV2,cellRangeFillDIV3,cellRangeFillSPAN1,cellRangeFillSPAN2,cellRangeFillSPAN3,fillSeriesDIV1,fillSeriesDIV2,fillSeriesDIV3,fillSeriesSPAN1,fillSeriesSPAN2,fillSeriesSPAN3,filterIconsPane,filterIconsPane1,filterIconsPane2,filterIconsPane3,dvListIconsPane,dvListIconsPane1,dvListIconsPane2,dvListIconsPane3,availableStartRowAfterFreeze,sheetPaneId="sP",sheetPane1Id="sP1",sheetPane2Id="sP2",sheetPane3Id="sP3",rowHeadId="rH",rowHead1Id="rH1",colHeadId="cH",colHead1Id="cH1",mCCId="mCC",mCC1Id="mCC1",mCC2Id="mCC2",mCC3Id="mCC3",SHEET={};SHEET.dom={},SHEET.freeze=function(e,t,s,l){SHEET.FREEZE.init(e,t,s,l)},SHEET.freezeTopRow=function(){SHEET.FREEZE._freeze(1,0)},SHEET.freezeFirstColumn=function(){SHEET.FREEZE._freeze(0,1)},SHEET.unFreeze=function(e,t){SHEET.FREEZE.release(e,t)},SHEET.FREEZE={init:function(e,t,s,l){if(e=e>5?5:e,t=t>5?5:t,ISFREEZED)return void SHEET.unFreeze();if(!(isWholeSheetSelected()||0===e&&0===t)){var i=ActiveCellInfo;return e=isUndefined(e)?isRowSelected()?i.getActiveRow():i.getStartRow():e,t=isUndefined(t)?isColSelected()?i.getActiveCol():i.getStartCol():t,e=isColSelected()?0:e,e>5||t>5?void showAlertDialog(jsMsg["FreezePanes.limitedupto5rowsand5columns"]):void((e!=FREEZED_ROW||t!=FREEZED_COL)&&this._freeze(e,t,s,l))}},_freeze:function(e,t,s,l){e=e>5?5:e,t=t>5?5:t,"undefined"==typeof l&&(l=!1);var i=function(){$("#freezePanes").zbutton("show","#unfreeze")},n=function(){$("#freezePanes").zbutton("hide","#freeze, #freezetoprow, #freezefirstcol")};return menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"show",callback:i}),menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"hide",callback:n}),isCellEdited()&&(submitBeforeFreeze="FREEZE",0!==cellField.value.indexOf("=")&&submitCell()),isRowInAvailableRowRange(e)?((SAVED||!ALLOW_TO_WRITE||jsREMOTE_SAVE_VIEW)&&(!jsREMOTE_SAVE_VIEW&&!jsREMOTE_VIEW||isDocSaved())||fromOpenFreeze||(freezeStatus.saveBeforeFreeze=!0,freezeStatus.ROW=e,freezeStatus.COL=t,SAVED=!1),void(jsEMBED_VIEW?0===getSheetScrollTop()&&(SHEET.dom.freeze.setCues(e,t),SHEET.FREEZE.react(!0,fromOpenFreeze||l,s,e,t)):(SHEET.dom.freeze.setCues(e,t),SHEET.FREEZE.react(!0,fromOpenFreeze||l,s,e,t)))):(updateTileCallbackInfo.isCallbackAvailable=!0,updateTileCallbackInfo.actionDetails={action:"FREEZE",callbackMethod:SHEET.FREEZE._freeze,freezeeRow:e,freezeeCol:t,afterRTC:s,jsOnly:l},scrollRowIntoView(0),!1)},release:function(e,t,s){if(0!==FREEZED_ROW||0!==FREEZED_COL){"undefined"==typeof t&&(t=!1),isCellEdited()&&(submitBeforeFreeze="true"==e?"AFTERRTCUNFREEZE":"UNFREEZE",submitCell());var l=function(){$("#freezePanes").zbutton("hide","#unfreeze")},i=function(){$("#freezePanes").zbutton("show","#freeze, #freezetoprow, #freezefirstcol")};menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"hide",callback:l}),menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"show",callback:i}),this.react(!1,t,e,void 0,void 0,s)}},react:function(e,t,s,l,i,n){if("undefined"==typeof s&&(s="false"),t)this.customizeDom(l,i,e,!0),this.callBack(e,l,i,!0,n),fromOpenFreeze=!1;else{var o,a=new AjaxRequest;e?(o=new RequestParameters(ActionConstants.FREEZE_PANES),o.setParameters(WorkSheets.getAssociatedActiveSheetName(),l,i,l,i)):(o=new RequestParameters(ActionConstants.UNFREEZE_PANES),o.setParameters(WorkSheets.getAssociatedActiveSheetName())),a.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(a)}},customizeDom:function(e,t,s,l){var i=SHEET.dom.freeze;if(s){var n="";n=0==e?"COLS":0==t?"ROWS":"ROWS/COLS",e>0&&i.splitRowHead(e),t>0&&i.splitColHead(t),userPresence.handleFreeze(n,e,t),i.splitSheetPanes(n,e,t),l&&i.constructTilesInSheetTables(e,t),i.setSheetPanesDim(n),i.showSheetPanes(n)}else i.moveCellsToTableTiles(),i.mergeSheetPanes(),i.hideSheetPanes(),i.resetSheetPaneDim()},callBack:function(e,t,s,l,i){if(e)this.setVars(t,s),restrictTextSelection(sheetTable1),restrictTextSelection(sheetTable2),restrictTextSelection(sheetTable3),ProtectedRanges.getObject().onFreeze(),isCellRange()&&showTransSpan();else{this.resetVariables(),ProtectedRanges.getObject().onUnfreeze();var n=getAvailableStartRow();n>ROWS_PER_TILE-1||getSheetScrollTop()>0||(void 0!=i&&1==i||void 0==i)&&focusCell(currRow,currCol)}appEvent.trigger("cmtHgltAfterFreeze")},resetVariables:function(){ISFREEZED=!1,FREEZED_ROW=0,FREEZED_COL=0,isRowsOnlyFreezed=!1,isColsOnlyFreezed=!1,isColsAndRowsFreezed=!1,firstPaneLeft=0,firstPaneTop=0,secondPaneLeft=0,secondPaneTop=0,thirdPaneLeft=0,thirdPaneTop=0,fourthPaneLeft=0,fourthPaneTop=0,freezedRowsHeight=0,freezedColsWidth=0,hideElement(vFreezeCue),hideElement(hFreezeCue),isSheetFreezed=!1,persistedFreezedRow=0,persistedFreezedCol=0,frozenRows=[],TOOLBARS.initViewToolbar()},setVars:function(e,t){ISFREEZED=!0,FREEZED_ROW=e,FREEZED_COL=t,0===e?isColsOnlyFreezed=!0:0===t?isRowsOnlyFreezed=!0:isColsAndRowsFreezed=!0;var s=freezedRowsHeight=getRowTop(e),l=freezedColsWidth=getColLeft(t);firstPaneLeft=firstPaneTop=secondPaneTop=thirdPaneLeft=0,secondPaneLeft=fourthPaneLeft=l,thirdPaneTop=fourthPaneTop=s,setScrollTop(sheetScrollInfo.scrollTop),setScrollLeft(sheetScrollInfo.scrollLeft)},getType:function(){return 0===FREEZED_ROW?"COLS":0===FREEZED_COL?"ROWS":"ROWS/COLS"},getFreezedRowsHeight:function(){return isRowsOnlyFreezed||isColsAndRowsFreezed?freezedRowsHeight=parseInt(sheetPane1.style.height,10):0},getFreezedColsWidth:function(){return isColsOnlyFreezed||isColsAndRowsFreezed?freezedColsWidth=parseInt(sheetPane1.style.width,10):0},reloadSheetPanes:function(){var e=SHEET.FREEZE;e.setVars(FREEZED_ROW,FREEZED_COL);var t=e.getType(),s=SHEET.dom.freeze;s.splitSheetPanes(t),s.setSheetPanesDim(t),s.setRowHeadAndTableForReload()}},SHEET.dom.freeze={constructTilesInSheetTables:function(e,t){for(var s,l=(getDocFragment(),getDocFragment()),i=getDocFragment(),n=getDocFragment(),o=TileUtil.getMarkup(),a=Row.getAvailableRows(),r=Row.dom.getCellsInRows(a),h=o.cloneNode("false"),d=o.cloneNode("false"),p=a.length,f=Row.getAvailableRowsInFrozenRange(e),c=f.length,g=f[c-1],y=a[c],T=getRowTop(0),P=0;P<f.length;P++)sheetTable.removeChild(sheetTable.childNodes[0]);for(var I=0;p>I;I++){var R=a[I],E=isTiledRow(R),L=r[I],u=L.length,w=getRowTop(R),C=w-T;if(g>=R){var h=o.cloneNode("false"),d=o.cloneNode("false");t&&(h.style.top=C+"px",h.style.height=getRowHeight(R)+"px"),d.style.top=C+"px",d.style.height=getRowHeight(R)+"px"}for(var m=0;u>m;m++){var H=L[m],D=getColLeft(m);if(g>=R)t>m?(C=0,h.appendChild(H),H.style[isRTL?"right":"left"]=D+"px",g>=R&&m===t-1&&l.appendChild(h)):(m==t&&0!==t&&(h.style.width=D+"px"),d.appendChild(H),C=0,H.style.top=C+"px",H.style[isRTL?"right":"left"]=D+"px",g>=R&&m==u-1&&i.appendChild(d),m==u-1&&(d.style.width=D+getColWidth(u-1)+"px"));else if(t>m)0!==m||R!=y&&!E||(T=w,s=TileUtil.getMarkup(),s.style.top=T+"px",s.style.height=getRowHeight(R)+"px",n.appendChild(s)),s.appendChild(H),H.style[isRTL?"right":"left"]=D+"px";else if(m==t&&0!==t&&(s.style.width=D+"px"),m==t&&R==y){T=w;var b=getTile(0,"sT");b.style.top=w+"px"}}}sheetTable1.appendChild(l),sheetTable2.appendChild(i),sheetTable3.appendChild(n)},moveCellsToTableTiles:function(){{var e,t,s=FREEZED_COL,l=ROWS_PER_TILE,i=Row.getAvailableRows(),n=Row.dom.getCellsInRows(i),o=(getDocFragment(),i.length),a=sheetTable.childNodes,r=0,h=getDocFragment(),d=Row.getAvailableRowsInFrozenRange(),p=0,f=0,c=0;i[l-1]}d&&d.length?p=d.length:c=f=i[0];var g=0;i[0]<p&&(g=p);for(var y=0;o>y;y++){var T=i[y],P=n[y],I=P.length,R=getRowTop(T),E=TileUtil.getMarkup(),L=E.cloneNode("false");0==getAvailableStartRow()&&y==p&&(sheetTable.insertBefore(h,sheetTable.childNodes[0]),a=sheetTable.childNodes),i[y]>=FREEZED_ROW&&(e=a[g],r=R,e.style.top=r+"px",e.style[isRTL?"right":"left"]="0px",g++),T>=FREEZED_ROW&&(t=getDocFragment()),r=R;for(var u=0;I>u;u++){var w=P[u],C=getColLeft(u),m=w.style;m.dir=C+"px",i[y]<FREEZED_ROW?(0===u&&(L.style.top=getRowTop(T)+"px",L.style.height=getRowHeight(T)+"px",L.style[isRTL?"right":"left"]="0px",L.style.width=getColLeft(I)+"px",h.appendChild(L)),L.appendChild(w)):s>u?t.appendChild(w):u==s&&e.insertBefore(t,e.childNodes[0])}}},splitSheetPanes:function(e,t,s){var l=secondPaneLeft,i=l+"px",n=-1*l+"px",o=thirdPaneTop,a=o+"px",r=-1*o+"px",h=sheetTable.style,d=sheetTable1.style,p=sheetTable2.style,f=sheetTable3.style,c=sheetPane.style,g=sheetPane1.style,y=sheetPane2.style,T=sheetPane3.style,P=getObj(mCCId),I=focusDIV.style;switch(appEvent.trigger("Sheet.Freeze",[{type:e,row:t,col:s,top:o,left:l}]),e){case"ROWS":getObj(mCC2Id).innerHTML=P.innerHTML,Merge.bindDOMObjcts(sheetPane2Id),h.top=r,p.width=h.width,p.height=h.height,isRTL?(y.right=y.top="0px",c.right="0px",c.top=a,focusDIV.style.marginTop=r,focusDIV2.style.top=I.top,focusDIV2.style.right=I.right,focusDIV2.style.height=I.height,focusDIV2.style.width=I.width,fillSeriesDIV.style.marginTop=r,cellRangeFillDIV.style.marginTop=r,P.style.marginTop=r,sheetObjectsPane.style.top=r,filterIconsPane.style.top=r,filterIconsPane2.style.right=n,dvListIconsPane.style.top=r,dvListIconsPane2.style.right=n):(y.left=y.top="0px",c.left="0px",c.top=a,focusDIV.style.marginTop=r,focusDIV2.style.top=I.top,focusDIV2.style.left=I.left,focusDIV2.style.height=I.height,focusDIV2.style.width=I.width,fillSeriesDIV.style.marginTop=r,cellRangeFillDIV.style.marginTop=r,P.style.marginTop=r,sheetObjectsPane.style.top=r,filterIconsPane.style.top=r,filterIconsPane2.style.left=n,dvListIconsPane.style.top=r,dvListIconsPane2.style.left=n);break;case"COLS":getObj(mCC3Id).innerHTML=P.innerHTML,Merge.bindDOMObjcts(sheetPane3Id),h[isRTL?"right":"left"]=n,f.width=h.width,f.height=h.height,T[isRTL?"right":"left"]=T.top="0px",c[isRTL?"right":"left"]=i,c.top="0px",isRTL?(focusDIV.style.marginRight=n,fillSeriesDIV.style.marginRight=n,cellRangeFillDIV.style.marginRight=n,P.style.marginRight=n):(focusDIV.style.marginLeft=n,fillSeriesDIV.style.marginLeft=n,cellRangeFillDIV.style.marginLeft=n,P.style.marginLeft=n),focusDIV3.style.top=I.top,focusDIV3.style[isRTL?"right":"left"]=I[isRTL?"right":"left"],focusDIV3.style.height=I.height,focusDIV3.style.width=I.width,sheetObjectsPane.style[isRTL?"right":"left"]=n,filterIconsPane.style[isRTL?"right":"left"]=n,filterIconsPane3.style.top=r,dvListIconsPane.style[isRTL?"right":"left"]=n,dvListIconsPane3.style.top=r;break;case"ROWS/COLS":var R=P.innerHTML;if(getObj(mCC1Id).innerHTML=R,getObj(mCC2Id).innerHTML=R,getObj(mCC3Id).innerHTML=R,Merge.bindDOMObjcts(sheetPane1Id),Merge.bindDOMObjcts(sheetPane2Id),Merge.bindDOMObjcts(sheetPane3Id),isRTL){p.right=h.right=n,d.right=f.right="0px",d.width=p.width=f.width=h.width,f.height=h.height,d.height=p.height=f.top=h.top=r,g.right=g.top="0px",y.right=i,y.top="0px",T.right="0px",T.top=a,c.right=i,c.top=a;var E=fillSeriesDIV.style,L=cellRangeFillDIV.style;focusDIV2.style.marginRight=I.marginRight=n,focusDIV3.style.marginTop=I.marginTop=r,focusDIV1.style.top=focusDIV3.style.top=focusDIV2.style.top=I.top,focusDIV1.style.right=focusDIV2.style.right=focusDIV3.style.right=I.right,focusDIV1.style.height=focusDIV2.style.height=focusDIV3.style.height=I.height,focusDIV1.style.width=focusDIV2.style.width=focusDIV3.style.width=I.width,fillSeriesDIV2.style.marginRight=E.marginRight=n,fillSeriesDIV3.style.marginTop=E.marginTop=r,cellRangeFillDIV2.style.marginRight=L.marginRight=n,cellRangeFillDIV3.style.marginTop=L.marginTop=r,getObj(mCC2Id).style.marginRight=n,getObj(mCC3Id).style.marginTop=r;var u=P.style;u.marginRight=n,u.marginTop=r;var w=filterIconsPane.style;w.right=n,w.top=r,filterIconsPane1.style.right=filterIconsPane1.style.top="0px",filterIconsPane2.style.right=n,filterIconsPane3.style.top=r;var C=dvListIconsPane.style;C.right=n,C.top=r,dvListIconsPane1.style.right=dvListIconsPane1.style.top="0px",dvListIconsPane2.style.right=n,dvListIconsPane3.style.top=r;var m=sheetObjectsPane.style;m.right=n,m.top=r}else{p.left=h.left=n,d.left=f.left="0px",d.width=p.width=f.width=h.width,f.height=h.height,d.height=p.height=f.top=h.top=r,g.left=g.top="0px",y.left=i,y.top="0px",T.left="0px",T.top=a,c.left=i,c.top=a;var E=fillSeriesDIV.style,L=cellRangeFillDIV.style;focusDIV2.style.marginLeft=I.marginLeft=n,focusDIV3.style.marginTop=I.marginTop=r,focusDIV1.style.top=focusDIV3.style.top=focusDIV2.style.top=I.top,focusDIV1.style.left=focusDIV2.style.left=focusDIV3.style.left=I.left,focusDIV1.style.height=focusDIV2.style.height=focusDIV3.style.height=I.height,focusDIV1.style.width=focusDIV2.style.width=focusDIV3.style.width=I.width,fillSeriesDIV2.style.marginLeft=E.marginLeft=n,fillSeriesDIV3.style.marginTop=E.marginTop=r,cellRangeFillDIV2.style.marginLeft=L.marginLeft=n,cellRangeFillDIV3.style.marginTop=L.marginTop=r,getObj(mCC2Id).style.marginLeft=n,getObj(mCC3Id).style.marginTop=r;var u=P.style;u.marginLeft=n,u.marginTop=r;var w=filterIconsPane.style;w.left=n,w.top=r,filterIconsPane1.style.left=filterIconsPane1.style.top="0px",filterIconsPane2.style.left=n,filterIconsPane3.style.top=r;var C=dvListIconsPane.style;C.left=n,C.top=r,dvListIconsPane1.style.left=dvListIconsPane1.style.top="0px",dvListIconsPane2.style.left=n,dvListIconsPane3.style.top=r;var m=sheetObjectsPane.style;m.left=n,m.top=r}}(Filter.hasFilter||Filter.isPivotFilter)&&Filter.replicateInAllPanes(!0)},setCues:function(e,t){e-1>=0&&(hFreezeCue.style.left="0px",this.setHCuePos(getRowTop(e)-1),this.setHCueWidth()),t-1>=0&&(this.setVCuePos(getColLeft(t)-1),this.setVCueHeight(),vFreezeCue.style.top="0px")},setHCuePos:function(e){hFreezeCue.style.top=e-1+"px"},setVCuePos:function(e){vFreezeCue.style[isRTL?"right":"left"]=e-1+"px"},setHCueWidth:function(){hFreezeCue.style.width=getSheetTableWidth()+"px"},setVCueHeight:function(){vFreezeCue.style.height=getSheetTableHeight()+"px"},splitColHead:function(e){colHeadTable1.innerHTML="";for(var t=0;e>t;t++)colHeadTable1.appendChild(colHeadTable.childNodes[t].cloneNode(!0));var s=getColLeft(e);colHead1.style.width=s+"px",colHeadTable1.style.width=colHeadTable.style.width,colHead.style[isRTL?"right":"left"]=s+"px",colHead.style.width=parseInt(colHead.style.width,10)-s+"px",colHeadTable.style[isRTL?"right":"left"]=-1*s+"px",secondPaneLeft=fourthPaneLeft=s,colHeadTable1.style.width=""},splitRowHead:function(e){rowHeadTable1.innerHTML=rowHeadTable.innerHTML;var t=getRowTop(e);rowHead1.style.height=t+"px",rowHeadTable1.style.height=rowHeadTable.style.height,rowHead.style.top=t+"px",rowHead.style.height=parseInt(rowHead.style.height,10)-t+"px",rowHeadTable.style.top=-1*t+"px",thirdPaneTop=fourthPaneTop=t},mergeSheetPanes:function(){if(isRTL){appEvent.trigger("Sheet.Unfreeze"),(isColsOnlyFreezed||isColsAndRowsFreezed)&&this.mergeColHeads(),(isRowsOnlyFreezed||isColsAndRowsFreezed)&&this.mergeRowHeads(),sheetTable1.innerHTML=sheetTable2.innerHTML=sheetTable3.innerHTML="",sheetTable.style.top=sheetTable.style.right="0px",sheetTable1.style.top=sheetTable1.style.right="0px",sheetTable2.style.top=sheetTable2.style.right="0px",sheetTable3.style.top=sheetTable3.style.right="0px",colHead.style.right=sheetPane.style.right=sheetPane2.style.right=sheetPane3.style.right="0px",rowHead.style.top=sheetPane.style.top=sheetPane2.style.top=sheetPane3.style.top="0px",sheetPane2.scrollLeft=0,sheetPane3.scrollTop=0,colHead.style.width=parseInt(colHead.style.width,10)+secondPaneLeft+"px",rowHead.style.height=parseInt(rowHead.style.height,10)+thirdPaneTop+"px",focusDIV.style.marginRight=fillSeriesDIV.style.marginRight=cellRangeFillDIV.style.marginRight="0px",focusDIV2.style.marginRight=fillSeriesDIV2.style.marginRight=cellRangeFillDIV2.style.marginRight="0px",focusDIV.style.marginTop=fillSeriesDIV.style.marginTop=cellRangeFillDIV.style.marginTop="0px",focusDIV3.style.marginTop=fillSeriesDIV3.style.marginTop=cellRangeFillDIV3.style.marginTop="0px";var e=getObj(mCC1Id),t=getObj(mCC2Id),s=getObj(mCC3Id);mCC.style.marginRight=t.style.marginRight="0px",mCC.style.marginTop=s.style.marginTop="0px",e.innerHTML=t.innerHTML=mCC3Id.innerHTML="",Merge.unBindDOMObjcts(),sheetObjectsPane.style.right=sheetObjectsPane.style.top="",filterIconsPane.style.right=filterIconsPane.style.top="",filterIconsPane1.style.right=filterIconsPane1.style.top="",filterIconsPane2.style.right=filterIconsPane2.style.top="",filterIconsPane3.style.right=filterIconsPane3.style.top="",filterIconsPane2.innerHTML=filterIconsPane3.innerHTML=filterIconsPane1.innerHTML="",dvListIconsPane.style.right=dvListIconsPane.style.top="",dvListIconsPane1.style.right=dvListIconsPane1.style.top="",dvListIconsPane2.style.right=dvListIconsPane2.style.top="",dvListIconsPane3.style.right=dvListIconsPane3.style.top="",dvListIconsPane2.innerHTML=dvListIconsPane3.innerHTML=dvListIconsPane1.innerHTML=""}else{appEvent.trigger("Sheet.Unfreeze"),(isColsOnlyFreezed||isColsAndRowsFreezed)&&this.mergeColHeads(),(isRowsOnlyFreezed||isColsAndRowsFreezed)&&this.mergeRowHeads(),sheetTable1.innerHTML=sheetTable2.innerHTML=sheetTable3.innerHTML="",sheetTable.style.top=sheetTable.style.left="0px",sheetTable1.style.top=sheetTable1.style.left="0px",sheetTable2.style.top=sheetTable2.style.left="0px",sheetTable3.style.top=sheetTable3.style.left="0px",colHead.style.left=sheetPane.style.left=sheetPane2.style.left=sheetPane3.style.left="0px",rowHead.style.top=sheetPane.style.top=sheetPane2.style.top=sheetPane3.style.top="0px",sheetPane2.scrollLeft=0,sheetPane3.scrollTop=0,colHead.style.width=parseInt(colHead.style.width,10)+secondPaneLeft+"px",rowHead.style.height=parseInt(rowHead.style.height,10)+thirdPaneTop+"px",focusDIV.style.marginLeft=fillSeriesDIV.style.marginLeft=cellRangeFillDIV.style.marginLeft="0px",focusDIV2.style.marginLeft=fillSeriesDIV2.style.marginLeft=cellRangeFillDIV2.style.marginLeft="0px",focusDIV.style.marginTop=fillSeriesDIV.style.marginTop=cellRangeFillDIV.style.marginTop="0px",focusDIV3.style.marginTop=fillSeriesDIV3.style.marginTop=cellRangeFillDIV3.style.marginTop="0px";var e=getObj(mCC1Id),t=getObj(mCC2Id),s=getObj(mCC3Id);mCC.style.marginLeft=t.style.marginLeft="0px",mCC.style.marginTop=s.style.marginTop="0px",e.innerHTML=t.innerHTML=mCC3Id.innerHTML="",Merge.unBindDOMObjcts(),sheetObjectsPane.style.left=sheetObjectsPane.style.top="",filterIconsPane.style.left=filterIconsPane.style.top="",filterIconsPane1.style.left=filterIconsPane1.style.top="",filterIconsPane2.style.left=filterIconsPane2.style.top="",filterIconsPane3.style.left=filterIconsPane3.style.top="",filterIconsPane2.innerHTML=filterIconsPane3.innerHTML=filterIconsPane1.innerHTML="",dvListIconsPane.style.left=dvListIconsPane.style.top="",dvListIconsPane1.style.left=dvListIconsPane1.style.top="",dvListIconsPane2.style.left=dvListIconsPane2.style.top="",dvListIconsPane3.style.left=dvListIconsPane3.style.top="",dvListIconsPane2.innerHTML=dvListIconsPane3.innerHTML=dvListIconsPane1.innerHTML=""}userPresence.handleUnFreeze()},mergeColHeads:function(){var e=getColLeft(FREEZED_COL);colHeadTable1.innerHTML="",colHead1.style.width="0px",colHeadTable1.style.width="0px",colHead.style.width=parseInt(colHead.style.width,10)+e+"px",isRTL?(colHead.style.right="0px",colHeadTable.style.right="0px"):(colHead.style.left="0px",colHeadTable.style.left="0px")},mergeRowHeads:function(){var e=getRowTop(FREEZED_ROW);rowHeadTable1.innerHTML="",rowHead1.style.height="0px",rowHeadTable1.style.height="0px",rowHead.style.top="0px",rowHead.style.height=parseInt(rowHead.style.height,10)+e+"px",rowHeadTable.style.top="0px"},setSheetPanesDim:function(e){switch(e){case"ROWS":sheetPane2.style.width=sheet.style.width,sheetPane2.style.height=thirdPaneTop+"px",sheetPane.style.height=parseInt(sheet.style.height,10)-thirdPaneTop+"px";break;case"COLS":sheetPane3.style.width=secondPaneLeft+"px",sheetPane3.style.height=sheetPane.style.height,sheetPane.style.width=parseInt(sheet.style.width,10)-secondPaneLeft+"px";break;case"ROWS/COLS":var t=parseInt(sheet.style.width,10)-secondPaneLeft+"px",s=parseInt(sheet.style.height,10)-thirdPaneTop+"px";sheetPane1.style.width=secondPaneLeft+"px",sheetPane1.style.height=thirdPaneTop+"px",sheetPane2.style.width=t,sheetPane2.style.height=thirdPaneTop+"px",sheetPane3.style.width=secondPaneLeft+"px",sheetPane3.style.height=s,sheetPane.style.width=t,sheetPane.style.height=s}},resetSheetPaneDim:function(){colHead.style.width=sheetPane.style.width=parseInt(sheetPane.style.width,10)+secondPaneLeft+"px",rowHead.style.height=sheetPane.style.height=parseInt(sheetPane.style.height,10)+thirdPaneTop+"px"},setRowHeadAndTableForReload:function(){var e=getRowTop(FREEZED_ROW),t=getSheetHeight();rowHead1.style.height=rowHead.style.top=e+"px",rowHeadTable1.style.height=e+"px",rowHeadTable.style.top=-e+"px",rowHead.style.height=t-e+"px"},showSheetPanes:function(e){"COLS"==e?(colHead1.style.display="",sheetPane3.style.display=""):"ROWS"==e?(rowHead1.style.display="",sheetPane2.style.display=""):(colHead1.style.display="",rowHead1.style.display="",sheetPane1.style.display="",sheetPane2.style.display="",sheetPane3.style.display="")},hideSheetPanes:function(){rowHead1.style.display="none",colHead1.style.display="none",sheetPane1.style.display="none",sheetPane2.style.display="none",sheetPane3.style.display="none"}};
function checkCookieSettings(){var e=new Date;e.setTime(e.getTime()-1),document.cookie="testcookie; expires="+e.toGMTString(),cookieEnabled=navigator.cookieEnabled,document.cookie="testcookie=testcookie",cookieEnabled=-1!=document.cookie.indexOf("testcookie")?!0:!1,cookieEnabled||(handleServerError("ERROR",replaceParams(jsMsg["Banner.Cookie.Disabled.Message"],new Array("<a target='_blank' href='"+jsMsg.ZohoHomeURL+"zoho_faq.html#13'>","</a>")),!0,!1),cookieStatusShown=!0)}function checkGuestViewSettings(){if(jsGUEST_VIEW){var e=iamurlWithServiceURL+encodeURIComponent("?guestId="+encodeURIComponent(guestEncStr)),i="";IS_WHOLE_DOCUMENT_SHARED_IN_READ_WRITE&&(i=replaceParams(jsMsg["GuestView.Banner.SignUp.Info.ForReadWritePermission"],new Array(CURR_DOC_OWNERNAME+"'s","<span class=''>","<a target='_self' href='"+e+"'>","</a>",guestId,"</span>","<strong>","</strong>"))),handleServerError("INFORMATION",i,!0,!0),guestStatusShown=!0}}function checkTrashViewSettings(){jsTRASH_VIEW&&(READ_WRITE=!1,allowSheetSwitch=!0)}function checkPublicViewSettings(){if(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE){var e=getObj("pubEditBtn");if(e&&(e.disabled=!1),READ_WRITE=!1,ALLOW_TO_WRITE=!1,exprField.readOnly=!0,allowSheetSwitch=!0,(isPublished||jsEMBED_VIEW)&&editPublicDoc(!0,!0),!isPublished&&!jsEMBED_VIEW){var i="";if(i=isPublicEditDoc?"PublicView.Banner.OrgEditDocument.Info":"PublicView.Banner.ReadOnly.Info",!isPublicViewDoc){var t=replaceParams(jsMsg[i],new Array("<strong>","</strong>"));showBannerMessage("INFO",t),publicMsgShown=!0}editPublicDoc(!0,!0)}}}function setReadOnlyViewSettings(){jsREMOTE_VIEW||jsTHROWAWAY_VIEW||jsPUBLIC_VIEW||(READ_WRITE=!1,ALLOW_TO_WRITE=!1,exprField.readOnly=!0,allowSheetSwitch=!0,isReadOnlyViewMode=!0,hideBannerMessage())}function documentUtilities(){cookieStatusShown||checkCookieSettings(),guestStatusShown||checkGuestViewSettings(),checkTrashViewSettings(),publicMsgShown||checkPublicViewSettings(),!ALLOW_TO_WRITE&&READ_ONLY_VIEW_MODE&&setReadOnlyViewSettings(),READ_WRITE||$("#fSC").hide(),"true"!=wmsCommErrorStatus||wmsErrorMsgShown||(wmsErrorMsgShown=!0)}function isServerComponentLoaded(){return documentBakeStatus.isBaked()?!0:!1}function initServerCompLoadingActivities(e){e||(TEMP_READ_WRITE=READ_WRITE,READ_WRITE=!1),exprField.readOnly=!0}function serverCompLoadedActivities(e){documentBakeStatus.setRenderBake(!0),e||(READ_WRITE=TEMP_READ_WRITE),unMaskSheet();var i=getObj("waitmsg");null!=i&&(i.style.display="none"),"true"!=wmsCommErrorStatus&&fileToolbarMask&&(fileToolbarMask.style.display="none"),READ_WRITE&&(exprField.readOnly=!1),(jsPUBLIC_VIEW&&!PUBLIC_EDIT_MODE&&!jsEMBED_VIEW||!REMOTE.ISEDITABLE)&&(READ_WRITE=!1)}function editPublicDoc(e,i){if(e&&!PUBLIC_EDIT_MODE)if(i){PUBLIC_EDIT_MODE=!0,READ_WRITE=!0,ALLOW_TO_WRITE=!1,exprField.readOnly=!1,isReadOnlyViewMode=!1,appEvent.trigger("setImagePermission"),setChartPermission();var t=getObj("pubEditBtn");if(t&&(t.disabled=!0,t.className="button-disabled"),!isPublished&&!jsEMBED_VIEW)if(isPublicEditDoc);else{if(allowExport)var s=replaceParams(jsMsg["PublicView.Banner.Interactive.Info.SaveToMyAccount.Enabled"],new Array("<strong>","</strong>"));else var s=replaceParams(jsMsg["PublicView.Banner.Interactive.Info.SaveToMyAccount.Disabled"],new Array("<strong>","</strong>"));showBannerMessage("INFO",s)}showSaveMessage("disable")}else isInOOMode?editPublicDoc(!0,!0):loadDocumentObject(DOCUMENT_ID,DOCUMENT_NAME,CURRENTTIME,CURR_DOC_OWNERNAME,void 0,!0);isPublished||resetWorkSheetDim()}var cookieStatusShown=!1,cookieEnabled=!0,guestStatusShown=!1,publicMsgShown=!1,TEMP_READ_WRITE=!0;
function updateResponseJson(e){var t=parseJSON(e);updateJson(t)}function updateJson(e){var t,n=null,s=!1;if(isUndefined(e.rsid)?isUndefined(e.isActionOwner)||(s=e.isActionOwner):s=e.rsid==WebMessanger.getRawSid(),!isUndefined(e.macroresponse)&&s&&(e.macroresponse.a==ActionConstants.MACRO_INSERT?callBack_insertMacro(JSON.stringify(e.macroresponse),e.macroresponse.macN):e.macroresponse.a==ActionConstants.MACRO_DELETE?callBack_deleteMacro(e.macroresponse):e.macroresponse.a==ActionConstants.MACRO_SAVE?callBack_saveMacro(e.macroresponse):e.macroresponse.a==ActionConstants.MACRO_START_RECORDING?callBack_startRecordMacro(e.macroresponse):e.macroresponse.a==ActionConstants.MACRO_STOP_RECORDING&&callBack_stopRecordMacro(e.macroresponse)),!isUndefined(e.webdatadeleted)&&s&&showWebDataDetails(),s&&!isUndefined(e[JSONConstants.DATAVALIDATION_ERROR])&&e[JSONConstants.DATAVALIDATION_ERROR][JSONConstants.DATAVALIDATION_ISSTOPEDIT]===!0)return void appEvent.trigger("datavalidation.stopError",[e]);if((isUndefined(e[JSONConstants.DATAVALIDATION_ERROR])||e[JSONConstants.DATAVALIDATION_ERROR][JSONConstants.DATAVALIDATION_ISSTOPEDIT]!==!0)&&(hideProgressMessage(),!isUpdateClientFirst||!s||isUndefined(e[JSONConstants.CLIENT_ACTION]))){if(1!=s||isUndefined(e[ActionConstants.UNDOREDOCOUNT])||(setUNDO(e[ActionConstants.UNDOREDOCOUNT].u),setREDO(e[ActionConstants.UNDOREDOCOUNT].r)),!isUndefined(e[JSONConstants.WORKBOOK_LEVEL_ACTION]))for(t=0;t<e[JSONConstants.WORKBOOK_LEVEL_ACTION].length;t++)updateWorkbookLevelAction(e[JSONConstants.WORKBOOK_LEVEL_ACTION][t],s,!isUndefined(e[ActionConstants.SELECT]));if(!isUndefined(e.a)&&(e.a==ActionConstants.IMPORT_INSERT_AS_NEW_SHEETS||e.a==ActionConstants.IMPORT_REPLACE_CURRENTSHEET||e.a==ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET||e.a==ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL)){if(e.a==ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET){var o=e[JSONConstants.WORKBOOK_LEVEL_ACTION][0],a=o[JSONConstants.START_ROW];focusCell(a,0)}appEvent.trigger("import.response")}if(!isUndefined(e[ActionConstants.NAMED_RANGE])){var i=e[ActionConstants.NAMED_RANGE];appEvent.trigger("namedrangechanged",[ActionConstants.NAMED_RANGE,i])}if(!isUndefined(e[ActionConstants.WORKBOOK_ACTION]))for(t=0;t<e[ActionConstants.WORKBOOK_ACTION].length;t++)updateWorkbookActionJson(e[ActionConstants.WORKBOOK_ACTION][t]);if(isUndefined(e[JSONConstants.PROTECTED_RANGES])&&isUndefined(e[JSONConstants.PROTECTED_SHEETS])||ProtectedRanges.getObject().updateResponse(e),1==s&&!isUndefined(e[ActionConstants.DEBUG_MSG]))for(n=[],t=0;t<e[ActionConstants.DEBUG_MSG].length;t++)n.push(e[ActionConstants.DEBUG_MSG][t]);if(1!=s||isUndefined(e[ActionConstants.ENABLE_EVENTS])||handleWarningTab(e[ActionConstants.ENABLE_EVENTS]),1!=e.rt||!isUndefined(e[ActionConstants.SELECT])&&getSheetASN(e[ActionConstants.SELECT])!=CURRSHEETNAME||!isUndefined(e[ActionConstants.FILTER_JSON])&&(isUndefined(e.a)||e.a!=ActionConstants.INSERT_COPY_COLUMN&&e.a!=ActionConstants.INSERT_CUT_COLUMN)){if(!isUndefined(e[ActionConstants.CHART])){var r=e[ActionConstants.CHART];appEvent.trigger("chart.onLoad",[r,s])}}else{e.a==ActionConstants.INSERT_COPY_COLUMN?appEvent.trigger("UpdateDiscussionRanges",[e.sn,!1,!1,e.wla[0].sc,e.wla[0].count]):e.a==ActionConstants.INSERT_COPY_ROW&&appEvent.trigger("UpdateDiscussionRanges",[e.sn,!0,!1,e.wla[0].sr,e.wla[0].count]);var c={};c.isExecuteActionIdNeeded=!0,reloadPage(void 0,!0,c)}if(!isUndefined(e[ActionConstants.RANGE])){for(t=0;t<e[ActionConstants.RANGE].length;t++){var l=e[ActionConstants.RANGE][t];l.a===ActionConstants.INSERT_ROW&&(l.rHt=e[ActionConstants.HEIGHT][CURRSHEETNAME][0].v),updateRangeJson(l,s)}appEvent.trigger("range.update",[e[ActionConstants.RANGE],[e.sn]])}if(e.a==ActionConstants.CHART_COPY_STYLE&&appEvent.trigger("chart.insert.server.copystyles",[e]),e.a==ActionConstants.POST_DOC_LOAD&&checkAndFlipSheet(e),e.a==ActionConstants.SERVERCLIP_PASTE_SHEET||e.a==ActionConstants.IMPORT_INSERT_AS_NEW_SHEETS){appEvent.trigger("copysheet.insert",[e.psn,e.scsasn,s]);var C=e[JSONConstants.PIVOT_DETAILS];if(C)for(var d=0;d<C.length;d++)PivotUtil.createPivotObject(C[d]);if(e.nor){var E=e.nor;for(t=0;t<E.length;t++)appEvent.trigger("namedrangechanged",[ActionConstants.NAMEDRANGE_ADD,E[t]])}}if((!isUndefined(e.ur)||!isUndefined(e.sn)&&CURRSHEETNAME==e.sn||!isUndefined(e.s)&&WorkSheets.getAssociatedActiveSheetName()==e.s)&&1==s&&!isCellEdited()&&!isUndefined(e[ActionConstants.SELECT])){var A=e[ActionConstants.SELECT],S=getSheetASN(A),O=getSheetRange(A),R=O.sr,T=O.er,g=O.sc,N=O.ec;if(CURRSHEETNAME==S){var f=A[JSONConstants.ACTION],v=!0;if(void 0==typeof f||f==ActionConstants.COPY_PASTE||f==ActionConstants.CUT_PASTE){var u=getCellRange(),I=u.startRow,p=u.startCol;(R!=I||g!=p)&&(v=!1)}if(v){var m=A[JSONConstants.FOCUS_TYPE];"cell"==m?focusCell(R,g):"cellRange"==m?focusCellRange(R,g,T,N,void 0,!0):"cols"==m?focusCol(g,N):"rows"==m?focusRow(R,T):"sheet"==m&&focusAllCells()}var _="cell"==m||"cellRange"==m||"rows"==m||"cols"==m,h=isHtmlParserEnabled&&_&&!isRecastAction&&(f==ActionConstants.COPY_PASTE||f==ActionConstants.SYSTEMCLIP_PASTE),L=isFillSeriesRecastEnabled&&_&&!isRecastAction&&e[ActionConstants.FILLSERIES];if(h=h&&"TRANSPOSE"!=ClipRange.getClipObject().pasteType)switch(f){case ActionConstants.COPY_PASTE:showCopyPasteWidget(R,g,T,N,f,e.xaid);var b=ClipRange.getClipObject().pasteType?ClipRange.getClipObject().pasteType:"ALL";updateOption("commonWidget",b);break;case ActionConstants.SYSTEMCLIP_PASTE:if("undefined"!=typeof isHTMLDataPasted&&isHTMLDataPasted){showCopyPasteWidget(R,g,T,N,f,e.xaid);var b="source_format";updateOption("commonWidget",b),isHTMLDataPasted=!1}}else if(L){showCopyPasteWidget(R,g,T,N,ActionConstants.FILLSERIES,e.xaid);var b=fillSeriesType;updateOption("commonWidget",b)}e[ActionConstants.FILLSERIES]&&(T>usedCursRow&&(usedCursRow=T),N>usedCursCol&&(usedCursCol=N))}else Goto.doGoto(S,R,T,g,N,!0);FIND.dialogOpen&&moveDialogBox(S,e[ActionConstants.SELECT].sc)}if(!isUndefined(e.sn)&&CURRSHEETNAME==e.sn||!isUndefined(e.s)&&WorkSheets.getAssociatedActiveSheetName()==e.s){if(appEvent.trigger("RTC",[e,s]),e.a===ActionConstants.READ_FILTER_RANGE&&Filter.updateFilterJson(e),isUndefined(e[ActionConstants.READ_FILTER_RANGE])||Filter.updateFilterJson(e[ActionConstants.READ_FILTER_RANGE]),isUndefined(e[ActionConstants.FILTER_JSON])||Filter.updateFilterJson(e[ActionConstants.FILTER_JSON],s),!isUndefined(e[ActionConstants.CLEARALL])){var D=currCell.className;for(D=replace(D," cC",""),currCell.className=D,t=0;t<e[ActionConstants.CLEARALL].length;t++){var M=e[ActionConstants.CLEARALL][t];isUndefined(M.sr)||(clearAll(M.sr,M.sc,M.er,M.ec,M.ws,M.wd),appEvent.trigger("range.clearAll",[M.sr,M.sc,M.er,M.ec]),updateRangeJson(M,s))}init_format(currCell)}if(isUndefined(e[ActionConstants.DATA_VALIDATION_CLEAR])||appEvent.trigger("cell.datavalidationClear",[e[ActionConstants.DATA_VALIDATION_CLEAR]]),!isUndefined(e[ActionConstants.CLEARSTYLES])){for(t=0;t<e[ActionConstants.CLEARSTYLES].length;t++){var U=e[ActionConstants.CLEARSTYLES][t];if(!isUndefined(U.sr)){var P={doNotSkipCoveredCells:!0};isUndefined(e[ActionConstants.RANGE])||e[ActionConstants.RANGE][0].a!=ActionConstants.INSERT_ROW&&e[ActionConstants.RANGE][0].a!=ActionConstants.DELETE_ROW||(P.doNotSkipCoveredCells=!1),isUndefined(e[ActionConstants.SELECT])||e[ActionConstants.SELECT].a!=ActionConstants.COPY_PASTE||(P.doNotSkipCoveredCells=!1),clearFormatting(U.sr,U.sc,U.er,U.ec,P)}}init_format(currCell)}if(!isUndefined(e[ActionConstants.CELL])&&0!==e[ActionConstants.CELL].length){var k=FadeCell.elemsarrIndex;for(FadeCell.elemsarrIndex++,FadeCell.elemsarr[k]=[],t=0;t<e[ActionConstants.CELL].length;t++)(isUndefined(e[ActionConstants.CELL][t].sn)||CURRSHEETNAME===e[ActionConstants.CELL][t].sn)&&(isUndefined(e[ActionConstants.CELL][t].r)?updateRangeDataJson(e[ActionConstants.CELL][t],k):updateCellData(e[ActionConstants.CELL][t].r,e[ActionConstants.CELL][t].c,e[ActionConstants.CELL][t],k));if(appEvent.trigger("range.updatedata"),0!==FadeCell.elemsarr[k].length){var F=7;FadeCell.fadeCells(F,k)}else FadeCell.elemsarr[k]=null,k<FadeCell.elemsarrIndex&&(FadeCell.elemsarrIndex=k)}if(!isUndefined(e[ActionConstants.RANGE_STYLE])){for(t=0;t<e[ActionConstants.RANGE_STYLE].length;t++)isUndefined(e[ActionConstants.RANGE_STYLE][t].r)?updateRangeStyleJson(e[ActionConstants.RANGE_STYLE][t]):updateCellStyle(e[ActionConstants.RANGE_STYLE][t].r,e[ActionConstants.RANGE_STYLE][t].c,e[ActionConstants.RANGE_STYLE][t]);init_format(currCell)}if(!isUndefined(e[ActionConstants.RANGE_STYLE])){for(t=0;t<e[ActionConstants.RANGE_STYLE].length;t++)isUndefined(e[ActionConstants.RANGE_STYLE][t].r)?updateRangeStyleJson(e[ActionConstants.RANGE_STYLE][t]):updateCellStyle(e[ActionConstants.RANGE_STYLE][t].r,e[ActionConstants.RANGE_STYLE][t].c,e[ActionConstants.RANGE_STYLE][t]);init_format(currCell)}if(!isUndefined(e[ActionConstants.BORDERS])){var H=!0,J=!isUndefined(e.a)&&e.a===ActionConstants.BORDERS;if(J){var P={doNotSkipCoveredCells:!0};clearBorder(e.sr,e.sc,e.er,e.ec,P)}for(isHtmlParserEnabled&&isRecastAction&&clearBorder(e.sr,e.sc,e.er,e.ec,void 0),t=0;t<e[ActionConstants.BORDERS].length;t++)isUndefined(e[ActionConstants.BORDERS][t].r)?updateRangeBorderJson(e[ActionConstants.BORDERS][t],H):updateCellBorder(e[ActionConstants.BORDERS][t].r,e[ActionConstants.BORDERS][t].c,e[ActionConstants.BORDERS][t],H)}if(isUndefined(e[ActionConstants.WIDTH])||(updateWidthJson(e[ActionConstants.WIDTH]),focusSheet()),!isUndefined(e.ARRAYDETAILS)){var y=e.ARRAYDETAILS;arrayDetails="string"==typeof y&&"EMPTY"===y?[]:y}if(e[ActionConstants.CTRL_COMP]&&loadControlComponent(e[ActionConstants.CTRL_COMP]),!isUndefined(e.frange)){var O=e.frange,B=WorkSheets.getSheetCodeFromName(e.sn);setTimeout(function(){FormObj.create(B,O)},1e3)}}if(appEvent.trigger("datavalidation.infoForCollobarators",[e,s]),(!isUndefined(e.sn)&&CURRSHEETNAME===e.sn||!isUndefined(e.s)&&WorkSheets.getAssociatedActiveSheetName()===e.s)&&(isUndefined(e[ActionConstants.DATA_VALIDATION_READRANGE])||appEvent.trigger("cell.datavalidationApply",[e[ActionConstants.DATA_VALIDATION_READRANGE]])),isUndefined(e[JSONConstants.DATAVALIDATION_ERROR])||Boolean(e[JSONConstants.DATAVALIDATION_ERROR][JSONConstants.DATAVALIDATION_ISSTOPEDIT])!==!1||appEvent.trigger("datavalidation.infoError",[e]),isUndefined(e.invalidCells)||DataValidation.highlightCells(e.invalidCells),!isUndefined(e[ActionConstants.HEIGHT])&&!isUndefined(e[ActionConstants.HEIGHT][CURRSHEETNAME])){var w=null,x=!0,W=!0;e.rt&&(w={},w.isExecuteActionIdNeeded=!0),isUndefined(e[ActionConstants.RANGE])&&ole.getObjects("button").length>0&&(W=!1,ole.getObjects("button").length>0&&(x=!1)),setRowsHeightAndModifyDOM(e[ActionConstants.HEIGHT][CURRSHEETNAME],e.rt,w,s,x,W),focusSheet()}if(1==s&&!isUndefined(e[ActionConstants.DEBUG_MSG]))for(t=0;t<e[ActionConstants.DEBUG_MSG].length;t++)msgboxArray.push(e[ActionConstants.DEBUG_MSG]);if(1==s&&e[ActionConstants.REPEAT_ACTION]&&repeat.setLastAction(e[ActionConstants.REPEAT_ACTION]),e[JSONConstants.VIEW_PORT]){var G=e[JSONConstants.VIEW_PORT],V=Math.max(getAvailableStartRow(),FREEZED_ROW),j=getAvailableEndRow(),Y=G[JSONConstants.MODIFIED_RANGE_START_ROW],K=G[JSONConstants.MODIFIED_RANGE_END_ROW],z=G[JSONConstants.START_ROW],Z=G[JSONConstants.END_ROW];(z>V&&z>Y||j>Z&&K>Z&&G[JSONConstants.ASSOCIATED_SHEET_NAME]==WorkSheets.getAssociatedActiveSheetName())&&reloadPage(void 0,!0)}if(!isUndefined(e[ActionConstants.LOCK_MULTIPLE]))for(t=0;t<e[ActionConstants.LOCK_MULTIPLE].length;t++){var l=e[ActionConstants.LOCK_MULTIPLE][t];(CURRSHEETNAME===l.sn||l.a===ActionConstants.LOCK_SHEET||l.a===ActionConstants.UNLOCK_SHEET)&&ProtectedRanges.getObject().updateResponse(l)}if(1==s){var $=e[JSONConstants.INFO_MESSAGE];$&&($[ActionConstants.REPLACE]?searchCallBack():$[ActionConstants.REPLACE_ALL]&&searchCallBack($[ActionConstants.REPLACE_ALL]));var X=null;isUndefined(e.me)&&null==n||(X=e.me,handleMacroErrorAndMsg(X,n))}if((!isUndefined(e.sn)&&CURRSHEETNAME==e.sn||!isUndefined(e.s)&&WorkSheets.getAssociatedActiveSheetName()==e.s)&&!isUndefined(e[JSONConstants.CONDITION_FORMAT])){var q=e[JSONConstants.CONDITION_FORMAT]&&e[JSONConstants.CONDITION_FORMAT][0]===!0?!0:!1;for(t=0;t<e[JSONConstants.CONDITION_FORMAT].length;t++)updateRangeStyleJson(e[JSONConstants.CONDITION_FORMAT][t],q,!1,!0);init_format(currCell)}if(!isUndefined(e[JSONConstants.COLORSCALE_COLOR]))for(var R,g,T,N,Q=e[JSONConstants.COLORSCALE_COLOR],et=0;et<Q.length;et++){var tt=Q[et];for(var t in tt){var nt=tt[t];for(d=0;d<nt.length;d++)if(nt[d].hasOwnProperty("sr")?(R=nt[d].sr,g=nt[d].sc,T=nt[d].er,N=nt[d].ec):nt[d].hasOwnProperty("R")&&(R=nt[d].R,g=nt[d].C,T=R,N=g),nt[d].hasOwnProperty("csHexColor")){var st=nt[d].csHexColor;st="#"==st.charAt(0)?st:"#"+st,updateRangeFormat(R,g,T,N,"backgroundColor",st)}else removeStyle("backgroundColor",R,g,T,N)}}e.xaid&&appEvent.trigger("response.updatedInClient",[e.xaid,e.serverActionExecutionTime,e.responseGeneratedTime]),isRecastAction=isRecastAction?!1:isRecastAction}}function split_merge(e){var t=e.v,n=parseInt(e.sr),s=parseInt(e.sc),o=parseInt(e.er),a=parseInt(e.ec);if(t)mergeCells(n,s,o,a,!0,!1,!0);else{var i=!0;ActiveCellInfo.isMerged()&&n>=ActiveCellInfo.getStartRow()&&s>=ActiveCellInfo.getStartCol()&&o<=ActiveCellInfo.getEndRow()&&a<=ActiveCellInfo.getEndCol()&&(i=!1,n=ActiveCellInfo.getStartRow(),s=ActiveCellInfo.getStartCol(),o=ActiveCellInfo.getEndRow(),a=ActiveCellInfo.getEndCol()),splitCells(n,s,o,a,i,!0)}}function updateRangeJson(e,t){var n=parseInt(e.a),s=getSheetASN(e);if(e.sn=void 0!=e.sn?e.sn:s,void 0!=e.rangeList&&(e.sr=getSheetRange(e).sr,e.sc=getSheetRange(e).sc,e.er=getSheetRange(e).er,e.ec=getSheetRange(e).ec),"undefined"==typeof e.sn||CURRSHEETNAME==e.sn||n===ActionConstants.UNLOCK_RANGE){var o={doNotSkipFirstCoveredCell:!0};switch(n){case ActionConstants.ITALIC:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"fontStyle",e.v,o);break;case ActionConstants.UNDERLINE:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"textDecoration",e.v,o);break;case ActionConstants.FONTFAMILY:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"fontFamily",e.v,o);break;case ActionConstants.FONTSIZE:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"fontSize",e.v,o);break;case ActionConstants.VALIGN:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"verticalAlign",e.v,o);break;case ActionConstants.HALIGN:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"textAlign",e.v,o);break;case ActionConstants.COLOR:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"backgroundColor",e.v,o);break;case ActionConstants.TEXTCOLOR:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"color",e.v,o);break;case ActionConstants.WRAP:setWrapPropertyForCellRange(e.sr,e.er,e.sc,e.ec,e.v);break;case ActionConstants.HEIGHT:setRowsHeightAndModifyDOM([e]),focusSheet();break;case ActionConstants.CLEARSTYLES:clearFormatting(e.sr,e.sc,e.er,e.ec);break;case ActionConstants.CLEARCONTENTS:isUndefined(e.sr)?clearContents(e.r,e.c,e.r,e.c,t,!0):clearContents(e.sr,e.sc,e.er,e.ec,t,!0);break;case ActionConstants.BORDERS:isRTL&&(13==e.v?e.v=14:14==e.v&&(e.v=13)),applyBorder(e.v,e.bs,e.bc,e.sr,e.sc,e.er,e.ec);break;case ActionConstants.MERGE_AND_CENTER:mergeAndCenter(e.sr,e.sc,e.er,e.ec);break;case ActionConstants.MERGE_RANGE:mergeRange(e.sr,e.sc,e.er,e.ec,t);break;case ActionConstants.MERGE_ACROSS:mergeAcross(e.sr,e.sc,e.er,e.ec,e.atc);break;case ActionConstants.MERGE_DOWN:mergeDown(e.sr,e.sc,e.er,e.ec);break;case ActionConstants.MERGE_SPLIT:break;case ActionConstants.BOLD:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"fontWeight",e.v,o);break;case ActionConstants.WIDTH:setSheetColumnsWidth(e.sc,e.ec,e.v),focusSheet();break;case ActionConstants.HIDE_GRID:gridFunctionality("hide");break;case ActionConstants.SHOW_GRID:gridFunctionality("show");break;case ActionConstants.INSERT_ROW:case ActionConstants.ADD_ROW_IN_NAMEDRANGE:void 0==e.count&&(e.count=e.er-e.sr+1),void 0==e.si&&(e.si=e.sr),Range.executeShiftOperationCallback("INSERT","ROW",e,t);break;case ActionConstants.INSERT_COL:void 0==e.count&&(e.count=e.ec-e.sc+1),void 0==e.si&&(e.si=e.sc),Range.executeShiftOperationCallback("INSERT","COLUMN",e,t);break;case ActionConstants.DELETE_ROW:void 0==e.count&&(e.count=e.er-e.sr+1),void 0==e.si&&(e.si=e.sr),Range.executeShiftOperationCallback("DELETE","ROW",e,t);break;case ActionConstants.DELETE_COL:void 0==e.count&&(e.count=e.ec-e.sc+1),void 0==e.si&&(e.si=e.sc),Range.executeShiftOperationCallback("DELETE","COLUMN",e,t);break;case ActionConstants.CELL_STYLENAME:setDefaultFormatForCell(getCell(e.r,e.c));break;case ActionConstants.CELL_COMMENT:appEvent.trigger("annot.handleResponse",[e]);break;case ActionConstants.CLEARALL:split_merge(e),clearAll(e.sr,e.sc,e.er,e.ec,e.ws,e.wd);break;case ActionConstants.SWITCH_SHEET:Goto.doGoto(e.sn,e.sr,e.er,e.sc,e.ec);break;case ActionConstants.UNDO_MESSAGE:showAlertDialog(jsMsg[e.v]);break;case ActionConstants.STRIKETHROUGH:updateRangeFormat(e.sr,e.sc,e.er,e.ec,"strikeThrough",e.v,o);break;case ActionConstants.DELETE_RANGE:deleteCells();break;case ActionConstants.INSERT_RANGE:insertCells();break;case ActionConstants.SELECT:selectedRange=e;break;case ActionConstants.DEBUG_MSG:msgboxArray.push(e);break;case ActionConstants.CLEAR_ANNOTATION:removeRangeComments(e.sr,e.sc,e.er,e.ec);break;case ActionConstants.FREEZE_PANES:SHEET.unFreeze("true",!0,t),SHEET.FREEZE._freeze(e.sr,e.sc,"true",!0),updateViewPort();break;case ActionConstants.UNFREEZE_PANES:SHEET.unFreeze("true",!0,t),updateViewPort();break;case ActionConstants.CTRL_COMP_ADD:Button.init(e.id,e),t?Button.editLabel(e.id,!0):(Button[e.id].switchModes(!1),Button.handleSelectedObjects(e.id));break;case ActionConstants.CTRL_COMP_ASSIGNMACRO:t?(Button(e.id).assignMacro(e),ole(e.id).deSelect(),Button(e.id).setContextMenu()):Button(e.id).assignMacro(e).setContextMenu();break;case ActionConstants.CTRL_COMP_CLONE:t?ole(e.dmid).synchronizeClones(e.ct,e.dmid,e.id):(Button.init(e.id,e,!0),Button(e.id).assignMacro(e),Button[e.id].switchModes(!1).setContextMenu(),ole(e.id).setHeight(e.ht).setWidth(e.wd).setLeft(e.left).setTop(e.top),Button.handleSelectedObjects(e.id));break;case ActionConstants.CTRL_COMP_DELETE:Button[e.id]&&(Button[e.id]=null),getObj(e.id)&&(ole.currObj&&ole.currObj.id==e.id&&getObj("OLETextarea").blur(),ole.remove(e.id,!1),activateCellField());break;case ActionConstants.CTRL_COMP_MOVE:if(!t){var a=ole(e.id);a.sCol=findColInXPos(e.left),a.sRow=findRowInYPos(e.top),a.sRowDiff=e.top-getRowTop(a.sRow),a.sColDiff=e.left-getColLeft(a.sCol),a.moveTo(e.left,e.top),Button.handleSelectedObjects(e.id)}break;case ActionConstants.CTRL_COMP_RESIZE:t||(ole(e.id).resizeTo(e.wd,e.ht),Button.handleSelectedObjects(e.id));case ActionConstants.CTRL_COMP_SETCAPTION:!t&&getObj(e.id)&&(Button(e.id).setText(e.cap),ole(e.id).setLeft(e.left).setWidth(e.wd),Button.handleSelectedObjects(e.id));break;case ActionConstants.IMPORT_REPLACE_DATA_STARTING_AT_CELL:case ActionConstants.IMPORT_APPEND_ROWS_TO_CURRENTSHEET:case ActionConstants.IMPORT_REPLACE_CURRENTSHEET:case ActionConstants.INSERT_COPY_ROW:break;case ActionConstants.INSERT_CUT_ROW:break;case ActionConstants.INSERT_COPY_COLUMN:break;case ActionConstants.INSERT_CUT_COLUMN:break;case ActionConstants.DELETE_PIVOT:PivotUtil.deletePivotInClient(e.id),PivotUtil.hideAndDisplayPivotTab(!0);break;case ActionConstants.FORM_FIELD_DELETED:e[JSONConstants.FORM_COL_DELETED]&&(void 0==e.count&&(e.count=e.ec-e.sc+1),void 0==e.si&&(e.si=e.sc),Range.executeShiftOperationCallback("DELETE","COLUMN",e,!0));break;case ActionConstants.FORM_LIVE_SUBMIT:Range.executeShiftOperationCallback("INSERT","ROW",e,!0);break;case ActionConstants.CONVERT_FORM:e.count=2,Range.executeShiftOperationCallback("INSERT","COLUMN",e,!0);break;case ActionConstants.FORM_FIELD_ADDED:void 0==e.count&&(e.count=e.ec-e.sc+1),void 0==e.si&&(e.si=e.sc),Range.executeShiftOperationCallback("INSERT","COLUMN",e,!0);break;case ActionConstants.INSERT_CELL_LEFT:ProtectedRanges.getObject().getRanges().shiftCells(e.sr,e.sc,e.er,e.ec,!1,!1),appEvent.trigger("ShiftDiscussionRanges",[e.sn,e.sr,e.sc,e.er-e.sr+1,e.ec-e.sc+1,!1,!1]);break;case ActionConstants.INSERT_CELL_TOP:ProtectedRanges.getObject().getRanges().shiftCells(e.sr,e.sc,e.er,e.ec,!0,!1),appEvent.trigger("ShiftDiscussionRanges",[e.sn,e.sr,e.sc,e.er-e.sr+1,e.ec-e.sc+1,!0,!1]);break;case ActionConstants.DELETE_CELL_RIGHT:ProtectedRanges.getObject().getRanges().shiftCells(e.sr,e.sc,e.er,e.ec,!1,!0),appEvent.trigger("ShiftDiscussionRanges",[e.sn,e.sr,e.sc,e.er-e.sr+1,e.ec-e.sc+1,!1,!0]);break;case ActionConstants.DELETE_CELL_BOTTOM:ProtectedRanges.getObject().getRanges().shiftCells(e.sr,e.sc,e.er,e.ec,!0,!0),appEvent.trigger("ShiftDiscussionRanges",[e.sn,e.sr,e.sc,e.er-e.sr+1,e.ec-e.sc+1,!0,!0]);break;case ActionConstants.LOCK_RANGE:case ActionConstants.UNLOCK_RANGE:CURRSHEETNAME===e.sn&&ProtectedRanges.getObject().updateResponse(e),protectionDialog.handleDeletionInManage(e)}}}function updateRangeDataJson(e,t){for(var n=e.sr;n<=e.er;n++)if(isRowAvailable(n,e.rs)||ISFREEZED&&FREEZED_ROW>n)for(var s=e.sc;s<=e.ec;s++)updateCellData(n,s,e,t)}function updateCellData(e,t,n,s){var o=!isUndefined(n.cs),a=!isUndefined(n.rs);if(o||a){var i=o?parseInt(n.cs):1,r=a?parseInt(n.rs):1,c=Merge.getCellInfo(e,t),l=!!c,C=!1,d=1,E=1;l&&(C=e!=c.startRow||t!=c.startCol,d=c.getColSpan(),E=c.getRowSpan()),C||(1==i&&1==r&&l?splitCells(e,t,e,t,!0,!0):((i>1||r>1)&&!l||i!=d||r!=E)&&mergeCells(e,t,e+r-1,t+i-1,!0,!0,!0))}var A=!1;if(isUndefined(n.m)||(A=n.m),t>usedCursCol&&(usedCursCol=t),e>usedCursRow&&(usedCursRow=e),!Merge.isCovered(e,t)){var S=new Cell(e,t);S.executeMethod(function(o){updateCellDataJson(o,n,e,t),A&&FadeCell.elemsarr[s].push(o)})}appEvent.trigger("cell.dataUpdate",[e,t,CURRSHEETNAME,n.isValidContent])}function updateCellDataJson(e,t,n,s){if(e){var o=e.className;if(isUndefined(t[ActionConstants.COMMENT]))Annot.removeAll(n,s,n,s),o=e.className;else{var a=t[ActionConstants.COMMENT];Annot.addComment(e,a,n,s),-1==o.indexOf(" cC")&&(o+=" cC")}var i="";if(isUndefined(t.f))e.removeAttribute("fn");else{var r=t.f.substring(1,t.f.length-1);e.setAttribute("fn",r),i=r}if(e==currCell&&(exprField.value=i),isUndefined(t.v))e.removeAttribute("cV");else{var c=t.v.substring(1,t.v.length-1);appEvent.trigger("cell.setcontent",[e,n,s,totCols,c]),e.setAttribute("cV",c)}if(!isUndefined(t.ev)){var l=t.ev.substring(1,t.ev.length-1);null==t.ev?l="Null":-1!=t.ev.constructor.toString().indexOf("Array")&&(l="["+t.ev+"]");var C=t.l;C||t.hl?C&&t.hl?appEvent.trigger("addlink",[e,l,C]):appEvent.trigger("addlink",[e,l]):isUndefined(t.fab)?(isUndefined(t.v)&&appEvent.trigger("cell.setcontent",[e,n,s,totCols,l]),setCellContent(e,l)):"checkbox"===t.fab&&(checkbox.add(e,l),o=e.className)}if(!checkbox.isPresent(e)&&"checkbox"!==t.fab){e.style.textAlign="";var d=getCSSStyleRegex("textAlign"),o=o.replace(d,""),E=getCSSStyleRegex("utextAlign");E.test(o)||t.ft&&"STRING"!==t.ft&&"0"!==t.ft&&(o+=" tar",addFlexBoxDiv(e,getCellInnerHTML(e)))}o=o.replace(getCSSStyleRegex("nFormat"),""),isUndefined(t.ptc)||"none"===t.ptc||(o+=" nFT"+t.ptc),e.className=o,isUndefined(t.ft)||("0"==t.ft?e.removeAttribute("format"):(e.setAttribute("format",t.ft),"PERCENT"==t.ft&&ActiveCellInfo.resetFormat(ActiveCellInfo._getFormat(e))),"FLOAT"==t.ft&&l&&-1!=l.indexOf(thousandSeparator)||menutabListener.doAction(TOOLBAR.FORMAT,{id:"formatCellsNumber",action:"uncheck",callback:applyStyle_zbutton,args:["formatCellsNumber","uncheck","comma"]}))}}function updateRangeStyleJson(e,t,n,s){isUndefined(n)&&(n=!0);for(var o=e.sr;o<=e.er;o++)if(isRowAvailable(o,e.rs)||ISFREEZED&&FREEZED_ROW>o)for(var a=e.sc;a<=e.ec;a++)updateCellStyle(o,a,e,t,n,s)}function updateCellStyle(e,t,n,s,o,a){isUndefined(s)&&(s=!1),Merge.isCovered(e,t)||new Cell(e,t).executeMethod(updateCellStyleJson,n,e,t,void 0,s,o,a)}function updateCellStyleJson(e,t,n,s,o,a,i,r){if(e){var c=e.className,l=checkbox.isPresent(e)?"cD tac vam":"cD";if(r&&!isUndefined(t.isIconClear)&&($(e).find("[class*='iS-']").remove(),l=l.replace(" iconWrap",""),5==Object.keys(t).length))return;if(l+=(isUndefined(t[ActionConstants.WRAP])||1!=t[ActionConstants.WRAP])&&c.indexOf("nW")>-1?" nW":" W",isUndefined(t[ActionConstants.BOLD])||1!=t[ActionConstants.BOLD]?a&&-1!==c.indexOf("fwb")&&(l+=" fwb"):l+=" fwb",isUndefined(t[ActionConstants.ITALIC])||1!=t[ActionConstants.ITALIC]?a&&-1!==c.indexOf("fsi")&&(l+=" fsi"):l+=" fsi",isUndefined(t[ActionConstants.UNDERLINE])||1!=t[ActionConstants.UNDERLINE]||!isUndefined(t[ActionConstants.STRIKETHROUGH])&&1===t[ActionConstants.STRIKETHROUGH]?a&&-1!==c.indexOf("tdu")&&(l+=" tdu"):l+=" tdu",isUndefined(t[ActionConstants.STRIKETHROUGH])||1!=t[ActionConstants.STRIKETHROUGH]||!isUndefined(t[ActionConstants.UNDERLINE])&&1===t[ActionConstants.UNDERLINE]?a&&-1!==c.indexOf("tdst")&&(l+=" tdst"):l+=" tdst",isUndefined(t[ActionConstants.UNDERLINE])||1!=t[ActionConstants.UNDERLINE]||isUndefined(t[ActionConstants.STRIKETHROUGH])||1!=t[ActionConstants.STRIKETHROUGH]?a&&-1!==c.indexOf("tdsu")&&(l+=" tdsu"):(l=l.replace(" tdst",""),l=l.replace(" tdu",""),l+=" tdsu"),isUndefined(t[ActionConstants.FONTFAMILY]))if(a){if(null!=c){var C=getCSSStyleRegex("fontFamily").exec(c);null!=C&&(l=l+=C[0])}}else e.style.fontFamily="";else if(cssStyle=getMatchedCSSFontStyle(t[ActionConstants.FONTFAMILY]),""==cssStyle)e.style.fontFamily=t[ActionConstants.FONTFAMILY];else if(a){if(null!=c){var C=getCSSStyleRegex("fontFamily").exec(c);null!=C&&(l=l+=C[0])}}else" fnal"!==cssStyle&&(l+=cssStyle),e.style.fontFamily="";if(isUndefined(t[ActionConstants.FONTSIZE]))if(a){if(null!=c){var C=getCSSStyleRegex("fontSize").exec(c);null!=C&&(l=l+=C[0])}}else e.style.fontSize="";else if(cssStyle=getCssFontSize(t[ActionConstants.FONTSIZE]),""==cssStyle){var d=t[ActionConstants.FONTSIZE].replace("pt","");d&&(l=l+" f"+d),e.style.fontSize=t[ActionConstants.FONTSIZE]}else if(a){if(null!=c){var C=getCSSStyleRegex("fontSize").exec(c);null!=C&&(l=l+=C[0])}}else l+=cssStyle,e.style.fontSize="";if(isUndefined(t[ActionConstants.HALIGN])||checkbox.isPresent(e)){if(null!=c){var C=getCSSStyleRegex("utextAlign").exec(c);if(null==C)var C=getCSSStyleRegex("textAlign").exec(c);a?null!=C&&(l=l+=C[0]):null===e.getAttribute("format")||"STRING"===e.getAttribute("format")||checkbox.isPresent(e)||(l+=" tar")}}else{var E="";switch(t[ActionConstants.HALIGN]){case 0:E=" fal";break;case 1:E=" fac";break;case 2:E=" far"}l+=E}if(-1!=c.indexOf(" cC")&&(l+=" cC"),isUndefined(t[ActionConstants.VALIGN])||checkbox.isPresent(e)){if(a&&null!=c){var C=getCSSStyleRegex("verticalAlign").exec(c);null!=C&&(l=l+=C[0])}}else{var E="";switch(t[ActionConstants.VALIGN]){case 0:E="";break;case 1:E=" vam";break;case 2:E=" vab"}l+=E}if(!i&&null!=c){var C=getCSSStyleRegex("borderRight").exec(c);null!=C&&(l=l+=C[0]);var C=getCSSStyleRegex("borderBottom").exec(c);null!=C&&(l=l+=C[0])}if(isUndefined(t[ActionConstants.COLOR]))a||(e.style.backgroundColor="",setBorderValue(n,s,n,s,"remove"));else if("transparent"!=t[ActionConstants.COLOR]){if(e.style.backgroundColor=t[ActionConstants.COLOR],Merge.getCellInfo(n,s)&&!Merge.isCovered(n,s)){var A=Merge.getCellInfo(n,s),S=new Range(A.startRow,A.startCol-1,A.endRow,A.startCol-1),O=S.getIterator();O.iterate(function(e,t){var n=new Cell(e,t);n.executeMethod(function(e){e.style.borderRight||(e.style.borderRight="1px solid transparent")})});var S=new Range(A.startRow-1,A.startCol,A.startRow-1,A.endCol),O=S.getIterator();O.iterate(function(e,t){var n=new Cell(e,t);n.executeMethod(function(e){e.style.borderBottom||(e.style.borderBottom="1px solid transparent")})})}setBorderValue(n,s,n,s,"add")}else e.style.backgroundColor="",setBorderValue(n,s,n,s,"remove");if(-1!==c.indexOf("highlightInvalid")&&(l+=" highlightInvalid"),null!=c){var C=getCSSStyleRegex("nFormat").exec(c);null!=C&&(l=l+=C[0])}if(isUndefined(t.icon_name)||isUndefined(t.icon_id))!r||a||isUndefined(t.isIconClear)||(l=l.replace(" iconWrap",""),$(e).find("[class*='iS-']").remove());else{-1!==e.className.indexOf(" W")&&(l+=" iconWrap");var R=iconsets.createSPAN(t.icon_name,parseInt(t.icon_id),t.dis);$(e).find("[class*='iS-']").remove(),hasFlexBoxDiv(e)?$(e.querySelector(".w100")).prepend(R):e.prepend(R)}var T=isRTL?/( (fa|ta)[rc])(\b)/i:/( (fa|ta)[rc])(\b)/i,g=getCellInnerHTML(e);(T.test(l)||-1!=l.indexOf(" W")||isRTL)&&addFlexBoxDiv(e,g),isUndefined(t[ActionConstants.TEXTCOLOR])?a||(e.style.color=""):r?e.style.setProperty("color",t[ActionConstants.TEXTCOLOR],"important"):e.style.color=t[ActionConstants.TEXTCOLOR],t.hcc?(l+=" hcc",e.style.setProperty("color","transparent","important")):!isUndefined(t[ActionConstants.TEXTCOLOR])||a&&!isUndefined(t.hcc)||e.style.setProperty("color","",""),e.className=l}}function isOutsideActionRange(e,t,n,s,o,a){return(n>e||e>o)&&(s>t||t>a)}function updateRangeBorderJson(e,t){for(var n=e.sr;n<=e.er;n++)if(isRowAvailable(n,e.rs)||ISFREEZED&&FREEZED_ROW>n)for(var s=e.sc;s<=e.ec;s++)updateCellBorder(n,s,e,t)}function updateCellBorder(e,t,n,s){Merge.isCovered(e,t)||new Cell(e,t).executeMethod(updateCellBorderJson,n,s)}function updateCellBorderJson(e,t,n){if(e){var s,o=e.className,a=o,i=t[ActionConstants.BORDER_RIGHT];if(isUndefined(i)?1==n&&(a=a.replace(getCSSStyleRegex("borderRight"),""),$(e).css("border-right","")):(isRTL&&(e=getCell(ActiveCellInfo.getActiveRow(),ActiveCellInfo.getActiveCol()+1)),s=getBorderStyleName(i,14),""!=s?-1==a.indexOf(s)&&(1==n&&(a=a.replace(getCSSStyleRegex("borderRight"),"")),a+=s):(isRTL&&(e=getCell(getCell(ActiveCellInfo.getActiveRow(),ActiveCellInfo.getActiveCol()))),null!=e&&(e.style.borderRight=i))),isRTL&&(e=getCell(getCell(ActiveCellInfo.getActiveRow(),ActiveCellInfo.getActiveCol()))),isUndefined(t[ActionConstants.BORDER_BOTTOM]))1==n&&(a=a.replace(getCSSStyleRegex("borderBottom"),""),$(e).css("border-bottom",""));else{var r=t[ActionConstants.BORDER_BOTTOM];s=getBorderStyleName(r,17),""!=s?-1==a.indexOf(s)&&(1==n&&(a=a.replace(getCSSStyleRegex("borderBottom"),"")),a+=s):null!=e&&(e.style.borderBottom=r)}o!=a&&(e.className=a)}}function getBorderStyleName(e,t){if("1"==e||"2"==e||"d"==e)switch(t){case 13:return" bl"+e;case 14:return" br"+e;case 16:return" bt"+e;case 17:return" bb"+e}return""}function getCssFontSize(e){var t="";switch(e){case"6pt":t=" f6";break;case"8pt":t=" f8";break;case"9pt":t=" f9";break;case"10pt":t=" f10";break;case"11pt":t=" f11";break;case"12pt":t=" f12";break;case"14pt":t=" f14";break;case"16pt":t=" f16";break;case"18pt":t=" f18";break;case"20pt":t=" f20";break;case"22pt":t=" f22";break;case"24pt":t=" f24";break;case"26pt":t=" f26";break;case"28pt":t=" f28";break;case"32pt":t=" f32";break;case"40pt":t=" f40";break;case"48pt":t=" f48";break;case"56pt":t=" f56";break;case"64pt":t=" f64";break;case"72pt":t=" f72"}return t}function updateRangeFormat(e,t,n,s,o,a,i,r,c){var l,C=e,d=!1,E=FREEZED_ROW>0&&getAvailableStartRow()>=ROWS_PER_TILE&&FREEZED_ROW>=e;if(E&&(l=FREEZED_ROW-1>=n?n:FREEZED_ROW-1),n>=getAvailableStartRow()&&e<=getAvailableEndRow()&&(n=n>getAvailableEndRow()?getAvailableEndRow():n,e=e<getAvailableStartRow()?getAvailableStartRow():e,d=!0),s>getAvailableEndCol()&&(s=getAvailableEndCol()),d||E||c){var A="",S=!1;switch(o){case"backgroundColor":if("transparent"==a||"-1"==a)return d&&removeStyle("backgroundColor",e,t,n,s),void(E&&removeStyle("backgroundColor",C,t,l,s));break;case"color":if("-1"==a||"rgb(0, 0, 0)"==a||"rgb(0,0,0)"==a||"#000000"==a)return d&&removeStyle("color",e,t,n,s),void(E&&removeStyle("color",C,t,l,s));break;case"fontWeight":1==a?A=" fwb":S=!0;break;case"fontStyle":1==a?A=" fsi":S=!0;break;case"textDecoration":1==a?A=" tdu":S=!0;break;case"strikeThrough":1==a?A=" tdst":S=!0;break;case"fontFamily":if(A=getMatchedCSSFontStyle(a),""==A){var O=$("#fontFace");getDDIndex(O,a)}break;case"fontSize":if(A=getCssFontSize(a),""==A){var O=$("#fontSize");getDDIndex(O,a)}break;case"verticalAlign":switch(a){case"top":A=" vat";break;case"middle":A=" vam";break;case"bottom":A=" vab";break;default:A=" vat"}break;case"textAlign":switch(a){case"start":A=" fal";break;case"center":A=" fac";break;case"end":A=" far";break;case"right":A=" tar";break;case"left":A="left"}}var R=getCSSStyleRegex(o);S?(E&&removeStyleValue(C,t,l,s,o,R),d&&removeStyleValue(e,t,n,s,o,R,i)):""!=A?(E&&addCssStyleValue(C,t,l,s,o,A,R),(d||c)&&addCssStyleValue(e,t,n,s,o,A,R,i)):(E&&addStyleValue(C,t,l,s,o,a,R),(d||c)&&addStyleValue(e,t,n,s,o,a,R,i)),r||appEvent.trigger("update.rangeformat",[currCell])}}function removeStyleValue(e,t,n,s,o,a,i){var r=new Range(e,t,n,s),c=r.getIterator(i);c.iterate(function(e,t){new Cell(e,t).executeMethod(removeStyleValueForCell,o,a)})}function removeStyleValueForCell(e,t,n){if(e){if(checkbox.isPresent(e)&&"textAlign"===t)return;isUndefined(n)&&(n=getCSSStyleRegex(t)),e.className=e.className.replace(n,""),e.style[t]="",("fontSize"==t||"fontFamily"==t)&&appEvent.trigger("setlinkstyle",[e]),-1!=e.className.indexOf(" tdsu")&&"strikeThrough"==t&&(e.className=e.className.replace(" tdsu"," tdu")),-1!=e.className.indexOf(" tdsu")&&"textDecoration"==t&&(e.className=e.className.replace(" tdsu"," tdst"))}}function addStyleValue(e,t,n,s,o,a,i,r){var c=new Range(e,t,n,s),l=c.getIterator(r);l.iterate(function(e,t){new Cell(e,t).executeMethod(addStyleValueForCell,o,a,i)}),"backgroundColor"==o&&setBorderValue(e,t,n,s,"add")}function setBorderValue(e,t,n,s,o){if(0!=t)for(var a=e;n>=a;a++){var i=isRTL?getCell(a,s+1):getCell(a,t-1);i&&("add"==o?i.style.borderRightColor||(i.style.borderRight="1px solid transparent"):Merge.isCovered(a,t)||i.style.backgroundColor||"transparent"==i.style.borderRightColor&&(i.style.borderRight=""))}if(0!=e)for(var r=t;s>=r;r++){var i=getCell(e-1,r);i&&("add"==o?i.style.borderBottomColor||(i.style.borderBottom="1px solid transparent"):Merge.isCovered(e,r)||i.style.backgroundColor||("transparent"==i.style.borderBottomColor&&(i.style.borderBottom=""),"transparent"==i.style.borderRightColor&&(i.style.borderRight="")))}}function addStyleValueForCell(e,t,n,s){e&&(isUndefined(s)&&(checkbox.isPresent(e)&&(n="textAlign"===t?" tac":"verticalAlign"===t?" vam":n),s=getCSSStyleRegex(t),e.className=e.className.replace(s,"")),e.style[t]=n,("fontSize"==t||"fontFamily"==t||"color"==t)&&appEvent.trigger("setlinkstyle",[e]),"backgroundColor"==t&&(e.style.borderBottomColor||(e.style.borderBottom="1px solid transparent"),e.style.borderRightColor||(e.style.borderRight="1px solid transparent")))}function addCssStyleValue(e,t,n,s,o,a,i,r){var c=new Range(e,t,n,s),l=c.getIterator(r);l.iterate(function(e,t){new Cell(e,t).executeMethod(addCssStyleValueForCell,o,a,i)})}function addCssStyleValueForCell(e,t,n,s){if(e){var o=e.className;if(-1==o.indexOf(n)){if(checkbox.isPresent(e)&&(n="textAlign"===t?" fac":"verticalAlign"===t?" vam":n),isUndefined(s)||(o=o.replace(s,"")),"textAlign"===t){"left"===n&&(e.style.textAlign="left",n=""),(-1!=o.indexOf(" fal")||-1!=o.indexOf(" fac")||-1!=o.indexOf(" far"))&&(o=o.replace(" fac",""),o=o.replace(" far",""),o=o.replace(" fal",""));var a=e.querySelector("span");if(" fal"!=n||-1!=o.indexOf(" W")){var i=getCellInnerHTML(e);addFlexBoxDiv(e,i)}else if(" fal"==n&&isRTL){var i=getCellInnerHTML(e);addFlexBoxDiv(e,i)}else{var r=e.getAttribute("hyper");"multi"==r||a||removeFlexBoxDiv(e)}}"strikeThrough"==t||"textDecoration"==t?-1!=o.indexOf(" tdu")?o=o.replace(" tdu"," tdsu"):-1!=o.indexOf(" tdst")?o=o.replace(" tdst"," tdsu"):-1==o.indexOf(" tdsu")&&(o+=n):o+=n,""!=t&&(e.style[t]=""),e.className=o,("fontSize"==t||"fontFamily"==t)&&appEvent.trigger("setlinkstyle",[e])}}}function updateChartJson(e,t){switch(e.a){case ActionConstants.CHART_DATACHANGE:if(t)for(var n=0;n<e.id.length;n++)regenerateChart(e.id[n]);break;case ActionConstants.CHART_NEW:var s={CP_DOCUMENTID:e.did,CP_DOCUMENTSHEET_NAME:e.sn,CP_CHART_DBID:e.id};setChartProps(s,e);var o=ExcelGraph.createInstance(s);createChart(o,"REGENERATE");break;case ActionConstants.CHART_REGENERATE:var o=ExcelGraph.getInstance(getChartImgId(e.id));o&&(setChartProps(o,e),createChart(o,"REGENERATE"));break;case ActionConstants.CHART_DELETE:for(var n=0;n<e.id.length;n++){var a=getChartImgId(e.id[n]);sheetObjectsPane.removeChild(getObj(a)),ExcelGraph.removeInstance(a)}break;case ActionConstants.CHART_MOVE:var a=getChartImgId(e.id);""!=a&&("undefined"!=typeof e.x&&OLE[a].setLeft(e.x),"undefined"!=typeof e.y&&OLE[a].setTop(e.y));break;default:var i=e.SUBMODE;t||drawChart(e,i,void 0,!0)}}function setChartProps(e,t){isUndefined(t.r)||(e.CP_DATARANGE=t.r),isUndefined(t.d)||(e.CP_DATAIN=t.d),isUndefined(t.h)||(""!=getChartImgId(t.id)&&OLE[getChartImgId(t.id)].setHeight(t.h),e.CP_HEIGHT=t.h),isUndefined(t.w)||(""!=getChartImgId(t.id)&&OLE[getChartImgId(t.id)].setWidth(t.w),e.CP_WIDTH=t.w),isUndefined(t.t)||(e.CP_GRAPHTYPE=t.t),isUndefined(t.hl)||(e.CP_SHOW_LEGEND=t.hl),isUndefined(t.tl)||(e.CP_CHART_TITLE=t.tl),isUndefined(t.lf)||(e.CP_LABEL_FORMAT=t.lf),isUndefined(t.o)||(e.CP_PLOT_ORIENTATION=t.o),isUndefined(t.x)||(""!=getChartImgId(t.id)&&OLE[getChartImgId(t.id)].setLeft(t.x),e.CP_LEFT=t.x),isUndefined(t.y)||(""!=getChartImgId(t.id)&&OLE[getChartImgId(t.id)].setTop(t.y),e.CP_TOP=t.y),isUndefined(t.xt)||(e.CP_CHART_X_LABEL=t.xt),isUndefined(t.yt)||(e.CP_CHART_Y_LABEL=t.yt)}function updateWorkbookActionJson(e){switch(e.a){case ActionConstants.SAVE_WORKBOOK:isSaveButtonEnabled=!1,READ_WRITE&&btn_disabled(),ISMACROEDITOROPEN&&macroBtn_disabled();break;case ActionConstants.NEW_WORKBOOK:SAVED=!0,MACROSAVED=!0;var t=e.i;loadDocument(t)}}function updateSheetChangesInEditor(e){var t=getObj("sheetobject");if(t||ISMINDLG)switch(e.a){case ActionConstants.SHEET_INSERT:case ActionConstants.SHEET_COPY:if(ISMINDLG&&!ISMACROEDITOROPEN)return void updateSheetOperations(e);var n=document.createElement("TD"),s=document.createElement("TD"),o=document.createElement("TD"),a=document.createElement("TR");a.id="tr_"+e.cn,o.innerHTML='<img src="../images/spacer.gif" class="mainBgImg scriptExplrSheet"/>&nbsp;',o.innerHTML+="<a href=\"javascript:loadMacro('"+e.cn+"','1')\">"+e.cn+"("+e.sn+")</a>",s.innerHTML="<img class='mainBgImg scriptExplrTreeBottomEnd' src='../images/spacer.gif'>",a.appendChild(n),a.appendChild(s),a.appendChild(o);var i=t.getElementsByTagName("tr")[t.rows.length-custommdlcnt-2];if(i.cells[1].getElementsByTagName("IMG")[0].className="mainBgImg scriptExplrTree",t.getElementsByTagName("TBODY")[0].insertBefore(a,t.getElementsByTagName("tr")[t.rows.length-custommdlcnt-1]),e.a==ActionConstants.SHEET_INSERT)newmodule={id:e.cn,text:"REM Sheet Module",syntax:"vb"},module_content.push("REM Sheet Module");else{var r;if(ISMACROEDITOROPEN)r=editAreaLoader.getFile("macrotextid",e.oscn).text;else{var c=getModuleIndex(e.oscn);null!=c&&(r=module_content[c])}mdlnames.push(e.cn),module_content.push(r),newmodule={id:e.sn,text:r,syntax:"vb"}}editAreaLoader.openFile("macrotextid",newmodule);break;case ActionConstants.SHEET_REMOVE:if(ISMINDLG&&!ISMACROEDITOROPEN)return void updateSheetOperations(e);ISMACROEDITOROPEN&&editAreaLoader.closeFile("macrotextid",e.cn),e.c==currentMdl.CURRENT&&(currentMdl={});var l=getObj("tr_"+e.cn);if(l){"mainBgImg scriptExplrTreeBottomEnd"==l.cells[1].firstChild.className&&(l.parentNode.rows[l.parentNode.rows.length-custommdlcnt-3].cells[1].firstChild.className="mainBgImg scriptExplrTreeBottomEnd"),l.parentNode.removeChild(l);var c=0,C=mdlnames,d=module_content;mdlnames=[],module_content=[];var E=0;for(c=0;c<C.length;c++)C[c]!=e.cn&&(mdlnames[E]=C[c],module_content[E]=d[c],E++)}break;case ActionConstants.SHEET_RENAME:if(ISMINDLG&&!ISMACROEDITOROPEN)return void updateSheetOperations(e);var A=getObj("tr_"+e.cn);if(null!=A){var o=A.cells[A.cells.length-1];o.innerHTML='<img src="../images/spacer.gif" class="mainBgImg scriptExplrSheet"/>&nbsp;',o.innerHTML+="<a href=\"javascript:loadMacro('"+e.cn+"','1')\">"+e.cn+"("+e.sn+")</a>"}}if(t=getObj("modulsttable")){var S,c=0,O=t.rows.length;if(e.a==ActionConstants.SHEET_COPY){var R,T,g,N=O;for(c=0;O>c;c++)if(S=t.rows[c].id,0==S.indexOf(e.oscn+".")){T=t.insertRow(t.rows.length),T.className=N%2==0?"trEven":"trOdd",T.id=S.replace(e.oscn+".",e.cn+".");var f;for(f=0;f<t.rows[c].cells.length;f++)g=document.createElement("TD"),R=replace(t.rows[c].cells[f].innerHTML,e.oscn+".",e.cn+"."),R=replace(R,"'"+e.oscn+"'","'"+e.cn+"'"),g.innerHTML=R,T.appendChild(g);N+=1}}else if(e.a==ActionConstants.SHEET_REMOVE)for(c=0;c<t.rows.length;c++)S=t.rows[c].id,0==S.indexOf(e.cn+".")&&(t.rows[c].parentNode.removeChild(t.rows[c]),c-=1)}}function handleMacroErrorAndMsg(e,t,n){if(null!=e&&0!=e.e||null!=t&&0!=t.length){var s;if(null!=t&&0!=t.length){clearMessage(),s="[";for(var o=t.length,a=0;o>a;a++)"undefined"!=typeof t[a].M&&(!ISMINDLG&&ISMACROEDITOROPEN?insertMessage(t[a]):(s+='{"M":"'+encodeURIComponent(t[a].M)+'",',s+='"L":"'+t[a].L+'",',s+='"MT":"'+t[a].MT+'",',s+='"MN":"'+t[a].MN+'"},'));s+="]"}if(!ISMINDLG&&ISMACROEDITOROPEN)null!=t&&0!=t.length&&enableMessage(),"undefined"==typeof n&&(n=!1),null!=e&&1==e.e?(e.ISERROR=e.e,e.MESSAGE=e.m,e.LINE=e.l,e.COLUMN=e.c,insertError(e),"undefined"!=typeof e.mn&&"unknown"!=e.mn&&loadMacro(e.mn,e.mt,""+e.l),enableError(),n&&""==MacroPanelState.tabs||showMacroError()):null!=t&&0!=t.length&&(n&&""==MacroPanelState.tabs||showMessage());else{var i=new RequestParameters(ActionConstants.JSP_MACROERROR);i.setParameters(s),null!=e&&1==e.e&&i.setParameters(s,e.m,e.mn,e.l,e.mt);var r=new AjaxRequest;r.init("POST",i.getURL(),!0,i.getParametersAsString()),r.addEventListener("onComplete",function(e){var n=jsMsg.Error;null!=t&&(n=jsMsg.MessageBox);var s={width:450,title:n};sheetdialog.open(e.responseText,s)}),r.sendRequest()}}}function mergeAndCenter(e,t,n,s){mergeRange(e,t,n,s),updateRangeFormat(e,t,e,t,"textAlign","center")}function mergeRange(e,t,n,s,o){o||(Merge.remove(e,t,n,s),Merge.add(e,t,n,s))}function mergeAcross(e,t,n,s,o){var a=getAvailableStartRow(),i=getAvailableEndRow(),r=a>e?a:e,c=n>i?i:n;o&&(n=usedCursRow);for(var l=r;c>=l;l++)Merge.remove(l,t,l,s),Merge.add(l,t,l,s)}function mergeDown(e,t,n,s){for(var o=getAvailableStartRow(),a=getAvailableEndRow(),i=o>e?o:e,r=n>a?a:n,c=t;s>=c;c++)Merge.remove(i,c,r,c),Merge.add(i,c,r,c)}function updateWorkbookLevelAction(e,t,n){var s=e[JSONConstants.ACTION];switch(e.sheetList&&(e.asn=e.sheetList[0][0]),s){case ActionConstants.SHEET_INSERT:insertNewSheetInClient(e,t,n),appEvent.trigger("DiscussionSheets",["SHEET_INSERT",e]);break;case ActionConstants.SHEET_DUPLICATE:case ActionConstants.SHEET_COPY:if(e.nsn&&(e.sn=e.nsn),isSheetBasedShare)return;e.SHEETNAMES&&WorkSheets.updateSheetNamesList(e.SHEETNAMES);var o=e.sn,a=e.pos+1,i=document.createElement("TD");i.setAttribute("sheetname",o),i.setAttribute("context","sheettabrmenu"),i.id="sheetdiv-"+WorkSheets.getSheetCodeFromName(o),i.title=o;var r="",c=e.stbc;i.innerHTML="<div class='tabItem'><div id='sheetnames_"+a+"'>"+r+o+"</div></div>",i.onmousedown=function(e){return reorderSheet(e,this)};var l=getObj("sheetdiv-"+WorkSheets.getAssociatedActiveSheetName());if(l){var C=l.parentNode;if(a==parseInt(TOTALSHEETS)+1)C.insertBefore(i,getObj("dummySheetTab"));else{var d=getObj("sheetsTab").getElementsByTagName("TD");C.insertBefore(i,d[a-1])}toggleSheetsTabNavBar(),TOTALSHEETS=parseInt(TOTALSHEETS)+1,IS_UNSAVED_SHEET=!0,e.SHEETNAMES&&WorkSheets.updateSheetNamesList(e.SHEETNAMES),sheetTabBgColor.updateSheetTabColors({SHEETNAME:o,TYPE:"BACKGROUND",COLOR:c}),t&&(!ISMACROEDITOROPEN||ISMACROEDITOROPEN&&ISMINDLG)&&showsheet(i,"new"),workbookData.copySheet=!0,workbookData.copiedSheet=CURRSHEETNAME}null==workbooksheets?focusRemembering.constructClientJson():focusRemembering.addSheetInJson(o,TOTALSHEETS),updateSheetChangesInEditor(e),t&&documentBakeStatus.setRenderBake(!0);var E=e[JSONConstants.PIVOT_DETAILS];if(E)for(var A=0;A<E.length;A++)PivotUtil.createPivotObject(E[A]);unMaskSheet(),appEvent.trigger("DiscussionSheets",["SHEET_COPY",e]);break;case ActionConstants.SHEET_REMOVE:pivot.Collection.deleteSheetOperation(e[JSONConstants.ASSOCIATED_SHEET_NAME]);var o=e.sn;ProtectedRanges.getObject().onSheetDelete(o),chartOnLoad.removeSheetCharts(e.asn),chartOnLoad.removeSheetAffectCharts(e.asn);var S=WorkSheets.getSheetCodeFromName(o),l=getObj("sheetdiv-"+S);if(appEvent.trigger("sheet.removed",[o,S]),e.SHEETNAMES&&WorkSheets.updateSheetNamesList(e.SHEETNAMES),e.latestFormVersionId&&(latestFormVersionId=e.latestFormVersionId),l){null==workbooksheets?(workbooksheets=focusRemembering.constructClientJson(),focusRemembering.deleteSheetInJson(o)):(focusRemembering.deleteSheetInJson(o),workbookData.preActiveRow=0,workbookData.preActiveCol=0,workbookData.posBtm=0,workbookData.posLft=0);var C=l.parentNode;C.removeChild(l),TOTALSHEETS=parseInt(TOTALSHEETS)-1,toggleSheetsTabNavBar(),removeSheets(o),CURRSHEETNAME==o&&showsheet(getObj("sheetdiv-"+WorkSheets.getSheetCodeFromName(e.os)),"open"),updateSheetChangesInEditor(e)}FormObj.instances[S]&&WebForm.resetFormInfo(),sheetTabBgColor.removeFromCache(S),t&&documentBakeStatus.setRenderBake(!0),unMaskSheet(),Discussion.shRemove(o),appEvent.trigger("DiscussionSheets",["SHEET_REMOVE",e]);break;case ActionConstants.SHEET_RENAME:appEvent.trigger("sheet.onnamechanged",[e.sn,e.osn]);var O=e.asn,R=WorkSheets.getSheetNameFromCode(O);R||(R=e.osn),e.SHEETNAMES&&WorkSheets.updateSheetNamesList(e.SHEETNAMES);var T=e.sn,l=getObj("sheetdiv-"+O);if(l){var C=l.parentNode,r="";FormObj.instances[O]&&(r="<img src='"+IMAGE_PATH+"spacer.gif'class='formIcon'/>");var g=$(l).children(".tabItem").children()[0];$(g).html(r+T),R==CURRSHEETNAME&&(CURRSHEETNAME=T,WorkSheets.updateAscActiveSheetName(),cellPrevState&&(cellPrevState.sourceSheet=CURRSHEETNAME)),l.setAttribute("sheetname",T),l.id="sheetdiv-"+O,l.title=T,toggleSheetsTabNavBar(),renameSheets(R,T);var c=e.stbc,N=WorkSheets.getSheetObjByName(T);T==CURRSHEETNAME?(N.css("backgroundColor",c),sheetTabBgColor.updateSheetTabColors({SHEETNAME:T,TYPE:"BORDER"})):(N.css("borderBottomColor",c),sheetTabBgColor.updateSheetTabColors({SHEETNAME:T,TYPE:"BACKGROUND"})),null==workbooksheets?(workbooksheets=focusRemembering.constructClientJson(),focusRemembering.renameSheetInJson(R,T)):focusRemembering.renameSheetInJson(R,T),ProtectedRanges.getObject().onSheetRename(R,T)}Discussion.shRename(T,R),updateSheetChangesInEditor(e),appEvent.trigger("DiscussionSheets",["SHEET_RENAME",e]);break;case ActionConstants.SHEET_MOVE:var o=e.sn,a=e.pos+1;e.SHEETNAMES&&WorkSheets.updateSheetNamesList(e.SHEETNAMES);var l=getObj("sheetdiv-"+WorkSheets.getSheetCodeFromName(o));if(l){var C=l.parentNode;if(C.removeChild(l),a==parseInt(TOTALSHEETS)+1)C.insertBefore(l,getObj("dummySheetTab"));else{var d=getObj("sheetsTab").getElementsByTagName("TD");C.insertBefore(l,d[a-1])}toggleSheetsTabNavBar()}break;case ActionConstants.SHEET_ACTIVATE:var l=getObj("sheetdiv-"+WorkSheets.getSheetCodeFromName(e.sn));l&&showsheet(l,"open","false",!0);break;case ActionConstants.NAMEDRANGE_ADD:appEvent.trigger("namedrangechanged",[ActionConstants.NAMEDRANGE_ADD,e]);break;case ActionConstants.NAMEDRANGE_MODIFY:appEvent.trigger("namedrangechanged",[ActionConstants.NAMEDRANGE_MODIFY,e]);break;case ActionConstants.NAMEDRANGE_DELETE:appEvent.trigger("namedrangechanged",[ActionConstants.NAMEDRANGE_DELETE,e]);break;case ActionConstants.IMAGE_DELETE:t||appEvent.trigger("removeImageFromClient",[e.IMAGE_ID]);break;case ActionConstants.CHART_DELETE:if(LOGINNAME==e.un){var f=getChartImgId(e.id),v=getObj(f);v&&(ole.remove(f,!1),ole.conf.onblur())}break;case ActionConstants.DOCUMENT_SETTING:isRTL!=JSON.parse(e.sheetDirection)&&showsheet("sheetdiv-"+WorkSheets.getSheetCodeFromName(CURRSHEETNAME),"open",void 0,void 0,!0),chartOnLoad.setLocaleOptions(46===e.decimalSeparator?".":",",e.thousandSeparator),appEvent.trigger("updateServerResponse",[e]),functionDescription=void 0,reloadPage();break;case ActionConstants.CONVERT_FORM:if(isSheetBasedShare)return;var u=e.webform;if(t&&u&&!u[JSONConstants.IS_SUCCESS])return void showAlertDialog(jsMsg["Form.NetworkProblemMessageWhileCreating"]);var I="<img src='"+IMAGE_PATH+"spacer.gif'class='formIcon'/>",o=e.sn,N=WorkSheets.getSheetObjByName(o);if(N.children().find("img").length<1&&N.children().prepend(I),WebForm.isFormAvailable=!0,t){WebForm.formRid=u.form_rid;var p=u[JSONConstants.FORM_URLS];WebForm.formEditUrl=p.formEditURL,WebForm.liveFormUrl=p.liveFormUrl,window.open(WebForm.liveFormUrl,"_blank"),WebForm.updateFormMenuTab(),WebForm.generateFormInfo()}WebForm.formVersionId=u.frmversionid,latestFormVersionId=u.latestFormVersionId,updateSheetChangesInEditor(e),t&&documentBakeStatus.setRenderBake(!0);break;case ActionConstants.FORM_CREATE:if(isSheetBasedShare)return;var u=e.webform;if(t&&u&&!u[JSONConstants.IS_SUCCESS])return void showAlertDialog(jsMsg["Form.NetworkProblemMessageWhileCreating"]);var I="<img src='"+IMAGE_PATH+"spacer.gif'class='formIcon'/>",o=e.sn,a=e.pos+1,m=WorkSheets.getNewSheetId(),i=document.createElement("TD");i.setAttribute("sheetname",o),i.setAttribute("context","sheettabrmenu"),i.title=o,i.innerHTML="<div class='tabItem'><div id='"+m+"'>"+I+o+"</div></div>",i.onmousedown=function(e){return reorderSheet(e,this)};var l=getObj("sheetdiv-"+WorkSheets.getAssociatedActiveSheetName());if(l){WorkSheets.updateSheetNamesList(e.SHEETNAMES),i.id="sheetdiv-"+WorkSheets.getSheetCodeFromName(o);var C=l.parentNode;if(a==parseInt(TOTALSHEETS)+1)C.insertBefore(i,getObj("dummySheetTab"));else{var d=getObj("sheetsTab").getElementsByTagName("TD");C.insertBefore(i,d[a-1])}if(toggleSheetsTabNavBar(),TOTALSHEETS=parseInt(TOTALSHEETS)+1,IS_UNSAVED_SHEET=!0,WebForm.isFormAvailable=!0,t){WebForm.formRid=u.form_rid;var p=u[JSONConstants.FORM_URLS];WebForm.formEditUrl=p.formEditURL,WebForm.liveFormUrl=p.liveFormUrl,window.open(WebForm.formEditUrl,"_blank"),WebForm.updateFormMenuTab(),WebForm.formCreateInfo()}WebForm.formVersionId=u.frmversionid,latestFormVersionId=u.latestFormVersionId,t&&!n&&(!ISMACROEDITOROPEN||ISMACROEDITOROPEN&&ISMINDLG)&&showsheet(i,"new"),null==workbooksheets?focusRemembering.constructClientJson():focusRemembering.addSheetInJson(o,TOTALSHEETS)}updateSheetChangesInEditor(e),t&&documentBakeStatus.setRenderBake(!0);break;case ActionConstants.FORM_DELETE:var _=e.isFormDeleted;latestFormVersionId=e.latestFormVersionId,_&&WebForm.resetFormInfo(t);break;case ActionConstants.FORM_DELETE_ON_REVERT_VERSION:latestFormVersionId=e.latestFormVersionId;break;case ActionConstants.SHEET_TABCOLOR:var h=e.sn,c=e.stbc,L={};L[h]=c,sheetTabBgColor.responseHandler(JSON.stringify(L));break;case ActionConstants.SAVE_RTL_SHEET:prevSheetStyle!=isRTL&&(showsheet("sheetdiv-"+e.asn,"open",void 0,void 0,!0),prevSheetStyle=isRTL);break;case ActionConstants.LOCK_SHEET:case ActionConstants.UNLOCK_SHEET:ProtectedRanges.getObject().updateResponse(e),protectionDialog.handleDeletionInManage(e);break;case ActionConstants.CHANGE_PIVOT_SOURCE:k=pivot.Collection.get(e[JSONConstants.ID]),PivotUtil.clearPivotDestination(k),k.set(JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME,e[JSONConstants.ASSOCIATED_SOURCE_SHEET_NAME]),k.set(JSONConstants.SOURCE_START_ROW,e[JSONConstants.SOURCE_START_ROW]),k.set(JSONConstants.SOURCE_START_COLUMN,e[JSONConstants.SOURCE_START_COLUMN]),k.set(JSONConstants.SOURCE_END_ROW,e[JSONConstants.SOURCE_END_ROW]),k.set(JSONConstants.SOURCE_END_COLUMN,e[JSONConstants.SOURCE_END_COLUMN]),k.set(JSONConstants.END_ROW,e[JSONConstants.END_ROW]),k.set(JSONConstants.END_COLUMN,e[JSONConstants.END_COLUMN]);var b=e[JSONConstants.ALL_FIELDS];b&&k.set(JSONConstants.ALL_FIELDS,b),t&&PivotUtil.goToDestination(e[JSONConstants.ID]);break;case ActionConstants.CHANGE_PIVOT_THEME:k=pivot.Collection.get(e[JSONConstants.ID]);var D=e[JSONConstants.PIVOTTEMPLATE_ID]+"tc"+e[JSONConstants.PIVOTTEMPLATE_COLOR];k.set(JSONConstants.PIVOTTEMPLATE_ID,D);break;case ActionConstants.MOVE_PIVOT:k=pivot.Collection.get(e[JSONConstants.ID]),k.set(JSONConstants.START_ROW,e[JSONConstants.START_ROW]),k.set(JSONConstants.START_COLUMN,e[JSONConstants.START_COLUMN]),k.set(JSONConstants.END_ROW,e[JSONConstants.END_ROW]),k.set(JSONConstants.END_COLUMN,e[JSONConstants.END_COLUMN]),k.set(JSONConstants.ASSOCIATED_SHEET_NAME,e[JSONConstants.ASSOCIATED_SHEET_NAME]),k.set(JSONConstants.PIVOT_BUTTONS,e[JSONConstants.PIVOT_BUTTONS]);case ActionConstants.CREATE_PIVOT:case ActionConstants.EDIT_PIVOT:if(e[ActionConstants.SHEET_INSERT]&&(insertNewSheetInClient(e[ActionConstants.SHEET_INSERT],t,n),delete e[ActionConstants.SHEET_INSERT]),s===ActionConstants.MOVE_PIVOT&&PivotUtil.reconstructFilterIcon(k),t&&(isCellEdited()||(WorkSheets.getAssociatedActiveSheetName()==e[JSONConstants.ASSOCIATED_SHEET_NAME]?focusCell(e[JSONConstants.START_ROW],e[JSONConstants.START_COLUMN]):Goto.doGoto(WorkSheets.getSheetNameFromCode(e[JSONConstants.ASSOCIATED_SHEET_NAME]),e[JSONConstants.START_ROW],e[JSONConstants.START_ROW],e[JSONConstants.START_COLUMN],e[JSONConstants.START_COLUMN],!1)),e[JSONConstants.END_COLUMN]>=totCols)){var M=e[JSONConstants.END_COLUMN]-totCols+1;insertCol("append",totCols,M,!0,!0,!0,void 0,void 0,void 0,void 0,!0)}if(s===ActionConstants.CREATE_PIVOT){if(t){var U=pivot.Collection.get("temp");U&&!e.old_aid&&(e[JSONConstants.ALL_FIELDS]=JSON.parse(JSON.stringify(U.get(JSONConstants.ALL_FIELDS))),pivot.Collection.remove("temp"),pivotId=e[JSONConstants.ID]),PivotUtil.changeCreatePivotBt(!0,!0)}PivotUtil.createPivotObject(e)}s===ActionConstants.EDIT_PIVOT&&(U=pivot.Collection.get(e[JSONConstants.ID]),e[JSONConstants.ALL_FIELDS]=U.get(JSONConstants.ALL_FIELDS),e[JSONConstants.PIVOTTEMPLATE_ID]=U.get(JSONConstants.PIVOTTEMPLATE_ID),e[JSONConstants.SUBTOTALOPTION]=U.get(JSONConstants.SUBTOTALOPTION),e[JSONConstants.ROWGRANDTOTALOPTION]=U.get(JSONConstants.ROWGRANDTOTALOPTION),e[JSONConstants.COLGRANDTOTALOPTION]=U.get(JSONConstants.COLGRANDTOTALOPTION),t&&PivotUtil.changeCreatePivotBt(!0,!0),PivotUtil.deletePivotInClient(e[JSONConstants.ID]),PivotUtil.createPivotObject(e)),s===ActionConstants.MOVE_PIVOT&&PivotUtil.clearPivotDestination(k?k:pivot.Collection.get(e[JSONConstants.ID])),PivotUtil.hideAndDisplayPivotTab(!0),PivotUtil.updateVerticalScroll(e[JSONConstants.END_ROW]);break;case ActionConstants.APPLYFILTER_PIVOT:var P=e[JSONConstants.COUNT]>0?!0:!1;PivotUtil.changeFilterIcon(e[JSONConstants.ID],e[JSONConstants.HEADER_INDEX],e[JSONConstants.PIVOT_FIELD_TYPE],e[JSONConstants.SELECT_ALL],P);case ActionConstants.REFRESH_PIVOT:var k=pivot.Collection.get(e[JSONConstants.ID]);PivotUtil.clearPivotDestination(k),PivotUtil.resetPivotProps(k,e[JSONConstants.PIVOT_DETAILS]),PivotUtil.hideAndDisplayPivotTab(!0),PivotUtil.reconstructFilterIcon(k);break;case ActionConstants.CHANGE_DISPLAYINFO_PIVOT:var P=e[JSONConstants.COUNT]>0?!0:!1;PivotUtil.changeFilterIcon(e[JSONConstants.ID],e[JSONConstants.HEADER_INDEX],e[JSONConstants.PIVOT_FIELD_TYPE],e[JSONConstants.SELECT_ALL],P);var k=pivot.Collection.get(e[JSONConstants.ID]);PivotUtil.clearPivotDestination(k),PivotUtil.resetPivotProps(k,e[JSONConstants.PIVOT_DETAILS]),PivotUtil.reconstructFilterIcon(k);break;case ActionConstants.SORT_PIVOT:PivotUtil.changeSortIcon(e),k=pivot.Collection.get(e[JSONConstants.ID]),PivotUtil.clearPivotDestination(k),PivotUtil.resetPivotProps(k,e[JSONConstants.PIVOT_DETAILS]),PivotUtil.reconstructFilterIcon(k);break;case ActionConstants.REFRESH_ALL_PIVOT:if(E=e[JSONConstants.PIVOT_DETAILS])for(var A=0;A<E.length;A++){var F=E[A];k=pivot.Collection.get(F[JSONConstants.ID]),k.set(JSONConstants.END_ROW,F[JSONConstants.END_ROW]),k.set(JSONConstants.END_COLUMN,F[JSONConstants.END_COLUMN])}break;case ActionConstants.CHANGE_PIVOT_SUBTOTALOPTION:k=pivot.Collection.get(e[JSONConstants.ID]),PivotUtil.clearPivotDestination(k),k.set(JSONConstants.SUBTOTALOPTION,e[JSONConstants.SUBTOTALOPTION]),k.set(JSONConstants.END_ROW,e[JSONConstants.END_ROW]),k.set(JSONConstants.END_COLUMN,e[JSONConstants.END_COLUMN]);break;case ActionConstants.CHANGE_PIVOT_GRANDTOTALROWOPTION:k=pivot.Collection.get(e[JSONConstants.ID]),PivotUtil.clearPivotDestination(k),k.set(JSONConstants.ROWGRANDTOTALOPTION,e[JSONConstants.ROWGRANDTOTALOPTION]),k.set(JSONConstants.END_ROW,e[JSONConstants.END_ROW]),k.set(JSONConstants.END_COLUMN,e[JSONConstants.END_COLUMN]);break;case ActionConstants.CHANGE_PIVOT_GRANDTOTALCOLOPTION:k=pivot.Collection.get(e[JSONConstants.ID]),PivotUtil.clearPivotDestination(k),k.set(JSONConstants.COLGRANDTOTALOPTION,e[JSONConstants.COLGRANDTOTALOPTION]),k.set(JSONConstants.END_ROW,e[JSONConstants.END_ROW]),k.set(JSONConstants.END_COLUMN,e[JSONConstants.END_COLUMN])}var l=e;appEvent.trigger("server.response.workbookLevelAction",[l])}function insertNewSheetInClient(e,t,n){if(!isSheetBasedShare){var s=e.sn,o=e.pos+1,a=WorkSheets.getNewSheetId(),i=document.createElement("TD");i.setAttribute("sheetname",s),i.setAttribute("context","sheettabrmenu"),i.title=s,i.innerHTML="<div class='tabItem'><div id='"+a+"'>"+s+"</div></div>",i.onmousedown=function(e){return reorderSheet(e,this)};var r=getObj("sheetdiv-"+WorkSheets.getAssociatedActiveSheetName());if(r){WorkSheets.updateSheetNamesList(e.SHEETNAMES),i.id="sheetdiv-"+WorkSheets.getSheetCodeFromName(s);var c=r.parentNode;if(o==parseInt(TOTALSHEETS)+1)c.insertBefore(i,getObj("dummySheetTab"));else{var l=getObj("sheetsTab").getElementsByTagName("TD");c.insertBefore(i,l[o-1])}toggleSheetsTabNavBar(),TOTALSHEETS=parseInt(TOTALSHEETS)+1,IS_UNSAVED_SHEET=!0,t&&!n&&(!ISMACROEDITOROPEN||ISMACROEDITOROPEN&&ISMINDLG)&&showsheet(i,"new"),null==workbooksheets?focusRemembering.constructClientJson():focusRemembering.addSheetInJson(s,TOTALSHEETS)}if(updateSheetChangesInEditor(e),t){documentBakeStatus.setRenderBake(!0);var C=e[JSONConstants.IS_PIVOT_SHEET];if(C){var d=pivot.Collection.get("temp");!d&&pivot.fuea?setTimeout(function(){PivotUtil.submitPivotFromRecommend(pivot.fuea.id,pivot.fuea.row,pivot.fuea.col,pivot.fuea.sasn)},500):d&&!PivotUtil.isPivotBuilderOpen()?(d.set(JSONConstants.ASSOCIATED_SHEET_NAME,WorkSheets.getAssociatedActiveSheetName()),PivotUtil.openBuilder(!0)):pivot.fua&&setTimeout(function(){PivotUtil.sendFollowUpAction(s)},500)}}}}function getSheetASN(e){return e.sn?e.sn:e.sheetList?WorkSheets.getSheetNameFromCode(e.sheetList[0][0]):void 0}function getSheetRange(e){return e.rangeList?e.rangeList[0][0]:void 0}
var Hyperlink=function(e){var t="Web",l=!1,n=!1,a=!1,r=!1,s="",o="",d=!0,g=function(){var e=getCellRange();if(!ProtectedRanges.isRangeLocked(e.startRow,e.startCol,e.endRow,e.endCol)){var t=currCellValue?currCellValue:"";s=t,l=t.trim()?!0:!1;var n={width:474,title:jsMsg.Hyperlink,sheetswitch:!0,close:function(){f()},buttons:[{text:jsMsg.OK,class:"ui-zbutton-primary",click:function(){k()}},{text:jsMsg.Cancel,click:function(){f()}}]},i={init:function(){if(c(),h(),u(),$("#InternalUrl").focus(function(){var e=this;RangeSelector.on({el:e,isAbsoluteRef:d,appendSheetName:!0,allowSheetSwitch:!0,callback:function(){$("#InternalUrl").is(":visible")&&I(e)}})}),RTLlang)for(var e=$(".hyperlinkHeader").children(),t=0;t<e.length;t++)$(e[t]).css("display","inline-block")},destroy:function(){RangeSelector.off()}};sheetdialog.open("hyperlinkdialog",n,i)}},f=function(){r=!1,o=".A1",sheetdialog.close(),resetCellRangeFill("linkDialog"),clearCellRangeFill()},c=function(){var t=CellUtils.getRequiredSheetNames().sheetNames,l="";for(i=0;i<t.length;i++)l+=t[i]==CURRSHEETNAME?"<option value='"+t[i]+"' selected >"+t[i]+"</option>":"<option value='"+t[i]+"' >"+t[i]+"</option>";e("#SheetNames").append(l);var n=CellUtils.getRequiredRangeNames().rangeNames.sort();if(0!=n.length){for(e("#rangeList").append("<select id = 'RangeNames' multiple='multiple' size='5' class='textArea' style='padding:3px 0px 3px 1px;width:100%;*width:90%;'></select>"),l="",i=0;i<n.length;i++)l+="<option value='"+n[i]+"'>"+n[i]+"</option>";e("#RangeNames").append(l)}else{var a="<div style='height:80px; padding:3px 0 3px 1px; text-align:center;' class='textArea'> 0 "+jsMsg.NamesDefined+"</div>";a+="<select id = 'RangeNames' style='display:none;'><option></option></select>",e("#rangeList").append(a)}},h=function(){var l,i="",r="http://",s="mailto:";getHyperLinkInCell(currCell).childTag&&(l=getHyperLinkInCell(currCell).childTag.href,l||(l=getHyperLinkInCell(currCell).childTag.title)),l&&(0==l.indexOf("#")?(i=l.substring(1,l.length),i.indexOf("'")>-1&&(i=i.replace(/\'/g,"")),t="Internal"):0==l.indexOf("mailto")?(s=l,t="Email"):(r=l,t="Web")),"Internal"==t&&a&&(p(),n&&(b("rangeNameTab"),e("#RangeNames").val(i))),e("#WebUrl").val(r),e("#InternalUrl").val(CellUtils.addApostrophe(i)),e("#EmailUrl").val(s),m(t),positionDialog()},u=function(){e("#hyperlinkDialog :input").bind("keydown",function(e){var t=e.which;return 13==t?void k():void 0}),e("#showHideArrow").bind("click",function(){p()}),e("#Web, #Internal, #Email").bind("click",function(){m(this.id)}),e("#WebUrl, #InternalUrl, #EmailUrl").bind("keyup",function(e){C(e,this)}),e("#WebText, #InternalText, #EmailText").bind("keyup",function(e){v(e,this)}),e("#sheetNameTab, #rangeNameTab").bind("click",function(){b(this.id)}),e("#SheetNames, #RangeNames").bind("change",function(){N(this)})},C=function(e,l){"Internal"==t?I(l):S(l.value)},v=function(e,t){var l=e.which;return 13==l?void k():(w(t.value),void(s=t.value))},m=function(n){RangeSelector.off();var a=["Web","Internal","Email"];for(e("#"+n).attr("checked",!0),e("#"+n.toLowerCase()+"Link").show(),i=0;i<a.length;i++)n!=a[i]&&e("#"+a[i].toLowerCase()+"Link").hide();t=n,"Internal"==t?(""==e("#InternalUrl").val()&&R(),r=!0):(clearCellRangeFill(),r=!1),l&&S(),setTimeout(function(){var e=getObj(t+"Url");e&&setCaretPos(e,"END")},100)},p=function(){var t=e("#showHideArrow").attr("class");e("#tabView").toggle(),"hyperlinkDownArrow"==t?(e("#showHideArrow").removeClass().addClass("hyperlinkUpArrow"),a=!0):(e("#showHideArrow").removeClass().addClass("hyperlinkDownArrow"),a=!1)},b=function(t){"sheetNameTab"==t?(e("#sheetList").show(),e("#rangeList").hide(),e("sheetNameTab").hasClass("selected")||(e("#sheetNameTab").addClass("selected"),e("#rangeNameTab").removeClass("selected")),I(e("#InternalUrl")),""!=e("#SheetNames").val()&&N(e("#SheetNames"),"sheet"),n=!1):(e("#rangeList").show(),e("#sheetList").hide(),e("rangeNameTab").hasClass("selected")||(e("#rangeNameTab").addClass("selected"),e("#sheetNameTab").removeClass("selected")),""!=e("#RangeNames").val()&&N(e("#RangeNames"),"range"),n=!0),setCaretPos(getObj("InternalUrl"),"END"),r=!0},R=function(t){if(t){var l=getObj("InternalUrl");l.value=CellUtils.addApostrophe("$"+CURRSHEETNAME+"."+t),I(l);try{setCaretPos(l,"END")}catch(e){}}else{var n=jsGADGET_VIEW?"Sheet1":e("#SheetNames").val();if(isCellRange()){if(!rangeFill){var i=getCellRange(),a=i.startRow,r=i.startCol,s=i.endRow,g=i.endCol;o="."+CellUtils.constructCellName(a,r,s,g,d),e("#InternalUrl").val(CellUtils.addApostrophe("$"+n+o))}}else o="."+CellUtils.constructCellName(currRow,currCol,void 0,void 0,d),e("#InternalUrl").val(CellUtils.addApostrophe("$"+n+o))}},x=function(e){var t=e.getAttribute("ilink");t&&Goto.gotoCellInit(t)},N=function(t){var l,n,i,a=t.value,r=t.id,s=0;if("RangeNames"==r&&0!=NamedRange.getNamedRangesList().length){var d=NamedRange.getRange(a),g=d.sheetName;l=d.startRow,n=d.startCol,i=d.endRow,s=d.endCol,O(!1,g,l,n,i,s)||clearCellRangeFill(),getObj("SheetNames").selectedIndex>-1&&(getObj("SheetNames").selectedIndex=-1)}else if("SheetNames"==r){var f=e("#InternalUrl").val();""!=f&&f.indexOf(".")>0&&(o=f.substring(f.indexOf("."),f.length)),O(!0,a)||clearCellRangeFill(),getObj("RangeNames").selectedIndex>-1&&(getObj("RangeNames").selectedIndex=-1),a+=o}e("#InternalUrl").val(a),S(a)},O=function(e,t,l,n,i,a){if(e&&""!=o){a=0;-1!=o.indexOf(":")?(lbl1=o.substring(1,o.indexOf(":")),lbl2=o.substring(o.indexOf(":")+1,o.length),CellUtils.isCellLabel(lbl1)&&(ref1Obj=CellUtils.getCellPosByLabel(lbl1),l=ref1Obj.row,n=ref1Obj.col,CellUtils.isCellLabel(lbl2)?(ref2Obj=CellUtils.getCellPosByLabel(lbl2),i=ref2Obj.row,a=ref2Obj.col):(i=ref1Obj.row,a=ref1Obj.col))):(lbl1=o.substring(1,o.length),CellUtils.isCellLabel(lbl1)&&(ref1Obj=CellUtils.getCellPosByLabel(lbl1),l=ref1Obj.row,n=ref1Obj.col,i=ref1Obj.row,a=ref1Obj.col))}if(t==CURRSHEETNAME&&"undefined"!=typeof l){var r=getCellRangeDIM(parseInt(l),parseInt(n),parseInt(i),parseInt(a));return setCellRangeFillDIVPos(r.left,r.top),setCellRangeFillDIVDim(r.width,r.height),showCellRangeFillDIV(),!0}return!1},S=function(n){l?(e("#WebText").val(s),e("#InternalText").val(s),e("#EmailText").val(s)):e("#"+t+"Text").val(n),""==n?e("#CreateButton").disable():e("#CreateButton").enable()},w=function(e){l=""==e?!1:!0},I=function(t){if(t){var l=t.value;if(l){if(l=l.replace(".","!"),-1!=l.indexOf("!")){var n=l.substring(l.indexOf("!"),l.length);o=n.replace("!","."),l=l.substring(0,l.indexOf("!"))}var i=CellUtils.getRequiredSheetNames(l).sheetName,a=CellUtils.getRequiredRangeNames(l).rangeName;i?(e("#SheetNames").val(i),O(!0,i)||clearCellRangeFill()):""!=a?e("#RangeNames").val(a):(getObj("SheetNames").selectedIndex=-1,getObj("RangeNames").selectedIndex=-1)}S(t.value)}},U=function(e,t,l,n,i){var a=!0;"undefined"==typeof n&&(n="");var r=revertSplChrs(n);if(null!=e){var s=e.substring(0,e.indexOf(":")).toLowerCase()+e.substring(e.indexOf(":"),e.length);s=s.trim();var o,d,g=document.createElement("a");if(g.setAttribute("rel","noreferrer"),g.setAttribute("idx","link"),g.setAttribute("style","text-decoration:underline;cursor:pointer;font:inherit;pointer-events:all"),g.setAttribute("target","_blank"),g.innerHTML=ZSEC.Encoder.encodeForHTML(t),0==s.indexOf("http://",0)&&e.length>7||0==s.indexOf("https://",0)&&e.length>8||0==s.indexOf("ftp://",0)&&e.length>6||0==s.indexOf("telnet://",0)&&e.length>9||0==s.indexOf("nntp://",0)&&e.length>7||0==s.indexOf("rlogin://",0)&&e.length>9||0==s.indexOf("gopher://",0)&&e.length>9||0==s.indexOf("url://",0)&&e.length>6)o=s,d=s;else if(0==e.indexOf("www.",0)&&e.length>4)o="http://"+e,d=o;else if(0==s.indexOf("#")&&i){s=e.substring(1,e.length);var f=s.substring(0,s.indexOf("."));d="#"+s,s.indexOf("'")>-1&&(s=s.replace(/\'/g,"")),-1!=f.indexOf(" ")&&-1==f.indexOf("'")&&(d="#'"+f+"'"+s.substring(s.indexOf("."),s.length)),g.setAttribute("ilink",s),g.setAttribute("onclick","Hyperlink.callGotoMethod(this)")}else{var c=0==s.indexOf("mailto:",0)?s.replace("mailto:",""):e,h=getInvalidEmailError(c,!1);null==h&&e.length>5?(o="mailto:"+c,d=jsMsg.mailto+":"+c):l?(a=!1,r+=ZSEC.Encoder.encodeForHTML(t)):(o="http://"+e,d=o)}a&&(o&&(g.href=o),g.title=d?d:"",r+=UTIL.DOM.getOuterHTML(g))}return{linkString:r,isLink:a}},y=function(e,t,l,n){if(e){if(null!=t&&""!=t){var a=/(;|,|{|}|[|]|$|!|`|\|<|>)/g,r="",s="";r=t;var o="";s=t.replace(a," "),r="";for(var d="",g=0,f=0,c=[],h=s.split("\n"),u=[],C=0,v=h.length,m=e.style.color,p=0;v>p;p+=1){u=h[p].split(" "),C=u.length;for(var b=0;C>b;b+=1)c=c.concat(u[b])}for(i=0;i<c.length;i++){i>0&&(d=t.charAt(o.length));var R=U(c[i],c[i],!0,d,"",m);R.isLink?(r+=R.linkString,f+=1):(r+=R.linkString,g+=1),o+=d+c[i]}setCellInnerHTML(e,encodeBlankSpaces(r.replace(/\n/g,"<br>"),!0)),L(e,l,n)}if(0==g&&1==f)e.setAttribute("hyper","full");else if(g>=0&&f>0){e.setAttribute("hyper","multi");var x=getCellInnerHTML(e);addFlexBoxDiv(e,x)}else{e.removeAttribute("hyper");var N=e.className,O=isRTL?/( (fa|ta)[lc])(\b)/i:/( (fa|ta)[rc])(\b)/i;O.test(N)||-1!=N.indexOf(" W")||isRTL||removeFlexBoxDiv(e)}}},k=function(l,n,i,a,r,s,o,d,g){if(l=l?l:"add",n=n?n:"",i=i?i:"false",d||(d=g=""),a?(startR=a,startC=r,endR=s,endC=o):(startR=getCellRange().startRow,startC=getCellRange().startCol,"remove"!=l?(endR=getCellRange().startRow,endC=getCellRange().startCol):(endR=getCellRange().endRow,endC=getCellRange().endCol)),!ProtectedRanges.isRangeLocked(startR,startC,endR,endC)){cellPrevState.sourceSheet!==CURRSHEETNAME&&(showsheet("sheetdiv-"+WorkSheets.getSheetCodeFromName(cellPrevState.sourceSheet),"open",!1,!1),startR=cellPrevState.row,startC=cellPrevState.col,endR=cellPrevState.row,endC=cellPrevState.col);var f=new RequestParameters(ActionConstants.HYPERLINK),c=getCellContent();if(c=encodeURIComponent(c),"remove"!=l){var h="";if("true"!=i)if("Web"==t){d=e("#WebText").val(),g=e("#WebUrl").val();var u=g.toLowerCase(),C=u.length;if(!(0===u.indexOf("http://")&&C>7||0===u.indexOf("https://")&&C>8||0===u.indexOf("ftp://")&&C>6||0===u.indexOf("telnet://")&&C>9||0===u.indexOf("gopher://")&&C>9||0===u.indexOf("rlogin://")&&C>9||0===u.indexOf("nntp://")&&C>7||0===u.indexOf("url://")&&C>6||0===u.indexOf("www.")&&C>4||0===u.indexOf("#")))return showAlertDialog(jsMsg["Error.Hyperlink.Invalid.Url"]),setCaretPos(getObj("WebUrl"),"END"),!1;d=""==d.trim()?g:d,h=g}else if("Internal"==t){d=e("#InternalText").val();var v=e("#InternalUrl").val();if(v){var m=tempRefName=refLoc="",p=CURRSHEETNAME;if(CellUtils.isDefinedName(v)||CellUtils.isDefinedSheet(v))CellUtils.isDefinedSheet(v)?p=v:CellUtils.isDefinedName(v)&&(m=v,tempRefName=v,p="");else{if(v=v.replace(/\$/g,"").replace(".","!"),!CellUtils.checkCellLbl(v))return setCaretPos(getObj("InternalUrl"),"END"),e("#InternalUrl").select(),!1;p=v.substring(0,v.indexOf("!")),p=""==p?CURRSHEETNAME:CellUtils.getRequiredSheetNames(p).sheetName,refLoc=v.substring(v.indexOf("!")+1,v.length)}if(""!=p){var b=p;-1!=p.indexOf(" ")&&(b="'"+p+"'"),m=""!=refLoc?p+"."+refLoc:p,tempRefName=""!=refLoc?b+"."+refLoc:b}d=""==d.trim()?m:d,g="#"+m,h="#"+tempRefName}}else if("Email"==t){if(d=e("#EmailText").val(),g=e("#EmailUrl").val(),mailId=-1!=g.indexOf(":")&&"mailto"==g.substring(0,g.indexOf(":"))?g.substring(7,g.length).trim():g,""!=mailId){var R=getInvalidEmailError(mailId.trim());if(null!=R)return showAlertDialog(R),setCaretPos(getObj("EmailUrl"),"END"),!1}d=""==d.trim()?g:d,h=g}if(""==g.trim()||"mailto:"==g.trim()||"http://"==g.trim())return S(""),!1;if(""==n&&f.setParameters(WorkSheets.getSheetCodeFromName(cellPrevState.sourceSheet),startR,startC,endR,endC,l,encodeURIComponent(d),encodeURIComponent(h)),d&&g){var x=new AjaxRequest;x.init("POST",f.getURL(),!0,f.getParametersAsString()),actionManager.addRequest(x)}sheetdialog.close()}if("remove"==l){""==n&&f.setParameters(WorkSheets.getAssociatedActiveSheetName(),startR,startC,endR,endC,"remove");var x=new AjaxRequest;x.init("POST",f.getURL(),!0,f.getParametersAsString()),actionManager.addRequest(x);var N=getCell(startR,startC),O=getCellContent();E(N,l,O)}}},E=function(e,t,l,n){if(null!=e)if("remove"==t)setCellInnerHTML(e,""),e.setAttribute("hyper","null"),setCellContent(e,l);else{setCellContent(e,l),setCellInnerHTML(e,revertQuote(n)),e.setAttribute("hyper","full");var i=e.style.color;L(e,i)}},L=function(e,t,l){if(null!=e){var n=getHyperLinkInCell(e).childTag,i=e.style.color,a="",r="",s=e.style.backgroundColor,a=t?t:i?i:a,r=l?l:s?s:r;("rgb(0, 0, 0)"==a||"rgb(0,0,0)"==a||"#000000"==a)&&(r?"rgb(255,255,255)"!=r&&(a="inherit"):a="","rgb(255,255,255)"===r&&(a=""));var o=e,o=(e.className,getCellContentNode(e));if(T(o))for(var d=(getChildNodesLength(o),o.childNodes),g=d.length,f=0;g>f;f++)if(n=d[f],null!=n&&"A"==n.nodeName){var c=a?"inherit":"blue";if(n.style.color=c,browser_ie){var h=e.className,u="",C=getCSSStyleRegex("fontSize").exec(h);null!=C&&(u=C[0]);var v=getCSSStyleRegex("fontFamily").exec(h);null!=v&&(u+=v[0]),""!=u&&(n.className=u),n.style.fontSize=getCurrentStyle(e,"fontSize"),n.style.fontFamily=getCurrentStyle(e,"fontFamily"),n.style.display="inline-block"}else n.style.font="inherit"}}},T=function(e){var t=0;if(e){var l=e.childNodes;if(l)for(var n=l.length,i=0;n>i;i++){var a=l[i];if(isHyperLink(a)){t=1;break}}}return t},A=function(e,t,l,n){if(l){var i=n?l:U(l,t,!0,"",!0).linkString;E(e,"add",t,i)}else y(e,t)},j=function(e){"remove"==e&&k("remove")},H=function(){return r};return appEvent.on("changelink",function(e){R(e)}),appEvent.on("addlink",function(e,t,l,n){A(e,t,l,n)}),appEvent.on("setlink",function(e,t,l){j(e,t,l)}),appEvent.on("setlinkstyle",function(e){L(e)}),appEvent.on("showLinkDialog",function(){Hyperlink.showDialog()}),{showDialog:g,isRangeFocused:H,responseHandler:j,callGotoMethod:x}}(jQuery);
function split(e){return e.split(/,\s*/)}function extractLast(e){return split(e).pop()}var functionDescription=void 0,autocomplete={types:{FORMULA:"formula",TEXT:"text"},options:{helpTip:!1,syntaxTip:!1},defaultFormulaEls:"#cF,#Tv",init:function(e,t){e||(e=this.defaultFormulaEls);var a={},r=this.types,n=t.type;$.extend(a,t),$(e).autocomplete({minLength:1,autoFocus:!0,delay:100,position:{my:"left top",at:"left bottom",collision:"fit flip",offset:"5 5"},create:function(){var e,t=$(this),a=t.data("autocomplete");t.unbind("keydown.autocomplete").unbind("keypress.autocomplete").unbind("blur.autocomplete").bind("keydown.autocomplete",function(t){if(!a.options.disabled&&!a.element.attr("readonly")){e=!1;var r=$.ui.keyCode,i=t.keyCode;switch(i){case r.PAGE_UP:a._move("previousPage",t);break;case r.PAGE_DOWN:a._move("nextPage",t);break;case r.UP:break;case r.DOWN:break;case r.ENTER:case r.NUMPAD_ENTER:a.menu.active&&(e=!0,t.preventDefault());case r.TAB:if(!a.menu.active)return;formulaMenuUtil.isFMenuOpened&&a.menu.select(t);break;case r.HOME:case r.ESCAPE:case r.END:formulaMenuUtil.isFMenuOpened&&a.close(t),27==i&&formulaSyntaxTip.hideMe();break;default:clearTimeout(a.searching),a.searching=setTimeout(function(){a.term!=a.element.val()&&(a.selectedItem=null,a.search(null,t))},a.options.delay)}}}).bind("keypress.autocomplete",function(t){e&&(e=!1,t.preventDefault())}).bind("blur.autocomplete",function(){a.options.disabled||clearTimeout(a.searching)})},search:function(){var e=$(this),t=e.val();if(0==t.indexOf("=")){if(void 0===functionDescription)return autocomplete.getFormulasInfo(),!1;this===cellField&&removeCSSStyle("textAlign",cellField);var r=getFieldValByCaretPos("before"),i=r.split('"').length-1,n=r.length,o=t.trim().length,l=0,s=formulaMenuUtil.itemsMatched(r);if(s&&(l=s.length),n>o||i%2!=0||!l)return e.autocomplete("close"),!1;var u=e.autocomplete("widget");l>=12?u.css("overflow-y","scroll"):u.css("overflow-y","auto");var c=getLastIndexOfRegex(r.trim());if(-1!=c){var f,d=r.substr(0,c+1),p=/\n/g,m=r.match(p);if(m){var h=r.lastIndexOf("\n"),g=r.substr(h);g&&(f=getCellValueWidth(g))}else f=getCellValueWidth(d);if(a.syntaxTip){var v=formulaSyntaxTip.getObj();if(v.is(":visible")){var x=v.outerHeight();x+=5,f=f+" "+x}else f+=" 6"}else f+=" 6";var y=isEditingInExprField&&RTLlang?"right top":"left top",T=isEditingInExprField&&RTLlang?"right bottom":"left bottom";e.autocomplete("option","position",{my:y,at:T,collision:"fit flip",offset:f})}}},source:function(e,t){var a=getFieldValByCaretPos("before");if(0==a.indexOf("=")){var r=formulaMenuUtil.getMatchedItems(a),n=0;if(r&&(n=r.length),!(n>0))return void $(this).autocomplete("close");t(r)}else if(null!=intAutoComplete){var o=e.term;o=o.replace(/[ ]*/,"");var l=o.lastIndexOf(",");for(-1!=l&&(o=o.substring(l+1).replace(/[ ]*/,"")),i=0;i<intAutoComplete.length;i++){var s=getCellContent(getCell(currRow,intAutoComplete[i].PKColNo));currCol==intAutoComplete[i].autocompleteColNo&&""!=s&&t($.ui.autocomplete.filter(intAutoComplete[i].autocompleteDisplay,extractLast(o)))}}},focus:function(e,t){var i=getFieldValByCaretPos("before");if(n==r.FORMULA&&a.helpTip&&0==i.indexOf("=")){var o=t.item.description;o=decodeURIComponent(o);var l=$(".ui-menu-item .ui-state-hover"),s=l.parent(),u=s.parent(),c=s.offset(),f=c.top,d=u.offset(),p=d.left,m=u.width();formulaHelper.showHelp(o,p,f,m)}return!1},open:function(){formulaMenuUtil.isFMenuOpened=!0},select:function(e,t){var i=getFieldValByCaretPos("before");if(n==r.FORMULA&&0==i.indexOf("=")){if(!e.ctrlKey&&!e.altKey){var o=e.which,l=getFieldValByCaretPos("before"),s=l.length,u=this.value,c=u.length,f=u.substr(s,c-1);l=l.trim();var d=getLastIndexOfRegex(l);l=l.substr(0,d+1);var p=t.item.label;l+=p;var m=(getFieldValByCaretPos("After"),f.charAt(0)),h=t.item.type.trim();"NAMEDRANGE"!=h&&"("!=m&&(l+="(");var g=l.trim()+f,v=document.activeElement;if(this.value=g,(this===cellField||this===exprField)&&(cellField.value=g,exprField.value=g,setCellFieldWidth(),appEvent.trigger("formulaSuggest.ValueChanged",[v.id,!0])),setCaretPos(v,l.length),a.syntaxTip&&"FUNCTION"==h){var x=$(this);x.autocomplete("widget").is(":visible")&&formulaSyntaxTip.showTip(l,x,o)}}}else if(null!=intAutoComplete){var y=cellField.value,T=cellField.value.lastIndexOf(",");if(-1!=T){{var F=y.substring(0,T+1);F+t.item.value}cellField.value=F+t.item.value}else cellField.value=t.item.value}return!1},close:function(){formulaMenuUtil.hideMenu()},change:function(){formulaMenuUtil.isFMenuOpened=!1,$("#fHelpDiv").hide()}}),this.overrideDefaults()},getFormulasInfo:function(){var e=new RequestParameters(ActionConstants.GET_FORMULA_SUGGEST_INFO),t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),t.addEventListener("onComplete",function(e){functionDescription=JSON.parse(e.responseText)[JSONConstants.FORMULA_SUGGEST_INFO]}),t.sendRequest()},destroy:function(e){$(e).autocomplete().autocomplete("destroy")},overrideDefaults:function(){$.ui.autocomplete.prototype._renderItem=function(e,t){if("FUNCTION"===t.type||"NAMEDRANGE"===t.type){var a=$("<span></span>").text(t.label).css("left",6).css("position","relative"),r=$("<span></span>");r.addClass("FUNCTION"==t.type?"functionicon":"namerangeicon");var i=$("<li></li>").data("item.autocomplete",t).append($("<a></a>").append(r).append(a)).appendTo(e);return i}return $("<li>").data("item.autocomplete",t).append("<a>"+t.label+"</a>").appendTo(e)},$.ui.autocomplete.prototype._move=function(e,t){var a=document.activeElement;(formulaMenuUtil.isFMenuOpened||a!=cellField&&a!=exprField)&&(this.menu[e](t),t.preventDefault())},$.ui.autocomplete.prototype._resizeMenu=function(){},$.ui.menu.prototype._scrollIntoView=function(e){if(this.deactivate(),this.hasScroll()){var t=e.offset().top-this.element.offset().top,a=this.element.scrollTop(),r=this.element.height();0>t?this.element.scrollTop(a+t):t>=r&&this.element.scrollTop(a+t-r+e.height())}this.active=e.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",null,{item:e})},$.ui.menu.prototype.deactivate=function(){var e=$(".ui-menu-item .ui-state-hover");e&&($(e).removeClass("ui-state-hover"),this._trigger("blur",null,{item:e}))},$.ui.menu.prototype.hasScroll=function(){return this.element.height()<this.element[$.fn.prop?"prop":"attr"]("scrollHeight")},$(".ui-autocomplete").mouseout(function(){var e=$(".ui-menu-item .ui-state-hover"),t=e.parent().hasClass("ui-menu-item");t||formulaHelper.hideMe()}),$("#fHelpDiv").hide()}};appEvent.on("book.onbeforesheetswitch",function(){autocomplete.destroy(autocomplete.defaultFormulaEls)});var AutocompleteItem=function(e,t,a,r){this.label=e,this.value=t,this.description=a,this.type=r},formulaMenuUtil={input:function(e){document.getElementById("cF").style.direction="ltr",document.getElementById("Tv").style.direction="ltr";var t=e.substr(1).trim(),a=getLastIndexOfRegex(t.trim());return-1!=a&&(t=t.substr(a+1)),t},functionsMatched:function(e){var t=[];t=functionDescription[JSONConstants.FUNCTION_LOCALIZED_NAMES];var a=matchString(e,t);return a},matchedNameRanges:function(e){for(var t=NamedRange.getRangeandExpression(),a=[],r=t.length,i=0;r>i;i++)a[i]=t[i]+"!";var n=[];return n=matchString(e,a),n?n:void 0},sheets:function(e){for(var t=[],a=($("#sheetsTab"),getObj("sheetsTab").getElementsByTagName("TD")),r=a.length,i=0;r-1>i;i++)t[i]=a[i].getAttribute("sheetname");matchString(e,t);return t},ignoreCaseSort:function(e,t){var a=e.toLowerCase(),r=t.toLowerCase();return r>a?-1:a>r?1:0},itemsMatched:function(e){var t=this.input(e),a=this.functionsMatched(t),r=this.matchedNameRanges(t),i=a;return r&&(i=a.concat(r).sort(this.ignoreCaseSort)),i},getMatchedItems:function(e){for(var t=this.itemsMatched(e),a=t.length,r=[],i=NamedRange,n=0;a>n;n++){var o=t[n],l=o.length;if("!"==t[n].charAt(l-1)){o=o.substring(0,l-1);var s=i.getDefinedNameProperty(o,"CONTENT");s=jsMsg.Refersto+" "+s,r[n]=new AutocompleteItem(o,o,s,"NAMEDRANGE")}else{var u=functionDescription[JSONConstants.FUNCTION_LOCALIZED_NAMES].indexOf(o),c=functionDescription[JSONConstants.FUNCTION_TIPS][u];r[n]=new AutocompleteItem(o,o,c,"FUNCTION")}}return r},hideMenu:function(){this.isFMenuOpened=!1;for(var e=["cF","Tv"],t=e.length,a=0;t>a;a++){var r=e[a],i=$("#"+r).autocomplete("widget"),n=i.is(":visible");n&&(i.hide(),i.html(""))}$("#fHelpDiv").hide()},isFMenuOpened:!1,disableAutoComplete:function(e){var t=$(".cF,#Tv"),a=t.autocomplete("option","disabled");a?(t.autocomplete("enable"),$("#"+e).autocomplete("search")):(t.autocomplete("close"),t.autocomplete("disable"))}},$formulaSyntaxDiv,formulaSyntaxTip={options:{id:"aFSyntax",clas:"formulaSyntax",appendTo:"body",position:{my:"left top",at:"left bottom",collision:"none"}},isVisible:function(){var e=this.getObj(),t=e.is(":visible");return t},getObj:function(){var e=this.options.id;e="#"+e;var t=$(e);return t},hideMe:function(){var e=this.getObj();e.is(":visible")&&e.css("display","none")},showTip:function(e,t,a,r,i){return 36!=a&&27!=a&&functionDescription?void formulaParser.getCurrFormulaDetails(e,a,r,i,t):void this.hideMe()},_construct:function(e,t,a,r,i,n,o){e=e.toUpperCase();var l=functionDescription[JSONConstants.FUNCTION_LOCALIZED_NAMES].indexOf(e),s=functionDescription[JSONConstants.FUNCTION_MAX_ARGS][l],u=["en","es","de","fr","pl"];if(-1!=l){var c=functionDescription[JSONConstants.FUNCTION_SYNTAX][l];if(c){if(!$formulaSyntaxDiv){var f=this.options;$formulaSyntaxDiv=$("<div>").attr("id",f.id).addClass(f.clas).appendTo(f.appendTo)}this._removeChilds();var d=r;$formulaSyntaxDiv.data("formulaData")&&$formulaSyntaxDiv.removeData("formulaData");var p={indx:d,name:e};$formulaSyntaxDiv.data("formulaData",p);var m,h,g;return m=$("<a>").addClass("formulaHelpLink").text(e).bind("click",function(){var t,a;-1!=u.indexOf(funcLangCode)?(t=funcLangCode,a=functionDescription[JSONConstants.FUNCTION_NAMES][l]):(t="en",a=e);var r=ctxpath+"html/functions/"+t+"/"+a+".html",i={width:600,title:jsMsg.FunctionReference,dontSubmit:!0};sheetdialog.open("functionhelpdialog",i,void 0,void 0,r)}).appendTo($formulaSyntaxDiv),h=$("<span>").text("(").addClass("openBrace").appendTo($formulaSyntaxDiv),this._addArguments(c,t,a,s),g=$("<span>").text(")").addClass("closedBrace").appendTo($formulaSyntaxDiv),this._removeAndAddBold(t),this.setLeftAndTop(d,o,e),void this._dragMe()}}},_addArguments:function(e,t,a,r){var i,n=e.substr(1,e.length-2),o=n.split(";"),l=o.length;if(r>=30){var s=o[0];s+=";";{var u,c=o[1],f=/[a-z]+/i,d=c.match(f),p=d[0],m=$("<span>").addClass("fParams");m.clone().text(s).appendTo($formulaSyntaxDiv)}if(r>30){u=p+"1;";{m.clone().text(u).appendTo($formulaSyntaxDiv)}}for(var n,h=a+2,g=1;h>g;g++)u="["+p+(g+1)+"];",n=m.clone().text(u).appendTo($formulaSyntaxDiv);{m.clone().text("...").appendTo($formulaSyntaxDiv)}m.remove()}else for(var g=0;l>g;g++){var v=o[g].trim();i=$("<span>").addClass("fParams").appendTo($formulaSyntaxDiv),i.text(g==l-1?v:v+";")}this._attachMouseEvents(a)},_highlightNextArg:function(e,t,a){var r=$("#aFSyntax").find("span.fParams"),i=r.last(),n=i.prev();if(44==a||59==a){var o=n.text(),l=/[a-z]+/gi,s=o.match(l),u=s[0];u+=t+2,u="["+u+"];";{$("<span>").addClass("fParams").text(u).insertBefore(i)}}8==a&&n.remove(),r.removeClass("fParamBold"),$(r[e]).addClass("fParamBold")},_attachMouseEvents:function(e){e+=1;var t=$("#aFSyntax").find("span.fParams:lt("+e+")");t.mousedown(function(){if(!browser_ie){var t=this;formulaSyntaxTip._selectArgTxtInField(t,e)}}).mouseup(function(){if(browser_ie){var t=this;formulaSyntaxTip._selectArgTxtInField(t,e)}}).css("cursor","pointer")},_functionHelpWindow:function(e){window.open("/html/functions/"+funcLangCode+"/"+e+".html","myWindow","status = 1, height = 250, width = 720, resizable = 0, scrollbars=yes, location = yes ")},_selectArgTxtInField:function(e,t){var a=$("#aFSyntax").find("span.fParams"),r=a.index(e);formulaSyntaxTip._removeAndAddBold(r),formulaParser.selectArgText(r,t)},_removeChilds:function(){var e=$formulaSyntaxDiv;if(e){var t=e.children();t.length>0&&e.empty()}},setLeftAndTop:function(e,t){var a,r,i=formulaParser.getFieldValueWidthByCaretPos(e);if(isEditingInExprField){var n=$("#cHC").position();a=isRTL?i+getOffsetRight(exprField):i+findPosX(exprField),r=n.top}else{$formulaSyntaxDiv.css("left",0);var o=$formulaSyntaxDiv.outerWidth(),l=getColLeft(currCol)+rowHeadWidth-getNormalizedScrollLeft();total=o+l,pageWidth=$(window).width(),total+=i;var s=$("#ssVScrollbar"),u=s.offset(),c=u.left,f=s.outerWidth(),d=c+f;a=isRTL?d>=total?pageWidth-o:i+getColLeft(currCol)+rowHeadWidth-getNormalizedScrollLeft():total>=d?pageWidth-o:i+getColLeft(currCol)+sheetLeft-getSheetScrollLeft(),r=getRowTop(currRow)+sheetTop-getSheetScrollTop()+t.outerHeight()}if(isRTL){document.getElementById("aFSyntax").style.left="";var p={right:a,top:r,display:"block"}}else{document.getElementById("aFSyntax").style.right="";var p={left:a,top:r,display:"block"}}if(isEditingInExprField)if(RTLlang){document.getElementById("aFSyntax").style.left="";var p={right:a,top:r,display:"block"}}else{document.getElementById("aFSyntax").style.right="";var p={left:a,top:r,display:"block"}}$formulaSyntaxDiv.css(p)},_removeAndAddBold:function(e){var t=$("#aFSyntax").find("span.fParams");t.removeClass("fParamBold"),$(t[e]).addClass("fParamBold")},_dragMe:function(){var e=this.getObj();e.draggable({containment:"parent"})}},formulaParser={regexOptions:{formulaRegex:/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,openRound:/\(/g,closedRound:/\)/g,roundPair:/\(([^\(])*?\)/g,openFlower:/{/g,closedFlower:/}/g,flowerPair:/{([^{])*?}/g,openSquare:/\[/g,closedSquare:/\]/g,squarePair:/\[([^\[])*?\]/g,doubleQuotes:/"/g,doubleQtStrings:/".*?"/g,separators:/[,;]/g,newLine:/\n/g},getCurrFormulaDetails:function(e,t,a,r,i){if(0==e.indexOf("=")){if(37==t||44==t||59==t){var n=e.split('"').length-1;if(n%2!=0)return}var o=e,l=getFieldValByCaretPos("after",t),s=o.length,u=l.length,c=o.charAt(s-1);switch(t){case 57:r&&(o+="(");break;case 8:a||(o=o.substr(0,s-1));break;case 48:r&&(o+=")");break;case 222:o+='"';break;case 46:l=l.substr(1)}if(8==t||r&&57==t||r&&48==t){var n=o.split('"').length-1;if(n%2!=0)return}var f=o+l;s=o.length,u=l.length;var d=o,p=this;d=p.escDblQtStrings(d);var m=[];if(m=p.getFnameAndIndx(d),!m)return void formulaSyntaxTip.hideMe();var h=m[0],g=m[1],v=m[2];v=p.getCurrentFormulaText(v);var x=g.length,y=h+x,T=f.substr(y);T=p.escapeStrings(T),T=p.filterIncompleteArg(T)[0],T=p.getCurrentFormulaText(T);var F=p.separators(v),b=p.separators(T);g=g.substr(0,x-1);var C=[];C[0]=g,C[1]=F,C[2]=b,C[3]=h,C[4]=c,formulaSyntaxTip._construct(g,F,b,h,t,c,i)}},getFnameAndIndx:function(e){var t=e.length,a=/[a-z\u00c0-\u00d6\u00d8-\u00f6\u0100-\u017F]([_.a-z0-9\u00c0-\u00d6\u00d8-\u00f6\u0100-\u017F])*\(/gi,r=e.match(a),i=[];if(r)for(var n=r.length,o=t,l=n-1;l>=0;l--){var s=r[l],u=s.length;if(o=e.substr(0,o).lastIndexOf(s),-1==o);else{var c=e.charAt(o-1),f=/[-()+=,~@%^*"|;:<>'&}{\n ]/g,d=f.test(c);if(!d)continue;var p=o;p+=u;var m=e.substr(p);m=this.filterIncompleteArg(m)[0],i[0]=o,i[1]=s,i[2]=m;var h=this.isThisAFormula(s);if(h){var g=this.isThisCurrentFormula(m);if(g){if(0==l)return null;continue}return i}}}},getCurrentFormulaText:function(e){e=this.escapeBrackets(e,"round");var t=e.split("(").length-1,a=e.split(")").length-1;if(a){var r=e.indexOf(")");-1!=r&&(e=e.substr(0,r))}else if(t){var r=e.indexOf("(");-1!=r&&(e=e.substr(0,r))}else e=e;return e},isThisCurrentFormula:function(e){e=this.escapeRoundBrkts(e);var t,a=(e.split("(").length-1,e.split(")").length-1);return t=a?!0:!1},selectArgText:function(e){var t=$formulaSyntaxDiv.data("formulaData"),a=t.indx,r=t.name,i=a+r.length+1,n=getValByField(),o=formulaParser.filterIncompleteArg(n),l=o[0],s=o[1],u=l.substr(i);u=this.getCurrentFormulaText(u);var c=this.separators(u),f=0,d=0;u=u.replace(/;/g,",");for(var p=0;e>p;p++){var m=",",h=0;h=u.indexOf(m,f),f=h+m.length,d=h}0!=e&&(d+=1);var g=u.substr(d),v=r.length+1,x=a+v+d,y=(u.length,g.length),T=/[,;]/g,F=g.match(T);if(F&&(y=g.indexOf(F[0])),0==e&&(x=a+v),e==c){var b=s.length;y+=b}y=x+y,isEditingInExprField?selectText(exprField,x,y):selectText(cellField,x,y)},bracketType:{round:"round",flower:"flower",square:"square"},fieldValue:function(){var e;return e=isEditingInExprField?exprField.value:cellField.value},separators:function(e){var t=/[,;]/g,a=0,r=e.match(t);return r&&(a=r.length),a},getMatchCount:function(e,t){var a=0,r=e.match(t);return r&&(a=r.length),a},escDblQtStrings:function(e){var t=this.regexOptions.doubleQtStrings,a=this.replaceBy,r=e.match(t);return r&&(e=e.replace(t,a)),e},escapeRoundBrkts:function(e){for(var t=this.regexOptions.roundPair,a=e.split("(").length-1,r=e.split(")").length-1,i=Math.min(a,r),n=this.replaceBy,o=0;i>o;o++){var l=e.search(t);-1!=l&&(e=e.replace(t,n))}return e},replaceBy:function(e){var t=formulaParser.replaceWith(e);return t},replaceWith:function(e){var t="",a=e.length,r=a+1;return t=new Array(r).join("~")},isThisAFormula:function(e){var t,a=e.substr(0,e.length-1);return a&&(a=a.toUpperCase(),t=functionDescription[JSONConstants.FUNCTION_LOCALIZED_NAMES].indexOf(a)),-1!=t?1:0},escapeStrings:function(e){var t=this.regexOptions.doubleQtStrings,a=e.match(t);if(a){var r=this.replaceBy;e=e.replace(t,r)}return e},filterIncompleteArg:function(e){var t;t=e,t=this.escapeStrings(t),t=this.escapeBrackets(t,"flower"),t=this.escapeBrackets(t,"square");var a=/"/g,r=/{/g,i=/\[/g,n=Number.POSITIVE_INFINITY,o=n,l=n,s=n,u=t.match(a),c=t.match(r),f=t.match(i);u&&(o=t.indexOf(u[0])),c&&(l=t.indexOf(c[0])),f&&(s=t.indexOf(f[0]));var d=Math.min(o,l,s),p="",m=[];return-1!=d&&n>d&&(p=t.substr(d),t=t.substr(0,d)),m[0]=t,m[1]=p,m},escapeBrackets:function(e,t){var a,r,i,n=this;if(t==n.bracketType.round)a=n.regexOptions.openRound,r=n.regexOptions.closedRound,i=n.regexOptions.roundPair;else if(t==n.bracketType.flower)a=n.regexOptions.openFlower,r=n.regexOptions.closedFlower,i=n.regexOptions.flowerPair;else{if(t!=n.bracketType.square)return;a=n.regexOptions.openSquare,r=n.regexOptions.closedSquare,i=n.regexOptions.squarePair}var o=0,l=0;o=n.getMatchCount(e,a),l=n.getMatchCount(e,r);var s=o+l,u=Math.floor(s/2);if(u)for(var c=n.replaceBy,f=0;u>f;f++){var d=e.search(i);-1!=d&&(e=e.replace(i,c))}return e},getFieldValueWidthByCaretPos:function(e){var t=this.fieldValue();e&&(t=t.substr(0,e));var a=this.regexOptions.newLine,r=t.match(a);if(r){var i=t.lastIndexOf("\n");-1!=i&&(t=t.substr(i))}return getCellValueWidth(t)}},getFieldValByCaretPos=function(e,t){var a,r,i,n,o=!1,l="",s=document.activeElement;if(i=s===cellField?cellField:s===exprField?exprField:s,a=getCaretPos(i),r=i.value,o=isTextSelected(i),o&&t&&(l=getSelectedText(i)),a<r.length){var u=r.substr(a,r.length);u=u.split(formulaParser.regexOptions.formulaRegex)[0],a+=u.length}if("before"==e)n=r.substr(0,a);else{var c=l.length;c&&(a+=c),n=r.substr(a)}return n},getValByField=function(){var e;return e=isEditingInExprField?exprField.value:cellField.value},getLastIndexOfRegex=function(e){var t=e.match(formulaParser.regexOptions.formulaRegex);if(!t)return-1;var a=t.length;if(a>0){var r=t[a-1],i=e.lastIndexOf(r);return i}},$formulaHelpTip,formulaHelper={_construct:function(e,t,a,r){$formulaHelpTip||($formulaHelpTip=$("<div>").attr("id","fHelpDiv").addClass("fHelper").appendTo("body")),$formulaHelpTip.text(e),$formulaHelpTip.css("left",0);var i=7,n=$formulaHelpTip.width(),o=r+t+i,l=$(window).width(),s=o+n;if(s>=l){var u=1.6;o=t-(n+i+u)}$formulaHelpTip.css("left",o),$formulaHelpTip.css("top",a),$formulaHelpTip.show(),this._dragMe()},showHelp:function(e,t,a,r){this._construct(e,t,a,r)},hideMe:function(){$("#fHelpDiv").hide()},_dragMe:function(){$formulaHelpTip.draggable({containment:"parent"})}};
var convertForm=function(){function e(){if(WebForm.isFormAvailable)sheetdialog.showAlertDialog(jsMsg["Form.CreateMessage.WhileSheetContainingForm"]);else{if(range=t(),r(range))return void sheetdialog.showAlertDialog(jsMsg["Form.columnLimitExceed"]);focusCellRange(range.startRow,range.startCol,range.endRow,range.endCol,!1,!0),n()}}function t(){var e=getCellRange();if(!isCellRange()){var t=new RequestParameters(ActionConstants.DETECT_FORM_RANGE);t.setParameters(e.startRow,e.startCol,e.endRow,e.endCol,WorkSheets.getAssociatedActiveSheetName(),CURRSHEETNAME);var r=new AjaxRequest;r.init("POST",t.getURL(),!1,t.getParametersAsString()),r.addEventListener("onComplete",function(t){var r=JSON.parse(t.responseText);e=CellUtils.getRangeFromCellLbl(r.result)}),r.sendRequest()}return e}function r(e){return e.endCol>=253||usedCursCol>=253?!0:!1}function o(){var e=document.getElementById("confirmForm");e.disabled=!0,e.classList.add("ui-state-disabled"),$("#convertToFormPreviewTable").html(""),$("#convertToFormPreviewTable").addClass("lI")}function n(){var e={init:function(){a(),WebForm.createFormCallback("_formName"),$("#rangeId").focus(function(){var e=this;RangeSelector.on({el:e,appendSheetName:!0,allowSheetSwitch:!0,callback:function(e){var e=CellUtils.getRangeFromCellLbl(e);return r(e)?(sheetdialog.showAlertDialog(jsMsg["Form.columnLimitExceed"]),convertForm.isPreviewAvailable=!1,void m()):(o(),void d(e))}})}),o(),d(CellUtils.getRangeFromCellLbl(document.getElementById("rangeId").value)),s()},destroy:function(){RangeSelector.off()}},t={width:847,title:jsMsg["DataTab.CreateForm"]};sheetdialog.open("convertFormDialog",t,e)}function a(){var e=getCellRange();$("#rangeId").val(CURRSHEETNAME+"."+CellUtils.constructCellName(e.startRow,e.startCol,e.endRow,e.endCol),!1,CURRSHEETNAME)}function s(){var e=document.getElementById("cancelForm");e.addEventListener("click",C);var t=document.getElementById("confirmForm");t.addEventListener("click",A),document.getElementById("_formName").addEventListener("keydown",function(e){(13==e.which||13==e.keyCode)&&A()});var r=document.getElementById("dfHdr");document.getElementById("dfHdr").checked=convertForm.firstRowAsHeader,r.addEventListener("click",function(){i()});var o=document.getElementById("rangeId");o.onchange=function(){l(this.value)}}function l(e){chart.isValidRange(e)?(o(),d(getCellRangeFromString(document.getElementById("rangeId").value))):showAlertDialog(jsMsg["Form.RangeErrorMessage"])}function i(){convertForm.isPreviewAvailable&&(convertForm.firstRowAsHeader=convertForm.firstRowAsHeader?!1:!0,m())}function c(){$("#convertToFormPreviewTable").removeClass("lI")}function d(e){if(void 0!=e&&null!=e)if(w(e)){var t=new RequestParameters(ActionConstants.PREDICT_DATATYPES);t.setParameters(e.startRow,e.startCol,e.endRow,e.endCol,WorkSheets.getAssociatedActiveSheetName(),CURRSHEETNAME);var r=new AjaxRequest;r.init("POST",t.getURL(),!0,t.getParametersAsString()),r.addEventListener("onComplete",function(t){convertForm.dataTypes=t.responseText,convertForm.isPreviewAvailable=!0,convertForm.formRange=e,g(),c(),m()}),r.sendRequest()}else convertForm.isPreviewAvailable=!1,c(),m()}function m(){var e=document.getElementById("confirmForm");if(convertForm.isPreviewAvailable){e.disabled=!1,e.classList.remove("ui-state-disabled");var t=R(),r=E(),o={width:595,height:185,colselection:!0,columnWidths:r,startRow:0};ztable.createTable($("#convertToFormPreviewTable"),t,o,!0,dataTypeList),$.ui.utils.initComponents($("#convertToFormPreviewTable"))}else{e.disabled=!0,e.classList.add("ui-state-disabled"),$("#convertToFormPreviewTable").html("");var n=document.createElement("div");n.className="nDf",n.textContent=jsMsg["Form.RangeErrorMessage"],$("#convertToFormPreviewTable").append(n)}}function v(e,t){var r=["SINGLE_LINE","MULTI_LINE","NUMBER","DECIMAL","NAME","ADDRESS","PHONE","EMAIL","DATE","TIME","DROPDOWN","RADIO","MULTIPLE_CHOICE","CHECKBOX","DECISION_BOX","DATETIME","WEBSITE","CURRENCY","RATING"],o=["Single Line","Multi Line","Number","Decimal","Name","Address","Phone","Email","Date","Time","Dropdown","Radio","Multiple Choice","Checkbox","Decision Box","Date-Time","Website","Currency","Rating"];return 1==t?o[r.indexOf(e)]:r[o.indexOf(e)]}function g(){dataTypeList=[];var e=JSON.parse(convertForm.dataTypes),t=e.result;convertForm.previewData=e.previewData,convertForm.lastRowData=e.lastRowData,convertForm.firstRowAsHeader=e.isFirstRowAsHeader,document.getElementById("dfHdr").checked=convertForm.firstRowAsHeader;var r=0;for(var o in t)dataTypeList[r++]=v(t[o].type,1)}function u(){var e=JSON.parse(convertForm.dataTypes).result,t=document.getElementsByClassName("hdrHt"),r={};convertForm.selectedColumnList=[];for(var o=0,n=0;n<t.length;n++)if(t[n].children[2].children[0].checked){var a={};a.type=v(t[n].children[0].value,2),a.colHead=t[n].children[2].children[2].value.trim(),a.values="RADIO"==a.type||"DROPDOWN"==a.type?f(n+convertForm.formRange.startCol,a.type):"CHECKBOX"==a.type||"MULTIPLE_CHOICE"==a.type?0==e[n+convertForm.formRange.startCol].values.length?f(n+convertForm.formRange.startCol,a.type):e[n+convertForm.formRange.startCol].values:[],r[o]=a,convertForm.selectedColumnList[o++]=n}return r}function f(e,t){for(var r=[],o=convertForm.firstRowAsHeader?convertForm.formRange.startRow+1:convertForm.formRange.startRow;o<=convertForm.formRange.endRow;o++){var n=getCell(o,e);if(null!=n&&!r.contains(n.textContent)&&""!=n.textContent&&(r.push(n.textContent.trim()),("CHECKBOX"==t||"MULTIPLE_CHOICE"==t)&&5==r.length||"RADIO"==t&&4==r.length||"DROPDOWN"==t&&10==r.length))return r}return 0==r.length&&r.push("option 1","option 2","option 3"),r}function R(){$("#convertToFormPreviewTable").html("");var e=[],t=convertForm.formRange,r=0,o=0,n=[];if(!convertForm.firstRowAsHeader){for(var a=t.startCol;a<=t.endCol;a++)n[o]=dataTypeList[o++];e[r++]=n}var s=t.endRow-t.startRow;s=convertForm.firstRowAsHeader?s:s+1;var l=0;if(5>=s)for(var a=t.startRow;a<t.endRow;a++){for(var o=0,n=[],i=t.startCol;i<=t.endCol;i++)n[o]=null!=convertForm.previewData[l][o]?convertForm.previewData[l][o].toString():"",o++;l++,e[r++]=n}else{for(var c=convertForm.firstRowAsHeader?t.startRow+4:t.startRow+3,a=t.startRow;c>a;a++){for(var o=0,n=[],i=t.startCol;i<=t.endCol;i++)n[o]=null!=convertForm.previewData[l][o]?convertForm.previewData[l][o].toString():"",o++;l++,e[r++]=n}var o=0,n=[];e[r++]=n}for(var o=0,n=[],a=t.startCol;a<=t.endCol;a++)n[o]=null!=convertForm.lastRowData[o]?convertForm.lastRowData[o].toString():"",o++;return e[r]=n,e}function C(){sheetdialog.close()}function w(e){var t=!1,e=new Range(e.startRow,e.startCol,e.endRow,e.endCol),r=e.getIterator();return r.iterate(function(e,r){var o=getCell(e,r);""!=o.textContent&&(t=!0,this.stopper=!0)}),t}function E(){for(var e=convertForm.formRange,t=[],r=0,o=e.startCol;o<=e.endCol;o++)t[r++]=160;return t}function h(){for(var e=document.getElementsByClassName("hdrHt"),t=0;t<e.length;t++)if(e[t].children[2].children[0].checked&&""==e[t].children[2].children[2].value.trim())return!0;return!1}function F(){for(var e=document.getElementsByClassName("hdrHt"),t=0;t<e.length;t++)if(e[t].children[2].children[0].checked)return!1;return!0}function A(){var e=document.getElementById("_formName").value;if(e=e.trim(),""==e||e.length>40)return void showAlertDialog(jsMsg["Form.InvalidNameMessage"]);if(h())return void showAlertDialog(jsMsg["Form.emptyColumnHeader"]);if(F())return void showAlertDialog(jsMsg["Form.columnSelectErrorMessage"]);showProgressMessage(jsMsg["Form.CreateProgressMessage"]),e=replaceDisallowedCharsInDocName(e.trim());var t=document.getElementById("_formDescription").value,r=CellUtils.getRangeFromCellLbl(document.getElementById("rangeId").value),o=new RequestParameters(ActionConstants.CONVERT_FORM),n=u();o.setParameters(r.startRow,r.startCol,r.endRow,r.endCol,e,t,convertForm.firstRowAsHeader,JSON.stringify(convertForm.selectedColumnList),JSON.stringify(n),WorkSheets.getAssociatedActiveSheetName(),CURRSHEETNAME);var a=new AjaxRequest;a.init("POST",o.getURL(),!0,o.getParametersAsString()),a.addEventListener("onComplete",function(){hideProgressMessage()}),actionManager.addRequest(a),sheetdialog.close()}function p(e){var t=e.className.split(" "),r=document.getElementsByClassName(t[1]),o=e.parentElement,n=e.nextSibling.nextSibling,a=e.parentElement.parentElement.children[0];if(e.checked){n.disabled=!1,o.style.opacity=1;for(var s=0;s<r.length;s++)r[s].style.opacity=1;$(a).zcombo("enable")}else{n.disabled=!0,o.style.opacity=.5;for(var s=0;s<r.length;s++)r[s].style.opacity=.5;$(a).zcombo("disable")}}return dataTypes={},dataTypeList=[],formRange=void 0,firstRowAsHeader=!0,selectedColumnList=[],isPreviewAvailable=!0,previewData=[],lastRowData=[],{convertForm:e,disableColumn:p}}();
function FormObj(e,o){this.id=e,this.range=o||{}}WebForm={isFormAvailable:!1,isReportSheetAvailable:!1,formBuilderUrl:void 0,formEditUrl:void 0,formDeleteUrl:void 0,liveFormUrl:void 0,formPublishUrl:void 0,formLinkName:void 0,formRid:void 0,isPublished:!1,publishType:void 0,formVersionId:-1,createForm:function(){var e=$("#formName").val();if(e=e.trim(),""==e||e.length>40)return void showAlertDialog(jsMsg["Form.InvalidNameMessage"]);e=replaceDisallowedCharsInDocName(e.trim());var o=$("#formDescription").val(),r=new RequestParameters(ActionConstants.FORM_CREATE);r.setParameters(WorkSheets.getAssociatedActiveSheetName(),!0,e,o);var t=new AjaxRequest;t.init("POST",r.getURL(),!0,r.getParametersAsString()),actionManager.addRequest(t),sheetdialog.close()},createFormDialog:function(){var e=new RequestParameters(ActionConstants.JSP_FORM_CREATE),o=(e.getURL()+"?"+e.getParametersAsString(),{width:550,title:jsMsg["DataTab.CreateForm"],close:function(){}});sheetdialog.open("createFormDialog",o,WebForm.createFormCallback("formName"))},editForm:function(){WebForm.formEditUrl&&window.open(WebForm.formEditUrl,"_blank")},validateDeleteForm:function(){var e={buttons:[{text:jsMsg.OK,class:"ui-zbutton-primary",click:function(){WebForm.deleteForm(),sheetdialog.closeNotify()}},{text:jsMsg.Cancel,click:function(){sheetdialog.closeNotify()}}]};sheetdialog.showConfirmDialog(jsMsg["Form.DeleteMessage"],e)},deleteForm:function(){var e=new RequestParameters(ActionConstants.FORM_DELETE);e.setParameters(WebForm.formRid,WorkSheets.getSheetCodeFromName(CURRSHEETNAME));var o=new AjaxRequest;o.init("POST",e.getURL(),!0,e.getParametersAsString()),actionManager.addRequest(o)},deleteFormsBeforeThisVersion:function(){var e=new RequestParameters(ActionConstants.FORM_DELETE_ON_REVERT_VERSION);e.setParameters(WorkSheets.getSheetCodeFromName(CURRSHEETNAME));var o=new AjaxRequest;o.init("POST",e.getURL(),!1,e.getParametersAsString()),actionManager.addRequest(o)},publishFormDialog:function(e){var o=new RequestParameters(ActionConstants.JSP_PUBLISH_FORM);o.setParameters(WebForm.formRid,e,orgDisplayName);var r={width:520,modal:!0,title:jsMsg["Share.MakePublic"]},t=o.getURL()+"?"+o.getParametersAsString();sheetdialog.open("publicformdialog",r,void 0,void 0,t)},publishForm:function(e){if(WebForm.formRid){var o=new getXmlhttp;o.open("POST",ctxpath+"publishform.do",!0),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&(sheetdialog.close(),responseText=o.responseText,"success"==responseText&&(WebForm.isPublished=!0,WebForm.publishType=e,WebForm.showPublishFormUrl(e)))},o.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),o.send("rid="+WebForm.formRid+"&action=publish&type="+e+"&"+csrfParamName+"="+readCookie(csrfCookieName))}else sheetdialog.close()},removePublish:function(){if(WebForm.isPublished){var e=new getXmlhttp;e.open("POST",ctxpath+"removeformpublish.do",!0),e.onreadystatechange=function(){4==e.readyState&&(sheetdialog.close(),200==e.status&&(responseText=e.responseText,"success"==responseText&&(WebForm.isPublished=!1,WebForm.publishType=void 0)))},e.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),e.send("rid="+WebForm.formRid+"&action=unpublish&type="+WebForm.publishType+"&"+csrfParamName+"="+readCookie(csrfCookieName))}else sheetdialog.close()},showPublishFormUrl:function(){var e=new RequestParameters(ActionConstants.JSP_PUBLISH_FORM_URL);e.setParameters(WebForm.formRid,WebForm.publishType,orgDisplayName);var o={width:520,modal:!0,title:jsMsg["Share.ViewPublicURL"]},r=e.getURL()+"?"+e.getParametersAsString();sheetdialog.open("viewpublicformurldialog",o,void 0,void 0,r)},cancelFormPublicDialog:function(e){sheetdialog.close(),cancelFromPubliccallback=void 0!=e&&"publicurl"==e?!0:!1;var o=new RequestParameters(ActionConstants.JSP_CANCEL_PUBLISH_FORM);o.setParameters(WebForm.publishType);var r=o.getURL()+"?"+o.getParametersAsString(),t={width:450,modal:!0,title:jsMsg.RemovePublic};sheetdialog.open("cancelformpublicdialog",t,void 0,void 0,r)},cancelFormCallBack:function(){cancelFromPubliccallback?(cancelFromPubliccallback=!1,sheetdialog.close(),WebForm.showPublishFormUrl(WebForm.publishType)):sheetdialog.close()},viewLiveForm:function(){WebForm.liveFormUrl&&window.open(WebForm.liveFormUrl,"_blank")},createFormCallback:function(e){var o=DOCUMENT_NAME;o&&o.length>40&&(o=o.substring(0,40)),setTimeout(function(){$("#"+e).val(o).focus().select()},100)},formCreateInfo:function(){var e="New form created. To add fields, <a id='formTitleLink' target='_blank' href='"+WebForm.formEditUrl+"'>Click here.</a>";InfoBanner.showBanner(e,!1,"success"),setTimeout(function(){InfoBanner.hideBanner()},6e4)},generateFormInfo:function(){var e="Form has been generated. To open <a id='formTitleLink' target='_blank' href='"+WebForm.liveFormUrl+"'>Click here.</a>";InfoBanner.showBanner(e,!1,"success"),setTimeout(function(){InfoBanner.hideBanner()},6e4)},updateFormInfo:function(e,o){if(WebForm.isFormAvailable=e,e){var r=o[JSONConstants.FORM_URLS];if(r){WebForm.formLinkName=o[JSONConstants.FORM_LINK_NAME],WebForm.formVersionId=o.frmversionid,WebForm.formRid=WebForm.formLinkName,WebForm.formEditUrl=r.formEditURL,isUndefined(o[JSONConstants.IS_FORM_PUBLISHED])||(WebForm.isPublished=o[JSONConstants.IS_FORM_PUBLISHED],WebForm.publishType=o[JSONConstants.FORM_PUBLISH_TYPE]),WebForm.liveFormUrl=r.liveFormUrl;var t=o[JSONConstants.FORMREPORT_SHEET_NAME];WebForm.isReportSheetAvailable=t?!0:!1}}WebForm.updateFormMenuTab(e,WebForm.isReportSheetAvailable)},updateOrgName:function(){var e=orgDisplayName?orgDisplayName:orgName,o=replaceParams(jsMsg["Share.Public.MakePublicWithin"],new Array(e));$("#formpublishmenu").css("width","auto"),setTimeout(function(){$("#formpublishmenu").zmenu("changeLabel","makeFromPublishOrg",o)},10)},resetFormInfo:function(e){WebForm.isFormAvailable=!1,WebForm.formBuilderUrl=void 0,WebForm.formEditUrl=void 0,WebForm.formDeleteUrl=void 0,WebForm.liveFormUrl=void 0,WebForm.formPublishUrl=void 0,WebForm.formLinkName=void 0,WebForm.formVersionId=-1,FormObj.instances={},e&&WebForm.updateFormMenuTab(!1,!1)},updateFormMenuTab:function(e,o){e?($("#editForm").enable(),$("#deleteForm").enable(),$("#liveForm").enable(),o?$("#createFormReport").disable():$("#createFormReport").enable(),$("#publishForm").enable()):($("#editForm").disable(),$("#deleteForm").disable(),$("#publishForm").disable(),$("#liveForm").disable(),$("#createFormReport").disable())},updateFormPublishMenu:function(){WebForm.updateOrgName(),WebForm.isPublished?"org"==WebForm.publishType?($("#makeFromPublishOrg").hide(),$("#viewpubFormURL").show(),$("#makeFromPublishExtn").show(),$("#removefrompublish").show()):($("#viewpubFormURL").show(),$("#removefrompublish").show(),$("#makeFromPublishOrg").hide(),$("#makeFromPublishExtn").hide()):($("#viewpubFormURL").hide(),$("#removefrompublish").hide(),$("#makeFromPublishExtn").show(),-1!=zoid?$("#makeFromPublishOrg").show():$("#makeFromPublishOrg").hide())}},appEvent.on("WebForm.updateFormInfo",function(e,o){WebForm.updateFormInfo(e,o)}),appEvent.on("Webform.formDeleteUrl",function(){return WebForm.formDeleteUrl}),FormObj.instances={},FormObj.create=function(e,o){FormObj.instances[e]=new FormObj(e,o)},FormObj.validateRowOperations=function(){var e=formobj.range;if(!isUndefined(e)){e.sr,e.er}},FormObj.isValidColumnOperations=function(e,o,r){void 0==o&&(o=WorkSheets.getAssociatedActiveSheetName());var t=FormObj.instances[o];if(t){var i=t.range;if(!isUndefined(i)){var a=getCellRange(),s=(a.startCol,a.endCol),n=i.sc,m=i.ec;if(r==ActionConstants.DELETE_COL&&(e>=n&&m>=e||s>=n&&m>=s)||r==ActionConstants.INSERT_COL&&e>n&&m>=e){var l=showConfirmDialog(jsMsg["Form.RangeOperationMessage"]);return!l}}}return!1},FormObj.isValidRowOperations=function(e,o){void 0==o&&(o=WorkSheets.getAssociatedActiveSheetName());var r=FormObj.instances[o];if(r){var t=r.range;if(!isUndefined(t)){var i=t.sr,a=getCellRange(),s=a.startRow,n=a.endRow;if(s==i||n==i){var m=showConfirmDialog(jsMsg["Form.RangeOperationMessage"]);return!m}}}return!1};
!function(e){function n(e,n){return!e&&(e=""),new RegExp(e,n)}function r(e){var n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),new RegExp("^"+e.source+"$",n)}function i(e){return e+"*"}function t(e){return u(e)+"?"}function u(e){return"(?:"+e+")"}function g(e){return"("+e+")"}function o(e){return e=e.replace(/-/g,"\\-"),"["+e+"]"}function l(e){return o("^"+e)+"+"}var c={},a=l("'\\n"),f="'"+a+"'",R="[.!]",s=f+"|"+a,x="6553[0-6]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[1-9][0-9]{0,3}",p="[I][A-V]|[A-H]?[A-Z]",v=t("\\$"),C=u(p),d=i("0")+u(x),m=v+C+v+d,A=m+i(u(":"+m)),h=g(u(m+t(":"+m))+"|"+u(v+d+":"+v+d)+"|"+u(v+C+":"+v+C)),w=t(v+g(s)+R)+h,E=r(n(w,"i")),I=v+C+t(v+d),$=i(u(I+":"))+v+C+i(u(":"+I))+":"+v+C+i(u(":"+I)),b=t(v+C)+v+d,y=i(u(b+":"))+v+d+i(u(":"+b))+":"+v+d+i(u(":"+b));m=u(u(m)+"|"+u(v+C)+"|"+u(v+d)),A=g(u(u(y)+"|"+u($)+"|"+u(A)));var B=t(v+g(s)+R)+A,D=r(n(B,"i")),F=g(v)+g(t(C))+g(v)+g(t(d)),H=m,Q="();,=+-/*<>&^\\s\\n",T='"'+t(l('"'))+'"?',V=n(u(T)+"|"+u(u(o(Q))+"|"+u(t(f+R)+l('"'+Q))),"gi");c.matchRegex=V,c.rangeRegex=D,c.enclosedByQuotes=r(n(T)),c.seperatorRegex=r(n(o(Q))),c.validCell=r(n(m,"i")),c.cellRangeForReferenceToggling=r(n(F,"i")),c.splitCellReferencesInRange=n(H,"gi"),c.valid2DRange=E,e.regexCollection=c}(this);
function getCurrentReferencingMode(e){var t=regexCollection.cellRangeForReferenceToggling.exec(e),s=!!t[1],r=!!t[3],n=!!t[2]&&!!t[4];return n?s?r?1:3:r?2:0:t[1]?5:4}var funcParser=function(){this.origStr="",this.selStart=0,this.selEnd=0,this.subRanges=[],this.wholeRanges=[],this.objectArray=[],this.objectsSelected=[],this.subFormulaArray=[]};funcParser.prototype={funcType:{unknown:"UNKNOWN",string:"STRING",func:"FUNCTION",seperator:"SEPERATOR",subRange:"SUBRANGE",range:"RANGE",sheet:"SHEET",namedRange:"NAMEDRANGE",rangeColon:"COLON_WITHIN_RANGE"},get:function(){return{origStr:this.origStr,rangeObjects:this.subRanges,wholeRanges:this.wholeRanges,selectedObjects:this.objectsSelected,allObjects:this.objectArray,currRange:this.currRange,focusedObject:this.currentFocusedObject}},set:function(e,t,s){this.origStr=e,s="undefined"==typeof s?t:s,t>s&&(s=t+s,t=s-t,s-=t),this.selStart=t,this.selEnd=s,this.check()},check:function(){this.resetObjs(),this.parseString(),this.formObj()},resetObjs:function(){this.subRanges=[],this.objectArray=[],this.objectsSelected=[],this.subFormulaArray=[],this.wholeRanges=[],this.currentFocusedObject=[]},isDifferentObject:function(e,t,s){return this.origStr!=e||this.selStart!=t||this.selEnd!=s},parseString:function(){var e=this.origStr.match(regexCollection.matchRegex);this.subFormulaArray=e?e:[],this.parentRange=[];for(var t=0,s=0,r=0;r<this.subFormulaArray.length;){var n=this.subFormulaArray[r];if(!regexCollection.enclosedByQuotes.test(n)&&regexCollection.rangeRegex.test(n)){var a=[],i=this.subFormulaArray.indexOf(n);a=n.match(/(?:([:.!])|([^:.!]+))/g),this.subFormulaArray.splice(i,1);for(var h={content:n,start:t,end:t+n.length,index:s++},o=0;o<a.length;o++)this.subFormulaArray.splice(i+o,0,a[o]),this.parentRange.push({range:!0,data:n,info:h});this.wholeRanges.push(h),r+=a.length}else r++,this.parentRange.push({range:!1});t+=n.length}},getType:function(e){var t=this.subFormulaArray[e],s=this.funcType.unknown;return regexCollection.enclosedByQuotes.test(t)?this.funcType.string:this.parentRange[e].range&&regexCollection.validCell.test(t)?this.funcType.subRange:t.match(regexCollection.seperatorRegex)?this.funcType.seperator:":"==t?this.funcType.rangeColon:s},formObj:function(){delete this.currRange;for(var e,t=0;t<this.subFormulaArray.length;t++){var s=this.subFormulaArray[t],r=this.getType(t),n=0==t?0:this.objectArray[t-1].end,a=n+s.length;if(""!=s){var i={content:s,type:r,start:n,end:a};this.parentRange[t].range&&(i.rangeData=this.parentRange[t].info),r==this.funcType.subRange&&(i.mode=getCurrentReferencingMode(s),this.subRanges.push(i),(n<=this.selStart&&this.selStart<=a||n<this.selEnd&&this.selEnd<a||n>=this.selStart&&a<=this.selEnd)&&this.objectsSelected.push(i)),i.rangeData&&i.rangeData.start<=this.selStart&&this.selEnd<=i.rangeData.end&&(this.currRange=i.rangeData),(n<=this.selStart&&this.selStart<=a||n<this.selEnd&&this.selEnd<a||n>=this.selStart&&a<=this.selEnd)&&this.currentFocusedObject.push(i),t>0&&(i.prev=e," "!==s&&(e.next=i,e=i))," "!==s&&(e=i),this.objectArray.push(i)}}}};
function toggleRef(e,t){if(e.length>0){var n=e[0],r=e[e.length-1],o=e[0].mode<4?4:2,i=(e[0].mode+(t?3:1))%o;return e.forEach(function(e){e.content=convertReferencing(e.content,i)}),{reconstruct:!0,startObj:n,endObj:r}}return{}}function convertReferencing(e,t){var n=regexCollection.cellRangeForReferenceToggling.exec(e),r=n[2]?(1===t||3===t?"$":"")+n[2]:"";return r+=n[4]?(1===t||2===t?"$":"")+n[4]:""}function selectRange(e,t){return 0>t?void 0:e.length>t?{reconstruct:!1,startObj:e[t],endObj:e[t]}:void 0}function selectCurrentRange(e){return e?{reconstruct:!1,startObj:e,endObj:e}:void 0}function getNearRange(e,t,n){for(var r=-1,o=0;o<e.length;o++)if(elem=e[o],n){if(!(elem.start<t))break;r=o}else if(-1===r&&elem.start>t){r=o;break}return-1===r&&(r=n?e.length-1:0),selectRange(e,r)}function enableFormulaControl(e){e.el.id!==gridFormulaEditController.getTarget()&&appEvent.trigger("formulaEditController.register",[e.el.id,!0,e])}var formulaEditController=function(e){function t(){return"DIV"===y.nodeName}function n(){return y===cellField||y===exprField}function r(){if(K.origStr!==x){var e=y.selectionStart,n=y.selectionEnd;t()?formulaDecorator.constructSpansAndHighlightRanges(K,y):y.value=K.origStr,x=K.origStr,y.setSelectionRange(e,n)}}function o(){D||(y.addEventListener("keydown",s),y.addEventListener("paste",l),y.addEventListener("input",l),y.addEventListener("mousedown",l),y.addEventListener("mouseup",a),D=!0)}function i(){D&&(y.resetUndoRedoStacks&&y.resetUndoRedoStacks(),y.removeEventListener("keydown",s),y.removeEventListener("paste",l),y.removeEventListener("input",l),y.removeEventListener("mousedown",l),y.removeEventListener("mouseup",a),D=!1)}function l(){RangeSelector.isActive()&&(RangeSelector.off(),RangeSelector.allowToUpdateRange(!1)),j="="===y.value.charAt(0),V(j),j&&(R(),c(),g())}function a(){j="="===y.value.charAt(0),j&&(R(),c(),g())}function c(){if(y.selectionStart===y.selectionEnd&&j){var e=K.focusedObject[0];if(e.end===y.selectionStart){var n=" "===e.content?e.prev:e,r=isUndefined(n.next)?" ":n.next.content,o=n.content,i=o.substr(o.length-1),l=r.substring(0,1),a=""!=i&&-1!=="(;,.!=+-/*<>&^".indexOf(i),c=-1!==");,=+-/*<>&^ ".indexOf(l),g=/^("[^"]+)$/.test(o);a&&c&&!g?(RangeSelector.on(O()),RangeSelector.allowToUpdateRange(!0),RangeHighlighter.removeActiveStatetoColorSelection(),t()&&formulaDecorator.addRangeSelectorCue()):RangeSelector.isActive()&&(RangeSelector.off(),RangeSelector.allowToUpdateRange(!1))}else RangeSelector.isActive&&(RangeSelector.off(),RangeSelector.allowToUpdateRange(!1))}}function g(){j&&!RangeSelector.isActive()&&(K.currRange?t()?RangeHighlighter.setActiveStatetoColorSelection(formulaDecorator.getStyleForRange(K.currRange.content).color):RangeHighlighter.drawDashedSelectionWithRangeName(K.currRange.content):(RangeHighlighter.removeActiveStatetoColorSelection(),RangeHighlighter.clearDashedSelection()))}function u(){return K.currRange}function s(e){var t=y.value;if("="===t.charAt(0)){var n=e.keyCode?e.keyCode:e.which;if(-1===U.indexOf(n)){var r=y.selectionStart!==y.selectionEnd&&-1!==L.indexOf(n);if(!r&&!RangeSelector.isActive()&&(R(),(38===n||40===n)&&(c(),RangeSelector.isActive()))){e.preventDefault();var o=38===n?currRow-1:currRow+1;RangeSelector.setRange(o,currCol)}}switch(!0){case 35===n:case 36===n:case 37===n:case 38===n:case 39===n:case 40===n:clearTimeout(i);var i=setTimeout(function(){R(),g()},0)}if(115==n||84==n&&e.altKey&&e.metaKey){R();var l=toggleRef(K.selectedObjects,e.shiftKey,y.selectionStart!==y.selectionEnd);d(l),e.preventDefault(),e.stopPropagation()}if(9===n&&(os_windows?e.ctrlKey:e.altKey)){R();var l=getNearRange(K.wholeRanges,e.shiftKey?y.selectionStart:y.selectionEnd,e.shiftKey?!0:!1);d(l),e.preventDefault(),R(),g()}if(68===n&&(os_windows?e.ctrlKey:e.metaKey)){R();var l=selectCurrentRange(K.currRange);d(l),e.preventDefault()}if(n>=48&&57>=n&&(os_windows?e.ctrlKey:e.metaKey||e.ctrlkey)){R();var a=n-48;k=10*k+a,K.wholeRanges.length<k&&(k=a);var l=selectRange(K.wholeRanges,k-1);d(l),clearTimeout(T),T=setTimeout(function(){k=0},300),e.preventDefault(),R(),g()}}}function d(e){e&&(e.reconstruct&&(S(),y.undoRedoRecord&&y.undoRedoRecord(),r()),(e.startObj||e.endObj)&&m(e.startObj.start,e.endObj.end),RangeSelector.isActive()&&RangeSelector.off())}function f(e){getObj(e)!==y&&(E(),y=getObj(e),h())}function v(){return H.isDifferentObject(y.value,y.selectionStart,y.selectionEnd)}function R(){v()&&(H.set(y.value,y.selectionStart,y.selectionEnd),K=H.get(),r())}function h(){y&&setTimeout(function(){j="="===y.value.charAt(0),o(),j&&(R(),g())},0)}function S(){var e="";K.allObjects.forEach(function(t,n,r){e+=t.content,t.start=0==n?0:r[n-1].end,t.end=t.start+t.content.length}),K.origStr=e}function m(e,t){y.setSelectionRange(e,t)}function E(){y&&(i(),H.set("",0,0),N=void 0,y=void 0,x=void 0,j=!1,RangeSelector.isActive()&&RangeSelector.off(),RangeHighlighter.clearAllColorSelection())}function p(e){var t=K.wholeRanges[e],n=y.value;RangeHighlighter.removeActiveStatetoColorSelection(),RangeSelector.isActive()||RangeSelector.on(O(),!0),RangeSelector.setText(n,t.start,t.end)}function C(){var e=y.selectionStart,t=y.selectionEnd;y.focus(),y.setSelectionRange(e,t),R(),g()}function F(){t()&&formulaDecorator.highlightRanges(K)}function b(){return y?y.id:null}function w(){return j}function A(e){N=e,N.el=y}function O(){var e;return e=n()?{directInput:!0,multiRangeSelection:!0,removeSourceSheetName:!0,skipReregisterCheck:!0,onupdate:function(e){setCellFieldWidth(),updateCellFieldAndExprField(y),setCellFieldValue(e)}}:N,e.el=y,e}var T,x,y=getObj(e),j=!1,D=!1,k=0,H=new funcParser,K=H.get(),U=[16,17,18,19,20,91,93],L=[37,38,39,40],N=void 0,V=function(){function e(e){if(e=!!e,e!==t){var r=y.selectionStart,o=y.selectionEnd,i=y.value;y.value=i,y.setSelectionRange(r,o),t=e,t?F():(hideFlashDIV(),RangeHighlighter.clearAllColorSelection()),n()&&!isCellFieldSPANHided()&&(initCellFieldStyles(i),setCellFieldWidth())}}var t=!1;return e}();return{on:h,off:E,getTarget:b,isDiv:t,changeTarget:f,setRangeSelectionInindex:p,setRangeSelectionOptions:A,checkAndEnableRangeSelector:c,isFormula:w,parseText:R,setFocus:C,rehighlightRanges:F,getCurrentRange:u,previewCurrRange:g}},gridFormulaEditController=formulaEditController("cF"),convertFormulaReferencing=function(){function e(e,o){r.set(e,0,e.length);var i=r.get();return t(i,o),n(i),i.origStr}function t(e,t){var n=e.selectedObjects;n.length>0&&n.forEach(function(e){e.content=convertReferencing(e.content,t)})}function n(e){var t="";e.allObjects.forEach(function(e){t+=e.content}),e.origStr=t}var r=new funcParser;return e}();appEvent.on("cellField.MouseUp exprField.MouseUp cellField.focus exprField.focus formula.insertFunction formulaEditController.register",function(e){gridFormulaEditController.changeTarget(e),gridFormulaEditController.isFormula()&&gridFormulaEditController.previewCurrRange()}),appEvent.on("formulaSuggest.ValueChanged RangeSelector.ValueChanged undoRedo.ValueChanged cellField.focus formula.insertFunction formulaEditController.register",function(e,t,n){isUndefined(e)||e!=gridFormulaEditController.getTarget()||(gridFormulaEditController.on(),n&&gridFormulaEditController.setRangeSelectionOptions(n),t&&setTimeout(function(){gridFormulaEditController.checkAndEnableRangeSelector()},0))}),appEvent.on("book.onaftersheetswitch",function(){isCellFieldSPANHided()||gridFormulaEditController.rehighlightRanges()}),appEvent.on("RangeSelector.onValueChange",function(){if(gridFormulaEditController.isFormula()&&gridFormulaEditController.isDiv()&&RangeSelector.isActive()){gridFormulaEditController.parseText();var e=gridFormulaEditController.getCurrentRange();if(e){var t,n=getDataFromRangeText(e.content);RangeHighlighter.addColorDataEntry("RS","index",e.index),CURRSHEETNAME===n.sheetName&&(t=formulaDecorator.getStyleForRange(e.content).color),appEvent.trigger("FormulaHighlightRangeSelector.colorChange",[t])}}}),appEvent.on("cell.onBeforeSubmit cell.escapeEdit exprField.escapeEdit",function(){gridFormulaEditController.off()}),appEvent.on("cell.focus",function(){exprField.id==gridFormulaEditController.getTarget()&&gridFormulaEditController.off()});
var undoManager=function(e,t){this.undoStack=[],this.redoStack=[],this.Timer={KeyPress:void 0,Delete:void 0},this.el=e,this.el.undoRedoRecord=this.record.bind(this),this.el.resetUndoRedoStacks=this.resetStacks.bind(this),this.props=t,this.recordForKeyPress=!0,this.recordForDelete=!0,this.el.addEventListener("keydown",this.key.down.bind(this)),this.el.addEventListener("keypress",this.key.press.bind(this)),this.el.addEventListener("keyup",this.key.up.bind(this))};undoManager.prototype={record:function(){var e=this.get();""!==e.value&&(this.undoStack.push(e),this.redoStack=[])},undo:function(){this.undoStack.length>0&&(this.redoStack.push(this.get()),this.set(this.undoStack.pop()),this.callBack())},redo:function(){this.redoStack.length>0&&(this.undoStack.push(this.get()),this.set(this.redoStack.pop()),this.callBack())},resetStacks:function(e){this.undoStack=[],this.redoStack=[],e&&this.record()},callBack:function(){appEvent.trigger("undoRedo.ValueChanged",[this.el.id,!0])},get:function(){var e=this.el,t={};return this.props.forEach(function(s){t[s]=e[s]}),t},set:function(e){if(!e)return!1;var t=this.el;return this.props.forEach(function(s){t[s]=e[s]}),!0},key:{down:function(e){var t=e.keyCode?e.keyCode:e.which;if(e.metaKey||e.ctrlkey)switch(t){case 89:e.preventDefault(),this.redo();break;case 90:e.preventDefault(),e.shiftKey?this.redo():this.undo();break;case 86:case 88:this.record()}8!==t&&46!==t||!this.recordForDelete||(this.record(),this.recordForDelete=!1)},press:function(){this.recordForKeyPress&&(this.record(),this.recordForKeyPress=!1),setTimeout(function(){clearTimeout(this.Timer.KeyPress),this.Timer.KeyPress=setTimeout(function(){this.recordForKeyPress=!0}.bind(this),300)}.bind(this),0)},up:function(){this.recordForDelete||(clearTimeout(this.Timer.Delete),this.Timer.Delete=setTimeout(function(){this.recordForDelete=!0}.bind(this),300))}}};
var TextAreaShims=function(e){function t(e){for(var t,n=[e],o="";t=n.pop();)if("BR"==t.nodeName)o+=String.fromCharCode(10);else if(3==t.nodeType)o+=t.textContent;else for(var i=t.childNodes.length;i--;)n.push(t.childNodes[i]);return o}function n(e){var n=t(e);return n.replace(/(\n)$/,"")}function o(e,t){e.innerHTML="";for(var n=t.split("\n"),o=0;o<n.length;o++){var i=n[o];e.appendChild(document.createTextNode(i)),o<n.length-1&&(e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("")))}}function i(e,t){o(e,t),e.appendChild(document.createElement("br"))}function a(e){setTimeout(function(){e.lastChild&&"br"===e.lastChild.nodeName.toLowerCase()||e.appendChild(document.createElement("br"))},T)}function c(e){a(e.target)}function r(e){Object.defineProperty(e,"value",{get:function(){return n(this)},set:function(t){"="!==t.charAt(0)?i(e,t):formulaDecorator.setInDiv(t,this)}})}function d(e){var t=window.getSelection(),n=t.getRangeAt(0),o=n.cloneRange();return o.selectNodeContents(e),o}function s(e){var n=e.cloneContents();return t(n).length}function l(e){var t=window.getSelection(),n=d(e);return n.setEnd(t.anchorNode,t.anchorOffset),s(n)}function f(e){var t=window.getSelection(),n=d(e);return n.setEnd(t.focusNode,t.focusOffset),s(n)}function u(e){Object.defineProperty(e,"selectionStart",{get:function(){var e=window.getSelection();return e.rangeCount>0&&(this.cachedSelectionStart=l(this)),this.cachedSelectionStart},set:function(e){this.cachedSelectionStart=e,this.setSelectionRange(e,this.selectionEnd)}})}function h(e){Object.defineProperty(e,"selectionEnd",{get:function(){var e=window.getSelection();return e.rangeCount>0&&(this.cachedSelectionEnd=f(this)),this.cachedSelectionEnd},set:function(e){this.cachedSelectionEnd=e,this.setSelectionRange(this.selectionStart,e)}})}function g(e){e.setSelectionRange=function(e,t){p(this,e,t)},e.select=function(){e.setSelectionRange(0,this.value.length)},u(e),h(e)}function p(e,t,n){var o=t>n;o&&(n=t+n,t=n-t,n-=t);var i=e.value,a=i.length;n=n>a?a:n;var c=S(e,t,n),r=window.getSelection();if(r.extend)o?v(c.focus,c.anchor):v(c.anchor,c.focus);else{var d=document.createRange();d.setStart(c.anchor.node,c.anchor.offset),d.setEnd(c.focus.node,c.focus.offset),r.removeAllRanges(),r.addRange(d)}}function v(e,t){var n=window.getSelection();e&&n.collapse(e.node,e.offset),t&&n.extend(t.node,t.offset)}function S(e,t,n){for(var o,i=0,a=[e],c=!1,r=!1,d={};!r&&(o=a.pop());)if("BR"===o.nodeName&&i++,3===o.nodeType){var s=i+o.length;!c&&t>=i&&s>=t&&(d.anchor={node:o,offset:t-i},c=!0),c&&n>=i&&s>=n&&(d.focus={node:o,offset:n-i},r=!0),i=s}else for(var l=o.childNodes.length;l--;)a.push(o.childNodes[l]);return d}function m(e){e.preventDefault();var t="";t=window.clipboardData?window.clipboardData.getData("Text"):(e.originalEvent||e).clipboardData.getData("text/plain"),C(document.createTextNode(t))}function w(e){new undoManager(e,["value","selectionStart","selectionEnd"])}function E(e){r(e),e.value="",g(e),e.addEventListener("keypress",c,!1),e.addEventListener("paste",m,!1),w(e)}function C(e){var t=window.getSelection(),n=t.getRangeAt(0);n.deleteContents(),n.collapse(!0),n.insertNode(e),n.setStartAfter(e),n.collapse(!0),t.removeAllRanges(),t.addRange(n)}function N(){C(document.createElement("br")),C(document.createTextNode(""))}var T=10;e.addTextAreaProperties=E,e.setTextForElement=o,e.insertElementAtSelection=C,e.insertLineBreakAtSelection=N}(window);addTextAreaProperties(getObj("cF")),addTextAreaProperties(getObj("Tv"));
var colorChoser=function(t){function n(t){return u[t]||u.push(Math.floor(16777215*Math.random()).toString(16).toUpperCase()),u[t]}function r(t){return t?(o[t]={color:n(e++)},o[t]):{color:"000000"}}var o={},e=0,u=t||[];this.getIndex=function(){return e},this.get=function(t){return o[t]?o[t]:r(t)},this.reset=function(){o={},e=0}};
var formulaDecorator=function(){function e(e){var t=getDataFromRangeText(e);if(WorkSheets.isNameExists(t.sheetName))return(t.sheetName+"."+getCellLabel(t.sR,t.sC)+":"+getCellLabel(t.eR,t.eC)).toUpperCase()}function t(t){return t=e(t),t?s.get(t):{}}function n(e,t){o(e.origStr,t),"="===e.origStr.charAt(0)&&c(e)}function o(e,t){s.reset(),t.innerHTML="";var n=document.createDocumentFragment();"="===e.charAt(0)?r(n,e):setTextForElement(n,e),n.appendChild(document.createElement("br")),t.appendChild(n)}function r(e,t){var n=t.match(regexCollection.matchRegex)||[],o="";return n.forEach(function(t){regexCollection.rangeRegex.test(t)||regexCollection.enclosedByQuotes.test(t)?(a(e,o),l(e,t),o=""):o+=t}),""!==o&&a(e,o),e}function a(e,t){var n=document.createElement("span");return setTextForElement(n,t),e.appendChild(n),n}function l(e,n){var o=a(e,n),r=regexCollection.enclosedByQuotes.test(n);r?(o.style.color="#005713",o.style.fontStyle="italic"):o.style.color="#"+t(n).color}function c(e){e.wholeRanges.forEach(function(e){var n=t(e.content).color;RangeHighlighter.drawColorSelectionWithRangeName(e.content,n),RangeHighlighter.addColorDataEntry(n,"index",e.index)}),RangeHighlighter.clearAllColorSelection(s.getIndex())}function i(e,t){o(e,t)}function g(){if(!getObj("RSCue")){var e=window.getSelection(),t=e.getRangeAt(0);t.deleteContents();var n=document.createElement("span");n.id="RSCue",t.insertNode(n),t=t.cloneRange(),t.setStartBefore(n),t.setEndBefore(n),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}}{var s=new colorChoser(["5883DA","E5575B","A43FBC","5B9C27","11A9CC","F7900C","BD4F90","2B799C","AC3135","5F5F5F","0D6856","9B8C2B","3FD0B4","F2B405","4B10AC","65765A","9258F1","795011","584A71","EF3964"]);new funcParser}return{getStyleForRange:t,setInDiv:i,addRangeSelectorCue:g,highlightRanges:c,constructSpansAndHighlightRanges:n}}();
window.onblur=function(){unsetStatus()};var clientDim=findClientDim(),clientWidth=clientDim.width,clientHeight=clientDim.height,resizeTimeout;window.onresize=function(){clientDim=findClientDim(),clientWidth=clientDim.width,clientHeight=clientDim.height,clearTimeout(resizeTimeout),resizeTimeout=setTimeout(function(){getObj("mainOuterDiv")&&(getObj("mainOuterDiv").style.width=clientWidth+"px"),resetPageDim("WIN_RESIZE")},250)},$(document.body).bind("focus",function(i){if(browser_nn6){if(jsEMBED_VIEW)return;var e=i.target;(e==document||e==window)&&"undefined"!=typeof ole&&ole.currObj&&ole.conf.onfocus()}}),window.onerror=function(i,e,t,n,o){appEvent.trigger("window.error",[i,e,t,n,o])};
var Thread=function(){this.holders=[]};Thread.prototype={wait:function(a){var r={};r.method=a,r.params=Array.prototype.slice.call(arguments,1),this.holders.push(r)},notifyAll:function(){for(var a=this.holders.length,r=0;a>r;)this.holders[r].method.apply(void 0,this.holders[r].params),r+=1;this.flush()},flush:function(){this.holders=[]}};var globalThreads={};globalThreads.init=function(){var a=new Thread;globalThreads.scroll=a},globalThreads.init(),Thread.getThread=function(a){switch(a){case"scroll":break;default:showAlertDialog("Give me Valid Thread Name")}return globalThreads[a]};
var documentSettings=function(e){var t,n,a,o,r,i=function(){var t=new AjaxRequest,n=new RequestParameters(ActionConstants.JSP_DOCUMENT_SETTING);t.init("POST",n.getURL(),!0,n.getParametersAsString()),t.addEventListener("onComplete",function(t){var n={width:500,modal:!0,title:jsMsg["File.DocumentSettings"],maxHeight:e(window).height()/2};sheetdialog.open(t.responseText,n),BLOCK_RTL||(document.getElementById("dispDir").value="true"==writingDirection?jsMsg.Rtl:jsMsg.Ltr)}),t.sendRequest()},s=function(){var e=(getAvailableStartRow(),getAvailableEndRow(),getCellRange());ftnLocaleLang=document.getElementById("langList").value;var t=ftnLocaleLang+"_"+document.getElementById("countrylist").value,n=document.getElementById("timezone").value,a=document.getElementById("setAsDefault"),o=!1;if(a.checked&&(o=a.value),ClipObject.removeClipInServer(),v(),BLOCK_RTL&&(r=!1),t!=workBookLocale||n!=workBookTimeZone||a.checked||JSON.parse(r)!=JSON.parse(writingDirection)&&!BLOCK_RTL){var i=new RequestParameters(ActionConstants.DOCUMENT_SETTING);i.setParameters(WorkSheets.getAssociatedActiveSheetName(),e.startRow,e.startCol,e.endRow,e.endCol,t,n,o,r);var s=new AjaxRequest;s.init("POST",i.getURL(),!0,i.getParametersAsString()),actionManager.addRequest(s)}sheetdialog.close()},c=function(o){var r=(getObj("currency"),getObj("comma"),o.clientUpdateJson,o.USERCURRENCY,o.thousandSeparator),i=o.currencySymbol;decSymbol=o.decimalSeparator,n=o.currencyCode,a=jsMsg["CURRENCYNAME."+n],t=o.dateSeparator,userDateFormatType=o.dateFormatType,46==t?userDateSeparator=".":47==t?userDateSeparator="/":45==t&&(userDateSeparator="-");{var s=o.newCustomizedLocale,c=o.newLocaleCountryName,u=o.newTimeZone,m=o.previousTimeZone,p=o.previousLocale;e("#currency").children().first().text(),e("#currencymenu"),new Object}docLocale=s,l(r),"undefined"==typeof a&&(a=n),(p!=s||m!=u)&&(d(i,s,c,a,n),userCurrencySymbol=i)},u=function(){sheetdialog.close()},l=function(t){thousandSeparator=t;var n=e("#comma").children().first();e("#comma").find("span").first().text("( "+t+" )"),n.hasClass("ui-icon-zcomma")?n.removeClass("ui-icon-zcomma"):n.hasClass("ui-icon-zdot")?n.removeClass("ui-icon-zdot"):n.hasClass("ui-icon-zsinglequote")?n.removeClass("ui-icon-zsinglequote"):n.hasClass("ui-icon-zspac")&&n.removeClass("ui-icon-zspac"),44==t.charCodeAt()?n.addClass("ui-icon-zcomma"):46==t.charCodeAt()?n.addClass("ui-icon-zdot"):39==t.charCodeAt()?n.addClass("ui-icon-zsinglequote"):160==t.charCodeAt()&&n.addClass("ui-icon-zspac"),t=t},d=function(t,n,a,o,r){var i=getObj("currency");if(i){{new Object}i.setAttribute("currencyType",n),e(i).find("span").first().text(t),e(i).attr("title",e(i).find("span").first().text()),e(i).metadata().appData.dynamic=!0,changetooltip(i,o),m(t,a,n,!1,o,r)}},m=function(t,n,a,o,r){var i=0,s=new Object;"Rs."==t&&(t="Rs"),e(s).attr("id",a),e(s).attr("data","{icon:'bold',iconText:'"+t+"',label:'"+r+"', appData:{dynamic:true,callback: 'format_new',arg: '168,"+a+",this'}}"),e("#currencymenu li").each(function(){t==e(this).find("span").first().text()&&(t=e(this).find("span").first().text(),i=1)});{var c=e("#currencymenu").children().first();c.clone()}e("#currencymenu").children().length>8&&e("ul#currencymenu li:first").remove();var u=e("#currencymenu");if(0==i){e("#menuitem_currency").children().first().html(t);var l=function(){u.zmenu("addMenuItem",s,1)};menutabListener.doAction(TOOLBAR.FORMAT,{id:"currencymenu",action:"addmenuItem",callback:l}),e(u).prepend(e("#"+a)),o=!1}p(t)},p=function(t){e("#currencymenu li").removeClass("menuActive");var n=null;"$"==t?n="DOLLAR":t==unescape("%u20AC")?n="EURO":t==decodeURIComponent("%C2%A3")?n="POUND":"￥"==t?n="YEN":8377===t.charCodeAt(0)?n="RUPEE":"&#xFFE5;"==t&&(n="YUAN"),null==n&&(n=docLocale);var a="#"+n;e(a).addClass("menuActive")},g=function(){var t=new RequestParameters(ActionConstants.JSP_DATETIMEMENU),n=(t.getURL()+"?"+t.getParametersAsString(),new AjaxRequest);n.init("POST",t.getURL(),!0,t.getParametersAsString()),n.addEventListener("onComplete",function(t){if(t.responseText){var n=getObj("datetimemenu"),a=n.parentNode;a.removeChild(n);var o=t.responseText;e("#dtcontent").html(o),e.ZToolbarHandler.init(["#datetimemenu"])}}),n.sendRequest()},C=function(t){e("#datetimemenu").hide(),appEvent.trigger("showFormatCellsDialog",["",t])};appEvent.on("documentLoad",function(e){var r=e;localizedFunctionName=JSON.parse(r.workbook.localeFunctionName),docLocale=r.workbook.docLocale,t=r.workbook.dateSeparator,userThousandSeparator=r.workbook.thousandSeparator,userDateFormatType=r.workbook.dateFormatType,userCurrencySymbol=r.workbook.currencySymbol,n=r.workbook.currencyCode,a=jsMsg["CURRENCYNAME."+n],o=r.workbook.userLocaleCountry,decSymbol=r.workbook.decimalSeparator,timeFormat=JSON.parse(r.workbook.timeFormat),userDateSeparator=46==t?".":47==t?"/":"-","undefined"==typeof a&&(a=n),p(userCurrencySymbol)}),appEvent.on("setCurrencyFormat",function(e){p(e)}),appEvent.on("setUserThousandSep",function(e){l(e)}),appEvent.on("updateServerResponse",function(e){g(),c(e),localizedFunctionName=e.localeFunctionName,timeFormat=e.timeFormat,v()});var v=function(){null!=document.getElementById("dispDir")&&(r=document.getElementById("dispDir").value,r==jsMsg.Rtl?r=!0:r==jsMsg.Ltr&&(r=!1))};return{init:i,submitSettings:s,cancelSettings:u,userCurrencySymbolSettings:d,showMoreFormat:C,translateDispDir:v}}(jQuery);
function VisualCueCellsInfo(){this.cellsJson=[]}function VisualCue(){this.cellsInfo=new VisualCueCellsInfo}VisualCueCellsInfo.prototype={add:function(e,t,s,r,o,n,i,l,a,c){for(var u=!1,h=this.cellsJson.length-1;h>=0;h--){var v=this.cellsJson[h];if(v.vcID===e){u=!0,v.sheetName=t?t:v.sheetName,v.row=null!==s?s:v.row,v.col=null!==r?r:v.col,v.erow=null!==o?o:v.erow,v.ecol=null!==n?n:v.ecol,v.colorCode=i?i:v.colorCode,v.pane=""===l||l?l:v.pane,v.zuid=a?a:v.zuid,v.dname=c?c:v.dname;break}}u||this.cellsJson.push({vcID:e,sheetName:t,row:s,col:r,erow:o,ecol:n,colorCode:i,pane:l,zuid:a,dname:c})},remove:function(e){for(var t=this.cellsJson.length-1;t>=0;t--)if(this.cellsJson[t].vcID==e){this.cellsJson.splice(t,1);break}},removeAll:function(){this.cellsJson=[]},get:function(e){for(var t=this.cellsJson.length-1;t>=0;t--)if(this.cellsJson[t].vcID==e)return this.cellsJson[t]},getByZuid:function(e){for(var t=[],s=this.cellsJson.length-1;s>=0;s--)this.cellsJson[s].zuid==e&&t.push(this.cellsJson[s]);return t}},VisualCue.prototype={show:function(e,t){if(WMSREQ_RECEIVE_COUNT++,e&&e.vcID){var s=e.vcID,r=e.zuid,o=e.sheetName,n=e.row,i=e.col,l=e.erow,a=e.ecol,c="null"!==e.colorCode?e.colorCode:getColorCode(e.zuid),u=e.dname;"undefined"!=typeof r&&(userColorCode[r]=c),o==CURRSHEETNAME?this.isPresent(s)?this.change(e):this.create(e):this.remove(s),isUndefined(o)||t||this.cellsInfo.add(s,o.trim(),n,i,l,a,c,null,r,u)}},showAll:function(){for(var e=this.getCellsJson(),t=e.length,s=0;t>s;s++)this.show(e[s])},create:function(e){var t=this.getVisualCueDivFragment(e),s=this.getProperty(e);this.setAllProperty(t,s),this.registerEvent(t,e.vcID),this.append(t,s,e.vcID)},append:function(e,t,s,r){e&&(isUndefined(r)&&(r=getSheetPane(t.row,t.col),r=4==r?"":r),this.cellsInfo.add(s,null,null,null,null,null,null,r),this.getParentDiv(r).appendChild(e),this.handleFreezePanesTopLeft(e,r))},handleFreezePanesTopLeft:function(e,t){if(thirdPaneTop||secondPaneLeft){var s=-1*thirdPaneTop+"px",r=-1*secondPaneLeft+"px";switch(t){case 1:e.style.marginLeft=0,e.style.marginTop=s=0;break;case 2:e.style.marginTop=s=0,e.style.marginLeft=r;break;case 3:e.style.marginLeft=0,e.style.marginTop=s;break;default:e.style.marginLeft=r,e.style.marginTop=s}}},setNameDIVTop:function(e){var t=$(e).children()[0];if(t){var s=parseInt($(e).css("marginTop")),r=parseInt($(e).css("top")),o=jsVERSION_VIEW?"-12px":"-10px";$(t).css("top",r+s>0?o:"0px")}},changeCursor:function(e,t,s){if(e){var r=getRowPosInMouseEvent(e),o=getColPosInMouseEvent(e),n=getCursorPos(e),i=n.x,l=n.y,a=getCell(r,o),c=getHyperLinkInCell(a),u=c.childTag;if(u&&isObject(u)&&u.tagName&&"A"==u.tagName.toUpperCase())if(CellUtils.checkBoundaryForTextInDiv(i,l,a)){s.style.cursor="pointer";var h=c.title;s.title=h}else s.style.cursor="",s.title=""}},change:function(e){var t=e.vcID,s=this.getVisualCueDiv(t),r=this.getProperty(e);this.setAllProperty(s,r),this.setNameDIVTop(s);var o=this.cellsInfo.get(t).pane,n=getSheetPane(r.row,r.col);if(n=4==n?"":n,o!=n){var s=this.getVisualCueDiv(t);this.switchPane(s,o,n,t)}},switchPane:function(e,t,s,r){this.getParentDiv(t).removeChild(e),this.append(e,null,r,s)},handleFreeze:function(e,t,s){var r=this.getCellsJson(),o=r.length;switch(e){case"ROWS":for(var n=0;o>n;n++){var i=this.getVisualCueDiv(r[n].vcID);i&&(r[n].row<t?this.switchPane(i,"",2,r[n].vcID):this.handleFreezePanesTopLeft(i,""))}break;case"COLS":for(var n=0;o>n;n++){var i=this.getVisualCueDiv(r[n].vcID);i&&(r[n].col<s?this.switchPane(i,"",3,r[n].vcID):this.handleFreezePanesTopLeft(i,""))}break;case"ROWS/COLS":for(var n=0;o>n;n++){var i=this.getVisualCueDiv(r[n].vcID);i&&(r[n].row<t&&r[n].col<s?this.switchPane(i,"",1,r[n].vcID):r[n].row<t?this.switchPane(i,"",2,r[n].vcID):r[n].col<s?this.switchPane(i,"",3,r[n].vcID):this.handleFreezePanesTopLeft(i,"",r[n].vcID))}}},handleUnFreeze:function(){for(var e=this.getCellsJson(),t=e.length-1;t>=0;t--)if(e[t].sheetName==CURRSHEETNAME){var s=e[t].vcID,r=this.getVisualCueDiv(s);""!=e[t].pane&&(this.getParentDiv(e[t].pane).removeChild(r),this.cellsInfo.add(s,null,null,null,null,null,null,""),this.getParentDiv("").appendChild(r)),isRTL?r.style.marginRight=0:r.style.marginLeft=0,r.style.marginTop=0}},remove:function(e){if(this.isPresent(e)){var t=this.getVisualCueDiv(e),s=this.cellsInfo.get(e).pane;this.getParentDiv(s).removeChild(t),this.cellsInfo.remove(e)}},removeByZuid:function(e){for(var t=this.cellsInfo.getByZuid(e),s=0,r=t.length;r>s;s++)this.remove(t[s].vcID)},removeAll:function(){for(var e=1;4>=e;e++){var t=4==e?"":e;$(userPresence.getParentDiv(t)).empty()}this.cellsInfo.removeAll()},getVisualCueDivFragment:function(e){var t=e.vcID,s="#"+userColorCode[e.zuid],r=$("<div/>",{class:"vcD",id:t+"_vcD",style:"border-color:"+s+";z-index: 260;"});return $("<div/>",{class:"vcND",id:t+"_vcND",style:"border-color:"+s+";background:"+s+";display:none;",text:e.dname}).appendTo(r),r.get(0)},isOwnDiv:function(e){return"vcD"==e.className||"vcND"==e.className},isPresent:function(e){var t=this.getVisualCueDiv(e);return t?!0:!1},getVisualCueDiv:function(e){return getObj(e+"_vcD")},getParentDiv:function(e){var t;switch(e){case 1:t=userPresencePane1;break;case 2:t=userPresencePane2;break;case 3:t=userPresencePane3;break;default:t=userPresencePane}return t},getProperty:function(e){if(e){var t=e.row,s=e.col,r=e.erow,o=e.ecol;r||o||(r=t,o=s);var n=Merge.getCellInfo(t,s);n&&(r=n.endRow,o=n.endCol);var i=getCellRangeDIM(parseInt(t),parseInt(s),parseInt(r),parseInt(o)),l=i.height+1,a=i.width+1,c=i.left-1,u=i.top-1,h={row:t,col:s,erow:r,ecol:o,left:c,top:u,width:a,height:l};return h}},setProperty:function(e,t,s){e.style[t]=s},setAllProperty:function(e,t){e&&(e.style[isRTL?"right":"left"]=t.left+"px",e.style.top=t.top+"px",e.style.width=t.width+"px",e.style.height=t.height+"px")},tuneDivsHeight:function(e){for(var t=this.getCellsJson(),s=t.length-1;s>=0;s--)if(t[s].row>=e){var r=this.getVisualCueDiv(t[s].vcID);if(r){var o=this.getProperty(t[s]);this.setProperty(r,"height",o.height+"px"),this.setProperty(r,"top",o.top+"px")}}},tuneDivsWidth:function(e){for(var t=this.getCellsJson(),s=t.length-1;s>=0;s--)if(t[s].col>=e){var r=this.getVisualCueDiv(t[s].vcID);if(r){var o=this.getProperty(t[s]);this.setProperty(r,"width",o.width+"px"),this.setProperty(r,"left",o.left+"px")}}},handleMerge:function(e,t){for(var s=this.getCellsJson(),r=s.length-1;r>=0;r--)if(s[r].row===e&&s[r].col===t){var o=this.getVisualCueDiv(s[r].vcID);if(o){var n=this.getProperty(s[r]);this.setAllProperty(o,n)}}},registerEvent:function(e,t){var s=getChildNode(e,0);e.onmouseover=function(){var r=$("#fD").css("zIndex");r&&(clearTimeout($(s).stop().data("timer")),$(s).css("opacity","1")),VisualCue.prototype.setNameDIVTop(e),VisualCue.prototype.showVisualCueNameDIV(s);var o=userPresence.cellsInfo,n=o.get(t);n&&Annot.show(n.row,n.col)},e.onmouseout=function(){VisualCue.prototype.hideVisualCueNameDIV(s),Annot.hide()},e.onmousemove=function(t){VisualCue.prototype.changeCursor(t,s,e)},e.onmousedown=function(){}},showVisualCueNameDIV:function(e){e&&(e.style.display="")},hideVisualCueNameDIV:function(e){e&&$(e).fadeOut()},getCellsJson:function(){return this.cellsInfo.cellsJson}},VisualCue.prototype.constructor=VisualCue;var userPresence=new VisualCue;userPresence.row=-1,userPresence.col=-1,userPresence.HOLD_ON_TIME=1e3,userPresence.send=function(e){var t=getCellRange();READ_WRITE&&WebMessanger.getRawSid()&&""!=COLLAB_ID&&"null"!=COLLAB_ID&&(e||userPresence.row!=t.startRow||userPresence.col!=t.startCol)&&!isErrorDoc&&sendUserPresence()},userPresence.create=function(e){VisualCue.prototype.create.call(this,e),appEvent.trigger("visualcue.createAndShow",[e.row,e.col,e.vcID])},userPresence.show=function(e){CollabPanel.isAllowed()&&(VisualCue.prototype.show.call(this,e),appEvent.trigger("visualcue.show",[e.row,e.col,e.vcID]))};var auditTrail=new VisualCue;auditTrail.rangeJson=[],auditTrail.getVisualCueDivFragment=function(e){var t=e.vcID,s="#"+e.colorCode,r=$("<div/>",{class:"atD",id:t+"_vcD",style:"border-color:"+s+";"});return $("<div/>",{class:"atND",id:t+"_vcND",style:"border-color:"+s+";background:"+s+";display:none;",text:e.dname}).appendTo(r),$("<div/>",{class:"atIND",style:"border-top-color:"+s}).appendTo(r),r.get(0)},auditTrail.change=function(e){var t=e.vcID,s=this.getVisualCueDiv(t),r="#"+e.colorCode;s.style.borderColor=r;var o=s.getElementsByClassName("atND")[0];o.style.borderColor=r,o.style.background=r,o.textContent=e.dname,s.getElementsByClassName("atIND")[0].style.borderTopColor=r},auditTrail.getProperty=function(e){if(e){var t=e.row,s=e.col,r=getCellDIM(parseInt(t),parseInt(s)),o={row:t,col:s,left:r.left,top:r.top-1,width:r.width-1,height:r.height};return o}},auditTrail.isOwnDiv=function(e){return"atD"==e.className};
var cellIndicator=function(e){var t=void 0,l=function(){t=e("#Trc"),t.on("keyup",function(e){i(e)}).on("keydown",function(e){n(e)}).on("focus",function(e){r(e)}).on("blur",function(){o()})},n=function(e){var t=e.which;if(9===t)return!1;if(13===t){isCellEdited()&&submitCell();var l=currCellIndicator.value.trim();l=l.replace(".","!"),currCellIndicator.blur();var n=l,i=CURRSHEETNAME;if(-1!==l.indexOf("!")&&(i=n.substring(0,n.indexOf("!")),n=n.substring(n.indexOf("!")+1,n.length)),CellUtils.checkCellRef(n))return Goto.gotoCellInit(n,"PARAM"),!1;if(-1!==l.indexOf("!")&&i.trim().toUpperCase()===CURRSHEETNAME.toUpperCase()&&(l=n),CellUtils.isSupportedName(l,"DEFINE_NAME")||!isNaN(l.charAt(0))){var r=jsMsg.InvalidName+"\n";return r+="	",r+="- "+jsMsg.CellNamecannotstartwithnumbers,r+="\n	",r+="- "+jsMsg.CellNamecannotbeassameasZohoOfficedefinedcelllabels,showAlertDialog(r),void currCellIndicator.focus()}var a=CURRSHEETNAME,o="";if(isCellRange()){var s=getCellRange();o=CellUtils.constructCellName(s.startRow,s.startCol,s.endRow,s.endCol,!0),focusCellRange(s.startRow,s.startCol,s.endRow,s.endCol,void 0,!0)}else{var c=ActiveCellInfo,d=c.getStartRow(),u=c.getStartCol();o=CellUtils.constructCellName(d,u,void 0,void 0,!0),focusCell(currRow,currCol)}-1!==a.indexOf(" ")&&(a="'"+a+"'"),cellLoc="$"+a+"."+o;var f={SUBMODE:"ADD",CELLNAME:l,CONTENT:cellLoc};appEvent.trigger("namedrangechanged",["DEFINENAME",f])}else 27===t&&(currCellIndicator.blur(),focusCell(currRow,currCol))},i=function(e){var t=e.which;return e.shiftKey&&e.ctrlKey&&78===t||16===t||17===t?!1:void Goto.suggestNamedRanges("Trc")},r=function(){setTimeout(function(){t.select()},50),a()},a=function(){isEditingInExprField&&submitCell();var t=NamedRange.getNamedRangesList();if(0!==t.length){t=t.sort();for(var l="<table id='definedNamerangesTBL'  width='100%' cellspacing='0' cellpadding='0' >",n=0;n<t.length;n++){var i="'"+escapeSpecialCharacters(t[n])+"'";l+="<tr id='defNameTR_"+n+"'>",l+='<td id="defNameTD_'+n+'" onClick="Goto.gotoCellInit('+i+', \'NAME\');"><a href="javaScript:;"><span>'+escapeSpecialCharacters(t[n])+"</span></a></td></tr>"}l+="</table>";var r=e("#eL").offset().top+e("#eL").height(),a=e("#definedNameListDIV");a.css("top",r),a.html(l),RTLlang&&(a.css("position","absolute"),a.css("right","0px")),a.show()}},o=function(){setTimeout(function(){e("#definedNameListDIV").hide()},200)};return l(),{initCellIndicator:l}}(jQuery);
var RangeSelector=function(e){function t(){appEvent.on("grid.mousedown",B),appEvent.on("colHead.mousedown rowHead.mousedown",W),appEvent.on("grid.rangeselect.end",z),appEvent.on("grid.rangeselect.update",q),appEvent.on("book.onaftersheetswitch",G)}function n(){e(C).unbind("keypress.setmultirange"),e(C).unbind("keydown.RangeSelectorArrowCheck"),appEvent.off("grid.mousedown",B),appEvent.off("colHead.mousedown rowHead.mousedown",W),appEvent.off("grid.rangeselect.end",z),appEvent.off("grid.rangeselect.update",q),appEvent.off("book.onaftersheetswitch",G)}function o(e){var t=getCaretPos(C),n=C.value;C=e,C.value=n,setCaretPos(C,t),C.focus()}function a(){if(E)for(var t=0;t<oleObjectsAry.length;t++){var n=OLE[oleObjectsAry[t]],o=n.getSelectLayer();o.classList.remove("imagehideTrick"),e("#"+oleObjectsAry[t]).removeClass("imagehideTrick")}E=!1}function i(e){var t=getCaretPos(C);C=x,C&&(C.value=e,setCaretPos(C,t),setTimeout(function(){x.focus()},100))}function r(e){C.value=e,w&&(C.selectionStart=formulaEIdxTemp,C.selectionEnd=formulaEIdxTemp),u&&u(e)}function l(t){window.event;e(t).bind("keypress.setmultirange",function(e){var t=e.keyCode?e.keyCode:e.which;c(t)})}function s(e){var t=e.keyCode?e.keyCode:e.which;if(isRTL&&(39==t?t=37:37==t&&(t=39)),t>=37&&e.keyCode<=40&&!F)if(e.preventDefault(),e.shiftKey&&!h){var n,o=ActiveFormulaInfo.getActiveRow(),a=ActiveFormulaInfo.getActiveCol(),i=j.startRow,r=j.startCol,l=j.endRow,s=j.endCol,c=a===r,d=a===s,f=o===i,u=o===l;switch(t){case 37:case 39:var R=39===t?r:s;n=new Range(i,R,l,R);break;case 38:case 40:var g=40===t?i:l;n=new Range(g,r,g,s)}switch(Merge.extendRange(n),t){case 37:if(c){if(n.startCol-1<0)return;j.setRangeInfo(i,r,l,n.startCol-1)}else if(d){if(j.startCol-1<0)return;j.startCol-=1}break;case 39:if(d){if(n.endCol+1>=totCols)return;j.setRangeInfo(i,n.endCol+1,l,s)}else if(c){if(j.endCol+1>=totCols)return;j.endCol+=1}break;case 38:if(f){if(n.startRow-1<0)return;j.setRangeInfo(i,r,Row.findNextNonHiddenRow(n.startRow,!1),s)}else if(u){if(j.startRow-1<0)return;j.startRow=Row.findNextNonHiddenRow(j.startRow,!1)}break;case 40:if(u){if(n.endRow+1>=totRows)return;j.setRangeInfo(Row.findNextNonHiddenRow(n.endRow),r,l,s)}else if(f){if(j.endRow+1>=totRows)return;j.endRow=Row.findNextNonHiddenRow(j.endRow)}}if(37!==t&&39!==t||c||d){if(!(38!==t&&40!==t||f||u)){var v=new Range(o,r,o,s);Merge.extendRange(v);var w=v.startRow,C=v.endRow;if(38===t)if(w==i){var m=new Range(l,r,l,s);Merge.extendRange(m),j.setRangeInfo(i,r,Row.findNextNonHiddenRow(m.startRow,!1),s)}else C==l?j.setRangeInfo(l,r,Row.findNextNonHiddenRow(i,!1),s):j.setRangeInfo(i,r,Row.findNextNonHiddenRow(l,!1),s);else if(w==i)j.setRangeInfo(i,r,Row.findNextNonHiddenRow(l),s);else if(C==l){var m=new Range(i,r,i,s);Merge.extendRange(m),j.setRangeInfo(l,r,Row.findNextNonHiddenRow(m.endRow),s)}else j.setRangeInfo(l,r,Row.findNextNonHiddenRow(i),s)}}else{var p=new Range(i,a,l,a);Merge.extendRange(p);var S=p.startCol,I=p.endCol;if(37===t)if(S==r){var m=new Range(i,s,l,s);Merge.extendRange(m),j.setRangeInfo(i,r,l,m.startCol-1)}else I==s?j.setRangeInfo(i,s,l,r-1):j.setRangeInfo(i,r,l,s-1);else if(S==r)j.setRangeInfo(i,r,l,s+1);else if(I==s){var m=new Range(i,r,l,r);Merge.extendRange(m),j.setRangeInfo(i,s,l,m.endCol+1)}else j.setRangeInfo(i,s,l,r+1)}}else{var E=ActiveFormulaInfo;switch(t){case 37:if(e.altKey)return switchSheet.doSwitch(RTLlang?"next":"prev"),!1;var x=E.getActiveRow(),b=E.getStartCol()-1;b>=0&&(ActiveFormulaInfo.set(x,b),j.setRangeInfo(x,b,x,b));break;case 38:var b=E.getActiveCol(),x=Row.findNextNonHiddenRow(E.getStartRow(),!1);x>=0&&(ActiveFormulaInfo.set(x,b),j.setRangeInfo(x,b,x,b));break;case 39:if(e.altKey)return switchSheet.doSwitch(RTLlang?"prev":"next"),!1;var x=E.getActiveRow(),b=E.getEndCol()+1;totCols>b&&(ActiveFormulaInfo.set(x,b),j.setRangeInfo(x,b,x,b));break;case 40:var b=E.getActiveCol(),x=Row.findNextNonHiddenRow(E.getEndRow());totRows>x&&(ActiveFormulaInfo.set(x,b),j.setRangeInfo(x,b,x,b))}}}function c(e){if(clearCellRangeFill(),j.init(),w){var t=[",",";",":"];-1!==t.indexOf(String.fromCharCode(e))&&(H=!0)}}function d(e,t,n,o){G();var a=m?CURRSHEETNAME:void 0,i=CellUtils.constructCellName(e,t,n,o,N,a);if(w){var r=Math.max(formulaSIdxTemp,formulaEIdxTemp)>0;if(void 0===R||!r){formulaSIdxTemp=getSelectionStart(C),formulaEIdxTemp=getSelectionEnd(C);var l=C.value;R=l.substring(0,formulaSIdxTemp),g=l.substring(formulaEIdxTemp)}formulaEIdxTemp=formulaSIdxTemp+i.length,formulaCell||H||0===R.indexOf("=")?i=R+i+g:(i=i,H=!1)}return i}function f(e,t,n){I&&(C===cellField&&isCellFieldSPANHided()?(focusCellField(e),setCellFieldWidth()):C.value=e,formulaSIdxTemp=t,formulaEIdxTemp=n,R=e.substring(0,formulaSIdxTemp),g=e.substring(formulaEIdxTemp),C.selectionStart=n,C.selectionEnd=n)}var u,R,g,v,w,C,m,p,h=!1,S=!1,I=!1,E=!1,x=void 0,b="",T="",N=!1,k=!1,A=!1,F=!1,H=!1,M=!1,j={data:{sR:-1,sC:-1,eR:-1,eC:-1},reset:function(){this.data={sR:-1,sC:-1,eR:-1,eC:-1},a()},drawFill:function(){var e=this.data;focusCellRangeFill(e.sR,e.sC,e.eR,e.eC)},setRangeInfo:function(e,t,n,o){if(n=isUndefined(n)?e:n,o=isUndefined(o)?t:o,this.data.sR!==e||this.data.sC!==t||this.data.eR!==n||this.data.eC!==o){var a=Math.min(e,n),i=Math.min(t,o),r=Math.max(e,n),l=Math.max(t,o);this.data={sR:a,sC:i,eR:r,eC:l},this.drawFill()}},init:function(){this.reset(),this.data={sR:currRow,sC:currCol,eR:currRow,eC:currCol},ActiveFormulaInfo.set(currRow,currCol)},set startRow(e){0>e||(this.data.sR=e,this.drawFill())},set startCol(e){0>e||(this.data.sC=e,this.drawFill())},set endRow(e){e>=totRows||(this.data.eR=e,this.drawFill())},set endCol(e){e>=totCols||(this.data.eC=e,this.drawFill())},get startRow(){return this.data.sR},get startCol(){return this.data.sC},get endRow(){return this.data.eR},get endCol(){return this.data.eC}},y=function(e,n){(!I||e.el!==x||e.skipReregisterCheck)&&(L(n),I=!0,C=x=e.el,k=e.allowSheetSwitch,F=!!e.disableArrowSupport,u=e.onupdate,h=e.single,N=e.isAbsoluteRef,v=e.directInput,w=e.multiRangeSelection,m=e.appendSheetName,p=e.callback,A=e.removeSourceSheetName,l(x),appEvent.trigger("rangeselector.on",[e]),t())},O=function(){L(),resetCellRangeFill(),I=!1,H=!1,M=!1,e(C).unbind("keypress.setmultirange"),e(C).unbind("keydown.RangeSelectorArrowCheck")},P=function(){return I},U=function(){if(C)var e=C.value;p&&p(e)},L=function(e){h=!1,F=!1,S=!1,I=!1,x=void 0,p=void 0,u=void 0,b="",T="",A=!1,M=!1,n(),clearCellRangeFill(),e||j.init(),N=!1,k=!1,w=void 0,m=void 0,H=!1},K=function(){return h},V=function(){return cellPrevState?cellPrevState.sourceSheet:void 0},D=function(){-1===sRange.value.indexOf("=")&&RangeSelector.goNormal()},B=function(e){return e.target!==C&&I?M?void sheetSwitchBeforeSubmit(!1):(Q(),focusCellRangeInit(e),appEvent.preventDefault()):void 0},Q=function(){if(w){var e=C,t=Math.max(formulaSIdxTemp,formulaEIdxTemp)>0;t||(formulaSIdxTemp=getSelectionStart(e),formulaEIdxTemp=getSelectionEnd(e));var n=e.value;R=n.substring(0,formulaSIdxTemp),g=n.substring(formulaEIdxTemp)}},W=function(){Q()};appEvent.on("cell.focus",function(){I&&j.init()}),appEvent.on("RangeSelector.RowColSelect",function(e,t,n){switch(t>n&&(t+=n,n=t-n,t-=n),e){case"Row":j.setRangeInfo(t,0,n,getColMax()-1);break;case"Col":j.setRangeInfo(0,t,getRowMax()-1,n)}});var q=function(e,t,n,o){j.setRangeInfo(e,t,n,o),r(d(e,t,n,o)),toCheckCFUnderOleObj(n,o,getCell(o,o),!0),E=!0;var a=m?CURRSHEETNAME:void 0,i=CellUtils.constructCellName(e,t,n,o,N,a);appEvent.trigger("RangeSelector.onValueChange",[i]),appEvent.trigger("RangeSelector.ValueChanged",[C.id])},z=function(){if(I){var e=C.value,t=Math.max(formulaSIdxTemp,formulaEIdxTemp)>0,n=t?formulaEIdxTemp:e.length;setCaretPos(C,n)}a()},G=function(){RangeSelector.isActive()&&cellPrevState&&(m=!(A&&cellPrevState.sourceSheet===CURRSHEETNAME))},J=function(e){e||(M=!0)};return{on:y,off:O,setText:f,isActive:P,isRangeSelectionSupported:K,setTargetElement:o,revokeTargetElement:i,functionCallback:U,setMultiRange:c,returnsourceSheet:V,inputValidate:D,setRange:j.setRangeInfo.bind(j),arrowKeyDownCheck:s,allowToUpdateRange:J,enableOle:a}}(jQuery);appEvent.on("book.onbeforesheetswitch book.sheetloaded cell.focus",function(){isCellEdited()||RangeSelector.isActive()||(cellPrevState={sourceSheet:CURRSHEETNAME,row:currRow,col:currCol,val:currCellValue})}),appEvent.on("book.onbeforesheetswitch",function(){isCellEdited()&&!RangeSelector.isActive()&&cellPrevState.sourceSheet===CURRSHEETNAME&&submitCell()});
var DataValidation=function(){function t(){Se.listview=!1,ne(Ne),O()}function e(t,e,n){var t=parseInt(t),e=parseInt(e),i=$(getCell(t,e));if(i){var o=i.hasClass("dvInfo");o?$("#"+n+"_vcD").addClass("dvInfo"):$("#"+n+"_vcD").removeClass("dvInfo")}}function n(t,e){var n=userPresence.cellsInfo.cellsJson;if(n)for(var t=parseInt(t),e=parseInt(e),i=0;i<n.length;i++)if(t===parseInt(n[i].row)&&e===parseInt(n[i].col))return n[i].vcID;return!1}function o(t){null===Le&&(Le=new Array),t&&Le.push(t)}function r(){return null!==Le?Le.shift():void 0}function l(){return null===Le||0===Le.length}function a(){Le&&(Le.length=0,Le=null)}function s(t,e,n){var i=n?n:CURRSHEETNAME,o=v(i);null===o&&(o=new Array),o[t]=e,u(n,o)}function d(t){var e=v(CURRSHEETNAME);return e.hasOwnProperty(t)?e[t]:null}function c(t,e){isUndefined(e)&&(e=CURRSHEETNAME);var n=v(e);return null===n?!1:n.hasOwnProperty(t)?(delete n[t],!0):!1}function u(t,e){null===me&&(me=new Array),me[t]=e}function v(t){return me&&me.hasOwnProperty(t)?me[t]:null}function f(t){return t&&me.hasOwnProperty(t)?(delete me[t],!0):!1}function p(t,e){var n=me;if(e&&t){var i=e;if(n&&n.hasOwnProperty(i)){var o=n[i];for(var r in o)if(o.hasOwnProperty(r)){var l=CellUtils.getCellPosByLabel(r);-1!==parseInt(l.row)&&-1!==parseInt(l.col)&&DataValidation.util.isIntersect(parseInt(l.row),parseInt(l.col),t)&&delete o[r]}}}}function g(){return null===me}function h(t,e,n){if(g()===!1){var i=v(CURRSHEETNAME);if(null===i)return;var o=getCellLabel(t,e);i.hasOwnProperty(o)&&R(t,e,d(o),n)}}function C(t){var e=t[JSONConstants.DATAVALIDATION_ERROR];if(t[ActionConstants.CELL]){var n=t[ActionConstants.CELL][0],i=(n[JSONConstants.VALUE],n.r),r=n.c,a=e[JSONConstants.DATAVALIDATION_ERRORMSG],s="DIALOG_RETRY_CANCEL";if(e[JSONConstants.DATAVALIDATION_ISSTOPEDIT]===!0)if(Ie.dvError||Ie.retry||"datavalerrordialog"===sheetdialog.getDialogName()&&sheetdialog.isDialogOpen()||!l())o(t);else{if(Ie.dvPending=!0,Ie.dvError=!0,Ie.dvfocusRow=i,Ie.dvfocusCol=r,t.sn!==CURRSHEETNAME)var d=replaceParams(jsMsg["DataVal.SheetSwitchResponseOnError"],["<b>"+t.sn+"."+getCellLabel(parseInt(i),parseInt(r))+"</b>"])+"</br>",c=!0;else focusCell(Ie.dvfocusRow,Ie.dvfocusCol),Ie.currRespObj=t;V(s,a,c,d)}}}function E(t){if(!isUndefined(t)){var e=t[JSONConstants.DATAVALIDATION_ERROR];if(t[ActionConstants.CELL]&&e){var n=t[ActionConstants.CELL][0],i=(n[JSONConstants.VALUE],n.r,n.c,e[JSONConstants.DATAVALIDATION_ERRORMSG]),o=getCellLabel(parseInt(n.r),parseInt(n.c));s(o,i,t.sn),t.sn===CURRSHEETNAME&&R(parseInt(n.r),parseInt(n.c),i)}}}function R(t,e,i,o,r){if(isUndefined(o))var l=getCell(t,e);else l=o;l&&null!==l.getAttribute("dv")&&($(l).addClass("dvInfo"),r||l.removeAttribute("emsg"),setTimeout(function(){var i=n(t,e);i&&$("#"+i+"_vcD").addClass("dvInfo")},100),!r&&i&&l.setAttribute("emsg",i))}function D(t,e){var i=getCell(t,e);if(i&&null!==i.getAttribute("dv")&&null!==i.getAttribute("emsg")){$(i).removeClass("dvInfo");var o=n(t,e);o&&$("#"+o+"_vcD").removeClass("dvInfo"),i.removeAttribute("emsg")}}function w(t,e){if(Ie.currRespObj){var n=Ie.currRespObj[ActionConstants.CELL][0];if((isUndefined(t)||isUndefined(e))&&(t=currRow,e=currCol),n&&n.r===t&&n.c===e){if(!isUndefined(Ie.currRespObj[JSONConstants.DATAVALIDATION_ERROR])){var i=getCell(n.r,n.c);updateCellDataJson(i,n,n.r,n.c),ye&&$(i).addClass("highlightInvalid"),ENABLE_SAVE_MESSAGE&&showSaveMessage("disable")}Ie.retry=!1,Ie.dvPending&&A()}}}function A(){if(Ie.retry=!1,l())Ie.dvPending=!1,Ie.dvfocusRow=-1,Ie.dvfocusCol=-1,Ie.dvError=!1,Ie.currRespObj=null,a();else{var t=r();if(Ie.dvPending=!0,t&&(Ie.currRespObj=t,t.sn===CURRSHEETNAME)){var e=t[JSONConstants.DATAVALIDATION_ERROR],n=t[ActionConstants.CELL][0];Ie.dvError=!0,Ie.dvfocusRow=parseInt(n.r),Ie.dvfocusCol=parseInt(n.c),focusCell(Ie.dvfocusRow,Ie.dvfocusCol),V("DIALOG_RETRY_CANCEL",e[JSONConstants.DATAVALIDATION_ERRORMSG])}}}function I(){Ie.retry=!0,Ie.dvError=!1,$("#save_message_display").hide(),Re=0,sheetdialog.close();var t=currCell.getAttribute("cV")?currCell.getAttribute("cV"):currCellValue;cellField.value=t,clearTextSelection(),focusCellField(t),setSelectionRange(cellField,0,t.length)}function S(){Ie.retry=!1,Re=2,sheetdialog.close()}function m(){if(Ie.dvError&&(Ie.dvError=!1,2===Re)){if(resetGlobalVariables(),Ie.currRespObj&&!isUndefined(Ie.currRespObj[JSONConstants.DATAVALIDATION_ERROR])){var t=Ie.currRespObj[ActionConstants.CELL][0],e=getCell(t.r,t.c);updateCellDataJson(e,t,t.r,t.c),ye&&$(e).addClass("highlightInvalid"),ENABLE_SAVE_MESSAGE&&showSaveMessage("disable")}Ie.dvPending&&A()}Re=2}function L(){if(Se.listview&&(T(),!DataValidation.isDvCacheEmpty()&&Se.listDropDown)){var t=ActiveCellInfo,e=t.getStartRow(),n=t.getStartCol(),i=getCellPosInPage(e,n);Ne.css(isRTL?{top:i.top,right:i.left,left:"",width:ActiveCellInfo.getWidth()}:{top:i.top,left:i.left,right:"",width:ActiveCellInfo.getWidth()})}if(Oe){var o=DataValidation.getTopLeftForHint();if(o){var r=o.left,l=o.top,a=$("#hintCallout");a.css(isRTL?{top:l+"px",right:r+"px",left:""}:{top:l+"px",left:r+"px",right:""})}}}function N(){var t=document.createElement("div");t.style.position="absolute",t.className="dvListIconContainer",t.id="dvListIconContainer";var e=document.createElement("img");return $(e).css({position:"absolute",cursor:"pointer",right:"1px",bottom:"1px",maxWidth:"100%",maxHeight:"100%",zIndex:15+BASEZINDEX}),t.appendChild(e),Se.listIconContainer=t}function T(t,e){var n=getObj("dvIP"),i=Se.listIconContainer?Se.listIconContainer:N();$(n).empty();var o=i.cloneNode(!0),r=isUndefined(t)?currRow:t,l=isUndefined(e)?currCol:e,a=Merge.getCellInfo(r,l);isUndefined(a)||(r=a.endRow,l=a.endCol);var s=getRowTop(r),d=getRowHeight(r);o.style.height=d+"px",o.style.width=getColWidth(l)+"px",o.style.left=getColLeft(l)+"px",o.style.top=s+"px",n.appendChild(o);var c=o.childNodes[0];c.style.right="-14px",c.src=IMAGE_PATH+"list_dropdown1.png",c.onclick=ae,c.id="dvListDropSrc",b()}function b(){if(ISFREEZED){var t=dvListIconsPane.innerHTML;dvListIconsPane2.innerHTML=t,dvListIconsPane1.innerHTML=t,dvListIconsPane3.innerHTML=t;var e=dvListIconsPane1.childNodes,n=dvListIconsPane2.childNodes,i=dvListIconsPane3.childNodes;e[0].childNodes[0].onclick=ae,n[0].childNodes[0].onclick=ae,i[0].childNodes[0].onclick=ae,browser_ie&&(e[0].onmousedown=sheetMouseDown,n[0].onmousedown=sheetMouseDown,i[0].onmousedown=sheetMouseDown)}}function O(){dvListIconsPane.innerHTML="",ISFREEZED&&(dvListIconsPane1.innerHTML="",dvListIconsPane2.innerHTML="",dvListIconsPane3.innerHTML="")}function V(t,e,n,i){DataValidation.hintCallOutHide();var o=e.length<25?265:400,r={autoOpen:!1,width:o,resizable:!1,title:jsMsg["Service.ZohoOffice"],close:function(){m()},contextmenu:!1,hidetoolbar:!0,sheetswitch:!1,allowtoscroll:!1};xe.dtype=t,e=replaceParams(e,[getCellLabel(Ie.dvfocusRow,Ie.dvfocusCol)]),xe.errormsg=e,xe.hideButtons=n,xe.diffSheetAlert=i,sheetdialog.open("datavalerrordialog",r,xe)}function y(){DataValidation.isDvCacheEmpty()||(ie(Ne),Se.listval=null,Se.partnum=0,Se.tparts=0,Se.noOfItems=0,De=null,we=null,Ae=null)}function x(t,e,n,i,o,r,l,a){isUndefined(o)&&(o=CURRSHEETNAME);var s;s=a?a:new Range(t,e,n,i),n>availableEndRow&&(n=availableEndRow,t=availableStartRow);var d=new Range(t,e,n,i),u=d.getIterator();u.iterate(function(n,i){var a=!1,s=$(getCell(n,i));if(s.removeClass("highlightInvalid").removeClass("dvAnimation"),r&&("MergeDown"===l&&n===t||"MergeAcross"===l&&i===e||n===t&&i===e)){var d=getCellLabel(n,i);c(d),D(n,i),a=!0}if(a===!1)if(o===CURRSHEETNAME){var u=getCell(n,i);if(u&&null!==u.getAttribute("dv")){var d=getCellLabel(n,i);if(c(d),D(n,i),u.removeAttribute("dv"),Merge.getCellInfo(n,i)){var v=getCell(n,i,void 0,!1);v.removeAttribute("dv"),$(v).removeClass("highlightInvalid").removeClass("dvAnimation")}parseInt(currRow)===n&&parseInt(currCol)===i&&DataValidation.checkCurrCellFocusForDv(),DataValidation.isDvCacheEmpty()||Ae===CURRSHEETNAME&&DataValidation.util.isIntersect(n,i,De)&&y()}}else{var d=getCellLabel(n,i);c(d,o)}}),g()||p(s,o)}function H(t,e){null!==t&&t.setAttribute("dv",e)}function M(t,e){if(e){var n=e.getAttribute("dv");null!==n&&(n=decodeURIComponent(n))}var i=e?n:null;if(null!==i){var o=parseJSON(i);Oe=!0;var r=o.hint?o.hint:"";if(r&&r.length>25){var l=r.replace(/.{20}\S*\s+/g,"$&@").split(/\s+@/);r=l.join("\n")}var a=$("#hintCallout"),s=a.find("div#eMsg");s.text("").hide(),DataValidation.showHintTextCallout(r);var d=e.getAttribute("emsg");d&&s.text(d).show();var c=DataValidation.getTopLeftForHint();if(c){var u=c.left,v=c.top;a.css(isRTL?{top:v+"px",right:u+"px",left:"","box-shadow":"3px 0 0 rgb(199, 199, 199)","text-align":"right"}:{top:v+"px",left:u+"px",right:"","box-shadow":"","text-align":""})}}}function _(){var t=document.createElement("div");t.setAttribute("id","hintCallout"),t.setAttribute("class","dvtoolTip"),t.style.position="absolute",t.style.zIndex=1e3+BASEZINDEX,t.style.display="none";var e=document.createElement("span");$(e).append(document.createElement("b")),$(e).find("b").text(jsMsg["DataVal.DV"]+": ");var n=$(document.createElement("div"));n.css("display","none"),n.attr("id","eMsg"),n.css("color","red"),$(e).append(n);var i=document.createElement("div");$(i).css({"margin-top":"2px",width:"170px"}),$(t).append($(e)),$(t).append($(i)),document.body.appendChild(t)}function U(t,e){if(!isUndefined(t)){var n=t.getIterator();n.iterate(function(t,n){P(t,n,e)})}}function P(t,e,n){var i=getCell(t,e);if(i&&n){var o="{";isUndefined(n[JSONConstants.CV_HINT])||(o+='"hint":"'+n[JSONConstants.CV_HINT]+'"'),n.list===!0&&(isUndefined(n[JSONConstants.CV_HINT])||(o+=","),o+='"list":true'),o+="}",i.setAttribute("dv",o),t===currRow&&e===currCol&&DataValidation.checkCurrCellFocusForDv()}}function F(t,e){if(e&&t){if(e!==Se.listSrcSheet&&e!==Ae)return;for(i=0;i<t.length;i++){var n=t[i];switch(n.a){case ActionConstants.INSERT_ROW:case ActionConstants.DELETE_ROW:var o=n.si,r=o+n.count-1;we&&(o>=we.startRow&&o<=we.endRow||r>=we.startRow&&r<=we.endRow||o<=we.startRow)?y():(De&&o>=De.startRow&&o<=De.endRow||r>=De.startRow&&r<=De.endRow)&&y();break;case ActionConstants.INSERT_COL:case ActionConstants.DELETE_COL:var o=n.si,r=o+n.count-1;we&&(o>=we.startCol&&o<=we.endCol||r>=we.startCol&&r<=we.endCol||o<=we.startCol)?y():(De&&o>=De.startCol&&o<=De.endCol||r>=De.startCol&&r<=De.endCol)&&y()}}}}function J(t){t&&(t[JSONConstants.ACTION]===ActionConstants.SHEET_RENAME?(k(t[JSONConstants.OLD_SHEET_NAME],t[JSONConstants.SHEET_NAME]),DataValidation.isDvCacheEmpty()||t[JSONConstants.OLD_SHEET_NAME]!==Se.listSrcSheet||isUndefined(Se.listSrcSheet)||(Se.listSrcSheet=t[JSONConstants.SHEET_NAME],y())):t[JSONConstants.ACTION]===ActionConstants.SHEET_REMOVE&&W(t.sn))}function k(t,e){if(t&&e){var n=v(t);null!==n&&(f(t),u(e,n))}}function W(t){if(t){var e=v(t);null!==e&&f(t)}}function j(t){t&&!DataValidation.isDvCacheEmpty()&&null!==we&&(isUndefined(Se.listSrcNR)||Se.listSrcNR!==t||y())}function B(t,e,n){if(null===we||DataValidation.isDvCacheEmpty()||(isUndefined(n)&&(n=CURRSHEETNAME),Se.listSrcSheet===n&&DataValidation.util.isIntersect(t,e,we)&&y()),!g()){var i=getCellLabel(t,e);c(i)&&D(t,e)}}function G(t,e,n,i){null!==we&&Se.listSrcSheet===CURRSHEETNAME&&DataValidation.util.isRangeIntersect(new Range(t,e,n,i),we)&&y()}function q(){return Ie.dvError?!0:Ie.retry===!0?(Ie.retry=!1,submitCell(),!0):!1}function z(t,e,n,i,o,r){if(t){DataValidation.hintCallOutHide();var l=ActiveCellInfo,o=isUndefined(o)?l.getStartRow():o;o=ActiveCellInfo.isMerged()?ActiveCellInfo.getEndRow():o;var r=isUndefined(r)?l.getStartCol():r,a=getCellPosInPage(o,r);"create"===e?DataValidation.isDvCacheEmpty()?(Ne=Z(ge,n,a),i||ee(Ne)):oe(Ne)||re(Ne,!0):"append"===e&&(n&&K(Ne,n),i||ee(Ne))}if("keyup"===t.type){var s=cellField.value;ce(s)}}function Z(t,e,n){if(!e)return void(Se.listDropDown=!1);Se.listDropDown=!0;var i=$("<ul>",{id:"dvListMenu"});i.addClass("dvListMenu"),i.css({width:ActiveCellInfo.getWidth(),"min-width":cellDefaultWidth,zIndex:23e3});var o=ActiveCellInfo.isMerged()?ActiveCellInfo.getEndRow():currRow;isUndefined(n)&&(n=getCellPosInPage(o,currCol)),i.css(isRTL?{top:n.top,right:n.left,left:""}:{top:n.top,left:n.left,right:""}),i.scroll(function(t){Se.listDropDown&&$(this)[0].scrollHeight&&$(this)[0].scrollHeight-$(this).scrollTop()<=$(this).outerHeight()&&le(t,"append")});var r=X,l=Y,a=te;return i.on("mouseenter","li",r),i.on("dvListFocus","li",l),i.on("click","li",a),K(i,e,n),i}function K(t,e,n){if(!e)return void re(t,!1);var i=Se.row,o=Se.col,r=!1;Se.noOfItems+=e.length,n&&t.css(isRTL?{top:n.top,right:n.left,left:""}:{top:n.top,left:n.left,right:""});var l=t;0!==l.find("li").length&&(r=!0);for(var a=0;a<e.length;a++){var s=decodeURIComponent(e[a]),d=$("<li>");d.text(s),l.append(d),d=null}if(i===currRow&&o===currCol){if(!r){$(document.body).append(l);var c=l.find("li:visible").length;ue(l,c),l.find("li:visible").length<Ee?t.css("height","auto"):t.css("height","200px"),setTimeout(function(){se()},100)}if(Te===!0&&r===!0){var s=cellField.value;ce(s,void 0,r)}}else Se.listDropDown=!1,ne(l)}function X(t){var e=t.target||t.srcElement;if(t.preventDefault(),browser_ie){var n=cellField.id;if(document.activeElement.getAttribute("id")!==n){var i=currCell.getAttribute("cV")?currCell.getAttribute("cV"):currCellValue;focusCellField(i)}}$(e).trigger("dvListFocus")}function Y(t){var e=t.target||t.srcElement;if(pe&&(pe.removeClass("dvListHover"),ve.removeClass("dvListHover"),fe.removeClass("dvListHover")),$(e).addClass("dvListHover"),ve=$(e).prev("li"),Te===!0&&!ve.is(":visible")){var n=Ne.find(ve).index();ve=Ne.find("li:lt("+n+"):visible:last")}if(fe=$(e).next("li"),Te===!0&&!fe.is(":visible")){var n=Ne.find(fe).index();fe=Ne.find("li:gt("+n+"):visible:eq(0)")}pe=$(e)}function Q(t){var e=unescapeSpecialChar(t);cellField.value=e,exprField.value=e,DataValidation.listSubmit=!0,re(Ne,!1)}function te(t){var e=t.target||t.srcElement,n=$(e).text();DataValidation.listSubmit=!0,setSuggestValue(escapeSpecialChar(n)),re(Ne,!1)}function ee(t){t&&t.unbind("scroll")}function ne(t){t&&1===t.length&&0!==$("#"+t.attr("id")).length&&(re(t,!1),t.detach())}function ie(t){null!==t&&(ne(t),Ne&&Ne.remove(),Ne=null)}function oe(t){if(!t)return!1;if(1===t.length&&0===$("#"+t.attr("id")).length){var e=currRow,n=currCol;return t.css("width",ActiveCellInfo.getWidth()),$(document.body).append(t),re(t,!0),(e!==currRow||n!==currCol)&&ne(t),!0}return!1}function re(t,e,n){if(!t)return void(Se.listDropDown=!1);if(n||(Se.listDropDown=e),Se.listInFocus=!1,e===!0){var i=t;Te=!1,be=!1,t.show(),i.find("li").show();var o=i.find("li:visible").length;ue(t,o),Ee>o?Ne.css("height","auto"):Ne.css("height",Ce+"px"),se()}else e||n||(be=!1),t.scrollTop(0),t.hide()}function le(t,e,n,i){if(Ve!==!0)if((isUndefined(n)||isUndefined(i))&&(n=currRow,i=currCol),"append"===e||DataValidation.isDvCacheEmpty()||!DataValidation.util.isIntersect(n,i,De)){"create"===e&&y(),Se.row=n,Se.col=i;var o=new RequestParameters(ActionConstants.DATA_VALIDATION_READLIST);o.setParameters(WorkSheets.getAssociatedActiveSheetName(),n,i,Se.tparts,Se.partnum),Ae=WorkSheets.getActiveSheetName(),Ve=!0;var r=new AjaxRequest;r.init("POST",o.getURL(),!0,o.getParametersAsString()),r.addEventListener("onComplete",function(o){Ve=!1;var r=parseJSON(o.responseText),l=r.dataval;if(isUndefined(l)||$.isEmptyObject(l))z(t,"create",void 0,!1,n,i);else{0===Se.partnum&&(De=new Range(l[JSONConstants.START_ROW],l[JSONConstants.START_COLUMN],l[JSONConstants.END_ROW],l[JSONConstants.END_COLUMN]),isUndefined(l.listSrcRange)||(we=new Range(l.listSrcRange[JSONConstants.START_ROW],l.listSrcRange[JSONConstants.START_COLUMN],l.listSrcRange[JSONConstants.END_ROW],l.listSrcRange[JSONConstants.END_COLUMN]),Se.listSrcNR=l.listSrcRange[JSONConstants.NAME_OF_RANGE],Se.listSrcSheet=l.listSrcRange[JSONConstants.SHEET_NAME]));var a=l.list;if(Se.partnum=parseInt(l.partnum),Se.tparts=parseInt(l.tparts),Se.totListItems+=a.length,-1===Se.partnum&&0===l.list.length)z(t,e,void 0,!1,n,i);else{var s=-1===Se.partnum||Se.totListItems>=DV_MAX_CELLRANGE_ITEMS?!1:Se.tparts>1?!0:!1;z(t,e,a,s,n,i)}}}),r.sendRequest()}else Se.row=n,Se.col=i,z(t,e,void 0,void 0,n,i)}function ae(t){if(!Ie.dvError){if(Se.listDropDown)return void re(Ne,!1);Se.listDropDown=!0;var e=currCell.getAttribute("cV")?currCell.getAttribute("cV"):currCellValue;focusCellField(e),le(t,"create",currRow,currCol)}}function se(){if(Se.listDropDown===!0){if(null!==Ne)var t=Ne;else t=$("#dvListMenu");Se.listInFocus=!0,t.find("li:visible:eq(0)").trigger("dvListFocus"),0!==t.scrollTop()&&t.animate({scrollTop:0},100)}}function de(t){if(40===t)if(fe&&0!==fe.length){if(Math.round(pe.position().top)+he>=Ce){var e=Math.round(Ne.scrollTop());Ne.scrollTop(e+he)}fe.is(":visible")&&fe.trigger("dvListFocus")}else Ne.animate({scrollTop:0},100),Ne.find("li:visible:eq(0)").trigger("dvListFocus");else if(38===t){if(ve&&0!==ve.length){if(Math.round(pe.position().top)-he<0){var e=Math.round(Ne.scrollTop());Ne.scrollTop(e-he)}ve.is(":visible")&&ve.trigger("dvListFocus")}}else if(13===t||9===t){if(pe&&0!==pe.length)return Q(escapeSpecialChar(pe.text())),!0}else if(27===t)resetGlobalVariables(),re(Ne,!1),DataValidation.isDvRetryMode()&&(focusCell(currRow,currCol),w());else if(36===t)se();else if(35===t){var n=Ne[0].scrollHeight;Ne.animate({scrollTop:n},100),Ne.find("li:visible:last").trigger("dvListFocus")}return!1}function ce(t,e,n){if("="===t)return void re(Ne,!1);if(Se.listDropDown&&Ne){if(0===t.trim().length)return void re(Ne,!0);t=t.toLowerCase(),8===e&&Te?Ne.show().find("li:hidden").filter(function(){return 0===$(this).text().toLowerCase().indexOf(t)}).show():8!==e&&Te?Ne.find("li:visible").filter(function(){return 0!==$(this).text().toLowerCase().indexOf(t)}).hide():Ne.show().find("li").hide().filter(function(){return 0===$(this).text().toLowerCase().indexOf(t)}).show();var i=Ne.find("li:visible");Te=i.length!==Ne.find("li").length,0!==i.length?(be=!1,n||se(),i.length<Ee?Ne.css("height","auto"):Ne.css("height","200px"),ue(Ne,i.length)):(be=!0,re(Ne,!1,be))}}function ue(t,e){if(null!==t){var n=getCellPosInPage(currRow,currCol),i=n.top,o=n.left,r=$(currCell).height(),l=parseInt(findClientDim().height)-(parseInt(i)+parseInt(r)),a=200;if(Ee>=e&&(a=e*he),a>l)t.css("top",i-(a+r+10)+"px"),t.css(isRTL?{right:o+"px",left:""}:{left:o+"px",right:""});else{var s=ActiveCellInfo,d=ActiveCellInfo.isMerged()?s.getEndRow():s.getStartRow(),c=s.getStartCol(),u=getCellPosInPage(d,c);u&&t.css(isRTL?{top:u.top,right:u.left,left:""}:{top:u.top,left:u.left,right:""})}}}var ve,fe,pe,ge="dvListMenu",he=20,Ce=200,Ee=10,Re=2,De=null,we=null,Ae=null,Ie={dvfocusRow:-1,dvfocusCol:-1,dvError:!1,retry:!1,dvPending:!1,currRespObj:null},Se={listview:!1,listDropDown:!1,listSrcSheet:void 0,listSrcNR:void 0,listIconContainer:void 0,partnum:0,tparts:0,listInFocus:!1,row:-1,col:-1,totListItems:0},me=null,Le=null,Ne=null,Te=!1,be=!1,Oe=!1,Ve=!1,ye=!1,xe={dtype:"",errormsg:"",hideButtons:"",diffSheetAlert:"",init:function(){setTimeout(function(){var t=(xe.dtype,xe.errormsg);if(xe.hideButtons&&xe.diffSheetAlert)$("#stopmsg").text(t),$("#stopmsgDiffSheet").html("<br>"+xe.diffSheetAlert).show(),$("#stopdiv").find(":button").hide();else{$("#stopmsg").text(t),$("#stopmsgDiffSheet").html("");var e=$("#stopdiv").find("button");$(e[0]).bind("click",function(){I()}),$(e[1]).bind("click",function(){S()}),$("#stopdiv").find(":button:eq(0)").focus()}$("#save_message_display").hide()},200)}};return $(document).ready(function(){_()}),appEvent.on("grid.shift",function(){L()}),appEvent.on("grid.afterColumnResize",function(){L()}),appEvent.on("namedrangechanged",function(t,e){var n=e.n;n&&(n=n.replace(/\"/g,""),n=n.replace(/\'/g,""),j(n))}),appEvent.on("range.focus cell.focus",function(){DataValidation.checkCurrCellFocusForDv()}),appEvent.on("cell.clear",function(t){if(!g()){var e=getCellLabel(t.row,t.col);c(e),D(t.row,t.col)}var n=$(getCell(t.row,t.col));n&&n.removeClass("highlightInvalid").removeClass("dvAnimation")}),appEvent.on("cell.dataUpdate",function(t,e,n,i){if(B(t,e,n),isHighlightInvalidData===!0){var o=$(getCell(t,e));o&&o.removeClass("highlightInvalid").removeClass("dvAnimation"),i===!1&&DataValidation.highlightInvalidCell(t,e)}}),appEvent.on("range.onBeforeMerge",function(t){var e=t.SR,n=t.SC,i=t.ER,o=t.EC,r=t.mergeOption,l=!0;x(e,n,i,o,void 0,l,r)}),appEvent.on("range.clearcontent",function(t,e,n,i){G(t,e,n,i)}),appEvent.on("cell.onBeforeSubmit",function(t){var e=t.row,n=t.col,i=t.v,o=getCell(e,n);if(o)var r=o.getAttribute("dv");if(r){var l=parseJSON(r);if(!g()){var a=getCellLabel(e,n);c(a),D(e,n)}Ie.retry===!1&&(ye=!1,$(o).hasClass("highlightInvalid")&&(ye=!0,$(o).removeClass("highlightInvalid").removeClass("dvAnimation")));var s=encodeURIComponent(i);("%08"===s||"%09"===s||"%0A"===s||"%0D"===s)&&(i=""),DataValidation.listSubmit===!0&&l.list===!0&&(0===i.indexOf("'")&&(i=i.replace(/'/,"''")),DataValidation.validateDV=!1,DataValidation.listSubmit=!1)}else DataValidation.validateDV=void 0}),appEvent.on("datavalidation.stopError",function(t){C(t)}),appEvent.on("datavalidation.infoError",function(t){E(t)}),appEvent.on("server.response.workbookLevelAction",function(t){J(t)}),appEvent.on("range.update",function(t,e){F(t,e)}),appEvent.on("range.clearAll",function(t,e,n,i){x(t,e,n,i)}),appEvent.on("book.onaftersheetswitch",function(){DataValidation.hintCallOutHide(),Se.listDropDown&&ne(Ne)}),appEvent.on("grid.afterload",function(){currCell=getCell(cursor_Row_Index,cursor_Col_Index),setTimeout(function(){DataValidation.checkCurrCellFocusForDv()},300),a(),y()}),appEvent.on("datavalidation.infoForCollobarators",function(t,e){if(!e&&!isUndefined(t[ActionConstants.CELL])&&0!==t[ActionConstants.CELL].length&&(!isUndefined(t.sn)&&CURRSHEETNAME!==t.sn||!isUndefined(t.s)&&WorkSheets.getAssociatedActiveSheetName()!==t.s)&&!g())for(var n=0;n<t[ActionConstants.CELL].length;n++)if(isUndefined(t[ActionConstants.CELL][n].r))for(var i=t.sr;i<=t.er;i++)for(var o=t.sc;o<=t.ec;o++){var r=getCellLabel(i,o);c(r,t.sn)&&D(i,o)}else{var l=t[ActionConstants.CELL][n].r,a=t[ActionConstants.CELL][n].c,r=getCellLabel(l,a);c(r,t.sn)&&D(l,a)}}),appEvent.on("cell.datavalidationClear",function(t){for(var e=t,n=0;n<e.length;n++){var i=isUndefined(t.sn)?isUndefined(t.s)?void 0:WorkSheets.getSheetNameFromCode(t.s):t.sn;x(e[n].sr,e[n].sc,e[n].er,e[n].ec,i)}}),appEvent.on("cell.datavalidationApply",function(t){var e=t;if(!isUndefined(e))for(var n=0;n<e.length;n++){var i=new Range(e[n].sr,e[n].sc,e[n].er,e[n].ec);U(i,e[n])}}),appEvent.on("visualcue.createAndShow",function(t,n,i){e(t,n,i)}),appEvent.on("visualcue.show",function(t,n,i){e(t,n,i)}),appEvent.on("grid.cellFieldKeyDown",function(t){var e=browser_ie?window.event.keyCode:t.which;27===e&&DataValidation.isDvHintVisible()===!0&&DataValidation.hintCallOutHide()}),appEvent.on("cell.escapeEdit",function(t,e){DataValidation.isDvRetryMode()===!0&&w(t,e)}),appEvent.on("sheet.verticallyScrolled",function(){DataValidation.checkDVHintPosition()}),appEvent.on("sheet.horizontallyScrolled",function(){DataValidation.checkDVHintPosition()}),appEvent.on("cell.setDataValidation",function(t,e,n,i){if(H(n,i),h(t,e,n),"undefined"!=typeof AuditTrail&&("undefined"==typeof AuditTrail.isCloseVersionHistory||AuditTrail.isCloseVersionHistory===!0)&&isHighlightInvalidData===!0){var o=$.parseJSON(i);o.contentValid===!1&&DataValidation.highlightInvalidCell(t,e,n)}}),appEvent.on("grid.beforeInsertRowOrColumn",function(){var t=q();return t===!0?(Ie.retry=!1,appEvent.preventDefault()):void 0}),appEvent.on("grid.onBeforeInsertCol",function(){var t=q();return t===!0?(Ie.retry=!1,appEvent.preventDefault()):void 0}),appEvent.on("grid.afterRowResize",function(){L()}),appEvent.on("cell.onBeforeFocusCellfield  cell.keyUp  cell.keyDown grid.mousedown cell.focusFillSeries exprField.keyDown colHead.mousedown rowHead.mousedown",function(){return DataValidation.isDvErrorThrown()?appEvent.preventDefault():void 0}),appEvent.on("grid.focusRow grid.focusCol",function(t){DataValidation.checkCurrCellFocusForDv(void 0,void 0,t)}),appEvent.on("cell.showDvList",function(t){var e=currCell;return Se.listview&&null!==e.getAttribute("dv")?(ae(t),appEvent.preventDefault()):void 0}),appEvent.on("grid.cFKeyDownInDvCell",function(t){if(Se.listDropDown&&!DataValidation.isDvListNoResults()){var e=browser_ie?window.event.keyCode:t.which,n=!0;return 38===e||40===e||13===e||35===e||36===e||27===e||9===e?Se.listInFocus===!1?se():n=de(e):Se.listInFocus=!1,n?!1:appEvent.preventDefault()}}),appEvent.on("grid.cFKeyUpInDvCell",function(t){var e=browser_ie?window.event.keyCode:t.which;if(Se.listDropDown){if(!(e>=35&&40>=e)&&13!==e&&27!==e&&18!==e){t.preventDefault();var n=cellField.value;return ce(n,e),appEvent.preventDefault()}}else{var i=currCell.getAttribute("dv"),o=$.parseJSON(i);if(o&&o.list&&27!==e&&!Se.listDropDown){var r=ActiveCellInfo.getStartRow(),l=ActiveCellInfo.getStartCol();return le(t,"create",r,l),appEvent.preventDefault()}}return!1}),appEvent.on("updateServerResponse",function(){y()}),appEvent.on("initVersionView",function(){Se.listview&&t(),Oe&&DataValidation.hintCallOutHide(),isHighlightInvalidData===!0&&$(".highlightInvalid").removeClass("highlightInvalid").removeClass("dvAnimation")}),{validateDV:void 0,isDvErrorThrown:function(){return Ie.dvError===!0},isDvRetryMode:function(){return Ie.retry===!0},getDvListCacheRange:function(){return De},isDvListNoResults:function(){return be===!0},checkDVHintPosition:function(){if(Se.listDropDown&&ne(Ne),Oe){var t=$("#hintCallout");if(t&&0!==t.length){var e=DataValidation.getTopLeftForHint();if(e){{var n=(parseInt(isRTL?t.css("right"):t.css("left")),parseInt(t.css("top")),e.top),i=e.left;screen.width,screen.height}t.css("top",n+"px"),t.css(isRTL?{right:i+"px","box-shadow":"3px 0 0 rgb(199, 199, 199)","text-align":"right",top:n+"px"}:{left:i+"px","box-shadow":"","text-align":"",top:n+"px"});var o=n-sheetTop,r=i-rowHeadWidth;0>o||0>r?t.hide():t.show()}}}},checkCurrCellFocusForDv:function(e,n,i){if(!(jsSHARE_VIEW&&!ALLOW_TO_WRITE||jsVERSION_VIEW)){-1===Ie.dvfocusRow||-1===Ie.dvfocusCol||currRow===Ie.dvfocusRow&&currCol===Ie.dvfocusCol||Ie.dvPending&&A();var o=e?getCell(e,n):currCell;if("undefined"==typeof e&&(e=currRow,n=currCol),o){if(Se.listview&&t(),Oe&&DataValidation.hintCallOutHide(),ProtectedRanges.isSheetLocked(CURRSHEETNAME)||o&&ProtectedRanges.isCellLocked(e,n,!0))return;if("focusRow"!==i&&"focusCol"!==i){var r=o.getAttribute("dv");if(null!==r&&(r=decodeURIComponent(r)),null!==r){var l=parseJSON(r);if(l.list===!0&&(T(),Se.listview=!0),(l.hint||null!==o.getAttribute("emsg"))&&(o.focus||o.click)){var a=o.focus?o.focus:o.click;M(a,o)}}}}}},getTopLeftForHint:function(){var t=currCell;if(null!=t&&Oe){var e=$("#hintCallout");if(hintCallout&&0!==hintCallout.length){var n=parseInt(t.style.height),i=parseInt(t.style.width),o=parseInt(ActiveCellInfo.getLeft())+(i-20)+rowHeadWidth-getNormalizedScrollLeft(),r=parseInt(ActiveCellInfo.getTop())+(n+3)+sheetTop-getSheetScrollTop(),l=findClientDim().width,a=findClientDim().height,s=parseInt(e.css("max-width")),d=parseInt(e.height());return o+s>l&&(o=o-s+80),r+d>a&&(r-=d),{type:"POSITION",top:r,left:o}}return null}},showHintTextCallout:function(t){var e=$("#hintCallout");!e||isRowSelected()||isColSelected()||(Oe=!0,e.show().find("div:eq(1)").text(t))},hintCallOutHide:function(){var t=$("#hintCallout");t&&(Oe=!1,t.hide())},isDvHintVisible:function(){return Oe},isDvCacheEmpty:function(){return null===Ne},highlightCells:function(t,e){if(!isUndefined(t))for(var n=0;n<t.length;n++)for(var i=t[n],o=0;o<=i.length;o++){var r=i[o];isUndefined(r)||DataValidation.highlightInvalidCell(r.r,r.c,void 0,e)}},highlightInvalidCell:function(t,e,n,i){var o="highlightInvalid";i===!0&&(o="dvAnimation");var r=$(n?n:getCell(t,e));isHighlightInvalidData===!0&&r&&(r.addClass(o),i===!0&&setTimeout(function(){r.addClass("highlightInvalid")},200))}}}();DataValidation.util={checkNRexists:function(t){return t?NamedRange.isNamedRange(t):void 0},getNamedRangesArray:function(){var t=NamedRange.getNamedRangesList();if(t.length>0){var e=new Array;return t.forEach(function(t){e.push("="+t)}),e}return null},getSheetNamesArray:function(){var t=getObj("sheetsTab").getElementsByTagName("TD"),e=new Array;if(t)for(var n=0;n<t.length-1;n++)e.push(t[n].getAttribute("sheetname"));return e},isIntersect:function(t,e,n){return n?t>=n.startRow&&t<=n.endRow&&e>=n.startCol&&e<=n.endCol:!1},isRangeIntersect:function(t,e){return t&&e?!(t.startCol>e.endCol||t.endRow<e.startRow||t.endCol<e.startCol||t.startRow>e.endRow):!1},isRange1D:function(t,e){if(1==e){var n=DataValidation.util.getDvRangeValues(CellUtils.removeDollar(t));return n.startRow==n.endRow||n.startCol==n.endCol}return 2==e?NamedRange.isNamedRangeOneDimentional(t):void 0},getDvRangeValues:function(t){if(isUndefined(t))return!1;var e=getDataFrom2DRangeText(t);return{startRow:e.sR,startCol:e.sC,endRow:e.eR,endCol:e.eC,sheetName:e.sheetName}}};
function Filter(e,t,r){this.id=e,this.range=t||{},this.appliedCols=r||[],this.columns=[],this.row=this.range.sr,this.rowTop=getRowTop(this.row);for(var l=t.sc,i=l,s=t.ec;s>=i;i++)this.columns[i]=new columnClass(i-l);return this}function columnClass(e){this.index=e,this.dataType=void 0,this.lastAppliedCondtion=void 0,this.columnData=void 0}function selectBackCustomFilter(){return isFilterOptionsDIVOpened?(selectedFilterTabIndex=8,$("#cF").focus(),void $("#customFilterBack").css("box-shadow","0px 0px 2px 2px #addfff")):!1}function focusSetting(e){$("#"+e).focus(),setTimeout(function(){$("#"+e).focus()},10)}var isFilterOptionsDIVOpened=!1,selectedFilterTab="autoFilterId";Filter.toolBarHandler=function(){var e=$("#reApply"),t=$("#clrFilter");if(Filter.hasFilter&&0!==Filter.getInstance().appliedCols.length)if(e.enable(),currRow>=Filter.getInstance().range.sr&&currRow<=Filter.getInstance().range.er&&Filter.getInstance().appliedCols.contains(currCol)){t.enable();var r='"'+getColHeadLabel(currCol+1)+'"';t.find("span.ui-zmenu-text").text(replaceParams(jsMsg["Filter.Clear_Filter_From_Column"],new Array(r)))}else t.disable(),t.find("span.ui-zmenu-text").text(jsMsg["Filter.Clear_Filter"]);else e.disable(),t.disable(),t.find("span.ui-zmenu-text").text(jsMsg["Filter.Clear_Filter"])},Filter.instances={},Filter.hasFilter=!1,Filter.isPivotFilter=!1,Filter.currCol,columnClass.prototype={getIndex:function(){},getLastAppliedCondition:function(){},getColumnData:function(){},setIndex:function(){},setLastAppliedCondition:function(){},setColumnData:function(){},isDataModified:!1,setDataModifed:function(){}},Filter.header={filterImage:"filter_new.png",filterAppliedImage:"filterApplied.png",selectAllItemsMsg:jsMsg["Filter.selectAll"],selectedItem:"filterItemSelect",partiallySelectedItem:"filterPartialSelection",deselectedItem:"filterItem",filterMenuHeader:"filterMenuHeader"},Filter.getHeader=function(){return Filter.header},Filter.filterIconHandler=function(e){e?(menutabListener.doAction(TOOLBAR.DATA,{id:"filter",action:"enable",callback:applyStyle_addClass,args:["filter","uiGrey"]}),menutabListener.doAction(TOOLBAR.DATA,{id:"filterDropDown",action:"enable",callback:applyStyle_addClass,args:["filterDropDown","uiGrey"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"filterClone",action:"addClass",callback:applyStyle_addClass,args:["filterClone","uiGrey"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"filterDropDownClone",action:"addClass",callback:applyStyle_addClass,args:["filterDropDownClone","uiGrey"]})):(menutabListener.doAction(TOOLBAR.HOME,{id:"filterClone",action:"disable",callback:applyStyle_removeClass,args:["filterClone","uiGrey"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"filterDropDownClone",action:"disable",callback:applyStyle_removeClass,args:["filterDropDownClone","uiGrey"]}),menutabListener.doAction(TOOLBAR.DATA,{id:"filter",action:"disable",callback:applyStyle_removeClass,args:["filter","uiGrey"]}),menutabListener.doAction(TOOLBAR.DATA,{id:"filterDropDown",action:"disable",callback:applyStyle_removeClass,args:["filterDropDown","uiGrey"]}))},Filter.create=function(e,t,r){return Filter.instances[e]=new Filter(e,t,r),Filter.instances[e].buildIcons(),Filter.hasFilter=!0,UIComponents.executeOnDeferredInit(function(){Filter.filterIconHandler(!0)}),Filter.instances[e]},Filter.ClearFilter=function(){Filter.hideFilterOptions()},Filter.reapplyFilter=function(){var e=Filter.getInstance();if(e)var t=e.range,r=t.sr,l=t.sc,i=t.er,s=t.ec;var o=new AjaxRequest,a=new RequestParameters(ActionConstants.FILTER_REAPPLY);a.setParameters(WorkSheets.getAssociatedActiveSheetName(),r,l,i,s),o.init("POST",a.getURL(),!0,a.getParametersAsString()),actionManager.addRequest(o)},Filter.clearExistingFilter=function(){var e=Filter.getInstance();if(e){var t=currCol-e.range.sc;Filter.applyFilterCriteria(CURRSHEETNAME,t,void 0,void 0,void 0,void 0,void 0,void 0,ActionConstants.APPLY_FILTER_ALL)}Filter.enableDisableInsertIcon(!0)},Filter.filterByCellColor=function(){var e=new AjaxRequest,t=new RequestParameters(ActionConstants.FILTER_BY_CELL_COLOR);t.setParameters(WorkSheets.getAssociatedActiveSheetName(),currRow,currCol,currRow,currCol),e.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(e),Filter.enableDisableInsertIcon(!1)},Filter.filterByFontColor=function(){var e=new AjaxRequest,t=new RequestParameters(ActionConstants.FILTER_BY_FONT_COLOR);t.setParameters(WorkSheets.getAssociatedActiveSheetName(),currRow,currCol,currRow,currCol),e.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(e),Filter.enableDisableInsertIcon(!1)},Filter.filterDataScroll=function(e){var t=getMouseWheelData(e),r=getObj("nrmlflyoutmenu"),l=r.scrollTop,i=30*(t/3);if(0>t)var s=l+-1*i;else s=l-i;getObj("filterColumnData").scrollTop=s,stopEvt(e)},Filter.enableDisableInsertIcon=function(e){e?(menutabListener.doAction(TOOLBAR.INSERT,{id:"insertCellBtn",action:"enable",callback:button_enable,args:["insertCellBtn"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"cellOpt",action:"enable",callback:button_enable,args:["cellOpt"]})):(menutabListener.doAction(TOOLBAR.INSERT,{id:"insertCellBtn",action:"disable",callback:button_disable,args:["insertCellBtn"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"cellOpt",action:"disable",callback:button_disable,args:["cellOpt"]}))},Filter.createFilter=function(e,t,r,l,i){e=WorkSheets.getSheetCodeFromName(e);var s=new RequestParameters(ActionConstants.CREATE_FILTER);s.setParameters(e,t,r,l,i);var o=new AjaxRequest;o.init("POST",s.getURL(),!0,s.getParametersAsString()),actionManager.addRequest(o)},Filter.filterByValue=function(){var e=new AjaxRequest,t=new RequestParameters(ActionConstants.FILTER_BY_VALUE);t.setParameters(WorkSheets.getAssociatedActiveSheetName(),currRow,currCol,currRow,currCol),e.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(e),Filter.enableDisableInsertIcon(!1)},Filter.removeFilter=function(e){Filter.hasFilter=!1;var t=Filter.getInstance();if(t){var r=t.range,l=new RequestParameters(ActionConstants.REMOVE_FILTER);e=WorkSheets.getSheetCodeFromName(e),l.setParameters(e,r.sr,r.sc,r.er,r.ec);var i=new AjaxRequest;i.init("POST",l.getURL(),!0,l.getParametersAsString()),actionManager.addRequest(i)}Filter.enableDisableInsertIcon(!0)},Filter.doFilterAction=function(e){if(READ_WRITE){var t,r,l,i;if("undefined"==typeof e&&(e=ActionConstants.CREATE_FILTER,Filter.hasFilter&&(e=ActionConstants.REMOVE_FILTER)),e===ActionConstants.CREATE_FILTER){if(l=currRow,i=currCol,t=l,r=i,isCellRange()){var s=getCellRange();t=s.startRow,r=s.startCol,l=s.endRow,i=s.endCol}Filter.createFilter(CURRSHEETNAME,t,r,l,i)}else e===ActionConstants.REMOVE_FILTER&&Filter.removeFilter(CURRSHEETNAME)}},Filter.remove=function(){var e=Filter.getInstance();e&&(Filter.filterIconHandler(!1),e.remove())},Filter.regenerateAffectedCharts=function(e){var t=[];if(e){var r=Object.keys(e);if(r.forEach(function(r){r===WorkSheets.getAssociatedActiveSheetName()&&(t=e[r])}),t&&t.length>0){var l=new AjaxRequest,i=new RequestParameters(ActionConstants.CHART_REFRESH);i.setParameters(WorkSheets.getAssociatedActiveSheetName(),JSON.stringify(t)),l.init("POST",i.getURL(),!0,i.getParametersAsString()),l.addEventListener("onComplete",function(e){var t=JSON.parse(e.responseText);t&&!isUndefined(t[ActionConstants.CHART])&&chartOnLoad.updateChartJson(t[ActionConstants.CHART])}),l.sendRequest()}}},Filter.filterColDataMouseDown=function(e){var t;return t=browser_ie?e.srcElement:e.target,stopEvt(e),!0},Filter.hasFilteredCols=function(){var e=Filter.getInstance();return e?e.appliedCols.length>0:!1},Filter.clear=function(){Filter.instances={}},Filter.getInstance=function(e){return e||(e=CURRSHEETNAME),"function"==typeof Filter.instances[e]?void 0:Filter.instances[e]},Filter.positionFilterIcons=function(e,t){for(var r=filterIconsPane.children,l=0;l<r.length;l++){var i=r[l];if(t){var s=i.getAttribute("row");s>=e&&(i.style.top=getRowTop(s)+"px",i.style.height=getRowHeight(s)+"px")}else{var o=i.getAttribute("col");o>=e&&(i.style.left=getColLeft(o)+"px",i.style.width=getColWidth(o)+"px")}}ISFREEZED&&Filter.replicateInAllPanes()},Filter.prototype={},Filter.prototype.addToAppliedCols=function(e){var t=this.appliedCols;-1===t.indexOf(e)&&t.push(e)},Filter.prototype.removeFromAppliedCols=function(e){var t=this.appliedCols,r=t.indexOf(e);-1!==r&&(this.appliedCols=t.slice(0,r).concat(t.slice(r+1,t.length)))},Filter.prototype.getColumnData=function(e){return Filter.instances[this.id].columns[e]},Filter.prototype.modfiyRange=function(){},Filter.prototype.buildIcons=function(){{var e=Filter.getHeader(),t=getObj("fIP"),r=this.appliedCols,l=this.range.sr,i=getRowTop(l),s=getRowHeight(l),o=Filter.getIconContainer(),a=this.range,n=a.sc;a.ec}browser_ie&&(t.style.zIndex=51+BASEZINDEX);for(var c=n,d=a.ec;d>=c;c++){var F=c-n,f=-1!==r.indexOf(c),u=o.cloneNode(!0);u.setAttribute("row",l),u.setAttribute("col",c),u.setAttribute("index",F),u.setAttribute("filter",!0),u.style.height=s+"px",u.style.width=getColWidth(c)+"px",isRTL?(u.style.right=getColLeft(c)+"px",u.style.left=""):(u.style.left=getColLeft(c)+"px",u.style.right=""),u.style.top=i+"px",t.appendChild(u);var I=u.childNodes[0];I.src=IMAGE_PATH+(f?e.filterAppliedImage:e.filterImage),I.setAttribute("col",c),I.setAttribute("index",F),I.onclick=Filter.showFilterOptions}return Filter.replicateInAllPanes(),this},Filter.prototype.reconstructIcons=function(){this.removeIcons().buildIcons()},Filter.prototype.removeIcons=function(){function e(e){for(var t=e.querySelectorAll("[filter]"),r=0;r<t.length;r++)e.removeChild(t[r])}return e(filterIconsPane),ISFREEZED&&(e(filterIconsPane1),e(filterIconsPane2),e(filterIconsPane3)),this},Filter.prototype.remove=function(){var e=Filter.getInstance().removeIcons().id;Filter.hasFilter=!1,delete Filter.instances[e];var t=getObj("tfr");t&&$(t).text("")},Filter.prototype.setRange=function(e){this.range=e},Filter.prototype.setAppliedCols=function(e){this.appliedCols=e},Filter.prototype.modify=function(e){this.appliedCols=e},Filter.prototype.isFilteredCol=function(e){var t=this.appliedCols;return-1!==t.indexOf(e)};var isFilterIconsReplicationPending=!1;Filter.replicateInAllPanes=function(e){if(e&&void 0===filterMetaInfo||ISFREEZED){var t=filterIconsPane.innerHTML,r=Filter.getInstance();if(r||Filter.isPivotFilter){isFilterIconsReplicationPending=!1;var l=filterIconsPane.children.length;filterIconsPane2.innerHTML=t,filterIconsPane1.innerHTML=t,filterIconsPane3.innerHTML=t;for(var i=filterIconsPane1.childNodes,s=filterIconsPane2.childNodes,o=filterIconsPane3.childNodes,a=0;l>a;a++){var n=i[a].childNodes[0],c=s[a].childNodes[0],d=o[a].childNodes[0];Filter.isPivotFilter?(PivotUtil.generateFilterDropDown(n),PivotUtil.generateFilterDropDown(c),PivotUtil.generateFilterDropDown(d)):(n.onmousedown=Filter.showFilterOptions,c.onmousedown=Filter.showFilterOptions,d.onmousedown=Filter.showFilterOptions,browser_ie&&(i[a].onmousedown=sheetMouseDown,s[a].onmousedown=sheetMouseDown,o[a].onmousedown=sheetMouseDown))}}else isFilterIconsReplicationPending=!0}},Filter.getIconContainer=function(){if(!Filter.iconContainerProto){var e=document.createElement("div");e.style.position="absolute",e.className="filterIconContainer";var t=document.createElement("img");t.style.position="absolute",t.style.cursor="pointer",isRTL?(t.style.left="1px",t.style.right=""):(t.style.right="1px",t.style.left=""),t.style.bottom="1px",t.style.maxWidth="100%",t.style.maxHeight="100%",t.style.zIndex=51+BASEZINDEX,e.appendChild(t),Filter.iconContainerProto=e}return Filter.iconContainerProto},Filter.isApplied=function(e){e||(e=CURRSHEETNAME);var t=Filter.getInstance(e);return t&&t.appliedCols.length>0},Filter.getIcon=function(e,t){var r=Filter.getInstance(),l=void 0;return r&&(t||filterIconsPane).querySelectorAll("[filter]")[e-r.range.sc]?(t||filterIconsPane).querySelectorAll("[filter]")[e-r.range.sc].childNodes[0]:l},Filter.updateIconStatus=function(e,t){var r=IMAGE_PATH+(t?Filter.header.filterAppliedImage:Filter.header.filterImage);Filter.getIcon(e).src=r,ISFREEZED&&(Filter.getIcon(e,filterIconsPane1).src=r,Filter.getIcon(e,filterIconsPane2).src=r,Filter.getIcon(e,filterIconsPane3).src=r)},Filter.renameFilterInstance=function(e,t){var r=Filter.getInstance(e);r&&(Filter.instances[t]=r,Filter.instances[t].id=t,delete Filter.instances[e])},Filter.isAcrossFilterHeader=function(e,t,r,l){var i=Filter.getInstance();if(i){var s=i.range,o=s.sc,a=s.ec,n=s.sr;if(n>e&&r>=n&&(t>=o&&a>=t||l>=o&&a>=l))return!0}return!1},Filter.reloadView=function(e,t){var r={},l=Filter.getInstance();if(l)if(ISFREEZED&&(r={reloadFrozenRows:!0,onBeforeReload:SHEET.FREEZE.reloadSheetPanes,onAfterReload:function(){SHEET.dom.freeze.setCues(FREEZED_ROW,FREEZED_COL)}}),r.passiveReload="true"===t,responseManager.isRequestPending()){var i={fn:setRowsHeightAndModifyDOM,params:[e,!0,r],condn:function(){return!responseManager.isRequestPending()}};actionManager.addEventListener("onResponse",i)}else setRowsHeightAndModifyDOM(e,!0,r)},Filter.readRowDetails=function(e,t,r){var l=new AjaxRequest,i=new RequestParameters(ActionConstants.FILTER_CALLBACK);e=WorkSheets.getSheetCodeFromName(e),i.setParameters(e,t,r),l.init("POST",i.getURL(),!0,i.getParametersAsString()),l.addEventListener("onComplete",function(e){var t=parseJSON(e.responseText);Filter.reloadView(t.rh)}),l.sendRequest()},Filter.updateFilterJson=function(e,t){if(filterMetaInfo=void 0,ActionConstants.READ_FILTER_RANGE===e.a)return void(e.hf?(Filter.remove(),Filter.create(e.sn,e.range,e.fc),_resettingRowHdrs(),Filter.enableDisableInsertIcon(Filter.hasFilter&&0!==Filter.getInstance().appliedCols.length?!1:!0)):(Filter.filterIconHandler(!1),Filter.hasFilter=!1));var r=e.rowsInfo,l=e.filterInfo,i=e.chartList,s=e.aa;if(s!==ActionConstants.CREATE_FILTER||e[ActionConstants.CREATE_FILTER]||Filter.filterIconHandler(!1),i&&Filter.regenerateAffectedCharts(i),l)var o=l.sn,a=l.range,n=l.fc;if(e[ActionConstants.REMOVE_FILTER]&&(r&&(r.rh?Filter.reloadView(r.rh):Filter.readRowDetails(o,r.sr,r.er)),Filter.remove(),activateCellField()),e[ActionConstants.CREATE_FILTER]&&(Filter.create(o,a),activateCellField(),t&&e.aa!==ActionConstants.FILTER_BY_VALUE&&scrollCellIntoView(a.sr,a.sc)),e[ActionConstants.APPLY_FILTER]){var c=e.outputInfo;if(c){var d=c.cfc,F=c.tvr,f=c.cf,u=getObj("cellStatus"),I=a.sc+d,p=Filter.getIcon(I);if(p){var x=Filter.getInstance();f?x&&(x.removeFromAppliedCols(I),Filter.enableDisableInsertIcon(!0)):x&&x.addToAppliedCols(I),Filter.updateIconStatus(I,!f)}if(u){var b="";F>=0&&(b=F+" "+jsMsg["Filter.of"]+" "+(a.er-a.sr)+" "+jsMsg["Filter.foundRecords"]),setStatusText(b),setTimeout(function(){$("#cellStatus").html("").hide()},5e3)}}}if(e[ActionConstants.UPDATE_FILTER_RANGE]){var x=Filter.getInstance();x&&(x.range=a)}if(e[ActionConstants.RECONSTRUCT_FILTER_ICON]){var x=Filter.getInstance();x&&(x.range=a,x.appliedCols=n,x.reconstructIcons())}r&&(r.rh?Filter.reloadView(r.rh):Filter.readRowDetails(o,r.sr,r.er))},Filter.hideFilterOptions=function(){$("#filterSearch").val("");var e=["autoFilterId","cellColorId","textColorId","clearFilter","filterOk","filterCancel","sort_asc","sort_desc","customFilterId"];hoverItem=-2,$("#"+e[selectedFilterTabIndex]).css("box-shadow",""),$($("#headers").find(".fselected")).css("box-shadow",""),selectedFilterTabIndex=0,"block"===getObj("customFilterIdContent").style.display&&(8===selectedFilterTabIndex&&$("#customFilterBack").css("box-shadow",""),$("#customFilterBack").trigger("mousedown")),Filter.resetTicks(!1,!0,!1);for(var t=["#autoFilterId","#cellColorId","#textColorId"],r=0;r<t.length;r++)$(t[r]).removeClass("selected bTc"),$(t[r]).children()[0].style.display="none";var l=getObj("filterColumnData");l&&(isFilterOptionsDIVOpened=!1,getObj("dataDiv").scrollTop=0,l.style.left="-100000px",l.style.top="-100000px",l.style.display="none",$("#ui-datepicker-div").hide()),$("#dataDiv").html(""),$("#cellColorDiv").html(""),$("#textcolorDiv").html("");var i=Filter.getInstance();void 0!==Filter.currCol&&i&&!i.isFilteredCol(Filter.currCol)&&Filter.getIcon(Filter.currCol)&&(Filter.getIcon(Filter.currCol).src=IMAGE_PATH+"filter_new.png"),Filter.resetAutoFilterOptions(),Filter.resetCustomFilter(),setFocusInCellField(),$("#sort_asc").removeClass("sSo"),$("#sort_desc").removeClass("sSo"),$("#sort_asc").removeAttr("title"),$("#sort_desc").removeAttr("title")};var hoverItem=-1,selectedFilterTabIndex=0;Filter.shortCutHandler=function(e){var t=["autoFilterId","select1","searchCont","clearFilter","filterOk","filterCancel","sort_asc","sort_desc","customFilterId"],r="autoFilterHeader"===currentHeader?"dataDiv":"cellColorHeader"===currentHeader?"cellColorDiv":"textColorDiv";switch(e.keyCode){case 9:hoverItem>-1&&$($("#"+r).children()[hoverItem]).removeClass("fhover"),hoverItem=-2,e.shiftKey?($("#"+t[selectedFilterTabIndex]).css("box-shadow",""),$("#customFilterBack").css("box-shadow",""),selectedFilterTabIndex--,selectedFilterTabIndex=-1===selectedFilterTabIndex?8:selectedFilterTabIndex,selectedFilterTabIndex%=9,4===selectedFilterTabIndex&&(selectedFilterTabIndex=$("#filterOk").is(":enabled")?4:3),3===selectedFilterTabIndex&&(selectedFilterTabIndex=$("#clearFilter").is(":enabled")?3:2),selectedFilterTabIndex="block"===getObj("customFilterIdContent").style.display&&2===selectedFilterTabIndex?$("#fVal2").focus():selectedFilterTabIndex,8===selectedFilterTabIndex&&("none"===getObj("customFilterIdContent").style.display?$($("#headers").find(".fselected")).css("box-shadow",""):$("#customFilterBack").css("box-shadow","0px 0px 2px 2px #addfff")),selectedFilterTabIndex>=0&&3>selectedFilterTabIndex?"autoFilterHeader"===currentHeader?2===selectedFilterTabIndex?($("#autoFilterId").trigger("click"),$("#autoFilterId").css("box-shadow",""),$("#select1").addClass("fhover"),hoverItem=-1):1===selectedFilterTabIndex?($("#select1").removeClass("fhover"),setTimeout(function(){$("#filterSearch").focus()},100),hoverItem=-2):0===selectedFilterTabIndex&&(hoverItem=-2,$("#select1").removeClass("fhover"),$("#autoFilterId").trigger("click"),$("#autoFilterId").css("box-shadow","0px 0px 2px 2px #addfff")):"cellColorHeader"===currentHeader?(2===selectedFilterTabIndex&&selectedFilterTabIndex--,1===selectedFilterTabIndex?(hoverItem=-1,$("#cellColorId").addClass("fselected"),$("#cellColorId").css("box-shadow",""),$("#select2").addClass("fhover")):0===selectedFilterTabIndex&&(hoverItem=-2,$("#select2").removeClass("fhover"),$("#cellColorId").trigger("click"),$("#cellColorId").css("box-shadow","0px 0px 2px 2px #addfff"))):"textColorHeader"===currentHeader&&(2===selectedFilterTabIndex&&selectedFilterTabIndex--,1===selectedFilterTabIndex?(hoverItem=-1,$("#textColorId").addClass("fselected"),$("#textColorId").css("box-shadow",""),$("#select3").addClass("fhover")):0===selectedFilterTabIndex&&(hoverItem=-2,$("#select3").removeClass("fhover"),$("#textColorId").trigger("click"),$("#textColorId").css("box-shadow","0px 0px 2px 2px #addfff"))):($("#"+t[selectedFilterTabIndex]).css("box-shadow","0px 0px 2px 2px #addfff"),e.stopPropagation())):($("#"+t[selectedFilterTabIndex]).css("box-shadow",""),$("#customFilterBack").css("box-shadow",""),selectedFilterTabIndex++,(6===selectedFilterTabIndex||7===selectedFilterTabIndex)&&Filter.isPivotFilter&&"disabled"===getObj("sort_desc").getAttribute("disabled")&&(selectedFilterTabIndex=1),8===selectedFilterTabIndex&&Filter.isPivotFilter&&(selectedFilterTabIndex=1),selectedFilterTabIndex%=9,selectedFilterTabIndex>=0&&3>selectedFilterTabIndex&&"none"===getObj("customFilterIdContent").style.display?"autoFilterHeader"===currentHeader?0===selectedFilterTabIndex?($("#autoFilterId").trigger("click"),$("#autoFilterId").css("box-shadow","0px 0px 2px 2px #addfff")):1===selectedFilterTabIndex?(hoverItem=-2,$("#autoFilterId").css(""),setTimeout(function(){$("#filterSearch").focus()},100)):2===selectedFilterTabIndex&&-2===hoverItem?($("#autoFilterId").css("box-shadow",""),$("#select1").addClass("fhover"),hoverItem=-1):$("#autoFilterId").removeClass("fselected"):"cellColorHeader"===currentHeader?0===selectedFilterTabIndex?($("#cellColorId").trigger("click"),$("#cellColorId").css("box-shadow","0px 0px 2px 2px #addfff")):(1===selectedFilterTabIndex||2===selectedFilterTabIndex)&&(hoverItem=-1,$("#select2").addClass("fhover"),$("#cellColorId").css("box-shadow",""),selectedFilterTabIndex++):"textColorHeader"===currentHeader&&(0===selectedFilterTabIndex?($("#textColorId").trigger("click"),$("#textColorId").css("box-shadow","0px 0px 2px 2px #addfff")):(1===selectedFilterTabIndex||2===selectedFilterTabIndex)&&(hoverItem=-1,$("#select3").addClass("fhover"),$("#textColorId").css("box-shadow",""),selectedFilterTabIndex++)):(selectedFilterTabIndex="block"===getObj("customFilterIdContent").style.display&&0===selectedFilterTabIndex?$("#fo1").zcombo("widget").focus():selectedFilterTabIndex,$($("#headers").find(".fselected")).css("box-shadow",""),Filter.isPivotFilter&&$("#select1").removeClass("fhover"),$("#select"+($($("#headers").find(".fselected")).index()+1)).removeClass("fhover"),3===selectedFilterTabIndex&&(selectedFilterTabIndex=$("#clearFilter").is(":enabled")?3:4),4===selectedFilterTabIndex&&(selectedFilterTabIndex=$("#filterOk").is(":enabled")?4:5),8===selectedFilterTabIndex&&"block"===getObj("customFilterIdContent").style.display?$("#customFilterBack").css("box-shadow","0px 0px 2px 2px #addfff"):$("#"+t[selectedFilterTabIndex]).css("box-shadow","0px 0px 2px 2px #addfff")));break;case 38:if(0>hoverItem||selectedFilterTabIndex>3)return;hoverItem--;var r="autoFilterHeader"===currentHeader?"dataDiv":"cellColorHeader"===currentHeader?"cellColorDiv":"textColorDiv";if(hoverItem>-1){var l=$($("#"+r).children()[hoverItem]).position().top;135>l&&$("#"+r).scrollTop($("#"+r).scrollTop()-23)}if(-1===hoverItem){var i="autoFilterHeader"===currentHeader?1:"cellColorHeader"===currentHeader?2:3;$("#select"+i).addClass("fhover"),$($("#"+r).children()[hoverItem+1]).removeClass("fhover")}else hoverItem>-2&&($($("#"+r).children()[hoverItem]).addClass("fhover"),$($("#"+r).children()[hoverItem+1]).removeClass("fhover"));break;case 40:if(3>selectedFilterTabIndex&&(0===selectedFilterTabIndex&&$($("#headers").find(".fselected")).css("box-shadow",""),-2===hoverItem))return hoverItem=-1,selectedFilterTabIndex=2,void $("#select"+($($("#headers").find(".fselected")).index()+1)).addClass("fhover");if(0===selectedFilterTabIndex)return;var r="autoFilterHeader"===currentHeader?"dataDiv":"cellColorHeader"===currentHeader?"cellColorDiv":"textColorDiv";if(hoverItem>$("#"+r).children().length-2||selectedFilterTabIndex>3)return;if(hoverItem++,0===hoverItem){var i="autoFilterHeader"===currentHeader?1:"cellColorHeader"===currentHeader?2:3;$("#select"+i).removeClass("fhover"),$($("#"+r).children()[hoverItem]).addClass("fhover")}else{var l=$($("#"+r).children()[hoverItem]).position().top;l>296&&$("#"+r).scrollTop($("#"+r).scrollTop()+23),$($("#"+r).children()[hoverItem]).addClass("fhover"),$($("#"+r).children()[hoverItem-1]).removeClass("fhover")}break;case 37:if(Filter.isPivotFilter)return;2>=selectedFilterTabIndex&&("cellColorHeader"===currentHeader?(selectedFilterTabIndex=0,$("#autoFilterId").trigger("click"),$("#autoFilterId").css("box-shadow","0px 0px 2px 2px #addfff"),$("#cellColorId").css("box-shadow",""),$("#select2").removeClass("fhover")):"textColorHeader"===currentHeader&&(selectedFilterTabIndex=0,$("#cellColorId").trigger("click"),$("#cellColorId").css("box-shadow","0px 0px 2px 2px #addfff"),$("#textColorId").css("box-shadow",""),$("#select3").removeClass("fhover")));break;case 39:if(Filter.isPivotFilter)return;2>=selectedFilterTabIndex&&("autoFilterHeader"===currentHeader?(selectedFilterTabIndex=0,$("#cellColorId").trigger("click"),$("#cellColorId").css("box-shadow","0px 0px 2px 2px #addfff"),$("#autoFilterId").css("box-shadow",""),$("#select1").removeClass("fhover")):"cellColorHeader"===currentHeader&&(selectedFilterTabIndex=0,$("#textColorId").trigger("click"),$("#textColorId").css("box-shadow","0px 0px 2px 2px #addfff"),$("#cellColorId").css("box-shadow",""),$("#select2").removeClass("fhover")));break;case 32:var s;if(selectedFilterTabIndex>=0&&3>=selectedFilterTabIndex){if(-2===hoverItem)return void(3===selectedFilterTabIndex&&"rgb(173, 223, 255) 0px 0px 2px 2px"===getObj("clearFilter").style.boxShadow&&(s=selectedFilterTabIndex,$($("#"+t[selectedFilterTabIndex])).trigger("mousedown"),$("#"+t[s]).removeClass("ui-state-active")));if(-1===hoverItem){var i="autoFilterHeader"===currentHeader?1:"cellColorHeader"===currentHeader?2:3;1===i?$("#select"+i).click():$("#select"+i).trigger("mousedown")}else{var r="autoFilterHeader"===currentHeader?"dataDiv":"cellColorHeader"===currentHeader?"cellColorDiv":"textColorDiv";Filter.selectItem($($("#"+r).children()[hoverItem])[0]),$($("#"+r).children()[hoverItem]).addClass("fhover")}}else 8===selectedFilterTabIndex?"none"===getObj("customFilterIdContent").style.display?($($("#"+t[selectedFilterTabIndex])).trigger("mousedown"),$("#customFilterBack").css("box-shadow","0px 0px 2px 2px #addfff")):($("#customFilterBack").css("box-shadow",""),$($("#customFilterBack")).trigger("mousedown"),selectedFilterTabIndex=0):(s=selectedFilterTabIndex,$($("#"+t[selectedFilterTabIndex])).trigger("mousedown"),$("#"+t[s]).removeClass("ui-state-active"));break;case 27:Filter.hideFilterOptions();break;case 13:if(8===selectedFilterTabIndex)$("#"+t[selectedFilterTabIndex]).css("box-shadow",""),"none"===getObj("customFilterIdContent").style.display?($($("#"+t[selectedFilterTabIndex])).trigger("mousedown"),$("#customFilterBack").css("box-shadow","0px 0px 2px 2px #addfff")):($("#customFilterBack").css("box-shadow",""),$($("#customFilterBack")).trigger("mousedown"),$("#customFilterId").css("box-shadow","0px 0px 2px 2px #addfff"),$($("#headers").find(".fselected")).removeClass("fselected"),selectedFilterTabIndex=8);else if(3>selectedFilterTabIndex){if(!$("#filterOk").is(":enabled"))return;Filter.applyCustomFilter()}else{var o=selectedFilterTabIndex;$($("#"+t[selectedFilterTabIndex])).trigger("mousedown"),$("#"+t[o]).removeClass("ui-state-active")}break;default:return}return!1},Filter.selectSetFocus=function(){},Filter.setFocus=function(){var e;setTimeout(function(){if(e=browser_safari?browser_chrome?document.activeElement.id:document.activeElement.classList.contains("ui-ztopband-background"):document.activeElement.id,e&&"fVal1"!==e){selectedFilterTabIndex=3;var t=["autoFilterId","cellColorId","textColorId","clearFilter","filterOk","filterCancel","sort_asc","sort_desc","customFilterId"];$("#cF").focus(),3===selectedFilterTabIndex&&(getObj("textColorId").className="",selectedFilterTabIndex=$("#clearFilter").is(":enabled")?3:4),4===selectedFilterTabIndex&&(selectedFilterTabIndex=$("#filterOk").is(":enabled")?4:5),$("#"+t[selectedFilterTabIndex]).css("box-shadow","0px 0px 2px 2px #addfff")}else"fVal1"===e?$("#fVal1").focus():$("#fo2").zcombo("widget").focus()},10)},appEvent.on("grid.shift",function(){Filter.hasFilter&&Filter.getInstance().reconstructIcons()}),appEvent.on("book.onaftersheetswitch",function(){Filter.enableDisableInsertIcon(Filter.hasFilter&&0!==Filter.getInstance().appliedCols.length?!1:!0)});
var lazyLoad=function(){function r(r,n,e){var t=document.createElement(r);return"link"===r?(t.href=n,t.rel="stylesheet",t.type="text/css"):t.src=n,e&&(t.async=!1),document.head.appendChild(t),t}function n(n){var t=function(){n.callback&&n.callback()};if(o||"string"==typeof n.src)if("string"==typeof n.src){var l=r("script",n.src,o);l.onload=l.onerror=t}else for(var s=0;s<n.src.length;s++){var l=r("script",n.src[s],o);s===n.src.length-1&&(l.onload=l.onerror=t)}else c.push(n.src.length),a++,e(n.src,c,n.callback,a)}function e(n,e,t,o){function s(){if(0!==e[o]){var f=n.shift();--c[o];var i=r("script",f);i.onload=function(){0===e[o]&&(l++,l===e.length&&(a=-1),t&&t()),s()}}}n.length;s()}function t(n){var e=function(){n.callback&&n.callback()};if("string"==typeof n.href){var t=r("link",n.href);t.onload=t.onerror=e}else for(var c=0;c<n.href.length;c++){var t=r("link",n.href[c]);c===n.href.length-1&&(t.onload=t.onerror=e)}}var c=[],a=-1,o=document.createElement("script").async,l=0;return{JS:n,CSS:t}}();
var copyDocument=!1,saveToMyAccount=function(){function e(){var e=jsMsg.ConfirmationMessage1,E="",n="",t=!0,o=!1,a=!1;REMOTE.MODE===REMOTE.SCRATCHVIEW&&(n=jsMsg.ConfirmationMessage3),READ_WRITE&&TEMP_CONTAINER_IDENTITY&&null!==TEMP_CONTAINER_IDENTITY&&(a=!0,E=jsMsg.ConfirmationMessage2),ConfirmBox.setInfoMsg(e,E,n,o,t,a),ConfirmBox.showDialog(jsMsg.SaveToMyAccount,s,jsMsg.OK,jsMsg.Cancel),n&&$("#sName").val(jsMsg.Untitled).select()}function s(){var e=getViewType(),s=!1;if("PUBLIC_VIEW"===e||"REMOTE_VIEW"==e||"THROWAWAY_VIEW"==e){var n=getObj("chkBox")?getObj("chkBox").checked:!1;n||(TEMP_CONTAINER_IDENTITY=RESOURCE_ID),REMOTE.MODE===REMOTE.EXCELVIEW&&(s=!0,""===DOCUMENT_NAME&&(DOC_NAME=jsMsg.Untitled)),REMOTE.MODE===REMOTE.SCRATCHVIEW&&(s=!0,DOC_NAME=getObj("sName").value),copyDocument=!0}else TEMP_CONTAINER_IDENTITY=RESOURCE_ID;-1==zuid?showSignupDialog():(message(jsMsg.Loading,"block","..."),E(null,s,n,DOC_NAME)),sheetdialog.close()}function E(e,s,E,n){var t=new RequestParameters(ActionConstants.SAVE_TO_MYACCOUNT),o=new AjaxRequest;t.setParameters(E,s,encodeURIComponent(n)),o.init("POST",t.getURL(),!0,t.getParametersAsString()),o.addEventListener("onComplete",function(e){if(e.responseText){var s=parseJSON(e.responseText);s.di&&loadDocument(s.di)}}),o.sendRequest()}return{getDetails:e,saveToMyAccount:s}}();
!function(t){t.widget("ui.zdialog",{_COMPONENTEVENTS:{ztab:"tabchange",zflipswitch:"flipswitchchange",zautosuggest:"zautosuggestchange",ztoggle:"togglechange",zspinner:"spinnerchange",zhiddennumericalslider:"hiddensliderchange",slider:"sliderchange",zcolorpallete:"colorpalletechange",zcombo:"combochange",zstatebutton:"statechange",zspinnerslider:"spinnersliderchange",zmenu:"menuitemclicked",zcolorfield:"colorfieldcolorselected"},widgetEventPrefix:"zdialog",_EVENTS:{ONMINIMIZE:"minimize",ONMAXIMIZE:"maximize",ONAFTERSHOW:"aftershow",ONBEFORECLOSE:"beforeclose"},options:{minimizable:!1,static:!1,modal:!1,draggable:!0,closeAction:!0,closeButton:!0,keys:{"close.label":"Close","minimize.label":"Minimize","maximize.label":"Maximize"},minimizeOffset:{bottom:"0px",right:"0px"}},dialogComponents:void 0,_create:function(){t.ui.dialog.overlay&&!t.ui.dialog.overlay.instances.length&&t.ui.dialog.overlay.instances.push(t("<div>")),this.openDialog(this.options)},setAssociatedObj:function(t){this.options.associatedObj=this._associatedObj=t,this.element.data("associatedObj",t)},_fixButtons:function(){var i=this.options.buttons,e=this;i&&t.each(i,function(i,n){if("function"!=t.type(n.click)&&n.click)if("CLOSE"==n.click)n.click=function(){e.close.call(e)};else{var o=t.ui.utils.getAsFunction(n.click);n.click=o.callable}})},_fixButtonProps:function(){var i=this.options.buttons;i&&t(this._dialogBase).find("[leftbutton=true]").addClass("ui-dialog-leftbtn")},openDialog:function(i){this._associatedObj=i.associatedObj;var e=t(this.element);if(this._fixButtons(),this._dialogPosition=i.position,i.target&&(i.target=t(i.target),!i.position)){var n=i.target.offset();this._dialogPosition=[n.left,n.top+i.target.height()]}var o=this,a=function(){if(o._dialogBase=o.element.parent(),o._addExtraButtons(),o._associatedObj&&t.isFunction(o._associatedObj.beforeInit)&&o._associatedObj.beforeInit(e),t(document).one("componentinitialized",function(){o.dialogComponents=t("[ctype]",t(o.element).children(":first")),o._fillValues(e,i.associatedObj,!0)}),t.ui.utils.initComponents(e),e.dialog("option","position",o._dialogPosition?o._dialogPosition:"center"),o._fixButtonProps(),o.element.data("focussed",o._focusButton()),!o.options.closeAction||!o.options.closeButton){var n=o._dialogBase.find(".ui-dialog-titlebar-close");n.hide()}o.element.find(".ui-tabs-horizontal").length&&o._dialogBase.addClass("ui-dialog-tab-horizontal")},s=t.extend({beforeClose:function(){return o._triggerEvent(o._EVENTS.ONBEFORECLOSE),t.ZContextMenu&&(t.ZContextMenu.hideMenu(),t.ZContextMenu.displayColorPalette(void 0,{},!1)),o.options.closeAction?o.options.hideOnClose?(o._checkAndDestroy(!0),!1):void 0:!1},close:function(){o._checkAndDestroy(!0)},position:o._dialogPosition,zIndex:t.ui.dialog.zIndex?t.ui.dialog.zIndex:1e4,open:a,autoOpen:!1,dragStart:function(){t.ZContextMenu&&t.ZContextMenu.hideMenu()}},i);parseInt(s.width)>0&&(s.width=parseInt(s.width)+10),e.dialog(s),e.data("associatedObj",i.associatedObj),this._addStatusDiv(),i.buttons&&this._checkAndInitLoaderBtn(i.buttons)},_checkAndInitLoaderBtn:function(){var i=this.element.parent().find(".ui-dialog-buttonset"),e=i.find("button[btype=loader]"),n=this;e.on("click",function(i){var e=t(i.target).closest(".ui-button");n.disableButton(e.attr("id"))})},disableButton:function(t){var i=this.element.parent().find(".ui-dialog-buttonset").find("#"+t);"loader"==i.attr("btype")?i.addClass("ui-status-icon ui-state-progress").button({icons:{secondary:"ui-components-icon ui-icon-loader"}}).button("disable"):i.button("enable")},enableButton:function(t){var i=this.element.parent().find(".ui-dialog-buttonset").find("#"+t);"loader"==i.attr("btype")?i.button({icons:{secondary:""}}).button("enable"):i.button("enable")},changeButtonLabel:function(t,i){var e=this.element.parent().find(".ui-dialog-buttonset").find("#"+t);e.button("option","label",i)},changeButtonIcon:function(t,i){var e=this.element.parent().find(".ui-dialog-buttonset").find("#"+t);e.button("option","icons",i)},_addStatusDiv:function(){var i=this.element.parent().find(".ui-dialog-buttonset");this._statusDiv=t("<div>").addClass("ui-widget-content ui-dialog-footer-status").css({display:"inline","margin-right":"5px"}).hide(),i&&i.prepend(this._statusDiv)},showStatus:function(t){t="object"==typeof t?t:{status:t};var i=this._statusDiv;i.html(t.status).show(),setTimeout(function(){i.hide()},t.duration?t.duration:3e3)},open:function(i){i&&(this.element.dialog("option","position",i),this._dialogPosition=i),this.isMinimized()?(this.maximize(),this.refreshValues()):this._hidden?(this._hidden=!1,this.element.dialog("moveToTop",!0),this._dialogBase.show(),this.getOverlay().show(),this.refreshValues()):this.element.dialog("open"),t(this.element).data("dialogOpened",!0),this._triggerEvent(this._EVENTS.ONAFTERSHOW),this._associatedObj&&t.isFunction(this._associatedObj.open)&&this._associatedObj.open(this.element)},_focusButton:function(){var i=this.element.find("input[tabindex], textarea[tabindex], button[tabindex]");if(i.length){var e=t(i.get(0)),n=e.prop("tabindex");i.each(function(i,o){t(o).prop("tabindex")<n&&(e=t(o),n=t(o).prop("tabindex"))})}else{var e=this._dialogBase.find(".ui-dialog-buttonset button:last:not(disabled)");e.length||(e=this._dialogBase.find(".ui-dialog-titlebar a:last"))}return this._setTabindex(),e.focus()},updateTabIndex:function(){this._setTabindex()},_setTabindex:function(){var i=this,e=i._dialogBase.find("button, input, select, textarea, .ui-zcombo");e.last().on("keydown."+this.widgetName,function(t){9==t.keyCode&&(e.get(0).focus(),t.preventDefault())}),e.on("keydown."+this.widgetName,function(e){if(9===e.which){var n=e.shiftKey?-1:1;i._getNextTabElement(t(this),n),e.preventDefault()}})},_getNextTabElement:function(i,e){var n=this._dialogBase.find("button, input:not(.ui-zcombo-editable), select, textarea, .ui-zcombo").filter(":visible").filter(function(){return t(this).attr("disabled")?!1:!0}),o=t(n.toArray()),a=n.filter(function(){return t(this).attr("tabindex")>0?!0:!1});if(a.length){var s=n.filter(function(){return t(this).attr("tabindex")<1?!0:!1});o=t(a.toArray().concat(s.toArray()))}var l=o.eq((o.index(i)+e)%o.length);l.hasClass("ui-zcombo")&&(l.focus(),l.prev().zcombo("setFocus",!0)),l.focus()},_addExtraButtons:function(){var t=this._titlebar=this.element.closest(".ui-dialog").find(".ui-dialog-titlebar"),i=t.find(".ui-dialog-titlebar-close");i.attr("title",this._getString("close.label"));var e=this;this.options.minimizable&&(this._minimizeButton=this._createButton("ui-icon ui-components-icon ui-icon-minus",i,e._toggleMinimize).attr("title",this._getString("minimize.label")),t.on("dblclick."+this.widgetName,function(){e._toggleMinimize(e._minimizeButton)}))},isMinimized:function(){return this._dialogBase?this._dialogBase.is(".ui-dialog-minimized"):!1},minimize:function(){this._dialogBase.is(":not(.ui-dialog-minimized)")&&this._toggleMinimize(this._minimizeButton)},maximize:function(){this._dialogBase.is(".ui-dialog-minimized")&&this._toggleMinimize(this._minimizeButton)},_toggleMinimize:function(i){var e=!this.element.is(":visible"),n=e?"show":"hide";this.element[n](),this.element.next(".ui-dialog-buttonpane")[n](),t(i).removeClass("ui-state-hover");var o=t(i).find("span");o.toggleClass("ui-components-icon ui-icon-plus").toggleClass("ui-components-icon ui-icon-minus"),this._dialogBase.toggleClass("ui-dialog-minimized"),this.element.dialog("option","draggable",e?this.options.draggable:!1);var a=this.getOverlay();a&&this.options.minimizable&&a[n]();var s=this._getMinimizablePane(),l=this.options.minimizeOffset;l&&!e&&s.css(l),e?(t("body").append(this._dialogBase),i.attr("title",this._getString("minimize.label")).data("title",this._getString("minimize.label"))):(i.attr("title",this._getString("maximize.label")).data("title",this._getString("maximize.label")),s.append(this._dialogBase)),this._triggerEvent(this._EVENTS[e?"ONMAXIMIZE":"ONMINIMIZE"])},_getMinimizablePane:function(){var i="ui-zdialog-minimize-pane",e=t("."+i);return e.length||(e=t("<div>").addClass(i),t("body").append(e)),e},_createButton:function(i,e,n){var o=t("<a>").attr({role:"button",unselectable:"on",href:"#"}).addClass("ui-dialog-titlebar-close ui-dialog-titlebar-minimize ui-corner-all").hover(function(){o.addClass("ui-state-hover")},function(){o.removeClass("ui-state-hover")}).append(t("<span>").addClass(i)),a=this;return o.insertAfter(e),o.click(function(i){return n&&n.call(a,t(i.currentTarget)),!1}),o},_fillValues:function(i,e,n,o){if(e){e&&(t.isFunction(e.init)&&e.init(i),t.isFunction(e.beforeFillValues)&&e.beforeFillValues(i));var a=["zspinner","zspinnerslider"],s=o?o.find("[ctype]"):this.dialogComponents,l=this;s.each(function(i,o){o=t(o);var s=o.attr("ctype");if(!(e&&e.fillVisible&&o[s]("widget").is(":hidden"))&&o.metadata()&&o.metadata().appData){var d=o.metadata().appData,r=d.action;if(e.get){var u=e.get(r,o),c=t.inArray(s,a);-1!=c&&void 0===u&&(u=0),"zstatebutton"!=s&&void 0!==u||"zcombo"==s?"flipswitch"===s?o[s]("select",u):"zbutton"!==s&&o[s]("setValue",u):o.val()==u||"checkbox"==t(o).attr("type")&&1==u?o.attr("checked",!0):o.attr("checked",!1)}if(l._COMPONENTEVENTS[s]&&n){var h=t(o);h.on(l._COMPONENTEVENTS[s]+".zdialog",{obj:e},function(i,e){var n=e.value;"zmenu"==s?n=e.menuitem:"zstatebutton"==s&&(n=h.is(":checked")),e.isFromSetValue||i.data.obj.set&&i.data.obj.set(d,n,t(i.target),s)})}}}),l._nonZohoComponents=i.find("[data]:not([ctype])"),l._nonZohoComponents.each(function(i,o){o=t(o);try{if(o.metadata()&&o.metadata().appData){var a=o.metadata().appData,s=a.action;if(e){if(e.get){var l=e.get(s,o);"checkbox"==o.attr("type")&&o.attr("checked",l),o.is("input")||o.is("button")||o.is("select")||o.is("textarea")?o.val(l):o.text(l)}n&&(o.is("input[type=text]")||o.is("textarea")?o.on("blur.zdialog",function(){e.set&&e.set(a,o.val(),o)}):o.on("change.zdialog",function(){e.set&&e.set(a,o.val(),o)}))}}}catch(t){}}),e&&t.isFunction(e.afterFillValues)&&e.afterFillValues(i)}},refreshValues:function(i,e,n){if(e){var o=t(this.element),a=this,s=this.options;i&&t.isFunction(i.beforeInit)&&i.beforeInit(o),t(document).one("componentinitialized",function(){a.dialogComponents=t("[ctype]",t(a.element).children(":first")),a._fillValues(o,s.associatedObj,!0,n)}),t.ui.utils.initComponents(o),a.element.data("focussed",a._focusButton())}else this._fillValues(this.element,i=i?i:this._associatedObj,!1,n),this.element.data("focussed",this._focusButton())},_getValueOfElementWithAction:function(i,e){var n=t("[action="+i+"]:first",e),o=void 0;if(n.length){{n.attr("ctype")}o={element:n}}return o},destroy:function(){this._destroy()},_destroy:function(){if(t(this.element).data("dialogOpened")){t(this.element).data("dialogOpened",!1);var i=this.options.associatedObj;i&&i.destroy&&i.destroy(),this._titlebar.off("."+this.widgetName),this._buildOrDestroyDialogComponents(!1),t(this.element).dialog("destroy"),t.Widget.prototype.destroy.apply(this,arguments)}},_checkAndDestroy:function(){return t(this.element.data("focussed")).blur(),this.options.hideOnClose?(this._dialogBase.hide(),this.getOverlay().hide(),this._hidden=!0,!1):(this.destroy(),!0)},getOverlay:function(){var i=this.element.data().dialog;return t(i&&i.overlay?i.overlay.$el:void 0)},close:function(){this.element.dialog("close")},_buildOrDestroyDialogComponents:function(i){if(this.dialogComponents){this.dialogComponents.each(function(e,n){var o=t(n).attr("ctype");i||t(n).off(".zdialog");var a=t(this).metadata();t(n)[o](i?a.componentOptions?a.componentOptions:a:"destroy")}),this.dialogComponents=void 0}this._nonZohoComponents&&(this._nonZohoComponents.each(function(i,e){t(e).off(".zdialog")}),this._nonZohoComponents=void 0)},_getString:function(i){return t.i18n?t.i18n("zdialog",i):this.options.keys[i]},_triggerEvent:function(t){var i={dialog:this.element,isMinimized:this.isMinimized()};return this._trigger(t,t,i)}})}(jQuery);
function ZComponents(){}!function(t){t.dialogutil={dialogs:{},options:{},_lastStaticDialog:void 0,open:function(t,e,i,o,a){a||(a={});var n=!0;return"object"==typeof a.ajax&&(n="boolean"==typeof a.ajax.cache?a.ajax.cache:!0),i&&(i.target=e),this.dialogs[t]||(this.dialogs[t]={}),this.isDialogOpened(t)?!1:(this.dialogs[t].cacheStatus&&n?this._initDialog(t,e,i,o,a):this._fetchDialogContent(t,!1,e,i,o,a),this.isDialogOpen=!0,this.dialogDiv)},_checkAndCloseLastStaticDialog:function(t,e){t.staticDialog&&this._lastStaticDialog&&this._lastStaticDialog.zdialog("close"),this._lastStaticDialog=e},_initDialog:function(e,i,o,a,n){var s=this.dialogs[e];if(!s.widget){var l=t("<div>").prop("id",e+"zdialog").html(s.content),d=t(l).children("div:eq(0)").metadata();d=t.extend({name:e,target:i},d),a&&(d=t.extend({},d,a)),s.data=d,s.widget=l.zdialog(d),l.zdialog("setAssociatedObj",o)}var d=s.data;if(d.maintainPosition&&s.position&&(d.position=s.position),n.onLoad){var c=n.onLoad;c()}this._checkAndCloseLastStaticDialog(s.data,s.widget),s.widget.zdialog("open",d.position),a&&a.doNotOpen&&s.widget.zdialog("close"),this._changeRequestStatus(e,"close"),s.widget.one("dialogclose",function(){d.maintainPosition&&(s.position=s.widget.dialog("option","position")),!d.hideOnClose&&s.widget&&s.widget.length&&(s.widget.remove(),delete s.widget)})},_changeRequestStatus:function(t){this.dialogs[t].requestStatus=!1},_cacheDialog:function(t,e){var i=this.dialogs[t];i||(i={},this.dialogs[t]=i),this.dialogs[t].cacheStatus=!0,e.content&&(i.content=e.content),i.widget=e.widget},_getReplacedData:function(t){var e={},i=this.options.dataFormat;for(key in i)value=i[key],"TIME"==value?value=(new Date).getTime():"DIALOG_NAME"==value&&(value=t),e[key]=value;return e},_fetchDialogContent:function(e,i,o,a,n,s){if(this.dialogs[e].requestStatus)return!1;this.dialogs[e].requestStatus=!0;var l=this;s||(s={}),"boolean"!=typeof s.addDefaultData&&(s.addDefaultData=!0);var d="object"==typeof s.ajax?s.ajax:{},c="string"==typeof d.requestType?d.requestType:"GET",g="string"==typeof d.url?d.url:this.options.dialogFetchUrl,u=t.extend({},this._getReplacedData(e),d.data);s.addDefaultData||(u=d.data),t.ajax({type:c,url:g,data:u,error:function(){l._changeRequestStatus(e,"close")},success:function(t){var d=void 0;t&&l._cacheDialog(e,{content:t}),l.dialogs[e].cacheStatus=!0,i?(l._changeRequestStatus(e,"close"),i()):d=l._initDialog(e,o,a,n,s)}})},close:function(t){var e=this.dialogs[t];e&&e.widget&&e.widget.zdialog("close")},isDialogOpened:function(e){if(!e)return!!t(".ui-dialog:visible").length;var i=this.dialogs[e],o=!1;return i&&i.widget&&(o=i.widget.parent().is(":visible")),o},preLoadAllDialogs:function(){this._preloadDialog(0)},_preloadDialog:function(t){var e=this,i=this.options.dialogNames[t];i&&(this.dialogs[i]?e._preloadDialog(++t):(this.dialogs[i]={},this._fetchDialogContent(i,function(){setTimeout(function(){e._preloadDialog(++t)},300)})))},refreshValues:function(t,e,i,o){var a=this.dialogs[e];a&&a.widget&&a.widget.zdialog("refreshValues",t,i,o)},_getElementType:function(e){return t(e).is(".ui-button")?"button":void 0},_getButtonObject:function(e){return t(e).parent().hasClass("ui-buttonset")?t(e).parent().hasClass("ui-button-splitbutton")?t(e).parent().parent():t(e).parent():e},makeCenter:function(t){var e=this.dialogs[t];e&&e.widget&&e.widget.dialog("option","position","center")},configure:function(t){this.options=t,t.preload&&this.preLoadAllDialogs()}},ZComponents.showConfirmMessage=function(e){e=t.extend({},e,{type:"confirm"}),ZComponents.showMessageDialog(e)},ZComponents.showAlertMessage=function(e){e=t.extend({},e,{type:"alert"}),ZComponents.showMessageDialog(e)},ZComponents.showPromptMessage=function(e){e=t.extend({},e,{type:"prompt"}),ZComponents.showMessageDialog(e)},ZComponents.showMessageDialog=function(e){function i(i){e.onClose&&e.onClose(i),t("#ui-zdialog-"+e.type).remove()}function o(o){var a={isCancel:!0};o&&(a={isCancel:!1,value:"prompt"===e.type?t("#ui-zdialog-"+e.type+"-textbox").val():void 0}),i(a)}var a=t("#ui-zdialog-"+e.type);a&&a.length&&ZComponents.closeMessageDialog("#ui-zdialog-"+e.type);var n={position:["auto",window.innerHeight/3/3],title:e.title,modal:!0,closeButton:!1,resizable:!1,autoOpen:!0,draggable:!1},s=t("<div ctype='zdialog' id='ui-zdialog-"+e.type+"'></div>");void 0!==e.primary&&s.append("<span id='ui-primary-msg' class='ui-primary-msg'>"+e.primary+"</span>"),void 0!==e.secondary&&s.append((void 0!==e.primary?"<br>":"")+"<span id='ui-secondary-msg' class='ui-secondary-msg'>"+e.secondary+"</span>"),"prompt"===e.type?(s.append("<br><input id='ui-zdialog-"+e.type+"-textbox' type='text'/>"),e.commandType="ok-cancel"):"confirm"===e.type?e.commandType="ok-cancel":"alert"===e.type&&(e.commandType="default"),n.buttons=void 0!==e.buttons?e.buttons:ZComponents._getButtonPanelElements(e);var l=0;t.each(n.buttons,function(t,e){e.click=function(){o("true"===e.indicate,!0,e)},l+=e.text.length}),l>50&&(n.width="auto"),s.on("dialogclose",function(){i({isCancel:!0})}).on("dialogopen",function(){if(""===e.title||void 0===e.title?s.closest(".ui-dialog").find(".ui-dialog-titlebar").remove():e.titleClass&&s.closest(".ui-dialog-titlebar").find("span").addClass(e.titleClass),s.css("border-top-width","0px"),e.icon){var i=t("<span />").addClass("ui-zalert-icon "+e.icon);t("#ui-primary-msg, #ui-secondary-msg").addClass("ui-zdialog-msg"),""===e.title||void 0===e.title?s.prepend(i):s.prev(".ui-dialog-titlebar").prepend(i)}s.closest(".ui-dialog").addClass("ui-alert-dialog");var o=s.next().find("button");1===o.length?o.addClass("ui-zbutton-secondary"):2===o.length&&(t(o[0]).addClass("ui-zbutton-primary"),t(o[1]).addClass("ui-zbutton-secondary")),e.onOpen&&e.onOpen()}),s.zdialog(n)},ZComponents.closeMessageDialog=function(e){t("#"+e).zdialog("close").remove()},ZComponents._getButtonPanelElements=function(t){t.keys={ok:"OK",cancel:"Cancel",yes:"Yes",no:"No"};var e=[{id:"ui-zdialog-cancel",text:t.keys.cancel,indicate:"false"},{id:"ui-zdialog-ok",text:t.keys.ok,indicate:"true"},{id:"ui-zdialog-yes",text:t.keys.yes,indicate:"true"},{id:"ui-zdialog-no",text:t.keys.no,indicate:"false"}];return"yes-no-cancel"===t.commandType?e.splice(1,1):"ok-cancel"===t.commandType?e.splice(2,2):"yes-no"===t.commandType?e.splice(0,2):("default"===t.commandType||void 0===t.commandType)&&(e.splice(0,1),e.splice(1,2)),e}}(jQuery);
var sheetdialog=function(e){var t={},o=void 0,n=void 0,l=void 0,a=!0,r=!1,s=!0,u=!1,c=!0,d=!1,f=!1,h="#cF",g=function(i,n,l,a){var r={},s=n;if(o=i,a){var u=a,c="",d=a.indexOf("?");-1!==d&&(u=a.slice(0,d),c=a.slice(d+1,a.length)),r={ajax:{url:u,cache:!1,data:O(c),requestType:"POST"},addDefaultData:!1,onLoad:"function"==typeof s?s:void 0}}e.dialogutil.open(o,l,s,t,r)},m=function(){var e=Math.round(1e10*Math.random());return r=!0,e.toString()},v=function(i,n){o=m();var l=e("<div/>",{id:o});l.html(i).zdialog(t).zdialog("open"),e.ui.utils.initComponents(l),e.ZToolbarHandler.init(["#"+o]),n&&n()},b=function(i,t){var o=e("#sheetnotifydialog");o.css({"max-width":"500px","min-width":"300px"}),o.html(i).zdialog(t).zdialog("open"),o.parent().find(".ui-dialog-titlebar-close").hide(),e(o.parent().find("button")[0]).focus()},p=function(i){var n={autoOpen:!1,modal:!1,resizable:!1,close:function(t,n){i.close&&i.close(t,n),d=!1,z(),featurePermission.resetPermission(),mask.bottomBand(!1,!1),f&&(allowtowrite=!0,f=!1),r&&(e("#"+o).zdialog("close").remove(),r=!1)}};i&&Object.keys(i).forEach(function(e){"close"!=e&&(n[e]=i[e])}),t=n},O=function(e){var t={};if(e){var o=e.split("&");for(i=0;i<o.length;i++){var n=o[i].indexOf("="),l=o[i].substring(0,n),a=o[i].substring(n+1);t[l]=a}}return t},w=function(){REMOTE.MODE===REMOTE.SCRATCHVIEW&&e.ajaxSetup({headers:{"User-Locale":USER_LOCALE}}),e.dialogutil.configure({dialogNames:["findandreplacedialog","gotodialog","commentsdialog"],dialogFetchUrl:ctxpath+"openDialog.do",dataFormat:{DIALOG_NAME:"DIALOG_NAME"},preload:!0}),e.dialogutil.zIndex=1e4},D=function(e,i,t,o,n){exitFormatPainter(),a=void 0!==i.sheetswitch?i.sheetswitch:!0,u=void 0!=i.contextmenu?i.contextmenu:!1,s=void 0!=i.hidetoolbar?i.hidetoolbar:!0;var l=i.hidesheetTabMenu?i.hidesheetTabMenu:!0;if(y(!0),p(i),i.modal&&READ_WRITE&&(allowtowrite=!1,f=!0),featurePermission.setPermission({contextmenu:u,hidetoolbar:s,sheetswitch:a,allowToScroll:c,hidesheetTabMenu:l}),mask.bottomBand(!1,!0),h=document.activeElement,isCellEdited()&&!i.dontSubmit&&submitCell(),d=!0,"object"==typeof e){var r=e.html();v(r,t)}else-1!==e.indexOf("<")?v(e,t):g(e,t,o,n);setTimeout(function(){var e=k();e.length&&e.find("input").bind("focusout",function(){h=this})},1e3),setTimeout(function(){var e=k();e.length||(featurePermission.resetPermission(),f&&(allowtowrite=!0,f=!1))},3e3)},y=function(i){if(d||e.dialogutil.isDialogOpened(o)){if(i&&n)return;o&&(e.dialogutil.close(o),e("#"+o).zdialog("close"),e("#"+o)&&e("#"+o).remove())}dialogOpened&&closeDialog()},E=function(){e(sheetdialog.getOpenedDialog().children()[1]).dialog("option","closeOnEscape")&&y()},C=function(){(d||k())&&(n=k(),n.hide(),d=!1,l=o,o=void 0)},T=function(){n&&(n.show(),o=l,isNaN(o)||(r=!0),l=void 0,n=void 0,d=!0)},x=function(i,t){h=document.activeElement,ole.currObj&&(h=ole.currObj.el),e("#notifyDivCnt #notifyVal").html(i);var o=e("#notifyDivCnt").html(),n={width:"auto",title:jsMsg["Service.ZohoOffice"],modal:!0,resizable:!1,close:function(){z()},buttons:[{text:jsMsg.OK,class:"ui-zbutton-primary",click:function(){j()},keypress:function(e){var i=browser_ie?window.event.keyCode:e.which;13===i&&e.preventDefault()},keyup:function(e){var i=browser_ie?window.event.keyCode:e.which;13===i&&j(t)}}]};setTimeout(function(){b(o,n)},200)},M=function(i,t){h=document.activeElement,ole.currObj&&(h=ole.currObj.el),e("#notifyDivCnt #notifyVal").html(i);var o=e("#notifyDivCnt").html(),n={width:"auto",resizable:!1,title:jsMsg["Service.ZohoOffice"],modal:!0,close:function(){j()}};n.buttons=t.buttons,setTimeout(function(){b(o,n)},200)},j=function(){e("#sheetnotifydialog").zdialog("destroy"),z()},z=function(){t.dontSubmit||(hideCellField(),exprField.value=getCellContent()),setTimeout(function(){var e=h.id;OLE[e]?ole(e)._setSelectLayer().positionActionBar():t.dontSubmit&&h.focus()},200)},S=function(){return o},A=function(){return t.title},k=function(){return e(".ui-dialog").filter(":visible")},L=function(){return d};return w(),{open:D,close:y,escClose:E,getDialogName:S,getTitle:A,getOpenedDialog:k,hideDialog:C,recallDialog:T,isDialogOpen:L,showAlertDialog:x,showConfirmDialog:M,closeNotify:j}}(jQuery);
!function(){var e=$.debounce(300,function(t){t=JSON.parse(t);for(var o=0;o<t.length;o++){var n=t[o];if(-1===n.sr||-1===n.er){var r=new XMLHttpRequest,a={rowsInPage:Row.getAvailableRows().toString(),startEnd:getAvailableStartRow()+":"+getAvailableEndRow(),tiles:sheetTable.childNodes.length,isFreezed:ISFREEZED,isRespondedInScroll:isRespondedInScroll,rid:RESOURCE_ID};r.open("post","/reporter.do",!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send($.param(a)),appEvent.off("viewport.update",e)}}});appEvent.on("viewport.update",e)}();
jQuery(function(e){function t(){var t=e("<div>").css({width:"100px",height:"100px",overflow:"scroll"}).appendTo("body"),o=t.width()-t[0].scrollWidth;t.remove(),e.ZContextMenu.scrollWidth=o}function o(e){return!e.fromDataBinding}function n(t,n){if(n||(n={}),!t.button||0==t.button){var i=s(t);if(!i.is("input[type=file]")){o(n)&&u(i);var r=p(t,"popup");return r&&(r=p(t,"toolbar"))?e.ZContextMenu.colorpaletteRegistered?p(t,"colorpalette"):void 0:r}}}function i(e,t){e.data=t,t&&t.target&&(e.target=t.target);var o={left:e.clientX,top:e.clientY};return p(e,"context",o,!0)}function r(e){return e.parent().is("button")?e.parent():e}function a(t,o){var n=!1;return e.each(t,function(e,t){return t==o[0]?(n=!0,!1):void 0}),n}function u(e,t,o){setTimeout(function(){l(e,t,o)},10)}function l(t,o,n){var i=o?!1:!0;o=o?o:{};var r="data-association",l="["+r+"]";if(t=t.is(l)?t:e(t.parents(l).get(0)),!(!t.length||o&&void 0==o.disabled&&t.is(":disabled"))){if(n){if(a(n,t))return}else n=[];n.push(t[0]);var s=t.attr(r),c=e(s);c.each(function(r,l){if(l!=t[0]&&!a(n,e(l))){l=e(l);var s={fromDataBinding:!0};if("undefined"!=typeof o.visible)if(l.is("input, button")&&l.button("widget").hasClass("ui-button"))l=l.parent().hasClass("ui-button-splitbutton")?l.parent():l.button("widget"),l[o.visible?"show":"hide"]();else{var c=l.closest(".ui-zmenu");c.length?c.zmenu((o.visible?"show":"hide")+"MenuItem","#"+l.attr("id")):l[o.visible?"show":"hide"]()}if("undefined"!=typeof o.disabled)if(l.is("input, button")&&l.button("widget").hasClass("ui-button"))l.button(o.disabled?"disable":"enable");else{var c=l.closest(".ui-zmenu");c.length?c.zmenu((o.disabled?"disable":"enable")+"MenuItems","#"+l.attr("id")):l[o.disabled?"disable":"enable"](!1,!0,s)}if("undefined"!=typeof o.checked){if(t.is("[checked]")||t.is("input[type=checkbox]")||t.is("input[type=radio]")){var d=t.is(":checked");if(l.is(".ui-zmenu-item")){l.data("checked",d);var c=l.closest(".ui-zmenu");c.zmenu("check",l,d)}else l.attr("checked",d)}l.is("input, button")&&(l.data("ui-zbuttonset")?l.buttonset("refresh"):l.data("ui-zbutton")&&l.button("refresh"))}i&&l.trigger("click",s),u(l,o,n)}})}}function s(t){var o=t.data&&t.data.target?t.data.target:t.srcElement;if(o){var n=o.correspondingElement;n&&(o=e(n))}else o=e(t.target);return e(o)}function c(e){e.stopPropagation(),e.preventDefault()}function d(e){return e.is("input,button,textarea,select")?e.is(":disabled"):e.hasClass("ui-state-disabled")}function p(t,o,n,i){var a=s(t);if(a.closest(".ui-zmenu").length)return t.stopPropagation(),t.preventDefault(),!1;var u=e.ZContextMenu.currentMenu;if(!e.ZContextMenu.hideMenu(t))return!1;e.ZContextMenu.colorpaletteRegistered&&"colorpalette"!=o&&e.ZContextMenu.colorpalette.zcolorpalette("hide"),a=r(e(a));var l=f(a,o),p=l.attr;if(a=l.element,d(a))return!0;if(p){var M=e("#"+p);if("toolbar"==o&&!M.length){var v=e(a.parent().metadata().relatedTabPane);v.hasClass("ui-ztoolbar-panel")&&(M=v.ztoolbar("getToolbarAsMenu"),M.attr("relativeto","parent"),e(a).attr("popup",e(a).attr("toolbar")).removeAttr("toolbar"))}if(u&&u[0]==M[0]&&this._lastVisitedMenu[0]===a[0]&&M.metadata().toggle&&!i)return c(t),!1;this._lastVisitedMenu=a;var C=!0,g=d(e(l.element));if("colorpalette"!=o||g)g||(C=e.ZContextMenu.showMenu(M,a,n,t,i));else{var x=e(l.element).hasClass("ui-zcolorchooser")?e(l.element).prev():e(l.element),a=e(l.element),m=x.metadata().colorpaletteOptions?x.metadata().colorpaletteOptions:{},Z=e.data(a[0],"selectedColor");Z=Z&&"transparent"!=Z?Z:!1;var b=e.ZContextMenu.colorpalette;m.relativeto?e(b).attr("relativeto",m.relativeto):e(b).removeAttr("relativeto");var w=h(b,a);options=e.extend({},m,{relativeToEle:w,selectedColor:Z}),e.ZContextMenu.displayColorPalette(a,options,!0)}return C&&c(t),!C}return!0}function f(t,o){var n="["+o+"]";return t=t.is(n)?t:e(t.parents(n).get(0)),{element:t,attr:t.attr(o)}}function h(e,t){var o=e.attr("relativeto");if(o){for(var n=o.split("."),i=t,r=0;r<n.length;r++){try{var a=i[n[r]]();if(!a||!a.length)break}catch(e){break}i=a}i&&(t=i)}return t}function M(t,o,n,i){var r=t.attr("position");o=h(t,o);var a=o.offset(),u=o.outerHeight(),l=o.outerWidth(),s=t.outerHeight(),c=t.outerWidth();switch(r||(r="after_start"),r){case"after_start":a.top+=u,e.ui.directionIsRTL&&(a.left+=l,a.left-=c);break;case"after_end":a.top+=u,a.left+=l;break;case"before_start":a.top-=s;break;case"before_end":a.top-=s,a.left+=l;break;case"start_before":a.left-=c;break;case"start_after":a.left-=c,a.top+=u;break;case"end_before":a.left+=l;break;case"end_after":a.left+=l,a.top+=u;break;case"end_after_end":a.top+=u,a.left=a.left+l-c;break;case"overlap":break;case"after_pointer":a={left:n.clientX,top:n.clientY};break;case"adjustable":var d=a.top+u;e.ui.directionIsRTL&&(a.left+=l,a.left-=c);var p=d+s-e.ZContextMenu.windowHeight;if(p>0){var f=a.top-s;f=f>0?f:0,f>=e(window).scrollTop()&&(d=f)}a.top=d}var M=e.ZContextMenu.windowWidth;if(i&&i.length){var v=i.css("position");if(/^(absolute|relative)$/.test(v)){M=i[0].scrollWidth;var C=i.offset();a.left=a.left-(C.left+parseInt(i.css("borderRightWidth")))+i.scrollLeft(),a.top=a.top-(C.top+parseInt(i.css("borderTopWidth")))+i.scrollTop()}}return a.left+c>=M&&(a.left=a.left-(a.left+c-M+2)),a}var v="zcontextmenu";_lastVisited=void 0,_lastVisitedMenu=void 0,e.ZContextMenu=function(o){bindEvents(e(o)),t()},e.ZContextMenu.clearTimout=function(){clearTimeout(e.ZContextMenu.ctimeout),e.ZContextMenu.ctimeout=void 0},e.ZContextMenu.hidingMenu=!0,bindEvents=function(t){t.on("click."+v,function(t,o){e.ZContextMenu.hidingMenu=!0,setTarget(t),e.ZContextMenu.clearTimout(),n(t,o)}),t.on("mousedown."+v,function(t){e.ZContextMenu.isColorpaletteShowing=!1,setTarget(t);var o=e(t.target);o.closest(".ui-zmenu, .ui-zmenu-scroll-top, .ui-zmenu-scroll-bottom").length||(e.ZContextMenu.ctimeout=setTimeout(function(){e.ZContextMenu.hideMenu()},100))}),t.on("contextmenu."+v,function(t,o){setTarget(t),e.ZContextMenu.clearTimout(),i(t,o)}),e(".ui-dialog").on("dialogdragstart."+v,function(e){n(e)}),e(document).on("element_state_changed",function(t,n){o(n)&&u(e(t.target),n)}),e(document).on("menuitemclicked",function(e,t){o(t)&&u(t.menuitem)}),e(document).on("tabselect",function(e,t){o(t)&&u(t.tab)})},setTarget=function(e){e.target.correspondingElement&&(e.target=e.target.correspondingElement)},e.ZContextMenu.getMenuPosition=function(e,t,o,n){return M(e,t,o,n)},e.ZContextMenu.highlightItem=function(e,t){if(!e.is(".ui-zcolorchooser")&&0!=e.metadata().highlightOnMenuShow){var o=t?"removeClass":"addClass",n="ui-state-highlight",i="ui-state-open";e[o](n);var r=e.parent();r&&(r[o](i),r.is(".ui-button-splitbutton")&&r[o](n))}},e.ZContextMenu.showMenu=function(t,o,n,i,r,a){if(!t||!t.length)return!1;var u=void 0,l=t.metadata();l&&(u=l.componentOptions),r||t.one("menushow.zcontext",function(t,o){o.skipHighlightTarget||e.ZContextMenu.highlightItem(e(o.target))}),t.zmenu(u),n||(n=M(t,o,i));var s=n.left,c=n.top;return e.ZContextMenu.currentMenu=t,t.zmenu("show",{left:s,top:c,currentTarget:i.target,target:o,event:i,isRightClick:r},void 0,a),e.ZContextMenu._isMenuShowing=!0,e.ZContextMenu.hidingMenu=!1,t.one("menuhide.zcontext",function(t,o){var n=e(o.currentTarget).closest(".ui-button").length?e(o.currentTarget).closest(".ui-button"):e(o.target);e.ZContextMenu.highlightItem(n,!0),e.ZContextMenu.currentMenu=void 0,e.ZContextMenu._isMenuShowing=!1}),!0},e.ZContextMenu.hideMenu=function(t){return(e.ZContextMenu.currentMenu&&e.ZContextMenu._isMenuShowing||e.ZContextMenu.colorpalette&&e.ZContextMenu.colorpalette.is(":visible"))&&(e.ZContextMenu.currentMenu&&e.ZContextMenu.currentMenu.hasClass("ui-zmenu")?e.ZContextMenu.currentMenu.zmenu("hide"):e.ZContextMenu.isColorpaletteShowing=!0,e.ZContextMenu._isMenuShowing=!1,e.ZContextMenu.currentMenu=void 0,t&&e.ZContextMenu.consumeEventOnMenuHide)?(t.stopPropagation(),t.preventDefault(),!1):!0},e.ZContextMenu._tabDropdownClicked=void 0,e.ZContextMenu.currentMenu=void 0,e.ZContextMenu._colorpaletteHoveredMenuItem=void 0,e.ZContextMenu._isMenuShowing=!1,e.ZContextMenu.colorpalette=void 0,e.ZContextMenu.windowWidth=e(window).width(),e.ZContextMenu.windowHeight=e(window).height(),e.ZContextMenu.colorpaletteRegistered=!1,e.ZContextMenu.displayMenuComponents=function(t,o){e.ZContextMenu._colorpaletteHoveredMenuItem&&(e.ZContextMenu.displayColorPalette(void 0,void 0,!1),e.ZContextMenu._colorpaletteHoveredMenuItem=void 0);var n=o.menuitem.metadata();if(n.colorpalette){var i=e(o.menuitem),r=e(n.relatedButton);r=r.data("menuButton")?r.data("menuButton"):r,i.addClass("ui-state-hover");var a=n.colorpaletteOptions||r.metadata().colorpaletteOptions||{},u=e.data(e(r)[0],"selectedColor");u=u&&"transparent"!=u?u:!1;var l=e.ZContextMenu.colorpalette;a.relativeto?l.attr("relativeto",a.relativeto):l.removeAttr("relativeto"),options=e.extend({},a,{relativeToEle:r,selectedColor:u}),e.ZContextMenu.colorpalette.one("colorpaletteshow",function(){var t=e.ZContextMenu.adjustElementPosition({bufferWidth:i.width()+l.width(),bufferHeight:l.height()-i.outerHeight(),top:i.offset().top,left:i.offset().left+i.width(),width:l.width(),height:l.height()});e.ZContextMenu.colorpalette.addClass("ui-zcolorpalette-menu-popover"),e.ZContextMenu.colorpalette.css({top:t.top,left:t.left})}),e.ZContextMenu._colorpaletteHoveredMenuItem=i,e.ZContextMenu.colorpalette.one("mouseenter",function(){e.ZContextMenu._colorpaletteHoveredMenuItem&&e.ZContextMenu._colorpaletteHoveredMenuItem.addClass("ui-state-hover")}),i.one("mouseleave",function(){l.is(":visible")&&e.ZContextMenu._colorpaletteHoveredMenuItem&&e.ZContextMenu._colorpaletteHoveredMenuItem.addClass("ui-state-hover")}),l.zcolorpalette("show",r,options)}},e.ZContextMenu.adjustElementPosition=function(t){return e.ZContextMenu.windowWidth-(t.left+t.width+e.ZContextMenu.scrollWidth)<5&&(t.left=t.left-t.bufferWidth),e.ZContextMenu.windowHeight-(t.top+t.height+e.ZContextMenu.scrollWidth)<5&&(t.top=t.top-t.bufferHeight),t},e.ZContextMenu.registerColorpalette=function(t){e.ZContextMenu.colorpalette||(e.ZContextMenu.colorpalette=e("<div>"),e("body").append(e.ZContextMenu.colorpalette),e.ZContextMenu.colorpalette.zcolorpalette(t),e.ZContextMenu.colorpalette.on("colorpalettecolorselected",function(t,o){e(o.colorpicker).trigger("colorpalettecolorselected",o),e.data(e(o.colorpicker)[0],"selectedColor",o.color)}).on("colorpalettehover colorpalettemouseleave",function(t,o){e(o.colorpicker).trigger(t.type,o)}),e.ZContextMenu.colorpaletteRegistered=!0)},e.ZContextMenu.displayColorPalette=function(t,o,n,i){var r=e.ZContextMenu.colorpalette;r&&(setTimeout(function(){n?r.focus():r.focusout()},10),n?r.one("colorpalettebeforeshow",function(t,o){var n=e(o.colorpicker).trigger("colorpalettebeforeshow",o);return n===!1?!1:void 0}).one("colorpaletteshow",function(t,o){e(o.colorpicker).trigger("colorpaletteshow",o),e.ZContextMenu.highlightItem(e(o.colorpicker))}).one("colorpalettehide",function(t,o){e(o.colorpicker).trigger("colorpalettehide",o),e.ZContextMenu.highlightItem(e(o.colorpicker),!0)}):e.ZContextMenu._colorpaletteHoveredMenuItem&&e.ZContextMenu._colorpaletteHoveredMenuItem.removeClass("ui-state-hover"),e.ZContextMenu.isColorpaletteShowing&&this._lastVisited&&t&&this._lastVisited[0]===t[0]&&(n=!1),this._lastVisited=t,i?r.zcolorpalette(n?"openAdvancedColorPalette":"closeAdvancedColorPalette",t,o):r.zcolorpalette(n?"show":"hide",t,o))},e.fn.zcontextmenu=function(){e.ZContextMenu(this),e(window).on("resize."+v,e.debounce(500,function(){e.ZContextMenu.windowWidth=e(window).width(),e.ZContextMenu.windowHeight=e(window).height()})).on("resize.z"+v,function(){e.ZContextMenu.hideMenu()})},e(document).zcontextmenu()});
jQuery(function(t){function e(e,i){var a=e.data("menuButton");a&&a.button(i?"disable":"enable"),e=t(e);var u=void 0,r=void 0;if(e.is(".ui-zmenu-item")?(u=t(e.parents(".ui-zmenu").get(0)),r="zmenu"):(u=e.is("[ctype]")?e:t(e.parents("[ctype]").get(0)),r=u.attr("ctype")),!u.length)return!1;switch(r){case"ztoolbar":u[r](i?"disableButton":"enableButton",e.attr("id"));break;case"zmenu":u[r]("disableMenuItem",e.attr("id"),!i);break;case"button":case"zbutton":n(e,!i);break;default:return e.is("[ctype]")?(e[e.attr("ctype")](i?"disable":"enable"),!0):!1}return!0}function n(t,e){if(t.is(".ui-button")){if(t.button(e?"enable":"disable"),t.metadata().splitbutton){var n=t.next(".ui-splitbutton");n.length&&n.button(e?"enable":"disable")}return!0}return!1}function i(e){n(e)||t(e).is(":disabled")||(t(e).attr("disabled","true"),t(e).addClass("ui-state-disabled"),s[d]=t(e),d++)}function a(e,i){n(e,!0)||(i?u(e):t(e).removeAttr("disabled"),t(e).removeClass("ui-state-disabled"))}function u(){t(s).each(function(e,n){t(n).removeAttr("disabled")})}function r(t,e,n){n=n?n:{},n.element=t,n.disabled=e,t.trigger("element_state_changed",n)}var s=[],d=0,o=function(u,r,s,d){if(!e(u,r)){if(!s)return void(r?i(t(u)):a(t(u),!0,void 0,d));var o=t(u).find("[ctype]");t(o).each(function(e,i){i=t(i);var a=i.attr("ctype");"zbutton"==a&&(a="button"),n(i,!r)||i[a](r?"disable":"enable")}),o=t(u).find("select,div,button,input:not([ctype]):not(.ui-widget)"),t(o).each(function(e,n){n=t(n);var s=n.closest(".ui-widget");u.has(s[0]).length||(r?i(n):a(n,d))}),r?i(u):a(u)}};t.fn.disable=function(e,n,i){var a=t(this);o(a,!0,e),(void 0==n||n)&&r(a,!0,i)},t.fn.enable=function(e,n,i,a){var u=t(this);o(u,!1,e,a),(void 0==n||n)&&r(u,!1,i)}});
!function(n){var e={},r=function(r){n.isArray(r)&&(r=r[0]),e=r},t="key",i="module",u="service",f=function(n){var e=n.split(".",2),r={};if(2!=e.length)return r[t]=n,r;r[u]=e[0],r[i]=e[1];var f=e[0].length+e[1].length+1,o=n.indexOf(".",f);return r[t]=n.substring(o+1,n.length),r},o=function(n,r,t){var i=e[n],u="[noi18n] "+r;if(i){var f=i[r];f&&(u=g(f,t))}return u},g=function(n,e){if("undefined"!=typeof e&&e.length>0)for(var r=0;r<e.length;r++){var t=new RegExp("\\{"+r+"\\}","gi");n=n.replace(t,e[r])}return n},a=function(n,e){var r=f(n);return o(r[i],r[t],e)};n.i18n=function(){var n=arguments,e=n[0];return 1==n.length&&"object"==typeof e?r(e):n.length>=1?"string"==typeof n[1]?o(n[0],n[1],n[2]):a(e,n[1]):void 0}}(jQuery);
!function(e){var t={_create:function(){this.element.attr("tabindex","0").addClass("ui-focusable").css("outline","0")},getFocusElement:function(){return this.element},focus:function(){this.element.focus()},destroy:function(){this.element.unbind(this.widgetName).removeClass("ui-focusable").removeAttr("tabindex")}};e.widget("ui.focusable",t)}(jQuery);
!function(t){var e={_prevented:!1,_shortcutkeys:!0,_changeShortCut:!1,_isMac:!1,_spCharArr:{"<F1>":"112","<F2>":"113","<F3>":"114","<F4>":"115","<F5>":"116","<F6>":"117","<F7>":"118","<F8>":"119","<F9>":"120","<F10>":"121","<F11>":"122","<F12>":"123",PRINTSCREEN:"44",NUMLOCK:"144",PAUSE:"19",INSERT:"45",HOME:"36",PAGEUP:"33",PAGEDOWN:"34",DELETE:"46",END:"35",TAB:"9",CAPSLOCK:"20",WINDOWS:"91",ARROW_UP:"38",ARROW_DOWN:"40",ARROW_LEFT:"37",ARROW_RIGHT:"39",ENTER:"13",BACKSPACE:"8",SPACE:"32",ESCAPE:"27",DOT:"190",".":"190","Ã‚":"226",91:"219",92:"220",93:"221",61:"187",45:"189",96:"192",44:"188",47:"191",39:"222",59:"186",123:"219",124:"220",125:"221",43:"187",95:"189",126:"192",60:"188",62:"190",63:"191",34:"222",58:"186",33:"49",64:"50",35:"51",36:"52",37:"53",94:"54",38:"55",42:"56",40:"57",41:"48"},_create:function(){this.options=t.extend({},t.ui.shortcutkeys.defaults,this.options),this._isMac=this._isMacOS(),this._isWindows=this._isWindowsOS();var e=this;t(document).on("keydown",function(t){e._shortcutkeys&&e._keyDown(t)})},_keyDown:function(t){if(this._checkTargetElement(t)){var e=this._getShortCutObject(t);e.eventObj&&"keyup"!==e.eventObj.handleOn&&this._triggerShortCut(e.eventObj,t,e.shortcutkey)}},_keyUp:function(t){if(this._checkTargetElement(t)){var e=this._getShortCutObject(t);e.eventObj&&"keyup"===e.eventObj.handleOn&&this._triggerShortCut(e.eventObj,t,e.shortcutkey)}},_checkTargetElement:function(e){if(this.options.discardInputElements){var r=e.srcElement;if(r||(r=e.target),r=t(r),!r.hasClass("ui-focus-element")&&(r.is("input")||!r.data("shortcut")&&void 0!=r.data("shortcut")||r.is("textarea")))return!1}return!0},_getShortCutObject:function(e){var r="",i=e.keyCode;e.ctrlKey&&(r+="ctrl+"),this._isMac&&e.metaKey&&(r+="cmd+"),e.shiftKey&&(r+="shift+"),e.altKey&&(r+="alt+");var s=String.fromCharCode(i);i>=65&&90>=i&&(i=s.charCodeAt());var n=this,o=r;r+=i;var a=r,u=t.ui.shortcutkeys.keys[r];if(!u)for(var c in n._spCharArr){if(n._spCharArr[c]===i.toString()){var h=o+c.toLowerCase();a=h,u=t.ui.shortcutkeys.keys[h]}if(u)break}return{eventObj:u,shortCutKey:a}},_triggerShortCut:function(e,r,i){this._prevented=!0;var s=t(e.element);s&&!s.is(":disabled")&&(s.trigger(e.event,{ele:s,fromShortCut:!0,shortcutkey:i}),(s.is(".ui-button")||s.is("input, button"))&&s.button("refresh"),r.preventDefault(),r.stopPropagation())},_getShortCutKey:function(t,e){var r=void 0;for(var i in t)t[i]===e.toString()&&(r=i.toLowerCase());return r},_registerKey:function(e,r,i,s){var n=this._sortKeyCombination(r);n&&(t.ui.shortcutkeys.keys[n]={element:e,event:i,handleOn:s.handleOn})},_isMacOS:function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mac")},_isWindowsOS:function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("win")},_unregisterKey:function(e){var r=this._sortKeyCombination(e);r&&delete t.ui.shortcutkeys.keys[r]},_sortKeyCombination:function(e){var r=["ctrl","cmd","shift","alt"],s=e.split("+"),n="",e="";for(i=0;i<t(r).size();i++)for(j=0;j<s.length;j++)r[i]==s[j]?n+=s[j]+"+":-1==t.inArray(s[j],t(r))&&(e=s[j]),""==s[j]&&(e="+");return this._spCharArr[e.toUpperCase()]||(e=e.toUpperCase().charCodeAt(0)),n+=e},register:function(e){e=t(e);var r=e.metadata(),i=this._getKey(e,this._isMac),s={},n=r.shortcutkey&&r.shortcutkey.event?r.shortcutkey.event:"click",o=r.skipshortcutregister;if(s.handleOn=this._isWindows||"keyup"!==r.handleOn?r.handleOn:"keydown","keyup"!==s.handleOn||this._keyUpEvent||this._bindKeyUpEvent(),n=n?n:"click",i){var a=this;t.each(i,function(t,u){o||a._registerKey(e,u,n,s),r.skipShortcutFormat||(u=a._getDisplayKey(u),i[t]=u)})}return i?i:!1},_bindKeyUpEvent:function(){var e=this;this._keyUpEvent=!0,t(document).on("keyup.shortcutkeys",function(t){e._shortcutkeys&&e._keyUp(t)})},unregister:function(e){e=t(e);var r=this._getKey(e,this._isMac);r||(r=this._getKey(e));var i=this;t.each(r,function(t,e){i._unregisterKey(e)})},getShortcutKey:function(e){var r=this._getKey(e,this._isMac);if(r){var i=this;return t.each(r,function(t,e){r[t]=i._getDisplayKey(e)}),r}return!1},arrowSymbols:{Arrow_up:" &uarr;",Arrow_down:" &darr;",Arrow_left:" &larr;",Arrow_right:" &rarr;"},_getDisplayKey:function(e){var r=e.split("+"),i="";return t(r).each(function(t,e){e=e.charAt(0)==e.charAt(0).toUpperCase()?e.toUpperCase():e.charAt(0).toUpperCase()+e.substring(1,e.length),r.length-1!=t&&(e+="+"),i+=e}),i},_getKey:function(e,r){var i=e.metadata(),s=i.shortcutkey,n=this;if(s){var o="object"==typeof s&&t.isArray(s)?s:[s];return t.each(o,function(t,e){var s=e,a=i.skipShortcutFormat;return"object"!=typeof s||(e=r&&s.mac?s.mac:s.key,a=s.skipShortcutFormat,s.key||n._isMac)?(e&&!s.mac&&n._isMac&&(e=e.replace(/ctrl/i,a?"Cmd":"cmd")),a||(e=e.toString().toLowerCase()),void(o[t]=e)):!1}),o}},enable:function(){this._shortcutkeys=!0},disable:function(){this._shortcutkeys=!1}};e=t.extend({},t.ui.key,e),t.widget("ui.shortcutkeys",e),t.ui.shortcutkeys.keys={},t.ui.shortcutkeys.defaults={type:"click",discardInputElements:!0,keycode:!1},t.ui.shortcutkeys.getter=["register"],t.ui.shortcutkeys.register=function(e){return t(document).shortcutkeys("register",e)},jQuery(function(t){t(document).shortcutkeys()})}(jQuery);
!function(t){t.widget("ui.zbutton",{_dropDownIcon:"ui-components-icon ui-icon-triangle-1-s",_noIcon:"ui-zbutton-no-icon",_create:function(){this._make(this.element)},widgetEventPrefix:"button",_ctypeElems:".ui-zoom-panel,.ui-hiddenslider,.ui-zslider-panel,.ui-zstate,.ui-zspinner,.ui-ztoggle,.ui-zcombo,.ui-zcolorchooser",_EVENTS:{ONICON_CHANGE:"iconchange",ONLABEL_CHANGE:"labelchange"},options:{noIconScope:!1,iconScope:"",keys:{"validfilemessage.label":"Please select a valid file"}},_getLabel:function(e){var n=e.next("label");if(n.length)return n;n=void 0;var i=e.metadata().label;return i||(i=e.attr("label")),i&&(n=t("<label>").text(i).insertAfter(e),"file"!=e.attr("type")&&n.attr("for",e.attr("id"))),n},_make:function(e){if(e.is("input[type=file]"))return this._makeFileButton();e=e?e:this.element;var n=this._getData(e);if(e.is("input")&&this._getLabel(e),n.buttonset){if("bottom"!==this.options.labelPosition&&(e.parent().metadata().buttonset?e.parent().addClass("ui-buttonset-sep-main"):e.addClass("ui-buttonset-sep-main"),n.label)){var i=t("<button>").attr({disabled:"disabled",class:"ui-buttonset-label",data:'{"label": "'+n.label+'"}'}).text(n.label);"right"===this.options.labelPosition?i.insertAfter(e.children(":last")).addClass("ui-buttonset-label-left"):i.insertBefore(e.children(":first")).addClass("ui-buttonset-label-right")}this._initButtonSet(e)}else n.splitbutton&&!n.splitInited?(n.splitInited=!0,this._initSplitButton(n,e)):this._initButton(n,e)},_makeFileButton:function(t){t=t?t:this.element;var e=this._getLabel(t);t.data("widgetBase",e),e.button().css("overflow","hidden").attr("autocomplete","off"),e.append(t.addClass("ui-zbutton-file"));var n=this;t.on("change."+this.widgetName,function(i){var a=t.val();if(e.attr("title",a),void 0!==a&&""!==a&&t.metadata().extension){var o=n._checkExtension(t,a);if(!o){i.stopImmediatePropagation();var s=t.metadata().validFileMessage,u=s?s:n._getString("validfilemessage.label","zerror");alert(u)}}})},_checkExtension:function(e,n){var i=e.metadata().extension.split(","),a=n.lastIndexOf("."),o=n.substr(a+1).toLowerCase();return t.inArray(o,i)<0?!1:!0},_getString:function(e,n){return t.i18n?t.i18n(n?n:"zbutton",e):this.options.keys[e]},_initItems:function(e){var n=this;t(e).each(function(e,i){var a=t(i),o=a.metadata();o.buttonset?(o=t.extend({},o,{iconScope:n.options.iconScope,labelPosition:n.options.buttonsetLabelPosition}),a.zbutton(o)):(a.is("input")||a.is("button"))&&n._make(a)})},_initButton:function(e,n){if(n=n?n:this.element,t.ui.shortcutkeys){t.ui.shortcutkeys.register(n)}var i=void 0;n.is("[type=file]")&&(i=n),n.is("[popup]")&&(e||(e={}),e.splitButtonDropDown||e.splitbutton||0==e.popupIcon||(e.icons||(e.icons={}),e.icons.secondary=this._dropDownIcon)),n.button(e).attr("autocomplete","off"),e.noIconScope&&n.button("widget").find(".ui-icon").removeClass("ui-icon"),i&&i.css({position:"absolute",opacity:0}),n.is("button")&&n.on("mouseout."+this.widgetName,function(){n.removeClass("ui-state-focus")}),n.is("input")&&n.button("widget").addClass(n.attr("class")).removeClass("ui-helper-hidden-accessible"),n.is(":disabled")&&this._disable("#"+n.attr("id"))},_initButtonSet:function(e,n){n||e.on("change",function(){e.find("input").each(function(e,n){n=t(n);var i=n.data("menuButton");i&&!n.is(":checked")&&i.triggerHandler("mouseout")})}),buttonSet=e?e:this.element;var i=void 0;if(e.hasClass("ui-button-splitbutton")?i=t("input"+(n?"":", button")+":not([ctype], select)",buttonSet):(i=buttonSet.children(":not([ctype],"+this._ctypeElems+",select)"),buttonSet.addClass("ui-buttonset-container")),buttonSet.metadata().buttonset){t("input[type='radio']",buttonSet).length===i.length&&0!=i.length&&buttonSet.metadata().buttonset&&buttonSet.addClass("ui-zbutton-radioset");var a=buttonSet.parent();a.metadata().buttonset&&(a.metadata().mainButtonset=!0,buttonSet.metadata().innerButtonset=!0,buttonSet.addClass("ui-buttonset-inner"),buttonSet.next(":not(.ui-group-text)").length&&buttonSet.append(t("<span>").attr("class","ui-components-icon ui-buttonset-sep ui-icon-dot-separator")))}this._initItems(i),e.hasClass("ui-button-splitbutton")||e.buttonset();var o=e.find(".ui-button:first");o.prev(".ui-button").length||e.parent().metadata().buttonset?e.prev(".ui-buttonset").length||o.find(".ui-button-text").addClass("no-sep-bg"):o.find(".ui-button-text").addClass("no-sep-bg")},_initSplitButton:function(e,n,i){n=n?n:this.element;var a=t("<div>").addClass("ui-button-splitbutton ui-buttonset");n.metadata().id&&a.attr("id",n.metadata().id),a.insertBefore(n),a.css({display:"inline-block"});var o=n.attr("id"),s=o?o+"DropDown":void 0,u=void 0;n.is("input")?(u=n.next().next(),(!u.length||u.is(":not('button')"))&&(u=t("<button>").data("created",!0))):u=i||n.next().is(":not('button')")?t("<button>").data("created",!0):n.next(),u.addClass("ui-splitbutton"),u.text().length||u.text(this._getString("more.label","zcommon")),u.attr("id")||u.attr("id",s);var r=u.metadata();r.splitButtonDropDown=!0,r.text=!1,r.icons={primary:this._dropDownIcon},u.data("created")&&e&&e.appData&&(r.appData=e.appData);var d=void 0;n.is("input")&&(d=n.next()),a.append(n),d&&a.append(d),a.append(u),setTimeout(function(){u.removeAttr("title").data("title","")},1e3);var l=this._getData(n);if(l.splitButtonPopup&&u.attr("popup",l.splitButtonPopup),this._initButton(l,n),n.is(":disabled")&&u.attr("disabled",!0),this._initButton(r,u),e&&e.splitbuttonAttrs&&u.attr(e.splitbuttonAttrs),this._initButtonSet(a,!0),n.is("input")){var p="ui-state-active",c=n.button("widget");n.on("change",function(){u[c.hasClass(p)?"addClass":"removeClass"](p)}),n.button("widget").on("mousedown",function(){if(n.is("[type=radio]")){var e=t("input[type=radio][name="+n.attr("name")+"]:checked");e.button("widget").next(".ui-splitbutton").removeClass(p)}}),n.is(":checked")&&u.addClass(p),u.on("mouseout",function(){c.hasClass(p)&&u.addClass(p)})}return n.data("menuButton",u),a.hover(function(e){var n=t(e.target).closest(".ui-button");n.hasClass("ui-state-disabled")||a.addClass("ui-state-hover")},function(){a.removeClass("ui-state-hover")}),a.on("mousemove",function(e){var n=t(e.target).closest(".ui-button");n.hasClass("ui-state-disabled")&&a.removeClass("ui-state-hover")}),a},_getData:function(t,e){t=t?t:this.element;var n=t.metadata();return this.options.noIconScope||n.noIconScope||n.icons&&this.options.iconScope&&!e&&(n.icons.primary&&(n.icons.primary=this.options.iconScope+" "+n.icons.primary),n.icons.secondary&&(n.icons.secondary=this.options.iconScope+" "+n.icons.secondary)),n},_isButtonSet:function(t){return t.metadata().buttonset},expandButtonSet:function(e,n){var i=this.element;if(n){var a=t(i).children(":not(.ui-extended-buttonset,input)");a.each(function(e,n){t(n).show()});var o=i.data().popup;if(o){t(o).zmenu("destroy").remove(),i.data().popup=void 0;var s=i.data().popupButton;t("#"+s).zbutton("destroy"),t("#"+s).remove()}}else t(e).each(function(e,n){n.show();var a=n.is("button")?"shrinked_menuitem_"+n.attr("id"):"shrinked_menuitem_"+n.attr("for");if(i=n.parent(),n.hasClass("ui-button-splitbutton")){var o=n.children(".ui-splitbutton").attr("popup")?"group_":"";n=n.children(":first"),a=o+"shrinked_menuitem_"+n.attr("id"),n.is("input")&&(a=o+"shrinked_menuitem_"+n.next().attr("for"))}var s=t(i.data().popup);if(s&&(s.zmenu("removeMenuItem",a),0==s.zmenu("getItemCount"))){s.zmenu("destroy").remove(),i.data().popup=void 0;var u=i.data().popupButton;t("#"+u).zbutton("destroy"),t("#"+u).remove()}})},shrinkButtonSet:function(e){var n=this.element,i=this;if(n.metadata().mainButtonset){var a=n.data().popup;t(e).each(function(e,o){var s=t(o);if(!s.is(":hidden")){s.hide();var u=i.getAsObject(s,!0),r=s.parent();r.metadata().mainButtonset?(a=n.data().popup,a||i._createButtonsetMenu(n)):(a=r.data().popup,a||i._createButtonsetMenu(r)),a?a.zmenu("addMenuItem",u,0):(a=r.data().popup=t.ui.zmenu.createMenu(r.attr("id")+"Menu",t(u)),a.on("menuitemhovered",function(e,n){t.ZContextMenu.displayMenuComponents(e,n)}))}})}else{this._createButtonsetMenu(n);var a=n.data().popup;t(e).each(function(e,o){if(!o.is(":hidden")){o.hide();var s=i.getAsObject(o,!0);a?a.zmenu("addMenuItem",s,0):(a=n.data().popup=t.ui.zmenu.createMenu(t(o.parent()).attr("id")+"Menu",t(s)),a.on("menuitemhovered",function(e,n){t.ZContextMenu.displayMenuComponents(e,n)}))}})}},_createButtonsetMenu:function(e){if(e.metadata().buttonset&&!e.data().popup){var n=t(e).attr("id")+"Menu",i=t("<button class='ui-ztoolbar-splitmenu ui-extended-buttonset'>"+this._getString("moreoptions.label","zcommon")+"</button>");i.attr("data",'{"text": false, "icons":{"primary": "ui-icon ui-components-toolbar-icon ui-icon-zmore"}}'),i.zbutton(),i.attr({popup:n,id:n+"Button"}),i.css("width","16px"),i.insertAfter(e.children(":not(.ui-buttonset-sep)").last()),e.data().popupButton=n+"Button"}},shrinkButtonSetAsMenu:function(e){var e=e?e:this.element;if(!e.data().popup){var n=e.children(":visible:not(.ui-buttonset-sep,.ui-extended-buttonset,input)"),i=e.attr("id")+"Menu",a=e.children(":visible:first"),o=a.metadata(),s=o.label?o.label:this._getString("moreoptions.label","zcommon"),u=t("<button class='ui-ztoolbar-splitmenu ui-extended-buttonset'>"+s+"</button>");u.attr("data",'{"text": false, "icons":{"primary": "'+o.icons.primary+'", "secondary": "ui-components-icon ui-icon-triangle-1-s"}}'),u.zbutton(),u.attr({popup:i,id:i+"Button"}),u.insertAfter(e.children(":not(.ui-buttonset-sep)").last()),e.data().popupButton=i+"Button";var r=this,d=[];n.each(function(e,n){var i=t(n);i.is(":hidden")||(i.hide(),d[d.length]=r.getAsObject(i,!0))}),d.reverse(),e.data().popup=t.ui.zmenu.createMenu(i,d)}},getAsObject:function(e,n,i){e=e?e:this.element;var a=e,o=t(e).parent().hasClass("ui-buttonset")&&!t(e).parent().hasClass("ui-button-splitbutton"),s=e.metadata(),u={},r=void 0,d=void 0;if(o){if(e.hasClass("ui-button-splitbutton")&&(e=e.children(":first"),e.is("input")&&(e=e.next())),e.is("button")){if(r=t(e).attr("id"),r&&(u.id="menuitem_"+r,u.relatedButton="#"+r),u.mtype=e.attr("btype"),e.hasClass("ui-buttonset-label")&&(i?u.submenu="#"+e.parent().attr("id")+"menu":u.mtype="group"),e.parent().hasClass("ui-button-splitbutton")){var l=t(e).next(),p=l.attr("popup");p&&(u.submenu="#"+p,d="#"+l.attr("id"),u.mtype="splitmenu"),u.colorpalette=l.attr("colorpalette")}else{var p=t(e).attr("popup");p&&(u.submenu="#"+p),u.colorpalette=t(e).attr("colorpalette")}u["data-association"]="#"+r}else if(e.is("label"))if(r=e.attr("for"),u.id="menuitem_"+r,u["data-association"]="#"+r,u.label=e.text(),e=e.prev(),u.inputtype=t(e).attr("type"),t(e).is(":checked")&&(u.checked=t(e).is(":checked")),u.name=t(e).attr("name")+"zbutton",e.parent().hasClass("ui-button-splitbutton")){var l=t(e).next().next(),p=l.attr("popup");u.colorpalette=l.attr("colorpalette"),p&&(u.submenu="#"+p,d="#"+l.attr("id"),u.mtype="splitmenu")}else{var p=t(e).attr("popup");p&&(u.submenu="#"+p),u.colorpalette=t(e).attr("colorpalette"),u.relatedButton="#"+r}}else{var c=e.attr("id");if(r="menuitem_"+c,u.id=r,u.dataassociation="#"+r,e.parent().hasClass("ui-buttonset")){u.id="menuitem_"+t(e).attr("id"),s=e.metadata();var b=e.next(".ui-button").attr("popup");b&&(u.submenu="#"+b,d="#"+c,u.mtype="splitmenu")}else{var h=t(e).attr("popup");h&&(u.submenu="#"+h)}u["data-association"]="#"+c}var m=void 0;if(e.is("[data-association]")){var f=e.attr("data-association");u["data-association"]+=","+f,u.id&&(m=f+",#"+u.id)}else m="#"+u.id;m&&e.attr("data-association",m),!e.attr("disabled")&&!e.hasClass("ui-state-disabled")||e.hasClass("ui-buttonset-label")||i||(u.disabled=!0);var s=e.metadata();if(u.data=e.attr("data"),d&&(u.splitButtonData=d),u.icon=s.icons?s.icons.primary==this._noIcon?"ui-zmenu-no-icon":s.icons.primary:void 0,!u.label){var v=s.label;e.hasClass("ui-button")&&(u.label=v?v:e.text())}if(s.textIcon){u.iconText=u.label?u.label:e.text();var g=e.button("widget");u.label=g.attr("title"),u.icon=g.attr("class").split(" ")[0]}return u.shortcutkey=s.shortcutkey,u.skipshortcutregister=!1,u.baseButton=a,e.data("hidden")&&(u.hidden=!0),n&&(u.pos=0,u.id="shrinked_"+u.id),u},_destroySplitButton:function(e){var n=e?e:this.element,e=t("button",n).button("destroy");e.last(".ui-splitbutton").removeClass(".ui-splitbutton"),e.data("isInternal")&&e.remove(),t(n).buttonset("destroy")},_destroyFileButton:function(t){var e=t.data("widgetBase");t.insertBefore(e),t.data("widgetCreated")&&e.remove(),t.removeClass("ui-zbutton-file"),e.button("destroy"),t.off("."+this.widgetName)},destroy:function(){var e=this.element;e.is("input[type=file]")?this._destroyFileButton(e):e.is(".ui-buttonset")?e.buttonset("destroy"):e.metadata().splitbutton?this._destroySplitButton(e.parent()):e.button("destroy"),e.off("."+this.widgetName),t.Widget.prototype.destroy.apply(this,arguments)},check:function(t){this._check(!0,t)},uncheck:function(t){this._check(!1,t)},_check:function(e,n){var i=n?this.element.find(n):this.element;i.each(function(n,i){if(i=t(i),!i.is(":disabled")){if(i.hasClass("ui-buttonset"))return;i.prop("checked",e),i.metadata().splitbutton&&i.button("widget").next("button.ui-splitbutton")[e?"addClass":"removeClass"]("ui-state-active"),i.button("refresh"),i.trigger("element_state_changed",{checked:e})}})},_disable:function(e,n){var i=n?"enable":"disable",a=this.element.metadata(),o=a.splitbutton&&this.element.parent().hasClass("ui-buttonset")?this.element.parent():this.element;if(o.metadata().buttonset){var s=e?this.element.find(e):o.children("input, button, div");t.each(s,function(e,a){t(a).hasClass("ui-button-splitbutton")?t(a).find("input,button").button().attr("disabled",!n).button(i):t(a).attr("disabled",!n).button(i),t(a).trigger("element_state_changed",{disabled:!n,checked:t(a).is(":checked")})})}else o.attr("disabled",!n),o.data("ui-button")&&o.button(i),o.trigger("element_state_changed",{disabled:!n,checked:o.is(":checked")})},disable:function(t){this._disable(t)},enable:function(t){this._disable(t,!0)},_show:function(e,n){var i=n?"show":"hide",a=this.element.metadata(),o=a.splitbutton?this.element.parent(".ui-buttonset"):this.element;if(o.hasClass("ui-buttonset")){var s=e&&!a.splitbutton?this.element.find(e):o.children("input, button");t.each(s,function(e,a){t(a).button("widget")[i](),t(a).data("hidden",n?!1:!0),t(a).trigger("element_state_changed",{visible:n,disabled:t(a).attr("disabled"),checked:t(a).is(":checked")})})}else o.button("widget")[i](),o.data("hidden",n?!1:!0),o.trigger("element_state_changed",{visible:n,disabled:o.attr("disabled"),checked:o.is(":checked")})},show:function(t){this._show(t,!0)},hide:function(t){this._show(t,!1)},changeIcon:function(e,n){n&&(n=-1!=n.indexOf("#")?n:"#"+n);var i=n?this.element.find(n):this.element;i.data("fromButtonChange",!0);var a={};a.primary=i.button("option","icons").primary,a.secondary=i.button("option","icons").secondary,e&&(e.primary&&(a.primary=e.primary),e.secondary&&(a.secondary=e.secondary));var o=t(i.data("association")).data("fromMenuItemChange");t(a).length&&(i.button("option","icons",a),i.metadata().icons=a,o||this._triggerEvent(this._EVENTS.ONICON_CHANGE,{button:i,icons:a}))},changeLabel:function(e,n){n&&(n=-1!=n.indexOf("#")?n:"#"+n),ele=n?this.element.find(n):this.element;var i=t(ele.data("association")).data("fromMenuItemChange");e&&(ele.button("option","label",e),i||this._triggerEvent(this._EVENTS.ONLABEL_CHANGE,{button:ele,label:e}))},_triggerEvent:function(t,e){return this._trigger(t,t,e)}})}(jQuery);
!function(e){var t={_baseElement:void 0,_deltaWidth:23,_COMBO_SCOPES:{icon_text:"",icon_only:"ui-zcombo-icononly",text_only:"ui-zcombo-textonly",icon_only_floating:"ui-zcombo-icononly ui-zcombo-floating",text_only_floating:"ui-zcombo-textonly ui-zcombo-floating"},widgetEventPrefix:"combo",_EVENTS:{ONBEFORESHOW:"beforeshow",ONSHOW:"show",ONCHANGE:"change",ONOPTIONFOCUS:"onfocus",ONHIDE:"hide",ONCLICK:"click"},contentType:"text",_create:function(){if(this.options=e.extend({},e.ui.zcombo.defaults,this.options),this._buildCombo(),this._optionTextArray=[],this._onLoadCheck=!0,this._defaultIndex=this.element.get(0).selectedIndex,this._prevSearchKey="",this._prevSearchTimer=void 0,this._prevKeydownTime="","html"==this.options.contentType&&(this.options.editable=!1),this.options.defaultValue){var t=e("option[value='"+this.options.defaultValue+"']",this.element);t.length&&(this._defaultIndex=t.get(0).index)}this._defaultIndex=this._defaultIndex?this._defaultIndex:0;var o=this._buildDropDown();this._buildComboMenu(o),this._addEvents(),this.options.editable||this._optArea.addClass("ui-zcombo-readonly")},_addScopeForCombo:function(){var e=this.options.type;this._baseElement.addClass(this._COMBO_SCOPES[e])},_buildCombo:function(){var t="ui-zcombo "+this.element.attr("class")+(e.ui.directionIsRTL?" zmenu___rtl ":" ");this._baseElement=e("<div>").attr("class",t+(this.options.editable?"ui-zcombo-editable":""));var o=this.element.outerHeight();o&&this._baseElement.height(o),this._baseElement.width(this.element.outerWidth()+this._deltaWidth),this._baseElement.insertAfter(this.element.hide());var i=this;this._dropDownArrow=e("<div>").addClass("ui-zcombo-dropdown ui-state-default").hover(function(){i._dropDownArrow.addClass("ui-state-hover")},function(){i._dropDownArrow.removeClass("ui-state-hover")});var n=e("<div>").addClass("ui-icon ui-components-icon ui-icon-triangle-1-s");this._dropDownArrow.append(n),this._optArea=e("<div>").addClass("ui-zcombo-select-item").css({width:this._baseElement.outerWidth()-this._deltaWidth}),this._baseElement.append(this._dropDownArrow),this._baseElement.append(this._optArea),e(this._baseElement).focusable(),e(this._baseElement).on("focusin focus",function(){i._baseElement.hasClass("ui-state-disabled")||i._baseElement.addClass("ui-state-focus")}),e(this._baseElement).on("focusout",function(){i._baseElement.removeClass("ui-state-focus")}),this._addScopeForCombo(),e(this.element).is(":disabled")&&this.disable()},_buildDropDown:function(t,o){t=t?t:this.element;var i=this._onLoadCheck?":not(optgroup):eq("+this._defaultIndex+")":"",n=t[this._onLoadCheck?"find":"children"](i),s=[],r=this;return n.each(function(t,i){if("none"!=i.style.display){i=e(i);var n=i.attr("mtype"),a={};if("separator"==n)a.mtype="separator";else{var d=i.metadata();if(a=e.extend({},d),i.is("optgroup"))a.mtype=r.options.optgroupAsSplitMenu?"splitmenu":"group",a.label=i.attr("label"),a.id="optgroup"+i.attr("id"),a.menuItems=r._buildDropDown(i,o),a.attr={"data-isoptgroup":!0,"data-optgroupid":i.attr("id")};else{a.label=i.text();var l=Math.round(1e10*Math.random());i.attr("optionfor",l),a.attr={index:l},r._optionTextArray[r._optionTextArray.length]={text:i.dataDisabled?"":i.text(),value:i.val()},"icon_only"===r.options.type&&(a.title=i.text()),a.hidden=i[0].hidden,a.disabled=i[0].disabled}a._option=i}s[s.length]=a}}),s},_addOption:function(t,o,i){var n=this,s=[],t=t instanceof Array?t:[t];return o=o?o:n.element,e.each(t,function(t,r){var a={},d=Math.round(1e10*Math.random());targetElement=e("object"==typeof r.optionGroup?r.optionGroup:o),allItems=targetElement.children(),optionElement=e("object"==typeof r.options?'<optgroup label="'+r.label+'" data-readOnly="'+r.readOnly+'" id="'+r.id+'"></optgroup>':'<option value="'+r.value+'" data-readOnly="'+r.readOnly+'" optionfor="'+d+'" style="'+r.style+'" >'+r.label+"</option> "),insertAfter=!1,itemPosition=r.position<=0?0:r.position,itemPosition<allItems.length?(relativeOption=allItems.eq(itemPosition),optionElement.insertBefore(relativeOption)):optionElement.appendTo(targetElement),"separator"==r.mtype?a.mtype="separator":(a=e.extend({},optionElement.metadata()),a.pos=itemPosition,a.label=r.label,"object"==typeof r.options?(a.mtype=n.options.optgroupAsSplitMenu?"splitmenu":"group",a.menuItems=n._addOption(r.options,optionElement,r.id),a.attr={"data-isoptgroup":!0,"data-optgroupid":r.id},a.id="optgroup"+r.id):("object"==typeof r.optionGroup&&(i=i?i:r.optionGroup.attr("id"),a.menu=n.options.optgroupAsSplitMenu?e("#optgroup"+i).next().children("ul"):e("#optgroup"+i)),a.attr={index:d},n._optionTextArray[n._optionTextArray.length]={text:r.label,value:r.value},"icon_only"===n.options.type&&(a.title=r.label)),a._option=optionElement),s[s.length]=a}),s},addOption:function(e){var t=this._addOption(e,this.element);this._buildComboMenu(t)},hideOption:function(t,o){var i=e(this._getOptionWithValue(t));i.length&&(t=t.replace(/\s+/g,""),i.prop("hidden",!o),e("li[index='"+i.attr("optionfor")+"']",this._dropDownMenu).attr("id","ui-zc-"+i.attr("optionfor")),this._dropDownMenu.zmenu(o?"showMenuItem":"hideMenuItem","ui-zc-"+i.attr("optionfor")))},showOption:function(e){this.hideOption(e,!0)},disableOption:function(t,o){var i=e(this._getOptionWithValue(t));i.length&&(t=t.replace(/\s+/g,""),i.prop("disabled",!o),e("li[index='"+i.attr("optionfor")+"']",this._dropDownMenu).attr("id","ui-zc-"+i.attr("optionfor")),this._dropDownMenu.zmenu("disableMenuItem","ui-zc-"+i.attr("optionfor")))},enableOption:function(e){this.enableOption(e,!0)},removeOption:function(t){var o=e(this._getOptionWithValue(t)),i=o.attr("data-readOnly");"true"!==i&&o.length&&(t=t.replace(/\s+/g,""),e("li[index='"+o.attr("optionfor")+"']",this._dropDownMenu).attr("id","ui-zc-"+t),this._dropDownMenu.zmenu("removeMenuItem","ui-zc-"+t),this.element.find('option[value!="'+t+'"]').remove())},removeAllOptions:function(){var t=this.element.children();t.each(function(t,o){var i=e(o),n=i.attr("data-readOnly");"true"!==n&&i.remove()}),this._reloadDropDownMenu()},removeOptGroup:function(t){t=-1!=t.indexOf("#")?t:"#"+t;var o=e(t,this.element);o.length&&(o.remove(),this._dropDownMenu.zmenu("removeMenuItem","optgroup"+t))},updateOption:function(e,t,o){var i=this._getOptionWithValue(e);return o?void i.attr(t,o):i.attr(t)},_buildComboMenu:function(t){var o=this,i=function(e,t){var i=t._option;e.is("[mtype=separator]")||(o.options.applyOptionStyles&&i.is("[style]")&&e.attr("style",i.attr("style")),o.options.applyOptionClass&&i.is("[class]")&&e.addClass(i.attr("class")))};if(this._dropDownMenu)this._dropDownMenu.zmenu("addMenuItems",t,i);else{this._dropDownMenuId="combo_"+this.element.attr("id")+"Menu",this._dropDownMenu=e.ui.zmenu.createMenu(this._dropDownMenuId,t,{positionAlterable:this.options.positionAlterable,type:this.options.type,bindKeys:!1,addItemCallback:i,height:this.options.dropDownMenuHeight,width:this.options.dropDownMenuWidth,menuClass:"ui-zcombo-dropdown",appendTo:this.options.appendDropdownTo}),this._dropDownMenu.attr({position:"adjustable",relativeTo:"parent"}),this._dropDownArrow.click(function(e){o._showDropDown(e)}).attr("popup",this._dropDownMenuId);var n=this._baseElement.width();n>this._dropDownMenu.width()&&this._dropDownMenu.width(this._baseElement.width()),this._optArea.click(function(e){o._showDropDown(e,!0)}),this._dropDownMenu.metadata().toggle=!0}var s=this._onLoadCheck?this._defaultIndex:this.element.get(0).selectedIndex;this._setOptionValue(s,!0)},_showDropDown:function(e,t){return this._onLoadCheck&&this._reloadDropDownMenu(),this._prevSearchKey="",this._prevKeydownTime="",this._prevSearchIndex="",this._prevSearchTimer=void 0,t&&this.options.editable?this._handleEditable():void(t&&(this._dropDownArrow.click(),e&&(e.stopPropagation(),e.preventDefault())))},_handleEditable:function(){if(this.options.editable&&!this._baseElement.is(".ui-state-disabled")&&"html"!=this.options.contentType){var t=e(".ui-zmenu-text",this._optArea),o=t.text(),i=e("<input>").attr("type","text").val(o).addClass("ui-zcombo-editable");i.data("base",t),i.data("text",o);var n=this;i.blur(function(){n._finishEditing(!0)});var s=function(t){var o=t.keyCode;if(o!==e.ui.keyCode.TAB&&o!==e.ui.keyCode.SHIFT){o!=e.ui.keyCode.ENTER&&o!=e.ui.keyCode.ESCAPE&&n._dropDownMenu.is(":hidden")&&n._baseElement.click();var s=i.val();if(s!=i.data("text")&&s.length){var r=n._optionInputSearch(s);if(r.length){var a=e("li[index='"+r.attr("optionfor")+"']",n._dropDownMenu);a.length&&(i.data("baseItem",a),n._selectRemainingTextOfEditable(i,a.text()),i.data("text",s))}}}};i.on("keydown.comboeditable",e.debounce(250,s)),t.replaceWith(i),i.select(),this._baseElement.attr("tabindex",-1)}},_selectRemainingTextOfEditable:function(e,t){var o=e.val();if(o!=e.data("text")){var i=t.toLowerCase().indexOf(o.toLowerCase())+o.length;e.val(t),e[0].setSelectionRange(i,t.length)}},_finishEditing:function(t){this._baseElement.attr("tabindex",0);var o=e(".ui-zcombo-editable",this._optArea);if(o.length){var i=o.data("baseItem");o.off(".comboeditable");var n=o.data("base");if(i)i.click(),o.remove();else{var s=n.text(),r=o.val();n.text(r),o.replaceWith(n),s!=r&&this._triggerEvent(this._EVENTS.ONCHANGE,{prevVal:s,value:r})}t?clearTimeout(this._focusTimer):this._handleEditable()}},_getOptionElements:function(){return e("option",this.element)},_getCorrectedOptPosition:function(e){var t=this._getOptionElements().length;return e>=t?e=t-1:0>e&&(e=0),e},_getOptionMenuPosition:function(t){if(this._onLoadCheck)return 0;var o=t-e("option",this.element).filter(function(){return"separator"==e(this).attr("mtype")&&e(this).index()<=t?!0:!1}).length;return o?o:0},_setOptionValue:function(t,o,i){t=this._getCorrectedOptPosition(t);var n=this.selected;this.selected=t;var s=i&&i.length?i:e(this._dropDownMenu.zmenu("getMenuItemAt",this._getOptionMenuPosition(t))),r=e(s.clone().html()),a=" width:"+this._optArea.css("width");if(this._optArea.empty().append(r),this._optArea.find(".ui-zmenu-shortcut").empty().remove(),!o){var d=this.element,l=void 0!=n?d.val():void 0;d.get(0).selectedIndex=t,l!=d.val()&&this._triggerEvent(this._EVENTS.ONCHANGE,{prevVal:l})}var h=this.element.get(0);h.selectedIndex=t;var u=e(".ui-zmenu-text:visible",this._optArea);if(u.length&&(this.options.optioinTextIsHTML?u.html(s.find(".ui-zmenu-text").html()):u.text(r.text())),this.options.applyOptionStylesOnCombo){var p=this.element.get(0).options[t].getAttribute("style");a+=null!=p?";"+p:"",a&&(this._optArea.attr("style",a),u.attr("style",a))}},_addEvents:function(){var t=this;this._dropDownMenu.on("menuhide."+this.widgetName,function(){t._triggerEvent(t._EVENTS.ONHIDE),t._baseElement.focusout().blur()}),this._dropDownMenu.on("menubeforeshow."+this.widgetName,function(){var e=t._triggerEvent(t._EVENTS.ONBEFORESHOW);return e?void 0:!1}),this._dropDownMenu.on("menushow."+this.widgetName,function(){t._dropDownMenu.zmenu("showMenuItemAsSelected",t._getOptionMenuPosition(t.selected)),t._setFocus(),t._triggerEvent(t._EVENTS.ONSHOW)}),this._dropDownMenu.on("menuitemhovered."+this.widgetName,function(o,i){var n={focusItem:i.menuitem,focusValue:e("option[optionfor='"+e(i.menuitem).attr("index")+"']",this.element).val()};t._triggerEvent(t._EVENTS.ONOPTIONFOCUS,n)}),this._dropDownMenu.on("menuitemclicked."+this.widgetName,function(o,i){t._triggerEvent(t._EVENTS.ONCLICK);var n="option[optionfor='"+e(i.menuitem).attr("index")+"']";if(t.options.optgroupAsSplitMenu){var s=e(i.menuitem).data();s&&s.isoptgroup&&(n="#"+s.optgroupid+" :eq(0)")}t._setOptionValue(e(n,this.element).get(0).index,!1,e(i.menuitem)),t.options.retainFocus&&(clearTimeout(t._focusTimer),t._focusTimer=setTimeout(function(){t._setFocus()},200))}),this._baseElement.on("keydown."+this.widgetName,function(e){t._keyPress(e)}).on("focus."+this.widgetName,function(){t._handleEditable()})},_setCurrentSearchOption:function(t){var o=e("option[value='"+this._optionTextArray[t].value+"']",this.element);o.length&&(e("li",this._dropDownMenu).removeClass("ui-state-hover"),this._currentSearchOption=e("li[index='"+o.attr("optionfor")+"']",this._dropDownMenu),this._currentSearchOption.trigger("mouseover"),this._scrollToView("search"))},_scrollToView:function(){var e=this,t=e._dropDownMenu.scrollTop(),o=e._currentSearchOption.height(),i=e._currentSearchOption.position().top,n=e._dropDownMenu.height();return o>n-i?e._dropDownMenu.scrollTop(t+(i-(n/3-o))):-1>i&&e._dropDownMenu.scrollTop(i-o),e},_setFocus:function(){e(".ui-zcombo-editable",this._optArea).length||this._baseElement.focus()},setFocus:function(e){this._baseElement[e?"addClass":"removeClass"]("ui-state-focus")},_showMenuAndSelectOption:function(e){this._dropDownMenu.is(":visible")||this._dropDownArrow.click(),this._dropDownMenu.zmenu(e?"hoverNextMenuItem":"hoverPreviousMenuItem")},_handleDropDownKeyCode:function(e){this._dropDownMenu.zmenu("handleKeyCode",e)},_keyPress:function(t){var o=t.charCode||t.keyCode,i=!1,n=this;switch(o){case e.ui.keyCode.UP:this._showMenuAndSelectOption(),i=!0;break;case e.ui.keyCode.LEFT:this.options.editable||(this._showMenuAndSelectOption(),i=!0);break;case e.ui.keyCode.DOWN:this._showMenuAndSelectOption(!0),i=!0;break;case e.ui.keyCode.RIGHT:this.options.editable||(this._showMenuAndSelectOption(!0),i=!0);break;case e.ui.keyCode.SPACE:(this._dropDownMenu.is(":visible")||e(".ui-zcombo-editable",this._optArea).length<1)&&(i=!0);break;case e.ui.keyCode.ENTER:i=!0,this._finishEditing();{this._dropDownMenu.zmenu("selectHoveredMenuItem")}this._dropDownMenu.zmenu("hide");break;case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.HOME:this._handleDropDownKeyCode(o);break;case e.ui.keyCode.ESCAPE:this._dropDownMenu.is(":visible")&&(t.stopPropagation(),t.preventDefault(),e.ZContextMenu.hideMenu(),this.options.retainFocus&&setTimeout(function(){n._setFocus()},200));break;case e.ui.keyCode.TAB:this._dropDownMenu.is(":visible")&&(t.stopPropagation(),t.preventDefault(),e.ZContextMenu.hideMenu());break;default:this._dropDownMenu.is(":visible")&&(alphaNumericKey=String.fromCharCode(o),this._callOptionsSearch(alphaNumericKey,(new Date).getTime()))}i&&(t.stopPropagation(),t.preventDefault())},_callOptionsSearch:function(e,t){var o=!1;""!==this._prevKeydownTime&&t-this._prevKeydownTime>700?(o=this._prevSearchKey==e?!0:!1,this._prevSearchKey=e):this._prevSearchKey=this._prevSearchKey+e,this._prevKeydownTime=t,this._optionMenuSearch(o)},_optionMenuSearch:function(e){var t=new RegExp("^"+this._prevSearchKey.replace(/[|()\[{.+*?$\\]/g,"\\$0"),"i"),o=e&&this._prevSearchIndex<this._optionTextArray.length-1?this._prevSearchIndex+1:0;for(x=o;x<this._optionTextArray.length;x++)if(this._optionTextArray[x].text.match(t)){this._prevSearchIndex=x;var i=!1;for(y=x+1;y<this._optionTextArray.length;y++)this._optionTextArray[y].text.match(t)&&(i=!0);return i||(this._prevSearchIndex=-1),void this._setCurrentSearchOption(x)}},_optionInputSearch:function(t){var o=new RegExp("^"+t.replace(/[|()\[{.+*?$\\]/g,"\\$0"),"i");for(x in this._optionTextArray)if(this._optionTextArray[x].text.match(o))return e("option[value='"+this._optionTextArray[x].value+"']",this.element)},_triggerEvent:function(t,o){var i={combo:e(this.element),value:e(this.element).val()};return o&&(i=e.extend(i,o)),this._trigger(t,t,i)},destroy:function(){this._baseElement.off("."+this.widgetName),this._dropDownMenu.zmenu("destroy").remove(),e.Widget.prototype.destroy.apply(this,arguments)},_getOptionWithValue:function(e){var t=document.getElementById(this.element.attr("id")).options,o=void 0;for(i=0;i<t.length;i++)e==t[i].value&&(o=t[i]);return o},setValue:function(t){this._onLoadCheck&&this._reloadDropDownMenu();var o=this._getOptionWithValue(t);o?this._setOptionValue(o.index,!0):this.options.editable?(this.selected=void 0,t||(t=""),e(".ui-zmenu-text",this._optArea).text(t)):(this.selected=void 0,this._optArea.empty())},getValue:function(){var e=this._getOptionElements();return e.get(this.element.get(0).selectedIndex).value},getSelectedOption:function(){var e=this.getSelectedIndex();return this._getOptionElements()[e]},getSelectedIndex:function(){return this.element.get(0).selectedIndex},setSelectedIndex:function(e){this._onLoadCheck&&this._reloadDropDownMenu();var t=this.element.get(0);return this._setOptionValue(e,!0),t.selectedIndex},getDropDown:function(){return this._onLoadCheck&&this._reloadDropDownMenu(),this._dropDownMenu},getDropDownId:function(){return this._dropDownMenuId},disable:function(){e(this._baseElement).attr("disabled","true"),e(this._baseElement).addClass("ui-state-disabled"),e(this._dropDownArrow).attr("disabled","true"),e(this._dropDownArrow).addClass("ui-state-disabled")},enable:function(){e(this._baseElement).removeAttr("disabled"),e(this._baseElement).removeClass("ui-state-disabled"),e(this._dropDownArrow).removeAttr("disabled"),e(this._dropDownArrow).removeClass("ui-state-disabled")},widget:function(){return this._baseElement},refresh:function(){this._reloadDropDownMenu()},_reloadDropDownMenu:function(){this._optionTextArray=[],this._onLoadCheck=!1,this._dropDownMenu.zmenu("removeAllMenuItems");var e=this._buildDropDown();this._buildComboMenu(e)},show:function(){this._baseElement.show()},hide:function(){this._baseElement.hide()},open:function(){this._dropDownMenu.is(":hidden")&&this._dropDownArrow.click()},close:function(){this._dropDownMenu.is(":visible")&&this._dropDownArrow.click()}};e.widget("ui.zcombo",t),e.ui.zcombo.defaults={editable:!1,type:"icon_text",applyOptionStyles:!0,applyOptionClass:!0,applyOptionStylesOnCombo:!1,retainFocus:!0,optgroupAsSplitMenu:!1,positionAlterable:!1,dropDownMenuHeight:void 0,dropDownMenuWidth:void 0,appendDropdownTo:void 0}}(jQuery);
!function(e){e.widget("ui.zmenu",{widgetEventPrefix:"menu",_DEFAULT_ICONS:{CHECK_BOX_NOT_CHECKED_ICON:"ui-zmenu-no-icon",CHECK_BOX_CHECKED_ICON:"ui-icon-check",RADIO_BUTTON_NOT_CHECKED_ICON:"ui-zmenu-no-icon",RADIO_BUTTON_CHECKED_ICON:"ui-icon-bullet"},_MENU_ITEM_TYPES:{CHECK_BOX:"checkbox",RADIO_BUTTON:"radio",SUB_MENU:"submenu"},_EVENTS:{ONBEFORESHOW:"beforeshow",ONBEFOREHIDE:"beforehide",ONSHOW:"show",ONHIDE:"hide",ONMENUITEMCLICKED:"itemclicked",ONBEFORESUBMENUSHOW:"beforesubshow",ONSUBMENUSHOW:"subshow",ONBEFORESUBMENUHIDE:"beforesubhide",ONSUBMENUHIDE:"subhide",ONMENUITEMHOVERED:"itemhovered",ONMENUITEMDISABLED:"itemdisabled",ONICONCHANGE:"itemiconchange",ONLABELCHANGE:"itemlabelchange"},_MENU_SCOPES:{icon_text:"ui-zmenu-icontext",icon_only:"ui-zmenu-icononly",text_only:"ui-zmenu-textonly",icon_only_floating:"ui-zmenu-icononly ui-zmenu-floating",text_only_floating:"ui-zmenu-textonly ui-zmenu-floating",icon_text_floating:"ui-zmenu-icontext-floating",icon_text_header:"ui-zmenu-icontext-header",icon_text_on_top:"ui-zmenu-icontext-top",icon_text_on_bottom:"ui-zmenu-icontext-bottom",icon_text_hint:"ui-zmenu-icontext-hint"},_CHECK_SELECTION_ICON:"ui-state-active",options:{positionAlterable:!0,type:"icon_text",bindKeys:!0,fixed:!1,fixWidth:!0,columns:3,skipHighlightTarget:!1,scroll:"default",toggle:!0},_create:function(){var t=this,i=this.element.metadata().toggle||this.options.toggle;this.element.metadata().toggle=i?!0:!1,t._buildMenu(this.element),this._menuTextArray=[],this._initEvents();var n=this.options.appendTo;void 0!==n&&""!==n&&(n=-1!=n.indexOf("#")?n:"#"+n,this.options.appendTo=e(n)),this.options.fixed?(this._resetMenuTextArray(this.element),this.show()):this.element.hide(),this.options.bindKeys&&this.element.focusable(),this.options.height&&this.element.data("height",this.options.height),this.options.width&&this.element.data("width",this.options.width),this.element.data("positionAlterable",this.options.positionAlterable)},_addScopeForMenu:function(e,t){e.addClass(this._MENU_SCOPES[t?t:this.options.type])},_initEvents:function(t){var i=t?"sub":"",n=t;if(t=t?t:this.element,!(t.data("initialized")&&!n||this._isExternalSubmenu(t))){t.data("initialized",!0);var s=this;e(t).on("click."+i+this.widgetName,function(e,t){return s._menuClicked(e,t)})}},_buildMenu:function(t,i){var n="ui-zmenu "+(e.ui.directionIsRTL?" zmenu___rtl ":"");t.addClass(n+(this.options.fixed?"":"ui-widget-shadow-new ui-zmenu-position")),this._addScopeForMenu(t,i),this._buildDefaults(t)},_uninitSliders:function(e){var t=e.metadata();t.sliders&&(t.sliders.top&&t.sliders.top.remove(),t.sliders.bottom&&t.sliders.bottom.remove())},_createSlider:function(t,i){var n=i?"top":"bottom",s=t.metadata();s.sliders||(s.sliders={});var u=s.sliders[n];u&&u.remove(),u=e("<div>").addClass("ui-zmenu-scroll-"+n),s.sliders[n]=u;var a=this;u.hover(function(){a._startScroll(t,i)},function(){a._stopScroll(t)}).hide(),u.click(function(){var e=t.scrollTop();return a._stopScroll(t),t.scrollTop(e+100*(i?-1:1)),a._startScroll(t,i),!1});var r=t.position(),o=t.outerWidth()-2,l=i?0:t.outerHeight()-6;u.css({top:r.top+1+l,left:r.left+1,width:o}).fadeTo(0,1);var h=i?"-3px":"-1px",d="top"==n?"ui-corner-bottom":"ui-corner-top",m=e('<button class="ui-button ui-widget ui-state-default ui-button-icon-only ui-scroll-arrowbg '+d+'"></button>').css({top:h}),c="top"==n?"n":"s",_=e('<span class="ui-button-icon-primary ui-icon ui-components-icon ui-icon-triangle-1-'+c+'"></span>'),p=e('<span class="ui-button-text">.</span>');return e(_).appendTo(e(m)),e(p).appendTo(e(m)),e(m).appendTo(u),u.insertAfter(t),u},_initSliders:function(e){this._createSlider(e),this._createSlider(e,!0);this._displayScrolls(e)},_displayScrolls:function(e){var t=e.metadata().sliders,i=e.scrollTop();t.top[0==i?"hide":"show"](),t.bottom[e[0].scrollHeight-i<e.outerHeight()?"hide":"show"]()},_startScroll:function(e,t){var i=t?0:e[0].scrollHeight-e.innerHeight(),n=this,s=e.scrollTop()-i,u=Math.abs(1e3*s/50);e.animate({scrollTop:i},{duration:u,easing:"linear",complete:function(){n._displayScrolls(e)}})},_stopScroll:function(e){e.stop(),this._displayScrolls(e)},_scrollToView:function(e,t){var i,n=t.scrollTop(),s=e.height(),u=e.position().top,a=t.height();return s>a-u?i=n+(u-(a/3-s)):-1>u&&(i=u-s),void 0!==i&&(this._animate===!1?t[0].scrollTop=i:t.animate({scrollTop:i},{duration:300,easing:"linear"})),!1},_buildDefaults:function(t){var i=t.children("li"),n=this;i.each(function(i,s){n._buildMenuItem(e(s),t)})},_setWidth:function(t,i){if(!this._isFloatingMenu(t)){var n=e("#tmpDiv");n.length||(n=e("<div>").attr("id","tmpDiv").css({width:"auto"}).appendTo("body")),n.attr("class","ui-zmenu "+t.attr("class")),n.html(e(i).clone());var s=n.outerWidth()+1;e(i).data("width",s),n.empty().hide()}},_addEventsForMenuItems:function(t){var i=this;t.hover(function(t,n){t.data=n,i._handleMouseOverOnMenuItems(e(this),t)},function(t,n){t.data=n,i._handleMouseOutOnMenuItems(e(this),t)})},_getMenuItemType:function(e){return e.attr("mtype")},_isChecked:function(e){return this._isCheckBoxOrRadioButton(e)?e.data("checked"):!1},_getRelatedIcon:function(e){var t=this._getInputType(e),i=e.metadata(),n=i.icon;if(t){var s=this._isChecked(e);if(n)n=s?n+" "+this._CHECK_SELECTION_ICON:n;else switch(t){case this._MENU_ITEM_TYPES.CHECK_BOX:n=this._DEFAULT_ICONS[s?"CHECK_BOX_CHECKED_ICON":"CHECK_BOX_NOT_CHECKED_ICON"];break;case this._MENU_ITEM_TYPES.RADIO_BUTTON:n=this._DEFAULT_ICONS[s?"RADIO_BUTTON_CHECKED_ICON":"RADIO_BUTTON_NOT_CHECKED_ICON"]}}return n},_getIconForMenuItem:function(e){var t=e.metadata(),i=this._getRelatedIcon(e);return i||(i=t.icon),t.iconText&&(i=(i?i+" ":"")+"ui-zmenu-icon-textable"),i=i?i:"ui-zmenu-no-icon"},_isGroup:function(e){var t=this._getMenuItemType(e);return"group"===t},_isSeparator:function(e){var t=this._getMenuItemType(e);return"separator"===t},_buildGroup:function(t){var i=e(t).children("ul");if(!i.length)return!1;i.addClass("ui-zmenu-group-base");var n=i.metadata(),s=n.type;!s&&n.componentOptions&&(s=n.componentOptions.type),this._addScopeForMenu(i,s);{var u=e(i).children("li"),a=this,r=t.attr("id");i.metadata().type}u.each(function(t){var n=e(u[u.length-t-1]);a._buildMenuItem(n,i),a._buildGroupItem(n,r)});t.text();return t.attr("mtype","group"),t.attr("gname",t.attr("id")),t.addClass("ui-zmenu-group-wrapper"),i},_buildGroupItem:function(e,t){this._isGroup(e)||(e.attr("gname",t),e.is("[mtype=separator]")||e.addClass("ui-zmenu-group-item"))},_buildSeparator:function(e){var t=e.attr("groupSep");e.addClass("ui-zmenu-separator"),t&&e.addClass("ui-zmenu-group-separator")},_getScopedMenu:function(e){var t=e.closest(".ui-zmenu-group-base");return t.length||(t=e.closest(".ui-zmenu")),t},_getMenuItemScopeType:function(e){var t=this._getScopedMenu(e),i=this.getMenuType(t);return i},_buildMenuItem:function(t,i){t.addClass("ui-zmenu-item");var n=this._isFloatingMenu(i);n&&t.addClass("ui-zmenu-item-floating");var s=t.metadata();s.hidden&&this._hideMenuItem(t,!1,!0);var u=this._getMenuItemType(t);if("custom"==u){s&&s.html&&t.html(s.html),t.addClass("ui-zmenu-item-custom");var a=t.find(".ui-widget-shadow-new");a.removeClass("ui-widget-shadow-new");var r=t.find(".ui-corner-all");return r.removeClass("ui-corner-all"),this._addEventsForMenuItems(t),void(i.children(":not([mtype=custom])").length&&this._setWidth(i,t))}if(this._isSeparator(t))return this._buildSeparator(t);var o=!1;if(this._isGroup(t)){o=!0;var l=this._buildGroup(t);l&&(t=t.clone(!0),t.attr("id",t.attr("id")+"Label"),t.removeClass("ui-zmenu-group-wrapper"),l.prepend(t),l.parent().removeClass("ui-zmenu-item")),t.addClass("ui-zmenu-group")}else"icon_text_floating"==this._getMenuItemScopeType(t);n=n&&!t.hasClass("ui-zmenu-group")&&!t.hasClass("ui-zmenu-subsplit");var h=e("<span />").addClass("ui-zmenu-icon-layout"),d=e("<span />").addClass("ui-icon ui-zmenu-icon-inner"+(n?" ui-zmenu-icon-placeholder":"")).addClass(this._getIconForMenuItem(t));s.iconText&&(i.data("iconAsText",!0),d.text(s.iconText)),h.append(d),d.hasClass(this._CHECK_SELECTION_ICON)&&(d.removeClass(this._CHECK_SELECTION_ICON),this._isFloatingMenu(t,!0)||h.addClass(this._CHECK_SELECTION_ICON));var m=void 0;"file"==u&&(m=t.find("input[type=file]").detach(),m.addClass("ui-zmenu-file"));var c=o?"":t.text();if(this._isSubMenuItem(t)){var _=e(t).contents().filter(function(){return 3==this.nodeType}),p=this;_.each(function(t,i){var n=p._trimStr(e(i).text());n.length&&(c=n,e(i).remove())})}else t.text("");s.label||(s.label=this._trimStr(c));var f=s.ellipsis?s.label+"...":s.label,v=e("<span />").addClass("ui-zmenu-text"+(n?" ui-zmenu-text-placeholder":"")).text(f),g=e.ui.shortcutkeys?e.ui.shortcutkeys.register(t):void 0;if(t.append(h,v),this._isRadioButton(t)&&this._isChecked(t)&&this._fixCheckRadio(t,!0),s.html){var M=s.html.content,I=s.html.replaceWithText;if(M){var b=void 0;if(I)t.find(".ui-zmenu-text").html(M),b=t.find(".ui-zmenu-text");else{var C=this._getIconHolderForMenuItem(t);C.html(M),C.css({background:"none"}),b=C}b.css({width:"auto",height:"auto",position:"relative",left:"0px",top:"0px"})}}var E=e("<span>").addClass("ui-zmenu-item-placeholder");if(this._isSubMenuItem(t)){if(this._buildSubMenu(t),g&&t.is("[mtype=splitmenu]")){var O=this._createShortCutEle(t,g);E.insertAfter(O).hide()}}else if(g){var O=this._createShortCutEle(t,g);E.insertAfter(O)}var y=t.metadata().hint;if(y){var x=e("<span />").addClass("ui-zmenu-hint");x.text(y),t.append(x)}m&&t.append(m),o?s.label.length||t.remove():(this._checkAndDisableMenuItem(t,!0),this._addEventsForMenuItems(t));var T=t.attr("onclick");this._fixClick(t,T),t.removeAttr("onclick"),t.off("click")},_createShortCutEle:function(t,i){var n=e("<span />").addClass("ui-zmenu-shortcut");return n.text(i[0]),t.append(n),n},_trimStr:function(e){return e.replace(/^\s+|\s+$/g,"")},_fixClick:function(e,t){var i=e.metadata();i.clickHandler||(i.clickHandler=t,i.onclick=function(e){var t=i.clickHandler;t&&t.call(e)})},_buildSplitMenu:function(t){var i=t.metadata(),n=e("<ul>").attr("mtype","group").addClass("ui-zmenu-splitgroup"),s=e("<li>").attr({mtype:"group",id:"group_"+t.attr("id")}),u=e("<li>").addClass("ui-zmenu-subsplit");u.data("mainsplit",t),t.data("subsplit",u);var a=this._isDisabled(t);a&&this._disableMenuItem(u,!a),i.doNotOpenSubmenu||t.hover(function(e){var i=setTimeout(function(){u.trigger(e)},400);t.data("timeout",i)},function(){var e=t.data("timeout");e&&clearTimeout(e)}),s.append(n),s.addClass("ui-zmenu-splitmenu"),s.insertBefore(t),this._buildMenuItem(s,n),n.append(t);var r=this._getSubMenu(t);if("object"==typeof r)if(r.metadata().isExternalSubMenu){var i=t.metadata();u.metadata().submenu=i.submenu,delete i.submenu}else u.append(r);else u.append(r);return n.append(u),n.addClass("ui-zmenu-floating"),this._buildMenuItem(u,n),!0},_buildSubMenu:function(t){if("splitmenu"!=t.attr("mtype")||!this._buildSplitMenu(t)){var i=t.metadata();if(i.contextual){t.addClass("ui-zmenu-item-contextual");var n=this;t.on("contextmenu."+this.widgetName,function(e){n._showSubmenu(t,{left:e.clientX,top:e.clientY,forcePosition:!0},!0),n._setFocus()})}var s=e("<span />").addClass("ui-icon ui-zmenu-submenu-arrow-cue ui-components-icon ui-icon-triangle-1-e");t.append(s);var u=this._getSubMenu(t);if(u&&(u.hide().attr({mtype:"submenu"}),u.parent().attr({mtype:"submenuitem"}),t.metadata().submenu=u,u.metadata().parent=t,!u.metadata().isExternalSubMenu)){var a=u.metadata(),r=a.type;!r&&a.componentOptions&&(r=a.componentOptions.type),this._buildMenu(u,r)}}},_isSubMenuItem:function(e){var t=e.metadata();return t.submenu?!0:e.is("[mtype=group]")?!1:e.children(":first").is("ul")},_isSubMenu:function(e){var t=e.metadata().parent;return!!t},_getSubMenu:function(t){var i=t.metadata().submenu;if("string"==typeof i){if(i=e(i),!i.length)return void 0;var n=i.metadata();i.data("zmenu")||i.zmenu(n.componentOptions),n.isExternalSubMenu=!0}return i&&i.length?(i.metadata().parent=t,i):t.children("ul:first")},_clearMenuTimeout:function(){this._menuTimeout&&(clearTimeout(this._menuTimeout),this._menuTimeout=void 0)},_isLastMenuItem:function(e){return e.parent().children("li:last").get(0)==e.get(0)},_isFirstMenuItem:function(e){return e.parent().children("li:first").get(0)==e.get(0)},_isDirectEvent:function(e){return!!e.originalEvent},_isMenuOfMenuItemShown:function(t){return this._isSubMenuItem(t)&&e(this._getSubMenu(t)).is(":visible")},_checkAndHideAllOpenedSubMenus:function(t){var i=t.find(".ui-zmenu-item-hover:last");if(i.length){var n=this._getSubMenu(i);e(n).is(":visible")&&(this._checkAndHideAllOpenedSubMenus(n),i.trigger("mouseleave"))}},_handleMouseOverOnMenuItems:function(e,t,i){i&&this._scrollToView(e,e.closest(".ui-zmenu"));var n=t?this._isDirectEvent(t):!1;if(e.is(".ui-zmenu-item-hover")&&this._isMenuOfMenuItemShown(e))return void this._setLastOverlayedMenuItem(e);if(this._checkAndHideAllOpenedSubMenus(e.closest(".ui-zmenu")),this._setLastOverlayedMenuItem(e),this._clearMenuTimeout(),!e.is("[mtype=custom]")){var s=this._isSubMenuItem(e);if(this._isDisabled(e)||e.addClass("ui-zmenu-item-hover"),!this._isDisabled(e)&&e.is(".ui-zmenu-subsplit")){var u=e.data("mainsplit");u&&u.addClass("ui-zmenu-item-hover")}this._isDisabled(e)||(s&&n&&!e.is(".ui-zmenu-item-contextual")&&this._showSubmenu(e,{isSplitMenu:e.is(".ui-zmenu-subsplit")}),this._triggerEvent(this._EVENTS.ONMENUITEMHOVERED,t,e.parent(),e))}},_showSubmenu:function(t,i,n){var s=this;i.target||(i.target=t);var u=function(){s.show(i,e(s._getSubMenu(t)))};n?u():s._menuTimeout=setTimeout(u,300)},_handleMouseOutOnMenuItems:function(t,i){var n=this._isDirectEvent(i);if(n){if(!t.parent().has(i.relatedTarget).length){if(this._isSubMenuItem(t)&&this._isMenuOfMenuItemShown(t))return;this._setLastOverlayedMenuItem(void 0)}}else{var s=i.data;if(!this._isMenuOfMenuItemShown(t)||!this._isElementInMenu(s,e(this._getSubMenu(t)))){if(this._clearMenuTimeout(),t.removeClass("ui-zmenu-item-hover"),t.is(".ui-zmenu-subsplit")){var u=t.data("mainsplit");u&&u.removeClass("ui-zmenu-item-hover")}if(this._isSubMenuItem(t)){var a=this._getSubMenu(t);if(!a)return;this._isElementInMenu(s,e(a))||this.hide(a)}}}},_isElementInMenu:function(t,i){return i||(i=this.element),t=e(t)[0],1==i.has(t).length},_getAllMenuItems:function(e,t,i,n,s){return e&&e.length||(e=this.element),e.find(".ui-zmenu-item:not([mtype=group], .ui-zmenu-subsplit"+(s?", .ui-zmenu-separator":"")+(t?", .ui-zmenu-item-floating":"")+(i?", li ul[mtype=submenu] li":"")+")"+(n?":visible":""))},_getMenuTypeFromData:function(e){var t=e.metadata(),i=t.type;return!i&&t.componentOptions&&(i=t.componentOptions.type),i},getMenuType:function(e){if(e&&this._isExternalSubmenu(e))return e.zmenu("getMenuType");e||(e=this.element);var t=this._getMenuTypeFromData(e);return t||(e.is(".ui-zmenu-group-base")&&(e=e.closest(".ui-zmenu"),t=this._getMenuTypeFromData(e)),t||(t=this.options.type)),t},_isFloatingMenu:function(e,t){var i=t?this._getScopedMenu(e):e?e:this.element,n=this.getMenuType(i);return this._isTypeFloating(n,i)},_isTypeFloating:function(e,t){return e&&-1!=e.indexOf("floating")||t&&(t.hasClass("ui-zmenu-floating")||t.hasClass("ui-zmenu-icontext-floating"))?!0:!1},_fixTextOnlyFloatingItemsWidth:function(t){var i=t.children("li:not(.ui-zmenu-group):not(.ui-zmenu-separator)"),n=0;i.each(function(t,i){i=e(i);var s=i.width();s>n&&(n=s)}),i.width(n)},_fixFloatingMenuWidth:function(t){var i=t.metadata().columns;if(!i||-1==i){var n=t.closest(".ui-zmenu");if(i=this._isExternalSubmenu(n)?n.zmenu("option","columns"):this.options.columns,!i||-1==i)return}var s=this._getAllMenuItems(t,!1,!1,!0),u=e(s[0]).outerWidth(!0);this._fixEllipsisForMenuItems(s,t,u*i);var a=u*i;t.width(a+1),t.data("width",a)},_getItemWithMaxWidth:function(t){t=t?t:this._getAllMenuItems(this.element,!1,!1,!0);var i=0,n=t[0];return t.each(function(t,s){s=e(s);var u=s.data("width");u>i&&(i=u,n=s)}),n},_getItemsLargerThanMenu:function(t,i,n){var s=[];return t=t?t:this._getAllMenuItems(this.element,!1,!1,!0),t.each(function(t,i){i=e(i);var u=i.width();u>n&&s.push(i)}),s},_fixEllipsisForMenuItems:function(t,i,n){var s=this._getItemsLargerThanMenu(t,i,n),u=this;e(s).each(function(t,i){i=e(i),u._fixEllipsisForMenuItem(i,n)})},_fixEllipsisForMenuItem:function(t,i){var n=this;e(t).each(function(t,s){var u=i,s=e(s),a=s,r=void 0;if(s.is("[mtype=custom]"))if(s.html()==s.text())r=s.text();else if(1==s.children().length)s=s.children(":first"),r=s.text();else{var o=s.find("[ellipsis=true]");o.length&&(r=o.text(),s=o)}else{a=s.find(".ui-zmenu-text"),r=a.text();var l=s.find(".ui-zmenu-icon-layout"),h=s.find(".ui-zmenu-shortcut");u=i-(l.is(":visible")?l.width():0)-(h.is(":visible")?h.width():0)}if(r){var d=n._getEllipsisText(r,u);s.attr("title",r),s.data("text",r),a.text(d)}})},_getEllipsisText:function(t,i){var n="...",s=0,u=e("<span>").addClass("ui-zmenu-item ui-zmenu-item-dummy").text(t);for(e("body").append(u);u.width()>i&&10>=s;)s++,t=t.substring(0,t.length-7)+n,u.text(t);return u.remove(),delete u,t},_fixMenuItemsWidth:function(e,t){if(e&&this.options.fixWidth){this.element[0]==e[0]&&e.css("width","");var i=e;return e.is(".ui-zmenu-group-base")&&(i=e.closest(".ui-zmenu")),t||(t=this.getMenuType(e)),this._isTypeFloating(t)?("text_only_floating"==t&&this._fixTextOnlyFloatingItemsWidth(e),this._fixFloatingMenuWidth(e)):void 0}},_fixMenuHeight:function(t,i){t.removeClass("ui-zmenu-scroll");var n="auto";t.height(n);var s=t.data("positionAlterable");s||this._positionMenu(t,i);var u=t.height(),a=1*t.css("top").split("px")[0]-e(window).scrollTop();a=a?a:0;var r=e(window).height(),o=r-u;if(a+u>=r&&(0>o||!s)&&(n=r-a-15),t.data("height")){var l=t.data(t.data("height")?"height":"modifiedHeight");n=u>l?l:n}else o>0&&s&&(n=u);t.height(n);var h=e.ZContextMenu.scrollWidth,d=t.metadata(),m=d.isExternalSubMenu&&d.componentOptions?d.componentOptions.scroll:this.options.scroll;if(u>n){t.data("modifiedHeight",n);var c=t.data("modifiedHeight");if(m=m?m:"default",m&&"no"!=m)if(t.data("pos")||this._positionMenu(t,i),"slider"==m)c&&c!=n&&this._uninitSliders(t),this._initSliders(t);else{t.addClass("ui-zmenu-scroll");var _=parseFloat(t.data("width"))+(this._isFloatingMenu(t)?h+1:h);t.width(_)}}else m&&"no"!=m&&t.removeClass("ui-zmenu-scroll")},_positionMenu:function(t,i,n){if(i||(i=t.data("pos"))){if(void 0==n&&(n=t.data("isSubMenu")),n&&(!i||!i.forcePosition)){var s=t.metadata().parent,u=s.offset();if(e.ui.directionIsRTL){var a=u.left-t.outerWidth()+3,r=u.top+1;i={left:a,top:r}}else{var a=u.left+s.outerWidth()-3,r=u.top+1;i={left:a,top:r}}}(this.options.positionAlterable||n)&&(i=this._checkBoundriesAndAlterPosition(t,i,s)),t.data({pos:i,isSubMenu:n});var o=t.metadata().sliders;o&&(o.top.css({left:i.left+1,top:i.top+1}),o.bottom.css({left:i.left+1,top:i.top+(t.outerHeight()-6)+1})),t.css(i)}},_checkBoundriesAndAlterPosition:function(t,i,n){var s=this.options.positionAlterable,u=this.options.appendTo,a=void 0!==u&&u.length?u:e(window),r={height:a.scrollTop()+a.height(),width:a.scrollLeft()+a.width()},o=i.top+t.outerHeight(),l=i.left+t.outerWidth();return"left"!=s&&(r.height<o&&(i.top=r.height-t.outerHeight()-2),i.top<0&&(i.top=0)),"top"!=s&&(r.width<l&&(i.left=n?i.left-n.outerWidth()-t.outerWidth()+5:r.width-t.outerWidth()-2),i.left<0&&(i.left=0)),i},_hideAllSubMenus:function(){var e=this._traverseAndFindBaseMenu();e[0]!=this.element[0]?e.zmenu("hide"):this._checkAndHideAllOpenedSubMenus(e)},_traverseAndFindBaseMenu:function(e){var t=e;e=e?e:this.element;var i=e.metadata();if(i.isExternalSubMenu||!t&&e.is("[mtype=submenu]"))for(var n=i.parent;n;){var t=n.closest(".ui-zmenu");t.is(":visible")?(e=t,i=e.metadata(),n=i.parent):n=!1}return e.closest(".ui-zmenu")},_initRuntimeEvents:function(){var t=this;e(this.element).on("keydown.run"+this.widgetName,function(i){var n=i&&i.target?i.target:i.srcElement;e(n).is(".ui-focusable")&&t._keyPressed(i)})},_lastOverlayedMenuItem:void 0,_lastOverlayedMenu:void 0,_setLastOverlayedMenuItem:function(e,t){if(!this._lastOverlayedMenuItem||!e||this._lastOverlayedMenuItem.get(0)!=e.get(0)){if(this._lastOverlayedMenuItem&&e&&e.length&&!this._lastOverlayedMenu.has(e.get(0)).length){var i=e.metadata().submenu;if(!i||i[0]!=this._lastOverlayedMenu[0]){var n=this._lastOverlayedMenu.metadata().parent;n&&n.parent().has(e[0]).length&&n.trigger("mouseleave",e)}}if(this._lastOverlayedMenuItem&&!t&&this._lastOverlayedMenuItem.trigger("mouseleave",e),this._lastOverlayedMenuItem=e,e&&e.length){var s=e.closest(".ui-zmenu");this.updateLastMenuChain(s)}}},updateLastMenuChain:function(e,t){if(this._lastOverlayedMenu=e,!t&&e[0]!=this.element[0]){var i=this._traverseAndFindBaseMenu();i.zmenu("updateLastMenuChain",e,!0)}},_getExactItem:function(e,t){var i=e.children("ul:first");return i.length&&i.is(".ui-zmenu-group-base")?i.children("li:visible:not(.ui-zmenu-group, .ui-zmenu-separator):"+(t?"last":"first")):e},_getNextFloatingMenuItem:function(t,i,n,s,u){var a=void 0,r=s?"top":"left",o=i.length;return e.each(i,function(n,s){s=i[u?o-n-1:n];var l=e(s).position();return l[r]==t[r]?(a=e(s),!1):void 0}),a},_getNextMenuItem:function(t,i,n,s){var u=this._lastOverlayedMenu&&0!=this._lastOverlayedMenu.length?this._lastOverlayedMenu:this.element,a=this._isFloatingMenu(u),r=void 0;if(n=void 0!=n?n:this._lastOverlayedMenuItem,n=n&&n.hasClass("ui-zmenu-subsplit")?n.closest(".ui-zmenu-group-wrapper"):n,0==n&&(n=void 0),n&&n.length){if(n.is(".ui-zmenu-group-wrapper"))r=n[t?"prev":"next"](),(!r.length||r.is(".ui-zmenu-group-wrapper,.ui-zmenu-group,.ui-zmenu-separator")&&!r.find("li:visible").length)&&(r=this._getNextMenuItem(t,i,r));else{r=n[t?"prevAll":"nextAll"](":visible.ui-zmenu-item,.ui-zmenu-group-wrapper").not(".ui-zmenu-separator,.ui-zmenu-group");var o=n.position(),l=s==e.ui.keyCode.LEFT||s==e.ui.keyCode.RIGHT;if(a?(r=this._getNextFloatingMenuItem(o,r,t,l),r||(r=n[t?"nextAll":"prevAll"](".ui-zmenu-item:not(.ui-zmenu-separator):not(.ui-zmenu-group):visible"),o[l?"left":"top"]=0,r=this._getNextFloatingMenuItem(o,r,t,l,!0))):r=e(r[0]),!r||!r.length){var h=n.closest("ul.ui-zmenu-group-base"),d=!1;h.length&&(d=h.parent()),r=this._getNextMenuItem(t,i,d)}}r=this._getExactItem(r,t)}else r=u.find(".ui-zmenu-item:visible:not(.ui-zmenu-group, .ui-zmenu-separator, .ui-zmenu-subsplit):"+(t?"last":"first")),r=this._getExactItem(r,t);return this._setLastOverlayedMenuItem(r,i),this._lastOverlayedMenuItem},_menuClicked:function(t,i){var n=e(t.target);if(n.is("input[type=file]")){var s=this;return n.one("change",function(){s.hide()}),!0}return n.is("li")||(n=n.parent()),this._handleClickOnMenuItem(n,t,i),!1},_handleClickOnMenuItem:function(t,i,n){t=e(t).closest(".ui-zmenu-item"),n||(n={});var s=t.metadata();if(t.is("[mtype=splitmenu]")&&!s.doNotOpenSubmenu&&this._clearMenuTimeout(),t.length&&!(this._isDisabled(t)||this._isGroup(t)||this._isSubMenuItem(t)&&!s.contextual)){var u=s.onclick;if(u&&u(),i.originalEvent||(i=void 0),this._isCheckBoxOrRadioButton(t)&&this._check(t,void 0,n),!t.is("[mtype=custom]")){var a=t.closest(".ui-zmenu");a.data("isSubMenu")&&(this._target=a.data("target")),s.doNotTriggerClickEvent||this._triggerEvent(this._EVENTS.ONMENUITEMCLICKED,i,a,t,n)}!t.is(".ui-zmenu-item-contextual")&&(this.options.fixed||this._isSubMenuItem(t))||s.doNotTriggerClickEvent||"checkbox"!=t.attr("inputtype")&&this.hide()}},_keyPressed:function(e){if(this.options.bindKeys){var t=e.keyCode;this.handleKeyCode(t,e),e.preventDefault(),e.stopPropagation()}},_hideLastShownMenu:function(){var e=this._lastOverlayedMenu.metadata().parent;this._lastOverlayedMenuItem=e,this.hide(this._lastOverlayedMenu);var t=e.closest(".ui-zmenu");this.updateLastMenuChain(t)},_isMenuMainMenu:function(t){return e(t).get(0)==this.element.get(0)},destroy:function(){this._uninitSliders(this.element),this.element.off("."+this.widgetName),this.element.find(".ui-zmenu-item-contextual").off("."+this.widgetName),e.Widget.prototype.destroy.apply(this,arguments)},_destroyRuntimeEvents:function(){e(this.element).off(".run"+this.widgetName)},_isCheckBoxOrRadioButton:function(e){var t=this._getInputType(e);return t==this._MENU_ITEM_TYPES.CHECK_BOX||t==this._MENU_ITEM_TYPES.RADIO_BUTTON},_isCheckBox:function(e){return this._getInputType(e)==this._MENU_ITEM_TYPES.CHECK_BOX},_isRadioButton:function(e){return this._getInputType(e)==this._MENU_ITEM_TYPES.RADIO_BUTTON},_getInputType:function(e){return e.attr("inputtype")},_fixCheckIcon:function(t,i){var n=this._isCheckBox(t);t.data("checked",i),delete t.metadata().checked;var s=this._isFloatingMenu(t,!0);if(s&&"splitmenu"!=t.attr("mtype"))return void t[i?"addClass":"removeClass"](this._CHECK_SELECTION_ICON);var u=e(".ui-zmenu-icon-layout",t).children(":first");u.removeClass(this._DEFAULT_ICONS[n?"CHECK_BOX_CHECKED_ICON":"RADIO_BUTTON_CHECKED_ICON"]),u.removeClass(this._DEFAULT_ICONS[n?"CHECK_BOX_NOT_CHECKED_ICON":"RADIO_BUTTON_NOT_CHECKED_ICON"]),u.removeClass(this._CHECK_SELECTION_ICON);var a=t.metadata(),r=a.icon,o=this._getRelatedIcon(t);r?(u=u.parent(),u[-1!=o.indexOf(this._CHECK_SELECTION_ICON)?"addClass":"removeClass"](this._CHECK_SELECTION_ICON)):u.addClass(o)},_defaultFixCheckIcon:function(e,t){"undefined"==typeof t&&(t=!this._isChecked(e)),this._fixCheckIcon(e,t)},_fixCheckRadio:function(t,i){var n=e(t).attr("name");if(!n)return this._defaultFixCheckIcon(t);var s=t.closest(".ui-zmenu"),u=this,a=s.find("li[inputtype=radio][name="+n+"]");a.filter(function(){return e(this).data("checked")});var r=t;a.each(function(t,n){n=e(n),i&&u._isChecked(n)&&(r=n),u._fixCheckIcon(n,!1)}),u._fixCheckIcon(r,!0)},_check:function(e,t,i,n){var s=this._getInputType(e);if(this._isCheckBoxOrRadioButton(e))switch(s){case this._MENU_ITEM_TYPES.CHECK_BOX:this._defaultFixCheckIcon(e,t);break;case this._MENU_ITEM_TYPES.RADIO_BUTTON:this._fixCheckRadio(e)}n&&(i?i&&i.fromDataBinding&&e.trigger("element_state_changed",{checked:e.data("checked")?!0:!1}):e.trigger("element_state_changed",{checked:e.data("checked")?!0:!1}))},_isDisabled:function(e){var t=e.attr("disabled")?e.attr("disabled"):!1;return t},_checkAndDisableMenuItem:function(e,t){var i=this._isDisabled(e),n="ui-state-disabled";e[i?"addClass":"removeClass"](n),t||this._triggerEvent(this._EVENTS.ONMENUITEMDISABLED,void 0,this.element,e)},_disableMenuItem:function(t,i){var n="string"==typeof t?e("#"+t,this.element):e(t);i?n.removeAttr("disabled"):n.attr({disabled:!i}),this._checkAndDisableMenuItem(n);var s=n.data("subsplit");s&&this._disableMenuItem(s,i),n.trigger("element_state_changed",{disabled:i?!1:!0,checked:n.data("checked")?!0:!1})},_isBaseMenu:function(e){return!e||e.get(0)==this.element.get(0)},_isExternalSubmenu:function(e){return e.metadata().isExternalSubMenu},_triggerEvent:function(t,i,n,s,u){var a=this._isBaseMenu(n),r={orgEvent:i,currentTarget:this._currentTarget,target:this._target?this._target:n.data("target"),offset:this.element.offset(),menu:n,isBaseMenu:a};return s&&(r.menuitem=s),u&&(r=e.extend({},r,u)),this._isExternalSubmenu(n)&&-1!=t.indexOf("sub")&&n.zmenu("triggerEvent",t.replace("sub",""),i,r),this._trigger(t,i,r)},triggerEvent:function(e,t,i){return this._trigger(e,t,i)},_getLastAppendableElement:function(e){var t=e.metadata().parent.closest(".ui-zmenu"),i=t.metadata().sliders;if(i&&i.length){if(i.bottom)return i.bottom;if(i.top)return i.top}return t},_setFocus:function(){var e=this,t=function(){e.element.focus()};setTimeout(t,100)},show:function(t,i,n){var s=this.options.appendTo,u=!1,a=void 0!==this.options.width?this.options.width:"auto",r={};if(this.options.fixed||(t&&(r.target=t.target,r.currentTarget=t.currentTarget),i?i.data("target",t.target):(this._target=t.target,this._currentTarget=t.currentTarget)),i){if(u=!0,i.is(":visible"))return;if(!i.length)return;i.insertAfter(this._getLastAppendableElement(i)),this._initEvents(i)}else{if(i=this.element,this._initRuntimeEvents(),i.is(":visible")&&!n)return;this.options.fixed||(void 0!==s&&s.length?s.append(i):e("body").append(i)),this._setFocus()}var o=this._isFloatingMenu(i);if(o||i.width(a),this.updateLastMenuChain(i),this.options.fixed)i.show();else{var l=t?t.event:void 0,h=this._triggerEvent(this._EVENTS[u?"ONBEFORESUBMENUSHOW":"ONBEFORESHOW"],l,i,void 0,r);if(0==h)return;if(t.target&&t.isSplitMenu&&!t.target.is(":visible"))return;if(i.fadeIn(200),this.refresh(i),this._fixMenuUI(i,t,u),t){t.isRightClick&&i.attr("position","after_pointer");var d=e.ZContextMenu.getMenuPosition(i,t.target,t.event,s);t.left=d.left,t.top=d.top,this._positionMenu(i,t,u)}this.options.skipHighlightTarget&&(r.skipHighlightTarget=this.options.skipHighlightTarget),this._triggerEvent(this._EVENTS[u?"ONSUBMENUSHOW":"ONSHOW"],l,i,void 0,r)}if(!o){var m=i.innerWidth()+1,c=e.ZContextMenu.scrollWidth;i.width(i.hasClass("ui-zmenu-scroll")?m+c:m)}this._resetMenuTextArray(i)},refresh:function(e){e=e?e:this.element,this._fixMenuItemsWidth(e)},_fixMenuUI:function(e,t,i){e.is(":visible")&&(this._fixMenuHeight(e,t),this._positionMenu(e,t,i),e.scrollTop(0))},_resetMenuTextArray:function(t){this._menuTextArray=[],this._prevSearchKey="",this._prevKeydownTime="",this._prevSearchIndex="",this._prevSearchTimer=void 0;var i=":visible[mtype!=separator][mtype!=custom][disabled!=disabled]";this.options.fixed&&(i="[mtype!=separator][mtype!=custom][disabled!=disabled]");for(var n=t.children(i),s=0;s<n.length;s++)if(e(n[s]).hasClass("ui-zmenu-group-wrapper"))for(var u=e(n[s]).children(":visible").children(":visible[mtype!=separator][mtype!=custom][disabled!=disabled]"),a=0;a<u.length;a++)this._menuTextArray[this._menuTextArray.length]={text:e(u[a]).metadata().label,menuitem:e(u[a])};else this._menuTextArray[this._menuTextArray.length]={text:e(n[s]).metadata().label,menuitem:e(n[s])}},hide:function(t){if(!this.options.fixed){var i=!1;if(t&&t.length){i=!0,t=e(t),t.off(".sub"+this.widgetName);var n=t.metadata().parent;n&&!t.metadata().isExternalSubMenu&&n.append(t)}else t=this.element,this._hideAllSubMenus(),this._destroyRuntimeEvents();if(t=e(t),e("li.ui-zmenu-item-hover",t).each(function(t,i){e(i).removeClass("ui-zmenu-item-hover")}),t.get(0)!=this.element.get(0)?this.updateLastMenuChain(t.parent().parent()):this._lastOverlayedMenuItem=void 0,!t.is(":hidden")){if(this._triggerEvent(this._EVENTS[i?"ONBEFORESUBMENUHIDE":"ONBEFOREHIDE"],void 0,t),this._uninitSliders(t),this._isFloatingMenu(t)?null:t.width(t.innerWidth()+1+e.ZContextMenu.scrollWidth),t.hide(),i){var s=e(t.metadata().parent).parent();s.hasClass("ui-zmenu-group-base")&&(s=s.parent().parent()),this._resetMenuTextArray(s)}else this._resetMenuTextArray(t);t.css({top:"",left:"",height:"",width:""}),this._triggerEvent(this._EVENTS[i?"ONSUBMENUHIDE":"ONHIDE"],void 0,t)}}},_attrNames:["id","name","mtype","inputtype","disabled","data-association","data"],addMenuItem:function(t,i,n){var s=e("<li>"),u=e(this.element);t.menu&&t.menu.length&&"object"==typeof t.menu&&(u=e(t.menu).is("ul")?t.menu:e(t.menu).children("ul"));var a=void 0,r=u.children("li");if("undefined"!=typeof t.pos&&r.length){var o=!1;t.pos>=r.length&&(t.pos=r.length-1,o=!0),t.pos<=0&&(t.pos=0),a=e(r.eq(t.pos)),a.hasClass("ui-zmenu-group")&&u.hasClass("ui-zmenu-group-base")?1===r.length?u.append(s):s.insertAfter(a):s[o?"insertAfter":"insertBefore"](a)}else u.append(s);var l=t.mtype;if(s.attr("mtype",l),"separator"!=l){e(this._attrNames).each(function(e,i){t[i]&&s.attr(i,t[i]+"")});var h=s.metadata(),d=this;for(var m in t)-1==e.inArray(m,d._attrNames)&&"menuItems"!=m&&"onclick"!=m&&t[m]&&(h[m]=t[m]);if(this._fixClick(s,t.onclick),"object"==typeof t.menuItems){var c=e("<ul>");c.metadata().type=t.type,s.append(c),e(t.menuItems).each(function(e,t){t.menu=c,t.internal=!0,d.addMenuItem(t,void 0,n)})}else n&&n(s,t)}else t.id&&s.attr("id",t.id),t.isGroupSep&&s.attr("groupSep",t.isGroupSep);if(t.checked&&s.data("checked",t.checked),t.hidden&&s.data("hidden",t.hidden),t.internal||(this._buildMenuItem(s,u),this._isGroup(u.parent())&&this._buildGroupItem(s,u.parent().attr("id"))),t.attr&&s.attr(t.attr),t.title&&s.attr("title",t.title),t.html){var _=t.html.content,p=t.html.replaceWithText;if(_){var f=void 0;if(p)s.find(".ui-zmenu-text").html(_),f=s.find(".ui-zmenu-text");else{var v=this._getIconHolderForMenuItem(s);v.html(_),v.css({background:"none"}),f=v}f.css({width:"auto",height:"auto",position:"relative",left:"0px",top:"0px"})}}var g=t.externalAssociation;g&&s.data("externalAssociation",g);var M=t.iconText;if(M){s.metadata().iconText=M}var I=t.splitButtonData;return I&&s.data("relatedButton",I),i||this._fixMenuUI(u),s},addMenuItems:function(t,i){var n=this,s=[];return e(t).each(function(e,t){var u=n.addMenuItem(t,!0,i);s.push(u)}),this._fixMenuUI(this.element),s},removeMenuItem:function(t){t=-1!=t.indexOf("#")?t.replace("#",""):t,this.hide(),e("#"+t,this.element).remove(),this._fixMenuUI(this.element)},removeAllMenuItems:function(t,i,n){t=t?t:this.element;var s=null,u=n?":not(.ui-zmenu-group)":"";s=e(t).is("li")?e(t).children("ul").children(u):e(t).children(u),s&&(this._removeAllMenuItems(s,i),this._resetMenuItemsWidthAndHeight(t.closest(".ui-zmenu")))},_removeAllMenuItems:function(t,i){var n=this;e(t).each(function(t,s){s=e(s);s.metadata();if(n._isSubMenuItem(s)){var u=n._getSubMenu(s);n._isExternalSubmenu(u)?i||u.zmenu("removeAllMenuItems",u):(n.removeAllMenuItems(u),u.remove())}s.remove()})},_resetMenuItemsWidthAndHeight:function(e){e.height("auto"),e.find("ul").width("auto"),e.find("li:not(.ui-zmenu-group-wrapper .ui-zmenu-group)").width("auto"),this.refresh(e)},disableMenuItem:function(e,t){var i=this._getMenuItemId(e);return i.length?this._disableMenuItem(i,t):void 0},_itemsWidthStateChanged:!1,_hideMenuItem:function(e,t){var i=this._getMenuItemId(e);i.length&&i[t?"show":"hide"]();this.element.is(":visible");return this._showOrHideCorrespondingSep(i,t),this._itemsWidthStateChanged=!0,i.trigger("element_state_changed",{visible:t?!0:!1,disabled:this._isDisabled(i),checked:i.data("checked")?!0:!1}),i},_showOrHideCorrespondingSep:function(e,t){var i=t?"":":visible",n=e.prevAll(".ui-zmenu-separator"+i),s=e.nextAll(".ui-zmenu-separator"+i+":first");if(n.length&&s.length)e.prevAll(t?":first":":visible:first").is(".ui-zmenu-separator")&&e.nextAll(t?":first":":visible:first").is(".ui-zmenu-separator")&&e.nextAll(".ui-zmenu-separator"+(t?":first":":visible:first"))[t?"show":"hide"]();else if(n.length){var u=e.prevAll(t?":first":":visible:first"),a=e.next(".ui-zmenu-item"+i),r=t?!0:0==a.filter(":visible").length;r&&u.is(".ui-zmenu-separator")&&u[t?"show":"hide"]()}else{var o=e.nextAll(t?":first":":visible:first"),l=e.prev(".ui-zmenu-item"+i),h=t?!0:0==l.filter(":visible").length;h&&o.is(".ui-zmenu-separator")&&o[t?"show":"hide"]()}},hideMenuItem:function(e){this._hideMenuItem(e)},showMenuItem:function(e){this._hideMenuItem(e,!0)},hideAllMenuItems:function(){var t=e(this.element).find("li:not(.ui-zmenu-group-wrapper)");this._hideMenuItems(t)},showAllMenuItems:function(){var t=e(this.element).find("li");this._hideMenuItems(t,!0)},_hideMenuItems:function(t,i){var n=this;e(t).each(function(e,t){var s=n._hideMenuItem(t,i);i&&n._isSubMenuItem(s)&&n._hideMenuItems(s.find("li"),i)})},hideMenuItems:function(e){this._hideMenuItems(e)},showMenuItems:function(e){this._hideMenuItems(e,!0)},_getGroupArrSelector:function(t,i){var n="string"==typeof t?[t]:t,s=i?"!":"",u="",a=n.length;return e.each(n,function(e,t){u+="li[gname"+s+"="+t+"]",e!=a-1&&(u+=",")}),u},_hideMenuGroup:function(t,i){var n=this._getGroupArrSelector(t),s=e(n,this.element);this._hideMenuItems(s,i)},hideMenuGroup:function(e){this._hideMenuGroup(e)},showMenuGroup:function(t,i){var n="string"==typeof t?[t]:t;if(i){var s=this._getGroupArrSelector(t,!0),u=e(s,this.element);this._hideMenuItems(u)}this._hideMenuGroup(n,!0)},_disableMenuItems:function(t,i){var n=this;e(t).each(function(e,t){n._disableMenuItem(t,i)})},disableMenuItems:function(e){this._disableMenuItems(e)},enableMenuItems:function(e){this._disableMenuItems(e,!0)},_disableMenuGroup:function(t,i){var n=e("[gname="+t+"]",this.element);this._disableMenuItems(n,i)},disableMenuGroup:function(e){this._disableMenuGroup(e)},enableMenuGroup:function(e){this._disableMenuGroup(e,!0)},getItemCount:function(){return e(this.element).children(".ui-zmenu-item,.ui-zmenu-splitmenu").length},check:function(e,t){var i=this._getMenuItemId(e);return i&&i.length>0?this._check(i,t):void 0},_uncheckAllItems:function(t){var i=t.children("[inputtype=radio],[inputtype=checkbox]");i.filter(function(){return e(this).data("checked")});var n=this;i.each(function(t,i){i=e(i),n._fixCheckIcon(i,!1)})},checkAllItems:function(t,i){var n=this.element;if(!t)return this._uncheckAllItems(n);i=i?i:n.find("[inputtype=checkbox],[inputtype=radio]");var s=this;i.each(function(i,n){s.check(e(n),t)})},_getIconHolderForMenuItem:function(e){return e.find(".ui-zmenu-icon-inner")},getIconHolderForMenuItem:function(t){var i="object"==typeof t?t:e("#"+t,this.element);return this._getIconHolderForMenuItem(i)},getAllIconHolders:function(t){var i=t?[]:{},n=this;return this._getAllMenuItems().each(function(s,u){u=e(u);var a=t?s:u.attr("id"),r=n._getIconHolderForMenuItem(u);i[a]={icon:r,item:u}}),i},getIconHolderForMenuItems:function(t){var i=[],n=this;return e(t).each(function(e,t){i[i.length]=n.getIconHolderForMenuItem(t)}),i},_getMenuItemAsObject:function(t){var i=this,n={};e(this._attrNames).each(function(e,i){var s=t.attr(i);s&&(n[i]=s)});var s=t.metadata(),i=this;for(var u in s)-1==e.inArray(u,i._attrNames)&&"menuItems"!=u&&s[u]&&(n[u]=s[u]);if(this._isSubMenuItem(t)){var a=this._getSubMenu(t);a&&(n.menuItems=this._getMenuAsObject(a))}return n},_getMenuAsObject:function(t){t||(t=this.element);var i=this,n=t.children(),s=[];return n.each(function(t,n){s.push(i._getMenuItemAsObject(e(n)))}),s},getMenuAsObject:function(){return this._getMenuAsObject()},getMenuItemAt:function(e,t){return t||(t=this.element),t.find(".ui-zmenu-item[mtype!=separator][mtype!=group]:eq("+e+")")},getMenuItemAsObjectAt:function(e,t){return this._getMenuItemAsObject(this.getMenuItemAt(e,t))},showMenuItemAsSelected:function(e,t){this._animate=!1,this._handleMouseOverOnMenuItems(this.getMenuItemAt(e,t),void 0,!0),this._animate=!0},_hoverOnMenuItem:function(e){e.trigger("mouseover")},hoverPreviousMenuItem:function(){this._hoverOnMenuItem(this._getNextMenuItem(!0))},hoverNextMenuItem:function(){this._hoverOnMenuItem(this._getNextMenuItem())},hoverMenuItemWithLableStartingWith:function(t){var i=this.element.children(":visible"),n=!1;return e(i).each(function(i,s){return s=e(s),0==s.text().indexOf(t)?(n=e(s),!1):void 0}),n?this._hoverOnMenuItem(n):this._lastOverlayedMenuItem&&(this._lastOverlayedMenuItem.trigger("mouseout"),this._lastOverlayedMenuItem=void 0),n},handleKeyCode:function(t){var i=this._isFloatingMenu();switch(t){case e.ui.keyCode.UP:this._getNextMenuItem(!0).trigger("mouseover");break;case e.ui.keyCode.DOWN:this._getNextMenuItem().trigger("mouseover");break;case e.ui.keyCode.RIGHT:var n=(this._lastOverlayedMenuItem.nextAll(":visible.ui-zmenu-item,.ui-zmenu-group-wrapper").not(".ui-zmenu-separator,.ui-zmenu-group"),this._getSubMenu(this._lastOverlayedMenuItem)),s=this._lastOverlayedMenuItem.closest(".ui-zmenu");if(i||!n.length&&s.hasClass("ui-zmenu-floating")){var u=void 0;this._getNextMenuItem(u,u,u,t).trigger("mouseover");break}if(this._lastOverlayedMenuItem.is(".ui-state-disabled"))return;if(this._isSubMenuItem(this._lastOverlayedMenuItem)){var s=this._getSubMenu(this._lastOverlayedMenuItem);if(!s)return;this.show({target:this._lastOverlayedMenuItem},s),this._lastOverlayedMenuItem=void 0,this._getNextMenuItem(!1,!0).trigger("mouseover")}break;case e.ui.keyCode.LEFT:var s=this._lastOverlayedMenuItem.closest(".ui-zmenu-group-base");s.length||(s=this._lastOverlayedMenuItem.closest(".ui-zmenu"));var a=s.find(":visible.ui-zmenu-item,.ui-zmenu-group-wrapper").not(".ui-zmenu-separator,.ui-zmenu-group").filter(":first"),r=a.position().left,o=this._lastOverlayedMenuItem.position().left,l=o>r?!1:!0;if(i||!l){var u=void 0;this._getNextMenuItem(!0,u,u,t).trigger("mouseover");break}this._isMenuMainMenu(this._lastOverlayedMenu)||this._hideLastShownMenu();break;case e.ui.keyCode.ESCAPE:this.options.fixed||(this._isMenuMainMenu(this._lastOverlayedMenu)?this.hide():this._hideLastShownMenu());break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this.selectHoveredMenuItem();break;default:alphaNumericKey=String.fromCharCode(t),this._menuTextArray.length&&this._callMenuitemSearch(alphaNumericKey,(new Date).getTime())}},_callMenuitemSearch:function(e,t){var i=!1;""!==this._prevKeydownTime&&t-this._prevKeydownTime>700?(i=this._prevSearchKey==e?!0:!1,this._prevSearchKey=e):this._prevSearchKey=this._prevSearchKey+e,this._prevKeydownTime=t,this._menuitemSearch(i)},_menuitemSearch:function(t){var i=new RegExp("^"+this._prevSearchKey.replace(/[|()\[{.+*?$\\]/g,"\\$0"),"i"),n=t&&this._prevSearchIndex<this._menuTextArray.length?this._prevSearchIndex+1:0;for(n=n>0&&n<this._menuTextArray.length?n:0,x=n;x<this._menuTextArray.length;x++)if(this._menuTextArray[x].text.match(i)){this._prevSearchIndex=x;var s=!1;for(y=x+1;y<this._menuTextArray.length;y++)this._menuTextArray[y].text.match(i)&&(s=!0);return s||(this._prevSearchIndex=-1),void this._handleMouseOverOnMenuItems(e(this._menuTextArray[x].menuitem),void 0,!0)}},selectHoveredMenuItem:function(){var t=this._lastOverlayedMenuItem;return t&&e(t).trigger("click"),this.hide(),t?t:!1},getSplitMenuItem:function(e){return e.hasClass(".ui-zmenu-subsplit")?e.prev(".ui-zmenu-item"):e.closest(".ui-zmenu-splitgroup").find(".ui-zmenu-item")},bindKeys:function(e){this.options.bindKeys=e},_disable:function(e,t){var i=this;e=e?e:this.element,this._getAllMenuItems().each(function(e,n){i._disableMenuItem(n,t)})},disable:function(e){this._disable(e)},enable:function(e){this._disable(e,!0)},changeIcon:function(t,i){var n=this._getMenuItemId(t);if(n.data("fromMenuItemChange",!0),i=i.primary?i.primary:i){var s=this._getIconHolderForMenuItem(n);s.attr("class","ui-icon ui-zmenu-icon-inner "+i)}var u=e(n.metadata().relatedButton).data("fromButtonChange");u||this._triggerEvent(this._EVENTS.ONICONCHANGE,void 0,this.element,n,{icon:i})},_getMenuItemId:function(t){if("string"!=typeof t)return e(t);var i=-1!=t.indexOf("#")?t:"#"+t;return this.element.find(i)},changeLabel:function(t,i){var n=this._getMenuItemId(t);if(n.length){i=n.metadata().ellipsis?i+"...":i,n.data("fromMenuItemChange",!0),i&&n.find(".ui-zmenu-text").text(i);var s=e(n.metadata().relatedButton).data("fromButtonChange");s||this._triggerEvent(this._EVENTS.ONLABELCHANGE,void 0,this.element,n,{label:i})}},setPlaceHolderDimesion:function(e,t){t=t?t:this.element;var i=t.find(".ui-zmenu-icon-placeholder");t.hasClass("ui-zmenu-icononly")&&t.hasClass("ui-zmenu-floating")?i.css(e):t.hasClass("ui-zmenu-icontext-floating")&&(i.css(e),t.find(".ui-zmenu-text-placeholder").css({width:e.width}))}}),e.ui.zmenu.createMenu=function(t,i,n){var s=e("<ul>").attr({id:t}).hide(),u=void 0;"object"==typeof n&&(n.menuClass&&s.addClass(n.menuClass),n.appendTo&&(u=n.appendTo)),s=s.zmenu(n),s.zmenu("addMenuItems",i,n?n.addItemCallback:void 0);var a=e("body");return void 0!==u&&""!==u&&(u=-1!=u.indexOf("#")?u:"#"+u,a=e(u)),a.append(s),s}}(jQuery);
!function(t){var e={widgetEventPrefix:"tab",_tabs:void 0,_selectedTabIndex:0,_selectedTab:void 0,_left:0,_tabsMain:void 0,_isMenuTab:!1,_EVENTS:{ONMOUSEOVERTAB:"mouseover",ONMOUSEOUTTAB:"mouseout",ONCLICKTAB:"click",ONADDTAB:"add",ONBEFORESELECTTAB:"beforeselect",ONSELECTTAB:"select",ONBEFOREDELETETAB:"beforedelete",ONDELETETAB:"delete",ONBEFOREHIDETAB:"beforehide",ONHIDETAB:"hide",ONBEFOREUNHIDETAB:"beforeunhide",ONUNHIDETAB:"unhide",ONBEFOREDISABLETAB:"beforedisable",ONDISABLETAB:"disable",ONBEFOREENABLETAB:"beforeenable",ONENABLETAB:"enable",ONSORTTAB:"sort",ONBEFOREEDITLABEL:"beforeeditlabel",ONEDITLABEL:"editlabel",ONBEFOREUPDATELABEL:"beforeupdatelabel",ONUPDATELABEL:"updatelabel",ONDROPDOWNCLICK:"dropdownclick"},_create:function(){if(this.options.toolbarButtonsetLabelPosition=this.options.toolbarButtonsetLabelPosition||this.element.attr("toolbarButtonsetLabelPosition"),this._lastHoverTab=void 0,this._tabMenuArray=[],this.options=t.extend({},t.ui.ztab.defaults,this.options),this._initContainer(),this._hiddenOnInitTabs=[],this._initTabs(),this._isMenuTab){var e="ui-ztabs-editor "+(t.ui.directionIsRTL?" zmenu___rtl ":"");this.element.addClass(e)}this._initTabSliders(),this._firstEleDiv&&this._tabsMain.css("left",this._firstEleDiv.width()),this._bindEvents(),this.options.selectTabOnInit?this.selectTab(this._selectedTabIndex,!0):this._selectedTabIndex=-1;var i=this;t(this._hiddenOnInitTabs).each(function(t,e){i._hideTab(e)}),this._hiddenOnInitTabs.splice(0,this._hiddenOnInitTabs.length),this._hiddenOnInitTabs=void 0},_initContainer:function(){this.element.addClass("ui-tabs ui-widget ui-widget-content "+(this.options.vertical?"ui-tabs-vertical":"ui-tabs-horizontal")),this._tabsPanel=t("<div>").attr("class","ui-tabs-panel ui-widget-content ui-ztabs-label-"+this.options.toolbarButtonsetLabelPosition);var e=this.element.children("*:not(ul, [ttype=custom])"),i=this;e.each(function(t,e){i._tabsPanel.append(e)}),this.element.append(this._tabsPanel)},_setBaseContainerHeight:function(){if(!this.options.vertical){var t=this._tabsPanel.outerHeight(!0)-this._tabsPanel.height();t=0;var e=this.element.height()-this._innerPanel.outerHeight(!0)-t;this._tabsPanel.height(e)}},_bindEvents:function(){var e=t.ui.ztab.allowedMouseOperations,i=this.options.selectTabOn;this.options.selectTabOn=i=-1!=t.inArray(i,e)?i:e[0];var a=this,s=function(t){a._tabSelected(t,a)};this._tabsMain.on(i+"."+this.widgetName,s),this.options.allowKeyBind&&t(this._tabsMain).on("keydown",function(e){var i=t(a.element).hasClass("ui-state-disabled")||t(e.target).attr("disabled");return i?!1:void a._keyPress(e)}),this._isMenuTab&&(t(document).on("menushow.ztab",function(e,i){var s=t(i.menu).attr("id");if(-1!=t.inArray(s,a._tabMenuArray)){var n=t("#"+t("#"+s).data("tabId")),l=t(i.menu).outerWidth(!0),r=n.innerWidth();n.children(".ui-tab-before").remove();var o={width:l-r};t.ui.directionIsRTL?o.right=r:o.left=r,n.prepend(t("<div class='ui-tab-before'>").css(o)),a._tabMenuIsOpened=!0}}),t(document).on("menuhide.ztab",function(e,i){var s=t(i.menu).attr("id");-1!=t.inArray(s,a._tabMenuArray)&&(a._tabMenuIsOpened=!1)}))},_initTabs:function(){this._tabsMain=t("ul:first",this.element),this._tabsMain.addClass("ui-ztab ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header"),this._tabs=t(this._tabsMain).children("[ttype!=custom]");var e=this,i=0;if(this._selectedTabIndex=0,t(this._tabsMain).children(".ui-ztab-menu-only")&&(this._selectedTabIndex=t(this._tabsMain).children("[ttype!=custom]:not(.ui-ztab-menu-only):eq(0)").index()),this._tabs.each(function(){e._initTab(t(this),i++)}),this._isMenuTab&&this.element.addClass("ui-ztab-menutab"),this.options.sortable)try{var e=this;this._tabsMain.sortable({cursor:"move",axis:e.options.vertical?"y":"x",update:function(i,a){e._triggerEvent(e._EVENTS.ONSORTTAB,t(a.item[0])),e._refreshTabs()},containment:e._innerPanel})}catch(t){}this._tabsMain.on("dblclick."+this.widgetName,function(t){e._handleEditTabLabel(t)}),this._tabs=t(this._tabsMain).children("[ttype!=custom]")},_handleEditTabLabel:function(e){var i=t(e.target),a=i.is("li")?i:i.closest("a").closest("li");if(!a.length||this._isDisabled(a))return!1;if(!a.metadata().editable)return!1;var s=this._triggerEvent(this._EVENTS.ONBEFOREEDITLABEL,a);if(s){var n=i.closest("a"),l=t("<input>").attr("type","text").css({width:n.outerWidth(),height:n.height()}).val(n.text()).addClass("ui-tabs-label-text");n.hide(),l.insertAfter(n),l.select();var r=this;l.on("blur change",function(){l.off("blur").off("change"),r._updateLabel(a,l.val()),n.show(),l.remove()}),this._triggerEvent(this._EVENTS.ONEDITLABEL,a)}},_updateLabel:function(e,i){var a=this._triggerEvent(this._EVENTS.ONBEFOREUPDATELABEL,e,{value:i});if(a)var a=(t("a",t(e)).text(i),this._triggerEvent(this._EVENTS.ONUPDATELABEL,e,{value:i}))},_getRelatedTabPane:function(e){if(!e.hasClass("ui-ztab-menu-only")){var i=e.metadata(),a=this,s=t("a",e).off("click").on("click",function(t){t.stopPropagation(),t.preventDefault(),a._tabSelected(t,a),a.element.trigger("click")}).attr("href");if(void 0===i.relatedTabPane&&""!==s&&(e.metadata().relatedTabPane=s),s=s?s:i.relatedTabPane,-1!=s.indexOf("#")){var n=s.split("#");s="#"+n[n.length-1]}}return t(s,this.element)},_initTab:function(e,i){var a=e.metadata();e.hasClass("filemenu")&&e.addClass("ui-ztab-menu-only"),t.ui.shortcutkeys&&t.ui.shortcutkeys.register(e);var s=this._getRelatedTabPane(e),n=a.toolbar?a.toolbar:a.popup;s.attr("buttonsetLabelPosition",this.options.toolbarButtonsetLabelPosition);var l=this;if(n){var r=a.toolbar?"toolbar":"popup";this._isMenuTab=!0;var o=t("<span class='ui-ztab-dropdown ui-ztab-arrow'><span class='ui-ztab-dropdown-icon ui-components-icon ui-ztab-menu'></span></span>").appendTo(e);e.hasClass("ui-ztab-menu-only")?(t("#"+n).addClass("ui-ztab-toolbar-menu ui-tabs-only"),t("#"+n).metadata().positionAlterable=!1,e.attr(r,n)):o.attr(r,n),this._tabMenuArray.push(n),l._currerntHoverTab=void 0,o.hover(function(){l._isDisabled(t(this))||(o.addClass("ui-ztab-dropdown-hover"),l._tabMenuIsOpened&&(l._lastHoverTab&&l._lastHoverTab[0]!=o[0]||!l._lastHoverTab)&&o.trigger("click"),l._currerntHoverTab=o)},function(){l._lastHoverTab=o,o.removeClass("ui-ztab-dropdown-hover")}),o.on("click",function(t){if(!e.hasClass("ui-ztab-menu-only")){l._selectedDropdown=this;var i=void 0!==t.originalEvent&&t.originalEvent?!0:!1;l._triggerEvent(l._EVENTS.ONDROPDOWNCLICK,e,{fromUI:i}),l._tabMenuIsOpened=!0}}),this._tabMenuIsOpened=!1}var h=t("a",e);if(linktext=h.text(),a.icon){h.empty();var d=t("<span/>").addClass("ui-icon "+a.icon).css({float:"left"});h.append(d),d.after(linktext)}var b=n?"ui-state-default ui-corner-top ui-tabs-nav-menu":"ui-state-default ui-corner-top ";e.metadata().contextual&&(b=b+" ui-ztab-contextual ui-ztab-contextual-"+e.metadata().group),e.addClass(b);var l=this;e.hover(function(i){if(!l._isDisabled(t(this))){if(e.hasClass("ui-state-active"))return;t(i.target).hasClass("ui-ztab-dropdown")||t(i.target).hasClass("ui-icon")?e.addClass("ui-state-hover").removeClass("ui-state-hover-hover"):e.addClass("ui-state-hover ui-state-hover-hover"),l._triggerEvent(l._EVENTS.ONMOUSEOVERTAB,e,{fromUI:!!i.originalEvent})}},function(t){l._isDisabled(e)||(e.removeClass("ui-state-hover ui-state-hover-hover"),l._triggerEvent(l._EVENTS.ONMOUSEOUTTAB,e,{fromUI:!!t.originalEvent})),e.hasClass("ui-ztab-menu-only")}),e.on("mousemove",function(i){l._isDisabled(e)||(t(i.target).hasClass("ui-ztab-dropdown")||t(i.target).hasClass("ui-icon")?e.addClass("ui-state-hover").removeClass("ui-state-hover-hover"):e.addClass("ui-state-hover ui-state-hover-hover"))}),t(s).hide(),a.index=i,a.selected&&(this._selectedTabIndex=i);var u=e.metadata();if(u.hidden&&this._hiddenOnInitTabs.push(e),u.closeable){var l=this,c=t("<span>").addClass("ui-icon ui-icon-close").click(function(){return l._isDisabled(e)?!1:void(u.hideonclose?l._hideTab(e):l._deleteTab(e,!0))});e.append(c)}this._isDisabled(e)&&this._disableTab({tab:e,enable:!1,isFromInit:!0},a.disableRelatedPane)},_clearRelatedTabProps:function(e){var i=e.metadata();t(i.relatedTabPane).hide()},_triggerEvent:function(e,i,a){var s=t(i).metadata(),n={tab:t(i),index:s.index,relatedPaneId:t(s.relatedTabPane).attr("id"),relatedPane:t(s.relatedTabPane)};return a&&(n=t.extend(n,a)),this._trigger(e,e,n)},_isDisabled:function(t){var e=t.hasClass("ui-state-disabled");return e?!0:!1},_selectTab:function(e,i,a){if(!this.element.hasClass("ui-state-disabled")&&(e=t(e),e.length)){if(e.is(":hidden")){if(!this.options.selectHiddenTabs)return!1;this._hideTab(e,!0)}var s=e.metadata();if(this._isDisabled(e))return!1;if(s.relatedTabPane&&!e.hasClass("ui-ztab-menu-only")){if(s.contextual&&this._tabsPanel.addClass("ui-ztoolbar-highlight-"+s.group),this._triggerEvent(this._EVENTS.ONCLICKTAB,e,{fromUI:a}),!i&&s.index===this._selectedTabIndex&&!this._tabExpand)return!1;var n=this._triggerEvent(this._EVENTS.ONBEFORESELECTTAB,e,{fromUI:a});if(!n)return!1;if(this._isMenuTab){var l=t(".ui-icon-collapse",this.element);l.length&&this._showhideToolbar(l)}if(this._selectedTab){this._selectedTab.metadata().selected=!1;var r=t(this._selectedTab).metadata();r.group!=s.group&&this._tabsPanel.removeClass("ui-ztoolbar-highlight-"+r.group),this._clearRelatedTabProps(this._selectedTab),t(this._selectedTab).removeClass("ui-tabs-selected ui-state-active")}e.addClass("ui-tabs-selected ui-state-active"),s.selected=!0,this._selectedTab=e,this._selectedTabIndex=s.index;var o=this._getRelatedTabPane(e);o.show();var h=o.data();null!=h&&"object"==typeof h.ztoolbar&&h.ztoolbar._isDocumentResized&&(h.ztoolbar._isDocumentResized=!1,o.ztoolbar("resizeTooolbar")),this._scrollTabToView(e),this._triggerEvent(this._EVENTS.ONSELECTTAB,e,{fromUI:a})}else{if(this._triggerEvent(this._EVENTS.ONCLICKTAB,e),!i&&s.index===this._selectedTabIndex)return!1;var n=this._triggerEvent(this._EVENTS.ONBEFORESELECTTAB,e,{fromUI:a});if(!n)return!1}}},_scrollTabToView:function(e){if(!this.options.vertical){e=t(e);var i=e.position();if(i.width=e.outerWidth(),e.outerWidth(!0)!==this._tabsMain.width()){var a=this._tabsMain.position();a.width=this._innerPanel.outerWidth()-this._lastEleDiv.width();var s=i.width+i.left,n=a.width,l=void 0,r=this._firstEleDiv,o=r.position().left+r.outerWidth();s+a.left>n?l=a.width-i.left-i.width-5:a.left+i.left<=o&&(l=o-i.left),void 0!=l&&this._animateToPosition(l)}}},_tabSelected:function(e){var i=t(e.target);if(!i.hasClass(".ui-ztab-arrow")){var a=i.is("li")?i:i.closest("a").closest("li");if(!a.length)return!1;var s=void 0!==e.originalEvent&&e.originalEvent?!0:!1;this._selectTab(a,void 0,s)}return!1},_keyPress:function(e){if(e.ctrlKey){var i=t(this.getSelectedTab()).metadata().index,a=this._tabs.length;switch(e.keyCode?e.keyCode:e.charCode){case t.ui.keyCode.RIGHT:i++;break;case t.ui.keyCode.LEFT:i--;break;case t.ui.keyCode.HOME:i=0;break;case t.ui.keyCode.END:i=a-1}0>i?i=a-1:i>=a&&(i=0),this.selectTab(i)}},_createSliderButton:function(e){var i=e?"left":"right",a=t("<div>").attr("_dir",i).addClass("ui-tabs-slider-"+i).addClass("ui-button ui-state-default ui-tabs-slider");return a.append(t("<span>").attr("_dir",i).addClass(e?"ui-scrolltab-l":"ui-scrolltab-r").addClass("ui-icon").addClass(e?"ui-icon-triangle-1-w":"ui-icon-triangle-1-e")),a.hover(function(){t(this).addClass("ui-state-hover")},function(){t(this).removeClass("ui-state-hover")}),a.hide()},_getExtraContainers:function(e){var i=this,a=t("<div>").addClass("ui-widget-content ui-ztab-custom-outer"),s=t("<div>").addClass("ui-widget-header ui-ztab-custom ui-ztab-custom-"+(e?"left":"right")).height(this._tabsMain.height()-1).append(a);if(this._isMenuTab){var n=t("<div>").attr({title:this._getString("collapse.label"),class:"ui-ztab-custom-right ui-ztab-expand ui-components-icon ui-icon-expand"}).appendTo(s);n.on("click",function(){i._showhideToolbar(n,!0)}).on("mousedown",function(){n.attr("title",i._getString(n.hasClass("ui-icon-expand")?"expand.label":"collapse.label"))})}return e?s.insertBefore(this._innerPanel):s.insertAfter(this._innerPanel),a},_showhideToolbar:function(e,i){if(this._selectedTab){relatedTabPane=this._getRelatedTabPane(t(this._selectedTab));var a=this._selectedTab.metadata();e.hasClass("ui-icon-expand")?(e.removeClass("ui-icon-expand").addClass("ui-icon-collapse"),a.contextual&&this._tabsPanel.removeClass("ui-ztoolbar-highlight-"+a.group),this._tabExpand=!0,this._selectedTab.removeClass("ui-tabs-selected ui-state-active"),relatedTabPane.ztoolbar("hide")):(e.removeClass("ui-icon-collapse").addClass("ui-icon-expand"),this._tabsPanel.removeClass("ui-ztab-toolbar-border"),i&&this._selectedTab.addClass("ui-tabs-selected ui-state-active"),a.contextual&&this._tabsPanel.addClass("ui-ztoolbar-highlight-"+a.group),this._tabExpand=!1,relatedTabPane.ztoolbar("show")),e.attr("title",this._getString(e.hasClass("ui-icon-expand")?"collapse.label":"expand.label"))}},_initTabSliders:function(){var e=t("<div>");if(this._innerPanel=e,this._sliderLeft=this._createSliderButton(!0),this._sliderRight=this._createSliderButton(),e.append(this._sliderLeft,this._tabsMain,this._sliderRight),t(e).insertBefore(t(this.element).children(":first")),e.addClass(this.options.vertical?"ui-tabs-inner-panel-v":"ui-tabs-inner-panel"),!this.options.vertical){var i=this,a=this.element.children("[ttype=custom][position=first], [ttype=custom]:not([position])");this._firstEleDiv=this._getExtraContainers(!0),this._lastEleDiv=this._getExtraContainers(),a.each(function(e,a){i._firstEleDiv.append(t(a))});var s=this.element.children("[ttype=custom][position=last]");s.each(function(e,a){i._lastEleDiv.append(t(a))}),t("div[_dir]",e).on("click",function(t){i._adjustTabs(t)}),this._sliderLeft.css("margin-left",this._firstEleDiv.width()),this._sliderRight.css("right",this._lastEleDiv.width()),t(window).on("resize."+this.widgetName,function(){i._showSliders()}),t.debounce(500,i._showSliders)}},_adjustTabs:function(e){var i=(t(e.target),this._getAlteredLeft(e));this._animateToPosition(i)},_getCorrectedLeft:function(t){var e=this._firstEleDiv.width(),i=this._getMaxLeft();return i>t&&(t=i),t>e&&(t=e),t},_animateToPosition:function(e){var i=this,a=t(this._tabsMain);a.stop(!0,!0),e=this._getCorrectedLeft(e),a.animate({left:e},1e3,function(){i._showSliders(!0)})},_getMaxLeft:function(){var t=this._tabsMain.children("li:visible:last");return t.length?(this._maxLeft=this._innerPanel.width()-(t.position().left+t.outerWidth()),this._lastEleDiv&&(this._maxLeft-=this._lastEleDiv.outerWidth()),this._maxLeft):0},_showSliders:function(e){if(!this.options.vertical)if(t.ui.directionIsRTL){var i=this._lastEleDiv.width();e||t(this._tabsMain).css("right",i)}else{var i=this._firstEleDiv.width();e||t(this._tabsMain).css("left",i);var a=this._tabsMain.position(),s=a.left+i;this._sliderLeft[s>=i?"hide":"show"]();var n=this._getMaxLeft()+i;this._sliderRight[1*s.toFixed(1)>1*n.toFixed(1)?"show":"hide"]()}},_getAlteredLeft:function(e){var i=t(e.target),a=this._tabsMain.position().left,s=i.attr("_dir"),n=(this._innerPanel,0);switch(s){case"right":n=a-100;break;case"left":n=a+100}return this._getCorrectedLeft(n)},getSelectedTab:function(){return this._tabsMain.children("li.ui-tabs-selected")},getSelectedRelatedTabPane:function(){var e=this.getSelectedTab();return t(e).metadata().relatedTabPane},_getTabAt:function(e,i){var a;return isNaN(e)?a=t("object"==typeof e?e:"#"+e):(a=i?this._tabsMain.children():this._tabs,e=!e||0>e?0:e>=a.length?a.length-1:e,a=a[e]),a},selectTab:function(t,e){this._selectTab(this._getTabAt(t,e),e)},_getTabByType:function(e){return t("[ttype="+e+"]:first",this._tabsMain)},selectTabByType:function(t,e){var i=this._getTabByType(t);return i.length?this._selectTab(i,e):void 0},showNextTab:function(){this.selectTab(t(this.getSelectedTab()).metadata().index+1)},showPrevTab:function(){this.selectTab(t(this.getSelectedTab()).metadata().index-1)},_nonDataParams:["label","relatedPaneId"],_refreshTabs:function(){this._maxLeft=void 0,this._tabs=t(this._tabsMain).children(":not([hidden]):not([ttype=custom])");var e=this;t(this._tabs).each(function(i,a){var s=t(a).metadata();s.index=i,s.selected&&(e._selectedTabIndex=i)}),this._showSliders()},_generateNewPaneId:function(){return"tab_"+this._tabs.length+this._getMaxLeft().toFixed(0)},addTab:function(e,i){var a=t("<li>"),s=this._tabs.length;!e.index||this._tabs.length-1<e.index?this._tabsMain.append(a):(s=e.index,a.insertBefore(this._tabs[e.index]));var n=t("<a>"),l=a.metadata();for(var r in e)-1===t.inArray(r,this._nonDataParams)&&(l[r]=e[r]);n.html(e.label),a.attr({ttype:e.type,id:e.id});var o=void 0;return e.relatedPaneId?o=t("#"+e.relatedPaneId):e.relatedPaneId=this._generateNewPaneId(),o&&o.length||(o=e.url?t("<iframe>").attr({id:e.relatedPaneId,src:e.url,frameborder:"0px"}).css("border","none"):t("<div>").attr("id",e.relatedPaneId)),e.relatedPane=o,n.attr("href","#"+e.relatedPaneId),this._tabsPanel.append(o),a.append(n),this._initTab(a,s),this._refreshTabs(),this._triggerEvent(this._EVENTS.ONADDTAB,a),this.options.highlightTabOnAdd&&this._highlightTab(a),i&&i(e),e.selected&&this._selectTab(a,!0),e},_deleteTab:function(e,i){if(1!==this._tabs.length){var e=t(e);if(e&&e.length){var a=this._triggerEvent(this._EVENTS.ONBEFOREDELETETAB,e);if(a){var s=this;e.height(e.height()),e.width(e.width()),e.empty(),e.animate({width:0,opacity:0},{duration:s.options.animateOnDeleteTab?300:0,complete:function(){s._removeTab(e,i)}})}}}},_removeTab:function(e,i){this._clearRelatedTabProps(e),i&&t(e.metadata().relatedTabPane).remove();var a=e.metadata().index;e.remove(),this._refreshTabs(),this._triggerEvent(this._EVENTS.ONDELETETAB,e),a===this._selectedTabIndex&&this.selectTab(a,!0)},deleteTab:function(t,e){this._deleteTab(this._getTabAt(t,!1),e)},deleteTabByType:function(t,e){var i=this._getTabByType(t);this._deleteTab(i,e)},highlightTab:function(t){this._highlightTab(this._getTabAt(t,!1))},highlightTabByType:function(t){var e=this._getTabByType(t);this._highlightTab(e)},_highlightTab:function(t){if(t&&t.length){var e=t.clone().addClass("ui-state-error"),i=t.position();e.css({position:"absolute",left:i.left,top:i.top}),e.fadeTo(0,0),t.parent().append(e),e.fadeTo(700,1,function(){e.fadeTo(700,.7,function(){e.fadeTo(700,1,function(){e.fadeTo(700,.7,function(){e.remove()})})})})}},_hideTab:function(e,i){if(e=t(e),(1!==this._tabs.length||i)&&e&&e.length){var a=e.metadata(),s=this._triggerEvent(this._EVENTS[i?"ONBEFOREUNHIDETAB":"ONBEFOREHIDETAB"],e);s&&(i||this._clearRelatedTabProps(e),a.selected=!1,this._selectedTabIndex=-1,this._selectedTab&&(this._selectedTab.metadata().group==a.group&&i||this._tabsPanel.removeClass("ui-ztoolbar-highlight-"+a.group)),a.contextual?i?e.is(":visible")||(e.css({top:"35px"}).animate({top:"0px"},{duration:1e3,easing:"easeInOutElastic"}),e.nextAll().is(":visible")&&e.nextAll().animate({left:e.innerWidth()+12},200),setTimeout(function(){e.nextAll().css({left:""}),e.show()},500)):e.is(":visible")&&(e.clearQueue().animate({top:"35px"},{duration:800,easing:"easeInOutElastic"}),e.nextAll().clearQueue().delay(300).animate({left:-(e.innerWidth()+12)}),setTimeout(function(){e.nextAll().css({left:""}),e.hide()},1e3)):e[i?"show":"hide"](),e.attr("hidden",!i),this._refreshTabs(),this._triggerEvent(this._EVENTS[i?"ONUNHIDETAB":"ONHIDETAB"],e),i&&this.options.highlightTabOnShow&&this._highlightTab(e))}},hideTab:function(t){this._hideTab(this._getTabAt(t,!0))},unhideTab:function(t){this._hideTab(this._getTabAt(t,!0),!0)},hideTabByType:function(t){var e=this._getTabByType(t,!0);this._hideTab(e)},unhideTabByType:function(t){var e=this._getTabByType(t,!0);this._hideTab(e,!0)},unhideAll:function(){var e=t(this._tabsMain).children("li:hidden"),i=this;t(e).each(function(e,a){i._hideTab(t(a),!0)})},hideTabs:function(e){var i=this;t(e).each(function(e,a){i._hideTab(t("#"+a))})},unhideTabs:function(e){var i=this;t(e).each(function(e,a){i._hideTab(t("#"+a),!0,1)})},_disableTab:function(e,i){var a=t(e.tab),s=e.enable;if(a&&a.length){var n=this._triggerEvent(this._EVENTS[s?"ONBEFOREENABLETAB":"ONBEFOREDISABLETAB"],a);if(n){t(a)[s?"removeClass":"addClass"]("ui-state-disabled"),s?t(a).removeAttr("disabled"):t(a).attr("disabled",!s);var l=t(a).find("[toolbar]");if(l.push(t(a).find("[popup]")),l.length&&t.each(l,function(e,i){s?t(i).removeClass("ui-state-disabled"):t(i).addClass("ui-state-disabled"),s?t(i).removeAttr("disabled"):t(i).attr("disabled",!s)}),i){var r=this._getRelatedTabPane(t(a));(r.data("ui-ztoolbar")||r.data("ztoolbar"))&&r.ztoolbar(s?"enable":"disable")}e.isFromInit||this._refreshTabs(),s&&this.element.removeClass("ui-state-disabled").removeAttr("disabled"),this._triggerEvent(this._EVENTS[s?"ONENABLETAB":"ONDISABLETAB"],a)}}},_getString:function(e){return t.i18n?t.i18n("ztab",e):this.options.keys[e]},disableTab:function(t,e){var i=this._getTabAt(t,!0);this._disableTab({tab:i,enable:!1},e)},disableTabByType:function(t,e){var i=this._getTabByType(t,!0);this._disableTab({tab:i,enable:!1},e)},enableTab:function(t,e){var i=this._getTabAt(t,!0);this._disableTab({tab:i,enable:!0},e)},enableTabByType:function(t,e){var i=this._getTabByType(t,!0);this._disableTab({tab:i,enable:!0},e)},disable:function(e){this.element.attr("disabled","true").addClass("ui-state-disabled"),this.element.children(".ui-tab").attr("disabled","true").addClass("ui-state-disabled");var i=this.element.find(".ui-ztab").children("li"),a=this;t.each(i,function(i,s){a._disableTab({tab:t(s),noTabClassChange:!0},e)})},enable:function(e){t(this.element).removeAttr("disabled"),t(this.element).removeClass("ui-state-disabled");var i=this.element.find(".ui-ztab").children("li"),a=this;t.each(i,function(i,s){a._disableTab({tab:t(s),enable:!0},e)})},destroy:function(){var e=this,i=t(this.element).find("[ttype=custom]");t.each(i,function(i,a){t(a).insertBefore(e.element.children(":last")).off(),t(e.element).find(".ui-ztab-custom").remove()}),t(this.element).find(".ui-tabs-slider").remove();var a=t(this.element).find(".ui-ztab");a.off().insertBefore(e.element.children(":last")),t(this.element).find(".ui-tabs-inner-panel").remove(),t.each(a.children("li"),function(e,i){t(i).removeAttr("class").off().find(".ui-icon-close").remove(),t(i).children("a").off()}),a.removeAttr("style").removeAttr("class");var s=t(this.element).find(".ui-tabs-panel");t.each(s.children(),function(i,a){t(a).removeAttr("style").insertBefore(e.element.children(":last")).off()}),s.remove(),t(this.element).removeAttr("style").removeAttr("class"),a.off("."+this.widgetName),this.element.off("."+this.widgetName),t.Widget.prototype.destroy.apply(this,arguments)}};e=t.extend({},e),t.widget("ui.ztab",e),t.ui.ztab.allowedMouseOperations=["click","mousedown","mouseup","mouseover"],t.ui.ztab.defaults={toolbarButtonsetLabelPosition:"left",sortable:!1,selectTabOn:"click",allowKeyBind:!0,selectHiddenTabs:!1,highlightTabOnShow:!1,highlightTabOnAdd:!1,animateOnDeleteTab:!0,selectTabOnInit:!0,keys:{"expand.label":"Expand Toolbar","collapse.label":"Collapse Toolbar"}}}(jQuery);
!function(t){var e={_toolbarButtons:void 0,_lastRemovedButton:void 0,options:{enableAutoResize:!0},_eleArr:[],_ctypeElems:".ui-zoom-panel,.ui-hiddenslider,.ui-zslider-panel,.ui-zstate,.ui-zspinner,.ui-ztoggle",_create:function(){this._radioButtonAsMenu=!1,this.options.buttonsetLabelPosition=this.options.buttonsetLabelPosition||this.element.attr("buttonsetLabelPosition"),this.options=t.extend({},t.ui.ztoolbar.defaults,this.options);var e="ui-ztoolbar-panel "+(t.ui.directionIsRTL?" zmenu___rtl ":"");this.element.addClass(e+" ui-ztoolbar-label-"+this.options.buttonsetLabelPosition),this._isDocumentResized=!1,this._fixToolbarWidth(),this._initItems(),this._eleArr=[],this._addEvents();var n=this,i=function(){n._onDocumentResized()};setTimeout(i,500)},widgetEventPrefix:"toolbar",_EVENTS:{ONINIT:"init",ONBUTTONCLICKED:"buttonclicked",ONTOOLBARSHRINK:"shrank",ONTOOLBAREXPAND:"expanded",ONBUTTONDOUBLECLICKED:"buttondblclicked",ONTOOLBARHIDE:"hide",ONTOOLBARSHOW:"show"},_addEvents:function(){var e=this;if(e.options.enableAutoResize){var n=function(){t(window).on("resize."+e.widgetName,t.debounce(500,function(t){e._onDocumentResized(t)}))};setTimeout(n,100)}this.element.on("click."+this.widgetName,function(t,n){t.data=n,e._fireEvent(t,e)}),this.element.on("dblclick."+this.widgetName,function(t,n){t.data=n,e._fireEvent(t,e)}),this._triggerEvent(this._EVENTS.ONINIT,!1,this.element)},_parseAndFixGroups:function(){var e=this.element.children("[ttype=group]");e.each(function(e,n){n=t(n);var i=n.children();i.each(function(e){var o=t(i[i.length-1-e]);o.insertAfter(n),o.attr("gname",n.attr("id"))}),n.remove()})},_initItems:function(){this._toolbarButtons=this.element.children();var e=t("<div>").addClass("ui-ztoolbar-inner-panel");this.element.append(e),this._toolbarButtons.each(function(t,n){e.append(n)}),this.innerPane=e;var n=this._toolbarButtons.filter(":not([ctype],select)"),i=this;n.each(function(e,n){var o=t(n),s=o.metadata();s.buttonset?(s.noseparator?o.addClass("ui-buttonset-nosep"):o.next().length||o.addClass("ui-buttonset-nosep"),o.zbutton({iconScope:"ui-components-toolbar-icon",labelPosition:i.options.buttonsetLabelPosition}),s.label&&"bottom"===i.options.buttonsetLabelPosition&&t("<span>").attr("class","ui-group-text").text(s.label).appendTo(o)):"custom"!==o.data("uitype")&&(o.is("select")?i._initCombo(o):o.zbutton({iconScope:"ui-components-toolbar-icon"}))});var o=this._toolbarButtons.children("select:not([ctype])");this._initCombo(o)},_initCombo:function(e){e.each(function(e,n){var i=t(n).metadata().componentOptions;t(n).zcombo(i)})},_registerShortcutkey:function(e){t.ui.shortcutkeys&&e.length&&(shortcut=t.ui.shortcutkeys.register(e))},_getLastEle:function(){return t(this.innerPane).children(":visible").last()},_fixToolbarWidth:function(){this.element.css("width",this.element.parent().width())},_getOffsets:function(e){e||(e=this._getLastEle());var n=t.ui.directionIsRTL?0:e.outerWidth(),i=e.length>0?Math.round(e.offset().left+n):0,o=Math.round(this.element.width()+this.element.offset().left);return{buttonEnd:i,toolbarEnd:o}},_isInBounds:function(){var e=this._getOffsets();return t.ui.directionIsRTL?e.buttonEnd>0:e.toolbarEnd>e.buttonEnd},_onDocumentResized:function(){return this.element.is(":hidden")||!t(this.innerPane).is(":visible")?void(this._isDocumentResized=!0):(this._fixToolbarWidth(),void(this._isInBounds()?(this._expandToolbar(),this._triggerEvent(this._EVENTS.ONTOOLBAREXPAND,!1,this.element)):(this._shrinkToolbar(),this._triggerEvent(this._EVENTS.ONTOOLBARSHRINK,!1,this.element))))},resizeTooolbar:function(){this._onDocumentResized()},_isButtonInButtonSet:function(e){return e.length?t(e).parent().hasClass("ui-button-splitbutton")?t(e).parent().parent().metadata().buttonset:t(e).parent().metadata().buttonset:!1},_isButtonSet:function(t){return t.metadata().buttonset},_addExtendedMenuButton:function(e){if(!this.extendMenuButton){var n=this._getLastVisibleButton();this.extendMenuButton=t("<button class='ui-ztoolbar-splitmenu'>"+t.i18n("zcommon","moreoptions.label")+"</button>"),this.extendMenuButton.attr("data",'{"text": false, "icons":{"primary": "ui-icon-carat-1-e"}}'),this.extendMenuButton.zbutton();var i=this.element.attr("id")+"Menu";this.extendMenuButton.attr("popup",i),this.extendedMenuPopup=t.ui.zmenu.createMenu(i,t(e)),this.extendMenuButton.css("width","16px"),this.extendMenuButton.appendTo(t(n).parent())}},_removeExtendedMenuButton:function(){this.extendedMenuPopup.zmenu("destroy").remove(),this.extendMenuButton.button("destroy").remove(),this.extendedMenuPopup=this.extendMenuButton=void 0},_shrinkToolbar:function(){if(!this._isInBounds()){var e=this._getButton();if(!e.length)return;if(this._eleArr.push(e),this._isButtonInButtonSet(e)){var n=e.parent();n=n.metadata().innerButtonset?n.parent():n,n.hasClass("ui-button-splitbutton")&&(n=n.parent());var i=n.attr("id");if(n.hasClass("ui-zbutton-radioset")){n.zbutton("shrinkButtonSetAsMenu",n),this._eleArr.pop(e),this._eleArr.push(n);var o=i+"Menu",s=o+"Button";t("#"+o).off("menuitemclicked").on("menuitemclicked",function(t,e){var i=e.menuitem.metadata();n.zbutton("changeIcon",{primary:i.icons.primary+" ui-components-toolbar-icon"},s),n.zbutton("changeLabel",i.label,s)})}else n.zbutton("shrinkButtonSet",[e]);t("#"+i).off("element_state_changed").on("element_state_changed",function(e,n){var o=n.disabled?!1:!0;t("#"+i+"Menu").zmenu("disableMenuItem","shrinked_menuitem_"+t(e.target).attr("id"),o);var s=n.checked?!0:!1;t("#"+i+"Menu").zmenu("check","shrinked_menuitem_"+t(e.target).attr("id"),s)})}else{var u=e.zbutton("getAsObject",e,!0);e.metadata().alteredId=u.id,this.extendMenuButton?this.extendedMenuPopup.zmenu("addMenuItem",u,0):this._addExtendedMenuButton(u),e.hide();var a=this;e.off("element_state_changed").on("element_state_changed",function(e,n){var i=n.disabled?!1:!0;a.extendedMenuPopup.zmenu("disableMenuItem","shrinked_menuitem_"+t(this).attr("id"),i);var o=n.checked?!0:!1;a.extendedMenuPopup.zmenu("check","shrinked_menuitem_"+t(this).attr("id"),o)})}this._shrinkToolbar()}},_expandToolbar:function(){if(this._eleArr&&this._eleArr.length>0){var e=t(this._eleArr[this._eleArr.length-1]),n=e.outerWidth(!0),i=0;if(this.innerPane.children(":visible").each(function(){i+=t(this).outerWidth(!0)}),i+n<this.element.width()){if(this._isButtonSet(e))e.zbutton("expandButtonSet",[e],!0),e.hasClass("ui-zbutton-radioset")&&(this._radioButtonAsMenu=!1);else if(this._isButtonInButtonSet(e)){var o=e.parent();o.hasClass("ui-button-splitbutton")?o.parent().zbutton("expandButtonSet",[e]):o.metadata().innerButtonset?o.parent().zbutton("expandButtonSet",[e]):o.zbutton("expandButtonSet",[e])}else e.show(),this.extendedMenuPopup.zmenu("removeMenuItem",e.metadata().alteredId);this._eleArr.splice(this._eleArr.length-1,1),this._expandToolbar()}}this.extendedMenuPopup&&0==this.extendedMenuPopup.zmenu("getItemCount")&&this._removeExtendedMenuButton()},_isSplitButton:function(t){return t.is("div.ui-buttonset")},_getLastVisibleButton:function(){return t(this.innerPane).children(".ui-button:visible:not(.ui-buttonset-sep,.ui-splitbutton,.ui-ztoolbar-splitmenu)").last()},_getButton:function(){var e="",n=void 0,i="",o=(this._radioButtonAsMenu?".ui-buttonset:visible:not(div.ui-button-splitbutton)":".ui-zbutton-radioset:visible",this._radioButtonAsMenu?".ui-buttonset":".ui-zbutton-radioset"),s=t(this.innerPane).children(o+",.ui-zbutton-group:visible:not(.ui-buttonset-sep,div.ui-button-splitbutton)");if(t(s.get().reverse()).each(function(e,o){if(!n){var s=t(o);if(s.is(".ui-buttonset")){var u=s.children(":visible:not(.ui-group-text,.ui-buttonset-sep,.ui-extended-buttonset,input,.ui-buttonset-label, .ui-zcombo)");s.metadata().mainButtonset?t(u).each(function(e,o){return i=t(o),i.children(":visible:not(.ui-group-text,.ui-buttonset-sep,.ui-extended-buttonset,input,.ui-buttonset-label, .ui-zcombo)").length>1?void(n=i):void 0}):i=s}else i=s;return i&&i.children(":visible:not(.ui-group-text,.ui-buttonset-sep,.ui-extended-buttonset,input,.ui-buttonset-label, .ui-zcombo)").length>1?void(n=i):void 0}}),n&&(e=n.hasClass("ui-button")?n:n.children(":visible:not(.ui-group-text,.ui-buttonset-sep,.ui-extended-buttonset,.ui-buttonset-label, input)").last()),!e.length){if(!this._radioButtonAsMenu)return this._radioButtonAsMenu=!0,this._getButton();e=this._getLastVisibleButton()}return e.length?e:!1},_getCorrespondingToolbarButton:function(e){var n=e;do{if(t.inArray(n,this._toolbarButtons))return n;n=n.parent()}while(n==this.element)},_fireEvent:function(e){var n=t(e.target),i=n.is("input")?n:n.closest(".ui-button");i.is(":not(input)")&&i.is(":not(button)")||i.length&&!i.is(":disabled")&&this._triggerEvent(this._getEvent(e),e,i)},_getEvent:function(t){var e=void 0;switch(t.type){case"click":e=this._EVENTS.ONBUTTONCLICKED;break;case"mouseover":e=this._EVENTS.ONMOUSEOVER;break;case"mouseout":e=this._EVENTS.ONMOUSEOUT;break;case"dblclick":e=this._EVENTS.ONBUTTONDOUBLECLICKED}return e},_getGroupBtnAsObj:function(t,e){var n=t.attr("data"),i={};return i.data=n,i.label=t.metadata().label,e?i.submenu="#"+t.parent().attr("id")+"menu":i.mtype="group",i},_filterCtypeElems:function(e){var n=[];return t.each(e,function(e,i){var o=t(i).parent();(o.hasClass("ui-zbutton-group")||o.hasClass("ui-buttonset"))&&n.push(i)}),n},_initAsMenu:function(){var t=this.element.parent().parent().find("a[href='#"+this.element.attr("id")+"']").parent().find(".ui-ztab-dropdown");if(t){var e=this.getToolbarAsMenu();e.attr("relativeto","parent"),t.attr("popup",t.attr("toolbar")),t.removeAttr("toolbar")}},getToolbarAsMenu:function(){var e=t(this.element.children()[0]).children(":not([ctype],select,"+this._ctypeElems+",.ui-zcolorchooser)"),n=t(this.element).attr("id")+"menu",i=this;this._menuArray=new Array,t(e).each(function(e,n){var o=t(n),s=o.children().filter(":not([ctype],select,"+i._ctypeElems+",.ui-zcolorchooser,.ui-zslider-panel,.ui-buttonset-sep,.ui-buttonset-sub-sep,.ui-zcombo,.ui-buttonset-label,.ui-group-text)").length;o.hasClass("ui-buttonset")&&!s||"custom"===o.data("uitype")||i.getButtonAsObj(o,void 0)});var o=t.ui.zmenu.createMenu(n,this._menuArray,{positionAlterable:!1,menuClass:"ui-ztab-toolbar-menu"});o.on("menuitemiconchange",function(e,n){var i=n.menuitem.metadata().relatedButton,o=t(i);o.parent().hasClass("ui-buttonset")?o.parent().zbutton("changeIcon",{primary:n.icon},i):o.zbutton("changeIcon",{primary:n.icon})}).on("menuitemlabelchange",function(e,n){var i=n.menuitem.metadata().relatedButton,o=t(i);o.parent().hasClass("ui-buttonset")?o.parent().zbutton("changeLabel",n.label,i,!0):o.zbutton("changeLabel",n.label,void 0,!0)}).on("menuitemhovered",function(e,n){t.ZContextMenu.displayMenuComponents(e,n)});var s=this.element.parent().parent().find("a[href='#"+this.element.attr("id")+"']").parent();return o.data("tabId",s.attr("id")),this._initButtonsEvents(this.element,o),o},getGroupAsObj:function(e,n,i){var o=this;e=e.filter(":not([ctype],select,"+o._ctypeElems+")"),t(e).each(function(t,e){o.getButtonAsObj(e,n,i)})},getButtonAsObj:function(e,n){var i=this,o=t(e),s=void 0,u=o.metadata(),a=o.hasClass("ui-buttonset")&&!o.hasClass("ui-button-splitbutton");if(a){var r=o.next(),l=u.innerButtonset&&o.next(":not(.ui-buttonset-sep)").length?!0:!1,h=o.children(":not([ctype],select,"+i._ctypeElems+",.ui-extended-buttonset,.ui-group-text,.ui-buttonset-label,.ui-buttonset-sep,.ui-buttonset-sub-sep,.ui-zcolorchooser,.ui-zcombo)");"bottom"!==this.options.buttonsetLabelPosition||n?"left"===this.options.buttonsetLabelPosition&&(n||u.mainButtonset||h.children().length&&(s=o.zbutton("getAsObject",void 0,!1,i.options.setGroupAsSubmenu),s.mtype="group",i._menuArray.push(s))):h.children().length&&(s=o.zbutton("getAsObject",void 0,!1,i.options.setGroupAsSubmenu),s.mtype="group",i._menuArray.push(s)),t(h).each(function(e,o){o=t(o);var u=void 0,a=!1;if(!o.is("input")&&!o.is("select")&&(n?u=n:o.hasClass("ui-button")||o.hasClass("ui-button-splitbutton")?u=o.parent():o.hasClass("ui-buttonset")&&(u=o.parent(),a=!0),s=u.zbutton("getAsObject",o,!1,i.options.setGroupAsSubmenu),o.hasClass("ui-buttonset-container")||(s.externalAssociation=o,o.data("associatedMenuItem",s.id),i._menuArray.push(s)),a)){if("left"===i.options.buttonsetLabelPosition){var r=o.children(":not([ctype],select,"+i._ctypeElems+",.ui-extended-buttonset,.ui-group-text,.ui-buttonset-label,.ui-buttonset-sep,.ui-buttonset-sub-sep,.ui-zcolorchooser,.ui-zcombo)");r.length&&(s.mtype="group",i._menuArray.push(s))}i.getButtonAsObj(o,u)}});var d=r.children().filter(":not([ctype],select,"+i._ctypeElems+",.ui-zcolorchooser,.ui-zcombo,.ui-buttonset-label,.ui-group-text)"),c=o.children().filter(":not([ctype],select,"+i._ctypeElems+",.ui-zcolorchooser,.ui-buttonset-sep,.ui-icon-dot-separator,.ui-zcombo,.ui-buttonset-label,.ui-group-text)");if(!r.hasClass("ui-zcombo")&&!r.is("select")&&!r.hasClass("ui-buttonset-sep")&&d.length&&c.length){var b=r.metadata();b.buttonset?b.label||i._menuArray.push({mtype:"separator",isGroupSep:l}):i._menuArray.push({mtype:"separator",isGroupSep:l})}}else{if(o.hasClass("ui-ztoolbar-splitmenu"))return;if(!o.hasClass("ui-zcombo")){var p=o.hasClass("ui-button-splitbutton")?o.children("button:first"):o;if(p.is("input"))return;s=p.zbutton("getAsObject"),s.externalAssociation=p,p.data("associatedMenuItem",s.id),i._menuArray.push(s)}}},_initButtonsEvents:function(t,e){t.on("buttoniconchange",function(t,n){n.button.data("association")&&e.zmenu("changeIcon",n.button.data("association"),n.icons.primary)}).on("buttonlabelchange",function(t,n){n.button.data("association")&&e.zmenu("changeLabel",n.button.data("association"),n.label)})},_triggerEvent:function(t,e,n){e||(e=t);var i={target:n};e.data&&(i.eventData=e.data),this._trigger(t,e,i)},destroy:function(){this.element.off("."+this.widgetName),this.element.off("click."+this.widgetName),this.element.off("mouseover."+this.widgetName),this.element.off("mouseout."+this.widgetName)},_getGroupButtons:function(e){var n=t("[gname="+e+"]",this.element);return n},_hideButton:function(e,n){var i="string"==typeof e?t("#"+e,this.element):t(e),o=this._getElementType(i),s=n?"show":"hide";o?t(i)[o]("widget")[s]():t(i)[s]()},_hideButtons:function(t,e){var n=this;t.each(function(t,i){n._hideButton(i,e)})},_hideGroup:function(t,e){var n=this._getGroupButtons(t);this._hideButtons(n,e)},showGroup:function(t){this._hideGroup(t,!0)},hideGroup:function(t){this._hideGroup(t)},hideButton:function(t){this._hideButton(t)},showButton:function(t){this._hideButton(t,!0)},hideButtons:function(e){var n=this;t(e).each(function(t,e){n._hideButton(e)})},showButtons:function(e){var n=this;t(e).each(function(t,e){n._hideButton(e,!0)})},_getElementType:function(t){return(t.is("input")||t.is("select"))&&(t=t.next()),t.is(".ui-zcombo")?"zcombo":t.is(".ui-button")?"button":void 0},_disableButton:function(e,n){var i="string"==typeof e?t("#"+e,this.element):t(e),o=this._getElementType(i);o?i[o](n?"enable":"disable"):i[n?"enable":"disable"]();var s=i.data("menuButton");s&&s.button(n?"enable":"disable");var u={element:i,disabled:!n};i.removeClass("ui-state-hover"),i.trigger("element_state_changed",u)},_disableButtons:function(t,e){var n=this;t.each(function(t,i){n._disableButton(i,e)})},_disableGroup:function(t,e){var n=this._getGroupButtons(t);this._disableButtons(n,e)},enableGroup:function(t){this._disableGroup(t,!0)},disableGroup:function(t){this._disableGroup(t)},disableButton:function(t){this._disableButton(t)},enableButton:function(t){this._disableButton(t,!0)},disableButtons:function(e){var n=this;t(e).each(function(t,e){n._disableButton(e)})},enableButtons:function(e){var n=this;t(e).each(function(t,e){n._disableButton(e,!0)})},checkAndFixToolbar:function(){this._onDocumentResized()},_disable:function(e){var n=this.getToolbarButtons();this._disableButtons(n,e?!0:!1);var i=this.element.find("[ctype]");t.each(i,function(n,i){t(i)[t(i).attr("ctype")](e?"enable":"disable")});var o=this.element.find("select");t.each(o,function(n,i){t(i).data("zcombo")&&t(i).zcombo(e?"enable":"disable")})},disable:function(){this._disable()},enable:function(){this._disable(!0)},getToolbarButtons:function(){var e=t(this.element).find("label.ui-button").not(".ui-buttonset-label").prev("input"),n=t(this.element).find("button.ui-button").not(".ui-buttonset-label");return e.push(n),t(e)},setExcludeElements:function(t,e){t&&(this._ctypeElems=e?t:this._ctypeElems+t)},show:function(){var e=this,n=this.element.parent();n.removeClass("ui-ztab-toolbar-border").animate({height:n.data("tabHeight")},100,void 0,function(){e._triggerEvent(e._EVENTS.ONTOOLBARSHOW,t(e))})},hide:function(){var e=this.element.parent();e.css("height","").data("tabHeight",e.innerHeight()).addClass("ui-ztab-toolbar-border");var n=this;e.animate({height:0},100,void 0,function(){n._triggerEvent(n._EVENTS.ONTOOLBARHIDE,t(n))})}};e=t.extend({},e),t.widget("ui.ztoolbar",e),t.ui.ztoolbar.defaults={buttonClickedEvent:"toolbar_button_clicked",valueChangedEvent:"combo_value_changed"}}(jQuery);
!function(t){t.widget("ui.ztoggle",{widgetEventPrefix:"toggle",options:{size:"regular",iconClass:{on:"",off:""}},_EVENTS:{ONCHANGE:"change"},_create:function(){var e=this;this.element.hide(),this.options=t.extend({},this.element.data().metadata,this.options);var s='<span style="left: 8px;"></span><span style="left: 12px;"></span><span style="left: 16px;"></span>',i=this.options.text?this.options.text.left:t.i18n("ztoggle","on.label"),o=this.options.text?this.options.text.right:t.i18n("ztoggle","off.label");"small"==e.options.size.toLowerCase()&&(i="",o="",s='<span style="left: 5px;"></span><span style="left: 7px;"></span><span style="left: 9px;"></span>'),this.toggle=t("<div>").addClass("ui-ztoggle ui-ztoggle-"+e.options.size.toLowerCase()).on("contextmenu",function(){return!1}),this.toggleBase=t("<div>").addClass("ui-ztoggle-base");var n=""!=this.options.iconClass.on&&""!=this.options.iconClass.off?!0:!1;this.left=t("<div class='ui-ztoggle-left ui-ztoggle-"+e.options.size.toLowerCase()+" "+(n?this.options.iconClass.on:"")+"' >");var h=t("<div class='ui-ztoggle-right ui-ztoggle-"+e.options.size.toLowerCase()+" "+(n?this.options.iconClass.off:"")+"' >");n||(this.left.html(i),h.html(o));var a=t("<div>").addClass("ui-ztoggle-handle ui-ztoggle-"+e.options.size.toLowerCase()).html(s);this.toggleBase.append(this.left,h,a).appendTo(this.toggle),e.element.after(this.toggle);var l=this._getWidth(this.left);rightWidth=this._getWidth(h),handleWidth=this._getWidth(a,!0)+2,this.maxWidth=l>rightWidth?l:rightWidth;var d=this.maxWidth;this.left.css({width:d,padding:0}),h.css({left:this.maxWidth+handleWidth,width:this.maxWidth,padding:0}),a.css({left:this.maxWidth}),this.toggle.css({width:this.maxWidth+handleWidth}),this.toggleBase.css({width:2*this.maxWidth+handleWidth,left:-this.maxWidth}),e.drag=function(s,i){t("body").css("cursor","pointer");var o=s.clientX,n=!1,h=parseInt(e.toggleBase.css("left")),a=(e.maxWidth+handleWidth,o-t(i).offset().left,h);e.left.css("padding-right","3px"),t(window).on("mousemove.onoff",function(t){n=!0,X=t.clientX-o+h,0>=X&&X>=-e.maxWidth?(a=X,e.toggleBase.css("left",X)):0>X?e.toggleBase.css("left",-e.maxWidth):X>-e.maxWidth&&e.toggleBase.css("left",0)}).on("mouseup.onoff",function(){if(t("body").css("cursor",""),e.left.css("padding-right",0),t(this).off("mousemove.onoff mouseup.onoff selectstart.onoff"),n){var s=Math.abs(a);e.maxWidth/2>=s?e._switchOn(!0):e._switchOff(!0)}else e.element[0].checked?e._switchOff(!0):e._switchOn(!0)}).on("selectstart.onoff",function(){return!1})},this._isEnabled=!0,this.toggle.on("mousedown.onoff",function(t){e.drag(t,this)}),this.toggleBase.css("left",this.element[0].checked?0:-this.maxWidth),this.element.is(":disabled")&&this.disable()},_getWidth:function(t,e){var s=t.clone(!0).appendTo("body"),i=e?s.width():s.innerWidth();return s.remove(),i},_triggerEvent:function(t,e){var s={element:this.element,state:this.element[0].checked,fromUI:e};return this._trigger(t,t,s)},switchOn:function(){this._switchOn()},switchOff:function(){this._switchOff()},_switchOn:function(t){if(this._isEnabled){this.left.css("padding-right","3px"),t?this.toggleBase.animate({left:0},200):this.toggleBase.css({left:0});var e=this.element[0].checked?!1:!0;this.element[0].checked=!0,e&&this._triggerEvent(this._EVENTS.ONCHANGE,t)}},_switchOff:function(t){if(this._isEnabled){var e=this;this.left.css("padding-right","3px"),t?this.toggleBase.animate({left:-this.maxWidth},200,function(){e.left.css("padding-right",0)}):(this.toggleBase.css({left:-this.maxWidth}),e.left.css("padding-right",0));var s=this.element[0].checked?!0:!1;this.element[0].checked=!1,s&&this._triggerEvent(this._EVENTS.ONCHANGE,t)}},state:function(){return this.element[0].checked},disable:function(){this.element.attr("disabled","true"),this.toggle.attr("disabled","true").addClass("ui-state-disabled ui-ztoggle-disabled").off("mousedown.onoff"),this._isEnabled=!1},enable:function(){var t=this;this.element.removeAttr("disabled"),this.toggle.removeAttr("disabled").removeClass("ui-state-disabled ui-ztoggle-disabled").off("mousedown.onoff").on("mousedown.onoff",function(e){t.drag(e,this)}),this._isEnabled=!0},destroy:function(){this.toggle.remove(),t(this.element).off("."+this.widgetName),t.Widget.prototype.destroy.apply(this,arguments)}})}(jQuery);
!function(n){n.ZToolbarHandler={init:function(e){this.menutabs=n("#menutabs"),this.selectedShapeTypes=[],this._bindEvents(e),toolbarinited=!0},_bindEvents:function(e){var t=this,a=n(e[0]);if(e.length>1)for(i=1;i<e.length;i++)a=a.add(n(e[i]));n(a).bind("toolbarbuttonclicked",function(n,e){t._fireEvent(n,e,e.target)});var c=n(a).find("select");n.each(c,function(e){n(c[e]).bind("combochange",function(n,e){t._fireEvent(n,e,e.combo)})});var f=n(a).find('input[ctype="zspinner"]');n.each(f,function(e){n(f[e]).bind("spinnerchange",function(n,e){t._fireEvent(n,e,e.spinner)})}),n.each(f,function(e){n(f[e]).bind("spinnerspin",function(n,e){t._fireEvent(n,e,e.spinner)})});var r=n(a).find("ul[ctype='zmenu']");n.each(r,function(e){n(r[e]).bind("menuitemclicked",function(n,e){t._fireEvent(n,e,e.menuitem)})}),"zmenu"==n(a).attr("ctype")&&n(a).bind("menuitemclicked",function(n,e){t._fireEvent(n,e,e.menuitem)})},_fireEvent:function(e,i,t){if(t&&t.length){var a=t.metadata();if(a){var c=a.callable;if(0==c)return!1;var f=a.appData;if(!f)return;var r=f.eventData;if(f&&f.callback){var l=f.arg,d=f.callback.split("."),o=window,u="";if(n(d).each(function(n,e){o=o[e],n==d.length-2&&(u=o)}),isUndefined(r)){if(isUndefined(r)&&isUndefined(l))o.call();else if(!isUndefined(l)){for(var s=l.split(","),v=0;v<s.length;v++)"this"===s[v]&&(s[v]=t),"event"===s[v]&&(s[v]=e);o.apply(u,s),f.afterclick&&f.afterclick()}}else o.call(u,r,t)}}}}}}(jQuery);
function initAppBadges(){var e=$("#ztb-liveChat");e.html("");var t=$("#appBadgeContainer");t.show(),e.append(t),$("#ztb-topband").unbind("ztopbarmenuopen")}function toggleElements(e,t,n,a){isUndefined(n)?$("#"+e[0]).is(":hidden")?(showElements(e),hideElements(t)):(showElements(t),hideElements(e)):n?(showElements(e,a),hideElements(t,a)):(hideElements(e,a),showElements(t,a))}function changebuttonsState(e,t,n){var a;for(a=0;a<n.length;a++)$("#"+e).zbutton(t,"#"+n[a])}function errorDocMenutab(e){e=e?e:"disable",widgetmenu.changeFileMenuState(e),"disable"===e?$("#filetw").css("zIndex",1e3+BASEZINDEX):$("#filetw").css("zIndex","")}function enableFileMenuItems(){for(var e=["exportfileas","printSort"],t=0;t<e.length;t++)$("#"+e[t]).enable("true")}function zbuttonpress(e,t,n){isUndefined(n)&&(n=!$(e).hasClass(t)),n?$(e).addClass(t):$(e).removeClass(t)}function changetooltip(e,t){$(e).attr("title",t)}var zswidgets={init:function(){ZComponentTabs.init(),subMenuBindings.init(),menutabs.initreadonlysheet()}},ZComponentTabs={TAB_LIST:[],CURR_TAB:"homeTab",init:function(){for(var e=$("#menutabs"),t=e.find(".ui-ztab").children("li"),n=0;n<t.length;n++)t[n]&&(this.TAB_LIST[n]=t[n].id);e.bind("tabclick",function(e,t){ZComponentTabs.tabSwitch(e,t)}),e.bind("tabdropdownclick",function(e,t){var n=t.relatedPaneId;setTimeout(function(){ZComponentMenus.dropDownClickFn(e,t),appEvent.trigger("menutabListener",[n])},10)}),e.on("toolbarhide",function(){resetSheetDim(),appEvent.trigger("docpanel.resetDim")}),e.on("toolbarshow",function(){resetSheetDim(),appEvent.trigger("docpanel.resetDim")})},tabSwitch:function(e,t){var n=t.relatedPaneId;switch(this.CURR_TAB=n,"homeTab"==n?$("#copyButtonDiv").show():$("#copyButtonDiv").hide(),setTimeout(function(){appEvent.trigger("menutabListener",[n])},100),n){case"homeTab":break;case"formatTab":TOOLBARS.initFormatToolbar();break;case"insertTab":TOOLBARS.initInsertToolbar();break;case"formulasTab":TOOLBARS.initFormulaToolbar();break;case"mdataTab":TOOLBARS.initDataToolbar();break;case"webformTab":TOOLBARS.initFormToolbar();break;case"viewTab":TOOLBARS.initViewToolbar();break;case"reviewTab":TOOLBARS.initReviewToolbar();break;case"macrosTab":TOOLBARS.initMacrosToolbar();break;case"shareTab":TOOLBARS.initShareToolbar();break;case"tabulardataTab":}},initDefaults:function(){HIDE_PUBLISH_OPTION&&$("#extpub, #orgpub").hide(),featurePermission.setPermission({contextmenu:!0}),ZComponentMenus.init()},getSelectedTab:function(){return $("#menutabs").ztab("getSelectedTab")},setSelectedTab:function(e){var t=this.TAB_LIST.indexOf(e);$("#menutabs").ztab("selectTab",t)},changeBtnState:function(e,t,n){if(t)$("#"+e).zbutton(n);else for(var a=0;a<e.length;a++)$("#"+e[a]).zbutton(n)}},TOOLBARS={initDataToolbar:function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?menutabListener.doAction(TOOLBAR.DATA,{id:"mdataTab",action:"disable",callback:ztoolbar_disable,args:["mdataTab"]}):menutabListener.doAction(TOOLBAR.DATA,{id:"mdataTab",action:"enable",callback:ztoolbar_enable,args:["mdataTab"]})},initFormulaToolbar:function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?(menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"disable",callback:ztoolbar_enable,args:["formulasTab"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"recalculate",action:"enable",callback:button_enable,args:["recalculate"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"namethiscell",action:"enable",callback:button_enable,args:["namethiscell"]})):menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"enable",callback:ztoolbar_enable,args:["formulasTab"]})},initFormatToolbar:function(){var e=ActiveCellInfo._getFormat(currCell),t=$("#formatCellsNumber");e.PERCENT?t.zbutton("check","#PERCENT"):t.zbutton("uncheck","#PERCENT");var t=$("#formatCellsNumber");e.hasSeparator?t.zbutton("check","#comma"):t.zbutton("uncheck","#comma")},initViewToolbar:function(){if(BLOCK_RTL?$("#shtDirectbtn").css("display","none"):$("#shtDirectbtn").css("display","block"),isSheetFreezed||ISFREEZED){var e=function(){$("#freezePanes").zbutton("show","#unfreeze")},t=function(){$("#freezePanes").zbutton("hide","#freeze, #freezetoprow, #freezefirstcol")};menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"show",callback:e}),menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"hide",callback:t})}else{var e=function(){$("#freezePanes").zbutton("hide","#unfreeze")},t=function(){$("#freezePanes").zbutton("show","#freeze, #freezetoprow, #freezefirstcol")};menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"hide",callback:e}),menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"show",callback:t})}if(ProtectedRanges.isSheetLocked(CURRSHEETNAME)?menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"disable",callback:ZComponentTabs.changeBtnState,args:["freezePanes",!0,"disable"]}):menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"enable",callback:ZComponentTabs.changeBtnState,args:["freezePanes",!0,"enable"]}),isGridHidden){var n=function(){$("#hideShowGrid").zbutton("show","#showgrid"),$("#hideShowGrid").zbutton("hide","#hidegrid")};menutabListener.doAction(TOOLBAR.VIEW,{id:"hideShowGrid",action:"show",callback:n});var a=function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?ZComponentTabs.changeBtnState("hideShowGrid",!0,"disable"):ZComponentTabs.changeBtnState("hideShowGrid",!0,"enable")};menutabListener.doAction(TOOLBAR.VIEW,{id:"hideShowGrid",action:"show",callback:a})}else{var n=function(){$("#hideShowGrid").zbutton("show","#hidegrid"),$("#hideShowGrid").zbutton("hide","#showgrid")};menutabListener.doAction(TOOLBAR.VIEW,{id:"hideShowGrid",action:"show",callback:n});var a=function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?ZComponentTabs.changeBtnState("hideShowGrid",!0,"disable"):ZComponentTabs.changeBtnState("hideShowGrid",!0,"enable")};menutabListener.doAction(TOOLBAR.VIEW,{id:"hideShowGrid",action:"show",callback:a})}setSheetDirectionLabel()},initReviewToolbar:function(){cdview&&($("#createversion").hide(),$("#viewhistory").hide()),Discussion.allowComments()?Discussion.toggle():hideElements(["addDiscussion","addDiscussionDropDown"],"cellDiscussion",!0)},initMacrosToolbar:function(){$("#macroPanel").is(":visible")&&(RECORDINGMACRO?showElements(["stoprecordmacro"],"macroBuildPort"):hideElements(["stoprecordmacro"],"macroBuildPort"))},initShareToolbar:function(){$("#shareTab").attr("style","display: block !important"),jsSHARE_VIEW?(isCoOwnerSharedDoc||canShare)&&menutabListener.doAction(TOOLBAR.SHARE,{id:"shareDocPort",action:"enable",callback:applyStyle_zbutton,args:["shareDocPort","show","share"]}):menutabListener.doAction(TOOLBAR.SHARE,{id:"shareDocPort",action:"enable",callback:applyStyle_zbutton,args:["shareDocPort","show","share"]}),HIDE_PUBLISH_OPTION&&menutabListener.doAction(TOOLBAR.SHARE,{id:"docPublishPort",action:"disable",callback:ztoolbar_disable,args:["docPublishPort"]}),orgDisplayName||orgName?($("#orgembedBtn").show(),$("#embed").hide()):($("#orgembedBtn").hide(),$("#embed").show())},initInsertToolbar:function(){Filter.enableDisableInsertIcon(Filter.hasFilter&&0!==Filter.getInstance().appliedCols.length?!1:!0),colSelection&&rowSelection?(changebuttonsState("insertRowColumn","disable",["insrowstbtn","insrowsmenu"]),changebuttonsState("insertRowColumn","disable",["inscolstbtn","inscolsmenu"])):colSelection?(changebuttonsState("insertRowColumn","disable",["insrowstbtn","insrowsmenu"]),changebuttonsState("insertRowColumn","enable",["inscolstbtn","inscolsmenu"])):rowSelection&&(changebuttonsState("insertRowColumn","enable",["insrowstbtn","insrowsmenu"]),changebuttonsState("insertRowColumn","disable",["inscolstbtn","inscolsmenu"]))},initFormToolbar:function(){WebForm.updateFormMenuTab(WebForm.isFormAvailable,WebForm.isReportSheetAvailable)}},ZComponentMenus={init:function(){$("#rowOptMenus").bind("menubeforeshow",function(e,t){widgetmenu.initRowMenu(e,t)}),$("#colOptMenus").bind("menubeforeshow",function(e,t){widgetmenu.initColMenu(e,t)}),$("#protectrangemenu").bind("menubeforeshow",function(){ProtectedRanges.initLockMenu()}),$("#insertcolsmenu").bind("menubeforeshow",function(e,t){widgetmenu.initInsertColMenu(e,t)}),$("#insertrowsmenu").bind("menubeforeshow",function(e,t){widgetmenu.initInsertRowMenu(e,t)}),$("#filterbySub").bind("menubeforeshow",function(){Filter.toolBarHandler()}),$("#publishmenu").bind("menubeforeshow",function(){widgetmenu.initPublishMenu()}),$("#discussionmenu").bind("menubeforeshow",function(){Discussion.toggle()}),$("#conditionalformatmenu").bind("menubeforeshow",function(){colorScalesBag.colorScaleThemeColor()}),$("#colorscaledialogtheme").bind("menubeforeshow",function(){colorScalesBag.colorScaleThemeColor()}),$("#createruledialogtheme").bind("menubeforeshow",function(){formatWithConditions.selectThemeInMenu()}),$("#createruledialogtheme").bind("menubeforehide",function(){formatWithConditions.storeCustomProperty()}),$("#iconsetmenuDialog").bind("menubeforeshow",function(){var e=$("#iconsetsPreview").attr("setName"),t=$("#iconsetmenuDialog").find(".isBoxIcons");if($(t).css("background-color",""),"custom"!=e)for(var n=0,a=t.length;a>n;n++)$(t[n]).attr("type")==e&&$(t[n]).css("background-color","#d6d3d3")})},dropDownClickFn:function(e,t){var n=t.relatedPaneId;switch(n){case"homeTab":TABMENUS.initHomeMenu();break;case"formatTab":TABMENUS.initFormatMenu(),widgetmenu.initcurrencymenu();break;case"insertTab":case"formulasTab":TABMENUS.initFormulaMenu();break;case"mdataTab":TABMENUS.initDataMenu();break;case"webformTab":TABMENUS.initWebFormMenu();break;case"viewTab":TABMENUS.initViewMenu();break;case"reviewTab":TABMENUS.initReviewMenu();break;case"macrosTab":TABMENUS.initMacroMenu();break;case"shareTab":TABMENUS.initShareMenu();break;case"tabulardataTab":}}},TABMENUS={initHomeMenu:function(){$("#menuitem_borderBtn").children("span:first").children("span:first").attr("class",$("#borderBtn").children("span:first").attr("class")),changeAlignIcon(),toggleCellInsertOption()},initFormatMenu:function(){$("#menuitem_currency").children("span:first").text($("#currency").children("span:first").text()),$("#menuitem_currency").children("span:first").next().text(jsMsg["FormatCells.PopularCurrencies"])},initFormulaMenu:function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?(menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"disable",callback:ztoolbar_disable,args:["formulasTab"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"recalculate",action:"enable",callback:ztoolbar_enable,args:["recalculate"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"namethiscell",action:"enable",callback:ztoolbar_enable,args:["namethiscell"]})):menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"enable",callback:ztoolbar_enable,args:["formulasTab"]})},initDataMenu:function(){os_mac&&$("#menuitem_filter .ui-zmenu-shortcut").text("Cmd+Shift+F"),ProtectedRanges.isSheetLocked(CURRSHEETNAME)?menutabListener.doAction(TOOLBAR.DATA,{id:"mdataTab",action:"disable",callback:ztoolbar_disable,args:["mdataTab"]}):menutabListener.doAction(TOOLBAR.DATA,{id:"mdataTab",action:"enable",callback:ztoolbar_enable,args:["mdataTab"]})},initViewMenu:function(){isSheetFreezed||ISFREEZED?($("#freezePanes").zbutton("show","#unfreeze"),$("#freezePanes").zbutton("hide","#freeze, #freezetoprow, #freezefirstcol")):($("#freezePanes").zbutton("hide","#unfreeze"),$("#freezePanes").zbutton("show","#freeze, #freezetoprow, #freezefirstcol")),ProtectedRanges.isSheetLocked(CURRSHEETNAME)?ZComponentTabs.changeBtnState("freezePanes",!0,"disable"):ZComponentTabs.changeBtnState("freezePanes",!0,"enable"),isGridHidden?($("#hideShowGrid").zbutton("show","#showgrid"),$("#hideShowGrid").zbutton("hide","#hidegrid"),ProtectedRanges.isSheetLocked(CURRSHEETNAME)?ZComponentTabs.changeBtnState("hideShowGrid",!0,"disable"):ZComponentTabs.changeBtnState("hideShowGrid",!0,"enable")):($("#hideShowGrid").zbutton("show","#hidegrid"),$("#hideShowGrid").zbutton("hide","#showgrid"),ProtectedRanges.isSheetLocked(CURRSHEETNAME)?ZComponentTabs.changeBtnState("hideShowGrid",!0,"disable"):ZComponentTabs.changeBtnState("hideShowGrid",!0,"enable")),BLOCK_RTL?$("#shtDirectbtn").parent().zbutton("hide","#shtDirectbtn"):($("#shtDirectbtn").parent().zbutton("show","#shtDirectbtn"),isRTL?($("#rtls").addClass("ui-state-active"),$("#ltrs").removeClass("ui-state-active")):($("#ltrs").addClass("ui-state-active"),$("#rtls").removeClass("ui-state-active"))),setSheetDirectionLabel()},initReviewMenu:function(){cdview&&hideElements(["createversion","viewhistory"],"versionPort",!0),Discussion.on?Discussion.toggle():hideElements(["addDiscussion","addDiscussionDropDown"],"cellDiscussion",!0)},initMacroMenu:function(){RECORDINGMACRO?showElements(["stoprecordmacro"],"macroBuildPort"):hideElements(["stoprecordmacro"],"macroBuildPort")},initShareMenu:function(){jsSHARE_VIEW?($("#menuitem_share").hide(),(isCoOwnerSharedDoc||canShare)&&$("#menuitem_share").show()):($("#menuitem_share").show(),jsPUBLIC_VIEW&&$("#menuitem_share").hide()),HIDE_PUBLISH_OPTION&&$("#shareTabmenu").zmenu("disableMenuItems",["menuitem_publishSheet","menuitem_orgembedBtn","menuitem_embed"]),orgDisplayName||orgName?($("#menuitem_orgembedBtn").show(),$("#menuitem_embed").hide()):($("#menuitem_orgembedBtn").hide(),$("#menuitem_embed").show())},initWebFormMenu:function(){WebForm.updateFormMenuTab(WebForm.isFormAvailable)}},menutabs={isToolbarAltered:!1,initreadonlysheet:function(){jsSHARE_VIEW&&READ_WRITE&&TOOLBARS.initShareToolbar()},sheetbasedtoggle:function(){menutabs.isToolbarAltered=!READ_WRITE,READ_WRITE?($("#menutabs").ztab("selectTab",9),showElements(["formattw","inserttw","formulastw","datatw","viewtw","reviewtw","macrostw","pivottabletw"]),$("#savefile").enable("true"),$("#readonlyico").hide()):($("#menutabs").ztab("selectTab",9),hideElements(["formattw","inserttw","formulastw","datatw","viewtw","reviewtw","macrostw","pivottabletw","pivottw"]),$("#savefile").disable("true"),$("#readonlyico").show())},protectionBasedToggle:function(e){if(e=isUndefined(e)?ProtectedRanges.isSheetLocked(CURRSHEETNAME):e,menutabs.isToolbarAltered=e,e){menutabListener.doAction(TOOLBAR.HOME,{id:"homeTab",action:"disable",callback:ztoolbar_disable,args:["homeTab"]}),menutabListener.doAction(TOOLBAR.HOME,{id:"homeTab",action:"enable",callback:ztoolbar_enableButtons,args:["homeTab","enableButtons",["copyButton","open"]]}),toggleUNDO(),toggleREDO(),$("#formattw").disable("true"),$("#inserttw").disable("true"),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"disable",callback:ztoolbar_disable,args:["formulasTab"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"recalculate",action:"enable",callback:button_enable,args:["recalculate"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"namethiscell",action:"enable",callback:button_enable,args:["namethiscell"]}),menutabListener.doAction(TOOLBAR.DATA,{id:"mdataTab",action:"disable",callback:ztoolbar_disable,args:["mdataTab"]}),$("#pivottw").disable(),$("#protectrangemenu").bind("menubeforeshow",function(){$("#rangeProtect").disable()});var t=ZComponentTabs.CURR_TAB;("mdataTab"===t||"insertTab"===t||"formatTab"===t)&&menutabListener.doAction(t,{id:"currTab",action:"disable",callback:ztoolbar_disable,args:[t]}),ProtectedRanges.showMenuEntry()?menutabListener.doAction(TOOLBAR.DATA,{id:"protectCell",action:"enable",callback:button_enable,args:["protectCell"]}):menutabListener.doAction(TOOLBAR.DATA,{id:"protectCell",action:"disable",callback:button_disable,args:["protectCell"]}),menutabListener.doAction(TOOLBAR.DATA,{id:"pivotbuilder",action:"enable",callback:button_enable,args:["pivotbuilder"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePanes",action:"disable",callback:zbutton_action,args:["freezePanes","disable"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"hidegrid",action:"disable",callback:zbutton_action,args:["hideShowGrid","disable"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"showgrid",action:"disable",callback:zbutton_action,args:["hideShowGrid","disable"]}),menutabListener.doAction(TOOLBAR.REVIEW,{id:"addcomment",action:"disable",callback:button_disable,args:["addcomment"]}),menutabListener.doAction(TOOLBAR.REVIEW,{id:"editcomment",action:"disable",callback:button_disable,args:["editcomment"]}),menutabListener.doAction(TOOLBAR.REVIEW,{id:"removecomment",action:"disable",callback:button_disable,args:["removecomment"]})}else $("#homeTab").ztoolbar("enable"),toggleUNDO(),toggleREDO(),$("#formattw").enable("true"),$("#inserttw").enable("true"),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"enable",callback:ztoolbar_enable,args:["formulasTab"]}),menutabListener.doAction(TOOLBAR.DATA,{id:"mdataTab",action:"enable",callback:ztoolbar_enable,args:["mdataTab"]}),$("#pivottw").enable(),$("#protectrangemenu").bind("menubeforeshow",function(){$("#rangeProtect").enable()}),ProtectedRanges.showMenuEntry()?menutabListener.doAction(TOOLBAR.DATA,{id:"protectCell",action:"enable",callback:button_enable,args:["protectCell"]}):menutabListener.doAction(TOOLBAR.DATA,{id:"protectCell",action:"disable",callback:button_disable,args:["protectCell"]}),menutabListener.doAction(TOOLBAR.INSERT,{id:"insertTab",action:"enable",callback:ztoolbar_enable,args:["insertTab"]}),menutabListener.doAction(TOOLBAR.FORMAT,{id:"formatTab",action:"enable",callback:ztoolbar_enable,args:["formatTab"]}),menutabListener.doAction(TOOLBAR.FORMULAS,{id:"formulasTab",action:"enable",callback:ztoolbar_enable,args:["formulasTab"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"freezePane",action:"enable",callback:zbutton_action,args:["freezePane","enable"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"unfreezePane",action:"enable",callback:zbutton_action,args:["unfreezePane","enable"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"hidegrid",action:"enable",callback:zbutton_action,args:["hideShowGrid","enable"]}),menutabListener.doAction(TOOLBAR.VIEW,{id:"showgrid",action:"enable",callback:zbutton_action,args:["hideShowGrid","enable"]}),$("#addcomment, #editcomment, #removecomment").enable()},toggleToolbar:function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?menutabs.protectionBasedToggle():isSheetBasedShare&&!READ_WRITE?menutabs.sheetbasedtoggle():menutabs.isToolbarAltered&&(0!==ProtectedRanges.getObject().getSheets().list.length?menutabs.protectionBasedToggle():isSheetBasedShare&&menutabs.sheetbasedtoggle())}},widgetmenu={initFcomponents:function(){var e="null"==RESOURCE_ID?void 0:RESOURCE_ID,t={contextPath:ctxpath+"fcomponents/",service:"ST",csrfParamName:"zsreqcsr",csrfCookieName:"zscookcsr",clientTokenIsEnabled:!1,resourceId:e?e:void 0};-1!=zuid&&FComponents.init(t),$(".ztb-topband").length&&(this.initTopBar(),this.initfileNameField())},initInsertColMenu:function(e,t){var n=t.menu,a=n.children("li"),i=1,o=!1;if(isCellRange()){var s=getCellRange();i=s.endCol-s.startCol+1,o=!0}n.zmenu("hideAllMenuItems"),ClipRange.getClipObject().insertCopyCols?($(a[2]).show(),$(a[3]).show()):ClipRange.getClipObject().insertCutCols?($(a[4]).show(),$(a[5]).show()):(o&&i>1?(i=i.toString(),$(a[0]).children("span.ui-zmenu-text").html(replaceParams(jsMsg.NoofColumnsBefore,new Array(i))),$(a[1]).children("span.ui-zmenu-text").html(replaceParams(jsMsg.NoofColumnsAfter,new Array(i)))):($(a[0]).children("span.ui-zmenu-text").html(jsMsg.ColumnBefore),$(a[1]).children("span.ui-zmenu-text").html(jsMsg.ColumnAfter)),$(a[0]).show(),$(a[1]).show())},initInsertRowMenu:function(e,t){var n=t.menu,a=n.children("li"),i=1,o=!1;if(isCellRange()){var s=getCellRange();i=s.endRow-s.startRow+1,i-=Row.getHiddenRowCount(s.startRow,s.endRow),o=!0}n.zmenu("hideAllMenuItems"),ClipRange.getClipObject().insertCopyRows?($(a[2]).show(),$(a[3]).show()):ClipRange.getClipObject().insertCutRows?($(a[4]).show(),$(a[5]).show()):(o&&i>1?(i=i.toString(),$(a[0]).children("span.ui-zmenu-text").html(replaceParams(jsMsg.NoofRowsAbove,new Array(i))),$(a[1]).children("span.ui-zmenu-text").html(replaceParams(jsMsg.NoofRowsBelow,new Array(i)))):($(a[0]).children("span.ui-zmenu-text").html(jsMsg.RowAbove),$(a[1]).children("span.ui-zmenu-text").html(jsMsg.RowBelow)),$(a[0]).show(),$(a[1]).show())},initRowMenu:function(e,t){var n=!1,a=0;if(isCellRange()){var i=getCellRange();a=i.endRow-i.startRow+1,a-=Row.getHiddenRowCount(i.startRow,i.endRow),n=!0}var o=t.menu;!isColSelected()&&a>1&&(isRowSelected()||n)?($("#rinsertOpt").enable(),$("#rdeleteOpt").enable(),a=a.toString(),o.zmenu("changeLabel","rinsertOpt",replaceParams(jsMsg["HomeTab.Row.InsertNoofRows"],new Array(a))),o.zmenu("changeLabel","rdeleteOpt",replaceParams(jsMsg["HomeTab.Row.DeleteNoofRows"],new Array(a)))):(o.zmenu("changeLabel","rinsertOpt",jsMsg["HomeTab.Row.Insert"]),o.zmenu("changeLabel","rdeleteOpt",jsMsg["HomeTab.Row.Delete"]),isColSelected()?($("#rinsertOpt").disable(),$("#rdeleteOpt").disable()):($("#rinsertOpt").enable(),$("#rdeleteOpt").enable()))},initColMenu:function(e,t){var n=!1,a=0;if(isCellRange()){var i=getCellRange();a=i.endCol-i.startCol+1,n=!0}var o=t.menu;!isRowSelected()&&a>1&&(isColSelected()||n)?($("#cinsertOpt").enable(),$("#cdeleteOpt").enable(),a=a.toString(),o.zmenu("changeLabel","cinsertOpt",replaceParams(jsMsg["HomeTab.Column.InsertNoofCols"],new Array(a))),o.zmenu("changeLabel","cdeleteOpt",replaceParams(jsMsg["HomeTab.Column.DeleteNoofCols"],new Array(a)))):(o.zmenu("changeLabel","cinsertOpt",jsMsg["HomeTab.Column.Insert"]),o.zmenu("changeLabel","cdeleteOpt",jsMsg["HomeTab.Column.Delete"]),isRowSelected()?($("#cinsertOpt").disable(),$("#cdeleteOpt").disable()):($("#cinsertOpt").enable(),$("#cdeleteOpt").enable()))},initcurrencymenu:function(){for(var e=$("#currencymenu").children(),t=0;t<e.length;t++)$(e[t]).children().first().children().css({height:"16px",width:"16px"});0!=$("#menuitem_currency").length&&($("#menuitem_currency").children(".ui-zmenu-text").text(jsMsg["FormatCells.PopularCurrencies"]),$("#menuitem_currency").children().first().children().first().css({width:"16px",height:"16px"}))},initmacroswidgets:function(e){if(!isUndefined(e)){var t=$("#macrosTab :input");t.each(function(){"disable"===e?("macrohelp"!==$(this).attr("id")&&"stoprecordmacro"!==$(this).attr("id")&&$(this).disable(),$("#macroBuildPort").hide()):"enable"===e&&("macrohelp"!==$(this).attr("id")&&"stoprecordmacro"!==$(this).attr("id")&&$(this).enable(),$("#macroBuildPort").show())})}},insertdefault:function(e){"rows"==e?ClipRange.getClipObject().insertCopyRows?ClipObject.showLocaleInfoDialog("INSERT_COPIED_ROWS","ROW","above"):ClipRange.getClipObject().insertCutRows?ClipObject.showLocaleInfoDialog("INSERT_CUT_ROWS","ROW","above"):Range.executeShiftOperation("INSERT","ROW","above"):"cols"==e&&(ClipRange.getClipObject().insertCopyCols?ClipObject.showLocaleInfoDialog("insertCopyCols"):ClipRange.getClipObject().insertCutCols?ClipObject.showLocaleInfoDialog("insertCutCols"):insertCol("before"))},initFileMenu:function(){var e=$("#filemenu");if(isErrorDoc&&!isNewDoc)this.changeFileMenuState("disable");else{if(appEvent.trigger("menutabListener",["FileTab"]),e.zmenu("enable"),allowExport&&("PUBLIC_VIEW"!=getViewType()||allowExportPublic&&allowExportOrg))if(allowPrint){var t=["saveasfile","saveastemplate","exportfileas","printSort","newversion","versionhistory"];isNewDoc&&0==$("#save_message_display").text().trim().length&&e.zmenu("disableMenuItems",t)}else e.zmenu("hideMenuItems",["printSort"]);else REMOTE.ISRMVIEW?e.zmenu("hideMenuItems",["printSort","saveToMyAcnt","fSaveSep","fExpSep","exportfileas"]):e.zmenu("disableMenuItems",["printSort","saveToMyAcnt","exportfileas"]);TEMPLATE_FLAG.toBoolean()&&e.zmenu("hideMenuItems",["saveasfile","saveastemplate"]),maskOpenRec&&e.zmenu("disableMenuItems",["openRectfile"])}},initfileNameField:function(){setTimeout(function(){if($("#fileName").length){var e=!0,t=!0;(jsSHARE_VIEW&&!isCoOwnerSharedDoc||TEMPLATE_FLAG.toBoolean()||IS_TEAM_RESOURCE)&&(e=!1),(jsPUBLIC_VIEW||IS_TEAM_RESOURCE)&&(t=!1,e=!1,jsPUBLIC_VIEW&&(hasRenamePermission=!1)),$("#fileName").zfilefield({displayLength:450,rename:hasRenamePermission,fileId:RESOURCE_ID,fileName:escapeSpecialCharacters(DOCUMENT_NAME),saveToFolder:e,canFavourite:t,submit:function(e,t){updateDocName(t.fileHTMLName)},blur:function(){focusCell(currRow,currCol,void 0,!0)},success:function(){var e=new AjaxRequest,t=new RequestParameters(ActionConstants.RENAME_DOCUMENT);t.setParameters(encodeURIComponent(DOCUMENT_NAME)),e.init("POST",t.getURL(),!0,t.getParametersAsString()),e.sendRequest()}})}jsPUBLIC_VIEW&&$("#pubdoc").show()},500)},initTopBar:function(){REMOTE.ISRMVIEW||cdview||(userInfoOpt={},-1!=zuid&&(userInfoOpt={name:LOGIN_FULL_NAME,emailAddress:LOGIN_EMAILID,photo:PHOTO_SERVER_URL+"/file?fs=thumb&ID="+zuid,userId:zuid,signOutURL:function(){""!=COLLAB_ID&&"null"!=COLLAB_ID&&Collaboration.quit(COLLAB_ID),document.location.href=ctxpath+"logout.do"}}),ztopbar({product:"sheet",homePageLink:"#home",userInfo:userInfoOpt,myAccountLink:IAM_SERVER_URL,signInPageLink:this.getSignInUrl(),signUpPageLink:this.getSignUpUrl(),helpMenu:{helpLinks:{helpLink:REBRAND_URLS.SettingMenuHelpUrl,others:[{id:"appearance",label:jsMsg.WhatsNew,action:"URL:"+jsMsg.NewFeaturesURL,target:"_blank"},{id:"appearance1",label:jsMsg.KeyboardShortcuts,action:"URL:"+jsMsg.KeyboardShortcutsURL,target:"_blank"}]},blogLink:jsMsg.BlogsURL,forumLink:jsMsg.ForumsURL,feedback:function(){Feedback.showdialog()},liveChat:""}}),ISREBRANDED?($("#ztb-switch-menu, #ztb-liveChat, #ztb-helpLink, #appearance, #ztb-helpsep1, #ztb-about, #ztb-blogs, #ztb-helpsep2, #ztb-forums, #ztb-zoho-uid-info").hide(),$("#ztb-placeholder-container").css("margin-left","5px")):$("#ztb-topband").bind("ztopbarmenuopen",function(){initAppBadges()}));var e=$("#save_message_display").parent().parent();$(e).css("display","block"),RTLlang?($("body").addClass("ztb-rtl"),$("#ztb-help-menu").css("direction","rtl"),$(e).css("float","left"),$("#docstausicons").css("float","right"),$("#save_message_display").css("direction","rtl")):$(e).css("float","right"),setTimeout(function(){initHamburgerMenu()},500)},getSignInUrl:function(){return jsMsg.ZohoHomeURL.indexOf("skydesk")>0?jsMsg.ZohoHomeURL+"login.html":void 0},getSignUpUrl:function(){return jsMsg.ZohoHomeURL.indexOf("skydesk")>0?jsMsg.ZohoHomeURL+"register.html":void 0},initPublishMenu:function(){var e=orgDisplayName?orgDisplayName:orgName,t=$("#publishmenu");if(t.zmenu("hideAllMenuItems"),e){if(t.zmenu("showMenuItems",["publicMenuSeparator","publishRangeCommon","showpubrange"]),isDocumentPublic?t.zmenu("showMenuItems",["viewpubURL","removepublic"]):isDocumentSemiPublic&&!isDocumentPublic&&t.zmenu("showMenuItems",["makePublicinExtn","orgpubmenusep","viewpubURLinOrg","removepublic"]),!isDocumentSemiPublic&&!isDocumentPublic){t.zmenu("showMenuItems",["makePublicBoth"]);var n=($("#makePublicmenu"),replaceParams(jsMsg["Share.Public.MakePublicWithin"],new Array(e)));$($("#orgpub1").children("span")[1]).text(n),$("#makePublicmenu").css("width","auto"),$("#makePublicmenu").children("li").css("width","auto")}}else t.zmenu("showMenuItems",["publicMenuSeparator","publishRange","showpubrange"]),isDocumentPublic?t.zmenu("showMenuItems",["viewpubURL","removepublic"]):t.zmenu("showMenuItems",["makePublicExtn"])},changeMenuTabsState:function(e){e=e?e:"disable";var t=ZComponentTabs.TAB_LIST;if("disable"==e)for(i=0;i<t.length;i++)$("#"+t[i]).disable();else for(i=0;i<t.length;i++)$("#"+t[i]).enable();ZComponentTabs.CURR_TAB=ZComponentTabs.CURR_TAB?ZComponentTabs.CURR_TAB:"homeTab",$("#"+ZComponentTabs.CURR_TAB).ztoolbar(e)},changeFileMenuState:function(e){e=e?e:"disable";var t=["saveasfile","saveastemplate","exportfileas","print","newversion","showDocumentSetting","renamefile"];"disable"==e?menutabListener.doAction(TOOLBAR.FILE,{id:"filemenu",action:"disable",callback:zmenu,args:["filemenu","disableMenuItems",t]}):menutabListener.doAction(TOOLBAR.FILE,{id:"filemenu",action:"enable",callback:zmenu,args:["filemenu","enableMenuItems",t]})}},contextMenu={initContextMenu:function(){var e=$("#rmenu"),t=$("#sheettabrmenu"),n=$("#sheetpastemenu");e.bind("menuitemclicked",function(e,t){contextMenu._bindrclickevent(e,t)}),e.bind("menubeforeshow",function(e,t){return featurePermission.setPermission({allowToScroll:!1}),zcontextmenu.initGridRightClickMenu(t.target.attr("id"))}),t.bind("menuitemclicked",function(e,t){contextMenu._bindrclickevent(e,t)}),t.bind("menubeforeshow",function(e,t){return zcontextmenu.initSheetTabRightClickMenu(e,t)}),n.bind("menuitemclicked",function(e,t){contextMenu._bindrclickevent(e,t)}),n.bind("menubeforeshow",function(e,t){return zcontextmenu.initSheetTabRightClickPasteMenu(e,t)})},_bindrclickevent:function(e,t){var n=$(t.menuitem).metadata().appData;if(n&&n.callback){var a=n.arg,i=n.eventData,o=t.menuitem,s=n.callback.split("."),r=window,l="";if($(s).each(function(e,t){r=r[t],e==s.length-2&&(l=r)}),isUndefined(i)){if(isUndefined(i)&&isUndefined(a))r.call();else if(!isUndefined(a)){for(var c=a.split(","),b=0;b<c.length;b++)"this"===c[b]&&(c[b]=o),"event"===c[b]&&(c[b]=e);r.apply(l,c)}}else r.call(l,i,o)}}},subMenuBindings={init:function(){var e=$("#popupmenu").find("ul[ctype='zmenu']");$.each(e,function(t){$(e[t]).bind("menubeforeshow",function(e,t){var n=t.menu[0].id,a=ActiveCellInfo._getFormat(currCell);switch(n){case"halignmenu":subMenuBindings.halignMenu(n,a);break;case"valignmenu":subMenuBindings.valignMenu(n,a);break;case"showHideUsers":subMenuBindings.collaborators(n)}})})},halignMenu:function(e,t){var n=$("#"+e);" tac"==t.hAlign||" fac"==t.hAlign?n.zmenu("check","center",!0):" tar"==t.hAlign||" far"==t.hAlign?n.zmenu("check","right",!0):isRTL?n.zmenu("check","right",!1):n.zmenu("check","left",!0)},valignMenu:function(e,t){var n=$("#"+e);" vam"==t.vAlign?n.zmenu("check","vcenter",!0):" vab"==t.vAlign?n.zmenu("check","vbottom",!0):n.zmenu("check","vtop",!0)},collaborators:function(){appEvent.trigger("collabpanel.hidePresence")}};
function initUIComponents(){return jsVERSION_VIEW?void initVersionToolbar():(RTLlang&&($.ui.directionIsRTL=!0),void $.ui.utils.initDeferredComponents({ztab:"#menutabs"},100,function(){$("#toolbarContainer").show(),resetEditorDim(),$.ui.utils.initDeferredComponents({ztoolbar:"#homeTab,#rhomeTab,#pivotTab",zbutton:"#sheetOptions"},500,function(){$("#sheetOptions").css("visibility","visible"),$("#toolbarContainer").is(":visible")&&($("#menutabs1").remove(),$("#rmvstyle").remove(),$("#mainOuterDiv").css({height:"auto",width:clientDim.width}),$("#menutabs").ztab("selectTab",$("#filetw").length?1:0),UIComponents.deferInitialize(),appEvent.trigger("toolbar.home.load"),$("#docstausicons").show(),customiseUIBehavior(),appEvent.trigger("doMenuItemBinding"),resetEditorDim(),ZComponentTabs.initDefaults())})}))}function initVersionToolbar(){$.ui.utils.initComponents($("#versionview")),$("#versionExport").show(),$("#versionMacroMenu").show()}function initializeToolbar(e,t){$.ui.utils.initDeferredComponents({ztoolbar:e},1),t&&t.removeAttribute("onmouseover"),setTimeout(function(){setDefaultStatus(e)},100)}function setDefaultStatus(e){switch(e){case"#shareTab":CollabPanel.getCollaboratorsCount()>0?menutabListener.doAction(TOOLBAR.SHARE,{id:"chatwithusersPanel",action:"enable",callback:button_enable,args:["chatwithusersPanel"]}):menutabListener.doAction(TOOLBAR.SHARE,{id:"chatwithusersPanel",action:"disable",callback:button_disable,args:["chatwithusersPanel"]}),IS_DOCUMENT_SHARED?menutabListener.doAction(TOOLBAR.SHARE,{id:"notifysharedusers",action:"enable",callback:button_enable,args:["notifysharedusers"]}):menutabListener.doAction(TOOLBAR.SHARE,{id:"notifysharedusers",action:"disable",callback:button_disable,args:["notifysharedusers"]});break;case"#formulasTab":break;case"#reviewTab":Discussion.allowComments()?Discussion.toggle():hideElements(["addDiscussion","addDiscussionDropDown"],"cellDiscussion",!0);break;case"#webformTab":$("#formpublishmenu").on("menubeforeshow",function(){WebForm.updateFormPublishMenu()})}}function customiseUIBehavior(){appEvent.on("doMenuItemBinding",function(){$("#filemenu").bind("menubeforeshow",function(){widgetmenu.initFileMenu()})}),$("#bgcolor").children("span:first").css({"border-bottom":"3px solid #FFFF00"}),$("#fontcolor").children("span:first").css({"border-bottom":"3px solid 	#FF0000"}),!jsSHARE_VIEW||isCoOwnerSharedDoc||canShare||$("#share").hide(),zswidgets.init(),"true"===TEMPLATE_FLAG?($("#formtw").hide(),$("#sharetw").hide(),$("#useTmplBtn").show()):($("#formtw").show(),$("#sharetw").show(),$("#useTmplBtn").hide());var e=["openfile","open","share"];$.each(e,function(t){$("#"+e[t]).bind("click",function(){sheetdialog.close()})}),$(".ui-zadvcolorpalette").parent().css("zIndex",3e3+BASEZINDEX),$(".ui-zadvcolorpalette").parent().bind("dialogfocus",function(){if(sheetdialog.isDialogOpen()&&"cformatdialog"==sheetdialog.getDialogName()){var e=$("#conditionalDialogContent").parent().parent().css("z-index"),t=parseInt(e)+1;$(".ui-zadvcolorpalette").parent().css("zIndex",t)}else if(sheetdialog.isDialogOpen()&&"colorscalesdialog"==sheetdialog.getDialogName()){var e=$(".clrScl").parent().parent().css("z-index"),t=parseInt(e)+1;$(".ui-zadvcolorpalette").parent().css("zIndex",t)}else $(".ui-zadvcolorpalette").parent().css("zIndex",3e3+BASEZINDEX);$("#menutabs :input").css("zIndex",999+BASEZINDEX)}),jsPUBLIC_VIEW||jsSHARE_VIEW||($("#orgpub").attr("title",replaceParams(jsMsg["Share.Public.withInOrg"],new Array(orgDisplayName))),isDocumentSemiPublic&&!isDocumentPublic&&$("#orgpub").show(),isDocumentPublic&&$("#extpub").show()),1==RESOURCE_LOCKED?"READ"==DOCUMENT_MAX_PERMISSION?$("#readonlyico").show():$("#readonlyico").hide():jsTRASH_VIEW||!READ_WRITE&&!ProtectedRanges.isSheetLocked(CURRSHEETNAME)||jsSHARE_VIEW&&!ALLOW_TO_WRITE?$("#readonlyico").show():$("#readonlyico").hide(),allowExport&&("PUBLIC_VIEW"!=getViewType()||allowExportPublic&&allowExportOrg)||($("#savecopy").disable(),$("#toolbar_print").hide(),$("#rosavecopy").disable(),$("#rotoolbar_print").hide()),allowPrint||($("#toolbar_print").hide(),$("#rotoolbar_print").hide()),decideMergeIcon(),changeAlignIcon(),toggleCellInsertOption(),setSheetDirectionLabel()}function applyStyle_zbutton(e,t,o){$("#"+e).zbutton(t,"#"+o)}function applyStyle_addClass(e,t){$("#"+e).addClass(t)}function applyStyle_removeClass(e,t){$("#"+e).removeClass(t)}function applyStyle_zCombo(e,t){$("#"+e).zcombo(t)}function applyStyle_zCombo_with_fn(e,t,o){$("#"+e).zcombo(t,o)}function button_enable(e){$("#"+e).enable()}function button_disable(e){$("#"+e).disable()}function zmenu(e,t,o){$("#"+e).zmenu(t,o)}function ztoolbar_enable(e){$("#"+e).ztoolbar("enable")}function ztoolbar_disable(e){$("#"+e).ztoolbar("disable")}function ztoolbar_enableButtons(e,t,o){$("#"+e).ztoolbar(t,o)}function zbutton_hide(e){$("#"+e).zbutton("hide")}function zbutton_show_mouseout(e){$("#"+e).zbutton("show").mouseout()}function zbutton_action(e,t){$("#"+e).zbutton(t)}function zbutton_show(e){$("#"+e).zbutton("show")}var UIComponents={isDeferInitializationDone:!1,listeners:[],deferInitialize:function(){UIComponents.triggerListeners(),UIComponents.isDeferInitializationDone=!0,this.setToolbarStatus()},executeOnDeferredInit:function(e){this.listeners.push(e),this.isDeferInitializationDone&&this.triggerListeners()},triggerListeners:function(){UIComponents.listeners.forEach(function(e){e()}),UIComponents.listeners=[]},setToolbarStatus:function(){documentBakeStatus.isBaked()&&this.isDeferInitializationDone&&featurePermission.setPermission({hidetoolbar:!1})}};$(document).ready(function(){$.metadata.setType("attr","data");var e={ok:jsMsg.OK,cancel:jsMsg.Cancel,close:jsMsg.Close};COMPONENTS_I18N_VALUES.common=e,$.i18n(COMPONENTS_I18N_VALUES),function(e){e.fcomponents=e.extend(!0,e.fcomponents,{getCurrentDocStatus:function(){return 1}})}(jQuery),$("#mainOuterDiv").css("width",clientDim.width)}),$("#menutabs").bind("tabbeforedelete",function(e,t){return 2==t.index?(e.preventDefault(),!1):void 0}),appEvent.on("book.onaftersheetswitch",function(){menutabs.toggleToolbar()}),appEvent.on("toolbar.home.load",function(){"undefined"!=typeof NiceURL&&(NiceURL.isToolbarLoaded=!0,NiceURL.process()),menutabs.toggleToolbar(),appEvent.trigger("menutabListener",["homeTab"])});
var menutabListener=function(a){var n={},r={},e=function(n,r){var e=(r.id,r.action,r.callback),i=a("#"+n).hasClass("ui-ztoolbar-panel"),c=r.args;i?o(e,c):t(n,r)},i=function(a,r){for(var e=n[a],i=e.length;i--;)e[i]===r&&e.splice(i,1)},t=function(a,e){n[a]||(n[a]=[]),n[a].push(e),r[a]=!0},o=function(a,n){var r=a;n?r.apply("",n):r.call()},c=function(a){if(r[a])for(var e=n[a],t=e.length-1;t>=0;t--){var c=e[t],b=c.callback,l=c.args;o(b,l),i(a,c)}};return appEvent.on("menutabListener",function(a){c(a)}),{doAction:e}}(jQuery),TOOLBAR={HOME:"homeTab",FORMAT:"formatTab",INSERT:"insertTab",FORMULAS:"formulasTab",DATA:"mdataTab",VIEW:"viewTab",REVIEW:"reviewTab",MACROS:"macrosTab",SHARE:"shareTab",VERSIONVIEW:"versionview",FILE:"FileTab"};
var Annot=function(e){var t,n,o,a,l=[],r=!1,s=void 0,c=!1,f=!1,v=!1,d=!1,h=0,u=!1,m=void 0,p=e("#commentPaneContiner"),g=function(t,n,o,i,a){var s=t.className;-1==s.indexOf(" cC")||a?(e(t).addClass(isRTL?"cCRTL":"cC"),e(t).on("mouseover",function(){d||(clearTimeout(h),w(o,i))}).on("mouseout",function(){d||x()}).on("mousemove",function(){r||d||w(o,i)}),setTimeout(function(){d&&w(o,i)},100)):d&&T(n,o,i),l[o]||(l[o]=[]),l[o][i]=JSON.stringify(n)},C=function(){var e="<div class='annoteContiner'>";return e+=READ_WRITE?"<div class='commentContentDiv' contenteditable='true'></div><input type='hidden'/><div class='annoteHeader' style= 'direction:ltr'><span>Cell:&nbsp;</span> <span class='commentRef'></span><div class='annoteTrash annotetrashAnimate' ><div class='lid'></div><div class='can' title='"+jsMsg.Delete+"'></div></div></div>":"<div class='commentContentDiv'></div><input type='hidden'/>",e+="</div>"},w=function(t,n){if(V(t,n)){var o=getCell(t,n);if(!o)return;var i=l[t][n];if(null!=i){if(!d){if(c)return!1;E()}var a=t+"_"+n,s=C(),f=JSON.parse(i),v=f.v,h=(e("#l_"+a),"move");web_kit?h="-webkit-grab":browser_firefox&&(h="-moz-grab");var u=e("#"+a);if(!u.length){u=e("<div>",{id:a,class:"commentCallout"}).appendTo(e("#cCP")),u.html(s),v=decodeURIComponent(v),v=escapeSpecialCharacters(v).replace(/\n/g,"<br>"),u.find(".commentContentDiv").html(v);var m=getCellLabel(t,n);u.find(".commentRef").text(m),u.find("input").val(a)}var p=void 0;d&&(u.draggable({cancel:".commentContentDiv",opacity:.5,zIndex:2e3,cursor:h,containment:"#cCP",scroll:!1,start:function(){e("#l_"+a).hide()},drag:function(t,n){e("#l_"+a).hide(),S(t,n)},stop:function(e,t){K(t),U(t)}}),u.find(".annoteContiner").css("cursor",h),f.x&&f.y&&(p=f)),u.find(".annoteTrash").show();var g=b(o,u,p);g?R(u):E(a)}r=!0}},S=function(e,t){var n=t.position.top,o=t.position.left,i=s.width(),a=s.height(),l=!1;n>getSheetScrollTop()+getSheetHeight()||n<getSheetScrollTop()?(o>sheetScrollLeftVal&&o+i<sheetScrollLeftVal+getSheetWidth()&&(l=!0),n<getSheetScrollTop()&&scrollAnimator.scroll(!1,n,o,a,i,"TOP",l),n+a>getSheetScrollTop()+getSheetHeight()&&scrollAnimator.scroll(!1,n,o,a,i,"BOTTOM",l)):(o+i>getSheetScrollLeft()+getSheetWidth()&&o+i<getColLeft(totCols)||o>getSheetScrollLeft()+getSheetWidth()||o<getSheetScrollLeft())&&(o<getSheetScrollLeft()&&scrollAnimator.scroll(!1,n,o,a,i,"LEFT"),o+i>getSheetScrollLeft()+getSheetWidth()&&scrollAnimator.scroll(!1,n,o,a,i,"RIGHT"))},T=function(t,n,o){var i=n+"_"+o,a=e("#"+i);if(a.length&&t){var l=t.v;l=decodeURIComponent(l),l=escapeSpecialCharacters(l).replace(/\n/g,"<br>"),a.find(".commentContentDiv").html(l)}},b=function(e,t,n){var o,i;if(n)i=n.x,o=n.y;else if(e){var a=findCellLeft(e),l=findCellTop(e),r=getCellWidth(e),s=getCellHeight(e);o=l>5?l-5:l,i=a+r+5;var c=getNormalizedScrollLeft(),f=p.scrollTop(),v=t.width(),d=t.height(),h=parseInt(sheetPane.style.width),u=parseInt(sheetPane.style.height);i-c+v>h&&(i=a-v),o-f+d>u&&(o=l+s-d),0>o&&(o=0),0>i&&(i=0)}var m=e.getAttribute("dv"),g=null!=m?14:0;return isRTL?(i+=parseInt(getObj("ssVScrollbar").style.width)-1,t.css("right",i+g+"px")):t.css("left",i+g+"px"),t.css("top",o+"px"),K(void 0,t),!0},R=function(i){i.hover(function(){v=!0,s=e(this)},function(){v=!1,E()}),i.find(".annoteContiner").on("mousedown",function(){var e="move";web_kit?e="-webkit-grabbing":browser_firefox&&(e="-moz-grabbing"),d&&(this.style.cursor=e)}).on("mouseup",function(){var e="move";web_kit?e="-webkit-grab":browser_firefox&&(e="-moz-grab"),d&&(this.style.cursor=e)}),i.find(".commentContentDiv").on("click",function(){if(!READ_WRITE)return!1;N(!0,s);var e=s.find("input").val(),i=e.split("_");t=n=i[0],o=a=i[1]}).on("keydown",function(e){var t=e.which;if(browser_ie)var e=window.event,t=e.keyCode;var n=(e.shiftKey,e.ctrlKey),o=(e.altKey,e.metaKey);if(27==t){var i=s.find("input").val();d||E(i),setTimeout(function(){focusActiveElement()},10)}else if(9==t||os_mac&&o&&13==t||!os_mac&&n&&13==t){W("add"),N(!1);var i=s.find("input").val();E(),setTimeout(function(){focusActiveElement()},10)}}),i.find(".annoteTrash").on("click",function(){O()}),i.find(".commentContentDiv").on("paste",function(e){e.preventDefault();var t="";t=window.clipboardData?window.clipboardData.getData("Text"):(e.originalEvent||e).clipboardData.getData("text/plain"),A(t)})},A=function(e){if(window.getSelection){var t=window.getSelection();if(t.getRangeAt&&t.rangeCount){var n=t.getRangeAt(0);n.deleteContents(),n.insertNode(document.createTextNode(e))}}else document.selection&&document.selection.createRange&&(document.selection.createRange().text=e)},y=function(e){e.focus();var t=document.createRange();t.selectNodeContents(e),t.collapse(!1),selection=window.getSelection(),selection&&(selection.removeAllRanges(),selection.addRange(t)),e.scrollTop=e.scrollHeight},x=function(){clearTimeout(h),h=setTimeout(function(){E()},500)},E=function(t){clearTimeout(h),!r||c||v||t||d||(P(),r=!1),t&&(e("#"+t).remove(),e("#l_"+t).remove(),N(!1),v=!1)},P=function(){e("#cCP").html("")},_=function(){var i=currCell,l=ActiveCellInfo;if(t=n=l.getStartRow(),o=a=l.getStartCol(),V(t,o))return void L();var c=t+"_"+o,v=getCellLabel(t,o),d=C();s=e("<div>",{id:c,class:"commentCallout"}).appendTo(e("#cCP")),s.html(d),s.find("input").val(c),s.find(".commentRef").text(v),s.find(".annoteTrash").hide(),b(i,s),R(s),y(s.find(".commentContentDiv")[0]),r=!0,f=!0,N(!0,s)},L=function(){var i=ActiveCellInfo;t=n=i.getStartRow(),o=a=i.getStartCol();var l=t+"_"+o;d||w(t,o),s=e("#"+l),y(s.find(".commentContentDiv")[0]),N(!0,s)},N=function(e,t){c=e,e?(t.css("zIndex",2e3),m=t):m&&m.css("zIndex","")},I=function(e,t,n,o){for(var i=e;n>=i;i++)for(var a=t;o>=a;a++){var r=getCell(i,a);k(r),z(i,a),l[i]&&(l[i][a]=void 0)}},D=function(){W("removeAll")},O=function(){if(r){var i=s.find("input").val(),c=i.split("_");t=n=c[0],o=a=c[1],N(!1),v=!1;var f=t+"_"+o;e("#l_"+f).remove(),s.addClass("trashoutAnimate trashout"),k(getCell(t,o)),setTimeout(function(){e("#"+f).remove()},1e3)}else{var d=ActiveCellInfo;t=n=d.getStartRow(),o=a=d.getStartCol()}l[t][o]=void 0,W("remove")},k=function(t){t&&(removeCSSStyle("cellComment",t),e(t).hasClass("cC")?e(t).removeClass("cC"):e(t).hasClass("cCRTL")&&e(t).removeClass("cCRTL"))},z=function(t,n){V(t,n)&&(e("#"+t+"_"+n).remove(),e("#l_"+t+"_"+n).remove())},W=function(e){var i="";if("add"==e){if(i=s.find(".commentContentDiv")[0].innerText,!i)return void E();var r=(s.offset(),{v:i});G(),f?(e="add",f=!1):(e="edit",l[t][o]=JSON.stringify(r))}else if("removeAll"==e){var c=getCellRange();t=c.startRow,o=c.startCol,n=c.endRow,a=c.endCol,e="remove"}var v=new RequestParameters(ActionConstants.CELL_COMMENT);v.setParameters(WorkSheets.getAssociatedActiveSheetName(),t,o,n,a,e,encodeURIComponent(i));var d=new AjaxRequest;d.init("POST",v.getURL(),!0,v.getParametersAsString()),actionManager.addRequest(d)},U=function(e){var t=e.position,n=t.left,o=t.top,i=e.helper,a=i.find("input").val(),r=i.find(".commentContentDiv"),s=a.split("_"),c=s[0],f=s[1],v=r.width(),d=r.height(),h=l[c][f];if(h){var u=JSON.parse(h);u.x=n,u.y=o,l[c][f]=JSON.stringify(u)}var m=new RequestParameters(ActionConstants.RESET_ANNOTE_POSITION);m.setParameters(WorkSheets.getAssociatedActiveSheetName(),c,f,n,o,v,d);var p=new AjaxRequest;p.init("POST",m.getURL(),!0,m.getParametersAsString()),p.sendRequest()},H=function(e){var t=e.sn;if(CURRSHEETNAME==t){var n=e.m;if("remove"==n)I(e.sr,e.sc,e.er,e.ec);else for(i in e.n){{var o=e.n[i],a=o.r,l=o.c;getCell(a,l)}o&&new Cell(a,l).executeMethod(Annot.addComment,o,a,l)}}},M=function(){d?(J(),e("#cellNotePopUp").zmenu("changeIcon","showAllNotes","ui-zmenu-no-icon")):(q(),e("#cellNotePopUp").zmenu("changeIcon","showAllNotes","ui-icon-check"))},j=function(){u&&(q(),e("#cellNotePopUp").zmenu("changeIcon","showAllNotes","ui-icon-check"))},V=function(e,t){if(l[e]){var n=l[e][t];if(n)return n}return!1},q=function(){d=!0;for(var e=getAvailableStartRow(),t=getAvailableStartCol(),n=getAvailableEndRow(),o=getAvailableEndCol(),i=l.length,a=0;i>a;a++){var r=l[a];if(r)for(var s=0;s<r.length;s++){var c=r[s];c&&a>=e&&n>=a&&s>=t&&o>=s&&w(a,s)}}},J=function(){P(),d=!1,r=!1},K=function(t,n){if(n)var o=isRTL?parseInt(e(n).css("right")):n.cssUnit("left")[0],i=n.cssUnit("top")[0];else{n=t.helper;var a=t.position,o=a.left,i=a.top}var l=n.find("input").val(),r=n.width(),s=n.height(),c=l.split("_"),f=c[0],v=c[1],d=getCell(f,v);if(e(d).is(":visible")){var h=findCellLeft(d),u=findCellTop(d),m=getCellWidth(d),g=(p.scrollLeft(),p.scrollTop(),h+m),C=u;g>o+r/2&&(o+=r),C>i+s/2&&(i+=s);var w={x:o,y:i},S={x:g,y:C};B(S,w,"l_"+l)}},B=function(t,n,o){var i=getObj(o);i?e(i).show():(i=document.createElement("canvas"),i.setAttribute("class","lineCanvas"),i.setAttribute("id",o),getObj("cCP").appendChild(i));var a,l;t.x<n.x?(a=t,l=n):(a=n,l=t);var r=1,s=10,c={x:a.x-s,y:Math.min(t.y,n.y)-s};i.width=Math.max(l.x-a.x,r)+2*s,i.height=Math.abs(t.y-n.y)+2*s,i.style[isRTL?"right":"left"]=c.x+"px",i.style.top=c.y+"px",isRTL&&(i.style.transform="scaleX(-1)");var f=i.getContext("2d");f.save(),f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,i.width,i.height),f.restore(),f.lineWidth=1,f.strokeStyle="#f9a503",f.beginPath(),f.moveTo(t.x-c.x,t.y-c.y),f.lineTo(n.x-c.x,n.y-c.y),f.stroke()},F=function(){var t=e(sheetPane).width(),n=e(sheetPane).height();p=e("#commentPaneContiner");var o=rowHeadWidth,i=e("#docPanel");"none"!=i.css("display")&&(o+=parseInt(i.css("width"))),p.css(isRTL?{top:sheetTop,right:o,width:t,height:n}:{top:sheetTop,left:sheetLeft,width:t,height:n}),e("#cCP").css({width:totalTableWidth+sheetLeft,height:totalTableHeight+sheetTop})},G=function(){var e=getSheetScrollTop(),t=getSheetScrollLeft();p.scrollTop(e),p.scrollLeft(t)},Q=function(){return r};return appEvent.on("Toolbar.Initialized",function(){F(),e(document).shortcutkeys("disable"),setTimeout(function(){e("#commentPaneContiner").show(),G()},2e3)}),appEvent.on("annot.add",function(e,t,n,o){g(e,t,n,o)}),appEvent.on("annot.handleResponse",function(e){H(e)}),appEvent.on("body.mousedown",function(e){if(browser_ie){e=window.event;var t=e.srcElement}else var t=e.target;var n=t.className;c&&"commentContentDiv"!=n&&W("add"),N(!1),E()}),appEvent.on("book.onbeforesheetswitch",function(){l=[]}),appEvent.on("book.onaftersheetswitch",function(){F(),setTimeout(function(){e("#commentPaneContiner").show(),G()},500)}),appEvent.on("sheet.horizontallyScrolled sheet.verticallyScrolled",function(){G()}),appEvent.on("tableWidthChanged",function(t){e("#cCP").css("width",t+"px")}),appEvent.on("tableHeightChanged",function(t){e("#cCP").css("height",t+"px")}),appEvent.on("sheet.resize",function(){F()}),appEvent.on("isAddCmtOn",function(){if(s&&s.is(":visible")){var e=s.find(".commentContentDiv")[0];y(e)}}),appEvent.on("range.clearAll",function(e,t,n,o){I(e,t,n,o)}),appEvent.on("zsmousewheel.scroll",function(){e("#cCP .commentCallout").css("pointer-events","none")}),appEvent.on("zsmousewheel.scroll",e.debounce(1e3,function(){e("#cCP .commentCallout").css("pointer-events","all")})),appEvent.on("initVersionView",function(){d&&(J(),u=!0)}),{add:_,edit:L,show:w,hide:x,isNoteOn:Q,remove:O,removeAll:I,hasNote:V,clearAll:D,addComment:g,toggleView:M,setNoteView:j}}(jQuery);
function showURLInDialog(t,e,i,o,s){var n=new AjaxRequest;n.init("POST",t.split("?")[0],!0,t.split("?")[1]),n.addEventListener("onComplete",function(t){var n=showDialog(t.responseText,e,i,s);o&&n.setAttribute("opener",o)}),n.sendRequest()}$.ui.zcombo&&($.ui.zcombo.prototype._setOptionValue=function(t,e){t=this._getCorrectedOptPosition(t);var i=this.selected;this.selected=t;var o=$(this._dropDownMenu.zmenu("getMenuItemAt",this._getOptionMenuPosition(t))),s=$(o.clone().html()),n=void 0;if(this.options.applyOptionStylesOnCombo&&(n=$(o).attr("style")),this._optArea.empty().append(s),this._optArea.find(".ui-zmenu-shortcut").empty().remove(),!e){var r=this.element,p=void 0!=i?r.val():void 0;r.get(0).selectedIndex=t,this._triggerEvent(this._EVENTS.ONCHANGE,{prevVal:p})}var a=this.element.get(0);a.selectedIndex=t;var l=$(".ui-zmenu-text:visible",this._optArea);l.length&&l.text(s.text()),n&&(this._optArea.attr("style",n),l.attr("style",n))});
var ProtectedRanges=function(){this.ranges=new ZS_RangeList("prDiv",!0,0),this.sheets=new ZS_ProtectedSheetList,this.highlight=!1};ProtectedRanges.prototype={initialize:function(e,t){0==isUndefined(e)&&this.ranges.initialize(e),0==isUndefined(t)&&this.sheets.initialize(t)},getRanges:function(){return this.ranges},getSheets:function(){return this.sheets},setHighlight:function(e){this.highlight=e},isHighlight:function(){return this.highlight},hasProtectedRange:function(e,t,n){for(var s,a=this.ranges.getIterator();a.hasNext();)if(s=a.next(),"INSERTLEFT"===t||"DELETERIGHT"===t||"INSERTTOP"===t||"DELETEBOTTOM"===t){if(s.isPartOfRange(e))return jsMsg["ProtectedRange.alert.ProtectRangeMessage.Move"]}else if(s.isIntersect(e)){if((t===ActionConstants.INSERT_ROW||t===ActionConstants.INSERT_CUT_ROW||t===ActionConstants.INSERT_COPY_ROW)&&e.getStartRow()<=s.getStartRow()||(t===ActionConstants.INSERT_COL||t===ActionConstants.INSERT_CUT_COLUMN||t===ActionConstants.INSERT_COPY_COLUMN)&&e.getStartCol()<=s.getStartCol())continue;if(n||s.isLock())return jsMsg["ProtectedRange.alert.ProtectRangeMessage"];if(t===ActionConstants.MERGE_RANGE&&!s.isContains(e))return jsMsg["ProtectedRange.alert.ProtectRangeMessage.Merge"]}return!1},hasProtectedSheet:function(e){return this.sheets.isSheetProtected(e)},addRange:function(e){var t=this.ranges.find(e);if(-1!==t){var n=this.ranges.getRange(t);n.isLock()!==e.isLock()&&(n.setLock(e.isLock()),e.isLock()===!0?this.ranges.addElement(n,ProtectedRanges.getObject().isHighlight()):ProtectedRanges.showMenuEntry()===!0?n.removeDivElement(ProtectedRanges.getObject().isHighlight()):this.ranges.remove(t))}else this.ranges.removeRange(e),(e.isLock()===!0||ProtectedRanges.showMenuEntry()===!0)&&this.ranges.add(e);if(e.isLock()&&isCellEdited()){var s=new ZS_Range(currRow,currCol,currRow,currCol);e.isIntersect(s)&&(resetCurrCellValue(),showAlertDialog(jsMsg["ProtectedRange.alert.ProtectRangeMessage"]))}},addSheet:function(){},updateResponse:function(e){if(ObjectUtil.isUndefined(e[JSONConstants.ACTION])===!0){if(!isUndefined(e[JSONConstants.PROTECTED_RANGES])||!isUndefined(e[JSONConstants.PROTECTED_SHEETS])){var t,n;if(CURRSHEETNAME===e[JSONConstants.SHEET_NAME]&&(t=e[JSONConstants.PROTECTED_RANGES]),isUndefined(e[JSONConstants.PROTECTED_SHEETS])||(n=e[JSONConstants.PROTECTED_SHEETS]),this.initialize(t,n),CURRSHEETNAME===e[JSONConstants.SHEET_NAME])for(var s=0;s<t.length;s++)t[s].lock&&appEvent.trigger("protectRange.apply",[t[s].sr,t[s].sc,t[s].er])}}else{var a,o,r=e[JSONConstants.ACTION];switch(r){case ActionConstants.LOCK_RANGE:a=ProtectedRanges.getRangeObj(e),this.addRange(a),appEvent.trigger("protectRange.apply",[a.startRow,a.startCol,a.endRow]);break;case ActionConstants.UNLOCK_RANGE:if(a=ProtectedRanges.getRangeObj(e),this.ranges.removeRange(a),ObjectUtil.isUndefined(e[JSONConstants.PROTECTED_RANGES])===!1)for(var i=new ZS_Iterator(e[JSONConstants.PROTECTED_RANGES]);i.hasNext();)a=ProtectedRanges.getRangeObj(i.next()),this.addRange(a);appEvent.trigger("protectRange.remove",[a.startRow,a.startCol,a.endRow]);break;case ActionConstants.LOCK_SHEET:o=this.sheets.getSheetObj(e[JSONConstants.SHEET_NAME]);var g=ZS_ProtectedSheet.getSheetObj(e);null!=o||1!=g.isLock()&&1!=ProtectedRanges.showMenuEntry()?o.isLock()!=g.isLock()&&(1==g.isLock()?(o.setLock(!0),o.lockSheetTab()):(o.unlockSheetTab(!0),1==ProtectedRanges.showMenuEntry()?o.setLock(!1):this.sheets.remove(g.getName()))):(o=g,this.sheets.add(o)),CURRSHEETNAME===e[JSONConstants.SHEET_NAME]&&this.ranges.initialize(e[JSONConstants.PROTECTED_RANGES]);break;case ActionConstants.UNLOCK_SHEET:o=this.sheets.getSheetObj(e[JSONConstants.SHEET_NAME]),null!=o&&(1==o.isLock()&&(CURRSHEETNAME===e[JSONConstants.SHEET_NAME]&&this.ranges.initialize(e[JSONConstants.PROTECTED_RANGES]),o.unlockSheetTab(!0)),this.sheets.remove(o.getName()))}}DataValidation.checkCurrCellFocusForDv()},onMoveOrResizeAction:function(e,t,n){switch(e){case ActionConstants.INSERT_ROW:this.ranges.iterateRangeMethods(ZS_Range.prototype.insertRow,[t,n]);break;case ActionConstants.DELETE_ROW:this.ranges.iterateRangeMethods(ZS_Range.prototype.deleteRow,[t,n],ProtectedRanges.deleteCallBack);break;case ActionConstants.HEIGHT:this.ranges.iterateRangeMethods(ZS_Range.prototype.resizeRow,[t]);break;case ActionConstants.INSERT_COL:this.ranges.iterateRangeMethods(ZS_Range.prototype.insertCol,[t,n]);break;case ActionConstants.DELETE_COL:this.ranges.iterateRangeMethods(ZS_Range.prototype.deleteCol,[t,n],ProtectedRanges.deleteCallBack);break;case ActionConstants.WIDTH:this.ranges.iterateRangeMethods(ZS_Range.prototype.resizeColumn,[t])}},onSheetRename:function(e,t){this.sheets.renameSheet(e,t)},onSheetDelete:function(e){this.sheets.deleteSheet(e)},onFreeze:function(){this.ranges.iterateRangeMethods(ZS_Range.prototype.freeze)},onUnfreeze:function(){this.ranges.iterateRangeMethods(ZS_Range.prototype.unFreeze)}};var protectedRanges;ProtectedRanges.getObject=function(){return(ObjectUtil.isUndefined(protectedRanges)||null==protectedRanges)&&(protectedRanges=new ProtectedRanges),protectedRanges},ProtectedRanges.getRangeObj=function(e){return new ZS_Range(e[JSONConstants.START_ROW],e[JSONConstants.START_COLUMN],e[JSONConstants.END_ROW],e[JSONConstants.END_COLUMN],e[JSONConstants.LOCK])},ProtectedRanges.lockRange=function(e,t,n,s,a,o,r,i,g,c){var R=new RequestParameters(ActionConstants.LOCK_RANGE);R.setParameters(WorkSheets.getSheetCodeFromName(e),t,n,s,a,o,r,i,g,c);var h=new AjaxRequest;h.init("POST",R.getURL(),!0,R.getParametersAsString()),actionManager.addRequest(h)},ProtectedRanges.lockSheet=function(e,t,n,s,a,o){var r=new RequestParameters(ActionConstants.LOCK_SHEET);r.setParameters(e,t,n,s,a,o);var i=new AjaxRequest,g=r.getParametersAsString();i.init("POST",r.getURL(),!0,g),actionManager.addRequest(i)},ProtectedRanges.lockMultipleRange=function(){var e=new RequestParameters(ActionConstants.LOCK_MULTIPLE);e.setParameters(JSON.stringify(protectionDialog.getModifiedRanges()),$("#manageSheets").is(":visible"));var t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),actionManager.addRequest(t)},ProtectedRanges.unlockRange=function(e,t,n,s,a){var o=new RequestParameters(ActionConstants.UNLOCK_RANGE);o.setParameters(WorkSheets.getSheetCodeFromName(e),t,n,s,a);var r=new AjaxRequest;r.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(r)},ProtectedRanges.unlockSheet=function(e){var t=new RequestParameters(ActionConstants.UNLOCK_SHEET);t.setParameters(e);var n=new AjaxRequest;n.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(n)},ProtectedRanges.toggleHighlight=function(){ProtectedRanges.getObject().isHighlight()?ProtectedRanges.removeHighlight():ProtectedRanges.highlight()},ProtectedRanges.highlight=function(){ProtectedRanges.getObject().getRanges().highlight(),ProtectedRanges.getObject().getSheets().highlight(),ProtectedRanges.getObject().setHighlight(!0)},ProtectedRanges.removeHighlight=function(){ProtectedRanges.getObject().getRanges().removeHighlight(),ProtectedRanges.getObject().getSheets().removeHighlight(),ProtectedRanges.getObject().setHighlight(!1)},ProtectedRanges.getSelectedRange=function(){var e=getCellRange();return new ZS_Range(e.startRow,e.startCol,isColSelected()?getRowMax()-1:e.endRow,isRowSelected()?getColMax()-1:e.endCol)},ProtectedRanges.isCellLocked=function(e,t,n){return ProtectedRanges.isRangeLocked(e,t,e,t,null,n)},ProtectedRanges.isRangeLocked=function(e,t,n,s,a,o,r){var i=ProtectedRanges.getObject(),g=new ZS_Range(e,t,n,s),c=i.hasProtectedRange(g,a,r);return c?(o||showAlertDialog(c),!0):!1},ProtectedRanges.showMenuEntry=function(){return jsNEW_DOC_VIEW||jsOPEN_DOC_VIEW||jsSHARE_VIEW&&isCoOwnerSharedDoc},ProtectedRanges.isSheetLocked=function(e){return ProtectedRanges.getObject().hasProtectedSheet(e)},ProtectedRanges.deleteCallBack=function(e,t){0==e&&ProtectedRanges.getObject().getRanges().removeRange(t)},ProtectedRanges.resetMenuItem=function(e){var t=$(e);if(t){var n=t.parent();t.is(":checked")?n.zbutton("uncheck",e):n.zbutton("check",e)}},ProtectedRanges.initLockMenu=function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)?$("#rangeProtect").disable():$("#rangeProtect").enable(),ProtectedRanges.showMenuEntry()?$("#protectCell").enable():$("#protectCell").disable(),ProtectedRanges.getObject().isHighlight()?$("#protectrangemenu").zmenu("changeIcon","highlightProtect","ui-individual-icon ui-icon-ztick"):$("#protectrangemenu").zmenu("changeIcon","highlightProtect","ui-zmenu-no-icon"),$("#pivotbuilder").enable()},ProtectedRanges.counterValuesForProtectRangeWithinAvailableRows=function(e){e||(e=0);for(var t=[],n=0,s=0;n<ProtectedRanges.getObject().ranges.list.length;n++){var a=ProtectedRanges.getObject().ranges.list[n].startRow,o=ProtectedRanges.getObject().ranges.list[n].endRow,r=ProtectedRanges.getObject().ranges.list[n].startCol;if(!(availableEndRow>=a&&a>=availableStartRow))break;for(var i=a;o>=i;i++,s++)t[s]=i*(totCols-e)+(r-e)}return t},appEvent.on("book.onaftersheetswitch",function(){ProtectedRanges.isSheetLocked(CURRSHEETNAME)&&mask.grid(!0,!1,!1,!0)});
var protectionDialog=function(){function e(){if(!ProtectedRanges.isSheetLocked(CURRSHEETNAME)){var e=ProtectedRanges.getSelectedRange(),t=ProtectedRanges.getObject().getRanges().getIntersectedRanges(e);if(t.isEmpty())B=!1,n(!1,!1,e,null,!0);else if(B=!0,1===t.size()){var a=t.getRange(0);if(e.equals(a))n(!1,!1,e);else if(a.isContains(e))n(!1,!1,e);else{var s={buttons:[{text:jsMsg.Yes,class:"ui-zbutton-primary",click:function(){n(!1,!0,e,t.getRange(0),!0),sheetdialog.closeNotify()}},{text:jsMsg.No,click:function(){n(!1,!1,e,null,!0),sheetdialog.closeNotify()}},{text:jsMsg.Cancel,click:function(){sheetdialog.closeNotify()}}]};sheetdialog.showConfirmDialog(jsMsg["ProtectedRange.confirm.Extend"],s)}}else{var o={buttons:[{text:jsMsg.OK,class:"ui-zbutton-primary",click:function(){n(!1,!1,e,null,!0),sheetdialog.closeNotify()}},{text:jsMsg.Cancel,click:function(){sheetdialog.closeNotify()}}]};sheetdialog.showConfirmDialog(jsMsg["ProtectedRange.confirm.RemoveExisting"],o)}}}function t(e){var t=e?currSheetOnRightClick:CURRSHEETNAME;B=null!==ProtectedRanges.getObject().getSheets().getSheetObj(t),n(!0,!1,WorkSheets.getSheetCodeFromName(t),null,!B)}function n(e,t,n,s,o){var i=jsMsg["ProtectRange.UI.Menu.ProtectRange"];e&&(i=jsMsg["Menu.ProtectRange.ProtectSheet"]);var r={init:function(){e?($("#prSheetInput").show(),$("#prSheetInput input").val(CURRSHEETNAME),$("#shareNote").text(jsMsg["ProtectedRange.UI.SheetLockCollaboratorsInfo"])):(appEvent.on("grid.mousedown",G),$("#prRangeInput").show(),$("#inputRange").focus(function(){var e=this;RangeSelector.on({el:e,isAbsoluteRef:!0,appendSheetName:!0})}),$("#inputRange").focus());var i=new RequestParameters(ActionConstants.PROTECT_RANGE_DIALOG);i.setParameters(e?null:n.getStartRow(),e?null:n.getStartCol(),e?null:n.getEndRow(),e?null:n.getEndCol(),e?n:WorkSheets.getAssociatedActiveSheetName(),e,t,t?s.getStartRow():null,t?s.getStartCol():null,t?s.getEndRow():null,t?s.getEndCol():null);var r=e?CURRSHEETNAME:CellUtils.constructCellName(n.getStartRow(),n.getStartCol(),n.getEndRow(),n.getEndCol(),!0,CURRSHEETNAME);$("#inputRange").attr("value",r);var l=new AjaxRequest;l.init("POST",i.getURL(),!0,i.getParametersAsString()),l.addEventListener("onComplete",function(t){var n=parseJSON(t.responseText),s=$("#content");s.empty();var i="prTable";$("<table/>",{style:"table-layout:fixed; margin-left: 10px; margin-right:10px",cellspacing:"0"}).attr("id",i).appendTo(s);var r=N(n[JSONConstants.PROTECTED_RANGES].owner,i),l=O(n[JSONConstants.PROTECTED_RANGES],i,r);l=I(n[JSONConstants.PROTECTED_RANGES],i,l),M(n[JSONConstants.PROTECTED_RANGES],i),x(),"partial"===l?$("#lockSelector").attr("class","pChkI"):l?$("#lockSelector").attr("class","chkI"):$("#lockSelector").attr("class","unChkI"),B||l?o&&$("#pR_ok").enable():$("#pR_ok").disable(),e&&$("#isSheet").attr("value",!0),$(".user, .group, .org, .linkShare").on("change",function(){a()})}),l.sendRequest()},destroy:function(){RangeSelector.off(),appEvent.off("grid.mousedown",G)}},l={autoOpen:!1,width:500,resizable:!1,title:i,modal:e,close:function(){e===!1&&(focusCellRange(n.getStartRow(),n.getStartCol(),n.getEndRow(),n.getEndCol(),void 0,!0),Q&&ProtectedRanges.removeHighlight())}};sheetdialog.open("protectdialog",l,r)}function a(){var e,t=0;$("#pR_ok").enable(),$(".user, .group, .org, .linkShare").each(function(){if($(this).is(":checked")?$(this).siblings().last().addClass("off"):$(this).siblings().last().removeClass("off"),0===t)e=$(this).is(":checked");else if(!$(this).is(":disabled")&&$(this).is(":checked")!==e)return $("#lockSelector").attr("class","pChkI"),!1;t++}),t===$(".user, .group, .org, .linkShare").length&&(e?$("#lockSelector").attr("class","chkI"):($("#lockSelector").attr("class","unChkI"),B||$("#pR_ok").disable()))}function s(){var e=$("#lockSelector").attr("class"),t="true"==getObj("isSheet").value;if(t)var n=WorkSheets.getAssociatedActiveSheetName();else{var a=$("#inputRange")[0].value,s=DataValidation_UI.validateDvRange(a);if(!s)return void showAlertDialog(jsMsg.InvalidRange);var a=getDataFrom2DRangeText(s);if(a.sR===a.eR&&a.sC===a.eC){var o=Merge.getCellInfo(a.sR,a.sC);o&&(a.endRow=o.eR,a.endCol=o.eC)}}if("chkI"===e){var i=new StringBuffer;return $(".user").each(function(){$(this).is(":disabled")||i.append($(this).attr("zid"))}),sheetdialog.close(),void(0==t?ProtectedRanges.lockRange(a.sheetName,a.sR,a.sC,a.eR,a.eC,null,i,null,null):ProtectedRanges.lockSheet(n,null,i,null,null))}if("pChkI"===e){var r=new StringBuffer,i=new StringBuffer,l=new StringBuffer,c=new StringBuffer,g=null,d=!0;if($(".user").each(function(){$(this).is(":disabled")||($(this).is(":checked")?(d=!1,i.append($(this).attr("zid"))):r.append($(this).attr("zid")))}),$(".group").each(function(){$(this).is(":disabled")||($(this).is(":checked")?d=!1:l.append($(this).attr("zid")))}),$(".org").each(function(){$(this).is(":disabled")||($(this).is(":checked")?d=!1:c.append($(this).attr("zid")))}),$(".linkShare").length&&!$(".linkShare").is(":disabled")&&(g=!$(".linkShare").is(":checked"),g||(d=!1)),!d)return sheetdialog.close(),void(t===!1?ProtectedRanges.lockRange(a.sheetName,a.sR,a.sC,a.eR,a.eC,r.toString(",",!0),i.toString(",",!0),l.toString(",",!0),c.toString(",",!0),g):ProtectedRanges.lockSheet(n,r.toString(",",!0),i.toString(",",!0),l.toString(",",!0),c.toString(",",!0),g))}sheetdialog.close(),t===!1?ProtectedRanges.unlockRange(a.sheetName,a.sR,a.sC,a.eR,a.eC):ProtectedRanges.unlockSheet(n)}function o(){var e={autoOpen:!1,width:575,modal:!0,resizable:!1,title:jsMsg["Menu.ProtectRange.ManageProtection"],close:function(){L(),H(!0),sheetdialog.allowToClose=!0}},t={set:function(e,t){"managePrSheetSelection"===e.action&&i(t)},init:function(){sheetdialog.allowToClose=!1;for(var e=0;e<WorkSheets._sheetNamesMetaList[WorkSheets.NAME_POS].length;e++){{$("#prSheetName").append($("<option>",{value:WorkSheets._sheetNamesMetaList[WorkSheets.META_POS][e],text:WorkSheets._sheetNamesMetaList[WorkSheets.NAME_POS][e]}))}if(WorkSheets._sheetNamesMetaList[WorkSheets.NAME_POS][e]===CURRSHEETNAME)var t=e+1}$("#prSheetName").zcombo("setSelectedIndex",t),i(WorkSheets.getAssociatedActiveSheetName(),!0)}};sheetdialog.open("manageprotectdialog",e,t)}function i(e,t){$("#content").empty(),$("#dialogLoadingMsg").show();var n=p(e);if("undefined"!=typeof n)protectionDialog.constructManageProtectRangeDiv(n,e);else{var a=new RequestParameters(ActionConstants.READ_PROTECTED_RANGES);a.setParameters(e,t);var s=new AjaxRequest;s.init("POST",a.getURL(),!0,a.getParametersAsString()),s.addEventListener("onComplete",function(e){var t=parseJSON(e.responseText),n=t[JSONConstants.SHEETLIST][0][0];K[n]=t[JSONConstants.PROTECTED_RANGES],protectionDialog.constructManageProtectRangeDiv(t[JSONConstants.PROTECTED_RANGES],n)}),s.sendRequest()}}function r(e,t){if($("#prSheetName").zcombo("getValue")===t){var n=$("#content");if(n.empty(),$("#dialogLoadingMsg").hide(),!e.length>0||1===e.length&&!e[0].prArray>0)U(n);else{$("#expandCollapse").show();var a=$("<div/>",{class:"treeExpand",click:function(){D(this)}}),s=$("<span/>",{class:"appliesTo"}),o=$("<table/>",{class:"uLC dFI aD1",cellspacing:"0"}),i=$("<div/>",{class:"trashAnimate",title:jsMsg.Remove}).click(function(e){var t=$(this).closest(".treeExpand"),n=0===t.length?$(this).closest(".treeCollapse"):t,a=n.next(),s=getDataFrom2DRangeText(a.attr("range"));ProtectedRanges.unlockRange(s.sheetName,s.sR,s.sC,s.eR,s.eC),l(a,n),stopEvt(e)}),r=$("<div/>",{class:"lid"}),c=$("<div/>",{class:"can"});i.append(r).append(c);for(var g=0;g<e.length;g++)for(var d=e[g],p=d.prArray,f=0;f<p.length;f++){var S=p[f],R=a.clone(!0),v=s.clone(!0).text(S.pr);v.click(u());var C=i.clone(!0);R.append(v),R.append(C),n.append(R);{var k=""+g+f,m="userListContainer"+k;o.clone(!0).attr("id",m).attr("range",S.pr).appendTo(n)}N(S.owner,m,k),O(S,m,void 0,k),I(S,m,void 0,k),M(S,m,k)}x(),$("#content .user, #content .group, #content .org, #content .linkShare").on("change",{isSheet:!1},h)}}}function l(e,t){$(e).removeClass("dFI aD1"),$(t).removeClass("dFI aD1"),setTimeout(function(){$(e).addClass("bFO aD"),$(t).addClass("bFO aD")},1),setTimeout(function(){$(e).removeClass("bFO aD"),$(t).removeClass("bFO aD")},1e3),setTimeout(function(){$(e).addClass("fO"),$(t).addClass("fO")},1001)}function c(){!$("#lockRanges").attr("disabled")&&$("#content").children().length<=0&&i($("#prSheetName").zcombo("getValue"))}function g(){if(!$("#lockSheets").attr("disabled")&&"undefined"==typeof K.sheets){$("#contentSheet").empty(),$("#dialogLoadingMsg").show();var e=new RequestParameters(ActionConstants.READ_PROTECTED_SHEETS),t=new AjaxRequest;t.init("POST",e.getURL(),!0,e.getParametersAsString()),t.addEventListener("onComplete",function(e){var t=parseJSON(e.responseText);K.sheets=!0,protectionDialog.constructManageProtectSheetDiv(t[JSONConstants.PROTECTED_SHEETS])}),t.sendRequest()}}function d(e){var t=$("#contentSheet");if(t.empty(),$("#dialogLoadingMsg").hide(),e.length<=0)U(t,!0);else{$("#expandCollapse1").show();var n=$("<div/>",{class:"treeExpand",click:function(){D(this)}}),a=$("<span/>",{class:"appliesTo"}),s=$("<table/>",{class:"uLC dFI aD1",cellspacing:"0"}),o=$("<div/>",{class:"trashAnimate",title:jsMsg.Remove}).click(function(e){{var t=$(this).closest(".treeExpand"),n=0===t.length?$(this).closest(".treeCollapse"):t,a=n.next();a.attr("range")}ProtectedRanges.unlockSheet(WorkSheets.getSheetCodeFromName(a.attr("range"))),l(a,n),stopEvt(e)}),i=$("<div/>",{class:"lid"}),r=$("<div/>",{class:"can"});o.append(i).append(r);for(var c=0;c<e.length;c++){var g=e[c],d=(g.prArray,g),p=n.clone(!0),f=a.clone(!0).text(d.sn);f.click(u());var S=o.clone(!0);p.append(f),p.append(S),t.append(p);{var R="S"+c+j,v="userListContainer"+R;s.clone(!0).attr("id",v).attr("range",d.sn).appendTo(t)}N(d.owner,v,R),O(d,v,void 0,R),I(d,v,void 0,R),M(g,v,R)}x(),$("#contentSheet .user, #contentSheet .group, #contentSheet .org, #contentSheet .linkShare").on("change",{isSheet:!0},h)}}function u(){return function(e){var t=$(this).text();Goto.gotoCellInit(t);var n=getCellRangeFromString(t);n&&moveDialogBox(n.startRow,n.startCol),stopEvt(e)}}function h(e){var t=$(this).attr("zid"),n=$(this).attr("id"),a=!$(this).is(":checked"),s=$(this).closest("table"),o="#"+s.attr("id"),i=new StringBuffer,r=new StringBuffer,l=new StringBuffer,c=new StringBuffer,g=null,d=!0;$(o+" .user").each(function(){$(this).is(":disabled")||($(this).is(":checked")?(r.append($(this).attr("zid")),$(this).siblings().last().addClass("off"),d=!1):(i.append($(this).attr("zid")),$(this).siblings().last().removeClass("off")))}),$(o+" .group").each(function(){$(this).is(":disabled")||($(this).is(":checked")?($(this).siblings().last().addClass("off"),d=!1):(l.append($(this).attr("zid")),$(this).siblings().last().removeClass("off")))}),$(o+" .org").each(function(){$(this).is(":disabled")||($(this).is(":checked")?(d=!1,$(this).siblings().last().addClass("off")):(c.append($(this).attr("zid")),$(this).siblings().last().removeClass("off")))}),$(o+".linkShare").length&&!$(".linkShare").is(":disabled")&&(g=!$(o+".linkShare").is(":checked"),g||($(this).siblings().last().addClass("off"),d=!1)),y(s.attr("range"),i.toString(",",!0),r.toString(",",!0),l.toString(",",!0),c.toString(",",!0),g,d),e.data.isSheet||f(s.attr("range"),t,$(this).is(":checked")),z(o,n,a,s.attr("range")),v(!1)}function p(e){return void 0!==Y[e]?Y[e]:K[e]}function f(e,t,n){var a=$("#prSheetName").zcombo("getValue");void 0===Y[a]&&(Y[a]=JSON.parse(JSON.stringify(K[a])));var s=Y[a][0].prArray;$.each(s,function(a,s){return s.pr===e?($.each(s,function(e,a){if(a instanceof Array)$.each(a,function(e,a){return t===a.zuid?(a.lock=n,!1):void 0});else if(t===a.zuid)return a.lock=n,!1}),!1):void 0})}function S(e){delete K[e]}function R(){if(ProtectedRanges.lockMultipleRange(),$("#manageSheets").is(":visible"))for(var e=0;e<q.length;e++){var t=WorkSheets.getSheetCodeFromName(q[e].pr);S(t),$("#prSheetName").zcombo("getValue")===t&&$("#content").empty()}L(),W(),v(!0)}function v(e){e?($("#close").show(),$("#saveChanges").slideUp(),$("#manageSheets").is(":visible")?$("#lockRanges").enable():$("#lockSheets").enable()):($("#close").hide(),$("#saveChanges").addClass("lCA"),$("#saveChanges").slideDown(),$("#manageSheets").is(":visible")?$("#lockRanges").disable():$("#lockSheets").disable())}function C(){$(".user, .group, .org, .linkShare").unbind("change");for(var e=0;e<V.length;e++){var t=$(V[e].tableId).find("input#"+V[e].eleId);V[e].prevState?(t.prop("checked",!0),$(t).siblings().last().addClass("off")):(t.prop("checked",!1),$(t).siblings().last().removeClass("off"))}W(),L(),H(),$(".user, .group, .org, .linkShare").on("change",{isSheet:$("#manageSheets").is(":visible")},h),v(!0)}function k(){"manageprotectdialog"===sheetdialog.getDialogName()&&i($("#options").children("select").val())}function m(e,t,n,a){return 0==t&&a==getRowMax()-1?getColHeadLabel(e+1)+":"+getColHeadLabel(n+1):getColHeadLabel(e+1)+getRowHeadLabel(t)+":"+getColHeadLabel(n+1)+getRowHeadLabel(a)}function E(e){if(sheetdialog.isDialogOpen()&&"manageprotectdialog"===sheetdialog.getDialogName()){var t=e.sn+"."+m(e.sc,e.sr,e.ec,e.er),n=$("#content"),a=$("#expandCollapse");if(e.a===ActionConstants.UNLOCK_SHEET&&(t=e.sn,n=$("#contentSheet"),a=$("#expandCollapse1")),b(V,t),b(q,t),e.a!==ActionConstants.UNLOCK_SHEET){var s=WorkSheets.getSheetCodeFromName(e.sn);if(Y[s]){var o=Y[s][0].prArray;o&&b(o,t)}if(K[s]){var o=K[s][0].prArray;o&&b(o,t)}}setTimeout(function(){var e=$("[range='"+t+"']");e.prev().remove(),e.remove(),0===n.children().length&&(U(n),$("#expandCollapse").hide()),0===q.length&&v(!0)},1e3)}}function b(e,t){for(var n=e.length;n--;)e[n].pr===t&&e.splice(n,1)}function P(){var e=$("#lockSelector").attr("class");$(".user, .group, .org, .linkShare").unbind("change"),$("#pR_ok").enable();var t=!0;"pChkI"===e||"unChkI"===e?$("#lockSelector").attr("class","chkI"):($("#lockSelector").attr("class","unChkI"),t=!1,B||$("#pR_ok").disable()),$(".user, .group, .org, .linkShare").each(function(){$(this).prop("checked",t),t?$(this).siblings().last().addClass("off"):$(this).siblings().last().removeClass("off")}),$(".user, .group, .org, .linkShare").on("change",a)}function N(e,t,n){if("undefined"==typeof e.lock)var a=!1;else a=e.lock;return T(e.name,parseInt(e.zuid),e.email,a,"zdc-shareuser_icon","user",jsMsg["ProtectRange.UI.Owner"],t,null,e.isSL,n),a}function O(e,t,n,a){var n=A(e[JSONConstants.CO_OWNER_USERS],"zdc-shareuser_icon","user",jsMsg["ProtectRange.UI.CoOwner"],t,null,null,n,a);return n=A(e[JSONConstants.CO_OWNER_GROUPS],"zdc-sharegroup_icon","group",jsMsg["ProtectRange.UI.CoOwner"],t,null,null,n,a),n=A(e[JSONConstants.READ_WRITE_USERS],"zdc-shareuser_icon","user",jsMsg["ProtectRange.UI.ReadWrite"],t,null,null,n,a),n=A(e[JSONConstants.READ_WRITE_GROUPS],"zdc-sharegroup_icon","group",jsMsg["ProtectRange.UI.ReadWrite"],t,null,null,n,a),n=A(e[JSONConstants.READ_WRITE_ORGS],"orgIcon","org",jsMsg["ProtectRange.UI.ReadWrite"],t,null,null,n,a)}function I(e,t,n,a){var s=e[JSONConstants.LINK_SHARE_PERMISSSION],o=!1;if("undefined"!=typeof s){var i=jsMsg["ProtectRange.UI.PublicOnTheWeb"],r="publicIcon";4096===s.shTp&&(i=jsMsg["ProtectRange.UI.PublicOnTheWebPassword"],r="publicProtectIcon",o=!!s.lock);var l=s.isRo?jsMsg["ProtectRange.UI.ReadOnly"]:jsMsg["ProtectRange.UI.ReadWrite"];T(i,-1,i,s.isRo?!0:s.lock,r,"linkShare",l,t,s.isRo,s.isRo?!1:s.isSL,a),"partial"!==n&&n!==o&&(n="partial")}return n}function M(e,t,n){A(e[JSONConstants.READ_ONLY_USERS],"zdc-shareuser_icon","user",jsMsg["ProtectRange.UI.ReadOnly"],t,!0,!0,void 0,n),A(e[JSONConstants.READ_ONLY_GROUPS],"zdc-sharegroup_icon","group",jsMsg["ProtectRange.UI.ReadOnly"],t,!0,!0,void 0,n),A(e[JSONConstants.READ_ONLY_ORGS],"orgIcon","org",jsMsg["ProtectRange.UI.ReadOnly"],t,!0,!0,void 0,n)}function A(e,t,n,a,s,o,i,r,l){if("undefined"!=typeof e)for(var c=0;c<e.length;c++){var g="undefined"==typeof e[c].lock?!1:e[c].lock;if("undefined"==typeof r)var r=g;else"partial"!==r&&r!==g&&(r="partial");var d=i?!1:e[c].isSL;T(e[c].name,parseInt(e[c].zuid),e[c].email,i?!0:g,t,n,a,s,o,d,l)}return r}function T(e,t,n,a,s,o,i,r,l,c,g){var d=$("<tr/>");if("user"===o||"group"===o){var u=PHOTO_SERVER_URL+"/file?fs=thumb&ID="+t;"group"===o&&(u+="&t=group"),d.append($("<td/>").append($("<span/>",{class:"ui-zcollaborator-imgcontainer"}).append($("<img/>",{class:"ui-zcollaborator-img",src:u,style:"border-radius: 100%"}))))}else d.append($("<td/>").append($("<div/>",{class:"lUI"}).append($("<div/>",{class:s}))));var h=$("<div/>",{class:"elipsis uNW",text:e,title:n});zuid===t&&h.append($("<span/>",{text:"  ("+jsMsg["ProtectRange.UI.me"]+")",style:"color:#a9a9a9;padding-left: 5px;"})),d.append($("<td/>",{class:"uPC"}).append(h).append($("<div/>",{text:i,class:"userRole"}))),d.append(c?$("<td/>",{style:"width: 25%;"}).append($("<span/>",{text:jsMsg["ProtectRange.UI.SheetLocked"],class:"lockInfo elipsis"})):$("<td/>",{class:"lUCell"}));var p=g?t+"_"+g:t,f=$("<div></div>"),S=$("<input />"),R=$("<label />"),v=$("<span />");$(v).attr("class",a?"lckRng off":"lckRng"),$(f).addClass("toggleCheckBox"),$(S).attr("id",p),$(S).attr("zid",t).attr("checked",a),$(S).attr("class",o),$(S).attr("type","checkbox"),$(R).attr("for",p),$(f).append(S),$(f).append(R),$(f).append(v),d.append($("<td/>").append(f)),zuid===t?d.prependTo($("#"+r)):d.appendTo($("#"+r))}function _(){return $("table[id^='userListContainer']").hide(),$(".treeExpand").attr("class","treeCollapse"),!1}function w(){return $("table[id^='userListContainer']").show(),$(".treeCollapse").attr("class","treeExpand"),!1}function D(e){"treeExpand"==e.className?($(e).attr("class","treeCollapse"),$(e).next().hide()):($(e).attr("class","treeExpand"),$(e).next().show())}function x(){$.ui.utils.initComponents($("#content")),$.ui.utils.initComponents($("#contentSheet"))}function U(e,t){var n=$("<div/>",{style:"text-align: center; top: 47%; position: relative;",text:t?jsMsg["ProtectRange.UI.NoProtectedSheet"]:jsMsg["ProtectRange.UI.NoProtectedRange"]});e.append(n)}function y(e,t,n,a,s,o,i){for(var r=!1,l=0;l<q.length;l++)if(q[l].pr===e){r=!0,q[l].isAllUnlocked=i,q[l].au=t?t:q[l].au,q[l].uau=n?n:q[l].uau,q[l].ag=a?a:q[l].ag,q[l].ao=s?s:q[l].ao,q[l].isPubA=o?o:q[l].isPubA;break}r||q.push(i?{pr:e,isAllUnlocked:i}:{pr:e,au:t,uau:n,ag:a,ao:s,isPubA:o})}function L(){q=[]}function z(e,t,n,a){for(var s=!1,o=0;o<V.length;o++)if(V[o].tableId===e&&V[o].eleId===t){s=!0;break}s||V.push({tableId:e,eleId:t,prevState:n,pr:a})}function W(){V=[]}function H(e){Y={},e&&(K={})}function J(){return q}function F(e){B=e}function G(){RangeSelector.isActive()&&(Q=ProtectedRanges.getObject().isHighlight()?!1:!0,ProtectedRanges.getObject().getRanges().highlight())}var B=!1,q=[],V=[],K={},Y={},Q=!1;return{getModifiedRanges:J,protectRangeMenu:e,protectSheetMenu:t,showProtectedRangeDialog:n,onDialogSubmit:s,showManageProtectedRangeDialog:o,constructManageProtectRangeDiv:r,constructManageProtectSheetDiv:d,getProtectedSheetsInfo:g,getProtectedRangesInfo:i,saveChangesInManage:R,handleDeletionInManage:E,resetManageDialog:C,refreshManageDialog:k,setLockOption:P,collapseAll:_,expandAll:w,setAlreadyProtected:F,tempHighlight:G,openManageRangeTab:c}}();
var ObjectUtil={isUndefined:function(t){return"undefined"==typeof t}},ZS_Range=function(t,e,i,n,s){this.initialize(t,e,i,n),this.lock=ObjectUtil.isUndefined(s)?!1:s};ZS_Range.prototype={initialize:function(t,e,i,n){this.startRow=t,this.startCol=e,this.endRow=i,this.endCol=n,this.divElement=null},addDivElement:function(t,e,i){null==this.divElement&&0==ObjectUtil.isUndefined(t)?(this.divElement=new ZS_Div(t,this),this.divElement.addElement(e)):i&&(this.divElement.highlight(!0,this.lock,!1,this),this.lock&&this.divElement.lock())},removeDivElement:function(t){null!=this.divElement&&(this.divElement.removeElement(t),t||(this.divElement=null))},getDivElement:function(){return this.divElement},isLock:function(){return this.lock},setLock:function(t){this.lock=t},getStartRow:function(){return this.startRow},getStartCol:function(){return this.startCol},getEndRow:function(){return this.endRow},getEndCol:function(){return this.endCol},setStartRow:function(t){this.startRow=t},setStartCol:function(t){this.startCol=t},setEndRow:function(t){this.endRow=t},setEndCol:function(t){this.endCol=t},reset:function(t,e,i,n){this.initialize(t,e,i,n)},cloneRange:function(){return new ZS_Range(this.getStartRow(),this.getStartCol(),this.getEndRow(),this.getEndCol())},equals:function(t){return this.getStartRow()==t.getStartRow()&&this.getStartCol()==t.getStartCol()&&this.getEndRow()==t.getEndRow()&&this.getEndCol()==t.getEndCol()},intersect:function(t){var e=Math.max(this.getStartRow(),t.getStartRow()),i=Math.max(this.getStartCol(),t.getStartCol()),n=Math.min(this.getEndRow(),t.getEndRow()),s=Math.min(this.getEndCol(),t.getEndCol());return n>=e&&s>=i?new ZS_Range(e,i,n,s):null},isIntersect:function(t){return this.getStartRow()<=t.getEndRow()&&this.getStartCol()<=t.getEndCol()&&this.getEndRow()>=t.getStartRow()&&this.getEndCol()>=t.getStartCol()},isContains:function(t){return this.getStartRow()<=t.getStartRow()&&this.getStartCol()<=t.getStartCol()&&this.getEndRow()>=t.getEndRow()&&this.getEndCol()>=t.getEndCol()},isPartOfRange:function(t){var e=new Range(this.getStartRow(),this.getStartCol(),this.getEndRow(),this.getEndCol()),i=new Range(t.getStartRow(),t.getStartCol(),t.getEndRow(),t.getEndCol());return isPartOfRange(i,e)},isSingleCell:function(){return this.getStartRow()==this.getEndRow()&&this.getStartCol()==this.getEndCol()},isSheet:function(){return 0===this.getStartRow()&&0===this.getStartRow()&&this.getEndRow()===getRowMax()-1&&this.getEndCol()===getColMax()-1},insertRow:function(t,e){var i=!1;t<=this.getStartRow()?(this.startRow+=e,this.endRow+=e,i=!0):t>this.getEndRow()==0&&(this.endRow+=e,i=!0),1==i&&null!=this.divElement&&this.divElement.resizeByRowAction(this.startRow,this.endRow)},deleteRow:function(t,e){var i=!1,n=t+e-1;return this.getEndRow()<=n&&this.getStartRow()>=t?!1:(n<this.getStartRow()?(this.startRow-=e,this.endRow-=e,i=!0):t>this.getEndRow()==0&&(t<this.getStartRow()&&(this.startRow=t),n<=this.getEndRow()?this.endRow-=e:this.endRow=t-1,i=!0),1==i&&null!=this.divElement&&this.divElement.resizeByRowAction(this.startRow,this.endRow),!0)},insertCol:function(t,e){var i=!1;t<=this.getStartCol()?(this.startCol+=e,this.endCol+=e,i=!0):t>this.getEndCol()==0&&(this.endCol+=e,i=!0),1==i&&null!=this.divElement&&this.divElement.resizeByColAction(this.startCol,this.endCol)},deleteCol:function(t,e){var i=!1,n=t+e-1;return n>=this.getEndCol()&&t<=this.getStartCol()?!1:(n<this.getStartCol()?(this.startCol-=e,this.endCol-=e,i=!0):t>this.getEndCol()==0&&(t<this.getStartCol()&&(this.startCol=t),n<=this.getEndCol()?this.endCol-=e:this.endCol=t-1,i=!0),1==i&&null!=this.divElement&&this.divElement.resizeByColAction(this.startCol,this.endCol),!0)},resizeRow:function(t){null!=this.divElement&&t<=this.endRow&&this.divElement.resizeByRowAction(this.startRow,this.endRow)},resizeColumn:function(t){null!=this.divElement&&t<=this.endCol&&this.divElement.resizeByColAction(this.startCol,this.endCol)},freeze:function(){null!=this.divElement&&this.divElement.handleFreeze()},unFreeze:function(){null!=this.divElement&&this.divElement.handleUnfreeze()}};var ZS_Div=function(t,e){this.parentElementId=t,this.elements=[],this.rangeObj=e};ZS_Div.prototype={_addElement:function(t,e,i){var n;ObjectUtil.isUndefined(e)?(n=getObj(this.parentElementId),e=0):n=getObj(this.parentElementId+e),null!=n&&0==ObjectUtil.isUndefined(t)&&null!=t&&(0==ObjectUtil.isUndefined(i)&&1==i&&(t=$(t).clone(!0).get(0)),n.appendChild(t),this.elements[e]=t,this._setPosition(e))},_setPosition:function(t){var e=this._getElementObj(t);if(0==ObjectUtil.isUndefined(e)&&null!=e)if(e.style.top=getRowTop(this.rangeObj.getStartRow())+"px",e.style[isRTL?"right":"left"]=getColLeft(this.rangeObj.getStartCol())+"px",thirdPaneTop||secondPaneLeft){t=parseInt(t);var i=-1*thirdPaneTop+"px",n=-1*secondPaneLeft+"px";switch(t){case 1:e.style[isRTL?"marginRight":"marginLeft"]=0,e.style.marginTop=0;break;case 2:e.style.marginTop=0,e.style[isRTL?"marginRight":"marginLeft"]=n;break;case 3:e.style[isRTL?"marginRight":"marginLeft"]=0,e.style.marginTop=i;break;default:e.style[isRTL?"marginRight":"marginLeft"]=n,e.style.marginTop=i}}else e.style[isRTL?"marginRight":"marginLeft"]=0,e.style.marginTop=0},_getElementObj:function(t){return ObjectUtil.isUndefined(t)&&(t=0),this.elements[t]},_removeElement:function(t,e,i){var n=this.elements[i];if(0==ObjectUtil.isUndefined(n)&&null!=n&&null!=n.parentNode){if(e)return void(n.className="pRH");n.parentNode.removeChild(n)}return 1==t&&(delete n,delete this.elements[i]),n},_resizeHeight:function(t,e){var i=this._getElementObj(e);0==ObjectUtil.isUndefined(i)&&null!=i&&(i.style.height=t,this._setPosition(e))},_resizeWidth:function(t,e){var i=this._getElementObj(e);0==ObjectUtil.isUndefined(i)&&null!=i&&(i.style.width=t,this._setPosition(e))},_lock:function(t){var e=this._getElementObj(t);$(e).addClass("pR")},_highlight:function(t,e,i,n,s){var o=this._getElementObj(s);0==ObjectUtil.isUndefined(o)&&null!=o&&(i||(t?this._addHighlightDiv(o,n):$(o).removeClass("pRH")))},_getNewElement:function(t,e){var i=getColLeft(e.getStartCol()),n=getRowTop(e.getStartRow()),s=getRowTop(e.getEndRow())+getRowHeight(e.getEndRow())-getRowTop(e.getStartRow())-1,o=getColLeft(e.getEndCol())+getColWidth(e.getEndCol())-getColLeft(e.getStartCol())-1,l=document.createElement("SVG");return l.style.position="absolute",l.style.left=i+"px",l.style.top=n+"px",l.style.width=o+"px",l.style.height=s+"px",0==t&&(e.isLock()&&(l.className="pR"),ProtectedRanges.getObject().isHighlight()&&this._addHighlightDiv(l,e)),l},_addHighlightDiv:function(t,e){$(t).addClass("pRH"),$(t).append($("<div/>",{class:"pRHL"}).bind("click",function(){focusCellRange(e.getStartRow(),e.getStartCol(),e.getEndRow(),e.getEndCol(),void 0,!0),protectionDialog.setAlreadyProtected(!0),protectionDialog.showProtectedRangeDialog(!1,!1,e,null,!1)})),isRTL&&$(t).children().css("transform","scaleX(-1)")},_iterateAllElements:function(t,e){var i,n=this.elements.length;for(i=0;n>i;i++)if(null!=this.elements[i]){var s=[];e&&(s=e.slice()),s.push(i),t.apply(this,s)}},_iterateAllObjects:function(t,e){if(0==ISFREEZED)t.apply(this,e);else{var i=!1,n=e.length;(this.rangeObj.getStartRow()>=FREEZED_ROW&&this.rangeObj.getStartCol()>=FREEZED_COL||this.rangeObj.getEndRow()>=FREEZED_ROW&&this.rangeObj.getEndCol()>=FREEZED_COL)&&(t.apply(this,e),i=!0),FREEZED_COL>0&&FREEZED_ROW>0&&this.rangeObj.getStartRow()<FREEZED_ROW&&this.rangeObj.getStartCol()<FREEZED_COL&&(e.splice(n,2,"1",i),t.apply(this,e),i=!0),FREEZED_ROW>0&&this.rangeObj.getStartRow()<FREEZED_ROW&&(0>=FREEZED_COL||FREEZED_COL>0&&this.rangeObj.getEndCol()>=FREEZED_COL)&&(e.splice(n,2,"2",i),t.apply(this,e),i=!0),FREEZED_COL>0&&this.rangeObj.getStartCol()<FREEZED_COL&&(0>=FREEZED_ROW||FREEZED_ROW>0&&this.rangeObj.getEndRow()>=FREEZED_ROW)&&(e.splice(n,2,"3",i),t.apply(this,e))}},handleUnfreeze:function(){var t=this.elements.length;if(null==this.elements[0]){var e,i;for(i=1;t>i;i++)if(null!=this.elements[i]){e=this.elements[i];break}this.removeElement(),this._addElement(e,void 0,!1)}else{for(i=1;t>i;i++)this._removeElement(!0,!1,i);this._setPosition(0)}},handleFreeze:function(){var t=this.rangeObj,e=getSheetPaneIds(t.getStartRow(),t.getStartCol(),t.getEndRow(),t.getEndCol()),i=e.indexOf(0),n=this.elements[0];-1==i?this._removeElement(!0,!1,0):(this._setPosition(0),e.splice(i,1));for(var s=0;s<e.length;s++)this._addElement(n,e[s],!0)},resizeByRowAction:function(t,e){var i=getRowTop(e)+getRowHeight(e)-getRowTop(t)-1;i+="px",this._iterateAllElements(this._resizeHeight,[i])},resizeByColAction:function(t,e){var i=getColLeft(e)+getColWidth(e)-getColLeft(t)-1;i+="px",this._iterateAllElements(this._resizeWidth,[i])},removeElement:function(t){this._iterateAllElements(this._removeElement,[!0,t])},addElement:function(t){var e=this._getNewElement(t,this.rangeObj);this._iterateAllObjects(this._addElement,[e])},lock:function(){this._iterateAllElements(this._lock)},highlight:function(t,e,i,n){this._iterateAllElements(this._highlight,[t,e,i,n])},setPosition:function(){this._iterateAllElements(this._setPosition)}};var ZS_Iterator=function(t,e){ObjectUtil.isUndefined(t)?this.elements=[]:0==ObjectUtil.isUndefined(t.size)||0==ObjectUtil.isUndefined(t.length)?this.elements=t:(this.elements=[],this.elements[0]=t),this.index=0,this.reverseIteration=0==ObjectUtil.isUndefined(e)&&1==e?!0:!1,1==this.reverseIteration&&(this.index=this.size())};ZS_Iterator.prototype={size:function(){return 0==ObjectUtil.isUndefined(this.elements.size)?this.elements.size():0==ObjectUtil.isUndefined(this.elements.length)?this.elements.length:0},hasNext:function(){return 0!=this.size()&&(0==this.reverseIteration?this.index<this.size():this.index>0)},next:function(){return 0==this.reverseIteration?this.elements[this.index++]:this.elements[--index]},reset:function(){this.index=0==this.reverseIteration?0:this.size()},skip:function(t){0==this.reverseIteration?(this.index+=t,this.index>this.size()&&(this.index=this.size())):(this.index-=t,this.index<0&&(this.index=0))},move:function(t){t>=0&&t<this.size()&&(this.index=t)},nextIndex:function(){return this.index},removeLastIteratedElement:function(){var t=0==this.reverseIteration?this.index-1:this.index;t>=0&&t<this.size()&&this.elements.splice(t,1)}};var ZS_RangeList=function(t,e,i){this.list=[],0==ObjectUtil.isUndefined(t)&&(this.parentElementId=t),0==ObjectUtil.isUndefined(i)&&(this.type=i),this.manageDivElements=0==ObjectUtil.isUndefined(e)?e:!1};ZS_RangeList.prototype={initialize:function(t){if(this.clearList(),0==ObjectUtil.isUndefined(t))for(var e,i=new ZS_Iterator(t);i.hasNext();)e=this.getRangeFromJson(i.next()),this.addRangeInList(e)},addRangeInList:function(t){this.list.push(t),this.addElement(t)},addElement:function(t,e){1!=this.manageDivElements||1!=t.isLock()&&!ProtectedRanges.getObject().isHighlight()||t.addDivElement(this.parentElementId,this.type,e)},getRangeFromJson:function(t){return new ZS_Range(t[JSONConstants.START_ROW],t[JSONConstants.START_COLUMN],t[JSONConstants.END_ROW],t[JSONConstants.END_COLUMN],t[JSONConstants.LOCK])},getRangeFromObject:function(t,e,i,n,s){return new ZS_Range(t,e,i,n,s)},clearList:function(){if(1==this.manageDivElements&&0==ObjectUtil.isUndefined(this.list))for(var t,e=new ZS_Iterator(this.list);e.hasNext();)t=e.next(),t.removeDivElement(),t=null;this.list=[]},reset:function(t){ObjectUtil.isUndefined(t)?this.clearList():this.initialize(t)},add:function(t){return 0==ObjectUtil.isUndefined(t)?(this.addRangeInList(t),!0):!1},addAll:function(t){for(var e=new ZS_Iterator(t.list),i=null;e.hasNext();)i=e.next(),null!=i&&0==ObjectUtil.isUndefined(i)&&this.addRangeInList(i)},remove:function(t){if(!ObjectUtil.isUndefined(t)&&t>=0&&t<this.size()){var e=this.list[t];return 1==this.manageDivElements&&e.removeDivElement(),this.list.splice(t,1),e}return null},removeRange:function(t){for(var e,i=null,n=null,s=new ZS_Iterator(this.list),o=this.size();s.hasNext()&&s.nextIndex()<o;)if(i=s.next(),!ObjectUtil.isUndefined(i)){if(e=s.nextIndex()-1,i.equals(t)){this.remove(e);break}n=i.intersect(t),null!=n&&(0==n.equals(i)&&(i.getStartRow()<n.getStartRow()&&(this.addRangeInList(this.getRangeFromObject(i.getStartRow(),i.getStartCol(),n.getStartRow()-1,i.getEndCol(),i.isLock())),i.setStartRow(n.getStartRow())),i.getStartCol()<n.getStartCol()&&(this.addRangeInList(this.getRangeFromObject(i.getStartRow(),i.getStartCol(),i.getEndRow(),n.getStartCol()-1,i.isLock())),i.setStartCol(n.getStartCol())),i.getEndRow()>n.getEndRow()&&(this.addRangeInList(this.getRangeFromObject(n.getEndRow()+1,i.getStartCol(),i.getEndRow(),i.getEndCol(),i.isLock())),i.setEndRow(n.getEndRow())),i.getEndCol()>n.getEndCol()&&this.addRangeInList(this.getRangeFromObject(i.getStartRow(),n.getEndCol()+1,i.getEndRow(),i.getEndCol(),i.isLock()))),this.remove(e),s.move(s.nextIndex()-1),o-=1)}},size:function(){return this.list.length},isEmpty:function(){return 0==this.size()},getRange:function(t){return!ObjectUtil.isUndefined(t)&&t<=this.size()?this.list[t]:null},getIterator:function(){return new ZS_Iterator(this.list)},getActualRangeObject:function(t){var e=this.find(t);return-1!=e?this.list[e]:null},getIntersectedRanges:function(t){var e=new ZS_RangeList;if(ObjectUtil.isUndefined(t))return!1;for(var i=new ZS_Iterator(this.list),n=null,s=null,o=!1;0==o&&i.hasNext();)n=i.next(),ObjectUtil.isUndefined(n)||null==n||(s=n.intersect(t),null!=s&&e.add(n));return e},isIntersect:function(t){if(ObjectUtil.isUndefined(t))return!1;for(var e=new ZS_Iterator(this.list),i=null,n=!1;0==n&&e.hasNext();)i=e.next(),ObjectUtil.isUndefined(i)||null==i||(n=i.isIntersect(t));return n},find:function(t){var e=-1;if(ObjectUtil.isUndefined(t))return e;for(var i=null,n=new ZS_Iterator(this.list);-1==e&&n.hasNext();)i=n.next(),ObjectUtil.isUndefined(i)||null==i||(e=i.equals(t)?n.nextIndex()-1:-1);return e},applyMethod:function(t,e){for(var i=null,n=new ZS_Iterator(this.list);n.hasNext();)i=n.next(),ObjectUtil.isUndefined(i)||null==i||t.apply(i,e)},callMethodByParam:function(t,e){for(var i=null,n=new ZS_Iterator(this.list);n.hasNext();)i=n.next(),ObjectUtil.isUndefined(i)||null==i||t.call({},i,e)},iterateRangeMethods:function(t,e,i){for(var n=null,s=new ZS_Iterator(this.list);s.hasNext();)if(n=s.next(),!ObjectUtil.isUndefined(n)&&null!=n){var o=t.apply(n,e);0==ObjectUtil.isUndefined(i)&&i.call({},o,n)}},shiftCells:function(t,e,i,n,s,o){var l=n-e+1,r=e,h=t,a=h+(i-t),g=getColMax()-1;s&&(l=i-t+1,r=t,h=e,a=h+(n-e),g=getRowMax()-1);var d=r+l-1;l=o?-l:l;for(var c=new ZS_Iterator(this.list);c.hasNext();){var u=c.next(),f=c.nextIndex()-1,E=s?u.getStartRow():u.getStartCol(),R=s?u.getEndRow():u.getEndCol(),m=s?u.getStartCol():u.getStartRow(),S=s?u.getEndCol():u.getEndRow();if(E>=r&&m>=h&&a>=S){var v=E+l;if(o?d>=R:v>g)this.remove(f);else{var C=Math.min(R+l,g);u.setStartRow(s?v:m),u.setStartCol(s?m:v),u.setEndRow(s?C:S),u.setEndCol(s?S:C),u.getDivElement()&&u.getDivElement().setPosition()}}}},highlight:function(){for(var t,e=this.getIterator();e.hasNext();)t=e.next(),(ObjectUtil.isUndefined(t.getDivElement())||null==t.getDivElement())&&t.addDivElement(this.parentElementId,this.type),t.getDivElement().highlight(!0,t.lock,t.isSheet(),t)},removeHighlight:function(){var t,e=this.getIterator();for($(".pRHL").remove();e.hasNext();)t=e.next(),0==t.isLock()?t.removeDivElement():t.getDivElement().highlight(!1,!0,t.isSheet(),t)}};var ZS_ProtectedSheetList=function(){this.list=[]};ZS_ProtectedSheetList.prototype={initialize:function(t){this.removeAll();for(var e=new ZS_Iterator(t);e.hasNext();)this.add(ZS_ProtectedSheet.getSheetObj(e.next()))},getIterator:function(){return new ZS_Iterator(this.list)},getSheetObj:function(t){for(var e,i=this.getIterator();i.hasNext();)if(e=i.next(),e.getName()==t)return e;return null},isSheetProtected:function(t){var e=this.getSheetObj(t);return null!=e&&e.isLock()},add:function(t){for(var e=this.getIterator(),i=!1;e.hasNext();)tempSheetObj=e.next(),tempSheetObj.getName()===t.name&&(tempSheetObj=t,i=!0);i||this.list.push(t),t.lockSheetTab()},remove:function(t){for(var e,i=this.getIterator(),n=-1;i.hasNext();)if(e=i.next(),e.getName()==t){e.unlockSheetTab(),n=i.nextIndex()-1;break}-1!=n&&(this.list[n]=null,this.list.splice(n,1))},removeAll:function(){for(var t=this.getIterator();t.hasNext();)t.next().unlockSheetTab();this.list=[]},renameSheet:function(t,e){var i=this.getSheetObj(t);null!=i&&(i.setName(e),i.lockSheetTab())},deleteSheet:function(t){for(var e,i=this.getIterator();i.hasNext();)e=i.next(),e.getName()===t&&i.removeLastIteratedElement()},highlight:function(){for(var t=this.getIterator();t.hasNext();){var e=t.next();e.highlight()}},removeHighlight:function(){for(var t=this.getIterator();t.hasNext();){var e=t.next();e.removeHighlight()}}};var ZS_ProtectedSheet=function(t,e,i){this.name=t,this.lock=e,this.position=i};ZS_ProtectedSheet.prototype={lockSheetTab:function(){if(this.lock){var t=WorkSheets.getSheetObjByName(this.name);void 0!=t&&(t.find("img.sheetLock").length||t.children("div:first").prepend($("<img/>",{src:IMAGE_PATH+"spacer.gif",class:"sheetLock"}))),CURRSHEETNAME===this.name&&(READ_WRITE=!1,mask.grid(!0,!1,!1,!0),menutabs.protectionBasedToggle(!0))}ProtectedRanges.getObject().isHighlight()&&this.highlight()},unlockSheetTab:function(t){var e=WorkSheets.getSheetObjByName(this.name);void 0!=e&&e.find("img.sheetLock").remove(),CURRSHEETNAME===this.name&&(READ_WRITE=!0,mask.grid(!1),menutabs.protectionBasedToggle(!1)),ProtectedRanges.getObject().isHighlight()&&!t&&this.removeHighlight()},isLock:function(){return this.lock},setLock:function(t){this.lock=t},setName:function(t){this.name=t},getName:function(){return this.name},highlight:function(){var t=WorkSheets.getSheetObjByName(this.name);t.addClass("pSH")},removeHighlight:function(){WorkSheets.getSheetObjByName(this.name).removeClass("pSH")}},ZS_ProtectedSheet.getSheetObj=function(t){return new ZS_ProtectedSheet(t[JSONConstants.SHEET_NAME],t[JSONConstants.LOCK],t[JSONConstants.POSITION])},ZS_ProtectedSheet.getSheetImgTag=function(){return"<img src='"+IMAGE_PATH+"spacer.gif' class='sheetLock'>"};
var checkbox=function(e){function t(t,n){n="undefined"==typeof n?t.getAttribute("cv"):n;var r="TRUE"===n?!0:!1;if(i(t))e(t).find(".cBC input").attr("checked",r);else{setCellContent(t,"");var c=(t.className,e("<label/>",{class:"cBC"}).append(e("<input/>",{type:"checkbox",checked:r}).after(e("<span/>")))),o=getCellContentNode(t);e(o).append(c);var l=getCSSStyleRegex("textAlign");addCssStyleValueForCell(t,"textAlign"," tac",l),l=getCSSStyleRegex("verticalAlign"),addCssStyleValueForCell(t,"verticalAlign"," vam",l),f||(a(),f=!0)}t.setAttribute("fn",n),t==currCell&&(exprField.value=n)}function n(e,t,n,a){var r=new Range(e,t,n,a),c=r.getIterator();c.iterate(function(e,t){new Cell(e,t).executeMethod(checkbox.add)})}function a(){e("#editorDIV").on("mousedown",".cBC",function(e){c(e.target.parentElement)})}function r(e){var t;"T"===e||"t"===e||"Y"===e||"y"===e||"1"===e?t=!0:"F"===e||"f"===e||"N"===e||"n"===e||"0"===e?t=!1:" "===e&&(t=!l()),"undefined"!=typeof t&&s(ActionConstants.CHECKBOX_EDIT,t?1:0)}function c(t){if(READ_WRITE&&documentBakeStatus.isBaked()){var n=getServerRange();if(ProtectedRanges.isRangeLocked(n.startRow,n.startCol,n.endRow,n.endCol))return!1;t.click(),s(ActionConstants.CHECKBOX_EDIT,e(t).find("input").is(":checked")?1:0)}}function i(t){return"undefined"==typeof t&&(t=currCell),1===e(t).find(".cBC").length}function o(t){return e(t).find(".cBC")}function l(t){return"undefined"==typeof t&&(t=currCell),e(t).find(".cBC input").is(":checked")}function s(e,t){var n=getServerRange(),a=n.startRow,r=n.startCol,c=n.endRow,i=n.endCol;if(ProtectedRanges.isRangeLocked(a,r,c,i))return!1;var o=new RequestParameters(1*e);o.setParameters(WorkSheets.getSheetCodeFromName(CURRSHEETNAME),a,r,c,i,t);var l=new AjaxRequest;l.init("POST",o.getURL(),!0,o.getParametersAsString()),actionManager.addRequest(l)}function d(e){var t=e.parentElement;return t?"cBC"===t.className:!1}function u(e){if(i(e)){var t=e.className,n=t.replace(" tac","").replace("vam",""),a=/( (fa|ta)[rc])(\b)/i;a.test(n)||-1!=n.indexOf(" W")||removeFlexBoxDiv(e),e.className=n}}var f=!1;return{add:t,addToRange:n,edit:r,toggle:c,isPresent:i,isOwnDiv:d,getFromCell:o,sendRequest:s,clear:u}}(jQuery);
var Goto=function(e){var t,o,n,l,a=[],r=-1,s=!1,c=!1,f=function(){a=NamedRange.getNamedRangesList(),a=a.sort()},g=function(){f();var t={width:"300px",title:jsMsg.Goto},o={init:function(){u(),d(),setTimeout(function(){e("#cellRef").focus()},200)}};sheetdialog.open("gotodialog",t,o)},u=function(){var t="style='padding:3px'",o="";if(0!=a.length){for(i=0;i<a.length;i++){var n=a[i];o+="<div id='definedNameTR_"+i+"' "+t+" onclick=\"Goto.gotoCellInit('"+n+"', 'NAME')\" title='"+n+"'>"+n+"</div>"}e("#nameListDIV").append(o),e("#nameContainerDIV").show()}},d=function(){e("#cellRef").on("keyup",function(e){v(e,this)}),e("#cellRef").on("keydown",function(e){if(browser_ie){var t=window.event.keyCode;13===t&&e.preventDefault()}}),e("#name_createBtn").on("click",function(){p(void 0,"CELLVALUE")})},C=function(t){var o=t?currCellIndicator.value.trim().toUpperCase():e("#cellRef").val().trim().toUpperCase();a.length||f();for(var n=0,l=0;l<a.length;l++){var i=e(t?"#defNameTR_"+l:"#definedNameTR_"+l);0!=a[l].toUpperCase().indexOf(o)?i.hide():(n++,i.show())}var r=e("#nameListDIV");r.length&&(0==n?r.hide():r.show())},v=function(t,o){var n=t.which;if(13===n){if(null!==e("#cellRef").val()&&0===e("#cellRef").val().trim().length)return;p(void 0,"CELLVALUE")}else h(o),C()},h=function(t){var o=e(t).val();o.trim()?e("#name_createBtn").enable():e("#name_createBtn").disable()},p=function(e,t){if(e||t){switch(t){case"CELLVALUE":R(e);break;case"LABEL":S(e);break;case"NAME":E(e);break;case"PARAM":m(e);break;default:R(e)}appEvent.trigger("HistoryAPI",["rangeSelection"])}else{if(c)return c=!1,appEvent.preventDefault();if(s)return b(l),D(),s=!1,appEvent.preventDefault()}},R=function(t){var o=e("#cellRef"),n=t?t:o.val().trim();n=n.replace(/\$/g,"").replace(".","!"),m(n)},m=function(e){var t=e;if(-1!=t.indexOf("!")&&(t=t.substring(t.indexOf("!")+1,t.length)),CellUtils.isDefinedName(t))return E(t),!1;CellUtils.isDefinedSheet(e)&&(e+="!A1");var o=e.substring(0,e.indexOf("!"));return o&&!CellUtils.isDefinedSheet(o)?(showAlertDialog(jsMsg.InvalidSheetName),!1):void(CellUtils.checkCellLbl(e)?S(e):showAlertDialog(jsMsg.InvalidCellReference))},E=function(e){var l,i=!1;if(l=NamedRange.getNamedRangeInfo(e,"REFSHEET"),i=NamedRange.isNamedRange(e))if(l){var a=NamedRange.getRange(e);l=a.sheetName,r=a.startRow,t=a.startCol,o=a.endRow,n=a.endCol,L(l)}else{var s=ActiveCellInfo,c=new RequestParameters(ActionConstants.NAMEDRANGE_READ);c.setParameters(WorkSheets.getAssociatedActiveSheetName(),e,s.getStartRow(),s.getStartCol(),s.getStartRow(),s.getStartCol());var f=new AjaxRequest;f.init("POST",c.getURL(),!0,c.getParametersAsString()),f.addEventListener("onComplete",function(e){w(e,l)}),f.sendRequest()}},w=function(e,l){var i=parseJSON(e.responseText);l=i.sn,r=i.sr,t=i.sc,o=i.er,n=i.ec,L(l)},S=function(e){l=e,l=l.replace(".","!");var t=!0,o=CURRSHEETNAME;return-1!=l.indexOf("!")&&(o=l.substring(0,l.indexOf("!")),o=CellUtils.getRequiredSheetNames(o).sheetName,l=l.substring(l.indexOf("!")+1,l.length),t=!1),o!=CURRSHEETNAME||b(l)?(l.indexOf(":")>0&&getDataFrom2DRangeText(l)&&k(l),void(t||o===CURRSHEETNAME?D():(workbookData.switchSheet=!0,s=!0,showsheet("sheetdiv-"+WorkSheets.getSheetCodeFromName(o),"open")))):!1},N=function(e,t){return e=parseInt(e),t=parseInt(t),t>totCols?(showAlertDialog(jsMsg.NotYetCreatedCell),!1):(Row.isAppendable(e)&&appendBlankRows("ROWS_EXCEEDED",e+1),isCustomScroll=!0,scrollRowIntoView(e),scrollColIntoView(t),!0)},b=function(e){var t,o=e;if(o.indexOf(":")>0){var n=o.substring(0,o.indexOf(":"));t=CellUtils.getCellPosByLabel(n)}else t=CellUtils.getCellPosByLabel(o);if(t.col>totCols-1){showAlertDialog(jsMsg.NotYetCreatedCell);var l=getObj("cellRef");return null!=l&&(l.focus(),l.select()),!1}return!0},A=function(e,l,i,a,s,f,g){r=l,t=a,o=i,n=s,c=f||g,e!=CURRSHEETNAME&&CellUtils.isDefinedSheet(e)?(showsheet("sheetdiv-"+WorkSheets.getSheetCodeFromName(e),"open",!1,f),appEvent.on("book.sheetloaded",U)):D()},D=function(){null!=getObj("cellRef")&&getObj("cellRef").blur();var e=getRowMax(),i=getColMax();if(-1==r){var a=CellUtils.getCellPosByLabel(l);a.row>=e&&(a.row=e-1),a.col>=i&&(a.col=i-1),sheetdialog.allowToClose&&sheetdialog.close(),isCustomScroll=!0,focusCell(a.row,a.col)}else r>=e&&(r=e-1),o>=e&&(o=e-1),t>=i&&(t=i-1),n>=i&&(n=i-1),sheetdialog.allowToClose&&sheetdialog.close(),r==o&&t==n?(isCustomScroll=!0,focusCell(parseInt(r),parseInt(t))):(isCustomScroll=!0,focusCellRange(parseInt(o),parseInt(n),parseInt(r),parseInt(t))),r=-1,t=o=n=0;appEvent.trigger("onGotoDone")},L=function(e){e&&(0==e.indexOf("'")&&(e=e.substring(1,e.length-1)),""!=e&&CellUtils.isDefinedSheet(e)?e!=CURRSHEETNAME?(showsheet("sheetdiv-"+WorkSheets.getSheetCodeFromName(e),"open"),appEvent.on("book.sheetloaded",U)):D():sheetdialog.close())},U=function(){D(),appEvent.off("book.sheetloaded",U)},k=function(e,l){var i=e.split(":"),a=CellUtils.getCellPosByLabel(i[0]),s=CellUtils.getCellPosByLabel(i[1]);if(a.col<0||s.col<0){var c=getDataFrom2DRangeText(e);if(void 0==c)return!1;a={},s={},a.row=c.sR,a.col=c.sC,s.row=c.eR,s.col=c.eC}return"undefined"==typeof l&&(r=a.row,t=a.col,o=s.row,n=s.col),!0},I=function(){return l},x=function(){return s},O=function(){return s?!0:!1};return appEvent.on("book.sheetloaded",function(){return p()}),appEvent.on("goto.focused",function(){return p()}),appEvent.on("goto.fromdialog",function(){return x()}),appEvent.on("goto.getLbl",function(){return I()}),{showDialog:g,suggestNamedRanges:C,gotoCellInit:p,doGoto:A,gotoCellPosition:N,isPreventDefault:O,getLbl:I}}(jQuery);
function flipSheet(e){if(prevSheetStyle=isRTL,translateViewId($(e).attr("id"))!=prevSheetStyle){isRTL=!isRTL;var t=new RequestParameters(ActionConstants.SAVE_RTL_SHEET);t.setParameters(WorkSheets.getAssociatedActiveSheetName(),isRTL);var s=new AjaxRequest;s.init("POST",t.getURL(),!0,t.getParametersAsString()),actionManager.addRequest(s),changeAlignIcon(),toggleCellInsertOption(),setSheetDirectionLabel()}}function flipColHeaders(){for(var e=document.getElementById("cHT").children,t=0;t<e.length;t++)isRTL?(e[t].style.right=e[t].style.left,e[t].style.left=null,document.getElementsByClassName("selectAllBg")[0].style.right="23px",document.getElementsByClassName("selectAllBg")[0].style.transform="scaleX(-1)"):(e[t].style.left=e[t].style.right,e[t].style.right=null,document.getElementsByClassName("selectAllBg")[0].style.right="",document.getElementsByClassName("selectAllBg")[0].style.left="23px",document.getElementsByClassName("selectAllBg")[0].style.transform="")}function toggleWritingDirection(){$("#sheetDir").attr("checked",!$("#sheetDir").is(":checked"))}function toggleCellInsertOption(){isRTL?($("#cellOptMenus > #insertLeft").hide(),$("#cellOptMenus > #insertRight").show(),$("#cellOptMenus > #deleteRight").hide(),$("#cellOptMenus > #deleteLeft").show(),$("#insertCellSub > #insertLeft").hide(),$("#insertCellSub > #insertRight").show()):($("#cellOptMenus > #insertRight").hide(),$("#cellOptMenus > #insertLeft").show(),$("#cellOptMenus > #deleteLeft").hide(),$("#cellOptMenus > #deleteRight").show(),$("#insertCellSub > #insertLeft").show(),$("#insertCellSub > #insertRight").hide())}function getOffsetRight(e){for(var t=e.offsetWidth,s=0;e.offsetParent;)s+=e.offsetLeft,e=e.offsetParent;return s+=e.offsetLeft,s=clientDim.width-s,s-=t}function setSheetDirectionLabel(){var e=$("#shtDirectbtn").children();isRTL?($("#rtls").addClass("ui-state-active"),$("#ltrs").removeClass("ui-state-active"),0!=e.length&&(e[1].innerHTML=jsMsg["View.SheetDirection.Rtl"],$(e[0]).removeClass(" zicon-ltr"),$(e[0]).addClass(" zicon-rtl")),$(".zsicon-freeze-first-column").addClass("scaleX"),$(".zsicon-freeze-panes").addClass("scaleX"),$(".zsicon-merge-across").addClass("scaleX")):($("#ltrs").addClass("ui-state-active"),$("#rtls").removeClass("ui-state-active"),0!=e.length&&(e[1].innerHTML=jsMsg["View.SheetDirection.Ltr"],$(e[0]).addClass(" zicon-ltr"),$(e[0]).removeClass(" zicon-rtl")),$(".zsicon-freeze-first-column").removeClass("scaleX"),$(".zsicon-freeze-panes").removeClass("scaleX"),$(".zsicon-merge-across").removeClass("scaleX"))}function translateViewId(e){var t=null;return"ltrs"==e?t=!1:"rtls"==e&&(t=!0),t}function checkAndFlipSheet(e){var t=e.isRTL;null!=t&&isRTL!=t&&flipSheet()}function openExplore(){var e=getCellRange(),t=new RequestParameters(ActionConstants.OPEN_EXPLORE);t.setParameters(WorkSheets.getAssociatedActiveSheetName(),e.startRow,e.startCol,e.endRow,e.endCol);var s=new AjaxRequest;s.init("POST",t.getURL(),!0,t.getParametersAsString()),s.addEventListener("onComplete",function(e){recArray=JSON.parse(e.responseText).recList,renderRecommendationList()}),s.sendRequest()}function renderQueryField(){var e="<div onkeydown='submitQuery(this,event)' style='margin-left:20px;width:90%;' class='ztextbox--group ztextbox--zicon h-alignright'><i onclick='initAnnayang()'style='cursor:pointer;'  class='ztextbox__icon'><svg style='fill:black'id='micIcon' viewBox='0 0 475.085 475.085'  width='20px' height='20px'><g id='surface1'><path d='M237.541,328.897c25.128,0,46.632-8.946,64.523-26.83c17.888-17.884,26.833-39.399,26.833-64.525V91.365c0-25.126-8.938-46.632-26.833-64.525C284.173,8.951,262.669,0,237.541,0c-25.125,0-46.632,8.951-64.524,26.84c-17.893,17.89-26.838,39.399-26.838,64.525v146.177c0,25.125,8.949,46.641,26.838,64.525C190.906,319.951,212.416,328.897,237.541,328.897z'></path><path d='M396.563,188.15c-3.606-3.617-7.898-5.426-12.847-5.426c-4.944,0-9.226,1.809-12.847,5.426c-3.613,3.616-5.421,7.898-5.421,12.845v36.547c0,35.214-12.518,65.333-37.548,90.362c-25.022,25.03-55.145,37.545-90.36,37.545c-35.214,0-65.334-12.515-90.365-37.545c-25.028-25.022-37.541-55.147-37.541-90.362v-36.547c0-4.947-1.809-9.229-5.424-12.845c-3.617-3.617-7.895-5.426-12.847-5.426c-4.952,0-9.235,1.809-12.85,5.426c-3.618,3.616-5.426,7.898-5.426,12.845v36.547c0,42.065,14.04,78.659,42.112,109.776c28.073,31.118,62.762,48.961,104.068,53.526v37.691h-73.089c-4.949,0-9.231,1.811-12.847,5.428c-3.617,3.614-5.426,7.898-5.426,12.847c0,4.941,1.809,9.233,5.426,12.847c3.616,3.614,7.898,5.428,12.847,5.428h182.719c4.948,0,9.236-1.813,12.847-5.428c3.621-3.613,5.431-7.905,5.431-12.847c0-4.948-1.81-9.232-5.431-12.847c-3.61-3.617-7.898-5.428-12.847-5.428h-73.08v-37.691c41.299-4.565,75.985-22.408,104.061-53.526c28.076-31.117,42.12-67.711,42.12-109.776v-36.547C401.998,196.049,400.185,191.77,396.563,188.15z'></path></g></svg></i><input id='query' autocomplete='off' style='height:35px;box-shadow: 0px 0px 2px 0px rgba(0,0,0,0.12), 0px 2px 2px 0px rgba(0,0,0,0.24);border: thin;background: #fafafa;' type='text' class='ztextbox' placeholder='Place Your Query'></div>";$("#recommendedNLPQuery").append($(e))}function renderRecommendationList(){var e="<div style='padding-left:25px;font-size:15px;margin-top:15px;margin-bottom:11px;font-weight:400;font-family:arial,sans-sarif;color:black;display:none;'>Recommended Queries</div>";for(i=0;i<recArray.length;i++)e+="<div onClick='sendQuery(this)' id='listDiv' style='padding-left:25px;' class='zlist zlist--textonly'><i style='vertical-align: sub;' class='ztextbox__icon'><svg viewBox='0 0 32 32' width='16px' height='16px'><g ><path style=''  d='M 10 0.1875 C 4.578125 0.1875 0.1875 4.578125 0.1875 10 C 0.1875 15.421875 4.578125 19.8125 10 19.8125 C 12.289063 19.8125 14.394531 19.003906 16.0625 17.6875 L 16.9375 18.5625 C 16.570313 19.253906 16.699219 20.136719 17.28125 20.71875 L 21.875 25.34375 C 22.589844 26.058594 23.753906 26.058594 24.46875 25.34375 L 25.34375 24.46875 C 26.058594 23.753906 26.058594 22.589844 25.34375 21.875 L 20.71875 17.28125 C 20.132813 16.695313 19.253906 16.59375 18.5625 16.96875 L 17.6875 16.09375 C 19.011719 14.421875 19.8125 12.300781 19.8125 10 C 19.8125 4.578125 15.421875 0.1875 10 0.1875 Z M 10 2 C 14.417969 2 18 5.582031 18 10 C 18 14.417969 14.417969 18 10 18 C 5.582031 18 2 14.417969 2 10 C 2 5.582031 5.582031 2 10 2 Z M 4.9375 7.46875 C 4.421875 8.304688 4.125 9.289063 4.125 10.34375 C 4.125 13.371094 6.566406 15.8125 9.59375 15.8125 C 10.761719 15.8125 11.859375 15.433594 12.75 14.8125 C 12.511719 14.839844 12.246094 14.84375 12 14.84375 C 8.085938 14.84375 4.9375 11.695313 4.9375 7.78125 C 4.9375 7.675781 4.933594 7.574219 4.9375 7.46875 Z ''></path></g></svg></i><span style='white-space:unset;vertical-align: text-top;color: #4f4f4f' class='zlist__text'>"+recArray[i]+"</span></div>";$("#recommendedNLPQuery").append($(e))}function submitQuery(e,t){13==t.keyCode&&sendQuery(e)}function sendQuery(e){query=e.textContent,("  "===query||null==query||""===query)&&(query=$("#query").val()),$("#query").val(query);var t=new RequestParameters(ActionConstants.NL_QUERY),s=new AjaxRequest;s.init("POST",t.getURL(),!0,t.getParametersAsString()),s.addEventListener("onComplete",function(e){var t=JSON.parse(e.responseText).result;formula=t.formula,result=t.result,naturalString=t.naturalString,relatedArray=t.related,refreshNlSection()}),s.sendRequest()}function refreshNlSection(){$("#recommendedNLPQuery").empty();var e="<div style='padding-left:15px;line-height:2;font-size:initial;''><div><b  style='color:rgb(79,129,189);'>Query:	</b><div>"+query+"</div></div><div><b style='color:rgb(79,129,189);'>Answer:</b><div>"+naturalString+"</div></div><div style='cursor:pointer;margin-top: -138px;float:right;'' class='bluewhite zlabel zlabel--small ' onclick='reconstructInitial()'>X</div></div>";$("#recommendedNLPQuery").append($(e));var t="<table style='width:100%;cursor:initial;margin-top:10px;'' class='ztable ztable--textellipsis ztable--border' cellpadding='0' cellspacing='0' border='0' align='center'><tbody><tr><th style='background-color:rgb(79,129,189);color:white;font-weight:400px;font-size:15px;' class='ztable--icon ztable__highlightbg'><span style='font-weight:400;' class='ztable--text'>Formula</span></th></tr><tr><td class='ztable--icon'>  <span style='white-space:pre-wrap' class='ztable--text'>"+formula+"</span></td> </tr><tr><th style='background-color:rgb(79,129,189);color:white;font-weight:400px;font-size:15px;' class='ztable--icon'>  <span style='font-weight:400' class='ztable--text'>Result</span></th> </tr><tr><td class='ztable--icon'>  <span class='ztable--text'>"+result+"</span></td> </tr></tbody></table>";$("#recommendedNLPQuery").append($(t)),renderRelated()}function reconstructInitial(){$("#recommendedNLPQuery").empty(),renderQueryField(),renderRecommendationList()}function renderRelated(){var e="<div style='padding-left:15px;height: 30px;font-size:15px;vertical-align: middle;background-color:rgb(79,129,189);line-height:2;color:white'>Related Queries:</div>";$("#recommendedNLPQuery").append($(e));var t;for(i=0;i<relatedArray.length;i++)t+="<div onClick='sendQuery(this)' id='listDiv' style='padding-left:25px;' class='zlist zlist--textonly'><i class='ztextbox__icon'><svg viewBox='0 0 32 32' width='16px' height='16px'><g ><path style=''  d='M 10 0.1875 C 4.578125 0.1875 0.1875 4.578125 0.1875 10 C 0.1875 15.421875 4.578125 19.8125 10 19.8125 C 12.289063 19.8125 14.394531 19.003906 16.0625 17.6875 L 16.9375 18.5625 C 16.570313 19.253906 16.699219 20.136719 17.28125 20.71875 L 21.875 25.34375 C 22.589844 26.058594 23.753906 26.058594 24.46875 25.34375 L 25.34375 24.46875 C 26.058594 23.753906 26.058594 22.589844 25.34375 21.875 L 20.71875 17.28125 C 20.132813 16.695313 19.253906 16.59375 18.5625 16.96875 L 17.6875 16.09375 C 19.011719 14.421875 19.8125 12.300781 19.8125 10 C 19.8125 4.578125 15.421875 0.1875 10 0.1875 Z M 10 2 C 14.417969 2 18 5.582031 18 10 C 18 14.417969 14.417969 18 10 18 C 5.582031 18 2 14.417969 2 10 C 2 5.582031 5.582031 2 10 2 Z M 4.9375 7.46875 C 4.421875 8.304688 4.125 9.289063 4.125 10.34375 C 4.125 13.371094 6.566406 15.8125 9.59375 15.8125 C 10.761719 15.8125 11.859375 15.433594 12.75 14.8125 C 12.511719 14.839844 12.246094 14.84375 12 14.84375 C 8.085938 14.84375 4.9375 11.695313 4.9375 7.78125 C 4.9375 7.675781 4.933594 7.574219 4.9375 7.46875 Z ''></path></g></svg></i><span style='white-space:unset;' class='zlist__text'>"+relatedArray[i]+"</span></div>";$("#recommendedNLPQuery").append($(t))}var RTL={dirRtl:!1};Object.defineProperty(window,"isRTL",{set:function(e){RTL.dirRtl=e},get:function(){return RTL.dirRtl}});var recArray,formula,result,query,naturalString,relatedArray;appEvent.on("book.onaftersheetswitch",setSheetDirectionLabel);
var currentHeader="autoFilterHeader",isFilterOpenedLeft=!1,displayMaxDataInfo=!1,maxFilterCriteria,cellColor=new Array,textColor=new Array,isReset=!1,currentFilterIndex;Filter.width={normalContainerWidth:"271px",expandedContainerWidth:"311px",topBotComboWidth:"80px",normalComboWidth:"150px",expandedComboWidth:"190px",normalSubComboWidth:"127px",expandedSubComboWidth:"169px",topBotExpandedContainerWidth:"272px"},Filter.initComponents=function(e){$.ui.utils.initComponents($(e)),$.ZToolbarHandler.init($(e))},Filter.showFilterOptions=function(e,t,r,l,i){var o,a=!!e,s=Filter.header;if(a&&(browser_ie?(e=window.event,o=e.srcElement):o=e.target),isCellEdited()&&submitCell(),!READ_WRITE)return void showAlertDialog(jsMsg["Filter.readOnly.alertMessage"]);sheetdialog.close(),isUndefined(t)&&(t=currCol);var d,n,c;r||(d=a?o:Filter.getIcon(t),n=d.parentNode),c=r?!0:n.getAttribute("pivot");var F;if(c&&(F=r?-1!==l.pft.indexOf("page"):"page"===n.getAttribute(JSONConstants.PIVOT_FIELD_TYPE)?!0:!1),Filter.isPivotFilter=c?!0:!1,!c)var u=Filter.getInstance(),f=u.range;var p=getObj("filterColumnData"),v=a?parseInt(n.getAttribute("col")):r?l.col:t,m=a?parseInt(n.getAttribute("index")):r?0/0:t-f.sc;if(!p||"none"===p.style.display||(Filter.hideFilterOptions(),currentFilterIndex!==m)){if(Filter.currCol=v,c||u.isFilteredCol(v)||(Filter.getIcon(v).src=IMAGE_PATH+"filter_state.png"),p){p.style.display="block";var h=Filter.width;$(p).css("width",h.normalContainerWidth)}currentFilterIndex=m;var I,C=new AjaxRequest;if(c){var g=r?l.row:n.getAttribute("row"),x=getCell(g,t),b=r?l.cellValue:getCellContent(x);pivot.Collection.setPivotId(g,t,r?l.asn:void 0),I=new RequestParameters(ActionConstants.READ_PIVOT_FILTER_DATA),I.setParameters(pivotId,encodeURIComponent(b))}else I=new RequestParameters(ActionConstants.GET_FILTER_DATA),I.setParameters(WorkSheets.getAssociatedActiveSheetName(),v,m);return C.init("POST",I.getURL(),!0,I.getParametersAsString()),C.addEventListener("onComplete",function(e){var o=parseJSON(e.responseText);if(o){var a=r?l.col:c?t:m+f.sc,h=o.dT,I=o.hV,C=o.o1,x=o.o2,O=o.v1,S=o.v2,D=o.ft,T=o.isc;maxFilterCriteria=o.mfc;var w=o.aft;Filter.currColData=o.cD,Filter.selectedItemIndexes=o.selectedItemIndexes,cellColor=o.ccs,textColor=o.tcs,isReset=!0;var y=o.smd;if(c){var H=o[JSONConstants.PIVOT_SORT_DETAILS],E=o[JSONConstants.PIVOT_FILTER_DETAILS];Filter.ascendingSort=H[JSONConstants.ASCENDING_SORT],Filter.sortMode=H[JSONConstants.PIVOT_SORTMODE],Filter.currColData=E.cD,Filter.selectedItemIndexes=E.selectedItemIndexes,$("#sort_asc").show(),$("#sort_desc").show(),F?($(".pivotSortByDiv").hide(),$("#sort_asc").attr("disabled","disabled"),$("#sort_desc").attr("disabled","disabled")):($(".pivotSortByDiv").show(),$("#sort_asc").removeAttr("disabled"),$("#sort_desc").removeAttr("disabled"),Filter.sortMode<1?($("#sort_asc").removeAttr("title"),$("#sort_desc").removeAttr("title")):Filter.ascendingSort?($("#sort_asc").addClass("sSo"),$("#sort_desc").removeAttr("title")):($("#sort_desc").addClass("sSo"),$("#sort_asc").removeAttr("title"))),Filter.fieldType=r?l.pft:n.getAttribute(JSONConstants.PIVOT_FIELD_TYPE),Filter.headerIndex=r?l[JSONConstants.HEADER_INDEX]:n.getAttribute(JSONConstants.HEADER_INDEX),Filter.sortDataIndex=o[JSONConstants.PIVOT_DATAFIELDINDEX],I=b,y=!1,Filter.selectedItemIndexes&&Filter.selectedItemIndexes.length&&(w="fbv"),cellColor=[],textColor=[];{Filter.ascendingSort?"sort_asc":"sort_desc"}$("#fL").show(),getObj("headers").style.display="none",getObj("cellColorId").style.display="none",getObj("textColorId").style.display="none",getObj("customFilterId").style.display="none",$("#filterSearch").addClass("pvt"),$(".filterOption").hide(),getObj("filterColumnData").style.width="250px",$("#autoFilterIdContent").css("border-top","1px dashed #e8e8e8"),$("#filterColumnData #btn").show(),Filter.initComponents("#pivotSortBy"),Filter.initComponents("#pFtopBottomDiv"),Filter.initComponents("#pFtBs"),Filter.initComponents("#pFcategory");var k=PivotUtil.getsortByValues(Filter.fieldType,Filter.headerIndex),A=$("#pivotSortBy");A.html("");var _=-1;for(z=0;z<k.length;z++)H[JSONConstants.PIVOT_DATAFIELDINDEX]==_?$("<option/>",{value:_,selected:"selected",text:k[z]}).appendTo(A):$("<option/>",{value:_,text:k[z]}).appendTo(A),_++;$("#sort_asc").attr("title",jsMsg["Pivot.Tooltip.Asc.By"]),$("#sort_desc").attr("title",jsMsg["Pivot.Tooltip.Desc.By"]),A.zcombo("refresh"),A.bind("combochange",function(){$("#sort_asc").removeClass("sSo"),$("#sort_desc").removeClass("sSo")});var j=$("#pFcategory");j.html("");var V=E[JSONConstants.COUNT];for(V>0?($("#pFtBs").zspinner("setValue",o[JSONConstants.COUNT]),$("#pFtBo").zcombo("setValue",o[JSONConstants.DISPLAY_MEMBER_MODE]),$("<option/>",{value:-1,text:"Choose"}).appendTo(j)):($("#pFtBs").zspinner("setValue",0),$("#pFtBo").zcombo("setValue","choose"),$("<option/>",{value:-1,selected:"selected",text:"Choose"}).appendTo(j)),k.shift(),z=0;z<k.length;z++)E[JSONConstants.PIVOT_FILTER_DATAFIELDINDEX]==z?$("<option/>",{value:z,selected:"selected",text:k[z]}).appendTo(j):$("<option/>",{value:z,text:k[z]}).appendTo(j);j.zcombo("refresh")}else $(".pivotSortByDiv").hide(),$("#fL").hide(),$("#pFtopBottomDiv").hide(),getObj("headers").style.display="block",getObj("cellColorId").style.display="block",getObj("textColorId").style.display="block",getObj("customFilterId").style.display="block",$("#filterSearch").removeClass("pvt"),$("#autoFilterIdContent").css("border-top","0px"),$(".filterOption").show(),$("#sort_asc").removeAttr("disabled"),$("#sort_desc").removeAttr("disabled"),getObj("filterColumnData").style.width="271px",$("#sort_asc").show(),$("#sort_desc").show(),$("#filterColumnData #btn").show(),$("#sort_asc").removeAttr("title"),$("#sort_desc").removeAttr("title");Filter.initComponents("#btn"),Filter.initComponents("#sortBtn");{Filter.updateAppliedFilterDetails(w)}c||(Filter.appendItems(w,"#cellColorDiv",cellColor),Filter.appendItems(w,"#textColorDiv",textColor)),$("#autoFilterId").off("click"),$("#cellColorId").off("click"),$("#textColorId").off("click"),$("#customFilterId").off("click"),$("#sort_asc").off("click"),$("#sort_desc").off("click"),$("#autoFilterId").click(function(){Filter.setHeader("autoFilterHeader")}),$("#cellColorId").click(function(){Filter.setHeader("cellColorHeader")}),$("#textColorId").click(function(){Filter.setHeader("textColorHeader")}),$("#customFilterId").click(function(){Filter.initComponents("#div4"),Filter.setHeader("customFilterHeader")}),Filter.initComponents("#div4");var y=o.smd,M=getObj("dataDiv");M.innerHTML="";var R=document.createDocumentFragment(),N=document.createElement("div");M.onmousedown=Filter.applyFilter1;var P=Filter.currColData.indexOf(""),B=-1!=P;if(B){var L=[],W=[];L.push(Filter.currColData[P]),W.push(Filter.selectedItemIndexes[P]);for(var z=0;z<Filter.currColData.length;z++)z!=P&&(L.push(Filter.currColData[z]),W.push(Filter.selectedItemIndexes[z]));Filter.currColData=L,Filter.selectedItemIndexes=W}var U,z=0;if(B){var q=N.cloneNode(!0);U="fbv"===w&&Filter.isItemSelected(z)?s.selectedItem:s.deselectedItem,$(q).attr("itemIndex",z++).text("(Blanks)").addClass(U),R.appendChild(q)}for(var J=Filter.currColData.length,z=0;J>z;z++)if(Filter.currColData[z]&&"object"!=typeof Filter.currColData[z]){var X=N.cloneNode(!0),U="fbv"===w&&Filter.isItemSelected(z)?s.selectedItem:s.deselectedItem;$(X).attr("itemIndex",z).attr("title",Filter.currColData[z]).text(Filter.currColData[z]).addClass(U),R.appendChild(X)}M.appendChild(R);var Y=getObj("maxDataInfo");y?(Y.style.display="",displayMaxDataInfo=!0):(Y.style.display="none",displayMaxDataInfo=!1),Filter.changeCriteriaLabels(h,T);var G=$("#fo1"),K=$("#fo2");if(T){var Z=$("#foCategory"),Q=$("#fVal3");Filter.customFilter(!0);var et=o.sOpr,tt=o.sC,rt=o.sVal,lt="items"===tt?"values":"percent";G.zcombo("setValue",et),Z.zcombo("setValue",lt),Q.zspinner("setValue",rt),Filter.setWidth(et)}else if("fc"===w){Filter.initComponents("#div4");var it=$("#fVal1"),ot=$("#fVal2");G.zcombo("setValue",C),K.zcombo("setValue",x),it.val(O),ot.val(S),"AND"===D?getObj("and").checked=!0:getObj("or").checked=!0,Filter.setWidth(C),Filter.datePickerHandler(C,"fo1"),Filter.datePickerHandler(x,"fo2")}!c&&u.columns[v]&&(u.columns[v].dataType=h)}isFilterOptionsDIVOpened=!0;var at=getNormalizedScrollLeft(),st=getColLeft(a)+getColWidth(a);a>FREEZED_COL&&(st-=at);var dt=r?st:st-d.offsetWidth;isFilterOpenedLeft=!1,dt+p.offsetWidth>getSheetWidth()+rowHeadWidth-ssVScrollbar.offsetWidth&&(dt=st-p.offsetWidth,isFilterOpenedLeft=!0),dt+=rowHeadWidth-1,filterStartRow=c?g:u.range.sr;var nt,ct=getSheetScrollTop(),Ft=getRowTop(parseInt(filterStartRow)+1)-ct,ut=Ft;Ft+p.offsetHeight>getSheetHeight()&&(Ft=getRowTop(parseInt(filterStartRow))+r?0:d.offsetTop-p.offsetHeight-ct,nt=parseInt(Ft)+parseInt(sheetTop)+"px"),0>Ft+sheetTop&&(Ft=parseInt(ut)+parseInt(sheetTop)+"px",getSheetHeight()-ut<p.offsetHeight&&(nt=0)),FREEZED_ROW>filterStartRow&&(nt=getSheetHeight()-(ct-Math.abs(ut))<p.offsetHeight?0:0>ut?parseInt(sheetTop)+ct-Math.abs(ut):parseInt(sheetTop)+ut),nt=void 0!=nt?nt:parseInt(Ft)+parseInt(sheetTop)+"px",r?PivotChartUtility.showFilterMenu(p,l,i):isRTL?($(p).css({right:dt+"px",zIndex:1e4+BASEZINDEX,top:nt}),$(p).css("left","")):$(p).css({left:dt+"px",zIndex:1e4+BASEZINDEX,top:nt})}),C.sendRequest(),!1}},Filter.setHeader=function(e){$("#ui-datepicker-div").hide(),currentHeader=e,isReset=!1},Filter.getSelectedItems=function(){var e="[",t=!1;if("div1"===Filter.currentEl)for(var r=0,l=Filter.currColData.length;l>r;r++)Filter.isItemSelected(r)&&(t=!0,e+='"'+encodeURIComponent(Filter.currColData[r].replace(/\"/g,'\\"'))+'",');else"div2"===Filter.currentEl?jQuery.each(Filter.selectedItemIndexes,function(t,r){1===r&&(e+='"bycellcolor('+cellColor[t]+')",')}):"div3"===Filter.currentEl&&jQuery.each(Filter.selectedItemIndexes,function(t,r){1===r&&(e+='"byfontcolor('+textColor[t]+')",')});return t&&(e=e.substring(0,e.length-1)),e+="]"},Filter.getSelectedTabDataLen=function(){return"autoFilterHeader"===currentHeader?Filter.currColData.length:"cellColorHeader"===currentHeader?cellColor.length:"textColorHeader"===currentHeader?textColor.length:0},Filter.applyFilterCriteria=function(e,t,r,l,i,o,a,s,d){var n=Filter.getInstance();if(n)var c=n.range,F=c.sr,u=c.sc,f=c.er,p=c.ec;var v=new AjaxRequest,m=ActionConstants.APPLY_FILTER,h=actionManager.addRequest.bind(actionManager),c=n.range;if(e=WorkSheets.getSheetCodeFromName(e),jsVERSION_VIEW){var I=jsVERSION_VIEW&&""===DOCUMENT_VERSION?!0:void 0,m=ActionConstants.APPLY_FILTER_READ_ONLY;h=v.sendRequest.bind(v),v.addEventListener("onComplete",function(e){var t=JSON.parse(e.responseText);updateJson(t)});var C=new RequestParameters(m);C.setParameters(e,t,r,l,i,o,a,s,d,F,u,f,p,I),v.init("POST",C.getURL(),!0,C.getParametersAsString()),h(v)}else{var C=new RequestParameters(m);C.setParameters(e,t,r,l,i,o,a,s,d,F,u,f,p),v.init("POST",C.getURL(),!0,C.getParametersAsString()),h(v)}Filter.enableDisableInsertIcon(!1),Filter.hideFilterOptions()},Filter.datePickerHandler=function(e,t){var r=Filter.getInstance();if(r&&r.getColumnData(Filter.currCol))var l=r.getColumnData(Filter.currCol).dataType;var i=$("fo1"===t?"#fVal1":"#fVal2");if("DATE"!==l||"lt"!==e&&"lte"!==e&&"gt"!==e&&"gte"!==e)i.removeClass("datePickerIcon"),i.datepicker("destroy");else{var o=getDateFormat();i.addClass("datePickerIcon"),i.datepicker({changeMonth:!0,changeYear:!0,constrainInput:!1,dateFormat:o}),$("#ui-datepicker-div").click(function(){isReset||($("#filterOk").enable(),Filter.closeSearchBox(),Filter.headerTickShow(!0,!0),Filter.resetSelectedItemIndexes())})}},Filter.setWidth=function(e){if(!Filter.isPivotFilter){var t=Filter.width,r=$("#filterColumnData"),l=(r.offset().left,r.width()),i=$("#fo1").siblings("div"),o=$("#fo2").siblings("div");if("top"===e||"bottom"===e)290!==l&&r.width(t.topBotExpandedContainerWidth),i.width(t.topBotComboWidth),i.children(".ui-zcombo-select-item").width(t.topBotComboWidth);else if("lte"===e||"gte"===e||"!begins"===e||"!ends"===e)330!==l&&(r.width(t.expandedContainerWidth),i.width(t.expandedComboWidth),i.children(".ui-zcombo-select-item").width(t.expandedSubComboWidth),o.width(t.expandedComboWidth),o.children(".ui-zcombo-select-item").width(t.expandedSubComboWidth));else{var a=getObj("fo1").value,s=getObj("fo2").value,d="gte"===a||"lte"===a||"!begins"===a||"!ends"===a||"gte"===s||"lte"===s||"!begins"===s||"!ends"===s;d||(290!==l&&r.width(t.normalContainerWidth),i.width(t.normalComboWidth),i.children(".ui-zcombo-select-item").width(t.normalSubComboWidth),o.width(t.normalComboWidth),o.children(".ui-zcombo-select-item").width(t.normalSubComboWidth))}}},Filter.showSpecialConditions=function(e){if(e){var t=e.zcombo("getValue");Filter.setWidth(t);var r=["autoFilterId","cellColorId","textColorId","clearFilter","filterOk","sort_asc","sort_desc","customFilterId"];if($("#customFilterBack").css("box-shadow",""),$("#"+r[selectedFilterTabIndex]).css("box-shadow",""),"top"===t||"bottom"===t){var l=["#autoFilterId","#cellColorId","#textColorId"];Filter.headerTickHide(l,!1),$("#filterOk").enable(),Filter.customFilter(!0),isReset||Filter.resetSelectedItemIndexes()}else Filter.customFilter(!1),""===$("#fVal1").val()&&""===$("#fVal2").val();var i=$(e).attr("id");Filter.datePickerHandler(t,i)}},Filter.customFilter=function(e){e?($("#fVal1").hide(),$("#fo2").parent().hide(),$("#fval2").hide(),$("#radioOpr").hide(),$("#topBottomDiv").show()):($("#topBottomDiv").hide(),$("#fVal1").show(),$("#fval2").show(),$("#and").show(),$("#or").show(),$("#radioOpr").show(),$("#fo2").parent().show())},Filter.searchInputKeydown=function(e,t){return Filter.searckeyEventsManager(e,t)},Filter.closeSearchBox=function(){var e=$("#searchIconCont"),t=$("#filterSearch");e.is(":checked")&&(e.click(),t.val(""),Filter.searchItems(""),t.blur())},Filter.textBoxMouseDown=function(e){var t=Filter.getInstance();if(t.getColumnData(Filter.currCol))var r=t.getColumnData(Filter.currCol).dataType;"DATE"===r&&("fVal1"!==e||"gt"!==$("#fo1").zcombo("getValue")&&"gte"!==$("#fo1").zcombo("getValue")&&"lt"!==$("#fo1").zcombo("getValue")&&"lte"!==$("#fo1").zcombo("getValue")?"fVal2"!==e||"gt"!==$("#fo2").zcombo("getValue")&&"gte"!==$("#fo2").zcombo("getValue")&&"lt"!==$("#fo2").zcombo("getValue")&&"lte"!==$("#fo2").zcombo("getValue")||$("#ui-datepicker-div").show():$("#ui-datepicker-div").show()),$("#"+e).focus(),Filter.resetTicks(!0,!0,!0);var l=["autoFilterId","cellColorId","textColorId","clearFilter","filterOk","sort_asc","sort_desc","customFilterId"];$("#"+l[selectedFilterTabIndex]).css("box-shadow",""),$("#customFilterBack").css("box-shadow",""),$("#filterOk").enable()},Filter.searchMouseDown=function(){var e=$("#filterSearch");$("#searchIconCont").is(":checked")?setTimeout(function(){e.focus()},100):(e.val(""),Filter.searchItems(""),e.blur())},Filter.dataDivMouseDown=function(){if(2!==selectedFilterTabIndex){var e=["autoFilterId","select1","searchCont","clearFilter","filterOk","sort_asc","sort_desc","customFilterId"];$("#"+e[selectedFilterTabIndex]).css("box-shadow","");selectedFilterTabIndex=2}$("#filterSearch").blur()},Filter.searckeyEventsManager=function(e,t){var r="autoFilterHeader"===currentHeader?"dataDiv":"cellColorHeader"===currentHeader?"cellColorDiv":"textColorDiv";return 40===e.keyCode?($("#cF").focus(),hoverItem=0,void $($("#"+r).children()[hoverItem]).addClass("fhover")):(39===e.keyCode?(hoverItem=-2,Filter.searchMouseDown()):9===e.keyCode?e.shiftKey?Filter.isPivotFilter?null!==getObj("sort_desc").getAttribute("disabled")&&"disabled"===getObj("sort_desc").getAttribute("disabled")?selectedFilterTabIndex=5:(selectedFilterTabIndex=7,$("#sort_desc").css("box-shadow","0px 0px 2px 2px #addfff")):(selectedFilterTabIndex=0,hoverItem=-2,$("#select1").removeClass("fhover"),$("#autoFilterId").trigger("click"),$("#autoFilterId").css("box-shadow","0px 0px 2px 2px #addfff")):($("#cF").focus(),Filter.shortCutHandler(e)):27===e.keyCode&&Filter.hideFilterOptions(),Filter.clearSearchTimeout(),void(Filter.timeoutId=window.setTimeout(function(){Filter.onSearchTimeout(t)},10)))},Filter.keyEventsManager=function(e){$("#filterOk").enable(),Filter.resetTicks(!1,!0,!0),browser_ie&&(e=window.event);var t=e.keyCode,r=e.altKey;if(27===t||r&&38===t)return Filter.hideFilterOptions(),!1;if(r){var l=!1,i=Filter.currCol,o=Filter.getInstance().range;if(37===t&&i>o.sc&&(l=!0,i-=1),39===t&&i<o.ec&&(l=!0,i+=1),l)return Filter.showFilterOptions(void 0,i),!1}return 13===t?(Filter.applyCustomFilter(),!1):("autoFilterHeader"===currentHeader||"cellColorHeader"===currentHeader||"textColorHeader"===currentHeader)&&65===t&&(os_mac&&e.metaKey||os_windows&&e.ctrlKey)&&e.shiftKey?(Filter.selectAllItems(),!1):void(isReset||(Filter.closeSearchBox(),Filter.resetSelectedItemIndexes()))},Filter.onSearchTimeout=function(e){Filter.searchItems(e.value.toLowerCase())},Filter.clearSearchTimeout=function(){isUndefined(Filter.timeoutId)||window.clearTimeout(Filter.timeoutId)},Filter.deselectAll=function(){for(var e=0,t=Filter.currColData.length;t>e;e++)Filter.selectedItemIndexes[e]=0},Filter.searchItems=function(e){var t=Filter.currColData,r=document.createElement("div"),l=document.createDocumentFragment(),i=""===e,o=0;Filter.resultantSearchItemIndexes=[];var a=Filter.header,s=0,d=0,n=""===Filter.currColData[0];if(n&&i){var c=0,F=r.cloneNode(!0),u="div1"===Filter.currentEl?Filter.isItemSelected(s):!1,f=u?(o++,c=1,a.selectedItem):a.deselectedItem;$(F).text("(Blanks)").attr("itemIndex",s).addClass(f),Filter.resultantSearchItemIndexes.push(c),l.appendChild(F),s++}for(var d=0,p=t.length;p>s;s++){var v=t[s];if(i||v.toLowerCase().indexOf(e)>-1){var c=0,F=r.cloneNode(!0),u="div1"===Filter.currentEl?Filter.isItemSelected(s):!1,f=u?(o++,c=1,a.selectedItem):a.deselectedItem;$(F).text(v).attr("itemIndex",s).addClass(f),$(F).text(v).attr("searchItemIndex",d++),Filter.resultantSearchItemIndexes.push(c),l.appendChild(F)}}var m=getObj("dataDiv").childNodes[0];m.innerHTML=i?a.selectAllItemsMsg:a.selectAllItemsMsg;var h=getObj("filterSearch");if(0===Filter.resultantSearchItemIndexes.length){m.style.visibility="hidden",h.className="filterSearchBox filterSearchError aFlrInp",Filter.isPivotFilter&&$("#filterSearch").addClass("pvt"),$("#dataDiv").html("");var I=document.createElement("div");$(I).text(jsMsg["Filter.noSearchResults"]),$(I).addClass("fltrNoRes"),$(I).attr("id","searchId"),$("#dataDiv").append(I)}else{m.style.visibility="visible",h.className="aFlrInp",Filter.isPivotFilter&&$("#filterSearch").addClass("pvt");var C=a.partiallySelectedItem;Filter.isViewFiltered()&&(o=Filter.selectedItemIndexes.toString().split("1").length-1),0===o?(C=a.deselectedItem,$("#filterOk").disable()):Filter.resultantSearchItemIndexes.toString().indexOf("0")<0&&(C=a.selectedItem,$("#filterOk").enable());var g=getObj("dataDiv");g.innerHTML="",g.appendChild(l),m.className=C}},Filter.selectedIndexes=[],Filter.isItemSelected=function(e){return parseInt(Filter.selectedItemIndexes[e])},Filter.resetSelectedItemIndexes=function(){Filter.resetTicks(!0,!0,!0),("autoFilterHeader"===currentHeader?"div1"!==Filter.currentEl:"cellColorHeader"===currentHeader?"div2"!==Filter.currentEl:"textColorHeader"===currentHeader?"div3"!==Filter.currentEl:"div4"!==Filter.currentEl)&&(Filter.currentEl="autoFilterHeader"===currentHeader?"div1":"cellColorHeader"===currentHeader?"div2":"textColorHeader"===currentHeader?"div3":"div4",Filter.selectedItemIndexes=new Array(Filter.getSelectedTabDataLen()+1).join("0").split(""),isReset=!0)},Filter.resetTicks=function(e,t,r){var l=Filter.header,i=["#dataDiv","#cellColorDiv","#textColorDiv"];e&&("autoFilterHeader"===currentHeader?i.splice(0,1):"cellColorHeader"===currentHeader?i.splice(1,1):"textColorHeader"===currentHeader&&i.splice(2,1));for(var o=0;o<i.length;o++){if(t){var a=$(i[o]).siblings();a.attr("class",l.deselectedItem)}if(r)for(var s=$(i[o]).children("div"),d=0;d<s.length;d++)s[d].className===l.selectedItem&&(s[d].className=l.deselectedItem)}},Filter.headerTickShow=function(e){var t="autoFilterHeader"===currentHeader?"#autoFilterId":"cellColorHeader"===currentHeader?"#cellColorId":"textColorHeader"===currentHeader?"#textColorId":"",r=$(t);r&&r.id&&$("#"+r.id).click();var l=$("#"+r[0].id);if($(l).children().animate({opacity:0},0).animate({opacity:1},300).show(),r.addClass("selected bTc dAt"),e){var i=["#autoFilterId","#cellColorId","#textColorId",""];i.splice(i.indexOf(t),1),Filter.headerTickHide(i,!0)}},Filter.headerTickHide=function(e){if("object"==typeof e)for(var t=0;t<e.length;t++){var r=$(e[t]);if($("#"+r.attr("id")).removeClass("selected bTc dAt"),$("#"+r.attr("id")).children()[0]){var l=$("#"+r.attr("id"));$(l).children().animate({opacity:0},0).hide()}}else{var i=$(e);$(i).children().animate({opacity:0},0).hide(),i.removeClass("selected bTc dAt")}},Filter.resetCustomFilter=function(){Filter.customFilter(!1);var e=$("#fVal1"),t=$("#fVal2");e.val(""),t.val(""),Filter.datePickerHandler("eq","fo1"),Filter.datePickerHandler("","fo2"),Filter.setWidth("eq")},Filter.selectItem=function(e){isReset||(Filter.resetSelectedItemIndexes(),Filter.resetCustomFilter(),"autoFilterHeader"!==currentHeader&&Filter.closeSearchBox()),hoverItem>=0&&($($("#"+e.parentElement.id).children()[hoverItem]).removeClass("fhover"),selectedFilterTabIndex=3),hoverItem=$(e).index();var t=$(e),r=parseInt(t.attr("itemIndex")),l=Filter.isItemSelected(r),i=Filter.header;e.className=l?(l=0,i.deselectedItem):(l=1,i.selectedItem),Filter.selectedItemIndexes[r]=l;var o=Filter.isViewFiltered();if(o){var a=parseInt(t.attr("searchItemIndex"));Filter.resultantSearchItemIndexes[a]=l}var s=o?Filter.resultantSearchItemIndexes:Filter.selectedItemIndexes,d=Filter.setSelectAllStyle(s);if(!d&&o){var n=Filter.selectedItemIndexes.toString();d=n.indexOf(1)>-1}if(d)Filter.headerTickShow(!0,!0),$("#filterOk").enable();else{var c="autoFilterHeader"===currentHeader?"#autoFilterId":"cellColorHeader"===currentHeader?"#cellColorId":"#textColorId";Filter.headerTickHide(c,!0),$("#filterOk").disable()}},Filter.setSelectAllStyle=function(e){var t=Filter.header,r=e.toString(),l=r.indexOf(0)>-1,i=r.indexOf(1)>-1,o=l?i?t.partiallySelectedItem:t.deselectedItem:t.selectedItem;return getObj(Filter.currentEl).childNodes[0].className="div1"==Filter.currentEl?o:o,i},Filter.isViewFiltered=function(){return""!==getObj("filterSearch").value},Filter.itemSelectorMouseDown=function(e,t){Filter.resetCustomFilter(),Filter.headerTickShow(!0,!0),isReset||Filter.resetSelectedItemIndexes(),Filter.selectAllItems(e,t)},Filter.selectAllItems=function(e,t){var r=Filter.isViewFiltered(),l=Filter.header,i="div1"==e?getObj(e).childNodes[0]:getObj(e).childNodes[0],o=l.selectedItem,a=!0;i.className===l.selectedItem&&(o=l.deselectedItem,a=!1),i.className=a?l.selectedItem:l.deselectedItem;for(var s=getObj(t).childNodes,d=a?1:0,n=0,c=s.length;c>n;n++){var F=s[n];F.className=o,r&&(Filter.resultantSearchItemIndexes[n]=d),Filter.selectedItemIndexes[parseInt(F.getAttribute("itemIndex"))]=d}var u=-1===Filter.selectedItemIndexes.toString().indexOf("1");if(u?$("#filterOk").disable():$("#filterOk").enable(),!a){var f="autoFilterHeader"===currentHeader?"#autoFilterId":"cellColorHeader"===currentHeader?"#cellColorId":"#textColorId";Filter.headerTickHide(f,!0)}},Filter.clickFunction=function(e){$(e).on("click",function(){Filter.selectItem(this)})},Filter.appendItems=function(e,t,r){var l=Filter.header;$(t).html("");for(var i=0;i<r.length;i++){var o=document.createElement("div");$(o).attr({colorname:r[i],itemindex:i}),$(o).addClass(("fbcc"===e&&"#cellColorDiv"===t||"fbtc"===e&&"#textColorDiv"===t)&&Filter.isItemSelected(i)?l.selectedItem:l.deselectedItem),Filter.clickFunction(o);var a=document.createElement("span");$(o).append(a),""===r[i]?"#textColorDiv"===t?($(a).css({"background-color":"#000000"}),$(o).append(jsMsg["Filter.default"])):$(o).append(jsMsg["Filter.noFill"]):$(a).css({"background-color":r[i]}),$(t).append(o)}},Filter.changeCriteriaLabels=function(e,t){var r=$("#fo1"),l=$("#fo2");if(t||"NUMBER"===e){if(!$("#fo1 option[value='top']").length){var i="<optgroup mtype='separator'></optgroup><option value='top'>"+jsMsg["Condition.top"]+"</option><option value='bottom'>"+jsMsg["Condition.bottom"]+"</option>";r.append(i)}}else("DATE"===e||"TEXT"===e)&&r.find("option[value='top']").length&&(r.find("option[value='top']").remove(),r.find("option[value='bottom']").remove(),r.find("optgroup:last").remove());"DATE"===e?(r.find("option[value='gt']").text(jsMsg["Condition.DateAfter"]),r.find("option[value='gte']").text(jsMsg["Condition.DateOnOrAfter"]),r.find("option[value='lt']").text(jsMsg["Condition.DateBefore"]),r.find("option[value='lte']").text(jsMsg["Condition.DateOnOrBefore"]),l.find("option[value='gt']").text(jsMsg["Condition.DateAfter"]),l.find("option[value='gte']").text(jsMsg["Condition.DateOnOrAfter"]),l.find("option[value='lt']").text(jsMsg["Condition.DateBefore"]),l.find("option[value='lte']").text(jsMsg["Condition.DateOnOrBefore"])):(r.find("option[value='gt']").text(jsMsg["Condition.GreaterThan"]),r.find("option[value='gte']").text(jsMsg["Condition.GreaterThanOrEqualTo"]),r.find("option[value='lt']").text(jsMsg["Condition.LessThan"]),r.find("option[value='lte']").text(jsMsg["Condition.LessThanOrEqualTo"]),l.find("option[value='gt']").text(jsMsg["Condition.GreaterThan"]),l.find("option[value='gte']").text(jsMsg["Condition.GreaterThanOrEqualTo"]),l.find("option[value='lt']").text(jsMsg["Condition.LessThan"]),l.find("option[value='lte']").text(jsMsg["Condition.LessThanOrEqualTo"])),r.zcombo("refresh"),l.zcombo("refresh")},Filter.updateAppliedFilterDetails=function(e){if(Filter.currentEl="div1",currentHeader="autoFilterHeader",e){var t=getObj("btn").childNodes[0];t.onmousedown=Filter.applyFilterAll,$("#clearFilter").enable(),$("#filterOk").enable(),"fc"===e?(Filter.currentEl="div4",currentHeader="customFilterHeader",$("#customFilterId").mousedown()):("fbv"===e?(Filter.showHeader("#autoFilterIdContent"),Filter.currentEl="div1",currentHeader="autoFilterHeader",$("#autoFilterId").trigger("click")):"fbcc"===e?(Filter.showHeader("#cellColorIdContent"),Filter.currentEl="div2",currentHeader="cellColorHeader",$("#cellColorId").trigger("click")):"fbtc"===e&&(Filter.showHeader("#textColorIdContent"),Filter.currentEl="div3",currentHeader="textColorHeader",$("#textColorId").trigger("click")),Filter.setSelectAllStyle(Filter.selectedItemIndexes),Filter.headerTickShow(!1,!0))}else $("#clearFilter").disable(),$("#filterOk").disable(),$("#customFilterBack").click(),$("#autoFilterId").trigger("click"),Filter.selectedItemIndexes=new Array(Filter.getSelectedTabDataLen()+1).join("0").split("")},Filter.showHeader=function(e){var t=["#autoFilterIdContent","#cellColorIdContent","#textColorIdContent","#customFilterIdContent"],r=$(e);("#autoFilterIdContent"===e||"#cellColorIdContent"===e||"#textColorIdContent"===e)&&$("#customFilterBack").click(),"#customFilterIdContent"===e&&($("#fB").text(jsMsg["Filter.customFilter"]),$("#fV").hide(),$("#customFilterId").hide(),$("#customFilterBack").show(),$("#headers").hide()),r.show(),t.splice(t.indexOf(e),1);for(var l=0;l<t.length;l++)$(t[l]).hide()},Filter.setMaxRange=function(e){if(e){var t=$("#fVal3");0===e.selectedIndex?t.zspinner("setMaxvalue",65536):1===e.selectedIndex&&t.zspinner("setMaxvalue",100)}},Filter.resetAutoFilterOptions=function(){var e=getObj("maxDataInfo");e.style.display="none",Filter.closeSearchBox()},Filter.closeFilterOptions=function(){isFilterOptionsDIVOpened&&Filter.hideFilterOptions()},Filter.applyCustomFilter=function(){if(Filter.isPivotFilter){for(var e=Filter.currColData,t=Filter.selectedItemIndexes,r=[],l=0;l<e.length;l++)1===t[l]&&r.push(e[l]);return PivotUtil.filter(Filter.fieldType,Filter.headerIndex,r,$("#select1").hasClass("filterItemSelect")),Filter.hideFilterOptions(),!1}var i,o=Filter.header,a=Filter.getInstance(),s=Filter.currCol-a.range.sc,d="TEXT";a.getColumnData(Filter.currCol)&&(d=a.getColumnData(Filter.currCol).dataType);for(var n=["#dataDiv","#cellColorDiv","#textColorDiv"],l=0;l<n.length;l++)for(var c=$(n[l]).children("div"),F=0;F<c.length;F++){var u=c[F].className;if(u===o.selectedItem){i=!0;break}}var f=getObj("fo1").value;if("top"===f||"bottom"===f){var p=f,v=getObj("fVal3").value,m=getObj("foCategory").value;return void Filter.applySpecialCondition(p,v,m,d,s)}if("div1"===Filter.currentEl||"div2"===Filter.currentEl||"div3"===Filter.currentEl)var h=i?!0:!1;var I,C,g,x,b;if(""===g)return Filter.hideFilterOptions(),!1;if(h){if(Filter.selectedItemIndexes.toString().indexOf("1")<0)return;I=Filter.getSelectedItems(),g="eq",b="OR"}else I=getObj("fVal1").value,I=encodeURIComponent(I),C=getObj("fVal2").value,C=encodeURIComponent(C),g=getObj("fo1").value,x=getObj("fo2").value,b=getObj("or").checked?"OR":"AND";if(h&&Filter.selectedItemIndexes.toString().indexOf("0")<0)Filter.applyFilterAll();else{if(h&&Filter.selectedItemIndexes.toString().split("1").length-1>maxFilterCriteria)return void showAlertDialog(replaceParams(jsMsg["Filter.Criteria.Selection"],new Array(maxFilterCriteria.toString())));Filter.applyFilterCriteria(CURRSHEETNAME,s,d,I,g,C,x,b)}return sheetdialog.close(),!1},Filter.applySpecialCondition=function(e,t,r,l,i){if(!(t>=1))return Filter.hideFilterOptions(),!1;t=Math.round(t);var o=e+" "+r;Filter.applyFilterCriteria(CURRSHEETNAME,i,l,t,o,void 0,void 0,void 0,ActionConstants.SPECIAL_CRITERIA)},Filter.applyFilterAll=function(){if(Filter.isPivotFilter)return PivotUtil.filter(Filter.fieldType,Filter.headerIndex,Filter.currColData,!0),void Filter.hideFilterOptions();var e=Filter.getInstance();if(e){var t=Filter.currCol-e.range.sc;Filter.applyFilterCriteria(CURRSHEETNAME,t,void 0,void 0,void 0,void 0,void 0,void 0,ActionConstants.APPLY_FILTER_ALL)}},Filter.applyFilterBlank=function(e){var t;browser_ie?(e=window.event,t=e.srcElement):t=e.target,Filter.selectItem(t,""),stopEvt(e)},Filter.applyFilter1=function(e){var t;return browser_ie?(e=window.event,t=e.srcElement):t=e.target,t.id?!1:void Filter.selectItem(t)},Filter.custom=function(e){Filter.initComponents("#div4"),$("#fVal3").zspinner("setValue",10),$("#fo1").zcombo("setValue","eq"),$("#fo2").zcombo("setValue","");var t=$("#fo1").zcombo("getDropDown");if("block"===t.css("display"))t.hide();else{var r=$("#fo2").zcombo("getDropDown");"block"===r.css("display")&&r.hide()}"customFilterHeader"===currentHeader&&Filter.setHeader("autoFilterHeader");var l=e.id;if("customFilterId"==l){var i=["autoFilterId","cellColorId","textColorId","clearFilter","filterOk","sort_asc","sort_desc","customFilterId"];$("#fB").show(),$("#"+i[selectedFilterTabIndex]).css("box-shadow",""),selectedFilterTabIndex=8,$("#fB").text(jsMsg["Filter.customFilter"]),$("#fV").hide(),$("#customFilterId").hide(),$("#customFilterBack").show(),$("#headers").hide(),$(".filterOption").addClass("cFd"),Filter.showOption(e)}else $("#fB").hide(),$("#fV").text(jsMsg["Filter.by.cellValue"]),$("#fV").show(),$("#customFilterId").show(),$("#customFilterBack").hide(),$("#customFilterBack").css("box-shadow",""),$("#headers").show(),$(".filterOption").removeClass("cFd"),Filter.showOption("textColorHeader"===currentHeader?$("#textColorId"):"cellColorHeader"===currentHeader?$("#cellColorId"):$("#autoFilterId"))},Filter.showOption=function(e){var t=["autoFilterId","cellColorId","textColorId","clearFilter","filterOk","sort_asc","sort_desc","customFilterId"],r=["dataDiv","cellColorDiv","textColorDiv"];$("#"+t[selectedFilterTabIndex]).css("box-shadow",""),$($("#headers").find(".fselected")).css("box-shadow",""),$("#"+r[t.indexOf(selectedFilterTab)]).scrollTop(0),hoverItem>-1&&$($("#"+r[t.indexOf(selectedFilterTab)]).children()[hoverItem]).removeClass("fhover"),$("#autoFilterIdContent").hide(),$("#cellColorIdContent").hide(),$("#textColorIdContent").hide(),$("#customFilterIdContent").hide();var l;l=e.id,l||(l=e.attr("id")),selectedFilterTab=l,hoverItem=-2,$("#"+l+"Content").show(),"autoFilterId"===l?($("#fV").text(jsMsg["Filter.by.cellValue"]),$(".dA").css("left","9px"),$("#cellColorId").removeClass("fselected"),$("#textColorId").removeClass("fselected"),$("#autoFilterId").addClass("fselected")):"cellColorId"===l?($("#fV").text(jsMsg["Filter.by.cellColor"]),$(".dA").css("left","97px"),$("#autoFilterId").removeClass("fselected"),$("#textColorId").removeClass("fselected"),$("#cellColorId").addClass("fselected")):"textColorId"===l&&($("#fV").text(jsMsg["Filter.by.textColor"]),$(".dA").css("left","181px"),$("#cellColorId").removeClass("fselected"),$("#autoFilterId").removeClass("fselected"),$("#textColorId").addClass("fselected"))},Filter.sortFilterRange=function(e){if(Filter.hideFilterOptions(),Filter.isPivotFilter){if("page"===Filter.fieldType)return;var t=getObj("pivotSortBy").value;isUndefined(e)&&(e=getObj("custSortAsc").checked?!0:!1),(0===Filter.sortMode||Filter.ascendingSort!=e||Filter.sortDataIndex!=t)&&PivotUtil.sort(Filter.fieldType,Filter.headerIndex,e,t)}else{var r=Filter.getInstance();if(r){var l=r.range,i=[],o={};o.f=Filter.currCol-l.sc,o.s=e,i.push(o),sortvalues(i,1,!1,!0,!1,!1,!0)}}},Filter.byValueChanged=function(){var e=getObj("pFtBo").value;("from_top"===e||"from_bottom"===e)&&Filter.changeDisplayInfo()},Filter.changeDisplayInfo=$.debounce(500,function(){if(Filter.isPivotFilter){var e=getObj("pFtBo").value,t=getObj("pFcategory").value;if("from_top"===e||"from_bottom"===e){var r=e,l=getObj("pFtBs").value;0==l&&($("#pFtBs").zspinner("setValue",5),l=5),-1==t&&($("#pFcategory").zcombo("setValue",0),t=0),PivotUtil.changeDisplayInfo(Filter.fieldType,Filter.headerIndex,r,l,t)}else $("#pFtBs").zspinner("setValue",0),PivotUtil.changeDisplayInfo(Filter.fieldType,Filter.headerIndex,r,-1)}});
!function(){function e(e,l,t){var n=getCell(e,l);n&&(n.style.zIndex=t,n.style.overflow="visible")}var l=4,t=3,n=3,o=0,a=[],r=0,E=!1;appEvent.on("cell.setZIndex",function(e,l,t){void 0==Merge.getCellInfo(l,t)||Merge.isCovered(l,t-1)?e.style.zIndex=l%ROWS_PER_TILE*256+(t+4):(e.style.zIndex=260,e.style.overflow="hidden")}),appEvent.on("setIndex",function(e){r=e%ROWS_PER_TILE,n=256*r+t,a[e]=[]}),appEvent.on("cell.construct.setProperty",function(e,t,E,g,i){if(0===getAvailableStartRow()&&(o=E),o=FREEZED_ROW>0&&FREEZED_ROW>E?E:E-getAvailableStartRow(),!i||void 0===i[7]&&void 0===i[5])e.style.zIndex=n,a[E]?a[E][t]=n:(a[E]=[],a[E][t]=n);else{var R=t+l+256*r;e.style.zIndex=R,n=R-1,a[E]?a[E][t]=R:(a[E]=[],a[E][t]=R)}}),appEvent.on("cell.setcontent",function(e,t,n,o,r,g){var i=getColMax(),R=0,v=e.className.indexOf("nW");if(g&&(E=g),R=FREEZED_ROW>0&&FREEZED_ROW>t?t:t-getAvailableStartRow(),""!==r||"'"===getCellFormula(e)||""===r&&""!==getCellFormula(e)){if(void 0===Merge.getCellInfo(t,n)){var C=e.style.zIndex,d=n+l+t%ROWS_PER_TILE*i;e.style.zIndex=d,v>0&&(e.style.overflow="visible"),a[t][n]=d;for(var f=n+1;o>f&&C>=a[t][f];f++)getCell(t,f).style.zIndex=d-1,a[t][f]=d-1}void 0!==Merge.getCellInfo(t,n)&&(e.style.zIndex=260,e.style.overflow="hidden")}else if(void 0===Merge.getCellInfo(t,n)){var C=a[t][n];if(v>0&&(e.style.overflow="visible"),C)a[t][n-1]===C+1||a[t][n-1]===C-1?(e.style.zIndex=n-1+l+t%ROWS_PER_TILE*i-1,a[t][n]=n-1+l+t%ROWS_PER_TILE*i-1):void 0===Merge.getCellInfo(t,n-1)?(e.style.zIndex=a[t][n-1],a[t][n]=a[t][n-1]):(e.style.zIndex=n+l,a[t][n]=n+l);else if(n-1>0){var s=getCell(t,n-1),I=s.style.zIndex;""!=getCellContent(s)||"'"==getCellContent(s)||void 0!=Merge.getCellInfo(t,n-1)?(e.style.zIndex=I-1,a[t][n]=I-1):(e.style.zIndex=I,a[t][n]=I)}else e.style.zIndex=3,a[t][n]=3;for(var f=n+1;o>f&&C>=a[t][f];f++)getCell(t,f).style.zIndex=a[t][n],a[t][f]=a[t][n]}}),appEvent.on("range.clearcontent",function(n,o,r,E,g){var i,R,v,C=getColMax(),d=new Range(n,o,r,g-1),f=d.getIterator();f.addEventListener("onRowBefore",function(e){var n=0;n=FREEZED_ROW>0&&FREEZED_ROW>e?e:e-getAvailableStartRow(),R=a[e][E],i=e%ROWS_PER_TILE*C+t,v=o+l+e%ROWS_PER_TILE*C,0!==o&&(i=a[e][o-1])}),f.iterate(function(n,r){var d=0;d=FREEZED_ROW>0&&FREEZED_ROW>n?n:n-getAvailableStartRow(),E+1>r?a[n][o]===i+1||a[n][o]===i-1?i!==n%ROWS_PER_TILE*C+t?(e(n,r,i-1),a[n][r]=i-1):(e(n,r,i),a[n][r]=i):0===o||void 0===Merge.getCellInfo(n,o-1)?(null!==getCell(n,r)&&null!==getCell(n,r-1)&&(e(n,r,i),a[n][r]=i),0===r&&(e(n,r,i),a[n][r]=i)):r===o?(e(n,o,v),a[n][r]=r+l+n%ROWS_PER_TILE*C):(e(n,r,v-1),a[n][r]=v-1):R>=a[n][r]&&void 0===Merge.getCellInfo(n,r)?(e(n,r,a[n][o]),a[n][r]=a[n][o]):f._skipColumn(g-1-r)})}),appEvent.on("grid.insertCol",function(n,o){var r,E,g=getColMax(),i=0;E=0!==n?n-1:n;var R=new Range(getAvailableStartRow(),0,getAvailableEndRow(),o-1),v=R.getIterator(),C=Row.getAvailableRowsInFrozenRange(FREEZED_ROW),d=C.length,f=(C[d-1],new Range(0,0,FREEZED_ROW-1,o-1)),s=f.getIterator();s.addEventListener("onRowBefore",function(){r=a[freezedrw][0],freezedrw=Row.findNextNonHiddenRow(freezedrw)}),v.iterate(function(o,E){if(n-1>=E)r<a[i][E]&&(r=a[i][E]);else if(0!==n&&void 0===Merge.getCellInfo(o,E)&&Merge.getCellInfo(o,E-1))e(o,E,E+l+o%ROWS_PER_TILE*g),a[i][E]=E+l+o%ROWS_PER_TILE*g,r=E+l+o%ROWS_PER_TILE*g;else if(""===getCellContent(getCell(o,E))&&"'"!==getCellFormula(getCell(o,E)))if(r!==o%ROWS_PER_TILE*g+t){var R=getCell(o,E);null!==R&&(R.style.zIndex=r-1,a[o][E]=r-1)}else{var R=getCell(o,E);null!==R&&(R.style.zIndex=r,a[o][E]=r)}else{var R=getCell(o,E);null!==R&&(getCell(o,E).style.zIndex=E+l+o%ROWS_PER_TILE*g,a[i][E]=E+l+o%ROWS_PER_TILE*g,r=E+l+o%ROWS_PER_TILE*g)}})}),appEvent.on("cell.merge.add",function(t,n,o,r){var E=getColMax(),g=new Range(t,n,o,getAvailableEndCol()),i=g.getIterator();i.iterate(function(t,n){var o=0;if(o=FREEZED_ROW>0&&FREEZED_ROW>t?t:t-getAvailableStartRow(),r>=n){var g=getCell(t,n);null!==g&&(g.style.overflow="hidden")}else if(n===r+1)e(t,r+1,r+1+l+t%ROWS_PER_TILE*E),a[t][r+1]=r+1+l+t%ROWS_PER_TILE*E,void 0!=Merge.getCellInfo(t,n)&&(getCell(t,n).style.overflow="hidden");else if(n+l+t%ROWS_PER_TILE*E>a[t][n])if(void 0===Merge.getCellInfo(t,n)){var R=r+1+l+t%ROWS_PER_TILE*E-1;e(t,n,R),a[t][n]=R}else getCell(t,n).style.overflow="hidden";else i._skipColumn(getAvailableEndCol()-n)})}),appEvent.on("cell.merge.remove",function(e,l,t,n){var o,r=new Range(e,l,t,getAvailableEndCol()),E=r.getIterator();E.addEventListener("onRowBefore",function(e){var l=0;l=FREEZED_ROW>0&&FREEZED_ROW>e?e:e-getAvailableStartRow(),a[l]&&(o=a[l][n+1])}),E.iterate(function(e,t){var r=0;if(r=FREEZED_ROW>0&&FREEZED_ROW>e?e:e-getAvailableStartRow(),n>=t){var E=getCell(e,t);null!==E&&(E.style.overflow="visible",""===getCellContent(getCell(e,l))&&"'"!==getCellFormula(getCell(e,l))||t===l||(E.style.zIndex=a[r][l]-1,a[r][t]=a[r][l]-1))}else if(""===getCellContent(getCell(e,n+1))&&"'"!==getCellFormula(getCell(e,n+1)))if(t===n+1){var E=getCell(e,n+1);null!==E&&(E.style.zIndex=a[e][n],a[e][n+1]=a[e][n])}else if(o>=a[e][t]){var E=getCell(e,t);null!==E&&(E.style.zIndex=a[e][n],a[e][t]=a[e][n])}})}),appEvent.on("grid.merge.removeDOM",function(e,l,t){var n=0;if(n=FREEZED_ROW>0&&FREEZED_ROW>e?e:e-getAvailableStartRow(),a[e]){var o=a[e][l];if(!getCellContent(t)){var r=getCell(e,l);null!==r&&(a[e][l-1]===o?(r.style.zIndex=a[e][l-1],a[e][l]=a[e][l-1]):(r.style.zIndex=a[e][l-1]-1,a[e][l]=a[e][l-1]-1))}}}),appEvent.on("protectRange.apply",function(e,t,n){setTimeout(function(){var o=new Range(e,t,n,getAvailableEndCol()),r=o.getIterator();if(0!==t){var E=3;r.addEventListener("onRowBefore",function(){E=3}),r.iterate(function(e,n){var o=0;if(o=FREEZED_ROW>0&&FREEZED_ROW>e?e:e-getAvailableStartRow(),n===t)getCell(e,n).style.zIndex=n+l,a[o][n]=n+l,E=n+l-1;else{var g=getCell(e,n);""!==getCellContent(g)||"'"==getCellContent(g)||void 0!=Merge.getCellInfo(e,n)?r._skipColumn(getAvailableEndCol()-n):(g.style.zIndex=E,a[o][n]=E)}})}},100)}),appEvent.on("protectRange.remove",function(e,l,t){var o=new Range(e,l,t,getAvailableEndCol()),r=o.getIterator();if(0!==l){var E=3;r.addEventListener("onRowBefore",function(e,l){E=""!==getCellContent(getCell(e,l))||"'"==getCellContent(getCell(e,l))?a[e][l-1]:a[e][l-1]-1}),r.iterate(function(e,l){var t=getCell(e,l);rowVal=FREEZED_ROW>0&&FREEZED_ROW>e?e:e-getAvailableStartRow(),""!==getCellContent(t)||"'"==getCellContent(t)||void 0!=Merge.getCellInfo(e,l)||void 0!=Merge.getCellInfo(e,l-1)||ProtectedRanges.isCellLocked(e,l,!0)?r._skipColumn(getAvailableEndCol()-l):(t.style.zIndex=E,a[rowVal][l]=n)})}})}();
function removeXTileIfExcessThanViewPort(e,t,l){var a=getRowRangeToRemove(e),o=a.firstRow,n=a.endRow;n-o>=0&&(FREEZED_ROW>0&&o>=FREEZED_ROW&&n>=FREEZED_ROW||0===FREEZED_ROW)&&removeXTiles(o,n,e,t,l),void 0==o&&("SCROLLDOWN"==e&&(availableStartRow=findRowInYPos(getSheetScrollTop()-getSheetHeight())),"SCROLLUP"==e&&(availableEndRow=findRowInYPos(getSheetScrollTop()+2*getSheetHeight())))}function removeXTiles(e,t,l,a,o,n,r){if(-1!=t||-1!=e){var i=Row.getAvailableRowsInRange(e,t,!0),s=i.length;if(s>0){if(a)sheetTable.innerHTML="",(isColsOnlyFreezed||isColsAndRowsFreezed)&&(sheetTable3.innerHTML="");else switch(l){case"SCROLLUP":var d=s/ROWS_PER_TILE;removeSheetTableTiles(d,l),(isColsOnlyFreezed||isColsAndRowsFreezed)&&removeSheetTableTiles(d,l,sheetPane3Id);break;case"SCROLLDOWN":var d=s/ROWS_PER_TILE;o&&(d=n),removeSheetTableTiles(d,l),(isColsOnlyFreezed||isColsAndRowsFreezed)&&(o&&(d=r),removeSheetTableTiles(d,l,sheetPane3Id))}o||updateAvailableRowRange("DELETE",l,i,void 0,a);var R=!0;Merge.remove(e,0,t-1,getTotalColumn(),R)}}}function removeSheetTableTiles(e,t,l){if("SCROLLUP"==t)var a=!0;else var a=!1;for(var o=0,n=e;n>o;o++){if(a)var r=getLastTile(l);else var r=getFirstTile(l);if(null!=r){var i=r.parentNode;i.removeChild(r)}}}function getCell(e,t,l){if(e=parseInt(e),t=parseInt(t),0>e||0>t)return null;l=getPaneId(e,t);var a=Merge.getCellInfo(e,t),o=getAvailableStartRow(),n=getAvailableEndRow(),r=FREEZED_ROW;if(!a||!(a.startRow<r)&&(a.startRow>n||a.endRow<o))if("undefined"==typeof l||l==sheetPaneId||l==sheetPane3Id){if(e>=totRows||t>=totCols||e>n||t>getAvailableEndCol())return null}else if(e>=totRows||t>=totCols)return null;if(isUndefined(arguments[3])&&a){t=a.startCol,e=a.startRow;var i=null,s=a.getDOM();if(s)switch(l){case sheetPane1Id:i=s.mC1;break;case sheetPane2Id:i=s.mC2;break;case sheetPane3Id:i=s.mC3;break;default:i=s.mC}return i}var d=getRowIndex(e,l,!0),R=ROWS_PER_TILE,g=R,h=rowsInPage,v=Row.getAvailableRowsInFrozenRange(),w=0,c=h[0];v&&v.length?(w=v.length,c=Row.findNextNonHiddenRow(r-1)):w=0;var f=d,b=0;if(b=FREEZED_ROW>e?d:0!=o?d:d-v.length,-1!==d){var C=getTile(b,l),E=0,p=t,T=totCols,u=FREEZED_COL;t>=u?(p=Math.abs(u-t),T-=u):T=u;var S=f%g;E=S*T+p;var F=getChildNode(C,E);return F}return null}function insertTiles(e,t,l,a,o,n,r){if(isStr(e)&&isObject(t)){var i=r&&r.fakeReload,s=l,d=Row.getAvailableRowsInFrozenRange(FREEZED_ROW).length,R=Row.getAvailableRowsInFrozenRange(FREEZED_ROW),g=R[d-1];d&&i&&Row.findNextNonHiddenRow(g)!==l[d]&&s.splice(0,d),updateAvailableRowRange("INSERT",e,s,r,i);var h=sheetTable.childNodes.length,v=sheetTable3.childNodes.length,w=constructTileFromJSON(t,l,a,o,n,r),c=w.docFragment,f=w.freezedFrags,b=ISFREEZED;if(!isUndefined(c)||f)switch((prevScrollTop<getSheetScrollTop()-2*getSheetHeight()||prevScrollTop>getSheetScrollTop()+2*getSheetHeight()||"SCROLLDOWN"===e)&&(f&&(f.table1||f.table2)&&b&&(f.table1&&f.table1.hasChildNodes()&&(sheetTable1.innerHTML="",sheetTable1.appendChild(f.table1)),f.table2&&f.table2.hasChildNodes()&&(sheetTable2.innerHTML="",sheetTable2.appendChild(f.table2))),f&&f.table3&&f.table3.hasChildNodes()&&sheetTable3.appendChild(f.table3),sheetTable.appendChild(b?f.table:c)),e){case"SCROLLDOWN":prevScrollTop>=getSheetScrollTop()-2*getSheetHeight()&&(isColsOnlyFreezed||isColsAndRowsFreezed)&&b&&f.table3&&sheetTable3.appendChild(f.table3);break;case"SCROLLUP":b&&(f.table1||f.table2)&&(f.table1&&f.table1.hasChildNodes()&&(sheetTable1.innerHTML="",sheetTable1.appendChild(f.table1)),f.table2&&f.table2.hasChildNodes()&&(sheetTable2.innerHTML="",sheetTable2.appendChild(f.table2)));var C="";(isColsOnlyFreezed||isColsAndRowsFreezed)&&f.table3&&f.table3.hasChildNodes()&&(sheetTable3.childNodes.length?sheetTable3.insertBefore(f.table3,sheetTable3.childNodes[0]):sheetTable3.appendChild(f.table3)),C=getFirstTile();var E=c?c:f.table;sheetTable.childNodes.length?sheetTable.insertBefore(E,sheetTable.childNodes[0]):sheetTable.appendChild(E)}if(insertRowHdrs(l,e,r),i&&(removeXTiles(getAvailableStartRow(),getAvailableEndRow()+1,"SCROLLDOWN",void 0,!0,h,v),prevScrollTop=getSheetScrollTop(),setScrollTop(getSheetScrollTop())),loadXTileIfVacantInViewPort(i),isDocContainsArrayFormula){var p=endRow>startRow?startRow:endRow,T=o>a?a:o,u=startRow>endRow?startRow:endRow,S=a>o?a:o;fixArrayFormulaNotation(p,T,u,S)}for(var F in availChartRange)-1!=availChartRange[F]&&UpdateChartCellRange(availChartRange[F])}}function constructTileFromJSON(e,t,l,a,o,n){afterConstructTilesFromJson=!0;var r=[],i=ISFREEZED,s=FREEZED_ROW,d=FREEZED_COL;if(n){var R=n.reloadFrozenRows;r=n.frozenRows,r&&(A=r.length),R&&(r=Row.getAvailableRowsInFrozenRange(FREEZED_ROW),r[0]===t[0]&&(r=[]),t=r.concat(t))}{var g,h=t[0],v=(getRowTop(h),0),w=h,c=t.length;Row.getAvailableRows(i)}appEvent.trigger("constructTile",[t.length]);var f=getColMax();if(s)var b=document.createDocumentFragment(),C=a!=f-1?getColLeft(a+1):getColLeft(f-1)+getColWidth(f-1);if(d)var E=document.createDocumentFragment(),p=getColLeft(d);if(s&&d)var T=document.createDocumentFragment(),u=getColLeft(d);var S=document.createDocumentFragment(),F=a!=f-1?getColLeft(a+1):getColLeft(f-1)+getColWidth(f-1),R=!1,A=0,I=0,m=-1;if(A||(r=Row.getAvailableRowsInFrozenRange(FREEZED_ROW)),r&&r.length)A=r.length,m=r[A-1],I=Row.findNextNonHiddenRow(s-1);else{m=I=rowsInPage[0];var N=document.createDocumentFragment()}var L=TileUtil.getMarkup(),O=getCellMarkUp();do{w=t[v],g=getRowTop(w);var y=getRowHeight(w);if(i)if(s&&m>=w){if(d){var x=L.cloneNode("false");x.style.top=g+"px",x.style.height=y+"px",x.style.width=u+"px",x.style.display=0==y?"none":"",T.appendChild(x)}var D=L.cloneNode("false");D.style.top=g+"px",D.style.height=y+"px",D.style.width=C+"px",D.style.display=0==y?"none":"",b.appendChild(D)}else{if(d){var _=L.cloneNode("false");_.style.top=g+"px",_.style.height=y+"px",_.style.width=p+"px",_.style.display=0==y?"none":"",E.appendChild(_)}var W=L.cloneNode("false");W.style.top=g+"px",W.style.height=y+"px",W.style.width=F+"px",W.style.display=0==y?"none":"",S.appendChild(W)}else{var P=L.cloneNode("false");P.style.top=g+"px",P.style.height=y+"px",P.style.width=F+"px",P.style.display=0==y?"none":"",N.appendChild(P)}appEvent.trigger("setIndex",[w]);var H=e[w],Z=a-l+1,U=l;if(H){var k=(getRowTop(w),getRowHeight(w)),z=!1,M=null;do{var B=H[U],V=O.cloneNode(!1),X=V.style;if(isRTL&&z&&(V.style.borderRight=M,z=!1,M=null),isRTL?(X.right=getColLeft(U)+"px",X.left=null):(X.left=getColLeft(U)+"px",X.right=null),X.height=k+"px",X.width=getColWidth(U)+"px",appEvent.trigger("cell.construct.setProperty",[V,U,w,Z,B]),B){var Y=browser_ie?[]:"";Y=concat(Y,"cD");var J=B[CellConstants.CLASSNAME]||"",j=B[CellConstants.WRAP],q=B[CellConstants.CELLHYPER],G=B[CellConstants.VALUEFORMAT],Q=B[CellConstants.CELLANNOT],K=B[CellConstants.CELLFORMULA],$=B[CellConstants.CELLSTYLE],et=B[CellConstants.CELLVALUE],tt=B[CellConstants.ENCODEDCELLVALUE],lt=B[CellConstants.DATAVALIDATION];null===et&&(et="null"),null===tt&&(tt="null"),et&&(et=decodeURIComponent(et)),tt&&(tt=decodeURIComponent(tt)),lt&&(lt=decodeURIComponent(lt));var at=isUndefined(et)?"":et;isUndefined(tt)?tt=at:at=tt,Y=j?concat(Y," W"):concat(Y," nW"),j&&(V.style.overflow="hidden");var ot=getCSSStyleRegex("utextAlign");ot.test(J)||G&&1!==G&&-1==J.indexOf("tar")&&(Y=concat(Y," tar")),J&&(Y=concat(Y,J)),browser_ie&&(Y=Y.join("")),isRTL&&(-1!==Y.indexOf("far")&&(Y=Y.replace("far","")),-1!==Y.indexOf("tar")&&(Y=Y.replace("tar","")));var nt=isRTL?/( (fa|ta)[lc])(\b)/i:/( (fa|ta)[rc])(\b)/i;if((nt.test(Y)||-1!=Y.indexOf(" W"))&&addFlexBoxDiv(V,""),V.className=Y,q){var rt=(q[0],q[1]);"multi"!=rt&&(at=q[2],at=decodeURIComponent(at))}if(G){switch(G){case 1:G="STRING";break;case 2:G="FORMULA";break;case 3:G="DATE";break;case 4:G="PERCENT";break;case 5:G="FRACTION";break;case 6:G="CURRENCY";break;case 7:G="BOOLEAN";break;case 8:G="DATETIME";break;case 9:G="ERROR";break;case 10:G="TIME";break;case 11:G="MATRIX";break;case 12:G="SCIENTIFIC";break;case 13:G="FLOAT"}V.setAttribute("format",G)}if(isUndefined(K)||(K=decodeURIComponent(K),V.setAttribute("fn",K)),$)for(var it in $)switch(it){case"1":V.style.backgroundColor=$[it],z=!1;break;case"2":V.style.color=$[it],z=!1;break;case"3":V.style.fontFamily=$[it],z=!1;break;case"4":V.style.fontSize=$[it],z=!1;break;case"5":V.style.textAlign=$[it],z=!1;break;case"6":V.style.verticalAlign=$[it],z=!1;break;case"7":V.style.borderTop=$[it],z=!1;break;case"8":V.style.borderBottom=$[it],z=!1;break;case"9":V.style.borderLeft=$[it],z=!1;break;case"10":isRTL?(z=!0,M=$[it]):(V.style.borderRight=$[it],z=!1);break;case"11":V.className+=" nFT"+$[it],z=!1}if(isUndefined(et)||V.setAttribute("cV",et),q){if("multi"!=rt?appEvent.trigger("addlink",[V,et,at.replace(/\n/g,"<br>"),!0]):appEvent.trigger("addlink",[V,et]),(browser_ie||browser_safari)&&null!=V){var st=getHyperLinkInCell(V).childTag;if(st){{var dt=V;V.className}dt=getCellContentNode(V);for(var Rt=getChildNodesLength(dt),gt=0;Rt>gt;gt+=1)if(st=getChildItem(dt.childNodes,gt),null!=st&&"A"==st.nodeName){var ht="",vt=getCSSStyleRegex("fontSize").exec(Y);null!=vt&&(ht=vt[0]),vt=getCSSStyleRegex("fontFamily").exec(Y),null!=vt&&(ht+=vt[0]);var wt=V.style.fontSize,ct=V.style.fontfamily;""!=wt&&(st.style.fontSize=wt),""!=ct&&(st.style.fontfamily=ct)}}}}else{var at=encodeBlankSpaces(at.replace(/\n/g,"<br>"),!0);setCellInnerHTML(V,revertQuote(at))}isUndefined(lt)||appEvent.trigger("cell.setDataValidation",[w,U,V,lt]),isUndefined(Q)||appEvent.trigger("annot.add",[V,Q,w,U])}else V.className="cD nW";s||d?s&&m>=w?d&&d>U?x.appendChild(V):D.appendChild(V):d>0&&d>U?_.appendChild(V):W.appendChild(V):P.appendChild(V);var ft=Merge.getRootCellInfo(w,U);if(ft){var bt=ft.startRow,Ct=ft.startCol,Et=ft.endRow,pt=ft.endCol;Merge.remove(bt,Ct,Et,pt,void 0,!0)}U++,Z--}while(Z)}else{{getRowTop(w)}do{var V=O.cloneNode(!1),k=getRowHeight(w);V.className="cD nW",V.style.height=k+"px",V.style.width=getColWidth(U)+"px",V.style[isRTL?"right":"left"]=getColLeft(U)+"px",V.style.display=0==k?"none":"",appEvent.trigger("cell.construct.setProperty",[V,U,w,Z]),s||d?s&&m>=w?d&&d>U?x.appendChild(V):D.appendChild(V):d&&d>U?_.appendChild(V):W.appendChild(V):P.appendChild(V);var ft=Merge.getRootCellInfo(w,U);if(ft){var bt=ft.startRow,Ct=ft.startCol,Et=ft.endRow,pt=ft.endCol;Merge.remove(bt,Ct,Et,pt,void 0,!0)}U++,Z--}while(Z)}v++}while(c>v);if(i){var Tt={};return s&&b.hasChildNodes()&&(Tt.table2=b),d&&E.hasChildNodes()&&(Tt.table3=E),s&&d&&T.hasChildNodes()&&(Tt.table1=T),Tt.table=S,{freezedFrags:Tt}}return{docFragment:N}}function insertAndShiftRows(e,t,l,a){var o=e?getCloneRow(a):getDummyRow(),n=t;resetRowsInPage();var r=Row.getAvailableRows(),i=ArrayUtils.getSortedIndex(r,e),s=FREEZED_ROW,d=FREEZED_COL,R=ROWS_PER_TILE,g=R,h=Row.getAvailableRowsInFrozenRange(),v=0,w=0,c=Row.getAvailableRowsInFrozenRange(s).length;h&&h.length?(v=h.length,w=h[v-1]):w=r[0];var f=r[0]==h[0],b=f?r[v]:r[0],C=r.indexOf(b),E=i%R,p=g,T=i,u=TileUtil.getMarkup();i>=C&&R>i&&f&&(g=R-v,T=i-C,E=T%g,p=g);var S=0|T,F=totCols,A=getAvailableTiles(sheetPaneId);if(d)var I=getAvailableTiles(sheetPane3Id);for(var m=A.length;m>S;){var N=document.createDocumentFragment(),L=S*g,O=r[L],y=getRowTop(O),x=S++;if(d)var D=document.createDocumentFragment();var _="0px";if(t-->0){for(var W=0;F>W;W++){var P=o[W].cloneNode(!0);d>W?D.appendChild(P):N.appendChild(P),P.style.top=_}if(d){var H=u.cloneNode("false");H.appendChild(D),H.style.top=getRowTop(i)+"px",H.style.width=getColLeft(d)+"px",H.style.height=getRowHeight(i)+"px",0===getAvailableStartRow()?sheetTable3.insertBefore(H,sheetTable3.childNodes[i-c]):sheetTable3.insertBefore(H,sheetTable3.childNodes[i])}var Z=u.cloneNode("false");Z.appendChild(N),Z.style.top=getRowTop(i)+"px",Z.style.height=getRowHeight(i)+"px",Z.style.width=getColLeft(F-1)+getColWidth(F-1)+"px",0===getAvailableStartRow()?sheetTable.insertBefore(Z,sheetTable.childNodes[i-c]):sheetTable.insertBefore(Z,sheetTable.childNodes[i])}else{var U=A[x];if(d){var k=I[x];k.style.top=y+"px"}U.style.top=y+"px"}i++}for(var z=document.createDocumentFragment(),M=document.createDocumentFragment(),B=A.length,V=B-1,W=0;n>W;V--,W++){var X=A[V];if(d){var Y=I[V];M.appendChild(Y)}z.appendChild(X)}}function _getCellArrToInsert(e,t,l,a,o,n,r){isUndefined(r)&&(r=sheetPaneId);var i=0==l?!0:!1;if(i||n)var s=getDefaultCellHTML();var d,R=l==totCols,g=[],h=[],v=Row.getAvailableRows(ISFREEZED),w=ROWS_PER_TILE,c=Row.getAvailableRowsInFrozenRange(),f=0,b=0,C=0,E=0;c&&c.length?(f=c.length,E=c[f-1],b=Row.findNextNonHiddenRow(FREEZED_ROW-1),C=FREEZED_ROW):(b=E=v[0],C=Row.findNextNonHiddenRow(w));for(var p=0,T=0,u=v.length;u>T;T++){var S=v[T],F=w,A=T;if(c&&-1==v.indexOf(b)&&(A=Math.abs(T-f-1)),i||n){A%F===0&&(p=0);var I=getRowHeight(S),d=s.cloneNode(!0);d.style.height=I+"px",p+=I}else{var m=getCell(S,e,r,!0);d=m.cloneNode(!0)}if(!i&&Merge.getCellInfo(S,e)){var N=getColLeft(e),o=getColWidth(e);d.style.left=N+"px",d.style.width=o+"px"}setDefaultValueForCell(d);var L=null;if(R)if((A+1)%F===0)L=null;else{var O=v[T+1];L=getCell(O,FREEZED_COL,r,!0),appEvent.trigger("grid.insertCol",[currCol,totCols])}else L=getCell(S,l,r,!0);removeCSSStyle("cellComment",d),null!=d.getAttribute("comment")&&d.removeAttribute("comment"),null!=d.getAttribute("onmouseover")&&d.removeAttribute("onmouseover"),null!=d.getAttribute("onmouseout")&&d.removeAttribute("onmouseout"),handleBordersInInsertCol(d,L),g[S]=L,h[S]=d}return{insertCellArr:g,newCellArr:h}}function _insertCells(e,t,l,a,o,n,r){getAvailableStartRow(),getAvailableEndRow();isUndefined(r)&&(r=sheetPaneId);var i=[],s=t==totCols?!0:!1,d=Row.getAvailableRows(ISFREEZED),R=0,g=0,h=0,v=ROWS_PER_TILE,w=Row.getAvailableRowsInFrozenRange(),c=d[0];w&&w.length?(R=w.length,g=w[R-1],h=Row.findNextNonHiddenRow(g),c=w[0],firstRowOf2ndTile=FREEZED_ROW):(g=h=c,firstRowOf2ndTile=d[v]);for(var f=d.length,b=0;f>b;b++){var C=d[b],E=document.createDocumentFragment();if(s)var p=getColLeft(t-1)+getColWidth(t-1);else var p=getColLeft(t);for(var T=0,u=0;a>u;u+=1){var S=e[C].cloneNode(!0);S.style[isRTL?"right":"left"]=p+"px","append"==n&&(o=colWidthAry[t],S.style.width=o+"px"),E.appendChild(S),p+=o,T+=o}i[C]=E}shiftCellsHorizontally(t,totCols-1,{mode:"DIFF",val:T},r);for(var F=0,b=0;f>b;b++){{var A,C=d[b];getRowIndex(C)}(C==h||b===R)&&(F=0);var A;A=FREEZED_ROW&&h>C?getTile(F,sheetPane2Id):getTile(F),F++,A.insertBefore(i[C],l[C]),A.style.width=getColLeft(totCols+a-1)+getColWidth(totCols+a-1)+"px"}}function updateAvailableRowRange(e,t,l,a,o){var n=l[0],r=l[l.length-1];switch(e){case"DELETE":if(o)availableStartRow=-1,availableEndRow=-1;else switch(t){case"SCROLLDOWN":availableStartRow=Row.findNthNonHiddenRow(1,r,!0);break;case"SCROLLUP":availableEndRow=Row.findNthNonHiddenRow(1,n,!1)}break;case"INSERT":if(-1==availableStartRow&&-1==availableEndRow&&(o=!0),o)availableStartRow=n,availableEndRow=r;else switch(t){case"SCROLLDOWN":0===n&&(availableStartRow=0),availableEndRow=r,0==sheetTable.childNodes.length&&(availableStartRow=n);break;case"SCROLLUP":availableStartRow=n,0==availableEndRow&&(availableEndRow=r),0==sheetTable.childNodes.length&&(availableEndRow=r)}}Row.setAvailableRows(Row.getNonHiddenRowsInRange(getAvailableStartRow(),getAvailableEndRow()))}function reloadPage(e,t,l,a,o){if(responseManager.isRequestPending()){var n={fn:reloadPage,params:arguments,condn:function(){return!responseManager.isRequestPending()}};return void actionManager.addEventListener("onResponse",n)}var e=void 0===e?getSheetScrollTop():e;if(Row.isAllRowsHidden()){if(l&&l.onFailure){var r=l.onFailure.params?l.onFailure.params:[];l.onFailure.method.apply(void 0,r)}removeXTiles(getAvailableStartRow(),getAvailableEndRow()+1,"SCROLLDOWN",!0)}else{e>getSheetTableHeight()&&(e=getSheetTableHeight()-getSheetHeight());var i=rowRangetoLoad(e,!0),s=i.startRow,d=i.endRow,R=i.scrollType;submitScrollForm(getNonHiddenRowsInPage(s,d),R,"true",t,l,a,o)}}function _removeCellsDeleteCol(e,t,l){function a(e){return b=i>e?e%s:e>=i&&s>e&&R?(e-i)%s:R?(e-i)%s:e%s}function o(e,t){var l=i>e?sheetTable2:sheetTable;return l.childNodes[t]}var n=Row.getAvailableRows(),r=Row.getAvailableRowsInFrozenRange(),i=0,s=ROWS_PER_TILE,d=[],R=r[0]===n[0];r&&r.length?(i=r.length,d=R?n:r.concat(n)):d=n;for(var g=d.length,h="",v=t+e,w=[],c=totCols,f=[],b=-1,C=0,E=0;g>C;C++){var p=[];b=a(C),0===b&&(C==i&&(E=0),h=o(C,E),w=h.childNodes,E++);for(var T=t,u=0;v>T;T++,u++){var S=T-FREEZED_COL+b*(c-FREEZED_COL);p[u]=w[S]}f[C]=p}shiftCellsHorizontally(v,totCols-1,{mode:"DIFF",val:-l});for(var C=0,E=0;g>C;C++){var p=f[C];b=a(C),0===b&&(C==i&&(E=0),h=o(C,E),E++);for(var F=0;F<p.length;F++)h.removeChild(p[F])}}Row.getLoadedRowsInFrozenRange=function(){return visibleRowsInFrozenRange=[],FREEZED_ROW>0&&(visibleRowsInFrozenRange=Row.getNNonHiddenRows(FREEZED_ROW,0)),visibleRowsInFrozenRange},Row.dom.setRowsHeight=function(e,t){var l=Row.getAvailableRowsInRange(e,t,!0),a=Row.getAvailableRows(),o=Row.dom.getCellsInRows(e,getAvailableEndRow()),n=isRowInAvailableRowRange(e)?ArrayUtils.getSortedIndex(a,e):0,r=totCols,i=FREEZED_ROW,s=FREEZED_COL,d=0,R=Row.getAvailableRowsInFrozenRange(),g=0,h=0,v=Row.getAvailableRowsInFrozenRange(i).length;R&&R.length?(d=R.length,g=R[d-1],h=Row.findNextNonHiddenRow(i-1)):(g=a[0],h=g);for(var w=n,c=a.length,f=0;c>w;w++,f++){var b=o[f],C=a[w],E=-1!==l.indexOf(C),p=0,T=w;T=w,p=a[T];var u=getRowTop(C),S=getRowTop(C),F=getRowHeight(C),A=getTileIndex(C);i&&0===availableStartRow&&(A-=v);var I=getTile(A);if(C>=i&&s>0){var m=getTile(A,sheetPane3Id);m&&(m.style.top=S+"px",m.style.height=F+"px")}I&&(I.style.top=u+"px",I.style.height=F+"px");for(var N=0;r>N;N++){var L=b[N];E&&L&&(L.style.height=F+"px",setCellHeightForVAlignedCell(L))}}},Row.dom.getCellsInRows=function(e,t){var l=Row.getAvailableRows();if(!isArray(e)){var a=ArrayUtils.getSortedIndex;e=l.slice(a(l,e),a(l,t)+1)}var o=sheetTable.childNodes,n=FREEZED_COL,r=Row.getAvailableRowsInFrozenRange(FREEZED_ROW).length;if(FREEZED_ROW)var i=sheetTable2.childNodes;if(n)var s=sheetTable3.childNodes;if(FREEZED_ROW&&n)var d=sheetTable1.childNodes;var R=[],g=totCols-n,h=n;if(ISFREEZED){var v=Row.getAvailableRowsInFrozenRange(),w=l[0]<FREEZED_ROW;if(w)var c=l.slice(ArrayUtils.getSortedIndex(l,FREEZED_ROW),ROWS_PER_TILE)}for(var f=0,b=e.length;b>f;f++){var C=e[f],E=FREEZED_ROW>C,p=E?v.indexOf(C):getRowIndex(C);if(-1!==p){!E&&FREEZED_ROW&&C>=FREEZED_ROW&&0==getAvailableStartRow()&&(p-=r);var T=~~(p/ROWS_PER_TILE),u=w&&C>=c[0]&&C<=c[c.length-1],S=(u?c.indexOf(C):p%ROWS_PER_TILE,[]);if(n&&(ISFREEZED?E?d[T]&&(S=ArrayUtils.slice(d[T].childNodes,0,h)):s[T]&&(S=ArrayUtils.slice(s[T].childNodes,0,h)):S=[]),E){if(i[T])var F=ArrayUtils.slice(i[T].childNodes,0,g)}else if(o[T])var F=ArrayUtils.slice(o[T].childNodes,0,g);R.push(S.concat(F))}}return R},Row.dom.removeAndShiftRows=function(e,t){var l,a=FREEZED_COL,o=Row.getAvailableRowsInRange(e),n=getTilesCount(),r=n-o.length,i=Row.getAvailableRowsInFrozenRange(FREEZED_ROW).length,s=parseInt(r),d=n-s,R=o[0],g=Row.getAvailableRows();l=s>0?Row.predictNthNonHiddenRow(s+i,o,getAvailableStartRow()):Row.findNextNonHiddenRow(getAvailableEndRow(),!0);{var h,v=R;Row.getAvailableRowsInRange(getAvailableStartRow(),R).length-1}if(t||getAvailableStartRow()!==R||(h=!0),0===s&&(l=getAvailableStartRow()),s>0&&l>v)for(var w=g.indexOf(v),c=g.indexOf(l)>0?l:g.length,f=g.slice(w,c),b=this.getCellsInRows(f),C=0,E=0,p=f.length;p>E;E++){var T=f[E],u=(b[E],getRowIndex(T));if(FREEZED_ROW&&0==getAvailableStartRow()&&(u-=i),-1!==o.indexOf(T))C++,sheetTable.removeChild(sheetTable.childNodes[u-o.indexOf(T)]),a>0&&sheetTable3.removeChild(sheetTable3.childNodes[u-o.indexOf(T)]);else{h&&(availableStartRow=T,h=!1);var S=f[E-C],F=getTileIndex(S),A=getTileIndex(T);0===getAvailableStartRow()&&(F-=i,A-=i);var I=getTile(F);if(a){var m=getTile(F,sheetPane3Id);getTile(A,sheetPane3Id)}var N=t?T-ArrayUtils.getSortedIndex(e,T):T,L=getRowTop(N);I.style.top=L+"px",a&&(m.style.top=L+"px")}}if(d!==getTilesCount()){FREEZED_ROW&&0==getAvailableStartRow()&&(s+=i);var O=Row.getNNonHiddenRows(s,availableStartRow),y=Row.getNNonHiddenRows(d,l)}else var x=!0;return{rowsToLoad:y,availableRows:O,pageReload:x}};
function loadXTiles(e,o,t,l){Row.getAvailableRows().length;extraViewPorts=1;var r=findRowInYPos(getSheetScrollTop()+3*sheetHeight,!0,!0)-findRowInYPos(getSheetScrollTop(),!0,!0);extraViewPorts=r>1&&50>r&&getSheetScrollTop()>=0?2:1;var a=rowRangetoLoad(e,o,l);if(a&&a.isValidRequestRange){var i=a.startRow,R=a.endRow,S=a.scrollState,s=!1;(prevScrollTop>getSheetScrollTop()+(extraViewPorts+1)*sheetHeight||prevScrollTop<getSheetScrollTop()-(extraViewPorts+1)*sheetHeight)&&(s=!0),isRespondedInScroll&&removeXTileIfExcessThanViewPort(a.scrollState,s,o),clearTileLoadTimeout(),isTileLoaded=!1,tileLoadTimeoutId=isVScrollFaceClicked?setTimeout("onTileLoadTimeout('VSCROLLBAR_FACE_DRAG',"+i+","+R+")",500):setTimeout("onTileLoadTimeout('SCROLL_WITHOUT_VSCROLLBAR_FACE_DRAG',"+i+","+R+")",500),lastRequestedTileInfo={startRow:i,endRow:R},s||0!=!getAvailableStartRow()||0!=!getAvailableEndRow()||-1==getAvailableEndRow()||-1==getAvailableStartRow()||("SCROLLUP"==a.scrollState?R=getAvailableStartRow()-1:i=getAvailableEndRow()+1),submitScrollForm(Row.getNonHiddenRowsInRange(i,R),S,void 0,void 0,void 0),prevScrollTop=getSheetScrollTop()}else setRowInfoBoxTimeout()}function rowRangetoLoad(e,o,t){var l,r,a,i=!0,R=void 0===e?getSheetScrollTop():e,S=getSheetHeight();if(o)i=!0,l=R-extraViewPorts*S>0?findRowInYPos(R-extraViewPorts*S,!0,!0):0,r=findRowInYPos(R+(extraViewPorts+1)*S,!0,!0),a="SCROLLDOWN";else if(l=R-extraViewPorts*S>0?findRowInYPos(R-extraViewPorts*S,!0,!0):0,prevScrollTop<getSheetScrollTop()||prevScrollTop===getSheetScrollTop()&&l>availableStartRow||0===prevScrollTop&&0===getSheetScrollTop()&&l>=availableStartRow||t){r=findRowInYPos(R+(extraViewPorts+1)*S,!0,!0);var s=getAvailableEndRow(),w=getAvailableStartRow();(l>r-1||s>=r-1)&&(i=!1),s>0&&(s+=1),prevScrollTop<getSheetScrollTop()-2*getSheetHeight()||(s>l&&0!==s&&0!=getSheetScrollTop()&&(l=s),0==l&&s>0&&!o&&(l=s)),t&&(l=s),a="SCROLLDOWN"}else{l=R-extraViewPorts*S>0?findRowInYPos(R-extraViewPorts*S):0,r=findRowInYPos(R+(extraViewPorts+1)*S,!0,!0);var w=getAvailableStartRow();l>=w&&(i=!1),0===w&&0===getAvailableEndRow()&&(i=!0),prevScrollTop>getSheetScrollTop()+2*getSheetHeight()||(r=r>=w&&0!=w?w-1:r),FREEZED_ROW>l&&l>0&&(l=0,FREEZED_ROW>r&&(r=FREEZED_ROW)),FREEZED_ROW>r&&(r=FREEZED_ROW),a="SCROLLUP"}return{startRow:l,endRow:r,scrollState:a,isValidRequestRange:i}}function getRowRangeToRemove(e){var o,t;if(isStr(e)){switch(e){case"SCROLLDOWN":o=findRowInYPos(prevScrollTop-extraViewPorts*getSheetHeight(),!0),t=findRowInYPos(getSheetScrollTop()-extraViewPorts*getSheetHeight(),!0)-1,getAvailableStartRow()<o&&(o=getAvailableStartRow()),(getSheetScrollTop()-prevScrollTop===1||getSheetScrollTop()===prevScrollTop)&&(o=t),o>availableStartRow&&(o=availableStartRow),FREEZED_ROW>o&&t>=FREEZED_ROW&&(o=FREEZED_ROW);break;case"SCROLLUP":o=findRowInYPos(getSheetScrollTop()+(extraViewPorts+1)*getSheetHeight(),!0)+1,t=findRowInYPos(prevScrollTop+(extraViewPorts+1)*getSheetHeight(),!0),t<getAvailableEndRow()&&(t=getAvailableEndRow())}return{firstRow:o,endRow:t}}}
