!function(c){var _=c.sPlusPlus,M=c.ZSConstants.FeatureConstants,o=(c.document,c.UserAction,_.view.Toolbar.Feature[M.COLOR_SCALE],{});o.GREEN_WHITE={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#FFFFFF",noofcond:2,noofrules:1},o.RED_WHITE={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#FFFFFF",noofcond:2,noofrules:1},o.GREEN_YELLOW={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#FCD058",noofcond:2,noofrules:1},o.WHITE_GREEN={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#FFFFFF",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#5AB187",noofcond:2,noofrules:1},o.WHITE_RED={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#FFFFFF",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#E07369",noofcond:2,noofrules:1},o.YELLOW_GREEN={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#FCD058",cr_ty2:"MAXIMUM",cval2:"",cs_c2:"#5AB187",noofcond:2,noofrules:1},o.GREEN_YELLOW_RED={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FCD058",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#E07369",noofcond:3,noofrules:1},o.BLUE_WHITE_RED={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#749AC8",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#E07369",noofcond:3,noofrules:1},o.GREEN_WHITE_RED={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#5AB187",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#E07369",noofcond:3,noofrules:1},o.RED_YELLOW_GREEN={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FCD058",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#5AB187",noofcond:3,noofrules:1},o.RED_WHITE_BLUE={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#749AC8",noofcond:3,noofrules:1},o.RED_WHITE_GREEN={cr_ty1:"MINIMUM",cval1:"",cs_c1:"#E07369",cr_ty2:"PERCENTILE",cval2:"50",cs_c2:"#FFFFFF",cr_ty3:"MAXIMUM",cval3:"",cs_c3:"#5AB187",noofcond:3,noofrules:1},c.ZSConstants.ColorscaleTheme=o}(this);
!function(i){var c=(i.sPlusPlus,i.ZSConstants.FeatureConstants,i.ZSConstants.IconSetConstants),_={},n={};_[c.LIKES2]={cr_ty2:"PERCENT",cval2:"50",is_c2:"gteq",noofcond:2,noofrules:1,iconSetName:"2Likes",istheme:!0,icon_name1:"2Likes",icon_id1:0,icon_name2:"2Likes",icon_id2:1},_[c.LOVE2]={cr_ty2:"PERCENT",cval2:"50",is_c2:"gteq",noofcond:2,noofrules:1,iconSetName:"2Love",istheme:!0,icon_name2:"3Heart",icon_id2:0,icon_name1:"2Love",icon_id1:1},_[c.INDICATOR2]={cr_ty2:"PERCENT",cval2:"50",is_c2:"gteq",noofcond:2,noofrules:1,iconSetName:"2Indicators",istheme:!0,icon_name2:"2Indicators",icon_id2:1,icon_name1:"2Indicators",icon_id1:0},_[c.ARROWS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Arrows",istheme:!0,icon_name1:"5Arrows",icon_id1:0,icon_name2:"5Arrows",icon_id2:2,icon_name3:"5Arrows",icon_id3:4},_[c.STARS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Stars",istheme:!0,icon_name1:"3Stars",icon_id1:0,icon_name2:"3Stars",icon_id2:1,icon_name3:"3Stars",icon_id3:2},_[c.SMILEYS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Smileys",istheme:!0,icon_name1:"5Smileys",icon_id1:1,icon_name2:"5Smileys",icon_id2:2,icon_name3:"5Smileys",icon_id3:3},_[c.HEARTRATING3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3HeartRating",istheme:!0,icon_name1:"3HeartRating",icon_id1:0,icon_name2:"3HeartRating",icon_id2:1,icon_name3:"3Heart",icon_id3:0},_[c.TRIANGLES3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Triangles",istheme:!0,icon_name1:"3Triangles",icon_id1:0,icon_name2:"3Triangles",icon_id2:1,icon_name3:"3Triangles",icon_id3:2},_[c.SIGNS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Signs",istheme:!0,icon_name1:"3Signs",icon_id1:0,icon_name2:"3Signs",icon_id2:1,icon_name3:"5TrafficLights",icon_id3:4},_[c.TRAFFICLIGHTS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3TrafficLights",istheme:!0,icon_name1:"5TrafficLights",icon_id1:2,icon_name2:"5TrafficLights",icon_id2:3,icon_name3:"5TrafficLights",icon_id3:4},_[c.TRAFFICLIGHTS32]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3TrafficLights2",istheme:!0,icon_name1:"3TrafficLights2",icon_id1:0,icon_name2:"3TrafficLights2",icon_id2:1,icon_name3:"3TrafficLights2",icon_id3:2},_[c.ARROWSGRAY3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3ArrowsGray",istheme:!0,icon_name1:"5ArrowsGray",icon_id1:0,icon_name2:"5ArrowsGray",icon_id2:2,icon_name3:"5ArrowsGray",icon_id3:4},_[c.ARROWSGRAY4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4ArrowsGray",istheme:!0,icon_name1:"5ArrowsGray",icon_id1:0,icon_name2:"5ArrowsGray",icon_id2:1,icon_name3:"5ArrowsGray",icon_id3:3,icon_name4:"5ArrowsGray",icon_id4:4},_[c.ARROWSGRAY5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5ArrowsGray",istheme:!0,icon_name1:"5ArrowsGray",icon_id1:0,icon_name2:"5ArrowsGray",icon_id2:1,icon_name3:"5ArrowsGray",icon_id3:2,icon_name4:"5ArrowsGray",icon_id4:3,icon_name5:"5ArrowsGray",icon_id5:4},_[c.FLAGS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Flags",istheme:!0,icon_name1:"3Flags",icon_id1:0,icon_name2:"3Flags",icon_id2:1,icon_name3:"3Flags",icon_id3:2},_[c.SYMBOLS3]={cr_ty3:"PERCENT",cval3:"67",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"33",is_c2:"gteq",noofcond:3,noofrules:1,iconSetName:"3Symbols",istheme:!0,icon_name1:"3Symbols",icon_id1:0,icon_name2:"3Symbols",icon_id2:1,icon_name3:"3Symbols",icon_id3:2},_[c.TRAFFICLIGHTS4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4TrafficLights",istheme:!0,icon_name1:"5TrafficLights",icon_id1:0,icon_name2:"5TrafficLights",icon_id2:2,icon_name3:"5TrafficLights",icon_id3:3,icon_name4:"5TrafficLights",icon_id4:4},_[c.REDTOBLACK4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4RedToBlack",istheme:!0,icon_name1:"5TrafficLights",icon_id1:0,icon_name2:"5TrafficLights",icon_id2:1,icon_name3:"4RedToBlack",icon_id3:2,icon_name4:"5TrafficLights",icon_id4:2},_[c.TRAFFICLIGHTS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5TrafficLights",istheme:!0,icon_name1:"5TrafficLights",icon_id1:0,icon_name2:"5TrafficLights",icon_id2:1,icon_name3:"5TrafficLights",icon_id3:2,icon_name4:"5TrafficLights",icon_id4:3,icon_name5:"5TrafficLights",icon_id5:4},_[c.ARROWS4]={cr_ty4:"PERCENT",cval4:"75",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"50",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"25",is_c2:"gteq",noofcond:4,noofrules:1,iconSetName:"4Arrows",istheme:!0,icon_name1:"5Arrows",icon_id1:0,icon_name2:"5Arrows",icon_id2:1,icon_name3:"5Arrows",icon_id3:3,icon_name4:"5Arrows",icon_id4:4},_[c.ARROWS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Arrows",istheme:!0,icon_name1:"5Arrows",icon_id1:0,icon_name2:"5Arrows",icon_id2:1,icon_name3:"5Arrows",icon_id3:2,icon_name4:"5Arrows",icon_id4:3,icon_name5:"5Arrows",icon_id5:4},_[c.QUARTERS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Quarters",istheme:!0,icon_name1:"5Quarters",icon_id1:0,icon_name2:"5Quarters",icon_id2:1,icon_name3:"5Quarters",icon_id3:2,icon_name4:"5Quarters",icon_id4:3,icon_name5:"5TrafficLights",icon_id5:0},_[c.WEATHER5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Weather",istheme:!0,icon_name1:"5Weather",icon_id1:0,icon_name2:"5Weather",icon_id2:1,icon_name3:"5Weather",icon_id3:2,icon_name4:"5Weather",icon_id4:3,icon_name5:"5Weather",icon_id5:4},_[c.SMILEYS5]={cr_ty5:"PERCENT",cval5:"80",is_c5:"gteq",cr_ty4:"PERCENT",cval4:"60",is_c4:"gteq",cr_ty3:"PERCENT",cval3:"40",is_c3:"gteq",cr_ty2:"PERCENT",cval2:"20",is_c2:"gteq",noofcond:5,noofrules:1,iconSetName:"5Smileys",istheme:!0,icon_name1:"5Smileys",icon_id1:0,icon_name2:"5Smileys",icon_id2:1,icon_name3:"5Smileys",icon_id3:2,icon_name4:"5Smileys",icon_id4:3,icon_name5:"5Smileys",icon_id5:4},n[c.IN_3ARROWS0]=n[c.IN_4ARROWS0]=n[c.IN_5ARROWS0]=n[c.IN_4RATING0]=c.IS_5ARROWS0,n[c.IN_3ARROWS1]=n[c.IN_5ARROWS2]=c.IS_5ARROWS2,n[c.IN_3ARROWS2]=n[c.IN_4ARROWS3]=n[c.IN_5ARROWS4]=n[c.IN_4RATING3]=c.IS_5ARROWS4,n[c.IN_3ARROWS3]=n[c.IN_4ARROWS1]=n[c.IN_5ARROWS1]=n[c.IN_4RATING1]=c.IS_5ARROWS1,n[c.IN_3ARROWS4]=n[c.IN_4ARROWS2]=n[c.IN_5ARROWS3]=n[c.IN_4RATING2]=c.IS_5ARROWS3,n[c.IN_3ARROWSGRAY0]=n[c.IN_4ARROWSGRAY0]=n[c.IN_5ARROWSGRAY0]=c.IS_5ARROWSGRAY0,n[c.IN_3ARROWSGRAY1]=n[c.IN_5ARROWSGRAY2]=c.IS_5ARROWSGRAY2,n[c.IN_3ARROWSGRAY2]=n[c.IN_4ARROWSGRAY3]=n[c.IN_5ARROWSGRAY4]=c.IS_5ARROWSGRAY4,n[c.IN_4ARROWSGRAY1]=n[c.IN_5ARROWSGRAY1]=c.IS_5ARROWSGRAY1,n[c.IN_4ARROWSGRAY2]=n[c.IN_5ARROWSGRAY3]=c.IS_5ARROWSGRAY3,n[c.IN_4REDTOBLACK3]=n[c.IN_3TRAFFICLIGHTS10]=n[c.IN_3TRAFFICLIGHTS0]=n[c.IN_4TRAFFICLIGHTS1]=n[c.IN_5TRAFFICLIGHTS2]=c.IS_5TRIFFICLIGHTS2,n[c.IN_3TRAFFICLIGHTS11]=n[c.IN_3TRAFFICLIGHTS1]=n[c.IN_4TRAFFICLIGHTS2]=n[c.IN_5TRAFFICLIGHTS3]=c.IS_5TRIFFICLIGHTS3,n[c.IN_3TRAFFICLIGHTS12]=n[c.IN_3TRAFFICLIGHTS2]=n[c.IN_4TRAFFICLIGHTS3]=n[c.IN_5TRAFFICLIGHTS4]=n[c.IN_3SIGNS2]=c.IS_5TRIFFICLIGHTS4,n[c.IN_4REDTOBLACK0]=n[c.IN_4TRAFFICLIGHTS0]=n[c.IN_5TRAFFICLIGHTS0]=n[c.IN_5RATINGS4]=n[c.IN_5QUARTERS4]=n[c.IN_5BOXES4]=c.IS_5TRIFFICLIGHTS0,n[c.IN_4REDTOBLACK1]=n[c.IN_5TRAFFICLIGHTS1]=c.IS_5TRIFFICLIGHTS1,n[c.IN_3SYMBOLS10]=n[c.IN_3SYMBOLS20]=c.IS_3SYMBOLS0,n[c.IN_3SYMBOLS11]=n[c.IN_3SYMBOLS21]=c.IS_3SYMBOLS1,n[c.IN_3SYMBOLS12]=n[c.IN_3SYMBOLS22]=c.IS_3SYMBOLS2,n[c.IN_3SMILEYS0]=n[c.IN_3COLORSMILIES0]=c.IS_5SMILEYS0,n[c.IN_3SMILEYS1]=n[c.IN_3COLORSMILIES1]=c.IS_5SMILEYS2,n[c.IN_3SMILEYS2]=n[c.IN_3COLORSMILIES2]=c.IS_5SMILEYS4,n[c.IN_5RATINGS0]=n[c.IN_5QUARTERS0]=n[c.IN_5BOXES0]=c.IS_5QUARTERS0,n[c.IN_5RATINGS1]=n[c.IN_5QUARTERS1]=n[c.IN_5BOXES1]=c.IS_5QUARTERS1,n[c.IN_5RATINGS2]=n[c.IN_5QUARTERS2]=n[c.IN_5BOXES2]=c.IS_5QUARTERS2,n[c.IN_5RATINGS3]=n[c.IN_5QUARTERS3]=n[c.IN_5BOXES3]=c.IS_5QUARTERS3,n[c.IN_3HEARTRATING2]=n[c.IN_2LOVE0]=c.IS_3HEART0,i.ZSConstants.IconSetTheme=_,i.ZSConstants.classNameMap=n}(this);
!function(t){function n(){!t.UserAction&&(t.UserAction={}),!a.Manager&&(a.Manager={}),!a.Constants&&(a.Constants={}),!a.Action&&(a.Action={}),!a.Wrapper&&(a.Wrapper={}),!a.Model&&(a.Model={}),!a.transient&&(a.transient={}),!a.Controller&&(a.Controller={}),!a.Utility&&(a.Utility={}),!a.Client&&(a.Client={}),!a.Server&&(a.Server={}),!a.Mobile&&(a.Mobile={}),!a.Client.Action&&(a.Client.Action={}),!a.Server.Action&&(a.Server.Action={}),i()}function e(n,e){var i=t.ZSChart;i.transient[n]=e}function i(){e("sendToSheet",r)}function r(t,n){o&&o.NativeInterface.sendToSheet(t,n)}!t.ZSChart&&(t.ZSChart={});var o=(t.window,t.sPlusPlus),a=t.ZSChart;n(),a.transient.initMethod=e}(this);
!function(E){var T=E.ZSChart,O=2e5,C=ZSConstants.I18N;const I={PIE:"pie",SEMIPIE:"semipie",FUNNEL:"funnel",SCATTER:"scatter",COLUMN:"column",COLUMNCHART:"col",COL:"Column Chart",BAR:"bar",LINE:"line",XYLINE:"xyline",AREA:"area",SPLINE:"spline",BUBBLE:"bubble",BUBBLECHART:"bubblechart",OHLC:"ohlc",OHLCCHART:"ohlcchart",CANDLESTICK:"candlestick",WATERFALL:"waterfall",BULLET:"bullet",GROUPED:"groupedChart",SEMIDOUGHNUT:"semidoughnut",DOUGHNUT:"doughnut",STACKED:"STACKED",DOUGHNUT3D:"doughnut3d",PIE3D:"pie3d",COMBOCHART:"COMBOCHART",WORDCLOUD:"WORDCLOUD",PARETO:"PARETO",XYLINE_SCATTER:"xyline_scatter",XYLINE_SCATTER_SHAPES:"xyline_scatter_shapes",GROUPEDCOL:"groupedcol",GROUPEDBAR:"groupedbar",STEPCHART:"stepchart",HISTOGRAM:"HISTOGRAM"},H={CHART:"chart",XAXIS:"xAxis",XAXIS_LABELS:"xaxisLabels",YAXIS:"yAxis",TITLE_STYLE:"titleStyle",CHART_TITLE:"chartTitle",CHART_SUBTITLE:"subtitle",XTITLE:"xTitle",YTITLE:"yTitle"},t="rgba(255,255,255,1)",S="0.13",a=["#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#375a84","#863835","#6c823e","#594671","#34788a","#ac6931","#5b94d9","#dd5c59","#b2d766","#9373ba","#56c6e4","#ffad51","#325177","#793230","#617538","#503f66","#2f6c7c","#9b5f2c","#67a8f6","#fa6864","#caf374","#a682d3","#62e0ff","#ffc35b"],M={ONLOAD:1,STATUS_ALL:2,TITLE:{STATUS:11},SUBTITLE:{STATUS:21},LEGEND:{STATUS:31},DATA_LABEL:{STATUS:41},ERROR:{READONLY:50,SHEET_LOCKED:51},ALLOWED:61},_={HIGHCHARTS:"HIGHCHARTS"},A={STOCK:"datetime"},L={HIGHCHARTS:O++},F={CHART_TITLE_STYLE:"119",CHART_SUB_TITLE_STYLE:"120",CHART_X_AXIS_TITLE_STYLE:"117",CHART_Y_AXIS_TITLE_STYLE:"118",CHART_TITLE:"122",CHART_SUB_TITLE:"123",CHART_X_AXIS_TITLE:"115",CHART_Y_AXIS_TITLE:"116"},N={LEGEND_STYLE:125,STAGGER_LINES:139,SLANT:129,FONT_FAMILY:114,BACKGROUND_COLOR:108,PLOT_BACKGROUND_COLOR:109,XAXIS_TITLE_STYLE:117,YAXIS_TITLE_STYLE:118,TITLE_STYLE:119,SUB_TITLE_STYLE:120,XAXIS_LABEL_STYLE:127,GRIDLINE_COLOR:124,YAXIS_LABEL_STYLE:126,YAXIS_MIN:130,YAXIS_MAX:131,YAXIS_INTERVAL:132,PLOTLINE_TITLE:134,PLOTLINE_TITLE_STYLE:136,PLOTLINE_LABEL_STYLE:135,ADD_OR_DELETE_PLOTLINE:140,XY_REVERSE:141,XY_LOGARITHMIC:142,XY_BASEVALUE:143,XY_LABELS:144,XY_OPPOSITE:146,PLOTLINE_REMOVE:192},R={LEGEND:101,DATALABELS:102,MAJOR:103,MINOR:104,ANIMATION:105,TOOLTIP:106,MARKER:147},s={EXTENDING_LEGEND_ITEM:O++,EXTENDING_SERIES_TYPE:O++,EXTENDING_LEGEND:O++,EXTENDING_POINTER:O++,EXTENDING_TOOLTIP:O++,EXTENDING_POINTER_NORMALIZATION:O++,EXTENDING_WORDCLOUD_API:O++,EXTENDING_LOG_SCALE:O++,DEFER_CHART_INIT:O++,EXTENDING_EXPORTING:O++,CHART_POPOVER_INIT:O++},e={SHEET_OFFICE_COLORFUL_THEME1:"SHEET-OFFICE-COLORFUL-THEME1",SHEET_OFFICE_COLORFUL_THEME2:"SHEET-OFFICE-COLORFUL-THEME2",SHEET_OFFICE_COLORFUL_THEME3:"SHEET-OFFICE-COLORFUL-THEME3",SHEET_OFFICE_COLORFUL_THEME4:"SHEET-OFFICE-COLORFUL-THEME4",SHEET_OFFICE_COLORFUL_THEME5:"SHEET-OFFICE-COLORFUL-THEME5",SHEET_OFFICE_COLORFUL_THEME6:"SHEET-OFFICE-COLORFUL-THEME6",SHEET_OFFICE_MONO_THEME1:"SHEET-OFFICE-MONOCHORMATIC-THEME1",SHEET_OFFICE_MONO_THEME2:"SHEET-OFFICE-MONOCHORMATIC-THEME2",SHEET_OFFICE_MONO_THEME3:"SHEET-OFFICE-MONOCHORMATIC-THEME3",SHEET_OFFICE_MONO_THEME4:"SHEET-OFFICE-MONOCHORMATIC-THEME4",SHEET_OFFICE_MONO_THEME5:"SHEET-OFFICE-MONOCHORMATIC-THEME5",SHEET_OFFICE_MONO_THEME6:"SHEET-OFFICE-MONOCHORMATIC-THEME6",SHEET_OFFICE_MONO_THEME7:"SHEET-OFFICE-MONOCHORMATIC-THEME7",SHEET_OFFICE_MONO_THEME8:"SHEET-OFFICE-MONOCHORMATIC-THEME8",SHEET_OFFICE_MONO_THEME9:"SHEET-OFFICE-MONOCHORMATIC-THEME9",SHEET_OFFICE_MONO_THEME10:"SHEET-OFFICE-MONOCHORMATIC-THEME10",SHEET_OFFICE_MONO_THEME11:"SHEET-OFFICE-MONOCHORMATIC-THEME11",SHEET_OFFICE_MONO_THEME12:"SHEET-OFFICE-MONOCHORMATIC-THEME12",SHEET_OFFICE_MONO_THEME13:"SHEET-OFFICE-MONOCHORMATIC-THEME13",SHEET_OFFICE_MONO_THEME14:"SHEET-OFFICE-MONOCHORMATIC-THEME14",SHEET_OFFICE_MONO_THEME15:"SHEET-OFFICE-MONOCHORMATIC-THEME15",SHEET_OFFICE_MONO_THEME16:"SHEET-OFFICE-MONOCHORMATIC-THEME16",SHEET_OFFICE_MONO_THEME17:"SHEET-OFFICE-MONOCHORMATIC-THEME17",SHEET_OFFICE_MONO_THEME18:"SHEET-OFFICE-MONOCHORMATIC-THEME18",SHEET_OFFICE_MONO_THEME19:"SHEET-OFFICE-MONOCHORMATIC-THEME19",SHEET_OFFICE_MONO_THEME20:"SHEET-OFFICE-MONOCHORMATIC-THEME20",SHEET_OFFICE_MONO_THEME21:"SHEET-OFFICE-MONOCHORMATIC-THEME21",SHEET_OFFICE_MONO_THEME22:"SHEET-OFFICE-MONOCHORMATIC-THEME22",SHEET_OFFICE_MONO_THEME23:"SHEET-OFFICE-MONOCHORMATIC-THEME23",SHEET_OFFICE_MONO_THEME24:"SHEET-OFFICE-MONOCHORMATIC-THEME24",SHEET_OFFICE_MONO_THEME25:"SHEET-OFFICE-MONOCHORMATIC-THEME25",SHEET_OFFICE_MONO_THEME26:"SHEET-OFFICE-MONOCHORMATIC-THEME26",SHEET_OFFICE_MONO_THEME27:"SHEET-OFFICE-MONOCHORMATIC-THEME27",SHEET_OFFICE_MONO_THEME28:"SHEET-OFFICE-MONOCHORMATIC-THEME28",SHEET_OFFICE_MONO_THEME29:"SHEET-OFFICE-MONOCHORMATIC-THEME29",SHEET_OFFICE_MONO_THEME30:"SHEET-OFFICE-MONOCHORMATIC-THEME30",SHEET_OFFICE_MONO_THEME31:"SHEET-OFFICE-MONOCHORMATIC-THEME31",SHEET_OFFICE_MONO_THEME32:"SHEET-OFFICE-MONOCHORMATIC-THEME32",SHEET_OFFICE_MONO_THEME33:"SHEET-OFFICE-MONOCHORMATIC-THEME33",SHEET_OFFICE_MONO_THEME34:"SHEET-OFFICE-MONOCHORMATIC-THEME34",SHEET_OFFICE_MONO_THEME35:"SHEET-OFFICE-MONOCHORMATIC-THEME35",SHEET_OFFICE_MONO_THEME36:"SHEET-OFFICE-MONOCHORMATIC-THEME36"},n={COLORFUL:"COLORFUL",MONO:"MONOCHROMATIC",CUSTOM:"CUSTOM"},r={"SHEET-OFFICE-COLORFUL-THEME1":{startIndex:1,endIndex:6,basecolor:["#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"]},"SHEET-OFFICE-COLORFUL-THEME2":{startIndex:7,endIndex:12,basecolor:["#a0ce3a","#49bfc9","#f99a00","#ef4e31","#bf3870","#fecd44"]},"SHEET-OFFICE-COLORFUL-THEME3":{startIndex:13,endIndex:18,basecolor:["#d79a49","#db6e51","#7ebea3","#e6d561","#6ea2b7","#76566e"]},"SHEET-OFFICE-COLORFUL-THEME4":{startIndex:19,endIndex:24,basecolor:["#764852","#cbc4bc","#cf6c59","#e4bb61","#81a077","#e19351"]},"SHEET-OFFICE-COLORFUL-THEME5":{startIndex:25,endIndex:30,basecolor:["#d35a3f","#54b5be","#e69636","#78b87b","#f0c74d","#a9515b"]},"SHEET-OFFICE-COLORFUL-THEME6":{startIndex:31,endIndex:35,basecolor:["#3498DB","#2ECC71","#F1C40F","#E67E22","#EE4675","#9B59B6"]}},D={PUBLISH:"publish",REVERT:"unpublish",SHOWURL:"showUrl"},l={DATA_RANGE:O++,CHART_TITLE:O++,CHART_SUBTITLE:O++,CHART_X_AXIES:O++,CHART_Y_AXIES:O++,SP_TITLE_TEXT:O++},i={PNG:"png",JPEG:"jpeg"},o={DEFAULT:"DEFAULT",THOUSANDS:"THOUSAND",MILLIONS:"MILLION",BILLIONS:"BILLION",NONE:"NONE",CUSTOM:"CUSTOM"},U={DEFAULT:"DEFAULT",THOUSANDS:"THOUSAND",MILLIONS:"MILLION",BILLIONS:"BILLION",NONE:"NONE"},h={UNITS:"UNITS",SCALES:"SCALES",NONE:"NONE"},c={MENU_TAB:"CHART"};var p={};C&&(p={COLUMN:C["Chart.Display.Column"],BAR:C["Chart.Display.Bar"],COL:C["Chart.Display.Column"],GROUPEDCOL:C["Chart.Display.GrpColumn"],STACKEDCOL:C["Chart.Display.StkColumn"],STACKEDCOL_PERCENT:C["Chart.Display.StkPercentColumn"],GROUPEDBAR:C["Chart.Display.GrpBar"],STACKEDBAR:C["Chart.Display.StkBar"],STACKEDBAR_PERCENT:C["Chart.Display.StkPercentBar"],XYLINE:C["Chart.Display.line"],SPLINE:C["Chart.Display.spline"],STEPCHART:C["Chart.Display.step"],PIE:C["Chart.Display.pie"],SEMIPIE:C["Chart.Display.SemiPie"],DOUGHNUT:C["Chart.Display.doughnut"],SEMIDOUGHNUT:C["Chart.Display.semidoughnut"],XYAREA:C["Chart.Display.area"],XYSTACKEDAREA:C["Chart.Display.stkArea"],SCATTER:C["Chart.Display.scatter"],XYLINE_SCATTER:C["Chart.Display.scatterline"],XYLINE_SCATTER_SHAPES:C["Chart.Display.scatterlinemark"],BUBBLE:C["Chart.Display.Bubble"],POLAR:C["Chart.Display.Polar"],SPIDERWEB:C["Chart.Display.SpiderWeb"],CANDLESTICK:C["Chart.Display.CandleStick"],OHLCCHART:C["Chart.Display.OHLC"],TIMELINE:C["Chart.Display.Timeline"],TIMEAREA:C["Chart.Display.Timearea"],BULLETBAR:C["Chart.Display.bulletbar"],BULLETCOL:C["Chart.Display.bulletcol"],COMBOCHART:C["Chart.Display.combochart"],WATERFALL:C["Chart.Display.waterfallchart"],FUNNEL:C["Chart.Display.funnelchart"],PARETO:C["Chart.Display.paretochart"],HISTOGRAM:C["Chart.Display.histogramchart"],WORDCLOUD:C["Chart.Display.wordcloudchart"],COL3D:C["Chart.Display.column3dchart"],BAR3D:C["Chart.Display.bar3dchart"],PIE3D:C["Chart.Display.pie3dchart"],XYSTACKEDAREA_PERCENT:C["Chart.Display.stkPercentArea"],DOUGHNUT3D:C["Chart.Display.doughnut3d"],STACKEDCOL3D:C["Chart.Display.stkcolumn3d"],STACKEDCOL3D_PERCENT:C["Chart.Display.stkcolumn3dpercent"],STACKEDBAR3D:C["Chart.Display.stkbar3d"],STACKEDBAR3D_PERCENT:C["Chart.Display.stkbar3dpercent"]});const B={COL:"col",GROUPEDCOL:"grpCol",STACKEDCOL:"stkCol",STACKEDCOL_PERCENT:"stkCol100",BAR:"bar",GROUPEDBAR:"grpBar",STACKEDBAR:"stkBar",STACKEDBAR_PERCENT:"stkBar100",XYLINE:"line",SPLINE:"spiLine",STEPCHART:"stepLine",PIE:"pie",DOUGHNUT:"dghNut",SEMIDOUGHNUT:"dghNutSemi",XYAREA:"area",XYSTACKEDAREA:"stkArea",SCATTER:"sct",XYLINE_SCATTER:"sctLine",XYLINE_SCATTER_SHAPES:"sctLineMrk",BUBBLE:"bub",POLAR:"polar",SPIDERWEB:"spiWeb",CANDLESTICK:"hlc",OHLCCHART:"hlc",TIMELINE:"tmLine",TIMEAREA:"tmLineArea",BULLETBAR:"bullet",BULLETCOL:"colBullet",COMBOCHART:"comb",WATERFALL:"wtrFall",FUNNEL:"funn",PARETO:"funn",HISTOGRAM:"funn",WORDCLOUD:"funn",COL3D:"col",BAR3D:"bar",PIE3D:"pie",DOUGHNUT3D:"dghNut",STACKEDCOL3D:"stkCol",STACKEDCOL3D_PERCENT:"stkCol100",STACKEDBAR3D:"stkBar",STACKEDBAR3D_PERCENT:"stkBar100"},P={Auto:{Unit:-1,Symbol:"A"},Thousand:{MaxUnit:1e4,Unit:1e3,Symbol:"K"},Millions:{Unit:1e6,Symbol:"M"},Billions:{Unit:1e9,Symbol:"B"},Trillions:{Unit:1e12,Symbol:"T"}},b={DOM_HEIGHT:50,DOM_WEIGHT:70,FILTER_COUNT:5},d=[.001,.01,.1,1,100,1e3,1e6],y=["COL","BAR","XYLINE","XYAREA","COMBOCHART","STEPCHART","SPLINE","COL3D","BAR3D"];T.Constants.ChartTabName=c,T.Constants.ChartImageExtn=i,T.Constants.ChartRangePickerType=l,T.Constants.ChartPublishConstant=D,T.Constants.ColorThemeRange=r,T.Constants.SupportedTheme=e,T.Constants.ColorSchemeType=n,T.Constants.ChartType=I,T.Constants.Event=Event,T.Constants.ColorLimit=a,T.Constants.MessageConstant=M,T.Constants.ServiceProvider=_,T.Constants.ServiceType=A,T.Constants.CSPConstant=L,T.Constants.CAConstant=s,T.Constants.MULTI_AXIES_CHART_TYPE=y,T.Constants.ChartClasses=B,T.Constants.ChartNames=p,T.Constants.defaultColor=t,T.Constants.ChartUpdate=H,T.Constants.NumberFormat=o,T.Constants.TitleConstants=F,T.Constants.QuickStyleActions=N,T.Constants.QuickEditActions=R,T.Constants.GRADIENT_PERCENT=S,T.Constants.UnitConversion=P,T.Constants.PivotFilter=b,T.Constants.UnitFormat=U,T.Constants.ScaleRange=d,T.Constants.ConversionType=h}(this);
!function(s){s.ZSClass;const E={MENU_TAB:"PIVOT",FUNCTION:"fn",FILTER_CELLS:"fc",HEADER_INDEX:"hidx",PIVOT_FIELD_TYPE:"pft",PIVOT_DATAFIELDINDEX:"pdfi",ASCENDING_SORT:"as",PIVOT_SORTMODE:"psm",COUNT:"count",DISPLAY_MEMBER_MODE:"dmm",PIVOT_FILTER_DATAFIELDINDEX:"pfdfi",GROUP:"gr",PIVOTTEMPLATE_ID:"ptid",SUBTOTALOPTION:"sto",ROWGRANDTOTALOPTION:"rgto",COLGRANDTOTALOPTION:"cgto",PIVOT_ACTION_JSON:"pa_json",PIVOT_FILTER_DETAILS:"pfd",PIVOT_SORT_DETAILS:"psd",ALL_FIELDS:"af",PAGE_FIELDS:"pf",ROW_FIELDS:"rf",COLUMN_FIELDS:"cf",DATA_FIELDS:"df",ASSOCIATED_SOURCE_SHEET_NAME:"sasn",SOURCE_START_ROW:"ssr",SOURCE_START_COLUMN:"ssc",SOURCE_END_ROW:"ser",SOURCE_END_COLUMN:"sec",STROKE_STYLE:"ss",BACKGROUND_STYLE:"bs",FONT_STYLE:"fs",ROW:"R",COLUMN:"C"},F={R1_D1:{R:{0:{ss:"#5B80B8",bs:"#DEE6F1",fs:"#405F8E"},1:{ss:"#5B80B8",bs:"#DEE6F1",fs:"#405F8E"},2:{ss:"#5B80B8",bs:"#FFFFFF",fs:"#405F8E"},99:{ss:"#5B80B8",bs:"#FFFFFF",fs:"#405F8E"},999:{ss:"#5B80B8",bs:"#FFFFFF",fs:"#405F8E"}},C:{0:{ss:"#5B80B8",bs:"",fs:""},1:{ss:"#5B80B8",bs:"",fs:""},99:{ss:"#5B80B8"},999:{ss:"#5B80B8"}}},P1_R1_D1:{R:{0:{ss:"#5B80B8",bs:"#DEE6F1",fs:"#405F8E"},1:{ss:"#5B80B8",bs:"#FFFFFF",fs:"#405F8E"},2:{ss:"#5B80B8",bs:"#DEE6F1",fs:"#405F8E"},3:{ss:"#5B80B8",bs:"#DEE6F1",fs:"#405F8E"},99:{ss:"#5B80B8",bs:"#FFFFFF",fs:"#405F8E"},999:{ss:"#5B80B8",bs:"#FFFFFF",fs:"#405F8E"}},C:{0:{ss:"#5B80B8",bs:"",fs:""},1:{ss:"#5B80B8",bs:"",fs:""},99:{ss:"#5B80B8"},999:{ss:"#5B80B8"}}}};s.ZSConstants.PivotConstant=E,s.ZSConstants.PivotColorConstant=F}(this);
!function(o){function t(){a=this,setTimeout(function(){this.controller.showDroppables(this.allowedPanes)}.bind(this),0)}function n(){this.controller.hideDroppables()}function e(){this.droppable.classList.add("hover")}function i(){this.droppable.classList.remove("hover")}function s(o){o.preventDefault()}function r(){if(a&&a.holder!==this){var o=a.holder;a.open(this),o.removePanel(a)}a=void 0}var a,l=(o.sPlusPlus,o.ZSClass),h=l.SidePanelUtility={};h.onDragStart=t,h.onDragEnd=n,h.onDragEnter=e,h.onDragLeave=i,h.onDragOver=s,h.onDrop=r}(this);
!function(t){function i(t){var i=document.createElement("div");return t&&(i.className=t),i}function e(){var t=i(n);t.addEventListener("click",function(){this.toggle()}.bind(this)),this.icon=t}function s(t,s,l){e.call(this),t.onCreate&&t.onCreate.call(this),!!t.underDevelopment&&(this.icon.style.display="none"),this.panel=i(o),this.callBack=t.callBack,this.controller=l,this.holder=s,this.alive=!1,s.placeIcon(this)}var l=(t.sPlusPlus,t.ZSClass),n=(l.SidePanelUtility,"sPIcon"),o="sPComp",h=[];s.prototype={open:function(t){t&&t!==this.holder&&(this.holder.activeComponent===this&&this.holder.close(),this.holder=t,this.holder.placeIcon(this)),this.holder.placePanel(this),this.holder.open(),this.alive=!0,this.created||(this.callBack&&this.callBack.call(this),this.created=!0)},toggle:function(){this.alive?this.close():this.open()},close:function(){this.alive&&(this.holder.close(),this.alive=!1)},hide:function(){this.close(),this.icon.style.display="none"},show:function(){this.icon.classList.add("sPAddNew"),this.icon.style.display=""},hideOthers:function(){for(var t=this.holder.panelList,i=t.length,e=0;i>e;e++){var s=t[e],l=s.icon;"none"!=l.style.display&&(l.style.display="none",h.push(l))}},showOthers:function(){for(var t=h,i=t.length,e=0;i>e;e++){var s=t[e];s.style.display=""}h=[]}},l.UIPanelComponent=s}(this);
!function(t){function e(t,e){var i=e.querySelector("."+t);if(!i){var i=document.createElement("div"),s=document.createElement("div");s.className="mt5",c.fn.addIcon(s,"SP_VIEWSTTING_ICON"),c.fn.addIcon(s,"DROPDOWN_ICON"),t&&(i.className=t),i.appendChild(s),e.appendChild(i)}return i}function i(){var t=e(p,this.icons);t.id="sPViewBtn",t.title=a["MenuItem.DataTab.ViewSettings"],t.setAttribute("data-menu-id","sidePanelViewSetting"),this.closeIcon=t}function s(t,s){this.panel=t,this.props=s,this.panel.classList.add("close"),this.icons=e(h,this.panel),!s.noCloseIcon&&i.call(this),this.holder=e(l,this.panel),this.alive=!1,this.panelList=[]}var n=t.sPlusPlus,o=t.ZSClass,a=t.ZSConstants.I18N,c=t.UIUtil,l="sPanel",h="sPISet",p="sPIcon shIconAfter sPViewIcon";n.view.measures.Right.sidePanelBar=50,s.prototype={open:function(){this.alive||(this.panel.classList.remove("close"),this.activeComponent&&(this.activeComponent.icon.classList.add("active"),this.activeComponent.onOpen&&this.activeComponent.onOpen()),this.closeIcon&&this.closeIcon.classList.add("open"),this.props.onOpen&&this.props.onOpen.call(this),this.alive=!0)},close:function(){this.alive&&(this.panel.classList.add("close"),this.activeComponent&&(this.activeComponent.icon.classList.remove("active"),this.activeComponent.onClose&&this.activeComponent.onClose(),this.activeComponent=void 0),this.closeIcon&&this.closeIcon.classList.remove("open"),this.props.onClose&&this.props.onClose.call(this),this.alive=!1)},toggle:function(){this.alive?this.close():this.open()},placeIcon:function(t){this.icons.appendChild(t.icon),this.panelList.push(t)},placePanel:function(t){this.activeComponent!==t&&(this.activeComponent&&this.activeComponent.close(),this.activeComponent=t,this.holder.innerHTML="",this.holder.appendChild(t.panel))},setWidth:function(t){this.panel.style.width=t+"px"},removePanel:function(t){var e=this.panelList.indexOf(t);this.panelList.splice(e,1)}},o.UIPanel=s}(this);
!function(e){function n(e,n){this.parent=e,this.panels={},this.panelProps=n}{var t=(e.sPlusPlus,e.ZSClass),s=t.UIPanel,i=t.UIPanelComponent;t.SidePanelUtility}n.prototype={add:function(e){if(!e.underDevelopment){var n=this.getPanel(e.direction),t=new i(e,n,this);return t}},getPanel:function(e){if(!this.panels[e]){var n=this.parent.querySelector("."+e);n||(document.createElement("div"),n.className=e,this.parent.appendChild(n)),this.panels[e]=new s(n,this.panelProps[e])}return this.panels[e]},showDroppables:function(e){for(var n in e){var t=this.getPanel(e[n]);t&&t.showDroppable()}},hideDroppables:function(){for(var e in this.panels)this.panels[e].hideDroppable()}},t.UIPanelController=n}(this);
!function(e){function t(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),o=i.view.getSheetID(e),n=i.view.getVersionID(e);UserAction.UpdateScreenViewPort(t,o,n),UserAction.DummyScroll(t,o,n)}var i=e.sPlusPlus,o=i.view.measures,n=e.ZSClass,r=n.UIPanelController,c=document.querySelector(".sPHldr"),s=document.querySelector(".gridContainer"),l={left:"sPLt",right:"sPRt",bottom:"sPBtm",dialog:"spDlg"};n.SidePanelClassList=l;var v={};v[l.right]={onOpen:function(){t()},onClose:function(){t()},onShow:function(){t()},onHide:function(){t()}},v[l.left]={onOpen:function(){s.style.left="340px";var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),r=i.view.getVersionID(e);o.Left.sidePanel=340,UserAction.UpdateScreenViewPort(t,n,r),UserAction.DummyScroll(t,n,r)},onClose:function(){s.style.left="40px";var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),r=i.view.getVersionID(e);o.Left.sidePanel=40,UserAction.UpdateScreenViewPort(t,n,r),UserAction.DummyScroll(t,n,r)},onShow:function(){s.style.left="40px";var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),r=i.view.getVersionID(e);o.Left.sidePanel=40,UserAction.UpdateScreenViewPort(t,n,r),UserAction.DummyScroll(t,n,r)},onHide:function(){s.style.left="";var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),r=i.view.getVersionID(e);o.Left.sidePanel=0,UserAction.UpdateScreenViewPort(t,n,r),UserAction.DummyScroll(t,n,r)}},v[l.bottom]={noCloseIcon:!0,onOpen:function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),r=i.view.getVersionID(e);o.Bottom.sidePanel=250,UserAction.UpdateScreenViewPort(t,n,r),UserAction.DummyScroll(t,n,r)},onClose:function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),r=i.view.getVersionID(e);o.Bottom.sidePanel=0,UserAction.UpdateScreenViewPort(t,n,r),UserAction.DummyScroll(t,n,r)}},v[l.dialog]={};var w=new r(c,v);n.SidePanel=w}(this);
!function(e){function t(e){UIUtil.Component.initComponent("#removeDuplicates");var t=p.view.getActiveGridID(),i=p.view.getResourceID(t),n=p.view.getVersionID(t),o=JSUtil.Range.parseRange(i,n,e.tableRange).range;return o.startRow==o.endRow?(h.querySelector("#invalidRange").style.display="block",h.querySelector("#removeDuplicates").style.display="none",void(h.querySelector("#columnLoader").style.display="none")):(h.querySelector("#invalidRange").style.display="none",h.querySelector("#removeDuplicates").style.display="",C.setRange(e.tableRange),u?(u.isCheckBoxCreated=!1,u.loadInfo(e)):(u=new r(e),u.addListeners()),u.duplicateInfo=e.duplicatesInfo,u.actionType=e.duplicatesInfo.actionType,u.duplicateEntries=e.duplicateRecords.length,u.wrapper.querySelector("#selectAll").checked=!0,u.showHeaders(),h.querySelector("#columnLoader").style.display="none",h.querySelector("#removeDuplicates").style.display="",u.wrapper.querySelector("#incFirstOcc").checked="duplicate"==e.duplicatesInfo.actionType,u.changePreview(),u.selectDuplicateRanges(e.duplicateRecords),void(u.wrapper.querySelector("#frh").checked=e.frl))}function r(e){this.wrapper=h.querySelector("#removeDuplicates"),this.gridID=p.view.getActiveGridID(),this.rID=p.view.getResourceID(this.gridID),this.sheetID=p.view.getSheetID(this.gridID),this.version=p.view.getVersionID(this.gridID),this.range=e.tableRange,this.isFRL=e.frl,this.rangeIDArray=[],this.columnElement=this.getColumnElement(),this.isCheckBoxCreated=!1,this.actionType=e.duplicatesInfo.actionType}function i(e){u.tableInfo=e.duplicatesInfo,u.duplicateEntries=e.duplicateRecords.length,u.duplicateInfo=e.duplicatesInfo,u.selectDuplicateRanges(e.duplicateRecords),u.changePreview()}function n(e){(3==global.SA.Controller.SheetAppUIController.getOperationMenuValue()||4==global.SA.Controller.SheetAppUIController.getOperationMenuValue())&&(b.readTable(e,u.actionType),u&&0!=u.rangeIDArray.length&&m.publish(S.Listener,g.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:u.rID,SHEETID:u.sheetID,VERSION:u.version,RANGEID_ARRAY:u.rangeIDArray}))}function o(e,t,r,i){if(C.isOpen()){q||(q=C.constructBanner(function(){if(3!=w.getOperationMenuValue()&&4!=w.getOperationMenuValue()){var e=C.tableInstance.getCurrentCol();R.triggerColumnChange(e,!0)}else u.reset(),b.readTable(C.getRange(),u.actionType)}));for(var n in i){var o=i[n],s=o[0],a=o[1],l=(o[2],o[3]),c=C.tableInstance.getCurrentCol();if(3!=w.getOperationMenuValue()&&4!=w.getOperationMenuValue())c>=a&&l>=c&&C.showNotification();else{var p=JSUtil.Range.parseRange(u.rID,u.version,u.range).range;p.startRow<=s&&p.endRow>=s&&p.startCol<=a&&p.endCol>=a&&C.showNotification()}}}}function s(e){-1==e.path.indexOf(h.querySelector("#moveDataContainer"))&&(y.RangePicker.isActiveOn(l)||UIUtil.Component.zpopover("#moveData","close")),-1==e.path.indexOf(h.querySelector("#copyDataContainer"))&&(y.RangePicker.isActiveOn(c)||UIUtil.Component.zpopover("#copyData","close"))}function a(e,t,r,i){u.callBack(i)}var l,c,u,p=e.sPlusPlus,h=(e.ZSConstants.FeatureConstants,e.document),d=(e.ZSConstants.wCC,e.ZSConstants.I18N),I=(e.ZSConstants.JSKeyCode,e.ZSEvents),m=I.topic,S=I.Groups,g=I.Names,y=(p.SML.Client,e.UIUtil.Component,e.ZSClass),v=y.Editors,f=y.RangePicker,A=e.UserAction,E=(JSUtil.fn,e.ZSConstants.FeatureConstants),C=p.view.Toolbar.Feature[E.DATA_CLEANING],D=e.module,R=D.getModule("SA/Controller/SheetAppController"),w=D.getModule("SA/Controller/SheetAppUIController"),L=(y.SidePanel,y.SidePanelClassList),b=([L.right],L.right,p.view.measures,p.view.Toolbar.Feature[E.DATA_DUPLICATES]),d=ZSConstants.I18N;r.prototype={addListeners:function(){this.ListenerAdded=!0;var e=this;this.wrapper.querySelectorAll("input").forEach(function(t){t.addEventListener("change",function(){if("radio"!=t.type)switch(t.id){case"matchCase":case"skipBlanks":case"includeHiddenCells":case"incFirstOcc":e.getDuplicates(!0);break;case"frh":e.isFRL=this.checked,e.isCheckBoxCreated=!1,e.showHeaders(),e.getDuplicates(!0)}})}),this.wrapper.querySelector("#selectAll").addEventListener("click",function(){var t=this.classList;t.contains("filterItemSelect")?(this.classList.remove("filterItemSelect"),this.classList.remove("filterPartialSelection"),e.wrapper.querySelector("#unique").setAttribute("data-count",""),e.wrapper.querySelector("#duplicate").setAttribute("data-count","")):this.classList.add("filterItemSelect");var r=this.classList.contains("filterItemSelect");e.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").forEach(function(e){r?e.classList.add("filterItemSelect"):e.classList.remove("filterItemSelect")}),e.getDuplicates(!0)}),this.wrapper.addEventListener("click",function(){});var t=[{text:"Delete",primary:!0},{text:d["Dialog.Button.Cancel"]}],r={buttons:t};r.buttons[0].click=function(){e.getDuplicates(!1,"deleteRow")},r.buttons[1].click=function(){},this.formatContainer=new UIUtil.FormatContainer(this.wrapper),this.enableRangeSelectors(),this.wrapper.querySelector("#deleteBtn").addEventListener("click",function(){y.ZSAlert(JSUtil.fn.replaceParams(d["DataCleaning.Alert.Delete"],[e.actionType]),r)}),this.wrapper.querySelector("#applyFormat").addEventListener("click",function(){var t=e.formatContainer.getFormats();e.getDuplicates(!1,"highlight",t)}),UIUtil.Component.bind("#moveData","zpopoverbeforeopen",function(){e.setAttributes(),setTimeout(function(){l.focus()},10)}),UIUtil.Component.bind("#copyData","zpopoverbeforeopen",function(){e.setAttributes(),setTimeout(function(){c.focus()},10)}),this.wrapper.querySelector("#moveBtn").addEventListener("click",function(){var t="newSheet"==h.querySelector('input[name="type"]:checked').value,r=t?"":l.value.trim();e.getDuplicates(!1,"move",r,t),h.querySelector('input[name="type"]:checked').value="existingSheet",UIUtil.Component.zpopover("#moveData","close"),l.value=""}),this.wrapper.querySelector("#copyBtn").addEventListener("click",function(){var t="newSheet"==h.querySelector('input[name="copytype"]:checked').value,r=t?"":c.value.trim();e.getDuplicates(!1,"copy",r,t),h.querySelector('input[name="copytype"]:checked').value="existingSheet",UIUtil.Component.zpopover("#copyData","close"),c.value=""})},setAttributes:function(){var e=this;UIUtil.Component.zpopover(e.wrapper.querySelector("#moveData"),"setAttributes",{closeOnBodyClick:!1}),UIUtil.Component.zpopover(e.wrapper.querySelector("#copyData"),"setAttributes",{closeOnBodyClick:!1}),h.body.addEventListener("mousedown",s,!1)},enableRangeSelectors:function(){var e=this.wrapper.querySelector("#moveRange");l=new v.RangeEditor(e,!0),f.register(l,!0,!0),l.addListeners({}),e=this.wrapper.querySelector("#copyRange"),c=new v.RangeEditor(e,!0),f.register(c,!0,!0),c.addListeners({})},loadInfo:function(e){this.gridID=p.view.getActiveGridID(),this.rID=p.view.getResourceID(this.gridID),this.sheetID=p.view.getSheetID(this.gridID),this.version=p.view.getVersionID(this.gridID),this.range=e.tableRange,this.isFRL=e.frl,this.rangeIDArray=[]},changePreview:function(){var e=this.duplicateInfo.uniqueValueCount,t=this.duplicateInfo.duplicateCount,r=e/(t+e)*100+"%";this.wrapper.querySelector("#indicator").style.background="linear-gradient(to right, rgb(68, 200, 146) "+r+", rgb(96, 96, 96) "+r+", rgb(96, 96, 96))",this.wrapper.querySelector("#unique").setAttribute("data-count",e),this.wrapper.querySelector("#duplicate").setAttribute("data-count",t)},selectDuplicateRanges:function(e){0!=this.rangeIDArray.length&&m.publish(S.Listener,g.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID_ARRAY:this.rangeIDArray});var t=[];this.rangeIDArray=[];for(var r=0;r<e.length;r++){var i=e[r].split(":"),n=new y.Range(parseInt(i[1]),parseInt(i[2]),parseInt(i[3]),parseInt(i[4]));JSUtil.SparklinePool.mergeRanges(n,t)}for(var r=0;r<t.length;r++){var i=t[r];this.rangeIDArray.push(r+1),m.publish(S.Listener,g.UserAction.HIGHLIGHT_RANGE.ADD,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:r+1,RANGE:i,COLOR:"red"})}},getColumnElement:function(){var e=h.createElement("div");return e.className="filterItem",e},showHeaders:function(){var e=this;this.wrapper.querySelector("#columnContainer").innerHTML="";var t,r=JSUtil.Range.parseRange(this.rID,this.version,this.range).range,i=function(i){if(!e.isCheckBoxCreated){e.isCheckBoxCreated=!0;for(var o=r.startCol,s=0;o<=r.endCol;o++,s++)if(i[n.startRow][o]){t=e.isFRL&&""!=i[n.startRow][o].ActualValue.trim()?i[n.startRow][o].ActualValue:"Column "+JSUtil.Object.getCharForNum(o+1);var a=e.columnElement.cloneNode(!0);a.setAttribute("value",t),a.innerText=t;var l=e.wrapper.querySelector("#selectAll").classList.contains("filterItemSelect")||e.wrapper.querySelector("#selectAll").classList.contains("filterPartialSelection")?"filterItemSelect":"";l&&a.classList.add(l),a.setAttribute("id",s+"row"),e.wrapper.querySelector("#columnContainer").appendChild(a)}e.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").forEach(function(t){t.addEventListener("click",function(){var r=t.classList;r.contains("filterItemSelect")?r.remove("filterItemSelect"):r.add("filterItemSelect"),e.doCheckBoxAction()})})}},n=new y.Range(r.startRow,r.startCol,r.startRow,r.endCol);sPlusPlus.view.fetchRangeData(e.rID,this.sheetID,this.version,n,["ActualValue","DV_IsValid"],!1,this.gridID,i)},doCheckBoxAction:function(){var e=this,t=e.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").length,r=e.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItemSelect").length,i=e.wrapper.querySelector("#selectAll");i.className="filterItem",i.className=0==r?"filterItem":r==t?"filterItem filterItemSelect":"filterItem filterPartialSelection",e.getDuplicates(!0)},getDuplicates:function(e,t,r,i){var n=this.getColumnAry(),o=this.wrapper.querySelector("#incFirstOcc").checked,s=this.wrapper.querySelector("#includeHiddenCells").checked,a=this.wrapper.querySelector("#matchCase").checked;e?(m.publish(S.Listener,g.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID_ARRAY:this.rangeIDArray}),0!=n.length&&A.getDuplicatesInfo(this.rID,[this.sheetID],this.version,this.range,this.isFRL,n,o,a,s,this.actionType)):0!=n.length&&A.getDuplicates(this.rID,[this.sheetID],this.version,this.range,this.isFRL,n,o,t,a,!1,r,this.callBack,this,s,this.actionType,i?i:!1)},getColumnAry:function(){var e=[];return this.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").forEach(function(t){t.classList.contains("filterItemSelect")&&e.push(parseInt(t.id))}),e},callBack:function(e){var t=new y.TBNotification(e+" rows are deleted",{type:"info",parent:this.wrapper});t.show(),this.changePreview(),0!=this.rangeIDArray.length&&m.publish(S.Listener,g.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID_ARRAY:this.rangeIDArray}),"duplicate"==this.actionType?this.wrapper.querySelector("#duplicate").setAttribute("data-count",0):this.wrapper.querySelector("#unique").setAttribute("data-count",0)},reset:function(){this.wrapper.querySelector("#selectAll").classList.add("filterItemSelect"),this.wrapper.querySelector("#frh").checked=!0,this.wrapper.querySelector("#incFirstOcc").checked="duplicate"==this.duplicateInfo.actionType,this.wrapper.querySelector("#includeHiddenCells").checked=!1,this.wrapper.querySelector("#matchCase").checked=!1,this.formatContainer.reset(),this.isCheckBoxCreated=!1}},window.addEventListener("DC_Duplicate_view_On_Close",function(){u&&0!=u.rangeIDArray.length&&m.publish(S.Listener,g.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:u.rID,SHEETID:u.sheetID,VERSION:u.version,RANGEID_ARRAY:u.rangeIDArray})});var q;m.register(S.Listener,g.UserAction.DATA_DUPLICATE.TABLE_DETAILS,t,"TABLE_DETAILS"),m.register(S.Listener,g.UserAction.DATA_DUPLICATE.TABLE_INFO,i,"TABLE_INFO"),m.register(S.Listener,g.UserAction.DATA_DUPLICATE.COUNT,a,"RID","SHEETID","VERSION","DATA"),m.register(S.UI,g.SidePanel.DATACLEANING.UPDATE_RANGE,n,"RANGE"),m.register(S.Listener,g.UserAction.DATACLEANING.REFRESH,o,"RID","SHEETID","VERSION","DATA")}(this),function(e){function t(e){this.wrapper=e,this.container=e.querySelector("#applyStyleContainer"),this.appendListerners()}{var r=e.sPlusPlus,i=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.wCC,e.ZSConstants.I18N,e.ZSConstants.JSKeyCode,e.ZSEvents),n=(i.topic,i.Groups,i.Names,e.ZSConstants.FeatureConstants),o=(r.SML.Client,e.UIUtil.Component),s=e.ZSClass;s.Editors,s.RangePicker,e.UserAction,JSUtil.fn,r.view.Toolbar.Feature[n.DATA_DUPLICATES]}t.prototype={appendListerners:function(){var e=this;this.boldElem=this.container.querySelector("#bold"),this.ItalicElem=this.container.querySelector("#italic"),this.UnderlineElem=this.container.querySelector("#underline"),this.StrikeElem=this.container.querySelector("#strike"),this.bgColorElem=this.container.querySelector("#fill"),this.tcColorElem=this.container.querySelector("#textColor"),this.clearElem=this.container.querySelector("#clearElem"),this.colorPickerElemArray=[this.bgColorElem,this.tcColorElem],this.colorPickerElemArray.forEach(function(t){t.setAttribute("data",'{"pickerOptions":{"nocolorbutton":false}, "value":"#000000"}'),t.setAttribute("data-ctype","zcolorchooser"),t.setAttribute("data-picker-id","sheet-colorpicker"),o.bind(t,"zcolorchooserchange",function(r,i){t.style.borderBottom="3px solid #"+i.color,e.changePreview()}),o.bind(t,"zcolorchooserbeforepickeropen",function(e,t){var r=t.picker;r.css("zIndex",1e5)})}),UIUtil.Component.bind("#applyStyle","zpopoverbeforeopen",function(){e.reset()}),this.formatArray=[this.boldElem,this.ItalicElem,this.UnderlineElem,this.StrikeElem],this.formatArray.forEach(function(t){t.addEventListener("click",function(){var r=t.parentElement.classList;r.contains("active")?r.remove("active"):r.add("active"),e.changePreview()})}),this.clearElem.addEventListener("click",function(){e.reset()}),o.initComponent(this.container)},changePreview:function(){var e=this.container.querySelector("#previewElem");e.style.fontWeight=this.boldElem.parentElement.classList.contains("active")?"bold":"",e.style.fontStyle=this.ItalicElem.parentElement.classList.contains("active")?"italic":"";var t="underline";this.UnderlineElem.parentElement.classList.contains("active")&&this.StrikeElem.parentElement.classList.contains("active")?t="line-through underline":!this.UnderlineElem.parentElement.classList.contains("active")&&this.StrikeElem.parentElement.classList.contains("active")?t="line-through":this.UnderlineElem.parentElement.classList.contains("active")||this.StrikeElem.parentElement.classList.contains("active")||(t=""),e.style.textDecoration=t,e.style.backgroundColor="transparent"==this.bgColorElem.style.borderBottomColor?"":this.bgColorElem.style.borderBottomColor,e.style.color="transparent"==this.tcColorElem.style.borderBottomColor?"":this.tcColorElem.style.borderBottomColor},reset:function(){this.formatArray.forEach(function(e){var t=e.parentElement.classList;t.remove("active")}),this.colorPickerElemArray.forEach(function(e){e.style.borderBottomColor="transparent"}),this.changePreview()},getFormats:function(){var e=[];return this.formatArray.forEach(function(t){var r=t.parentElement.classList;e.push(r.contains("active"))}),this.colorPickerElemArray.forEach(function(t){var r=t.style.borderBottomColor;r="transparent"==r?"":zoho.color.rgbToHex(t.style.borderBottomColor),e.push(r)}),e}},UIUtil.FormatContainer=t}(this);
!function(e){function t(){l=m.getElementById(A.MI+"DOCNAME"+A.HOLDER);var e=m.getElementById("popupmenu"),t=UserAction.getTemplate(["docNameTemplate"]),n=t.docNameTemplate.querySelector("#docNamePopOver");e.appendChild(n),l.setAttribute("data-content","#docNamePopOver"),l.setAttribute("data-is-content-html-encoded",!0),l.setAttribute("data-class-name","shRenameAni"),E.zpopover(l),v=m.querySelector("#docNamePopOver"),o(v)}function o(e){var t=e.querySelector("#tbDocNameInput"),o=e.querySelector("#tbDocNameBtn");p=new D.TextAreaEditor(t),p.addListeners({keydown:s}),o.addEventListener("click",c),E.bind(l,"zpopoveropen",function(){n()}),E.bind(l,"zpopoverclose",function(){r()})}function n(){i();var e=d.view.getActiveGridID(),t=d.view.getResourceID(e),o=(d.view.getSheetID(e),d.view.getVersionID(e)),n=(d.data.getWorkBook(t,o),v.querySelector("#tbDocNameInput"));n.value=l.innerText,n.focus(),n.select()}function r(){a()}function i(){var e=d.view.Events.Key;e.focusContext(e.Entry.DocName.Context)}function a(){var e=d.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function s(e){var t=e.keyCode||e.which;13==t&&p.value&&(c(),e.stopPropagation())}function c(){var e=d.view.getActiveGridID(),t=d.view.getResourceID(e),o=d.view.getVersionID(e),n=d.data.getWorkBook(t,o),r=n.Name,i=p.value;if(i&&0!==i.trim().length){if(i.length>255&&(i=i.substring(0,255)),i===r)return void E.zpopover(l,"close");l.innerText=i,l.title=i,UserAction.RenameDocument(t,o,encodeURIComponent(i)),E.zpopover(l,"close")}else g.ZSAlert(C["Rename.SheetNameCannotBeEmpty"],{title:C["Alert.Title.EnterSheetName"]})}function u(){E.zpopover(l,"close")}var l,v,p,d=e.sPlusPlus,m=e.document,E=e.UIUtil.Component,g=e.ZSClass,f=e.ZSConstants.FeatureConstants,C=e.ZSConstants.I18N,D=g.Editors,I=e.ZSEvents,N=I.topic,w=I.Groups,y=I.Names,A=e.ZSConstants.wCC,S=d.view.Toolbar.Feature[f.RENAME];S.openDialog=function(){E.zpopover(l,"open",{target:l})},N.register(w.UI,y.Layout.TEMPLATE_LOADED,t),N.register(w.Listener,y.Browser.RESIZE,u)}(this);
!function(e){function r(){var r=e.UserAction.getTemplate(["SORT","SORT_BY"]),n=r.SORT,i=r.SORT_BY,l={modal:!0,width:400,title:N["MenuItem.DataTab.Sort.CustomSort"],dialogClass:"",close:function(){h()}};A||(R=L.createElement("div"),R.id="DI_SORT",R.appendChild(n),A=new U.Dialog(R,l),t()),a(i),o(),O.initComponent(R);var c="true"==q?!0:!1;c&&R.querySelector("#containsHeader").click(),A.open()}function t(){R.querySelector("#okBtn").addEventListener("click",n),R.querySelector("#clBtn").addEventListener("click",function(){A.close()}),R.querySelector("#containsHeader").addEventListener("click",i);for(var e=R.querySelectorAll("[name=orientation]"),r=0;r<e.length;r++)e[r].addEventListener("click",l)}function o(){var e=R.querySelector("#containsHeader");y(e,!1);var r=R.querySelector("#caseSenstive");y(r,!0);var t=R.querySelector("#topBottom");y(t,!0)}function n(){var e=c(),r=x,t=G,o=P,n=D.view.getActiveGridID(),a=D.view.getResourceID(n),i=D.view.getVersionID(n),l=(D.data.getWorkBook(a,i),D.view.getSelectedSheets(n));k.executeSort(a,l,i,e,b,o,r,t),A.close()}function a(e){for(var r="",t=0;3>t;t++){var o,n=e.cloneNode(!0);o=0==t?N.Sort:N.Thenby;var a={sortHeader:"sortHeader"+t,GroupLabel:o,ascendingRadio:"ascendingRadio"+t,descendingRadio:"descendingRadio"+t,thenby:"thenby"+t},i=n.children[0].outerHTML,l=k.renderJsTemplate(i,a);r+=l}R.querySelector("#groupHolder").innerHTML=r,T=S(),w=f(),s(T,!1)}function i(){x=R.querySelector("#containsHeader").checked;var e;x?(x="TRUE",E=g(),e=E):e=T,s(e,!0)}function l(e){var r,t=e.target.id,o=R.querySelector("#containsHeader");"topBottom"===t?(r=T,y(o,!1),m(o,!1)):(P="TRUE",r=w,y(o,!1),m(o,!0)),s(r,!0)}function c(){for(var e=new Array,r=R.querySelector("#groupHolder"),t=r.querySelectorAll("select"),o=0;o<t.length;o++){var n={},a=t[o].selectedIndex-1;n.f=a;var i="FALSE",l=r.querySelector("[name=thenby"+o+"]").checked;l&&(i="TRUE"),n.s=i,e.push(n)}return e}function s(e){var r=R.querySelectorAll("select"),t=e.length;H=t-1;for(var o=0;o<r.length;o++){r[o].innerHTML="";for(var n=0;t>n;n++){var a=L.createElement("option");a.innerText=e[n],r[o].appendChild(a)}O.bind("#"+r[o].id,"zselectboxchange",u)}v();var i=R.querySelector("#sortHeader0");i.selectedIndex=1,O.zcombo("#sortHeader0","setAttribute","selectedIndex",1);var l=t>3?3:t-1;d(l),u()}function u(){var e=O.zcombo("#sortHeader0","getValue"),r=O.zcombo("#sortHeader1","getValue"),t=O.zcombo("#sortHeader2","getValue");"None"==e&&"None"==r&&"None"==t||"None"==e?O.disable("#okBtn"):O.enable("#okBtn")}function d(e){for(var r=e,t=R.querySelector("#groupHolder").childNodes,o=0;o<t.length;o++){var n=t[o].querySelectorAll("div")[1];o>r-1?n.classList.add("zsDisable"):n.classList.remove("zsDisable")}}function v(){for(var e=R.querySelectorAll("select"),r=0;r<e.length;r++)O.zcombo(e[r],"refresh")}function S(){var e=b,r=new Array;r.push(N.None);for(var t=e.startCol;t<=e.endCol;t++){var o=p(t+1),n=M.fn.replaceParams(N["Sort.Orientation.Column"],[o]);r.push(n)}return r}function f(){var e=b,r=new Array;r.push(N.None);for(var t=e.startRow;t<=e.endRow;t++){var o=M.fn.replaceParams(N["Sort.Orientation.Row"],[t+1]);r.push(o)}return r}function g(){var r=D.view.getActiveGridID(),t=D.view.getVersionID(r),o=D.view.getResourceID(r),n=D.view.getSheetID(r),a=(D.data.getWorkBook(o,t),D.view.getSheetState(r,n)),i=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],l=a.getActiveRange(),c=l.startRow,s=l.startCol,u=l.endRow,d=l.endCol,v=new Array;v.push(N.None);for(var S=function(e){if(P&&""===e[h][g].DisplayValue){var r=p(g+1),t=M.fn.replaceParams(N["Sort.Orientation.Column"],r);v.push(t)}else v.push(e[h][g].DisplayValue)},f=function(r){e.ZSClass.Logger.log("Couldnt retrieve cell content",r)},g=s;d>=g;g++)for(var h=c;u>h;h+=u){var y=S,m=f;D.view.fetchCellData(o,n,t,h,g,i,r,y,m)}return v}function h(){var e=R.querySelector("#groupHolder");e.innerHTML=""}function p(e){if(e){if(26>=e)return String.fromCharCode(e+64);var r=e%26,t=Math.floor(e/26);return 0===r?p(t-1)+"Z":p(t)+String.fromCharCode(r+64)}}function y(e,r){e.checked=r?!0:!1}function m(e,r){e.disabled=r?"disabled":""}function C(e,t){b=e,q=t,r()}var A,R,T,w,E,H,b,q,D=e.sPlusPlus,L=e.document,k=e.UserAction,I=e.ZSConstants.FeatureConstants,N=e.ZSConstants.I18N,O=e.UIUtil.Component,U=e.ZSClass,V=e.ZSEvents,B=V.topic,z=V.Groups,F=V.Names,M=e.JSUtil,x="FALSE",G="TRUE",P="FALSE",Z=D.view.Toolbar.Feature[I.SORT];B.register(z.Listener,F.CellAction.VALUE.CUSTOM_SORT_EXPANDRANGE,C,"ACTIVERANGE","HEADER_DETAILS"),Z.openDialog=r}(this);
!function(e){function t(){if(Ct)o($);else{tt=[];var e=function(e){r(e)},t=L(e);if(-1==t)return void nt.ZSAlert(lt["TexttoColumns.ConvertsOneColumnAtATime"],{title:lt["Alert.Title.InvalidCellRange"]})}}function r(e){var t=rt.view.getActiveGridID(),r=rt.view.getResourceID(t),n=rt.view.getVersionID(t),a=rt.view.getSheetID(t),i=rt.data.getWorkBook(r,n),c=i.getSheetObj(a);for(var l in e)for(var u in e[l]){var s=c.Merge.isXists(parseInt(l),parseInt(u)),d=e[l][u].DisplayValue;if(""!==d&&(!s||s&&s.isRoot)){var S=[d];tt.push(S)}}o(tt)}function o(t){if(0==t.length)return void nt.ZSAlert(lt["TexttoColumns.NoDataWasSelectedToParse"],{title:lt["Alert.Title.InvalidCellRange"]});void 0==H&&(H=t,J=t);var r=pt.getTemplate(["TEXTTOCOLUMN"]);B=r.TEXTTOCOLUMN;var o={width:540,title:lt["MenuItem.DataTab.TextToColumns"],dialogClass:"txtCol",close:function(){mt={},U()},open:function(){a()}};j||(n(),j=new e.ZSClass.Dialog(W,o),i(),l()),Ct&&(W.querySelector("#importSettings").style.display="block"),j.open(),c(),z()}function n(){W=ct.createElement("div"),W.id="DI_TEXTTOCOLUMN",W.appendChild(B),M(),W.querySelector("#submit").addEventListener("click",k),W.querySelector("#cancel").addEventListener("click",function(){j.close()})}function a(){R()}function i(){var e=W.querySelector("#destinationCell");F=new vt.RangeEditor(e),nt.RangePicker.register(F,!0);var t=W.querySelector("#rangePickerIcon");nt.RangePicker.Dialog.register(F,j,t,lt["MenuItem.DataTab.TextToColumns"])}function c(){var e=j.gridID,t=j.rID,r=j.version,o=rt.view.getSheetID(e),n=rt.data.getWorkBook(t,r),a=n.getSheetObj(o),i=a.Prop.getName(),c=rt.view.getSheetState(e,o),l=c.getActiveCellRange(),u=l.getLabel();F.value=i+"."+u,F.focus()}function l(){u(),s(),p(),d(),v()}function u(){for(var e=W.querySelectorAll("input[type=checkbox]"),t=0;t<e.length;t++)e[t].addEventListener("click",f.bind(null,e[t].id))}function s(){W.querySelector("#otherSeparatorValue").addEventListener("keyup",function(e){W.querySelector("#otherSeparator").checked=!0,f(e.target.id)}),W.querySelector("#otherSeparatorValue").addEventListener("click",function(e){W.querySelector("#otherSeparator").checked=!0,f(e.target.id)})}function d(){at.bind("#TTCtype","zmenuitemclick",function(e,t){var r=t.data,o=t.target[0].parentElement,n=o.children[0],a=r.label;n.innerText=a;var i=o.getAttribute("index"),c=parseInt(i);S(c,a)})}function S(e,t){-1!=t.indexOf("(")&&(t=t.substring(t.indexOf("(")+1,t.indexOf(")"))),wt[e]=t}function p(){at.bind("#textDelimiter","zselectboxchange",function(){Y(),f(this.id)})}function v(){at.bind("#StartRowCount","znumberfieldchange",function(){et.setStartRow(G())}),at.bind("#StartRowCount","znumberfieldspinend",function(){et.setStartRow(G())})}function f(e){b(e);var t;switch(e){case Dt[0]:t=Ot[Dt[0]],m(e,t);break;case Dt[1]:t=Ot[Dt[1]],m(e,t);break;case Dt[3]:t=Ot[Dt[3]],m(e,t);break;case Dt[4]:t=Ot[Dt[4]],m(e,t);break;case Dt[5]:T();break;case Dt[6]:J=H}"none"!=ft&&(J=H),e==Dt[5]&&Tt||pt.splitOperation(J,gt,Tt,ft,g)}function g(e){Tt||(J=e),h();var t=e;e.length>15&&(t=t.slice(0,16)),wt={},E(e.length,t)}function T(){Tt=W.querySelector("#"+Dt[5]).checked?!0:!1,Tt&&pt.splitOperation(H,gt,Tt,ft,g)}function h(){var e=W.querySelector("#TTCtable");e.innerHTML=""}function m(e,t){W.querySelector("#"+e).checked?C(t):y(t)}function C(e){-1==gt.indexOf(e)&&gt.push(e)}function y(e){e&&-1!=gt.indexOf(e)&&gt.splice(gt.indexOf(e),1),J=H}function b(){if(W.querySelector("#"+Dt[2]).checked)if(W.querySelector("#otherSeparatorValue").value){var e=W.querySelector("#otherSeparatorValue").value;Ot[Dt[2]]=e,m("otherSeparator",e)}else Ot.hasOwnProperty(Dt[2])&&Ot[Dt[2]]!=e&&y(Ot[Dt[2]]);else Ot.hasOwnProperty(Dt[2])&&Ot[Dt[2]]!=e&&y(Ot[Dt[2]])}function k(){var e=j.rID,t=j.sheetID,r=j.version,o=j.gridID,n=F.value.trim(),a=rt.view.getSheetState(o,t),i=a.getActiveRange(),c=D(),l=P(),u=G(),s=JSUtil.Range.parseRange(e,r,F.value.trim()),d="";Ct?d=yt:l=K,w(),pt.ApplyTexttoColumn(e,[t],r,n,i,c.textSeparatorsList,c.textDelimiter,Tt,mt,d,l,u,s.range,Ct),j.close()}function w(){Object.keys(wt).forEach(function(e){var t=wt[e],r=parseInt(e),o=mt.hasOwnProperty(t);o||(mt[t]=[]),mt[t].push(r)})}function D(){var e,t=W.querySelector("#tabSeparator"),r=W.querySelector("#commaSeparator"),o=W.querySelector("#otherSeparator"),n=W.querySelector("#otherSeparatorValue"),a=W.querySelector("#spaceSeparator"),i=W.querySelector("#semicolonSeparator"),c=(W.querySelector("#mergeDelimiters").checked?!0:!1,ft);return e=t.checked?t.value+"TTC":"",e+=r.checked?r.value+"TTC":"",e+=i.checked?i.value+"TTC":"",e+=a.checked?a.value+"TTC":"",e+=o.checked?n.value:"",{textSeparatorsList:e,textDelimiter:c}}function O(e){var t;switch(e){case"	":t=Dt[0];break;case",":t=Dt[1];break;case" ":t=Dt[3];break;case";":t=Dt[4];break;default:W.querySelector("#otherSeparatorValue").value=e,t=Dt[2]}W.querySelector("#"+t).checked=!0,f(t)}function R(){var e=new pt.DelimiterDetector(H.join("\n"),{ignoreEmptyLines:!0},bt);O(e.detect()),Q&&W.querySelector("#"+Q+"Separator").click()}function q(e,r,o,n){Ct=e,$=r,Q=o,yt=n,t()}function I(e,t){-1==e&&(e=0),ht.index=e,ht.element=t;var r=ht.element.innerText,o=A(r);at.zcombo("#TTCtype","setValue",o)}function A(){W.querySelector("#TTCtype")}function x(e){Z(e)}function E(e,t){var r,o=W.querySelector("#TTCtable"),n={width:100,height:20,colHeader:[r],cellClick:I,rowClick:!1};Ct&&(X(e),n.rowClick=x);var a=new pt.ZSTable(o,n,t);a.setActiveCol(0),a.setStartRow(G()),et=a}function L(e){var t=rt.view.getActiveGridID(),r=rt.view.getResourceID(t),o=rt.view.getSheetID(t),n=rt.view.getVersionID(t),a=rt.view.getSheetState(t,o),i=rt.data.getWorkBook(r,n),c=i.getSheetObj(o),l=a.getActiveRange(),u=(l.startRow,l.startCol),s=(l.endRow,l.endCol),d=c.Merge.getInfo(l.startRow,l.startCol),S=["DisplayValue"],p=function(e){nt.Logger.log("couldn't retrieve data",e)},v=d&&d.equals(l);return l.isRow()||u!=s&&!v?-1:(l.isCol()&&(l.endRow=14),void rt.view.fetchRangeData(r,o,n,l,S,!0,t,e,p))}function U(){H=void 0,J=void 0,Tt=!1,gt=[],N(),W.querySelector("#importSettings").style.display="none",Ct=!1,$=void 0,yt=void 0,Z(1),et.resetTempValue(),W.querySelector("#otherSeparatorValue").value=""}function N(){for(var e=W.querySelectorAll("input[type=checkbox]"),t=1;t<e.length;t++)e[t].checked=!1}function V(){}function M(){var e=rt.data.AppRegistry.localeInfo.CURRENCY_LIST;e.sort(function(e,t){var r=e.COUNTRY.toUpperCase(),o=t.COUNTRY.toUpperCase();return o>r?-1:r>o?1:0});for(var t=W.querySelector("#importLocale"),r=0;r<e.length;r++){var o=ct.createElement("option"),n=e[r].KEY,a=n.substring(n.indexOf(0),n.indexOf("(")),i=n.substring(n.indexOf("(")+1,n.length-1);o.value=a+"_"+i,o.innerText=e[r].COUNTRY+" ( "+e[r].LANGUAGE+" )",t.appendChild(o)}}function _(e,t){K=e+"_"+t}function z(){at.zcombo("#importLocale","setValue",K)}function P(){return at.zcombo("#importLocale","getValue")}function G(){return at.zspinner("#StartRowCount","getValue")}function X(e){at.znumberfield("#StartRowCount","setAttribute","max",e)}function Z(e){at.zspinner("#StartRowCount","setValue",e)}function Y(){ft=at.zcombo("#textDelimiter","getValue")}function U(){H=void 0,J=void 0,Tt=!1,gt=[],N(),W.querySelector("#importSettings").style.display="none",Ct=!1,$=void 0,yt=void 0,Z(1),et.resetTempValue(),W.querySelector("#otherSeparatorValue").value=""}var j,W,B,F,H,J,K,$,Q,et,tt,rt=e.sPlusPlus,ot=e.ZSConstants,nt=e.ZSClass,at=e.UIUtil.Component,it=ot.FeatureConstants,ct=e.document,lt=ot.I18N,ut=(ot.wCC,e.ZSEvents),st=ut.topic,dt=ut.Groups,St=ut.Names,pt=e.UserAction,vt=nt.Editors,ft=(nt.Editors.RangeEditor,"none"),gt=[],Tt=!1,ht={},mt={},Ct=!1,yt=void 0,bt="~`!@#$%^&*()_-+={[}]|\\;:'?/>.<,	 \"",kt=rt.view.Toolbar.Feature[it.TEXT_TO_COLUMN],wt={},Dt=["tabSeparator","commaSeparator","otherSeparator","spaceSeparator","semicolonSeparator","mergeDelimiters","textDelimiter"],Ot={tabSeparator:"	",commaSeparator:",",spaceSeparator:" ",semicolonSeparator:";"};st.register(dt.Listener,St.DocMeta.DOCUMENT_LOCALE,_,"LANGUAGE","COUNTRY"),st.register(dt.Listener,St.UserAction.OPEN_TEXT_TO_COLUMNS,q,"ISOUTSIDE_DATA","DATA","DELIMITER","ORIGINALDATA"),rt.view.Toolbar.transient.destructor[it.TEXT_TO_COLUMN]=V,kt.openDialog=t}(this);
!function(e){function t(e){var t=M.view.getActiveGridID(),l=M.view.getResourceID(t),i=M.view.getSheetID(t),n=M.view.getVersionID(t),a=gt.isSingleCell();if(a){var s={width:570,title:j["MenuItem.InsertTab.Hyperlink"],close:function(){c()},open:function(){o()}};dt||(r(l,i,n),dt=new Y.Dialog(ht,s),x()),y(l,i,n),p(l,i,n),dt.open(),U(),et.publish(tt.Selector.BoundUpdate.CellEdit,rt.Selection.BOUND_UPDATE.REMOVE,{RID:dt.rID,SHEETID:dt.sheetID,VERSION:dt.version,isSubmittable:!0}),ht.querySelector("#sheetListTabs").classList.contains("dsp_none")||(q(at.value)||B(at.value),ht.querySelector(K).click()),e.preventDefault()}}function r(t,r,n){var a=e.UserAction.getTemplate(["hyperlinkTemplate"]),o=a.hyperlinkTemplate;ht=X.createElement("div"),ht.id="DI_HYPERLINK",ht.appendChild(o),ht.classList.add("hlD"),ht.classList.add("hlDResize");for(var s=ht.querySelectorAll("li[name=hyperlink]"),c=0;c<s.length;c++)s[c].addEventListener("click",i);ht.querySelector("#openaccordion").addEventListener("click",l.bind(ht)),ht.querySelector("#removeLinkBtn").addEventListener("click",function(){_()}),ht.querySelector("#okBtn").addEventListener("click",function(){P(t,r,n)}),ht.querySelector("#clBtn").addEventListener("click",function(){dt.close()})}function l(){this.querySelector("#sheetListTabs").classList.toggle("dsp_none"),this.querySelector("#openaccordion").classList.toggle("openAccActive"),this.classList.toggle("hlDResize"),q(at.value)||B(at.value),this.querySelector(K).click()}function i(){var e,t=M.view.getActiveGridID(),r=dt.rID,l=dt.sheetID,i=dt.version,o=M.data.getWorkBook(r,i),c=o.getSheetObj(l),u=c.Prop.getName(),v=M.view.getSheetState(t,l),d=v.getActiveCellRange(),h=d.getLabel(),g=n(this.id),f=N(r,l,i),S=f.tab;g!=S?(e=a(g,!1),f.tab=g):(e=a(S,!1),f.tab=S),""!=e.text&&(f.cellVal=e.text),f.cellhyperlink=""!=e.link?e.link:g==ft[1]?u+"."+h:"",s(f)}function n(e){if(e){var t=ht.querySelector("li[name=hyperlink].active"),r=t.id;if(e!=r){t.removeAttribute("class");var l=ht.querySelector("#"+r+"_content");l.style.display="none"}var i=ht.querySelector("#"+e);i.className="active";var n=ht.querySelector("#"+e+"_content");n.style.display="block"}else e=ht.querySelector("li[name=hyperlink].active").id;var a=Object.keys(St),o=Object.values(St),s=o.indexOf(e),c=a[s];return c}function a(e,t){var r,l=e;return l==ft[0]?r=D():l==ft[1]?r=A(t):l==ft[2]?r=w():l==ft[3]&&(r=R(t)),r}function o(){{var e=dt.rID,t=dt.sheetID,r=dt.version,l=N(e,t,r),i=l.tab;l.cellVal,l.cellhyperlink}ht.querySelector("#"+St[i]).click(),s(l)}function s(e){var t=e.tab,r=e.cellVal,l=e.cellhyperlink;t==ft[0]?L(r,l):t==ft[1]?(b(r,-1!=l.indexOf("#")?l.substring(1,l.length):l),at.valueChanged()):t==ft[2]?T(r,l):t==ft[3]&&C(r,l)}function c(){u(),v(),yt={}}function u(){it.value="",nt.value="",at.value="",ot.value="",st.value="",ct.value="",ut.value="",vt.value=""}function v(){var e=[],t=ht.querySelector("#NamedRangeTab").querySelector("ul"),r=ht.querySelector("#SheetNamesTab").querySelector("ul");e.push(t),e.push(r);for(var l=0;l<e.length;l++)for(;e[l].hasChildNodes();)e[l].removeChild(e[l].lastChild)}function d(e,t){var r=null==t?e:e+"."+t;at.value=r,at.focus(),at.valueChanged()}function h(e,t,r,l,i,n){var a=e.target.getAttribute("range");d(a,null),at.valueChanged(),W(i),n.classList?n.classList.add("highlightSelection"):n.className+=" highlightSelection"}function g(e,t,r,l,i,n){var a=M.view.getActiveGridID(),o=M.view.getSheetState(a,r),s=o.getActiveCellRange(),c=s.getLabel(),u=e.target.getAttribute("range"),v=at.value,h=v.indexOf("."),g=c;-1!=h&&(g=v.substring(h+1,v.length)),d(u,g),W(i),n.classList?n.classList.add("highlightSelection"):n.className+=" highlightSelection"}function f(e,t,r,l,i,n,a,o){var s=X.createElement("li");s.className="txtOverflow curPtr",a||(a=i),s.title=a,s.setAttribute("range",i),s.addEventListener("click",function(){n(event,e,t,r,o,s)}),s.innerText=i,l.appendChild(s)}function S(e,t){var r=parseInt(e,10),l=parseInt(t,10);if(isNaN(r)&&isNaN(l)){var i=e.replace(pt,""),n=t.replace(pt,"");if(i===n){var a=parseInt(e.replace(mt,""),10),o=parseInt(t.replace(mt,""),10);return a===o?0:a>o?1:-1}return i>n?1:-1}return isNaN(r)?1:isNaN(l)?-1:r>l?1:-1}function y(e,t,r){var l=M.data.getWorkBook(e,r),i=k(e,r),n=Array.from(i).sort(S);J=n;var a=ht.querySelector("#NamedRangeTab").querySelector("ul"),o=n.length;if(0!=o)for(var s=(n.keys(),0);o>s;s++){var c=n[s],u=l.NamedRange.get(c);yt[c]=u;var v=JSUtil.FormRange(u);f(e,t,r,a,c,h,v,"#NamedRangeTab")}else{var d=document.createElement("li");d.innerText=j["Hyperlink.NonamesDefined"],d.className="noHover",a.appendChild(d)}}function p(e,t,r){for(var l=m(e,r),i=ht.querySelector("#SheetNamesTab").querySelector("ul"),n=0;n<l.length;n++){var a=l[n];f(e,t,r,i,a,g,"","#SheetNamesTab")}}function m(e,t){var r=M.data.getWorkBook(e,t),l=r.SheetList.getAllSheetNames();return l}function k(e,t){var r=M.data.getWorkBook(e,t),l=r.NamedRange.getAllKeys();return l}function N(e,t,r){var l=ht.querySelector("#removeLinkBtn"),i={},n=I(e,t,r),a=n.displayValue,o=n.hyperlink,s=n.hasLink;o||1!=s||(o=E(a));var c=ft[0];return o?(l.style.display="block",o.startsWith("#")?c=ft[1]:o.startsWith("mailto:")?c=ft[2]:o.startsWith("tel:")&&(c=ft[3])):l.style.display="none",i.cellVal=null!=a?a:"",i.cellhyperlink=null!=o?o:"",i.tab=c,i}function E(e){for(var t=lt.Cell.splitDisplayValue(e),r=0;r<t.length;r++)if(lt.Cell.isWhiteListed(t[r])||t[r].startsWith("www."))return t[r]}function I(t,r,l){var i=M.view.getActiveGridID(),n=M.data.getWorkBook(t,l),a=(n.getSheetObj(r),M.view.getSheetState(i,r)),o=a.getActiveCellRange(),s=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","hasLink"],c={},u=function(e){c.displayValue=e[o.startRow][o.startCol].DisplayValue,c.hyperlink=e[o.startRow][o.startCol].Hyperlink,c.hasLink=e[o.startRow][o.startCol].hasLink},v=function(t){e.ZSClass.Logger.log("couldn't retrieve data",t)};return M.view.fetchCellData(t,r,l,o.startRow,o.startCol,s,i,u,v),c}function L(e,t){it.value=t,nt.value=e,it.focus()}function D(){var e=it.value;if(e){var t=e.substring(0,e.indexOf(":"));t=""==t?e.substring(0,e.indexOf(".")):t;var r=/^(https|www|http|gopher|telnet|nntp|rlogin|url)$/,l=r.test(t);l||(e="https://"+e)}return{link:e,text:nt.value}}function b(e,t){at.value=t,ot.value=e,at.focus()}function A(e){var t=e?"#"+at.value:at.value;return{link:t,text:ot.value}}function T(e,t){st.value=t,ct.value=e,st.focus()}function w(){{var e=st.value;e.indexOf("mailto:")}return{link:e,text:ct.value}}function C(e,t){ut.value=t,vt.value=e,ut.focus()}function R(){var e=ut.value,t=e.indexOf("tel:"),r=-1==t&&e?"tel:"+e:e;return{link:r,text:vt.value}}function q(e){return 0===e.length||!e.trim()}function x(){var e=ht.querySelector("#URLtxt");it=new $.TextAreaEditor(e);var t=ht.querySelector("#displayURLtxt");nt=new $.TextAreaEditor(t);var r=ht.querySelector("#placeInDoctxt");at=new $.RangeEditor(r),Y.RangePicker.register(at,!0);var l=ht.querySelector("#HrangePickerIcon");Y.RangePicker.Dialog.register(at,dt,l,"Hyperlink");var i=ht.querySelector("#displayplaceInDoctxt");ot=new $.TextAreaEditor(i);var n=ht.querySelector("#emaillinktxt");st=new $.TextAreaEditor(n);var a=ht.querySelector("#displayemaillinktxt");ct=new $.TextAreaEditor(a);var o=ht.querySelector("#phonenumbertxt");ut=new $.TextAreaEditor(o);var s=ht.querySelector("#displayphonenumbertxt");vt=new $.TextAreaEditor(s)}function O(e,t,r){for(var l=m(e,t),i=0;i<l.length;i++)if(l[i]===r)return!0;return!1}function U(){var e=(dt.rID,dt.sheetID,dt.version,dt.getKeyContext()),t=e.keyDown;t[z.ENTER]=function(e,t,r,l){return P(t,r,l),e.preventDefault(),!1}}function P(t,r,l){var r=dt.sheetID,i=M.view.getActiveGridID(),n=M.view.getSheetID(i);r!=n?e.UserAction.SwitchSheet(t,n,l,r,void 0,!1,H):H()}function H(){{var t=dt.rID,r=dt.version,l=n(),i=a(l,!0),o=i.link,s=i.text,c=(dt.sheetID,M.view.getActiveGridID());M.view.getSheetID(c)}s||(s=l==ft[1]&&-1!=o.indexOf("#")?o.substring(1,o.length):o);var u=V(o,l,t,r);u&&o&&setTimeout(function(){e.UserAction.HyperLink(dt.rID,[dt.sheetID],dt.version,"add",s,o),dt.close()},10)}function V(e,t,r,l){var i=e;if(t==ft[2]){var n=JSUtil.REGEXP.validEmail;if(!n.test(i))return Y.ZSAlert(j.PleaseEnterValidEmailAddress,{title:j["Alert.Title.InvalidEmail"]}),!1}else if(t==ft[0]){var n=JSUtil.REGEXP.validURL;if(!n.test(i))return Y.ZSAlert(j["Error.Hyperlink.Invalid.Url"],{title:j["Alert.Title.InvalidURL"]}),!1}else if(t==ft[3]){var n=JSUtil.REGEXP.phoneNo;if(!n.test(i))return Y.ZSAlert(j.PhoneNumberValidation,{title:j["Alert.Title.InvalidPhone"]}),!1}else{var i=at.value,a=(JSUtil.REGEXP.rangeTest.test(i),k(r,l)),o=O(r,l,i),s=o||JSUtil.REGEXP.rangeTest.test(i)||a.has(i);if(!s)return Y.ZSAlert(j["Hyperlink.validInDocument"],{title:j["Alert.Title.InvalidCellRange"]}),!1}return!0}function B(e){var t=dt.rID,r=dt.version,l=Z(t,r,e),i=G(t,r,e);K=l?"#NamedRange":i?"#sheetNames":"#sheetNames"}function G(e,t,r){var l=m(e,t);W("#SheetNamesTab");for(var i=0;i<l.length;i++){var n=r.substring(0,r.indexOf("."));if(l[i]==n){var a=ht.querySelectorAll("#SheetNamesTab > ul > li")[i];a.classList?a.classList.add("highlightSelection"):a.className+=" highlightSelection";var o=ht.querySelector("#SheetNamesTab");return o.scrollTop=a.offsetTop,!0}}return!1}function W(e){for(var t=ht.querySelectorAll(e+" > ul > li"),r=0;r<t.length;r++)t[r].classList&&t[r].classList.remove("highlightSelection")}function Z(e,t,r){var l=J,i=Array.from(l);W("#NamedRangeTab");for(var n=0;n<i.length;n++)if(r==i[n]){var a=ht.querySelectorAll("#NamedRangeTab > ul > li")[n];a.classList?a.classList.add("highlightSelection"):a.className+=" highlightSelection";var o=ht.querySelector("#NamedRangeTab");return o.scrollTop=a.offsetTop,!0}return!1}function _(){gt.Clear(),dt.close()}function c(){u(),v(),yt={}}var K,J,M=e.sPlusPlus,F=e.ZSConstants.FeatureConstants,X=e.document,j=e.ZSConstants.I18N,z=(e.ZSConstants.wCC,e.ZSConstants.JSKeyCode),Y=e.ZSClass,$=(Y.Editors.RangeEditor,Y.Editors.Utility,Y.Editors),Q=(e.UIUtil.Component,e.ZSEvents),et=Q.topic,tt=Q.Groups,rt=Q.Names,lt=e.JSUtil,it=void 0,nt=void 0,at=void 0,ot=void 0,st=void 0,ct=void 0,ut=void 0,vt=void 0,dt=void 0,ht=void 0,gt=M.view.Toolbar.Feature[F.HYPERLINK],ft={0:"WEB_LINK",1:"INDOCUMENT",2:"EMAIL_LINK",3:"PHONENO"},St={WEB_LINK:"webLink",INDOCUMENT:"pDocLink",EMAIL_LINK:"emailLink",PHONENO:"telLink"},yt={},pt=/[^a-zA-Z]/g,mt=/[^0-9]/g;gt.openDialog=t}(this);
!function(t){function e(){if(this.DOM.customTxt1.value="",this.DOM.customTxt2.value="",this.DOM.andOperator.checked=!0,this.DOM.autoFilterCnt.innerHTML="",this.DOM.cellFilterCnt.innerHTML="",this.DOM.textFilterCnt.innerHTML="",v(this.DOM.autoFilter,!0),v(this.DOM.customFilter,!1),F.zcombo(this.DOM.criteria1,"setValue","eq"),F.zcombo(this.DOM.criteria2,"setValue","eq"),F.zcombo("foCategory","setValue","values"),F.zspinner("fspinner","setValue",10),F.zdatetimefield(customTxt2,"destroy"),F.zdatetimefield(customTxt1,"destroy"),this.DOM.autoCellFilterSearch.value="",this.prevTab){var t=this.DOM[this.prevTab];t.labels[0].classList.remove("flChecked"),this.prevTab=void 0}}function i(t){var e=this.getIndexOfSelectedItem(t);-1==e?(this.addSelectItem(t),this.selectedItemsCount++):(this.removeSelectedItem(e),this.selectedItemsCount--),l.call(this)}function l(){var t=this.getActiveTab().selectedItems.length,e=Object.keys(this.activeTabData).length,i=t>0?"enable":"disable";f("filterbtn",i);var l=this.activeTab+"Select";t==e?(!this.DOM[l].classList.contains("filterItemSelect")&&this.DOM[l].classList.add("filterItemSelect"),this.DOM[l].classList.remove("filterPartialSelection")):1>t?(this.DOM[l].classList.remove("filterItemSelect"),this.DOM[l].classList.remove("filterPartialSelection")):(this.DOM[l].classList.contains("filterItemSelect")&&this.DOM[l].classList.remove("filterItemSelect"),!this.DOM[l].classList.contains("filterPartialSelection")&&this.DOM[l].classList.add("filterPartialSelection"));var r=this.DOM[this.activeTab];if(t>0){if(void 0!=this.prevTab&&this.prevTab!=this.activeTab){var a=this.DOM[this.prevTab];a.labels[0].classList.remove("flChecked");var o="autoCellFilter"==this.prevTab?"autoFilterCnt":"cellColorFilter"==this.prevTab?"cellFilterCnt":"textFilterCnt";this.getFilterdTab().selectedItems.length>0&&s.call(this,o),this.clearAllSelectedItems()}r.labels[0].classList.add("flChecked"),this.prevTab=this.activeTab}else r.labels[0].classList.remove("flChecked")}function s(t){for(var e=this.container.querySelector("#"+t),i=e.children,l=this.prevTab+"Select",s=0;s<i.length;s++){var r;r="autoFilterCnt"!=t?i[s]:i[s],r.classList.contains("filterItemSelect")&&r.classList.remove("filterItemSelect"),r.classList.contains("filterPartialSelection")&&r.classList.remove("filterPartialSelection")}this.DOM[l].classList.remove("filterPartialSelection"),this.DOM[l].classList.remove("filterItemSelect")}function r(){this.callback.clearFilter(this.data.index),this.close()}function a(){var t,e,i,l,s,r,a="none"==this.DOM.customFilter.style.display,o=this.data,c=o.dT,n=(o.index,["lt","lte","gt","gte"]);if(a)t=JSON.stringify(this.getActiveTab().selectedItems),e="eq",i="OR";else{e=this.DOM.criteria1.value,s=this.DOM.criteria2.value;var h=-1!=n.indexOf(e),u=-1!=n.indexOf(s);if("top"==e||"bottom"==e){t=this.container.querySelector("#fspinner").value;var d=this.container.querySelector("#foCategory").value;e=e+" "+d,r=M.SPECIAL_CRITERIA}else(h||u)&&"DATE"==c?(t=h?F.zdatetimefield(this.DOM.customTxt1,"getValue").dateString:this.DOM.customTxt1.value,l=u?F.zdatetimefield(this.DOM.customTxt2,"getValue").dateString:this.DOM.customTxt2.value,s=u?s:""!==this.DOM.customTxt2.value?this.DOM.criteria2.value:"",i=1==this.DOM.andOperator.checked?"AND":"OR"):(t=""!==this.DOM.customTxt1.value?this.DOM.customTxt1.value:"",l=""!==this.DOM.customTxt2.value?this.DOM.customTxt2.value:"",s=""!==this.DOM.customTxt2.value?this.DOM.criteria2.value:"",i=1==this.DOM.andOperator.checked?"AND":"OR")}t&&(this.callback.applyFilter(o.index,c,t,e,i,l,s,r),this.close())}function o(t){var e=r.bind(this),i=a.bind(this);this.DOM.clearbtn.onclick=function(){"enable"==t&&e()},this.DOM.filterbtn.onclick=function(){i()}}function c(){var t=this.data.dT,e=this.DOM.criteria1,i=this.DOM.criteria2,l=e.querySelector('option[value="top"]'),s=e.querySelector('option[value="bottom"]');"NUMBER"==t?(v(l,!0),v(s,!0)):("DATE"==t||"TEXT"==t)&&(v(l,!1),v(s,!1)),"DATE"==t?(m(e.querySelector("option[value='gt']"),y["Condition.DateAfter"]),m(e.querySelector("option[value='gte']"),y["Condition.DateOnOrAfter"]),m(e.querySelector("option[value='lt']"),y["Condition.DateBefore"]),m(e.querySelector("option[value='lte']"),y["Condition.DateOnOrBefore"]),m(i.querySelector("option[value='gt']"),y["Condition.DateAfter"]),m(i.querySelector("option[value='gte']"),y["Condition.DateOnOrAfter"]),m(i.querySelector("option[value='lt']"),y["Condition.DateBefore"]),m(i.querySelector("option[value='lte']"),y["Condition.DateOnOrBefore"])):(m(e.querySelector("option[value='gt']"),y["Condition.GreaterThan"]),m(e.querySelector("option[value='gte']"),y["Condition.GreaterThanOrEqualTo"]),m(e.querySelector("option[value='lt']"),y["Condition.LessThan"]),m(e.querySelector("option[value='lte']"),y["Condition.LessThanOrEqualTo"]),m(i.querySelector("option[value='gt']"),y["Condition.GreaterThan"]),m(i.querySelector("option[value='gte']"),y["Condition.GreaterThanOrEqualTo"]),m(i.querySelector("option[value='lt']"),y["Condition.LessThan"]),m(i.querySelector("option[value='lte']"),y["Condition.LessThanOrEqualTo"])),F.zcombo(e,"refresh"),F.zcombo(i,"refresh")}function n(t,e){t.style.top=e+"px"}function h(){var t=this.dateFormat;if(this.DOM.toggleFilter.classList.toggle("autoFilterCls"),this.isCustomFilter)this.posAdjusted&&n(this.container,I),v(this.DOM.autoFilter,!0),v(this.DOM.customFilter,!1),this.DOM.toggleFilter.innerText=y["Filter.customFilter"],this.isCustomFilter=!1,this.DOM.autoCellFilter.click();else{if(this.posAdjusted){var e=parseInt(this.container.style.top);I=e;var i=this.container.offsetHeight,l=i-250;e+=l,n(this.container,e)}v(this.DOM.autoFilter,!1),v(this.DOM.customFilter,!0),this.DOM.toggleFilter.innerText=y["Filter.Auto"],this.isCustomFilter=!0;var s="enable";this.DOM.customTxt1.onfocus=function(){f("filterbtn",s)},this.DOM.customTxt2.onfocus=function(){f("filterbtn",s)},c.call(this);var r=this.data.dT,a=F.zcombo(this.DOM.criteria1,"getValue");b(a,!1,{dT:r,dateFormat:t}),F.unbind(this.DOM.criteria1,"zselectboxchange"),F.bind(this.DOM.criteria1,"zselectboxchange",function(e,i){var l=i.value;b(l,!1,{dT:r,dateFormat:t})});var o=this.DOM.customTxt2;F.unbind(this.DOM.criteria2,"zselectboxchange"),F.bind(this.DOM.criteria2,"zselectboxchange",function(e,i){f("filterbtn",s);var l=i.value;"lt"!=l&&"lte"!==l&&"gt"!==l&&"gte"!==l||"DATE"!=r?F.zdatetimefield(o,"destroy"):F.zdatetimefield(o,{format:t,picker:!0})}),""==this.DOM.customTxt1.value&&""==this.DOM.customTxt2.value?f("filterbtn","disable"):f("filterbtn",s)}}function u(){var t=h.bind(this),e=d.bind(this);this.DOM.toggleFilter.onclick=function(){t()};var i=this.container.querySelector("#sortAsc"),l=this.container.querySelector("#sortDesc");i.onclick=function(){e("ASC")},l.onclick=function(){e("DESC")};var s=O.bind(this);autoSelect.onclick=function(){var t=this.classList.contains("filterPartialSelection")||!this.classList.contains("filterItemSelect")?!0:!1;s(autoFilterCnt,t)},cellColorSelect.onclick=function(){var t=this.classList.contains("filterPartialSelection")||!this.classList.contains("filterItemSelect")?!0:!1;s(cellFilterCnt,t)},textColorSelect.onclick=function(){var t=this.classList.contains("filterPartialSelection")||!this.classList.contains("filterItemSelect")?!0:!1;s(textFilterCnt,t)}}function d(t){this.callback.sortFilter(t)}function f(t,e){F[e]("#"+t)}function v(t,e){t.style.display=e?"":"none"}function m(t,e){t.innerText=e}function O(t,e){for(var i=t.children,s=0;s<i.length;s++){var r=i[s],a=e&&!r.classList.contains("filterItemSelect")||!e;if(a){var o=r.getAttribute("value");if(e)r.classList.add("filterItemSelect"),r.classList.remove("filterPartialSelection"),this.addSelectItem(o),f("filterbtn","enable");else{r.classList.remove("filterPartialSelection"),r.classList.remove("filterItemSelect");var c=this.getIndexOfSelectedItem(o);this.removeSelectedItem(c),f("filterbtn","disable")}}}l.call(this)}function b(t,e,i){var l=p.getElementById("customFilter"),s=p.getElementById("customTxt1");if(f("filterbtn","enable"),"top"==t||"bottom"==t){s.type="input",l.classList.add("topBotm");var r=p.getElementById("foCategory"),a=p.getElementById("fspinner"),o="items"==i.sC?"values":"percent";e&&F.zcombo(r,"setValue",o),e&&F.zspinner(a,"setValue",i.sVal)}else"lt"!=t&&"lte"!=t&&"gt"!=t&&"gte"!=t||"DATE"!=i.dT?F.zdatetimefield(s,"destroy"):F.zdatetimefield(s,{format:i.dateFormat,picker:!0}),l.classList.remove("topBotm")}function T(){var t=this.container;this.DOM={autoCellFilter:t.querySelector("#filterCellValue"),cellColorFilter:t.querySelector("#filterCellColor"),textColorFilter:t.querySelector("#filterTextColor"),autoFilterCnt:t.querySelector("#autoFilterCnt"),cellFilterCnt:t.querySelector("#cellFilterCnt"),textFilterCnt:t.querySelector("#textFilterCnt"),clearbtn:t.querySelector("#clearbtn"),filterbtn:t.querySelector("#filterbtn"),customTxt1:t.querySelector("#customTxt1"),customTxt2:t.querySelector("#customTxt2"),criteria1:t.querySelector("#criteria1"),criteria2:t.querySelector("#criteria2"),andOperator:t.querySelector("#andOperator"),orOperator:t.querySelector("#orOperator"),toggleFilter:t.querySelector("#toggleFilter"),autoFilter:t.querySelector("#autoFilter"),customFilter:t.querySelector("#customFilter"),cellColorFilterSelect:t.querySelector("#cellColorSelect"),textColorFilterSelect:t.querySelector("#textColorSelect"),autoCellFilterSelect:t.querySelector("#autoSelect"),textColorFilterSearch:t.querySelector("#textColorSearch"),cellColorFilterSearch:t.querySelector("#cellColorSearch"),autoCellFilterSearch:t.querySelector("#autoSearch"),maxInfo:t.querySelector("#maxDataInfo")}}function D(t,e,l,s,r){var a=this.container.querySelector("#"+l+"loader"),o=s,c=[],n=o.indexOf(""),h=-1!=n,u=[],c=[];if(h){u.push(o[n]),c.push(this.data.selectedItemIndexes[n]);for(var d=0;d<o.length;d++)d!=n&&(u.push(o[d]),c.push(this.data.selectedItemIndexes[d]))}else u=o,c=this.data.selectedItemIndexes;this.initActiveTab();{var f=(this.getActiveTab().selectedItems,this.DOM[l]),m=0,O=i.bind(this),b=this.activeTab+"Search";new C.AutoSuggest.filterSuggest({editor:this.DOM[b],container:f,dataType:"Array",fuzzy:!0,data:u,dontCreateSpan:!0,callBack:function(e){var i=e.text,l=new C.Filter.selectItems(t,O);l[r](i,c[m],e.dom),e.decorate=function(){},m++}})}v(a,!1)}function S(t,e,l,s){var r=this.data.cD,a=this.data.ccs,o=this.data.tcs,r="autoCellFilter"===l?r:"cellColorFilter"==l?a:o;this.activeTab=l,this.activeTabData=r;var c=this.container.querySelector("#"+e+"loader");if(v(c,!0),!this.filterTypes[l])if("autoCellFilter"==l)D.call(this,t,l,e,r,s);else{this.initActiveTab();var n={};if(this.dataFromClient)n=r;else for(var h=0;h<r.length;h++){var u=void 0!=this.data.selectedItemIndexes[h]?this.data.selectedItemIndexes[h]:0;n[r[h]]=u}var d=i.bind(this),m=new C.Filter.selectItems(t,d);this.DOM[e].appendChild(m[s](n))}v(c,!1);var O=this.selectedItemsCount,b=O>0?"enable":"disable";f("filterbtn",b)}var C=(t.sPlusPlus,t.ZSClass),p=t.document,F=t.UIUtil.Component,g=t.ZSConstants,y=g.I18N,M=g.ActionConstants,x=function(t,e){this.callback=t,this.dateFormat=e.dateFormat,this.init()};x.prototype={init:function(){var e=t.UserAction.getTemplate(["filterWidget"]),i=e.filterWidget;this.container=p.createElement("div"),this.container.id="DI_FILTER",this.container.className="flWrapper",this.container.style.zIndex=1e3,this.container.appendChild(i),p.body.appendChild(this.container),F.initComponent("#"+this.container.id),T.call(this),u.call(this)},getDialogPos:function(){return this.container.style.display="",{height:this.container.clientHeight,width:this.container.clientWidth}},show:function(t,i,l){e.call(this),this.container.style.top=t+"px",this.container.style.left=i+"px",this.posAdjusted=l,v(this.container.querySelector("#autoFilterCntloader"),!0),v(this.container.querySelector("#cellFilterCntloader"),!0),v(this.container.querySelector("#textFilterCntloader"),!0)},generateData:function(t){this.selectedItemsCount=0,this.data=t;var e=t.aft;this.dataFromClient=void 0!=this.data.selectedItemIndexes?!1:!0,this.isCustomFilter=void 0==e?!1:"fc"===e?!0:!1,this.filteredtype=this.isCustomFilter;var i=e&&"fbcc"===e?"filterCellColor":e&&"fbtc"===e?"filterTextColor":"filterCellValue",l=t.aft?!0:!1;this.filterTypes={};var s=S.bind(this,i,"autoFilterCnt","autoCellFilter","generateAutoFilterItems"),r=S.bind(this,i,"cellFilterCnt","cellColorFilter","generateCellColorItems"),a=S.bind(this,i,"textFilterCnt","textColorFilter","generateTextColorItems");this.DOM.autoCellFilter.onclick=function(){s()},this.DOM.cellColorFilter.onclick=function(){r()},this.DOM.textColorFilter.onclick=function(){a()};var h;if(this.isCustomFilter){var u=this.dateFormat;if(this.DOM.toggleFilter.innerText=y["Filter.Auto"],this.DOM.toggleFilter.classList.add("autoFilterCls"),c.call(this),this.posAdjusted){var d=parseInt(this.container.style.top);I=d;var m=this.container.offsetHeight,O=m-250;d+=O,n(this.container,d)}v(this.DOM.autoFilter,!1),v(this.DOM.customFilter,!0);var T=t.sOpr?t.sOpr:t.o1?t.o1:t.o2;F.zcombo(this.DOM.criteria1,"setValue",T),b(T,!0,{sC:t.sC,sVal:t.sVal,dT:t.dT,dateFormat:u});var D=this.data.dT;F.unbind(this.DOM.criteria1,"zselectboxchange"),F.bind(this.DOM.criteria1,"zselectboxchange",function(t,e){var i=e.value;b(i,!1,{dT:D,dateFormat:u})});var C=this.DOM.customTxt2;if(F.unbind(this.DOM.criteria2,"zselectboxchange"),F.bind(this.DOM.criteria2,"zselectboxchange",function(t,e){var i=e.value;"lt"!=i&&"lte"!==i&&"gt"!==i&&"gte"!==i||"DATE"!=D?F.zdatetimefield(C,"destroy"):F.zdatetimefield(C,{format:u,picker:!0})}),!t.sVal){if("DATE"!=D)this.DOM.customTxt1.value=t.v1,this.DOM.customTxt2.value=t.v2;else{var p=["lt","lte","gt","gte"];t.o1&&-1!=p.indexOf(t.o1)?F.zdatetimefield(this.DOM.customTxt1,"setValue",t.v1):this.DOM.customTxt1.value=t.v1,t.o2&&-1!=p.indexOf(t.o2)?(F.zdatetimefield(C,{format:u,picker:!0}),F.zdatetimefield(C,"setValue",t.v2)):this.DOM.customTxt2.value=t.v2}this.DOM.orOperator.checked="OR"==t.ft?!0:!1,t.o1&&F.zcombo(this.DOM.criteria1,"setValue",t.o1),t.o2&&F.zcombo(this.DOM.criteria2,"setValue",t.o2)}h=t.v1||t.v2||t.sVal?"enable":"disable"}else{v(this.DOM.autoFilter,!0),v(this.DOM.customFilter,!1);var g=this.container.querySelector("#"+i);g.checked=!0,g.click(),h=l?"enable":"disable",this.DOM.toggleFilter.classList.remove("autoFilterCls"),this.DOM.toggleFilter.innerText=y["Filter.customFilter"],h=0==this.getActiveTab().selectedItems.length?"disable":"enable"}f("clearbtn",h),f("filterbtn",h),o.call(this,h),v(this.DOM.maxInfo,t.smd)},close:function(){var t=this.container&&""===this.container.style.display;t&&(this.container.style.display="none",e.call(this)),this.callback.dialogClose()},clearAllSelectedItems:function(){this.selectedItemsCount-=this.filterTypes[this.prevTab].selectedItems.length,this.filterTypes[this.prevTab].selectedItems,this.filterTypes[this.prevTab]={},this.filterTypes[this.prevTab].selectedItems=[]},getIndexOfSelectedItem:function(t){return this.getActiveTab().selectedItems.indexOf(t)},removeSelectedItem:function(t){this.getActiveTab().selectedItems.splice(t,1)},initActiveTab:function(){this.filterTypes[this.activeTab]={},this.filterTypes[this.activeTab].selectedItems=[],l.call(this)},addSelectItem:function(t){this.filterTypes[this.activeTab].selectedItems.push(t)},getActiveTab:function(){return this.filterTypes[this.activeTab]},getFilterdTab:function(){return this.filterTypes[this.prevTab]},changeDateFormat:function(t){this.dateFormat=t}};var I;C.Filter.Dialog=x}(this);
!function(e){function t(e,t){this.type=e,this.callback=t}e.sPlusPlus;t.prototype={init:function(){this.model={inputProps:{className:"filterItem"},inputAttrs:{},spanProps:{className:"flClrPallete"}},this.eventListener={click:this.setSelectedItems}},generateAutoFilterItems:function(e,t,s){this.init();var l=document.createDocumentFragment(),i=this.model.inputProps,n=this.model.inputAttrs;if(this.type)var r="filterCellValue"==this.type&&t?!0:!1;else var r=t?!0:!1;var a=e?e:"(Blanks)";n.value=e,i.title=a,i.innerText=a;var o=new ZSClass.Filter.Item("div",i,n,this,this.eventListener,s),m=o.getElement();return r&&this.setSelectedItems(m,r),l.appendChild(m),l},generateCellColorItems:function(e){this.init();var t=document.createDocumentFragment(),s=this.model.inputProps,l=this.model.inputAttrs,i=this.model.spanProps;for(var n in e){var r="filterCellColor"==this.type&&e[n]?!0:!1,a=n,o={innerText:""==a?"(No Fill)":""};l.value="bycellcolor("+a+")";var m=new ZSClass.Filter.Item("div",s,l,this,this.eventListener),p=m.getElement(),c=new ZSClass.Filter.Item("span",o),h=c.getElement();r&&this.setSelectedItems(p,r),i.style={},i.style.backgroundColor=a;var m=new ZSClass.Filter.Item("span",i),u=m.getElement();p.appendChild(u),p.appendChild(h),t.appendChild(p)}return t},generateTextColorItems:function(e){this.init();var t=document.createDocumentFragment(),s=this.model.inputProps,l=this.model.inputAttrs,i=this.model.spanProps;for(var n in e){var r="filterTextColor"==this.type&&e[n]?!0:!1,a=n,o={innerText:""==a?"(Default)":""};l.value="byfontcolor("+a+")";var m=new ZSClass.Filter.Item("div",s,l,this,this.eventListener),p=m.getElement(),c=new ZSClass.Filter.Item("span",o),h=c.getElement();r&&this.setSelectedItems(p,r),i.style={},i.style.backgroundColor=""==a?"black":a;var m=new ZSClass.Filter.Item("span",i),u=m.getElement();p.appendChild(u),p.appendChild(h),t.appendChild(p)}return t},setSelectedItems:function(e){var t=e.getAttribute("value");e.classList.toggle("filterItemSelect"),this.callback&&this.callback(t)}},ZSClass.Filter.selectItems=t}(this);
!function(){function t(t,e,s,i,n,c){this.type=t,this.props=e,this.attributes=s,this.events=n,this.parent=i,this.elem=c}function e(t,e){Object.keys(e).forEach(function(s){"style"==s?i(t,e[s]):t[s]=e[s]})}function s(t,e){Object.keys(e).forEach(function(s){t.setAttribute(s,e[s])})}function i(t,e){Object.keys(e).forEach(function(s){t.style[s]=e[s]})}function n(t,e,s){Object.keys(s).forEach(function(i){t.addEventListener(i,function(){var t=s[i];t.call(e,this)})})}t.prototype.getElement=function(){var t=this.elem||document.createElement(this.type);return this.props&&e(t,this.props),this.attributes&&s(t,this.attributes),this.events&&n(t,this.parent,this.events),t},ZSClass.Filter.Item=t}(this);
!function(t){function s(t){g.register.call(this,t);var s={input:n.bind(this)};e(this.editor,s),this.suggest("")}function n(){var t=i(this.editor);this.suggest(t)}function e(t,s){Object.keys(s).forEach(function(n){var e=s[n];t.addEventListener(n,e)})}function i(t){var s=t.value,n=t.selectionStart,e=t.selectionEnd,i=r(s,n,e),u=s.substring(i.start,i.end);return u}function r(t,s,n){{var e=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=t.substring(0,s),r=t.substring(n,t.length),u=s-i.split(e).pop().length,g=n+r.split(e)[0].length;t.substring(0,u),t.substring(g,t.length)}return{start:u,end:g}}var u=(t.sPlusPlus,t.ZSClass),g=u.AutoSuggest;s.prototype=new g.register,g.filterSuggest=s}(this);
!function(e){function t(){var t={modal:!0,width:450,title:f["MenuItem.FileTab.SpreadSheetSetting"]};h||(n(),h=new e.ZSClass.Dialog(O,t)),h.open()}function n(){var t=e.UserAction.getTemplate(["SP_SHEETSETTINGS"]),n=t.SP_SHEETSETTINGS;O=T.createElement("div"),O.id="DI_SPSettings",O.appendChild(n);var o=b.fn.replaceParams(f["documentsettingsdialog.additionalInfo"],new Array("<a target='_blank' href='"+N.ZOHO_ACCOUNTS_URL+"/u/h#profile/personal'>","</a>"));O.querySelector("#zohoAccLink").innerHTML=o,O.querySelector("[id=spcountryCombo]").appendChild(l),O.querySelector("[id=splanguageCombo]").appendChild(u),O.querySelector("[id=sptimezoneCombo]").appendChild(S);var a=O.querySelector("#okBtn");a.addEventListener("click",i);var s=O.querySelector("#cancelBtn");s.addEventListener("click",r)}function o(e){t(),c=e,E.zcombo("#spcountryCombo","setValue",e[I.COUNTRY]),E.zcombo("#splanguageCombo","setValue",e[I.LANGUAGE]),E.zcombo("#sptimezoneCombo","setValue",e[I.TIME_ZONE])}function i(){var t=O.querySelector("#spcountryCombo").value,n=O.querySelector("#splanguageCombo").value,o=O.querySelector("#sptimezoneCombo").value,i=d.data.Defaults.VIEW==d.data.View.CLASSIC?"CLASSIC":"COMFORT",s=a(t,n,o);if(s){var c=d.view.getActiveGridID(),l=d.view.getResourceID(c),u=(d.view.getSheetID(c),d.view.getVersionID(c)),S=d.view.getSelectedSheets(c);e.UserAction.DocumentSetting(l,S,u,n+"_"+t,o,i)}r()}function a(e,t,n){var o=e,i=t,a=n,r=c[I.COUNTRY],s=c[I.LANGUAGE],l=c[I.TIME_ZONE];return r!=o||s!=i||l!=a?!0:!1}function r(){h.close()}function s(){var t=d.view.getActiveGridID(),n=d.view.getResourceID(t),o=d.view.getSelectedSheets(t),i=d.view.getVersionID(t);e.UserAction.fetchDocumentSettings(n,o,i)}{var c,l,u,S,d=e.sPlusPlus,C=e.ZSEvents,v=C.topic,g=C.Groups,m=C.Names,E=e.UIUtil.Component,p=e.ZSConstants.FeatureConstants,T=e.document,f=e.ZSConstants.I18N,I=(e.ZSConstants.wCC,e.ZSConstants.CommandConstants),A=e.ZSConstants.LocaleConstants,N=e.sPlusPlus.data.AppRegistry,b=e.JSUtil,h=void 0,O=void 0,U=d.view.Toolbar.Feature[p.SPREADSHEET_SETTINGS];!function(){var e=["COUNTRY","LANGUAGE","TIMEZONE"];for(var t in e){for(var n=A[e[t]],o=document.createDocumentFragment(),i=0;i<=n.length;i++)if(void 0!=n[i]){var a,r;"TIMEZONE"===e[t]?(a=n[i].substring(0,n[i].indexOf("[")),r=n[i].substring(n[i].indexOf("[")+1,n[i].length)):(r=n[i].substring(0,n[i].indexOf("_")),a=n[i].substring(n[i].indexOf("_")+1,n[i].length));var s=T.createElement("option");s.text=r,s.value=a,o.appendChild(s)}"COUNTRY"==e[t]?l=o:"LANGUAGE"==e[t]?u=o:S=o}}()}v.register(g.Listener,m.UserAction.FETCH_DOCUMENT_SETTINGS,o,"RESPONSE"),U.openDialog=t,U.fetchDocumentSettings=s}(this);
!function(t){function i(t){this.callback=t,this.init()}function e(){this.callback.close()}function n(){this.container.classList.remove("pointer")}function s(t){var i=t;this.activeElement&&this.activeElement.classList.remove("active"),i.classList.add("active"),this.activeElement=t}function c(){var t=this.activeElement&&this.activeElement.textContent;return t&&this.callback.submit(t),!1}function o(){if(0!=this.listAry.length){var t=this.activeElement;if(this.container.classList.add("pointer"),t){var i=t.getAttribute("id"),e=l.call(this,i),n=h.call(this,e);s.call(this,n),u.call(this,n)}else{var c=this.container.childNodes[0];s.call(this,c)}return!1}}function a(){if(0!=this.listAry.length){var t=this.activeElement;if(this.container.classList.add("pointer"),t){var i=t.getAttribute("id"),e=l.call(this,i),n=r.call(this,e);s.call(this,n),f.call(this,n)}else{var c=this.listAry.length,o=this.container.childNodes[c-1];s.call(this,o),f.call(this,o)}return!1}}function l(t){return this.listAry.indexOf(t)}function h(t){var i=t+1>=this.listAry.length?0:t+1,e=this.listAry[i];return this.container.querySelector("#"+e)}function r(t){var i=0>t-1?this.listAry.length-1:t-1,e=this.listAry[i];return this.container.querySelector("#"+e)}function d(t,i){t.scrollTop=i}function u(t){var i=this.container.offsetHeight,e=t.offsetTop;if(e+t.offsetHeight>i){var n=this.container.scrollTop;d(this.container,n+t.offsetHeight)}else 0==e&&d(this.container,0)}function f(t){var i=(this.container.offsetHeight,t.offsetTop),e=this.container.scrollTop,n=this.listAry.length-1;e>i?d(this.container,i):i==n*t.offsetHeight&&d(this.container,i)}var v=t.sPlusPlus,p=t.ZSClass,y=(v.view.Events.Key,t.ZSConstants),m=y.JSKeyCode,E=y.wCC;i.prototype={init:function(){this.container=document.createElement("ul"),this.container.classList.add("pickListMenu"),this.container.addEventListener("mousemove",n.bind(this)),this.container.id=E.SUBMENUITEM+"PICK_LIST"+E.IDENTITY,document.body.appendChild(this.container),this.context=new p.KeyMapping,this.bindEvents()},getDialogPos:function(){var t={height:this.container.offsetHeight};return t},getDisplay:function(){return this.container.style.display},setDialogPos:function(t){var i=t.top,e=t.left,n=t.height<this.container.offsetHeight?t.height+"px":"auto";this.container.style.top=i+"px",this.container.style.left=e+"px",this.container.style.height=n},close:function(){this.container.style.cssText="",this.container.style.display="none",this.container.innerHTML="",this.reset()},reset:function(){this.activeElement=void 0},show:function(t,i){this.listAry=[];var e=document.createDocumentFragment(),n=t.length;if(0!=n)for(var c=0;n>c;c++){var o=t[c],a=document.createElement("li");a.addEventListener("click",this.callback.submit.bind(this,o)),a.addEventListener("mouseover",s.bind(this,a)),this.listAry.push("list_"+c),a.setAttribute("id","list_"+c);var l=document.createTextNode(o);a.appendChild(l),e.appendChild(a)}else{var a=document.createElement("li"),l=document.createTextNode("none");a.appendChild(l),e.appendChild(a)}this.container.style.display="",this.container.appendChild(e),i&&this.setDialogPos(i),this.setActiveCellFocus()},setActiveCellFocus:function(){if(this.activeElement){s.call(this,this.activeElement);var t=this.activeElement.offsetTop;d(this.container,t)}},bindEvents:function(){var t=v.view.Events.Key,i=t.Entry.PickList.Context,n=i.keyDown;n[m.ESC]=e.bind(this),n[m.ENTER]=c.bind(this),n[m.DOWN]=o.bind(this),n[m.UP]=a.bind(this),n[m.PURE_PRINTABLE_CHAR]=this.close.bind(this)}},p.PickFromList=i}(this);
!function(e){function t(){ZSClass.KeyMapping.call(this)}function o(e,t){var o=-1!=n.data.AppRegistry.ZFSNG_PRODUCT_TYPE?!1:!0,a={insertFrom:"Upload",isRemoteMode:o,gadgetsURL:"//"+n.data.AppRegistry.gadgetUrl,enableGadgets:!0,gadgets:{hostname:"",serviceName:"sheet"},noOfImagesToBeSelected:g?g:50,onInsert:i,onInsertType:void 0!=t?t:"INSERT"};o||(a.product_type=n.data.AppRegistry.ZFSNG_PRODUCT_TYPE,a.owner_id=n.data.AppRegistry.OWNER_ZUID),C.focusContext(C.Entry.Dialog.Context),E||(c.bind("#zfeedbackDialog","zdialogclose",function(){C.focusContext(C.Entry.CellEditor.Context)}),E=!0),c.initFcomponents(),FCImageLibrary.open(a)}function i(e){{var t=n.view.getActiveGridID(),o=n.view.getResourceID(t),i=n.view.getSheetID(t),a=n.view.getVersionID(t);n.data.getWorkBook(o,a)}l.publish(I.Listener,p.SheetAction.IMAGES.UPLOAD,{RID:o,SHEETID:i,VERSION:a,IMAGES:e.info,DATA:e}),FCImageLibrary.close()}var n=e.sPlusPlus,a=e.ZSConstants,s=a.FeatureConstants,r=n.view.Toolbar.Feature[s.IMAGE],g=10,d=e.ZSEvents,l=d.topic,I=d.Groups,p=d.Names,c=e.UIUtil.Component,E=!1,u=new t,C=n.view.Events.Key;C.Entry.Dialog.Node.addChildNode(u),l.register(I.UI,p.Toolbar.IMAGE.CLICK,o,"EV","ID"),r.openDialog=o}(this);
!function(e){function t(){s||n(),r(),s.open(),u.focus()}function n(){var t=e.UserAction.getTemplate(["solverTemplate"]).solverTemplate,n=document.createElement("div");n.id="DI_SOLVER",n.appendChild(t),u=new ZSClass.Editors.RangeEditor(n.querySelector("#targetCell")),v=new ZSClass.Editors.RangeEditor(n.querySelector("#variantCells")),ZSClass.RangePicker.register(u,!0,!0),ZSClass.RangePicker.register(v,!0),S=n.querySelector("#nonNegative"),d=n.querySelector("#optimizeTo"),g=n.querySelector("#specificValue"),m.bind(d,"zselectboxchange",function(e,t){g.style.display="VALUE"==t.value?"inline-block":"none"}),l=n.querySelector("#solverConstraintsContainer"),c=n.querySelector("#addSolverConstraint"),c.addEventListener("click",r),n.querySelector("#clBtn").addEventListener("click",function(){s.close()}),n.querySelector("#okBtn").addEventListener("click",function(){var e,t=u.value.trim(),n=v.value.trim(),r=m.zcombo(d,"getValue"),i="VALUE"==r,o=S.checked;i&&(e=g.value.trim()),f.execute(t,n,r,o,e,R,i)});var i={width:560,title:E["MenuItem.DataTab.Solver"],close:a,open:o};s=new ZSClass.Dialog(n,i);var p=n.querySelector("#rangePickerVariant");ZSClass.RangePicker.Dialog.register(v,s,p,E["MenuItem.DataTab.Solver"])}function r(){var e=new f.Constraint(l);e.addConstraintToUI(),e.initComponents(),R.push(e)}function i(e){R.splice(e,1)}function o(){var e=p.data.getWorkBook(s.rID,s.version),t=e.getSheetObj(s.sheetID),n=t.Prop.getName(),r=p.view.getSheetState(s.gridID,s.sheetID).getActiveCellRange().getLabel();u.value=n+"."+r}function a(){m.destroyComponent(l);var t=p.view.getActiveGridID(),n=p.view.getResourceID(t),r=p.view.getVersionID(t),i=p.view.getSheetID(t);s.sheetID!=i&&e.UserAction.SwitchSheet(n,i,r,s.sheetID),u.value="",v.value="",S.checked=!0,g.value="",m.zcombo(d,"setValue","MAXIMIZE"),g.style.display="none",l.innerHTML="",w=0,R=[],c.style.display=""}var s,l,c,u,v,S,d,g,s,p=e.sPlusPlus,C=e.ZSConstants,I=C.FeatureConstants,m=e.UIUtil.Component,E=C.I18N,y=e.ZSEvents,D=y.Groups,h=y.Names,k=y.topic,f=p.view.Toolbar.Feature[I.SOLVER],w=0,R=[];f.openDialog=t,k.register(D.Listener,h.UserAction.SOLVER.REMOVE_CONSTRAINT,i,"INDEX")}(this);
!function(t){function e(t){this.parent=t;var e=UserAction.getTemplate(["solverConstraintTemplate"]).solverConstraintTemplate;this.expressionEditor=new ZSClass.Editors.RangeEditor(e.querySelector("#constraintExpression")),this.valueEditor=new ZSClass.Editors.RangeEditor(e.querySelector("#constraintValue")),ZSClass.RangePicker.register(this.expressionEditor,!0,!0),ZSClass.RangePicker.register(this.valueEditor,!0,!0),this.closeButton=e.querySelector("#solverConstraintClose"),this.closeButton.addEventListener("click",this.remove.bind(this)),this.operator=e.querySelector("#constraintOperator"),this.operator.id=this.operator.id+""+o,o++;var s=document.createElement("div");s.className="dspTblRow",s.appendChild(e),this.solverConstraintElement=s}var s=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,i=t.UIUtil.Component,r=s.view.Toolbar.Feature[n.SOLVER],o=0,a=[],l=t.ZSEvents,p=l.Groups,u=l.Names,d=l.topic;e.prototype={getExpression:function(){return this.expressionEditor.value.trim()},getValue:function(){return this.valueEditor.value.trim()},addConstraintToUI:function(){this.parent.appendChild(this.solverConstraintElement),this.solverConstraintElement.scrollIntoView(),a.push(this),10==a.length&&(addConstraintBtn.style.display="none")},remove:function(){this.parent.removeChild(this.solverConstraintElement);var t=a.indexOf(this);d.publish(p.Listener,u.UserAction.SOLVER.REMOVE_CONSTRAINT,{INDEX:t}),a.splice(t,1),9==a.length&&(addConstraintBtn.style.display="")},getOperator:function(){return i.zcombo(this.operator,"getValue")},initComponents:function(){i.initComponent(this.operator)}},r.Constraint=e}(this);
!function(e){function t(){var t={width:450,title:u["MenuItem.DataTab.GoalSeek"],close:function(){l()},open:function(){a()}};E||(o(),E=new e.ZSClass.Dialog(m,t),n()),E.open()}function o(){var t=e.UserAction.getTemplate(["goalSeekTemplate"]),o=t.goalSeekTemplate;m=document.createElement("div"),m.id="DI_GOALSEEK",m.className="gSd",m.appendChild(o),m.querySelector("#okBtn").addEventListener("click",function(){C.execute()}),m.querySelector("#cancelBtn").addEventListener("click",function(){E.close()})}function r(){E.close()}function a(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),o=s.view.getSheetID(e),r=s.view.getVersionID(e),a=s.data.getWorkBook(t,r),n=a.getSheetObj(o),i=n.Prop.getName(),l=s.view.getActiveState(e),c=l.getSheetState(o),d=c.getActiveCellRange(),u=d.getLabel();m.querySelector("#gsTargetCell").innerText=i+"."+u,m.querySelector("#gsTargetCell").focus()}function n(){var t=new S(m.querySelector("#gsTargetCell"),!0);g.RangePicker.register(t,!0,!0);var o=m.querySelector("#targetCellRange");g.RangePicker.Dialog.register(t,E,o,u["MenuItem.DataTab.GoalSeek"]+" - "+u["GoalSeek.UI.TargetCell"]),t.addListeners(D),f.animateLabel(t),f.addValidator(t,function(){return e.JSUtil.REGEXP.validCell.test(t.value)},function(){t.Editor.style.borderBottomColor="#dfdfdf"},function(){t.Editor.style.borderBottomColor="#ff8d00"},200);var r=new S(m.querySelector("#gsVariantCell"),!0);g.RangePicker.register(r,!0,!0);var a=m.querySelector("#variantCellRange");g.RangePicker.Dialog.register(r,E,a,u["MenuItem.DataTab.GoalSeek"]+" - "+u["GoalSeek.UI.VariantCell"]),r.addListeners(D),f.animateLabel(r),f.addValidator(r,function(){return e.JSUtil.REGEXP.validCell.test(r.value)},function(){r.Editor.style.borderBottomColor="#dfdfdf"},function(){r.Editor.style.borderBottomColor="#ff8d00"},200),f.animateLabel(new v(m.querySelector("#gsResult")))}function i(e){var t=e.keyCode||e.which;13===t&&(e.preventDefault(),r())}function l(){var t=s.view.getActiveGridID(),o=s.view.getResourceID(t),r=s.view.getVersionID(t),a=s.view.getSheetID(t);E.sheetID!=a&&e.UserAction.SwitchSheet(o,a,r,E.sheetID),m.querySelector("#gsVariantCell").innerText="",m.querySelector("#gsResult").innerText=""}var s=e.sPlusPlus,c=e.ZSEvents,d=(c.topic,c.Groups,c.Names,e.ZSConstants.FeatureConstants),u=(e.document,e.ZSConstants.I18N),g=(e.ZSConstants.wCC,e.ZSClass),S=g.Editors.RangeEditor,v=g.Editors.TextAreaEditor,f=g.Editors.Utility,C=(g.Range,e.UIUtil.Component,s.view.Toolbar.Feature[d.GOAL_SEEK]),E=void 0,m=void 0,D={keydown:i};C.openDialog=t,C.closeDialog=r}(this);
!function(e){function t(){var t=e.UserAction.getTemplate(["GoalSeekResponseTemplate"]).GoalSeekResponseTemplate;a=document.createElement("div"),a.id="DI_GOALSEEK_RESULT",a.className="gSd",a.appendChild(t),a.querySelector("#okBtn").addEventListener("click",o),a.querySelector("#clBtn").addEventListener("click",function(){l.close()});var n={modal:!0,width:350,title:w["MenuItem.DataTab.GoalSeek"],close:s,open:function(){}};l=new D.Dialog(a,n)}function n(e,n,i){l||t(),a.querySelector("#gsMessage").innerText=e,a.querySelector("#targetCellValue").innerText=n,a.querySelector("#gsResultVal").innerText=i,l.open()}function i(e,t,n,i,o){c=e,S=t,u=n,d=i,v=o}function o(){l.close();{var e=E.view.getActiveGridID();E.view.getSheetID(e)}UserAction.SubmitCell(c,u,S,v,d.startRow,d.startCol)}function s(){r()}function r(){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),n=E.view.getSheetID(e),i=E.view.getVersionID(e);p.publish(m.Listener,C.Layers.Preview.RemoveAll,{RID:t,SHEETID:n,VERSION:i})}var a,l,c,u,S,d,v,E=e.sPlusPlus,g=e.ZSEvents,p=g.topic,m=g.Groups,C=g.Names,I=e.ZSConstants.FeatureConstants,w=(e.document,e.ZSConstants.I18N),D=(e.ZSConstants.wCC,e.ZSClass),R=(D.Editors.RangeEditor,D.Editors.TextAreaEditor,D.Editors.Utility,D.Range,e.UIUtil.Component,E.view.Toolbar.Feature[I.GOAL_SEEK]);R.openResultDialog=n,R.initCopyParams=i}(this);
!function(t){function a(t,a,e){this.passage=t,this.options=a,this.delimiterString=e,this.characterKeyMap={}}var e=t.UserAction,r="~`!#^&*-_:;'?,| 	";a.prototype={setMaxLineLimit:function(t){this.lineLimit=t},detect:function(){this._clearCache(),this.passageArray=this.passage.trim().split("\n"),this.options.ignoreWhiteSpaces&&(this.passageArray=this.passageArray.replace(/ /g,""));for(var t=0,a=0;a<this.passageArray.length;a++){var e=this.passageArray[a].trim();if(!this.ignoreEmptyLines||""!=e){t++;for(var r=0;r<e.length;r++){if('"'==e[r])for(r+=1;'"'!=e[r]&&r<e.length;)r++;this._isSpecialCharacter(e[r])&&this._updateCharacterStack(e[r])}if(t==this.lineLimit)break}}var i=",",s=0;for(var h in this.characterKeyMap)this.characterKeyMap[h]>s&&(s=this.characterKeyMap[h],i=h);return i},getDelimiterList:function(){return this._clearCache(),this.detect(),this.characterKeyMap},getSplittedArray:function(t){for(var a="",e=[],r=[],i=0;i<this.passageArray.length;i++){var s=this.passageArray[i];r=[];for(var h=0;h<s.length;h++)a+=s[h],(-1!=t.indexOf(s[h])||h==s.length-1)&&(r.push(h==s.length-1?a:a.substr(0,a.length-1)),a="");e.push(r)}return e},_clearCache:function(){this.characterKeyMap={}},_isSpecialCharacter:function(t){return this.delimiterString?this.delimiterString.contains(t):r.contains(t)},_updateCharacterStack:function(t){this.characterKeyMap[t]||(this.characterKeyMap[t]=0),this.characterKeyMap[t]=this.characterKeyMap[t]+1}},e.DelimiterDetector=a}(this);
!function(e){function o(){var e={import:w.execute,importCancel:r,openDialog:i,closeDialog:r};s||(s=new m.ImportDialog(e),w.Dialog=s),s.open()}function t(e){var o={width:400,title:"Password Protected"};if(!l){var t=UserAction.getTemplate(["openImportPasswordDialogue"]),i=t.openImportPasswordDialogue,r=document.createElement("div");r.id=g.DI+p.IMPORT+g.IDENTITY,l=new m.Dialog(r,o),n(i),r.appendChild(i)}c=e,l.open()}function n(e){var o=e.querySelector("#ImportBtn"),t=e.querySelector("#CancelBtn"),n=e.querySelector("#SetPassword");o.addEventListener("click",function(){var e=document.querySelector("#SetPassword").value;w.importEncryptedAction(e,c)}),n.addEventListener("keydown",function(){w.hideWrongPasswordMessage()}),t.addEventListener("click",function(){l.close()})}function i(){}function r(){s&&s.close()}function a(){l&&l.close()}var s,c,l,u=e.sPlusPlus,d=e.ZSConstants,p=d.FeatureConstants,g=(e.document,d.I18N,d.wCC),m=e.ZSClass,v=e.ZSEvents,w=(v.Groups,v.Names,v.topic,u.view.Toolbar.Feature[p.IMPORT]);w.openDialog=o,w.closeDialog=r,w.openEncryptedDialog=t,w.closePasswordDialog=a}(this);
!function(e){function t(){var e=this.Dom;V||(e.querySelector("#importAsTemplate").disabled=!0,e.querySelector("#replaceSpreadsheet").disabled=!0,e.querySelector("#replaceCurrSheet").disabled=!0,e.querySelector("#insertSheets").disabled=!0,e.querySelector("#appendRows").disabled=!0,e.querySelector("#replaceData").disabled=!0)}function i(){A.zcombo(this.DOM.delimiter1,"setValue","Comma"),A.zcombo(this.DOM.delimiter2,"setValue","Comma"),this.DOM.customDelimiter1.value="",this.DOM.customDelimiter2.value="",this.DOM.customDelimiter1.style.display="none",this.DOM.customDelimiter2.style.display="none",this.DOM.delimiterContainer1.style.display="none",this.DOM.delimiterContainer2.style.display="none"}function r(){this.DOM.fileImportOpt.checked=!0,this.importOption="createNew",k.bind(this)(!1,!0),i.bind(this)()}function s(){this.DOM.fileImportOpt.checked=!0,n.call(this)}function o(){f.bind(this)(!0),this.callback.import.call(this)}function l(){d.bind(this)(!1),f.bind(this)(!1),O.bind(this)(!1),M.bind(this)(!1),m.bind(this)(!0),D.call(this)}function n(){l.call(this);var e=this.DOM.container.querySelector("#browseFile");this.isURLImport=this.DOM.urlImportOpt.checked;var t=this.DOM.container.querySelector("#importview_holder").style,i=this.DOM.fileUrl;this.DOM.fileUrl.value="";var r=this.DOM.fileUploadEl;this.isURLImport?(t.top="-150px",e.style.display="none",i.style.display="block",i.tabIndex=0,r.tabIndex=-1):(t.top="0px",e.style.display="block",i.style.display="none",i.tabIndex=-1,r.tabIndex=0),k.bind(this)(!1)}function a(){var e=this.dialog.Dom;this.DOM={container:e,fileUrl:e.querySelector("#xurl"),importBtn:e.querySelector("#import"),importBtnTxt:e.querySelector("#import").childNodes[1],fileUploadEl:e.querySelector("#content"),fileImportOpt:e.querySelector("#fileimport"),urlImportOpt:e.querySelector("#urlimport"),importOptions:e.querySelectorAll("input[name=importview]"),emsg:e.querySelector("#eMsg"),emsgs:e.querySelector("#eMsgs"),delimiterContainer1:e.querySelector("#delimiterContainer1"),delimiterContainer2:e.querySelector("#delimiterContainer2"),delimiter1:e.querySelector("#delimiter1"),delimiter2:e.querySelector("#delimiter2"),customDelimiter1:e.querySelector("#customDelimiter1"),customDelimiter2:e.querySelector("#customDelimiter2")},this.importOption="createNew",this.showErrorMsg=c,this.errorMsg="errorMsg1"}function c(e,t){f.bind(this)(!1),O.bind(this)(!1),this.isURLImport?D.call(this):(M.bind(this)(!1),m.bind(this)(!0)),t?h.bind(this)(!0):d.bind(this)(!0,e)}function d(e,t){e?(this.DOM.emsgs.style.display="none",this.DOM.emsg.style.display="block",this.DOM.emsg.classList.add("emsg"),this.DOM.emsg.innerText=t):(this.DOM.emsgs.style.display="block",this.DOM.emsg.style.display="none",this.DOM.emsg.classList.remove("emsg"))}function h(e){e?(this.DOM.container.querySelector("#"+this.errorMsg).style.display="",this.DOM.container.querySelector("#"+this.errorMsg).classList.add("emsg")):("errorMsg2"==this.errorMsg&&(this.DOM.container.querySelector("#"+this.errorMsg).style.display="none"),this.DOM.container.querySelector("#"+this.errorMsg).classList.remove("emsg"),this.errorMsg="errorMsg1")}function u(){{var e=this,t=this.DOM;this.isURLImport}if(t.fileImportOpt.onchange=t.urlImportOpt.onchange=n.bind(this),t.fileUploadEl.onchange=function(){e.fileAttach.bind(e)(t.fileUploadEl.files)},t.container.querySelector(".import-close").onclick=n.bind(this),t.container.querySelector("#close").onclick=this.callback.importCancel.bind(this),t.importBtn.onclick=o.bind(this),this.enableImportOptions)for(var i=0;i<t.importOptions.length;i++)p(e,t.importOptions[i]);else t.container.querySelector("#importOptions").style.display="none";t.fileUrl.oninput=function(){e.fileAttach.bind(e)(t.fileUploadEl.files)},t.container.querySelector("#importForm1").onsubmit=function(i){return e.fileAttach.bind(e)(t.fileUploadEl.files),i.stopPropagation(),!1};var r={valueChanged:function(){D.bind(e)(!1)}};this.url_editor.addListeners(r),this.url_editor.customPreventDefault=function(e){var t=e.keyCode||e.which;return!E.JSKeyCode.LEFTCOMMAND||t!=E.JSKeyCode.V&&t!=E.JSKeyCode.C&&t!=E.JSKeyCode.X?void 0:(e.stopPropagation(),!1)},A.bind(this.DOM.delimiter1,"zselectboxchange",function(t,i){"Custom"==i.value?(e.DOM.customDelimiter1.style.display="",e.DOM.customDelimiter1.focus()):e.DOM.customDelimiter1.style.display="none"}),A.bind(this.DOM.delimiter2,"zselectboxchange",function(t,i){"Custom"==i.value?(e.DOM.customDelimiter2.style.display="",e.DOM.customDelimiter2.focus()):e.DOM.customDelimiter2.style.display="none"})}function p(e,t){t.onchange=function(){w.bind(e)(t)}}function m(e,t){if(i.bind(this)(),e)this.DOM.container.querySelector(".filewrapper").style.border="1px dashed #ccc",this.DOM.container.querySelector("#browseFile").style.display="block",this.DOM.container.querySelector("#browseDetails").style.display="block",this.DOM.container.querySelector("#importLabel").style.display="none",this.DOM.container.querySelector("#content").value="",b.bind(this)(!1),S.bind(this)(!0);else{var r=this.DOM.container.querySelector("#importLabel");this.DOM.container.querySelector(".filewrapper").style.border="none",this.DOM.container.querySelector("#browseFile").style.display="none",this.DOM.container.querySelector("#browseDetails").style.display="none",r.style.display="block",r.innerText=t,I.bind(this)(t),M.bind(this)(!0)}}function y(e,t){i.bind(this)(),e?(this.DOM.container.querySelector("#browseDetails").style.display="block",this.DOM.container.querySelector(".importloadercnt").style.display="none",this.DOM.container.querySelector(".importloadersuccess").style.display="none",this.DOM.fileUrl.style.borderColor="#f26f7b"):(this.DOM.container.querySelector(".importloadercnt").style.display="block",this.DOM.container.querySelector(".importloadersuccess").style.display="block",this.DOM.fileUrl.style.borderColor="",I.bind(this)(t))}function D(){this.DOM.importBtn.disabled=!0,d.bind(this)(!1),h.bind(this)(!1),this.DOM.container.querySelector("#browseDetails").style.display="block",this.DOM.container.querySelector(".importloadercnt").style.display="none",this.DOM.fileUrl.style.borderColor=""}function b(e){e?(this.DOM.container.querySelector("#scell").style.display="block",this.DOM.container.querySelector("#startCell").focus()):this.DOM.container.querySelector("#scell").style.display="none"}function M(e){e?this.DOM.container.querySelector(".importView_browse").classList.add("importCancel"):this.DOM.container.querySelector(".importView_browse").classList.remove("importCancel")}function O(e){this.DOM.importBtn.disabled=e?!1:!0}function f(e){e?(this.DOM.importBtn.classList.add("ZsRt"),this.DOM.importBtnTxt.nodeValue=L["Indication.Importing"]):(this.DOM.importBtn.classList.remove("ZsRt"),this.DOM.importBtnTxt.nodeValue=L["Import.Button.Label"])}function S(e){this.DOM.container.querySelector("#csvNote").style.opacity=e?"1":"0"}function g(){var e=this.DOM.fileUrl.value,t=new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}(([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?)*");return t=t.test(e)&&v(e),t||(this.errorMsg="errorMsg2"),t}function q(e){var t=!0;return e>Math.pow(10,7)&&(t=!1,this.errorMsg="errorMsg2"),t}function v(e){var t=e.split(".").pop();return t=t.toLowerCase(),-1!==["xlsx","xls","xlsm","ods","sxc","csv","tsv"].indexOf(t)}function C(e){var t;if(e=e.split("\\").pop(),e.length>30){{e.split(".")}t=e.substr(0,20)+"..."+e.substr(e.length-7,e.length)}else t=e;return t}function w(e){var t=e.id;if(this.importOption=t,e.checked&&"replaceData"==e.id){var i=U.view.getActiveGridID(),r=U.view.getResourceID(i),s=U.view.getSheetID(i),o=U.view.getVersionID(i),l=U.data.getWorkBook(r,o),n=l.getSheetObj(s),a=n.Prop.getName(),c=U.view.getActiveState(i),d=c.getSheetState(s),h=d.getActiveCellRange(),u=h.getLabel(),p=this.DOM.container.querySelector("#startCell");z.startCellEditor.value=a+"."+u,p.focus(),b.bind(this)(!0)}else b.bind(this)(!1)}function I(e){var t="";void 0!=e&&(e=e.split("\\").pop(),t=e.split(".").pop()),t=t.toLowerCase(),"csv"==t||"tsv"==t?k.bind(this)(!0,!1,t):k.bind(this)(!1),this.format=t}function k(e,t,r){if(e&&V)this.DOM.container.querySelector("#replaceCurrSheet").disabled=!1,this.DOM.container.querySelector("#appendRows").disabled=!1,this.DOM.container.querySelector("#replaceData").disabled=!1,this.isURLImport?(this.DOM.delimiterContainer2.style.display="","tsv"==r?A.zcombo(this.DOM.delimiter2,"setValue","Tab"):A.zcombo(this.DOM.delimiter2,"setValue","Comma")):(this.DOM.delimiterContainer1.style.display="","tsv"==r?A.zcombo(this.DOM.delimiter1,"setValue","Tab"):A.zcombo(this.DOM.delimiter1,"setValue","Comma")),S.bind(this)(!1);else{if(this.DOM.container.querySelector("#replaceCurrSheet").disabled=!0,this.DOM.container.querySelector("#appendRows").disabled=!0,this.DOM.container.querySelector("#replaceData").disabled=!0,this.DOM.delimiterContainer1.style.display="",this.DOM.delimiterContainer2.style.display="",t){var s=this.DOM.container.querySelector("#createNew");s.checked=!0,S.bind(this)(!0),b.bind(this)(!1)}i.bind(this)()}}var U=e.sPlusPlus,x=e.ZSClass,E=(e.document,e.ZSConstants),L=E.I18N,R=(E.ActionConstants,x.Editors.RangeEditor,e.ZSConstants.JSKeyCode,x.Editors),A=(x.Editors.Utility,e.UIUtil.Component),T=U.data.UserInfo.Permission,V=T.isEditable,z=(UserAction.DelimiterDetector,function(e,t){this.callback=e,this.enableImportOptions=void 0==t?!0:t,this.init()});z.prototype={init:function(){var i=s.bind(this),o=r.bind(this),l={modal:!1,width:650,title:L["MenuItem.FileTab.Import"],close:function(){i()},open:function(){t.call(this),o()}},n=this.getDialogContent();this.dialog=new e.ZSClass.Dialog(n,l),this.initEditor(this.dialog,n),a.call(this),this.isURLImport=!1,u.call(this)},open:function(){this.dialog.open()},close:function(){this.dialog.close()},getDialogContent:function(){var t=e.UserAction.getTemplate(["importTemplate"]),i=t.importTemplate,r=document.createElement("div");return r.id="DI_IMPORT",r.appendChild(i),r},initEditor:function(e,t){var i=t.querySelector("#xurl");this.url_editor=new R.TextAreaEditor(i);var r=t.querySelector("#startCell"),s=new R.RangeEditor(r,!0);x.RangePicker.register(s,!0,!0);var o=r.nextElementSibling;x.RangePicker.Dialog.register(s,e,o,L["MenuItem.FileTab.Import"]),z.startCellEditor=s},fileAttach:function(e){var t,i,t,r=!1,s=this.isURLImport,o="",l="",n=this;s?(o=this.DOM.fileUrl.value,this.files=o,l=o.substring(o.lastIndexOf("/")+1),r=g.call(this),t=function(){y.bind(n)(!r,l)}):(this.files=e,l=C(e[0].name),i=e[0].size,r=v.bind(this)(l)&&q.bind(this)(i),t=function(){m.bind(n)(!r,l)}),r?t.call():this.showErrorMsg(this.errorMsg,!0),O.bind(this)(r)}};x.ImportDialog=z}(this);
!function(e){function t(e,t){var l=U.view.getActiveGridID(),a=U.view.getResourceID(l),s=U.view.getSelectedSheets(l),i=U.view.getSheetState(l,s[0]),r=i.getActiveRange(),n=U.view.getVersionID(l);Q.dataType(a,s,n,r,e,t)}function l(e,t,l,s){var i=U.view.getActiveGridID(),n=U.view.getResourceID(i),o=U.view.getSheetID(i),c=U.view.getSelectedSheets(i),d=s&&"EDIT"==s.mode?"CFormat.EditRule":"CFormat.CreateRule",h=k["CFormat.Classic"]+" - "+k[d],p={width:575,title:"Classic - "+h,dialogClass:"cfclassic",close:function(){u()}};if(!D){var m=Q.getTemplate(["classicTemplate"]).classicTemplate;L=M.createElement("div"),L.id="DI_CF_CLASSIC",L.appendChild(m),D=new Y.Dialog(L,p),r(n,c,U.view.getVersionID(i))}e=e||R,D.open(),D.setTitle(h),a(n,o,i,e,t,s,l),j=l}function a(e,t,l,a,s,i,r){{var n="rule"+ ++H,o=new E(n,a,s),c=U.view.getVersionID(l),u=U.data.getWorkBook(e,c),d=(u.getSheetObj(t),U.view.getSheetState(l,t));d.getActiveRange()}X.datarange.value="",X.datarange.focus();var h=d.getRanges();Y.RangePicker.setRanges(e,t,c,h),r&&i?(L.querySelector("#aR").style.display="none",N=i||void 0,o.setValues(N)):L.querySelector("#aR").style.display="block"}function s(){{var e="rule"+ ++H;new E(e,R)}$++,i()}function i(){W.sortable(L.querySelector("#classicRule"),{disabled:$>1?!1:!0})}function r(e,t,l){n(),c(L.querySelector("#appliestofieldcs"),"datarange"),L.querySelector("#addRule").addEventListener("click",s),L.querySelector("#classic_create").addEventListener("click",function(){p(e,t,l)}),L.querySelector("#classic_cancel").addEventListener("click",o),W.sortable(L.querySelector("#classicRule"),{axis:"y"})}function n(){var e=Q.getTemplate(["classicSingleRule"]).classicSingleRule,t=M.createElement("div");t.id="classicRule",t.appendChild(e),t=Q.renderJsTemplate(t.outerHTML,w);var l=new DOMParser,a=l.parseFromString(t,"text/html");q=a.getElementById("classicRule").children[0]}function o(){D.close()}function c(e,t){var l=new G.RangeEditor(e,!0);"formula"==e.id&&e.addEventListener("mousedown",function(e){e.stopPropagation()}),J.register(l);var a=e.nextElementSibling;Y.RangePicker.Dialog.register(l,D,a,k["Chart.Range.select"]),X[t]=l}function u(){R="",H=0,j&&V.publish(B.Listener,P.UserAction.CONDITIONAL_FORMAT.MANAGE,{isServerRequestNeed:K}),j=!1,K=!1,N="",$=0,W.destroyComponent(L.querySelector(".cFDrag")),X={datarange:X.datarange},L.querySelector(".cFDrag").innerHTML="",M.querySelectorAll(".classicTheme").forEach(function(e){e.remove()})}function d(e,t,l){var a=[];return l.replace(/,/g,";").split(";").forEach(function(l){a.push(JSUtil.Range.parseRange(e,t,l).range)}),a}function h(e,t){var l=e.valinp.errorMsg,a=k[""+l];-1===l.indexOf("DataVal.InputError")||t.cr_nu!==w.BETWEEN&&t.cr_nu!==w.NOT_BETWEEN||(a=k["DataVal.InputError2"]);var s="ANY_VALUE",i=JSUtil.fn.replaceParams(a,new Array(tt[s]));Y.ZSAlert(i,{title:k["Alert.Title.InvalidValueType"]})}function p(e,t,l){var a=v(),s=d(e,l,X.datarange.value.trim());a&&Q.CFValidation(e,t,s,l,a,"conditionalformat",m,h)}function m(e,t,l,a,s){N&&"EDIT"===N.mode&&(e.csuid=N.csuid),K=!0;var i=N&&"EDIT"==N.mode?"CONDITIONAL_FORMAT_EDIT":"CONDITIONAL_FORMAT_APPLY";Q.applyConditionalFormat(e,t,l,a,s,i,o)}function g(e,t,l){var a=l.split(";"),s=JSUtil.Range.parseRange(e,t,a[0]);return s?s.sheetID:D.sheetID}function v(){var e={};e.datarange=X.datarange.value.trim().replace(/,/g,";");var t=L.querySelector(".cFDrag").children,l=t.length;e.noofrules=l;for(var a=!0,s=1;l>=s;s++){var i=t[s-1],r=i.getAttribute("id"),n=i.querySelectorAll("select"),o=W.zcombo(n[0],"getValue"),c=i.querySelectorAll("DATE"==o?"#date input":"#cellValue input"),u=W.zcombo(n[0],"getAttribute","selectedIndex"),d="FORMULA"==o?-1:parseInt(W.zcombo(n[u+1],"getValue")),h=y(i.querySelector(".cFFrmtWidget").querySelector("ul"),!0);e["cr_ty"+s]=o,e["cstyle"+s]=h,e["cond"+s]=d,e["cval"+s]="FORMULA"==o?X[r].value:encodeURIComponent("DATE"==o?d<=w.NOT_EQUAL?UIUtil.Component.zdatetimefield("#date3","getValue").dateString:UIUtil.Component.zdatetimefield("#date1","getValue").dateString+";"+UIUtil.Component.zdatetimefield("#date2","getValue").dateString:d<=w.NOT_EQUAL||"TEXT"==o?c[2].value:c[0].value+";"+c[1].value),"%3B"!=e["cval"+s]||"CELL"==o||(a=!1)}return a?(e.asn=g(D.rID,D.version,e.datarange),e):void Y.ZSAlert(k["CFormat.FieldsBlank"],{title:k["Alert.Title.EnterValue"]})}function y(e,t){var l=[],a=e.querySelector(".shCellBG").style.borderBottomColor,s=e.querySelector(".shTxtBg").style.borderBottomColor;return l.push("transparent"==a?"":a),l.push("transparent"==s?"":s),l.push(e.querySelector(".shBold").parentElement.classList.contains("active")),l.push(e.querySelector(".shItalic").parentElement.classList.contains("active")),l.push(e.querySelector(".shUndrLine").parentElement.classList.contains("active")?"single":"none"),l.push(e.querySelector(".shStrThr").parentElement.classList.contains("active")),t?l.join("~"):l}function f(e){var t=new Date(e);return e?t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear():""}function S(e){var t=e.split("/");return t[2]+"-"+t[0]+"-"+t[1]}function T(e,t,a){R="number"===e?"ANY_VALUE":e.toUpperCase(),t&&"9"==t?R="TEXT":t&&"4"==t?R="FORMULA":!t||"33"!=t&&"34"!=t||(R="CELL"),l(R,t,a)}function E(e,t,l){this.id=e,this.value=t,this.type=l,this.create()}function I(e,t,l){var a="";return l.forEach(function(e){a+=new Y.Range(e.startRow,e.startCol,e.endRow,e.endCol).getLabel()+";"}),a.substring(0,a.length-1)}function b(){var e="MM",t="yyyy",l=e+"/dd/"+t;return"MDY"===at&&(l=e+lt+"dd"+lt+t),"DMY"===at&&(l="dd"+lt+e+lt+t),"YMD"===at&&(l=t+lt+e+lt+"dd"),l}function C(e,t){lt=e,at=t}function A(e,t){st=e,it=t}var L,D,q,N,R,U=e.sPlusPlus,O=e.ZSConstants,F=O.FeatureConstants,w=O.ConditionalFormatClassicOperator,M=(O.ActionConstants,e.document),_=e.ZSConstants.wCC,k=e.ZSConstants.I18N,x=e.ZSEvents,V=x.topic,B=x.Groups,P=x.Names,z=(e.ZSConstants,U.view.Toolbar.Feature[F.CF_CLASSIC]),W=(U.SML.Client,e.UIUtil.Component),Y=e.ZSClass,G=Y.Editors,J=Y.RangePicker,Q=e.UserAction,Z=M.getElementById("popupmenu"),X={},H=0,j=!1,K=!1,$=1,et={};et.theme1=["rgb(155, 222, 180)","rgb(37, 150, 80)","false","false","none","false"],et.theme2=["rgb(248, 205, 207)","rgb(231, 72, 77)","false","false","none","false"],et.theme3=["rgb(248, 245, 203)","rgb(140, 132, 28)","false","false","none","false"],et.theme4=["rgb(209, 232, 251)","rgb(48, 123, 187)","false","false","none","false"],et.theme5=["rgb(246, 217, 186)","","false","false","none","false"],et.theme6=["rgb(194, 232, 230)","","false","false","none","false"],et.theme7=["rgb(255, 255, 255)","rgb(0, 0, 0)","true","false","none","false"],et.theme8=["rgb(255, 255, 255)","rgb(45, 133, 210)","true","false","none","false"],et.theme9=["rgb(255, 255, 255)","rgb(0, 0, 0)","false","false","none","true"],et.theme10=["rgb(255, 255, 255)","rgb(232, 80, 86)","false","false","none","true"],et.clearTheme=["transparent","transparent","false","false","none","false"];var tt={DECIMAL:k["CFormat.Decimal"].toLowerCase(),WHOLENUMBER:k["CFormat.WholeNumber"].toLowerCase(),TEXT_LENGTH:k["CFormat.TextLength"].toLowerCase(),DATE:k["Filter.date"].toLowerCase(),ANY_VALUE:k.Number.toLowerCase(),TIME:k.Time.toLowerCase(),DATETIME:k.DateTime.toLowerCase()};E.prototype={create:function(){this.template=q.cloneNode(!0),this.template.setAttribute("id",this.id),L.querySelector(".cFDrag").appendChild(this.template),this.appendAttributes()},appendAttributes:function(){var e=this;this.previewElem=this.template.querySelector(".cFPrv"),this.selectTags=this.template.querySelectorAll("select"),this.doColorPickerChanges(),this.selectTags[0].setAttribute("id","rulesCombo"+H),this.selectTags[1].setAttribute("id","anyvalueCombo"+H),this.selectTags[2].setAttribute("id","textCombo"+H),this.selectTags[3].setAttribute("id","dateCombo"+H),this.selectTags[4].setAttribute("id","cellCombo"+H),this.bindEvents(),W.initComponent(this.template),this.selectTags.forEach(function(t,l){setTimeout(function(){W.bind(t,"zselectboxchange",function(){0===l?e.setCombo(H):e.getListItems(H)})},100)}),W.zcombo(this.selectTags[0],"setValue",this.value),this.setCombo()},doColorPickerChanges:function(){["#date1","#date2","#date3"].forEach(function(e){W.zdatetimefield(e,"setAttribute","locale",st+"-"+it)})},bindEvents:function(){var e=this,t=this.template.querySelector(".cFFrmtWidget").querySelector("ul").querySelectorAll("li");t.forEach(function(t){t.addEventListener("click",function(){var l=t.classList;l.contains("active")?l.remove("active"):l.add("active"),e.changePreview(e.previewElem)})}),this.template.querySelector(".shClear").addEventListener("click",function(){e.loadThemeInDialog(et.clearTheme)});var l=this.template.querySelectorAll(".cP1");l.forEach(function(t){t.setAttribute("data",'{"pickerOptions":{"nocolorbutton":false}, "value":"#000000"}'),t.setAttribute("data-ctype","zcolorchooser"),t.setAttribute("data-picker-id","sheet-colorpicker"),W.bind(t,"zcolorchooserchange",function(l,a){t.style.borderBottom="3px solid #"+a.color,e.changePreview(e.previewElem)})}),this.template.querySelector(".cFClose").onclick=this.delete.bind(this),c(this.template.querySelector("#formula"),this.id),this.addThemeInPreview()},addThemeInPreview:function(){var e=this;this.classicThemeMenu=Q.getTemplate(["classicQuickTheme"]).classicQuickTheme.children[0],this.classicThemeMenu.id=_.DIALOGSUBMENUITEM+F.CF_CLASSIC+_.IDENTITY+"_"+H,Z.appendChild(this.classicThemeMenu),this.previewElem.setAttribute("data-menu-id",_.DIALOGSUBMENUITEM+F.CF_CLASSIC+_.IDENTITY+"_"+H),this.classicThemeMenu.querySelectorAll("li").forEach(function(t){t.addEventListener("click",function(){var l=t.getAttribute("theme");e.loadThemeInDialog(et[l])})}),W.bind(this.classicThemeMenu,"zmenubeforeshow",function(){e.checkTheme(this)}),Z.appendChild(this.classicThemeMenu)},changePreview:function(e){var t=y(this.template.querySelector(".cFFrmtWidget").querySelector("ul"),!0).split("~"),l="";l+="background-color:"+t[0]+";",l+="color:"+t[1]+";",l+="true"==t[2]?"font-weight:bold;":"",l+="true"==t[3]?"font-style:italic;":"",("single"==t[4]||"true"==t[5])&&(l+="single"==t[4]&&"false"==t[5]?"text-decoration:underline;":"none"==t[4]?"text-decoration:line-through;":"text-decoration:line-through underline;"),e.setAttribute("style",l)},loadThemeInDialog:function(e){this.template.querySelector(".shCellBG").style.borderBottomColor=e[0],this.template.querySelector(".shTxtBg").style.borderBottomColor=e[1],"true"==e[2]?this.template.querySelector(".shBold").parentElement.classList.add("active"):this.template.querySelector(".shBold").parentElement.classList.remove("active"),"true"==e[3]?this.template.querySelector(".shItalic").parentElement.classList.add("active"):this.template.querySelector(".shItalic").parentElement.classList.remove("active"),"single"==e[4]?this.template.querySelector(".shUndrLine").parentElement.classList.add("active"):this.template.querySelector(".shUndrLine").parentElement.classList.remove("active"),"true"==e[5]?this.template.querySelector(".shStrThr").parentElement.classList.add("active"):this.template.querySelector(".shStrThr").parentElement.classList.remove("active"),this.changePreview(this.previewElem)},checkTheme:function(e){e.querySelector(".active").classList.remove("active");var t=this.getStyle(this.previewElem),l=!1;for(var a in et)if(t.toString()==et[a].toString()){e.querySelector("[theme="+a+"]").classList.add("active"),l=!0;break}l?"block"==e.querySelector("#custom").style.display&&(et.CUSTOM=this.getStyle(e.querySelector("#custom"))):(et.CUSTOM=t,e.querySelector("#custom").style.display="block",e.querySelector("#custom").classList.add("active"),this.changePreview(e.querySelector("#custom"))),e.querySelector("#custom").style.display=et.CUSTOM?"block":"none"},getStyle:function(e){var t=[];return t.push(e.style.backgroundColor),t.push(e.style.color),t.push("bold"==e.style.fontWeight?"true":"false"),t.push("italic"==e.style.fontStyle?"true":"false"),t.push(-1!=e.style.textDecoration.indexOf("underline")?"single":"none"),t.push(-1!=e.style.textDecoration.indexOf("line-through")?"true":"false"),t},setCombo:function(){this.valueIndex=W.zcombo(this.selectTags[0],"getAttribute","selectedIndex"),2==this.valueIndex?(this.template.querySelector("#cellValue").style.display="none",this.template.querySelector("#date").style.display="block"):(this.template.querySelector("#cellValue").style.display="block",this.template.querySelector("#date").style.display="none");var e=5!==this.valueIndex?this.valueIndex+1:void 0;this.showProperValueCombo(e)},showProperValueCombo:function(e){var t=this;this.selectTags.forEach(function(l,a){if(0!=a)if(a===e&&5!=e){var s=W.zcombo(l,"getElement");s.style.display="block",t.type?(W.zcombo(l,"setValue",t.type),t.type=""):W.zcombo(l,"setAttribute","selectedIndex",0)}else{var s=W.zcombo(l,"getElement");s.style.display="none"}}),this.getListItems()},getListItems:function(){this.singleInput=this.template.querySelector("2"==this.valueIndex?"#date #singleInput":"#singleInput"),this.doubleInput=this.template.querySelector("2"==this.valueIndex?"#date #doubleInput":"#doubleInput");var e=this.selectTags[this.valueIndex+1],t=W.zcombo(e,"getValue");4===this.valueIndex||t<=w.NOT_EQUAL||t>=w.TEXT_CONTAINING&&t<=w.TEXT_ENDINGWITH?(this.singleInput.style.display="block",this.doubleInput.style.display="none",2!==this.valueIndex&&(this.singleInput.children[0].style.display=4===this.valueIndex?"none":"block",this.singleInput.children[1]&&(this.singleInput.children[1].style.display=4===this.valueIndex?"block":"none"))):t==w.BETWEEN||t==w.NOT_BETWEEN?(this.singleInput.style.display="none",this.doubleInput.style.display="block"):(this.singleInput.style.display="none",this.doubleInput.style.display="none")},setValues:function(e){switch(this.loadThemeInDialog(e.cstyle1.split("~")),X.datarange.value=e.datarange,this.type=e.cond1,this.value){case"ANY_VALUE":parseInt(this.type)<=w.NOT_EQUAL?this.singleInput.querySelector("input").value=e.cval1[0]:(parseInt(this.type)==w.BETWEEN||parseInt(this.type)==w.NOT_BETWEEN)&&(this.doubleInput.querySelectorAll("input")[0].value=e.cval1[0],this.doubleInput.querySelectorAll("input")[1].value=e.cval1[1]);break;case"DATE":parseInt(this.type)<=w.NOT_EQUAL?W.zdatetimefield("#date3","setValue",e.cval1[0]):(parseInt(this.type)==w.BETWEEN||parseInt(this.type)==w.NOT_BETWEEN)&&(W.zdatetimefield("#date1","setValue",e.cval1[0]),W.zdatetimefield("#date2","setValue",e.cval1[1]));break;case"TEXT":this.singleInput.querySelector("input").value=e.cval1[0];break;case"FORMULA":X[this.id].value=e.cval1[0]}},delete:function(){$--,L.querySelector(".cFDrag").removeChild(this.template),i()}};var lt,at,st,it;z.quickAction=t,V.register(B.Listener,P.UserAction.CONDITIONAL_FORMAT.FIND_DATA_TYPE,T,"DATA_TYPE","CR_TYPE","MANAGE_REQ"),V.register(B.Listener,P.UserAction.CONDITIONAL_FORMAT.CLASSIC,l,"value","type","isManageReq","ruleObj"),V.register(B.Listener,P.UserAction.CONDITIONAL_FORMAT.FIND_CLASSIC,t,"type","isManageReq"),e.JSUtil.CFUtils.getDateFormat=f,e.JSUtil.CFUtils.setDateFormat=S,e.JSUtil.CFUtils.getRangeList=d,e.JSUtil.Range.findASN=g,e.JSUtil.Range.getDateFormats=b,e.JSUtil.Range.getRangesInString=I,V.register(B.Listener,P.DocMeta.DOCUMENT_LOCALE,C,"DATE_SEPARATOR","LOCALE_DATEFORMAT"),V.register(B.Listener,P.DocMeta.DOCUMENT_LOCALE,A,"LANGUAGE","COUNTRY")}(this);
!function(e){function t(e,t){e=e||j.GREEN_WHITE;var o="EDIT"==e.mode?"CFormat.EditRule":"CFormat.CreateRule",i=U["CFormat.ColorScale"]+" - "+U[o],a={width:570,title:i,dialogClass:"clScale",close:function(){s()},open:function(){}};if(!M){var c=G.getTemplate(["conditonalFormatTemplate"]).conditonalFormatTemplate;N=O.createElement("div"),N.id="DI_CONDTIONAL_FORMATTING",N.appendChild(c),M=new z.Dialog(N,a),r(),n()}setTimeout(function(){l(e)},0),M.open(),M.setTitle(i),Z=t}function o(){var e=O.createElement("ul");e.mtype="submenu",e.id=R.DIALOGSUBMENUITEM+L.COLOR_SCALE+R.IDENTITY;var t=G.getTemplate(["colorscaleSubMenu"]).colorscaleSubMenu;e.appendChild(t),e.querySelector("#customDialog").remove(),e.querySelectorAll(".theme").forEach(function(e){e.addEventListener("click",function(){u(j[e.getAttribute("theme")])})}),x.bind(e,"zmenubeforeshow",function(){this.querySelector("#custom").style.display="none",i(this)}),H.appendChild(e)}function i(e){e.querySelector(".active").classList.remove("active");var t=C(),o=!1;for(var i in j)if(JSON.stringify(t).toLowerCase()==JSON.stringify(j[i]).toLowerCase()){e.querySelector("[theme="+i+"]").classList.add("active"),o=!0;break}if(o)j.CUSTOM&&(e.querySelector("#custom").style.display="block");else{j.CUSTOM=t,e.querySelector("#custom").style.display="block";var r=2==t.noofcond?B.getGradientColor(t.cs_c1,t.cs_c2,7):B.getGradientColor(t.cs_c1,t.cs_c2,t.cs_c3,7);e.querySelector("#classicPreview").style.backgroundImage=S(r),e.querySelector("#classicPreview").classList.add("active")}}function r(){for(var e=G.getTemplate(["csRuleTemplate"]).csRuleTemplate,t=N.querySelectorAll(".dspTblRow .csSet"),i=1;V>=i;i++){var r=e.cloneNode(!0),n=new I(r,i);t[i-1].appendChild(n.container)}a(),o(),f(["#appliestofieldcs","#value1","#value2","#value3"])}function n(){var e=M.getKeyContext(),t=e.keyDown;t[q.ENTER]=function(){E()}}function a(){N.querySelector("#cs_createBtn").addEventListener("click",E),N.querySelector("#cs_cancelBtn").addEventListener("click",c),N.querySelector("#colorScalePreview").setAttribute("data-menu-id",R.DIALOGSUBMENUITEM+L.COLOR_SCALE+R.IDENTITY),N.querySelector("#hideCellContent").addEventListener("change",K),N.querySelector("#autoTextColor").addEventListener("change",K("autoTextColor"))}function c(){M.close()}function l(e){{var t=A.view.getActiveGridID(),o=A.view.getResourceID(t),i=A.view.getSheetID(t),r=A.view.getVersionID(t),n=A.data.getWorkBook(o,r),a=(n.getSheetObj(i),A.view.getSheetState(t,i));a.getActiveRange()}if(X[0].value="",X[0].focus(),"EDIT"==e.mode)T=e,X[0].value=e.datarange;else{var c=a.getRanges();z.RangePicker.setRanges(o,i,r,c)}u(e)}function s(){Z&&_.publish(w.Listener,k.UserAction.CONDITIONAL_FORMAT.MANAGE,{isServerRequestNeed:J}),T="",Z=!1,J=!1}function u(e){for(var t=e.noofcond,o=1,i=1;t>=o;o++,i++)2===t&&2==o?(UIUtil.Component.zcolorselectbox("#input"+i,"setValue","transparent"),x.zcombo("#type"+i,"setValue","NONE"),X[i].value=d(i,"NONE"),v(i),i++):p(i),"MINIMUM"==e["cr_ty"+o]||"MAXIMUM"==e["cr_ty"+o]?v(i):p(i),X[i].value="MINIMUM"===e["cr_ty"+o]?"(Lowest value)":"MAXIMUM"===e["cr_ty"+o]?"(Highest value)":e["cval"+o],x.zcombo("#type"+i,"setValue",e["cr_ty"+o]),UIUtil.Component.zcolorselectbox("#input"+i,"setValue",e["cs_c"+o]);e.mode&&(N.querySelector("#hideCellContent").checked=e.hcc,N.querySelector("#autoTextColor").checked=e.atc),h()}function d(e,t){var o;switch(e){case"minpoint":case 1:o="NUMBER"===t||"PERCENT"===t?"0":"FORMULA"===t?"=":"PERCENTILE"===t?"10":"(Lowest value)";break;case"midpoint":case 2:o="NONE"===t?"":"PERCENTILE"===t||"PERCENT"===t?"50":"FORMULA"===t?"=":"0";break;case"maxpoint":case 3:o="NUMBER"===t?"0":"FORMULA"===t?"=":"PERCENTILE"===t?"90":"PERCENT"===t?"100":"(Highest value)"}return o}function v(e){var t=N.querySelector("#value"+e);t.classList.add("zsDisable");var o=N.querySelector("#input"+e);o.previousElementSibling.classList.add("zsDisable"),2==e&&(UIUtil.Component.zcolorselectbox(o,"disable"),y("input2","transparent")),X[e].disable()}function p(e){var t=N.querySelector("#value"+e);t.classList.remove("zsDisable");var o=N.querySelector("#input"+e);o.previousElementSibling.classList.remove("zsDisable"),2==e&&UIUtil.Component.zcolorselectbox(o,"enable"),X[e].enable()}function C(){for(var e={},t=0,o=1;V>=o;o++){t++,2==o&&"NONE"===N.querySelector("#type2").value&&o++;var i=N.querySelector("#type"+o).value;e["cr_ty"+t]=i,e["cval"+t]="MAXIMUM"===i||"MINIMUM"===i?"":X[o].value,e["cs_c"+t]=zoho.color.rgbToHex(m("input"+o))}return e.noofcond=t,e.noofrules=1,e}function g(){var e=C();return e.istheme=!1,e.hcc=N.querySelector("#hideCellContent").checked,e.atc=N.querySelector("#autoTextColor").checked,e.datarange=X[0].value.replace(/,/g,";"),e.asn=JSUtil.Range.findASN(M.rID,M.version,e.datarange),T&&"EDIT"==T.mode&&(e.csuid=T.csuid,e.cs_type=T.cs_type),e}function h(){var e="NONE"===x.zcombo("#type2","getValue")?!0:!1,t=7,o=e?B.getGradientColor(m("input1"),m("input3"),t):B.getGradientColor(m("input1"),m("input2"),m("input3"),t),i=S(o);N.querySelector("#colorScalePreview").style.backgroundImage=i}function S(e){for(var t="linear-gradient(to right, ",o=100/e.length,i=0;i<e.length;i++)t+=e[i]+" "+Math.round(o*i)+"% ,"+e[i]+" "+Math.round(o*(i+1))+"%, ";return t.substring(0,t.lastIndexOf(","))+")"}function m(e){var t=UIUtil.Component.zcolorselectbox("#"+e,"getElement")[0];return t.querySelector("canvas").style.backgroundColor}function y(e,t){x.zcolorselectbox("#"+e,"setValue",t)}function f(e){N.querySelectorAll(".ZsRangeIco");e.forEach(function(e){var t=N.querySelector(e),o=new P.RangeEditor(t,!0);F.register(o);var i=t.nextElementSibling;z.RangePicker.Dialog.register(o,M,i,U["Chart.Range.select"]),X.push(o)})}function E(){var e=g(),t=A.view.getActiveGridID(),o=A.view.getResourceID(t),i=A.view.getSelectedSheets(t),r=A.view.getVersionID(t),n=JSUtil.CFUtils.getRangeList(M.rID,M.version,X[0].value.trim());G.CFValidation(o,i,n,r,e,"colorscales",b)}function b(e,t,o,i,r){J=!0;var n=T&&"EDIT"==T.mode?"CONDITIONAL_FORMAT_EDIT":"COLOR_SCALES_APPLY";G.applyConditionalFormat(e,t,o,i,r,n,c)}function I(e,t){this.container=e,this.id=t,this.criteria=1==this.id?"minpoint":2==this.id?"midpoint":"maxpoint",this.addAttributes()}var T,N,M,A=e.sPlusPlus,L=e.ZSConstants.FeatureConstants,O=e.document,R=e.ZSConstants.wCC,U=e.ZSConstants.I18N,q=e.ZSConstants.JSKeyCode,D=e.ZSEvents,_=D.topic,w=D.Groups,k=D.Names,x=(A.SML.Client,e.UIUtil.Component),z=e.ZSClass,P=z.Editors,F=z.RangePicker,G=e.UserAction,B=JSUtil.fn,V=3,Z=!1,J=!1,X=[],H=O.getElementById("popupmenu"),Y=A.view.Toolbar.Feature[L.COLOR_SCALE],j=e.ZSConstants.ColorscaleTheme,K=function(){N.querySelector("#hideCellContent").checked?N.querySelector("#autoTextColor").parentNode.classList.add("zsDisable"):N.querySelector("#autoTextColor").parentNode.classList.remove("zsDisable")};I.prototype={addAttributes:function(){this.container.querySelector(".zsEditor").setAttribute("id","value"+this.id),this.container.querySelector(".cP").setAttribute("id","input"+this.id),this.removeOptions(),this.selectTag.setAttribute("id","type"+this.id),this.selectTag.setAttribute("action",this.criteria),this.selectTag.setAttribute("set",this.id),this.bindColorpallete()},removeOptions:function(){var e=this;this.selectTag=this.container.querySelector("select");var t=O.createElement("option");t.value="minpoint"==this.criteria?"MINIMUM":"midpoint"==this.criteria?"NONE":"MAXIMUM",t.text="midpoint"==this.criteria?"None":"Automatic";var o="midpoint"==this.criteria?4:0;this.selectTag.add(t,o),x.bind(this.selectTag,"zselectboxchange",function(t,o){e.setComboAction(o.value)})},bindColorpallete:function(){{var e=this.container.querySelector(".cP");e.getAttribute("id")}e.setAttribute("data",'{"pickerOptions":{"defaultColorButton":false, "noColorButton":false}}'),e.setAttribute("data-ctype","zcolorselectbox"),x.bind(e,"zcolorselectboxselect",function(){setTimeout(function(){h()},10)})},setComboAction:function(e){var t=d(this.criteria,e);X[this.id].value=t,"midpoint"!==this.criteria||"rgba(0, 0, 0, 0)"!==m("input2")&&"transparent"!==m("input2")||(y("input2",B.getGradientColor(m("input1"),m("input3"),3)[1]),h()),"NONE"==e||"MINIMUM"==e||"MAXIMUM"==e?v(this.id):p(this.id)}},_.register(w.Listener,k.UserAction.CONDITIONAL_FORMAT.COLORSCALE,t,"ruleObj","isManageReq"),Y.openDialog=t}(this);
!function(e){function t(e,t){nt=bt.view.getActiveGridID(),ot=bt.view.getResourceID(nt),rt=bt.view.getVersionID(nt),at=bt.view.getSelectedSheets(nt),ct=bt.view.getSheetID(nt),it=bt.view.getSheetState(nt,ct),lt=it.getActiveRow(),ut=it.getActiveCol(),Q=t,J||n(),J.open()}function n(){var t=Tt.getTemplate(["FORMAT_CELLS"]);X=t.FORMAT_CELLS,mt=X.querySelector("#formatPreview"),dt=X.querySelector("#codePreview"),st=X.querySelector("#customFrmtCombo"),ft=X.querySelector("#customFrmtInput");var n={width:660,dialogClass:"fmcell",title:yt.FormatCells,open:g};v(),y(),D(),B=pt.createElement("div"),B.id=Lt.DI+At.FORMATCELLS+Lt.IDENTITY,B.appendChild(X),J=new e.ZSClass.Dialog(B,n),C(),e.dialogWrapper=B,e.dialogObject=J}function o(){gt.bind("#negativeFormatNumbers","zselectboxchange",xt.float),gt.bind("#decimalPlacesNumber","znumberfieldchange",xt.float),gt.bind("#decimalPlacesNumber","znumberfieldspinend",xt.float),gt.bind("#leadingZeroNumber","znumberfieldchange",xt.float),gt.bind("#leadingZeroNumber","znumberfieldspinend",xt.float),B.querySelector("#thousandSeperatorNumber").addEventListener("change",xt.float)}function r(){gt.bind("#currencySymbol","zselectboxchange",function(){xt.currency(),zt=!0}),gt.bind("#negativeFormatCurrency","zselectboxchange",xt.currency),gt.bind("#decimalPlacesCurrency","znumberfieldchange",xt.currency),gt.bind("#decimalPlacesCurrency","znumberfieldspinend",xt.currency),gt.bind("#leadingZeroCurrency","znumberfieldchange",xt.currency),gt.bind("#decimalPlacesCurrency","znumberfieldspinend",xt.currency),B.querySelector("#thousandSeperatorCurrency").addEventListener("change",xt.currency)}function a(){gt.bind("#currencySymbolAcc","zselectboxchange",function(){xt.accounting(),Ot=!0}),gt.bind("#decimalPlacesCurrencyAcc","znumberfieldchange",xt.accounting),gt.bind("#decimalPlacesCurrencyAcc","znumberfieldspinend",xt.accounting),gt.bind("#leadingZeroCurrencyAcc","znumberfieldchange",xt.accounting),gt.bind("#decimalPlacesCurrencyAcc","znumberfieldspinend",xt.accounting),B.querySelector("#thousandSeperatorCurrencyAcc").addEventListener("change",xt.accounting)}function c(){gt.bind("#dateFormatCombo","zselectboxchange",xt.datetime),gt.bind("#timeFormatCombo","zselectboxchange",xt.datetime)}function i(){gt.bind("#durationFormatCombo","zselectboxchange",xt.duration)}function l(){gt.bind("#percentageFormatSpinner","znumberfieldchange",xt.percentage),gt.bind("#percentageFormatSpinner","znumberfieldspinend",xt.percentage)}function u(){B.querySelector("#fractionFormatCombo");gt.bind("#fractionFormatCombo","zselectboxchange",xt.fraction)}function m(){gt.bind("#scientificFormatSpinner","znumberfieldchange",xt.scientific),gt.bind("#scientificFormatSpinner","znumberfieldspinend",xt.scientific)}function d(){var e=B.querySelector("#regionalFrmtCombo");e.addEventListener("change",xt.regional),gt.bind("#regionalFrmtCountryCombo","zselectboxchange",function(){ht=!0,xt.regional()}),gt.bind("#regionalFrmtCombo","zselectboxchange",function(){xt.regional()})}function s(){var e={formatType:"CUSTOM"};return-1==st.selectedIndex?(e.frmtAction="saveAndApplyCustomFormats",e.format=encodeURIComponent(ft.value)):(e.frmtAction="submit",e.format=encodeURIComponent(st.value)),e}function f(){ft.addEventListener("focus",function(){}),ft.addEventListener("keydown",function(e){var t=e.which;13==t&&(p(),T(),e.stopPropagation())}),st.addEventListener("change",function(){var e=this.value,t={formatType:"CUSTOM",frmtAction:"generate"};t.format=encodeURIComponent(e),Tt.FORMATCELLS_CLIENT(ot,at,rt,t,function(e){V(e.format.preview,e.format.formatcode,e.format.color)})})}function C(){for(var e=B.querySelectorAll("#tabList li"),t=0;t<e.length;t++)e[t].addEventListener("click",L.bind(e[t]));o(),r(),a(),c(),i(),l(),u(),m(),d(),f(),B.querySelector("#okBtn").addEventListener("click",p),B.querySelector("#cancelBtn").addEventListener("click",T),B.querySelector("#manageFrmt").addEventListener("click",b)}function b(){Ft.publish(Rt.UI,Nt.Toolbar.FORMAT.OPEN_MANAGEFORMAT,{RID:ot,SHEETLIST:at,VERSION:rt})}function p(){var e=W.getAttribute("name");switch(e){case"general":Mt.GENERAL(ot,at,rt);break;case"float":var t=gt.zcombo("#negativeFormatNumbers","getValue"),n=B.querySelector("#thousandSeperatorNumber").checked,o=gt.zspinner("#decimalPlacesNumber","getValue"),r=gt.zspinner("#leadingZeroNumber","getValue"),a=tt;Mt.FLOAT(ot,at,rt,t,n,o,r,a);break;case"currency":Tt.FORMATCELLS_GRID(ot,at,rt,null,null,k());break;case"accounting":Tt.FORMATCELLS_GRID(ot,at,rt,null,null,w());break;case"datetime":x()?Tt.FORMATCELLS_GRID(ot,at,rt,null,null,Z()):ZSClass.ZSAlert("both can't be none");break;case"duration":Tt.FORMATCELLS_GRID(ot,at,rt,null,null,Y());break;case"percentage":var c=gt.zspinner("#percentageFormatSpinner","getValue");Mt.PERCENTAGE(ot,at,rt,c,tt);break;case"fraction":var i=B.querySelector("#fractionFormatCombo").value;Mt.FRACTION(ot,at,rt,i);break;case"scientific":var c=gt.zspinner("#scientificFormatSpinner","getValue");Mt.SCIENTIFIC(ot,at,rt,c,tt);break;case"text":Mt.TEXT(ot,at,rt);break;case"regional":var l=gt.zcombo("#regionalFrmtCountryCombo","getValue"),u=B.querySelector("#regionalFrmtCombo").value;Mt.REGIONAL(ot,at,rt,l,u);break;case"custom":-1==st.selectedIndex?Tt.FORMATCELLS_CLIENT(ot,at,rt,s(),function(e){"FormatSupported"==e.cusFrmtStatus?Tt.FORMATCELLS_GRID(ot,at,rt,null,null,s()):ZSClass.ZSAlert("Invalid format")}):Tt.FORMATCELLS_GRID(ot,at,rt,null,null,s())}}function g(){setTimeout(S,500)}function T(){J.close()}function E(){I(),F(),R(),N(),h(),z(),O(),M(),U()}function S(){E();var t="general";if(Q){var n=B.querySelector("#tabList [name='"+Q+"']");return void L.call(n)}var o=function(e){var n=e[lt][ut].Pattern;if(!Et.Object.isEmpty(n)){var o=n[vt.FORMATTYPE];t=o.toLowerCase(),("date"==t||"time"==t)&&(t="datetime"),"string"==t&&(t="text"),"custom"==t&&(Ct=n[vt.FORMATSTRING]),A(n)}var r=B.querySelector("#tabList [name='"+t+"']");L.call(r)},r=function(n){e.ZSClass.Logger.log(" couldn't retrieve data from cell  ",n);var o=B.querySelector("#tabList [name='"+t+"']");L.call(o)};bt.view.fetchCellData(ot,at,rt,lt,ut,["Pattern"],nt,o,r)}function A(t){var n=t[vt.FORMATTYPE];switch(n){case"FLOAT":I(t[vt.NEGATIVEFRMT],t[vt.DECIMALS],t[vt.LEADINGZEROES],t[vt.ISGROUPINGUSED]);break;case"CURRENCY":F(t[vt.SYMBOL],t[vt.NEGATIVEFRMT],t[vt.DECIMALS],t[vt.LEADINGZEROES],t[vt.ISGROUPINGUSED]);break;case"ACCOUNTING":R(t[vt.SYMBOL],t[vt.DECIMALS],t[vt.LEADINGZEROES],t[vt.ISGROUPINGUSED]);break;case"DATETIME":case"DATE":case"TIME":"DATETIME"==n?N(e.decodeURIComponent(t[vt.DATEFMRT].replace(/\+/g," ")),e.decodeURIComponent(t[vt.TIMEFMRT].replace(/\+/g," "))):"DATE"==n?N(e.decodeURIComponent(t[vt.DATEFMRT].replace(/\+/g," ")),"none"):N("none",e.decodeURIComponent(t[vt.TIMEFMRT].replace(/\+/g," ")));break;case"DURATION":h(e.decodeURIComponent(t[vt.TIMEFMRT].replace(/\+/g," ")));break;case"CUSTOM":break;case"REGIONAL":U(t[vt.LANGUAGE]+"("+t[vt.COUNTRY]+")",t[vt.REGIONALTYPE]);break;case"SCIENTIFIC":M(t[vt.DECIMALS]);break;case"FRACTION":O(t[vt.FRACTION_DIGITS])}}function v(){function e(e){for(var n=0;n<t.length;n++)if(t[n].KEY==e)return t[n]}for(var t=bt.data.AppRegistry.localeInfo.CURRENCY_LIST,n=bt.data.AppRegistry.localeInfo.POPULAR_CURRENCY_LIST,o=X.querySelector("#popularCurr"),r=X.querySelector("#currList"),a=X.querySelector("#popularCurrAcc"),c=X.querySelector("#currListAcc"),i=0;i<n.length;i++){var l=e(n[i]),u=pt.createElement("option");u.value=l.KEY,u.innerText=l.CURRENCY+" ("+l.LANGUAGE+", "+l.COUNTRY+")",o.appendChild(u),a.appendChild(u.cloneNode(!0))}for(var i=0;i<t.length;i++){Ut[t[i].KEY]=t[i].COUNTRY;var u=pt.createElement("option");u.value=t[i].KEY,u.innerText=t[i].CURRENCY+" ("+t[i].LANGUAGE+", "+t[i].COUNTRY+")",r.appendChild(u),c.appendChild(u.cloneNode(!0))}}function y(){for(var e=X.querySelector("#regionalFrmtCountryCombo"),t=bt.data.AppRegistry.localeInfo.REGIONAL_LIST,n=0;n<t.length;n++){var o=pt.createElement("option");o.value=t[n],o.innerText=Ut[t[n]],e.appendChild(o)}}function L(){if(W){var e=W.getAttribute("name");if(t==e)return;W.className="",B.querySelector("#"+e+"Content").style.display="none"}var t=this.getAttribute("name");this.className="active",B.querySelector("#"+t+"Content").style.display="",W=this,xt[t]()}function I(e,t,n,o){gt.zcombo("#negativeFormatNumbers","setAttribute","selectedIndex",void 0!=e?e:0),gt.zspinner("#decimalPlacesNumber","setValue",void 0!=t?t:2),gt.zspinner("#leadingZeroNumber","setValue",void 0!=n?n:1),B.querySelector("#thousandSeperatorNumber").checked=void 0!=o?o:!1}function F(e,t,n,o,r){gt.zcombo("#currencySymbol","setValue",void 0!=e?e:tt),gt.zcombo("#negativeFormatCurrency","setAttribute","selectedIndex",void 0!=t?t:0),gt.zspinner("#decimalPlacesCurrency","setValue",void 0!=n?n:2),gt.zspinner("#leadingZeroCurrency","setValue",void 0!=o?o:1),B.querySelector("#thousandSeperatorCurrency").checked=void 0!=r?r:!0}function R(e,t,n,o){gt.zcombo("#currencySymbolAcc","setValue",void 0!=e?e:tt),gt.zspinner("#decimalPlacesCurrencyAcc","setValue",void 0!=t?t:2),gt.zspinner("#leadingZeroCurrencyAcc","setValue",void 0!=n?n:1),B.querySelector("#thousandSeperatorCurrencyAcc").checked=void 0!=o?o:!0}function N(e,t){void 0!=e?gt.zcombo("#dateFormatCombo","setValue",e):gt.zcombo("#dateFormatCombo","setAttribute","selectedIndex",0),void 0!=t?gt.zcombo("#timeFormatCombo","setValue",t):gt.zcombo("#timeFormatCombo","setAttribute","selectedIndex",0)}function h(e){void 0!=e?gt.zcombo("#durationFormatCombo","setValue",e):gt.zcombo("#durationFormatCombo","setAttribute","selectedIndex",0)}function z(e){gt.zspinner("#percentageFormatSpinner","setValue",void 0!=e?e:2)}function O(e){var t=B.querySelector("#fractionFormatCombo");t.selectedIndex=void 0!=e?e-1:0}function M(e){UIUtil.Component.zspinner("#scientificFormatSpinner","setValue",void 0!=e?e:2)}function U(e,t){void 0!=e&&bt.data.AppRegistry.localeInfo.REGIONAL_LIST[e]?gt.zcombo("#regionalFrmtCountryCombo","setValue",e):bt.data.AppRegistry.localeInfo.REGIONAL_LIST[tt]?gt.zcombo("#regionalFrmtCountryCombo","setValue",tt):gt.zcombo("#regionalFrmtCountryCombo","setAttribute","selectedIndex",0);B.querySelector("#regionalFrmtCombo");void 0!=t?gt.zcombo("#regionalFrmtCombo","setValue",t):gt.zcombo("#regionalFrmtCombo","setAttribute","selectedIndex",0)}function x(){var e=gt.zcombo("#dateFormatCombo","getValue"),t=gt.zcombo("#timeFormatCombo","getValue");return!("none"==e&&"none"==t)}function P(e){var t=e.USERLEVELCUSTOMFORMATS,n=e.ISENCODED,o=B.querySelector("#noCustom");if(t.length>0){st.innerHTML="",o.style.display="none",st.style.display="block";for(var r=t.length,a=0;r>a;a++){var c=pt.createElement("option"),i=n?decodeURIComponent(t[a]):t[a];c.value=i,c.textContent=n?decodeURIComponent(t[a]):t[a],decodeURIComponent(Ct)===i&&(c.selected=!0,xt.customPreview(t[a])),st.appendChild(c)}}else st.style.display="none",o.style.display="block"}function V(e,t,n){mt.innerText=e,dt.innerText=decodeURIComponent(t).replace(/\+/g," "),mt.style.color=n?n:"#000"}function q(e){var t=e.format.regional,n=Object.keys(t),o=B.querySelector("#regionalFrmtCombo");o.innerHTML="";for(var r=0;r<n.length;r++){var a=n[r],c=t[a],i=pt.createElement("option");i.value=a,i.innerText=c,o.appendChild(i)}}function G(e){var t=e.format.datetimepatterns,n=t.datePatterns,o=t.timePatterns,r=t.durationPatterns,a=B.querySelector("#durationFormatCombo"),c=B.querySelector("#dateFormatCombo"),i=B.querySelector("#timeFormatCombo");a.innerHTML="",c.innerHTML="",i.innerHTML="";for(var l=0;l<r.length;l++){var u=pt.createElement("option"),m=decodeURIComponent(r[l].replace(/\+/g," "));u.value=m,u.innerText=m,a.appendChild(u),gt.zcombo(a,"refresh")}for(var l=0;l<n.length;l++){var u=pt.createElement("option");u.value=n[l],u.innerText=n[l],c.appendChild(u),gt.zcombo(c,"refresh")}for(var l=0;l<o.length;l++){var u=pt.createElement("option");u.value=o[l],u.innerText=o[l],i.appendChild(u),gt.zcombo(i,"refresh")}}function _(e){var t=B.querySelector("#negativeFormatCurrency"),n=t.options,o=e.format;n[0].innerText=o.firstoption,n[1].innerText=o.secondoption,n[2].innerText=o.thirdoption,n[3].innerText=o.fourthoption,n[4].innerText=o.fifthoption}function D(){var e={formatType:"REGIONAL",format:"undefined",language:"en(US)",frmtAction:"generate"},t={formatType:"DATETIME",format:"M/d/yy HH:mmk",language:tt,frmtAction:"generate"},n={formatType:"CURRENCY",negFrmt:"0",thousandsep:"true",decimals:"2",leadingzeroes:"1",language:tt,symbol:tt,frmtAction:"generate"};Tt.FORMATCELLS_CLIENT(ot,at,rt,t,G),Tt.FORMATCELLS_CLIENT(ot,at,rt,e,q),Tt.FORMATCELLS_CLIENT(ot,at,rt,n,_)}function k(){return{formatType:"CURRENCY",frmtAction:"generate",negFrmt:gt.zcombo("#negativeFormatCurrency","getValue"),thousandsep:B.querySelector("#thousandSeperatorCurrency").checked,decimals:gt.zspinner("#decimalPlacesCurrency","getValue"),leadingzeroes:gt.zspinner("#leadingZeroCurrency","getValue"),language:tt,symbol:gt.zcombo("#currencySymbol","getValue")}}function w(){return{formatType:"ACCOUNTING",frmtAction:"generate",thousandsep:B.querySelector("#thousandSeperatorCurrencyAcc").checked,decimals:gt.zspinner("#decimalPlacesCurrencyAcc","getValue"),leadingzeroes:gt.zspinner("#leadingZeroCurrencyAcc","getValue"),language:tt,symbol:gt.zcombo("#currencySymbolAcc","getValue")}}function Z(){var e,t=gt.zcombo("#dateFormatCombo","getValue"),n=gt.zcombo("#timeFormatCombo","getValue"),o="";return"none"==t?(e="TIME",o=n):"none"==n?(o=t,e="DATE"):(o=t+" "+n,e="DATETIME"),{formatType:e,frmtAction:"generate",format:o,language:tt}}function Y(){var e=gt.zcombo("#durationFormatCombo","getValue");return{formatType:"TIME",frmtAction:"generate",format:encodeURIComponent(e)}}function H(e,t){$=e,et=t,tt=$+"("+et+")"}function K(){return tt}function j(){t()}var B,J,X,W,Q,$,et,tt,nt,ot,rt,at,ct,it,lt,ut,mt,dt,st,ft,Ct,bt=e.sPlusPlus,pt=e.document,gt=e.UIUtil.Component,Tt=(e.ZSConstants.JSKeyCode,e.UserAction),Et=e.JSUtil,St=e.ZSConstants,At=St.FeatureConstants,vt=St.CommandConstants,yt=St.I18N,Lt=St.wCC,It=e.ZSEvents,Ft=It.topic,Rt=It.Groups,Nt=It.Names,ht=!1,zt=!1,Ot=!1,Mt=bt.view.Toolbar.Feature[At.FORMATCELLS],Ut={},xt={};xt.general=function(){Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.GENERAL_PARAMS(),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.float=function(){var e=gt.zcombo("#negativeFormatNumbers","getValue"),t=B.querySelector("#thousandSeperatorNumber").checked,n=gt.zspinner("#decimalPlacesNumber","getValue"),o=gt.zspinner("#leadingZeroNumber","getValue"),r=tt;Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.FLOAT_PARAMS(e,t,n,o,r),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.currency=function(){Tt.FORMATCELLS_CLIENT(ot,at,rt,k(),function(e){if(V(e.format.preview,e.format.formatcode,e.format.color),zt){var t=B.querySelector("#negativeFormatCurrency"),n=t.options,o=e.format;n[0].innerText=o.firstoption,n[1].innerText=o.secondoption,n[2].innerText=o.thirdoption,n[3].innerText=o.fourthoption,n[4].innerText=o.fifthoption,gt.zcombo(t,"refresh"),zt=!1}})},xt.accounting=function(){Tt.FORMATCELLS_CLIENT(ot,at,rt,w(),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.datetime=function(){x()&&Tt.FORMATCELLS_CLIENT(ot,at,rt,Z(),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.duration=function(){Tt.FORMATCELLS_CLIENT(ot,at,rt,Y(),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.percentage=function(){var e=gt.zspinner("#percentageFormatSpinner","getValue");Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.PERCENTAGE_PARAMS(e,tt),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.fraction=function(){var e=B.querySelector("#fractionFormatCombo").value;Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.FRACTION_PARAMS(e),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.scientific=function(){var e=gt.zspinner("#scientificFormatSpinner","getValue");Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.SCIENTIFIC_PARAMS(e,tt),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.text=function(){Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.TEXT_PARAMS(),function(e){V(e.format.preview,e.format.formatcode,e.format.color)})},xt.regional=function(){var e=gt.zcombo("#regionalFrmtCountryCombo","getValue"),t=B.querySelector("#regionalFrmtCombo").value;Tt.FORMATCELLS_CLIENT(ot,at,rt,Mt.REGIONAL_PARAMS(e,t),function(e){if(V(e.format.preview,e.format.formatcode,e.format.color),ht){var t=B.querySelector("#regionalFrmtCombo"),n=e.format.regional;t.innerHTML="";for(var o=Object.keys(n),r=0;r<o.length;r++){var a=o[r],c=n[a],i=pt.createElement("option");i.value=a,i.innerText=c,t.appendChild(i)}gt.zcombo("#regionalFrmtCombo","refresh"),gt.zcombo("#regionalFrmtCombo","setAttribute","selectedIndex",0),ht=!1}})},xt.custom=function(){ft.focus();var e={formatType:"CUSTOM",frmtAction:"readCustomFormats"};Tt.FORMATCELLS_CLIENT(ot,at,rt,e,P)},xt.customPreview=function(e){var t={formatType:"CUSTOM",format:e,frmtAction:"generate"};Tt.FORMATCELLS_CLIENT(ot,at,rt,t,function(e){V(e.format.preview,e.format.formatcode)})},Ft.register(Rt.Listener,Nt.DocMeta.DOCUMENT_LOCALE,H,"LANGUAGE","COUNTRY"),Mt.openDialog=t,Mt.LOCALE=K,Mt.Callshortcut=j}(this);
!function(t){function e(t,e,i){c=t,p=e,h=i,u||s(),u.open()}function s(){F=S.createElement("span"),F.className="ZsLoader";var e=T.getTemplate(["MANAGE_FORMAT"]),s=e.MANAGE_FORMAT,o={width:750,dialogClass:"fmcell",title:M.FormatCells,open:r};m=S.createElement("div"),m.id=E.DI+"ManageFormat"+E.IDENTITY,m.appendChild(s),i(),y=m.querySelector("#valueInput"),C=m.querySelector("#custFormatList"),u=new t.ZSClass.Dialog(m,o)}function i(){m.querySelector("#fCloseDlg").addEventListener("click",a),m.querySelector("#addBtn").addEventListener("click",n),m.querySelector("#addApplyBtn").addEventListener("click",l)}function o(){u.close()}function r(){C.appendChild(F);var t={formatType:"CUSTOM",frmtAction:"readCustomFormats"};T.FORMATCELLS_CLIENT(c,p,h,t,function(t){C.removeChild(F),C=m.querySelector("#custFormatList");var e=m.querySelector("#custFormatList"),s=t.USERLEVELCUSTOMFORMATS;if(s&&s.length>0){e.innerText="",e.removeAttribute("style");for(var i=0;i<s.length;i++){var o=new d(s[i]);U.push(o),C.appendChild(o.dom)}}else e.setAttribute("style","text-align:center;line-height: 265px"),e.innerText="0 "+M["FormatCells.CustomFormats"]})}function a(){C.innerHTML="",U=[],I.openDialog(null,"custom")}function n(){var t=y.value;if(t){var e={formatType:"CUSTOM",frmtAction:"saveCustomFormats",format:t};T.FORMATCELLS_CLIENT(c,p,h,e,function(t){if(t.CUSTOMFORMAT){var e=m.querySelector("#custFormatList");e.hasAttribute("style")&&(e.innerText="",e.removeAttribute("style"));var s=new d(t.CUSTOMFORMAT);C.appendChild(s.dom),U.push(s)}else if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var i=M["FormatCells.CustomFormat.AlertMessage"];L(i,q)}},I.UpdateCustomFormats.bind(this,U))}else{var s=M["FormatCells.CustomFormat.AlertMessage"];L(s,q)}}function l(){var t=y.value;if(t){var e={formatType:"CUSTOM",frmtAction:"saveAndApplyCustomFormats",format:t};T.FORMATCELLS_CLIENT(c,p,h,e,function(t){var s=t.cusFrmtStatus;if("FormatNotSupported"==s){var i=M["FormatCells.CustomFormat.AlertMessage"];L(i,q)}else"FormatSupported"==s&&(o(),T.FORMATCELLS_GRID(c,p,h,null,null,e))},I.UpdateCustomFormats.bind(this,U))}else{var s=M["FormatCells.CustomFormat.AlertMessage"];L(s,q)}}function d(t){this.value=decodeURIComponent(t),this.init()}var m,u,c,p,h,C,F,y,v=t.sPlusPlus,S=t.document,T=(t.UIUtil.Component,t.UserAction),A=(t.JSUtil,t.ZSConstants),f=A.FeatureConstants,M=(A.CommandConstants,A.I18N),E=A.wCC,L=t.ZSClass.ZSAlert,O=t.ZSEvents,N=O.topic,R=O.Groups,g=O.Names,I=v.view.Toolbar.Feature[f.FORMATCELLS],U=[],q={title:M["Alert.Title.InvalidFormatCode"]};d.prototype={init:function(){var t=T.getTemplate(["MANAGE_FORMAT_LIST"]);this.dom=S.createElement("li"),this.dom.appendChild(t.MANAGE_FORMAT_LIST),this.displayName=this.dom.querySelector("#roCustName"),this.displayName.innerText=this.value,this.viewMode=this.dom.querySelector("#viewAction"),this.input=this.dom.querySelector("#rwCustName"),this.input.value=this.value,this.input.style.display="none",this.editMode=this.dom.querySelector("#editAction"),this.editMode.style.display="none",this.bindEvents()},bindEvents:function(){this.dom.querySelector("#rwCustName").addEventListener("keydown",function(){}),this.dom.querySelector("#deleteCustFrmt").addEventListener("click",this.deleteFormat.bind(this)),this.dom.querySelector("#editCustFrmt").addEventListener("click",this.editFormat.bind(this)),this.dom.querySelector("#updateCustFrmt").addEventListener("click",this.updateFormat.bind(this)),this.dom.querySelector("#cancelCustFrmt").addEventListener("click",this.cancelEdit.bind(this))},editFormat:function(){this.viewMode.style.display="none",this.displayName.style.display="none",this.editMode.style.display="",this.input.style.display=""},deleteFormat:function(){this.dom.parentNode.removeChild(this.dom);for(var t=U.indexOf(this),e=0;e<U.length;e++)t==e&&U.splice(t,1);var s={formatType:"CUSTOM",frmtAction:"deleteCustomFormats",index:t};T.FORMATCELLS_CLIENT(c,p,h,s,null,I.UpdateCustomFormats.bind(this,U));var i=m.querySelector("#custFormatList"),o=i.querySelectorAll("li");if(0==o.length){var r=m.querySelector("#custFormatList");r.setAttribute("style","text-align:center;line-height: 265px"),r.innerText="0 "+M["FormatCells.CustomFormats"]}},updateFormat:function(){var t=U.indexOf(this),e=this.input.value;if(e){var s={formatType:"CUSTOM",frmtAction:"updateCustomFormats",index:t,format:e};T.FORMATCELLS_CLIENT(c,p,h,s,function(t){if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var e=M["FormatCells.CustomFormat.AlertMessage"];L(e,q)}else this.displayName.style.display="",this.displayName.innerText=decodeURIComponent(t.CUSTOMFORMAT),this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none"}.bind(this),I.UpdateCustomFormats.bind(this,U))}else{var i=M["FormatCells.CustomFormat.AlertMessage"];L(i,q)}},cancelEdit:function(){this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none",this.displayName.style.display="",y.value=""}},N.register(R.UI,g.Toolbar.FORMAT.OPEN_MANAGEFORMAT,e,"RID","SHEETLIST","VERSION")}(this);
!function(e){function t(e,t){var o=h.view.getActiveGridID(),l=h.view.getResourceID(o),i=h.view.getSheetID(o),r=h.view.getVersionID(o);e=e||P[x.ARROWS3];var c="EDIT"==e.mode?"CFormat.EditRule":"CFormat.CreateRule",a=D["CFormat.IconSets"]+" - "+D[c],s={width:570,title:a,dialogClass:"icSet",close:function(){C()},open:function(){}};if(!q){var u=M.getTemplate(["iconSetTemplate"]).iconSetTemplate;I=N.createElement("div"),I.id="DI_CF_ICONSET",I.appendChild(u),q=new U.Dialog(I,s),n()}setTimeout(function(){S(l,i,r,e)},0),q.open(),q.setTitle(a),Z=t}function n(){var e=M.getTemplate(["allIcons"]).allIcons;e.querySelectorAll("li").forEach(function(e){e.addEventListener("click",function(){b.classList=e.querySelector("span").classList[0],m(s())})}),L.appendChild(e.children[0]),I.querySelectorAll(".iCSelectBox.wd50").forEach(function(e){e.addEventListener("click",function(){b=this.querySelector("span"),e.setAttribute("data-menu-id","iconSetIcons")})}),o(),d(),y(["appliestofield","value1","value2","value3","value4"]),I.querySelector(".iCSelectBox.wd150").setAttribute("data-menu-id",w.DIALOGSUBMENUITEM+A.ICON_SET+w.IDENTITY),I.querySelector("#applyIconset").addEventListener("click",function(){r()}),I.querySelector("#cancelBtn").addEventListener("click",l)}function o(){var e=I.querySelectorAll("select");e.forEach(function(e){setTimeout(function(){F.bind("#"+e.id,"zselectboxchange",function(t,n){i(e.getAttribute("action"),n.value,parseInt(e.getAttribute("set")))})},0)})}function l(){q.close()}function i(e,t,n){var o,l=I.querySelector("#set"+(n+1)).querySelector(".flt_left.mr5.mt5"),i=I.querySelectorAll(".iCSelectBox.wd150 .mr5").length;switch(e){case"symbol":var r="gt"==t?"> ":">= ";o=r+G["value"+n].value;break;case"value":var o="Formula";if("FORMULA"!=t){var t=G["value"+n].value,c=g(t);if(c){var a=(parseInt(t),t.length);a>=9?(o=t.substring(0,6)+"...",l.setAttribute("title",t)):(o=t,l.removeAttribute("title"))}}o=("gt"==F.zcombo("#cd"+n,"getValue")?"> ":">= ")+o}o+=i==n+1?"":" and",l.innerText=o}function r(){var e=a(),t=h.view.getActiveGridID(),n=h.view.getResourceID(t),o=h.view.getSelectedSheets(t),l=h.view.getVersionID(t),i=JSUtil.CFUtils.getRangeList(q.rID,q.version,G.appliestofield.value.trim());M.CFValidation(n,o,i,l,e,"iconset",c)}function c(e,t,n,o,i){V=!0;var r=T&&"EDIT"==T.mode?"CONDITIONAL_FORMAT_EDIT":"ICON_SET_APPLY";M.applyConditionalFormat(e,t,n,o,i,r,l)}function a(){var e=s();return e.istheme=!1,e.hcc=I.querySelector("#hdCellConten").checked,e.rio=I.querySelector("#RvIconOrder").checked,e.dis=I.querySelector("#kpDfltSize").checked,e.noofrules=1,e.datarange=G.appliestofield.value.replace(/,/g,";"),e.asn=JSUtil.Range.findASN(q.rID,q.version,e.datarange),e.iconSetName=u(e),T&&"EDIT"==T.mode&&(e.csuid=T.csuid,e.cs_type=T.cs_type),e}function s(){for(var e={},t=I.querySelectorAll(".iCSelectBox.wd150 .mr5").length,n=t,o=t;o>=1;o--){if("table-row"===I.querySelector("#set"+o).style.display){1!=n&&(e["cr_ty"+n]=F.zcombo("#valueTypes"+(o-1),"getValue"),e["cval"+n]=G["value"+(o-1)].value,e["is_c"+n]=F.zcombo("#cd"+(o-1),"getValue"));var l=I.querySelector("#set"+o).querySelector(".iCSelectBox.wd50 span").className.replace("iS-","");e["icon_name"+n]=-1===l.indexOf("None")?l.slice(0,-1):"None",e["icon_id"+n]="None"!==l?l.slice(-1):-1}n--}return e.noofcond=t,e}function u(e){for(var t in P){var n=t,o=P[t];if(e.noofcond===o.noofcond){for(var l=!0,t=1;t<=e.noofcond;t++)(e["icon_id"+t]!=o["icon_id"+t]||e["icon_name"+t]!=o["icon_name"+t])&&(l=!1);if(l)return n}}return"custom"}function d(){var e=N.createElement("ul");e.mtype="submenu",e.className="icTypes",e.id=w.DIALOGSUBMENUITEM+A.ICON_SET+w.IDENTITY;var t=M.getTemplate(["iconsetTable"]).iconsetTable;t.querySelector(".icCustomMenu").style.display="none",e.appendChild(t),e.querySelectorAll("li").forEach(function(e){e.addEventListener("click",function(){p(P[e.getAttribute("type")])})}),F.bind(e,"menubeforeshow",function(){}),L.appendChild(e)}function S(e,t,n,o){{var l=h.data.getWorkBook(e,n),i=(l.getSheetObj(t),h.view.getSheetState(h.view.getActiveGridID(),t));i.getActiveRange()}if(G.appliestofield.value="",G.appliestofield.focus(),"EDIT"==o.mode)T=o,G.appliestofield.value=o.datarange;else{var r=i.getRanges();U.RangePicker.setRanges(e,t,n,r)}p(o)}function y(e){e.forEach(function(e){var t=I.querySelector("#"+e),n=new z.RangeEditor(t,!0);n.addListeners(W),B.register(n);var o=t.nextElementSibling;U.RangePicker.Dialog.register(n,q,o,D["Chart.Range.select"]),G[e]=n})}function v(e){var t=e.keyCode||e.which;13===t&&(e.preventDefault(),r())}function p(e){for(var t=(I.querySelectorAll(".iCSelectBox.wd150 .mr5").length,e.noofcond?e.noofcond:Object.keys(e).length/5),n=t,o=1;j>=o;o++)if(o>t)I.querySelector("#set"+o).style.display="none";else{if(0!==t||e.mode){if(I.querySelector("#set"+o).style.display="table-row",F.zcombo("#cd"+o,"setValue",e["is_c"+(o+1)]?e["is_c"+(o+1)]:"gteq"),G["value"+o]&&(G["value"+o].value=e["cval"+(o+1)]||""),F.zcombo("#valueTypes"+o,"setValue",e["cr_ty"+(o+1)]),o>1){var l=o-1,i="gt"==F.zcombo("#cd"+l,"getValue")?">":">=",r=G["value"+l].value,c=g(r),a="FORMULA"!==F.zcombo("#valueTypes"+l,"getValue")&&c?r:"Formula",s=o===t?i+" "+a:i+" "+a;I.querySelector("#set"+o).querySelector(".flt_left.mr5.mt5").innerText=o!==t?s+" and ":s+""}if(I.querySelector("#cd"+o))if(o===t){var u=F.zcombo("#cd"+o,"getElement");u.style.display="none",I.querySelector("#inputVal"+o).style.display="none",u=F.zcombo("#valueTypes"+o,"getElement"),u.style.display="none"}else{I.querySelector("#inputVal"+o).style.display="";var u=F.zcombo("#cd"+o,"getElement");u.style.display="table",u=F.zcombo("#valueTypes"+o,"getElement"),u.style.display="table"}}I.querySelector("#set"+n).querySelector(".iCSelectBox.wd50 span").className=f(e["icon_name"+n],e["icon_id"+n]),n--}I.querySelector("#RvIconOrder").checked=e.rio,I.querySelector("#hdCellConten").checked=e.hcc,I.querySelector("#kpDfltSize").checked=e.dis,m(e)}function f(e,t){return-1==t?"iS-None":J[e+t]?J[e+t]:"iS-"+e+t}function m(e){var t=u(e),n=I.querySelector(".iCSelectBox.wd150");if("custom"!=t){n.querySelector("#custom").style.display="none",n.querySelector("#iconsSpans").style.display="block";for(var o=n.querySelector("#iconsSpans").children,l=1;j>=l;l++){var i=o[l-1];i.className="table-row"===I.querySelector("#set"+l).style.display?I.querySelector("#set"+l).querySelector(".iCSelectBox.wd50 span").className+" mr5":""}}else n.querySelector("#custom").style.display="block",n.querySelector("#iconsSpans").style.display="none"}function g(e){var t=new RegExp("^[-]?[0-9]*[.][0-9]*$"),n=new RegExp("^[-]?[0-9]*$");return t.test(e)||n.test(e)?!0:!1}function C(){Z&&O.publish(R.Listener,k.UserAction.CONDITIONAL_FORMAT.MANAGE,{isServerRequestNeed:V}),T="",Z=!1,V=!1}var I,q,T,b,h=e.sPlusPlus,E=e.ZSConstants,A=E.FeatureConstants,N=(e.ZSConstants.ConditionalFormatClassicOperator,e.ZSConstants.ActionConstants,e.document),w=e.ZSConstants.wCC,D=e.ZSConstants.I18N,_=e.ZSEvents,O=_.topic,R=_.Groups,k=_.Names,L=N.getElementById("popupmenu"),F=(h.SML.Client,e.UIUtil.Component),U=e.ZSClass,x=e.ZSConstants.IconSetConstants,z=U.Editors,B=U.RangePicker,M=e.UserAction,V=!1,Z=!1,G={},P=e.ZSConstants.IconSetTheme,J=e.ZSConstants.classNameMap,j=5,Y=h.view.Toolbar.Feature[A.ICON_SET],W={keydown:v};O.register(R.Listener,k.UserAction.CONDITIONAL_FORMAT.ICONSET,t,"ruleObj","isManageReq"),e.JSUtil.CFUtils.getIconClassName=f,e.JSUtil.CFUtils.isNumber=g,Y.openDialog=t}(this);
!function(e){function t(e){var t=R.view.getActiveGridID(),r=R.view.getVersionID(t),i=R.view.getResourceID(t),n={width:545,title:"Conditional Formatting - Manage Rules",dialogClass:"cfmanage"};if(!N){var o=Y.getTemplate(["cf_manage"]).cf_manage;v=M.createElement("div"),v.id="DI_CF_MANAGE",v.appendChild(o),N=new G.Dialog(v,n),a(i)}v.querySelector("#cf_range").parentNode.style.display="none",e&&c(i,r),N.open()}function a(e){H.initComponent(v),_=v.querySelector("#manage_container");var t=v.querySelector("#cf_range");f=new W.RangeEditor(t,!0),x.register(f,!0),v.querySelectorAll("#selRule").forEach(function(t,a){H.bind(t,"zselectboxchange",function(t,r){l(a,r.value,e)})}),v.querySelectorAll("#filterRule").forEach(function(t){H.bind(t,"zselectboxchange",function(t,a){s(a.value,e)})}),H.sortable(_,{axis:"y",stop:function(t,a){var r=a.item[0],i=a.item.index();o(e,r,i)}}),y=Y.getTemplate(["cf_manage_rule"]).cf_manage_rule.children[0],S=Y.getTemplate(["csToolTip"]).csToolTip.children[0],u(),C(),F=Y.getTemplate(["iconSetTitle"]).iconSetTitle.children[0],v.querySelector("#addNewRule").setAttribute("data-menu-id","addNewRules"),v.querySelector("#manage_close").addEventListener("click",i);var a=v.querySelector(".ZsRangeIco");G.RangePicker.Dialog.register(f,N,a,P["Chart.Range.select"]),r()}function r(){var e=!0,t={valueChanged:function(){e&&(e=!1,setTimeout(function(){d(Z.range,N.rID),e=!0},500))}};f.addListeners(t)}function i(){N.close()}function n(){var e=Y.getTemplate(["addRules"]).addRules,t=M.createElement("ul");t.appendChild(e),t.querySelectorAll("li").forEach(function(e){e.addEventListener("click",function(){b(e.getAttribute("id"))})}),Q.appendChild(t.children[0])}function o(e,t,a){var r={},i=t.getAttribute("asn");r.asn=i,r.csuid=t.getAttribute("csuid");for(var n=K[t.getAttribute("csuid")].datarange,o=_.querySelectorAll(".cFMng"),s=a-1;s>=0;s--)if(i==o[s].getAttribute("asn")){var c={};c.csuid=_.children[s].getAttribute("csuid"),r.to=c;break}var l=R.view.getActiveGridID(),d=R.view.getVersionID(l),u=R.data.getWorkBook(e,d),C=R.view.getSheetID(l),h=sPlusPlus.view.getSelectedSheets(l),m=u.getSheetObj(C).Prop.Name;Y.reordeRules(e,C,h,d,m,r,n)}function s(e){for(var t=_.children,a=0;a<t.length;a++)t[a].style.display="all"!=e&&e==t[a].getAttribute("type")?"block":"all"==e?"block":"none"}function c(e,t){var a=R.data.getWorkBook(e,t),r=a.SheetList.getSheets(!0),i=v.querySelector("#selRule"),n=R.view.getSheetID(R.view.getActiveGridID()),o=a.getSheetObj(n).Prop.Name;i.innerHTML="",i.appendChild(Y.getTemplate(["selRuleOptions"]).selRuleOptions);for(var s=0,c=r.length;c>s;s++){var l=r[s].Name,u=M.createElement("option");u.value=l,u.innerText=l,i.appendChild(u)}H.zcombo(i,"refresh"),H.zcombo(i,"setValue",o),d(o,e)}function l(e,t,a){if(_.innerHTML="",t==Z.range){v.querySelector("#cf_range").parentNode.style.display="block";var r=R.view.getActiveGridID(),i=R.view.getSheetID(r),n=R.view.getSheetState(r,i);f.value=n.getActiveRange().getLabel(),f.focus()}else v.querySelector("#cf_range").parentNode.style.display="none";d(t,a)}function d(e,t){var a=R.view.getActiveGridID(),r=R.view.getSheetID(a),i=R.view.getVersionID(a),n=R.data.getWorkBook(t,i),o=n.getSheetObj(r).Prop.Name;e!=Z.range&&e!=Z.workbook&&(o=e,r=n.SheetList.getIdByName(o),e=Z.sheet);var s=e==Z.range?f.value:"";if(s){var c=JSUtil.Range.parseRange(t,i,s);o=c.sheetName,s=c.range}else s=new G.Range(-1,-1,-1,-1);var l=[r];_.innerHTML="",_.appendChild(L),Y.readConditionalFormatRules(t,l,i,e,s,JSUtil.Range.getDateFormats())}function u(){L=M.createElement("span"),L.className="ZsLoader ZsLoaderSmall"}function C(){I=M.createElement("span"),I.innerText="No Rules",I.className="ZsNoMsg"}function h(e){_.innerHTML="",0==e.length&&_.appendChild(I),K={};for(var t=0,a=e.length;a>t;t++){var r=e[t],i=r.csuid,n=r.asn,o="rule"+t,s=r.cs_type,c=new m(o,s,i,n,r);K[i]=r,_.appendChild(c.getElement())}}function m(e,t,a,r,i){this.id=e,this.csuid=a,this.type=t,this.asn=i.sheetList[0][0],this.ruleObj=i,this.create()}function g(e){var t="",a=e.split("~");return t+="background-color:"+a[0]+";",t+="color:"+a[1]+";",t+="true"==a[2]?"font-weight:bold;":"",t+="true"==a[3]?"font-style:italic;":"",("true"==a[4]||"true"==a[5])&&(t+="true"==a[4]&&"false"==a[5]?"text-decoration:underline;":"false"==a[4]&&"true"==a[5]?"text-decoration:line-through;":"text-decoration:line-through underline;"),t}function E(e){for(var t=6===Object.keys(e).length?X.getGradientColor(e.cs_c1,e.cs_c2,7):X.getGradientColor(e.cs_c1,e.cs_c2,e.cs_c3,7),a="linear-gradient(to right, ",r=7,i=100/r,n=0;7>n;n++)a+=t[n]+" "+Math.round(i*n)+"% ,"+t[n]+" "+Math.round(i*(n+1))+"%, ";a=a.substring(0,a.lastIndexOf(","))+")";var o="background-image:"+a;return o}function p(e){for(var t=e.cstyle1,a=M.createElement("div"),r=e.noofcond,i=1;r>=i;i++){var n=S.cloneNode(!0);n.children[0].innerText=1==i?"Min:":2==i&&2!=r?"Mid:":"Max:";var o="MINIMUM"===t["cr_ty"+i]||"MAXIMUM"===t["cr_ty"+i]?"Automatic":"PERCENT"===t["cr_ty"+i]?t["cval"+i]+"%":"PERCENTILE"===t["cr_ty"+i]?t["cval"+i]+" "+P["CFormat.CS.Percentile"]:t["cval"+i];n.children[1].innerText=o,a.appendChild(n)}return a.outerHTML.replace(/\"/g,"'")}function T(e){for(var t=A(e),a=(e.cstyle1,M.createElement("div")),r=1,i=e.noofcond;i>=r;r++){var n=F.cloneNode(!0);n.querySelector("span").className=t["icon_id"+r],n.querySelector(".cnt").innerText=t["is_c"+r],a.appendChild(n)}return a.outerHTML.replace(/\"/g,"'")}function A(t){for(var a={},r=t.cstyle1,i=t.noofcond,n=1;i>0;i--,n++){a.noOfCond=t.noofcond;var o=t.rio?n:i;a["icon_id"+o]=e.JSUtil.CFUtils.getIconClassName(r["icon_name"+i],r["icon_id"+i]);var s=e.JSUtil.CFUtils.isNumber(r["cval"+i]);if(a["val"+i]="FORMULA"!==r["cr_ty"+i]&&s?"PERCENTILE"===r["cr_ty"+i]?r["cval"+i]+" "+P["CFormat.CS.Percentile"]:"PERCENT"===r["cr_ty"+i]?r["cval"+i]+"%":r["cval"+i]:"Formula",i==t.noofcond)a["is_c"+i]=("gteq"===r["is_c"+i]?" >= ":" > ")+a["val"+i];else{var c="gteq"==r["is_c"+(i+1)]?" < ":"<=",l=1!=i?("gteq"==r["is_c"+i]?" >= ":" > ")+a["val"+i]:"";l=l?l+=" and ":l,a["is_c"+i]=l+c+a["val"+(i+1)]}}return a}function b(e,t){switch(N.close(),e){case J.colorscale:case J.iconset:var a=e==J.iconset?"ICONSET":"COLORSCALE";if(t){var r=t.cstyle1;delete t.cstyle1;for(var i in r)t[i]=r[i]}B.publish(q.Listener,j.UserAction.CONDITIONAL_FORMAT[a],{ruleObj:t,isManageReq:!0});break;case J.classic:t?B.publish(q.Listener,j.UserAction.CONDITIONAL_FORMAT.CLASSIC,{value:t?t.cr_ty1:"",type:t?t.cond1:"",ruleObj:t,isManageReq:!0}):B.publish(q.Listener,j.UserAction.CONDITIONAL_FORMAT.FIND_CLASSIC,{type:void 0,isManageReq:!0})}}function O(e,t,a){var r=parseInt(e),i="",n=t[0],o=t[1]?t[1]:"";switch(r){case D.TEXT_CONTAINING:i=P["CFormat.Condition.Contains"]+" '"+n+"'";break;case D.TEXT_NOTCONTAINING:i=P["CFormat.Condition.NotContains"]+" '"+n+"'";break;case D.TEXT_BEGINNINGWITH:i=P["CFormat.Condition.BeginsWith"]+" '"+n+"'";break;case D.TEXT_ENDINGWITH:i=P["CFormat.Condition.EndsWith"]+" '"+n+"'";break;case D.ISBLANK:i=P["CFormat.Condition.Blanks"];break;case D.ISNOTBLANK:i=P["CFormat.Condition.NoBlanks"];break;case D.ISERROR:i=P["CFormat.Condition.Errors"];break;case D.ISNOTERROR:i=P["CFormat.Condition.NoErrors"];break;case D.YESTERDAY:i=P["CFormat.Condition.Yesterday"];break;case D.TODAY:i=P["CFormat.Condition.Today"];break;case D.TOMORROW:i=P["CFormat.Condition.Tomorrow"];break;case D.LAST_7_DAYS:i=P["CFormat.Condition.Last7Days"];break;case D.NEXT_7_DAYS:i=P["CFormat.Condition.Next7Days"];break;case D.LAST_WEEK:i=P["CFormat.Condition.LastWeek"];break;case D.THIS_WEEK:i=P["CFormat.Condition.ThisWeek"];break;case D.NEXT_WEEK:i=P["CFormat.Condition.NextWeek"];break;case D.LAST_MONTH:i=P["CFormat.Condition.LastMonth"];break;case D.THIS_MONTH:i=P["CFormat.Condition.ThisMonth"];break;case D.NEXT_MONTH:i=P["CFormat.Condition.NextMonth"];break;case D.LAST_YEAR:i=P["CFormat.Condition.LastYear"];break;case D.THIS_YEAR:i=P["CFormat.Condition.ThisYear"];break;case D.NEXT_YEAR:i=P["CFormat.Condition.NextYear"];break;case D.DUPLICATE_VALUES:i=P["CFormat.Condition.Duplicate"];break;case D.UNIQUE_VALUES:i=P["CFormat.Condition.Unique"]}if(i)return i;if("WHOLENUMBER"==a||"DECIMAL"==a||"ANY_VALUE"==a||"TEXT_LENGTH"==a)switch(s=new Array(P["CFormat.AnyValue"],n,o),"WHOLENUMBER"==a?s=new Array(P["CFormat.WholeNumber"],n,o):"DECIMAL"==a?s=new Array(P["CFormat.Decimal"],n,o):"TEXT_LENGTH"==a&&(s=new Array(P["CFormat.TextLength"],n,o)),r){case D.LESS_THAN:i=X.replaceParams(P["CFormat.Condition.LessThan"],s);break;case D.GREATER_THAN:i=X.replaceParams(P["CFormat.Condition.GreaterThan"],s);break;case D.LESS_EQUAL:i=X.replaceParams(P["CFormat.Condition.LessThanOrEqual"],s);break;case D.GREATER_EQUAL:i=X.replaceParams(P["CFormat.Condition.GreaterThanOrEqual"],s);break;case D.EQUAL:i=X.replaceParams(P["CFormat.Condition.Equal"],s);break;case D.NOT_EQUAL:i=X.replaceParams(P["CFormat.Condition.NotEqual"],s);break;case D.BETWEEN:i=X.replaceParams(P["CFormat.Condition.Between"],s);break;case D.NOT_BETWEEN:i=X.replaceParams(P["CFormat.Condition.NotBetween"],s)}else if("DATE"==a){var s,c=-1;switch(r<=D.NOT_BETWEEN&&(n&&null!==n.match(/\s|:/g)&&(c=n.match(/\s|:/g).length),o&&null!==o.match(/\s|:/g)&&(c+=o.match(/\s|:/g).length)),r<=D.NOT_EQUAL?c>=2?s=new Array(P.DateTime,n):1==c?(n=X.replaceParams(P["CFormat.TimeHrs"],new Array(n)),s=new Array(P.Time,n)):s=new Array(P["Filter.date"],n):(r==D.BETWEEN||r==D.NOT_BETWEEN)&&(c>=4?s=new Array(P.DateTime,n,o):2==c?(n=X.replaceParams(P["CFormat.TimeHrs"],new Array(n)),o=X.replaceParams(P["CFormat.TimeHrs"],new Array(o)),s=new Array(P.Time,n,o)):s=new Array(P["Filter.date"],n,o)),r){case D.LESS_THAN:i=X.replaceParams(P["CFormat.Condition.DateBefore"],s);break;case D.LESS_EQUAL:i=X.replaceParams(P["CFormat.Condition.DateOnOrBefore"],s);break;case D.GREATER_THAN:i=X.replaceParams(P["CFormat.Condition.DateAfter"],s);break;case D.GREATER_EQUAL:i=X.replaceParams(P["CFormat.Condition.DateOnOrAfter"],s);break;case D.EQUAL:i=X.replaceParams(P["CFormat.Condition.DateOn"],s);break;case D.NOT_EQUAL:i=X.replaceParams(P["CFormat.Condition.DateNotOn"],s);break;case D.BETWEEN:i=X.replaceParams(P["CFormat.Condition.DateBetween"],s);break;case D.NOT_BETWEEN:i=X.replaceParams(P["CFormat.Condition.DateNotBetween"],s)}}else"LIST"===a?(n=n.length>55?n.substring(0,55)+"...":n,i=n.indexOf('"')>-1?X.replaceParams(P["CFormat.Condition.List"],new Array(n)):X.replaceParams(P["CFormat.Condition.Range"],new Array(n))):"FORMULA"===a&&(i=P["CFormat.Condition.Formula"]+" ="+n);return i}var v,N,f,y,_,S,F,L,I,R=e.sPlusPlus,w=e.ZSConstants,k=w.FeatureConstants,D=(w.ActionConstants,w.ConditionalFormatClassicOperator),M=e.document,P=(e.ZSConstants.wCC,e.ZSConstants.I18N),U=e.ZSEvents,q=U.Groups,j=U.Names,B=U.topic,H=(R.SML.Client,e.UIUtil.Component),G=e.ZSClass,W=G.Editors,x=G.RangePicker,Y=e.UserAction,X=JSUtil.fn,Q=M.getElementById("popupmenu"),V=R.view.Toolbar.Feature[k.CF_MANAGE],Z={range:"CONDITIONAL_FORMAT_READ_RANGE",sheet:"CONDITIONAL_FORMAT_READ_SHEET",workbook:"CONDITIONAL_FORMAT_READ_WORKBOOK"},J={iconset:"i_s",colorscale:"c_s",classic:"c_f"},K={};m.prototype={create:function(){y=Y.getTemplate(["cf_manage_rule"]).cf_manage_rule;var e=y.cloneNode(!0),t=e.querySelector(".ml20");if(t.innerText=this.type==J.colorscale?"Color Scale":this.type==J.iconset?"Icon Set":"Classic",this.type!=J.iconset){var a=this.type===J.classic?g(this.ruleObj.cstyle1):E(this.ruleObj.cstyle1);e.querySelector(".cFmanagePrv").setAttribute("style",a)}else this.setIconsInPreview(e.querySelector(".cFmanagePrv"),this.ruleObj);this.type===J.classic&&(e.querySelector(".cFmanagePrv").innerText="Preview");{var r=this.type==J.colorscale?p(this.ruleObj):this.type==J.iconset?T(this.ruleObj):O(this.ruleObj.cond1,this.ruleObj.cval1,this.ruleObj.cr_ty1);'{"componentOptions":{"contentType":"html","content":"'+r.replace(/\"/g,"'")+'"}}'}e.querySelector(".cfInfoTooltip").setAttribute("title"," "),e.querySelector(".cfInfoTooltip").setAttribute("data-title-inner-HTML",r),e.querySelector(".flt_left").innerText=this.ruleObj.datarange,e.querySelector(".flt_left").setAttribute("title",this.ruleObj.datarange);var i=this;e.querySelector(".cFMenu").addEventListener("click",function(e){i.showEditOption(e)}),e.querySelector(".cpy").onclick=this.copy.bind(this),e.querySelector(".edt").onclick=this.edit.bind(this),e.querySelector(".del").onclick=this.delete.bind(this);var n=M.createElement("div");n.className="dspTbl",n.appendChild(e),this.rowObj=M.createElement("div"),this.rowObj.classList.add("wid","wid100","cFDrag","cFMng"),this.rowObj.appendChild(n),this.rowObj.setAttribute("id",this.id),this.rowObj.setAttribute("csuid",this.csuid),this.rowObj.setAttribute("asn",this.asn),this.rowObj.setAttribute("type",this.type),this.rowObj.onclick=this.hideEditOption.bind(this),_.onclick=this.hideEditOption.bind(this),this.rowObj.ondblclick=this.edit.bind(this)},delete:function(){var e={};e.csuid=this.csuid,e.datarange=this.ruleObj.datarange,e.asn=this.asn,e.cs_type=this.type;var t=R.view.getActiveGridID(),a=R.view.getResourceID(t),r=R.view.getVersionID(t),i=(R.data.getWorkBook(a,r),R.view.getSheetID(t)),n=JSUtil.CFUtils.getRangeList(N.rID,N.version,this.ruleObj.datarange);Y.deleteConditionalFormat(a,[i],n,JSON.stringify(e),this.ruleObj.datarange,this.rowObj)},edit:function(){this.ruleObj.mode="EDIT",b(this.type,this.ruleObj)},copy:function(){this.ruleObj.mode="COPY",b(this.type,this.ruleObj)},getElement:function(){return this.rowObj},getCSUID:function(){return this.csuid},getAssociatedSheetName:function(){return this.asn},showEditOption:function(e){this.hideEditOption(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),this.rowObj.querySelector(".cFMenuPopUp").classList.add("edtOption")},hideEditOption:function(){var e=v.querySelector(".edtOption");e&&e.classList.remove("edtOption")},setIconsInPreview:function(e,t){for(var a=1;a<=t.noofcond;a++){var r=M.createElement("span");r.appendChild(M.createElement("span"));var i="iS-"+t.cstyle1["icon_name"+a]+t.cstyle1["icon_id"+a];r.classList.add(i,"mr5"),e.appendChild(r)}}},V.openDialog=t,e.JSUtil.CFUtils.getInfoTitle=O,B.register(q.UI,j.Layout.TEMPLATE_LOADED,n),B.register(q.Listener,j.UserAction.CONDITIONAL_FORMAT.READ_RULES,h,"RESPONSE"),B.register(q.Listener,j.UserAction.CONDITIONAL_FORMAT.MANAGE,t,"isServerRequestNeed")}(this);
!function(e){function t(){C||n(),setTimeout(function(){i(),F.focus()},10),C.open()}function n(){var t={width:580,title:N["MenuItem.InsertTab.DefineName"],dialogClass:"nRtD",close:function(){l()},open:function(){a()}},n=e.UserAction.getTemplate(["namedRangeTemplate"]),i=n.namedRangeTemplate;i.querySelector("#nR_addBtn").onclick=o,i.querySelector("#cancelBtn").addEventListener("click",function(){C.close()}),x=m.createElement("div"),x.id="DI_NAMEDRANGE",x.appendChild(i),C=new e.ZSClass.Dialog(x,t),r(x)}function i(){var e=x.querySelector("#nR_container"),t=x.querySelector("#nR_noResult"),n=E();n.childElementCount?(t.style.display="none",e.style.display="",e.appendChild(n)):(t.style.display="",e.style.display="none");{var i=R.view.getActiveGridID(),r=R.view.getResourceID(i),s=R.view.getSheetID(i),o=R.view.getVersionID(i),a=R.data.getWorkBook(r,o),l=a.getSheetObj(s),i=(l.Prop.getName(),R.view.getActiveGridID()),c=R.view.getSheetState(i,s),d=c.getActiveRange();new I(d.startRow,d.startCol,d.endRow,d.endCol)}L.value="",L.focus(),p.publish(D.Listener,A.RangePicker.Update,{RID:r,SHEETID:s,VERSION:o,RANGE:d}),w.animateLabel.trigger(L)}function r(e){var t=e.querySelector("#nR_name"),n=e.querySelector("#nR_expression");F=new S.TextAreaEditor(t,!0),L=new S.RangeEditor(n,!0),y.RangePicker.register(L,!1,!1,1);var i=n.nextElementSibling;y.RangePicker.Dialog.register(L,C,i,"Select Range"),F.addListeners({input:c,keydown:s}),L.addListeners({keydown:s})}function s(e){var t=e.keyCode||e.which;13===t&&(o(),e.preventDefault())}function o(){for(var e=F.value,t=R.view.getActiveGridID(),n=R.view.getResourceID(t),i=(R.view.getSheetID(t),R.view.getVersionID(t)),r=R.data.getWorkBook(n,i),s=r.NamedRange.allNames,o=s.keys(),a=0;a<s.size;a++){var l=o.next().value.toLowerCase();if(l==e.toLowerCase())return void y.ZSAlert(N["Error.NamedExpression.Already.Exists"],{title:N["Alert.Title.DefinedNameExists"]})}if(g(e,"DEFINE_NAME")||!isNaN(e.charAt(0))||JSUtil.LinkMaker.isCellLabel(e.trim()))return void y.ZSAlert(b,T);if(e.trim()&&L.value){var c=x.querySelector("#nR_container"),d=new y.UIDefinedRangeRow(e,L.value);_[e]=d;var u=R.view.getSelectedSheets(t);c.appendChild(d.getElement()),UserAction.addNamedRange(n,u,i,e,L.value),F.value="",L.value="",F.focus(),x.querySelector("#nR_addBtn").disabled=!0,c.scrollIntoView(!1)}else y.ZSAlert(N.Rangecannotbeempty,{title:N["Alert.Title.InvalidCellRange"]})}function a(){F.focus(),p.register(D.Listener,A.DocAction.NAMED_RANGE.ADD,d,"RID","VERSION","NAMEDRANGE","CLIENT_ID"),p.register(D.Listener,A.DocAction.NAMED_RANGE.MODIFY,u,"RID","VERSION","NAMEDRANGE","CLIENT_ID"),p.register(D.Listener,A.DocAction.NAMED_RANGE.REMOVE,v,"RID","VERSION","NAMEDRANGE","CLIENT_ID")}function l(){p.unregister(D.Listener,A.DocAction.NAMED_RANGE.ADD,d),p.unregister(D.Listener,A.DocAction.NAMED_RANGE.MODIFY,u),p.unregister(D.Listener,A.DocAction.NAMED_RANGE.REMOVE,v),x.querySelector("#nR_container").innerHTML=""}function c(){var e=this.value,t=x.querySelector("#nR_addBtn");t.disabled=e?!1:!0}function d(e,t,n){var i=x.querySelector("#nR_container"),r=x.querySelector("#nR_noResult");r.style.display="none",i.style.display="";for(var s in n){var o=n[s][0],a=n[s][2],l=JSUtil.FormRange(a),c=_[o];c||(c=new y.UIDefinedRangeRow(o,l),_[o]=c,i.appendChild(c.getElement()))}}function u(e,t,n){for(var i in n){var r=n[i][0],s=_[r];s.setExpression(n[i][2])}}function v(e,t,n){for(var i in n){var r=n[i][0],s=_[r],o=s.getElement();o&&o.remove(),delete _[r]}JSUtil.Object.isEmpty(_)&&(x.querySelector("#nR_container").style.display="none",x.querySelector("#nR_noResult").style.display="")}function E(){var e=R.view.getActiveGridID(),t=R.view.getResourceID(e),n=(R.view.getSheetID(e),R.view.getVersionID(e)),i=R.data.getWorkBook(t,n),r=i.NamedRange.getAllKeys(),s=m.createDocumentFragment();_={};var o=r.size;if(0!=o)for(var a=r.keys(),l=0;o>l;l++){var c=a.next(),d=c.value,u=i.NamedRange.get(d),v=JSUtil.FormRange(u),E=new y.UIDefinedRangeRow(d,v);_[d]=E,s.appendChild(E.getElement())}return s}function g(e,t){if("CELL_REF"==t){var n=new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF!:]+$");return!n.test(e)}if("DEFINE_NAME"==t){var n=new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF]+$");return!n.test(e)}if("SHEET_NAME"==t){var n=new RegExp("^[a-zA-Z0-9_ \\u00A1-\\uFFFF]+$");return!n.test(e)}return!1}var R=e.sPlusPlus,m=e.document,h=e.ZSEvents,p=h.topic,D=h.Groups,A=h.Names,f=e.ZSConstants,y=(f.FeatureConstants,e.ZSClass),S=y.Editors,w=y.Editors.Utility,N=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),I=y.Range,_={},C=void 0,x=void 0,F=void 0,L=void 0,k=R.view.Toolbar.Feature[f.FeatureConstants.DEFINE_NAME],q=[{text:N.OK,primary:!0,click:function(){F.focus()}}],T={buttons:q,title:N["Alert.Title.InvalidDefinedName"]},b=N.CellNamecannotbeassameasZohoSheetdefinedcelllabels;k.openDialog=t}(this),function(e){function t(e,t){this.name=e,this.expression=t,this.create()}function n(){var t=e.UserAction.getTemplate(["namedRangeDetailTemplate"]);return t.namedRangeDetailTemplate}function i(){var e=o.createElement("span");return e.setAttribute("class","rangeSelectOut"),e}function r(e){var t,n=e.querySelectorAll("[name=view]"),i=e.querySelectorAll("[name=edit]");for(t=0;t<n.length;t++)n[t].style.display="none"==n[t].style.display?"":"none";for(t=0;t<i.length;t++)i[t].style.display="none"==i[t].style.display?"":"none"}var s=e.sPlusPlus,o=e.document,a=e.ZSClass,l=a.Editors;t.prototype={create:function(){this.template=n();var e=this.template.querySelector("#nR_textContent");e.innerText=this.expression;var t=this.template.querySelector("#nR_nameField");t.innerText=this.name,t.addEventListener("click",UserAction.Goto.bind(null,this.name)),this.rowElement=o.createElement("div"),this.rowElement.className="dspTblRow";var i=this.template.querySelector("#nR_editContent");this.editContentEditor=new l.RangeEditor(i,!0),this.editContentEditor.value=this.expression,a.RangePicker.register(this.editContentEditor,!0,!1,1);var r=this.template.querySelector("#nR_editDelete"),s=r.querySelector("#nR_editRange");s.addEventListener("click",this.edit.bind(this));var c=r.querySelector("#nR_deleteRange");c.addEventListener("click",this.delete.bind(this));var d=r.querySelector("#nR_updateRange");d.addEventListener("click",this.update.bind(this));var u=r.querySelector("#nR_cancelEdit");u.addEventListener("click",this.cancel.bind(this)),this.rowElement.appendChild(this.template)},edit:function(){i();this.expression="string"==typeof this.expression?this.expression:JSUtil.FormRange(this.expression),this.editContentEditor.value=this.expression,r(this.rowElement),this.editContentEditor.focus()},delete:function(){var t=this.name;if(t){var n=s.view.getActiveGridID(),i=s.view.getResourceID(n),r=s.view.getVersionID(n),o=s.view.getSelectedSheets(n);e.UserAction.deleteNamedRange(i,o,r,t),this.rowElement.remove()}},update:function(){this.expression=this.editContentEditor.value,this.rowElement.querySelector("#nR_textContent").innerText=this.expression,r(this.rowElement);var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=(s.view.getSheetID(e),s.view.getVersionID(e)),i=s.view.getSelectedSheets(e);UserAction.modifyNamedRange(t,i,n,this.name,this.expression)},cancel:function(){this.editContentEditor.value=this.expression,r(this.rowElement)},getElement:function(){return this.rowElement},setExpression:function(e){this.expression=e}},a.UIDefinedRangeRow=t}(this);
!function(e){function t(e,t){var a={width:580,title:"Data Validation",close:function(){T.closeDialog()},open:function(){}};A||(I=document.createElement("div"),I.id="DI_DATA_VALIDATION",I.appendChild(u()),A=new L.Dialog(I,a),i(),s()),setTimeout(function(){d(A.rID,A.sheetID,A.version,e)},0),M=t||!1,A.open()}function i(){I.querySelector("#createDV").addEventListener("click",n),I.querySelector("#cancelDV").addEventListener("click",function(){A.close(),M&&V.publish(k.Listener,R.UserAction.DATA_VALIDATION.MANAGE_DIALOG,{REQ_NEED:!1})}),h(["#dvDataRange","#rangeList"]),a()}function a(){var e=!0,t={valueChanged:function(){e&&(e=!1,setTimeout(function(){T.setRangeValue(),e=!0},500))}};w.rangeList.addListeners(t)}function n(){var e=S.view.getActiveGridID(),t=S.view.getSheetID(e);t!==A.sheetID&&UserAction.SwitchSheet(A.rID,t,A.version,A.sheetID);var i,a=A.rID,n=(A.gridID,A.version),s=l();if(""==s.val1||s.val2&&""==s.val2)return void L.ZSAlert(b["CFormat.FieldsBlank"],{title:b["Alert.Title.EnterValue"]});for(var o=[],u=(w.dvDataRange.value.trim().replace(";",","),w.dvDataRange.value.trim().replace(/;/g,",").split(",")),h=0;h<u.length;h++){var d=JSUtil.Range.parseRange(A.rID,A.version,u[h].trim());0==h&&(i=d.sheetID),o.push(d.range)}var v=[i];s.asn=i;var g=T.validate;g?UserAction.ValidateInput(a,v,n,s,o,c,r):c(a,v,n,s,o)}function r(e,t){var i,a=e.valinp.errorMsg;switch(e.valinp.errorMsg){case"DataVal.MaxMinSwap":a=b["DataVal.MaxMinSwap"];break;case"DataVal.InputError":case"DataVal.InputError2":case"DataVal.InputError1":a=JSUtil.fn.replaceParams(b["DataVal.InputError2"],new Array(j[t.cr_ty])),i=b["Alert.Title.InvalidValueType"]}L.ZSAlert(a,{title:i})}function s(){var e=A.getKeyContext(),t=e.keyDown;t[x.ENTER]=function(){}}function l(){var e={};e.cr_nu=T.condition,e.cr_ty="CELL_RANGE"==T.criteria?"LIST":T.criteria;var t=T.getHintObj();return e.cv_hi={is_dis:t.is_dis,v:encodeURIComponent(t.v)},e.cv_err=T.getErrorObj(),e.cv_abc=T.container.querySelector("#ignoreBlank").checked,e.cv_ldt=T.listDisplayType(),e.val1=encodeURIComponent(T.value1.replace(/\"/g,'\\"')),T.value2&&(e.val2=encodeURIComponent(T.value2.replace(/\"/g,'\\"'))),e}function c(e,t,i,a,n){UserAction.CreateDataValidation(e,t,i,a,n,M),A.close(),M=!1}function o(e){this.dvObj=e,this.criteria=e?e.isRange?"CELL_RANGE":e.cr_ty:"DECIMAL",this.condition=e?e.cr_nu:7,this.stopMsg=b["DataVal.StopErrorMsg"],this.infoMsg=b["DataVal.InfoErrorMsg"],this.container=I,this.create()}function u(){var e=UserAction.getTemplate(["DATA_VALIDATION"]).DATA_VALIDATION,t=document.createElement("div");t.id="dvDialog",t.appendChild(e),t=UserAction.renderJsTemplate(t.outerHTML,m);var i=new DOMParser,a=i.parseFromString(t,"text/html");return a.getElementById("dvDialog")}function h(e){e.forEach(function(e){var t=I.querySelector(e),i=new C.RangeEditor(t,!0);"#rangeList"!=e?N.register(i,!1):N.register(i,!1,!1,1);var a=t.nextSibling;L.RangePicker.Dialog.register(i,A,a,"Select Range"),w[t.getAttribute("id")]=i})}function d(e,t,i,a){T=new o(a);var n=I.querySelector("#dvDataRange").parentNode;if(a&&a.disable?n.classList.add("zsDisable"):n.classList.remove("zsDisable"),w.dvDataRange.value="",!a&&w.dvDataRange.focus(),a&&a.RANGENAME)w.dvDataRange.value=a.RANGENAME;else{w.dvDataRange.focus();var r=S.data.getWorkBook(e,i),s=(r.getSheetObj(t),S.view.getSheetState(S.view.getActiveGridID(),t)),l=s.getRanges();L.RangePicker.setRanges(e,t,i,l)}}function v(e,t,i){var a=S.data.getWorkBook(e,i),n=(a.getSheetObj(t),S.view.getSheetState(S.view.getActiveGridID(),t)),r=n.getActiveRange().getLabel();return r}function g(e){var i=w,a=S.view.getActiveGridID(),n=S.view.getResourceID(a),r=S.view.getVersionID(a);if(0==Object.keys(e).length)return void t();var s=[{text:b.Yes,primary:!0},{text:b.No},{text:b["Dialog.Button.Cancel"]}],l={buttons:s};if("OVERWRITE"===e.RangeValidate)l.buttons[0].click=function(){p(e),t(e)},l.buttons[2].click=function(){},l.title=b["Alert.Title.VaidationDetected"],L.ZSAlert(b["DataVal.OverwriteSelection"],l);else if("EDIT"==e.RangeValidate||"EXTEND"===e.RangeValidate){l.buttons[0].click=function(){e.RANGENAME=e.RANGENAME?e.RANGENAME:v(n,S.view.getSheetID(a),r),t(e),i.dvDataRange.value=e.RANGENAME},l.buttons[1].click=function(){delete e.RANGENAME,p(e),t(e)},l.buttons[2].click=function(){};var c=e.RANGENAME?b["DataVal.ExpandSelection"]:b["DataVal.ExtendSelection"];l.title=e.RANGENAME?b["Alert.Title.ValidationDetected"]:b["Alert.Title.ExtendValidation"],L.ZSAlert(c,l)}else t(e)}function p(e){e.val1=e.lval1?e.lval1:e.val1,e.val2=e.lval2?e.lval2:e.val2}function E(e,t){f=e,D=t}var A,T,I,f,D,S=e.sPlusPlus,y=(e.document,e.ZSConstants),b=y.I18N,m=(y.wCC,y.FeatureConstants,y.ConditionalFormatClassicOperator),x=(y.ActionConstants,y.JSKeyCode),O=e.ZSEvents,L=e.ZSClass,C=L.Editors,N=L.RangePicker,V=O.topic,k=O.Groups,R=O.Names,_=JSUtil.fn,q=(e.JSUtil.CFUtils,e.UIUtil.Component),w={},M=!1,j={DECIMAL:b["CFormat.Decimal"].toLowerCase(),WHOLENUMBER:b["CFormat.WholeNumber"].toLowerCase(),TEXT_LENGTH:b["CFormat.TextLength"].toLowerCase(),DATE:b["Filter.date"].toLowerCase(),ANY_VALUE:b.Number.toLowerCase(),TIME:b.Time.toLowerCase(),DATETIME:b.DateTime.toLowerCase()};o.prototype={create:function(){q.zcombo("#criteriaOpn","setValue",this.criteria),this.criteriaIndex=q.zcombo("#criteriaOpn","getAttribute","selectedIndex"),this.errorElem=this.container.querySelector("#errSel"),this.hintFieldChanged=!1,this.appendAction(),this.setValueTag(),this.dvObj&&this.loadRule(this.dvObj),this.changeErrorMsg(),this.checkBoxHandling()},appendAction:function(){var e=this;this.selectTags=this.container.querySelectorAll("select"),this.selectTags.forEach(function(t){q.bind(t,"zselectboxchange",function(){e.changeComboValue(t,t.getAttribute("id"))})}),this.doColorPickerChanges(f,D),this.container.querySelector("#helpTxt").addEventListener("change",function(){e.container.querySelector("#helpTxt").checked?e.container.querySelector("#helpTextCombo").classList.remove("disabledCheck"):e.container.querySelector("#helpTextCombo").classList.add("disabledCheck")}),this.container.querySelector("#invalidData").addEventListener("change",function(){e.container.querySelector("#invalidData").checked?e.container.querySelector("#errSelCombo").classList.remove("disabledCheck"):e.container.querySelector("#errSelCombo").classList.add("disabledCheck")}),this.container.querySelectorAll("input").forEach(function(t){t.addEventListener("keyup",function(){"helpText"!==t.id&&"helpTxt"!==t.id&&e.setHintText(),"helpText"==t.id&&(e.hintFieldChanged=!0)})}),this.container.querySelector("#list").addEventListener("keyup",function(){e.setHintText()})},doColorPickerChanges:function(){var e=this;["#date1","#date2","#date3"].forEach(function(t){q.bind(t,"zdatetimefieldpickerdateselect",function(){e.setHintText()}),q.zdatetimefield(t,"setAttribute","locale",f+"-"+D)})},changeComboValue:function(e,t){switch(t){case"criteriaOpn":this.criteria=q.zcombo(e,"getValue"),this.criteriaIndex=q.zcombo(e,"getAttribute","selectedIndex"),this.setValueTag(),this.checkBoxHandling();break;case"errSel":this.changeErrorMsg();break;default:this.showInputBox()}},changeErrorMsg:function(){var e=q.zcombo("#errSel","getValue");this.container.querySelector("#err_txt").value="STOP"==e?this.stopMsg:this.infoMsg},setValueTag:function(){this.criteriaIndex>=0&&this.criteriaIndex<=3?(this.valueTag=2==this.criteriaIndex?"textOpn":"numberOpn",this.inputId="decimalInputData"):4==this.criteriaIndex?(this.valueTag="dateOpn",this.inputId="dateInputData"):(this.valueTag="",this.inputId=5==this.criteriaIndex?"listInput":"cellRangeData"),this.showSelectTag()},getValueTag:function(){return this.criteriaIndex>=0&&this.criteriaIndex<=3?this.valueTag=2==this.criteriaIndex?"textOpn":"numberOpn":4==this.criteriaIndex&&(this.valueTag="dateOpn"),this.valueTag},showSelectTag:function(){var e=this;e.selectTags.forEach(function(t,i){if(0==i||4==i||t.getAttribute("id")==e.valueTag){var a=q.zcombo(t,"getElement");a.style.display="block"}else{var a=q.zcombo(t,"getElement");a.style.display="none"}}),this.showInputDiv()},checkBoxHandling:function(){this.container.querySelector("#inputBoxes").style.display="LIST"===this.criteria?"block":"none"},showInputDiv:function(){var e=this;this.inputContainer=this.container.querySelector("#inputContainer"),Array.from(this.inputContainer.children).forEach(function(t){t.getAttribute("id")==e.inputId?(e.inputDiv=t,t.style.display="block"):t.style.display="none"}),this.showInputBox()},showInputBox:function(){var e=this;this.validate=!1,this.condition=this.valueTag?parseInt(q.zcombo("#"+this.valueTag,"getValue")):-1,this.criteriaIndex>=0&&this.criteriaIndex<=4?(this.condition===m.BETWEEN||this.condition===m.NOT_BETWEEN?(this.validate=!0,this.inputElem=this.inputDiv.querySelector("#doubleInput"),this.inputElem.style.display="block",this.inputDiv.querySelector("#singleInput").style.display="none"):this.condition>=m.YESTERDAY&&this.condition<=m.NEXT_YEAR?(this.inputDiv.querySelector("#doubleInput").style.display="none",this.inputDiv.querySelector("#singleInput").style.display="none",this.inputElem=""):(this.validate=!0,this.inputElem=this.inputDiv.querySelector("#singleInput"),this.inputElem.style.display="block",this.inputDiv.querySelector("#doubleInput").style.display="none"),this.inputElem.querySelectorAll("input").forEach(function(t){4!=e.criteriaIndex&&(t.value="")}),this.inputElem.querySelector("input").focus()):5==this.criteriaIndex?(this.inputElem=this.container.querySelector("#list"),this.inputElem.value="",this.inputElem.focus()):(this.inputElem=w.rangeList,this.validate=!0,w.rangeList.focus()),this.setHintText()},setHintText:function(){var e="DataVal.LIST",t=new Array("","");if(this.criteriaIndex>=0&&this.criteriaIndex<=4){e="DataVal."+this.criteria+this.condition;var i=this.inputElem?this.inputElem.querySelectorAll("input"):"";this.condition===m.BETWEEN||this.condition===m.NOT_BETWEEN?(this.value1=4==this.criteriaIndex?q.zdatetimefield("#date1","getValue").dateString+" "+i[2].value:i[0].value,this.value2=4==this.criteriaIndex?q.zdatetimefield("#date2","getValue").dateString+" "+i[3].value:i[1].value,t=new Array(this.value1,this.value2)):this.condition<=m.NOT_EQUAL?(this.value1=4==this.criteriaIndex?q.zdatetimefield("#date3","getValue").dateString+" "+i[1].value:i[0].value,t=new Array(this.value1)):(this.value1=i[0].value,t=new Array(this.value1))}else 5==this.criteriaIndex?(this.value1=this.container.querySelector("#list").value+"\n",this.value1=this.value1.replace(/\n/g,"\\n").replace(/\";\"/g,"\\;")):7==this.criteriaIndex?(e="DataVal.CUSTOM",this.value1=w.rangeList.value,t=new Array(this.value1)):this.value1=w.rangeList.value;this.hintFieldChanged||(this.hintText=_.replaceParams(b[e],t),this.container.querySelector("#helpText").value=this.hintText),this.bindPickerEvent()},bindPickerEvent:function(){var e=!0,t=this,i={valueChanged:function(){e&&(e=!1,setTimeout(function(){if(7==t.criteriaIndex){var i="DataVal.CUSTOM";t.value1=w.rangeList.value;var a=new Array(t.value1);t.hintText=_.replaceParams(b[i],a),t.container.querySelector("#helpText").value=t.hintText}e=!0},200))}};w.rangeList.addListeners(i)},setRangeValue:function(){this.value1=w.rangeList.value},loadRule:function(e){var t=this.container;if(q.zcombo("#criteriaOpn","setValue",this.criteria),this.criteriaIndex=q.zcombo("#criteriaOpn","getAttribute","selectedIndex"),this.valueTag=this.getValueTag(),this.showInputBox(),this.criteriaIndex>=0&&this.criteriaIndex<=4){var i=this.inputElem?this.inputElem.querySelectorAll("input"):"";if(this.condition===m.BETWEEN||this.condition===m.NOT_BETWEEN)if(4==this.criteriaIndex){var a=this.dvObj.val1.split(" "),n=this.dvObj.val2.split(" ");this.value1=i[0].value=a[0],this.value2=i[1].value=n[0],q.zdatetimefield("#date1","setValue",a[0]),q.zdatetimefield("#date2","setValue",n[0]),i[2].value=a[1]||"",i[3].value=n[1]||""}else this.value1=i[0].value=this.dvObj.val1,i[0].value=this.dvObj.val1,this.value2=i[1].value=this.dvObj.val2,i[1].value=this.dvObj.val2;else if(this.condition<=m.NOT_EQUAL)if(4==this.criteriaIndex){var a=this.dvObj.val1.split(" ");this.value1=i[0].value=a[0],i[1].value=this.dvObj.val2}else this.value1=i[0].value=this.dvObj.val1;else this.value1=i[0].value=this.dvObj.val1}else if(5==this.criteriaIndex){var r="string"==typeof e.val1?e.val1.replace(/"/g,"").split(";"):e.val1;this.inputElem.value=r.join("\n"),this.value1=this.inputElem.value.replace(/\n/g,"\\n").replace(/";"/g,"\\;")}else this.value1=w.rangeList.value=e.val1;t.querySelector("#ignoreBlank").checked=this.dvObj.cv_abc,t.querySelector("#alertText").checked=!0,t.querySelector("#helpTxt").checked=this.dvObj.cv_hi.is_dis,t.querySelector("#helpText").value="undefined"!=this.dvObj.cv_hi.v?this.dvObj.cv_hi.v:this.hintText,t.querySelector("#invalidData").checked=this.dvObj.cv_err.is_dis,t.querySelector("#err_txt").value=this.dvObj.cv_err.v,q.zcombo(this.errorElem,"setValue",this.dvObj.cv_err.msgt),this.hintFieldChanged=!1,this.setHintText(),"STOP"==this.dvObj.cv_err.msgt?this.stopMsg=this.dvObj.cv_err.v:this.infoMsg=this.dvObj.cv_err.v},getHintObj:function(){var e={};return e.is_dis=this.container.querySelector("#helpTxt").checked,e.v=e.is_dis?this.container.querySelector("#helpText").value:"undefined",e},getErrorObj:function(){var e={};return e.is_dis=this.container.querySelector("#invalidData").checked,e.v=this.container.querySelector("#err_txt").value,e.msgt=q.zcombo(this.errorElem,"getValue"),e},listDisplayType:function(){return(5==this.criteriaIndex||6==this.criteriaIndex)&&this.container.querySelector("#showList").checked?this.container.querySelector("#listAsc").checked?"SORT_ASCENDING":"UNSORTED":"NO"},closeDialog:function(){this.checkBoxHandling(),this.container.querySelector("#helpTxt").checked=!1,this.container.querySelector("#alertText").checked=!1,this.container.querySelectorAll("input").forEach(function(e){e.value=""}),w.rangeList.value=""}},V.register(k.Listener,R.UserAction.DATA_VALIDATION.DV_DIALOG,t,"DV_JSON","MANAGE_REQ"),V.register(k.Listener,R.UserAction.DATA_VALIDATION.VALIDATION,g,"DV_JSON"),V.register(k.Listener,R.DocMeta.DOCUMENT_LOCALE,E,"LANGUAGE","COUNTRY")}(this);
!function(e){function t(e){var t=f.view.getActiveGridID(),i=f.view.getResourceID(t),o=f.view.getVersionID(t),r={width:545,title:"Data Validation - Manage Rules",dialogClass:"dvManage",close:function(){}};if(!p){var a=_.getTemplate(["dv_manage"]).dv_manage;A=document.createElement("div"),A.id="DI_DV_MANAGE",A.appendChild(a),p=new ZSClass.Dialog(A,r),n()}e&&d(i,o),p.open()}function n(){y.initComponent(A),y.bind(A.querySelector("#rulesFor"),"zselectboxchange",function(e,t){a(t.value)}),A.querySelector("#dvClose").addEventListener("click",function(){p.close()}),A.querySelector("#dvCreate").addEventListener("click",function(){v()}),l(),c(),i(),S=_.getTemplate(["dv_manage_rule"]).dv_manage_rule.firstElementChild,h=A.querySelector(".mngCtn")}function i(){var e=A.querySelector("#dv_range");D=new L.RangeEditor(e,!0),T.register(D,!0),ZSClass.RangePicker.Dialog.register(D,p,e.nextSibling,"Select Range"),o()}function o(){var e=!0,t={valueChanged:function(){e&&(e=!1,setTimeout(function(){s(D.value),e=!0},500))}};D.addListeners(t)}function r(e,t){var n=f.data.getWorkBook(e,t),i=n.SheetList.getSheets(!0),o=A.querySelector("#rulesFor"),r=f.view.getSheetID(f.view.getActiveGridID()),a=n.getSheetObj(r).Prop.Name;o.innerHTML="",o.appendChild(_.getTemplate(["dvRuleOptions"]).dvRuleOptions);for(var s=0,l=i.length;l>s;s++){var c=i[s].Name,d=document.createElement("option");d.value=c,d.innerText=c,o.appendChild(d)}y.zcombo(o,"refresh"),y.zcombo(o,"setValue",a)}function a(e){var t=f.view.getActiveGridID(),n=f.view.getResourceID(t),i=f.view.getSheetID(t),o=f.view.getVersionID(t);switch(e){case k.readBook:for(var r=0;r<V.length;r++)V[r].ruleContainer.style.display="block";A.querySelector("#dvSelRange").style.display="none";break;case k.readRange:D.value="",D.focus();var a=f.view.getSheetState(f.view.getActiveGridID(),i),l=a.getActiveRange().getLabel();D.value=l,s(l);break;default:for(var r in V){var c=JSUtil.Range.parseRange(n,o,V[r].obj.RANGENAME.trim());V[r].ruleContainer.style.display=e===c.sheetName?"block":"none"}A.querySelector("#dvSelRange").style.display="none"}}function s(e){var t=p.rID,n=p.version,i=JSUtil.Range.parseRange(t,n,e);for(var o in V)for(var r=V[o].obj.RANGENAME,a=0;a<r.split(",").length;a++){var s=r.split(",")[a],l=JSUtil.Range.parseRange(t,n,s.trim()),c=new ZSClass.Range(i.range.startRow,i.range.startCol,i.range.endRow,i.range.endCol),d=new ZSClass.Range(l.range.startRow,l.range.startCol,l.range.endRow,l.range.endCol);if(c.intersects(d)&&i.sheetID===l.sheetID){V[o].ruleContainer.style.display="block";break}V[o].ruleContainer.style.display="none"}A.querySelector("#dvSelRange").style.display="block"}function l(){E=document.createElement("span"),E.className="ZsLoader ZsLoaderSmall"}function c(){R=document.createElement("span"),R.innerText="No Rules",R.className="ZsNoMsg"}function d(e,t){r(e,t);var n=f.view.getActiveGridID(),i=f.data.getWorkBook(e,t),o=f.view.getSelectedSheets(n),a=f.view.getSheetID(n),t=f.view.getVersionID(n),s=(i.getSheetObj(a).Prop.Name,k.readBook);h.innerHTML="",h.appendChild(E),_.ReadDataValidation(e,o,a,t,s,"",JSUtil.Range.getDateFormats())}function u(e){var t=A.querySelector(".mngCtn");t.innerHTML="",V=[];for(var n in e)for(var i=e[n].RANGENAME.split(","),o=0;o<i.length;o++){var r=new g(n,e[n],i[o]);V.push(r),t.appendChild(r.ruleContainer)}var s=y.zcombo("#rulesFor","getValue");a(s),0==e.length&&h.appendChild(R)}function g(e,t,n){this.id=e,this.obj=t,this.range=n,this.obj.RANGENAME=n,this.create()}function v(e){p.close(),w.publish(N.Listener,O.UserAction.DATA_VALIDATION.DV_DIALOG,{DV_JSON:e,MANAGE_REQ:!0})}var h,p,A,S,D,E,R,f=e.sPlusPlus,b=e.document,m=e.ZSConstants,C=(m.I18N,m.wCC,m.FeatureConstants),y=(m.ConditionalFormatClassicOperator,m.ActionConstants,m.JSKeyCode,e.UIUtil.Component),I=e.ZSEvents,w=I.topic,N=I.Groups,O=I.Names,L=ZSClass.Editors,T=ZSClass.RangePicker,_=e.UserAction,k=(b.getElementById("popupmenu"),{readRange:"DATA_VALIDATION_READRANGE",readSheet:"DATA_VALIDATION_READSHEET",readBook:"DATA_VALIDATION_READWORKBOOK"}),V=[],j=f.view.Toolbar.Feature[C.MANAGE_DATA_VALIDATION];g.prototype={create:function(){var e=S.cloneNode(!0);e.querySelector("p").innerText=this.range,e.querySelector(".txtOverflow").innerText=JSUtil.CFUtils.getInfoTitle(this.obj.cr_nu,this.obj.VALUE,this.obj.cr_ty),this.ruleContainer=b.createElement("div").appendChild(e),this.editRule()},editRule:function(){var e=this.ruleContainer;e.onclick=this.hideEditOption.bind(this),e.querySelector(".cFMenu").onclick=this.showEditOption.bind(this),e.querySelector(".cpy").onclick=this.copy.bind(this),e.querySelector(".edt").onclick=this.edit.bind(this),e.querySelector(".del").onclick=this.delete.bind(this),e.ondblclick=this.edit.bind(this),this.modifyObj()},modifyObj:function(){this.obj.val1=this.obj.VALUE[0],this.obj.val2=this.obj.VALUE[1]},copy:function(){var e=(this.obj,JSON.parse(JSON.stringify(this.obj)));e.mode="COPY",delete e.RANGENAME,v(e)},edit:function(){this.obj.mode="EDIT",this.obj.disable=!0,v(this.obj)},showEditOption:function(){this.hideEditOption();var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),this.ruleContainer.querySelector(".cFMenuPopUp").classList.add("shwEdtOpn")},hideEditOption:function(){var e=A.querySelector(".shwEdtOpn");e&&e.classList.remove("shwEdtOpn")},delete:function(){var e=f.view.getActiveGridID(),t=f.view.getResourceID(e),n=f.view.getSelectedSheets(e),i=f.view.getVersionID(e),o=[],r=this.obj.RANGENAME.split(",");for(var a in r)o.push(JSUtil.Range.parseRange(t,i,r[a].trim()).range);_.RemoveDataValidation(t,n,i,o,this.ruleContainer,R)},getRuleContainer:function(){return this.ruleContainer}},j.openDialog=t,w.register(N.Listener,O.UserAction.DATA_VALIDATION.MANAGE,u,"ALL_DV"),w.register(N.Listener,O.UserAction.DATA_VALIDATION.MANAGE_DIALOG,t,"REQ_NEED")}(this);
!function(e){function t(){var e={width:850,title:T["Data.ManageExternalData"],dialogClass:"leTMCls",close:function(){n()}};if(!h){var t=UserAction.getTemplate(["letManage"]).letManage;d=document.createElement("div"),d.id="DI_WEBDATA",d.appendChild(t),h=new ZSClass.Dialog(d,e),c()}h.open(),i()}function n(){d.querySelector("#manageTable").innerHTML=""}function i(){var e=I.view.getActiveGridID(),t=I.view.getVersionID(e),n=I.view.getResourceID(e),i=(I.data.getWorkBook(n,t).SheetList,I.view.getSheetID(e));m.appendChild(u),UserAction.getWebDataList(n,i,t,1)}function r(){u=document.createElement("span"),u.className="ZsLoader ZsLoaderSmall"}function s(){D=document.createElement("span"),D.innerText=T.NoExternalDataLinkedWithDocument,D.className="ZsNoMsg"}function a(){}function l(e){b.error("webListAry",e),m.innerHTML="",0==e.length&&m.appendChild(D);for(var t in e){var n=new o(e[t]);d.querySelector("#manageTable").appendChild(n.rowElement)}}function o(e){this.parent=d.querySelector("#manageTable"),this.ruleObj=e,this.URL=e.URL,this.startCell=e.cellName,this.interval=e.interval,this.schTime=e.schTime,this.wdCellId=e.wdCellId,this.webDataID=e.webDataId,this.fullURL=e.fullURL,this.sheetID=e.sheetId,this.create(),b.error("creation",e.webDataId)}function c(){var e=UserAction.getTemplate(["letManageRule"]).letManageRule;L=document.createElement("div"),L.appendChild(e),m=d.querySelector("#manageTable"),r(),s()}var h,d,u,D,m,I=e.sPlusPlus,p=e.document,E=e.ZSEvents,g=E.topic,A=E.Groups,w=E.Names,v=(e.UIUtil.Component,p.getElementById("popupmenu"),e.ZSConstants.FeatureConstants),T=e.ZSConstants.I18N,b=(e.ZSConstants.wCC,e.ZSDevTools.Logger),T=e.ZSConstants.I18N,f=I.view.Toolbar.Feature[v.MANAGE_LINK_EXTERNAL];o.prototype={create:function(){this.rowElement=L.children[0].cloneNode(!0),this.rowElement.setAttribute("id",this.webDataID);var e=this.rowElement;e.querySelector("#webURL").innerText=this.URL,e.querySelector("#webURL").setAttribute("title",this.fullURL),e.querySelector("#rangeID").innerText=this.startCell,e.querySelector("#webInterval").innerText=this.interval,e.querySelector("#nxtSch").innerText=this.schTime,this.setEditActions()},setEditActions:function(){this.rowElement.querySelector("#letEdit").onclick=this.edit.bind(this),this.rowElement.querySelector("#letEdit").style.display="none",this.rowElement.querySelector("#letRefresh").onclick=this.refresh.bind(this),this.rowElement.querySelector("#letDel").onclick=this.delete.bind(this)},edit:function(){var e=this.ruleObj;g.publish(A.Listener,w.UserAction.WEB_DATA.EDIT_DIALOG,{EV:void 0,EDIT_OBJ:e}),h.close()},sendReq:function(e){var t=h.sheetID,n=I.data.getWorkBook(h.rID,h.version),i=n.getSheetObj(t).Prop.Name,r=JSUtil.Range.parseRange(h.rID,h.version,this.startCell).sheetID,s=this.startCell.split(".")[1],a=[r],l=!1;r="refresh"==e?r:this.sheetID,b.error("webDataID",this.webDataID),UserAction.refreshWebData(h.rID,a,t,i,h.version,e,r,this.webDataID,l,s)},refresh:function(){this.sendReq("refresh"),h.close()},delete:function(){this.sendReq("delete"),this.parent.removeChild(this.rowElement),0==this.parent.children.length&&m.appendChild(D)}};var L;f.openDialog=t,g.register(A.Listener,w.UserAction.WEB_DATA.LIST,l,"LIST_ARRAY"),g.register(A.Listener,w.UserAction.WEB_DATA.MANAGE_DIALOG,t),I.view.Toolbar.transient.destructor[v.LINK_EXTERNAL_DATA]=a}(this);
!function(e){function t(){var e=E.createElement("ul");e.setAttribute("ctype","zmenu"),e.setAttribute("relativeto","parent"),e.id=r.SUBMENUITEM+a.LINK_EXTERNAL_DATA+r.IDENTITY,u&&u.createElement(e),o&&o.createElement(e),s.appendChild(e)}var n=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,E=e.document,r=(e.ZSConstants.I18N,e.ZSConstants.wCC),s=(n.view.Toolbar.Feature[a.LINK_EXTERNAL_DATA],E.getElementById("popupmenu")),u=n.view.Toolbar.Feature[a.CREATE_LINK_EXTERNAL],o=n.view.Toolbar.Feature[a.MANAGE_LINK_EXTERNAL];t()}(this);
!function(e){function t(t,o){x=t,j=o;var n={modal:!1,width:500,title:L["ProtectRange.UI.Menu.ProtectRange"],close:function(){c()},open:function(){l()}};G||(r(),G=new e.ZSClass.Dialog(K,n),a()),K.querySelector("#appliestorange").style.display="block",K.querySelector("#Note").innerText=L["ProtectedRange.UI.RangeLockCollaboratorsInfo"],G.open()}function r(){var t=e.UserAction.getTemplate(["LOCKCELL"]),r=t.LOCKCELL;K=document.createElement("div"),K.id="DI_LOCK_CELLS",K.appendChild(r),p=K.querySelector("#usersContainer"),K.querySelector("#saveBtn").addEventListener("click",g),K.querySelector("#cancelBtn").addEventListener("click",o),K.querySelector("#select12").addEventListener("change",s)}function o(){G.close()}function n(){var e=y.view.getActiveGridID(),r=y.view.getResourceID(e),o=y.view.getSheetID(e),n=y.view.getVersionID(e),a=y.data.getWorkBook(r,n),a=(y.data.DocRegistry[r][n],y.data.getWorkBook(r,n)),i=y.view.getSheetState(e,o),c=i.getActiveRange(),l=a.getSheetObj(o).ProtectedRanges.getIntersectedRanges(c),s=0!=l.length?c.startRow<l[0].startRow||c.endRow>l[0].endRow||c.startCol<l[0].startCol||c.endCol>l[0].endCol:!1;if(s){var d=L["ProtectedRange.confirm.Extend"];if(l[0].equals(c))t(!1);else{var g=[{text:L.Yes,primary:!0,click:function(){t(!0)}},{text:L.No,click:function(){t(!1)}}],u={buttons:g,title:L["Alert.Title.ExtendLock"]};ZSClass.ZSAlert(d,u)}}else t(!1)}function a(){var t=K.querySelector("#appliestofieldcs");k=new O(t,!0),ZSClass.RangePicker.register(k,!1);var r=t.nextSibling;ZSClass.RangePicker.Dialog.register(k,G,r,L["ProtectRange.UI.Menu.ProtectRange"]),k.addListeners(N),T.animateLabel(k),T.addValidator(k,function(){return e.JSUtil.REGEXP.validCell.test(k.value)},function(){k.Editor.style.borderBottomColor="#dfdfdf"},function(){k.Editor.style.borderBottomColor="#ff8d00"},200)}function i(e){var t=e.keyCode||e.which;13===t&&(e.preventDefault(),o())}function c(){for(var e=p.querySelectorAll('input[type="checkbox"]'),t=0;t<e.length;t++)e[t].checked=!1;p.innerHTML=""}function l(){K.querySelector("#lockCellsLoader").style.display="block",A.disable("#saveBtn"),S(),v()}function s(){for(var e=K.querySelector("#select12").checked,t=p.querySelectorAll('input[type="checkbox"]'),r=0;r<t.length;r++)t[r].checked=e;A.enable("#saveBtn")}function d(){var e=K.querySelector("#select12"),t=p.querySelectorAll('[type="checkbox"]:checked').length,r=Object.keys(W).length;r>t?e.checked=!1:r==t&&(e.checked=!0)}function g(){for(var t=y.view.getActiveGridID(),r=y.view.getResourceID(t),n=y.view.getVersionID(t),a=y.data.getWorkBook(r,n),i=y.view.getSelectedSheets(t),c=p.querySelectorAll('[type="checkbox"]:checked'),l=[],s=W,d=0;d<c.length;d++){var g=c[d].value;l[d]=g,delete s[g]}M=l.join(","),V=Object.keys(s).join(",");for(var v=u(r,n,k),S=y.view.getSheetID(t),f=a.getSheetObj(S),h=(f.ProtectedRanges.RangeList.masterList,!1),R=0;R<v.length;R++)for(var C=v[R],w=a.getSheetObj(S).ProtectedRanges.getIntersectedRanges(C),I=0;I<w.length;I++)w[I].equals(C)&&(h=!0);h&&0==l.length?e.UserAction.RemoveLockRange(r,i,v,n):e.UserAction.LockRange(r,i,v,n,V,M,!1,x),o()}function u(e,t,r){for(var o,n=[],a=(r.value.trim().replace(";",","),r.value.trim().replace(/;/g,",").split(",")),i=0;i<a.length;i++){var c=JSUtil.Range.parseRange(e,t,a[i].trim());0==i&&(o=c.sheetID),n.push(c.range)}return n}function v(){var t=y.view.getActiveGridID(),r=y.view.getResourceID(t),o=y.view.getVersionID(t),n=y.view.getSelectedSheets(t);e.UserAction.checkRangeLockInfo(r,n,o,!1,x,j)}function S(){var e=y.view.getActiveGridID(),t=y.view.getResourceID(e),r=y.view.getSheetID(e),o=y.view.getVersionID(e),n=y.data.getWorkBook(t,o),a=n.getSheetObj(r),i=(a.Prop.getName(),y.view.getSheetState(y.view.getActiveGridID(),r)),c=void 0==j?i.getRanges():[j],l=K.querySelector("#appliestofieldcs");l.focus(),ZSClass.RangePicker.setRanges(t,r,o,c)}function f(e,t){F[e]=t}function h(e,t){if(!t){for(;p.firstChild;)p.removeChild(p.firstChild);K.querySelector("#lockCellsLoader").style.display="none";{new R(p,e)}}}function R(e,t){this.parent=e,this.addCollaborators(t.pr)}function C(e){var t="";switch(e){case"coU":t=L["ProtectRange.UI.CoOwner"];break;case"rwU":t=L["ProtectRange.UI.ReadWrite"];break;case"roU":t=L["ProtectRange.UI.ReadOnly"];break;case"rcU":t=L["ProtectRange.UI.ReadComment"];break;default:t=L["ProtectRange.UI.Users"]}return t}var p,k,y=e.sPlusPlus,w=e.ZSConstants,I=w.FeatureConstants,E=e.document,L=e.ZSConstants.I18N,b=(e.ZSConstants.wCC,e.ZSEvents),U=b.topic,m=b.Groups,D=b.Names,P=e.UserAction,A=(E.getElementById("popupmenu"),e.UIUtil.Component),q=e.JSUtil,O=(e.ZSConstants.ActionConstants,ZSClass.Editors.RangeEditor),T=(ZSClass.Editors.TextAreaEditor,ZSClass.Editors.Utility),x=!1,B=y.data.AppRegistry.USER_PHOTO_SERVER_URL,Z=y.view.Toolbar.Feature[I.LOCK_CELLS],_=y.view.Toolbar.Feature[I.LOCK],G=(y.view.Toolbar.Feature[I.LOCK_SHEET],void 0),K=void 0,j=void 0,N={keydown:i},M=new q.StringBuffer,V=new q.StringBuffer,W={},F={};R.prototype={createUser:function(e,t,r){var o=e.zuid,n=P.getTemplate(["LOCK_USERS_TEMPLATE"]).LOCK_USERS_TEMPLATE,a=document.createElement("div");a.className="dspTblRow",a.appendChild(n),a.querySelector("#profile").src=B+"/file?fs=thumb&ID="+o,a.querySelector("#name").textContent=e.name,a.querySelector("#name").title=e.email,a.querySelector("#userType").textContent=r;var i=a.querySelector('input[type="checkbox"]');e.lock&&(i.checked=!0),o==y.data.UserInfo.zuid&&(a.querySelector("#me").style.display="block"),i.value=o,i.addEventListener("change",function(){A.enable("#saveBtn"),d()}),W[o]=o,this.parent.appendChild(a)},addCollaborators:function(e){var t=y.view.getActiveGridID(),r=(y.view.getResourceID(t),0);this.createUser(e.owner,r,L["ProtectRange.UI.Owner"]);for(var o in e)for(var n=C(o),a=0;a<e[o].length;a++,r++)this.createUser(e[o][a],r,n);d()}},_.openDialog=n,Z.openDialog=n,Z.showDialog=t,U.register(m.Listener,D.UserAction.SHOW_LOCK_INFO,h,"lockInfo","isSheet"),U.register(m.Listener,D.SheetMeta.PROTECTED_RANGES,f,"SHEETID","RangeList")}(this);
!function(e){function t(){var e=r.createElement("ul");e.setAttribute("data-ctype","zmenu"),e.setAttribute("data-content-type","text"),e.setAttribute("relativeto","parent"),e.id=i.SUBMENUITEM+o.LOCK_CELLS+i.IDENTITY,C&&C.createElement(e),E&&E.createElement(e),m&&m.createElement(e),a(e),T&&T.createMenuElement(e),s.appendChild(e),l.bind(e,"zmenuitemclick",function(e,t){var a=t.data.action;switch(a){case"lockcells":C.openDialog(!1);break;case"locksheet":E.openDialog(!0);break;case"managelock":m.openDialog();break;case"highlightlock":I.execute()}}),l.bind(e,"zmenubeforeshow",function(){u.publish(p.UI,b.Toolbar.INIT_MENU,{DOM:e})})}function a(e){var t=r.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}var n=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,r=e.document,i=(e.ZSConstants.I18N,e.ZSConstants.wCC),l=e.UIUtil.Component,s=(n.view.Toolbar.Feature[o.LOCK_CELLS],r.getElementById("popupmenu")),c=e.ZSEvents,u=c.topic,p=c.Groups,b=c.Names,C=n.view.Toolbar.Feature[o.LOCK],E=n.view.Toolbar.Feature[o.LOCK_SHEET],m=n.view.Toolbar.Feature[o.MANAGE_LOCK_SETTINGS],T=n.view.Toolbar.Feature[o.HIGHLIGHT_LOCKS],I=n.view.Toolbar.Feature[o.HIGHLIGHT_LOCKS];t()}(this);
!function(e){function t(){if(!m){var t={modal:!0,width:580,title:h["MenuItem.DataTab.Lock.ManageLockSettings"],close:function(){r()},open:function(){s()}};m=new e.ZSClass.Dialog(o(),t)}k.manageDlgWrapper.querySelector("#saveBtn").style.display="none",k.manageDlgWrapper.querySelector("#manageLockInfo").style.display="none",m.open(),c()}function n(){var e=d.view.getActiveGridID(),t=d.view.getResourceID(e),n=d.view.getVersionID(e),o=d.data.getWorkBook(t,n).SheetList,r=d.view.getSheetID(e),s=(d.data.getWorkBook(t,n),h.WholeDocument),i=document.createElement("option");i.value="All",i.innerText=s,g.appendChild(i),k.loadedSheets.All=0;for(var c=0;c<o.length;c++){s=o[c].Name;var i=document.createElement("option");i.value=o[c].Id,i.innerText=s,g.appendChild(i),k.loadedSheets[o[c].Id]=0}D.zcombo("#appliestofieldM","refresh"),D.bind("#appliestofieldM","zselectboxchange",function(e,t){a(e,t)}),D.zcombo("#appliestofieldM","setValue",r)}function a(t,n){{var a=d.view.getActiveGridID(),o=d.view.getResourceID(a),r=d.view.getVersionID(a),s=d.view.getSelectedSheets(a);d.data.getWorkBook(o,r)}k.selectedSheetId=n.value,k.RangeLocksContainer.isWholeDocument=!1,"All"===k.selectedSheetId&&(k.RangeLocksContainer.isWholeDocument=!0),D.zcombo(g,"setValue",k.selectedSheetId),0==k.loadedSheets[k.selectedSheetId]?e.UserAction.readProtectedRanges(o,s,k.RangeLocksContainer.isWholeDocument?d.view.getSheetID(a):k.selectedSheetId,r,k.RangeLocksContainer.isWholeDocument):k.RangeLocksContainer.show()}function o(){var t=e.UserAction.getTemplate(["MANAGE_LOCKCELL"]),n=t.MANAGE_LOCKCELL;return k.manageDlgWrapper=document.createElement("div"),k.manageDlgWrapper.id="DI_MANAGE_LOCKCELL",k.manageDlgWrapper.appendChild(n),g=k.manageDlgWrapper.querySelector("#appliestofieldM"),k.manageDlgWrapper.querySelector("#rangeOpt").addEventListener("click",function(){k.RangeLocksContainer.show()}),k.manageDlgWrapper.querySelector("#sheetOpt").addEventListener("click",function(){k.SheetLocksContainer.show()}),k.manageDlgWrapper.querySelector("#saveBtn").onclick=l,k.manageDlgWrapper.querySelector("#cancelBtn").onclick=i,k.manageDlgWrapper}function r(){k.SheetLocksContainer.container.innerHTML="<span id='sheetLocksLoader'  class='ZsLoader ZsLoaderSmall'></span>",k.RangeLocksContainer.container.innerHTML="<span id='rangeLocksLoader'  class='ZsLoader ZsLoaderSmall'></span>",k.sheetLocksConstructed=!1,k.rangeLocksConstructed=!1,k.selectedSheetId="",g.innerHTML="",k.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none"}function s(){var t=d.view.getActiveGridID(),a=d.view.getResourceID(t),o=d.view.getVersionID(t),r=d.view.getSelectedSheets(t),s=d.view.getSheetID(t);k.selectedSheetId=s,n(),e.UserAction.readProtectedRanges(a,r,s,o,!1)}function i(){m.close()}function c(){k.modifiedRanges=[],k.sheetLocks={},k.rangeLocks={},k.SheetLocksContainer=new ZSClass.SheetLocksContainer(k.manageDlgWrapper.querySelector("#sheetLocksContainer")),k.RangeLocksContainer=new ZSClass.RangeLocksContainer(k.manageDlgWrapper.querySelector("#rangeLocksContainer")),k.RangeLocksContainer.isWholeDocument=!1}function l(){var t=d.view.getActiveGridID(),n=d.view.getResourceID(t),a=(d.view.getSheetID(t),d.view.getVersionID(t)),o=(d.data.getWorkBook(n,a),d.view.getSelectedSheets(t));k.enableManageLocks(!1),e.UserAction.manageLockRange(n,k.modifiedRanges,o,a,k.isSheetTabSelected)}var g,d=e.sPlusPlus,p=e.ZSEvents,u=p.topic,L=p.Groups,S=p.Names,h=e.ZSConstants.I18N,v=e.ZSConstants.FeatureConstants,m=void 0,D=e.UIUtil.Component,k=d.view.Toolbar.Feature[v.MANAGE_LOCK_SETTINGS];k.isSheetTabSelected=!1,k.manageDlgWrapper=void 0,k.loadedSheets={},k.selectedSheetId="",k.openDialog=t,u.register(L.Listener,S.UserAction.MANAGE_LOCK_DLG,t)}(this);
!function(e){function t(e){if(!i){var t={modal:!0,width:340,title:p["SaveAs.New.SpreadSheet"],dialogClass:"",close:function(){},open:function(){n()}};a(t)}i.open(),e.preventDefault()}function n(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),n=S.view.getVersionID(e),a=S.data.getWorkBook(t,n);d.className="Zsbtn",u.nodeValue=p["Dialog.Button.Save"],c.style.display="none",m.style.display="block",D.style.display="block",l.value=JSUtil.fn.replaceParams(p.CopyOfName,new Array(a.Name)),l.select()}function a(t){var n=e.UserAction.getTemplate(["SP_SAVEAS"]),a=n.SP_SAVEAS,S=document.createElement("div");S.id=g.DI+v.SAVE_AS+g.IDENTITY,S.appendChild(a),i=new e.ZSClass.Dialog(S,t);var p=i.getKeyContext();return p.keyDown[y.ENTER]=function(){o()},d=S.getElementsByTagName("button")[0],D=S.getElementsByTagName("button")[1],d.addEventListener("click",function(){o()}),D.addEventListener("click",s),u=d.childNodes[1],l=S.querySelector("#copiedSpreadsheetName"),r=S.querySelector("#copiedSpreadsheetLink"),c=S.querySelector(".zssucState"),m=S.querySelector("#saveAsInp"),S}function s(){i.close()}function o(){var t=S.view.getActiveGridID(),n=S.view.getResourceID(t),a=S.view.getVersionID(t),s=l.value;s&&0!==s.trim().length?(d.className="Zsbtn ZsRt",u.nodeValue=p["Dialog.Button.Saving"]+"...",D.style.display="none",e.UserAction.saveAs(n,a,s)):ZSClass.ZSAlert(p["InvalidMsg.SpreadsheetName"],{title:p["Alert.Title.EnterFileName"]})}var i,l,r,c,d,u,S=e.sPlusPlus,v=e.ZSConstants.FeatureConstants,g=e.ZSConstants.wCC,p=ZSConstants.I18N,y=ZSConstants.JSKeyCode,A=S.view.Toolbar.Feature[v.SAVEAS],m=void 0,D=void 0;A.openDialog=t,A.closeDialog=s}(this);
!function(e){function t(){if(!s){var t={width:540,title:S["FormTab.CreateForm"],open:function(){n()}};a(),s=new e.ZSClass.Dialog(l,t)}s.open();var o=C.view.getActiveGridID(),i=C.view.getResourceID(o),r=C.view.getVersionID(o),d=C.data.getWorkBook(i,r),u=d.Name;c.value=u,c.setSelectionRange(0,u.length),c.focus()}function n(){u.className="Zsbtn",v.textContent=S["Dialog.Button.Create"],g.style.display="",d.value=""}function o(){s&&s.close()}function a(){var t=e.UserAction.getTemplate(["CREATEFORM"]),n=t.CREATEFORM,o=n.querySelector("#formName");c=new w.TextAreaEditor(o);var a={keydown:function(e){var t=e.keyCode||e.which;t==ZSConstants.JSKeyCode.ENTER&&(e.stopPropagation(),i(),s.close())}};c.addListeners(a);var r=n.querySelector("#description");d=new w.TextAreaEditor(r),d.addListeners(a),u=n.querySelector("#createBtn"),v=u.childNodes[1],u.addEventListener("click",function(){i()}),g=n.querySelector("#cancelBtn"),g.addEventListener("click",function(){s.close()}),l=document.createElement("div"),l.id=E.DI+m.CREATE_FORM+E.IDENTITY,l.appendChild(n)}function i(){var e=c.value;if(e=e.trim(),""===e)return void ZSClass.ZSAlert(S["Form.InvalidNameMessage"],{title:S["Alert.Title.InvalidFormName"]});u.className="Zsbtn ZsRt",v.textContent=S["Dialog.Button.Creating"]+"...",g.style.display="none",e=r(e.trim());var t=d.value,n=C.view.getActiveGridID(),o=C.view.getSheetID(n),a=C.view.getResourceID(n),i=C.view.getVersionID(n),s=C.view.getSelectedSheets(n),l=C.data.getWorkBook(a,i),m=l.getSheetObj(o).Prop.getName();UserAction.createForm(a,s,i,e,t,m)}function r(e){var t=new RegExp("['\"<>#?/%&\\\\]","g");return e.replace(t,"-")}var s,l,c,d,u,v,g,C=e.sPlusPlus,m=e.ZSConstants.FeatureConstants,E=e.ZSConstants.wCC,S=ZSConstants.I18N,w=ZSClass.Editors,f=C.view.Toolbar.Feature[m.CREATE_FORM];f.openDialog=t,f.closeDialog=o}(this);
!function(e){function t(){var e=[{text:i.Yes,primary:!0,click:function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getSheetID(e),r=o.view.getVersionID(e),i=o.data.getWorkBook(t,r),a=i.FormSheets[n],l=a[s.FORM_RID];UserAction.deleteForm(t,n,r,l)}},{text:i.No}],t={buttons:e,title:i["Alert.Title.FormDelete"]};ZSClass.ZSAlert(i["Alert.Message.FormDeleteConfirmation"],t)}var o=e.sPlusPlus,s=ZSConstants.CommandConstants,n=e.ZSConstants.FeatureConstants,r=o.view.Toolbar.Feature[n.DELETE_FORM],i=e.ZSConstants.I18N;r.openDialog=t}(this);
!function(e){function t(){if(!S){var t={width:540,title:C["Publish.Form"],close:function(){},open:n};r(),S=new e.ZSClass.Dialog(P,t)}S.open()}function i(){o(),R.unregister(M.Listener,U.DocAction.FORM_SHEETS.MODIFY,i)}function r(){var t=e.UserAction.getTemplate(["PUBLISH_OPTIONS","FORM_PUBLISH_TEMPLATE","OK_CANCEL_TEMPLATE"]),r=(t.PUBLISH_OPTIONS,t.FORM_PUBLISH_TEMPLATE),n=t.OK_CANCEL_TEMPLATE,o=n.querySelector("#okBtn");o.addEventListener("click",function(){var e=L.view.getActiveGridID(),t=L.view.getSheetID(e),r=L.view.getResourceID(e),n=L.view.getVersionID(e),o=L.data.getWorkBook(r,n),a=o.FormSheets[t],l=a[w.FORM_RID];UserAction.publishForm(r,t,n,l,u,!0),R.register(M.Listener,U.DocAction.FORM_SHEETS.MODIFY,i),S.close()});var a=n.querySelector("#clBtn");a.addEventListener("click",function(){S.close()}),P=document.createElement("div"),P.id=D.DI+_.PUBLISH_FORM+D.IDENTITY,d=sPlusPlus.data.UserInfo.orgName,void 0!=d&&P.appendChild(t.PUBLISH_OPTIONS),P.appendChild(r),P.appendChild(n)}function n(){if(u=A.ORG,void 0!=d){P.querySelector("#withinNetworkLabel").innerText=k.fn.replaceParams(C["Share.Public.MakePublicWithin"],[d]),P.querySelector("#withinNetwork").checked=!0,P.querySelector("#publicInfoMessage").innerText=k.fn.replaceParams(C["Form.Public.Org.Warning.WithDomain"],[d]);var e=P.querySelector("#externalWorld");e.addEventListener("change",function(){u=A.PUBLIC,P.querySelector("#publicInfoMessage").innerText=C["FormTab.Dialog.LinkExternalDataMsg"]});var t=P.querySelector("#withinNetwork");t.addEventListener("change",function(){u=A.ORG,P.querySelector("#publicInfoMessage").innerText=k.fn.replaceParams(C["Form.Public.Org.Warning.WithDomain"],[d])})}}function o(){var t=L.view.getActiveGridID(),i=L.view.getSheetID(t),r=L.view.getResourceID(t),n=L.view.getVersionID(t),o=L.data.getWorkBook(r,n),l=o.FormSheets[i],c=l[w.FORM_RID];if(!g){var s={width:540,title:C["Share.ViewPublicURL"],close:function(){},open:function(){}};a(),g=new e.ZSClass.Dialog(m,s)}var t=L.view.getActiveGridID(),r=L.view.getResourceID(t),i=L.view.getSheetID(t),n=L.view.getVersionID(t),o=L.data.getWorkBook(r,n),S=o.FormSheets[i];if(u=S[w.FORM_PUBLISH_TYPE],g.open(),void 0!=d){m.querySelector("option[value='org']").innerText=k.fn.replaceParams(C["Share.Public.MakePublicWithin"],[d]);var P=m.querySelector("#pubOption");u==A.PUBLIC?O.zcombo(P,"setValue","external"):O.zcombo(P,"setValue","org"),m.querySelector("#publishMsg").innerText=k.fn.replaceParams(C["Share.Public.PublishType"],[C["Dialog.Publish.Form"]])}var T=F+y+c;E.href=T,E.text=T,I=p+T+h,v.textContent=I}function a(){var t=e.UserAction.getTemplate(["CHANGE_PUBLISH_OPTIONS","VIEW_PUBLISH_URL","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]),i=t.CHANGE_PUBLISH_OPTIONS,r=t.VIEW_PUBLISH_URL,n=t.EMBED_SNIPPET_TEMPLATE,o=t.EMBED_REVERT_CANCEL_TEMPLATE;E=r.querySelector("#zsPublicUrlLink"),v=n.querySelector("#embedCode"),p='<iframe style="position:absolute;height:100%;width:99%;border:none;" frameborder=0 src="',h='"></iframe>';var a=r.querySelector("#publicURL"),l={inputToSelect:E,cssClass:"frmSnpt"},s=new ZSClass.CopyToClipboard(a,l);s.createElement();var S=n.querySelector("#embedSnippetCode"),P={inputToSelect:v,cssClass:"frmSnpt"},s=new ZSClass.CopyToClipboard(S,P);s.createElement();var I=o.querySelector("#btnCancel");I.addEventListener("click",function(){g.close()});var T=o.querySelector("#btnRemovePublic");if(T.addEventListener("click",function(){c(),g.close()}),m=document.createElement("div"),m.id=D.DI+_.PUBLISH_FORM+"_VIEW_PUBLISH_URL"+D.IDENTITY,d=L.data.UserInfo.orgName,void 0!=d){m.appendChild(i);var b=u==A.PUBLIC?C["Share.Public.MakePublicToExternal"]:k.fn.replaceParams(C["Share.Public.MakePublicWithin"],[d]);m.querySelector("#publishMsg").innerText=k.fn.replaceParams(C["Share.Public.PublishType"],[C["Dialog.Publish.Form"]])+" "+b}m.appendChild(r),m.appendChild(n),m.appendChild(o),m.querySelector("#embedSnipetMsg").innerText=k.fn.replaceParams(C["Dialog.Publish.EmbedMessage"],[C["Dialog.Publish.Form"]]);var f=m.querySelector("#pubOption");O.bind(f,"zselectboxchange",function(e,t){u="external"==t.value?A.PUBLIC:A.ORG;var i=L.view.getActiveGridID(),r=L.view.getSheetID(i),n=L.view.getResourceID(i),o=L.view.getVersionID(i),a=L.data.getWorkBook(n,o),l=a.FormSheets[r],c=l[w.FORM_RID];UserAction.publishForm(n,r,o,c,u,!0)})}function l(){var e=L.view.getActiveGridID(),t=L.view.getSheetID(e),i=L.view.getResourceID(e),r=L.view.getVersionID(e),n=L.data.getWorkBook(i,r),o=n.FormSheets[t],a=o[w.FORM_RID],l=o[w.FORM_PUBLISH_TYPE];UserAction.publishForm(i,t,r,a,l,!1)}function c(){if(!T){var t={width:540,title:C.RemovePublic,close:function(){},open:function(){}};s(),T=new e.ZSClass.Dialog(b,t)}T.open()}function s(){var t=e.UserAction.getTemplate(["REMOVE_PUBLISH_TEMPLATE"]),i=t.REMOVE_PUBLISH_TEMPLATE,r=i.querySelector(".publishWarning");r.textContent=C["FormTab.Dialog.RemovePublicMsg"];var n=i.querySelector("#removeBtn");n.addEventListener("click",function(){l(),T.close()});var o=i.querySelector("#dontRemoveBtn");o.addEventListener("click",function(){T.close()}),b=document.createElement("div"),b.id=D.DI+_.PUBLISH_FORM+"_REMOVE_PUBLIC"+D.IDENTITY,b.appendChild(i)}var u,S,P,d,E,I,v,p,h,g,m,T,b,L=e.sPlusPlus,_=e.ZSConstants.FeatureConstants,D=e.ZSConstants.wCC,C=ZSConstants.I18N,f=e.ZSEvents,R=f.topic,M=f.Groups,U=f.Names,w=ZSConstants.CommandConstants,O=e.UIUtil.Component,B=L.view.Toolbar.Feature[_.PUBLISH_FORM],F=L.data.AppRegistry.FORM_SERVER_URL,y="/published.do?rid=",A={ORG:1,PUBLIC:2},k=e.JSUtil;B.showPublishDialog=t,B.showPublishedUrl=o,B.showRemovePublishDialog=c}(this);
!function(e){function t(){var t={width:600,title:Z.AT,close:function(){i()},open:function(){n()}};if(!o){var s=UserAction.getTemplate([k]),u=s[k];c=document.createElement("div"),c.id=T.DI+q.AUDIT_TRAIL+T.IDENTITY,o=new ZSClass.Dialog(c,t),a(u),c.appendChild(u)}o.open(),l.innerHTML="",l.appendChild(b),e.UserAction.getActionList(o.rID,o.version,!0,!0,r)}function n(){u.click(),C=E.zdatetimefield("#from","getElement"),D=E.zdatetimefield("#to","getElement"),C.hide(),D.hide()}function i(){var t=m.view.getActiveGridID(),n=m.view.getResourceID(t),i=m.view.getSheetID(t),r=m.view.getVersionID(t);e.UserAction.clearActionList(n,i,r)}function r(e,t,n){n&&s(e,t,n)}function s(e,t,n){var i=m.view.actionListManager;i.appendAction(n);var r=!0;h&&(r=!1),h=new ZSClass.UIAuditUser(e,u,i,l,v,r);var s=new Event("change");h.select.dispatchEvent(s);var a=!0;f&&(a=!1),f=new ZSClass.UIAuditSheet(t,S,i,l,y,o,a),!p&&(p=new ZSClass.UIAuditDate(d,i,l,I,C,D,w,o)),!L&&(L=new ZSClass.UIAuditRange(g,i,l,A,o)),U.style.display=Object.keys(n).length<1e3?"none":""}function a(e){u=e.querySelector("#byUser"),v=e.querySelector("#userList"),d=e.querySelector("#byDate"),I=e.querySelector("#dateList"),w=e.querySelector("#showDetails"),S=e.querySelector("#bySheet"),y=e.querySelector("#sheetList"),g=e.querySelector("#byRange"),A=new ZSClass.Editors.RangeEditor(e.querySelector("#rangePickerDiv")),U=e.querySelector("#thousandEdits");var t=e.querySelector("#cancelBtn");t.addEventListener("click",function(){o.close()}),ZSClass.RangePicker.register(A,!0);var n=e.querySelector("#rangePickerIcon");ZSClass.RangePicker.Dialog.register(A,o,n,Z.AT),l=e.querySelector("#actionLogContainer")}var o,c,l,u,d,S,g,v,I,y,A,C,D,w,h,f,p,L,U,m=e.sPlusPlus,q=e.ZSConstants.FeatureConstants,T=e.ZSConstants.wCC,Z=ZSConstants.I18N,E=e.UIUtil.Component,R=m.view.Toolbar.Feature[q.AUDIT_TRAIL],k="AUDIT_TRAIL",b=e.document.createElement("span");b.className="ZsLoader ZsLoaderSmall",R.openDialog=t}(this);
!function(t){function n(t,n,s,e){this.Tab=t,this.Container=n,this.listManager=s,this.noEditsMsg=e}function s(t,n){var s=new e;return s.setColorCode(t.cc),s.setName(t.un),s.setTime(t.ts),t.irb&&s.setAsRollBackAction(),s.setMessage(s.processMessage(t)),s.append(n),s}var e=ZSClass.UIActionLog,i=t.document.createElement("span");i.classList.add("ZsNoMsg"),n.prototype={place:function(t){t=t?t:{};var n=Object.keys(t),e=n.length;this.Container.innerHTML="",e||(i.textContent=this.noEditsMsg,this.Container.appendChild(i));for(var a=e-1;a>=0;a--){s(t[n[a]],this.Container)}},getTab:function(){return this.Tab},getContainer:function(){return this.Container},getListManager:function(){return this.listManager},getNoEditMsg:function(){return this.noEditsMsg}},ZSClass.UIAudit=n}(this);
!function(e){function t(e,t,n,a,c,r){this.audit=new ZSClass.UIAudit(t,a,n,o["AT.NoEdits.User"]),this.select=c,this.userMap=e,i.call(this,e),r&&s.call(this)}function n(e,t){var n=new r;return n.setColorCode(e.cc),n.setName(e.un),n.setTime(e.ts),e.irb&&n.setAsRollBackAction(),n.setMessage(n.processMessage(e)),n.append(t),n}function s(){var e=this;c.bind(this.select,"zselectboxchange",function(){var t=new Event("change");e.select.dispatchEvent(t)});var t=e.audit.getTab();t.addEventListener("click",function(){var t=new Event("change");e.select.dispatchEvent(t)}),this.select.addEventListener("change",function(){var t=e.audit.getListManager(),n=this.value==d?t.getActionList():t.getByUser(this.value),s=n?Object.keys(n).length:0;s?e.place(n):e.showNoEditMsg()})}function a(e,t){var n=document.createDocumentFragment(),s=document.createElement("option");s.value=e,s.textContent=t;var a=document.createElement("optGroup");return a.setAttribute("mtype","seperator"),n.appendChild(s),n.appendChild(a),n}function i(e){var t,n=document.createDocumentFragment(),s=Object.keys(e),i=s.length;i>1&&(t=d,n=a(t,u));for(var o=0;i>o;o++){var r=document.createElement("option");r.value=r.textContent=e[s[o]],n.appendChild(r)}this.select.innerHTML="",this.select.appendChild(n),c.zcombo(this.select,"refresh"),c.zcombo(this.select,"setValue",t?t:e[s[0]])}var c=(e.ZSClass.UIAudit,e.UIUtil.Component),o=e.ZSConstants.I18N,r=e.ZSClass.UIActionLog,l=e.document.createElement("span");l.classList.add("ZsNoMsg");var d="selectAll",u="All Users";t.prototype={place:function(e){var t=Object.keys(e),s=t.length,a=this.audit.getContainer();a.innerHTML="";for(var i=s-1;i>=0;i--)n(e[t[i]],a)},showNoEditMsg:function(){var e=this.audit.getContainer();e.innerHTML="",l.textContent=this.select.value==d?o["AT.NoEdits.Spreadsheet"]:this.select.value+" "+this.audit.getNoEditMsg(),e.appendChild(l)}},ZSClass.UIAuditUser=t}(this);
!function(t){function e(t,e,a,s,l,o,d,r){this.audit=new ZSClass.UIAudit(t,a,e,c["AT.NoEdits.Date"]),this.select=s,this.fromDateInput=l,this.toDateInput=o,this.showDetailsBtn=d,this.auditTrailDialog=r,n.call(this),i.call(this)}function i(){var t=this;o.bind(this.select,"zselectboxchange",function(){var e=new Event("change");t.select.dispatchEvent(e)});var e=this.audit.getTab();e.addEventListener("click",function(){var e=new Event("change");t.select.dispatchEvent(e)}),this.select.addEventListener("change",function(){var e=t.audit.getListManager();"all"==this.value?(s.call(t,"none","none","none"),t.audit.place(e.getActionList())):l.call(t,~~this.value)}),this.showDetailsBtn.addEventListener("click",function(){{var e,i,a,n,s,l,r,u,h;t.audit.getListManager()}switch(~~t.select.value){case d.EQUAL:case d.LESS_THAN:case d.GREATER_THAN:if(e=o.zdatetimefield("#from","getValue").dateObject,!e||!e.getTime())return void ZSClass.ZSAlert(c["AT.Alert.Date"],{title:c["Alert.Title.InvalidDate"]});n=e.getDate(),s=e.getMonth(),l=e.getFullYear(),UserAction.AuditFilterByDate(t.auditTrailDialog.rID,t.auditTrailDialog.version,~~t.select.value,s+1+"/"+n+"/"+l,void 0,t.audit.place.bind(t.audit));break;case d.BETWEEN:case d.NOT_BETWEEN:if(e=o.zdatetimefield("#from","getValue").dateObject,i=o.zdatetimefield("#to","getValue").dateObject,!(e&&e.getTime()&&i&&i.getTime()))return void ZSClass.ZSAlert(c["AT.Alert.Date"],{title:c["Alert.Title.InvalidDate"]});n=e.getDate(),s=e.getMonth(),l=e.getFullYear(),r=i.getDate(),u=i.getMonth(),h=i.getFullYear(),UserAction.AuditFilterByDate(t.auditTrailDialog.rID,t.auditTrailDialog.version,~~t.select.value,s+1+"/"+n+"/"+l,u+1+"/"+r+"/"+h,t.audit.place.bind(t.audit))}t.audit.place(a)})}function a(t,e){var i=document.createDocumentFragment(),a=document.createElement("option");a.value=t,a.textContent=e;var n=document.createElement("optGroup");return n.setAttribute("mtype","seperator"),i.appendChild(a),i.appendChild(n),i}function n(){for(var t=a("all","All"),e=0;e<r.length;e++){var i=document.createElement("option");i.value=u[e],i.textContent=c[r[e]],t.appendChild(i)}this.select.innerHTML="",this.select.appendChild(t),o.zcombo(this.select,"refresh"),o.zcombo(this.select,"setValue","all")}function s(t,e,i){t?this.fromDateInput.hide():this.fromDateInput.show(),e?this.toDateInput.hide():this.toDateInput.show(),this.showDetailsBtn.style.display=i}function l(t){switch(t){case d.TODAY:case d.YESTERDAY:case d.THIS_WEEK:case d.LAST_WEEK:case d.THIS_MONTH:case d.LAST_MONTH:s.call(this,"none","none","none"),UserAction.AuditFilterByDate(this.auditTrailDialog.rID,this.auditTrailDialog.version,t,void 0,void 0,this.audit.place.bind(this.audit));break;case d.EQUAL:case d.LESS_THAN:case d.GREATER_THAN:s.call(this,"","none","");break;case d.BETWEEN:case d.NOT_BETWEEN:s.call(this,"","","")}}var o=(t.ZSClass.UIAudit,t.UIUtil.Component),c=t.ZSConstants.I18N,d=ZSConstants.ConditionalFormatClassicOperator,r=["Condition.Today","Condition.Yesterday","Condition.ThisWeek","Condition.LastWeek","Condition.ThisMonth","Condition.LastMonth","Condition.DateOn","Condition.DateBefore","Condition.DateAfter","Condition.Between","Condition.NotBetween"],u=[d.TODAY,d.YESTERDAY,d.THIS_WEEK,d.LAST_WEEK,d.THIS_MONTH,d.LAST_MONTH,d.EQUAL,d.LESS_THAN,d.GREATER_THAN,d.BETWEEN,d.NOT_BETWEEN];ZSClass.UIAuditDate=e}(this);
!function(t){function i(t,i,a,r,s){this.audit=new ZSClass.UIAudit(t,a,i,n["AT.NoEdits.Range"]),this.rangePickerEditor=r,this.auditTrailDialog=s,e.call(this)}function e(){var t=this,i=t.audit.getTab();i.addEventListener("click",function(){t.rangePickerEditor.focus(),t.audit.place()});var e=!0,n={valueChanged:function(){e&&(e=!1,setTimeout(function(){r.rangeRegex.test(t.rangePickerEditor.value)&&t.filterByRange(t.rangePickerEditor.value),e=!0},500))}};this.rangePickerEditor.addListeners(n),this.rangePickerEditor.customPreventDefault=a}function a(t){var i=t.keyCode||t.which;return i==ZSConstants.JSKeyCode.ENTER?(t.preventDefault(),!0):void 0}var n=(t.ZSClass.UIAudit,t.UIUtil.Component,t.ZSConstants.I18N),r=t.JSUtil.REGEXP,s=t.document.createElement("span");s.className="ZsLoader ZsLoaderSmall",i.prototype.filterByRange=function(t){var i=this.audit.getContainer();i.innerHTML="",i.appendChild(s),UserAction.AuditFilterByRange(this.auditTrailDialog.rID,this.auditTrailDialog.version,t,this.audit.place.bind(this.audit))},ZSClass.UIAuditRange=i}(this);
!function(t){function e(t,e,n,s,c,r,l){this.audit=new ZSClass.UIAudit(e,s,n,o["AT.NoEdits.Sheet"]),this.select=c,this.auditTrailDialog=r,this.sheetMap=t,a.call(this,t),l&&i.call(this)}function i(){var t=this;s.bind(t.select,"zselectboxchange",function(){var e=new Event("change");t.select.dispatchEvent(e)});var e=t.audit.getTab();e.addEventListener("click",function(){var e=new Event("change");t.select.dispatchEvent(e)}),this.select.addEventListener("change",function(){var e=t.audit.getListManager();"workbook"==this.value?t.audit.place(e.getActionList()):t.filterBySheet(this.value)})}function n(t,e){var i=document.createDocumentFragment(),n=document.createElement("option");n.value=t,n.textContent=e;var a=document.createElement("optGroup");return a.setAttribute("mtype","seperator"),i.appendChild(n),i.appendChild(a),i}function a(t){var e,i=document.createDocumentFragment(),a=Object.keys(t),o=a.length;o>=1&&(e="workbook",i=n(e,"Whole Document"));for(var c=0;o>c;c++){var r=document.createElement("option");r.value=r.textContent=t[a[c]],i.appendChild(r)}this.select.innerHTML="",this.select.appendChild(i),s.zcombo(this.select,"refresh"),s.zcombo(this.select,"setValue",e?e:t[a[0]])}var s=(t.ZSClass.UIAudit,t.UIUtil.Component),o=t.ZSConstants.I18N,c=t.document.createElement("span");c.className="ZsLoader ZsLoaderSmall",e.prototype.filterBySheet=function(t){this.audit.Container.innerHTML="",this.audit.Container.appendChild(c),UserAction.AuditFilterBySheet(this.auditTrailDialog.rID,this.auditTrailDialog.version,t,this.audit.place.bind(this.audit))},ZSClass.UIAuditSheet=e}(this);
!function(e){function t(e){if(!e.repeat){w.printPreviewObj=void 0;var t={modal:!0,width:650,model:!0,title:m["Print.PrintSettings"],open:function(){u()}};g||(i(),o(),g=new b.Dialog(h,t)),a(),g.open()}}function i(){var t=e.UserAction.getTemplate(["PRINT_TEMPLATE"]),i=t.PRINT_TEMPLATE;h=document.createElement("div"),h.id=y.DI+S.PRINT+y.IDENTITY,h.appendChild(i)}function n(){var e=x.Options.PageWidth,t=x.Options.PageHeight;for(var i in x.PaperDim)if(x.PaperDim[i].w==e&&x.PaperDim[i].h==t)return i;return"custom"}function r(){var e=n();v.zcombo("#printPaperSize","setValue",e)}function a(){var e=h.querySelector("#printAddImages"),t=h.querySelector("#printAddCharts"),i=h.querySelector("#printAddButtons"),n=P.view.getActiveGridID(),r=P.view.getResourceID(n),a=P.view.getSheetID(n),o=P.view.getVersionID(n),d=P.data.getWorkBook(r,o),c=d.getSheetObj(a);c.Charts.length()&&(t.checked=!0,x.Options.addChart=!0),c.Buttons.length()&&(i.checked=!0,x.Options.addButton=!0),c.Images.length()&&(e.checked=!0,x.Options.addImage=!0)}function o(){var e=h.querySelector("#printPaperSize"),t=h.querySelector("#printPaperWidth"),i=h.querySelector("#printPaperHeight"),n=h.querySelector("#printPortraitOrient"),a=h.querySelector("#printLandscapeOrient"),o=h.querySelector("#printTopMargin"),p=h.querySelector("#printBottomMargin"),l=h.querySelector("#printLeftMargin"),u=h.querySelector("#printRightMargin"),P=h.querySelector("#printAddGridLines"),f=h.querySelector("#printAddImages"),b=h.querySelector("#printAddCharts"),S=h.querySelector("#printAddButtons"),m=h.querySelector("#printFitToWidth");s=h.querySelector(".printPrvPge"),v.bind(e,"zselectboxchange",function(e,t){d.call(t),c.call(t,"PageSize")}),v.bind(t,"znumberfieldspin",function(e,t){c.call(t,"PageWidth"),r()}),v.bind(i,"znumberfieldspin",function(e,t){c.call(t,"PageHeight"),r()}),v.bind(t,"znumberfieldinput",function(e,t){c.call(t,"PageWidth"),r()}),v.bind(i,"znumberfieldinput",function(e,t){c.call(t,"PageHeight"),r()}),v.bind(o,"znumberfieldchange",function(e,t){c.call(t,"MarginTop")}),v.bind(p,"znumberfieldchange",function(e,t){c.call(t,"MarginBottom")}),v.bind(l,"znumberfieldchange",function(e,t){c.call(t,"MarginLeft")}),v.bind(u,"znumberfieldchange",function(e,t){c.call(t,"MarginRight")}),n.addEventListener("change",c.bind(n,"Orientation")),a.addEventListener("change",c.bind(a,"Orientation")),P.addEventListener("change",c.bind(P,"addGridLines")),S.addEventListener("change",c.bind(S,"addButton")),f.addEventListener("change",c.bind(f,"addImage")),b.addEventListener("change",c.bind(b,"addChart")),m.addEventListener("change",c.bind(m,"FitToWidth")),h.querySelector("#printPreviewBtn").addEventListener("click",function(){w.execute("PREVIEW"),g.close()}),h.querySelector("#printBtn").addEventListener("click",function(){w.execute("PRINT"),g.close()}),h.querySelector("#clBtn").addEventListener("click",function(){g.close()})}function d(){var e=x.PaperDim[this.value];x.Options.PageSize=this.value,x.Options.PageWidth=e.w,x.Options.PageHeight=e.h}function c(e){x.Options[e]="checkbox"==this.type?this.checked:this.value,"checkbox"!=this.type&&(("custom"!=x.Options.PageSize||"Orientation"==e)&&p(this.value),u())}function p(e){var t,i,n=x.PaperDim[e];n?(t=n.w,i=n.h):(t=x.Options.PageWidth,i=x.Options.PageHeight);var r=x.Options.Orientation;v.zspinner("#printPaperWidth","setValue",0==r?t:i),v.zspinner("#printPaperHeight","setValue",0==r?i:t)}function l(){var e=v.zspinner("#printPaperWidth","getValue"),t=v.zspinner("#printPaperHeight","getValue");return{w:Math.round(100*parseFloat(e))/100,h:Math.round(100*parseFloat(t))/100}}function u(){h.querySelector(".noPreview").style.display="none",s.style.display="none";var e=l(),t=e.w,i=e.h,n=Math.floor(6*parseInt(t)),r=Math.floor(6*parseInt(i));s.style.width=n+"px",s.style.height=r+"px",s.dataset.widthinch=t+"''",s.dataset.heightinch=i+"''",s.style.display="block"}var s,h,g,P=e.sPlusPlus,v=e.UIUtil.Component,f=e.ZSConstants,b=e.ZSClass,S=(e.window,f.FeatureConstants),m=f.I18N,y=f.wCC,w=(P.view.measures,P.view.Toolbar.Feature[S.PRINT]),x=P.view.Toolbar.Feature[S.PRINT_SETTINGS];x.PaperDim={a3:{n:"A3",w:"11.69",h:"16.54",i:"0",iW:"62px",iH:"85px"},a4:{n:"A4",w:"8.27",h:"11.69",i:"0",iW:"53px",iH:"72px"},a5:{n:"A5",w:"5.83",h:"8.27",i:"2",iW:"43px",iH:"59px"},b4:{n:"B4",w:"9.84",h:"13.90",i:"3",iW:"62px",iH:"83px"},b5:{n:"B5",w:"6.93",h:"9.84",i:"4",iW:"50px",iH:"70px"},letter:{n:"Letter",w:"8.5",h:"11",i:"1",iW:"59px",iH:"70px"},legal:{n:"Legal",w:"8.5",h:"14",i:"2",iW:"59px",iH:"78px"},executive:{n:"Executive",w:"7.25",h:"10.5",i:"3",iW:"50px",iH:"69px"},envelope10:{n:"Envelope #10",w:"4.13",h:"9.5",i:"4",iW:"26px",iH:"61px",dO:"1"}},x.Options={PageSize:"a4",PageWidth:"8.27",PageHeight:"11.69",Orientation:0,MarginLeft:.5,MarginRight:.5,MarginTop:.5,MarginBottom:.5,addGridLines:!1,addImage:!1,addButton:!1,addChart:!1,FitToWidth:!1},w.openDialog=t,x.openDialog=t}(this);
!function(e){function t(e){g||i();var t=d();t.length&&(document.querySelector(".dNc").style.display="block",n(t)),g.open(),e.preventDefault();var o=S.view.getActiveGridID(),r=S.view.getResourceID(o),a=S.view.getSheetID(o),l=S.view.getVersionID(o);b.publish(y.Selector.BoundUpdate.CellEdit,h.Selection.BOUND_UPDATE.REMOVE,{RID:r,SHEETID:a,VERSION:l,isSubmittable:!0})}function n(e){var t=p.querySelector("#gt_namelist"),n=f.createElement("div");if(n.className="txtOverflow boxBorder",t)for(var i=0;i<e.length;i++){var r=e[i],a=n.cloneNode();a.innerText=r,a.title=r,a.addEventListener("click",o.bind("null",r)),t.appendChild(a)}}function o(e){UserAction.Goto(e),g.close()}function i(){var t={width:310,title:E.Goto,close:u,open:c},n=UserAction.getTemplate(["gotoTemplate"]);p=f.createElement("div"),p.id="DI_GOTO",p.appendChild(n.gotoTemplate),p.querySelector("#gt_submit").addEventListener("click",v),g=new e.ZSClass.Dialog(p,t);var o=p.querySelector("#gt_input");A=new I(o),A.addListeners(U)}function r(){var e=A.value;e?l():s()}function a(e){13==e.which&&(v(),e.stopPropagation())}function l(){return m.enable("#gt_submit"),!1}function s(){return m.disable("#gt_submit"),!1}function c(){A.focus()}function u(){s(),A.value="",p.querySelector("#gt_namelist").innerText=""}function d(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),n=S.view.getVersionID(e),o=(S.view.getSheetID(e),S.data.getWorkBook(t,n)),i=o.NamedRange.getAllKeys(),r=Array.from(i);return r}function v(){var e=A.value;UserAction.Goto(e),g.close()}var g,p,S=e.sPlusPlus,f=e.document,m=e.UIUtil.Component,w=e.ZSClass,D=e.ZSConstants.FeatureConstants,E=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),C=(e.ZSConstants.wCC,e.ZSEvents),I=w.Editors.TextAreaEditor,b=(w.Editors.Utility,C.topic),y=C.Groups,h=C.Names,T=S.view.Toolbar.Feature[D.GOTO],A=void 0,U={input:r,keydown:a};T.openDialog=t}(this);
!function(e){function t(){var e=c.value;if(e=e.trim(),""===e)return void ZSClass.ZSAlert(d.Namecannotbeempty,{title:d["Alert.Title.EnterName"]});var t=v.view.getActiveGridID(),n=v.view.getResourceID(t),i=v.view.getVersionID(t);UserAction.renameVersion(n,i,e,function(){var n=v.view.getVersionState(t),i=n.getActiveVersionLog();i.setDescription(e)})}function n(){var t={model:!0,width:360,title:d["AT.Version.Mark"],close:function(){},open:function(){}};r||(i(),r=new e.ZSClass.Dialog(s,t)),r.open();var n=v.view.getActiveGridID(),o=v.view.getVersionState(n),a=o.getActiveVersionLog(),l=a.getVersionName();c.value=l,c.focus()}function i(){var n=e.UserAction.getTemplate(["RENAME_VERSION"]),i=n.RENAME_VERSION,v=i.querySelector("#versionName");c=new g.TextAreaEditor(v),a=i.querySelector("#createBtn"),a.addEventListener("click",function(){t(),r.close()}),l=i.querySelector("#cancelBtn"),l.addEventListener("click",function(){r.close()}),c.addListeners({keydown:o}),s=E.createElement("div"),s.id=S.DI+u.RENAME_VERSION+S.IDENTITY,s.appendChild(i)}function o(e){var t=e.keyCode||e.which;switch(t){case 13:a.click();break;case 27:l.click()}}var r,s,c,a,l,v=e.sPlusPlus,u=e.ZSConstants.FeatureConstants,d=e.ZSConstants.I18N,E=e.document,S=e.ZSConstants.wCC,g=ZSClass.Editors,w=v.view.Toolbar.Feature[u.RENAME_VERSION];w.openDialog=n}(this);
!function(e){function t(){var t={model:!0,width:390,title:l["Version.RevertVersion"],close:function(){},open:function(){}};o||(n(),o=new e.ZSClass.Dialog(r,t));var i=a.view.getActiveGridID(),c=a.view.getVersionState(i),v=c.getVersionNumber(),u=JSUtil.fn.replaceParams(l["AT.RevertVersion.Alert"],["#"+parseFloat(v)]);s.innerText=u,o.open()}function n(){var t=e.UserAction.getTemplate(["REVERT_VERSION"]),n=t.REVERT_VERSION;s=n.querySelector("#message");var a=n.querySelector("#okBtn");a.addEventListener("click",function(){i(),o.close()});var l=n.querySelector("#cancelBtn");l.addEventListener("click",function(){o.close()}),r=v.createElement("div"),r.id=u.DI+c.REVERT_VERSION+u.IDENTITY,r.appendChild(n)}function i(){var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),i=a.view.getVersionID(t);R.publish(V.Listener,S.UserAction.REVERT_VERSION);var o=l["Version.RevertingMessage"],r=new e.ZSClass.TBNotification(o,{mode:"STD",type:"info"});r&&r.show(!0),UserAction.revertVersion(n,i,r)}var o,r,s,a=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,l=e.ZSConstants.I18N,v=e.document,u=e.ZSConstants.wCC,E=e.ZSEvents,R=E.topic,V=E.Groups,S=E.Names,d=a.view.Toolbar.Feature[c.REVERT_VERSION];d.openDialog=t}(this);
!function(e){function t(t){var o={width:550,title:I["Notification.EmailSettings"],close:function(){a()},open:function(){n()}};A||(i(t),A=new e.ZSClass.Dialog(y,o)),A.open()}function i(){var t=e.UserAction.getTemplate(["NotificationSettingsTemplate"]),i=t.NotificationSettingsTemplate;y=document.createElement("div"),y.id="DI_GOALSEEK",y.className="gSd",y.appendChild(i),y.querySelector("#okBtn").addEventListener("click",function(){var e=y.querySelectorAll("input[name=notifyComments]:checked")[0],t=e.value;r(t),A.close()}),y.querySelector("#cancelBtn").addEventListener("click",function(){A.close()})}function o(){A.close()}function n(){var e;switch(p.MailNotifyType){case 0:e="#notifyNothing";break;case 1:e="#notifyAllComment";break;case 2:e="#notifyMentioned"}y.querySelector(e).checked=!0}function a(){}function c(){void 0==p.MailNotifyType?s(t):t()}function s(e){var t=v.view.getActiveGridID(),i=v.view.getResourceID(t),o=v.view.getVersionID(t),n=(v.data.getWorkBook(i,o),v.view.getSelectedSheets(t)),a=v.view.getSheetID(t),c=v.view.getSheetState(t,a),s=c.getActiveRange();UserAction.emailNotificationType(i,o,n,s,e,void 0,N.NOTIFICATION_SETTINGS_GETSTATE)}function r(e){var t=v.view.getActiveGridID(),i=v.view.getResourceID(t),o=v.view.getVersionID(t),n=(v.data.getWorkBook(i,o),v.view.getSelectedSheets(t)),a=v.view.getSheetID(t),c=v.view.getSheetState(t,a),s=c.getActiveRange();p.MailNotifyType=parseInt(e),UserAction.emailNotificationType(i,o,n,s,void 0,parseInt(e),N.NOTIFICATION_SETTINGS_SETSTATE)}function l(e,t){void 0!=t&&(p.MailNotifyType=e,t())}var v=e.sPlusPlus,S=e.ZSEvents,d=S.topic,T=S.Groups,g=S.Names,u=e.ZSConstants,f=u.FeatureConstants,I=(e.document,u.I18N),E=(u.wCC,e.ZSClass),N=(E.Editors.RangeEditor,E.Editors.TextAreaEditor,E.Editors.Utility,E.Range,e.UIUtil.Component,u.ActionConstants),p=v.view.Toolbar.Feature[f.COMMENTS],A=void 0,y=void 0;p.openNotificationSetingsDialog=c,p.closeDialog=o,d.register(T.Listener,g.UserAction.REVIEW_COMMENTS.UPDATE_NOTIFICATION_STATE,l,"state","callback")}(this);
!function(e){function t(e,t){Object.keys(t).forEach(function(n){e.style[n]=t[n]})}function n(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function r(e,t){return e&&e.dataset&&e.dataset[t]}var l=e.document;!e.ZSChart&&(e.ZSChart={});var i=e.ZSChart;!i.Wrapper&&(i.Wrapper={});var o={};o.Events={KEYDOWN:"keydown",BLUR:"blur",INPUT:"input",SEARCH:"search",CHANGE:"change",CLICK:"click",MOUSEDOWM:"mousedown",MOUSEOVER:"mouseover",SUBMIT:"submit",KEYUP:"keyup",MOUSELEAVE:"mouseleave",MOUSEWHEEL:"mousewheel",DOMMOUSEWHEEL:"DOMMouseScroll"},o.getIndex=function(e){var t=this.getAllPrevElement(e,[]);return t?t.length:0},o.getAllPrevElement=function(e,t){for(var n=e.parentNode.firstChild;n&&n!==e;)3!==n.nodeType&&t.push(n),n=n.nextElementSibling||n.nextSibling;return t},o.getElementByClassName=function(e){return l.getElementsByClassName(e)[0]},o.getElementsByClassName=function(e){return l.getElementsByClassName(e)},o.getElementById=function(e){return l.getElementById(e)},o.removeClass=function(e,t){if(null!=e)if(this.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];r.classList.remove(t)}else e.classList.remove(t)},o.toggleActive=function(e){var t="";return this.hasClass(e,"active")?(this.removeClass(e,"active"),t=""):(this.addClass(e,"active"),t="active"),t},o.updateActive=function(e,t){var n="";return t?(this.addClass(e,"active"),n="active"):(this.removeClass(e,"active"),n=""),n},o.addClass=function(e,t){e&&e.classList.add(t)},o.hasClass=function(e,t){return null!=e&&e.classList&&e.classList.contains(t)},o.hideById=function(e){var t=l.getElementById(e);null!=t&&this.hide(t)},o.showById=function(e){var t=l.getElementById(e);null!=t&&this.show(t)},o.hide=function(e){e&&!e.style&&(e.style={}),e&&(e.style.display="none")},o.isVisible=function(e){return!("none"==e.style.display)},o.show=function(e){!e.style&&(e.style={}),e.style.display="block"},o.hideByClassName=function(e){var t=this.getElementByClassName(e);this.hide(t)},o.hideElementsByClassName=function(e){for(var t=this.getElementsByClassName(e),n=0;n<t.length;n++)this.hide(t[n])},o.showByClassName=function(e){var t=this.getElementByClassName(e);this.show(t)},o.getElementStack=function(e,t){var n,r=t||e;return n=l.querySelectorAll(r),0==n.length&&(n=l.querySelectorAll("."+r)),0==n.length&&(n=l.querySelectorAll("#"+r)),t&&(n=this.getChildStack(e,n)),n},o.isArray=function(e){var t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t||"[object NodeList]"===t||"[object HTMLCollection]"==t},o.getChildStack=function(e,t){var n,r=[];if(this.isArray(t))for(var l,i=t.length,o=0;i>o;o++)l=t[o],n=l.querySelectorAll(e),0==n.length&&(n=l.querySelectorAll("."+e)),0==n.length&&(n=l.querySelectorAll("#"+e)),r.push(n);else n=t[0].querySelectorAll(e),0==n.length&&(n=t[0].querySelectorAll("."+e)),0==n.length&&(n=t[0].querySelectorAll("#"+e)),r.push(n);return r},o.addChild=function(e,t,n){var e="string"==typeof e?l.createElement("div"):e,r="string"==typeof t?document.querySelector("#"+t):t;return!r&&(r=document.querySelector("."+t)),Object.keys(n).forEach(function(t){e.setAttribute(t,n[t])}),r&&r.appendChild(e),e},o.addChildByIndex=function(e,t,n,r){var e="string"==typeof e?l.createElement("div"):e,i="string"==typeof t?document.getElementById(t):t;return!i&&(i=document.getElementsByClassName(t)),Object.keys(n).forEach(function(t){e.setAttribute(t,n[t])}),i[r]?i[r].appendChild(e):i.appendChild(e),e},o.addChildAtIndex=function(e,t,n,r){var e="string"==typeof e?l.createElement("div"):e,i="string"==typeof t?document.getElementById(t):t;return!i&&(i=document.getElementsByClassName(t)),n&&Object.keys(n).forEach(function(t){e.setAttribute(t,n[t])}),i.children[r]?i.insertBefore(e,i.children[r]):i.appendChild(e),e},o.getActiveElement=function(e,t){for(var n=this.getElementByClassName(e),r=n.children,l=r.length,i=0;l>i;i++)if(r[i].classList.contains(t))return r[i]},o.getActiveStatus=function(e){var t=e.dataset;return t&&t.active&&"true"==t.active},o.getAttribute=function(e,t){return e.getAttribute(t)},o.getDatasetAttribute=function(e,t){return r(e,t)},o.setInnerHTML=function(e,t,n,r){var l=document.querySelector("#"+e);!l&&(l=document.querySelector("."+e)),!l&&(l=document.querySelector(e)),n&&(l.children[r].innerHTML=t),!n&&(l.innerHTML=t)},o.addEvent=function(e,t,n,r){var l=document.querySelectorAll("#"+e);0==l.length&&(l=document.querySelectorAll("."+e)),0==l.length&&(l=document.querySelectorAll(e));for(var i=0;i<l.length;i++)r&&this.addListenerIfNotAvailable(l[i],t,n,!1),!r&&l[i].removeEventListener(t,n,!1),!r&&l[i].addEventListener(t,n,!1)},o.getNodeInNode=function(e,t){var n=e.querySelectorAll("#"+t);return 0==n.length&&(n=e.querySelectorAll("."+t)),0==n.length&&(n=e.querySelectorAll(t)),n},o.getNodeInParent=function(e,t){var n;return n="string"==typeof e?this.getElements(e)[0]:e,this.getNodeInNode(n,t)},o.addStyle=function(e,n){var r;"string"==typeof e?(r=document.querySelectorAll("#"+e),0==r.length&&(r=document.querySelectorAll("."+e)),0==r.length&&(r=document.querySelectorAll(e))):(r=[],r.push(e));for(var l,i=0;i<r.length;i++)l=r[i],l&&t(l,n)},o.addAttributes=function(e,t){var r;if("string"==typeof e){r=document.querySelectorAll("#"+e),0==r.length&&(r=document.querySelectorAll("."+e)),0==r.length&&(r=document.querySelectorAll(e));for(var l,i=0;i<r.length;i++)l=r[i],n(l,t)}else r=e,Object.keys(t).forEach(function(e){r&&r.setAttribute(e,t[e])})},o.addEventByNode=function(e,t,n,r){if(this.isArray(e))for(var l=e.length,i=0;l>i;i++){var o=e[i];this.addEventByNode(o,t,n,r)}r&&this.addListenerIfNotAvailable(e,t,n,!1),!r&&e&&e.removeEventListener&&e.removeEventListener(t,n,!1),!r&&e&&e.addEventListener&&e.addEventListener(t,n,!1)},o.addListenerIfNotAvailable=function(e,t,n,r){this.hasEvents(e,t)||(this.addBinder(e,t),e&&e.addEventListener&&e.addEventListener(t,n,r))},o.addBinder=function(e,t){try{var n=e.dataset,r=n?n.evts:null;r=r?r+" _"+t:t,e.setAttribute&&e.setAttribute("data-evts",r)}catch(e){}},o.hasEvents=function(e,t){if(!e)return!1;var n=e.dataset;return n&&n.evts&&-1!==n.evts.indexOf(t)},o.toggle=function(e){var t=document.querySelectorAll("#"+e);0==t.length&&(t=document.querySelectorAll("."+e)),0==t.length&&(t=document.querySelectorAll(e));for(var n,r=0;r<t.length;r++)n=t[r],this.isVisible(n)?this.hide(n):this.show(n)},o.getElements=function(e){var t=document.querySelectorAll("#"+e);return 0==t.length&&(t=document.querySelectorAll("."+e)),0==t.length&&(t=document.querySelectorAll(e)),0==t.length&&(t=document.getElementsByName(e)),t},o.findByClassName=function(e,t){for(var n,r=this.getElements(e),l=[],i=0;i<r.length;i++){n=r[i];var o=n.classList;o.contains(t)&&l.push(n)}return l},o.findNodeByClassName=function(e,t){for(var n,r=[],l=0;l<e.length;l++){n=e[l];var i=n.classList;i.contains(t)&&r.push(n)}return r},o.findByElementType=function(e,t){var n,r=this.getElements(e),l=[];if(n=r[0],!n)return l;for(var i=n.children,o=0;o<i.length;o++)i[o].tagName===t&&l.push(i[o]);return l},o.findPreviousSibling=function(e){return e.previousSibling},o.findNextSibling=function(e){return e.nextSibling},o.findNodeByElementType=function(e,t){var n,r=[];n=e;for(var l=n.children,i=0;i<l.length;i++)l[i].tagName===t&&r.push(l[i]);return r},o.findNodeByElementId=function(e,t){var n,r=[];n=e;for(var l=n.children,i=0;i<l.length;i++)l[i].id===t&&r.push(l[i]);return r},o.findMatchingElementByAttribute=function(e,t,n){var r,l=[];r=e;for(var i=0;i<r.length;i++)this.getAttribute(r[i],t)===n&&l.push(r[i]);return l},o.remove=function(e){var t;if("string"==typeof e){if(t=document.querySelectorAll("#"+e),0==t.length&&(t=document.querySelectorAll("."+e)),0==t.length&&(t=document.querySelectorAll(e)),!t)return;for(var n,r=0;r<t.length;r++)n=t[r],n&&n.remove()}else t=e,t&&t.remove()},o.createTxtNode=function(e){return document.createTextNode(e)},o.getElementsByName=function(e){return l.getElementsByName(e)},o.flipState=function(e,t){e.target.checked=!t},o.createElement=function(e,t){var n=document.createElement(e);return t&&Object.keys(t).forEach(function(e){n.setAttribute(e,t[e])}),n},o.createElementNS=function(e,t,n){var r=document.createElementNS(e,t);return n&&Object.keys(n).forEach(function(e){r.setAttribute(e,n[e])}),r},o.removeAll=function(e){for(var t in e)this.remove(e[t])},o.appendChild=function(e,t){e&&e.appendChild(t)},o.isSameNode=function(e,t){return e===t?!0:!1},o.getParentNode=function(e){return e.parentNode},o.getElementStyle=function(e,t){var n,r="string"==typeof e?this.getElementById(e):e;return window.getComputedStyle?n=document.defaultView.getComputedStyle(r,null).getPropertyValue(t):r.currentStyle&&(n=r.currentStyle[t]),n},function(){function e(){Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){function t(e,t){return{start:e,length:t,end:e+t}}function n(t,n){return!1===e||n.start<t.end&&t.start<n.end?Math.min(t.start,Math.max(n.start,t.end-n.length)):(t.start+t.end-n.length)/2}function r(e,t){return{x:e,y:t,translate:function(n,l){return r(e+n,t+l)}}}function l(e,t){for(;e;)t=t.translate(e.offsetLeft,e.offsetTop),e=e.offsetParent;return t}for(var i,o=l(this,r(0,0)),s=r(this.offsetWidth,this.offsetHeight),a=this.parentNode;a instanceof HTMLElement;)i=l(a,r(a.clientLeft,a.clientTop)),a.scrollLeft=n(t(o.x-i.x,s.x),t(a.scrollLeft,a.clientWidth)),a.scrollTop=n(t(o.y-i.y,s.y),t(a.scrollTop,a.clientHeight)),o=o.translate(-a.scrollLeft,-a.scrollTop),a=a.parentNode})}e()}(e),i.Wrapper.DOMUtils=o}(this);
!function(e){function t(){}function r(e,t){!e.yAxis[t.index].plotLines&&(e.yAxis[t.index].plotLines=[]),e.yAxis[t.index].plotLines&&(e.yAxis[t.index].plotLines[t.plIndex]={});var r="plot-line"+t.index+"_"+t.plIndex,o="shortDash",i=2,n=6,s=e.yAxis[t.index].plotLines[t.plIndex];!s.id&&(s.id=r),!s.dashStyle&&(s.dashStyle=o),!s.width&&(s.width=i),!s.zIndex&&(s.zIndex=n)}function o(e,t){var r=e&&e.pointColors?e.pointColors:null;if(r)for(var o=r.length,i=0;o>i;i++)for(var n=r[i],s=n.points?n.points.length:0,a=0;s>a;a++){var l=n.points[a],p=l.pIndex,g=n.sIndex,c=l.color;t[g].data[p].color=c}}function i(e,t,r){for(var o=[],i=t,n=0;r>i;i++,n++)o[n]=e[i];return o}function n(e,t,r,o,i){function n(e,t){var r;switch(t){case A.DEFAULT:r=a(e);break;case A.THOUSANDS:r=_converNumberToThousand(e);break;case A.MILLIONS:r=_converNumberToMillions(e);break;case A.BILLIONS:r=_converNumberToBillions(e);break;default:r=u(e)}return r}function s(e,t){return{cv:e/t,symbol:""}}function a(e){return e>=x.Thousand.MaxUnit&&e<x.Millions.Unit||i.call(this,e)?l(e):e>=x.Millions.Unit&&e<x.Billions.Unit?p(e):e>=x.Billions.Unit&&e<x.Trillions.Unit?g(e):e>=x.Trillions.Unit?c(e):u(e)}function l(e){return{cv:e/x.Thousand.Unit,symbol:x.Thousand.Symbol}}function p(e){return{cv:e/x.Millions.Unit,symbol:x.Millions.Symbol}}function g(e){return{cv:e/x.Billions.Unit,symbol:x.Billions.Symbol}}function c(e){return{cv:e/x.Trillions.Unit,symbol:x.Trillions.Symbol}}function u(e){return{cv:e,symbol:""}}switch(!o&&(o=C.UNITS),o){case C.UNITS:e=n(e,r);break;case C.SCALES:e=s(e,t);break;case C.NONE:e=u(e)}return e}function s(e,t,r,o,i){function n(e,r,o,i,n){return"%"==t?e+i+r+o+n:e+i+o+r+n}var s=v.Constants.NumberFormat,a="",l="";switch(i){case s.DEFAULT:a+=Highcharts.numberFormat(Math.abs(e),-1);break;case s.NONE:case s.CUSTOM:default:a+=Highcharts.numberFormat(Math.abs(e),-1,void 0,"")}return 0>e&&(l+="-"),n(l,a,s.DEFAULT==i?t:"",r,o)}function a(e,t,r,o,i,a,l){var p=v.Constants.NumberFormat,g=new v.Utility.ChartAgent,c=g.pickCurrency(o,t,r),u=e[t].nfCode||p.DEFAULT,h=e[t].prefix||"",y=e[t].suffix||"",d=e[t].unitFactor||A.DEFAULT;i=i||e[t].scaleFactor||1;var C=l?x.Thousand.Unit:x.Thousand.MaxUnit,I=function(e){return function(t){return e>=C&&t<x.Thousand.MaxUnit&&t>=x.Thousand.Unit}};e[t].labels={enabled:e[t].labels.enabled,style:e[t].labels.style,isAxisDirty:e[t].labels.isAxisDirty,formatter:function(){var e=this.value;if(-1!==r.toUpperCase().indexOf(f.PARETO)&&1==t)return Highcharts.numberFormat(Math.abs(e),0)+"%";if("%"==c)return s(Math.abs(e)/i,c,h,y,u);var o=n(Math.abs(e),i,d,a,I(this.axis.getExtremes().max));return s(o.cv,c,h,o.symbol+y,u)}}}function l(e,t){var r=t.pIndex,o=t.sIndex,i=t.cValue,n=t.isSeries;return e=p.call(this,e,r,o,i,n)}function p(e,t,r,o,i){var n=e.colorObject,s=n.pointColors,a=n.seriesColors;if(i)s=c(s,r),a=g(a,r,o,!1);else{s||(s=[]);var l={color:o,pIndex:t},p=h(s,l),u=p>=0?s[p]:[];if(u.sIndex){p=h(u.points,l);var y=u.points?u.points:[];-1!=p?y[p]=l:y.push(l),u.points=y}else u.sIndex=r,u.points=[l];s.push(u)}return s&&s.length>=1&&(n.pointColors=s),a&&a.length>=1&&(n.seriesColors=a),e}function g(e,t,r,o){return e?o?e=u(e,t):(e=u(e,t),e.push({color:r,sIndex:t})):(e=[],e.push({color:r,sIndex:t})),e}function c(e,t){if(e){for(var r=e.length,o=[],i=0;r>i;i++){var n=e[i];n.sIndex&&n.sIndex==t||o.push(n)}e=o}return e}function u(e,t){if(e){for(var r=e.length,o=[],i=0;r>i;i++){var n=e[i];n.sIndex&&n.sIndex==t||o.push(n)}e=o}return e}function h(e,t){for(var r=e.length,o=0;r>o;o++){var i=e[o];if(y(i,t))return o}return-1}function y(e,t){var r=!1;return t.sIndex&&e.sIndex&&(r=t.sIndex==e.sIndex),t.pIndex&&e.pIndex&&(r=t.pIndex==e.pIndex),r}var d=e.sPlusPlus,v=(e.ZSClass,e.UserAction,e.ZSChart),f=v.Constants.ChartType,x=v.Constants.UnitConversion,C=v.Constants.ConversionType,A=v.Constants.UnitFormat,I=v.Constants.ServiceType,S=e.JSUtil,b=(v.Constants.ChartRangePickerType,v.Constants.TitleConstants);t.prototype.checkRedrawProperty=function(e,t,r,o){var i=t&&t.xAxis.type===I.STOCK,n=t?t.series:[],s=r.options.series?r.options.series.length:0,a=n?n.length:0,l=a*(n[0]&&n[0].data?n[0].data.length:1),p=t.chart.type.toUpperCase()===f.WATERFALL.toUpperCase()||t.chart.type.toUpperCase()===f.PARETO.toUpperCase()||t.chart.type.toUpperCase()===f.WORDCLOUD.toUpperCase()||l>300||e.secYAxisSymbol,g=e.grouping,c=s!==a,u=-1!==e.type.indexOf("TIME"),h=o>=100?!0:!1,y=107==o||138==o||137==o||148==o||151==o||-1==o?!0:!1,d=(t.chart.type.toUpperCase()===f.WORDCLOUD.toUpperCase(),i||p||g||c||u||h||y);return d},t.prototype.isRecommendationCallNeeded=function(e){return e&&0!=e?!1:!0},t.prototype.getCustomColorForActiveChart=function(){var e=this.getActiveChartMeta();return e[0].getCustomChartColor()},t.prototype.clone=function(e,t){var r=e instanceof Array?[]:{};for(var o in e)r[o]=t&&e[o]&&"object"==typeof e[o]&&"renderTo"!=o?this.clone(e[o],t):e[o];return r},t.prototype.addInstance=function(e,t,r,o,i,n,s){var a=d.data.getWorkBook(e,r),l=a.getSheetObj(t),p=l.Charts,g=p.get(o);!g&&(g=this.addInSheetChartRegister(p,o,n,s)),this.updateInstance(o,t,p,i,g)},t.prototype.addInSheetChartRegister=function(e,t,r,o){var i=new v.Model.ChartGridMeta;return i.setOptions(r),i.setDetails(o),e.set(t,i),e.get(t)},t.prototype.updateInstance=function(e,t,r,o,i){i&&i.setInstance(o,!1),i&&(i.isLoaded=!0),i&&i.setAssociatedSheetId(t),r.set(e,i)},t.prototype.getInstance=function(e,t,r,o){var i=d.data.getWorkBook(e,r),n=i.getSheetObj(t),s=n.Charts;return s.get(o)},t.prototype.isLockedSheet=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=e||d.view.getSheetID(t),n=d.data.getWorkBook(r,o);return n.ProtectedSheets.isSheetLocked(i)},t.prototype.setInstanceSize=function(e,t,r,o,i,n){var s=this.getInstance(e,t,r,o),a=s.getInstance();v.Utility.setSize.fn.call(this,a,i,n),s.isClientActionDone=!s.isClientActionDone},t.prototype.addNewPlotline=function(e,t){r(e,t);var o=e.yAxis[t.index].plotLines[t.plIndex];return o.value=t.plValue,e.yAxis[t.index].plotLines[t.plIndex]=o,e},t.prototype.removePlotlineByIndex=function(e,t){r(e,t);var o=e.yAxis[t.index].plotLines;return o&&o.splice(t.plIndex,1),e},t.prototype.updatePlotLineName=function(e,t){r(e,t);var o=e.yAxis[t.index].plotLines[t.plIndex];return o.label={text:t.title},e.yAxis[t.index].plotLines[t.plIndex]=o,e},t.prototype.getFormatLabels=function(e,t,r,o,i,n){for(var s=0;s<e.length;s++)a(e,s,r,t,o,i,n);return e},t.prototype.updateSeriesColor=function(e,t){(-1!==t.mType.indexOf("PIE")||-1!==t.cType.indexOf("pie"))&&(t.isSeries=!0),l.call(this,e,t)},t.prototype.setColorOptions=function(e,t,r){if(-1!==e.toUpperCase().indexOf(f.PIE.toUpperCase())||-1!==e.toUpperCase().indexOf(f.FUNNEL.toUpperCase())||-1!==e.toUpperCase().indexOf(f.WATERFALL.toUpperCase()))for(var i=t.seriesColors,n=i?i.length:0,s=0;n>s;s++)for(var a=i[s],l=0;l<r.length;l++){var p=isNaN(parseInt(a.sIndex))?-1:parseInt(a.sIndex);r[l]&&r[l].data[parseInt(p)]&&(r[l].data[parseInt(p)].color=a.color)}else if(-1!==e.indexOf(f.COMBOCHART))for(var i=t.seriesColors,n=i?i.length:0,s=0;n>s;s++)for(var a=i[s],l=0;l<r.length;l++){var p=isNaN(parseInt(a.sIndex))?-1:parseInt(a.sIndex);r[l]&&(-1!==r[l].type.toUpperCase().indexOf(f.PIE.toUpperCase())||-1!==r[l].type.toUpperCase().indexOf(f.FUNNEL.toUpperCase())||-1!==r[l].type.toUpperCase().indexOf(f.WATERFALL.toUpperCase()))&&r[l].data[parseInt(p)]?r[l].data[parseInt(p)].color=a.color:r[p]?r[p].color=a.color:r&&r.length>=1&&r[0].regressionSettings&&r[p-parseInt(r.length)]&&(r[p-parseInt(r.length)].regressionSettings.color=a.color)}else for(var i=t.seriesColors,n=i?i.length:0,s=0;n>s;s++){var a=i[s],p="undefined"!=typeof a.sIndex?parseInt(a.sIndex):-1;r[p]?r[p].color=a.color:r&&r.length>=1&&r[0].regressionSettings&&r[p-parseInt(r.length)]&&(r[p-parseInt(r.length)].regressionSettings.color=a.color)}return o.call(this,t,r),r},t.prototype.getInstanceByCId=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=d.view.getSheetID(t),n=d.data.getWorkBook(r,o),s=n.getSheetObj(i),a=s.Charts;return a.get(e)},t.prototype.getAllMetaOfSheet=function(e,t,r){var o=d.data.getWorkBook(e,r),i=o.getSheetObj(t),n=i.Charts,s=n.getMap(),a=[];for(var l in s){var p=s[l],g=p.getSheetAssociatedId();g==t&&a.push(p)}return a},t.prototype.getMaximumDataLength=function(e){if(e){for(var t=e.options.series.length,r=0,o=0;t>o;o++){var i=0;e.options.series[o]&&e.options.series[o].data&&(i=e.options.series[o].data.length),r=i>r?i:r}return r}},t.prototype.getAllChartID=function(e,t,r){var o=d.data.getWorkBook(e,r),i=o.getSheetObj(t),n=i.Charts,s=n.getMap(),a=[];for(var l in s){var p=s[l],g=p.getSheetAssociatedId();g==t&&a.push(p.getID())}return a},t.prototype.mergeChartMeta=function(e,t,r,o){var i=d.data.getWorkBook(e,r),n=i.getSheetObj(t),s=n.Charts,a=s.getMap();for(var l in a){var p=a[l];if(o.id==p.getID()){var g=p.getDetails(),c={};return p.merge(c,g,o),void p.setDetails(c)}}},t.prototype.resetChartMetaVisitedProperty=function(e,t){for(var r in e){var o=e[r];"undefined"!=typeof t?activeMeta.isLoaded=t:o.toggleVisited()}},t.prototype.getChartSvgByID=function(e){var t=this.getChartMeta(e);return t.getSVG()},t.prototype.filterMeta=function(e,t,r,o,i,n){var o=o?o:d.view.getActiveGridID(),s=t?t:d.view.getResourceID(o),r=r?r:d.view.getVersionID(o),a=d.data.getWorkBook(s,r);if(a){var l=a.getSheetObj(e);if(l.Visited){var p=l.Charts,g=p.getMap(),c=[],u=[],h=[];for(var y in g){var v=g[y],f=v.getSheetAssociatedId(),x=v.isDirty,C=i?!1:v.isLoaded;f==e&&(x&&c.push(v.getID()),(!x||n)&&!C&&u.push(v.getComputedChartMeta()),C&&!x&&h.push(v.getID()),v.toggleVisited())}var A={afftectedCharts:c,CHARTS:u,CACHED:h};return A}}},t.prototype.getActiveChartID=function(){return v.Utility.getActiveChart()},t.prototype.getActiveChartMeta=function(){var e=v.Utility.getActiveChart(),t=[];for(var r in e)t.push(this.getChartMeta(e[r]));return t},t.prototype.getChartMeta=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=d.view.getSheetID(t);return this.getChartMetaOfSheet(i,r,o,t,e)},t.prototype.getChartMetaOfSheet=function(e,t,r,o,i){var o=o?o:d.view.getActiveGridID(),n=t?t:d.view.getResourceID(o),r=r?r:d.view.getVersionID(o),s=d.data.getWorkBook(n,r),a=s.getSheetObj(e),l=a.Charts;return l.get(i)},t.prototype.filterRegressionSettings=function(e){var t=e.series,r=e.colors;for(var o in t){var i=t[o];i.hasOwnProperty("regressionSettings")&&(i.regressionSettings.color=r[o%r.length])}return e},t.prototype.isUniqueValue=function(e,t){return e!==t},t.prototype.isArray=function(e){e=e||"";var t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t||"[object NodeList]"===t},t.prototype.merge=function(e,t,r,o){var i=new v.Utility.CommanAgent;return o?e=i.mergeRecursively(t,r):(Object.keys(t).forEach(function(r){e[r]=t[r]}),Object.keys(r).forEach(function(t){e[t]=r[t]})),e},t.prototype.getXAxisCatgeories=function(e,t,r,o){var i=d.data.getWorkBook(e,t),n=i.getSheetObj(r),s=n.Charts,a=s.get(o),l=a.getOptions(),p=this.isArray(l.xAxis)?l.xAxis[0]:l.xAxis;return p.categories},t.prototype.constructStyleProperty=function(e){var t={};if(t.chart={},t.yAxis=[],t.xAxis={},t.chartTitle={},t.chartSubTitle={},t.chartLegend={},t.colorObject={},e.chart.backgroundColor&&(t.chart.backgroundColor=e.chart.backgroundColor),e.chart.plotBackgroundColor&&(t.chart.plotBackgroundColor=e.chart.plotBackgroundColor),e.chart.style&&(t.chart.style=e.chart.style),e.legend.itemStyle&&(t.chartLegend=e.legend.itemStyle),e.title.style&&(t.chartTitle.style=e.title.style),e.subtitle&&e.subtitle.style&&(t.chartSubTitle.style=e.subtitle.style),e.colorOptions&&(t.colorObject=e.colorOptions),e.xAxis&&e.xAxis.title&&e.xAxis.title.style?(t.xAxis.style=e.xAxis.title.style,e.xAxis.labels.style&&(t.xAxis.labelStyle=e.xAxis.labels.style)):e.xAxis[0]&&e.xAxis[0].title&&e.xAxis[0].title.style&&(t.xAxis.style=e.xAxis[0].title.style,e.xAxis[0].labels.style&&(t.xAxis.labelStyle=e.xAxis[0].labels.style)),e.yAxis&&e.yAxis.length>=1)for(var r=0;r<e.yAxis.length;r++)t.yAxis[r]={},t.yAxis[r].index=r,e.yAxis[r].title.style&&(t.yAxis[r].style=e.yAxis[r].title.style),e.yAxis[r].gridLineColor&&(t.yAxis[r].gridLineColor=e.yAxis[r].gridLineColor),e.yAxis[r].labels.style&&(t.yAxis[r].labelStyle=e.yAxis[r].labels.style);return t},t.prototype.getMaxColorLength=function(e){var t=e.chart.type;return-1!==t.indexOf(f.PIE)||-1!==t.indexOf(f.FUNNEL)||-1!==t.indexOf(f.WATERFALL)?this.getMaximumSeriesLength(e)[1]:e.chart.customChartType&&-1!==e.chart.customChartType.indexOf(f.BULLET)?3:e.series.length},t.prototype.getRowPosbyTop=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=d.view.getSheetID(t),n=d.data.getWorkBook(r,o),s=n.getSheetObj(i),a=s.Row.auxiliaryAxis.findAbs(e);return a},t.prototype.getleftByColPos=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=d.view.getSheetID(t),n=d.data.getWorkBook(r,o),s=n.getSheetObj(i),a=s.Column;return a.axis.getPos(e)},t.prototype.getTopByRowPos=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=d.view.getSheetID(t),n=d.data.getWorkBook(r,o),s=n.getSheetObj(i),a=s.Row;return a.auxiliaryAxis.getPos(e)},t.prototype.getColPosbyLeft=function(e){var t=d.view.getActiveGridID(),r=d.view.getResourceID(t),o=d.view.getVersionID(t),i=d.view.getSheetID(t),n=d.data.getWorkBook(r,o),s=n.getSheetObj(i),a=s.Column.axis.findAbs(e);return a},t.prototype.getMaximumSeriesLength=function(e){for(var t,r=0,o=0;o<e.series.length;o++)e.series[o].data&&e.series[o].data.length>r&&(t=o,r=e.series[o].data.length);return[t,r]},t.prototype.filterCurrency=function(e,t){e="string"==typeof e?JSON.parse(e):e;var r=0;for(var o in e)r++;var n=e?e:{},s=r-t;return s>0&&(n=i(n,s,r)),n},t.prototype.isMutipleAxiesChart=function(e){var t=v.Constants.MULTI_AXIES_CHART_TYPE,r=!1;return t.forEach(function(t){t==e&&(r=!0)}),r},t.prototype.pickCurrency=function(e,t,r){var o="string"==typeof e?JSON.parse(e):e;if(this.isMutipleAxiesChart(r))return o[t]||"";for(var i=0;i<Object.keys(e).length;i++)if(e[i])return e[i];return""},t.prototype.pickPrecision=function(e,t){return!e&&(e={}),e[t]||0},t.prototype.getColorSchemenColors=function(e,t,r,o){e=this.resetChartColorCode(e);var i=v.Constants,n=i.ColorSchemeType;if(-1!==r.indexOf(n.COLORFUL)){var s,a=this.getMaxColorLength(e);s=this.generateColorTheme(t,a,!0),e.colors=s}else{var a=this.getMaxColorLength(e),l=!e.chart.customChartType||-1===e.chart.customChartType.indexOf(f.BULLET)&&-1===e.chart.customChartType.indexOf(f.GROUPED)?!1:!0,s=this.generateColorTheme(t,a,!1,!1,l);o="string"==typeof o?"true"==o?!0:!1:o;var p=o?s.reverse():s;e.colors=p}return e},t.prototype.generateColorTheme=function(e,t,r,o,i){e="string"==typeof e&&-1!==e.indexOf("[")?JSON.parse(e):e;var n=[];if(r){var s=e.length,a=Math.min(Math.ceil(t/s),3);n=new v.Utility.SheetChartColor(e).getColorCombination(a)}else for(var l=i?t:t+2,p=0,g=1/l,c=0;t>c;c++)n.push(o?new v.Utility.SheetChartColor(e).darken(p).getColor():new v.Utility.SheetChartColor(e).brighten(p).getColor()),p+=g;return n},t.prototype.resetChartColorCode=function(e){var t=e.chart.type;if(-1!==t.indexOf("pie")||-1!==t.indexOf("funnel")||-1!==t.indexOf("waterfall"))for(var r=0;r<e.series.length;r++)for(var o=0;o<e.series[r].data.length;o++)e.series[r].data[o].color&&delete e.series[r].data[o].color;else for(var r=0;r<e.series.length;r++)e.series[r].color&&delete e.series[r].color;return e},t.prototype.fetchRangeValue=function(e,t,r,o){var i=d.view.getActiveGridID(),n=d.view.getResourceID(i),s=d.view.getVersionID(i),a=e.trim().split(";");a.forEach(function(e){if(e.length>1){var a=S.Range.parseRange(n,s,e);if(a){var l=a.sheetID;d.view.fetchRangeData(n,l,s,a.range,[t||"DisplayValue"],!0,i,r,o)}}})},t.prototype.getCellValue=function(e,t,r){var o=d.view.getActiveGridID(),i=d.view.getResourceID(o),n=d.view.getVersionID(o),s=S.Range.parseRange(i,n,e);if(s){var a=s.range.startRow,l=s.range.startCol,p=s.sheetID;d.view.fetchCellData(i,p,n,a,l,["DisplayValue"],o,t,r)}else r(e)},t.prototype.detectTable=function(e,t,r){var o=d.view.getActiveGridID(),i=d.view.getResourceID(o),n=d.view.getVersionID(o),s=d.view.getSheetID(o);v.Server.doDetectTable(i,s,n,e,t,r)},t.prototype.generateMonochromaticShades=function(e,t){var r=new v.Utility.AgentDom;r.generateMonochromaticShades(e,t)},t.prototype.getActiveChartIDForSP=function(){return"preview"},t.prototype.reverseMonoColor=function(e,t){var r=new v.Utility.AgentDom;r.reverseAllLiItems(e,t)},t.prototype.addChartBoundary=function(e,t){e.chart.width=t.wd,e.chart.height=t.ht;var r=e.chart;return-1!==r.type.indexOf(f.PIE)||-1!==r.type.indexOf(f.FUNNEL)?(r.spacingLeft=r.spacingTop=r.spacingRight=10,r.spacingBottom=15):(r.spacingLeft=r.spacingTop=r.spacingRight=30,r.spacingBottom=20),e},t.prototype.applySeriesColorToPlotLines=function(e){for(var t=(e.yAxis,0);t<e.yAxis.length;t++)if(e.yAxis[t].plotLines)for(var r=0;r<e.yAxis[t].plotLines.length;r++)e.yAxis[t].plotLines[r].color=e.colors?e.colors[t]:e.colorOptions.colorTheme.basecolor[t];return e},t.prototype.applySeriesColorToPlotLinesOnLoad=function(e,t){for(var r=0;r<e.length;r++)if(e[r].plotLines)for(var o=0;o<e[r].plotLines.length;o++)e[r].plotLines[o].color=t.colorTheme.basecolor[r];return e},t.prototype.applySeriesColorToAxis=function(e,t,r){if(!r)return e;for(var o=(e.yAxis,0);o<e.yAxis.length;o++)e.yAxis[o]&&e.yAxis[o].labels&&(e.yAxis[o].labels.isAxisDirty||(e.yAxis[o].labels.style.color=t.colorTheme.basecolor[o]),e.yAxis[o].title.isAxisDirty||(e.yAxis[o].title.style.color=t.colorTheme.basecolor[o]));return e},t.prototype.applySeriesColorToYAxisOnLoad=function(e,t,r){if(r)for(var o=0;o<e.length;o++)e[o]&&e[o].labels&&(e[o].labels.isAxisDirty||(e[o].labels.style.color=t.colorTheme.basecolor[o]),e[o].title.isAxisDirty||(e[o].title.style.color=t.colorTheme.basecolor[o]));return e},t.prototype.applyLegendStyle=function(e,t){for(var r=Object.keys(t),o=0;o<r.length;o++)e.legend.itemStyle[r[o]]=t[r[o]];return e},t.prototype.applyChartLevelStyles=function(e,t,r){return e.chart[t]=r,e},t.prototype.applyTitleLevelStyles=function(e,t,r){return e.title[t]=r,e},t.prototype.applySubTitleLevelStyles=function(e,t,r){return e.subtitle[t]=r,e},t.prototype.getRenderTo=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.renderTo)return r.renderTo}},t.prototype.checkIfChartIsGrouped=function(e){var t=v.Utility.getChartMeta([e],!0);return t.isGrouping()},t.prototype.getRGBAColor=function(e){var t=-1!==e.indexOf("#")?(new v.Model.ChartModel).getRGBA(e):e;return t},t.prototype.updateTypeForYAxis=function(e,t,r){return"logarithmic"===r?(e.yAxis[t].type="logarithmic",e.yAxis[t].min=1,e.yAxis[t].tickInterval=1):e.yAxis[t].type="linear",e},t.prototype.applyYAxisLevelStyles=function(e,t,r,o,i){return-1==r?("labelStyle"===o&&(e.yAxis[t].labels.style=i),"titleStyle"===o&&(e.yAxis[t].title.style=i),"labels"===o&&(e.yAxis[t].labels.enabled=i),"type"===o&&(e=this.updateTypeForYAxis(e,t,i)),"labelStyle"!==o&&"titleStyle"!==o&&"labels"!==o&&(e.yAxis[t][o]=i)):"plotLines"===o?i.plValue&&(e.yAxis[t].plotLines[r].value=i.plValue):("labelStyle"===o&&(e.yAxis[t].plotLines[r].labels.style=i),"titleStyle"===o&&(e.yAxis[t].plotLines[r].title.style=i),"labelStyle"!==o&&"titleStyle"!==o&&(e.yAxis[t].plotLines[r][o]=i)),e},t.prototype.applyGridLineColorForAllAxisObjects=function(e,t){if(!e.yAxis)return e;for(var r=(new v.Model.ChartModel).getRGBA(t,"0.5"),o=0;o<e.yAxis.length;o++)e.yAxis[o].gridLineColor=t,e.yAxis[o].minorGridLineColor=r;return e},t.prototype.applyXAxisLevelStyles=function(e,t,r,o){return"labelStyle"===r&&(e.xAxis.labels.style=o),"titleStyle"===r&&(e.xAxis.title.style=o),"labels"===r&&(e.xAxis.labels.enabled=o,!o&&(e.xAxis.tickWidth=0),!o&&(e.xAxis.lineWidth=0),o&&(e.xAxis.lineWidth=1),o&&(e.xAxis.tickWidth=1)),"labelStyle"!==r&&"titleStyle"!==r&&"labels"!==r&&(e.xAxis[r]=o),e},t.prototype.applyChartDefaultStyle=function(e,t){for(var r=Object.keys(t),o=0;o<r.length;o++)e.chart[r[o]]=t[r[o]];return e},t.prototype.updateChartTitle=function(e){var t=e,r=v.Manager.SidePanelManager,o=d.view.getActiveGridID(),i=d.view.getVersionID(o),n=d.view.getResourceID(o),s=d.data.getWorkBook(n,i),a=d.view.getSheetID(o),l=s.getSheetObj(a),p=l.Charts,g=r.getActiveChartID(),c=g,u=new v.Controller.ZSCController,h=[],y={};Object.keys(c).forEach(function(e){{var r=c[e],o=p.get(r);o.getOptions()}y.title=t,o&&h.push(o)}),u.updateChartTitle(n,a,i,h[0],y)},t.prototype.updateYAxisTitle=function(e,t){var r=e,o=v.Manager.SidePanelManager,i=d.view.getActiveGridID(),n=d.view.getVersionID(i),s=d.view.getResourceID(i),a=d.data.getWorkBook(s,n),l=d.view.getSheetID(i),p=a.getSheetObj(l),g=p.Charts,c=o.getActiveChartID(),u=[c],h=new v.Controller.ZSCController,y=[],f={};Object.keys(u).forEach(function(e){{var o=u[e],i=g.get(o);i.getOptions()}f.title=r,f.index=t,i&&y.push(i)}),h.updateYAxisTitle(s,l,n,y[0],f)},t.prototype.updateChartSubTitle=function(e){var t=e,r=v.Manager.SidePanelManager,o=d.view.getActiveGridID(),i=d.view.getVersionID(o),n=d.view.getResourceID(o),s=d.data.getWorkBook(n,i),a=d.view.getSheetID(o),l=s.getSheetObj(a),p=l.Charts,g=r.getActiveChartID(),c=[g],u=new v.Controller.ZSCController,h=[],y={};Object.keys(c).forEach(function(e){{var r=c[e],o=p.get(r);o.getOptions()}y.title=t,o&&h.push(o)}),u.updateChartSubTitle(n,a,i,h[0],y)},t.prototype.updateXAxisTitle=function(e){var t=e,r=v.Manager.SidePanelManager,o=d.view.getActiveGridID(),i=d.view.getVersionID(o),n=d.view.getResourceID(o),s=d.data.getWorkBook(n,i),a=d.view.getSheetID(o),l=s.getSheetObj(a),p=l.Charts,g=r.getActiveChartID(),c=[g],u=new v.Controller.ZSCController,h=[],y={};Object.keys(c).forEach(function(e){{var r=c[e],o=p.get(r);o.getOptions()}y.title=t,o&&h.push(o)}),u.updateXAxisTitle(n,a,i,h[0],y)},t.prototype.getChartMapFromSheet=function(){var e=[],t=d.view.getActiveGridID(),r=d.view.getVersionID(t),o=d.view.getResourceID(t),i=d.data.getWorkBook(o,r),n=d.view.getSheetID(t),s=i.getSheetObj(n),a=s.Charts;return e.push(o),e.push(n),e.push(r),e.push(a),e},t.prototype.getSPActiveChartID=function(){var e=v.Manager.SidePanelManager,t=e.getActiveChartID();return t},t.prototype.fetchTitleLabelBasedOnSubAction=function(e){return e==b.CHART_TITLE_STYLE?"CHART_TITLE":e==b.CHART_SUB_TITLE_STYLE?"CHART_SUB_TITLE":e==b.CHART_X_AXIS_TITLE_STYLE?"XAXIS_TITLE":e==b.CHART_Y_AXIS_TITLE_STYLE?"YAXIS_TITLE":void 0},t.prototype.getRequestObject=function(e,t,r){var o={preview:"previewaction",new:"chartaction",edit:"chartaction"},i={preview:"CHART_PREVIEW",new:"CHART_NEW",edit:"CHART_EDIT"},n={};return n.parameters={currentSheet:e.getActiveSheet(),id:"preview"==t?"":e.getChartID(),chartType:e.getType(),dataRange:e.getRange(),seriesIn:e.getSeriesIn(),frl:e.getFirstRowAsLabel(),fcl:e.getFirstColAsLabel(),lpos:e.getLPos(),sr:e.getStartRowIndex(),sc:e.getStartColIndex(),srd:e.getStartRowDiff(),scd:e.getStartColDiff(),left:e.getLeft("edit"===t),top:e.getTop("edit"===t),wd:e.getWidth(),ht:e.getHeight(),title:e.getTitle(),subTitle:e.getSubTitle(),xTitle:e.getXTitle(),tooltip:e.getToolTip(),zoom:e.getZoomType(),animation:e.getAnimation(),trendline:e.getTrendline(),isFloating:e.getFloating(),majorGridLineWidth:e.getMajorGridWidth(),minorTickInterval:e.getMinorTickInterval(),xLabel:e.getXLabel(),yLabel:e.getYLabel(),isSingleYAxis:e.getYAxisState(),isIncludeHiddenCells:e.getHiddenCellState(),slant:e.getXSlant(),labelFormat:e.getLabelFormat(),appedingWay:e.getCombinedWay(),isMarker:e.getMarkerState(),trendlineType:e.getTrendlineTypes(),threshold:e.getThreshold(),degree:e.getDegreeOrElse(),autoExpand:e.getAutoExpandState(),actionList:JSON.stringify(e.getCustomStyle()),isPivotChart:e.getPivotState(),isCloned:e.isCloned(),comboChartTypes:JSON.stringify(e.getComboTypes()),yAxis:JSON.stringify(e.getYAxis()),lineStyles:JSON.stringify(e.getLineStyles()),pivotId:e.getPivotId(),sline:e.getStaggerState(),aggregation:JSON.stringify(e.getAggregation()),filter:JSON.stringify(e.getFilter()),reversed:r?e.getType().toLowerCase()==f.BAR:e.getXReverse(),isFromZia:r,binning:JSON.stringify(e.getBinning())},n.url=o[t],n.action=i[t],n},v.Utility.removeCursorPointer=function(e){for(var t=0;t<e.length;t++)delete e[t].title.style.cursor,e[t].labels.style&&delete e[t].labels.style.cursor;return e},!v.Utility&&(v.Utility={}),v.Utility.ChartAgent=t}(this);
!function(e){function t(){this.ID=null,this.config={},this.evName=null,this.reason={clean:-1}}function n(e,t){var n=e.getOptions(),i=t.sIndex;return n.series&&n.series[i]&&n.series[i].dashStyle?n.series[i].dashStyle:"solid"}function i(e,t){var n=(!t.isSeries,e.getInstance()[0].options),i=T(e.getOptions(),t.sIndex,t.pIndex,e.getInstance()[0]),a=h.Utility.getColorCodeFromGradient(n.chart.plotBackgroundColor?n.chart.plotBackgroundColor:n.chart.backgroundColor),r=i?new h.Utility.SheetChartColor(i).isLuminance():!1,o=a?new h.Utility.SheetChartColor(a).isLuminance():!1;return p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,{CONFIG:{META:e,NAME:M.SERIES_COLOR,COLOR:i}}),r||o?P.LIGHT:P.DARK}function a(){var e=h.Manager.ZSChartCutomEventManager;e.init()}function r(e){var t=h.Manager.ZSChartCutomEventManager;t.setProperty(e)}function o(){var e=c(!0);if(e){var t=h.Manager.ZSChartCutomEventManager,n=t.getEventName();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.INIT_TOOLBAR,{EVENT:n})}}function l(e){var t=new h.Utility.CommanAgent;return t.isFallUnderCompositionType(e)||-1!=e.indexOf(b.WATERFALL.toUpperCase())}function s(e,t,n){return-1!==t.indexOf(b.COMBOCHART)&&-1!==e.series[n].type.indexOf(b.PIE)?b.PIE:t}function c(e){var t=h.Wrapper.DOMUtils,n=t.getElementById("DI_CHART_CONTEXT");return n||e?n:d()}function d(){var t=h.Wrapper.DOMUtils,n=t.getElementById("DI_CHART_CONTEXT");if(n)return n;var i=e.UserAction.getTemplate(["CHART_TRANSPARANCY_POPOVER"]),a=e.UserAction.getTemplate(["CHART_SERIES_TRANSPARANCY_POPOVER"]),r=document.getElementById("popupmenu"),o=document.getElementById("cTchrtPopOver")?!0:!1,l=document.getElementById("sTchrtPopOver")?!0:!1;!o&&t.appendChild(r,i.CHART_TRANSPARANCY_POPOVER),!l&&t.appendChild(r,a.CHART_SERIES_TRANSPARANCY_POPOVER);var s=e.UserAction.getTemplate(["CHART_CONTEXTUAL_TEMPLATE"]);return t.appendChild(document.body,s.CHART_CONTEXTUAL_TEMPLATE),n=t.getElementById("DI_CHART_CONTEXT"),v.initComponent("#DI_CHART_CONTEXT"),O=n.querySelector("#seriesTransparencyWrappper"),O.setAttribute("data-is-content-html-encoded",!0),O.setAttribute("data-position","bottom"),f=n.querySelector("#chartTransparencyWrappper"),f.setAttribute("data-is-content-html-encoded",!0),f.setAttribute("data-position","bottom"),v.initComponent("#cTchrtPopOver"),v.initComponent("#sTchrtPopOver"),v.zpopover(f),v.zpopover(O),n}function S(e){function t(){d.hideById("titleInputBx");var e=s.getLegend(),t=e.itemStyle||{},n=t.fontWeight?"bold"==t.fontWeight:!1;d.addAttributes("titleQckBld",{"data-active":n});var i=t.fontStyle?"italic"==t.fontStyle:!1;d.addAttributes("titleQckItalic",{"data-active":i}),v.zcombo("#titleQckFontSize","setValue",t.fontSize||"12px"),v.zcolorchooser("#titleQckFntColor","setValue",t.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1));var a=d.getElementById("titleQckFntColor");d.addStyle(a.previousElementSibling,{"border-bottom-color":t.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1)})}function n(){var e=h.Utility.getColorCodeFromGradient(s.getOptions().chart.backgroundColor||"#FFFFFF"),t=(new h.Model.ChartModel).getTransparency(e);v.zslider("#chartTransparencySlder","setValue",t);var n=s.getOptions().chart.style?s.getOptions().chart.style.fontFamily:"Arial";v.zcombo("#chartQukfontfamilys","setValue",n);var i=d.getElementById("ctxChartfillColor");d.addStyle(i.previousElementSibling,{"border-bottom-color":e}),v.zcolorchooser("#ctxChartfillColor","setValue",e)}function i(){d.addStyle("titleInputBx",{display:""});var e=h.Manager.SidePanelManager,t=e.getDialogUtil(),n=s.getID(),i=h.Utility.getTitleRelative(c.subAction),a=t.getTitleStyle(i,[n]),r=a.fontWeight?"bold"==a.fontWeight:!1;d.addAttributes("titleQckBld",{"data-active":r});var o=a.fontStyle?"italic"==a.fontStyle:!1;d.addAttributes("titleQckItalic",{"data-active":o}),v.zcombo("#titleQckFontSize","setValue",a.fontSize||"12px"),v.zcolorchooser("#titleQckFntColor","setValue",a.color||"#2d2d2d");var l=d.getElementById("titleQckFntColor");d.addStyle(l.previousElementSibling,{"border-bottom-color":a.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1)});var S=s.getOptions(),T="";switch(c.subAction){case 1:var E=S.title;T=E.text;break;case 2:var E=S.subtitle;T=E.text;break;case 3:var E=S.xAxis.title;T=E.text;break;default:var E=S.yAxis[c.subAction-4].title;T=E.text}d.getElementById("titleInputBx").value=T}function a(){var e=c.index,t=s.getYAxis()[e||0],n=t.labels||{},i=n.style||{},a=i.fontWeight?"bold"==i.fontWeight:!1;d.addAttributes("vXaiesBld",{"data-active":a});var r=i.fontStyle?"italic"==i.fontStyle:!1;d.addAttributes("vXaiesItalic",{"data-active":r}),v.zcombo("#vAxiesQckFontSize","setValue",i.fontSize||"12px"),v.zcolorchooser("#vAxiesQckFontColor","setValue",i.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1));var o=d.getElementById("vAxiesQckFontColor");d.addStyle(o.previousElementSibling,{"border-bottom-color":i.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1)}),d.getElementById("cMinQck").value=t.min||"",d.getElementById("cMaxQck").value=t.max||"",d.getElementById("cIntervalQck").value=t.interval||""}function r(){d.hideById("titleInputBx");var e=s.getXAxis(),t=e.labels||{},n=t.style||{},i=n.fontWeight?"bold"==n.fontWeight:!1;d.addAttributes("titleQckBld",{"data-active":i});var a=n.fontStyle?"italic"==n.fontStyle:!1;d.addAttributes("titleQckItalic",{"data-active":a}),v.zcombo("#titleQckFontSize","setValue",n.fontSize||"12px"),v.zcolorchooser("#titleQckFntColor","setValue",n.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1));var r=d.getElementById("titleQckFntColor");d.addStyle(r.previousElementSibling,{"border-bottom-color":n.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1)})}function o(){var e=T(s.getOptions(),c.sIndex,c.pIndex,s.getInstance()[0]),t=(new h.Model.ChartModel).getTransparency(e);v.zslider("#seriesTransparency","setValue",t);var n=d.getElementById("ctxSeriesfillColor");d.addStyle(n.previousElementSibling,{"border-bottom-color":e}),v.zcolorchooser("#ctxSeriesfillColor","setValue",e)}var l=h.Manager.ZSChartCutomEventManager,s=l.getActiveMeta(),c=l.getConfigMeta(),d=h.Wrapper.DOMUtils;switch(e){case D.STYLES:n();break;case D.TITLES:i();break;case D.HAXIS:r();break;case D.VAXIS:a();break;case D.SERIES:E(s,c),o();break;case D.LEGEND:t()}}function T(e,t,n,i){function a(){try{var a=e.series.length,r=e.series[t%a].data[n].color||i.series[t].data[n].color;return h.Utility.getColorCodeFromGradient(r)}catch(e){return null}}function r(){try{var n=e.series.length,a=e.series[t%n].color||i.series[t].color;return h.Utility.getColorCodeFromGradient(a)}catch(e){return null}}return r()||a()}function E(e,t){function n(e,t){var n=e.getInstance();for(var a in n){var r=n[a],o=r.container;t.isSeries?r.updateSeriesByCustomProperty(t.sIndex,{borderWidth:1,borderColor:i(e,t)}):r.updatePointByCustomProperty(t.sIndex,t.pIndex,{borderWidth:1,borderColor:i(e,t)});var l=o.querySelector(".highcharts-series-"+t.sIndex),s=l.children,c=s?s.length:0;if(t.isSeries)for(var a=0;c>a;a++){var d=s[a];d.classList.add("animateLinePath")}else{var d=s[t.pIndex];d.classList.add("animateLinePath")}}}I(e,t)&&n(e,t)}function I(e,t){var n=new h.Utility.CommanAgent;if(n.isFallUnderCompositionType(e.getType()))return!1;if(-1!=e.getType().indexOf(b.COMBOCHART)){var i=t.sIndex,a=e.getOptions().series,r=a?a[i]:null;if(r&&n.isFallUnderCompositionType(r.type))return!1}return!0}var C=e.ZSEvents,u=C.Groups,A=C.Names,p=C.topic,g=(e.ZSConstants.wCC,e.sPlusPlus),h=e.ZSChart,R=(h.Controller,h.Constants),v=(e.ZSConstants.FeatureConstants,R.CAConstant,e.UIUtil.Component),b=(ZSDevTools.Logger,h.Constants.MessageConstant,h.Constants.ChartType),O=null,f=null,P={LIGHT:"#FFFFFF",DARK:"#000000"},U={CHART_LEGEND:".highcharts-legend",CHART_TITLE:".highcharts-title",CHART_SUBTITLE:".highcharts-subtitle",CHART_BACKGROUND:".highcharts-background",CHART_PLOT:".highcharts-plot-background",CHART_XAXIS_LABELS:".highcharts-xaxis-labels",CHART_YAXIS_LABELS:".highcharts-yaxis-labels",CHART_YAXIS_TITLE:".highcharts-yaxis",CHART_XAXIS_TITLE:".highcharts-xaxis"},y={zID:"#chartTitleCombo",cRelative:{1:"CHART_TITLE",2:"CHART_SUBTITLE",3:"CHART_X_AXIES",4:"LA",5:"RA"}};const M={SERIES_COLOR:"SERIES_COLOR",CHART_BACKGROUND:"CHART_BACKGROUND",CHART_SERIES:"SERIES",CHART_TITLE:"CHART_TITLE",CHART_SUBTITLE:"CHART_SUBTITLE",CHART_XAXIS_LABELS:"CHART_XAXIS_LABELS",CHART_YAXIS_LABELS:"CHART_YAXIS_LABELS",CHART_YAXIS_TITLE:"CHART_YAXIS_TITLE",CHART_XAXIS_TITLE:"CHART_XAXIS_TITLE",CHART_LEGEND:"CHART_LEGEND"},D={STYLES:"STYLES",TITLES:"TITLES",VAXIS:"VAXIS",HAXIS:"HAXIS",SERIES:"SERIES",LEGEND:"LEGEND"},L={CHART:"chartArea",PLOT:"plotArea",SERIES:"series",STYLES:"chartArea",TITLES:"titlesWrapper",VAXIS:"verticalAxies",HAXIS:"titlesWrapper",LEGEND:"titlesWrapper"};t.prototype={init:function(){this.ID=null,this.config={},this.evName=null,this.reason={clean:-1}},setProperty:function(e){this.ID=e.ID,this.config=e.CONFIG,this.evName=e.NAME},getID:function(){if(!this.ID){{new h.Utility.ChartAgent}this.ID=h.Utility.getActiveChart().pop()}return this.ID},getActiveMeta:function(){var e=new h.Utility.ChartAgent;return e.getChartMeta(this.getID())},getConfigMeta:function(){return this.config||{}},getEventName:function(){return this.evName},setCleanerReason:function(e){this.reason.clean=e||-1},isMoved:function(){return-1!==this.reason.clean}},h.Utility.getTitleRelative=function(e){return y.cRelative[e]},h.Utility.isContextMenuAlive=function(){var e=h.Manager.SidePanelManager;return e&&e.isPanelOpen()},h.Client.Action.getClassMapping=function(e,t){return t?void 0:U[e]},h.Client.Action.initCutomEventProperty=function(e){function t(e,t,n){P[e]||(P[e]={});var i=P[e];i[t]=n}var i=e.META,a=e.NAME,r=e.props;switch(a){case M.CHART_SERIES:var o=i.getID();t(o,"sIndex",r.sIndex),t(o,"pIndex",r.pIndex),t(o,"isSeries",r.isSeries),t(o,r.sIndex,{ds:n(i,r)});break;case M.CHART_TITLE:case M.CHART_SUBTITLE:case M.CHART_BACKGROUND:case M.CHART_XAXIS_LABELS:case M.CHART_YAXIS_LABELS:case M.CHART_YAXIS_TITLE:case M.CHART_XAXIS_TITLE:case M.CHART_LEGEND:t("svg","ID",e.ID),t("svg","ACTION",a),t("svg","INDEX",e.index);break;case M.SERIES_COLOR:var o=i.getID();t(o,"color",e.COLOR)}},h.Client.Action.removeCutomEventProperty=function(){P={LIGHT:"#FFFFFF",DARK:"#000000"}},h.Client.Action.destroyContextualToolbar=function(e){try{var t=h.Wrapper.DOMUtils,n=t.getElementById("DI_CHART_CONTEXT");v.zpopover(O,"destroy"),v.zpopover(f,"destroy");var i=new Event("mousedown");document.dispatchEvent(i),n&&n.remove();var a=h.Manager.ZSChartCutomEventManager;a.setCleanerReason(e)}catch(e){}},h.Client.Action.resetChartSelection=function(e){var t=e.ID;if(t){var n=new h.Utility.ChartAgent,i=n.getChartMeta(t);i&&i.resetSelection()}},h.Client.Action.removeBorderAnimation=function(e){function t(e,t){{var n=e.getInstance();e.getOptions()}for(var i in n){for(var a=n[i],r=a.container,o=r.querySelector(".highcharts-series-"+t.sIndex),l=o.children,s=l?l.length:0,i=0;s>i;i++){var c=l[i];c.classList.remove("animateLinePath")}var d=t[t.sIndex];t.isSeries?(d&&a.updateSeriesByCustomProperty(t.sIndex,{dashStyle:d.ds}),t.color&&a.updateSeriesByCustomProperty(t.sIndex,{borderWidth:1,borderColor:new h.Utility.SheetChartColor(h.Utility.getColorCodeFromGradient(t.color)).darken(.7).getColor()})):t.color&&a.updatePointByCustomProperty(t.sIndex,t.pIndex,{borderWidth:1,borderColor:new h.Utility.SheetChartColor(h.Utility.getColorCodeFromGradient(t.color)).darken(.7).getColor()})}}var n=e.ID;if(n){var i=e.Props||P[n];if(i){var a=new h.Utility.ChartAgent,r=a.getChartMeta(n);I(r,i)&&t(r,i),h.Client.Action.removeCutomEventProperty(),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:n})}}},h.Client.Action.applyContextualToolbar=function(e){function t(){var e=a(),t=n();i(t,e)}function n(){function e(){Object.keys(L).forEach(function(e){i.hide(n.querySelector("#"+L[e]))})}function t(){function e(){v.unbind("#vAxiesQckFontSize","zselectboxchange"),v.bind("#vAxiesQckFontSize","zselectboxchange",function(e,t){var n=t.value,i=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_SIZE,{PROPERTIES:{fontSize:n,cID:i,props:S}})})}function t(){v.unbind("#vAxiesQckFontColor","zcolorchooserchange"),v.bind("#vAxiesQckFontColor","zcolorchooserchange",function(e,t){var n=t.color,i=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_COLOR,{PROPERTIES:{color:n,cID:i,props:S}})})}function n(){i.addEvent("vXaiesBld",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t,props:S}}),i.addAttributes(this,{"data-active":!e})},!0)}function a(){i.addEvent("vXaiesItalic",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_STYLE,{PROPERTIES:{italic:e,cID:t,props:S}}),i.addAttributes(this,{"data-active":!e})},!0)}function c(){i.addEvent("cMinQck",i.Events.CHANGE,function(){var e=this.value,t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MIN,{PROPERTIES:{min:e,cID:t,props:S}})},!0),i.addEvent("cMinQck",i.Events.KEYDOWN,function(e){e.stopPropagation()},!0)}function d(){i.addEvent("cMaxQck",i.Events.CHANGE,function(){var e=this.value,t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MAX,{PROPERTIES:{max:e,cID:t,props:S}})},!0),i.addEvent("cMaxQck",i.Events.KEYDOWN,function(e){e.stopPropagation()},!0)}function E(){i.addEvent("cIntervalQck",i.Events.CHANGE,function(){var e=this.value,t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.INTERVAL,{PROPERTIES:{interval:e,cID:t,props:S}})},!0),i.addEvent("cIntervalQck",i.Events.KEYDOWN,function(e){e.stopPropagation()},!0)}function I(){v.unbind("#titleQckFontSize","zselectboxchange"),v.bind("#titleQckFontSize","zselectboxchange",function(e,t){var n=t.value,i=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_SIZE,{PROPERTIES:{fontSize:n,cID:i,props:S}})})}function C(){v.unbind("#titleQckFntColor","zcolorchooserchange"),v.bind("#titleQckFntColor","zcolorchooserchange",function(e,t){var n=t.color,a=r.getID(),o=new h.Utility.ChartAgent,l=r.getXAxis(),s=l.labels||{},c=s.style||{},d=c.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1),T=o.isUniqueValue(d.replace(/ /g,""),n.replace(/ /g,"")),E=i.getElementById("titleQckFntColor");i.addStyle(E.previousElementSibling,{"border-bottom-color":n}),T&&p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_COLOR,{PROPERTIES:{color:n,cID:a,props:S}})})}function g(){i.addEvent("titleQckBld",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t,props:S}}),i.addAttributes(this,{"data-active":!e})},!0)}function R(){i.addEvent("titleQckItalic",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_STYLE,{PROPERTIES:{italic:e,cID:t,props:S}}),i.addAttributes(this,{"data-active":!e})},!0)}function b(){v.unbind("#titleQckFontSize","zselectboxchange"),v.bind("#titleQckFontSize","zselectboxchange",function(e,t){var n=t.value,i=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_SIZE,{PROPERTIES:{fontSize:n,cID:i}})})}function O(){v.unbind("#titleQckFntColor","zcolorchooserchange"),v.bind("#titleQckFntColor","zcolorchooserchange",function(e,t){var n=t.color,a=r.getID(),o=new h.Utility.ChartAgent,l=r.getLegend(),s=l.itemStyle||{},c=s.color||(new h.Model.ChartModel).getRGBA("#4d4d4d",1),d=o.isUniqueValue(c.replace(/ /g,""),n.replace(/ /g,"")),S=i.getElementById("titleQckFntColor");i.addStyle(S.previousElementSibling,{"border-bottom-color":n}),d&&p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_COLOR,{PROPERTIES:{color:n,cID:a}})})}function f(){i.addEvent("titleQckBld",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t}}),i.addAttributes(this,{"data-active":!e})},!0)}function P(){i.addEvent("titleQckItalic",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_STYLE,{PROPERTIES:{italic:e,cID:t}}),i.addAttributes(this,{"data-active":!e})},!0)}function U(){v.unbind("#titleQckFontSize","zselectboxchange"),v.bind("#titleQckFontSize","zselectboxchange",function(e,t){var n=t.value,i=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_SIZE,{PROPERTIES:{fontSize:n,cID:i,props:S}})},!0)}function y(){v.unbind("#titleQckFntColor","zcolorchooserchange"),v.bind("#titleQckFntColor","zcolorchooserchange",function(e,t){var n=t.color,a=r.getID(),o=i.getElementById("titleQckFntColor");i.addStyle(o.previousElementSibling,{"border-bottom-color":n}),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_COLOR,{PROPERTIES:{color:n,cID:a,props:S}})},!0)}function M(){i.addEvent("titleQckBld",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t,props:S}}),i.addAttributes(this,{"data-active":!e})},!0)}function L(){i.addEvent("titleQckItalic",i.Events.CLICK,function(){var e=i.getActiveStatus(this),t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_STYLE,{PROPERTIES:{italic:e,cID:t,props:S}}),i.addAttributes(this,{"data-active":!e})},!0)}function m(){i.addEvent("titleInputBx",i.Events.CHANGE,function(e){var t=this.value,n=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.TEXT,{PROPERTIES:{txt:t,cID:n,props:S}}),e.stopPropagation()},!0),i.addEvent("titleInputBx",i.Events.KEYDOWN,function(e){e.stopPropagation()},!0),i.addEvent("titleInputBx",i.Events.BLUR,function(){var e=this.value,t=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.TEXT,{PROPERTIES:{txt:e,cID:t,props:S}})},!0)}function H(){v.unbind("#chartQukfontfamilys","zselectboxchange"),v.bind("#chartQukfontfamilys","zselectboxchange",function(e,t){var n=t.value,i=r.getID();p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FONT_FAMILY,{PROPERTIES:{fontFamily:n,cID:i}})})}function _(){v.unbind("#chartTransparencySlder","zsliderchange"),v.bind("#chartTransparencySlder","zsliderchange",function(e,t){var n=t.value,i=parseFloat(parseFloat((100-n)/100).toFixed(2)),a=(r.getID(),new h.Model.ChartModel),o=h.Utility.getColorCodeFromGradient(r.getOptions().chart.backgroundColor||a.getRGBA("#FFFFFF",1)),l=a.getRGBA(o,i),s=new h.Utility.ChartAgent,c=s.isUniqueValue(l.replace(/ /g,""),o.replace(/ /g,""));c&&v.zslider("#caTransparency","setValue",n)})}function x(){v.unbind("#ctxChartfillColor","zcolorchooserchange"),v.bind("#ctxChartfillColor","zcolorchooserchange",function(e,t){var n=t.color,a=h.Utility.getColorCodeFromGradient(r.getOptions().chart.backgroundColor||"#FFFFFF"),o=v.zslider("#chartTransparencySlder","getValue");o=parseFloat(parseFloat((100-o)/100).toFixed(2));var l=new h.Utility.ChartAgent,a=(new h.Model.ChartModel).getRGBA(a,o),s=(new h.Model.ChartModel).getRGBA(n,o),c=l.isUniqueValue(s.replace(/ /g,""),a.replace(/ /g,"")),d=r.getID(),S=i.getElementById("ctxChartfillColor");i.addStyle(S.previousElementSibling,{"border-bottom-color":s}),c&&p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FILL,{PROPERTIES:{color:s,cID:d}})})}function N(){v.unbind("#ctxSeriesfillColor","zcolorchooserchange"),v.bind("#ctxSeriesfillColor","zcolorchooserchange",function(e,t){var n=r.getType(),a=S.sIndex,o=S.pIndex,c=t.color,d=r.getSelectionState(a)||!1,E=r.getID(),I=r.getCType(),C=v.zslider("#seriesTransparency","getValue");C=parseFloat(parseFloat((100-C)/100).toFixed(2));var g=(new h.Model.ChartModel).getRGBA(c,C),R=T(r.getOptions(),a,o,r.getInstance()[0]);R=(new h.Model.ChartModel).getRGBA(R,C);var b=i.getElementById("ctxSeriesfillColor");i.addStyle(b.previousElementSibling,{"border-bottom-color":g});var O=new h.Utility.ChartAgent,f=O.isUniqueValue(R.replace(/ /g,""),g.replace(/ /g,""));f&&p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:d,color:g,sIndex:d&&l(s(r.getOptions(),r.getType(),a))?o:a,pIndex:o,cType:I,cID:E,mCType:n}})})}function F(){v.unbind("#seriesTransparency","zsliderchange"),v.bind("#seriesTransparency","zsliderchange",function(e,t){var n=t.value,i=parseFloat(parseFloat((100-n)/100).toFixed(2)),a=S.sIndex,o=S.pIndex,c=r.getSelectionState(a),d=r.getCType(),E=r.getType(),I=T(r.getOptions(),a,o,r.getInstance()[0]),C=new h.Model.ChartModel,g=C.getTransparency(I);I=C.getRGBA(I,i),g!=n&&p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:c,color:I,sIndex:c&&l(s(r.getOptions(),r.getType(),a))?o:a,pIndex:o,cType:d,cID:r.getID(),mCType:E}})})}switch(o){case D.SERIES:N(),F();break;case D.STYLES:H(),_(),x();break;case D.TITLES:U(),y(),M(),L(),m();break;case D.HAXIS:I(),C(),g(),R();break;case D.VAXIS:e(),t(),n(),a(),c(),d(),E();break;case D.LEGEND:b(),O(),f(),P()}}var n=c(),i=h.Wrapper.DOMUtils;return t(),e(),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.INIT_TOOLBAR,{EVENT:o}),i.show(n.querySelector("#"+L[o])),n}function i(e,t){var n=h.Wrapper.DOMUtils;e.style.left=t.LEFTX+"px",e.style.top=t.TOPX+"px",n.show(e)}function a(){var e,t;switch(o){case D.SERIES:t=parseInt(d.pageX)-60,e=parseInt(d.pageY)-54;break;case D.STYLES:t=parseInt(d.pageX)-127,e=parseInt(d.pageY)-58;break;case D.TITLES:t=parseInt(d.pageX)-107,e=parseInt(d.pageY)-90;break;case D.VAXIS:t=parseInt(d.pageX)-107,e=parseInt(d.pageY)-88;break;case D.HAXIS:t=parseInt(d.pageX)-107,e=parseInt(d.pageY)-53;break;case D.LEGEND:t=parseInt(d.pageX)-107,e=parseInt(d.pageY)-53}return{TOPX:e,LEFTX:t}}var r=e.META,o=e.NAME,d=e.EREF,S=e.props;switch(S&&(S.isSeries=r.getSelectionState(S.sIndex)),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,{CONFIG:e}),o){case D.STYLES:case D.TITLES:case D.VAXIS:case D.HAXIS:case D.SERIES:case D.LEGEND:t()}},h.Client.Action.applyCustomEvents=function(e,t,n,i){function a(e){p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:i,META:e,props:n}})}function r(e,n){e.getSelectionState(n.sIndex);p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:i,META:e,props:n}}),v.zcombo("#chartSeries","setValue",""+n.sIndex),p.publish(u.UI,A.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE)}function o(e){e.resetSelection(),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:i,META:e}})}function l(e,n){e.resetSelection();var a=h.Manager.SidePanelManager;v.zcombo(y.zID,"setValue",y.cRelative[n.subAction]+n.suffix),a.getDialogUtil().updateTitleForSp(e.getID(),y.cRelative[n.subAction]+n.suffix),a.getDialogUtil().updateTitleIndex(e.getID(),y.cRelative[n.subAction]+n.suffix),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:i,META:e,props:n}})}function s(e,n){e.resetSelection(),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:i,META:e,props:n}})}function c(e,n){e.resetSelection();var a=h.Manager.SidePanelManager,r=0==n.index?"LA":"RA"+n.index;v.zcombo("#yaxisMulti","setValue",r),a.getDialogUtil().updateMultiYAxiesDom(e.getID(),{value:0==n.index?"LA":"RA"+n.index}),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:i,META:e,props:n}})}var d=h.Manager.ZSChartCutomEventManager,S=d.isMoved();if(h.Client.Action.destroyContextualToolbar(),S)return void d.setCleanerReason();var T=h.Manager.SidePanelManager;if(T&&T.isPanelOpen())switch(h.Client.Action.removeBorderAnimation({ID:e.getID()}),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:e.getID()}),!T.isRangeEditing()&&p.publish(u.UI,A.SidePanel.CHARTS.ACCORDION.OPEN,{NAME:t.toUpperCase()}),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.SET_PROPERTY,{PROPERTIES:{ID:e.getID(),NAME:t,CONFIG:n}}),t){case D.SERIES:r(e,n);break;case D.STYLES:o(e);break;case D.TITLES:l(e,n);break;case D.HAXIS:s(e,n);break;case D.VAXIS:c(e,n);break;case D.LEGEND:a(e)}},h.Client.Action.removeHoverRect=function(e){for(var t=(h.Wrapper.DOMUtils,new h.Utility.ChartAgent),n=t.getChartMeta(e),i=n.getInstance(),a=i?i.length:0,r=0;a>r;r++)for(var o=i[r],l=o.container,s=l.querySelectorAll("#rectHover"),c=s?s.length:0,d=0;c>d;d++){var S=s[d];S&&S.remove()}},h.Client.Action.removeRect=function(e){var t=(h.Wrapper.DOMUtils,new h.Utility.ChartAgent),n=t.getChartMeta(e);if(n)for(var i=n.getInstance(),a=i?i.length:0,r=0;a>r;r++)for(var o=i[r],l=o.container,s=l.querySelectorAll("#rectAttach"),c=s?s.length:0,d=0;c>d;d++){var S=s[d];S&&S.remove()}},h.Client.Action.reApplyCustomHoverSvg=function(){var e=P.svg;if(e){if(!c(!0)){var t=h.Manager.ZSChartCutomEventManager;return void p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:t.getID()})}var n=e.ID,i=e.ACTION,a=e.INDEX;p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:n}),p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:n,evType:i,INDEX:a})}},h.Client.Action.applyCustomHoverSvg=function(e,t,n,i){function a(){var e,n,a="http://www.w3.org/2000/svg",r="http://www.w3.org/1999/xlink",o="#a5d5c2",l=g.data.AppRegistry.IMAGEPath;if(-1!==t.indexOf("CHART_BACKGROUND"))n=d.createElementNS(a,"rect",{fill:"none","fill-opacity":.3,stroke:o,"stroke-width":1});else{e=d.createElementNS(a,"svg");var s=d.createElementNS(a,"defs"),c=d.createElementNS(a,"pattern"),S=d.createElementNS(a,"image");n=d.createElementNS(a,"rect",{stroke:o,"stroke-width":i?0:1}),S.setAttributeNS(r,"href",l+"Pattern2.png"),S.setAttribute("x","0"),S.setAttribute("y","0"),S.setAttribute("width","5"),S.setAttribute("height","5"),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("width","5"),c.setAttribute("height","5"),c.setAttribute("id","pattern"),c.setAttribute("patternUnits","userSpaceOnUse"),d.appendChild(c,S),d.appendChild(s,c),d.appendChild(e,s)}return{SVG:e,RECT:n}}function r(){var e=a(),t=e.RECT,n=e.SVG;t.setAttributeNS(null,"id",c);{var i=l(),r=i.BOX;i.ELEM}if(r){var s=o(r);if(!s.width)return void h.Client.Action.destroyContextualToolbar();d.addAttributes(t,{fill:"url(#pattern)",x:s.x,y:s.y,width:s.width,height:s.height});var S=T.getHeight(),E=T.getWidth();n?(n.setAttributeNS(null,"width",E),n.setAttributeNS(null,"height",S),n.setAttributeNS(null,"id",c),d.appendChild(n,t)):n=t;for(var I=T.getInstance(),C=I?I.length:0,u=0;C>u;u++){var A=I[u],p=A.container,g=p.getElementsByTagName("svg")[0],R=g.querySelector(U.CHART_BACKGROUND);g.insertBefore(n,R.nextSibling)}}}function o(e){var n,i,a,r;switch(t){case M.CHART_TITLE:case M.CHART_SUBTITLE:case M.CHART_XAXIS_LABELS:case M.CHART_YAXIS_LABELS:case M.CHART_YAXIS_TITLE:case M.CHART_XAXIS_TITLE:case M.CHART_LEGEND:n=parseInt(e.x)-5,i=parseInt(e.y)-5,e.height&&(a=parseInt(e.height)+10),e.width&&(r=parseInt(e.width)+10)}return{x:n,y:i,height:a,width:r}}function l(){var e,i,a=T.getInstance()[0],r=a.container;switch(t){case M.CHART_TITLE:i=r.querySelector(U[t]),a.title&&(e=a.title.getBBox(!0));break;case M.CHART_SUBTITLE:i=r.querySelector(U[t]),a.subtitle&&(e=a.subtitle.getBBox(!0));break;case M.CHART_XAXIS_LABELS:i=r.querySelector(U[t]),e=i.getBBox(!0);break;case M.CHART_YAXIS_LABELS:i=r.querySelectorAll(U[t]),e=i[n].getBBox(!0);break;case M.CHART_YAXIS_TITLE:i=r.querySelectorAll("div"+U[t]),i=i[n];var o=i.children,l=o[0].getBoundingClientRect(),s=d.getParentNode(i).getBoundingClientRect();e={width:parseInt(l.width)+10,height:parseInt(l.height)+10,x:parseInt(l.x)-parseInt(s.x)-5,y:parseInt(l.y)-parseInt(s.y)-5};break;case M.CHART_XAXIS_TITLE:i=r.querySelector("div"+U[t]);var o=i.children,l=o[n||0].getBoundingClientRect(),s=d.getParentNode(i).getBoundingClientRect();e={width:parseInt(l.width)+10,height:parseInt(l.height)+10,x:parseInt(l.x)-parseInt(s.x)-5,y:parseInt(l.y)-parseInt(s.y)-5};break;case M.CHART_LEGEND:i=r.querySelector(U[t]);var l=i.getBoundingClientRect(),s=d.getParentNode(i).getBoundingClientRect();e={width:parseInt(l.width)+10,height:parseInt(l.height)+10,x:parseInt(l.x)-parseInt(s.x)-5,y:parseInt(l.y)-parseInt(s.y)-5}}return{BOX:e,ELEM:i}}var s=h.Manager.SidePanelManager;if(s&&s.isPanelOpen()){var c=i?"rectHover":"rectAttach";i||p.publish(u.UI,A.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,{CONFIG:{NAME:t,ID:e,index:n}});var d=h.Wrapper.DOMUtils,S=new h.Utility.ChartAgent,T=S.getChartMeta(e);switch(t){case M.CHART_TITLE:case M.CHART_SUBTITLE:case M.CHART_BACKGROUND:case M.CHART_XAXIS_LABELS:case M.CHART_YAXIS_LABELS:case M.CHART_YAXIS_TITLE:case M.CHART_XAXIS_TITLE:case M.CHART_LEGEND:r()}}},h.Utility.getSeriesColor=T,h.Utility.isCompositionChart=l,h.Utility.getChartMetaByIndex=s,h.Manager.ZSChartCutomEventManager=new t,h.Constants.CustomEventName=M,h.Constants.CustomEventGroupName=D,p.register(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.INIT_TOOLBAR,S,"EVENT"),p.register(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.INIT,a),p.register(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.SET_PROPERTY,r,"PROPERTIES"),p.register(u.UI,A.SidePanel.CHARTS.CUSTOM.EVENT.SYNC_PROPERTY_TO_TOOLBAR,o,"PROPERTIES")}(this);
!function(t){function n(t,n){return new Promise(function(e){t[n].redraw(),setTimeout(function(){e()},100)})}function e(t,i,u){u>i&&n(t,i).then(function(){e(t,++i,u)})}function i(t,n,e,o){o>e&&u(t,n,e).then(function(){i(t,n,++e,o)})}function u(t,n,e){return new Promise(function(i){t[e].updateTitle(n),setTimeout(function(){i()},100)})}function o(t,n,e,i){i>e&&r(t,n,e).then(function(){o(t,n,++e,i)})}function r(t,n,e){return new Promise(function(i){t[e].updateSubTitle(n),setTimeout(function(){i()},100)})}function c(t,n,e,i){i>e&&f(t,n,e).then(function(){c(t,n,++e,i)})}function f(t,n,e){return new Promise(function(i){t[e].updateXTitle(n,0),setTimeout(function(){i()},100)})}function a(t,n,e,i){i>e&&s(t,n,e).then(function(){a(t,n,++e,i)})}function s(t,n,e){return new Promise(function(i){var u=X.view.getActiveGridID(),o=X.view.getSheetID(u),r=X.view.getSheetState(u,o),c=r.getZoom();n.chart.width=n.chart.width*c,n.chart.height=n.chart.height*c,t[e].updateChart(n),setTimeout(function(){i()},100)})}function l(t,n,e,i){i>e&&h(t,n,e).then(function(){l(t,n,++e,i)})}function h(t,n,e){return new Promise(function(i){t[e].updateXAxis(n),setTimeout(function(){i()},100)})}function d(t,n,e,i){i>e&&m(t,n,e).then(function(){d(t,n,++e,i)})}function m(t,n,e){return new Promise(function(i){t[e].setPositiveExtreme(!1),t[e].updateYAxis(n),setTimeout(function(){i()},100)})}function v(t,n,e,i){i>e&&g(t,n,e).then(function(){v(t,n,++e,i)})}function g(t,n,e){return new Promise(function(i){var u=X.view.getActiveGridID(),o=X.view.getSheetID(u),r=X.view.getSheetState(u,o),c=r.getZoom();n.width=n.width*c,n.height=n.height*c,t[e].updateChartObject(n),setTimeout(function(){i()},100)})}function p(t,n,e,i,u){u>i&&w(t,n,e,i).then(function(){p(t,n,e,++i,u)})}function w(t,n,e,i){return new Promise(function(u){var o=X.view.getActiveGridID(),r=X.view.getSheetID(o),c=X.view.getSheetState(o,r),f=c.getZoom();t[i].setZSCSize(e*f,n*f),setTimeout(function(){u()},10)})}function T(t,n,e,i){i>e&&S(t,n,e).then(function(){T(t,n,++e,i)})}function S(t,n,e){return new Promise(function(i){t[e].updateDataLabels(n),setTimeout(function(){i()},200)})}function y(t,n,e,i,u){i>e&&U(t,n,e,u).then(function(){y(t,n,++e,i,u)})}function U(t,n,e,i){return new Promise(function(u){for(var o=0;i>o;o++)n&&t[e].addYMajorGrid(o),!n&&t[e].removeYMajorGrid(o);setTimeout(function(){u()},100)})}function P(t,n,e,i,u){i>e&&A(t,n,e,u).then(function(){P(t,n,++e,i,u)})}function A(t,n,e,i){return new Promise(function(u){for(var o=0;i>o;o++)n&&t[e].addYMinorGrid(o),!n&&t[e].removeYMinorGrid(o);setTimeout(function(){u()},100)})}function C(t,n,e,i){i>e&&b(t,n,e).then(function(){C(t,n,++e,i)})}function b(t,n,e){return new Promise(function(i){t[e].updateAnimation(n),setTimeout(function(){i()},100)})}function x(t,n,e,i){i>e&&D(t,n,e).then(function(){x(t,n,++e,i)})}function D(t,n,e){return new Promise(function(i){t[e].updateTooltip(n),setTimeout(function(){i()},100)})}function Y(t,n,e,i){i>e&&G(t,n,e).then(function(){Y(t,n,++e,i)})}function G(t,n,e){return new Promise(function(i){t[e].updateMarker(n),setTimeout(function(){i()},100)})}function j(t,n,e,i){i>e&&O(t,n,e).then(function(){j(t,n,++e,i)})}function M(t,n,e,i){i>e&&I(t,n,e).then(function(){M(t,n,++e,i)})}function I(t,n,e){return new Promise(function(i){var u=t[e];u.updateChartObject(n.getChartObject()),u.setAnimation(!1);var o=n.getTitle();u.updateTitle(o.text);var r=n.getSubTitle();u.updateSubTitle(r.text);var c=n.getXAxis();u.updateXAxis(c);var f=n.getYAxis();u.updateYAxis(f);var a=n.getSeriesObject();u.updateSeries(a);{var s=n.getChartDetails();Z(n.constructChartOptions(),s.lf,{type:s.type,isSingleYaxis:s.isSingleYaxis,secYAxisSymbl:s.secYAxisSymbl,currency:s.currency,ds:s.ds,ts:s.ts,precisions:s.precision})}u.updateDataLabels(ChartOptions),setTimeout(function(){i()},100)})}function O(t,n,e){return new Promise(function(i){t[e].updateTitleStyle(n),setTimeout(function(){i()},100)})}function Z(t,n,e){var i=new L.Utility.CommanAgent;return!e&&(e=i.getDefaultDataLabelConfig(t.chart.renderTo)),e.lf=n,i.getDataLabelsUpdate(t,e)}var X=t.sPlusPlus,L=(t.ZSClass,t.JSUtill,t.UIUtil.Component,t.ZSEvents,t.ZSChart);L.Utility.updateChart={fn:function(t,n){var e=0,i=t.length;a(t,n,e,i)}},L.Utility.updateTitle={fn:function(t,n){var e=0,u=t.length;i(t,n,e,u)}},L.Utility.redraw={fn:function(t){var n=0,i=t.length;e(t,n,i)}},L.Utility.updateSubTitle={fn:function(t,n){var e=0,i=t.length;o(t,n,e,i)}},L.Utility.updateXTitle={fn:function(t,n){var e=0,i=t.length;c(t,n,e,i)}},L.Utility.updateXAxis={fn:function(t,n){var e=0,i=t.length;l(t,n,e,i)}},L.Utility.updateYAxis={fn:function(t,n){var e=0,i=t.length;d(t,n,e,i)}},L.Utility.updateChartObject={fn:function(t,n){var e=0,i=t.length;v(t,n,e,i)}},L.Utility.setSize={fn:function(t,n,e){var i=0,u=t.length;p(t,n,e,i,u)}},L.Utility.updateDataLabels={fn:function(t,n){var e=0,i=t.length;T(t,n,e,i)}},L.Utility.updateMajorGrid={fn:function(t,n,e){var i=0,u=t.length;y(t,n,i,u,e)}},L.Utility.updateMinorGrid={fn:function(t,n,e){var i=0,u=t.length;P(t,n,i,u,e)}},L.Utility.updateAnimation={fn:function(t,n){var e=0,i=t.length;C(t,n,e,i)}},L.Utility.updateTooltip={fn:function(t,n){var e=0,i=t.length;x(t,n,e,i)}},L.Utility.updateMarker={fn:function(t,n){var e=0,i=t.length;Y(t,n,e,i)}},L.Utility.updateTitleStyle={fn:function(t,n){var e=0,i=t.length;j(t,n,e,i)}},L.Utility.updateChartClient={fn:function(t,n){var e=0,i=t.length;M(t,n,e,i)}}}(this);
!function(t){function i(t,i,s,e,h){this.isSingleRowDataAllowed=t||!1,this.dateTypeAllowed=i||!1,this.isGroupedChartAllowed=s||!1,this.chartCategory=e||p.Comparison,this.ChartType=h}function s(){i.call(this),this.init()}function e(t,i){-1===i.indexOf(t.ChartType)&&this.dateType&&this.noOfSeries>=1&&i.push(t.ChartType)}function h(t,i){-1===i.indexOf(t.ChartType)&&(this.dateType||this.isGroupedChart||this.noOfSeries>=2&&!this.firstRowAsLabel&&!this.firstColAsLabel&&i.push(t.ChartType))}function a(t,i){-1===i.indexOf(t.ChartType)&&i.push(t.ChartType)}function o(t,i){-1===i.indexOf(t.ChartType)&&i.push(t.ChartType)}function n(t,i){-1===i.indexOf(t.ChartType)&&(this.dateType||this.isGroupedChart||this.isSingleRowData&&this.dataLengthInSeries<=6&&i.push(t.ChartType))}function T(t,i){-1===i.indexOf(t.ChartType)&&(this.isSingleRowData||this.frl&&this.fcl&&i.push(t.ChartType))}var r=(t.sPlusPlus,t.ZSChart);const p={Comparison:1,Composion:2,Relationship:3,Distribution:4,Comparison_Composition:5};s.prototype.init=function(){this.SUPPORTED_CHART_LIST=["XYLINE","SCATTER","BAR","COL","PIE","COMBOCHART","DOUGHNUT"],this.RULE_SET={},this.META_DATA=null,this.SELECTED_CHART_TYPE=null,this.isSingleRowData=!1,this.dataLengthInSeries=0,this.dateType=!1,this.isGroupedChart=!1,this.noOfSeries=0,this.firstColAsLabel=!1,this.firstRowAsLabel=!1,this.initRuleSet()},s.prototype.initRuleSet=function(){this.SUPPORTED_CHART_LIST.forEach(function(t){switch(t){case"XYLINE":this.RULE_SET[t]=new i(!0,!0,!0,p.Relationship,t);break;case"SCATTER":this.RULE_SET[t]=new i(!0,!1,!1,p.Relationship,t);break;case"BAR":this.RULE_SET[t]=new i(!0,!0,!0,p.Comparison,t);break;case"COL":this.RULE_SET[t]=new i(!0,!0,!0,p.Comparison,t);break;case"PIE":case"DOUGHNUT":this.RULE_SET[t]=new i(!0,!1,!1,p.Composion,t);break;case"COMBOCHART":this.RULE_SET[t]=new i(!1,!0,!0,p.Comparison_Composition,t)}}.bind(this))},s.prototype.setMetaData=function(t,i){this.META_DATA=t,i&&(this.SELECTED_CHART_TYPE=t.type)},s.prototype.predict=function(){return this.analyzedData(),this.getPossibility(3)},s.prototype.analyzedData=function(){this.isDateType(),this.isSingleRowDataType(),this.dataFilter()},s.prototype.isDateType=function(){this.dateType="datetime"==this.META_DATA.co.xAxis.type},s.prototype.isSingleRowDataType=function(){this.isSingleRowData=1==this.META_DATA.co.series.length},s.prototype.dataFilter=function(){this.noOfSeries=this.META_DATA.co.series.length||0,this.isGroupedChart=this.META_DATA.grouping||!1,this.firstColAsLabel=!1||this.META_DATA.fcl,this.firstRowAsLabel=!1||this.META_DATA.frl,this.noOfSeries>=1&&(this.dataLengthInSeries=this.META_DATA.co.series[0].data.length)},s.prototype.getPossibility=function(t){var i=[];return this.SELECTED_CHART_TYPE&&i.push(this.SELECTED_CHART_TYPE),this.SELECTED_CHART_TYPE&&-1==this.SUPPORTED_CHART_LIST.indexOf(this.SELECTED_CHART_TYPE)?i:(this.parse(i),t?i.splice(0,t):i)},s.prototype.parse=function(t){this.SUPPORTED_CHART_LIST.forEach(function(i){switch(i){case"XYLINE":e.call(this,this.RULE_SET[i],t);break;case"SCATTER":h.call(this,this.RULE_SET[i],t);break;case"BAR":a.call(this,this.RULE_SET[i],t);break;case"COL":o.call(this,this.RULE_SET[i],t);break;case"PIE":n.call(this,this.RULE_SET[i],t);break;case"COMBOCHART":T.call(this,this.RULE_SET[i],t)}}.bind(this))},r.Manager.ZRecommendation=s}(this);
!function(e){function t(){}var r=e.sPlusPlus,o=(e.ZSClass,e.UserAction,e.ZSChart),n=o.Constants.ChartType,a=e.UIUtil.Component,i=!1,s=[],p=null,l=(e.ZSDevTools.Logger,{}),h={},c=null,u=e.ZSEvents,g=u.Groups,m=u.Names,y=u.topic;t.prototype.setDialogStatus=function(e){i=e},t.prototype.isAllowToDraw=function(e){try{for(var t=e.co.series,r=!0,o=0;o<t.length&&r;o++){r=!0;var n=t[o].data;if(n)for(var a=0;a<n.length;a++)if(n[a].y||n[a].weight){r=!1;break}}return r?!1:!0}catch(e){return!1}},t.prototype.setRangeState=function(e,t){h[e]=t},t.prototype.getRangeState=function(e){return h[e]},t.prototype.resetRangePicker=function(){l={}},t.prototype.setMoveMenuRefreshedSheetName=function(e){c=e},t.prototype.getMoveMenuRefreshSheetName=function(){return c},t.prototype.resetMoveMenu=function(){c=null},t.prototype.addRangePicker=function(e,t){l[e]=t},t.prototype.getRangePicker=function(e){return l[e]},t.prototype.pickIntegerFromString=function(e,t){var r=/\d+/g,o=e.match(r);return t?o:o?o[0]:0},t.prototype.isFallUnderCompositionType=function(e){var t=[];return t.push(n.PIE),t.push(n.SEMIPIE),t.push(n.FUNNEL),t.push(n.SEMIDOUGHNUT),t.push(n.DOUGHNUT),t.push(n.DOUGHNUT3D),t.push(n.PIE3D),-1!==t.indexOf(e.toLowerCase())},t.prototype.checkIfDataApplicableForChartType=function(e,t){var r=e.getType(),a=o.Utility.getSeriesLengthFromRange(e,t),i=!0;switch(r.toLowerCase()){case n.OHLCCHART:case n.CANDLESTICK:i=a>=4;break;case n.BUBBLE:i=a>1}return i},t.prototype.getRangeAry=function(e,t,r){var o="",n=";";return e&&""!==e?(n?ranges=e.split(n):ranges.push(e),o="COLS"==t&&"VERTICAL"==r||"ROWS"==t&&"HORIZONTAL"==r?ranges[0]:e):[]},t.prototype.getGroupedChartName=function(e){var t={};return t.GROUPEDCOL="COL",t.GROUPEDBAR="BAR",t[e]?t[e]:e},t.prototype.get3DChartName=function(e){var t={};return t.COL="COL3D",t.BAR="BAR3D",t.PIE="PIE3D",t.DOUGHNUT="DOUGHNUT3D",t[e]},t.prototype.isWordCloud=function(e){return"WORDCLOUD"===e},t.prototype.isHistogram=function(e){return"HISTOGRAM"===e},t.prototype.isFallUnder3D=function(e){var t=[];return t.push(n.PIE),t.push(n.DOUGHNUT),t.push(n.COLUMNCHART),t.push(n.BAR),-1!==t.indexOf(e.toLowerCase())||-1!==e.indexOf(n.STACKED)||-1!==e.indexOf("3D")},t.prototype.isFallUnderCorrelationType=function(e){var t=[];return t.push(n.SCATTER),t.push(n.XYLINE_SCATTER),t.push(n.XYLINE_SCATTER_SHAPES),-1!==t.indexOf(e.toLowerCase())},t.prototype.isComboChartContainsLine=function(e,t){var r=!1;if(e===n.COMBOCHART)for(var o=Object.keys(t),a=0;a<o.length;a++)if(-1!==t[o[a]].indexOf(n.XYLINE.toUpperCase())){r=!0;break}return r},t.prototype.getScaleFactorConstant=function(e){return-1!==o.Constants.ScaleRange.indexOf(e)?e:"custom"},t.prototype.isFallUnderLineType=function(e){var t=[];return t.push(n.XYLINE),t.push(n.SPLINE),t.push(n.STEPCHART),-1!==t.indexOf(e.toLowerCase())},t.prototype.isGroupingAllowedInChart=function(e){var t=[];return t.push(n.COLUMN),t.push(n.COLUMNCHART),t.push(n.BAR),t.push(n.GROUPEDCOL),t.push(n.GROUPEDBAR),-1!==t.indexOf(e.toLowerCase())},t.prototype.getDialogStatus=function(){return i},t.prototype.setActiveChartID=function(e){s.push(e)},t.prototype.removeActiveChartID=function(){return s.pop()},t.prototype.getActiveChartID=function(){return s[s.length-1]},t.prototype.setDialogUtil=function(e){p=e},t.prototype.removeDailogUtil=function(){p=null},t.prototype.getDialogUtil=function(){return p},t.prototype.updateTheme=function(e){var t=this.getDialogStatus()||!1,r=o.Manager.SidePanelManager,n=r.getActiveChartID()||"preview";this.getDialogUtil().updateTheme(n,e,t);var a=new o.Controller.ZSCController;!t&&a.updateTheme(e)},t.prototype.resetSidePanel=function(){var e=o.Wrapper.DOMUtils;a.zcombo("#yaxisMulti","setValue","LA"),a.zcombo("#chartTitleCombo","setValue","CHART_TITLE");var t=new o.Utility.AgentDom;t.closeAggregationTab(),t.closeFilterTab(),!e.hasClass(e.getElementByClassName("generalTab"),"active")&&e.getElementByClassName("generalTab").click(),y.publish(g.UI,m.SidePanel.CHARTS.CLOSE_ALL_ACCORDIONS)},t.prototype.resetTitleCombo=function(){a.zcombo("#chartTitleCombo","setValue","CHART_TITLE")},t.prototype.reveseColorScheme=function(e){var t=this.getDialogStatus()||!1,r=o.Manager.SidePanelManager,n=r.getActiveChartID()||"preview";t&&this.getDialogUtil().reveseColorScheme(n,e);var a=new o.Controller.ZSCController;!t&&a.reveseColorScheme(e)},t.prototype.getAssociateParentThemeNameByChildThemeName=function(e){var t=o.Constants,t=o.Constants,r=t.SupportedTheme,n=t.ColorSchemeType,a=/\d+/g,i=e.match(a);return-1!==e.indexOf(n.COLORFUL)?e:-1!==e.indexOf(n.CUSTOM)?r.SHEET_OFFICE_COLORFUL_THEME1:i>=1&&6>=i?r.SHEET_OFFICE_COLORFUL_THEME1:i>=7&&12>=i?r.SHEET_OFFICE_COLORFUL_THEME2:i>=13&&18>=i?r.SHEET_OFFICE_COLORFUL_THEME3:i>=19&&24>=i?r.SHEET_OFFICE_COLORFUL_THEME4:i>=25&&30>=i?r.SHEET_OFFICE_COLORFUL_THEME5:r.SHEET_OFFICE_COLORFUL_THEME6},t.prototype.getSupportedChartThemeObject=function(){var e=o.Constants,t=e.ColorThemeRange;return t},t.prototype.mergeRecursively=function(e,t){return t&&Object.keys(t).forEach(function(r){e[r]="object"==typeof t[r]&&e[r]?this.mergeRecursively(e[r],t[r]):t[r]}.bind(this)),e},t.prototype.getLegendName=function(e){var t=["None","Bottom","Top","Right","Left","TopRight"];return t[e]},t.prototype.getLegendPosition=function(e){var t=o.Manager.SidePanelManager;e||(t&&t.isPanelOpen()&&(e=a.zcombo("#legendPos","getValue")),t&&!t.isPanelOpen()&&(e="None"));var r={Bottom:1,Left:4,Right:3,Top:2,None:0,TopRight:5};return r[e]},t.prototype.setDefaultLegendItemStylesOrElse=function(e,t){return t?e.itemStyle=t:e.itemStyle?e.itemStyle.fontWeight||(e.itemStyle.fontWeight="normal"):e.itemStyle={fontWeight:"normal"},e},t.prototype.getLegendUpdate=function(e){var t,r,o,n={},a=!0,i={x:0,y:0};switch(e=this.getLegendName(e)){case"Top":case 2:t="horizontal",r="center",o="top";break;case"Bottom":case 1:t="horizontal",r="center",o="bottom";break;case"Left":case 4:t="vertical",r="left",o="middle";break;case"Right":case 3:t="vertical",r="right",o="middle";break;case"TopRight":case 5:t="vertical",r="right",o="top";break;case"None":case 0:a=!1}return t&&(n.layout=t),r&&(n.align=r),o&&(n.verticalAlign=o),n.maxHeight="bottom"!==o&&"top"!==o||"vertical"===t?"":55,n.y=i.y,n.symbolHeight=10,n.symbolWidth=10,n.borderWidth=0,n.enabled=a,n},t.prototype.getDataLabelsUpdate=function(e,t){delete e.legend;{var r=t.lf,a=t.currency,i=(t.ds,t.ts,t.type),s=new o.Utility.ChartAgent,a=s.filterCurrency(a,e.series?e.series.length:0);t.precisions}switch(r){case"N":e.plotOptions.series.dataLabels={enabled:!1};break;case"V":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){var e=s.pickCurrency(a,this.series.index,i),t=this.point.decimals;return this.y>=0?"%"===e?Highcharts.numberFormat(this.y,t)+e:e+Highcharts.numberFormat(this.y,t):"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:"-"+e+Highcharts.numberFormat(Math.abs(this.y),t)}};break;case"L":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key}};break;case"S":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name}};break;case"P":(-1!==i.toLowerCase().indexOf(n.FUNNEL)||-1!==i.toLowerCase().indexOf(n.PIE)||-1!==i.toLowerCase().indexOf(n.DOUGHNUT)||e.plotOptions.series.stacking&&(-1!==e.plotOptions.series.stacking.indexOf("normal")||-1!==e.plotOptions.series.stacking.indexOf("percent")))&&(e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return Highcharts.numberFormat(this.percentage,2)+"%"}});break;case"L_P":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key?this.key+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"S_V":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:a,formatter:function(){var e=s.pickCurrency(a,this.series.index,i),t=this.point.decimals;return this.y>=0?"%"===e?this.series.name+" ("+Highcharts.numberFormat(this.y,t)+e+")":this.series.name+" ("+e+Highcharts.numberFormat(this.y,t)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:this.series.name+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),t)+")"}};break;case"L_V":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:a,formatter:function(){var e=s.pickCurrency(a,this.series.index,i),t=this.point.decimals;return this.y>=0?"%"===e?this.key+" ("+Highcharts.numberFormat(this.y,t)+e+")":this.key+" ("+e+Highcharts.numberFormat(this.y,t)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:this.key+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),t)+")"}};break;case"S_P":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name?this.series.name+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"V_P":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.y?this.y+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"B":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.point.z}};break;default:e.plotOptions.series.dataLabels={enabled:!1}}return e},t.prototype.getDefaultDataLabelConfig=function(e){var t=r.view.getActiveGridID(),o=r.view.getVersionID(t),n=r.view.getResourceID(t),a=r.data.getWorkBook(n,o),i=r.view.getSheetID(t),s=a.getSheetObj(i),p=s.Charts,l=p.get(e),h={type:l.getType(),isSingleYaxis:l.isSingleYaxis(),secYAxisSymbl:l.getSecYAxisSymbol(),currency:l.getCurrency(),ds:l.getDecimalSeprator(),ts:l.getThousandSeprator(),precisions:l.getPrecisions()};return h},!o.Utility&&(o.Utility={}),o.Utility.CommanAgent=t}(this);
!function(e){function t(){}function a(e,t){var a=new d.Utility.CommanAgent,r=a.pickIntegerFromString(t)-1,l=d.Wrapper.DOMUtils,o={dashStyle:"shortDash",fontSize:"12px",fontWeight:"normal",fontStyle:"normal",color:"#2d2d2d"};try{if(r>=0&&e){var i=e[r],n=i.label?i.label.style:{};s.zcombo("#chartPlotNameFont","setValue",n.fontSize||"12px"),s.zcolorselectbox("#chartPlotNameFontContainer","setValue",n.color||"#2d2d2d");var p=l.getElementById("chartPlotNamebold"),c=l.getElementById("chartPlotNameitalic");"italic"==n.fontStyle?l.addClass(c,"active"):l.removeClass(c,"active"),"bold"==n.fontWeight?l.addClass(p,"active"):l.removeClass(p,"active"),s.zcolorchooser("#chartPlotLineColor","setValue",i.color)}}catch(e){s.zcombo("#chartPlotNameFont","setValue",o.fontSize||"12px"),s.zcolorselectbox("#chartPlotNameFontContainer","setValue",o.color||"#2d2d2d");var p=l.getElementById("chartPlotNamebold"),c=l.getElementById("chartPlotNameitalic");"italic"==o.fontStyle?l.addClass(c,"active"):l.removeClass(c,"active"),"bold"==o.fontWeight?l.addClass(p,"active"):l.removeClass(p,"active"),s.zcolorchooser("#chartPlotLineColor","setValue",o.color)}}function r(e){var t=d.Constants.UnitFormat,a=d.Constants.NumberFormat,r=e;switch(e){case t.THOUSANDS:case t.MILLIONS:case t.BILLIONS:r=a.DEFAULT}return r}var l=e.sPlusPlus,o=e.ZSEvents,i=o.Groups,n=(o.Names,o.topic),d=e.ZSChart,s=e.UIUtil.Component,p=(d.Constants.ServiceProvider,d.Constants.ChartType),c=ZSConstants.I18N,g=e.document,m=d.Constants.ChartRangePickerType,u=(d.Constants.ChartClasses,d.Constants.ChartNames),y=d.Constants.defaultColor,h=e.ZSConstants.CommandConstants,C=d.Wrapper.DOMUtils;t.prototype.setDivContainerProperty=function(e,t,a,r,l,o,i,n,s,p,c,m,u){var y=g.createDocumentFragment(),h=d.Wrapper.DOMUtils,C=u||h.createElement("div",{context:"MI_CHART_CONTEXT"});C.id=r,y.appendChild(C);var v=new d.Controller.ZSCController;v.AddOle(e,t,a,r,n,i,o,l),v.AddContent(e,t,a,r,y)},t.prototype.generateMonochromaticShades=function(e){var t=d.Wrapper.DOMUtils,a=new d.Utility.CommanAgent;e=a.getAssociateParentThemeNameByChildThemeName(e);for(var r,l=a.getSupportedChartThemeObject(),o=l[e],i="SHEET-OFFICE-MONOCHORMATIC-THEME",n="",s=t.getElements("colorpaletteDialogMonochromatic > li"),p=o.startIndex;p<=o.endIndex;p++){r=o.basecolor[p-o.startIndex],n=new d.Utility.SheetChartColor(r).getLinerGradient(6);var c={"data-basecolor":r,"data-name":i+p};t.addAttributes(s[p-o.startIndex],c),t.addStyle(s[p-o.startIndex],{"background-image":n})}},t.prototype.resetFilterIfNeeded=function(){d.Wrapper.DOMUtils;s.zcombo("#filterType","setValue","NONE"),s.zspinner("#filterSpinner","setValue","0"),s.zcombo("#filterColumns","setValue","noFilter")},t.prototype.reverseAllLiItems=function(e){var t=d.Wrapper.DOMUtils,a="chartDialogCPalletteCode",r=t.getElements(a);for(var l in r){var o=r[l],i=o.children;for(var l in i){var n=i[l];1==n.nodeType&&n.setAttribute("data-reversed",e)}}var a="colorDialogCustomPallete",r=t.getElements(a);for(var l in r){var o=r[l];1==o.nodeType&&o.setAttribute("data-reversed",e)}},t.prototype.resetColorDOMProperty=function(e,t){var a=d.Wrapper.DOMUtils,r=d.Constants,l=r.ColorSchemeType,s=this.getColorScaleProperty(e);if(t){var p="chartThemePallate";a.addAttributes(p,s.property);var c=-1!==a.getElementById(p).dataset.name.indexOf(l.COLORFUL);c&&a.getElementById(p).setAttribute("data-reversed",!1),a.addStyle(p,s.css)}a.removeClass(a.findByClassName("cPaletteCode > li","active"),"active"),a.removeClass(a.getElementByClassName("colorDialogCustomPallete"),"active");for(var g="cPaletteCode li[data-name ="+s.property["data-name"]+"]",m=a.getElements(g),u=0;u<m.length;u++)a.addClass(m[u],"active");var y=s.property["data-reversed"];y="string"==typeof y?"true"==y?!0:!1:y;var h="customColorToggle";a.getElements(h)[0].checked=y;var C=e.colorObject.colorTheme,v="colorDialogCustomPallete",I="chartcustomcolorDropDown";-1!==C.name.indexOf(l.CUSTOM)&&(a.addStyle(v,s.css),a.addAttributes(v,s.property),a.addStyle(I+" > span",{background:C.basecolor}),a.addClass(a.getElementByClassName(v),"active")),this.reverseAllLiItems(y);var A=a.getElementById("chrtTypeLblValue");A&&n.publish(i.UI,o.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:A})},t.prototype.getColorScaleProperty=function(e){var t=e.colorObject.colorTheme,a=t.basecolor,r=d.Constants,l=r.ColorSchemeType;a="string"==typeof a&&-1!==a.indexOf("[")?JSON.parse(a):a;var o=t.name,i=-1!==o.indexOf(l.COLORFUL),n=new d.Utility.SheetChartColor(a),s=i?n.generateLinearGradient():n.getLinerGradient(6),p=new d.Utility.ChartAgent;p.generateMonochromaticShades(o,!0);var c=t.isReversed;"undefined"==typeof c&&(c=t.reversed);var g={property:{"data-basecolor":a,"data-name":t.name,"data-reversed":c},css:{"background-image":s}};return g},t.prototype.refreshDataLabelsAsync=function(e){var t=new d.Utility.CommanAgent,a=d.Wrapper.DOMUtils;return new Promise(function(r){var l=["dataLabels_bubble_size","dataLabels_series_value","dataLabels_label_value","dataLabels_label_percent","dataLabels_value_percent","dataLabels_series_percent","dataLabels_percent"];a.removeAll(l);var o=a.getElementById("dataLabels");if(t.isFallUnderCompositionType(e)){var i=a.createElement("option",{id:"dataLabels_percent",value:"P"});i.innerText=c.ShowPercent,a.appendChild(o,i)}if(-1!==e.toLowerCase().indexOf(p.BUBBLE)){var n=a.createElement("option",{id:"dataLabels_bubble_size",value:"B"});n.innerText=c.ShowBubbleSize,a.appendChild(o,n)}var d=a.createElement("option",{id:"dataLabels_label_value",value:"L_V"});d.innerText=c.ShowLabelValue,a.appendChild(o,d);var g=a.createElement("option",{id:"dataLabels_series_value",value:"S_V"});if(g.innerText=c.ShowSeriesValue,a.appendChild(o,g),-1!==e.indexOf(p.STACKED)||t.isFallUnderCompositionType(e)){var m=a.createElement("option",{id:"dataLabels_label_percent",value:"L_P"});m.innerText=c.ShowLabelPercent,a.appendChild(o,m);var u=a.createElement("option",{id:"dataLabels_value_percent",value:"V_P"});u.innerText=c.ShowValuePercentage,a.appendChild(o,u);var y=a.createElement("option",{id:"dataLabels_series_percent",value:"S_P"});y.innerText=c.ShowSeriesPercentage,a.appendChild(o,y)}s.zcombo("#dataLabels","refresh"),setTimeout(function(){r()},100)})},t.prototype.updateYAxiesRelative=function(e,t){var a=new d.Utility.CommanAgent,r=a.pickIntegerFromString(t.value),l=e.getYAxis(),o=l[r];e.setActiveYIndex(r),this.generatePlotline(l,r),o&&this.updateYAxiesRelativeByAxiesObjectSP(o,r)},t.prototype.refreshDialogDom=function(e){this.updateSeriesDom(e).then(function(){this.refreshDataLabelsAsync(e.getType()).then(function(){this.refreshMuilipleAxiesLabelAsync(e)}.bind(this))}.bind(this))},t.prototype.updateSeriesDom=function(e){var t=d.Wrapper.DOMUtils;return new Promise(function(a){var r=e.getOptions(),l=r.series,c=document.getElementById("chartSeries");c.innerHTML="";var g=new d.Utility.CommanAgent,m=g.isFallUnderCompositionType(e.getType());if(m)for(var u=new d.Utility.ChartAgent,y=u.getMaximumSeriesLength(r),h=y[1],C=0;h>C;C++){var v=l[y[0]].data[C].name||"point "+(C+1),I=t.createElement("option",{id:v,value:C});I.innerText=v,t.appendChild(c,I)}else for(var h=l?l.length:0,C=0;h>C;C++){var v=l[C].name||"series "+(C+1),I=t.createElement("option",{id:v,value:C});I.innerText=v,t.appendChild(c,I)}s.zcombo("#chartSeries","refresh"),s.zcombo("#chartSeries","setValue","0"),t.hideById("chartTypeMenuWrapper"),e.getType()==p.COMBOCHART&&t.addStyle("chartTypeMenuWrapper",{display:""}),setTimeout(function(){a()},100),n.publish(i.UI,o.Names.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE)})},t.prototype.createPlotLineDom=function(t){var a=d.Wrapper.DOMUtils,r=e.UserAction.getTemplate(["CHART_PLOTLINE_TEMPLATE"]),l=r.CHART_PLOTLINE_TEMPLATE,o=l.cloneNode(!0);if(o.hasChildNodes()){var i=o.querySelectorAll("input"),n=o.querySelector("span"),s=i[0],p=i[1];s.setAttribute("data-index",t),p.setAttribute("data-index",t),s.id="PlotlineName"+t,p.id="PlotlineValue"+t,p.addEventListener("keyup",d.Action.updatePlotline),n.addEventListener("click",d.Action.removePlotLine),s.addEventListener("keyup",d.Action.updatePlotlineName)}var c=a.getElementById("plotLineWrapper");c.appendChild(o),2>t?a.showById("addPlotLine"):a.hideById("addPlotLine")},t.prototype.generateDefaultPlotline=function(){var t=d.Wrapper.DOMUtils,a=e.UserAction.getTemplate(["CHART_PLOTLINE_DEFAULT_TEMPLATE"]),r=a.CHART_PLOTLINE_DEFAULT_TEMPLATE,l=r.cloneNode(!0);if(l.hasChildNodes()){var o=l.querySelectorAll("input"),i=o[0],n=o[1];i.setAttribute("data-index",0),n.setAttribute("data-index",0),i.id="PlotlineName0",n.id="PlotlineValue0",n.addEventListener("keyup",d.Action.updatePlotline),i.addEventListener("keyup",d.Action.updatePlotlineName)}var s=t.getElementById("plotLineWrapper");s.appendChild(l)},t.prototype.generatePlotline=function(e,t){var a=d.Wrapper.DOMUtils,r=e.length?e[t]:e,l=r.plotLines,o=l?l.length||0:0,i=a.getElementById("plotLineWrapper");i.innerHTML="",this.generateDefaultPlotline(),this.addCustomPlotline(1,o),o>=3&&this.hideAddButton(),this.refreshPlotlineDom(l)},t.prototype.refreshPlotlineDom=function(e,t){return new Promise(function(r){var l=document.getElementById("plotlineValues"),o=s.zcombo("#plotlineValues","getValue");l.innerHTML="";for(var i=e?e.length:t?t:0,n=0;i>n;n++){var d="Plotline"+(n+1),p=C.createElement("option",{id:d,value:d});p.innerText=d,C.appendChild(l,p)}if(0==i){var d="None",p=C.createElement("option",{id:d,value:d});p.innerText=d,C.appendChild(l,p),C.hideById("plotlineCustomizationWrapper")}else C.addStyle("plotlineCustomizationWrapper",{display:""});s.zcombo("#plotlineValues","refresh"),s.zcombo("#plotlineValues","setValue",o||"Plotline1"),a(e,o||"Plotline1"),setTimeout(function(){r()},10)})},t.prototype.hideAddButton=function(){var e=d.Wrapper.DOMUtils,t=e.getElementById("addPlotLine");e.hide(t)},t.prototype.addCustomPlotline=function(e,t){for(var a=e,r=e;t>a;a++,r++)this.createPlotLineDom(r)},t.prototype.refreshMuilipleAxiesLabelAsync=function(e){var t=d.Wrapper.DOMUtils;return new Promise(function(a){var r=t.getElementById("yaxisMulti");if(null!==r){var l=r.children,o=l.length,i=e.getOptions(),n=i.series?i.series.length:0;if(o==n)return;for(var d=1;o>d;d++)t.remove("RA"+d);for(var p=1;n>p;p++){var g=t.createElement("option",{id:"RA"+p,value:"RA"+p,class:"RA"});g.innerText=c["Chart.SelectedAxis.RightAxis"]+p,t.appendChild(r,g)}s.zcombo("#yaxisMulti","refresh")}setTimeout(function(){a()},10)})},t.prototype.updateDialog=function(e){this.refreshDialogDom(e);var t=d.Wrapper.DOMUtils,a=new d.Utility.CommanAgent,r=a.getRangePicker(m.DATA_RANGE);r.value=e.getRange().trim(),s.zcombo("#combinedRanges","setValue",e.combinedRange);var l=e.seriesIn,o=-1==l.indexOf("COLS");o&&(t.getElementById("rowChart").checked=!0),!o&&(t.getElementById("columnChart").checked=!0),t.getElementById("firstRow").checked=e.frl,t.getElementById("firstColumn").checked=e.fcl;var i=a.getRangePicker(m.CHART_TITLE);i.value=e.getTitle();var n=a.getRangePicker(m.CHART_SUBTITLE);n.value=e.getSubTitle(),s.zcombo("#legendPos","setValue",e.getLegendName(e.lPostion)),s.zcombo("#dataLabels","setValue",e.dLables),s.zcombo("#trendlineType","setValue",e.trendlineType),s.zcombo("#trendlineDegree","setValue",e.trendlineDegree);var p=Math.max(2,e.options.series.length);s.zspinner("#trendlinePeriod","setValue",e.trendlineDegree),s.zspinner("#trendlinePeriod","setMaxValue",p),t.getElementById("ChartThreshold").value=e.threshold,t.getElementById("tooltipToggle").checked=e.tooltip,t.getElementById("animationToggle").checked=e.animation,t.getElementById("zoomToggle").checked=e.zoom,t.getElementById("autoExpandToggle").checked=e.autoExpand,t.getElementById("hddCellToggle").checked=e.isIncludeHidden,t.getElementById("multiyaxisYes").checked=e.getYAxisState();var c=t.getElementById("yAxisWrapper");e.getYAxisState()?t.addClass(c,"wrapMultiAxies"):t.removeClass(c,"wrapMultiAxies"),this.resetColorDOMProperty(e.getStyleObject(),!0);var g=e.xAxis[0],u=a.getRangePicker(m.CHART_X_AXIES);u.value=g.title.text,t.getElementById("xAxisLabel").checked=g.labels.enabled,s.zcombo("#slant","setValue",e.slant),s.zcombo("#staggerLines","setValue",1==e.staggerLines?"auto":e.staggerLines);var y=null,h=a.pickIntegerFromString(s.zcombo("#yaxisMulti","getValue"));e.setActiveYIndex(h),y=e.yAxis[e.getActiveYIndex()],this.updateYAxiesRelativeByAxiesObject(y,e.getActiveYIndex()),t.getElementById("majorGridLines").checked=e.majorGridLine,t.getElementById("minorGridLines").checked=e.minorGridLine},t.prototype.updateTitleStyle=function(e){var t=d.Wrapper.DOMUtils;s.zcombo("#chartFont","setValue",e.fontSize);var a=!1,r=!1,l=document.querySelector("#chartTitlebold"),o=document.querySelector("#chartTitleitalic");e&&e.fontStyle&&(r="normal"===e.fontStyle?!1:!0),e&&e.fontWeight&&(a="normal"===e.fontWeight?!1:!0),t.updateActive(l,a),t.updateActive(o,r),e&&s.zcolorselectbox("#chartTitleFontColor","setValue",e.color)},t.prototype.updateLegendItemStyle=function(e){var t=d.Wrapper.DOMUtils,a=e&&e.fontSize?e.fontSize:"12px",r=!1,l=!1,o=document.querySelector("#chartBold"),i=document.querySelector("#chartitalic");e&&e.fontStyle&&(l="normal"===e.fontStyle?!1:!0),e&&e.fontWeight&&(r="normal"===e.fontWeight?!1:!0),s.zcombo("#legendFont","setValue",a),t.updateActive(o,r),t.updateActive(i,l),e&&s.zcolorselectbox("#chartFontColor2","setValue",e.color)},t.prototype.updateChartFontFamily=function(e){s.zcombo("#chartfontfamilys","setValue",e.getFontFamily())},t.prototype.updateTitleRelatedDom=function(e){var t=d.Wrapper.DOMUtils,a=(new d.Utility.CommanAgent,s.zcombo("#chartTitleCombo","getValue")),r=e.getTitleJsonForSP(a),l=e.getTitleStyleJsonForSP(a),o=t.getElementById("titleTextBox");o.value=r,l&&this.updateTitleStyle(l)},t.prototype.updateLegendRelatedDom=function(e){s.zcombo("#legendPos","setValue",e.getLegendName(e.lPostion)),this.updateLegendItemStyle(e.getLegendStyle())},t.prototype.updateDataLabelsDom=function(e){var t=d.Wrapper.DOMUtils;s.zcombo("#dataLabels","setValue",e.dLables);var a=e.getOptions(),r=a.colorOptions,l=r.dataLabels,o=l||{};s.zcombo("#dataLabelsFontSize","setValue",o.fontSize||"12px"),s.zcolorselectbox("#dataLabelsFontColor","setValue",o.color||"#2d2d2d");var i=t.getElementById("dataLabelsBold"),n=t.getElementById("dataLabelsItalic");"bold"==o.fontWeight?t.addClass(i,"active"):t.removeClass(i,"active"),"italic"==o.fontStyle?t.addClass(n,"active"):t.removeClass(n,"active")},t.prototype.updateTrendlineRelatedDom=function(e){var t=d.Wrapper.DOMUtils;t.getElementById("trendLineToggle").checked=e.trendline&&"none"!=e.trendlineType,s.zcombo("#trendlineType","setValue",e.trendlineType),s.zcombo("#trendlineDegree","setValue",e.trendlineDegree);var a=new d.Utility.ChartAgent,r=a.getMaximumDataLength(e);r=Math.max(2,r),s.zspinner("#tlPeriod","setValue",e.trendlineDegree),s.zspinner("#tlPeriod","setAttribute","max",r)},t.prototype.updateTooltipToggle=function(e){C.getElementById("tooltipToggle").checked=e.tooltip},t.prototype.updateAnimationToggle=function(e){C.getElementById("animationToggle").checked=e.animation},t.prototype.updateHiddenCellToggle=function(e){C.getElementById("hddCellToggle").checked=e.isIncludeHidden},t.prototype.updateMultiAxisToggle=function(e){C.getElementById("multiyaxisYes").checked=e.getYAxisState();var t=C.getElementById("yAxisWrapper");e.getYAxisState()?C.addClass(t,"wrapMultiAxies"):C.removeClass(t,"wrapMultiAxies")},t.prototype.updateAutoExpandToggle=function(e){C.getElementById("autoExpandToggle").checked=e.autoExpand},t.prototype.updateXAxisRelatedDom=function(e){var t=e.xAxis[0];C.getElementById("xAxisLabel").checked=t.labels.enabled;var a=null==e.slant?"Auto":e.slant;s.zcombo("#slant","setValue",a),s.zcombo("#staggerLines","setValue","1"==e.staggerLines?"auto":e.staggerLines),C.getElementById("xReverseToggle").checked=t.reversed;var r=t.labels.style||{};s.zcombo("#xAxisLabelFont","setValue",r.fontSize||"12px"),s.zcolorselectbox("#chartAxisFontColor","setValue",r.color||"#2d2d2d");var l=C.getElementById("chartXAxisBold"),o=C.getElementById("chartAxisItalic");"bold"==r.fontWeight?C.addClass(l,"active"):C.removeClass(l,"active"),"italic"==r.fontStyle?C.addClass(o,"active"):C.removeClass(o,"active")},t.prototype.updateYAxisRelatedDom=function(e){var t=new d.Utility.CommanAgent,a=null,r=t.pickIntegerFromString(s.zcombo("#yaxisMulti","getValue"));e.setActiveYIndex(r),a=e.yAxis[e.getActiveYIndex()],a&&this.updateYAxiesRelativeByAxiesObjectSP(a,e.getActiveYIndex())},t.prototype.updateMajorMinor=function(e){C.getElementById("majorGridLines").checked=e.majorGridLine,C.getElementById("minorGridLines").checked=e.minorGridLine},t.prototype.updateBackgroundColorDom=function(e){var t=e.getOptions().chart.backgroundColor||y,a=(new d.Model.ChartModel).getRGBA(t);s.zcolorselectbox("#chartcustomcolorDropDown1","setValue",a);var r=(new d.Model.ChartModel).getTransparency(e.getOptions().chart.backgroundColor);s.zslider("#caTransparency","setValue",r)},t.prototype.updateGlColorDom=function(e){var t=e.getOptions().yAxis[0].gridLineColor||y,a=(new d.Model.ChartModel).getRGBA(t);s.zcolorselectbox("#chartcustomcolorDropDown3","setValue",a)},t.prototype.updateSidePanel=function(e){this.refreshDialogDom(e);var t=e.getType(),a=new d.Utility.CommanAgent,r=UserAction.getTemplate(["COL_ICON","XYLINE_SCATTER_SHAPES_ICON","GROUPEDCOL_ICON","GROUPEDBAR_ICON","STACKEDCOL_ICON","STACKEDCOL_PERCENT_ICON","BAR_ICON","STACKEDBAR_ICON","STACKEDBAR_PERCENT_ICON","XYLINE_ICON","SPLINE_ICON","STEPCHART_ICON","PIE_ICON","SEMIPIE_ICON","SEMIPIE_ICON","DOUGHNUT_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","XYSTACKEDAREA_PERCENT_ICON","SCATTER_ICON","XYLINE_SCATTER_ICON","BUBBLE_ICON","TIMELINE_ICON","TIMEAREA_ICON","CANDLESTICK_ICON","OHLCCHART_ICON","POLAR_ICON","SPIDERWEB_ICON","BULLETCOL_ICON","BULLETBAR_ICON","COMBOCHART_ICON","WATERFALL_ICON","FUNNEL_ICON","PARETO_ICON","HISTOGRAM_ICON","WORDCLOUD_ICON"]),s="BUBBLECHART"===t?"BUBBLE":t;-1!==s.indexOf("3D")&&(s=d.Utility.get3DMapping(t,!1)),-1!==s.indexOf("GROUPED")&&(s=a.getGroupedChartName(t));var p=r[s+"_ICON"],c=C.getElementById("chrtTypeLblValue");c&&n.publish(i.UI,o.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:c}),C.addAttributes(c,{class:"spChrtTypeImg"}),t="BUBBLECHART"===t?"BUBBLE":t,c.innerHTML="",C.appendChild(c,p),C.getElementById("chartTypeSpan").innerText=u[t]||t,C.getElementById(t)&&(C.getElementById(t).checked=!0),n.publish(i.UI,o.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:c});var g=a.getRangePicker(m.DATA_RANGE);if(e.isPivotChart){var y=l.view.getActiveGridID(),v=l.view.getResourceID(y),I=l.view.getVersionID(y),A=l.data.getWorkBook(v,I).PivotCollection.get(e.pivotId),T=A[h.TARGET],E=l.data.getWorkBook(v,I).getSheetObj(T[0]).Prop.Name;E=E?-1!==E.indexOf(" ")?"'"+E+"'":E:"";var b=new ZSClass.Range(T[1],T[2],T[3],T[4]);g.value=E+"."+b.getLabel()}else g.value=null!=e.getRange()&&""!==e.getRange()?e.getRange().trim():"";g.valueChanged(),"HORIZONTAL"===e.combinedRange&&(C.getElementById("horizontally").checked=!0),"VERTICAL"===e.combinedRange&&(C.getElementById("vertically").checked=!0);var B=e.seriesIn,f=-1==B.indexOf("COLS");f&&(C.getElementById("rowChart").checked=!0),!f&&(C.getElementById("columnChart").checked=!0),C.getElementById("firstRow").checked=e.frl,C.getElementById("firstColumn").checked=e.fcl;var S=e.yAxis.length;this.generateTitleOptions(S,t),this.updateTitleRelatedDom(e),this.updateChartFontFamily(e),this.updateDataLabelsDom(e),this.updateLegendRelatedDom(e),this.updateTrendlineRelatedDom(e),this.updateTooltipToggle(e),this.updateAnimationToggle(e),this.updateHiddenCellToggle(e),this.updateMultiAxisToggle(e),this.updateAutoExpandToggle(e),this.resetColorDOMProperty(e.getStyleObject(),!0),this.updateXAxisRelatedDom(e),this.updateYAxisRelatedDom(e),this.updateMajorMinor(e),this.updateBackgroundColorDom(e),this.updateGlColorDom(e);var O=d.Manager.SidePanelManager;!O.TABEL_DEFINATION&&this.rePopulateFilterColumns(e),!O.TABEL_DEFINATION&&this.updateAggFilterProperties(e);var L=C.getElementById("c3DToggle");L.checked=-1!==t.indexOf("3D"),C.getElementById("binningInterval").value="",0!=e.getBinningInterval()&&(C.getElementById("binningInterval").value=e.getBinningInterval()),this.updateGradientStatus(e)},t.prototype.updateAggFilterProperties=function(e){this.populateFilterColumns(e),"NONE"!==e.getFilterType()&&s.zcombo("#filterType","setValue",e.getFilterType()),"NONE"===e.getFilterType()&&s.zcombo("#filterType","setValue","TOP"),e.getFilterLimit()&&s.zspinner("#filterSpinner","setValue",e.getFilterLimit()),(!e.getFilterLimit()||e.getFilterLimit()<=0)&&s.zspinner("#filterSpinner","setValue",5),this.populateAggregationColumns(e)},t.prototype.updateGradientStatus=function(e){var t=d.Wrapper.DOMUtils,a=e.getGradient(),r=(a&&a.enabled&&a.ias,a&&a.enabled&&a.iab);t.getElementById("chartGradientReverse").checked=r||!1},t.prototype.populateFilterColumns=function(e){this.setFilterColumnBasedOnInput(e),e.isFilterEnabled()?this.openFilterTab():this.closeFilterTab()},t.prototype.rePopulateFilterColumns=function(e){var t=d.DecTable.getRangeDecTableMap(e.getRange());d.DecTable.populateFilterColumns(e,t)},t.prototype.setFilterColumnBasedOnInput=function(e){var t="",a=d.DecTable;e.setFilterColumnOnEnabled(),e.getFilterColumn()&&(t=a.constructRangeString(e.getFilterColumn())),!e.isFilterEnabled()&&"NONE"===t&&(t="noFilter"),""!==t&&s.zcombo("#filterColumns","setValue",t)},t.prototype.constructAggregationDom=function(e){var t=d.Wrapper.DOMUtils,a=t.getElementsByClassName("aggHldr"),r=e.getAggregationColHeaders().length;if(e.getAggregationEnabled()&&r>1&&a.length<r)for(var l=1;l<e.getAggregationColHeaders().length;l++)d.Aggregation.constructNewcombo(l)},t.prototype.populateAggregationColumns=function(e){for(var t=e.getAggregationColHeaders(),a=d.Wrapper.DOMUtils,r=d.Manager.SidePanelManager,l=(a.getElementById("chartAggCombo0"),[]),o=0;o<t.length;o++)l.push(e.getAggregationHeader(o));t.length>0&&d.Aggregation.disableLabelCheckBox(e.getSeriesIn(),e.getFirstColAsLabel(),e.getFirstRowAsLabel()),s.select2("#chartAggCombo0",void 0,"setValue",l),r.isCurrentActionOwner()||(e.getAggregationEnabled()&&s.zcombo("#aggreoperation","setValue",e.getAggregationOperation()),!e.getAggregationEnabled()&&s.zcombo("#aggreoperation","setValue","NONE")),r.resetCurrentActionOwner(),e.getAggregationEnabled()&&this.openAggregationTab()},t.prototype.openAggregationTab=function(){var e=d.Wrapper.DOMUtils,t=e.getElementById("chartAggregation");t.classList.add("selected"),t.checked=!0},t.prototype.closeAggregationTab=function(){var e=d.Wrapper.DOMUtils,t=e.getElementById("chartAggregation");t.classList.remove("selected"),t.checked=!1},t.prototype.isAggregationTabOpen=function(){var e=d.Wrapper.DOMUtils,t=e.getElementById("chartAggregation");return t.checked},t.prototype.openFilterTab=function(){var e=d.Wrapper.DOMUtils,t=e.getElementById("chartFilter");t.classList.add("selected"),t.checked=!0},t.prototype.closeFilterTab=function(){var e=d.Wrapper.DOMUtils,t=e.getElementById("chartFilter");t.classList.remove("selected"),t.checked=!1},t.prototype.getDepthHeaderCombos=function(){var e=d.Wrapper.DOMUtils,t=[],a=e.getElementsByClassName("depthHeadersCombo");for(var r in a)"SELECT"===a[r].tagName&&t.push(a[r]);return t},t.prototype.getDateElemsCombos=function(){var e=d.Wrapper.DOMUtils,t=[],a=e.getElementsByClassName("dateCombo");for(var r in a)"SELECT"===a[r].tagName&&t.push(a[r]);return t},t.prototype.updateYAxiesRelativeByAxiesObject=function(e,t){var a=d.Wrapper.DOMUtils,r=(new d.Utility.CommanAgent,e.plotLines);this.generatePlotline(e,t),a.getElementById("yAxisLabel").checked=e.labels.enabled;for(var l=r?r.length||0:0,o=0;l>o;o++)a.getElementById("PlotlineValue"+o).value=r[o].value||"";a.getElementById("min").value=e.min?e.min:"",a.getElementById("max").value=e.max?e.max:"",a.getElementById("interval").value=e.tickInterval?e.tickInterval:""},t.prototype.updateYAxiesRelativeByAxiesObjectSP=function(e,t){var a=d.Wrapper.DOMUtils,l=new d.Utility.CommanAgent,o=e.plotLines,i={display:"table-row"};this.generatePlotline(e,t),a.getElementById("yAxisLabel").checked=e.labels.enabled,a.getElementById("scaleCustomValue").value="";var n=o?o.length||0:0;a.getElementById("plotlineToggle").checked=n>=1,a.hideById("plotlineCustomizationWrapper"),n>=1&&a.addStyle("plotlineCustomizationWrapper",{display:""});for(var p=0;n>p;p++)a.getElementById("PlotlineValue"+p).value=o[p].value||"",a.getElementById("PlotlineName"+p).value=o[p].label.text||"";a.getElementById("LogarthimicToggle").checked="logarithmic"===e.type,s.zspinner("#baseValue","setValue",e.baseValue),a.getElementById("min").value=e.min?e.min:"","logarithmic"===e.type?a.addStyle("baseValueWrapper",i):a.hideById("baseValueWrapper"),a.getElementById("max").value=e.max?e.max:"",a.getElementById("interval").value=e.tickInterval?e.tickInterval:"",a.hideById("scaleCustomWrapper");var c=d.Constants.ConversionType,g=e.conversionType||c.UNITS;g==c.UNITS?s.zcombo("#scaleType","setValue",e.unitFactor):g==c.SCALES&&("custom"===l.getScaleFactorConstant(e.scaleFactor)?(s.zcombo("#scaleType","setValue","custom"),a.addStyle("scaleCustomWrapper",i),e.scaleFactor&&(a.getElementById("scaleCustomValue").value=e.scaleFactor)):s.zcombo("#scaleType","setValue",e.scaleFactor));var m=d.Constants.NumberFormat,u=e.nfCode||m.DEFAULT;u=r.call(this,u),s.zcombo("#numberFormatType","setValue",u),a.hideById("zsCustomNubFormatWrapper"),m.CUSTOM==u&&(a.addStyle("zsCustomNubFormatWrapper",{display:"table-row"}),a.getElementById("prefixNumberFormat").value=e.prefix,a.getElementById("suffixNumberFormat").value=e.suffix);var y=e.labels.style||{};s.zcombo("#chartYAxisFontSize","setValue",y.fontSize||"12px"),s.zcolorselectbox("#chartYAxisFontColor","setValue",y.color||"#2d2d2d");var h=a.getElementById("chartYAxisBold"),C=a.getElementById("chartYAxisItalic");"bold"==y.fontWeight?a.addClass(h,"active"):a.removeClass(h,"active"),"italic"==y.fontStyle?a.addClass(C,"active"):a.removeClass(C,"active")},t.prototype.generateTitleOptions=function(e,t){var a=d.Wrapper.DOMUtils,r=new d.Utility.CommanAgent,l=a.getElementById("chartTitleCombo"),o=r.isFallUnderCompositionType(t)||r.isWordCloud(t),i=a.findByElementType("chartTitleCombo","OPTION").length,n=a.findByElementType("chartTitleCombo","OPTION"),p=i;if(o)for(var c=2;i>c;c++)a.remove(n[c]),p--;else{for(var c=2;i>c;c++)a.remove(n[c]),p--;var g=a.createElement("option",{id:"chartXAxisValue",value:"CHART_X_AXIES"});a.appendChild(l,g),a.getElementById("chartXAxisValue").innerText="Horizontal axis title"}if(!o&&e>=1)for(var m=e,c=0;m>c;c++){var g;if(0==c)g=a.createElement("option",{id:"LA",value:"LA"}),a.appendChild(l,g),a.getElementById("LA").innerText="Vertical axis title";else{var u="RA"+c,g=a.createElement("option",{id:u,value:u,class:"RA"});a.appendChild(l,g),a.getElementById(u).innerText="Right Vertical Axis "+c}}else if(!o&&i>4)for(var c=4,y=1;i>c;c++,y++){var u="RA"+y;a.remove(u)}s.zcombo("#chartTitleCombo","refresh")},t.prototype.showRecommendationDOM=function(){var e=d.Wrapper.DOMUtils;e.showById("chartRecommendTitle"),e.showById("chartRecommend")},t.prototype.hideRecommendationDOM=function(){var e=d.Wrapper.DOMUtils;e.hideById("chartRecommendTitle"),e.hideById("chartRecommend")},t.prototype.hidePropertyBasedOnMeta=function(e,t,a){var r=d.Wrapper.DOMUtils,l=new d.Utility.CommanAgent,o=(new d.Utility.ChartAgent,r.getElementById("LogarthimicToggle").checked),i=s.zcombo("#scaleType","getValue"),n=e.getRange(),p={display:"table-row"},c={display:""};e.isPivotChart?r.hideById("combinedRangesWrapper"):null!=n&&""!==n&&n.split(";").length>1?r.addStyle("combinedRangesWrapper",p):r.hideById("combinedRangesWrapper");var g=e.getType(),m=e.getTrendline(),u=e.getTrendlineTypes();if(r.hideById("tredlineWrapper"),r.hideById("trendlineOrdr"),r.hideById("trendlinePeriod"),r.hideById("baseValueWrapper"),r.hideById("markerWrapper"),r.hideById("chart3DWrapper"),r.hideById("scaleCustomWrapper"),r.hideById("binningIntervalWrapper"),t){var y=r.getElementByClassName("chrtTabList").children;l.isFallUnderCompositionType(g)?(r.hide(y[3]),r.hideById("tredlineWrapper"),r.hideById("chrtThresholdWrapper"),r.hideById("zoomWrapper")):(r.show(y[3]),r.addStyle("tredlineWrapper",p),r.addStyle("chrtThresholdWrapper",p),r.addStyle("zoomWrapper",p)),r.hideById("trendlinePeriodWrapper"),r.hideById("trendlineDegreeWrapper")}else{l.isFallUnderCompositionType(g)?(r.hideById("xAxis"),r.hideById("yAxis"),r.hideById("majorMinorGridLines"),r.hideById("tredlineWrapper"),r.hideById("trendlineOrdr"),r.hideById("trendlinePeriod"),r.hideById("gridlinecolordom"),r.addStyle("aggregationDiv",c),r.addStyle("filterDiv",c),r.addStyle("chartBox",c)):l.isWordCloud(g)?(r.hideById("xAxis"),r.hideById("yAxis"),r.hideById("majorMinorGridLines"),r.hideById("tredlineWrapper"),r.hideById("trendlineOrdr"),r.hideById("trendlinePeriod"),r.hideById("gridlinecolordom"),r.hideById("aggregationDiv"),r.hideById("filterDiv"),r.hideById("chartBox"),r.hideById("seriesAccordion")):l.isHistogram(g)?(r.hideById("tredlineWrapper"),r.hideById("trendlineOrdr"),r.hideById("trendlinePeriod"),r.hideById("aggregationDiv"),r.hideById("filterDiv"),r.addStyle("xAxis",p),r.addStyle("yAxis",p),r.addStyle("chartBox",c),r.addStyle("seriesAccordion",c),r.addStyle("majorMinorGridLines",c),r.addStyle("gridlinecolordom",c),r.addStyle("binningIntervalWrapper",c)):(r.addStyle("xAxis",p),r.addStyle("yAxis",p),r.addStyle("majorMinorGridLines",c),r.addStyle("tredlineWrapper",p),r.addStyle("gridlinecolordom",c),r.addStyle("chartBox",c),r.addStyle("aggregationDiv",c),r.addStyle("filterDiv",c),r.addStyle("seriesAccordion",c)),l.isFallUnder3D(g)&&r.addStyle("chart3DWrapper",c);var h=e.yAxis.length;"undefined"==typeof a||133!=a&&107!=a||this.generateTitleOptions(h,g);var C=e.getComboChartTypes()||[];l.isFallUnderLineType(g)||l.isComboChartContainsLine(g,C)?(r.addStyle("markerWrapper",{display:""}),r.getElementById("markerToggle").checked=e.getMarkerState()):r.hideById("linemarkerDiv"),l.isGroupingAllowedInChart(g)&&e.getSeriesLength()>1?r.addStyle("groupDiv",p):r.hideById("groupDiv")}m&&(-1!==u.indexOf("Average")?r.addStyle("trendlinePeriodWrapper",p):-1!==u.indexOf("Polynomial")?r.addStyle("trendlineDegreeWrapper",p):null,-1!==u.indexOf("average")?r.addStyle("trendlinePeriod",p):-1!==u.indexOf("polynomial")?r.addStyle("trendlineOrdr",p):null,s.zcombo("#trendlineDegree","setValue",e.trendlineDegree),s.zspinner("#trendlinePeriod","setValue",e.trendlineDegree)),o&&r.addStyle("baseValueWrapper",c),"custom"===i&&r.addStyle("scaleCustomWrapper",p),e.getGroupingStatus()?(r.hideById("staggerWrapper"),r.hideById("slantWrapper")):(r.addStyle("slantWrapper",p),r.addStyle("staggerWrapper",p))},!d.Utility&&(d.Utility={}),d.Utility.AgentDom=t}(this);
!function(t){function i(t,i,e,s,o,r,n,h,a,p,c,l,u,d,y,f){this.isStock=f||!1,this.chartId=t,this.chartDetails=i,this.chartObject=e,this.colorOptions=s,this.xAxis=o,this.yAxis=r,this.series=n,this.title=h,this.subtitle=a,this.tooltip=p,this.plotOptions=c,this.legend=l,this.credits=u,this.decimalSeparator=y,this.thousandSeparator=d,this.responsive=null}var e=t.ZSChart,s=(t.document,e.Constants.ChartType,e.Constants.ServiceProvider,t.ZSDevTools.Logger);i.prototype.getChartObject=function(){return this.chartObject},i.prototype.getChartDetails=function(){return this.chartDetails},i.prototype.getXAxis=function(){return this.xAxis},i.prototype.getYAxis=function(){return this.yAxis},i.prototype.getTitle=function(){return this.title},i.prototype.getSubTitle=function(){return this.subtitle},i.prototype.getSeriesObject=function(){return this.series},i.prototype.getDataLabel=function(){return this.plotOptions.series.dataLabels},i.prototype.init=function(t,i,e){this.setLocale(),this.filterProperties(),this.initColorOptions(),this.decodeOptionString(),this.parseOptionString(),this.initChartOptions(),this.initTitleOptions(),this.initSubtitleOptions(),this.initLegendOptions(),this.initPlotOptions(i),this.initSeriesOptions(),this.initXAxisOptions(),this.initYAxisOptions(),this.initTooltipOptions(),this.applyGradient(),!t&&!e&&this.adjustChartItems()},i.prototype.setLocale=function(){var t=new e.Wrapper.ZSChart;t.setLocale(this.decimalSeparator||".",this.thousandSeparator||",")},i.prototype.show=function(t){var i;return!t&&(i=this.renderChart()),i},i.prototype.setDivContainerProperty=function(t,i,s,o,r,n,h,a,p,c,l,u){var d=new e.Utility.AgentDom;d.setDivContainerProperty(t,i,s,o,r,n,h,a,p,c,l,u)},i.prototype.setDivContainerSize=function(t,i){document.getElementById(this.chartId).style.height=t+"px",document.getElementById(this.chartId).style.width=i+"px"},i.prototype.setSeparatorOptions=function(){Highcharts.setOptions({lang:{decimalPoint:this.decimalSeparator,thousandsSep:this.thousandSeparator}})},i.prototype.constructChartOptions=function(t){var i={isStockChart:this.isStock,chart:this.chartObject,colors:this.colorTheme,xAxis:this.xAxis,yAxis:this.yAxis,series:this.series,title:this.title,subtitle:this.subtitle,tooltip:this.tooltip,plotOptions:this.plotOptions,legend:this.legend,credits:this.credits,responsive:t?null:this.responsive};return i},i.prototype.renderChart=function(t){var i=this.constructChartOptions(t),e=this.createNew(i);return e&&e.setPositiveExtreme(!0),this.clearRegressionRender(),e},i.prototype.addZoomBotton=function(t){return t.chart.resetZoomButton={},t.chart.resetZoomButton.theme={},t.chart.resetZoomButton.theme.states={},t.chart.resetZoomButton.theme.states.hover={fill:"#f0f0f0",stroke:"#DDDDDD"},t},i.prototype.createNew=function(t,i){t=this.addZoomBotton(t);try{var o=new e.Wrapper.ZSChart;return i&&o.init(i),o.Chart(t)}catch(t){s.log("[Chart] Adapter throwing exception while constructing dom element",t)}},i.prototype.getId=function(){return this.chartDetails.id},i.prototype.showPreview=function(){return this.renderChart(!0)},e.Model.ChartModel=i}(this);
!function(t){function e(){this.chartOptions={},this.chartMeta={},this.chartInstance=[],this.isDirty=!1,this.isEditable=!1,this.selectionMeta={},this.isClone=!1,this.associatedSheetId=void 0,this.timestamp=-1,this.ttl=900,this.ttlTimer=null,this.isLoaded=!1,this.isClientActionDone=!1,this.actionOwner=!1}var o=(t.sPlusPlus,t.ZSClass,t.ZSChart);e.prototype.updateTimeStamp=function(){this.timestamp=Math.floor(Date.now()),clearTimeout(this.ttlTimer),this.ttl>0&&(this.ttlTimer=setTimeout(function(){this.markForCleaner()}.bind(this),1e3*this.ttl))},e.prototype.setMarkerState=function(t){this.chartOptions.plotOptions.series.marker.enabled=t},e.prototype.isClientUpdated=function(){return this.isClientActionDone},e.prototype.setClientUpdated=function(t){return this.isClientActionDone=t},e.prototype.getID=function(){return this.chartMeta.id},e.prototype.resetSelection=function(){this.selectionMeta={}},e.prototype.addSelectionState=function(t){this.selectionMeta[t]?(this.resetSelection(),this.selectionMeta[t]={isSeries:!1}):(this.resetSelection(),this.selectionMeta[t]={isSeries:!0})},e.prototype.getSelectionState=function(t){return this.selectionMeta[t]&&this.selectionMeta[t].isSeries},e.prototype.getXReverse=function(){return this.chartOptions.xAxis.reversed},e.prototype.getColors=function(){return this.chartOptions.colors||this.chartInstance[0].options.colors},e.prototype.markForCleaner=function(){clearTimeout(this.ttlTimer),this.timestamp=-1},e.prototype.getBinning=function(){return this.chartOptions.binning},e.prototype.setActionOwner=function(t){this.actionOwner=t},e.prototype.isActionOwner=function(){return this.actionOwner},e.prototype.getBackgroundColor=function(){return this.chartOptions.chart.backgroundColor||"#FFFFFF"},e.prototype.getTimestamp=function(){return this.timestamp},e.prototype.getAggregation=function(){return this.chartOptions.aggregation},e.prototype.getFilter=function(){return this.chartOptions.filter},e.prototype.getInstance=function(){return this.chartInstance},e.prototype.setInstanceAtIndex=function(t,e){this.chartInstance[t]=e},e.prototype.setInstance=function(t,e){var o=this.chartInstance.indexOf(t);~o?this.chartInstance[o]=t:this.chartInstance.push(t),e&&this.frameOptionsFromInstance(this.Instance)},e.prototype.flushInstance=function(){this.chartInstance=[]},e.prototype.markDirty=function(t){this.isDirty=t},e.prototype.isDirty=function(){return this.isDirty},e.prototype.isEditable=function(){return this.isEditable},e.prototype.setEditPermission=function(t){this.isEditable=t},e.prototype.setAssociatedSheetId=function(t){this.associatedSheetId=t},e.prototype.getSheetAssociatedId=function(){return this.associatedSheetId},e.prototype.setSelection=function(t){return this.selectionMeta=t},e.prototype.getSelection=function(){return this.selectionMeta},e.prototype.getOptions=function(){return this.chartOptions},e.prototype.frameOptionsFromInstance=function(){var t=this.chartInstance&&this.chartInstance.co&&this.chartInstance.co.options?this.chartInstance.co.options:null;this.setOptions(t)},e.prototype.setOptions=function(t){this.chartOptions=t,this.removeUnwantedProeprties()},e.prototype.removeUnwantedProeprties=function(){this.chartOptions.chart.plotBackgroundColor=null},e.prototype.setDetails=function(t){this.chartMeta=t},e.prototype.getDetails=function(){return this.chartMeta},e.prototype.cloneOf=function(t,e){var o=t instanceof Array?[]:{};for(var i in t)o[i]=e&&t[i]&&"object"==typeof t[i]?this.cloneOf(t[i],e):t[i];return o},e.prototype.merge=function(t,e,o){return Object.keys(e).forEach(function(o){t[o]=e[o]}),Object.keys(o).forEach(function(e){t[e]=o[e]}),t},e.prototype.getRange=function(){return this.chartMeta.dataRange},e.prototype.getSeriesIn=function(){return this.chartMeta.seriesIn},e.prototype.getCombinedWay=function(){return this.chartMeta.cR},e.prototype.getType=function(){return this.chartMeta.type},e.prototype.getCType=function(){return this.chartOptions.chart.type},e.prototype.isSingleYaxis=function(){return this.chartMeta.isSingleYaxis},e.prototype.getSecYAxisSymbol=function(){return this.chartMeta.secYAxisSymbl},e.prototype.getCurrency=function(){return this.chartMeta.currency},e.prototype.getPrecisions=function(){return this.chartMeta.precision},e.prototype.getStyleOptions=function(){return this.chartOptions.colorOptions},e.prototype.isPublishChart=function(){return"undefined"!=typeof this.chartMeta.pcn&&-1!=this.chartMeta.pcn},e.prototype.getTitle=function(){return this.chartOptions.title.text},e.prototype.getPubChartName=function(){return this.chartMeta.pcn},e.prototype.getHeight=function(){return this.chartMeta.ht},e.prototype.getWidth=function(){return this.chartMeta.wd},e.prototype.getComputedChartMeta=function(){var t=this.cloneOf(this.chartMeta,!0);return t.co=this.cloneOf(this.chartOptions,!0),t},e.prototype.toggleVisited=function(){!this.isLoaded&&(this.isLoaded=!0)},e.prototype.setForClone=function(t){this.isClone=!!t},e.prototype.isForClone=function(){return this.isClone},e.prototype.getActiveSheet=function(){return this.getSheetAssociatedId()},e.prototype.getChartID=function(){return this.getID()},e.prototype.getFirstRowAsLabel=function(){return this.chartMeta.frl},e.prototype.getFirstColAsLabel=function(){return this.chartMeta.fcl},e.prototype.getLegendPosition=function(){return this.chartMeta.legendPos},e.prototype.getLPos=function(){return this.getLegendPosition()},e.prototype.setLegendPosition=function(t){this.chartMeta.legendPos=t},e.prototype.getStartRowIndex=function(){function t(){var t=new o.Utility.ChartAgent,e=this.chartMeta.sr;return 0>e&&(this.chartMeta.sr=t.getRowPosbyTop(this.getTop())),this.chartMeta.sr}return this.isCloned()?this.getStartRowForClone():t.call(this)},e.prototype.getStartColIndex=function(){function t(){var t=new o.Utility.ChartAgent,e=this.chartMeta.sc;return 0>e&&(this.chartMeta.sc=t.getColPosbyLeft(this.getLeft())),this.chartMeta.sc}return this.isCloned()?this.getStartColForClone():t.call(this)},e.prototype.getStartRowForClone=function(){var t=new o.Utility.ChartAgent,e=this.getTopPositionForCloning();return t.getRowPosbyTop(e)},e.prototype.getStartColForClone=function(){var t=new o.Utility.ChartAgent,e=this.getLeftPositionForCloning();return t.getColPosbyLeft(e)},e.prototype.getStartRowDiff=function(){return this.chartMeta.srd<0?0:this.chartMeta.srd},e.prototype.getStartColDiff=function(){return this.chartMeta.scd<0?0:this.chartMeta.scd},e.prototype.getLeftPositionForCloning=function(){var e=50,o=this.chartMeta.left,i=this.chartMeta.wd;return parseInt(o)+e+i>t.innerWidth&&(e=-50),parseInt(o)+e},e.prototype.getTopPositionForCloning=function(){var e=50,o=this.chartMeta.top,i=this.chartMeta.ht;return parseInt(o)+e+i>t.innerHeight&&(e=-50),parseInt(o)+e},e.prototype.getLeft=function(){return this.isCloned()?this.getLeftPositionForCloning():this.chartMeta.left},e.prototype.getTop=function(){return this.isCloned()?this.getTopPositionForCloning():this.chartMeta.top},e.prototype.getWidth=function(){return this.chartMeta.wd},e.prototype.getHeight=function(){return this.chartMeta.ht},e.prototype.getSubTitle=function(){return this.chartOptions.subtitle.text},e.prototype.getXTitle=function(){return this.chartOptions.xAxis.title.text},e.prototype.getToolTip=function(){return this.chartOptions.tooltip.enabled},e.prototype.getZoomType=function(){return this.chartOptions.chart.zoomType?this.chartOptions.chart.zoomType:""},e.prototype.getAnimation=function(){return this.chartOptions.plotOptions.series.animation?this.chartOptions.plotOptions.series.animation:!0},e.prototype.getTrendline=function(){return this.chartMeta.tl},e.prototype.getFloating=function(){return!1},e.prototype.getMajorGridWidth=function(t){return this.chartOptions.yAxis[t||0].gridLineWidth?this.chartOptions.yAxis[t||0].gridLineWidth:null},e.prototype.getMinorTickInterval=function(t){return this.chartOptions.yAxis[t||0].minorTickInterval?this.chartOptions.yAxis[t||0].minorTickInterval:""},e.prototype.getXLabel=function(){return this.chartOptions.xAxis.labels.enabled},e.prototype.getYLabel=function(t){return this.chartOptions.yAxis[t||0].labels.enabled},e.prototype.getHiddenCellState=function(){return this.chartMeta.ihc},e.prototype.getYAxisState=function(){return this.isSingleYaxis()},e.prototype.getXSlant=function(){return this.chartOptions.xAxis.labels.rotation?this.chartOptions.xAxis.labels.rotation:null},e.prototype.getLabelFormat=function(){return this.chartMeta.lf},e.prototype.getMarkerState=function(){return this.chartOptions.plotOptions.series.marker.enabled},e.prototype.getTrendlineTypes=function(){return this.chartMeta.tlType},e.prototype.getThreshold=function(){return this.chartOptions.plotOptions.series.threshold},e.prototype.getDegreeOrElse=function(){return this.chartMeta.order},e.prototype.getAutoExpandState=function(){return this.chartMeta.autoExpand},e.prototype.getCustomStyle=function(){var t=new o.Utility.ChartAgent,e=t.constructStyleProperty(this.chartOptions);return e},e.prototype.getPivotState=function(){return this.chartMeta.isPivotChart},e.prototype.isCloned=function(){return this.isClone},e.prototype.getComboTypes=function(){return this.chartOptions.comboChartTypes?Object.values(this.chartOptions.comboChartTypes):[]},e.prototype.getNoOfAxies=function(){return 1},e.prototype.getYAxis=function(){var t=o.Utility.removeCursorPointer(this.chartOptions.yAxis);return t},e.prototype.getXAxis=function(){return this.chartOptions.xAxis},e.prototype.getLegend=function(){return this.chartOptions.legend},e.prototype.getLineStyles=function(){return this.chartMeta.lineStyles?this.chartMeta.lineStyles:[]},e.prototype.getPivotId=function(){return this.chartMeta.pivotId},e.prototype.getStaggerState=function(){return this.chartOptions.xAxis.labels.staggerLines?this.chartOptions.xAxis.labels.staggerLines:null},e.prototype.getDecimalSeprator=function(){return this.chartMeta.ds},e.prototype.getThousandSeprator=function(){return this.chartMeta.ts},e.prototype.setLocale=function(t,e){this.chartMeta.ds=t,this.chartMeta.ts=e},e.prototype.setPosition=function(t,e){var i=new o.Utility.ChartAgent;this.chartMeta.left=t,this.chartMeta.top=e,this.chartMeta.sr=i.getRowPosbyTop(e),this.chartMeta.sc=i.getColPosbyLeft(t),this.chartMeta.srd=Math.abs(e-i.getTopByRowPos(this.chartMeta.sr)),this.chartMeta.scd=Math.abs(t-i.getleftByColPos(this.chartMeta.sc))},e.prototype.getComputedLeft=function(t){var e=new o.Utility.ChartAgent;return parseInt(e.getleftByColPos(t))+parseInt(this.chartMeta.scd)},e.prototype.getComputedTop=function(t){var e=new o.Utility.ChartAgent;return parseInt(e.getTopByRowPos(t))+parseInt(this.chartMeta.srd)},e.prototype.setDimension=function(t,e){this.chartMeta.wd=t,this.chartMeta.ht=e},e.prototype.getUpdateLegendStyle=function(t){var e={};return this.merge(e,this.getOptions().legend.itemStyle,t),e},e.prototype.getLegendPositionByName=function(e){var o=new t.ZSChart.Utility.CommanAgent;return o.getLegendPosition(e)},e.prototype.getCustomChartColor=function(){var t=this.getOptions(),e=t.colorOptions,o=e.colorTheme;return"SHEET-OFFICE-CUSTOM-THEME"==o.name?o.basecolor:"rgb(128,128,128)"},e.prototype.getSVG=function(){var t=this.getInstance()[0],e=this.getOptions();return t.getSVG(e)},e.prototype.updateScaleFactor=function(t,e,o,i){var n=this.getYAxis();n[o].scaleFactor=t,n[o].unitFactor=e,n[o].conversionType=i},e.prototype.setNumberFormat=function(t,e,o,i){var n=this.getYAxis();n[i].nfCode=t,n[i].prefix=e,n[i].suffix=o},e.prototype.isInsertFromZiaPanel=function(){return this.chartMeta.isFromZia},e.prototype.isGrouping=function(){return this.chartMeta.grouping},e.prototype.updateXLabelStyle=function(t){var e=this.getXAxis();return e.labels.style||(e.labels.style={}),e.labels.style[t.key]=t.value,e.labels.style},e.prototype.updateYLabelStyle=function(t,e){var o=this.getYAxis()[e];return o.labels.style||(o.labels.style={}),o.labels.style[t.key]=t.value,o.labels.style},e.prototype.updateTrendtype=function(t){this.chartMeta.tlType=t.value;var e=t.prevVal;return this.chartMeta.tl="None"!==this.chartMeta.tlType,this.chartMeta.order=2,"None"==e&&this.chartMeta.tl},e.prototype.updateTrendDegree=function(t){this.chartMeta.order=t.value},e.prototype.updateFontFamily=function(t){this.chartOptions.chart.style=t},e.prototype.updateTitleStyle=function(t,e,o){"CHART_TITLE"==t?this.chartOptions.title.style=e:"CHART_SUB_TITLE"==t?this.chartOptions.subtitle.style=e:"XAXIS_TITLE"==t?this.chartOptions.xAxis.title.style=e:"YAXIS_TITLE"==t&&(this.chartOptions.yAxis[o].title.style=e)},e.prototype.updateChartColor=function(t){this.chartOptions.chart.backgroundColor=t,this.chartOptions.chart.plotBackgroundColor=null},e.prototype.updateGCColor=function(t){for(var e=0;e<this.chartOptions.yAxis.length;e++){this.chartOptions.yAxis[e].gridLineColor=t;var i=(new o.Model.ChartModel).getRGBA(t,"0.5");this.chartOptions.yAxis[e].minorGridLineColor=i}},e.prototype.updateXLabel=function(t){this.chartOptions.xAxis.labels.enabled=t},e.prototype.updateXSlant=function(t){this.chartOptions.xAxis.labels.rotation="Auto"===t.value?null:parseInt(t.value)},e.prototype.updateXStagger=function(t){this.chartOptions.xAxis.labels.staggerLines="auto"==t.value?1:parseInt(t.value)},e.prototype.updateYLabel=function(t,e){this.chartOptions.yAxis[e||0].labels.enabled=t},e.prototype.updateYMin=function(t,e){this.chartOptions.yAxis[e||0].min=""==t?null:parseInt(t)},e.prototype.updateYMax=function(t,e){this.chartOptions.yAxis[e||0].max=""==t?null:parseInt(t)},e.prototype.updateYInterval=function(t,e){this.chartOptions.yAxis[e||0].tickInterval=""==t?null:parseInt(t)},e.prototype.updateYMajor=function(t){for(var e=0;e<this.chartOptions.yAxis.length;e++)this.chartOptions.yAxis[e].gridLineWidth=t?1:0},e.prototype.updateYMinor=function(t){for(var e=0;e<this.chartOptions.yAxis.length;e++)this.chartOptions.yAxis[e].minorTickInterval=t?"auto":null},e.prototype.updateYReverse=function(t,e){this.chartOptions.yAxis[e||0].reversed=t},e.prototype.updateYOpposite=function(t,e){this.chartOptions.yAxis[e||0].opposite=t},e.prototype.updateXReverse=function(t){this.chartOptions.xAxis.reversed=t},e.prototype.updateYLogarithmic=function(t,e){this.chartOptions.yAxis[e||0].type=t?"logarithmic":"linear",t?(this.chartOptions.yAxis[e||0].min=1,this.chartOptions.yAxis[e||0].tickInterval=1):(this.chartOptions.yAxis[e||0].min=this.chartOptions.yAxis[e||0].prevMin,this.chartOptions.yAxis[e||0].tickInterval=this.chartOptions.yAxis[e||0].prevInterval)},e.prototype.updateYBaseValue=function(t,e){this.chartOptions.yAxis[e||0].baseValue=t},e.prototype.addNewPlotline=function(t){var e=new o.Utility.ChartAgent;this.chartOptions=e.addNewPlotline(this.chartOptions,t)},e.prototype.removePlotlineByIndex=function(t){var e=new o.Utility.ChartAgent;this.chartOptions=e.removePlotlineByIndex(this.chartOptions,t)},e.prototype.updatePlotLineName=function(t){var e=new o.Utility.ChartAgent;this.chartOptions=e.updatePlotLineName(this.chartOptions,t)},e.prototype.updateLegendStyle=function(t){this.chartOptions.legend.itemStyle=t},e.prototype.updateColorScheme=function(t){this.chartOptions.colorOptions.colorTheme.basecolor=t.basecolor,this.chartOptions.colorOptions.colorTheme.name=t.name,this.chartOptions.colorOptions.colorTheme.isReversed=t.isReversed},e.prototype.setGradient=function(t){this.chartMeta.gradient=t},e.prototype.getGradient=function(){return this.chartMeta.gradient},e.prototype.getDataLabelStyle=function(){return this.chartOptions.colorOptions.dataLabels},e.prototype.setDataLabelStyle=function(t){this.chartOptions.colorOptions.dataLabels=t},e.prototype.removeAllPlotLine=function(t){var e=this.getYAxis();delete e[t].plotLines},e.prototype.getConversionCode=function(){var t=o.Constants.ConversionType,e=this.getYAxis()[0],i=e.conversionType||t.UNITS;return i},!o.Model&&(o.Model={}),o.Model.ChartGridMeta=e}(this);
!function(t,i){function e(t){return"string"!=typeof t?t:{radialGradient:{cx:.5,cy:.5,r:.25},stops:[[0,c(t).brighten(x*l.GRADIENT_PERCENT).get("rgba")],[1,t]]}}function s(t){return"string"!=typeof t?t:{linearGradient:{x1:0,y1:.95,x2:0,y2:.4},stops:[[0,c(t).brighten(x*l.GRADIENT_PERCENT).get("rgba")],[1,t]]}}function h(t){if("object"==typeof t){var i=t.stops[0][1],e=t.stops[1][1];return c(i).brighten(x*l.GRADIENT_PERCENT).get("rgba")==e?i:e}return t}function o(t,i,h){return-1!==i.indexOf("radial")?e(t,h):s(t,h)}var n=ZSChart.Model.ChartModel.prototype,r=ZSChart.Constants.ChartType,a=t.ZSEC,l=ZSChart.Constants,c=i.Color,x=1;n.decodeOptionString=function(){this.title.text&&(this.title.text=a?a.Encoder.encodeForHTML(unescape(this.title.text)):unescape(this.title.text)),this.subtitle.text&&(this.subtitle.text=a?a.Encoder.encodeForHTML(unescape(this.subtitle.text)):unescape(this.subtitle.text)),this.xAxis.title&&this.xAxis.title.text?this.xAxis.title.text=a?a.Encoder.encodeForHTML(unescape(this.xAxis.title.text)):unescape(this.xAxis.title.text):this.xAxis[0]&&this.xAxis[0].title&&this.xAxis[0].title.text&&(this.xAxis[0].title.text=a?a.Encoder.encodeForHTML(unescape(this.xAxis[0].title.text)):unescape(this.xAxis[0].title.text));for(var t=0;t<this.yAxis.length;t++)this.yAxis[t].title&&this.yAxis[t].title.text&&(this.yAxis[t].title.text=a?a.Encoder.encodeForHTML(unescape(this.yAxis[t].title.text)):unescape(this.yAxis[t].title.text))},n.parseOptionString=function(){if(this.yAxis&&this.yAxis.length>=1)for(var t=0;t<this.yAxis.length;t++)this.yAxis[t].min&&(this.yAxis[t].min=parseFloat(this.yAxis[t].min)),this.yAxis[t].max&&(this.yAxis[t].max=parseFloat(this.yAxis[t].max)),this.yAxis[t].tickInterval&&(this.yAxis[t].tickInterval=parseFloat(this.yAxis[t].tickInterval))},n.initChartOptions=function(){this.setChartSize(this.chartDetails.ht,this.chartDetails.wd),this.setChartSpacing(),this.setChartBackgroundColor(),this.setPlotBackgroundColor()},n.setPlotBackgroundColor=function(){this.chartObject.plotBackgroundColor=null},n.restoreDefaultSpacing=function(){this.chartObject.spacingTop=10,this.chartObject.spacingLeft=10,this.chartObject.spacingBottom=15,this.chartObject.spacingRight=10},n.initTitleOptions=function(){this.removeTitleOffset(),this.setOverflow(this.title.style);try{this.title.text=decodeURIComponent(this.title.text)}catch(t){}},n.initSubtitleOptions=function(){this.setOverflow(this.subtitle.style),this.subtitle.text=decodeURIComponent(this.subtitle.text)},n.initLegendOptions=function(){this.setLegendPosition(),this.setLegendStyle(),this.applySharedLegendForPie(),this.applySharedLegendForCombination()},n.initPlotOptions=function(t){this.setDataLabel(),this.applyDataLabelStyle(),this.plotOptions.series.animation&&t&&(this.plotOptions[this.chartObject.type].animation=!1),this.plotOptions.series.animation&&t&&(this.plotOptions.series.animation=!1)},n.initSeriesOptions=function(){this.setDefaultColorIndex(),this.setPointColorIndex(),this.setGroupedChartProperty(),this.setBulletChartProperty(),this.updateWaterfallColor()},n.initColorOptions=function(){this.setColorScheme(),this.applyRegressionColorIndex(),this.setColorOptions()},n.applyGradient=function(){try{var t=this.chartDetails.gradient,i=t&&t.enabled&&t.ias,e=t&&t.enabled&&(t.canvas||t.iab);if(e&&(this.chartObject.backgroundColor=o(this.chartObject.backgroundColor||"#FFFFFF","radial",t.isReversed||t.cgReversed)),this.chartDetails.type==r.WORDCLOUD)return;for(var s=this.series,n=s?s.length:0,a=0;n>a;a++){var l=s[a].data,c=l?l.length:0,x=s[a].color||this.colorTheme[a%this.colorTheme.length],p=-1!==this.chartDetails.type.toUpperCase().indexOf(r.DOUGHNUT.toUpperCase())||this.chartDetails.type==r.PIE.toUpperCase()?"radial":t.gType||t.sgType;i&&(s[a].color=o(x,p,t.isReversed||t.sgReversed));for(var d=0;c>d;d++){var u=l[d];u.color&&i&&(u.color=o(u.color,t.gType||t.sgType,t.isReversed||t.sgReversed)),u.borderWidth=1,u.borderColor=this.getRGBA(this.chartDetails.type==r.HISTOGRAM||-1!==this.chartDetails.type.toUpperCase().indexOf(r.DOUGHNUT.toUpperCase())||-1!==this.chartDetails.type.toUpperCase().indexOf(r.SEMIPIE.toUpperCase())?"#FFFFFF":h(u.color||x))}}}catch(t){}},n.disableLabelsForWordCloud=function(){this.chartDetails.type===r.WORDCLOUD&&(this.xAxis[0]?(this.xAxis[0].tickWidth=0,this.xAxis[0].lineWidth=0,this.xAxis[0].labels.enabled=!1):this.xAxis&&(this.xAxis.tickWidth=0,this.xAxis.lineWidth=0,this.xAxis.labels.enabled=!1))},n.unEscapeTitleForXAxis=function(){this.xAxis[0]?this.xAxis[0].title.text=decodeURIComponent(this.xAxis[0].title.text):this.xAxis&&(this.xAxis.title.text=decodeURIComponent(this.xAxis.title.text))},n.unEscapeTitleForYAxis=function(){for(var t=this.yAxis.length,i=0;t>i;i++)this.yAxis[i].title.text=decodeURIComponent(this.yAxis[i].title.text)},n.initXAxisOptions=function(){this.formatXAxisLabel(),this.setGroupingOptions(),this.setAdvanceXAxisProperty(),this.disableLabelsForWordCloud(),this.unEscapeTitleForXAxis()},n.initYAxisOptions=function(){this.formatYAxisLabel(),this.unEscapeTitleForYAxis();var t=new ZSChart.Utility.ChartAgent;this.yAxis=t.applySeriesColorToYAxisOnLoad(this.yAxis,this.colorOptions,this.chartDetails.isSingleYaxis),this.yAxis=t.applySeriesColorToPlotLinesOnLoad(this.yAxis,this.colorOptions)},n.initTooltipOptions=function(){var t=this.chartDetails.type;t!=r.WORDCLOUD&&(this.formatTooltip(),this.tooltip.followTouchMove=!1,this.tooltip.useHTML=!1,this.tooltip.followPointer=!1)},n.adjustChartItems=function(){var t=this.getTextWidth;this.responsive={rules:[{condition:{callback:function(){var t=this.chartHeight,i=this.chartWidth;return 300>t||300>i?!0:!1},chartOptions:{plotOptions:{series:{dataLabels:{enabled:!1}}}}},condition:{callback:function(){var i=(this.chartHeight,this.chartWidth);if(!this.title)return 200>i?!0:!1;var e=this.title.textStr,s=this.title.styles,h=this.options.chart.style?this.options.chart.style.fontFamily:null,o=t(e,h,s.fontSize,s.fontWeight,s.fontStyle);return i<Math.round(o.width)/2||200>i?!0:!1}},chartOptions:{title:{text:""}}},{condition:{callback:function(){var i=(this.chartHeight,this.chartWidth);if(!this.subtitle)return 200>i?!0:!1;var e=this.subtitle.textStr,s=this.subtitle.styles,h=this.options.chart.style?this.options.chart.style.fontFamily:null,o=t(e,h,s.fontSize,s.fontWeight,s.fontStyle);return i<Math.round(o.width)/2||200>i?!0:!1}},chartOptions:{subtitle:{text:""}}},{condition:{callback:function(){var t=this.chartHeight,i=this.chartWidth;if(!this.legend)return 250>t||250>i?!0:!1;var e=this.options.chart.type,s=0;try{s=-1===e.indexOf(r.PIE)?this.series.length:this.series[0].data.length}catch(t){}if("vertical"===this.legend.options.layout){if(250>i)return!0}else if("horizontal"===this.legend.options.layout&&250>t)return!0;return!1}},chartOptions:{legend:{enabled:!1}}},{condition:{callback:function(){var t=this.chartWidth,i=(this.chartHeight,this.options.chart.type);return-1===i.indexOf(r.PIE)&&-1===i.indexOf(r.FUNNEL)&&350>t?!0:!1}},chartOptions:{yAxis:[{tickWidth:0,labels:{enabled:!1}}]}},{condition:{callback:function(){var t=this.chartWidth,i=this.chartHeight,e=this.options.chart.type;return-1===e.indexOf(r.BAR)&&-1===e.indexOf(r.PIE)&&-1===e.indexOf(r.FUNNEL)&&250>i?!0:-1!==e.indexOf(r.BAR)&&200>t?!0:!1}},chartOptions:{xAxis:{tickWidth:0,labels:{enabled:!1}}}},{condition:{callback:function(){var i=this.yAxis[0].axisTitle;if(!i)return!1;var e=this.chartWidth,s=this.chartHeight,h=i.textStr,o=i.styles,n=this.options.chart.style?this.options.chart.style.fontFamily:null,r=t(h,n,o.fontSize,o.fontWeight,o.fontStyle);return h&&h.length>0&&(150>e||s<Math.round(r.width))?!0:!1}},chartOptions:{yAxis:[{title:{text:""}}]}}]};var i=this.chartDetails.ht,e=this.chartDetails.wd,s=this.chartObject.type;250>i&&250>e&&s.indexOf(r.FUNNEL)&&(this.chartObject.marginRight=10),150>i&&(this.xAxis[0]?this.xAxis[0].tickLength=0:this.xAxis&&(this.xAxis.tickLength=0));var h=this.xAxis[0]?this.xAxis[0].title.text:this.xAxis.title.text;if(h&&h.length>0){var o=this.xAxis[0]?this.xAxis[0].title.style:this.xAxis.title.style,n=this.chartObject.style?this.chartObject.style.fontFamily:null,a=this.getTextWidth(h,n,o.fontSize,o.fontWeight,o.fontStyle);e<Math.round(a.width)&&(this.xAxis[0]?(this.xAxis[0].title.text="",this.xAxis[0].tickLength=0):this.xAxis&&(this.xAxis.title.text="",this.xAxis.tickLength=0))}},n.disableZoom=function(){this.chartObject.zoomType="",this.chartObject.resetZoomButton={theme:{display:"none"}}},n.setChartSize=function(t,i){this.chartObject.reflow=!0,this.chartObject.height=t,this.chartObject.width=i,this.chartObject.zoomType=""},n.setChartSpacing=function(){-1!==this.chartObject.type.indexOf(r.PIE)||-1!==this.chartObject.type.indexOf(r.FUNNEL)?(this.chartObject.spacingLeft=this.chartObject.spacingTop=this.chartObject.spacingRight=10,this.chartObject.spacingBottom=15):(this.chartObject.spacingLeft=this.chartObject.spacingTop=this.chartObject.spacingRight=30,this.chartObject.spacingBottom=20)},n.setChartBackgroundColor=function(){var t=this.chartObject.type;-1!==t.indexOf(r.PIE)||-1!==t.indexOf(r.FUNNEL)||this.chartObject.polar?this.chartObject.plotBackgroundColor&&(this.chartObject.plotBackgroundColor=null):this.chartObject.plotBackgroundColor||(this.chartObject.plotBackgroundColor=this.chartObject.backgroundColor)},n.setLegendSymbol=function(){var t=this.legend;t.symbolHeight&&t.symbolWidth&&!t.symbolRadius&&(t.symbolRadius=0)},n.getMaximumSeriesLength=function(){for(var t,i=0,e=0;e<this.series.length;e++)this.series[e].data&&this.series[e].data.length>i&&(t=e,i=this.series[e].data.length);return[t,i]},ZSChart.Utility.getColorCodeFromGradient=h}(this,Highcharts);
!function(t){{var e=t.ZSChart,s=e.Model.ChartModel.prototype;e.Constants.ChartType,e.Constants.MessageConstant}s.removeTitleOffset=function(){delete this.xAxis.title.offset},s.setOverflow=function(t){t.overflow="hidden",t.textOverflow="ellipsis"}}(this);
!function(e){function t(e){return e.itemStyle?e.itemStyle.fontWeight||(e.itemStyle.fontWeight="normal"):e.itemStyle={fontWeight:"normal"},e}{var i=e.ZSChart,s=(e.sPlusPlus,i.Model.ChartModel.prototype),r=i.Constants.ChartType;i.Constants.MessageConstant}s.setLegendPosition=function(){this.legend.enabled=0===this.chartDetails.legendPos?!1:!0,"horizontal"===this.legend.layout?this.legend.alignHorizontalToPlotArea=!0:"vertical"===this.legend.layout&&(this.legend.alignVerticalToPlotArea=!0)},s.setLegendStyle=function(){var e=this.legend.itemStyle?this.legend.itemStyle.color:null;e&&(this.legend.itemHoverStyle={color:this.getRGBA(e,"0.7")},this.legend.itemHiddenStyle={color:this.getRGBA(e,"0.5")}),this.legend=t(this.legend)},s.applySharedLegendForPie=function(){this.plotOptions.series.minPointLength=2;var e=this.getMaximumSeriesLength(),t=e[0],s=e[1];if(this.rearrageColorForPie(s),1===this.series.length&&-1!==this.chartObject.type.indexOf(r.PIE)&&(this.plotOptions.pie.borderWidth=0),this.series.length>1&&-1!==this.chartObject.type.indexOf(r.PIE)){for(var n=0;n<this.series.length;n++)switch(t!==n&&(this.series[n].showInLegend=!1),n){case 1:2===this.series.length&&(this.series[n].size="70%",this.series[n].states={hover:{halo:{size:0}}});break;case 2:this.series[n].innerSize="55%",this.series[n].states={hover:{halo:{size:0}}};break;case 3:this.series[n].size="40%",this.series[n].states={hover:{halo:{size:0}}}}var o=this.applyPointVisibility;this.plotOptions.series.point={events:{legendItemClick:function(){var e=this.id,t=this.series.chart.renderTo.id;if(i.Mobile.isMobileView&&i.Mobile.isMobileView())var s=i.Mobile.getInstance();else var r=new i.Utility.ChartAgent,n=r.getChartMeta(t),s=n.getInstance();for(var h in s)for(var a=s[h],l=a.series,h=0;h<l.length;h++)for(var g=0;g<l[h].data.length;g++)o(l[h].data[g],e);for(var h in s){var a=s[h];a.redraw()}return!1}}}}},s.applySharedLegendForCombination=function(){if(-1!==this.chartObject.type.indexOf(r.LINE))for(var e=0;e<this.series.length;e++)this.series[e].showInLegend=this.plotOptions[this.chartObject.type].showInLegend},s.rearrageColorForPie=function(e){for(var t,i=0;i<this.series.length;i++)if(this.series[i].data&&(t=this.series[i].data.length,e>t))for(var s=0;s<this.series[i].data.length;s++)this.series[i].data[s].color=this.colorTheme[(this.series[i].data[s].id-1)%this.colorTheme.length]},s.applyPointVisibility=function(e,t){e.id===t&&(e.visible?e.setVisible(!1,!1):e.setVisible(!0,!1))}}(this);
!function(){var t=ZSChart.Model.ChartModel.prototype,s=ZSChart.Constants.ChartType;t.formatXAxisLabel=function(){var t=this.chartDetails.xAxisSymbol,i=this.chartObject.type;i!==s.SCATTER&&i!==s.BUBBLE||!t||(this.xAxis.labels.xAxisSymbol=t,this.xAxis.labels.formatter=function(){var s=this.value,i=t||"";return 0>s?i+"- "+Math.abs(s):i+this.value})},t.setAdvanceXAxisProperty=function(){this.xAxis.startOnTick=!0,this.xAxis.endOnTick=!0},t.setGroupingOptions=function(){this.xAxis.labels.groupedOptions=[];for(var t=0;t<=this.getGroupingDepth();t++)this.xAxis.labels.groupedOptions.push({rotation:0});var i=this.series&&this.series[0]&&this.series[0].hasOwnProperty("regressionSettings")?1:0,e=this.chartDetails.grouping;(e||this.xAxis&&this.xAxis.categories&&this.xAxis.categories[i]&&"object"==typeof this.xAxis.categories[i])&&this.getGroupingDepth()>=1&&(this.xAxis.tickmarkPlacement="between",this.xAxis.labels.step=1,this.xAxis.labels.rotation=-1!==this.chartObject.type.indexOf(s.BAR)?null:-90,delete this.xAxis.labels.staggerLines,this.chartObject.options3d&&this.chartObject.options3d.enabled&&-1===this.chartObject.type.indexOf(s.PIE)&&(this.chartObject.options3d.beta=0,this.chartObject.options3d.alpha=0))},t.getGroupingDepth=function(){var t,s=0,i=this.series&&this.series[0]&&this.series[0].hasOwnProperty("regressionSettings")?1:0,e=this.chartDetails.grouping;if(e||this.xAxis&&this.xAxis.categories&&this.xAxis.categories[i]&&"object"==typeof this.xAxis.categories[i])for(t=this.xAxis.categories[i],s=0;"object"==typeof t;s++)t=t.categories[0];else if(e||this.xAxis[0]&&this.xAxis[0].categories&&this.xAxis[0].categories[i]&&"object"==typeof this.xAxis[0].categories[i])for(t=this.xAxis[0].categories[i],s=0;"object"==typeof t;s++)t=t.categories[0];return s},t.formatYAxisLabel=function(){var t=this.chartDetails.currency,s=this.chartDetails.type,i=new ZSChart.Utility.ChartAgent;i.getFormatLabels(this.yAxis,t,s,void 0,this.getConversionCode(),this.chartDetails.isSingleYaxis)},t.getConversionCode=function(){var t=ZSChart.Constants.ConversionType,s=this.yAxis[0],i=s.conversionType||t.UNITS;return i}}(this);
!function(t){function i(){return s.Mobile.isMobileView&&s.Mobile.isMobileView()?!1:s.Utility.isContextMenuAlive()?!0:!1}var e,s=t.ZSChart,r=s.Model.ChartModel.prototype,h=s.Constants.ChartType;r.formatTooltip=function(){var t=this.chartDetails.currency,r=(this.chartDetails.precision,this.chartDetails.type);if(r!==h.WORDCLOUD){var a=new s.Utility.ChartAgent;this.tooltip.enabled&&this.series&&this.series.length>=1&&(!this.chartObject.customChartType||-1===this.chartObject.customChartType.indexOf(h.BULLET)&&-1===this.chartObject.customChartType.indexOf(h.GROUPED)?-1===this.chartObject.type.indexOf(h.SCATTER)&&-1===this.chartObject.type.toUpperCase().indexOf(h.PARETO)&&-1===this.chartObject.type.indexOf(h.COLUMN)&&-1===this.chartObject.type.indexOf(h.BAR)&&-1===this.chartObject.type.indexOf(h.LINE)&&-1===this.chartObject.type.indexOf(h.AREA)&&-1===this.chartObject.type.indexOf(h.SPLINE)||!(this.xAxis.type&&-1===this.xAxis.type.indexOf("time")||"undefined"==typeof this.xAxis.type||null==this.xAxis.type)?(this.chartObject&&-1!==this.chartObject.type.indexOf(h.PIE)||-1!==this.chartObject.type.indexOf(h.FUNNEL))&&(this.tooltip={backgroundColor:"#FFFFFF",shape:"square",enabled:!0,formatter:function(){if(i())return!1;var e,s=a.pickCurrency(t,this.series.index,r),h=this.point.decimals,o="";o+=this.point.name,o+="<br />",o+='<span style="color:'+this.point.color+'">●</span>'+this.series.name,e=parseFloat(this.y),e=Highcharts.numberFormat(Math.abs(e),h),o+=": ",this.y<0&&(o+="-");var n="";n=s||"";var c=n&&"%"!==n?n:"",p=n&&"%"===n?n:"";return o+="<b>"+c+"</b>"+e+"<b>"+p+"</b><br />"}}):(this.tooltip.currency=this.chartDetails.currency,this.tooltip.hasRegression=this.series&&this.series[0].hasOwnProperty("regressionSettings"),this.tooltip.chartType=this.chartObject.type,this.tooltip.borderColor=null,this.tooltip.formatter=function(){if(i())return!1;var s,o="",n=a.pickCurrency(t,this.series.index,r),c=this.point.decimals,p=this.series.tooltipOptions.chartType,l=this.color||this.series.color;return this.series.tooltipOptions.hasRegression?(o+=this.series.name,s=parseFloat(this.y),s=Highcharts.numberFormat(Math.abs(s),c),-1!==p.indexOf(h.SCATTER)?(o+="<br> x : ",this.x<0&&(o+="-"),Highcharts.numberFormat(Math.abs(parseFloat(this.x))),o+=c,o+="<br> y : "):o+=":",this.y<0&&(o+="-"),n&&"%"!==n&&(o+=n),o+=s+"<br>"):(o+='<span style="color:'+l+'">●</span> '+this.series.name,e=this.series.tooltipOptions.valueSuffix||"",s=parseFloat(this.y),s=Highcharts.numberFormat(Math.abs(s),c),-1!==p.indexOf(h.SCATTER)?(o+="<br> x : ",this.x<0&&(o+="-"),Highcharts.numberFormat(Math.abs(parseFloat(this.x))),o+=c,o+="<br> y : "):o+=":",this.y<0&&(o+="-"),n&&"%"!==n&&(o+=n),o+=s,o+=e+"<br>"),o}):(this.tooltip.shared=!0,this.tooltip.borderColor=null,this.tooltip.currency=this.chartDetails.currency,this.tooltip.pointFormatter=function(){if(i())return!1;var s=a.pickCurrency(t,this.series.index,r),h="",o=this.decimals,n=this.color||this.series.color;h+='<span style="color:'+n+'">●</span> '+this.series.name,e=this.series.tooltipOptions.valueSuffix||"";var c=parseFloat(this.y);return c=Highcharts.numberFormat(Math.abs(c),o),h+=": ",this.y<0&&(h+="-"),s&&"%"!==s&&(h+="<b>"+s+"</b>"),h+="<b>"+c+"</b>",h+=e+"<br>"}))}}}(this);
!function(t){{var e=t.ZSChart,s=e.Model.ChartModel.prototype,a=e.Constants.ChartType;e.Constants.MessageConstant}s.setDataLabel=function(){var t=this.chartDetails.lf,s=this.chartDetails.currency,i=(this.chartDetails.precision,this.decimalSeparator,this.thousandSeparator,this.chartObject.type),r=this.chartDetails.type,n=new e.Utility.ChartAgent,h=this.colorOptions.dataLabels||{};switch(t){case"N":this.plotOptions.series.dataLabels={enabled:!1};break;case"V":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:s,formatter:function(){var t=n.pickCurrency(s,this.series.index,r),e=this.point.decimals;return this.y>=0?"%"===t?Highcharts.numberFormat(this.y,e)+t:t+Highcharts.numberFormat(this.y,e):"%"===t?"-"+Highcharts.numberFormat(Math.abs(this.y),e)+t:"-"+t+Highcharts.numberFormat(Math.abs(this.y),e)}};break;case"L":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key}};break;case"S":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name}};break;case"P":(-1!==i.indexOf(a.FUNNEL)||-1!==i.indexOf(a.PIE)||this.plotOptions.series.stacking&&(-1!==this.plotOptions.series.stacking.indexOf("normal")||-1!==this.plotOptions.series.stacking.indexOf("percent")))&&(this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return Highcharts.numberFormat(this.percentage,2)+"%"}});break;case"L_P":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key?this.key+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"S_V":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:s,formatter:function(){var t=n.pickCurrency(s,this.series.index,r),e=this.point.decimals;return this.y>=0?"%"===t?this.series.name+" ("+Highcharts.numberFormat(this.y,e)+t+")":this.series.name+" ("+t+Highcharts.numberFormat(this.y,e)+")":"%"===t?"-"+Highcharts.numberFormat(Math.abs(this.y),e)+t:this.series.name+" (-"+t+Highcharts.numberFormat(Math.abs(this.y),e)+")"}};break;case"L_V":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:s,formatter:function(){var t=n.pickCurrency(s,this.series.index,r),e=this.point.decimals;return this.y>=0?"%"===t?this.key+" ("+Highcharts.numberFormat(this.y,e)+t+")":this.key+" ("+t+Highcharts.numberFormat(this.y,e)+")":"%"===t?"-"+Highcharts.numberFormat(Math.abs(this.y),e)+t:this.key+" (-"+t+Highcharts.numberFormat(Math.abs(this.y),e)+")"}};break;case"S_P":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name?this.series.name+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"V_P":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.y?this.y+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"B":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.point.z}};break;default:this.plotOptions.series.dataLabels={enabled:!1}}this.plotOptions.series.dataLabels.style=h,this.plotOptions.series.dataLabels.style.textOutline=0},s.applyDataLabelStyle=function(){var t=this.plotOptions.series.dataLabels;-1!==this.chartObject.type.indexOf(a.FUNNEL)&&(this.chartObject.marginRight=10),this.plotOptions[this.chartObject.type].dataLabels.padding=0,this.plotOptions[this.chartObject.type].dataLabels.allowOverlap=!1,-1!==this.chartObject.type.indexOf(a.PIE)&&this.series.length>1&&this.series[0].hasOwnProperty("innerSize")&&t&&t.enabled&&(t.connectorColor="#000000")}}(this);
!function(){var e=ZSChart.Model.ChartModel.prototype,t=ZSChart.Constants.ChartType;e.setDefaultColorIndex=function(){var e=this.chartObject.type;if(-1===e.indexOf(t.WATERFALL)&&this.series&&this.series.length>=1)if(-1!==e.indexOf(t.PIE)||-1!==e.indexOf(t.FUNNEL))for(var s=0;s<this.series.length;s++)for(var i=0;i<this.series[s].data.length;i++)this.series[s].data[i].color||(this.series[s].data[i].color=this.colorTheme[i%this.colorTheme.length]);else for(var s=0;s<this.series.length;s++)this.series[s].color||(this.series[s].color=this.colorTheme[s%this.colorTheme.length])},e.setPointColorIndex=function(){var e=this.colorOptions,t=e&&e.pointColors?e.pointColors:null;if(t)for(var s=Object.keys(t),i=0;i<s.length;i++)for(var r=t[s[i]],h=0;h<r.length;h++){var o=r[h],n=o.pIndex,c=o.sIndex,l=o.color;this.series[c].data[n].color=l}},e.applyCustomizationToPlotLines=function(){for(var e=this.series,t=this.yAxis,s=0;s<t.length;s++)if(this.yAxis[s]&&this.yAxis[s].plotLines)for(var i=this.yAxis[s].plotLines,r=0;r<i.length;r++)this.yAxis[s].plotLines[r].isPlColorChanged||(this.yAxis[s].plotLines[r].color=e[s].color?e[s].color:"")},e.setGroupedChartProperty=function(){var e=this.chartObject.customChartType;if(e&&-1!==e.indexOf(t.GROUPED)){this.plotOptions[this.chartObject.type].grouping=!1,this.plotOptions[this.chartObject.type].groupPadding=0;for(var s=2===this.series.length?.3:.1,i=0;i<this.series.length;i++)this.series[i].pointPadding=s,s+=.1}},e.setBulletChartProperty=function(){if(this.chartObject.customChartType&&-1!==this.chartObject.customChartType.indexOf(t.BULLET)){var e,s,i=Math.max(0,this.series.length-2),r=.2,h=.9,o=this.colorTheme,n=this.colorOptions.colorTheme,c=this.series.length-i;i>0&&-1===n.name.indexOf("COLORFUL")&&(e=this.generateColorTheme(o[2],i,!1,!1,!0),s=o.slice(0,2),n.isReversed&&(e=e.reverse(),s=s.reverse()),e=e.concat(s),this.colorTheme=e);for(var l=this.plotOptions[this.chartObject.type].showInLegend,a=0;a<this.series.length;a++)delete this.series[a].maxPointWidth,this.series[a].pointPadding=.2,this.series[a].color=this.colorTheme[a],0>h&&(h=.9),h-=r,i>a?(this.series[a].stacking=!1,this.series[a].grouping=!1,this.series[a].zIndex=--c):a==i?(this.series[a].pointPadding=.4,this.series[a].showInLegend=l,this.series[a].zIndex=a):a>i&&(this.series[a].type="boxplot",this.series[a].pointPadding=.3,this.series[a].zIndex=a,this.plotOptions.boxplot={lineWidth:3,medianWidth:0,stemWidth:0,whiskerWidth:0,showInLegend:l})}},e.updateWaterfallColor=function(){this.series.length>=1&&-1!==this.chartObject.type.indexOf(t.WATERFALL)&&(this.series[0].upColor=this.colorTheme[0],this.series[0].color=this.colorTheme[1])},e.applyRegressionColorIndex=function(){if((-1!==this.chartObject.type.indexOf(t.SCATTER)||-1!==this.chartObject.type.indexOf(t.COLUMN)||-1!==this.chartObject.type.indexOf(t.BAR)||-1!==this.chartObject.type.indexOf(t.LINE)||-1!==this.chartObject.type.indexOf(t.SPLINE)||-1!==this.chartObject.type.indexOf(t.AREA))&&this.series.length>0&&this.series[this.series.length-1].hasOwnProperty("regressionSettings"))for(var e=0;e<this.series.length;e++)this.series[e].regressionSettings.color=this.colorTheme[e%this.colorTheme.length],this.series[e].regressionSettings.showInLegend=this.plotOptions[this.chartObject.type].showInLegend},e.clearRegressionRender=function(){if((-1!==this.chartObject.type.indexOf(t.SCATTER)||-1!==this.chartObject.type.indexOf(t.COLUMN)||-1!==this.chartObject.type.indexOf(t.BAR)||-1!==this.chartObject.type.indexOf(t.LINE)||-1!==this.chartObject.type.indexOf(t.SPLINE)||-1!==this.chartObject.type.indexOf(t.AREA))&&this.series.length>0&&this.series[this.series.length-1].hasOwnProperty("regressionSettings"))for(var e=0;e<this.series.length;e++)this.series[e].rendered&&(this.series[e].rendered=!1)}}(this);
!function(){{var t=ZSChart.Model.ChartModel.prototype;ZSChart.Constants.ChartType}t.setColorScheme=function(){var t=this.colorOptions.colorTheme,e=t.basecolor,r=t.name,o=t.isReversed,s=new ZSChart.Utility.ChartAgent,i={};i.chart=this.chartObject,i.series=this.series,i=s.getColorSchemenColors(i,e,r,o),this.colorTheme=i.colors},t.getMaxColorLength=function(){var t=new ZSChart.Utility.ChartAgent,e={};return e.chart=this.chartObject,e.series=this.series,t.getMaxColorLength(e)},t.generateColorTheme=function(t,e,r,o,s){var i=new ZSChart.Utility.ChartAgent;return i.generateColorTheme(t,e,r,o,s)},t.setColorOptions=function(){var t=this.chartDetails.type,e=(this.colorOptions,new ZSChart.Utility.ChartAgent);return e.setColorOptions(t,this.colorOptions,this.series)}}(this);
!function(){var t=ZSChart.Model.ChartModel.prototype;t.getTextWidth=function(t,e,r,n,i){var a=document.createElement("canvas"),s=a.getContext("2d");e=e||"Arial";var l=r+" "+e;n&&(l=n+" "+l),i&&(l=i+" "+l),s.font=l;var c=s.measureText(t);return c},t.getRGBA=function(t,e){if(null==t||"undefined"==typeof t||-1!==t.indexOf("transparent"))return t;var r,n,i,a;if("#"===t.charAt(0)){var s=t.slice(1);r=this.hexToInt(s.slice(0,2)),n=this.hexToInt(s.slice(2,4)),i=this.hexToInt(s.slice(4,6))}else if("rgb("===t.slice(0,4)||"rgba"===t.slice(0,4)){var l=t.split("(")[1].split(")")[0].split(",");r=l[0],n=l[1],i=l[2],a=l[3]}if("undefined"!=typeof e&&null!==e)return"rgba("+r+","+n+","+i+","+e+")";var c="";return c="rgb("+r+","+n+","+i+")"},t.getTransparency=function(t){if(null==t||"undefined"==typeof t||-1!==t.indexOf("transparent"))return 0;var e,r,n,i;if("rgb("===t.slice(0,4)||"#"===t.charAt(0))return 0;if("rgba"===t.slice(0,4)){var a=t.split("(")[1].split(")")[0].split(",");e=a[0],r=a[1],n=a[2],i=a[3]}var s=100-100*parseFloat(i);return s},t.getTransparencyQuotient=function(t){if(null==t||"undefined"==typeof t||-1!==t.indexOf("transparent"))return 0;var e,r,n,i;if("rgb("===t.slice(0,4)||"#"===t.charAt(0))return 1;if("rgba"===t.slice(0,4)){var a=t.split("(")[1].split(")")[0].split(",");e=a[0],r=a[1],n=a[2],i=a[3]}return i},t.filterProperties=function(){var t=new ZSChart.Utility.ChartAgent;this.chartDetails.currency=t.filterCurrency(this.chartDetails.currency,this.getSeriesObject()?this.getSeriesObject().length:0)},t.hexToInt=function(t){return parseInt(t,16)}}(this);
!function(t,e){function i(t){t.wrap(t.Legend.prototype,"render",function(t){if(this.options.alignHorizontalToPlotArea){var e=this.chart;this.options.itemStyle.width=e.plotWidth-this.options.symbolWidth-this.options.symbolPadding-this.padding,this.options.itemStyle.overflow="hidden",this.options.itemStyle.textOverflow="ellipsis"}else if(this.options.alignVerticalToPlotArea){var e=this.chart;this.options.itemStyle.width=.2*e.chartWidth,this.options.itemStyle.overflow="hidden",this.options.itemStyle.textOverflow="ellipsis","right"===this.options.align&&"top"===this.options.verticalAlign&&-1!==e.userOptions.chart.type.indexOf(c.FUNNEL)&&(this.options.y=e.plotTop+e.options.chart.spacingTop)}t.call(this)})}function n(t){t.wrap(t.Tooltip.prototype,"refresh",function(t,e,i){t.call(this,e,i),this.hide(3e3)})}function r(t){t.wrap(t.Pointer.prototype,"normalize",function(t,e){var i,n=t.call(this,e),r=this.chart.container.parentNode;return""!==r.style.zoom&&(i=parseFloat(r.style.zoom,10),n.chartX/=i,n.chartY/=i),n})}function s(t){t.Legend.prototype.getAllItems=function(){{var e=[],i=t.each;t.pick,t.defined}i(this.chart.series,function(t){var i=t&&t.options;t&&i.showInLegend&&(e=e.concat(t.legendItems||("point"===i.legendType?t.data:t)))});var n=[];return i(e,function(t){!t.series||-1===t.series.chart.options.chart.type.indexOf("pie")&&-1===t.series.chart.options.chart.type.indexOf("funnel")?n.push(t):t.y&&n.push(t)}),n}}function o(t){t.wrap(Highcharts.seriesTypes.column.prototype,"init",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var e=this.options,i=e.grouping,n=e.stacking,r=this.yAxis.options.reversedStacks,s=0;if(void 0===i||i){var o,a=this.chart.retrieveStacks(n),h=e.stack||0;for(o=0;o<a[h].series.length&&a[h].series[o]!==this;o++);s=10*a.totalStacks-10*(a.totalStacks-a[h].position)-(r?o:-o)}e.zIndex=s}})}function a(){}function h(t){{var e=(t.defaultOptions,t.doc),i=t.Chart,n=t.createElement,r=t.discardElement,s=(t.css,t.merge),o=t.each,a=t.extend;t.SVGRenderer}a(i.prototype,{SVGRenderer:function(t,e){var i=t.match(/<\/svg>(.*?$)/);return i&&i[1]&&(i='<foreignObject x="0" y="0" width="'+e.chart.width+'" height="'+e.chart.height+'"><body xmlns="ht""tp://www.w3.org/1999/xhtml">'+i[1]+"</body></foreignObject>",t=t.replace("</svg>",i+"</svg>")),t=t.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="ht""tp://www.w3.org/1999/xlink" ').replace(/ (|NS[0-9]+\:)href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g," ").replace(/&shy;/g,"­")},getChartHTML:function(){return this.container.innerHTML},getSVG:function(i){var h,l,p,c,u,d,g,E,f=this,y=s(f.options,i);return l=n("div",null,{position:"absolute",top:"-9999em",width:f.chartWidth+"px",height:f.chartHeight+"px"},e.body),g=f.renderTo.style.width,E=f.renderTo.style.height,u=y.chart.width||/px$/.test(g)&&parseInt(g,10)||600,d=y.chart.height||/px$/.test(E)&&parseInt(E,10)||400,a(y.chart,{animation:!1,renderTo:l,forExport:!0,renderer:"SVGRenderer",width:u,height:d}),delete y.data,y.series=[],o(f.series,function(t){c=s(t.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:t.visible}),c.isInternal||y.series.push(c)}),o(f.axes,function(e){e.userOptions.internalKey||(e.userOptions.internalKey=t.uniqueKey())}),h=new t.Chart(y,f.callback),i&&o(["xAxis","yAxis","series"],function(t){var e={};i[t]&&(e[t]=i[t],h.update(e))}),o(f.axes,function(e){var i=t.find(h.axes,function(t){return t.options.internalKey===e.userOptions.internalKey}),n=e.getExtremes(),r=n.userMin,s=n.userMax;!i||void 0===r&&void 0===s||i.setExtremes(r,s,!0,!1)}),p=h.getChartHTML(),y=null,h.destroy(),r(l),p}})}function l(t){t.Axis.prototype.log2lin=function(t){if(!this)return Math.log(t)/Math.LN10;var e,i=this&&this.userOptions&&this.userOptions.baseValue||10,n=0>t,r=Math.abs(t);return i>r&&(r+=(i-r)/i),e=Math.log(r)/Math.log(i),n?-e:e},t.Axis.prototype.lin2log=function(t){if(!this)return Math.pow(10,t);var e=this&&this.userOptions&&this.userOptions.baseValue||10,i=0>t,n=Math.abs(t),r=Math.pow(e,n);return e>r&&(r=e*(r-1)/(e-1)),i?-r:r}}var p=t.ZSChart,c=p.Constants.ChartType,u=p.Constants.CAConstant;p.transient[u.EXTENDING_LEGEND_ITEM]=s,p.transient[u.EXTENDING_SERIES_TYPE]=o,p.transient[u.EXTENDING_LEGEND]=i,p.transient[u.EXTENDING_POINTER]=r,p.transient[u.EXTENDING_TOOLTIP]=n,p.transient[u.EXTENDING_POINTER_NORMALIZATION]=a,p.transient[u.EXTENDING_EXPORTING]=h,p.transient[u.EXTENDING_LOG_SCALE]=l,p.transient[u.EXTENDING_LEGEND_ITEM](e),p.transient[u.EXTENDING_SERIES_TYPE](e),p.transient[u.EXTENDING_POINTER_NORMALIZATION](e),p.transient[u.EXTENDING_LOG_SCALE](e),p.transient[u.EXTENDING_EXPORTING](e)}(this,Highcharts);
!function(t){function r(t,r){return parseInt(t,r||10)}function e(t){return this instanceof e?(this.rgba=void 0,this.color=void 0,this.defaultRGBA=void 0,this.depth=void 0,this.generatedColor=void 0,this.lowerLimit=7,this.colorRange=void 0,void this.init(t)):new e(t)}var i=t.ZSChart;e.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),parseFloat(t[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(t){return[r(t[1],16),r(t[2],16),r(t[3],16),1]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),1]}}],names:{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",transparent:"#ffffff",default:"#ffffff"},init:function(t){if("object"==typeof t){var r,e,i,n,s,o=[];for(e=this.parsers.length-1,s=0,n=t.length;n>s;)e=0>e?2:e,i=i=this.parsers[e],r=i.regex.exec(t[s]),r&&(o.push(i.parse(r)),s++),e--;this.colorRange=o||[],this.defaultRGBA=JSON.parse(JSON.stringify(o))||[]}else{var r,a,e,i;for(this.color=t=this.names[t]||t,e=this.parsers.length;e--&&!a;)i=this.parsers[e],r=i.regex.exec(t),r&&(a=i.parse(r));this.rgba=a||[],this.defaultRGBA=JSON.parse(JSON.stringify(a))||[]}},polynomial:function(t){for(var r=arguments.length-1,e=arguments[r];r>1;)e=e*t+arguments[--r];return e},erf:function(t){var r=this.polynomial(Math.abs(t),1,.278393,.230389,972e-6,.078108);return r*=r,r*=r,r=1-1/r,0>t?-r:r},getColorCombination:function(t){var r,e=this.colorRange,i=1/t,n=0,s=[],o=0;this.generatedColor=[];for(var a=0;t>a;a++){for(var h=0;a>0&&h<e.length;h++,o++)r=e[h],s.push(a%2==0?this.getBrighten(r,this.erf(n),o%3):this.getDarken(r,this.erf(n),o%3));0==a&&(s=JSON.parse(JSON.stringify(e)));for(var f=0;f<s.length;f++)this.generatedColor.push(this.getRGB(s[f]));e=JSON.parse(JSON.stringify(this.defaultRGBA)),n=n>.6?.3:n,n+=i,s=[]}return this.generatedColor},getRGB:function(t){return"rgb("+t[0]+","+t[1]+","+t[2]+")"},getColor:function(t){var r,e=this.color,i=this.rgba;return r=i&&i[0]?"rgb"===t||!t&&1===i[3]?"rgb("+i[0]+","+i[1]+","+i[2]+")":"a"===t?i[3]:"rgba("+i.join(",")+")":e},getBrighten:function(t,e,i){for(var i=0;2>=i;i++)t[i]=r(e*t[i]+255*(1-e)),t[i]<0&&(t[i]=0),t[i]>255&&(t[i]=255);return t},getDarken:function(t,e,i){for(var i=0;2>=i;i++)t[i]=r(e*t[i]+100*(1-e)),t[i]<0&&(t[i]=0),t[i]>255&&(t[i]=255);return t},isLuminance:function(){var t=this.rgba,r=.2126*t[0]+.7152*t[1]+.0722*t[2];return 100>r?!0:!1},brighten:function(t){var e,i=this.rgba;if(t&&0!==t)for(e=0;3>e;e++)i[e]+=r(t*(255-i[e])),i[e]<0&&(i[e]=0),i[e]>255&&(i[e]=255);return this},darken:function(t){var e,i=this.rgba;if(t&&0!==t)for(e=0;3>e;e++)i[e]+=r(t*(150-i[e])),i[e]<0&&(i[e]=0),i[e]>255&&(i[e]=255);return this},setOpacity:function(t){return this.rgba[3]=t,this},getLinerGradient:function(t){var r;return this.setDepth(t),this.brightenNColors(),r=this.getNColorCode(),r=r.slice(0,t),this.generateLinearGradient(r,t)},getRGBA:function(t){for(var r=[],e=0;e<t.length;e++){var i=t[e],n="rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")";r.push(n)}return r},generateLinearGradient:function(t,r){var e="linear-gradient(to right, ";t=t||this.getRGBA(this.defaultRGBA),r=r||6;for(var i=r,n=100/i,s=0;i>s;s++)e+=t[s]+" "+Math.round(n*s)+"% ,"+t[s]+" "+Math.round(n*(s+1))+"%, ";return e=e.substring(0,e.lastIndexOf(","))+")"},brightenNColors:function(){var t,r,e=(this.rgba,Math.max(this.depth,this.lowerLimit));for(e+=2,t=0;e>t;t++)r=this.brighten(t/e).getColor(),r&&(this.generatedColor||(this.generatedColor=[]),this.generatedColor.push(r),r=void 0);return this},getNColorCode:function(){return this.generatedColor},setDepth:function(t){return this.depth=t,this}},i.Utility.parseInteger=r,i.Utility.SheetChartColor=e}(this);
!function(t,e){function i(){this.stockChart=!1,this.Chart=!1}{var r=t.ZSChart;r.Constants.ServiceType}i.prototype=e.Chart.prototype,i.prototype.setStockChart=function(t){this.stockChart=t},i.prototype.setLocale=function(t,i){t&&i&&e.setOptions({lang:{decimalPoint:t,thousandsSep:i}})},i.prototype.isStockChart=function(){return this.stockChart},i.prototype.setChart=function(t){this.Chart=t},i.prototype.isCommonChart=function(){return this.Chart},i.prototype.createZSChart=function(t){var e,i;return e=t.chart.renderTo,this.setStockChart(t.isStockChart||!1),i=this.isStockChart()?this.ZSStockChart(e,t):this.ZSChart(e,t),i.resetTitleFontFamily(),i},i.prototype.ZSStockChart=function(t,i){return e.stockChart(t,i)},i.prototype.ZSChart=function(t,i){return e.chart(t,i)},i.prototype.destroyChart=function(){this.destroy()},i.prototype.updateTitle=function(t){this.setTitle({text:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.getChartInstance=function(t){var e=r.Wrapper.DOMUtils,i=e.getDatasetAttribute(t,"highchartsChart");return Highcharts.charts[i]},i.prototype.updateSubTitle=function(t){this.setSubtitle({text:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateTitleStyle=function(t){this.setTitle({style:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateSubTitleStyle=function(t){this.setTitle(null,{style:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateTooltip=function(t){this.updateChart({tooltip:{enabled:t}})},i.prototype.updateZoom=function(t){this.updateChart({chart:{zoomType:t?"xy":""}})},i.prototype.updateAnimation=function(t){this.updateChart({chart:{animation:t}})},i.prototype.updateMarker=function(t){this.updateChart({plotOptions:{series:t}})},i.prototype.setPositiveExtreme=function(t){var i=this;try{i&&i.yAxis.forEach(function(r){var n=r.getExtremes();if(n){var o,s;n.min<0&&n.dataMin>=0&&!i.options.yAxis[0].min&&(o=e.pick(r.min,n.dataMin,n.userMin,n.min)),r.setExtremes(o,s,!1,t)}else r.setExtremes(void 0,void 0,!1,t)})}catch(t){}},i.prototype.updateXTitle=function(t,e){this.xAxis[e].setTitle({text:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.getCType=function(){return this.options.chart.type},i.prototype.isBarCType=function(){return-1!==this.getCType().indexOf("bar")},i.prototype.updateYTitle=function(t,e){this.yAxis[e].setTitle({text:t,rotation:this.isBarCType()?0:270}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateLegend=function(t){this.legend.update(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateDataLabels=function(t){this.updateChart(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateTrendtype=function(t){return this.createZSChart(t)},i.prototype.updateChart=function(t){this.update(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateXAxis=function(t){this.updateChart({xAxis:t})},i.prototype.wrapMinMaxInterval=function(t){if(t)for(var e=0;e<t.length;e++)t[e].min&&(t[e].min=parseFloat(t[e].min)),t[e].tickInterval&&(t[e].tickInterval=parseFloat(t[e].tickInterval)),t[e].max&&(t[e].max=parseFloat(t[e].max))},i.prototype.updateYAxis=function(t){this.wrapMinMaxInterval(t),this.updateChart({yAxis:t})},i.prototype.updateChartObject=function(t){this.updateChart({chart:t})},i.prototype.updateYPlotLine=function(t,e){var i=t.id;this.removeYPlotLine(i,e),this.yAxis[e||0].addPlotLine(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.removeYPlotLine=function(t,e){this.yAxis[e||0].removePlotBandOrLine(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateMin=function(t,e){this.yAxis[e||0].update({min:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateMax=function(t,e){this.yAxis[e||0].update({max:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateInterval=function(t,e){var i=this.getIntervalValue(this.yAxis[e||0].getExtremes(),t);null!==t&&i>t||(this.yAxis[e||0].update({tickInterval:t}),this.removeUnwantedElements(),this.resetTitleFontFamily())},i.prototype.getIntervalValue=function(t){var e=t.min,i=t.max,r=(i-e)/200;return Math.round(r)},i.prototype.addYMajorGrid=function(t){this.yAxis[t||0].update({gridLineWidth:1}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.removeYMajorGrid=function(t){this.yAxis[t||0].update({gridLineWidth:0}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.addYMinorGrid=function(t){this.yAxis[t||0].update({minorTickInterval:"auto"}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.removeYMinorGrid=function(t){this.yAxis[t||0].update({minorTickInterval:null}),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.refresh=function(t){return this.createZSChart(t)},i.prototype.setAnimation=function(t){this.options.plotOptions.series.animation=t},i.prototype.setZSCSize=function(t,e){this.setSize(t,e),this.removeUnwantedElements(),this.resetTitleFontFamily()},i.prototype.updateSeries=function(t){this.updateChart({series:t})},i.prototype.updateSeriesByCustomProperty=function(t,e){this.series[t].update(e)},i.prototype.updatePointByCustomProperty=function(t,e,i){this.series[t].data[e].update(i)},i.prototype.removeUnwantedElements=function(){if(r.Wrapper&&r.Wrapper.DOMUtils){var t=r.Wrapper.DOMUtils,e=this.renderTo.id,i=new r.Utility.ChartAgent,n=i.checkIfChartIsGrouped(e),o=t.getElementById(e);if(!o||n)return;for(var s=o.querySelector(".highcharts-container"),a=s.children,p=1;p<=a.length-2;p++)a[p].classList.contains("highcharts-axis-labels")&&s.removeChild(a[p]);r.Client.Action.OverrideHighchartEvents(e)}},i.prototype.resetTitleFontFamily=function(){if(r.Wrapper&&r.Wrapper.DOMUtils){var t=r.Wrapper.DOMUtils,e=this.renderTo.id,i=t.getElementById(e);if(!i)return;var n="Arial";this.options.chart&&this.options.chart.style&&(n=this.options.chart.style.fontFamily);for(var o=i.querySelector(".highcharts-container"),s=o.children,a=0;a<s.length;a++)s[a].classList.contains("highcharts-title")&&(s[a].style.fontFamily=n),s[a].classList.contains("highcharts-subtitle")&&(s[a].style.fontFamily=n);r.Client.Action.OverrideHighchartEvents(e)}},i.prototype.hideToolip=function(){this.tooltip.hide()},r.Wrapper.ZSHighChartWrapper=i}(this,Highcharts);
!function(r){function t(){}var p=r.ZSChart,a=p.Wrapper.ZSHighChartWrapper,e={HIGHCHARTS:new a};t.prototype={getAdaper:function(r){return p.Wrapper.ZSChartAdatperPlugins[r]}},p.Wrapper.ZSChartAdatperPlugins=e,p.Wrapper.ZSChartAdapter=t}(this);
!function(t){function e(){this.serviceName=a,this.adapter=new o}var r=t.ZSChart,i=r.Constants.ServiceProvider,a=i.HIGHCHARTS,o=r.Wrapper.ZSChartAdapter;e.prototype.init=function(t){this.serviceName=t},e.prototype.Chart=function(t){return this.adapter.getAdaper(this.serviceName).createZSChart(this.getRequiredChartProperty(t))},e.prototype.setLocale=function(t,e){this.adapter.getAdaper(this.serviceName).setLocale(t,e)},e.prototype.reposition=function(t){return this.adapter.getAdaper(this.serviceName).reposition(t)},e.prototype.getRequiredChartProperty=function(t){return this.serviceName==i.HIGHCHARTS?t:t},r.Wrapper.ZSChart=e}(this);
!function(t){function e(){}function i(t,e,i,n,r){var o=new c.Utility.CommanAgent,a={legend:o.getLegendUpdate(e,i,n)};return t=o.mergeRecursively(t,a),t.plotOptions[t.chart.type].showInLegend=t.legend.enabled,t.legend=o.setDefaultLegendItemStylesOrElse(t.legend,r),t}function n(t,e,i){var n=new c.Utility.CommanAgent;return!i&&(i=n.getDefaultDataLabelConfig(t.chart.renderTo)),i.lf=e,n.getDataLabelsUpdate(t,i)}function r(t,e){var i=e.scaleFactor||1,n=e.index||0,r=e.unitFactor||" ",o=e.conversionType||d.ConversionType.UNITS;t.updateScaleFactor(i,r,n,o)}function o(t,e){var i=e.nfCode,n=e.prefix||"",r=e.suffix||"",o=e.index||0;t.setNumberFormat(i,n,r,o)}function a(t,e){var i=new c.Utility.ChartAgent,n=e||t.getYAxis(),r=t.getType(),o=i.filterCurrency(t.getCurrency(),t.getOptions().series?t.getOptions().series.length:0);return i.getFormatLabels(n,o,r,void 0,t.getConversionCode(),t.isSingleYaxis())}var c=t.ZSChart,s=c.Model,l=t.sPlusPlus,d=c.Constants,h=t.ZSConstants.I18N,u=d.ColorSchemeType,p=(l.data.AppRegistry,t.document),A=c.Constants.ChartUpdate,g=c.Constants.QuickStyleActions,v=t.ZSEvents,y=v.Groups,S=v.Names,C=v.topic,f=c.Constants.ChartType,I=null,D=t.ZSDevTools.Logger;e.prototype.switchChart=function(t){var e=(new c.Utility.ChartAgent,l.view.getActiveGridID()),i=l.view.getResourceID(e),n=l.view.getVersionID(e),r=l.view.getSheetID(e),o=c.Utility.getActiveChart();c.Server.Action.switchChart(i,r,n,{ID:o,dSN:t+"#",sSN:r}),UserAction.SwitchSheet(i,r,n,t+"#")},e.prototype.updateDataRange=function(t,e,i,n){var r=new c.Utility.ChartAgent;for(var o in n){var a=n[o];r.mergeChartMeta(t,e,i,a)}},e.prototype.rePaintChartOnGrid=function(t,e,i){var n=new c.Utility.ChartAgent,r=new c.Utility.CommanAgent;r.resetMoveMenu();var o=n.filterMeta(e,t,i);if(o){var a=o.CHARTS,s=o.afftectedCharts,l=o.CACHED;new Promise(function(n){C.publish(y.Listener,S.SheetAction.CHARTS.ATTACH,{RID:t,SHEETID:e,VERSION:i,CHARTS:a,CACHED:l});var r=this;setTimeout(function(){n(r)},100)}.bind(this)).then(function(t){t.updateChartFromServer(e,s)})}},e.prototype.updateSidePanelMeta=function(t){t&&C.publish(y.UI,S.SidePanel.CHARTS.METACONVERSION,{CHART_ID:t})},e.prototype.renderSheetCharts=function(t,e,i,n){if(n){var r=n.shift();r&&this.attachAsync(t,e,i,r,r.ts,r.ds,this).then(function(r){r.renderSheetCharts(t,e,i,n)})}},e.prototype.attachAsync=function(t,e,i,n,r,o,a){return new Promise(function(r){var o=new c.Utility.AgentDom,s=n.getInstance().renderTo;o.setDivContainerProperty(t,e,i,n.id,n.ht,n.wd,n.top,n.left,n.sr,n.sc,n.srd,n.scd,s),n.getInstance().reflow(),setTimeout(function(){r(a)},100)})},e.prototype.updateChartFromServer=function(t,e){e.length>0&&c.Server.Action.RefreshChart(t,e,function(t){C.publish(y.Listener,S.SheetAction.CHARTS.UPDATE,{RID:t.rID,SHEETID:t.sheetID,CHARTS:t.CHARTS,VERSION:t.version,AOWNER:t.isActionOwner})})},e.prototype.setLoadedChartPropertyByChartId=function(t,e,i,n){var r=new c.Utility.ChartAgent,o=[],a=r.getInstance(t,e,i,n);a.setAssociatedSheetId(e),o.push(a),r.resetChartMetaVisitedProperty(o)},e.prototype.resetLoadedChartProperty=function(t,e,i){var n=new c.Utility.ChartAgent,r=n.getAllMetaOfSheet(t,e,i);n.resetChartMetaVisitedProperty(r)},e.prototype.insertChart=function(t,e,i,n,r,o,a){if(n){var c=n.shift();c&&this.renderAsync(t,e,i,c,c.ts,c.ds,!1,!1||a,!0,this).then(function(r){r.insertChart(t,e,i,n)})}},e.prototype.renderAsync=function(t,e,i,n,r,o,a,d,h,u){return new Promise(function(h){var p=(new c.Utility.CommanAgent,n.id),A=l.view.getActiveGridID(),g=l.view.getSheetID(A),v=n.asn;if(g!=v)return u.setLoadedChartPropertyByChartId(t,e,i,p,!1),void h(u);var y,S=new c.Utility.ChartAgent,C=n.co,f=S.clone(n,!0),I=S.clone(f.co,!0);delete f.co;var D=new s.ChartModel(p,f,C.chart,C.colorOptions,C.xAxis,C.yAxis,C.series,C.title,C.subtitle,C.tooltip,C.plotOptions,C.legend,C.credits,r,o,C.isStockChart);D.setSeparatorOptions(),D.init(a,d),y=D.show(a),S.addInstance(t,e,i,p,y,I,f),setTimeout(function(){h(u)},100)})},e.prototype.loadChart=function(t,e,i,n){if(n){var r=n.shift();r&&this.renderAsync(t,e,i,r,r.ts,r.ds,!1,!1,!0,this).then(function(r){r.loadChart(t,e,i,n)})}},e.prototype.reRenderChart=function(t,e,i,n){var r=l.view.getActiveGridID(),o=l.view.getSheetID(r);for(var a in n){{var c=n[a],s=c.id||c.chartId,d=c.asn;c.co}o==d?this.refreshChart(t,e,s,c,i,!0,!0):this.markChartAsDirty(t,e,s,i)}},e.prototype.updateChart=function(t,e,i,n){var r=l.view.getActiveGridID(),o=l.view.getSheetID(r),a=new c.Utility.ChartAgent;for(var s in n){var d=n[s];d.id=d.id||d.chartId;var h=d.id,u=d.asn,p=d.co,A=a.getInstance(t,e,i,h),g=d.subAction?d.subAction:-1,v=(c.Manager.SidePanelManager,p&&a.checkRedrawProperty(A.getDetails(),p,A.getInstance()[0],g)),I=A.getType().toUpperCase()===f.WORDCLOUD.toUpperCase();v=I?!0:v;{a.isRecommendationCallNeeded(g)}if(g>0&&C.publish(y.UI,S.SidePanel.CHARTS.CUSTOM.EVENT.SYNC_PROPERTY_TO_TOOLBAR,{PROPERTIES:{value:d.value,subAction:g}}),o==u){if("undefined"==typeof v)return A.isClientActionDone||(this.doQuickEditClientAction(t,e,i,[h],g,d.value),this.doQuickStyleClientAction(h,A,g,!0),this.doQuickTitleEditAction([h],A.getOptions(),g),C.publish(y.UI,S.SidePanel.CHARTS.METACONVERSION,{CHART_ID:h}),h===c.Utility.getActiveChart()[0]&&c.Utility.updatePartOfPanel(g,h)),void(A.isClientActionDone=!1);!v&&this.updateChartClient(t,e,i,h,d),v&&this.refreshChart(t,e,h,d,i,!0)}else this.markChartAsDirty(t,e,h,i)}},e.prototype.updateSidePanel=function(t,e){C.publish(y.UI,S.SidePanel.CHARTS.METACONVERSION,{CHART_ID:t}),e&&C.publish(y.UI,S.SidePanel.CHARTS.CALL_RECOMMENDATION,{CHART_ID:t}),e&&C.publish(y.UI,S.SidePanel.CHARTS.CALL_TABLE_DEFINITION,{CHART_ID:t}),C.publish(y.UI,S.SidePanel.CHARTS.REFRESH_SIDE_PANEL,{CHART_ID:t})},e.prototype.addChartToImageLibrary=function(t,e,i,n){c.Server.Action.addChartToImageLibrary(t,i,e,n,function(t){var e=new ZSClass.TBNotification(h["chart.errorInfoWhileAddingInLibrary"]||"Unable to add chart into image library. please try again!",{type:"error"});"success"==t&&(e=new ZSClass.TBNotification(h["chart.infoWhileAddingInLibrary"]||"New chart image added into image library.",{type:"info"})),e.show()})},e.prototype.saveChartAsImage=function(t){function e(t,e){return unescape(0==t.length?e:t)}var i=l.view.getActiveGridID(),n=l.view.getResourceID(i),r=l.view.getVersionID(i),o=l.view.getSheetID(i),a=new c.Utility.ChartAgent;if(!t&&(t=c.Utility.getActiveChart()),"object"==typeof t)for(var s in t){var h=t[s],u=a.getChartMeta(h),p=e(u.getTitle(),"CHART");setTimeout(function(){this.downloadAs(n,o,r,{chartId:h,extn:d.ChartImageExtn.PNG,fileName:p,height:u.getHeight(),width:u.getWidth()})}.bind(this),100)}else{var h=t,u=a.getChartMeta(h),p=e(u.getTitle(),"CHART");setTimeout(function(){this.downloadAs(n,o,r,{chartId:h,extn:d.ChartImageExtn.PNG,fileName:p,height:u.getHeight(),width:u.getWidth()})}.bind(this),100)}},e.prototype.downloadAs=function(t,e,i,n){function r(){var t=o.createElement("a");t.href=l.toDataURL("image/"+n.extn),t.download=n.fileName+"."+n.extn;var e=p.body;e.appendChild(t),t.click(),e.removeChild(t)}{var o=c.Wrapper.DOMUtils,a=new c.Utility.ChartAgent,s=a.getChartSvgByID(n.chartId),l=o.createElement("canvas");l.getContext("2d")}l.height=n.height,l.width=n.width,canvg(l,s,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){r()}})},e.prototype.doChartCustomization=function(t,e){function i(){c.Server.Action.doQuickStyleAction(a,d,s,e.cID,112,[{pIndex:e.pIndex,cValue:e.color,sIndex:e.sIndex,isSeriesLevel:e.isSeries}])}function n(){var t=h.getChartMeta(e.ID),i=t.updateXLabelStyle(e.style);c.Server.Action.doQuickStyleAction(a,d,s,t.getID(),127,[{style:i}])}function r(){var t=h.getChartMeta(e.ID),i=t.updateYLabelStyle(e.style,e.yIndex);c.Server.Action.doQuickStyleAction(a,d,s,t.getID(),126,[{style:i,index:e.yIndex}])}var o=l.view.getActiveGridID(),a=l.view.getResourceID(o),s=l.view.getVersionID(o),d=l.view.getSheetID(o),h=new c.Utility.ChartAgent;switch(t){case"series":i();break;case"haxis":n();break;case"vaxis":r()}},e.prototype.doClone=function(t){var e=l.view.getActiveGridID(),i=l.view.getResourceID(e),n=l.view.getVersionID(e),r=l.view.getSheetID(e),o=new c.Utility.ChartAgent;if(t){var a=o.getChartMeta(t);a.setForClone(!0);var s=o.getRequestObject(a,"new");a.setForClone(!1)}else{t=c.Utility.getActiveChart();for(var d in t){var h=t[d],a=o.getChartMeta(h);a.setForClone(!0);var s=o.getRequestObject(a,"new");a.setForClone(!1)}}C.publish(y.Listener,S.SheetAction.CHARTS.BLUR,{RID:i,SHEETID:r,VERSION:n,CHARTID:t}),c.Server.Action.updateChartOnGrid(i,r,n,s)},e.prototype.updateChartClient=function(t,e,i,n,r){var o=new c.Utility.ChartAgent,a=o.getInstance(t,e,i,n),l=a.getInstance(),d=r.co,h=o.clone(r,!0);delete h.co;var u=new s.ChartModel(n,h,d.chart,d.colorOptions,d.xAxis,d.yAxis,d.series,d.title,d.subtitle,d.tooltip,d.plotOptions,d.legend,d.credits,h.ts,h.ds,d.isStockChart);u.setSeparatorOptions(),u.init(!1,!0),c.Utility.updateChartClient.fn.call(this,l,u),c.Client.Action.OverrideHighchartEvents(n),n===c.Utility.getActiveChart()[0]&&this.updateSidePanel(n,!1)},e.prototype.createPreview=function(t,e){var i=new c.Utility.ChartAgent,n=e.co,r=i.clone(e,!0),o=(i.clone(r.co,!0),e.ts||""),a=e.ds||"";delete r.co;var s=new ChartManager.Model.Chart(t,r,n.chart,n.colorOptions,n.xAxis,n.yAxis,n.series,n.title,n.subtitle,n.tooltip,n.plotOptions,n.legend,n.credits,o,a);return s.setSeparatorOptions(),s.init(!1,!1),s.restoreDefaultSpacing(),s.showPreview()},e.prototype.resizeChart=function(t,e){var i=c.transient.hInsance;chart.chartDetails.ht=t,chart.chartDetails.wd=e,chart.chartObject.height=t,chart.chartObject.width=e,chart.setDivContainerSize(t,e),i.setZSCSize(e,t)},e.prototype.resetSize=function(t,e,i,n,r,o){var a=new c.Utility.ChartAgent;a.setInstanceSize(t,e,i,n,o,r),C.publish(y.UI,S.SidePanel.CHARTS.METACONVERSION,{CHART_ID:n})},e.prototype.updateScaleFactor=function(t,e,i,n,o){var a=l.view.getActiveGridID(),s=l.view.getResourceID(a),d=l.view.getVersionID(a),h=l.view.getSheetID(a);Object.keys(t).forEach(function(a){var s=t[a],l=c.Utility.getChartMeta(s,!0);r(l,{scaleFactor:e,unitFactor:i,index:n,conversionType:o})}),this.doQuickEditClientAction(s,h,d,t,149,{scaleFactor:e,unitFactor:i,index:n,conversionType:o});for(var u in t){var p=t[u];c.Server.Action.doQuickStyleAction(s,h,d,p,149,[{scaleFactor:e,index:n,unitFactor:i,conversionType:o}])}},e.prototype.updateBinningInterval=function(t,e){var i=l.view.getActiveGridID(),n=l.view.getResourceID(i),r=l.view.getVersionID(i),o=l.view.getSheetID(i);0!==t.length&&c.Server.Action.doQuickEditAction(n,o,r,t,151,e)},e.prototype.setNumberFormat=function(t,e){var i=l.view.getActiveGridID(),n=l.view.getResourceID(i),r=l.view.getVersionID(i),a=l.view.getSheetID(i);Object.keys(t).forEach(function(i){var n=t[i],r=c.Utility.getChartMeta([n],!0);o(r,e)}),this.doQuickEditClientAction(n,a,r,t,150,e),I&&clearTimeout(I),I=setTimeout(function(){for(var i in t){var o=t[i];c.Server.Action.doQuickStyleAction(n,a,r,o,150,[e])}},500)},e.prototype.doQuickEditClientAction=function(t,e,r,o,l,d){if(0!=o.length){var h=new c.Utility.ChartAgent;for(var u in o){var p=o[u],g=h.getChartMeta(p);if(g){var v,y=g.getInstance(),S=h.clone(g.getOptions(),!0),C=h.clone(g.getDetails(),!0),f=S.title.text.length>0?!0:!1,I=S.subtitle.text.length>0?!0:!1,D=new s.ChartModel(p,C,S.chart,S.colorOptions,S.xAxis,S.yAxis,S.series,S.title,S.subtitle,S.tooltip,S.plotOptions,S.legend,S.credits,C.ts,C.ds,S.isStockChart);D.setSeparatorOptions(),D.init(!1,!0);var T=D.constructChartOptions();switch(l){case 101:v=i(T,d,f,I),y&&c.Utility.updateChart.fn.call(this,y,v);break;case 102:v=n(T,d),v=i(v,g.getLegendPosition(),f,I);var h=new c.Utility.ChartAgent;v=h.applySeriesColorToPlotLines(v),v.chart.width=C.wd,v.chart.height=C.ht,y&&c.Utility.updateDataLabels.fn.call(this,y,v);break;case 103:if(y){d=h.isArray(d)?1===d[0].gridLineWidth:d;var k=T.yAxis.length;c.Utility.updateMajorGrid.fn.call(this,y,d,k)}break;case 104:if(y){d=h.isArray(d)?"auto"===d[0].minorTickInterval:d;var k=T.yAxis.length;c.Utility.updateMinorGrid.fn.call(this,y,d,k)}break;case 105:y&&c.Utility.updateAnimation.fn.call(this,y,d);break;case 106:y&&c.Utility.updateTooltip.fn.call(this,y,d);break;case 147:T.plotOptions.series.marker.enabled=d,y&&c.Utility.updateMarker.fn.call(this,y,T.plotOptions.series);break;case 149:T.yAxis=a(g,T.yAxis),y&&this.updateHighChartsInstance(T,y,g,A.YAXIS);break;case 150:T.yAxis=a(g,T.yAxis),y&&this.updateHighChartsInstance(T,y,g,A.YAXIS)}g.setClientUpdated(!0)}}}},e.prototype.reLoadChartOnGrid=function(t,e,i){var n=new c.Utility.ChartAgent,r=n.filterMeta(e,t,i,!0,!0);if(r){var o=r.CHARTS,a=r.afftectedCharts;new Promise(function(n){C.publish(y.Listener,S.UserAction.CHARTS.ZOOM,{RID:t,SHEETID:e,VERSION:i,CHARTS:o});var r=this;setTimeout(function(){n(r)},100)}.bind(this)).then(function(t){t.updateChartFromServer(e,a)})}},e.prototype.updateChartOnGrid=function(t,e,i,n){var r=[];for(var o in n){var a=n[o],c=a.subAction,s=a.value;switch(c){case 137:case 138:case 107:case 148:case 151:case 152:case 153:case 154:s.subAction=c,r.push(s);break;default:r.push(a)}}this.updateChart(t,e,i,r)},e.prototype.refreshChart=function(t,e,i,n,r,o,a){var s=[];s.push(n),C.publish(y.Listener,S.UserAction.CHARTS.UPDATE,{RID:t,SHEETID:e,VERSION:r,CHARTS:s,doNotSetFocus:o}),i===c.Utility.getActiveChart()[0]&&this.updateSidePanel(i,a)},e.prototype.markChartAsDirty=function(t,e,i,n){D.log("[CHART] >>>>>> Marking Chart as Dirty ",i);var r=new c.Utility.ChartAgent,o=r.getChartMetaOfSheet(e,t,n,void 0,i);o&&o.markDirty(!0)},e.prototype.changeChartType=function(t,e,i,n,r){Object.keys(n).forEach(function(o){var a=[],s=n[o],l=s.getDetails(),d=l.type;d!==r&&a.push(l.id),0!==a.length&&c.Server.Action.doQuickEditAction(t,e,i,a,107,r)})},e.prototype.updateLegend=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails(),a=i.legendPos;a!==r&&o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,101,r),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,101,r)},e.prototype.updateLegendStyle=function(t,e,i,n,r){var o=n.getDetails(),a={};a.style=r;var s=[];s.push(a),this.doQuickStyleClientAction(o.id,n,125),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),125,s)},e.prototype.updateXSlant=function(t,e,i,n,r){var o=n.getDetails(),a={};a.slant=r;var s=[];s.push(a),this.doQuickStyleClientAction(o.id,n,129),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),129,s)},e.prototype.updateChartTitle=function(t,e,i,n,r){var o=(n.getDetails(),[]);o.push(r),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),122,o)},e.prototype.updateChartSubTitle=function(t,e,i,n,r){var o=(n.getDetails(),[]);o.push(r),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),123,o)},e.prototype.updateXAxisTitle=function(t,e,i,n,r){var o=(n.getDetails(),[]);o.push(r),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),115,o)},e.prototype.updateYAxisTitle=function(t,e,i,n,r){var o=(n.getDetails(),[]);o.push(r),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),116,o)},e.prototype.updateStaggerLines=function(t,e,i,n,r){var o=n.getDetails(),a={};a.staggerLines=r;var s=[];s.push(a),this.doQuickStyleClientAction(o.id,n,139),c.Server.Action.doQuickStyleAction(t,e,i,n.getChartID(),139,s)},e.prototype.updateTrendlineType=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,137,r)},e.prototype.updateTrendlineDegree=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,138,r)},e.prototype.updateTrendlinePeriod=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,148,r)},e.prototype.updateTooltip=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,106,r),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,106,r)},e.prototype.updateLinemarker=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,147,r),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,147,r)},e.prototype.updateAnimation=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,105,r),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,105,r)},e.prototype.addPlotlines=function(t,e,i,n,r,o){var a=n.getDetails(),s=[];s.push(r),this.doQuickStyleClientAction(a.id,n,140),!o&&c.Server.Action.doQuickStyleAction(t,e,i,a.id,140,s)},e.prototype.addPlotLineName=function(t,e,i,n,r,o){var a=n.getDetails(),s=[];s.push(r),this.doQuickStyleClientAction(a.id,n,134),!o&&c.Server.Action.doQuickStyleAction(t,e,i,a.id,134,s)},e.prototype.removePlotline=function(t,e,i,n,r,o){var a=n.getDetails(),s=[];s.push(r),this.doQuickStyleClientAction(a.id,n,192),!o&&c.Server.Action.doQuickStyleAction(t,e,i,a.id,192,s)},e.prototype.updateMin=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,130),c.Server.Action.doQuickStyleAction(t,e,i,o.id,130,a)},e.prototype.updateAggregation=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),c.Server.Action.doQuickStyleAction(t,e,i,o.id,152,a)},e.prototype.updateFilter=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),c.Server.Action.doQuickStyleAction(t,e,i,o.id,153,a)},e.prototype.updateMultipleYAxis=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),c.Server.Action.doQuickStyleAction(t,e,i,o.id,154,a)},e.prototype.updateAutoExpand=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,145,r),o.length>0&&c.Server.Action.doQuickEditAction(t,e,i,o,145,r)},e.prototype.updateMajor=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,103,r),o.length>0&&c.Server.Action.doQuickEditAction(t,e,i,o,103,r)},e.prototype.updateMinor=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails();o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,104,r),o.length>0&&c.Server.Action.doQuickEditAction(t,e,i,o,104,r)},e.prototype.updateReverse=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,141),c.Server.Action.doQuickStyleAction(t,e,i,o.id,141,a)},e.prototype.updateTitleStyle=function(t,e,i,n,r,o){var a=n.getDetails(),s=[];s.push(r),this.doQuickStyleClientAction(a.id,n,o),c.Server.Action.doQuickStyleAction(t,e,i,a.id,o,s)},e.prototype.updateOpposite=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,146),c.Server.Action.doQuickStyleAction(t,e,i,o.id,146,a)},e.prototype.updateLogarithmic=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,142),c.Server.Action.doQuickStyleAction(t,e,i,o.id,142,a)},e.prototype.updateBaseValue=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,143),c.Server.Action.doQuickStyleAction(t,e,i,o.id,143,a)},e.prototype.updateLabels=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,144),c.Server.Action.doQuickStyleAction(t,e,i,o.id,144,a)},e.prototype.updateFontFamily=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,114),c.Server.Action.doQuickStyleAction(t,e,i,o.id,114,a)},e.prototype.updateCBC=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,108),c.Server.Action.doQuickStyleAction(t,e,i,o.id,108,a)},e.prototype.updatePBC=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,109),c.Server.Action.doQuickStyleAction(t,e,i,o.id,109,a)},e.prototype.updateGC=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,124),c.Server.Action.doQuickStyleAction(t,e,i,o.id,124,a)},e.prototype.updateMax=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,131),c.Server.Action.doQuickStyleAction(t,e,i,o.id,131,a)},e.prototype.updateInterval=function(t,e,i,n,r){var o=n.getDetails(),a=[];a.push(r),this.doQuickStyleClientAction(o.id,n,132),c.Server.Action.doQuickStyleAction(t,e,i,o.id,132,a)},e.prototype.updateDataLabel=function(t,e,i,n,r){var o=[];Object.keys(n).forEach(function(t){var e=n[t],i=e.getDetails(),a=i.type;a!==r&&o.push(i.id)}),this.doQuickEditClientAction(t,e,i,o,102,r),0!==o.length&&c.Server.Action.doQuickEditAction(t,e,i,o,102,r)},e.prototype.updateThemeOnGrid=function(t,e){var i=new c.Utility.ChartAgent,n=e.basecolor,r=e.name,o=e.reversed;"string"==typeof o&&(o="false"==o?!1:!0),"string"==typeof n&&-1!==n.indexOf("[")?JSON.parse(n):n,-1!==r.indexOf(u.COLORFUL)&&i.generateMonochromaticShades(r,!0);var a=c.Utility.getChartMeta([t],!0);a.updateColorScheme(e),this.doQuickStyleClientAction(t,a,133);var s=l.view.getActiveGridID(),d=l.view.getResourceID(s),h=l.view.getVersionID(s),p=l.view.getSheetID(s);if(!t&&(t=c.Utility.getActiveChart()),"object"==typeof t)for(var A in t){var g=t[A];c.Server.Action.doQuickStyleAction(d,p,h,g,133,[{basecolor:n,pallateName:r,isReversed:o}])}else c.Server.Action.doQuickStyleAction(d,p,h,t,133,[{basecolor:n,pallateName:r,isReversed:o}])},e.prototype.reveseColorScheme=function(t,e){var i=l.view.getActiveGridID(),n=l.view.getResourceID(i),r=l.view.getVersionID(i),o=l.view.getSheetID(i),a=l.data.getWorkBook(n,r),s=a.getSheetObj(o),d=s.Charts,h=new c.Utility.ChartAgent;t.forEach(function(t){var i=d.get(t),n=h.clone(i.getStyleOptions().colorTheme,!0),r={basecolor:n.basecolor,name:n.name,reversed:e};this.updateThemeOnGrid(t,r)}.bind(this)),h.reverseMonoColor(e,!0)},e.prototype.updateHighChartsInstance=function(t,e,i,n){if(e)switch(n){case A.CHART:c.Utility.updateChartObject.fn.call(this,e,t.chart);break;case A.XAXIS:c.Utility.updateXAxis.fn.call(this,e,t.xAxis);break;case A.XAXIS_LABELS:c.Utility.updateXAxis.fn.call(this,e,{labels:t.xAxis.labels});break;case A.YAXIS:c.Utility.updateYAxis.fn.call(this,e,t.yAxis);break;case A.TITLE_STYLE:c.Utility.updateTitleStyle.fn.call(this,e,t.title.style);break;case A.CHART_TITLE:c.Utility.updateTitle.fn.call(this,e,t.title.text);break;case A.CHART_SUBTITLE:c.Utility.updateSubTitle.fn.call(this,e,t.subtitle.text);break;case A.XTITLE:c.Utility.updateXTitle.fn.call(this,e,t.xAxis.title.text);break;case A.YTITLE:c.Utility.updateYAxis.fn.call(this,e,t.yAxis);break;default:c.Utility.updateChart.fn.call(this,e,t)}},e.prototype.resetClientActionDone=function(t){var e=(new c.Utility.ChartAgent,l.view.getActiveGridID()),i=l.view.getResourceID(e),n=l.view.getVersionID(e),r=l.view.getSheetID(e),o=l.data.getWorkBook(i,n),a=o.getSheetObj(r),s=a.Charts;for(var d in t){var h=t[d],u=s.get(h);u&&u.getType().toUpperCase()!==f.WORDCLOUD.toUpperCase()&&(u.isClientActionDone=!0)}},e.prototype.doQuickTitleEditAction=function(t,e,i){var n=(new c.Utility.ChartAgent,l.view.getActiveGridID()),r=l.view.getResourceID(n),o=l.view.getVersionID(n),a=l.view.getSheetID(n),s=l.data.getWorkBook(r,o),d=s.getSheetObj(a),h=d.Charts;for(var u in t){var p=t[u],A=h.get(p);if(A){if(A.getType().toUpperCase()===f.WORDCLOUD.toUpperCase())return;var g=A.getInstance();switch(i){case 122:this.updateHighChartsInstance(e,g,A,"chartTitle");break;case 123:this.updateHighChartsInstance(e,g,A,"subTitle");break;case 115:this.updateHighChartsInstance(e,g,A,"xTitle");break;case 116:this.updateHighChartsInstance(e,g,A,"yTitle")}}}},e.prototype.doQuickStyleClientAction=function(t,e,r){var o=this;return new Promise(function(a){var l=[];t&&l.push(t),!t&&(l=c.Utility.getActiveChart());for(var d in l){var h=l[d],u=e;if(u){var p=u.getInstance(),v=new c.Utility.ChartAgent,y=v.clone(u.getOptions(),!0),S=v.clone(u.getDetails(),!0),C=new s.ChartModel(h,S,y.chart,y.colorOptions,y.xAxis,y.yAxis,y.series,y.title,y.subtitle,y.tooltip,y.plotOptions,y.legend,y.credits,S.ts,S.ds,y.isStockChart);C.setSeparatorOptions(),C.init(!1,!0);var f=C.constructChartOptions(),I=f.title.text.length>0?!0:!1,D=f.subtitle.text.length>0?!0:!1,T=S.lf,k=null;switch(f.legend&&(k=v.clone(f.legend.itemStyle,!0)),f=n(f,T),f=i(f,u.getLegendPosition(),I,D,k),f.chart.renderTo=v.getRenderTo(p),f.plotOptions.series.animation=!1,r){case g.SUB_TITLE_STYLE:case g.FONT_FAMILY:case g.LEGEND_STYLE:o.updateHighChartsInstance(f,p,u);break;case g.SLANT:case g.STAGGER_LINES:o.updateHighChartsInstance(f,p,u,A.XAXIS_LABELS);break;case g.PLOT_BACKGROUND_COLOR:case g.BACKGROUND_COLOR:o.updateHighChartsInstance(f,p,u,A.CHART);break;case g.YAXIS_TITLE_STYLE:o.updateHighChartsInstance(f,p,u,A.YAXIS);break;case g.TITLE_STYLE:o.updateHighChartsInstance(f,p,u,A.TITLE_STYLE);break;case g.XAXIS_LABEL_STYLE:case g.XAXIS_TITLE_STYLE:case g.XY_REVERSE:o.updateHighChartsInstance(f,p,u,A.XAXIS);break;case g.GRIDLINE_COLOR:case g.YAXIS_LABEL_STYLE:case g.YAXIS_MIN:case g.YAXIS_MAX:case g.YAXIS_INTERVAL:case g.PLOTLINE_TITLE:case g.PLOTLINE_TITLE_STYLE:case g.PLOTLINE_LABEL_STYLE:case g.ADD_OR_DELETE_PLOTLINE:case g.XY_LOGARITHMIC:case g.XY_BASEVALUE:case g.PLOTLINE_REMOVE:o.updateHighChartsInstance(f,p,u,A.YAXIS);break;case g.XY_LABELS:o.updateHighChartsInstance(f,p,u,A.YAXIS),o.updateHighChartsInstance(f,p,u,A.XAXIS);break;case g.XY_OPPOSITE:o.updateHighChartsInstance(f,p,u,A.YAXIS),o.updateHighChartsInstance(f,p,u,A.XAXIS)}u.setClientUpdated(!0)}}setTimeout(function(){a()},100)})},e.prototype.updateLocale=function(t,e,i,n){for(var r=l.view.getActiveGridID(),o=l.view.getResourceID(r),e=l.view.getVersionID(r),a=l.view.getSheetID(r),d=l.data.getWorkBook(o,e),h=d.getSheetObj(a),u=h.Charts,p=new c.Utility.ChartAgent,A=u.length(),g=0;A>g;g++){var v=u.getKeys(),y=u.get(v[g]);if(y){y.setLocale(n,i);var S=y.getInstance(),C=p.clone(y.getOptions(),!0),f=p.clone(y.getDetails(),!0),I=new s.ChartModel(chartId,f,C.chart,C.colorOptions,C.xAxis,C.yAxis,C.series,C.title,C.subtitle,C.tooltip,C.plotOptions,C.legend,C.credits,f.ts,f.ds,C.isStockChart);I.setSeparatorOptions(),I.init(!1,!0),c.Utility.redraw.fn.call(this,S)}}},e.prototype.updatePlotlineDashStyle=function(t,e,i,n,r){c.Server.Action.doQuickStyleAction(t,e,i,n.getID(),135,[{isYAxis:!0,dashStyle:r.dashStyle,index:r.yIndex,plIndex:r.pIndex}])},e.prototype.updatePlotlineStyle=function(t,e,i,n,r){c.Server.Action.doQuickStyleAction(t,e,i,n.getID(),136,[{isYAxis:!0,style:r.style,index:r.yIndex,plIndex:r.pIndex}])},e.prototype.updatePlotlineColor=function(t,e,i,n,r){c.Server.Action.doQuickStyleAction(t,e,i,n.getID(),135,[{isYAxis:!0,cbc:r.color,index:r.yIndex,plIndex:r.pIndex}])},e.prototype.updateGradient=function(t,e,i,n){var r=n.getGradient();c.Server.Action.doQuickStyleAction(t,e,i,n.getID(),190,[{enabled:r.enabled,sgType:r.sgType||"radial",sgReversed:r.sgReversed||!1,cgType:r.cgType||"radial",cgReversed:r.cgReversed||!1,iab:r.iab||!1,ias:r.ias||!1}])},e.prototype.updateDataLabelStyle=function(t,e,i,n){var r=n.getDataLabelStyle();c.Server.Action.doQuickStyleAction(t,e,i,n.getID(),191,[{style:r}])},c.Manager.ZSCManager=e}(this);
!function(e){function t(){}{var i=e.ZSChart,o=i.Server.Action,n=e.sPlusPlus,r=e.ZSEvents,s=r.topic,c=r.Groups,p=r.Names;i.Constants}t.prototype.place=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),o=n.view.getVersionID(t),s=n.view.getSheetID(t);r.topic.publish(c.Listener,p.SheetAction.CHARTS.PLACE,{RID:i,SHEETID:s,VERSION:o,ID:e})},t.prototype.ResetPosition=function(e,t,i,o){for(var n in o){var r=o[n],s=r.id;s&&this.place(s)}},t.prototype.ResizePosition=function(e,t,o,n){var r=new i.Utility.ChartAgent;for(var s in n){{var c=n[s],p=c.id,a=r.getInstance(e,t,o,p),I=(parseInt(c.sr||a.getStartRowIndex()),parseInt(c.sc||a.getStartColIndex()),c.wd||a.getWidth()),v=c.ht||a.getHeight();c.top||a.getTop(),c.left||a.getLeft()}p&&this.place(p),p&&r.setInstanceSize(e,t,o,p,v,I)}},t.prototype.isImageAction=function(e){return-1!==e.indexOf("img")},t.prototype.focus=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),o=n.view.getVersionID(t),s=n.view.getSheetID(t);r.topic.publish(c.Listener,p.SheetAction.CHARTS.FOCUS,{RID:i,SHEETID:s,VERSION:o,CHARTID:e})},t.prototype.blur=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),o=n.view.getVersionID(t),s=n.view.getSheetID(t);r.topic.publish(c.Listener,p.SheetAction.CHARTS.BLUR,{RID:i,SHEETID:s,VERSION:o,CHARTID:e})},t.prototype.reposition=function(e,t,i,n,r,s,c,p,a,I){o.Reposition(e,t,i,n,r,s,c,p,a,I)},t.prototype.delete=function(e,t,n,r){if(i.Action.closeMenuTab(),"object"==typeof r)for(var a in r){var I=r[a];o.RemoveChart(e,t,n,I)}else o.RemoveChart(e,t,n,r);s.publish(c.UI,p.SidePanel.CHARTS.CLOSE)},t.prototype.resizeChart=function(e,t,i,n,r,s,c,p,a,I,v,u){o.Resize(e,t,i,n,r,s,c,p,a,I,v,u)},i.Manager.ZSCOleManager=t}(this);
!function(e){function t(){}var a=e.ZSChart,n=e.sPlusPlus,r=a.Manager,o=e.ZSEvents,p=o.Groups,i=o.Names,u=o.topic,d=a.Constants.ChartPublishConstant;t.prototype.insertChart=function(e,t,a,n,o){var p=new r.ZSCManager;p.insertChart(e,t,a,n,void 0,void 0,o)},t.prototype.publishOleDelete=function(){var e=n.view.getActiveGridID(),t=n.view.getResourceID(e),a=n.view.getVersionID(e),r=n.view.getSheetID(e);this.publishOleDeleteAction(t,r,a)},t.prototype.updateDataRange=function(e,t,a,n){var o=new r.ZSCManager;o.updateDataRange(e,t,a,n)},t.prototype.deleteChart=function(e,t,a,n){var o=new r.ZSCOleManager;o.delete(e,t,a,n)},t.prototype.doEdit=function(){var e=(a.Manager.SidePanelManager,a.Utility.getActiveChart()[0]);u.publish(p.UI,i.SidePanel.CHARTS.OPEN,{CHART_ID:e})},t.prototype.loadChart=function(e,t,a,n){var o=new r.ZSCManager;o.loadChart(e,t,a,n)},t.prototype.removeSelection=function(){var e=(new r.ZSCOleManager,n.view.getActiveGridID()),t=n.view.getResourceID(e),a=n.view.getVersionID(e),o=n.view.getSheetID(e),d=n.data.getWorkBook(t,a),C=d.getSheetObj(o),l=C.Ole.Chart,g=l.getActive();for(var v in g){{g[v]}u.publish(p.Listener,i.Layers.Ole.Blur,{RID:t,SHEETID:o,VERSION:a,ID:chartDetails.id})}},t.prototype.repositionChart=function(e,t,a,n,o,p,i,u,d,C){var l=new r.ZSCOleManager;l.reposition(e,t,a,n,o,p,i,u,d,C);var g=new r.ZSCManager;g.updateSidePanelMeta(n)},t.prototype.focusChart=function(e,t,n,o){var p=new r.ZSCOleManager,i=new a.Utility.CommanAgent;p.focus(e,t,n,o),i.setActiveChartID(o)},t.prototype.blurChart=function(e,t,n,o){var p=new r.ZSCOleManager,i=new a.Utility.CommanAgent;p.blur(e,t,n,o),i.removeActiveChartID()},t.prototype.updateChart=function(e,t,a,n){var o=new r.ZSCManager;o.updateChart(e,t,a,n)},t.prototype.reRenderChart=function(e,t,a,n){var o=new r.ZSCManager;o.reRenderChart(e,t,a,n)},t.prototype.updateChartOnGrid=function(e,t,a,n){var o=new r.ZSCManager;o.updateChartOnGrid(e,t,a,n)},t.prototype.AddOle=function(e,t,a,n,o,p,i,u){var d=new r.ZSCOleManager;d.AddOle(e,t,a,n,o,p,i,u)},t.prototype.AddContent=function(e,t,a,n,o){var p=new r.ZSCOleManager;p.AddContent(e,t,a,n,o)},t.prototype.updateTheme=function(e){var t=new r.ZSCManager,n=new a.Utility.ChartAgent;t.updateThemeOnGrid(n.getActiveChartID(),e)},t.prototype.reveseColorScheme=function(e){var t=new r.ZSCManager,n=new a.Utility.ChartAgent;t.reveseColorScheme(n.getActiveChartID(),e)},t.prototype.publishChart=function(e,t,a,n,o){var p=new r.ZSCPublishManager;p.doPublishAction({status:d.SHOWURL},n,o)},t.prototype.revertPubishChart=function(){var e=new r.ZSCPublishManager;e.unPublishChart()},t.prototype.updateLegend=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateLegend(e,t,a,n,o)},t.prototype.changeChartType=function(e,t,a,n,o){var p=new r.ZSCManager;p.changeChartType(e,t,a,n,o)},t.prototype.updateDataLabel=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateDataLabel(e,t,a,n,o)},t.prototype.publishOleDeleteAction=function(e,t,a){u.publish(p.Listener,i.Layers.Ole.Delete,{RID:e,SHEETID:t,VERSION:a})},t.prototype.initColoSchemeEvents=function(){var e=new r.ZSCColorManager;e.initEvents()},t.prototype.doPublishAction=function(e,t,a){var n=new r.ZSCPublishManager;n.doPublishAction(e,t,a)},t.prototype.rePaintChartOnGrid=function(e,t,a){var n=new r.ZSCManager;n.rePaintChartOnGrid(e,t,a)},t.prototype.resetLoadedChartProperty=function(e,t,a){var n=new r.ZSCManager;n.resetLoadedChartProperty(e,t,a)},t.prototype.movePosition=function(e,t,a,n){var o=new r.ZSCOleManager;o.ResetPosition(e,t,a,n)},t.prototype.ResizePosition=function(e,t,a,n){var o=new r.ZSCOleManager;o.ResizePosition(e,t,a,n)},t.prototype.deleteOle=function(e,t,a,n){var o=new r.ZSCOleManager;o.deleteOle(e,t,a,n)},t.prototype.doCloneAction=function(e){var t=new r.ZSCManager;t.doClone(e)},t.prototype.saveChartAsImage=function(e){var t=new r.ZSCManager;t.saveChartAsImage(e)},t.prototype.switchChart=function(e){var t=new r.ZSCManager;t.switchChart(e)},t.prototype.doStyleClip=function(e){var t=new r.ZSCCManager;t.performStyleAction(e)},t.prototype.resizeChart=function(e,t,a,n,o,p,i,u,d,C,l,g){var v=new r.ZSCOleManager;v.resizeChart(e,t,a,n,o,p,i,u,d,C,l,g)},t.prototype.resetSize=function(e,t,a,n,o,p){var i=new r.ZSCManager;i.resetSize(e,t,a,n,o,p)},t.prototype.updateLegendStyle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateLegendStyle(e,t,a,n,o)},t.prototype.updateTrendlineType=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateTrendlineType(e,t,a,n,o)},t.prototype.updateTrendlineDegree=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateTrendlineDegree(e,t,a,n,o)},t.prototype.updateTrendlinePeriod=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateTrendlinePeriod(e,t,a,n,o)},t.prototype.updateTooltip=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateTooltip(e,t,a,n,o)},t.prototype.updateAnimation=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateAnimation(e,t,a,n,o)},t.prototype.updateXSlant=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateXSlant(e,t,a,n,o)},t.prototype.updateStaggerLines=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateStaggerLines(e,t,a,n,o)},t.prototype.addPlotLines=function(e,t,a,n,o,p){var i=new r.ZSCManager;i.addPlotlines(e,t,a,n,o,p)},t.prototype.addPlotLineName=function(e,t,a,n,o,p){var i=new r.ZSCManager;i.addPlotLineName(e,t,a,n,o,p)},t.prototype.removePlotline=function(e,t,a,n,o,p){var i=new r.ZSCManager;i.removePlotline(e,t,a,n,o,p)},t.prototype.updateMin=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateMin(e,t,a,n,o)},t.prototype.updateAutoExpand=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateAutoExpand(e,t,a,n,o)},t.prototype.updateMax=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateMax(e,t,a,n,o)},t.prototype.updateInterval=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateInterval(e,t,a,n,o)},t.prototype.updateCBC=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateCBC(e,t,a,n,o)},t.prototype.updatePBC=function(e,t,a,n,o){var p=new r.ZSCManager;p.updatePBC(e,t,a,n,o)},t.prototype.updateGC=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateGC(e,t,a,n,o)},t.prototype.updateMajor=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateMajor(e,t,a,n,o)},t.prototype.updateMinor=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateMinor(e,t,a,n,o)},t.prototype.updateChartTitle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateChartTitle(e,t,a,n,o)},t.prototype.updateChartSubTitle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateChartSubTitle(e,t,a,n,o)},t.prototype.updateXAxisTitle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateXAxisTitle(e,t,a,n,o)},t.prototype.updateYAxisTitle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateYAxisTitle(e,t,a,n,o)},t.prototype.updateReverse=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateReverse(e,t,a,n,o)},t.prototype.updateOpposite=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateOpposite(e,t,a,n,o)},t.prototype.updateLogarithmic=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateLogarithmic(e,t,a,n,o)},t.prototype.updateBaseValue=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateBaseValue(e,t,a,n,o)},t.prototype.updateLabel=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateLabels(e,t,a,n,o)},t.prototype.updateFontFamily=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateFontFamily(e,t,a,n,o)},t.prototype.updateTitleStyle=function(e,t,a,n,o,p){var i=new r.ZSCManager;i.updateTitleStyle(e,t,a,n,o,p)},t.prototype.reLoadChartOnGrid=function(e,t,a){var n=new r.ZSCManager;n.reLoadChartOnGrid(e,t,a)},t.prototype.updateLineMarker=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateLinemarker(e,t,a,n,o)},t.prototype.updateScaleFactor=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateScaleFactor(e,t,a,n,o)},t.prototype.updateBinningInterval=function(e,t){var a=new r.ZSCManager;a.updateBinningInterval(e,t)},t.prototype.setNumberFormat=function(e,t){var a=new r.ZSCManager;a.setNumberFormat(e,t)},t.prototype.doChartCustomization=function(e,t){var a=new r.ZSCManager;a.doChartCustomization(e,t)},t.prototype.updateLocale=function(e,t,a,n){var o=new r.ZSCManager;o.updateLocale(e,t,a,n)},t.prototype.updateAggregation=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateAggregation(e,t,a,n,o)},t.prototype.updateFilter=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateFilter(e,t,a,n,o)},t.prototype.updateMultipleYAxis=function(e,t,a,n,o){var p=new r.ZSCManager;p.updateMultipleYAxis(e,t,a,n,o)},t.prototype.updateGradient=function(e,t,a,n){var o=new r.ZSCManager;o.updateGradient(e,t,a,n)},t.prototype.updatePlotlineStyle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updatePlotlineStyle(e,t,a,n,o)},t.prototype.updatePlotlineColor=function(e,t,a,n,o){var p=new r.ZSCManager;p.updatePlotlineColor(e,t,a,n,o)},t.prototype.updatePlotlineDashStyle=function(e,t,a,n,o){var p=new r.ZSCManager;p.updatePlotlineDashStyle(e,t,a,n,o)},t.prototype.updateDataLabelStyle=function(e,t,a,n){var o=new r.ZSCManager;o.updateDataLabelStyle(e,t,a,n)},t.prototype.addChartToImageLibrary=function(e){var t=n.view.getActiveGridID(),a=n.view.getResourceID(t),o=n.view.getVersionID(t),p=n.view.getSheetID(t),i=new r.ZSCManager;i.addChartToImageLibrary(a,o,p,e)},a.Controller.ZSCController=t}(this);
!function(t,e){function n(){var t=l.view.getActiveGridID(),e=l.view.getResourceID(t),n=l.view.getVersionID(t),i=l.view.getSheetID(t);c.publish(a.Listener,s.SheetAction.CHARTS.REPAINT,{RID:e,SHEETID:i,VERSION:n})}function i(){var e=C.Wrapper.DOMUtils;if(!e.getElementById("DI_CHART_COLOR_SCHEME")){var n=t.UserAction.getTemplate(["chartColorSchemeTemplate"]),i=e.createElement("div");i.id="DI_CHART_COLOR_SCHEME",i.style.display="none",i.classList.add("zSChrtClrPlt"),i.appendChild(n.chartColorSchemeTemplate),e.appendChild(document.body,i),d.initComponent("#DI_CHART_COLOR_SCHEME")}}function o(){i()}var r=t.ZSEvents,a=r.Groups,s=r.Names,c=r.topic,l=(t.ZSConstants.wCC,t.sPlusPlus),C=t.ZSChart,E=C.Controller,h=C.Constants,u=t.ZSConstants.FeatureConstants,p=h.CAConstant,d=t.UIUtil.Component,A=ZSDevTools.Logger,S=C.Constants.MessageConstant,v=(C.Constants.ChartType,C.Constants.CustomEventName),T=C.Constants.CustomEventGroupName;C.Utility.getActiveChart=function(t){var e=l.view.getActiveGridID(),n=l.view.getGridComponent(e),i=n.Chart,o=i.State,r=o.getActive(),a=[];return Object.keys(r).forEach(function(t){r[t]&&a.push(t)}),t?a[0]:a},C.Utility.getSheetCharts=function(){var t=l.view.getActiveGridID(),e=l.view.getResourceID(t),n=l.view.getVersionID(t),i=l.view.getSheetID(t),o=new C.Utility.ChartAgent;return{GRIDID:t,RID:e,SHEETID:i,VERSION:n,CHARTS:o.getAllMetaOfSheet(e,i,n)}},C.Client.Action.onGridShift=function(){var t=C.Utility.getSheetCharts(),e=t.CHARTS;e.forEach(function(e){C.Client.Action.ResetPosition(t.RID,t.SHEETID,t.VERSION,e.getDetails())})},C.Utility.getChartMeta=function(t,e){var n=new C.Utility.ChartAgent,i=[];for(var o in t){var r=t[o],a=n.getChartMeta(r);a&&i.push(a)}return e?i[0]:i},C.Utility.isAllowdToInsertChartInSheet=function(){var t=l.view.getActiveGridID(),e=l.view.getResourceID(t),n=l.view.getVersionID(t),i=l.view.getSheetID(t),o=l.data.getWorkBook(e,n);return o.isEditable()?o.ProtectedSheets.isSheetLocked(i)?S.ERROR.SHEET_LOCKED:S.ALLOWED:S.ERROR.READONLY},C.Action.resetSize=function(t,e,n,i,o,r,a,s,c,l,E,h){try{C.Client.Action.removeBorderAnimation({ID:i}),C.Client.Action.destroyContextualToolbar(),C.Client.Action.resetSize(t,e,n,i,E,h),C.Server.Action.resizeChart(t,e,n,i,o,r,a,s,c,l,E,h)}catch(t){A.log("[CHART] >>>>>> Exception caught while resetting chart size",t)}},C.Action.openMenuTab=function(){C.Client.Action.reArrangeMenuItems(C.Utility.getActiveChart())},C.Action.closeMenuTab=function(){l.view.getViewMenu()},C.Client.Action.setChartState=function(t){var e=l.view.getActiveGridID(),n=l.view.getSheetID(e),i=l.view.getSheetState(e,n),o=new ZSClass.StateChart;i.setChartState(t,o),i.setChartRendered(t,!0)},C.Client.Action.getChartState=function(t){var e=l.view.getActiveGridID(),n=l.view.getSheetID(e),i=l.view.getSheetState(e,n);return i.isChartRendered(t)},C.Client.Action.setLocaleOptions=function(t,n){t&&n&&e.setOptions({lang:{decimalPoint:t,thousandsSep:n}})},C.Client.Action.insertChart=function(t,e,n,i,o){try{{var r=new E.ZSCController;new C.Utility.ChartAgent}r.insertChart(t,e,n,i,o)}catch(t){A.log("[CHART] >>>>>> Exception caught while insert chart ",t)}},C.Client.Action.updateLocale=function(t,e,n,i){try{var o=new E.ZSCController;o.updateLocale(t,e,n,i)}catch(t){A.log("[CHART] >>>>>> Exception caught while updating Locale for Chart ",t)}},C.Client.Action.deleteChart=function(t,e,n,i){try{var o=[];for(var r in i)o.push(i[r].id);c.publish(a.Listener,s.SheetAction.CHARTS.DELETE_LAYER,{RID:t,SHEETID:e,VERSION:n,ACTIVE_CHART_ID:o}),c.publish(a.UI,s.SidePanel.CHARTS.CLOSE)}catch(t){A.log("[CHART] >>>>>> Exception caught while deleting chart ",t)}},C.Client.Action.OverrideHighchartEvents=function(t){function e(e){var n=e,i=n.querySelector(C.Client.Action.getClassMapping(v.CHART_TITLE));i&&(p.addEventByNode(i,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.TITLES,{subAction:1,suffix:""},e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_TITLE})},!0),p.addEventByNode(i,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_TITLE,HOVER:!0})},!0),p.addEventByNode(i,p.Events.MOUSELEAVE,function(){this.style.cursor="auto",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function n(e){var n=e,i=n.querySelector(C.Client.Action.getClassMapping(v.CHART_SUBTITLE));i&&(p.addEventByNode(i,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.TITLES,{subAction:2,suffix:""},e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_SUBTITLE})},!0),p.addEventByNode(i,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_SUBTITLE,HOVER:!0})},!0),p.addEventByNode(i,p.Events.MOUSELEAVE,function(){this.style.cursor="auto",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function i(t){var e=t,n=e.querySelector(C.Client.Action.getClassMapping(v.CHART_PLOT));n&&(p.addEventByNode(n,p.Events.MOUSEOVER,function(){this.style.cursor="pointer"},!0),p.addEventByNode(n,p.Events.MOUSEDOWM,function(){this.style.cursor="inherit"},!0),p.addEventByNode(n,p.Events.MOUSELEAVE,function(){this.style.cursor="pointer"},!0))}function o(e){var n=e,i=n.querySelector(C.Client.Action.getClassMapping(v.CHART_BACKGROUND));i&&(p.addEventByNode(i,p.Events.MOUSEDOWM,function(){this.style.cursor="inherit"},!0),p.addEventByNode(i,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.STYLES,void 0,e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_BACKGROUND})},!0),p.addEventByNode(i,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_BACKGROUND,HOVER:!0})},!0),p.addEventByNode(i,p.Events.MOUSELEAVE,function(){c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t}),this.style.cursor="pointer"},!0))}function r(e){var n=e,i=n.querySelector(C.Client.Action.getClassMapping(v.CHART_XAXIS_LABELS));i&&(p.addEventByNode(i,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.HAXIS,void 0,e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_XAXIS_LABELS})},!0),p.addEventByNode(i.children,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_XAXIS_LABELS,HOVER:!0})},!0),p.addEventByNode(i.children,p.Events.MOUSELEAVE,function(){this.style.cursor="auto",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function l(e){function n(e,n){p.addEventByNode(e,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.VAXIS,{index:n},e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_YAXIS_LABELS,INDEX:n})},!0),p.addEventByNode(e.children,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_YAXIS_LABELS,INDEX:n,HOVER:!0})},!0),p.addEventByNode(e.children,p.Events.MOUSELEAVE,function(){this.style.cursor="auto",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0)}var i=e,o=i.querySelectorAll(C.Client.Action.getClassMapping(v.CHART_YAXIS_LABELS));if(o)for(var r=o.length,l=0;r>l;l++)n(o[l],l)}function E(e){var n=e,i=n.querySelector("div"+C.Client.Action.getClassMapping(v.CHART_XAXIS_TITLE));i&&(p.addEventByNode(i.children,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.TITLES,{subAction:3,suffix:""},e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_XAXIS_TITLE})},!0),p.addEventByNode(i.children,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_XAXIS_TITLE,HOVER:!0})},!0),p.addEventByNode(i.children,p.Events.MOUSELEAVE,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function h(e){function n(e,n){p.addEventByNode(e.children,p.Events.CLICK,function(e){C.Client.Action.applyCustomEvents(S,T.TITLES,{subAction:0==n?4:5,suffix:0==n?"":n},e),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_YAXIS_TITLE,INDEX:n})},!0),p.addEventByNode(e.children,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_YAXIS_TITLE,INDEX:n,HOVER:!0})},!0),p.addEventByNode(e.children,p.Events.MOUSELEAVE,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0)}var i=e,o=i.querySelectorAll("div"+C.Client.Action.getClassMapping(v.CHART_YAXIS_TITLE));if(o)for(var r=o.length,l=0;r>l;l++)n(o[l],l)}function u(e){var n=e,i=n.querySelector(C.Client.Action.getClassMapping(v.CHART_LEGEND));i&&(p.addEventByNode(i,p.Events.MOUSEOVER,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:v.CHART_LEGEND,HOVER:!0})},!0),p.addEventByNode(i,p.Events.MOUSELEAVE,function(){this.style.cursor="pointer",c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}var p=C.Wrapper.DOMUtils,d=new C.Utility.ChartAgent,S=d.getChartMeta(t);if(S){var R=S.getInstance();if(R)for(var g in R){var I=R[g];try{e(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to title")}try{n(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to subtitle")}try{i(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to plot")}try{o(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to canvas")}try{r(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to xLabels")}try{l(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to yLabels")}try{E(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to to xAxis")}try{h(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to yAxis")}try{u(I.container)}catch(t){A.log("[Chart] Exception while adding Custom Events to yAxis")}}}},C.Client.Action.addSynchronization=function(t,e){function n(t){t.chart.events||(t.chart.events={})}function i(t,e){try{{var t=t.target,n=new C.Utility.ChartAgent,i=n.getChartMeta(e),o=i.getInstance(),r=t.index,a=t.series.index;t.series.chart}for(var s in o){var c=o[s],l=c.series[a].points[r];l&&(l.setState("hover",!0),c.tooltip.refresh(c.tooltip.shared?[l]:l))}}catch(t){}}function o(t,e){try{{var t=t.target,n=new C.Utility.ChartAgent,i=n.getChartMeta(e),o=i.getInstance(),r=t.index,a=t.series.index;t.series.chart}for(var s in o){var c=o[s],l=c.series[a].points[r];l&&(l.setState(""),c.hideToolip())}}catch(t){}}function r(t,e,n,i){var o=new C.Utility.ChartAgent,r=o.getChartMeta(i),a=r.getInstance();for(var s in a){var c=a[s],l=c.series[e].data[n];l&&l.slice&&l.slice()}var E=C.Manager.SidePanelManager;E&&E.isPanelOpen()&&(r.addSelectionState(e),C.Client.Action.applyCustomEvents(r,T.SERIES,{sIndex:e,pIndex:n},t))}function l(t,e,n,i){var o=new C.Utility.ChartAgent,r=o.getChartMeta(n);if(C.Utility.isContextMenuAlive())return C.Client.Action.applyCustomEvents(r,T.LEGEND,void 0,i.browserEvent),c.publish(a.UI,s.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:n,evType:v.LEGEND}),!1;var l=r.getInstance(),E=new C.Utility.CommanAgent;for(var h in l){var u=l[h];if(E.isFallUnderCompositionType(r.getType())){var p=u.series[t].data[e];p.setVisible(!p.visible,!1)}else{var d=u.series[t];d.setVisible(!d.visible,!1)}}for(var h in l){var u=l[h];u.redraw()}return!1}function E(e,a){n(e),e.plotOptions[a]||(e.plotOptions[a]={}),e.plotOptions[a].point||(e.plotOptions[a].point={}),e.plotOptions[a].point.events||(e.plotOptions[a].point.events={}),e.plotOptions[a].point.events.mouseOver=function(e){i(e,t)},e.plotOptions[a].point.events.mouseOut=function(e){o(e,t)},e.plotOptions.series||(e.plotOptions.series={}),e.plotOptions.series.point||(e.plotOptions.series.point={}),e.plotOptions.series.events||(e.plotOptions.series.events={}),e.plotOptions.series.cursor="pointer",e.plotOptions.series.point.events||(e.plotOptions.series.point.events={}),e.plotOptions.series.point.events.legendItemClick=function(e){var n=this.series.index,i=this.index;return l(n,i,t,e)},e.plotOptions.series.point.events.click=function(e){var n=this.series?this.series.index:0,i=this.index;r(e,n,i,t)},e.plotOptions.series.events.legendItemClick=function(e){var n=this.index;return l(n,n,t,e)}}var u=e.co,p=e.type;if(p==h.ChartType.COMBOCHART){var d=u.series;for(var A in d){var S=d[A];S&&E(u,S.type)}}else E(u,u.chart.type);return e},C.Client.Action.reArrangeMenuItems=function(t){try{c.publish(a.Listener,s.UserAction.CHARTS.RESET_MENU,{ACTIVE_CHART_ID:t})}catch(t){A.log("[CHART] >>>>>> Exception caught while reArrangeMenuItems ",t)}},C.Client.Action.loadChart=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.loadChart(t,e,n,r.clone(i,!0))}catch(t){A.log("[CHART] >>>>>> Exception caught while loading chart ",t)}},C.Client.Action.focusChart=function(t,e,n,i){try{var o=new E.ZSCController;o.focusChart(t,e,n,i)}catch(t){A.log("[CHART] >>>>>> Exception caught while chart focus ",t)}},C.Client.Action.blurChart=function(t,e,n,i){try{var o=new E.ZSCController;o.blurChart(t,e,n,i)}catch(t){A.log("[CHART] >>>>>> Exception caught while chart blur ",t)}},C.Client.Action.updateChart=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.updateChart(t,e,i,r.clone(n,!0));for(var a=n?n.length:0,s=0;a>s;s++){var c=n[s].id;C.Client.Action.OverrideHighchartEvents(c),C.Client.Action.reApplyCustomHoverSvg()}}catch(t){A.log("[CHART] >>>>>> Exception caught while updating chart ",t)}},C.Client.Action.updateChartOnGrid=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.updateChartOnGrid(t,e,n,r.clone(i,!0))}catch(t){A.log("[CHART] >>>>>> Exception caught while updating chart on grid ",t)}},C.Client.Action.publishChart=function(t,e,n,i,o){try{var r=new E.ZSCController;r.publishChart(t,e,n,i,o)}catch(t){A.log("[CHART] >>>>>> Exception caught on chart Publish ",t)}},C.Client.Action.rePaint=function(t,e,n,i){try{var o=new E.ZSCController;!i&&o.rePaintChartOnGrid(t,e,n),i&&o.reLoadChartOnGrid(t,e,n)}catch(t){A.log("[CHART] >>>>>> Exception caught on chart rePaint ",t)}},C.Client.Action.resetVisited=function(t,e,n){try{var i=new E.ZSCController;i.resetLoadedChartProperty(t,e,n)}catch(t){A.log("[CHART] >>>>>> Exception caught on chart resetVisited ",t)}},C.Client.Action.beforeSheetSwitchAction=function(t,e,n){try{c.publish(a.Listener,s.SheetAction.CHARTS.RESETVISIT,{RID:t,SHEETID:e,VERSION:n}),C.Action.closeMenuTab()}catch(t){}},C.Client.Action.afterSheetSwitchAction=function(t,e,n){try{c.publish(a.Listener,s.SheetAction.CHARTS.REPAINT,{RID:t,SHEETID:e,VERSION:n})}catch(t){}},C.Client.Action.reRenderChart=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.reRenderChart(t,e,i,r.clone(n,!0))}catch(t){A.log("[CHART] >>>>>> Exception caught on chart  RE - RenderChart",t)}},C.Client.Action.ResetPosition=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.movePosition(t,e,n,r.clone(i,!0))}catch(t){A.log("[CHART] >>>>>> Exception caught on reset position ",t)}},C.Client.Action.deleteOle=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.deleteOle(t,e,n,r.clone(i,!0))}catch(t){A.log("[CHART] >>>>>> Exception caught on delete chart layer ",t)}},C.Client.Action.updateDataRange=function(t,e,n,i){try{var o=new E.ZSCController;o.updateDataRange(t,e,n,i)}catch(t){A.log("[CHART] >>>>>> Exception caught on data range update ",t)}},C.Client.Action.resizePosition=function(t,e,n,i){try{var o=new E.ZSCController,r=new C.Utility.ChartAgent;o.ResizePosition(t,e,n,r.clone(i,!0))}catch(t){A.log("[CHART] >>>>>> Exception caught on reset position ",t)}},C.Client.Action.resetSize=function(t,e,n,i,o,r){try{var a=new E.ZSCController;a.resetSize(t,e,n,i,o,r)}catch(t){A.log("[CHART] >>>>>> Exception caught on resizeChart ",t)}},C.Client.Action.updateBoundary=function(t,e,n){try{for(var i=new C.Utility.ChartAgent,o=i.getAllChartID(t,e,n),r=o.length,l=0;r>l;l++){var E=o[l];c.publish(a.Listener,s.SheetAction.CHARTS.PLACE,{RID:t,SHEETID:e,VERSION:n,ID:E})}}catch(t){}},!C.transient&&(C.transient={}),!C.transient.Toolbar&&(C.transient.Toolbar={}),C.transient[p.DEFER_CHART_INIT]=n,C.transient.Toolbar[u.CHART_COLOR_SCHEME]=o}(this,Highcharts);
!function(t){{var r=t.ZSEvents,e=(r.Groups,r.Names,r.topic,t.sPlusPlus,t.ZSChart),n=e.Controller;e.Constants,t.ZSConstants.FeatureConstants}e.Server.Action.repositionChart=function(t,r,e,o,s,C,a,i,l,c){var u=new n.ZSCController;u.repositionChart(t,r,e,o,s,C,a,i,l,c)},e.Server.Action.resizeChart=function(t,r,e,o,s,C,a,i,l,c,u,S){var h=new n.ZSCController;h.resizeChart(t,r,e,o,s,C,a,i,l,c,u,S)},e.Server.Action.deleteChart=function(t,r,e,o){var s=new n.ZSCController;s.deleteChart(t,r,e,o)}}(this);
!function(e){var t=e.ZSEvents,i=t.Groups,n=t.Names,E=e.ZSChart,r=t.topic,S=E.Constants,A=e.ZSConstants.FeatureConstants,R=S.CAConstant;r.register(i.Listener,n.GridAction.WheelXYPaneContainerScroll,E.Client.Action.destroyContextualToolbar),r.register(i.UI,n.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,E.Client.Action.removeRect,"ID"),r.register(i.UI,n.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,E.Client.Action.removeHoverRect,"ID"),r.register(i.UI,n.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,E.Client.Action.applyCustomHoverSvg,"ID","evType","INDEX","HOVER"),r.register(i.UI,n.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,E.Client.Action.initCutomEventProperty,"CONFIG"),r.register(i.UI,n.SidePanel.CHARTS.CUSTOM.EVENTS,E.Client.Action.applyContextualToolbar,"PROPERTIES"),r.register(i.UI,n.Layout.TEMPLATE_LOADED,E.transient.Toolbar[A.CHART_COLOR_SCHEME]),r.register(i.Listener,n.SheetAction.CHARTS.PUBLISH,E.Client.Action.publishChart,"RID","SHEETID","VERSION","CHARTS","AOWNER"),r.register(i.Listener,n.SheetAction.CHARTS.EDIT,E.Client.Action.updateChartOnGrid,"RID","SHEETID","VERSION","CHARTS","AOWNER"),r.register(i.Listener,n.SheetAction.CHARTS.MODIFY,E.Client.Action.reRenderChart,"RID","SHEETID","CHARTS","VERSION","AOWNER"),r.register(i.Listener,n.SheetAction.CHARTS.DELETE,E.Client.Action.deleteChart,"RID","SHEETID","VERSION","CHARTS","AOWNER"),r.register(i.Listener,n.SheetAction.CHARTS.UPDATE,E.Client.Action.updateChart,"RID","SHEETID","CHARTS","VERSION","AOWNER"),r.register(i.Listener,n.SheetAction.CHARTS.RESIZE,E.Client.Action.resizePosition,"RID","SHEETID","VERSION","CHARTS","AOWNER"),r.register(i.Listener,n.SheetAction.CHARTS.MOVE,E.Client.Action.ResetPosition,"RID","SHEETID","VERSION","CHARTS","AOWNER"),r.register(i.UserAction,n.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,E.Client.Action.beforeSheetSwitchAction,"RID","SHEETID","VERSION"),r.register(i.Listener,n.SheetAction.CHARTS.RESETVISIT,E.Client.Action.resetVisited,"RID","SHEETID","VERSION"),r.register(i.Listener,n.SheetAction.CHARTS.REPAINT,E.Client.Action.rePaint,"RID","SHEETID","VERSION","ZOOM"),r.register(i.Listener,n.SheetAction.HIDEROWS.ADD,E.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),r.register(i.Listener,n.SheetAction.HIDEROWS.REMOVE,E.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),r.register(i.Listener,n.SheetAction.HIDECOLS.ADD,E.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),r.register(i.Listener,n.SheetAction.HIDECOLS.REMOVE,E.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),r.register(i.Listener,n.SheetAction.CHARTS.UPDATE_LOCALE,E.Client.Action.updateLocale,"RID","VERSION","THOUSAND_SEPERATOR","DECIMAL_SEPERATOR"),r.register(i.Listener,n.SheetAction.HIDEROWS.ADD,E.Client.Action.onGridShift),r.register(i.Listener,n.SheetAction.HIDEROWS.REMOVE,E.Client.Action.onGridShift),r.register(i.Listener,n.SheetAction.HIDECOLS.REMOVE,E.Client.Action.onGridShift),r.register(i.Listener,n.SheetAction.HIDECOLS.ADD,E.Client.Action.onGridShift),function(){E.transient[R.DEFER_CHART_INIT]()}(E)}(this);
!function(e){function t(){}function i(e,t){for(var i=e.getInstance(),a=i.length,r=[],o=0;a>o;o++){var n=i[o];n=n.refresh(t),n.setPositiveExtreme(!1),r.push(n)}e.setInstance(r)}function a(e){var t=new c.Utility.CommanAgent;return t.isFallUnderCompositionType(e)}function r(e){for(var t in e){var i=e[t],a=i.data;for(var r in a){var o=a[r];o.visible=!0}}return e}function o(e){for(var t in e){var i=e[t];i.visible=!0}return e}var n=e.sPlusPlus,s=e.ZSClass,l=null,d=(e.JSUtill,e.UserAction,e.ZSConstants.I18N),p=e.UIUtil.Component,c=e.ZSChart,g=(c.Constants.ServiceProvider,c.Constants.ChartType),h=c.Constants,u=h.ColorSchemeType,v=c.Constants.ChartRangePickerType,y=e.ZSDevTools.Logger,f=e.ZSEvents,A=(f.Groups,f.Names,f.topic,e.ZSEC);t.prototype.init=function(){this.previewOn=!0,this.state="ADD",this.prevChartType="COL",this.dialogMeta={},this.currentChartType="COL",this.UNPROCESSEDTASK={},this.chartId="preview",this.responseObj=null,this.id=["preview"],this.taskType="recommendation",this.tabName="General",this.activeId="preview",this.activeRecommendationID=null,this.allowPostProcess=!0,this.sidePanelState=!1},t.prototype.getDialogMeta=function(e){return this.dialogMeta[e]},t.prototype.setSidePanelState=function(e){this.sidePanelState=e},t.prototype.getSidePanelState=function(){return this.sidePanelState},t.prototype.getPreviousChartType=function(){return this.prevChartType},t.prototype.setPreviousChartType=function(e){this.prevChartType="BUBBLE"===e?"BUBBLECHART":e},t.prototype.setSelectedChartType=function(e){this.prevChartType=this.currentChartType=e},t.prototype.stopPostProcess=function(){this.allowPostProcess=!1},t.prototype.enablePostProcess=function(){this.allowPostProcess=!0},t.prototype.isPostProcessAllowed=function(){return this.allowPostProcess},t.prototype.changeType=function(e,t){var i=this.dialogMeta[t||this.chartId];this.prevChartType=e,i&&i.setType(e)},t.prototype.updateRequiredProperty=function(e,t){var i=this.dialogMeta[t]||this.dialogMeta.preview;i.dLables=e.dLables},t.prototype.isPreviewOn=function(){return this.previewOn},t.prototype.setPreviewStatus=function(e){this.previewOn=e},t.prototype.setResposne=function(e){this.responseObj=e},t.prototype.clearResposne=function(){this.responseObj=null},t.prototype.processPreviewResponse=function(e){var t=c.Wrapper.DOMUtils,i={display:"table-cell"};t.addStyle("preview",i),this.setResposne(e),this.doPreprocess(!0),this.doPostProcess(!0),this.clearDom(!1),this.clearResposne()},t.prototype.populateFilterColumnsIfNeeded=function(e,t,i){var a=this.dialogMeta[e];if(a){var r=c.Aggregation.checkIfOperationIsValueManipulative(t),o=c.Aggregation.checkIfOperationIsValueManipulative(i);if(r!==o){a.setAggregationOperation(i);var n=new c.Utility.AgentDom;return n.rePopulateFilterColumns(a),setTimeout(function(){n.setFilterColumnBasedOnInput(a)},200),!0}return!1}},t.prototype.processRecommendationResponse=function(e){for(var t=e,i=0;i<t.length;i++){var a=t[i];if(a.co){var r;i&&(r=this.chartId+i),i&&this.id.push(r),a.co.chart.renderTo=r}}this.addUnProcessTask(this.taskType,this.doRecommendationTask.bind(this),t,{startIndex:1,isShift:!0}),setTimeout(function(){this.checkToPerformUnProcessedTask()}.bind(this),10)},t.prototype.processResponse=function(e){this.setResposne(e),this.clearDom(),this.doPreprocess(),this.doPostProcess(),this.clearResposne()},t.prototype.setActiveId=function(e){this.activeId=e},t.prototype.getActiveId=function(){return this.activeId},t.prototype.resetIDs=function(){this.id=["preview"]},t.prototype.doPreprocess=function(e){this.enablePostProcess(),this.resetIDs();var t=new c.Utility.AgentDom;t.hideRecommendationDOM();for(var i=this.responseObj,a=0;a<i.length;a++){var r,o=i[a];a&&(r=this.chartId+a),!a&&(r=this.chartId),a&&this.addUnProcessTask(this.taskType,this.doRecommendationTask.bind(this),i,{startIndex:a,isShift:!0}),a&&this.id.push(r),o.co&&o.co.chart&&(o.co.chart.renderTo=r)}var n=new c.Utility.ChartAgent,s=n.isArray(i);!s&&!e&&this.alertInvalidRecommendation();var l=s?i[0]:i;try{!s&&(l.co.chart.renderTo=this.chartId),e&&!s&&(l.isMutedUpdate=e),this.setActiveId(this.chartId),!e&&this.grabProperty(l,this.sidePanelState),e&&this.updateRequriedProperty(l),e&&this.updateGroupingStates(l),this.setSelectedChartType(l.type),this.sidePanelState||this.updateDialog()}catch(e){y.log("[CHART] Chart DialogMeta Throwing exception while redering chart in dialog",e),this.alertForInvalidCase(l),this.stopPostProcess(!0)}},t.prototype.generateAlertMessage=function(e){var t,i=-1!==e.type.indexOf(g.BUBBLE.toUpperCase())?2:4,a=d.Bubble,r="";switch(e.type){case"CANDLESTICK":a=d.CandleStick;break;case"OHLC":a=d.OHLC;break;case"TIMELINE":a=d["Chart.Time.Line"];break;case"TIMEAREA":a=d["Chart.Time.Area"];break;case"WATERFALL":a=d["Chart.Type.Waterfall"];break;case"COMBOCHART":a=d["Chart.Type.Combo"]}e.isPivotChart?(r=JSUtil.fn.replaceParams(d["PivotChart.Not.Allowed"],new Array(a)),t=d["Alert.Title.InvalidChartType"]):(r=JSUtil.fn.replaceParams(d["Chart.Preview.Not.Allowed"],new Array(a,i)),t=d["Alert.Title.InvalidSourceRange"]);var o={msg:r,titleKey:t};return o},t.prototype.alertForInvalidCase=function(e){var t,i=e.reason,a="",r=i.ice,o=i.iad;if(r&&(a=JSUtil.fn.replaceParams(d["Chart.Cells.Count.Exceeded"],new Array("3000"))),r&&(t=d["Alert.Title.LimitExceeded"]),!r&&!o){var n=this.generateAlertMessage(i);a=n.msg,t=n.titleKey}var l=c.Wrapper.DOMUtils;s.ZSAlert(a,{title:t}),l.hideById("chartRecommend"),l.hideById("chartRecommendTitle")},t.prototype.updateRequriedProperty=function(e){if(e){var t=this.dialogMeta[this.activeId];t&&t.setExtractOptions(e),t&&t.extractYAxisProperty(),t&&t.extractXAxisProperty(),t&&t.constructStyleProperty()}},t.prototype.doPostProcess=function(){var e,t=this.getResponse();l=new c.Utility.ChartAgent;var i=c.Wrapper.DOMUtils,a=l.isArray(t);if(e=a?t[0]:t,this.isPostProcessAllowed()&&!this.getSidePanelState()){var r=i.getElementByClassName("chrtPreview");r.setAttribute("id","preview"),this.renderChart(e),this.doNoDataFoundAction(e),this.updateCurrentTabName()}else if(this.isPostProcessAllowed()&&this.getSidePanelState()){this.insertChart(e);var i=(new c.Utility.AgentDom,c.Wrapper.DOMUtils),o=c.Manager.SidePanelManager;o.setUnProcessed(this.UNPROCESSEDTASK)}},t.prototype.updateDialog=function(){var e=(new c.Utility.ChartAgent,this.getActiveId()),t=this.dialogMeta[e],i=new c.Utility.AgentDom;i.updateDialog(t),this.hideUnwantedProperty(e)},t.prototype.updateRequiredDialogProperty=function(e,t){var i=new c.Utility.AgentDom;i.generatePlotline(e.yAxis,t||0)},t.prototype.hideUnwantedProperty=function(e,t){var i=this.dialogMeta[e],a=new c.Utility.AgentDom;a.hidePropertyBasedOnMeta(i,!this.sidePanelState,t)},t.prototype.PROCESSTASK=function(e){var t,i=this.UNPROCESSEDTASK[e];if(i)for(var a in i){t=i[a];var r=t.parameters,o=t.optional;try{t.fn(r,o)}catch(e){y.log("[CHART] Chart DialogMeta PROCESSTASK Throwing exception while redering chart in dialog",e)}}delete this.UNPROCESSEDTASK[e]},t.prototype.trimChartData=function(e){var t=Math.min(10,e.co.series.length);e.co.series=e.co.series.splice(0,t);for(var i=0;t>i;i++){var a=Math.min(50,e.co.series[i].data.length);e.co.series[i].data=e.co.series[i].data.splice(0,a)}return e},t.prototype.renderRecommendation=function(e,t){var i=e.shift();if(i&&i.co){var a=new c.Utility.AgentDom;a.showRecommendationDOM(),i=this.trimChartData(i),this.recommendChart(i,t,this).then(function(){this.renderRecommendation(e,++t)}.bind(this))}this.setRecommedationSelection()},t.prototype.renderChart=function(e){this.loadPreview(e)},t.prototype.recommendChart=function(e,t,i){return new Promise(function(a){var r,o,n,s,l=c.Wrapper.DOMUtils,d=e,p=i.getSidePanelState()?"recWrapper1":"recWrapper",g=l.getElementById("chrtTypeWrapper");s={class:p,"border-color":"rgb(25, 175, 92)",width:"50px",height:"50px"};{var h=g.querySelector("#recommendChartPreview");l.addChild("chartWrapperDiv",h,s)}o=i.id[t]?i.id[t]:i.id[0]+t,n=d.type,s={class:"recChartDiv",id:o,style:"height : inherit;width:inherit;","data-id":o},r=l.addChildByIndex("chartDiv",p,s,t-1),s={class:"recChartName",id:"tooltip"+t,"data-id":o};var u=l.addChildByIndex("chartNameDiv",p,s,t-1);u.addEventListener("click",function(e){e.stopPropagation(),i.getSidePanelState()?(i.unSelectRecommendation(),i.selectRecommendedChart(o),i.updateChart(o)):i.renderToPreview(o)},!1),r.addEventListener("click",function(e){e.stopPropagation(),i.getSidePanelState()?(i.unSelectRecommendation(),i.selectRecommendedChart(o),i.updateChart(o)):i.renderToPreview(o)},!1),u.innerText=i.getChartNameByChartCode(n),i.grabProperty(e),e.isMutedUpdate=!0,e=i.removeUnwantedProperties(e),i.renderChart(e),setTimeout(function(){a()},10)})},t.prototype.alertInvalidRecommendation=function(){var e=c.Wrapper.DOMUtils;e.showById("chartRecAlert1"),e.hideById("generalChartType")},t.prototype.doRecommendationTask=function(e,t){this.clearRecommendationDom(),this.resetIDs();var i=(c.Wrapper.DOMUtils,[]);e.length&&(i=e),!e.length&&i.push(e);var a=new c.Utility.AgentDom;a.hideRecommendationDOM();var r=1|t.startIndex,o=t.isShift|!1;try{o&&i.shift(),this.renderRecommendation(i,r)}catch(e){a.hideRecommendationDOM(),y.log("[CHART] Chart DialogMeta doRecommendationTask Throwing exception while redering chart in dialog",e),this.alertInvalidRecommendation()}},t.prototype.addUnProcessTask=function(e,t,i,a){if(!this.UNPROCESSEDTASK[e]){this.UNPROCESSEDTASK[e]=[];var r={};r.fn=t,r.parameters=i,r.optional=a,this.UNPROCESSEDTASK[e].push(r)}},t.prototype.processUnProcessTask=function(e){e&&-1!==e.indexOf("recommendation")&&(this.PROCESSTASK(e),this.clearResposne())},t.prototype.clearRecommendationDom=function(){var e=c.Wrapper.DOMUtils,t=e.getElementById("chartRecommend");e.hideById("chartRecAlert1"),e.showById("generalChartType"),t&&(t.innerHTML=""),e.addChild("wrapper","chartRecommend",{id:"recommendChartPreview"})},t.prototype.getTabName=function(){return this.tabName},t.prototype.setUnProcessed=function(e){this.UNPROCESSEDTASK=e},t.prototype.checkToPerformUnProcessedTask=function(){var e=-1!==this.getTabName().indexOf("General");e&&this.processUnProcessTask(this.taskType)},t.prototype.updateCurrentTabName=function(){var e=c.Wrapper.DOMUtils,t=e.getActiveElement("chrtTabList","active"),i=t.textContent;this.tabName=i},t.prototype.getResponse=function(){return this.responseObj},t.prototype.updateGroupingStates=function(e){var t=this.dialogMeta[this.chartId];t&&t.updateGroupingStates(e)},t.prototype.grabProperty=function(e,t){var i=new c.Model.DialogMeta,a=t?this.getActiveId():e.co.chart.renderTo;i.constructPropertyFromObject(e),this.addMetaObject(a,i)},t.prototype.grabPropertyForChartID=function(e,t){var i=new c.Model.DialogMeta;i.constructPropertyFromObject(e),this.addMetaObject(t,i)},t.prototype.addMetaObject=function(e,t){this.dialogMeta[e]=t},t.prototype.getMetaObject=function(e){return y.log("Requesting meta for chart Id >>>>> ",e),this.dialogMeta[e]},t.prototype.getState=function(){return this.state},t.prototype.setState=function(e){this.state=e},t.prototype.getDialogTitle=function(){return-1!==this.getState().indexOf("ADD")?d.AddChart:d.EditChart},t.prototype.clearCatch=function(){this.init(),this.clearDom(!0)},t.prototype.clearDom=function(e){var t=c.Wrapper.DOMUtils,i=t.getElementById("preview"),a=t.getElementById("chartRecommend");e&&i&&(i.innerHTML=""),e&&a&&(a.innerHTML="")},t.prototype.loadPreview=function(t){var i=e.ZSChart;l=new i.Utility.ChartAgent;var a=l.isArray(t),r=null;a&&t.forEach(function(e){r=t.co.chart.renderTo||this.chartId,this.createPreview(this.chartId+e,t)}),!a&&(r=t.co.chart.renderTo||this.chartId)&&this.createPreview(r,t)},t.prototype.createPreview=function(e,t){var i=null,a=t.isMutedUpdate||!1;!a&&this.grabProperty(t),i=c.Action.createPreview(e,t);var r=this.dialogMeta[e];r.setInstance(i)},t.prototype.doNoDataFoundAction=function(e){var t=c.Wrapper.DOMUtils,i=t.getElementById("preview"),a=new c.Utility.CommanAgent;try{var r=i.getElementsByClassName("chrtNoDta")[0];i.removeChild(r)}catch(e){}try{var o=!a.isAllowToDraw(e);o&&o.Exception.throw}catch(e){var r=t.getElementByClassName("chrtNoDta"),n=r.cloneNode(!0);n.style.zIndex=1e4,n.style.display="block",t.appendChild(i,n)}},t.prototype.updateTitleByRange=function(e,t){function i(e){var i=n.view.getActiveGridID(),a=n.view.getResourceID(i),s=n.view.getVersionID(i),l=JSUtil.Range.parseRange(a,s,t),d=l.range.startRow,p=l.range.startCol;r(e[d][p].DisplayValue,this),o(t,this)}function a(){r(t,this),o(t,this)}function r(t,i){switch(e){case v.CHART_TITLE:i.updateTitle("preview",t);break;case v.CHART_SUBTITLE:i.updateSubTitle("preview",t);break;case v.CHART_X_AXIES:i.updateXTitle("preview",t,0);break;case v.CHART_Y_AXIES:i.updateYTitle("preview",t);break;case v.SP_TITLE_TEXT:default:var a=(new c.Utility.ChartAgent,c.Manager.SidePanelManager),r=p.zcombo("#chartTitleCombo","getValue");if("CHART_TITLE"===r)i.updateTitle(a.getActiveChartID(),t);else if("CHART_SUBTITLE"===r)i.updateSubTitle(a.getActiveChartID(),t);else if("CHART_X_AXIES"===r)i.updateXTitle(a.getActiveChartID(),t,0);else if("LA"===r||-1!==r.indexOf("RA")){var o="LA"===r?0:r.substring(r.length-1,r.length);i.updateYTitle(a.getActiveChartID(),t,o)}}}function o(t,i){var a=c.Manager.SidePanelManager,r=i.dialogMeta[i.chartId]||i.dialogMeta[a.getActiveChartID()];if(r)switch(e){case v.CHART_TITLE:r.setTitle(t);break;case v.CHART_SUBTITLE:r.setSubTitle(t);break;case v.CHART_X_AXIES:r.updateXTitle(t,0);break;case v.CHART_Y_AXIES:r.updateYTitleRange(t,i.getActiveYAxisIndex("preview"));break;case v.SP_TITLE_TEXT:default:var o=(new c.Utility.ChartAgent,a.getActiveChartID()),n=p.zcombo("#chartTitleCombo","getValue");"CHART_TITLE"===n?r.setTitle(t):"CHART_SUBTITLE"===n?r.setSubTitle(t):"CHART_X_AXIES"===n?r.updateXTitle(t,0):"LA"===n&&r.updateYTitle(t,0),i.setInTitleJson(o,n,t)}}{var s=new c.Utility.ChartAgent,l=new c.Utility.CommanAgent;l.getRangePicker(v.SP_TITLE_TEXT)}s.getCellValue(t,i.bind(this),a.bind(this))},t.prototype.removeUnwantedProperties=function(e){var t=e.co;if(e.legendPos=0,e.lf="N",t.title.text="",t.tooltip.enabled=!1,t.plotOptions.series.animation=!1,t.legend.enabled=!1,t.plotOptions.series.showInLegend=!1,t.plotOptions.series.dataLabels&&(t.plotOptions.series.dataLabels.enabled=!1),t.xAxis&&(t.xAxis.lineWidth=0,t.xAxis.tickLength=0,t.xAxis.labels.enabled=!1,t.chart.zoomType="none"),t.yAxis)for(var i=0;i<t.yAxis.length;i++)t.yAxis[i].labels&&(t.yAxis[i].labels.enabled=!1),t.yAxis[i].gridLineWidth&&(t.yAxis[i].gridLineWidth=0);return t.plotOptions.series.allowPointSelect=!1,e},t.prototype.refreshByMeta=function(e){var t=new c.Utility.ChartAgent,i=new c.Utility.CommanAgent,a=t.clone(e.getDetails(),!0),r=t.clone(e.getOptions(),!0),o=r.title.text.length>0?!0:!1,n=r.subtitle.text.length>0?!0:!1,s={legend:i.getLegendUpdate(a.legendPos,o,n)};return t.merge({},r,s,!0),a.co=r,new Promise(function(e){this.grabProperty(a,!0),this.refreshOptions(a),setTimeout(function(){e(this)}.bind(this),100)}.bind(this)).then(function(e){e.processPreviewResponse(a)})},t.prototype.refreshByMetaForSidePanel=function(e,t){var i=new c.Utility.ChartAgent,a=new c.Utility.CommanAgent,r=i.clone(e.getDetails(),!0),o=i.clone(e.getOptions(),!0),n=o.title.text.length>0?!0:!1,s=o.subtitle.text.length>0?!0:!1,l={legend:a.getLegendUpdate(r.legendPos,n,s)};i.merge({},o,l,!0),r.co=o,this.grabPropertyForChartID(r,t)},t.prototype.refreshOptions=function(e){return e.wd=e.co.chart.width=450,e.ht=e.co.chart.height=390,e.co.chart.renderTo=this.chartId,e.isMutedUpdate=!0,e.co.series=a(e.type)?r(e.co.series):o(e.co.series),e.co.plotOptions[e.co.chart.type].showInLegend=e.co.legend.enabled,e.co=this.setDefaultLegendItemStylesOrElse(e.co),e},t.prototype.setDefaultLegendItemStylesOrElse=function(e){var t=new c.Utility.CommanAgent,i=e.legend;return i=t.setDefaultLegendItemStylesOrElse(i),e},t.prototype.renderToPreview=function(e){var t=this.dialogMeta[e];this.changeType(t.getType()),this.updateRequiredProperty(t),this.createRequest("CHART_PREVIEW")},t.prototype.updateChart=function(e){var t=c.Utility.getActiveChart()[0],i=this.dialogMeta[e];this.changeType(i.getType()),this.updateRequiredProperty(i,t);var a=new c.Utility.ChartAgent,r=new c.Utility.CommanAgent,o=this.dialogMeta[t]||this.dialogMeta.preview,s=o.getRange(),l=new c.Model.DialogMeta;o.merge(l,o,i,!1);var d=l.getRange();l.setChartID(t),this.mergeDialogMetaWithChartMeta(e,l);var p=this.getRequestObject(l,"edit"),g=n.view.getActiveGridID(),h=n.view.getResourceID(g),u=n.view.getVersionID(g),v=n.view.getSheetID(g);c.Server.Action.updateChartOnGrid(h,v,u,p);var y=a.isUniqueValue(s,d),f=c.Manager.SidePanelManager;y&&(f.TABEL_DEFINATION=!0),c.Aggregation.resetAggregationDom(l.getSeriesIn()),r.resetSidePanel();var A=c.DecTable.getRangeDecTableMap(s);!f.TABEL_DEFINATION&&c.DecTable.populateFilterColumns(l,A)},t.prototype.setRecommedationSelection=function(){var e=c.Wrapper.DOMUtils,t=c.Manager.SidePanelManager,i=t.getActiveChartID()[0],a=this.dialogMeta[i];if(a){Object.keys(this.dialogMeta).forEach(function(t){e.getElementById(t)&&(e.getElementById(t).parentElement.style.borderColor="#d4d4d4")});var r=a.getType(),o=a.getRange();Object.keys(this.dialogMeta).forEach(function(t){if("preview"!==t&&-1!==t.indexOf("preview")){var i=this.dialogMeta[t],a=i.getType(),n=i.getRange(),s=r==a&&n==o,l=e.getElementById(t);s&&l&&(l.parentElement.style.borderColor="#01975B"),s&&i.setRecommendationSelection(!0),!s&&l&&(l.parentElement.style.borderColor="#d4d4d4"),s&&i.setRecommendationSelection(!1)}}.bind(this))}},t.prototype.unSelectRecommendation=function(){var e=c.Wrapper.DOMUtils;Object.keys(this.dialogMeta).forEach(function(t){t.startsWith("preview")&&e.getElementById(t)&&(e.getElementById(t).parentElement.style.borderColor="#d4d4d4")})},t.prototype.checkIfArraysAreNotSame=function(e,t){if(e.length!==t.length)return!1;for(var i in e)if(e[i]!==t[i])return!1;return!0},t.prototype.selectRecommendedChart=function(e){var t=c.Wrapper.DOMUtils,i=this.dialogMeta[e];if(i){var a=i.getType(),r=i.getRange(),o=i.getAggregationColHeaders(),n=this;Object.keys(this.dialogMeta).forEach(function(e){if("preview"!=e){var i=this.dialogMeta[e],s=i.getType(),l=i.getRange(),d=i.getAggregationColHeaders(),p=a==s&&l==r&&n.checkIfArraysAreNotSame(o,d),c=t.getElementById(e);p&&c&&(c.parentElement.style.borderColor="#01975B"),p&&i.setRecommendationSelection(!0),!p&&c&&(c.parentElement.style.borderColor="#d4d4d4"),p&&i.setRecommendationSelection(!1)}}.bind(this))}},t.prototype.getChartNameByChartCode=function(e){var t;switch(e){case"COL":t=d["Chart.Type.Column"];break;case"BAR":t=d.Bar;break;case"STACKEDCOL":t=d.StackedColumn;break;case"STACKEDBAR":t=d.StackedBar;break;case"XYSTACKEDAREA":t=d.StackedArea;break;case"XYLINE":t=d.Line;break;case"SCATTER":t=d.Scatter;break;case"BUBBLE":t=d.Bubble;break;case"PIE":t=d.Pie;break;case"COMBOCHART":t=d["Chart.Type.Combo"];break;default:t=e}return t},t.prototype.updateTooltip=function(e,t){var i=this.dialogMeta[e];i.setTooltip(t);var a=i.getInstance();a&&a.updateTooltip(t)},t.prototype.updateZoom=function(e,t){var i=this.dialogMeta[e];i.setZoom(t);var a=i.getInstance();a&&a.updateZoom(t)},t.prototype.updateAnimation=function(e,t){var i=this.dialogMeta[e];i.setAnimation(t);var a=i.getInstance();a&&a.updateAnimation(t)},t.prototype.updateAutoExpand=function(e,t){var i=this.dialogMeta[e];i.setExpand(t)},t.prototype.updateHiddenCell=function(e,t){var i=this.dialogMeta[e];i.setHiddenCells(t),this.createRequest("CHART_PREVIEW")},t.prototype.updateChartGradientStatus=function(e,t){var i=this.dialogMeta[e];i.setChartGradientStatus(t)},t.prototype.updateSeriesGradientStatus=function(e,t){var i=this.dialogMeta[e];i.setSeriesGradientStatus(t)},t.prototype.updateGradientType=function(e,t){var i=this.dialogMeta[e];i.updateGradientType(t);var a=new c.Utility.AgentDom;a.updateGradientStatus(i)},t.prototype.updateGradientReverse=function(e,t){var i=this.dialogMeta[e];i.updateGradientReverse(t);var a=new c.Utility.AgentDom;a.updateGradientStatus(i)},t.prototype.updateGradientScope=function(e,t){var i=this.dialogMeta[e];i.updateGradientScope(t);var a=new c.Utility.AgentDom;a.updateGradientStatus(i)},t.prototype.updateHiddenCellForSP=function(e,t){var i=this.dialogMeta[e];if(i){i.setHiddenCells(t);var a=this.getRequestObject(i,"edit"),r=n.view.getActiveGridID(),o=n.view.getResourceID(r),s=n.view.getVersionID(r),l=n.view.getSheetID(r);c.Server.Action.updateChartOnGrid(o,l,s,a),c.Action.doRecommendation(i,!0)}},t.prototype.createRequest=function(e){var t=new c.Utility.ChartAgent;-1!==e.indexOf("CHART_PREVIEW")&&this.createPreviewRequest(t.getActiveChartIDForSP()),-1!==e.indexOf("CHART_NEW")&&this.createNewRequest(),-1!==e.indexOf("CHART_EDIT")&&this.createEditRequest()},t.prototype.updateSeriesIn=function(e,t,i){var a=t?"ROWS":i?"COLS":null;if(a){var r=this.dialogMeta[e];r.setSeriesIn(a),this.createRequest("CHART_PREVIEW"),c.Action.doRecommendation(r,!1)}},t.prototype.updateSeriesInForSP=function(e,t,i){var a=t?"ROWS":i?"COLS":null;if(a){var r=this.dialogMeta[e];r.setSeriesIn(a),this.resetAggregation(e,!1),c.Aggregation.resetAggregation(a),this.resetFilter(e,!1);var o=new c.Utility.AgentDom;o.resetFilterIfNeeded(),c.Aggregation.enableLabelCheckBox(a),this.mergeDialogMetaWithChartMeta(e,r);var s=this.getRequestObject(r,"edit"),l=n.view.getActiveGridID(),d=n.view.getResourceID(l),p=n.view.getVersionID(l),g=n.view.getSheetID(l);c.Server.Action.updateChartOnGrid(d,g,p,s)}},t.prototype.updateDataRange=function(e,t){var i=this.dialogMeta[e];if(i){var a=i.setRange(t);a&&this.createRequest("CHART_PREVIEW"),a&&c.Action.doRecommendation(i,!1)}},t.prototype.updateFirstRowAsLabel=function(e,t){var i=this.dialogMeta[e];i.setFirstRowAsLabel(t),this.createRequest("CHART_PREVIEW"),c.Action.doRecommendation(i,!1)},t.prototype.updateFirstColumnAsLabel=function(e,t){var i=this.dialogMeta[e];i.setFirstColumnAsLabel(t),this.createRequest("CHART_PREVIEW"),c.Action.doRecommendation(i,!1)},t.prototype.updateFirstColumnAsLabelForSP=function(e,t){var i=this.dialogMeta[e];i.setFirstColumnAsLabel(t);var a=this.getRequestObject(i,"edit"),r=n.view.getActiveGridID(),o=n.view.getResourceID(r),s=n.view.getVersionID(r),l=n.view.getSheetID(r);c.Server.Action.updateChartOnGrid(o,l,s,a),c.Action.doRecommendation(i,!0)},t.prototype.updateFirstRowAsLabelForSP=function(e,t){var i=this.dialogMeta[e];i.setFirstRowAsLabel(t);var a=this.getRequestObject(i,"edit"),r=n.view.getActiveGridID(),o=n.view.getResourceID(r),s=n.view.getVersionID(r),l=n.view.getSheetID(r);c.Server.Action.updateChartOnGrid(o,l,s,a),c.Action.doRecommendation(i,!0)},t.prototype.updateTitle=function(e,t){if(e)for(var a=e.length,r=0;a>r;r++){var o=e[r],n=this.dialogMeta[o];if(!n)return;n.isChartTitleValueChanged(t);var s=n.setTitle(t);n.updateOptionByTitle(t);{var l=n.getUpdateOptions();n.getInstance()}if(!s){var d=new c.Manager.ZSCManager;d.doQuickTitleEditAction(e,l,122),d.resetClientActionDone(e)}s&&i.call(this,n,l)}},t.prototype.updateFontFamily=function(e,t){var i=this.dialogMeta[e];i&&i.updateFontFamily(t.style)},t.prototype.updateTitleStyle=function(e,t,i){var a=this.dialogMeta[e];a&&a.updateTitleStyle(t,i)},t.prototype.updateChartColor=function(e,t){var i=this.dialogMeta[e];i&&i.updateChartColor(t)},t.prototype.updateTitleForSp=function(e,t){var i=c.Wrapper.DOMUtils,a=this.dialogMeta[e];if(a){var r=a.getTitleJsonForSP(t),o=a.getTitleStyleJsonForSP(t),n=i.getElementById("titleTextBox");n.value=r||"";var s=new c.Utility.AgentDom;o&&s.updateTitleStyle(o)}},t.prototype.setInTitleJson=function(e,t,i){var a=(c.Wrapper.DOMUtils,this.dialogMeta[e]);a&&a.addTitleJsonForSP(t,i)},t.prototype.updateSubTitle=function(e,t){if(e)for(var a=e.length,r=0;a>r;r++){var o=e[r],n=this.dialogMeta[o];if(!n)return;n.isSubTitleValueChanged(t);var s=n.setSubTitle(t);n.updateOptionBySubtitle(t);var l=n.getUpdateOptions(),d=n.getInstance();if(!s){var a=d.length,p=new c.Manager.ZSCManager;p.doQuickTitleEditAction(e,l,123),p.resetClientActionDone(e)}s&&i.call(this,n,l)}},t.prototype.updateXTitle=function(e,t,i){if(e)for(var a=e.length,r=0;a>r;r++){var o=e[r],n=this.dialogMeta[o];if(!n)return;n.isXTitleValueChanged(t,i||0),n.updateXTitle(t,i||0);var s=n.getUpdateOptions();s.xAxis.title.text=t;var l=new c.Manager.ZSCManager;l.doQuickTitleEditAction(e,s,115),l.resetClientActionDone(e)}},t.prototype.updateYTitle=function(e,t,i){if(e)for(var a=e.length,r=0;a>r;r++){var o=e[r],n=this.dialogMeta[o];if(!n)return;n.isYTitleValueChanged(t,i),n.updateYTitle(t,i);var s=n.getUpdateOptions();s.yAxis[i].title.text=t;var l=new c.Manager.ZSCManager;l.doQuickTitleEditAction(e,s,116),l.resetClientActionDone(e)}},t.prototype.updateLegend=function(e,t){var i=this.dialogMeta[e];i.updateLegend(t);var a=i.getLegendUpdate(),r=i.getInstance();r&&r.updateChart(a)},t.prototype.updateXAxiesLabelStyle=function(e,t){var i=this.dialogMeta[e];i.updateXLabelStyle(t)},t.prototype.updateYAxiesLabelStyle=function(e,t,i){var a=this.dialogMeta[e];a.updateYLabelStyle(t,i)},t.prototype.updateXLabel=function(e,t){var i=this.dialogMeta[e];i.updateXLabel(t);var a=i.getXLabelUpdate(),r=i.getInstance();r&&r.updateXAxis(a)},t.prototype.updateXSlant=function(e,t){var i=this.dialogMeta[e];i.updateXSlant(t);var a=i.getXSlantUpdate(),r=i.getInstance();r&&r.updateXAxis(a)},t.prototype.updateXStagger=function(e,t){var i=this.dialogMeta[e];i.updateXStagger(t);var a=i.getXStaggerUpdate(),r=i.getInstance();r&&r.updateXAxis(a)},t.prototype.updateTrendtype=function(e,t){var i=this.dialogMeta[e],a=i.updateTrendtype(t);if(a)return void this.createPreviewRequest("preview");var r=i.getTrendUpdate(),o=i.getInstance();o&&this.hideUnwantedProperty(this.activeId),o&&(o=o.refresh(r)),o&&o.setPositiveExtreme(!1),i.setInstance(o)},t.prototype.setTrendline=function(e,t){var i=this.dialogMeta[e];i.setTrendline(t),i.updateTrendtype(t?{value:"Linear"}:{value:"None"}),p.zcombo("#trendlineType","setValue","linear")},t.prototype.updateTrendDegree=function(e,t){var i=this.dialogMeta[e],a=(i.updateTrendDegree(t),i.getTrendUpdate(),i.getInstance());a&&this.hideUnwantedProperty(this.activeId)},t.prototype.updateCombinedWay=function(e,t){var i=this.dialogMeta[e];i.setCombinedWay(t.value),this.createPreviewRequest("preview"),c.Action.doRecommendation(i,!1)},t.prototype.updateCombinedRange=function(e,t){var i=this.dialogMeta[e];if(i){i.setCombinedWay(t),this.resetAggregation(e,!1),this.resetFilter(e,!1),this.mergeDialogMetaWithChartMeta(e,i);var a=i.getSeriesIn();c.Aggregation.resetAggregation(a);var r=new c.Utility.AgentDom;r.resetFilterIfNeeded();var o=this.getRequestObject(i,"edit"),s=n.view.getActiveGridID(),l=n.view.getResourceID(s),d=n.view.getVersionID(s),p=n.view.getSheetID(s);c.Server.Action.updateChartOnGrid(l,p,d,o)}},t.prototype.updateDataRangeForSP=function(e,t){var i=this.dialogMeta[e];if(i){var a=i.setRange(t);if(a){var r=c.DecTable.validateAggregationHeaders(i);"COLS"===i.getSeriesIn()&&i.updateAggregation("colheaders",r.join(";")),"ROWS"===i.getSeriesIn()&&i.updateAggregation("rowheaders",r.join(";")),i=this.mergeDialogMetaWithChartMeta(e,i);var o=this.getRequestObject(i,"edit"),s=n.view.getActiveGridID(),l=n.view.getResourceID(s),d=n.view.getVersionID(s),p=n.view.getSheetID(s);c.Server.Action.updateChartOnGrid(l,p,d,o)}}},t.prototype.mergeDialogMetaWithChartMeta=function(e,t){var i=new c.Utility.ChartAgent,a=i.getActiveChartMeta()[0];return a?(t.top=a.getTop(),t.left=a.getLeft(),t.sRow=a.getStartRowIndex(),t.sCol=a.getStartColIndex(),t.sColDiff=a.getStartColDiff(),t.sRowDiff=a.getStartRowDiff(),t.width=a.getWidth(),t.height=a.getHeight(),t):t},t.prototype.updateDataLabels=function(e,t){var i=this.dialogMeta[e];i.updateDataLabels(t);var a=i.getDataLabelsUpdate(),r=i.getInstance();r&&r.updateDataLabels(a)},t.prototype.updateYLabel=function(e,t,i){var a=this.dialogMeta[e];a.updateYLabel(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},t.prototype.updateYReverse=function(e,t,i){var a=this.dialogMeta[e];a.updateYReverse(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},t.prototype.updateYLogarithmic=function(e,t,i){var a=this.dialogMeta[e];a.updateYLogarithmic(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},t.prototype.updateYBaseValue=function(e,t,i){var a=this.dialogMeta[e];a.updateYBaseValue(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},t.prototype.updateXReverse=function(e,t,i){var a=this.dialogMeta[e];a.updateXReverse(t,i);var r=a.getXAxis(),o=a.getInstance();o&&o.updateXAxis(r)},t.prototype.updateYOpposite=function(e,t,i){var a=this.dialogMeta[e];a.updateYOpposite(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},t.prototype.updateXReverse=function(e,t,i){var a=this.dialogMeta[e];a.updateXReverse(t,i);var r=a.getXAxis(),o=a.getInstance();o&&o.updateXAxis(r)},t.prototype.updateMultiYAxies=function(e,t){var i=this.dialogMeta[e];i.setYAxisState(t),i.updateNoOfYAxies(),this.createPreviewRequest(e)},t.prototype.updateMultiYAxiesForSP=function(e,t){var i=this.dialogMeta[e];i.setYAxisState(t),i.updateNoOfYAxies();var a=n.view.getActiveGridID(),r=n.view.getResourceID(a),o=n.view.getVersionID(a),s=n.view.getSheetID(a),l={isSingleYAxis:t},d=c.Utility.getChartMeta([e],!0),g=new c.Controller.ZSCController;g.updateMultipleYAxis(r,s,o,d,l);var h=new c.Utility.AgentDom;if(h.hidePropertyBasedOnMeta(i,!1),!t){p.zcombo("#yaxisMulti","setValue","LA"),p.zcombo("#chartTitleCombo","setValue","CHART_TITLE"),c.Utility.changeTitleCombo();var u=i.getYAxis()[0];h.updateYAxiesRelativeByAxiesObjectSP(u,0)}},t.prototype.updateTitleIndex=function(e,t){var i=this.dialogMeta[e];if(i){var a=0;-1!==t.indexOf("RA")&&(a=t.substring(t.length-1,t.length)),i.setActiveTitleIndex(a)}},t.prototype.getActiveTitleIndex=function(e){var t=this.dialogMeta[e];return t.getActiveTitleIndex()},t.prototype.getActiveYAxisIndex=function(e){var t=this.dialogMeta[e];return t.getActiveYIndex()},t.prototype.getYAxiesByIndex=function(e,t){var i=this.dialogMeta[e];return i.getYAxis()[t]},t.prototype.updateScaleFactor=function(e,t,i){var a=c.Constants.ConversionType,r=this.dialogMeta[e];r.updateScaleFactor(t,i),r.updateConversionType(a.SCALES,i);var o=new c.Controller.ZSCController;o.updateScaleFactor([e],t,r.getUnitFactor(i),i,r.getConversionType(i))},t.prototype.updateUnitFactor=function(e,t,i){var a=c.Constants.ConversionType,r=this.dialogMeta[e];r.updateUnitFactor(t,i),r.updateConversionType(a.UNITS,i);var o=new c.Controller.ZSCController;o.updateScaleFactor([e],r.getScaleFactor(i),t,i,r.getConversionType(i))},t.prototype.updateBinningInterval=function(e,t){var i=this.dialogMeta[e],a={};a.interval=t,i.updateBinning(a);var r=new c.Controller.ZSCController;r.updateBinningInterval([e],t)},t.prototype.setNumberFormat=function(e,t){var i=this.dialogMeta[e];i.updateNumberFormat(t);var a=new c.Controller.ZSCController;a.setNumberFormat([e],{nfCode:t.nfCode,prefix:t.prefix,suffix:t.suffix,index:t.yIndex})},t.prototype.updateMultiYAxiesDom=function(e,t){var i=this.dialogMeta[e],a=new c.Utility.AgentDom;a.updateYAxiesRelative(i,t)},t.prototype.removeYPlotline=function(e,t,i){var a=this.dialogMeta[e],r=a.removeYPlotline(t,i),o=a.getInstance();o&&o.removeYPlotLine(r,t)},t.prototype.removeAllPlotLine=function(e,t){var i=this.dialogMeta[e];i.removeAllPlotLine(t)},t.prototype.getTitleStyle=function(e,t,i){if(t)for(var a=0;a<t.length;a++){var r=t[a],o=this.dialogMeta[r];if("CHART_TITLE"===e)return o.getChartTitleStyle();if("CHART_SUBTITLE"===e)return o.getChartSubTitleStyle();if("CHART_X_AXIES"===e)return o.getChartXAxisTitleStyle();if("LA"===e||-1!==e.indexOf("RA")){var n="undefined"==typeof i?o.getActiveTitleIndex():i;return o.getChartYAxisTitleStyle(n)}}},t.prototype.getSubAction=function(e){return"CHART_TITLE"===e?119:"CHART_SUBTITLE"===e?120:"CHART_X_AXIES"===e?117:"LA"===e||-1!==e.indexOf("RA")?118:void 0},t.prototype.addPlotLine=function(e){var t=this.dialogMeta[e],i=c.Wrapper.DOMUtils,a=(t.getYAxis(),t.getActiveYIndex(),i.getElementById("plotLineWrapper")),r=a?a.children.length:1,o=new c.Utility.AgentDom;o.createPlotLineDom(r);var n=a?a.children.length:1;(r>=3||n>=3)&&o.hideAddButton()},t.prototype.updateYPlotline=function(e,t,i,a){var r=this.dialogMeta[e];r.updateYPlotline(t,i,a);var o=r.getYPlotlineUpdate(i,a),n=r.getInstance();n&&n.updateYPlotLine(o,i,a)},t.prototype.updateYPlotlineName=function(e,t,i,a){var r=this.dialogMeta[e];r.updateYPlotlineName(t,i,a);var o=r.getYPlotlineUpdate(i,a),n=r.getInstance();n&&n.updateYPlotLine(o,i,a)},t.prototype.updateYMin=function(e,t,i){var a=this.dialogMeta[e];a.updateYMin(t,i),t=""==t?null:t;var r=a.getInstance();r&&r.updateMin(t,i)},t.prototype.updateYMax=function(e,t,i){var a=this.dialogMeta[e];a.updateYMax(t,i),t=""==t?null:t;var r=a.getInstance();r&&r.updateMax(t,i)},t.prototype.updateYMajorGrid=function(e,t,i){var a=this.dialogMeta[e];a.updateYMajor(t,i);var r=a.getInstance();t&&r&&r.addYMajorGrid(i),!t&&r&&r.removeYMajorGrid(i)},t.prototype.updateYMinorGrid=function(e,t,i){var a=this.dialogMeta[e];a.updateYMinor(t,i);var r=a.getInstance();t&&r&&r.addYMinorGrid(i),!t&&r&&r.removeYMinorGrid(i)},t.prototype.updateYInterval=function(e,t,i){var a=this.dialogMeta[e];a.updateYInterval(t,i),t=""==t?null:t;var r=a.getInstance();r&&r.updateInterval(t,i)},t.prototype.updateThreshold=function(e,t){var i=this.dialogMeta[e];i.updateThreshold(t),t=""==t?null:+parseFloat(t);var a=i.getInstance(),r=i.getThresholdUpdate();a&&(a=a.refresh(r)),a&&a.setPositiveExtreme(!1),i.setInstance(a)},t.prototype.updateTheme=function(e,t,a){if(e)for(var r=0;r<e.length;r++){var o=e[r],n=new c.Utility.ChartAgent,s=t.basecolor,l=t.name,d=t.reversed;"string"==typeof s&&-1!==s.indexOf("[")?JSON.parse(s):s,-1!==l.indexOf(u.COLORFUL)&&n.generateMonochromaticShades(l,-1!==o.indexOf("preview"));var p=this.dialogMeta[o];p.updateTheme(s,l,d);{var g=p.getThemeUpdate(s,l,d);p.getInstance()}this.updateColorSchemeDom(p.getStyleObject()),a&&i.call(this,p,g)}},t.prototype.createPreviewRequest=function(e){if(this.isPreviewOn()){var t=this.dialogMeta[e],i=this.getRequestObject(t,"preview"),a=n.view.getActiveGridID(),r=n.view.getResourceID(a),o=n.view.getVersionID(a),s=n.view.getSheetID(a);c.Server.Action.updatePreview(r,s,o,i,this.processPreviewResponse.bind(this))}},t.prototype.createNewRequest=function(e){var t=this.dialogMeta[e||this.activeId],i=this.getRequestObject(t,"new"),a=n.view.getActiveGridID(),r=n.view.getResourceID(a),o=n.view.getVersionID(a),s=n.view.getSheetID(a);c.Server.Action.updateChartOnGrid(r,s,o,i)},t.prototype.createEditRequest=function(e){var t=this.dialogMeta[e||this.activeId],i=this.getRequestObject(t,"edit"),a=n.view.getActiveGridID(),r=n.view.getResourceID(a),o=n.view.getVersionID(a),s=n.view.getSheetID(a);c.Server.Action.updateChartOnGrid(r,s,o,i)},t.prototype.getRequestObject=function(e,t){var i=new c.Utility.ChartAgent;return i.getRequestObject(e,t)},t.prototype.getActiveMeta=function(){return this.dialogMeta[this.activeId]},t.prototype.updateColorSchemeDom=function(e){var t=new c.Utility.AgentDom;t.resetColorDOMProperty(e,!0)},t.prototype.reveseColorScheme=function(e,t){var i=this.dialogMeta[e],a=i.getStyleObject(),r=a.colorObject.colorTheme;r.reversed=t,this.updateTheme(e,r);var o=new c.Utility.ChartAgent;o.reverseMonoColor(t,!0)},t.prototype.updateFilterMeta=function(e,t,i){var a=this.dialogMeta[e];a&&(a.setFilterLimit(i),a.setFilterType(t))},t.prototype.updateFilter=function(e,t,i,a){var r=this.dialogMeta[e];if(r&&(r.updateFilter(t,i),a)){var o=n.view.getActiveGridID(),s=n.view.getResourceID(o),l=n.view.getVersionID(o),d=n.view.getSheetID(o),p={filter:r.getFilter()},g=c.Utility.getChartMeta([e],!0),h=new c.Controller.ZSCController;h.updateFilter(s,d,l,g,p)}},t.prototype.getIsYAxisForReverse=function(e,t){var i=this.dialogMeta[e];return i?(-1!==i.getType().indexOf("BAR")&&(t=!t),t):t},t.prototype.resetFilter=function(e,t){var i=this.dialogMeta[e];if(i&&(i.resetFilter(),t)){var a=n.view.getActiveGridID(),r=n.view.getResourceID(a),o=n.view.getVersionID(a),s=n.view.getSheetID(a),l={filter:i.getFilter()},d=c.Utility.getChartMeta([e],!0),p=new c.Controller.ZSCController;p.updateFilter(r,s,o,d,l)}},t.prototype.resetAggregation=function(e,t){var i=this.dialogMeta[e];if(i&&i.getAggregationEnabled()){var a=i.getAggregationOperation(),r={};if(r.type="NONE",r.colheaders=void 0,r.rowheaders=void 0,r.enabled=!1,r.dateOperations=void 0,Object.keys(r).forEach(function(e){i.updateAggregation(e,r[e])}),t){var o=n.view.getActiveGridID(),s=n.view.getResourceID(o),l=n.view.getVersionID(o),d=n.view.getSheetID(o),p={aggregation:i.getAggregation()},g=new c.Controller.ZSCController,h=c.Utility.getChartMeta([e],!0);g.updateAggregation(s,d,l,h,p),this.populateFilterColumnsIfNeeded(e,a,"NONE")}}},t.prototype.updateAggregation=function(e,t,i){var a=this.dialogMeta[e],r=c.Manager.SidePanelManager;if(a){var o=!1,s=!1;if(r.setCurrentActionOwner(),Object.keys(t).forEach(function(e){o="type"===e,a.updateAggregation(e,t[e]),s=s?s:"colheaders"===e||"dateOperations"===e}),s&&a.udpateAggregationHeaderMap(t),i){var l=n.view.getActiveGridID(),d=n.view.getResourceID(l),p=n.view.getVersionID(l),g=n.view.getSheetID(l),h={aggregation:a.getAggregation()},u=new c.Controller.ZSCController,v=c.Utility.getChartMeta([e],!0);u.updateAggregation(d,g,p,v,h)}}},t.prototype.updateSeriesCustomization=function(e){var t=this.dialogMeta[e.cID];t&&t.updateSeriesCustomization(e)},t.prototype.updateTitleText=function(e){var t=new c.Utility.ChartAgent,i=p.zcombo("#chartTitleCombo","getValue"),a=c.Manager.SidePanelManager,r=a.getActiveChartID();r&&r.forEach(function(a){var r=this.dialogMeta[a];if(r.isTitleValueChanged()){switch(i){case"CHART_TITLE":t.updateChartTitle(e);break;case"CHART_SUBTITLE":t.updateChartSubTitle(e);break;case"CHART_X_AXIES":t.updateXAxisTitle(e);break;default:var o="LA"===i?0:i.substring(i.length-1,i.length);t.updateYAxisTitle(e,o)}this.setInTitleJson(a,i,e)}}.bind(this))},t.prototype.isFilterRequestNeeded=function(e,t){var i=!0,a=this.dialogMeta[e];if("type"===t){var r="noFilter"!==p.zcombo("#filterColumns","getValue")?a.getFilterColumn():"noFilter",o=a.getFilterLimit()||-1==a.getFilterLimit()?p.zspinner("#filterSpinner","getValue"):a.getFilterLimit();i=r&&"noFilter"!==r&&0!==o}else if("limit"===t){var r="noFilter"!==p.zcombo("#filterColumns","getValue")?a.getFilterColumn():"noFilter",n="NONE"==a.getFilterType()?p.zcombo("#filterType","getValue"):a.getFilterType();i=r&&n&&"noFilter"!==r&&"NONE"!==n}else{var o=a.getFilterLimit()||a.getFilterLimit()<=0?p.zspinner("#filterSpinner","getValue"):a.getFilterLimit(),n="NONE"==a.getFilterType()?p.zcombo("#filterType","getValue"):a.getFilterType();i=o&&n&&o>0&&"NONE"!==n}return i},t.prototype.updateClientTitleText=function(e,t){var i=p.zcombo("#chartTitleCombo","getValue");if(t=A?A.Encoder.encodeForHTML(t):t,"CHART_TITLE"===i)this.updateTitle(e,t);else if("CHART_SUBTITLE"===i)this.updateSubTitle(e,t);else if("CHART_X_AXIES"===i)this.updateXTitle(e,t,0);else if("LA"===i||-1!==i.indexOf("RA")){var a="LA"===i?0:i.substring(i.length-1,i.length);this.updateYTitle(e,t,a)}},t.prototype.updateTextInInstance=function(e,t){var i=e.getUpdateOptions(),a=new c.Utility.ChartAgent;i=a.addChartBoundary(i,e.getDetails()),i=a.applySeriesColorToPlotLines(i),i=cia.applySeriesColorToAxis(i),i.plotOptions.series.animation=!1;for(var r=0;r<t.length;r++){var o=t[r];o&&o.renderTo&&(o=o.refresh(i),t[r]=o)}e.setInstance(t)},c.Model.Dialog=t}(this);
!function(e){var t=(e.sPlusPlus,e.ZSClass,e.UserAction,e.ZSChart);!t.Aggregation&&(t.Aggregation={});{var a=(t.Constants.ChartType,t.Constants.ServiceType,e.JSUtil,t.Constants.ChartRangePickerType,e.UIUtil.Component),r=e.ZSEvents;r.Groups,r.Names,r.topic}t.Aggregation.getLastIndex=function(){var e=t.Wrapper.DOMUtils,a=e.getElementsByClassName("depthHeadersCombo"),r=a[a.length-2].id,n=r.substring(r.length-1,r.length);return parseInt(n)+1},t.Aggregation.constructNewcombo=function(r){var n=t.Wrapper.DOMUtils,o=e.UserAction.getTemplate(["aggregationholderTemplate"]),g=o.aggregationholderTemplate,i=[r],l=g.cloneNode(!0),d=l.children[0].children[2],s=l.children[0].children[1],c=n.getElementById("aggregationTemplate");n.appendChild(c,l);var p=s.children[0];p.id="chartAggCombo"+r;var h=s.children[1].children[0];h.id="chartAggDate"+r;var m=s.children[1];n.addClass(m,"dateFilters"+r);var u=d;u.attributes.index.nodeValue=r,a.initComponent(p),a.initComponent(h),a.zcombo("#chartAggDate"+r,"setValue","NONE"),t.Aggregation.bindEvents(i)},t.Aggregation.bindEvents=function(e){var a=t.Manager.SidePanelManager;a.bindAggregationEvents(e)},t.Aggregation.getOptionsAndLoadInCombo=function(e,a){var r=t.Aggregation.getNewComboList("ADD",null,a),n=t.Wrapper.DOMUtils,o=n.getElementById("chartAggCombo"+e);t.Aggregation.loadComboListInCombo(o,r,e)},t.Aggregation.selectedElementClicked=function(){var e=t.Wrapper.DOMUtils;e.addAttributes("chartAggCombo0",{childClicked:!0})},t.Aggregation.aggregationComboChanged=function(e,a,r,n){t.Aggregation.disableLabelCheckBox(a,r,n)},t.Aggregation.loadComboListInCombo=function(e,r,n){var o=t.Wrapper.DOMUtils,g="combo"+n+"_choose",i=o.createElement("option",{id:g,value:"choose"});if(o.getElementById("choose").innerText="Select",r.length>0)for(var l=0;l<r.length;l++){var d=r[l].headerRange,s=r[l].type,c=r[l].label,p=c.replace(/ /g,""),h=r[l].displayValue,m=r[l].rangeIdx;"DATE"!==s&&"DATETIME"!==s&&(i=o.createElement("option",{header:c,type:s,id:"combo"+n+"_"+p,value:d,range:m})),("DATE"===s||"DATETIME"===s)&&(i=o.createElement("option",{header:c,type:s,id:"combo"+n+"_"+p,value:d,range:m,class:"aggDateElement"})),o.appendChild(e,i),o.getElementById("combo"+n+"_"+p).innerText=h}a.zcombo(e,"refresh")},t.Aggregation.getTotalHeaders=function(){return t.Utility.getTotalHeaders()},t.Aggregation.comboList=function(e,a){for(var r=t.Model.ChartDecTable,n=r.getDepthIndices()||[],o=[],g=0;g<n.length;g++)for(var i=0;i<n[g].length&&20>i;i++){var l=a?n[g][i].headerRange:n[g][i].headerRange;if(-1==e.indexOf(l)){var d={};d.rangeIdx=g,d.headerValue=l,d.type=n[g][i].type,d.label=n[g][i].headerLabel,d.displayValue=n[g][i].headerValue,d.headerRange=n[g][i].headerRange,o.push(d)}}return o},t.Aggregation.getNewComboList=function(e,a,r){var n=t.Wrapper.DOMUtils,o=[],g=(n.getElementsByClassName("depthHeadersCombo"),[]);return o=this.comboList(g,r)},t.Aggregation.getNewCombo=function(){var e=t.Wrapper.DOMUtils,a=this.getNewComboList("ADD",null,label),r=e.createElement("select",{style:"'width:94px'",id:"combo"+idx}),n=e.findNodeByClassName(elem,"depthHeaders");e.appendChild(n,r);var o=e.findNodeByElementType(n,"SELECT")[0];this.loadComboListInCombo(o,a,idx,!0,!0)},t.Aggregation.createNewCombo=function(){var e=t.Wrapper.DOMUtils,a=e.createElement("div",{class:"aggHldr"}),r=e.getElementById("aggregationTemplate");e.appendChild(a,e.createElement("div",{class:"aggMove"})),e.appendChild(a,e.createElement("div",{class:"depthHeaders"})),e.appendChild(a,e.createElement("span",{class:"aggclose"}));var n=this;e.addEventByNode(e.getElementByClassName("aggclose"),"click",function(e){n.deleteDepthHeader(e.target)}),e.appendChild(r,a);var o=e.getElementsByClassName("aggHldr").size-1;this.getNewCombo(o,idx);var g=[];return g.push(o),getComboElem(0)},t.Aggregation.getHeaderLabelFromHeaderRange=function(e){for(var a=t.Model.ChartDecTable.getDepthIndices(),r=0;r<a.length;r++)for(var n=0;n<a[r].length;n++){var o=a[r][n];if(e=e.replace(/\'/g,""),-1!==e.indexOf(o.headerRange))return o.headerLabel.replace(/ /g,"")}return null},t.Aggregation.renderDateOperationTemplate=function(e){e.stopPropagation()},t.Aggregation.loadOptionsListInCombo=function(e,r){var n=t.Wrapper.DOMUtils;n.getElementById("chartAggCombo"+r)&&(n.getElementById("chartAggCombo"+r).innerHTML="");for(var o="NONE",g="",i=0;i<e.length;i++)for(var l=e[i],d=0;d<l.length;d++){var s=l[d],c=s.headerLabel,p=c.replace(/ /g,"");o="combo"+r+"_"+p;var h=s.headerValue||s.headerLabel;g=n.createElement("option",{id:o,value:s.headerRange,header:s.headerLabel,type:s.type,displayValue:h}),g.innerText=s.headerValue||s.headerLabel,n.appendChild(n.getElementById("chartAggCombo"+r),g)}a.zcombo("#chartAggCombo"+r,"refresh"),a.zcombo("#chartAggCombo"+r,"setValue","Choose")},t.Aggregation.disableLabelCheckBox=function(e){var a=t.Wrapper.DOMUtils,r="COLS"===e?"firstColumn":"firstRow";a.getElementById(r).disabled="disabled"},t.Aggregation.enableLabelCheckBox=function(){var e=t.Wrapper.DOMUtils;e.getElementById("firstColumn").disabled="",e.getElementById("firstRow").disabled=""},t.Aggregation.getDateOperations=function(e,t,a){var r=e||["NONE","NONE","NONE"];return"undefined"!=typeof t&&(r[t]="NONE"!==a?"DATE-"+a:a),r},t.Aggregation.spliceDateOperations=function(e,t){var a=e||["NONE","NONE","NONE"];return"undefined"!=typeof t&&a.splice(t,1),a.push("NONE"),a},t.Aggregation.resetAggregation=function(e){var r=t.Wrapper.DOMUtils;a.select2("#chartAggCombo0",void 0,"reset");var n=r.getElementById("aggDateMenu");a.zmenu(n,"hide"),a.zcombo("#aggreoperation","setValue","NONE"),t.Aggregation.enableLabelCheckBox(e)},t.Aggregation.resetAggregationDom=function(e){var r=t.Wrapper.DOMUtils;a.select2("#chartAggCombo0",void 0,"reset");var n=r.getElementById("aggDateMenu");a.zmenu(n,"hide"),a.zcombo("#aggreoperation","setValue","NONE"),t.Aggregation.enableLabelCheckBox(e)},t.Aggregation.getTypeFromValue=function(e){for(var a=t.Model.ChartDecTable.getDecTable()||[],r=0;r<a.length;r++)for(var n=Object.keys(a[r])||[],o=0;o<n.length;o++){o=parseInt(o);var g=n[o],i=a[r][g];if(i.headerRange===e)return i.type}return e},t.Aggregation.getDisplayLabelFromDateOperation=function(e){var t={};return t.YEAR="Year",t.QUARTER="Quarter",t.MONTH="Month",t.DAY="Day",t.DAY_OF_WEEK="Day of Week",t.QUARTER_BY_YEAR="Quarter by Year",t.MONTH_BY_YEAR="Month by Year",t[e]},t.Aggregation.setSelectedState=function(e){var a=t.Wrapper.DOMUtils;null!=a.getElementById(e)&&a.addClass(a.getElementById(e),"selectedState")},t.Aggregation.resetSelectedState=function(){var e=t.Wrapper.DOMUtils;if(null!=e.getElementById("aggDateUl"))for(var a=e.getElementById("aggDateUl").children,r=0;r<a.length;r++)e.removeClass(a[r],"selectedState")},t.Aggregation.checkIfOperationIsValueManipulative=function(e){var t=["SUM","AVERAGE","MIN","MAX","MEDIAN","NONE"];return-1!==t.indexOf(e)},t.Aggregation.checkIfOperationIsCountRelated=function(e){var t=["COUNT"];return-1!==t.indexOf(e)}}(this);
!function(e){function t(){this.initDecTable()}function a(e,t){for(var a=t.getDepthIndices(),n=0;n<a.length;n++)for(var r=a[n],l=Object.keys(r),o=0;o<l.length;o++){var i=l[o];if(null!=r[i]&&-1!==r[i].headerRange.indexOf(e))return"combo0_"+r[i].headerLabel.replace(/\s/g,"")}}function n(e){return e&&(e=e.replace(/'/g,"")),e&&d[e]?d[e]:null}function r(){d={}}function l(e){e&&(e=e.replace(/'/g,"")),e&&d[e]&&delete d[e]}var o=e.sPlusPlus,i=(e.ZSClass,e.JSUtill,e.UserAction,e.ZSConstants.I18N),g=e.UIUtil.Component,s=e.ZSEvents,c=s.Groups,p=s.Names,b=s.topic,h=e.ZSChart;!h.DecTable&&(h.DecTable={});var u=(h.Constants.ServiceProvider,h.Constants.ChartType,h.Constants),d=(u.ColorSchemeType,h.Constants.ChartRangePickerType,e.ZSDevTools.Logger,{});t.prototype.initDecTable=function(){this.decTableResponse=null,this.splitRanges=null,this.decTable=null,this.depthArray=null,this.rangeStr=null},t.prototype.setSeriesIn=function(e){this.seriesIn=e},t.prototype.getSeriesIn=function(){return this.seriesIn},t.prototype.setDepthIndices=function(e){this.depthArray=e},t.prototype.getDepthIndices=function(){return this.depthArray},t.prototype.setSplitRanges=function(e){this.splitRanges=e},t.prototype.getSplitRanges=function(){return this.splitRanges},t.prototype.setDecTable=function(e){this.decTable=e},t.prototype.getDecTable=function(){return this.decTable},t.prototype.setDecTableResponse=function(e){this.decTableResponse=e},t.prototype.getDecTableResponse=function(){return this.decTableResponse},t.prototype.setRangeString=function(e){this.rangeStr=e},t.prototype.getRangeString=function(){return this.rangeStr},h.DecTable.processSplitRange=function(e){for(var t=[],a=e.getDecTableResponse(),n=0;n<a.length;n++)for(var r=null!=a[n]?Object.keys(a[n]):[],l=a[n],o=0;o<r.length;o++)if("splitRanges"===r[o])for(var i=l[r[o]],g=i.rangeData.headers,s=g?Object.keys(g):[],c=0;c<s.length;c++)t.push(g[s[c]]);e.setSplitRanges(t)},h.DecTable.initializeRangeMap=function(e){if(e=e.replace(/'/g,""),d[e])return d[e];var t=new h.Model.ChartDecTable;return d[e]=t,t.setRangeString(e),t},h.DecTable.getDecTableInstance=function(e){return d&&d[e]?d[e]:null},h.DecTable.initializeDecTableInstance=function(e,t,a,n){n.setSeriesIn(t?"COLS":"ROWS"),n.setDecTableResponse(e),n.setRangeString(a)},h.DecTable.processDecTableResponse=function(e,t,a,n){var r=h.Manager.SidePanelManager;r.TABEL_DEFINATION=!1,h.DecTable.initializeDecTableInstance(n,e,t,a),h.DecTable.processSplitRange(a),h.DecTable.processDecTable(a);var l=h.DecTable.getDataRanges(t);h.DecTable.processDepthIndices(a,l),b.publish(c.UI,p.SidePanel.CHARTS.FILTERCOLUMNS,{depthArray:a.getDepthIndices()})},h.DecTable.getDataRanges=function(e){for(var t=[],a=(h.Manager.SidePanelManager,new h.Utility.ChartAgent,e.split(";")),n=0;n<a.length;n++){var r=h.DecTable.getRangeObject(a[n]);t.push(r)}return t},h.DecTable.processDecTable=function(e){var t=[],a=e.getDecTableResponse();if(null!=a)for(var n=0;n<a.length;n++){var r=a[n]?Object.keys(a[n]):[],l=a[n],o=h.DecTable.getRangeObject(l.rangeStr);t[n]={};for(var g=0;g<r.length;g++)if("splitRanges"!==r[g]&&"rangeStr"!==r[g]){var s={};s.headerValue=l[r[g]].colHead||l[r[g]].rowHead,s.headerLabel="COLS"==e.getSeriesIn()?i["Sheet.Column"]+" "+h.DecTable.getColheaderLabel(parseInt(r[g])+1):i["Sheet.Row"]+" "+h.DecTable.getRowheaderLabel(parseInt(r[g])),s.headerRange="COLS"==e.getSeriesIn()?h.DecTable.getHeaderLabelRange(o.sheetName,parseInt(r[g]),o.range.startRow):h.DecTable.getHeaderLabelRange(o.sheetName,parseInt(r[g]),o.sC),s.type=l[r[g]].type,t[n][r[g]]=s}}e.setDecTable(t)},h.DecTable.getTotalHeaders=function(e){for(var t=0,a=e.decTable||[],n=0;n<a.length;n++)t+=Object.keys(a[n]).length;return 0==t?3:t},h.DecTable.processDepthIndices=function(e,t){var a=h.Manager.SidePanelManager,n=(h.Wrapper.DOMUtils,[]),r=a.getActiveMeta();if(r){var l=e.getSeriesIn();if("COLS"==l)for(var o=0;o<t.length;o++){for(var g=t[o],s=g.range,c=[],p=s.startCol;p<=s.endCol;){var b=h.DecTable.getMergeSpanInfo(s.startRow,p,l),u=h.DecTable.getHeaderValueFromDecTable(e,o,p);u=null!=u?u:{},b>0&&(u=h.DecTable.getSplitRangeObject(p,e));var d={};d.headerLabel=i["Sheet.Column"]+" "+h.DecTable.getColheaderLabel(p+1),h.DecTable.checkIfHeaderAlreadyExists(n,d.headerLabel)||(d.headerValue=u.headerValue,d.type=u.type,d.headerRange=h.DecTable.getHeaderLabelRange(g.sheetName,p,s.startRow),c.push(d)),p+=b+1}n.push(c)}else for(var o=0;o<t.length;o++){for(var g=t[o],s=g.range,c=[],D=s.endRow-s.startRow,p=s.startRow;p<=s.endRow&&20>D;){var b=h.DecTable.getMergeSpanInfo(p,s.startCol,l),u=h.DecTable.getHeaderValueFromDecTable(e,o,p);u=null!=u?u:{},b>0&&(u=h.DecTable.getSplitRangeObject(p,e));var d={};d.headerLabel=i["Sheet.Row"]+" "+h.DecTable.getRowheaderLabel(p),h.DecTable.checkIfHeaderAlreadyExists(n,d.headerLabel)||(d.headerValue=u.headerValue,d.type=u.type,d.headerRange=h.DecTable.getHeaderLabelRange(g.sheetName,s.startCol,p),c.push(d)),p+=b+1}n.push(c)}e.setDepthIndices(n),h.Aggregation.loadOptionsListInCombo(n,0),h.DecTable.populateFilterColumns(r,e);var T=new h.Utility.AgentDom;T.updateAggFilterProperties(r)}},h.DecTable.populateFilterColumns=function(e,t){var a=h.Wrapper.DOMUtils,n="",r=a.getElementById("filterColumns");r.innerHTML="",n=a.createElement("option",{id:"noFilter",value:"noFilter"}),a.appendChild(r,n),a.getElementById("noFilter").innerText="Select";var l=t.getDepthIndices();if(e.getAggregationEnabled()&&"COUNT"===e.getAggregationOperation())n=a.createElement("option",{id:"count",value:"NONE"}),a.appendChild(r,n),a.getElementById("count").innerText="Count";else for(var o=0;o<l.length;o++)for(var i=l[o],s=0;s<i.length;s++){var c=i[s];if("NUMBER"===c.type||"DECIMAL"===c.type||"CURRENCY"===c.type||"PERCENTAGE"===c.type||"EMPTY"===c.type){var p=c.headerValue||c.headerLabel,b=c.headerLabel.replace(" ","");n=a.createElement("option",{id:b,value:c.headerRange,header:c.headerLabel,displayValue:p}),a.appendChild(r,n),a.getElementById(b).innerText=p}}g.zcombo("#filterColumns","refresh")},h.DecTable.getLastFilterElement=function(e){var t=e.getDepthIndices(),a=t.length-1,n=t[a],r=n.length-1,l=n[r];return l.headerRange},h.DecTable.getMergeSpanInfo=function(e,t,a){var n=o.view.getActiveGridID(),r=o.view.getResourceID(n),l=o.view.getVersionID(n),i=o.view.getSheetID(n),g=o.data.getWorkBook(r,l),s=g.getSheetObj(i).Merge,c=s.getInfo(e,t);return c?"COLS"==a?c.endCol-c.startCol:c.endRow-c.startRow:0},h.DecTable.getHeaderValueFromDecTable=function(e,t,a){var n=e.getDecTable();if(n&&n.length>t)for(var r=Object.keys(n[t]),l=0;l<r.length;l++)if(r[l]==a)return n[t][r[l]];return null},h.DecTable.checkIfHeaderAlreadyExists=function(e,t){if(e&&e.length>0)for(var a=0;a<e.length;a++){var n=e[a],r=n.headerLabel;if(r===t)return!0}return!1},h.DecTable.getColheaderLabel=function(e){return JSUtil.Object.getCharForNum(e)},h.DecTable.getRowheaderLabel=function(e){return isNaN(e)?void 0:e+1},h.DecTable.getHeaderLabelRange=function(e,t,a){return e+"."+h.DecTable.getColheaderLabel(t+1)+h.DecTable.getRowheaderLabel(a)},h.DecTable.getRangeObject=function(e){var t=o.view.getActiveGridID(),a=o.view.getResourceID(t),n=o.view.getVersionID(t),r=(o.view.getSheetID(t),JSUtil.Range.parseRange(a,n,e));return r},h.DecTable.constructRangeString=function(e){if("NONE"===e)return e;var t=o.view.getActiveGridID(),a=o.view.getResourceID(t),n=o.view.getVersionID(t),r=(o.view.getSheetID(t),JSUtil.Range.parseRange(a,n,e));return r?h.DecTable.getHeaderLabelRange(r.sheetName,r.range.startCol,r.range.startRow):null},h.DecTable.getHeaderIndexes=function(e,t){for(var a=[],n=0;n<e.length;n++){var r=h.DecTable.getRangeObject(e[n]);"COLS"===t&&a.push(r.range.startCol),"ROWS"===t&&a.push(r.range.startRow)}return a},h.DecTable.validateAggregationHeaders=function(e){var t=[],a=e.getRange(),n=a.split(";"),r=e.getAggregationColHeaders(),l=e.getSeriesIn(),o=h.DecTable.getHeaderIndexes(r,e.getSeriesIn());if("COLS"===l)for(var i=0;i<n.length;i++)for(var g=n[i],s=h.DecTable.getRangeObject(g),c=s.range.startCol,p=s.range.endCol,b=c;p>=b;b++)for(var u=0;u<o.length;u++){var d=o[u];d===b&&t.push(r[u])}else for(var i=0;i<n.length;i++)for(var g=n[i],s=h.DecTable.getRangeObject(g),c=s.range.startRow,p=s.range.endRow,b=c;p>=b;b++)for(var u=0;u<o.length;u++){var d=o[u];d===b&&t.push(r[u])}return t},h.DecTable.getSplitRangeObject=function(e,t){for(var a={},n=t.getSplitRanges(),r=t.getSeriesIn(),l=0;l<n.length;l++)"COLS"==r?n[l].colIndex==e&&(a.headerValue=n[l].name,a.type="text"):n[l].rowIndex==e&&(a.headerValue=n[l].name,a.type="text");return a},h.Utility.getComboId=a,h.Model.ChartDecTable=t,h.DecTable.getRangeDecTableMap=n,h.DecTable.clearRangeDecTableMap=r,h.DecTable.removeRangeEntry=l}(this);
!function(t){function e(){this.isDrag=!1,this.isRecommend=!1,this.type="",this.chartId="",this.sRow=0,this.sCol=0,this.sColDiff=0,this.sRowDiff=0,this.floating=!1,this.top=null,this.left=null,this.trendline=!1,this.isPivotChart=!1,this.pivotId=null,this.trendlineType="None",this.trendlineDegree=2,this.lPostion=3,this.dLables="N",this.threshold=null,this.slant="Auto",this.staggerLines=1,this.yAxis=[],this.styleObject=[],this.xAxis=[],this.chartTitle="",this.subTitle="",this.zoom=!0,this.tooltip=!0,this.animation=!0,this.autoExpand=!0,this.isIncludeHidden=!1,this.combinedRange="HORIZONTAL",this.frl=!1,this.fcl=!1,this.dataRange=null,this.currency="",this.options=null,this.width=615,this.height=380,this.seriesIn="COLS",this.majorGridLine=!1,this.minorGridLine=!1,this.HCInstance=null,this.isSingleYaxis=!1,this.isMarker=!1,this.lineStyle=[],this.comboTypes=["COL"],this.noOfYAxies=1,this.isGrouping=!1,this.activeYAxisIndex=0,this.ts=",",this.ds=".",this.titleJsonForSP={},this.styleJsonForSP={},this.filter={},this.aggregation={},this.titleValueChanged=!1,this.associatedSheetId=null,this.xReverse=!1,this.activeTitleIndex=0,this.aggregationHeaderOperationMap=[],this.binning={},this.gradient={enabled:!1,iab:!1,ias:!1,cgType:"radial",sgType:"radial",cgReversed:!1,sgReversed:!1}}{var i=t.sPlusPlus,o=(t.ZSClass,t.UIUtil.Component),n=t.ZSChart;n.Constants.ChartRangePickerType}e.prototype.setActiveTitleIndex=function(t){this.activeTitleIndex=t},e.prototype.getAggregationHeaderMap=function(){return this.aggregationHeaderOperationMap},e.prototype.getActiveTitleIndex=function(){return this.activeTitleIndex},e.prototype.getXReverse=function(){return this.xReverse},e.prototype.getAssociatedSheetId=function(){return this.associatedSheetId},e.prototype.addTitleJsonForSP=function(t,e){this.titleJsonForSP[t]=e},e.prototype.addTitleStyleJsonForSP=function(t,e){this.styleJsonForSP[t]=e},e.prototype.getFontFamily=function(){var t="Arial";return this.options.chart&&this.options.chart.style&&(t=this.options.chart.style.fontFamily),""!==t?t:"Arial"},e.prototype.getTitleJsonForSP=function(t){return this.titleJsonForSP[t]},e.prototype.getTitleStyleJsonForSP=function(t){return this.styleJsonForSP[t]},e.prototype.resetTitleJsonForSP=function(){this.titleJsonForSP={},this.styleJsonForSP={}},e.prototype.getStyleObject=function(t){return this.styleObject[t||0]},e.prototype.getThousandSeprator=function(){return this.ts},e.prototype.getDecimalSeprator=function(){return this.ds},e.prototype.getGradient=function(){return this.gradient},e.prototype.setExtractOptions=function(e,i){var o=this.cloneOf(e.co||i),n=o.colorOptions,r=n.colorTheme,s=r.basecolor,a=r.name,p=r.isReversed,l=new t.ZSChart.Utility.ChartAgent;o=l.getColorSchemenColors(o,s,a,p),this.setOptions(o)},e.prototype.setOptions=function(t){this.options=t},e.prototype.getComboChartTypes=function(){return this.options.comboChartTypes},e.prototype.getChartTitleStyle=function(){return this.options.title.style},e.prototype.getLegendStyle=function(){return this.options.legend.itemStyle},e.prototype.getChartSubTitleStyle=function(){return this.options.subtitle.style},e.prototype.getChartXAxisTitleStyle=function(){var t=this.options.xAxis.length?this.options.xAxis[0]:this.options.xAxis;return t.title.style},e.prototype.getChartYAxisTitleStyle=function(t){return this.options.yAxis[t].title.style},e.prototype.getOptions=function(){return this.options},e.prototype.setInstance=function(t){this.HCInstance=t},e.prototype.getInstance=function(){return this.HCInstance},e.prototype.setTooltip=function(t){this.tooltip=t},e.prototype.setZoom=function(t){this.zoom=t},e.prototype.setExpand=function(t){this.autoExpand=t},e.prototype.setGradinetStatus=function(t){this.gradient.enabled=t},e.prototype.setChartGradientStatus=function(t){this.gradient.iab=t,this.setGradinetStatus(this.gradient.iab||this.gradient.ias),this.updateChartGradientType(t)},e.prototype.setSeriesGradientStatus=function(t){this.gradient.ias=t,this.setGradinetStatus(this.gradient.iab||this.gradient.ias),this.updateSeriesGradientType(t)},e.prototype.updateChartGradientType=function(){this.gradient.cgType="radial",this.gradient.cgReversed=!0},e.prototype.updateSeriesGradientType=function(){this.gradient.sgType="linear",this.gradient.sgReversed=!0},e.prototype.getLogarithmic=function(t){return"logarithmic"===this.yAxis[t].type},e.prototype.setAnimation=function(t){this.animation=t},e.prototype.setHiddenCells=function(t){this.isIncludeHidden=t},e.prototype.setTitle=function(t){var e=this.chartTitle;return this.chartTitle=t,""===e&&2==this.lPostion},e.prototype.isChartTitleValueChanged=function(t){this.titleValueChanged=this.chartTitle!=t},e.prototype.isSubTitleValueChanged=function(t){this.titleValueChanged=this.subTitle!=t},e.prototype.isXTitleValueChanged=function(t,e){this.titleValueChanged=this.xAxis[e].title.text!=t},e.prototype.isYTitleValueChanged=function(t,e){this.titleValueChanged=this.yAxis[e].title.text!=t},e.prototype.isTitleValueChanged=function(){return this.titleValueChanged},e.prototype.setSubTitle=function(t){var e=this.subTitle;return this.subTitle=t,""===e&&2==this.lPostion},e.prototype.updateXTitle=function(t,e){this.xAxis[e].title.text=t},e.prototype.updateYTitle=function(t,e){this.yAxis[e].title.text=t},e.prototype.updateLegend=function(t){var e=t.value,i=this.getLegendPosition(e);this.lPostion=i},e.prototype.updateOptionByTitle=function(t){var e=this.getOptions();e.title.text=t},e.prototype.updateOptionBySubtitle=function(t){var e=this.getOptions();e.subtitle.text=t},e.prototype.updateDataLabels=function(t){this.dLables="object"==typeof t?t.value:t},e.prototype.getTitle=function(){return this.chartTitle},e.prototype.getSubTitle=function(){return this.subTitle},e.prototype.setType=function(t){!("COMBOCHART"==t)&&this.setYAxisState(!1),this.type=t},e.prototype.getSeriesLength=function(){var t=0;try{var e=this.getOptions();return e.series.length}catch(e){return t}},e.prototype.getType=function(){return"BUBBLE"==this.type?"BUBBLECHART":this.type},e.prototype.getActiveChartThemeName=function(){var t=this.getOptions(),e=t.colorOptions,i=e.colorTheme;return i.name},e.prototype.getDefaultStartRow=function(){var t=i.view.getActiveGridID(),e=i.view.getResourceID(t),o=i.view.getVersionID(t),n=i.view.getSheetID(t),r=i.data.getWorkBook(e,o),s=r.getSheetObj(n),a=s.Row;return a.auxiliaryAxis.findAbs(this.getTop())},e.prototype.getStartRowIndex=function(t){return t&&0!=this.sRow?this.sRow:this.getDefaultStartRow()},e.prototype.setStartRowIndex=function(t){this.sRow=t},e.prototype.getDefaultStartCol=function(){var t=i.view.getActiveGridID(),e=i.view.getResourceID(t),o=i.view.getVersionID(t),n=i.view.getSheetID(t),r=i.data.getWorkBook(e,o),s=r.getSheetObj(n),a=s.Column;return a.axis.findAbs(this.getLeft())},e.prototype.setStartColIndex=function(t){this.sCol=t},e.prototype.getStartColIndex=function(t){return t&&0!=this.sCol?this.sCol:this.getDefaultStartCol()},e.prototype.getStartRowDiff=function(){return this.sRowDiff},e.prototype.getStartColDiff=function(){return this.sColDiff},e.prototype.getFirstRowAsLabel=function(){var t=this.frl;return t},e.prototype.getFirstColAsLabel=function(){var t=this.fcl;return t},e.prototype.getCenterPoint=function(){var t=i.view.getActiveGridID(),e=(i.view.getResourceID(t),i.view.getVersionID(t),i.view.getSheetID(t),i.view.getGridComponent(t));return e.getCenterPoint()},e.prototype.getDefaultLeft=function(){var t=i.view.getActiveGridID(),e=i.view.getSheetID(t),o=i.view.getSheetState(t,e),n=o.getZoom(),r=this.getCenterPoint(),s=parseInt(r.x)-parseInt(this.getWidth()/2);return Math.round(s/n)},e.prototype.getLeft=function(t){return t&&this.left?this.left:this.isDrag?this.left:this.getDefaultLeft()},e.prototype.setLeft=function(t){this.left=t},e.prototype.setTop=function(t){this.top=t},e.prototype.setDragMode=function(t){this.isDrag=t},e.prototype.resetRowColIndex=function(){this.sCol=this.sRow=0},e.prototype.getDefaultTop=function(){var t=i.view.getActiveGridID(),e=i.view.getSheetID(t),o=i.view.getSheetState(t,e),n=(o.getScrollTops(),o.getZoom()),r=this.getCenterPoint(),s=parseInt(r.y)-parseInt(this.getHeight()/2);return Math.round(s/n)},e.prototype.getTop=function(t){return t&&this.top?this.top:this.isDrag?this.top:this.getDefaultTop()},e.prototype.getActiveSheet=function(){var t=i.view.getActiveGridID(),e=i.view.getSheetID(t);return e},e.prototype.getRange=function(){return this.dataRange},e.prototype.setRange=function(t){return n.DecTable.removeRangeEntry(this.dataRange),this.dataRange!=t&&(this.dataRange=t)},e.prototype.getSeriesIn=function(){return this.seriesIn},e.prototype.getHeight=function(){return this.height},e.prototype.getWidth=function(){return this.width},e.prototype.getCustomStyle=function(t){return this.styleObject[t||0]},e.prototype.getZoomType=function(){return""},e.prototype.getToolTip=function(){return this.tooltip},e.prototype.getXTitle=function(t){return this.xAxis[t||0].title&&this.xAxis[t||0].title.text},e.prototype.getYTitle=function(t){return this.yAxis[t||0].title.text},e.prototype.getAnimation=function(){return this.animation},e.prototype.getAutoExpandState=function(){return this.autoExpand},e.prototype.getTrendline=function(){return this.trendline},e.prototype.getFloating=function(){return this.floating},e.prototype.getMajorGridWidth=function(){return this.majorGridLine?1:0},e.prototype.getMinorTickInterval=function(){return this.minorGridLine?"auto":""},e.prototype.getXLabel=function(t){return this.xAxis[t||0].labels.enabled},e.prototype.getYLabel=function(t){return this.xAxis[t||0].labels.enabled},e.prototype.setYAxisState=function(t){this.isSingleYaxis=t},e.prototype.getYAxisState=function(){var t=new n.Utility.ChartAgent,e=t.isMutipleAxiesChart(this.type);return e?this.isSingleYaxis:!1},e.prototype.getHiddenCellState=function(){return this.isIncludeHidden},e.prototype.getXSlant=function(){return"Auto"==this.slant?null:this.slant},e.prototype.getLabelFormat=function(){return this.dLables},e.prototype.setCombinedWay=function(t){this.combinedRange=t},e.prototype.getCombinedWay=function(){return this.combinedRange},e.prototype.getMarkerState=function(){return this.isMarker},e.prototype.setMarkerState=function(t){this.isMarker=t},e.prototype.getLPos=function(){return this.lPostion},e.prototype.getTrendlineTypes=function(){return this.trendlineType},e.prototype.getDegreeOrElse=function(){return this.trendlineDegree},e.prototype.getThreshold=function(){return this.threshold},e.prototype.getPivotState=function(){return this.isPivotChart},e.prototype.isCloned=function(){return!1},e.prototype.getComboTypes=function(){return this.comboTypes},e.prototype.setComboTypes=function(t){this.comboTypes=t},e.prototype.updateNoOfYAxies=function(){var t=this.options,e=t.series,i=e?e.length:1;this.setNoOfYAxies(this.isSingleYaxis?i:1)},e.prototype.getTitleObject=function(){return this.options.title},e.prototype.getSubTitleObject=function(){return this.options.subtitle},e.prototype.constructTitleJsonForSP=function(){var t=this.getOptions().cellRef,e=t.titleRange?"="+t.titleRange:this.getTitle(),i=t.subtitleRange?"="+t.subtitleRange:this.getSubTitle(),o=t.xtitleRange?"="+t.xtitleRange:this.getXTitle();this.titleJsonForSP.CHART_TITLE=e,this.titleJsonForSP.CHART_SUBTITLE=i,this.titleJsonForSP.CHART_X_AXIES=o;for(var n=0;n<this.getYAxis().length;n++){var r=0==n?"LA":"RA"+parseInt(n);this.titleJsonForSP[r]=t["ytitleRange"+n]?"="+t["ytitleRange"+n]:this.getYAxis()[n].title.text}},e.prototype.constructStyleJsonForSP=function(){var t=this.getTitleObject().style,e=this.getSubTitleObject().style,i=this.options.xAxis.title&&this.options.xAxis.title.style;this.styleJsonForSP.CHART_TITLE=t,this.styleJsonForSP.CHART_SUBTITLE=e,this.styleJsonForSP.CHART_X_AXIES=i;for(var o=0;o<this.getYAxis().length;o++){var n=0==o?"LA":"RA"+parseInt(o);this.styleJsonForSP[n]=this.getYAxis()[o].title.style}},e.prototype.setNoOfYAxies=function(t){this.noOfYAxies=t},e.prototype.getNoOfAxies=function(){return this.getYAxisState()?this.noOfYAxies:1},e.prototype.getYAxis=function(){var t=n.Utility.removeCursorPointer(this.yAxis);return t},e.prototype.getXAxis=function(t){return this.xAxis[t||0]},e.prototype.getActiveYIndex=function(){return this.activeYAxisIndex},e.prototype.setActiveYIndex=function(t){this.activeYAxisIndex=t},e.prototype.getLineStyles=function(){return this.lineStyle},e.prototype.getPivotId=function(){return this.pivotId},e.prototype.getStaggerState=function(){return this.staggerLines},e.prototype.updateTrendtype=function(t){this.trendlineType=t.value;t.prevVal;return this.trendlineDegree=2,!1},e.prototype.setTrendline=function(t){this.trendline=t},e.prototype.updateTrendDegree=function(t){this.trendlineDegree=t.value},e.prototype.updateFontFamily=function(t){this.options.chart.style=t},e.prototype.updateTitleStyle=function(t,e){var i="";return"119"==t?(i=this.options.title.style.color,this.options.title.style=e):"120"==t?(i=this.options.subtitle.style.color,this.options.subtitle.style=e):"117"==t?(i=this.xAxis[0].title.style.color,this.xAxis[0].title.style=e):"118"==t&&(i=this.yAxis[this.getActiveYIndex()].title.style.color,this.yAxis[this.getActiveYIndex()].title.style=e),i},e.prototype.addNewPlotline=function(t){var e=new n.Utility.ChartAgent;this.options=e.addNewPlotline(this.options,t);var i=this.getActiveYAxisPltlines(t),o=new n.Utility.AgentDom;o.refreshPlotlineDom(i)},e.prototype.removePlotlineByIndex=function(t){var e=new n.Utility.ChartAgent;this.options=e.removePlotlineByIndex(this.options,t);var i=this.getActiveYAxisPltlines(t),o=new n.Utility.AgentDom;o.refreshPlotlineDom(i)},e.prototype.getActiveYAxisPltlines=function(t){var e=this.options.yAxis[t.index],i=e.plotLines?e.plotLines:null;return i},e.prototype.updatePlotLineName=function(t){var e=new n.Utility.ChartAgent;this.options=e.updatePlotLineName(this.options,t)},e.prototype.updateChartColor=function(t){this.options.chart.backgroundColor=t},e.prototype.updateXLabel=function(t,e){this.xAxis[e||0].labels.enabled=t},e.prototype.updateXLabelStyle=function(t,e){this.xAxis[e||0].labels.style||(this.xAxis[e||0].labels.style={}),this.xAxis[e||0].labels.style[t.key]=t.value},e.prototype.updateYLabelStyle=function(t,e){this.yAxis[e||0].labels.style||(this.yAxis[e||0].labels.style={}),this.yAxis[e||0].labels.style[t.key]=t.value},e.prototype.updateXSlant=function(t){this.slant="Auto"===t.value?null:parseInt(t.value)},e.prototype.updateXStagger=function(t){this.staggerLines="auto"==t.value?1:parseInt(t.value)},e.prototype.updateYLabel=function(t,e){this.yAxis[e||0].labels.enabled=t},e.prototype.updateYReverse=function(t,e){this.yAxis[e||0].reversed=t},e.prototype.updateYLogarithmic=function(t,e){this.yAxis[e||0].type=t?"logarithmic":"linear"},e.prototype.updateYBaseValue=function(t,e){this.yAxis[e||0].baseValue=t},e.prototype.updateXReverse=function(t,e){this.xAxis[e||0].reversed=t,this.xReverse=t},e.prototype.updateYOpposite=function(t,e){this.yAxis[e||0].opposite=t},e.prototype.updateXReverse=function(t,e){this.xAxis[e||0].reversed=t},e.prototype.updateYPlotlineName=function(t,e,i){!this.yAxis[e||0].plotLines&&(this.yAxis[e||0].plotLines=[]),!this.yAxis[e||0].plotLines[i||0]&&(this.yAxis[e||0].plotLines[i||0]={}),this.yAxis[e||0].plotLines[i||0].labels={text:t},this.yAxis[e||0].plotLines[i||0].id="plot-line"+e+"_"+i},e.prototype.updateYPlotline=function(t,e,i){!this.yAxis[e||0].plotLines&&(this.yAxis[e||0].plotLines=[]);var o=this.options,n=o.series,r=null,s=null;try{r=this.yAxis[e||0].plotLines[i||0].color,s=this.yAxis[e||0].plotLines[i||0].dashStyle}catch(t){}r=r||(n[e]?n[e].color:"#FF0000")||"#FF0000",s=s||"shortDash",!this.yAxis[e||0].plotLines[i||0]&&(this.yAxis[e||0].plotLines[i||0]={}),this.yAxis[e||0].plotLines[i||0].value=""==t?null:t,this.yAxis[e||0].plotLines[i||0].id="plot-line"+e+"_"+i,this.yAxis[e||0].plotLines[i||0].width=2,this.yAxis[e||0].plotLines[i||0].color=r,this.yAxis[e||0].plotLines[i||0].dashStyle=s},e.prototype.updateYMin=function(t,e){this.yAxis[e||0].min=""==t?null:parseInt(t)},e.prototype.updateYMax=function(t,e){this.yAxis[e||0].max=""==t?null:parseInt(t)},e.prototype.updateYInterval=function(t,e){this.yAxis[e||0].interval=""==t?null:parseInt(t)},e.prototype.updateYMajor=function(t,e){this.majorGridLine=t;var i=this.getYAxis();i[e||0].gridLineWidth=t?1:0},e.prototype.updateYMinor=function(t,e){this.minorGridLine=t;var i=this.getYAxis();i[e||0].minorTickInterval=t?"auto":null},e.prototype.setSeriesIn=function(t){this.seriesIn=t},e.prototype.setFirstRowAsLabel=function(t){this.frl=t},e.prototype.setFirstColumnAsLabel=function(t){this.fcl=t},e.prototype.updateThreshold=function(t){this.threshold=""==t?null:+parseFloat(t)},e.prototype.getChartID=function(){return-1==this.chartId.indexOf("preview")?this.chartId:""},e.prototype.setChartID=function(t){this.chartId=t},e.prototype.updateTheme=function(t,e,i,o){var o=o||0,n=this.getStyleObject(o);n.colorObject.colorTheme={basecolor:t,name:e,isReversed:i}},e.prototype.updateFilter=function(t,e){this.filter[t]=e,"type"===t&&"NONE"===e&&(this.filter.limit=0,this.filter.limitBy="NONE",this.filter.limitByName="")},e.prototype.resetFilter=function(){this.filter&&(this.filter.limit=0,this.filter.type="NONE",this.filter.limitBy="NONE")},e.prototype.getFilter=function(){!this.filter.type&&(this.filter.type="NONE"),"NONE"!==this.filter.type&&(this.filter.enabled=!0),!this.filter.limit&&(this.filter.limit=0);var t=n.Wrapper.DOMUtils,e=null!=t.getElementById("filterColumnWrapper")?t.getElementById("filterColumnWrapper").style.display:"none",i="";if("none"!==e){var r=o.zcombo("#filterColumns","getValue");i=r.selector?"NONE":r}else i="NONE";return!this.filter.limitBy&&(this.filter.limitBy=i),this.filter},e.prototype.getFilterType=function(){return this.filter&&this.filter.type},e.prototype.setFilterType=function(t){this.filter.type=t},e.prototype.setFilterLimit=function(t){this.filter.limit=t},e.prototype.isFilterEnabled=function(){return this.filter&&"NONE"!==this.filter.type&&"NONE"!==this.filter.limitBy},e.prototype.setFilterColumnOnEnabled=function(){if(this.filter&&this.isFilterEnabled()&&("NONE"===this.filter.limitBy||""===this.filter.limitBy))if(this.getAggregationEnabled()&&"COUNT"===this.getAggregationOperation())this.getAggregationEnabled()&&"COUNT"===this.getAggregationOperation()&&this.setFilterColumn("NONE");else{var t=n.DecTable.getRangeDecTableMap(this.getRange()),e=n.DecTable.getLastFilterElement(t);this.setFilterColumn(e)}},e.prototype.setFilterColumn=function(t){this.filter.limitBy=t},e.prototype.getFilterLimit=function(){return this.filter&&this.filter.limit},e.prototype.getFilterColumn=function(){return this.filter&&this.filter.limitBy},e.prototype.getAggregationColHeaders=function(){var t=this.aggregation&&this.aggregation.enabled&&(this.aggregation.colheaders||this.aggregation.rowheaders),e=t&&t.split(";")||[];return e},e.prototype.getAggColHeaders=function(){var t=this.aggregation&&(this.aggregation.colheaders||this.aggregation.rowheaders),e=t&&t.split(";")||[];return e},e.prototype.getAggregationHeader=function(t){var e=this.aggregation&&this.aggregation.enabled&&(this.aggregation.colheaders||this.aggregation.rowheaders),i=e&&e.split(";")||[],o=n.DecTable,r=i[t]&&o.constructRangeString(i[t]);return r||"Choose"},e.prototype.getDepthOperation=function(t){var e=this.aggregation&&this.aggregation.dateOperations,i=[],o=new n.Utility.ChartAgent;return e&&"NONE"!==e&&!o.isArray(e)&&(i=e.split(",")),i[t]&&"NONE"!==i[t]&&i[t].split("-")[1]||"NONE"},e.prototype.isDateOperationIndex=function(t){var e=this.aggregation&&this.aggregation.dateOperations,i=[],o=new n.Utility.ChartAgent;return e&&"NONE"!==e&&!o.isArray(e)&&(i=e.split(",")),i[t]&&"NONE"!==i[t]},e.prototype.getAggregationOperation=function(){return this.aggregation&&this.aggregation.type||"NONE"},e.prototype.getAggregationEnabled=function(){return this.aggregation&&this.aggregation.enabled},e.prototype.getAggregationDateOperations=function(){var t,e=new n.Utility.ChartAgent;return this.aggregation&&this.aggregation.dateOperations&&!e.isArray(this.aggregation.dateOperations)&&(t=this.aggregation.dateOperations.split(",")),t||["NONE","NONE","NONE"]},e.prototype.getAggregation=function(){var t=["NONE","NONE","NONE"],e=new n.Utility.ChartAgent,i=this.aggregation.dateOperations&&!e.isArray(this.aggregation.dateOperations)?this.aggregation.dateOperations.split(","):this.aggregation.dateOperations;for(var o in i)t[o]=i[o];return this.aggregation.dateOperations=t.join(","),this.aggregation},e.prototype.getBinning=function(){return this.binning},e.prototype.getUpdateOptions=function(){var t=this.cloneOf(this.getOptions(),!0);return t=this.updateOptionsByMeta(t)},e.prototype.setRecommendationSelection=function(t){this.isRecommend=t},e.prototype.isRecommendationSelection=function(){return this.isRecommend},e.prototype.getBinningInterval=function(){return this.binning?this.binning.interval:0},e.prototype.getComputedAggregationStatus=function(){var t=this.aggregation.colheaders&&this.aggregation.colheaders.length>0||this.aggregation.rowheaders&&this.aggregation.rowheaders.length>0;return t=t&&"NONE"!==this.aggregation.type},e.prototype.updateAggregation=function(t,e){this.aggregation&&(this.aggregation[t]=e)},e.prototype.setAggregationOperation=function(t){this.aggregation&&(this.aggregation.type=t)},e.prototype.udpateAggregationHeaderMap=function(t){var e=this.aggregationHeaderOperationMap.length;if(t.colheaders||t.dateOperations)for(var i=new n.Utility.ChartAgent,o=t.colheaders.split(","),r=i.isArray(t.dateOperations)?t.dateOperations:t.dateOperations.split(","),s=0;s<o.length;s++){for(var a=o[s],p=!1,l=0;e>l;l++){var h=this.aggregationHeaderOperationMap[l],g=h.headers;if(p=g===a)break}if(p){var h=this.aggregationHeaderOperationMap[l];h.dateOperations=r[s],this.aggregationHeaderOperationMap[l]=h}else{var h={};h.headers=o[s],h.dateOperations=r[s],this.aggregationHeaderOperationMap.push(h)}}},e.prototype.getAggregationHeaderMapDetails=function(t){for(var e=this.aggregationHeaderOperationMap,i=0;i<e.length;i++){var o=e[i];if(o.headers===t)return o.dateOperations}},e.prototype.getAggregationHeaderMapDetailsForAllHeaders=function(t){var e=[],i=this.aggregationHeaderOperationMap;if(!t)return e;for(var o=0;o<t.length;o++)for(var n=t[o],r=0;r<i.length;r++){var s=i[r];s.headers===n&&e.push(s.dateOperations)}return e},e.prototype.updateNumberFormat=function(t){var e=t.nfCode,i=n.Constants.NumberFormat;switch(e){case i.THOUSANDS:case i.BILLIONS:case i.MILLIONS:case i.NONE:case i.DEFAULT:this.setYAxiesNumberFormat(t.yIndex,t.prefix,t.suffix,t.nfCode);break;case i.CUSTOM:this.setYAxiesNumberFormat(t.yIndex,t.prefix||null,t.suffix||null,t.nfCode)}},e.prototype.setYAxiesNumberFormat=function(t,e,i,o){var n=this.yAxis;n[t].prefix=e,n[t].suffix=i,n[t].nfCode=o},n.Model.DialogMeta=e}(this);
!function(t){function e(){}function i(t){return t&&t.co?t.co.cellRef&&t.co.cellRef.titleRange?t.co.cellRef.titleRange:t.co.title.text:""}function s(t){return t&&t.co?t.co.cellRef&&t.co.cellRef.subtitleRange?t.co.cellRef.subtitleRange:t.co.subtitle.text:""}var r=(t.sPlusPlus,t.ZSClass,t.UIUtil.Component);e.prototype=ZSChart.Model.DialogMeta.prototype,e.prototype.constructPropertyFromObject=function(t){this.ds=t.ds||this.ds,this.ts=t.ts||this.ts,this.isGrouping=t.grouping?t.grouping:this.isGrouping,this.type=t.type||this.type,this.chartId=t.co.chart.renderTo||this.chartId,this.associatedSheetId=t.asn,this.sRow=t.sR||this.sRow,this.sCol=t.sC||this.sCol,this.sRowDiff=t.srd||this.sRowDiff,this.sColDiff=t.scd||this.sColDiff,this.top=t.top||this.top,this.left=t.left||this.left,this.trendline=t.tl||this.trendline,this.isPivotChart=t.isPivotChart||!1,this.pivotId=t.pivotId||null,this.trendlineType=t.tlType||this.trendlineType,this.combinedRange=t.cR||this.combinedRange,this.trendlineDegree=t.order||this.trendlineDegree,this.frl=t.frl||this.frl,this.fcl=t.fcl||this.fcl,this.dataRange=t.dataRange||this.dataRange,this.currency=t.currency||this.currency,this.secYAxisSymbol=t.secYAxisSymbol||this.secYAxisSymbol,this.width=t.wd||this.width,this.height=t.ht||this.height,this.seriesIn=t.seriesIn||this.seriesIn,this.chartTitle=i(t)||this.chartTitle,this.subTitle=s(t)||this.subTitle,this.lPostion=t.legendPos>=0?t.legendPos:this.lPostion,this.dLables=t.lf||this.dLables,this.threshold=t.th||this.threshold,this.isSingleYaxis="undefined"==typeof t.isSingleYaxis?this.isSingleYaxis:t.isSingleYaxis,this.isIncludeHidden="undefined"==typeof t.ihc?this.isIncludeHidden:t.ihc,this.autoExpand="undefined"==typeof t.ae?this.autoExpand:t.ae,this.aggregation=t.co.aggregation,this.comboTypes=t.comboChartTypes||this.comboTypes,this.filter=t.co.filter||{},this.lineStyle=t.co.lineStyles||[],this.gradient=t.gradient||this.gradient,this.setExtractOptions(t),this.extractYAxisProperty(),this.extractYAxisCurrentState(),this.extractXAxisProperty(),this.constructStyleProperty(),this.extractYAxiesCount(),this.updateToggleProperty(),this.updateNoOfYAxies(),this.constructTitleJsonForSP(),this.constructStyleJsonForSP(),this.constructAggregationHeaderOperationMap(),this.updateGroupingStates(t),this.extractBinningProperties(t)},e.prototype.getDetails=function(){var t={};return t.ds=this.ds,t.ts=this.ts,t.grouping=this.isGrouping,t.type=this.type,t.sR=this.sRow,t.sC=this.sCol,t.srd=this.sRowDiff,t.scd=this.sColDiff,t.top=this.top,t.left=this.left,t.tl=this.trendline,t.isPivotChart=this.isPivotChart,t.pivotId=this.pivotId,t.tlType=this.trendlineType,t.cR=this.combinedRange,t.order=this.trendlineDegree,t.frl=this.frl,t.fcl=this.fcl,t.dataRange=this.dataRange,t.currency=this.currency,t.secYAxisSymbol=this.secYAxisSymbol,t.wd=this.width,t.ht=this.height,t.seriesIn=this.seriesIn,t.legendPos=this.lPostion,t.lf=this.dLables,t.th=this.threshold,t.isSingleYaxis=this.isSingleYaxis,t.ihc=this.isIncludeHidden,t.ae=this.autoExpand,t.aggregation=this.aggregation,t.filter=this.filter,t.yAxis=this.yAxis,t.lineStyles=this.lineStyle,t},e.prototype.constructPropertyFromDialog=function(){},e.prototype.updateGroupingStates=function(t){this.isGrouping=t.grouping?t.grouping:!1},e.prototype.getGroupingStatus=function(){return this.isGrouping},e.prototype.constructAggregationHeaderOperationMap=function(){var t=this.aggregation.colheaders||this.aggregation.rowheaders,e=this.aggregation.dateOperations;if(t)for(var i=t.split(-1!==t.indexOf(";")?";":","),s=e.split(","),r=0;r<i.length;r++){var n={};n.headers=i[r].replace(/'/g,""),n.dateOperations=s[r],this.aggregationHeaderOperationMap.push(n)}},e.prototype.resetAggregationOperationIfNeeded=function(){!this.aggregation.enabled&&(this.aggregation.type="NONE")},e.prototype.extractYAxiesCount=function(){(this.isGropuing||this.isPivotChart)&&(this.noOfYAxies=this.options.series.length)},e.prototype.extractBinningProperties=function(t){this.binning=t.co.binning},e.prototype.updateToggleProperty=function(){var t=this.options;this.isMarker="undefined"==typeof t.plotOptions.series.marker.enabled?this.isMarker:t.plotOptions.series.marker.enabled,this.animation="undefined"==typeof t.plotOptions.series.animation?this.animation:t.plotOptions.series.animation,this.tooltip="undefined"==typeof t.tooltip.enabled?this.tooltip:t.tooltip.enabled,this.zoom="xy"===t.chart.zoomType?!0:!1},e.prototype.extractXAxisProperty=function(){var t=this.getOptions(),e=this.cloneOf(t.xAxis,!0),i=new ZSChart.Utility.ChartAgent,s=i.isArray(e),r={};s?this.xAxis=e:(this.merge(r,this.xAxis[0]||{},e),this.xAxis=[],this.xAxis.push(r)),this.slant=e&&e.labels?e.labels.rotation:this.slant,this.staggerLines=e&&e.labels?e.labels.staggerLines:this.staggerLines,this.xReverse=e?e.reversed:this.xReverse,t.cellRef&&e.title&&(e.title.text=t.cellRef.xtitleRange||(e.title?e.title.text:""))},e.prototype.extractYAxisProperty=function(){var t=this.getOptions(),e=this.cloneOf(t.yAxis,!0);if(e||e[0]){this.majorGridLine=e[0].gridLineWidth?!0:!1,this.minorGridLine="auto"===e[0].minorTickInterval?!0:!1;for(var i in e){var s=e[i];t.cellRef&&t.cellRef["ytitleRange"+i]&&(s.yAxistitle=t.cellRef["ytitleRange"+i]||s.yAxistitle)}this.yAxis=e}},e.prototype.extractYAxisCurrentState=function(){if(this.isSingleYaxis){var t=r.zcombo("#yaxisMulti","getValue");t="string"==typeof t?t:"LA";var e="LA"===t?0:t.substring(t.length-1,t.length),i=r.zcombo("#chartTitleCombo","getValue");i="string"==typeof i?i:"LA",-1!==i.indexOf("RA")&&this.setActiveTitleIndex(i.substring(i.length-1,i.length)),this.setActiveYIndex(e)}else this.setActiveYIndex(0),this.setActiveTitleIndex(0)},e.prototype.updateYTitleRange=function(t,e){this.yAxis[e].yAxistitle=t},e.prototype.constructStyleProperty=function(){var t=this.getOptions(),e=new ZSChart.Utility.ChartAgent,i=e.constructStyleProperty(t);this.styleObject.push(i)},e.prototype.getLegendPosition=function(e){var i=new t.ZSChart.Utility.CommanAgent;return i.getLegendPosition(e)},e.prototype.getLegendName=function(e){var i=new t.ZSChart.Utility.CommanAgent;return i.getLegendName(e)},e.prototype.cloneOf=function(t,e){var i=new ZSChart.Utility.ChartAgent;return i.clone(t,e)},e.prototype.merge=function(t,e,i,s){var r=new ZSChart.Utility.ChartAgent;return r.merge(t,e,i,s||!1),t},e.prototype.getDataLabelsUpdate=function(){var e=this.cloneOf(this.options,!0),i={lf:this.dLables,type:this.type,isSingleYaxis:this.isSingleYaxis,secYAxisSymbl:this.secYAxisSymbol,currency:this.currency},s=new t.ZSChart.Utility.CommanAgent,r=s.getDataLabelsUpdate(e,i);return r=this.removeExtraProperty(r)},e.prototype.getLegendUpdate=function(){var e=this.cloneOf(this.options,!0),i=new t.ZSChart.Utility.CommanAgent,s={legend:i.getLegendUpdate(this.lPostion,this.chartTitle,this.subTitle)};return i.mergeRecursively(e,s),e.plotOptions[e.chart.type].showInLegend=e.legend.enabled,e},e.prototype.getTrendUpdate=function(){var t=this.getTrendlineTypes(),e=this.getDegreeOrElse(),i=this.cloneOf(this.options,!0);i=this.updateOptionsByMeta(i);var s,r,n,o=i.colors,a=i.legend.enabled,h=i.series,l=h.length;if(s=r=parseInt(l/2),h[l-1].hasOwnProperty("isRegressionLine")){for(;r>s;s++)delete h[s];h.length=r}if(-1===t.indexOf("None"))for(var p=0;p<h.length;p++)n=h[p].name,void 0===n&&(n="Series "+(p+1)),h[p].regression=!0,h[p].regressionSettings={regression:!0,type:t.toLowerCase(),color:o[p],order:e,dashStyle:"ShortDot",name:n+" Trendline",period:e,showInLegend:a},h[p].rendered=!1;else for(var p=0;p<h.length;p++)delete h[p].regression,delete h[p].regressionSettings;return i},e.prototype.getXLabelUpdate=function(t){var e=this.getXLabel(),i=this.cloneOf(this.xAxis,!0);return i[t||0].tickLength=e?10:0,i[t||0].lineWidth=e?1:0,i[t||0]},e.prototype.getXSlantUpdate=function(t){var e=this.getXSlant(),i=this.cloneOf(this.xAxis,!0);return i[t||0].labels.rotation="auto"==e?null:parseInt(e),i[t||0]},e.prototype.getXStaggerUpdate=function(t){var e=this.getStaggerState(),i=this.cloneOf(this.xAxis,!0);return i[t||0].labels.staggerLines=1===e?null:e,i[t||0]},e.prototype.getYPlotlineUpdate=function(t,e){var i=this.getYAxis(),s=i[t||0].plotLines;return s[e||0]},e.prototype.removeYPlotline=function(t,e){var i=this.getYAxis(),s=i[t||0].plotLines,r=s[e]?s[e].id:"";return s[e]&&delete s[e],r},e.prototype.removeAllPlotLine=function(t){var e=this.getYAxis();delete e[t].plotLines},e.prototype.getThresholdUpdate=function(){var t=this.cloneOf(this.options,!0);return this.threshold?(t.plotOptions.series.threshold=this.threshold,t.plotOptions.series.negativeColor="#FF0000"):(delete t.plotOptions.series.threshold,delete t.plotOptions.series.negativeColor),t},e.prototype.getThemeUpdate=function(e,i,s){var r=this.getOptions();r=this.updateOptionsByMeta(r);var n=new t.ZSChart.Utility.ChartAgent;return r=n.getColorSchemenColors(r,e,i,s),r.colorOptions=this.getStyleObject().colorObject,r},e.prototype.updateOptionsByMeta=function(t){var e=new ZSChart.Utility.ChartAgent;return t.title.text=this.chartTitle,t.subtitle.text=this.subTitle,t=this.removeExtraProperty(t),e.merge({},t,this.getLegendUpdate(),!0),e.merge({},t,this.getDataLabelsUpdate(),!0),t.chart.renderTo=this.chartId,t},e.prototype.removeExtraProperty=function(t){return delete t.chart.spacingBottom,delete t.chart.spacingTop,delete t.chart.spacingLeft,delete t.chart.spacingRight,t},e.prototype.updateScaleFactor=function(t,e){this.yAxis[e].scaleFactor=t},e.prototype.updateConversionType=function(t,e){this.yAxis[e].conversionType=t},e.prototype.updateUnitFactor=function(t,e){this.yAxis[e].unitFactor=t},e.prototype.getScaleFactor=function(t){return this.yAxis[t||0].scaleFactor},e.prototype.getConversionType=function(t){return this.yAxis[t||0].conversionType},e.prototype.getUnitFactor=function(t){return this.yAxis[t||0].unitFactor},e.prototype.updateBinning=function(t){this.binning=t},e.prototype.reGeneratedYxiesLabels=function(){var t=new ZSChart.Utility.ChartAgent,e=t.getFormatLabels(this.yAxis,this.currency,this.type);return e},e.prototype.updateSeriesCustomization=function(t){var e=new ZSChart.Utility.ChartAgent,i=this.getCustomStyle();e.updateSeriesColor(i,{cValue:t.color,mType:t.mCType,cType:t.cType,pIndex:t.pIndex,sIndex:t.sIndex,isSeries:t.isSeries})},ZSChart.Utility.getSeriesLengthFromRange=function(t,e){var i=t.getRange();if(!i||""===i)return 0;var s=t.getFirstRowAsLabel(),r=t.getFirstColAsLabel(),n=t.getSeriesIn();i=i.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");var o=ZSChart.DecTable.getDataRanges(i),a=0,h=0,l=0;if(e&&t.isFilterEnabled())return 0;if(e&&t.getAggregationEnabled()){var p=ZSChart.DecTable.getDecTableInstance(i);if(!p)return 0;for(var g=0,c=p.getDepthIndices(),d=0;d<c.length;d++)for(var u=c[d],y=0;y<u.length;y++){var f=u[y];("NUMBER"===f.type||"DECIMAL"===f.type||"CURRENCY"===f.type||"PERCENTAGE"===f.type||"EMPTY"===f.type)&&g++}l=g+t.getAggColHeaders().length}else if("COLS"==n){for(var d=0;d<o.length;d++){var x=o[d];a+=x.range.endCol-x.range.startCol+1}l=r?a-1:a}else{for(var d=0;d<o.length;d++){var x=o[d];h+=x.range.endRow-x.range.startRow+1}l=s?h-1:h}return l}}(this);
!function(t){function e(){o.Model.Dialog.call(this)}{var s=(t.sPlusPlus,t.ZSClass,t.JSUtill,t.UserAction,t.ZSConstants.I18N,t.UIUtil.Component,t.ZSEvents),o=(s.Groups,s.Names,s.topic,t.ZSChart),n=(o.Constants.ServiceProvider,o.Constants.ChartType,o.Constants);n.ColorSchemeType,o.Constants.ChartRangePickerType,t.ZSDevTools.Logger}e.prototype=new o.Model.Dialog,e.prototype.processResponse=function(t){this.setSidePanelState(!0),this.setResposne(t),this.doPreprocess(),this.doPostProcess(),this.clearResposne()},e.prototype.getRangeAry=function(t,e,s){var o="",n=";",r=[];return n?r=t.split(n):r.push(t),o="COLS"==e&&"VERTICAL"==s||"ROWS"==e&&"HORIZONTAL"==s?r[0]:t},e.prototype.insertChart=function(){var t="CHART_NEW";this.createRequest(t)},e.prototype.checkIfFirstInstanceIsValid=function(t){return!t.reason},o.Model.SPMeta=e}(this);
!function(e){function t(){this.addRangeClicked=!1,this.Id=-1,this.alive={}}function i(e){this.removeRangeDOM(e)}var a=e.ZSChart,n=(e.sPlusPlus,e.ZSEvents),o=n.topic,s=n.Groups,l=n.Names,r=e.document,d=null,c=null,h=!1,p=null,g=e.UIUtil.Component;t.prototype={set range(e){this.populateRanges(e)},get range(){return this.getPopulatedRanges()}},t.prototype.showRangeDomForSP=function(){var e=a.Wrapper.DOMUtils;e.showById("rangeSelectorDiv"),e.showByClassName("spDisabled");var t=Object.keys(this.alive),i=this.alive[t[t.length-1]];i.focus(),i.setSelectionRange(i.value.length,i.value.length),this.addRangeClicked=!1},t.prototype.hideRangeDomForSP=function(){var e=a.Wrapper.DOMUtils;e.getElementById("rangeWrapper").innerHTML="",e.hideById("rangeSelectorDiv"),e.hideByClassName("spDisabled")},t.prototype.constructRangeDialog=function(){h=!0;var t={width:365,title:"Select Data Ranges",height:"auto",close:function(){this.closeZSCRDialog()}.bind(this)};return this.initCRDialog(),new e.ZSClass.Dialog(c,t)},t.prototype.incr=function(){this.Id++},t.prototype.addListner=function(){h=!1,p=a.Wrapper.DOMUtils,p.addEvent("chMlAdd","click",function(){this.createRangeElement()}.bind(this)),p.addEvent("updateRange","click",this.updateRange.bind(this)),p.addEvent("cancelRange","click",this.cancelDialog.bind(this))},t.prototype.addListnerForSP=function(){h=!1,p=a.Wrapper.DOMUtils,p.addEventByNode(p.getElementByClassName("chMlAdd"),"click",function(){this.createRangeElement();var e=Object.keys(this.alive),t=e[e.length-1];this.alive[t].focus()}.bind(this)),p.addEvent("updateRange","click",this.updateRangeForSP.bind(this)),p.addEvent("cancelRange","click",this.cancelDialogForSp.bind(this))},t.prototype.openZSCRDialog=function(){this.hideDialog(),d.open()},t.prototype.closeZSCRDialog=function(){p.getElementById("rangeWrapper").innerHTML=""},t.prototype.populateRanges=function(e){!d&&(d=this.constructRangeDialog()),this.getIsSidePanel()?h&&this.addListnerForSP():h&&this.addListner();var t=e?e.split(";"):[];t.forEach(function(e){""!=e&&this.createRangeElement(e)}.bind(this)),(this.addRangeClicked||0==t.length)&&this.createRangeElement();var i=p.getElementById("rangeWrapper"),a=this;g.sortable(i,{axis:"y",update:function(e,t){var i=t.item[0],n=t.item.index(),o=i.lastElementChild,s=o.dataset,l=s.index,r=a.alive[l];a.alive[l]=a.alive[n],a.alive[n]=r,o.setAttribute("data-index",n)}})},t.prototype.clearRangeCatch=function(){this.Id=-1,this.alive={},this.isRangeEditing()||(o.publish(s.UI,l.SidePanel.CHARTS.SETFOCUS),this.disableRangeEditor())},t.prototype.createRangeElement=function(t){var a=Object.keys(this.alive),n="";if(a.length>0&&(n=this.alive[a[a.length-1]]),!(a.length>0&&""==n.value)){this.incr();var o=e.UserAction.getTemplate(["CHART_MULTI_RANGE_TEMPLATE"]),s=o.CHART_MULTI_RANGE_TEMPLATE,l=s.cloneNode(!0);if(l.hasChildNodes())for(var r=l.children,d=0;d<r.length;d++){var c=r[d],h=c.children;if(h[1]){var g=h[1].querySelector("#chRangeSelector");this.alive[this.Id]=new ZSClass.Editors.RangeEditor(g),ZSClass.RangePicker.register(this.alive[this.Id],!0),this.alive[this.Id].customPreventDefault=this.customPreventDefault.bind(this,this.Id),t&&(this.alive[this.Id].value=t),this.alive[this.Id].addListeners({mousedown:function(e){e.stopPropagation()}}),h[1].setAttribute("data-idx",this.Id)}h[2].setAttribute("data-index",this.Id),h[2].addEventListener("click",i.bind(this))}var u=p.getElementById("rangeWrapper");u.appendChild(l)}},t.prototype.updateRange=function(){d.close(),this.recallDialog()},t.prototype.updateRangeForSP=function(){this.hideRangeDomForSP(),this.updateDataRangeForSP()},t.prototype.cancelDialog=function(){d.close(),this.recallDialog()},t.prototype.cancelDialogForSp=function(){this.disableRangeEditor(),this.clearRangeCatch(),this.hideRangeDomForSP()},t.prototype.removeRangeDOM=function(e){var t=p.getElementById("rangeWrapper"),i=e.target.dataset;delete this.alive[i.index],t.removeChild(e.target.parentElement)},t.prototype.initCRDialog=function(){var t=e.UserAction.getTemplate(["CHART_RANGE_SELECTOR_TEMPLATE"]);c=r.createElement("div"),c.id="DI_CHART_RANGE_DIALOG",c.appendChild(t.CHART_RANGE_SELECTOR_TEMPLATE)},t.prototype.getPopulatedRanges=function(){var e="";return Object.keys(this.alive).forEach(function(t){var i=this.alive[t];e+=""!=i.value?i.value.trim()+";":""}.bind(this)),e},t.prototype.customPreventDefault=function(e,t){var i=t.keyCode||t.which;return 13==i?(this.updateRangeForSP(),!0):void 0},a.Manager.ZSCRManger=t}(this);
!function(e){function t(){Zt.Manager.ZSCRManger.call(this)}function a(e){var t=Zt.Wrapper.DOMUtils;t.addEventByNode(e,"click",function(){x(this.previousElementSibling.id)})}function n(){var e=Zt.Wrapper.DOMUtils;aa.bind("#dataLabelsFontSize","zselectboxchange",function(e,t){var a=t.value,n=Zt.Utility.getActiveChart(!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_SIZE,{PROPERTIES:{fontSize:a,cID:n}})}),aa.bind("#dataLabelsBold","click",function(){var t=e.toggleActive(this),a=""===t,n=Zt.Utility.getActiveChart(!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_WEIGHT,{PROPERTIES:{bold:a,cID:n}})}),aa.bind("#dataLabelsItalic","click",function(){var t=e.toggleActive(this),a=""===t,n=Zt.Utility.getActiveChart(!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_STYLE,{PROPERTIES:{italic:a,cID:n}})}),aa.bind("#dataLabelsFontColor","zcolorselectboxchange",function(e,t){var a=t.color,n=Zt.Utility.getActiveChart(!0),i=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),r=new Zt.Utility.ChartAgent,l=i.getDataLabelStyle()||{},o=(new Zt.Model.ChartModel).getRGBA(l.color||"#2d2d2d");a=(new Zt.Model.ChartModel).getRGBA(a);var g=r.isUniqueValue(o.replace(/ /g,""),a.replace(/ /g,""));g&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_COLOR,{PROPERTIES:{color:a,cID:n}})})}function r(){var e=Zt.Wrapper.DOMUtils;aa.bind("#chartPlotNameFont","zselectboxchange",function(e,t){var a=t.value,n=aa.zcombo("#plotlineValues","getValue"),i=Zt.Utility.getActiveChart(!0),r=new Zt.Utility.CommanAgent,l=parseInt(r.pickIntegerFromString(n))-1;if(!(0>l)){var o=na.getActiveYAxisIndex(i),g=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),c=g.getYAxis()[o],d=c.plotLines[l],s=d.label.style;s.fontSize=a,$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:s,yIndex:o,pIndex:l,ID:g.getID()}})}}),aa.bind("#chartPlotLineColor","zcolorchooserchange",function(e,t){var a=t.color,n=aa.zcombo("#plotlineValues","getValue"),i=Zt.Utility.getActiveChart(!0),r=new Zt.Utility.CommanAgent,l=parseInt(r.pickIntegerFromString(n))-1,o=na.getActiveYAxisIndex(i);if(!(0>l)){var g=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),c=g.getYAxis()[o],d=c.plotLines[l],s=d.color,v=new Zt.Model.ChartModel;a=v.getRGBA(a),s=v.getRGBA(s);var u=new Zt.Utility.ChartAgent,h=u.isUniqueValue(s.replace(/ /g,""),a.replace(/ /g,""));h&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.COLOR,{PROPERTIES:{color:a,yIndex:o,pIndex:l,ID:g.getID()}})}}),aa.bind("#chartPlotNameFontColor","zcolorselectboxchange",function(e,t){var a=t.color,n=aa.zcombo("#plotlineValues","getValue"),i=Zt.Utility.getActiveChart(!0),r=new Zt.Utility.CommanAgent,l=parseInt(r.pickIntegerFromString(n))-1,o=na.getActiveYAxisIndex(i);if(!(0>l)){var g=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),c=g.getYAxis()[o],d=c.plotLines[l],s=d.label.style,v=s.color||"#2d2d2d",u=new Zt.Model.ChartModel;a=u.getRGBA(a),v=u.getRGBA(v);var h=new Zt.Utility.ChartAgent,C=h.isUniqueValue(v.replace(/ /g,""),a.replace(/ /g,""));C&&(s.color=a),C&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:s,yIndex:o,pIndex:l,ID:g.getID()}})}}),e.addEvent("chartPlotNamebold",e.Events.CLICK,function(){var t=e.toggleActive(e.getElementById("chartPlotNamebold")),a=""!==t,n=aa.zcombo("#plotlineValues","getValue"),i=Zt.Utility.getActiveChart(!0),r=new Zt.Utility.CommanAgent,l=parseInt(r.pickIntegerFromString(n))-1,o=na.getActiveYAxisIndex(i);if(!(0>l)){var g=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),c=g.getYAxis()[o],d=c.plotLines[l],s=d.label.style;s.fontWeight=a?"bold":"normal",$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:s,yIndex:o,pIndex:l,ID:g.getID()}})}}),e.addEvent("chartPlotNameitalic",e.Events.CLICK,function(){var t=e.toggleActive(e.getElementById("chartPlotNameitalic")),a=""!==t,n=aa.zcombo("#plotlineValues","getValue"),i=Zt.Utility.getActiveChart(!0),r=new Zt.Utility.CommanAgent,l=parseInt(r.pickIntegerFromString(n))-1,o=na.getActiveYAxisIndex(i);if(!(0>l)){var g=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),c=g.getYAxis()[o],d=c.plotLines[l],s=d.label.style;s.fontStyle=a?"italic":"normal",$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:s,yIndex:o,pIndex:l,ID:g.getID()}})}}),aa.bind("#plotLineType","zmenuitemclick",function(e,t){var a=t.data,n=a.id,i=aa.zcombo("#plotlineValues","getValue"),r=Zt.Utility.getActiveChart(!0),l=new Zt.Utility.CommanAgent,o=parseInt(l.pickIntegerFromString(i))-1,g=na.getActiveYAxisIndex(r);if(!(0>o)){var c=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.DASHSTYLE,{PROPERTIES:{dashStyle:n,yIndex:g,pIndex:o,ID:c.getID()}})}})}function l(){var e=Zt.Wrapper.DOMUtils;e.addEvent("plotlineToggle","change",function(){var e=!this.checked,t=Zt.Utility.getActiveChart(!0),a=na.getActiveYAxisIndex(t);e&&na.removeAllPlotLine(t,a);var n=Zt.Utility.getChartMeta([t],!0);e&&n.removeAllPlotLine(a);var i=Jt.view.getActiveGridID(),r=Jt.view.getResourceID(i),l=Jt.view.getVersionID(i),o=Jt.view.getSheetID(i),g=new Zt.Controller.ZSCController;e&&g.removePlotline(r,o,l,n,{isYAxis:!0,plIndex:-1,index:a});var c=new Zt.Utility.AgentDom;e&&c.updateYAxisRelatedDom(na.getDialogMeta(t))}),aa.bind("#chartYAxisFontSize","zselectboxchange",function(e,t){var a=t.value,n=Zt.Utility.getActiveChart(!0),i=na.getActiveYAxisIndex(n);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_SIZE,{PROPERTIES:{fontSize:a,cID:n,props:{index:i}}})}),aa.bind("#chartYAxisBold","click",function(){var t=e.toggleActive(this),a=""===t,n=Zt.Utility.getActiveChart(!0),i=na.getActiveYAxisIndex(n);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_WEIGHT,{PROPERTIES:{bold:a,cID:n,props:{index:i}}})}),aa.bind("#chartYAxisItalic","click",function(){var t=e.toggleActive(this),a=""===t,n=Zt.Utility.getActiveChart(!0),i=na.getActiveYAxisIndex(n);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_STYLE,{PROPERTIES:{italic:a,cID:n,props:{index:i}}})}),aa.bind("#chartYAxisFontColor","zcolorselectboxchange",function(e,t){var a=t.color,n=Zt.Utility.getActiveChart(!0),i=na.getActiveYAxisIndex(n),r=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),l=new Zt.Utility.ChartAgent,o=r.getXAxis(),g=o.labels||{},c=g.style||{},d=c.color||(new Zt.Model.ChartModel).getRGBA("#4d4d4d",1),s=l.isUniqueValue(d.replace(/ /g,""),a.replace(/ /g,""));s&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_COLOR,{PROPERTIES:{color:a,cID:n,props:{index:i}}})})}function o(){aa.bind("#xAxisLabelFont","zselectboxchange",function(e,t){var a=t.value,n=Zt.Utility.getActiveChart(!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_SIZE,{PROPERTIES:{fontSize:a,cID:n,props:null}})}),aa.bind("#chartXAxisBold","click",function(){var e=Qt.toggleActive(this),t=""===e,a=Zt.Utility.getActiveChart(!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_WEIGHT,{PROPERTIES:{bold:t,cID:a,props:null}})}),aa.bind("#chartAxisItalic","click",function(){var e=Qt.toggleActive(this),t=""===e,a=Zt.Utility.getActiveChart(!0);$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_STYLE,{PROPERTIES:{italic:t,cID:a,props:null}})}),aa.bind("#chartAxisFontColor","zcolorselectboxchange",function(e,t){var a=t.color,n=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),i=n.getID(),r=new Zt.Utility.ChartAgent,l=n.getXAxis(),o=l.labels||{},g=o.style||{},c=g.color||(new Zt.Model.ChartModel).getRGBA("#4d4d4d",1),d=r.isUniqueValue(c.replace(/ /g,""),a.replace(/ /g,""));d&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_COLOR,{PROPERTIES:{color:a,cID:i,props:null}})})}function g(){var e=Zt.Wrapper.DOMUtils;e.addEventByNode(e.getElementById("binningInterval"),"change",function(t){var a=tt(t.target.value);if(!a)return e.getElementById("binningInterval").value="",void at();var n=""==t.target.value?0:t.target.value,i=Zt.Manager.SidePanelManager,r=i.getActiveChartID();na.updateBinningInterval(r,n)})}function c(){aa.bind("#seriesCaTransparency","zsliderchange",function(e,t){var a=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),n=t.value,i=parseFloat(parseFloat((100-n)/100).toFixed(2)),r=parseInt(aa.zcombo("#chartSeries","getValue")),l=a.getType(),o=!Zt.Utility.isCompositionChart(Zt.Utility.getChartMetaByIndex(a.getOptions(),a.getType(),r)),g=o?0:r,c=Zt.Utility.getSeriesColor(a.getOptions(),r,null,a.getInstance()[0]),d=new Zt.Model.ChartModel,s=d.getTransparency(c);c=d.getRGBA(c,i),s!=n&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:o,color:c,sIndex:o?r:0,pIndex:g,cType:l,cID:a.getID(),mCType:l}})}),aa.bind("#chartcustomcolorDropDown11","zcolorselectboxchange",function(e,t){var a=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),n=a.getType(),i=parseInt(aa.zcombo("#chartSeries","getValue")),r=t.color,l=!Zt.Utility.isCompositionChart(Zt.Utility.getChartMetaByIndex(a.getOptions(),a.getType(),i)),o=a.getID(),g=a.getCType(),c=aa.zslider("#seriesCaTransparency","getValue");c=parseFloat(parseFloat((100-c)/100).toFixed(2));var d=(new Zt.Model.ChartModel).getRGBA(r,c),s=Zt.Utility.getSeriesColor(a.getOptions(),i,void 0,a.getInstance()[0]);if(s=(new Zt.Model.ChartModel).getRGBA(s,c)){var v=new Zt.Utility.ChartAgent,u=v.isUniqueValue(s.replace(/ /g,""),d.replace(/ /g,""));u&&$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:l,color:d,sIndex:l?i:0,pIndex:l?0:i,cType:g,cID:o,mCType:n}})}}),aa.bind("#chartType","zmenuitemclick",function(e,t){for(var a=t.data,n=a.id,i=parseInt(aa.zcombo("#chartSeries","getValue")),r=na.getDialogMeta(Zt.Utility.getActiveChart(!0)),l=r.getComboTypes(),o=0;i>o;o++)!l[o]&&(l[o]="XYLINE");l[i]=n,r.setComboTypes(l),$t.publish(qt.UI,Xt.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES_TYPE,{PROPERTIES:{value:l.join(","),ID:r.getChartID(),META:r}})}),aa.bind("#chartSeries","zselectboxchange",function(){d.call(this)})}function d(){function e(e,t){var a={};return e.forEach(function(e){e.sIndex==t&&(a=e)}),a}var t=Zt.Utility.getChartMeta(Zt.Utility.getActiveChart(),!0),a=t.getOptions(),n=parseInt(aa.zcombo("#chartSeries","getValue")),i=t.getColors(),r=a.colorOptions,l=r.seriesColors,o=e(l,n),g=o.color||i[n%i.length],c=new Zt.Model.ChartModel,d=c.getTransparency(g);aa.zslider("#seriesCaTransparency","setValue",d),aa.zcolorselectbox("#chartcustomcolorDropDown11","setValue",g)}function s(){var e=Zt.Wrapper.DOMUtils,t=Zt.Constants.UnitFormat;aa.bind("#scaleType","zselectboxchange",function(e,a){function n(){v(),u();var e=+parseFloat(a.selectedValue),t=Zt.Manager.SidePanelManager,n=t.getActiveChartID();na.updateScaleFactor(n,e,na.getActiveYAxisIndex(n)||0)}function i(){v(),u();var e=Zt.Manager.SidePanelManager,t=e.getActiveChartID();na.updateUnitFactor(t,r,na.getActiveYAxisIndex(t)||0)}var r=a.selectedValue;switch(r){case"custom":h();break;case t.THOUSANDS:case t.MILLIONS:case t.BILLIONS:case t.DEFAULT:case t.NONE:i();break;default:n()}}),e.addEventByNode(e.getElementById("scaleCustomValue"),e.Events.INPUT,function(){var t=Q(this.value);if(!t)return e.getElementById("scaleCustomValue").value="",void at();var a=+parseFloat(this.value),n=Zt.Manager.SidePanelManager,i=n.getActiveChartID();na.updateScaleFactor(i,a,na.getActiveYAxisIndex(i)||0)})}function v(){var e=Zt.Wrapper.DOMUtils;e.getElementById("scaleCustomValue").value=""}function u(){var e=Zt.Wrapper.DOMUtils,t={display:"none"};e.addStyle("scaleCustomWrapper",t)}function h(){var e=Zt.Wrapper.DOMUtils,t={display:"table-row"};e.addStyle("scaleCustomWrapper",t)}function C(){var e=Zt.Constants.NumberFormat,t=Qt.getElementById("suffixNumberFormat"),a=Qt.getElementById("prefixNumberFormat");aa.bind("#numberFormatType","zselectboxchange",function(n,i){var r=Zt.Wrapper.DOMUtils;r.hideById("zsCustomNubFormatWrapper");var l=i.selectedValue,o=Zt.Manager.SidePanelManager,g=o.getActiveChartID()[0];switch(l==e.CUSTOM&&(r.addStyle("zsCustomNubFormatWrapper",{display:"table-row"}),a.value=na.getYAxiesByIndex(g,na.getActiveYAxisIndex(g)||0).prefix||"",t.value=na.getYAxiesByIndex(g,na.getActiveYAxisIndex(g)||0).suffix||""),l){case e.DEFAULT:na.setNumberFormat(g,{nfCode:e.DEFAULT,prefix:"",suffix:"",yIndex:na.getActiveYAxisIndex(g)||0});break;case e.THOUSANDS:na.setNumberFormat(g,{nfCode:e.THOUSANDS,prefix:"",suffix:"",yIndex:na.getActiveYAxisIndex(g)||0});break;case e.MILLIONS:na.setNumberFormat(g,{nfCode:e.MILLIONS,prefix:"",suffix:"",yIndex:na.getActiveYAxisIndex(g)||0});break;case e.BILLIONS:na.setNumberFormat(g,{nfCode:e.BILLIONS,prefix:"",suffix:"",yIndex:na.getActiveYAxisIndex(g)||0});break;case e.NONE:na.setNumberFormat(g,{nfCode:e.NONE,prefix:"",suffix:"",yIndex:na.getActiveYAxisIndex(g)||0})}}),Qt.addEventByNode(a,Qt.Events.INPUT,function(){var a=Zt.Manager.SidePanelManager,n=a.getActiveChartID();na.setNumberFormat(n,{nfCode:e.CUSTOM,prefix:this.value,suffix:t.value,yIndex:na.getActiveYAxisIndex(n)||0})}),Qt.addEventByNode(t,Qt.Events.INPUT,function(){var t=Zt.Manager.SidePanelManager,n=t.getActiveChartID();na.setNumberFormat(n,{nfCode:e.CUSTOM,prefix:a.value,suffix:this.value,yIndex:na.getActiveYAxisIndex(n)||0})})}function A(){var e=Zt.Wrapper.DOMUtils,t=e.getElementById("chartAggCombo0"),a={};a.width="100%",a.placeholder="Select column(s) to aggregate",a.maximumSelectionLength=3,a.templateSelection=p,aa.select2(t,a,"init")}function p(e){var t=Zt.Wrapper.DOMUtils,a=e.element,n=t.getAttribute(a,"type"),i=t.getAttribute(a,"id");if("NONE"===i)return"";var r=t.getAttribute(a,"value"),l=t.getAttribute(a,"header"),o=t.getAttribute(a,"displayValue"),g="DATE"===n||"DATETIME"===n?t.createElement("span",{id:i+"_date",value:r,header:l}):t.createElement("span",{id:i,value:r,header:l});if(g.innerText=o,t.addStyle(g,{display:"block"}),"DATE"===n||"DATETIME"===n){var c=Ft(r);Vt(g,c),t.addAttributes(g,{"data-menu-id":"aggDateMenu"}),t.addEventByNode(g,"click",Zt.Aggregation.selectedElementClicked)}return g}function S(){Qt.addEvent("c3DToggle",Qt.Events.CLICK,function(){var e=Qt.getElementById("c3DToggle").checked,t=Zt.Manager.SidePanelManager,a=t.getActiveChartID(),n=na.dialogMeta[a],i=n.getType();i=E(i,e),x(i)})}function E(e,t){var a={COL:"COL3D",BAR:"BAR3D",PIE:"PIE3D",DOUGHNUT:"DOUGHNUT3D",STACKEDCOL:"STACKEDCOL3D",STACKEDCOL_PERCENT:"STACKEDCOL3D_PERCENT",STACKEDBAR:"STACKEDBAR3D",STACKEDBAR_PERCENT:"STACKEDBAR3D_PERCENT"},n={COL3D:"COL",BAR3D:"BAR",PIE3D:"PIE",DOUGHNUT3D:"DOUGHNUT",STACKEDCOL3D:"STACKEDCOL",STACKEDCOL3D_PERCENT:"STACKEDCOL_PERCENT",STACKEDBAR3D:"STACKEDBAR",STACKEDBAR3D_PERCENT:"STACKEDBAR_PERCENT"};return t?a[e]:n[e]}function I(){var e=Zt.Manager.SidePanelManager;e.enableRangeEditor()}function T(){}function y(){Qt.addEventByNode(Qt.getElementByClassName("aggAddMore"),"click",function(){{var e=Zt.Aggregation,t=Zt.Aggregation.getLastIndex();Zt.Manager.SidePanelManager}e.constructNewcombo(t),e.getOptionsAndLoadInCombo(t,!0)}),Qt.addEventByNode(Qt.getElementById("resetAggregation"),"click",function(){{var e=Zt.Aggregation,t=Zt.Manager.SidePanelManager,a=t.getActiveMeta();t.getActiveChartID()}e.resetAggregation(a.getSeriesIn()),na.resetAggregation(t.getActiveChartID(),!0)}),aa.bind("#aggreoperation","zselectboxchange",function(e,t){var a=Zt.Manager.SidePanelManager,n=a.getActiveMeta();if(n){var i=a.getActiveChartID(),r=aa.select2("#chartAggCombo0",void 0,"getValue"),l="";r&&(l=r.join(";"));var o=n.getAggregationHeaderMapDetailsForAllHeaders(r);l="NONE"===t.value?"":l;var g=null!=l&&""!==l&&"NONE"!==t.value,c={type:t.value,colheaders:l,dateOperations:o,enabled:g},d=na.populateFilterColumnsIfNeeded(i,n.getAggregationOperation(),t.value);d&&na.updateFilter(i,"limitBy","NONE",!1);var s=r&&0!=r.length?!0:!1;na.updateAggregation(i,c,s)}});var e=Qt.getElementByClassName("select2-selection__rendered");aa.sortable(e,{axis:"x",update:function(){for(var e=Zt.Wrapper.DOMUtils,t=e.getElementsByClassName("select2-selection__choice"),a=[],n=0;n<t.length;n++)a.push(e.getAttribute(t[n].children[1],"value"));var i=f(a),r=null!=a&&""!==a,l={};l.colheaders=a.join(";"),l.dateOperations=i.join(","),l.enabled=r;var o=Zt.Manager.SidePanelManager;na.updateAggregation(o.getActiveChartID()[0],l,!0)}})}function f(e){for(var t=Zt.Manager.SidePanelManager,a=t.getActiveMeta(),n=a.getAggregationHeaderMap(),i=[],r=0;r<e.length;r++)for(var l=e[r],o=0;o<n.length;o++){var g=n[o];-1!==g.headers.indexOf(l)&&i.push(g.dateOperations)}return i}function m(){var e=Zt.Manager.SidePanelManager;Qt=Zt.Wrapper.DOMUtils,aa.bind("#filterSpinner","znumberfieldchange",function(){var t=na.isFilterRequestNeeded(e.getActiveChartID(),"limit");na.updateFilter(e.getActiveChartID(),"limit",Qt.getElementById("filterSpinner").value,t)}),aa.bind("#filterSpinner","znumberfieldspin",function(){var t=na.isFilterRequestNeeded(e.getActiveChartID(),"limit");na.updateFilter(e.getActiveChartID(),"limit",Qt.getElementById("filterSpinner").value,t)}),aa.bind("#filterType","zselectboxchange",function(t,a){var n=a.value,i=na.isFilterRequestNeeded(e.getActiveChartID(),"type"),r=new Zt.Utility.AgentDom;na.updateFilter(e.getActiveChartID(),"type",n,i),"NONE"===n&&r.resetFilterIfNeeded()}),aa.bind("#filterColumns","zselectboxchange",function(t,a){var n=a.value,i=new Zt.Utility.AgentDom;if("noFilter"===n)na.resetFilter(e.getActiveChartID(),!0),i.resetFilterIfNeeded();else{var r=na.isFilterRequestNeeded(e.getActiveChartID(),"limitBy");na.updateFilterMeta(e.getActiveChartID(),aa.zcombo("#filterType","getValue"),aa.zspinner("#filterSpinner","getValue")),na.updateFilter(e.getActiveChartID(),"limitBy",n,r)}});var t=Qt.getElementById("chartFilterReset");Qt.addEventByNode(t,"click",function(){var t=new Zt.Utility.AgentDom;t.resetFilterIfNeeded(),na.resetFilter(e.getActiveChartID(),!0)})}function M(){Qt.addEvent("xAxisLabel","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("xAxisLabel").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={};Object.keys(r).forEach(function(e){{var a=r[e],i=n.get(a);i.getDetails()}g.isYAxis=!1,g.labels=t,i&&i.updateXLabel(t),i&&o.push(i)});var c=i.getActiveMeta();c.updateXLabel(t),l.updateLabel(a[0],a[1],a[2],o[0],g)}}),aa.bind("#slant","zselectboxchange",function(e,t){var a=new Zt.Utility.ChartAgent,n="Auto"==t.value?null:parseInt(t.value),i=a.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=Zt.Manager.SidePanelManager,o=a.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d=null;Object.keys(o).forEach(function(e){var i=o[e];d=r.get(i);var l=(d.getOptions(),d&&a.isUniqueValue(n,d.getXSlant()));l&&d.updateXSlant(t),l&&c.push(d)});var s=l.getActiveMeta();s.updateXSlant(t),c[0]&&d&&g.updateXSlant(i[0],i[1],i[2],c[0],n)}}),aa.bind("#staggerLines","zselectboxchange",function(e,t){var a=new Zt.Utility.ChartAgent,n="auto"==t.value?null:t.value,i=a.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=Zt.Manager.SidePanelManager,o=a.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[];Object.keys(o).forEach(function(e){var i=o[e],l=r.get(i),g=(l.getOptions(),l&&a.isUniqueValue(n,l.getStaggerState()));g&&l.updateXStagger(t),g&&c.push(l)});var d=l.getActiveMeta();d.updateXStagger(t),c[0]&&g.updateStaggerLines(i[0],i[1],i[2],c[0],n)}})}function D(){var e=Zt.Manager.SidePanelManager;e.disableRangeEditor()}function P(e){na.updateTitleText(e)}function b(){function e(e){return 0==e.indexOf("=")&&B(e.substring(1))}var t=Zt.Manager.SidePanelManager,a=Qt.getElementById("titleTextBox"),n=null;Qt.addEventByNode(a,Qt.Events.INPUT,function(){var a=this.value;n&&clearTimeout(n),e(a)?na.updateTitleByRange(null,unescape(a.substring(1))):R(t.getActiveChartID(),a),n=setTimeout(function(){P(e(a)?a.substring(1):escape(a)),n=null},300)}),Qt.addEventByNode(a,Qt.Events.BLUR,function(){var t=this.value;n&&P(e(t)?t.substring(1):escape(t)),n&&clearTimeout(n)})}function R(e,t){oa.getRangePicker(ga.SP_TITLE_TEXT);na.updateClientTitleText(e,t)}function U(){var e=this.id,t=!1,a=null;if(a=na.getPreviousChartType(),a!=e){t=na.isPreviewOn();var n=new Zt.Utility.ChartAgent,i=na.dialogMeta[n.getActiveChartIDForSP()];i.setType(e),t&&na.createRequest("CHART_PREVIEW"),t&&na.setRecommedationSelection()}}function x(e){var t=Zt.Manager.SidePanelManager,a=t.getActiveMeta();if(a){var n=Zt.Wrapper.DOMUtils,i=new Zt.Utility.CommanAgent,r=e;a.setType(r);var l=i.checkIfDataApplicableForChartType(a,!0);if(!l)return void jt.ZSAlert(ta["Chart.Not.Allowed"],{title:ta["Alert.Title.InvalidSourceRange"]});var o=Jt.view.getActiveGridID(),g=Jt.view.getVersionID(o),c=Jt.view.getResourceID(o),d=Jt.data.getWorkBook(c,g),s=Jt.view.getSheetID(o),v=d.getSheetObj(s),u=v.Charts,h=Zt.Utility.getActiveChart(),C=new Zt.Utility.ChartAgent,A=new Zt.Controller.ZSCController,p=[],S=null;Object.keys(h).forEach(function(e){var t=h[e],a=u.get(t);if(a){var n=a.getDetails();S=n.type,a&&C.isUniqueValue(n.type,r)&&p.push(a)}});var A=new Zt.Controller.ZSCController,E=UserAction.getTemplate(["COL_ICON","STACKEDCOL_ICON","STACKEDCOL_PERCENT_ICON","BAR_ICON","STACKEDBAR_ICON","STACKEDBAR_PERCENT_ICON","XYLINE_ICON","SPLINE_ICON","STEPCHART_ICON","PIE_ICON","DOUGHNUT_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","SCATTER_ICON","XYLINE_SCATTER_ICON","BUBBLE_ICON","TIMELINE_ICON","TIMEAREA_ICON","CANDLESTICK_ICON","OHLCCHART_ICON","POLAR_ICON","SPIDERWEB_ICON","BULLETCOL_ICON","BULLETBAR_ICON","COMBOCHART_ICON","WATERFALL_ICON","FUNNEL_ICON","PARETO_ICON","HISTOGRAM_ICON","WORDCLOUD_ICON"]),I=(E[r+"_ICON"],"BUBBLE"===r?"BUBBLECHART":r);n.hideById("chartTypeMenuWrapper"),a.getType()==sa.COMBOCHART&&n.addStyle("chartTypeMenuWrapper",{display:""}),A.changeChartType(c,s,g,p,I),n.getElementById("chartTypeSpan").innerText=da[r]}}function O(){var e=new Zt.Manager.ZSCColorManager;e.hideColorScheme(),St(this),pt(this)}function w(){var e=new Zt.Manager.ZSCColorManager;e.hideColorScheme();var t=Qt.getIndex(this);-1!=t&&yt(t)}function L(){var e=-1===na.getState().indexOf("Edit")?"CHART_NEW":"CHART_EDIT",t=new Zt.Utility.CommanAgent,a=t.getRangeState(ga.DATA_RANGE);a?(na.createRequest(e),na&&na.clearCatch(),ia.close()):jt.ZSAlert(ta.InvalidRange,{title:ta["Alert.Title.InvalidSourceRange"]})}function N(){na&&na.clearCatch(),ia.close()}function B(e){e=e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");var t=e.split(";"),a=Jt.view.getActiveGridID(),n=Jt.view.getResourceID(a),i=Jt.view.getVersionID(a),r=!1;for(var l in t)try{if(""!==t[l]&&(t.length>1?(0==l&&(r=Ht(n,i,t[l],!0)),l>0&&(r=Ht(n,i,t[l],!1))):0==l&&(r=Ht(n,i,t[l],!0)),!r))return r}catch(e){return!1}return r}function _(e){Qt.hideById("combinedRangesWrapper"),e&&Qt.addStyle("combinedRangesWrapper",{display:"table-row"})}function F(){var e=new Zt.Utility.CommanAgent,t=new Zt.Utility.ChartAgent,a=e.getRangeState(ga.DATA_RANGE),n=e.getRangePicker(ga.DATA_RANGE);if(a){var i=n.value;i=i.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");var r=Zt.Manager.SidePanelManager;if(i=i.lastIndexOf(";")===i.length-1?i.slice(0,i.length-1):i,na.getSidePanelState()){var l=r.getActiveMeta(),o=l.getAssociatedSheetId(),g=l.getActiveSheet(),c=Y(o,g);c?(na.updateDataRangeForSP(r.getActiveChartID(),i),r.disableRangeEditor()):k(o,r.getActiveChartID()[0],i)}else na.updateDataRange(t.getActiveChartIDForSP(),i)}else jt.ZSAlert(ta.InvalidRange,{title:ta["Alert.Title.InvalidSourceRange"]})}function k(e,t,a){{var n=Jt.view.getActiveGridID(),i=Jt.view.getResourceID(n),r=Jt.view.getSheetID(n),l=Jt.view.getVersionID(n),o=e,g=Zt.Manager.SidePanelManager;new Promise(function(e){UserAction.SwitchSheet(i,r,l,o),setTimeout(function(){e()},10)}).then(function(){g.disableRangeEditor(),na.updateDataRangeForSP(t,a)})}}function Y(e,t){return e===t}function H(e){var t=new Zt.Utility.CommanAgent;t.setRangeState(ga.DATA_RANGE,e)}function V(e){e=e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");var t=e.trim().split(";");_(t.length>1)}function G(e){ca.addValidator(e,function(){return B(e.value)},function(){V(e.value),H(!0),e.Editor.style.border=""},function(){H(!1),e.Editor.style.border="1px solid red"},100)}function z(){var e=new Zt.Utility.ChartAgent;Qt.addEvent("rowChart","change",function(){Zt.Manager.SidePanelManager;na.updateSeriesIn(e.getActiveChartIDForSP(),Qt.getElementById("rowChart").checked,Qt.getElementById("columnChart").checked)}),Qt.addEvent("columnChart","change",function(){Zt.Manager.SidePanelManager;na.updateSeriesIn(e.getActiveChartIDForSP(),Qt.getElementById("rowChart").checked,Qt.getElementById("columnChart").checked)})}function W(){new Zt.Utility.ChartAgent;Qt.addEvent("rowChart","change",function(){var e=Zt.Manager.SidePanelManager;na.updateSeriesInForSP(e.getActiveChartID(),Qt.getElementById("rowChart").checked,Qt.getElementById("columnChart").checked)}),Qt.addEvent("columnChart","change",function(){var e=Zt.Manager.SidePanelManager;na.updateSeriesInForSP(e.getActiveChartID(),Qt.getElementById("rowChart").checked,Qt.getElementById("columnChart").checked)})}function Z(){new Zt.Utility.ChartAgent;Qt.addEvent("horizontally","change",function(){var e=Zt.Manager.SidePanelManager,t=e.getActiveChartID(),a=e.getActiveMeta(),n=new Zt.Utility.ChartAgent;if(a){var i=Qt.getElementById("horizontally").checked,r=(Qt.getElementById("vertically").checked,i?"HORIZONTAL":"VERTICAL");n.isUniqueValue(r,a.getCombinedWay())&&na.updateCombinedRange(t,r)}}),Qt.addEvent("vertically","change",function(){var e=Zt.Manager.SidePanelManager,t=e.getActiveChartID(),a=e.getActiveMeta(),n=new Zt.Utility.ChartAgent;if(a){var i=Qt.getElementById("horizontally").checked,r=(Qt.getElementById("vertically").checked,i?"HORIZONTAL":"VERTICAL");n.isUniqueValue(r,a.getCombinedWay())&&na.updateCombinedRange(t,r)}})}function j(){var e=new Zt.Utility.ChartAgent;Qt.addEvent("firstRow","change",function(){Zt.Manager.SidePanelManager;na.updateFirstRowAsLabel(e.getActiveChartIDForSP(),Qt.getElementById("firstRow").checked)}),Qt.addEvent("firstColumn","change",function(){Zt.Manager.SidePanelManager;na.updateFirstColumnAsLabel(e.getActiveChartIDForSP(),Qt.getElementById("firstColumn").checked)})}function X(){new Zt.Utility.ChartAgent;Qt.addEvent("firstRow","change",function(){var e=Zt.Manager.SidePanelManager;na.updateFirstRowAsLabelForSP(e.getActiveChartID(),Qt.getElementById("firstRow").checked)}),Qt.addEvent("firstColumn","change",function(){var e=Zt.Manager.SidePanelManager;na.updateFirstColumnAsLabelForSP(e.getActiveChartID(),Qt.getElementById("firstColumn").checked)})}function q(){var e=new Zt.Utility.ChartAgent;Qt.addEvent("tooltipToggle","change",function(){na.updateTooltip(e.getActiveChartIDForSP(),Qt.getElementById("tooltipToggle").checked)}),Qt.addEvent("zoomToggle","change",function(){na.updateZoom(e.getActiveChartIDForSP(),Qt.getElementById("zoomToggle").checked)}),Qt.addEvent("animationToggle","change",function(){na.updateAnimation(e.getActiveChartIDForSP(),Qt.getElementById("animationToggle").checked)}),Qt.addEvent("autoExpandToggle","change",function(){na.updateAutoExpand(e.getActiveChartIDForSP(),Qt.getElementById("autoExpandToggle").checked)}),Qt.addEvent("hddCellToggle","change",function(){var e=new Zt.Utility.ChartAgent;na.updateHiddenCell(e.getActiveChartIDForSP(),Qt.getElementById("hddCellToggle").checked)})}function K(){new Zt.Utility.ChartAgent;Qt.addEvent("tooltipToggle","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("tooltipToggle").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=(new Zt.Utility.ChartAgent,new Zt.Controller.ZSCController),o=[];Object.keys(r).forEach(function(e){{var t=r[e],a=n.get(t);a.getDetails()}a&&o.push(a)});var g=(i.getActiveChartID(),i.getActiveMeta());g.setTooltip(t),l.updateTooltip(a[0],a[1],a[2],o,t)}}),Qt.addEvent("chartGradientReverse","change",function(){na.updateChartGradientStatus(Zt.Utility.getActiveChart(!0),this.checked),na.updateSeriesGradientStatus(Zt.Utility.getActiveChart(!0),this.checked);var e=Jt.view.getActiveGridID(),t=Jt.view.getVersionID(e),a=Jt.view.getResourceID(e),n=(Jt.data.getWorkBook(a,t),Jt.view.getSheetID(e)),i=new Zt.Utility.ChartAgent,r=i.getChartMeta(Zt.Utility.getActiveChart(!0));r.setGradient(na.getDialogMeta(Zt.Utility.getActiveChart(!0)).getGradient());var l=new Zt.Controller.ZSCController;l.updateGradient(a,n,t,r)}),Qt.addEvent("seriesGradientReverse","change",function(){na.updateSeriesGradientStatus(Zt.Utility.getActiveChart(!0),this.checked);var e=Jt.view.getActiveGridID(),t=Jt.view.getVersionID(e),a=Jt.view.getResourceID(e),n=(Jt.data.getWorkBook(a,t),Jt.view.getSheetID(e)),i=new Zt.Utility.ChartAgent,r=i.getChartMeta(Zt.Utility.getActiveChart(!0));r.setGradient(na.getDialogMeta(Zt.Utility.getActiveChart(!0)).getGradient());var l=new Zt.Controller.ZSCController;l.updateGradient(a,n,t,r)}),Qt.addEvent("animationToggle","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("animationToggle").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[];Object.keys(r).forEach(function(e){{var t=r[e],a=n.get(t);a.getDetails()}a&&o.push(a)});var g=i.getActiveMeta();g.setAnimation(t),l.updateAnimation(a[0],a[1],a[2],o,t)}}),Qt.addEvent("autoExpandToggle","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("autoExpandToggle").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[];Object.keys(r).forEach(function(e){{var t=r[e],a=n.get(t);a.getDetails()}a&&o.push(a)});var g=(i.getActiveChartID(),i.getActiveMeta());g.setExpand(t),l.updateAutoExpand(a[0],a[1],a[2],o,t)}}),Qt.addEvent("hddCellToggle","change",function(){var e=(new Zt.Utility.ChartAgent,Zt.Manager.SidePanelManager),t=[e.getActiveChartID()];na.updateHiddenCellForSP(t[0],Qt.getElementById("hddCellToggle").checked)}),Qt.addEvent("markerToggle","change",function(){var e=this.checked,t=new Zt.Utility.ChartAgent,a=t.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=t.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[];Object.keys(r).forEach(function(t){var a=r[t],i=n.get(a);i.setMarkerState(e),i&&o.push(i)});var g=i.getActiveMeta();g.setMarkerState(e),l.updateLineMarker(a[0],a[1],a[2],o,e)}})}function $(){var e;e=new jt.Editors.RangeEditor(Qt.getElementById("ChartTitle"),!0,!0),e.customPreventDefault=Lt.bind(e),jt.RangePicker.register(e,!0,!0),oa.addRangePicker(ga.CHART_TITLE,e);var t;t=new jt.Editors.RangeEditor(Qt.getElementById("ChartSubTitle"),!0,!0),t.customPreventDefault=Lt.bind(t),jt.RangePicker.register(t,!0,!0),oa.addRangePicker(ga.CHART_SUBTITLE,t),ca.addValidator(e,function(){return B(e.value)},function(){na.updateTitleByRange(ga.CHART_TITLE,e.value)},function(){var t=new Zt.Utility.ChartAgent;na.updateTitle(t.getActiveChartIDForSP(),e.value)}),ca.addValidator(t,function(){return B(t.value)},function(){na.updateTitleByRange(ga.CHART_SUBTITLE,t.value)},function(){var e=new Zt.Utility.ChartAgent;na.updateSubTitle(e.getActiveChartIDForSP(),t.value)}),Qt.addEvent("ChartThreshold","keyup",function(){var e=new Zt.Utility.ChartAgent;na.updateThreshold(e.getActiveChartIDForSP(),Qt.getElementById("ChartThreshold").value)})}function J(){var e;e=new jt.Editors.RangeEditor(Qt.getElementById("xAxisTitle"),!0,!0),e.customPreventDefault=Lt.bind(e),jt.RangePicker.register(e,!0,!0),oa.addRangePicker(ga.CHART_X_AXIES,e),ca.addValidator(e,function(){return B(e.value)},function(){na.updateTitleByRange(ga.CHART_X_AXIES,e.value)},function(){var t=new Zt.Utility.ChartAgent;na.updateXTitle(t.getActiveChartIDForSP(),e.value,0)}),Qt.addEvent("xAxisLabel","change",function(){var e=new Zt.Utility.ChartAgent;na.updateXLabel(e.getActiveChartIDForSP(),Qt.getElementById("xAxisLabel").checked)}),aa.bind("#slant","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateXSlant(a.getActiveChartIDForSP(),t)}),aa.bind("#staggerLines","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateXStagger(a.getActiveChartIDForSP(),t)})}function Q(e){if(e&&""!=e){var t=parseFloat(e);return!isNaN(t)}return""==e?!0:!1}function et(e){if(e&&""!=e&&"."!=e){var t=parseFloat(e);return isNaN(t)?0:1}return""==e?2:"."==e?-1:0}function tt(e){if("undefined"!=typeof e&&""!=e){var t=parseInt(e);return!isNaN(t)}return""==e?!0:!1}function at(){var e=ta.InvalidRange;jt.ZSAlert(e,{title:ta["Alert.Title.InvalidSourceRange"]})}function nt(){Qt.addEvent("yAxisLabel","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("yAxisLabel").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=0;Object.keys(r).forEach(function(e){var a=r[e];c=na.getActiveYAxisIndex(a);{var i=n.get(a);i.getDetails()}g.isYAxis=!0,g.index=c,g.labels=t,i&&i.updateYLabel(t,c),i&&o.push(i)});var d=i.getActiveMeta();d.updateYLabel(t,c),l.updateLabel(a[0],a[1],a[2],o[0],g)}}),Qt.addEvent("min","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("min").value,a=Q(t);if(!a)return Qt.getElementById("min").value="",void at();var n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=Zt.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[],c={},d=0;Object.keys(l).forEach(function(e){var a=l[e];d=na.getActiveYAxisIndex(a);{var n=i.get(a);n.getDetails()}c.isYAxis=!0,c.index=d,c.min=""===t?void 0:+parseFloat(t),n&&n.updateYMin(t,d),n&&g.push(n)});var s=r.getActiveMeta();s.updateYMin(t,d),o.updateMin(n[0],n[1],n[2],g[0],c)}},1e3),Qt.addEvent("max","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("max").value,a=Q(t);if(!a)return Qt.getElementById("max").value="",void at();var n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=Zt.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[],c={},d=0;Object.keys(l).forEach(function(e){var a=l[e];d=na.getActiveYAxisIndex(a);{var n=i.get(a);n.getDetails()}c.isYAxis=!0,c.index=d,c.max=""===t?void 0:+parseFloat(t),n&&n.updateYMax(t,d),n&&g.push(n)});var s=r.getActiveMeta();s.updateYMax(t,d),o.updateMax(n[0],n[1],n[2],g[0],c)}},1e3),Qt.addEvent("interval","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("interval").value,a=Q(t);if(!a)return Qt.getElementById("interval").value="",void at();var n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=Zt.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[],c={},d=0;Object.keys(l).forEach(function(e){var a=l[e];d=na.getActiveYAxisIndex(a);{var n=i.get(a);n.getDetails()}c.isYAxis=!0,c.index=d,c.interval=""===t?void 0:+parseFloat(t),n&&n.updateYInterval(t,d),n&&g.push(n)});var s=r.getActiveMeta();s.updateYInterval(t,d),o.updateInterval(n[0],n[1],n[2],g[0],c)}},1e3),Qt.addEvent("majorGridLines","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("majorGridLines").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g=0;Object.keys(r).forEach(function(e){var a=r[e];g=na.getActiveYAxisIndex(a);{var i=n.get(a);i.getDetails()}i&&i.updateYMajor(t,g),i&&o.push(i)});var c=i.getActiveMeta();c.updateYMajor(t,g),l.updateMajor(a[0],a[1],a[2],o,t)}}),Qt.addEvent("minorGridLines","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("minorGridLines").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g=0;Object.keys(r).forEach(function(e){var a=r[e];g=na.getActiveYAxisIndex(a);{var i=n.get(a);i.getDetails()}i&&i.updateYMinor(t,g),i&&o.push(i)});var c=i.getActiveMeta();c.updateYMinor(t,g),l.updateMinor(a[0],a[1],a[2],o,t)}}),Qt.addEvent("yReverseToggle","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("yReverseToggle").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=0;Object.keys(r).forEach(function(e){var a=r[e];c=na.getActiveYAxisIndex(a),g.index=c,g.reversed=t,g.isYAxis=!0;{var i=n.get(a);i.getDetails()}i&&i.updateYReverse(t,c),i&&o.push(i)});var d=i.getActiveMeta();d.updateYReverse(t,c),l.updateReverse(a[0],a[1],a[2],o[0],g)}}),Qt.addEvent("yOppositeToggle","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("yOppositeToggle").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=0;Object.keys(r).forEach(function(e){var a=r[e];c=na.getActiveYAxisIndex(a),g.index=c,g.opposite=t,g.isYAxis=!0;{var i=n.get(a);i.getDetails()}i&&i.updateYOpposite(t,c),i&&o.push(i)});var d=i.getActiveMeta();d.updateYOpposite(t,c),l.updateOpposite(a[0],a[1],a[2],o[0],g)}}),Qt.addEvent("xReverseToggle","change",function(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("xReverseToggle").checked,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=0;Object.keys(r).forEach(function(e){var a=r[e];c=na.getActiveYAxisIndex(a),g.index=c,g.reversed=t,g.isYAxis=!1;{var i=n.get(a);i.getDetails()}i&&i.updateXReverse(t),i&&o.push(i)});var d=i.getActiveMeta();d.updateXReverse(t,0),l.updateReverse(a[0],a[1],a[2],o[0],g)}}),Qt.addEvent("LogarthimicToggle","change",function(){var e=Zt.Wrapper.DOMUtils,t={display:""};e.getElementById("LogarthimicToggle").checked?e.addStyle("baseValueWrapper",t):e.hideById("baseValueWrapper");var a=new Zt.Utility.ChartAgent,n=e.getElementById("LogarthimicToggle").checked,i=a.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=Zt.Manager.SidePanelManager,o=a.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d={},s=0;Object.keys(o).forEach(function(e){var t=o[e];s=na.getActiveYAxisIndex(t),d.index=s,d.logarithmic=n,d.isYAxis=!0;{var a=r.get(t);a.getDetails()}a&&a.updateYLogarithmic(n,s),a&&c.push(a)});var v=l.getActiveMeta();v.updateYLogarithmic(n,s),g.updateLogarithmic(i[0],i[1],i[2],c[0],d)}}),aa.bind("#baseValue","znumberfieldchange",function(){zt()}),aa.bind("#baseValue","znumberfieldspin",function(){zt()}),Qt.addEvent("multiyaxisYes","change",function(){var e=Zt.Manager.SidePanelManager;Qt.showById("addPlotLine"),na.updateMultiYAxiesForSP(e.getActiveChartID()[0],Qt.getElementById("multiyaxisYes").checked);var t=Qt.getElementById("yAxisWrapper");this.checked?Qt.addClass(t,"wrapMultiAxies"):Qt.removeClass(t,"wrapMultiAxies")}),aa.bind("#yaxisMulti","zselectboxchange",function(e,t){var a=(new Zt.Utility.ChartAgent,Zt.Manager.SidePanelManager);na.updateMultiYAxiesDom(a.getActiveChartID()[0],t)}),Qt.addEvent("addPlotLine","click",function(){var e=(new Zt.Utility.ChartAgent,Zt.Manager.SidePanelManager);na.addPlotLine(e.getActiveChartID()[0])})}function it(){var e;e=new jt.Editors.RangeEditor(Qt.getElementById("yAxisTitle"),!0,!0),e.customPreventDefault=Lt.bind(e),jt.RangePicker.register(e,!0,!0),oa.addRangePicker(ga.CHART_Y_AXIES,e),ca.addValidator(e,function(){return B(e.value)},function(){na.updateTitleByRange(ga.CHART_Y_AXIES,e.value)},function(){var t=new Zt.Utility.ChartAgent;na.updateYTitle(t.getActiveChartIDForSP(),e.value)}),Qt.addEvent("yAxisLabel","change",function(){var e=new Zt.Utility.ChartAgent;na.updateYLabel(e.getActiveChartIDForSP(),Qt.getElementById("yAxisLabel").checked)}),Qt.addEvent("PlotlineValue0","keyup",function(){var e=new Zt.Utility.ChartAgent;na.updateYPlotline(e.getActiveChartIDForSP(),Qt.getElementById("PlotlineValue0").value,na.getActiveYAxisIndex("preview"),0)}),Qt.addEvent("min","change",function(){var e=new Zt.Utility.ChartAgent;na.updateYMin(e.getActiveChartIDForSP(),Qt.getElementById("min").value,na.getActiveYAxisIndex("preview"))}),Qt.addEvent("max","change",function(){var e=new Zt.Utility.ChartAgent;na.updateYMax(e.getActiveChartIDForSP(),Qt.getElementById("max").value,na.getActiveYAxisIndex("preview"))}),Qt.addEvent("interval","change",function(){var e=new Zt.Utility.ChartAgent;na.updateYInterval(e.getActiveChartIDForSP(),Qt.getElementById("interval").value,na.getActiveYAxisIndex("preview"))}),Qt.addEvent("majorGridLines","change",function(){var e=new Zt.Utility.ChartAgent;na.updateYMajorGrid(e.getActiveChartIDForSP(),Qt.getElementById("majorGridLines").checked,na.getActiveYAxisIndex("preview"))}),Qt.addEvent("minorGridLines","change",function(){na.updateYMinorGrid(chartAgent.getActiveChartIDForSP(),Qt.getElementById("minorGridLines").checked,na.getActiveYAxisIndex("preview"))}),Qt.addEvent("multiyaxisYes","change",function(){var e=new Zt.Utility.ChartAgent;Qt.showById("addPlotLine"),na.updateMultiYAxies(e.getActiveChartIDForSP(),Qt.getElementById("multiyaxisYes").checked)}),aa.bind("#yaxisMulti","change",function(e,t){var a=new Zt.Utility.ChartAgent;delete t.combo,na.updateMultiYAxiesDom(a.getActiveChartIDForSP(),t)}),Qt.addEvent("addPlotLine","click",function(){var e=new Zt.Utility.ChartAgent;na.addPlotLine(e.getActiveChartIDForSP())})}function rt(){aa.bind("#legendPos","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateLegend(a.getActiveChartIDForSP(),t)}),aa.bind("#dataLabels","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateDataLabels(a.getActiveChartIDForSP(),t)}),aa.bind("#trendlineType","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateTrendtype(a.getActiveChartIDForSP(),t)}),aa.bind("#trendlinePeriod","spinnerchange",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateTrendDegree(a.getActiveChartIDForSP(),t)}),aa.bind("#trendlineDegree","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateTrendDegree(a.getActiveChartIDForSP(),t)}),aa.bind("#combinedRanges","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateCombinedWay(a.getActiveChartIDForSP(),t)}),aa.bind("#chartTitle","change",function(e,t){delete t.combo;var a=new Zt.Utility.ChartAgent;na.updateTitleForSp(a.getActiveChartIDForSP(),t)})}function lt(){var e=Zt.Manager.SidePanelManager,t=e.getActiveChartID();na.updateTitleIndex(t,aa.zcombo("#chartTitleCombo","getValue")),na.updateTitleForSp(t,aa.zcombo("#chartTitleCombo","getValue"));var a=Zt.Wrapper.DOMUtils;a.getElementById("titleTextBox").focus()}function ot(){aa.bind("#dataLabels","zselectboxchange",function(e,t){var a=t.value,n=new Zt.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[];Object.keys(l).forEach(function(e){var t=l[e],i=r.get(t),o=i.getDetails();i&&n.isUniqueValue(a,o.lf)&&g.push(i)}),o.updateDataLabel(i[0],i[1],i[2],g,a)}})}function gt(){aa.bind("#legendPos","zselectboxchange",function(e,t){var a=t.value,n=new Zt.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){{var r=i[3],l=n.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[];e.target.position}Object.keys(l).forEach(function(e){{var t=l[e],n=r.get(t);n.getDetails()}a=n.getLegendPositionByName(a),0==a&&Zt.Client.Action.destroyContextualToolbar(),n&&g.push(n)}),o.updateLegend(i[0],i[1],i[2],g,a)}}),aa.bind("#legendFont","zselectboxchange",function(e,t){var a=t.value,n=new Zt.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[],c={};Object.keys(l).forEach(function(e){var t=l[e],i=r.get(t),o=i.getOptions();c=i.getUpdateLegendStyle({fontSize:a});var d=i&&n.isUniqueValue(a,o.legend.itemStyle.fontSize);d&&i.updateLegendStyle(c),d&&g.push(i)}),o.updateLegendStyle(i[0],i[1],i[2],g[0],c)}}),aa.bind("#chartBold","click",function(){var e=Zt.Wrapper.DOMUtils,t=e.getElementById("chartBold"),a=e.toggleActive(t),n=""===a?!1:!0,i=new Zt.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d={};Object.keys(o).forEach(function(e){var t=o[e],a=l.get(t),i=(a.getOptions(),n?"bold":"normal");d=a.getUpdateLegendStyle({fontWeight:i}),a&&a.updateLegendStyle(d),a&&c.push(a)}),g.updateLegendStyle(r[0],r[1],r[2],c[0],d)}}),aa.bind("#chartitalic","click",function(){var e=Zt.Wrapper.DOMUtils,t=e.getElementById("chartitalic"),a=e.toggleActive(t),n=""===a?!1:!0,i=new Zt.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d={};Object.keys(o).forEach(function(e){var t=o[e],a=l.get(t),i=(a.getOptions(),n?"italic":"normal");d=a.getUpdateLegendStyle({fontStyle:i}),a&&a.updateLegendStyle(d),a&&c.push(a)}),g.updateLegendStyle(r[0],r[1],r[2],c[0],d)}}),aa.bind("#chartFontColor2","zcolorselectboxchange",function(e,t){var a=(Zt.Wrapper.DOMUtils,t.color),n=new Zt.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[],c={},d="";Object.keys(l).forEach(function(e){var t=l[e],n=r.get(t),i=n.getOptions();d=i.legend.itemStyle.color,c=n.getUpdateLegendStyle({color:a}),n&&n.updateLegendStyle(c),n&&g.push(n)});var s=n.isUniqueValue(d,a);s&&o.updateLegendStyle(i[0],i[1],i[2],g[0],c)}})}function ct(){var e=Zt.Wrapper.DOMUtils;ot(),gt(),e.addEvent("trendLineToggle",e.Events.CLICK,function(){var e=this.checked,t=e?"Linear":"None",a=new Zt.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=Zt.Manager.SidePanelManager,r=n[3],l=a.getSPActiveChartID(),o=new Zt.Controller.ZSCController,g=[],c=i.getActiveMeta();c.setTrendline(e),Object.keys(l).forEach(function(e){var n=l[e],i=r.get(n),o=i.getDetails(),c=i&&a.isUniqueValue(t.toLowerCase(),o.tlType);c&&i.updateTrendtype({value:t}),c&&g.push(i)}),o.updateTrendlineType(n[0],n[1],n[2],g,t.toLowerCase())}}),aa.bind("#trendlineType","zselectboxchange",function(e,t){var a=new Zt.Utility.ChartAgent,n=t.value,i=a.getChartMapFromSheet();if(!(i.length<4)){var r=Zt.Manager.SidePanelManager,l=i[3],o=a.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d=r.getActiveMeta();d.updateTrendtype(t),Object.keys(o).forEach(function(e){var i=o[e],r=l.get(i),g=r.getDetails(),d=r&&a.isUniqueValue(n.toLowerCase(),g.tlType);d&&r.updateTrendtype(t),d&&c.push(r)}),g.updateTrendlineType(i[0],i[1],i[2],c,n.toLowerCase())}}),aa.bind("#tlPeriod","znumberfieldchange",function(e,t){Wt(t)}),aa.bind("#tlPeriod","znumberfieldspin",function(e,t){Wt(t)}),aa.bind("#chartfontfamilys","zselectboxchange",function(e,t){var a=new Zt.Utility.ChartAgent,n=t.value,i=a.getChartMapFromSheet(),r=Zt.Manager.SidePanelManager;if(!(i.length<4)){var l=i[3],o=a.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d={};d.style={},Object.keys(o).forEach(function(e){{var t=o[e],a=l.get(t);a.getDetails()}d.style.fontFamily=n,a&&a.updateFontFamily(d.style),a&&c.push(a)});var s=r.getActiveMeta();s.updateFontFamily(d.style),g.updateFontFamily(i[0],i[1],i[2],c[0],d)}}),aa.bind("#trendlineDegree","zselectboxchange",function(e,t){var a=new Zt.Utility.ChartAgent,n=t.value,i=a.getChartMapFromSheet(),r=Zt.Manager.SidePanelManager;if(!(i.length<4)){var l=i[3],o=a.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[];Object.keys(o).forEach(function(e){var i=o[e],r=l.get(i),g=r.getDetails(),d=r&&a.isUniqueValue(n,g.order);d&&r.updateTrendDegree(t),d&&c.push(r)});var d=r.getActiveMeta();d.updateTrendDegree(t),g.updateTrendlineDegree(i[0],i[1],i[2],c,parseInt(n))}}),aa.bind("#chartTitleCombo","zselectboxchange",function(){lt()}),aa.bind("#chartFont","zselectboxchange",function(e,t){var a=new Zt.Utility.ChartAgent,n=aa.zcombo("#chartTitleCombo","getValue"),i=a.getSPActiveChartID(),r=na.getSubAction(n,i),l=na.getTitleStyle(n,i),o=a.getChartMapFromSheet(),g=Zt.Manager.SidePanelManager;if(!(o.length<4)){var c=o[3],d=new Zt.Controller.ZSCController,s=c.get(i),v={};l.fontSize=t.value,v.style=l,r==Aa.CHART_Y_AXIS_TITLE_STYLE&&(v.index=na.getActiveTitleIndex(i));var u=g.getActiveMeta();u.updateTitleStyle(r,l),s.updateTitleStyle(a.fetchTitleLabelBasedOnSubAction(r),l,v.index),d.updateTitleStyle(o[0],o[1],o[2],s,v,r)}}),e.addEventByNode(e.getElementById("chartTitlebold"),"click",function(){var e=aa.zcombo("#chartTitleCombo","getValue"),t=new Zt.Utility.ChartAgent,a=t.getSPActiveChartID(),n=Zt.Wrapper.DOMUtils,i=n.toggleActive(n.getElementById("chartTitlebold")),r=""===i?!1:!0,l=na.getSubAction(e,a),o=na.getTitleStyle(e,a),g=t.getChartMapFromSheet(),c=Zt.Manager.SidePanelManager;if(!(g.length<4)){var d=g[3],s=new Zt.Controller.ZSCController,v=d.get(a),u={};o.fontWeight=r?"bold":"normal",u.style=o,l==Aa.CHART_Y_AXIS_TITLE_STYLE&&(u.index=na.getActiveTitleIndex(a));var h=c.getActiveMeta();h.updateTitleStyle(l,o),v.updateTitleStyle(t.fetchTitleLabelBasedOnSubAction(l),o,u.index),s.updateTitleStyle(g[0],g[1],g[2],v,u,l)}}),aa.bind("#chartTitleitalic","click",function(){var e=aa.zcombo("#chartTitleCombo","getValue"),t=new Zt.Utility.ChartAgent,a=t.getSPActiveChartID(),n=Zt.Wrapper.DOMUtils,i=n.toggleActive(n.getElementById("chartTitleitalic")),r=""===i?!1:!0,l=Zt.Manager.SidePanelManager,o=na.getSubAction(e,a),g=na.getTitleStyle(e,a),c=t.getChartMapFromSheet();if(!(c.length<4)){var d=c[3],s=d.get(a),v=new Zt.Controller.ZSCController,u={};g.fontStyle=r?"italic":"normal",u.style=g,o==Aa.CHART_Y_AXIS_TITLE_STYLE&&(u.index=na.getActiveTitleIndex(a));var h=l.getActiveMeta();h.updateTitleStyle(o,g),s.updateTitleStyle(t.fetchTitleLabelBasedOnSubAction(o),g,u.index),v.updateTitleStyle(c[0],c[1],c[2],s,u,o)}}),aa.bind("#chartTitleFontColor","zcolorselectboxchange",function(e,t){var a=aa.zcombo("#chartTitleCombo","getValue"),n=Zt.Manager.SidePanelManager,i=new Zt.Utility.ChartAgent,r=i.getSPActiveChartID(),l=na.getTitleStyle(a,r),o=na.getSubAction(a,r),g=i.getChartMapFromSheet();if(!(g.length<4)){var c=g[3],d=c.get(n.getActiveChartID()),s=new Zt.Controller.ZSCController,v={},u=i.getRGBAColor(l.color);l.color=t.color,v.style=l,o==Aa.CHART_Y_AXIS_TITLE_STYLE&&(v.index=na.getActiveTitleIndex(r));var h=n.getActiveMeta();h.updateTitleStyle(o,l),d.updateTitleStyle(i.fetchTitleLabelBasedOnSubAction(o),l,v.index);var C=i.isUniqueValue(t.color.replace(/\s/g,""),u.replace(/\s/g,""));C&&s.updateTitleStyle(g[0],g[1],g[2],d,v,o)}})}function dt(){aa.bind("#chartcustomcolorDropDown1","zcolorselectboxchange",function(e,t){var a=t.color,n=new Zt.Utility.ChartAgent,i=Zt.Manager.SidePanelManager,r=n.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=n.getSPActiveChartID(),g=new Zt.Controller.ZSCController,c=[],d={},s=i.getActiveMeta(),v=s.getOptions().chart.backgroundColor||ua,u=(new Zt.Model.ChartModel).getTransparencyQuotient(v),h=(new Zt.Model.ChartModel).getRGBA(v);1>u&&(a=(new Zt.Model.ChartModel).getRGBA(a,u)),Object.keys(o).forEach(function(e){var t=o[e],n=l.get(t);if(n){{n.getDetails()}n&&n.updateChartColor(a),n&&c.push(n),d.cbc=a,d.pbc=a}});var C=n.isUniqueValue(a.replace(/ /g,""),h.replace(/ /g,""));C&&s.updateChartColor(a),C&&g.updateCBC(r[0],r[1],r[2],c[0],d)}}),aa.bind("#caTransparency","zsliderchange",function(e,t){var a=t.value,n=parseFloat(parseFloat((100-a)/100).toFixed(2)),i=Zt.Manager.SidePanelManager,r=new Zt.Utility.ChartAgent,l=r.getChartMapFromSheet();if(!(l.length<4)){var o=l[3],g=r.getSPActiveChartID(),c=o.get(g[0]),d=c.getOptions().chart.backgroundColor||ua,s=(new Zt.Model.ChartModel).getRGBA(d,n),v=new Zt.Controller.ZSCController,u=[],h={};Object.keys(g).forEach(function(e){var t=g[e],a=o.get(t);if(a){{a.getDetails()}a&&a.updateChartColor(s),a&&u.push(a),h.cbc=s,h.pbc=s}});var C=i.getActiveMeta(),A=r.isUniqueValue(s.replace(/ /g,""),d.replace(/ /g,""));A&&C.updateChartColor(s),A&&v.updateCBC(l[0],l[1],l[2],u[0],h)}})}function st(){aa.bind("#chartcustomcolorDropDown3","zcolorselectboxchange",function(e,t){var a=t.color,n=new Zt.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new Zt.Controller.ZSCController,n=new Zt.Utility.ChartAgent,g=[],c={};Object.keys(l).forEach(function(e){{var t=l[e],n=r.get(t);n.getDetails()}c.glColor=a,c.index=0,n&&n.updateGCColor(a),n&&g.push(n)});var d=Zt.Manager.SidePanelManager,s=d.getActiveMeta(),v=s.getOptions().yAxis[0].gridLineColor||ua,u=(new Zt.Model.ChartModel).getRGBA(v),h=n.isUniqueValue(a.replace(/ /g,""),u.replace(/ /g,""));h&&o.updateGC(i[0],i[1],i[2],g[0],c)}})}function vt(){Qt.addEvent("chartThemePallate","click",function(){var e=new Zt.Manager.ZSCColorManager;e.showColorScheme(this)})}function ut(){Qt.addEvent("previewAn","click",function(){ht()})}function ht(){var e=!na.isPreviewOn();na.setPreviewStatus(e),Ct(e)}function Ct(e){var t=ia.getDialog();if(t.style.transition="300ms linear",e){if(window.innerWidth<=parseInt(t.offsetLeft)+parseInt(t.offsetWidth)+500){var a="-="+(parseInt(t.offsetLeft)+parseInt(t.offsetWidth)+520-window.innerWidth);t.style.left=a+"px"}t.style.width="1020px",setTimeout(function(){At()},100)}else Qt.hideById("preview"),t.style.width="520px"}function At(){na.createRequest("CHART_PREVIEW"),na.setRecommedationSelection()}function pt(e,t){for(var t=t||Qt.getIndex(e),a=Qt.getElementsByClassName("chartTypeHolder"),n=a.length,i=0;n>i;i++)Qt.hide(a[i]);return Qt.show(a[t]),!0}function St(e,t){for(var a=Qt.getElementByClassName("chrtTypeTab"),n=a.children,t=t||Qt.getIndex(e),i=n.length,r=0;i>r;r++)r!=t?Qt.removeClass(n[r],"active"):Qt.addClass(n[r],"active");return!0}function Et(e){var t=["chartGeneral","chartType","chartOption","chartAxis","Advanced"];for(i=0;i<t.length;i++)e!==i&&Qt.hideById(t[i]);var a=Qt.getElementByClassName("chrtTabList"),n=a.children,r=n.length;for(i=0;r>i;i++)e!==i&&Qt.removeClass(n[i],"active");return t[e]}function It(e){switch(e){case"chartOption":case"chartAxis":break;case"chartGeneral":na.checkToPerformUnProcessedTask();break;case"chartType":Tt()}}function Tt(e){var t=na.getActiveMeta(),a=e||t.getType();a=-1!==a.indexOf("BUBBLE")?"BUBBLE":a,Qt.getElementById(a).checked=!0;var n=Qt.getElementById(a);-1!==a.indexOf("3D")&&St(void 0,1)&&pt(void 0,1),n&&(Qt.getElementByClassName("chartTypeHolder").scrollTop=n.parentElement.offsetTop-34)}function yt(e){var t=Et(e);Qt.showById(t),Qt.addClass(Qt.getElementByClassName("chrtTabList").children[e],"active"),na.updateCurrentTabName(),It(t)}function ft(e){var t=e.getActiveSheet(),a=e.getRange();if(null!=a&&""!==a){var n=e.getSeriesIn(),i=e.getCombinedWay(),r=e.getFirstRowAsLabel(),l=e.getFirstColAsLabel(),o=e.getHiddenCellState(),g=!1,c=Jt.view.getActiveGridID(),d=Jt.view.getResourceID(c),s=Jt.view.getVersionID(c),v=Jt.view.getSheetID(c),u={};u.parameters={seriesIn:n,dataRange:a,currentSheet:t,appedingWay:i,fcl:l,frl:r,isIncludeHiddenCells:o,isAndroidClient:g},u.url="useraction",u.action="GET_CHART_RECOMMENDATION",Zt.Server.Action.updatePreview(d,v,s,u,na.processRecommendationResponse.bind(na))}}function mt(){return ia.getDialog()}function Mt(e){var t=e.target,a=t.dataset;ha=!1;var n=et(t.value);if(0==n)return void at();if(!(0>n)){if(2==n)return void xt(e);if(na.getSidePanelState()){var i=e.keyCode||e.which;13===i?Rt(e,!1):(clearTimeout(),Rt(e,!0),setTimeout(function(){!ha&&Rt(e,!1),ha=!0},1e3))}else na.updateYPlotline("preview",t.value,na.getActiveYAxisIndex("preview"),a.index)}}function Dt(e){var t=e.target,a=t.dataset;ha=!1;{var n=Zt.Utility.getActiveChart(!0);na.getActiveYAxisIndex(n)}if(na.getSidePanelState()){var i=e.keyCode||e.which;13===i?Ut(e,!1):(clearTimeout(),Ut(e,!0),setTimeout(function(){!ha&&Ut(e,!1),ha=!0},1e3))}else na.updateYPlotlineName("preview",t.value,na.getActiveYAxisIndex("preview"),a.index)}function Pt(){var e=Zt.Manager.SidePanelManager;na.addPlotLine(e.getActiveChartID())}function bt(e){var t=e.target,a=t.parentElement.parentElement,n=t.dataset,i=n.index;Qt.showById("addPlotLine"),Qt.getElementById("plotLineWrapper").removeChild(a),na.getSidePanelState()?setTimeout(function(){xt(e,!1)},1e3):na.removeYPlotline("preview",na.getActiveYAxisIndex("preview"),i)}function Rt(e,t){var a=(e.target.value,new Zt.Utility.ChartAgent),n=a.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=a.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=Zt.Manager.SidePanelManager;Object.keys(r).forEach(function(t){{var a=r[t],n=na.getActiveYAxisIndex(a),l=i.get(a);l.getDetails()}g.isYAxis=!0,g.index=n,g.plIndex=e.target.dataset.index,g.plValue=e.target.value,l&&l.addNewPlotline(g),l&&o.push(l)});var d=c.getActiveMeta();d.addNewPlotline(g),l.addPlotLines(n[0],n[1],n[2],o[0],g,t)}}function Ut(e,t){var a=(e.target.value,new Zt.Utility.ChartAgent),n=a.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=a.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=Zt.Manager.SidePanelManager;Object.keys(r).forEach(function(t){{var a=r[t],n=na.getActiveYAxisIndex(a),l=i.get(a);l.getDetails()}g.isYAxis=!0,g.index=n,g.plIndex=e.target.dataset.index,g.title=e.target.value,l&&l.updatePlotLineName(g),l&&o.push(l)});var d=c.getActiveMeta();d.updatePlotLineName(g),l.addPlotLineName(n[0],n[1],n[2],o[0],g,t)}}function xt(e,t){var a=new Zt.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=a.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=Zt.Manager.SidePanelManager;Object.keys(r).forEach(function(t){{var a=r[t],n=na.getActiveYAxisIndex(a),l=i.get(a);l.getDetails()}g.isYAxis=!0,g.index=n;var c=(e.target.previousElementSibling.id,e.target.dataset),d=c.index;g.plIndex=d,g.plValue=void 0,l&&l.removePlotlineByIndex(g),l&&o.push(l)});var d=c.getActiveMeta();d.removePlotlineByIndex(g),l.removePlotline(n[0],n[1],n[2],o[0],g,t)}}function Ot(e){var t=e.keyCode||e.which;switch(t){case 65:if(!e.metaKey)return;case 37:case 38:case 39:case 40:setTimeout(function(){this.selectionChanged()}.bind(this),0)}13===t&&(e.preventDefault(),"titleTextBox"===e.target.id?wt():F())}function wt(){var e=oa.getRangePicker(ga.SP_TITLE_TEXT);va?na.updateTitleByRange(ga.SP_TITLE_TEXT,e.value):na.updateTitleText(encodeURIComponent(e.value.replace(/\u00a0/g," ")))}function Lt(e){return Ot.call(this,e),!0}function Nt(e){var t=e.params.data.id,a=Zt.Aggregation,n=Zt.Manager.SidePanelManager,i=n.getActiveMeta(),r=i.getSeriesIn(),l=i.getFirstRowAsLabel(),o=i.getFirstColAsLabel();a.aggregationComboChanged(t,r,o,l);var g=n.getActiveChartID(),c=i.getAggregationColHeaders(),d=i.getAggregationDateOperations();if(0==c.length)c.push(t);else{var s=0;for(s=0;s<c.length;s++){var v=!1;if(-1!==c[s].replace(/\'/g,"").indexOf(t)){v=!0;break}}v?(c.splice(s,1),d=a.spliceDateOperations(d,s)):(c.push(t),d=a.getDateOperations(d,s,"NONE"))}var u=c.join(";"),h=aa.zcombo("#aggreoperation","getValue"),C=null!=u&&""!==u&&"NONE"!==h;(null==u||""==u)&&a.enableLabelCheckBox(r);var A={colheaders:u,dateOperations:d,type:h,enabled:C},p="NONE"===h?!1:!0;na.updateAggregation(g,A,p)}function Bt(e){var t=Zt.Manager.SidePanelManager,a=t.getActiveMeta(),n=a.getAggregationColHeaders(),i=!1;for(var r in n){var l=n[r],o=l.replace(/'/g,"");if(i=-1!==o.indexOf(e))break}return i?r:-1}function _t(e){var t=(Zt.Manager.SidePanelManager,aa.select2("#chartAggCombo0",void 0,"getValue")),a=-1;return t&&(a=t.indexOf(e)),a}function Ft(e){var t=Bt(e),a=Zt.Manager.SidePanelManager,n=a.getActiveMeta(),i=n.getDepthOperation(t);return i}function kt(e,t){var a=Zt.Aggregation,n=Zt.Manager.SidePanelManager,i=n.getActiveChartID(),r=n.getActiveMeta(),l=r.getAggregationDateOperations();l=a.getDateOperations(l,e,t);var o=aa.select2("#chartAggCombo0",void 0,"getValue"),g="";o&&(g=o.join(";"));var c=aa.zcombo("#aggreoperation","getValue"),d=null!=g&&""!==g&&"NONE"!==c,s={dateOperations:l,colheaders:g,type:c,enabled:d},v="NONE"===c?!1:!0;na.updateAggregation(i,s,v)}function Yt(e){var t=Zt.Manager.SidePanelManager,a=t.getActiveChartID(),n=Zt.Aggregation,i=e.target,r=Zt.Wrapper.DOMUtils,l=r.getAttribute(i,"index"),o=n.deleteDepth(l),g=n.getDateOperations(),c=o.join(";"),d=null!=c&&""!==c,s={colheaders:c,dateOperations:g,enabled:d};na.updateAggregation(a,s,!0)}function Ht(e,t,a,n){var i,r,l=Jt.data.getWorkBook(e,t),o=a.match(Ca.rangeRegex);return!n||"undefined"!=typeof o&&"undefined"!=typeof o[1]?n&&"undefined"!=typeof o&&o[1]?(i=o[1].replace(/'/g,""),l.SheetList.isNameExists(i)?(r=l.SheetList.getIdByName(i))?!0:void 0:!1):null!==o&&"undefined"!=typeof o:!1}function Vt(e,t){var a=Zt.Wrapper.DOMUtils,n=Zt.Aggregation;n.resetSelectedState(),t&&"NONE"!==t&&n.setSelectedState(t);var i=a.createElement("span",{class:"dateFields"});null!==e&&a.appendChild(e,i)}function Gt(e){if(e&&null!=e){for(var t=e.split(";"),a=0;a<t.length;a++){var n=t[a],i=Zt.Manager.SidePanelManager,r=i.getActiveMeta(),l=r.getRange(),o=Zt.DecTable.getRangeDecTableMap(l),g=Zt.Utility.getComboId(n,o);aa.select2("#chartAggCombo0",null,"detach",g)}aa.select2("#chartAggCombo0",null,"triggerChange")}}function zt(){var e=new Zt.Utility.ChartAgent,t=Qt.getElementById("baseValue").value,a=e.getChartMapFromSheet();if(!(a.length<4)){var n=a[3],i=Zt.Manager.SidePanelManager,r=e.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g={},c=0;Object.keys(r).forEach(function(e){var a=r[e];c=na.getActiveYAxisIndex(a),g.index=c,g.baseValue=t,g.isYAxis=!0;{var i=n.get(a);i.getDetails()}i&&i.updateYBaseValue(t,c),i&&o.push(i)});var d=i.getActiveMeta();d.updateYBaseValue(t,c),l.updateBaseValue(a[0],a[1],a[2],o[0],g)}}function Wt(e){var t=new Zt.Utility.ChartAgent,a=e.value,n=t.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.getSPActiveChartID(),l=new Zt.Controller.ZSCController,o=[],g=Zt.Manager.SidePanelManager;Object.keys(r).forEach(function(n){var l=r[n],g=i.get(l),c=g.getDegreeOrElse(),d=g&&t.isUniqueValue(a,c);d&&g.updateTrendDegree(e),d&&o.push(g)});var c=g.getActiveMeta();c.updateTrendDegree(e),l.updateTrendlinePeriod(n[0],n[1],n[2],o,a)}}var Zt=e.ZSChart,jt=e.ZSClass,Xt=e.ZSEvents,qt=Xt.Groups,Kt=Xt.Names,$t=Xt.topic,Jt=(Zt.Model,e.sPlusPlus),Qt=null,ea=(e.ZSConstants.FeatureConstants,e.document),ta=e.ZSConstants.I18N,aa=(e.ZSConstants.wCC,e.UIUtil.Component),na=null,ia=null,ra=null,la=!0,oa=null,ga=Zt.Constants.ChartRangePickerType,ca=(Zt.Constants.ChartClasses,jt.Editors.Utility),da=Zt.Constants.ChartNames,sa=Zt.Constants.ChartType,va=(e.JSUtil,!1),ua=Zt.Constants.defaultColor,ha=!1,Ca=e.JSUtil.REGEXP,Aa=(Ca.rangeRegex,Zt.Constants.TitleConstants);t.prototype=new Zt.Manager.ZSCRManger,t.prototype.setType=function(e){na||(na=new Zt.Model.Dialog,na.init()),na.setState(e)},t.prototype.getDialogUtil=function(){return na},t.prototype.setIsSidePanel=function(e){var t=new Zt.Utility.CommanAgent;na||(na=new Zt.Model.Dialog,na.init()),na.setSidePanelState(e),t.setDialogUtil(na)},t.prototype.getChartType=function(e){return na.dialogMeta[e].getType()},t.prototype.getActiveChartThemeName=function(e){return na.dialogMeta[e].getActiveChartThemeName()},t.prototype.replaceMeta=function(e,t){na.addMetaObject(e,t)},t.prototype.getMetaObject=function(e){return na.getMetaObject(e)},t.prototype.updateSidePanel=function(e){var t=na.dialogMeta[e];na.setState("edit");var a=new Zt.Utility.AgentDom;a.updateSidePanel(t)},t.prototype.hideUnwantedProperty=function(e,t){na.hideUnwantedProperty(e,t)},t.prototype.checkForRecommendationsPopulated=function(e){na.setUnProcessed(e),na.checkToPerformUnProcessedTask()},t.prototype.getIsSidePanel=function(){return na.getSidePanelState()},t.prototype.Open=function(){var e=new Zt.Utility.CommanAgent,t=new Zt.Utility.ChartAgent;return t.isLockedSheet()?void jt.ZSAlert(ta["ProtectRange.UI.SheetLocked"],{title:ta["Alert.Title.SheetLocked"]}):(e.setDialogStatus(!0),!ia&&(ia=this.constructDialogObject()),e.setDialogUtil(na),void ia.open())},t.prototype.clearSidePanelCached=function(){this.removeActiveChartID(),na&&na.clearCatch()},t.prototype.constructDialogObject=function(){na||(na=new Zt.Model.Dialog,na.init()),la=!0;var t={width:1020,title:na.getDialogTitle(),close:function(){this.closeDailogHandler()}.bind(this),open:function(){this.openDialogHandler()}.bind(this)};return this.initDialog(),new e.ZSClass.Dialog(ra,t)},t.prototype.getActiveRange=function(){var e=Jt.view.getActiveGridID(),t=(Jt.view.getResourceID(e),Jt.view.getVersionID(e),Jt.view.getSheetID(e)),a=Jt.view.getSheetState(e,t),n=a.getActiveRange();return n},t.prototype.doDialogSpecificAttachEvents=function(){for(var e=Qt.getElementByClassName("chrtTabList"),t=e.children,a=t.length,n=0;a>n;n++)Qt.addEventByNode(t[n],"click",w);e=Qt.getElementByClassName("chrtTypeTab"),t=e.children;for(var a=t.length,n=0;a>n;n++)Qt.addEventByNode(t[n],"click",O);var i="flt_right mt20",r=Qt.getElementsByClassName(i),t=r[0].children;t[0]&&Qt.addEventByNode(t[0],"click",function(){L()}),t[1]&&Qt.addEventByNode(t[1],"click",function(){N()}),ut()},t.prototype.attachEventsForSP=function(){Qt=Zt.Wrapper.DOMUtils,oa=new Zt.Utility.CommanAgent;var e=new jt.Editors.RangeEditor(Qt.getElementById("chrtEditor"));e.customPreventDefault=Lt.bind(e),jt.RangePicker.register(e),oa.addRangePicker(ga.DATA_RANGE,e);for(var t=Qt.getElementByClassName("spChrtTypesList"),i=t.querySelectorAll("label"),d=i.length,v=0;d>v;v++)a(i[v]);T(),A();var u=Qt.getElementById("addNewRanges"),h=Qt.getElementById("chrtEditor");Qt.addEventByNode(u,"click",this.showRangeDialog.bind(this,!0)),Qt.addEventByNode(h,"click",this.showRangeDialog.bind(this,!1)),G(e),W(),Z(),X(),ct(),K(),b(),M(),nt(),vt(),dt(),st(),m(),s();var p=[0];this.bindAggregationEvents(p),y(),S(),C(),g(),c(),o(),l(),r(),n()},t.prototype.bindAggregationEvents=function(e){var t=Zt.Wrapper.DOMUtils,a=t.getElementById("aggDateMenu");aa.bind(a,"zmenuitemclick",function(e,a){var n=(Zt.Aggregation,a.forElement[0]),i=a.data.value;"NONE"!==i&&Vt(null,i);var r=Bt(t.getAttribute(n,"value"));-1==r&&(r=_t(t.getAttribute(n,"value"))),-1!==r&&kt(r,i)});var n=t.getElementsByClassName("aggclose");t.addEventByNode(n[e[0]],"click",Yt)},t.prototype.attachEvents=function(){la=!1,Qt=Zt.Wrapper.DOMUtils,oa=new Zt.Utility.CommanAgent;var e=new jt.Editors.RangeEditor(Qt.getElementById("chrtEditor"));jt.RangePicker.register(e),oa.addRangePicker(ga.DATA_RANGE,e),this.doDialogSpecificAttachEvents();for(var t,a,n,i=Qt.getElementStack("input","chrtTypeLbl"),r=i.length,l=0;r>l;l++){t=i[l],a=t.length;for(var o=0;a>o;o++)n=t[o],Qt.addEventByNode(n,"click",U)}var g=Qt.getElementById("addNewRanges");Qt.addEventByNode(g,"click",this.openRangeDialog.bind(this)),G(e),z(),j(),rt(),q(),$(),J(),it(),vt()},t.prototype.setActiveChartId=function(e){this.activeChartId||(this.activeChartId=[]),-1==this.activeChartId.indexOf(e)&&this.activeChartId.push(e)},t.prototype.getActiveChartID=function(){return this.activeChartId},t.prototype.removeActiveChartID=function(){this.activeChartId=null},t.prototype.getActiveMeta=function(){var e=Zt.Manager.SidePanelManager,t=e.getActiveChartID(),a=na.dialogMeta[t];return a},Zt.Manager.getActiveChartMeta={fn:function(){var e=Zt.Manager.SidePanelManager,t=e.getActiveChartID(),a=na.dialogMeta[t];return a}},t.prototype.openRangeDialog=function(){var e=new Zt.Utility.CommanAgent,t=e.getRangePicker(ga.DATA_RANGE);this.range=t.value,this.setActiveChartId(Zt.Utility.getActiveChart()[0]),this.openZSCRDialog()},t.prototype.showRangeDialog=function(e){var t=new Zt.Utility.CommanAgent,a=t.getRangePicker(ga.DATA_RANGE);this.addRangeClicked=e,this.range=a.value,I(),this.showRangeDomForSP(e)},t.prototype.hideDialog=function(){ia&&ia.hide()},t.prototype.recallDialog=function(){ia&&ia.show();var e=new Zt.Utility.CommanAgent,t=e.getRangePicker(ga.DATA_RANGE);t.value=this.range,t.valueChanged(),this.clearRangeCatch(),F()},t.prototype.hideRangeDialogForSP=function(){D(),this.cancelDialogForSp()},t.prototype.updateDataRangeForSP=function(){var e=(Zt.Manager.SidePanelManager,new Zt.Utility.CommanAgent),t=e.getRangePicker(ga.DATA_RANGE);t.value=this.range,t.valueChanged(),this.clearRangeCatch(),setTimeout(function(){F()},200)},t.prototype.setFocus=function(e){var t=Zt.Wrapper.DOMUtils;t.getElementById(e).click()},t.prototype.initDialog=function(){var t=e.UserAction.getTemplate(["CHART_WRAPPER_TEMPLATE","CHART_PREVIEW_TEMPLATE","CHART_OK_CANCEL_TEMPLATE","CHART_YAXIES_TEMPLATE","CHART_AXIES_TEMPLATE","CHART_OPTION_TEMPLATE","CHART_TYPE_TEMPLATE","CHART_GENRAL_TEMPLATE","CHART_RECOMMENDATION_TEMPLATE","CHART_LABEL_TEMPLATE","CHART_SERIES_IN_TEMPLATE","CHART_DATA_RANGE_COMBINED_RANGE_TEMPLATE","CHART_TAB_LIST_TEMPLATE","CHART_XAXIES_TEMPLATE","CHART_LEFT_PANEL_TEMPLATE","CHART_BOX_TEMPLATE","CHART_PREVIEW_OPEN_CLOSE_TEMPLATE","CHART_ADVANCE_TEMPLATE","AGGREGATED_CHART_TEMPLATE","FILTER_CHART_TEMPLATE"]);ra=ea.createElement("div"),ra.id="DI_CHART",ra.appendChild(t.CHART_PREVIEW_OPEN_CLOSE_TEMPLATE),ra.appendChild(t.CHART_WRAPPER_TEMPLATE);var a=ra.querySelector("#wrapper");a.appendChild(t.CHART_TAB_LIST_TEMPLATE),a.appendChild(t.CHART_LEFT_PANEL_TEMPLATE),a.appendChild(t.CHART_PREVIEW_TEMPLATE);var n=a.querySelector("#chartleftPanel");n.appendChild(t.CHART_GENRAL_TEMPLATE),n.appendChild(t.CHART_OPTION_TEMPLATE),n.appendChild(t.CHART_TYPE_TEMPLATE),n.appendChild(t.CHART_AXIES_TEMPLATE),n.appendChild(t.CHART_ADVANCE_TEMPLATE),n.appendChild(t.CHART_OK_CANCEL_TEMPLATE);var i=n.querySelector("#chartGeneral");i.appendChild(t.CHART_BOX_TEMPLATE),i.appendChild(t.CHART_RECOMMENDATION_TEMPLATE);var r=i.querySelector("#chartBox");r.appendChild(t.CHART_DATA_RANGE_COMBINED_RANGE_TEMPLATE),r.appendChild(t.CHART_SERIES_IN_TEMPLATE),r.appendChild(t.CHART_LABEL_TEMPLATE);var l=n.querySelector("#chartAxis");l.appendChild(t.CHART_XAXIES_TEMPLATE),l.appendChild(t.CHART_YAXIES_TEMPLATE);var o=n.querySelector("#Advanced");o.appendChild(t.AGGREGATED_CHART_TEMPLATE),o.appendChild(t.FILTER_CHART_TEMPLATE)},t.prototype.constructDialogMetaObject=function(e,t){na.refreshByMetaForSidePanel(e,t)},t.prototype.openDialogHandler=function(){la&&this.attachEvents();var e=new Zt.Utility.CommanAgent,t=na.getState(),a=-1!==t.indexOf("ADD");if(a){yt(0);var n=Jt.view.getActiveGridID(),i=Jt.view.getResourceID(n),r=Jt.view.getVersionID(n),l=Jt.view.getSheetID(n),o=(Jt.view.getSheetState(n,l),e.getRangePicker(ga.DATA_RANGE));o.Editor.focus(),Zt.Server.Action.fetchChart(i,l,r,"CHART_DETAILS",na.processResponse.bind(na))}else{yt(2);var g=Zt.Utility.getActiveChart(),c=Zt.Utility.getChartMeta(g,!0);na.refreshByMeta(c),Zt.Action.doRecommendation(c,!1);var d=e.getRangePicker(ga.CHART_TITLE);d.Editor.focus()}},t.prototype.closeDailogHandler=function(){var e=new Zt.Utility.CommanAgent;e.setDialogStatus(!1),e.removeDailogUtil();var t=new Zt.Manager.ZSCColorManager;t.hideColorScheme(),na&&na.clearCatch();var a={display:"table-cell"};Qt.addStyle("preview",a)};Zt.Action.addNewPlotLine=Pt,Zt.Action.updatePlotline=Mt,Zt.Action.updatePlotlineName=Dt,Zt.Action.removePlotLine=bt,Zt.Utility.getDialog=mt,Zt.Action.doRecommendation=ft,Zt.Manager.DialogManager=t,Zt.Action.AggregationHeaderChange=Nt,Zt.Utility.changeTitleCombo=lt,Zt.Utility.onChangeSelect2=Gt,Zt.Utility.get3DMapping=E,$t.register(qt.UI,Kt.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE,d)}(this);
!function(e){function t(){Q.call(this)}function a(){var e=Z.getTemplate(["chartIcon"]);this.icon.appendChild(e.chartIcon),this.icon.title=lt["MenuItem.InsertTab.Chart"]}function n(){setTimeout(function(){Y=$.add({onCreate:a,callBack:y,allowed:tt,direction:at}),Y.onOpen=g,Y.onClose=P,Y.hide(),l()},1e3)}function l(){var e=At.keyDown;e[nt.ESC]=function(){var e=j.Manager.SidePanelManager;return e.hideRangeDialogForSP(),!1},e[nt.SUPER+"+"+nt.Z]=function(e){return Tt.execute(e),!1},e[nt.SUPER+"+"+nt.Y]=function(e){return dt.execute(e),!1}}function r(e){var t=null;it.getElementByClassName("spChartTabWrap")&&(t=it.getActiveElement("spChartTabWrap","active"));var a=!1;null!=t&&(a=e?it.hasClass(t,"generalTab"):it.hasClass(t,"builderTab")),null==t&&(a=!0),e?(it.getElementById("spChartHeader").style.display="none",it.getElementById("spPChartHeader").style.display="block",it.getElementByClassName("builderTab").style="",a&&it.addClass(it.getElementByClassName("builderTab"),"active"),it.removeClass(it.getElementByClassName("generalTab"),"active"),a&&it.removeClass(it.getElementByClassName("customTab"),"active"),it.hide(it.getElementByClassName("generalTab")),a&&(it.getElementById("spPivotChartGeneral").style.display=""),a&&(it.getElementById("spChartCustom").style.display="none"),it.getElementById("spChartGeneral").style.display="none"):(it.getElementById("spChartHeader").style.display="block",it.getElementById("spPChartHeader").style.display="none",it.getElementByClassName("builderTab").style.display="none",it.getElementById("spPivotChartGeneral").style.display="none",it.addStyle(it.getElementByClassName("generalTab"),{display:""}),(a||it.hasClass(t,"generalTab"))&&it.show(it.getElementById("spChartGeneral"))),s()}function s(){var e={NOT_SUPPORTED_TYPE:[{MenuItem:"stckWebTlt",Parent:"chrtTypeWrapper",Scope:1},{MenuItem:"PARETO",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"HISTOGRAM",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"WORDCLOUD",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"TIMEAREA",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"XYSTACKEDAREA_PERCENT",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"scatterBubleTlt",Parent:"chrtTypeWrapper",Scope:1},{MenuItem:"TIMELINE",Parent:"chrtTypeWrapper",Scope:2}],MENU_SWAPPING:[{MenuItem:"SP_CHART_TYPES_WRAPPER",Pivot_Parent:"spChartInnerDiv",Chart_Parent:"spGeneralInnerDiv",index:0}]},t=j.Wrapper.DOMUtils,a=j.Manager.SidePanelManager,n=a.getActiveMeta();e.NOT_SUPPORTED_TYPE.forEach(function(e){var a=t.getElementById(e.Parent),l=a.querySelector("#"+e.MenuItem);null!=l&&(n.isPivotChart?t.hide(l):1==e.Scope?t.addStyle(l,{display:""}):null,n.isPivotChart?t.hide(l.nextElementSibling):t.addStyle(l.nextElementSibling,{display:""}))}),e.MENU_SWAPPING.forEach(function(e){var a=t.getElementById(e.MenuItem);if(null!=a){var l=t.getElementById(e.Pivot_Parent),r=t.getElementById(e.Chart_Parent);n.isPivotChart?t.addChildAtIndex(a,l,null,e.index):t.addChildAtIndex(a,r,null,e.index)}})}function i(e){it=j.Wrapper.DOMUtils;var t=e.target.className;-1!==t.indexOf("builderTab")?(it.addClass(it.getElementByClassName("builderTab"),"active"),it.removeClass(it.getElementByClassName("generalTab"),"active"),it.removeClass(it.getElementByClassName("customTab"),"active"),it.getElementById("spPivotChartGeneral").style="",it.getElementById("spChartCustom").style.display="none",it.getElementById("spChartGeneral").style.display="none"):-1!==t.indexOf("customTab")?(it.addClass(it.getElementByClassName("customTab"),"active"),it.removeClass(it.getElementByClassName("generalTab"),"active"),it.removeClass(it.getElementByClassName("builderTab"),"active"),it.getElementById("spChartCustom").style="",it.getElementById("spChartGeneral").style.display="none",it.getElementById("spPivotChartGeneral").style.display="none"):(it.addClass(it.getElementByClassName("generalTab"),"active"),it.removeClass(it.getElementByClassName("customTab"),"active"),it.removeClass(it.getElementByClassName("builderTab"),"active"),it.getElementById("spChartGeneral").style="",it.getElementById("spChartCustom").style.display="none",it.getElementById("spPivotChartGeneral").style.display="none")}function C(){Y&&Y.toggle(),Ct=!Ct}function E(e,t,a){if(T(e)){var n=j.Manager.SidePanelManager;n.TABEL_DEFINATION=a,n.setActiveChartId(e),Y&&Y.alive&&o(e),Y&&Y.open(),Y&&Y.show()}}function T(e){{var t=F.view.getActiveGridID(),a=F.view.getResourceID(t),n=F.view.getVersionID(t),l=F.data.getWorkBook(a,n),r=F.view.getSheetID(t),s=new j.Utility.ChartAgent;s.getChartMetaOfSheet(r,a,n,t,e)}return l.isEditable()&&!l.ProtectedSheets.isSheetLocked(r)}function d(){var e=j.Manager.SidePanelManager;return null!=e.getActiveChartID()?e.getActiveChartID()[0]:j.Utility.getActiveChart()[0]}function o(e){var t=j.Manager.SidePanelManager;if(!e&&(e=d()),e){t.setPanelStatus({open:!0,close:!1}),A(e);var t=j.Manager.SidePanelManager;t.RECOMMENDATION=!t.RECOMMENDATION,t.TABEL_DEFINATION=!0,t.initPanelManager(),setTimeout(function(){x.publish(V.UI,q.SidePanel.CHARTS.METACONVERSION,{CHART_ID:e});var t=j.Manager.SidePanelManager;t.getActiveMeta().isPivotChart?(r(!0),X.construct(t.getActiveMeta().pivotId)):r(!1),t.RECOMMENDATION&&x.publish(V.UI,q.SidePanel.CHARTS.CALL_RECOMMENDATION,{CHART_ID:e}),t.TABEL_DEFINATION&&x.publish(V.UI,q.SidePanel.CHARTS.CALL_TABLE_DEFINITION,{CHART_ID:e}),x.publish(V.UI,q.SidePanel.CHARTS.REFRESH_SIDE_PANEL,{CHART_ID:e}),x.publish(V.UI,q.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE),x.publish(V.UI,q.SidePanel.CHARTS.CLOSE_ALL_ACCORDIONS)},100)}}function A(e){var t=F.view.getActiveGridID(),a=F.view.getVersionID(t),n=F.view.getResourceID(t),l=F.view.getSheetID(t);x.publish(V.Listener,q.SheetAction.CHARTS.UPDATE_PANEL_STATUS,{RID:n,SHEETID:l,VERSION:a,CHART_ID:e,STATUS:!0})}function c(){Y&&Y.show()}function I(){Y&&Y.hide()}function S(){var e=j.Manager.SidePanelManager,t=e.getActiveChartID();Y&&!e.rangeEditor.isEditing&&(Y.close(),t&&0!=t.length||Y.hide()),j.Client.Action.destroyContextualToolbar(),t&&j.Client.Action.removeBorderAnimation({ID:t[0]}),t&&j.Client.Action.resetChartSelection({ID:t[0]}),p()}function p(){var e=j.Wrapper.DOMUtils;e.addClass(e.getElementByClassName("generalTab"),"active"),e.removeClass(e.getElementByClassName("builderTab"),"active"),e.removeClass(e.getElementByClassName("customTab"),"active")}function m(){var e=j.Wrapper.DOMUtils;e.getElementById("rangeWrapper")&&(e.getElementById("rangeWrapper").innerHTML=""),e.hideById("rangeSelectorDiv"),e.hideByClassName("spDisabled")}function N(){st.select2("#chartAggCombo0",void 0,"destroy")}function _(){var e=j.Manager.SidePanelManager;N(),m(),e.setPanelStatus({open:!1,close:!0}),e.clearCache()}function g(){z.Right.sidePanel=320,this.holder.setWidth(320),o(),R()}function R(){var e=F.view.Events.Key;e.focusContext(At)}function P(){z.Right.sidePanel=0,this.holder.setWidth(0),h(),_()}function h(){document.activeElement.blur(),x.publish(V.Listener,q.KeyBoard.ChangeContext,{CONTEXT:"Grid"})}function u(e){var t=j.Wrapper.DOMUtils,a=["COL","XYLINE_SCATTER_SHAPES","STACKEDCOL","GROUPEDCOL","GROUPEDBAR","STACKEDCOL_PERCENT","BAR","STACKEDBAR","STACKEDBAR_PERCENT","XYLINE","SPLINE","STEPCHART","PIE","SEMIPIE","DOUGHNUT","SEMIDOUGHNUT","XYAREA","XYSTACKEDAREA","XYSTACKEDAREA_PERCENT","SCATTER","XYLINE_SCATTER","BUBBLE","TIMELINE","TIMEAREA","CANDLESTICK","OHLCCHART","POLAR","SPIDERWEB","BULLETCOL","BULLETBAR","COMBOCHART","WATERFALL","FUNNEL","PARETO","HISTOGRAM","WORDCLOUD"],n=Z.getTemplate(["COL_ICON","XYLINE_SCATTER_SHAPES_ICON","GROUPEDCOL_ICON","GROUPEDBAR_ICON","STACKEDCOL_ICON","STACKEDCOL_PERCENT_ICON","BAR_ICON","STACKEDBAR_ICON","STACKEDBAR_PERCENT_ICON","XYLINE_ICON","SPLINE_ICON","STEPCHART_ICON","PIE_ICON","SEMIPIE_ICON","DOUGHNUT_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","XYSTACKEDAREA_PERCENT_ICON","SCATTER_ICON","XYLINE_SCATTER_ICON","BUBBLE_ICON","TIMELINE_ICON","TIMEAREA_ICON","CANDLESTICK_ICON","OHLCCHART_ICON","POLAR_ICON","SPIDERWEB_ICON","BULLETCOL_ICON","BULLETBAR_ICON","COMBOCHART_ICON","WATERFALL_ICON","FUNNEL_ICON","PARETO_ICON","HISTOGRAM_ICON","WORDCLOUD_ICON"]),l=e||t.getElementById("chrtTypeWrapper");a.forEach(function(e){var a=l.querySelector("#"+e),r=a.nextElementSibling;t.appendChild(r,n[e+"_ICON"])})}function y(){var e=Z.getTemplate(["SP_CHART","SP_CHART_DATA_RANGE_OTHERS","DATARANGE_SELECTOR","SP_CHART_DATA_RANGE","SP_CHART_CHART_TYPES","SP_CHART_COLOR_SCHEME","SP_CHART_DATA_OPTIONS","SP_CHART_LEGEND_OPTIONS","SP_CHART_STYLES","SP_CHART_TITLES","SP_CHART_XAXIS","SP_CHART_YAXIS","SP_CHART_SERIES","SP_CHART_AGGREGATION","SP_CHART_FILTER","SP_CHART_COMBINED_RANGE","DATE_MENU_TEMPLATE"]),t=rt.createElement("div");t.id="SPCHART",t.className="wid wid100 hgt100",t.appendChild(e.SP_CHART),this.panel.appendChild(t),k=this.panel.querySelector("#SPCHART");var a=t.querySelector("#spGeneralInnerDiv");a.appendChild(e.SP_CHART_CHART_TYPES),a.appendChild(e.SP_CHART_DATA_RANGE),a.appendChild(e.SP_CHART_COMBINED_RANGE),a.appendChild(e.DATARANGE_SELECTOR),u(),a.appendChild(e.SP_CHART_DATA_OPTIONS),a.appendChild(e.SP_CHART_DATA_RANGE_OTHERS),a.appendChild(e.SP_CHART_AGGREGATION),a.appendChild(e.DATE_MENU_TEMPLATE),a.appendChild(e.SP_CHART_FILTER),a=t.querySelector("#spChartInnerDiv"),a.appendChild(e.SP_CHART_TITLES),a.appendChild(e.SP_CHART_LEGEND_OPTIONS),a.appendChild(e.SP_CHART_SERIES),a.appendChild(e.SP_CHART_XAXIS),a.appendChild(e.SP_CHART_YAXIS),a.appendChild(e.SP_CHART_STYLES);var n=Z.getTemplate(["SP_PIVOT","SPP_BUILDER"]);a=t.querySelector("#spPivotChartInnerDiv"),a.appendChild(n.SP_PIVOT),a=t.querySelector("#pivotGenTab"),a.appendChild(n.SPP_BUILDER),X=new J.Pivot.BuilderModel(this.panel),X.init(),t.addEventListener("mousedown",R),st.initComponent(t),B();var l=new j.Manager.ZSCColorManager;l.initEvents(),x.publish(V.UI,K.Names.SidePanel.CHARTS.BINDEVENTS)}function O(){for(var e=it.getElementsByName("chartGeneralAccordion"),t=0;t<e.length;t++)e[t].checked=!1,e[t].classList.remove("selected");e=it.getElementsByName("chartCustomAccordion");for(var t=1;t<e.length;t++)e[t].checked=!1,e[t].classList.remove("selected")}function v(){for(var e=j.Wrapper.DOMUtils,t=e.getElementsByName("chartCustomAccordion"),a=0;a<t.length;a++)this!=t[a]&&(t[a].checked=!1),this!=t[a]&&t[a].classList.remove("selected");this.checked=!this.classList.contains("selected"),this.checked?this.classList.add("selected"):this.classList.remove("selected")}function D(){var e=j.Wrapper.DOMUtils;setTimeout(function(){e.getElementById("aggregationDiv").scrollIntoView({behavior:"smooth"})},200)}function B(){it=j.Wrapper.DOMUtils,it.addEventByNode(it.getElementByClassName("builderTab"),"click",i),it.addEventByNode(it.getElementByClassName("generalTab"),"click",i),it.addEventByNode(it.getElementByClassName("customTab"),"click",i),it.addEventByNode(it.getElementById("closeChart"),"click",S);for(var e=it.getElementsByName("chartCustomAccordion"),t=0;t<e.length;t++)it.addEventByNode(e[t],"click",v);e=it.getElementsByName("chartGeneralAccordion");for(var t=0;t<e.length;t++)it.addEventByNode(e[t],"click",v);it.addEventByNode(it.getElementById("chartAggregation"),"click",D)}function L(e){e.length>1&&S()}function H(e){var t=j.Manager.SidePanelManager;return ot[e]?ot[e].aTC:T(t.getActiveChartID())?ot.CHART_DEFAULT.aTC:ot.PIVOT_DEFAULT.aTC}function M(e){var t=j.Wrapper.DOMUtils;return ot[e]&&ot[e].aAN?t.getElements(ot[e].aAN)[0]:null}function b(e){var t=H(e),a=M(e);W(t),a&&w(a,1)}function U(e){var t=H(e),a=M(e);W(t),a&&w(a,0)}function f(){var e=j.Wrapper.DOMUtils;return e.getElementById("CHART_RIGHT_PANEL_CONATAINER")}function G(){var e=f(),t=e.querySelector(".spChrtTab");return t.querySelector(".active")}function W(e){var t=j.Wrapper.DOMUtils,a=G();if(!t.hasClass(a,e.cls))switch(t.removeClass(a,"active"),t.addClass(t.getElementByClassName(e.cls),"active"),e.name){case"custom":t.getElementById("spChartCustom").style="",t.getElementById("spPivotChartGeneral").style.display="none",t.getElementById("spChartGeneral").style.display="none";break;case"general":t.getElementById("spChartGeneral").style="",t.getElementById("spPivotChartGeneral").style.display="none",t.getElementById("spChartCustom").style.display="none";break;default:t.getElementById("spChartGeneral").style.display="",t.getElementById("spPivotChartGeneral").style="",t.getElementById("spChartCustom").style.display="none"}}function w(e){var t=e.querySelector("input"),a=new Event("click");t&&t.dispatchEvent(a)}var Y,k,X,F=e.sPlusPlus,K=e.ZSEvents,x=K.topic,V=K.Groups,q=K.Names,Z=e.UserAction,J=e.ZSClass,j=e.ZSChart,z=F.view.measures,Q=J.KeyMapping,$=J.SidePanel,et=J.SidePanelClassList,tt=[et.right,et.left,et.bottom],at=et.right,nt=e.ZSConstants.JSKeyCode,lt=e.ZSConstants.I18N,rt=e.document,st=e.UIUtil.Component,it=null,Ct=!1,Et=e.ZSConstants.FeatureConstants,Tt=F.view.Toolbar.Feature[Et.UNDO],dt=F.view.Toolbar.Feature[Et.REDO],ot={SERIES:{aTC:{name:"custom",cls:"customTab"},aAN:"series"},TITLES:{aTC:{name:"custom",cls:"customTab"},aAN:"titles"},LEGEND:{aTC:{name:"custom",cls:"customTab"},aAN:"legend"},HAXIS:{aTC:{name:"custom",cls:"customTab"},aAN:"haxis"},VAXIS:{aTC:{name:"custom",cls:"customTab"},aAN:"vaxis"},STYLES:{aTC:{name:"custom",cls:"customTab"},aAN:"styles"},CHART_DEFAULT:{aTC:{name:"general",cls:"generalTab"}},PIVOT_DEFAULT:{aTC:{name:"builder",cls:"builderTab"}}},At=new t,ct=F.view.Events.Key;ct.Entry.RightPane.Node.addChildNode(At),x.register(V.UI,q.SidePanel.CHARTS.TOGGLE,C),x.register(V.UI,q.SidePanel.CHARTS.OPEN,E,"CHART_ID","RECOMMENDATION","TABEL_DEFINATION"),x.register(V.UI,q.SidePanel.CHARTS.OPEN_ICON,c),x.register(V.UI,q.SidePanel.CHARTS.SETFOCUS,R),x.register(V.UI,q.SidePanel.CHARTS.CLOSE,S),x.register(V.UI,q.SidePanel.CHARTS.CLOSE_ICON,I),x.register(V.UI,q.SidePanel.CHARTS.CLOSE_ALL_ACCORDIONS,O),x.register(V.UI,q.Layout.TEMPLATE_LOADED,n),x.register(V.Listener,q.UserAction.CHARTS.RESET_MENU,L,"ACTIVE_CHART_ID"),x.register(V.UI,q.SidePanel.CHARTS.ACCORDION.OPEN,b,"NAME"),x.register(V.UI,q.SidePanel.CHARTS.ACCORDION.CLOSE,U,"NAME"),x.register(V.UI,q.SidePanel.CHARTS.LINKED_ICON,u,"PARENT")}(this);
!function(e){function t(){O.Model.Dialog.call(this),this.init()}function r(){f.publish(E.UI,I.Toolbar.CHART.POPUP.CLEAR),f.publish(E.UI,I.Toolbar.CHART.POPUP.LOADER.SHOW),w=!0;var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),r=A.view.getVersionID(e),n=A.view.getSheetID(e);i.call(this),O.Server.Action.fetchChart(t,n,r,"CHART_DETAILS",!1,function(e){f.publish(E.UI,I.Toolbar.CHART.POPUP.PROCESSRESPONSE,{RESPONSE:e})},A.view.Toolbar.showChartPopup)}function i(){var e=n(),t=new O.Utility.ChartAgent;R(e)&&t.detectTable(e[0],s.bind(this),function(){}),!R(e)&&s({dataRange:o(e)})}function n(){var e=A.view.getActiveGridID(),t=(A.view.getResourceID(e),A.view.getVersionID(e),A.view.getSheetID(e)),r=A.view.getSheetState(e,t),i=r.getRanges();return i}function o(e){for(var t=[],r=e?e.length:0,i=0;r>i;i++)t.push(e[i].getLabel());return t.join(";")}function a(e){for(var t=e.split(";"),r="",i=0;i<t.length;i++){var n=t[i].split(".");r=0==r.length?r:r+";",r+=n[1]||n[0]}return r}function s(e){var t=e.dataRange;M=a(t.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";")),c.call(this);var r=A.view.getActiveGridID(),i=A.view.getResourceID(r),n=A.view.getVersionID(r);C(i,n,M,H)}function c(){}function l(){D=null,w=!1,M=null,ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this)}function h(e,r){w&&(f.publish(E.UI,I.Toolbar.CHART.POPUP.LOADER.HIDE),D=new t,D.processResponse(e)),r&&(D=new t,D.processMuteResponse(e))}function p(e){D&&(D.setType(e),D.insertChartByDataRange())}function d(e){try{return e.co.title.text}catch(e){}return null}function g(e){if(D){U||(U=e.innerHTML);var t=O.Wrapper.DOMUtils,r=t.createElement("span"),i=t.createElement("span");r.innerText=ZSConstants.I18N.DataRange,i.innerText=": "+D.getSourceRange(),r.classList.add("fntBld"),e.innerHTML="",t.appendChild(e,r),t.appendChild(e,i)}}function u(e){U&&(e.innerHTML=U)}function v(e,t){try{if(f.publish(E.UI,I.Toolbar.CHART.POPUP.PROCESSRESPONSE,{RESPONSE:e,MUTE_ACTION:!0}),!D)return;D.setType(t),D.insertChart()}catch(e){}f.publish(E.UI,I.Toolbar.CHART.POPUP.CLEAR)}function R(e){try{var t=e.length,r=e[0];return 1==t&&r.startRow==r.endRow&&r.startCol==r.endCol}catch(e){return!1}}function C(e,t,r,i){ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this);var n=r.trim().split(";"),o=1;n.forEach(function(r){var n=JSUtil.Range.parseRange(e,t,r);n&&ZSZIA.Client.Range.Highlight.ADD.fn.call(this,o,n.range,i),o++})}var A=e.sPlusPlus,P=e.ZSEvents,f=P.topic,E=P.Groups,I=P.Names,T=e.ZSConstants.FeatureConstants,S=A.view.Toolbar.Feature[T.CHART],y=e.ZSConstants.I18N,O=e.ZSChart,T=e.ZSConstants.FeatureConstants,m=e.ZSDevTools,b=m.Logger,D=null,w=!1,U=null,M=null,H="#13ad6b";t.prototype=new O.Model.Dialog,t.prototype.getSourceRange=function(){return M||(M=o(n())),M},t.prototype.processResponse=function(e){this.setResposne(e);try{this.preProcess(),this.postProcess()}catch(e){this.doFallbackCase()}},t.prototype.processMuteResponse=function(e){this.setResposne(e);try{this.preProcess(),this.postMuteProcess()}catch(e){this.doFallbackCase()}},t.prototype.doFallbackCase=function(){try{var e=null,t=new O.Utility.ChartAgent;if(e=t.isArray(this.responseObj)?this.responseObj.shift():this.responseObj,e&&e.reason)return throws.err;this.grabProperty(e),this.alertInvalidRecommendation()}catch(t){this.alertForInvalidCase(e)}},t.prototype.alertForInvalidCase=function(e){try{var t,r=e.reason,i="",n=r.ice,o=r.iad;n&&(i=JSUtil.fn.replaceParams(y["Chart.Cells.Count.Exceeded"],new Array("3000"))),n&&(t=y["Alert.Title.LimitExceeded"]),n||o||(msgObj=this.generateAlertMessage(r),i=msgObj.msg,t=msgObj.titleKey),ZSClass.ZSAlert(i,{title:t})}catch(e){}f.publish(E.UI,I.Toolbar.CHART.POPUP.CLOSE)},t.prototype.getAlertForRecommendationMsg=function(e){try{var t=new O.Utility.ChartAgent;t.isArray(this.responseObj)&&(e=this.responseObj.shift());var r=e.reason,i="",n=r.ice,o=r.iad;return n&&(i=JSUtil.fn.replaceParams(y["Chart.Cells.Count.Exceeded"],new Array("3000"))),!n&&!o&&(i=this.generateAlertMessage(r).msg),i}catch(e){return y["Chart.RecommendationAlertText"]}},t.prototype.getChartNameByChartCode=function(e){return a(e.dataRange)},t.prototype.preProcess=function(){var e=this.responseObj,t=e.length;if(!t)return throws.err;for(var r=0;r<e.length;r++){var i,n=e[r];r&&(i=this.chartId+r),!r&&(i=this.chartId),r&&this.id.push(i),n.co&&n.co.chart&&(n.co.chart.renderTo=i)}},t.prototype.doRecommendationTask=function(e,t){var r=[];e.length&&(r=e),!e.length&&r.push(e);var i=1|t.startIndex,n=t.isShift|!1;try{n&&r.shift(),this.renderRecommendation(r,i)}catch(e){b.log("[CHART] Chart Recommendation Task Throwing exception while redering chart in popover"),this.alertInvalidRecommendation()}},t.prototype.alertInvalidRecommendation=function(){var e=O.Wrapper.DOMUtils,t=S.getRecommendationHolder(),r=t.querySelector("#RECOMMENDALERT"),i=t.querySelector("#recommendChartPreview"),n=S.getFooterBar();r.setAttribute("noChart","true"),e.hide(i),e.show(r);var o=this.getAlertForRecommendationMsg(this.responseObj);n.innerText=o,f.publish(E.UI,I.Toolbar.CHART.POPUP.SELECT,{ID:"COLMENU"}),b.log("[Chart] >>>>>>>>>> Chart Alert Messgae >>>>>>>>>>")},t.prototype.setRecommendationSelection=function(){function e(e){return this.getSourceRange()==e}var t=this,r=S.getRecommendationHolder(),i=O.Wrapper.DOMUtils;this.dialogMeta&&Object.keys(this.dialogMeta).forEach(function(n){var o=t.dialogMeta[n],s=a(o.dataRange),c=r.querySelector("#"+n),l=c.nextElementSibling;e.call(t,s)?i.hide(l):i.show(l)})},t.prototype.renderRecommendation=function(e,t){var r=e.shift();r&&r.co&&(r=this.trimChartData(r),this.recommendChart(r,t,this).then(function(){this.renderRecommendation(e,++t)}.bind(this)))},t.prototype.recommendChart=function(e,t,r){return new Promise(function(i){var n,o,a,s,c=O.Wrapper.DOMUtils,l=e,h="recWrapper1";s={class:h,"border-color":"rgb(25, 175, 92)",width:"50px",height:"50px"};var p=S.getRecommendationHolder(),g=p.querySelector("#recommendChartPreview"),u=c.createElement("chartWrapperDiv",s);o=r.id[t],a=l.type,g.appendChild(u),s={class:"recChartDiv",id:o,style:"height : inherit;width:inherit;","data-id":o},n=c.addChildByIndex("chartDiv",u,s,t-1);var v=d(e);n.setAttribute("title",v);{var R=A.view.getActiveGridID(),P=A.view.getResourceID(R),f=A.view.getVersionID(R);A.view.getSheetID(R)}c.addEventByNode(n,c.Events.MOUSEOVER,function(){var t=e.dataRange;C(P,f,t),u.style.border="1px solid #13AD6B"}),c.addEventByNode(n,c.Events.MOUSELEAVE,function(){u.style.border="1px solid #e9e9e9",C(P,f,r.getSourceRange(),H)}),s={class:"recChartName",id:"tooltip"+t,"data-id":o};var E=c.addChildByIndex("chartNameDiv",u,s,t-1);c.addEventByNode(E,c.Events.MOUSEOVER,function(){var t=e.dataRange;C(P,f,t),u.style.border="1px solid #13AD6B"}),c.addEventByNode(E,c.Events.MOUSELEAVE,function(){u.style.border="1px solid #e9e9e9",C(P,f,r.getSourceRange(),H)}),E.addEventListener("click",function(e){r.setActiveID(o),r.insertChart(o),e.stopPropagation()},!1),n.addEventListener("click",function(e){r.setActiveID(o),r.insertChart(o),e.stopPropagation()},!1),E.innerText=r.getChartNameByChartCode(e),r.grabProperty(e),e=r.removeUnwantedProperties(e),r.createPreview(o,e),setTimeout(function(){i()},10)})},t.prototype.insertChart=function(e){var t=this.dialogMeta[e||this.getActiveID()];if(!t)return void b.log("[CHART] >>>>>>>> Active Meta Unavailable ",e||this.getActiveID());var r=new O.Utility.CommanAgent,i=r.checkIfDataApplicableForChartType(t,!0);if(!i)return void ZSClass.ZSAlert(y["Chart.Not.Allowed"]);var n=this.getRequestObject(t,"new"),o=A.view.getActiveGridID(),a=A.view.getResourceID(o),s=A.view.getVersionID(o),c=A.view.getSheetID(o);O.Server.Action.updateChartOnGrid(a,c,s,n),f.publish(E.UI,I.Toolbar.CHART.POPUP.CLOSE),ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this)},t.prototype.insertChartByDataRange=function(e){var t=this.dialogMeta[e||this.getActiveID()];if(!t)return void b.log("[CHART] >>>>>>>> Active Meta Unavailable ",e||this.getActiveID());var r=A.view.getActiveGridID(),i=A.view.getResourceID(r),n=A.view.getVersionID(r),o=A.view.getSheetID(r),a=[],s=M.trim().split(";");s.forEach(function(e){a.push(JSUtil.Range.parseRange(i,n,e).range)}),O.Server.Action.insertChartForRange(i,o,n,[a],"CHART_DETAILS",function(e,t){v(e,t)},t.getType()),f.publish(E.UI,I.Toolbar.CHART.POPUP.CLOSE)},t.prototype.grabProperty=function(e){var t=new O.Model.DialogMeta,r=e.co.chart.renderTo;t.constructPropertyFromObject(e),this.addMetaObject(r,t)},t.prototype.postProcess=function(){var e=S.getRecommendationHolder(),t=e.querySelector("#recommendChartPreview"),r=O.Wrapper.DOMUtils;r.show(t),this.doRecommendationTask(this.responseObj,{startIndex:1,isShift:!0}),this.setActiveID("preview1"),this.clearResposne()},t.prototype.postMuteProcess=function(){var e=this.responseObj.shift();this.setActiveID(this.chartId),D.grabProperty(e),this.clearResposne()},t.prototype.setType=function(e){var t=this.dialogMeta[id||this.getActiveID()];t.setType(e)},t.prototype.getActiveID=function(){return this.activeId},t.prototype.setActiveID=function(e){this.activeId=e},t.prototype.createPreview=function(e,t){var r=O.Action.createPreview(e,t),i=this.dialogMeta[e];i.setInstance(r)},f.register(E.UI,I.Toolbar.CHART.POPUP.CLEAR,l),f.register(E.UI,I.Toolbar.CHART.POPUP.OPEN,r),f.register(E.UI,I.Toolbar.CHART.POPUP.PROCESSRESPONSE,h,"RESPONSE","MUTE_ACTION"),f.register(E.UI,I.Toolbar.CHART.POPUP.EDIT,p,"TYPE"),f.register(E.UI,I.Toolbar.CHART.POPUP.SETDATASOURCE,g,"HOLDER"),f.register(E.UI,I.Toolbar.CHART.POPUP.SETRECOMMENDATIONSOURCE,u,"HOLDER")}(this);
!function(e){function t(){var t={width:358,title:w["Data.Pivot.CreatePivotTable"],resizable:!1,autoOpen:!1,close:function(){o()},open:function(){i()}};V||(r(),V=new e.ZSClass.Dialog(G,t),l(),n()),V.open()}function r(){var t=e.UserAction.getTemplate(["pivotSourceTemplate","pivotDestinationTemplate","pivotButtonTemplate"]);G=document.createElement("div"),G.id="DI_PIVOT_PROMPT",G.appendChild(t.pivotSourceTemplate),G.appendChild(t.pivotDestinationTemplate),G.appendChild(t.pivotButtonTemplate),G.querySelector("#confirmPivot").addEventListener("click",S),G.querySelector("#cancelPivot").addEventListener("click",a),G.querySelector("#nSheet").addEventListener("click",v),G.querySelector("#eSheet").addEventListener("click",u)}function i(){b=m.view.getActiveGridID();var t=m.view.getResourceID(b);k=m.view.getSheetID(b);var r=m.view.getSelectedSheets(b),i=m.view.getVersionID(b),o=m.data.getWorkBook(t,i),a=o.getSheetObj(k);O=a.Prop.getName();var n=m.view.getSheetState(b,k),l=n.getRanges()[0];if(l.startRow===l.endRow&&l.startCol===l.endCol)e.UserAction.getPivotSRange(t,r,i),G.querySelector("#confirmPivot").classList.add("zsDisable");else{var c={sr:l.startRow,sc:l.startCol,er:l.endRow,ec:l.endCol};s(c)}G.querySelector("#nSheet").checked=!0}function o(){A.value="",U&&(U.value=""),G.querySelector("#nSheet").checked=!0,G.querySelector("#targetLoc").classList.add("pvtHide")}function a(){V.close()}function n(){H=G.querySelector("#pivotSourceRange"),A=new E.RangeEditor(H,!0),y.register(A,!0);var e=G.querySelector("#pivotSourceRangeIcon");T.RangePicker.Dialog.register(A,V,e,"Select Range")}function s(e){var t=new T.Range(e.sr,e.sc,e.er,e.ec);A.value=O+"."+t.getLabel(),H.focus(),G.querySelector("#confirmPivot").classList.remove("zsDisable")}function l(){var e=G.querySelector("#pivotTargetCell");U=new E.RangeEditor(e,!0),y.register(U,!0,!0),U.addListeners({valueChanged:c})}function c(){U.value.length>0?G.querySelector("#confirmPivot").classList.remove("zsDisable"):G.querySelector("#confirmPivot").classList.add("zsDisable")}function v(){G.querySelector("#targetLoc").classList.add("pvtHide"),G.querySelector("#confirmPivot").classList.contains("zsDisable")&&G.querySelector("#confirmPivot").classList.remove("zsDisable")}function u(){G.querySelector("#targetLoc").classList.remove("pvtHide"),U.value="",c();var e=G.querySelector("#pivotTargetCell");e.focus()}function d(){var e=m.view.getActiveGridID(),t=m.view.getResourceID(e),r=m.view.getVersionID(e),i=JSUtil.Range.parseRange(t,r,A.value.trim()),o=i.range;if(o.isSingle())return I.publish(D.Listener,h.ERROR.SHOW,{ERRORMSG:"Error.Pivot.Source.Selection"}),!1;L.ID="temp";var a=o.startRow,n=o.startCol,s=o.endRow,l=o.endCol,c=[];c.push(i.sheetID);var v=new T.ParamGenerator(c,t,r),u=v.getSheets(),d=new T.Range(a,n,s,l);UserAction.getPivotFields(t,u[0],r,d,L.ID)}function g(){if(b=m.view.getActiveGridID(),!G.querySelector("#nSheet").checked){var e,t=m.view.getResourceID(b),r=m.view.getVersionID(b),i=JSUtil.Range.parseRange(t,r,U.value.trim()),o=!0;if(i){if(m.data.getWorkBook(t,r).PivotCollection.isPivotCell(i.sheetID,i.range.startRow,i.range.startCol)){var a=i.sheetName,n=new T.Range(i.range.startRow,i.range.startCol,i.range.endRow,i.range.endCol),s=a+"."+n.getLabel(),l=w["Error.Pivot.Table.Overlaps"];e=w["Alert.Title.InvalidDestination"],l=JSUtil.fn.replaceParams(l,new Array(s));var c=document.createElement("div");c.innerHTML=l,o=!1}else if(m.data.getWorkBook(t,r).PivotCollection.isPivotSourceCell(i.sheetID,i.range.startRow,i.range.startCol)){var l=w["Error.Pivot.Table.Overlaps.With.Source"];e=w["Alert.Title.InvalidCellRange"],l=JSUtil.fn.replaceParams(l,new Array(s));var c=document.createElement("div");c.innerHTML=l,o=!1}}else{var l=w["GoalSeek.Msg.InvalidCell"];e=w["Alert.Title.InvalidCellRange"];var c=document.createElement("div");c.innerHTML=l,o=!1}if(o)return!0;var v=[{text:w.OK,primary:!0,click:function(){U.value="",U.focus()}}],u={buttons:v,isHtml:!0,title:e};return T.ZSAlert(c,u),!1}return!0}function S(){if(!G.querySelector("#confirmPivot").classList.contains("zsDisable")){var e=g();if(e){d()}}}function p(e){b=m.view.getActiveGridID();var t=m.view.getResourceID(b),r=m.view.getVersionID(b),i=m.data.getWorkBook(t,r).PivotCollection;L.ID="temp";var o={id:"temp",af:e,pf:[],rf:[],cf:[],df:[],fn:[],ptid:"3tc1",uf:{},sto:!0,rgto:!0,cgto:!0},n=JSUtil.Range.parseRange(t,r,A.value.trim());if(o[q.SOURCE]=[n.sheetID,n.range.startRow,n.range.startCol,n.range.endRow,n.range.endCol],i.add("temp",o),G.querySelector("#nSheet").checked){var s=m.view.getSelectedSheets(b);a(),L.InsertSheetCallBack="NEW_PIVOT",UserAction.InsertSheet(t,s,r,void 0,void 0,!0,void 0)}else{var l=JSUtil.Range.parseRange(t,r,U.value.trim());o[q.TARGET]=[l.sheetID,l.range.startRow,l.range.startCol,l.range.startRow,l.range.startCol],a(),I.publish(D.UI,h.SidePanel.PIVOT.SHOW_ICON),I.publish(D.UI,h.SidePanel.PIVOT.OPEN)}}function f(e){var t=w[e],r=[{text:w.OK,primary:!0}],i={buttons:r,isHtml:!1};return T.ZSAlert(t,i),!1}function R(){}var m=e.sPlusPlus,C=e.ZSConstants.FeatureConstants,w=(e.document,e.ZSConstants.wCC,e.ZSConstants.I18N),P=e.ZSEvents,I=P.topic,D=P.Groups,h=P.Names,T=e.ZSClass,E=T.Editors,L=T.Pivot,y=T.RangePicker,q=e.ZSConstants.CommandConstants,O=void 0,b=void 0,k=void 0,A=void 0,U=void 0,V=void 0,G=void 0,H=void 0,_=m.view.Toolbar.Feature[C.PIVOT_TABLE];I.register(D.Listener,h.UserAction.PIVOT.DETECT_RANGE,s,"resp_Range"),I.register(D.Listener,h.UserAction.PIVOT.NEW_GET_FIELDS,p,"allFields"),m.view.Toolbar.transient.destructor[C.PIVOT_TABLE]=R,_.openDialog=t,_.handleError=f}(this);
!function(t){function e(){this.DOM.autoFilterCnt.innerHTML=""}function i(t){var e=this.getIndexOfSelectedItem(t);-1==e?this.addSelectItem(t):this.removeSelectedItem(e),s.call(this)}function s(){var t=this.selectedItems.length,e=Object.keys(this.activeTabData).length,i=t>0?"enable":"disable";v("filterbtn",i);var s="autoCellFilterSelect";t==e?(!this.DOM[s].classList.contains("filterItemSelect")&&this.DOM[s].classList.add("filterItemSelect"),this.DOM[s].classList.remove("filterPartialSelection")):1>t?(this.DOM[s].classList.remove("filterItemSelect"),this.DOM[s].classList.remove("filterPartialSelection")):(this.DOM[s].classList.contains("filterItemSelect")&&this.DOM[s].classList.remove("filterItemSelect"),!this.DOM[s].classList.contains("filterPartialSelection")&&this.DOM[s].classList.add("filterPartialSelection"))}function l(){var t=this.pivotFilterCell;this.callback.applyFilter(t.pId,t.pft,t.hidx,void 0,!0),this.close()}function r(){var t=this.pivotFilterCell;if(this.DOM.toggleCustFilter.checked){var e=pvtCriteria1.value,i=""!==this.DOM.pvtCustomTxt1.value?this.DOM.pvtCustomTxt1.value:"",s=""!==this.DOM.pvtCustomTxt2.value?this.DOM.pvtCustomTxt2.value:void 0;if("btwn"===e)i=""!==this.DOM.pvtBetTxt1.value?this.DOM.pvtBetTxt1.value:"";else if("top"==e||"bottom"==e){i=pvtFspinner.value;var l=this.container.querySelector("#pvtFoCategory").value;e=e+" "+l}if(pivotFilterByMenu.value<0)var r=1;else var r=2,o=pivotFilterByMenu.value;var a=this.DOM.autoCellFilterSelect.classList.contains("filterItemSelect"),n=JSON.stringify([]);this.callback.applyFilter(t.pId,t.pft,t.hidx,n,a,r,e,i,s,o)}else{var r=0,a=this.DOM.autoCellFilterSelect.classList.contains("filterItemSelect"),n=void 0;a===!1&&(n=JSON.stringify(this.selectedItems)),this.callback.applyFilter(t.pId,t.pft,t.hidx,n,a,r)}this.close()}function o(){var t=a.bind(this),e=this.container.querySelector("#sortAsc"),i=this.container.querySelector("#sortDesc");e.onclick=function(){t("true")},i.onclick=function(){t("false")};var s=p.bind(this);autoSelect.onclick=function(){var t=this.classList.contains("filterPartialSelection")||!this.classList.contains("filterItemSelect")?!0:!1;s(autoFilterCnt,t)}}function a(t){var e=this.DOM.pivotSortSelectTag.value;this.callback.sortPivot(this.pivotFilterCell.pId,this.pivotFilterCell.pft,this.pivotFilterCell.hidx,t,e),this.close()}function n(){pivotFilterByMenu.value<0?(O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","top","hidden",!0),O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","bottom","hidden",!0)):(O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","top","hidden",!1),O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","bottom","hidden",!1))}function c(){pvtFltCrit.classList.contains("betweenData")&&pvtFltCrit.classList.remove("betweenData"),pvtFltCrit.classList.contains("topBotm")&&pvtFltCrit.classList.remove("topBotm");var t=pvtCriteria1.value;if("btwn"===t)pvtFltCrit.classList.add("betweenData");else if("top"===t||"bottom"===t){pvtFltCrit.classList.add("topBotm");var e="enable";v("filterbtn",e)}}function h(){var t=l.bind(this),e=r.bind(this);this.DOM.clearbtn.onclick=function(){t()},this.DOM.filterbtn.onclick=function(){e()}}function v(t,e){O[e]("#"+t)}function u(t,e){t.style.display=e?"":"none"}function p(t,e){for(var i=t.children,l=0;l<i.length;l++){var r=i[l],o=e&&!r.classList.contains("filterItemSelect")||!e;if(o){var a=r.getAttribute("value");if(e)r.classList.add("filterItemSelect"),r.classList.remove("filterPartialSelection"),this.addSelectItem(a),v("filterbtn","enable");else{r.classList.remove("filterPartialSelection"),r.classList.remove("filterItemSelect");var n=this.getIndexOfSelectedItem(a);this.removeSelectedItem(n),v("filterbtn","disable")}}}s.call(this)}function d(){var t=this.container;this.DOM={autoFilterCnt:t.querySelector("#autoFilterCnt"),clearbtn:t.querySelector("#clearbtn"),filterbtn:t.querySelector("#filterbtn"),autoFilter:t.querySelector("#autoFilter"),autoCellFilterSearch:t.querySelector("#autoSearch"),autoCellFilterSelect:t.querySelector("#autoSelect"),pivotSortSelectTag:t.querySelector("#pivotSortByMenu"),pvtCriteria1:t.querySelector("#pvtCriteria1"),pvtFltCrit:t.querySelector("#pvtFltCrit"),pvtCustomTxt1:t.querySelector("#pvtCustomTxt1"),pvtCustomTxt2:t.querySelector("#pvtCustomTxt2"),pvtBetTxt1:t.querySelector("#pvtBetTxt1"),pvtFspinner:t.querySelector("#pvtFspinner"),pFcategory:t.querySelector("#pFcategory"),pivotFilterByMenu:t.querySelector("#pivotFilterByMenu"),labelOptGrp:t.querySelector("#labelOptGrp"),valueOptGrp:t.querySelector("#valueOptGrp"),toggleCustFilter:t.querySelector("#toggleCustFilter")}}var f=t.sPlusPlus,m=t.ZSClass,D=t.document,O=t.UIUtil.Component,S=t.ZSConstants,C=(S.I18N,S.ActionConstants,m.Pivot),b=t.ZSConstants.PivotConstant,F=C.Dialog||(C.Dialog={}),M=function(t){this.callback=t,this.init()};M.prototype={init:function(){var e=t.UserAction.getTemplate(["pivotFilter"]),i=e.pivotFilter;this.container=D.createElement("div"),this.container.id="DI_PIVOT_FILTER",this.container.className="flWrapper fltPvtDlg",this.container.appendChild(i),D.body.appendChild(this.container),this.selectedItems=[],O.initComponent("#"+this.container.id),d.call(this),o.call(this)},getDialogPos:function(){return this.container.style.display="",{height:this.container.clientHeight,width:this.container.clientWidth}},show:function(t,e,i,s,l){this.container.style.top=t+i+f.view.measures.gridTop+"px",this.container.style.left=e+s+f.view.measures.gridLeft+"px",this.pivotFilterCell=l},generatePivotData:function(t){this.data=t,this.fFilterDetails=t[b.PIVOT_FILTER_DETAILS],this.fSortDetails=t[b.PIVOT_SORT_DETAILS];var e=this.container.querySelector("#autoFilterCntloader");u(e,!0);var i=C.Util.getsortByValues(this.pivotFilterCell.pId,this.pivotFilterCell.pft,this.pivotFilterCell.hidx);this.constructPivotSortMenu(i);var s=this.fFilterDetails.fType;s&&s>0?(this.DOM.toggleCustFilter.checked=!0,this.constructCustomFilter(i),this.constructPivotAutofilter(i)):(this.DOM.toggleCustFilter.checked=!1,this.constructPivotAutofilter(i),this.constructCustomFilter(i)),u(e,!1),h.call(this)},constructPivotAutofilter:function(){var t="generateAutoFilterItems",e="autoFilterCnt",l="autoCellFilterSearch",r=this.fFilterDetails.cD,o={},a=[];if(0==this.fFilterDetails.selectedItemIndexes.length)for(var n in o)a.push(0);else a=this.fFilterDetails.selectedItemIndexes;for(var c=[],h=0;h<r.length;h++){{var v=""==r[h]?"(Blanks)":r[h];r[h]}c.push(v)}this.activeTabData=c,s.call(this);{var e=this.DOM[e],u=0,p=i.bind(this);new m.AutoSuggest.filterSuggest({editor:this.DOM[l],container:e,data:c,dataType:"Array",fuzzy:!0,dontCreateSpan:!0,callBack:function(e){var i=e.text,s=new m.Filter.selectItems(void 0,p);s[t](i,a[u],e.dom),e.decorate=function(){},u++}})}},constructPivotSortMenu:function(t){var e=(document.createDocumentFragment(),this.fSortDetails[b.PIVOT_DATAFIELDINDEX]),i=this.fSortDetails[b.ASCENDING_SORT],s=this.container.querySelector("#sortAsc"),l=this.container.querySelector("#sortDesc");this.fSortDetails[b.PIVOT_SORTMODE]<1?(s.classList.remove("selected"),l.classList.remove("selected")):i?(s.classList.add("selected"),l.classList.remove("selected")):(l.classList.add("selected"),s.classList.remove("selected")),this.DOM.pivotSortSelectTag.innerHTML="";for(var r=-1,o=0;o<t.length;o++){var a=document.createElement("option");a.value=r,a.textContent=t[o],this.DOM.pivotSortSelectTag.appendChild(a),r++}O.zcombo(this.DOM.pivotSortSelectTag,"refresh"),O.zcombo(this.DOM.pivotSortSelectTag,"setValue",e)},constructCustomFilter:function(t){var e=this.fFilterDetails.fc1,i=this.fFilterDetails.fv,s=this.fFilterDetails.fv1,l=this.fFilterDetails[b.PIVOT_DATAFIELDINDEX],r="enable";this.DOM.pvtCustomTxt1.onfocus=function(){v("filterbtn",r)},this.DOM.pvtCustomTxt2.onfocus=function(){v("filterbtn",r)};var o=-2;l>-1&&(o=l),this.DOM.labelOptGrp.innerHTML="",this.DOM.valueOptGrp.innerHTML="";for(var a=-1,h=0;h<t.length;h++){var u=document.createElement("option");u.value=a,u.textContent=t[h],0==h?(u.value=-2,this.DOM.labelOptGrp.appendChild(u)):this.DOM.valueOptGrp.appendChild(u),a++}O.zcombo(this.DOM.pivotFilterByMenu,"setValue",o),o>-1?(O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","top","hidden",!1),O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","bottom","hidden",!1)):(O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","top","hidden",!0),O.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","bottom","hidden",!0)),O.zcombo(this.DOM.pvtCriteria1,"setValue",e),"btwn"===e?(pvtFltCrit.classList.add("betweenData"),this.DOM.pvtBetTxt1.value=i,this.DOM.pvtCustomTxt2.value=s):"top"===e||"bottom"===e?(pvtFltCrit.classList.add("topBotm"),O.zspinner(this.DOM.pvtFspinner,"setValue",i)):i&&(this.DOM.pvtCustomTxt1.value=i),O.zcombo(this.DOM.pivotFilterByMenu,"refresh"),O.zcombo(this.DOM.pvtCriteria1,"refresh"),O.bind(this.DOM.pvtCriteria1,"zselectboxchange",c.bind(this)),O.bind(this.DOM.pivotFilterByMenu,"zselectboxchange",n.bind(this))},close:function(){this.selectedItems=[];var t=this.container&&""===this.container.style.display;t&&(this.container.style.display="none",e.call(this)),pvtFltCrit.classList.contains("betweenData")&&pvtFltCrit.classList.remove("betweenData"),pvtFltCrit.classList.contains("topBotm")&&pvtFltCrit.classList.remove("topBotm"),O.zcombo(this.DOM.pivotFilterByMenu,"setValue",-1),O.zcombo(this.DOM.pvtCriteria1,"setValue",-1),this.DOM.pvtCustomTxt1.value="",this.DOM.pvtCustomTxt2.value="",this.DOM.pvtBetTxt1.value=""},getIndexOfSelectedItem:function(t){return this.selectedItems.indexOf(t)},removeSelectedItem:function(t){this.selectedItems.splice(t,1)},initActiveTab:function(){this.filterTypes[this.activeTab]={},this.filterTypes[this.activeTab].selectedItems=[],s.call(this)},addSelectItem:function(t){this.selectedItems.push(t)},getActiveTab:function(){return this.filterTypes[this.activeTab]}},F.Filter=M}(this);
!function(e){function t(e,t){var i=P.querySelector("#createPivot");N.isAlive()&&(e?(i.classList.remove("ZsRt"),i.children[0].classList.remove("generate"),i.children[1].innerText=F["Pivot.UI.Generate"],t&&i.classList.add("ui-button-disabled","ui-state-disabled")):(i.children[1].innerText=F["Pivot.UI.Progress"],i.children[0].classList.add("generate"),i.classList.add("ZsRt")))}function n(e){var t=m.view.getActiveGridID(),i=m.view.getResourceID(t),n=m.view.getVersionID(t);B=I.Pivot.currentPivotId;var l=m.data.getWorkBook(i,n).PivotCollection.get(B);e&&(l[y.TARGET]=[e,0,0,0,0]),r()}function r(){W=0;var e=m.view.getActiveGridID(),t=m.view.getResourceID(e),i=m.view.getVersionID(e);B=I.Pivot.currentPivotId;var n=m.data.getWorkBook(t,i).PivotCollection.get(B),r=n[y.SOURCE];U=r[1],x=r[2],O=r[3],q=r[4],w=r[0],N||l(),a(),N.open()}function l(){{var t="right";Math.round(screen.height/10)}t+=" top";var i={width:418,title:F["Pivot.UI.Builder.Title"],resizable:!1,autoOpen:!1,left:400,close:function(){s()},open:function(){o()}},n=e.UserAction.getTemplate(["pivotBuilderTemplate","pivotBuilderDateTemplate"]);P=document.createElement("div"),P.id="DI_PIVOT_BUILDER",P.classList.add("pivotBuilder"),P.appendChild(n.pivotBuilderTemplate),P.querySelector("#createPivot").addEventListener("click",v),P.querySelector("#cancelPivot").addEventListener("click",h),P.querySelector("#resetPivot").addEventListener("click",u),N=new e.ZSClass.Dialog(P,i),d()}function d(){var e,t,i=[F.None,F["Pivot.Submenu.Year"],F["Pivot.Submenu.Quarter"],F["Pivot.Submenu.Month"],F["Pivot.Submenu.Day"],F["Pivot.Submenu.Day.Week"],F["Pivot.Submenu.Quarter.Year"],F["Pivot.Submenu.Month.Year"]],n=document.getElementById("popupmenu"),r=document.createElement("ul");r.id="dateDropDown",r.setAttribute("ctype","zmenu"),r.setAttribute("relativeto","parent");for(var l=i.length,d=0;l>d;d++){var a=i[d],o=document.createElement("li"),s=d+1;o.id="gr"+s,o.textContent=a,r.appendChild(o)}n.appendChild(r),_.bind(r,"menushow",function(i,n){var r=n.target[0],l=r.parentNode;t=l.textContent.trim();for(var d,a=R[T.ALL_FIELDS],o=0;o<a.length;o++){var s=a[o];"Td"===s.type&&s.content===t&&(d=s[T.GROUP])}e=void 0===d?"gr1":"gr"+(d+1),_.zmenu("#dateDropDown","changeIcon",e,"ui-individual-icon ui-icon-ztick")}),_.bind(r,"menuhide",function(){e&&_.zmenu("#dateDropDown","changeIcon",e,"ui-zmenu-no-icon")}),_.bind(r,"menuitemclicked",function(e,i){for(var n=i.menu.prevObject[0].id,r=n.substring(2)-1,l=R[T.ALL_FIELDS],d=0;d<l.length;d++){var a=l[d];"Td"===a.type&&a.content===t&&(a[T.GROUP]=r)}})}function a(){var e=m.view.getActiveGridID(),t=m.view.getResourceID(e),i=m.view.getSelectedSheets(e),n=m.view.getVersionID(e),r=new I.Range(U,x,O,q);UserAction.getPivotFields(t,i,n,r)}function o(){}function s(){G&&G.unbindEvent(),c("#pB_allFields"),c("#pf ul,#rf ul,#cf ul,#df ul")}function c(e){var t=document.querySelectorAll(e);t.forEach(function(e){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild)})}function v(){for(var e=m.view.getActiveGridID(),i=m.view.getResourceID(e),n=m.view.getSelectedSheets(e),r=m.view.getVersionID(e),l=R[T.ALL_FIELDS],d={},a=0;a<l.length;a++){var o=l[a],s=o[T.GROUP];if(void 0!==s){var c=o.colIndex;d[c.toString()]=s}}R[T.GROUP]=d,t(!1),UserAction.createPivot(i,n,r,R)}function h(){N.close()}function u(){for(var e=[T.PAGE_FIELDS,T.ROW_FIELDS,T.COLUMN_FIELDS,T.DATA_FIELDS],t=0;t<e.length;t++){for(var i=e[t],n=P.querySelector("#"+i+" ul");n.firstChild;)n.removeChild(n.firstChild);R[i]=[]}for(var r=P.querySelector("#pB_allFields").children,t=0;t<r.length;t++){var l=r[t];l.classList.remove("used-element")}k=[],R[T.FUNCTION]=[],P.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled")}function p(t){return e.UserAction.getTemplate([t])}function f(e,t){R=t,k=[],this.allFields=R[T.ALL_FIELDS],this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1},this.placeholder={element:void 0,parent:void 0,position:void 0}}function g(){var e=e||window.event,t=e.target,n=t.className,r=t.parentNode.className,l=t.parentNode.parentNode.className,d=n;-1!=n.indexOf("ui-zcombo-select-item")?d=r:-1!=n.indexOf("ui-icon-triangle-1-s")?d=l:(-1!=n.indexOf("ui-zmenu-item")||-1!=n.indexOf("ui-zmenu-text"))&&(d="pDtmBox");var a=document.getElementsByClassName("pvtDataMenuBox");if(-1==d.indexOf("pDtmBox")){for(i=0;i<a.length;i++)a[i].style.display="none";document.body.removeEventListener("mousedown",g)}}var m=e.sPlusPlus,D=e.ZSConstants.FeatureConstants,F=(e.document,e.ZSConstants.wCC,e.ZSConstants.I18N),E=e.ZSEvents,L=E.topic,S=E.Groups,A=E.Names,I=e.ZSClass,y=(I.Editors,e.ZSConstants.CommandConstants),_=e.UIUtil.Component,T=e.ZSConstants.PivotConstant,C=e.JSUtil,b=m.view.Toolbar.Feature[D.PIVOT_BUILDER],N=void 0,P=void 0,U=void 0,x=void 0,O=void 0,q=void 0,w=void 0,B=void 0,R=void 0,k=[],M=void 0,W=0,G=void 0;f.prototype={init:function(){this.constructFieldList(),this.constructMainList(),this.bindEvent()},constructMainList:function(){for(var e=P.querySelector("#pB_allFields"),t=R.af,i=document.createDocumentFragment(),n=0;n<t.length;n++){var r=t[n],l=r.colIndex,d=r.content,a=r.type;if(-1!==l){r.i=n+1;var o=p("allFieldsTemplate").allFieldsTemplate,s=o.querySelector("li"),c=o.querySelector(".fldL"),v=o.querySelector(".fldIns");v.addEventListener("click",this.insertField.bind(this),!1),c.parentNode.children[0].className="fld"+a,c.innerText=d,this.isUsedField(l)&&(s.className+=" used-element"),i.appendChild(o)}}e.appendChild(i),P.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled")},constructFieldList:function(){for(var e=[T.PAGE_FIELDS,T.ROW_FIELDS,T.COLUMN_FIELDS,T.DATA_FIELDS],t=R[T.ALL_FIELDS],i=R[T.FUNCTION],n=0;n<e.length;n++){var r=e[n],l=R[r],d=P.querySelector("#"+r+" ul");if(l&&l.length>0)for(var a=0;a<l.length;a++){var o=l[a];if(-1===o){var s={content:"Values",colIndex:-1,type:"Tt"},c=document.createDocumentFragment(),v=p("fieldTemplate").fieldTemplate,h=v.querySelector("li"),u=v.querySelector(".fldRmv");u.addEventListener("click",this.removeField.bind(this),!1);var f=v.querySelector(".fldL");f.innerText=s.content,c.appendChild(h),d.appendChild(c),k.push({content:s.content,colIndex:s.colIndex,field:r}),this.allFields.push(s)}else for(var g=0;g<t.length;g++){var m=t[g];if(o===m.colIndex){var D=m.content;if(r===T.DATA_FIELDS){var E,L=i[a];for(E in L)var S=L[E];var A=E.charAt(0).toUpperCase()+E.slice(1),D=C.fn.replaceParams(F["Pivot.UI.Datafield.Content."+A],new Array(m.content));"none"!=S&&(D="% "+D)}var c=document.createDocumentFragment(),v=p("fieldTemplate").fieldTemplate,h=v.querySelector("li");if("Td"===m.type){var I=v.querySelector(".pDrpdwn");I.style.visibility="visible",I.setAttribute("popup","dateDropDown")}else if(r===T.DATA_FIELDS){h.setAttribute("content",m.content);var I=v.querySelector(".pDrpdwn");I.style.visibility="visible",I.addEventListener("click",this.showPivotBuilderDataMenu.bind(this),!1)}h.addEventListener("dragover",this,!1),h.addEventListener("dragstart",this,!1),h.addEventListener("dragenter",this,!1);var u=v.querySelector(".fldRmv");u.addEventListener("click",this.removeField.bind(this),!1);var f=v.querySelector(".fldL");f.innerText=D,c.appendChild(h),d.appendChild(c),k.push({content:m.content,colIndex:m.colIndex,field:r})}}}}},isUsedField:function(e){for(var t=[T.PAGE_FIELDS,T.ROW_FIELDS,T.COLUMN_FIELDS,T.DATA_FIELDS],i=!1,n=0;n<t.length;n++){var r=t[n],l=R[r];if(l.indexOf(e)>-1){i=!0;break}}return i},getUsedField:function(e){for(var t=0;t<k.length;t++){var i=k[t];if(i.content===e&&i.field!==T.DATA_FIELDS)return i.field}return void 0},insertField:function(e){var t,i=e.target,n=i.parentNode.parentNode,r=n.textContent.trim(),l=this.getUsedField(r);if(!l){var d=n.children[0].children[0];if(t=this.getDefaultField(d)){n.className+=" used-element";var a=P.querySelector("#"+t+" ul"),o=a.children.length;this.selection.sender="allFields",t===T.DATA_FIELDS?this.addDataField(a,r,o):this.addField(t,r,o)}}},removeField:function(e){var t,i=e.target,n=void 0,r=i.parentNode.parentNode,l=r.parentNode.parentNode,d=l.id;t=d===T.DATA_FIELDS?r.getAttribute("content"):r.textContent.trim(),d&&this.removeDroppedElement(d,t,!0,n)},addValuesField:function(){var e=T.COLUMN_FIELDS,t=P.querySelector("#"+e+" ul").children.length;if(t>=5){e=T.ROW_FIELDS;var t=P.querySelector("#"+e+" ul").children.length}if(t>=5)return!1;var i="Values";return this.addListElement(e,i,t),this.allFields.push({content:i,colIndex:-1,type:"Tt"}),this.addElementToUsedField(e,i,t),!0},addDataField:function(e,t,i){var n=T.DATA_FIELDS;return this.isMaxField(n,t)?!1:1!==this.getFieldLength(T.DATA_FIELDS)||this.addValuesField()?(this.addListElement(T.DATA_FIELDS,t,i),this.addElementToUsedField(T.DATA_FIELDS,t,i),!0):!1},addField:function(e,t,i){if(!this.isMaxField(e,t)){if(e===T.DATA_FIELDS){{P.querySelector("#"+T.DATA_FIELDS+" ul").children}if(1===this.getFieldLength(T.DATA_FIELDS)&&!this.addValuesField())return!1}("allFields"===this.selection.sender||this.selection.sender===T.DATA_FIELDS)&&(this.addListElement(e,t,i),this.addElementToUsedField(e,t,i))}},addListElement:function(e,t,i){var n,r=P.querySelector("#"+e+" ul"),l=this.getFieldType(t),d="";if(e===T.DATA_FIELDS){var a,o={},s=R[T.FUNCTION];0==s.length?(a="Tn"===l?"sum":"count",o[a]="none",s.splice(i,0,o)):a=s[i],a=a.charAt(0).toUpperCase()+a.slice(1),d="data",n=t,t=C.fn.replaceParams(F["Pivot.UI.Datafield.Content."+a],new Array(t))}else"Td"===l&&(d="date");var c=document.createDocumentFragment(),v=p("fieldTemplate").fieldTemplate,h=v.querySelector(".pDrpdwn"),u=v.querySelector("li");e===T.DATA_FIELDS?(u.setAttribute("content",n),h.style.visibility="visible",h.addEventListener("click",this.showPivotBuilderDataMenu.bind(this),!1)):"Td"===l&&(h.style.visibility="visible",h.setAttribute("popup","dateDropDown"));var f=v.querySelector(".fldRmv");f.addEventListener("click",this.removeField.bind(this),!1);var g=v.querySelector(".fldL");g.innerText=t,c.appendChild(v),u.addEventListener("dragstart",this,!1),u.addEventListener("dragover",this,!1),u.addEventListener("dragenter",this,!1);var m=r.querySelector(".dropPos");m?m.replaceWith(c):r.appendChild(c)},replacePlaceHolderWithElem:function(){if(this.selection.sender===T.DATA_FIELDS&&this.selection.receiver!=T.DATA_FIELDS){var e=this.selection.draggingField.getAttribute("content"),t=this.selection.draggingField.querySelector(".pDrpdwn");t.style.visibility="hidden",t.removeEventListener("click",this.showPivotBuilderDataMenu.bind(this));var i=this.selection.draggingField.querySelector(".fldL");i.innerText=e}var n=this.selection.receiver,r=P.querySelector("#"+n+" ul"),l=r.querySelector(".dropPos"),n=this.selection.receiver;l&&("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"),l.replaceWith(this.selection.draggingField))},addElementToUsedField:function(e,t,i){var n=this.getColIndex(t);k.push({content:t,colIndex:n,field:e}),this.changeElementInFieldArray(n,i,e)},changeElementInFieldArray:function(e,t,i,n,r){k.length>0?P.querySelector("#createPivot").classList.remove("ui-button-disabled","ui-state-disabled"):P.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled");var l=void 0;if(n){var d=R[n];if(void 0!==r&&r>-1&&n===T.DATA_FIELDS){d.splice(r,1);var a=R[T.FUNCTION];l=a.splice(r,1)[0]}else for(var o=0;o<d.length;o++)if(d[o]===e){d.splice(o,1),n===T.DATA_FIELDS&&(a=R[T.FUNCTION],l=a.splice(o,1)[0]);break}}if(i){var s=R[i];s.splice(t,0,e),l&&i===T.DATA_FIELDS&&a.splice(t,0,l)}},removeALLDataField:function(){for(var e=P.querySelector("#"+T.DATA_FIELDS+" ul").children,t=e.length,i=0;t>i;i++){var n=e[0];this.removeDroppedElement(T.DATA_FIELDS,n.getAttribute("content"),!0)}},removeDroppedElement:function(e,t,i,n){this.removeListElement(e,t,n);var r=this.removeElementFromUsedField(e,t,i,n);i&&-1===r&&this.removeALLDataField()},removeListElement:function(e,t,i){var n,r=P.querySelector("#"+e+" ul").children,l=e===T.DATA_FIELDS;if(void 0!==i&&i>-1)n=r[i],"dropPos"===n.getAttribute("class")?(n=r[i+1],n.parentNode.removeChild(n)):n.parentNode.removeChild(n);else for(var d=0;d<r.length;d++){n=r[d];var a=l?n.getAttribute("content"):n.textContent.trim();a===t&&n.parentNode.removeChild(n)}if(l&&this.getFieldLength(T.DATA_FIELDS)<=1){var o=this.getUsedField("Values");o&&this.removeDroppedElement(o,"Values",!1)}},getFieldLength:function(e){for(var t=0,i=P.querySelector("#"+e+" ul").children,n=0;n<i.length;n++){var r=i[n];r.classList.contains("dropPos")||t++}return t},removeElementFromUsedField:function(e,t,i,n){for(var r=-2,l=0;l<k.length;l++){var d=k[l];if(d.field===e&&d.content===t){r=d.colIndex,k.splice(l,1);break}}return r>=-1&&this.changeElementInFieldArray(r,void 0,void 0,e,n),i&&-1!==r&&this.toggleAllFieldCheck(t,r,!1),r},toggleAllFieldCheck:function(e,t,i){if(!this.isUsedField(t))for(var n=P.querySelector("#pB_allFields").children,r=0;r<n.length;r++){var l=n[r];if(l.textContent.trim()===e){i?l.classList.add("used-element"):l.classList.remove("used-element");break}}},getFieldType:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content===e)return i.type}return"Tt"},isMaxField:function(){return!1},unbindEvent:function(){for(var e=P.querySelector("#pB_allFields").children,t=0;t<e.length;t++){var i=e[t];i.removeEventListener("dragstart",this,!1)}for(var n=P.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul"),t=0;t<n.length;t++){var r=n[t];r.removeEventListener("dragenter",this,!1),r.removeEventListener("dragover",this,!1),r.removeEventListener("drop",this,!1),r.removeEventListener("dragend",this,!1)}},bindEvent:function(){var e=document.createElement("li");e.className="dropPos",this.placeholder.element=e;for(var t=P.querySelector("#pB_allFields").children,i=0;i<t.length;i++){var n=t[i];n.addEventListener("dragstart",this,!1)}for(var r=P.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul"),i=0;i<r.length;i++){var l=r[i];l.addEventListener("dragenter",this,!1),l.addEventListener("dragover",this,!1),l.addEventListener("drop",this,!1),l.addEventListener("dragleave",this,!1)}},handleEvent:function(e){var t=e.target.parentNode,i=e.target.nodeName;if("dragend"===e.type)this.pFieldDragEnd(e);else if("LI"===i){var n=t.id?t.id:t.parentNode.id;if("pB_allFields"===n)switch(e.type){case"dragstart":this.allField_dragstart(e)}else if("pf"===n||"rf"===n||"cf"===n||"df"===n)switch(e.type){case"dragstart":this.field_dragstart(e);break;case"dragenter":this.field_dragEnter(e);break;case"dragover":this.field_dragover(e);break;case"drop":this.fieldContainer_drop(e)}}else if("UL"===i)switch(e.type){case"dragenter":this.fieldContainer_dragEnter(e);break;case"dragover":this.fieldContainer_dragover(e);break;case"drop":this.fieldContainer_drop(e);break;case"dragend":this.fieldContainer_dropEnd(e);break;case"dragleave":this.fieldContainer_dragLeave(e)}else if("SPAN"===i)switch(e.type){case"dragenter":this.field_eventDPrevent(e);break;case"dragover":this.field_eventDPrevent(e);break;case"drop":this.fieldContainer_drop(e)}},pFieldDragEnd:function(){var e=this.selection.draggingField.textContent.trim();if(this.selection.dropped){var t=this.getUsedField(e);t&&(this.selection.draggingField.className+=" used-element")}else{var i=this.selection.sender;"allFields"!=i&&this.removeDroppedElement(i,e,!0)}for(var n=[T.PAGE_FIELDS,T.ROW_FIELDS,T.COLUMN_FIELDS,T.DATA_FIELDS],r=0;r<n.length;r++){var l=P.querySelector("#"+n[r]).children[0];l.contains(this.placeholder.element)&&l.removeChild(this.placeholder.element)}this.applyOrRemoveHoverClass(!1),document.body.removeEventListener("dragend",this,!1)},addSelection:function(e){if(this.selection.owner){if(this.selection.owner!=e.parentNode)return}else this.selection.owner=e.parentNode;this.selection.draggingField=e},clearSelections:function(){this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1}},allField_dragstart:function(e){var t=e.target;this.clearSelections(),this.addSelection(e.target),e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("text/html",this.outerHTML),this.selection.sender="allFields",this.selection.usedElement=t.classList.contains("used-element")?!0:!1,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},field_dragstart:function(e){e.dataTransfer.effectAllowed="move",e.stopImmediatePropagation();var t=e.target;this.clearSelections(),this.addSelection(t),this.selection.sender=t.parentNode.parentNode.id,this.selection.receiver=t.parentNode.parentNode.id,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},fieldContainer_dragEnter:function(e){e.preventDefault(),"UL"==e.target.nodeName&&(this.selection.receiver=e.target.parentNode.id,e.target.contains(this.placeholder.element)||e.target.appendChild(this.placeholder.element))},fieldContainer_dragover:function(e){e.preventDefault(),e.stopPropagation()},field_dragEnter:function(){event.preventDefault(),event.stopPropagation()},field_dragover:function(e){e.preventDefault(),e.stopPropagation();var t=e.target,i=this._index(this.placeholder.element),n=this._index(t);this.placeholder.position=i,"allFields"!=this.selection.sender&&"none"!==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="none"),n>i?this._after(t,this.placeholder.element):this._before(t,this.placeholder.element)},fieldContainer_drop:function(e){e.target.parentNode,e.target.nodeName;e.preventDefault(),e.stopPropagation(),this.checkAddField(),this.selection.dropped=!0},field_eventDPrevent:function(e){e.preventDefault()},fieldContainer_dragLeave:function(e){var t=e.target.parentNode.id,i=this.placeholder.parent;"pf"!==t&&"rf"!==t&&"cf"!==t&&"df"!==t||"pf"!==i&&"rf"!==i&&"cf"!==i&&"df"!==i||e.target.contains(this.placeholder.element)&&e.target.removeChild(this.placeholder.element)},checkAddField:function(){var e=this.selection.draggingField.textContent.trim();this.selection.sender===T.DATA_FIELDS&&(e=this.selection.draggingField.getAttribute("content"));var t=this.placeholder.position,i=this.selection.receiver;if("allFields"===this.selection.sender)if(this.selection.usedElement){var n=this.getUsedField(e);n?n===this.selection.receiver||this.isMaxField(this.selection.receiver,e)||(this.removeDroppedElement(n,e,!1),this.addField(i,e,t)):this.addField(i,e,t)}else this.addField(i,e,t);else if(this.selection.receiver===T.DATA_FIELDS)if(d=this.getColIndex(e),this.selection.sender===T.DATA_FIELDS)this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(d,t,this.selection.sender,this.selection.sender);else{this.removeElementFromUsedField(this.selection.sender,e,!1);var r=P.querySelector("#df").children[0];r.contains(this.placeholder.element)&&r.removeChild(this.placeholder.element);var l=P.querySelector("#df ul");this.addDataField(l,e,t)}else if(this.selection.sender===this.selection.receiver){var d=this.getColIndex(e);t>=0&&(this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(d,t,this.selection.sender,this.selection.sender))}else this.replacePlaceHolderWithElem(),this.removeElementFromUsedField(this.selection.sender,e,!1),this.addElementToUsedField(i,e,t)},_index:function(e){return e.parentElement?Array.prototype.indexOf.call(e.parentElement.children,e):0},_before:function(e,t){e.parentElement.insertBefore(t,e)},_after:function(e,t){e.parentElement.insertBefore(t,e.nextElementSibling)},applyOrRemoveHoverClass:function(e,t,i){i=this.selection.draggingField.textContent.trim(),t=this.selection.sender;for(var n=[T.PAGE_FIELDS,T.ROW_FIELDS,T.COLUMN_FIELDS,T.DATA_FIELDS],r=0;r<n.length;r++){var l=n[r],d=5,a=P.querySelector("#"+l+" ul"),o=void 0;"allFields"===t&&i&&(o=this.getUsedField(i)),e&&o!==l&&(a.children.length<d||l===this.selection.sender)?a.classList.add("dragStart"):a.classList.remove("dragStart")}},getDefaultField:function(e){return e.classList.contains("fldTn")&&R[T.DATA_FIELDS].length<5?T.DATA_FIELDS:e.classList.contains("fldTd")&&R[T.ROW_FIELDS].length<5?T.ROW_FIELDS:this.getMinUsedField()},getColIndex:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content===e)return i.colIndex}return void 0},getMinUsedField:function(){var e=R[T.ROW_FIELDS].length,t=R[T.COLUMN_FIELDS].length;return 5>e||5>t?e>t?T.COLUMN_FIELDS:T.ROW_FIELDS:0===R[T.DATA_FIELDS].length?T.DATA_FIELDS:R[T.PAGE_FIELDS].length<5?T.PAGE_FIELDS:void 0},showPivotBuilderDataMenu:function(){var t=e.UserAction.getTemplate(["pivotBuilderDataMenuTemplate"]),n=e.UIUtil.Component,r=document.getElementById("DI_PIVOT_BUILDER_DATAMENU");r||(M=document.createElement("div"),M.id="DI_PIVOT_BUILDER_DATAMENU",M.appendChild(t.pivotBuilderDataMenuTemplate),document.body.appendChild(M));var l=document.getElementsByClassName("pvtDataMenuBox");for(i=0;i<l.length;i++)l[i].style.display="none";var d,a,o,s,c,v=event.target,h=v.parentNode.parentNode,u=h.parentNode,p=Array.prototype.slice.call(u.children),f=p.indexOf(h),m=h.children,D=M.querySelector("#pvtDataMenus");if(m.length<2){d=D.cloneNode(!0),d.removeAttribute("id");var E=d.getElementsByTagName("select"),s=E[0],c=E[1];W+=1,s.setAttribute("id","Data"+W),n.bind(s,"combochange",function(){var e=new Event("change");s.dispatchEvent(e)}),s.addEventListener("change",function(e){var t=e.target,i=t.parentNode.parentNode.parentNode.parentNode,n=i.parentNode,r=Array.prototype.slice.call(n.children),l=r.indexOf(i),d=this.value,a=R[T.FUNCTION],o="none",s=a[l];for(var c in s)o=s[c];var v={};v[d.toLowerCase()]=o,a[l]=v;var h=i.getAttribute("content"),u=C.fn.replaceParams(F["Pivot.UI.Datafield.Content."+d],new Array(h));"none"!=o&&(u="% "+u);var h=i.querySelector(".fldL");h.innerText=u}),W+=1,c.setAttribute("id","Data"+W),n.bind(c,"combochange",function(e){var t=e.target,i=t.parentNode.parentNode.parentNode.parentNode,n=i.parentNode,r=Array.prototype.slice.call(n.children),l=r.indexOf(i),d=this.value,a=R[T.FUNCTION],o=a[l];for(var s in o)_=o[s];var c={};c[s]=d,a[l]=c;var v=i.getAttribute("content"),h=s.charAt(0).toUpperCase()+s.slice(1),u=C.fn.replaceParams(F["Pivot.UI.Datafield.Content."+h],new Array(v));"none"!=d&&(u="% "+u);var v=i.querySelector(".fldL");v.innerText=u}),n.initComponent(d),h.appendChild(d)}a=h.children[1],o=h.offsetTop-(parseInt(D.style.height)+h.offsetHeight-5),a.style.top=o+"px",a.style.display="block";var L=R[T.FUNCTION],S=f+(f+1),A="#Data"+S,I="#Data"+(S+1),y="Sum",_="none",b=L[f];for(y in b)_=b[y];var N=y.charAt(0).toUpperCase()+y.slice(1);a.querySelector(A).value=N,a.querySelector(I).value=_,n.zcombo(s,"refresh"),n.zcombo(c,"refresh"),setTimeout(function(){document.body.addEventListener("mousedown",g)},10)}},L.register(S.Listener,A.UserAction.PIVOT.OPEN_PIVOTBUILDER,r),L.register(S.Listener,A.UserAction.PIVOT.BEFORE_BUILDEROPEN,n,"NEWSHEETID"),b.openDialog=r}(this);
!function(e){function t(){f||o(),setTimeout(function(){n()},10),f.open()}function o(){var t={width:358,title:u["Pivot.UI.Source.Title"],close:function(){l()},open:function(){s()}},o=e.UserAction.getTemplate(["pivotSourceTemplate","pivotButtonTemplate"]);D=document.createElement("div"),D.id="DI_PIVOT_CHANGE_SOURCE",D.appendChild(o.pivotSourceTemplate),D.appendChild(o.pivotButtonTemplate),D.querySelector("#confirmPivot").addEventListener("click",a),D.querySelector("#cancelPivot").addEventListener("click",r),f=new e.ZSClass.Dialog(D,t),i()}function n(){var e=v.Pivot.currentPivotId,t=c.view.getActiveGridID(),o=c.view.getResourceID(t),n=c.view.getVersionID(t),i=c.data.getWorkBook(o,n).PivotCollection.get(e),a=i[P.SOURCE],r=a[0],s=c.data.getWorkBook(o,n).getSheetObj(a[0]).Prop.getName(),l=new v.Range(a[1],a[2],a[3],a[4]);m.value=s+"."+l.getLabel(),m.focus(),p.publish(E.Listener,I.RangePicker.Update,{RID:o,SHEETID:r,VERSION:n,RANGE:l}),S.animateLabel.trigger(m)}function i(){var e=D.querySelector("#pivotSourceRange");e.focus(),m=new d.RangeEditor(e,!0),v.RangePicker.register(m,!0);var t=e.nextSibling;v.RangePicker.Dialog.register(m,f,t,"Select Range")}function a(){var e=v.Pivot.currentPivotId,t=c.view.getActiveGridID(),o=c.view.getResourceID(t),n=c.view.getVersionID(t),i=c.data.getWorkBook(o,n).PivotCollection.get(e),a=i[P.SOURCE],s=JSUtil.Range.parseRange(o,n,m.value.trim()),l=!1;if(a[0]!==s.sheetID||a[1]!==s.range.startRow)l=!0;else if(a[2]!==s.range.startCol||a[4]!==s.range.endCol){for(var g=a[4],u=a[2],C=[PivotConstants.PAGE_FIELDS,PivotConstants.ROW_FIELDS,PivotConstants.COLUMN_FIELDS,PivotConstants.DATA_FIELDS],d=0;d<C.length;d++){var S=C[d],p=i[S];if(p&&p.length>0)for(var E=0;E<p.length;E++){var I=p[E];g>I&&(g=I),I>u&&(u=I)}}(g<s.range.startCol||u>s.range.endCol)&&(l=!0)}if(l);else{i[P.SOURCE]=[s.sheetID,s.range.startRow,s.range.startCol,s.range.endRow,s.range.endCol];var R=c.view.getSelectedSheets(t);r(),UserAction.changePivotSource(o,R,n,e,s.range,!1)}}function r(){f.close()}function s(){}function l(){m.value=""}var c=e.sPlusPlus,v=(e.document,e.UIUtil.Component,e.ZSClass),g=e.ZSConstants.FeatureConstants,u=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),C=(e.ZSConstants.wCC,e.ZSEvents),d=v.Editors,S=v.Editors.Utility,p=C.topic,E=C.Groups,I=C.Names,P=e.ZSConstants.CommandConstants,R=c.view.Toolbar.Feature[g.PIVOT_CHANGE_SOURCE],f=void 0,D=void 0,m=void 0;R.openDialog=t}(this);
!function(e){function t(e){A=!1,O=!1,g||i(),e&&"Move"===e.getAttribute("data-label")?(A=!0,d="move"):e&&"Copy"===e.getAttribute("data-label")?(d="copy",O=!0):"move"==d?A=!0:"copy"==d&&(O=!0),g.setTitle(A?C["Pivot.UI.Move.Title"]:C["Pivot.UI.Select.Location.Title"]),S.querySelector("#nSheet").checked=!0,g.open()}function i(){var t={width:358,title:C["Pivot.UI.Move.Title"],close:function(){u()},open:function(){v()}},i=e.UserAction.getTemplate(["pivotDestinationTemplate","pivotButtonTemplate"]);S=document.createElement("div"),S.id="DI_PIVOT_MOVE",S.appendChild(i.pivotDestinationTemplate),S.appendChild(i.pivotButtonTemplate),S.querySelector("#confirmPivot").addEventListener("click",n),S.querySelector("#cancelPivot").addEventListener("click",c),S.querySelector("#nSheet").addEventListener("click",o),S.querySelector("#eSheet").addEventListener("click",a),g=new e.ZSClass.Dialog(S,t),r(S)}function r(){var e=S.querySelector("#pivotTargetCell");L=new T.RangeEditor(e,!0),P.RangePicker.register(L,!0,!0),L.addListeners({valueChanged:s})}function o(){S.querySelector("#targetLoc").classList.add("pvtHide"),S.querySelector("#confirmPivot").classList.contains("zsDisable")&&S.querySelector("#confirmPivot").classList.remove("zsDisable")}function a(){s(),S.querySelector("#targetLoc").classList.remove("pvtHide"),L.value="";var e=S.querySelector("#pivotTargetCell");e.focus()}function n(){var e=m.view.getActiveGridID(),t=m.view.getResourceID(e),i=m.view.getSelectedSheets(e),r=m.view.getVersionID(e),o=P.Pivot.ID;if(S.querySelector("#nSheet").checked)if(c(),A?D.InsertSheetCallBack="MOVE_PIVOT":O&&(D.InsertSheetCallBack="COPY_PIVOT"),"INSERT_PIVOT"===D.InsertSheetCallBack)P.Pivot.Util.insertFromRecommendation(!0,!1);else{var a=new P.Range(0,0,0,0);UserAction.movePivot(t,i,r,o,a,!1,!0,d)}else if(A||O){D.LastAction=A?"DIALOG_MOVE":"DIALOG_COPY";var n=JSUtil.Range.parseRange(t,r,L.value.trim());if(!n){var l=C["GoalSeek.Msg.InvalidCell"],s=[{text:C.OK,primary:!0,click:function(){L.value="",L.focus()}}],v={buttons:s,title:C["Alert.Title.InvalidCellRange"]};return P.ZSAlert(l,v),!1}c();var u=[];u.push(n.sheetID),UserAction.movePivot(t,u,r,o,n.range,!1,!1,d)}else{D.LastAction="DIALOG_INSERT";var e=m.view.getActiveGridID(),t=m.view.getResourceID(e),r=m.view.getVersionID(e),g=m.data.getWorkBook(t,r).PivotCollection.get("temp"),n=JSUtil.Range.parseRange(t,r,L.value.trim());g[p.TARGET]=[n.sheetID,n.range.startRow,n.range.startCol,n.range.startRow,n.range.startCol],c(),P.Pivot.Util.insertFromRecommendation()}}function l(e){var i=e.split("#"),r=i[0],o=i[1],a=i.slice(1,i.length),n=P.Pivot.ID;if(a.length<1){var l=m.view.getActiveGridID(),s=m.view.getResourceID(l),c=m.view.getVersionID(l),v=m.data.getWorkBook(s,c).PivotCollection.get(n),u=v[p.TARGET],d=m.data.getWorkBook(s,c),g=d.getSheetObj(u[0]),S=g.Prop.getName(),I=new P.Range(u[1],u[2],u[3],u[4]);a=S+"."+I.getLabel()}if("Error.Pivot.Table.Part.Change"===r||"Error.Pivot.Table.Overlaps.With.Source"===r){var f=C[r],T=[{text:C.OK,primary:!0,click:function(){t()}}],A={buttons:T,title:"Error.Pivot.Table.Part.Change"===r?C["Alert.Title.PivotTable"]:C["Alert.Title.InvalidCellRange"]};P.ZSAlert(f,A)}else if("Error.Pivot.Table.Overlaps.Create"===r||r.contains("Error.Pivot.Overwrite.Data")){var f,O;if("Error.Pivot.Table.Overlaps.Create"===r){f=C["Error.Pivot.Table.Overlaps.Create"],O=C["Error.Pivot.Table.Overlaps.Header"],f=JSUtil.fn.replaceParams(f,new Array(a));var E=document.createElement("div");E.innerHTML=f;var T=[{text:C.OK,primary:!0,click:function(){t()}}],A={buttons:T,isHtml:!0,title:C["Alert.Title.InvalidDestination"]};P.ZSAlert(E,A)}else{f=C[r],O=C["Error.Pivot.Overwrite.Data.Header"],f=JSUtil.fn.replaceParams(f,new Array(a));var E=document.createElement("div");E.innerHTML=f;var T=[{text:C.Yes,primary:!0,click:function(){switch(D.LastAction){case"SP_MOVE":case"SP_COPY":case"DIALOG_MOVE":case"DIALOG_COPY":var e=JSUtil.fn.getPosFromLabel(o),t=JSUtil.fn.getPosFromLabel(o).ranges[0],i=m.view.getActiveGridID(),r=m.view.getResourceID(i),a=(m.view.getSelectedSheets(i),m.view.getVersionID(i)),n=P.Pivot.ID;if("DIALOG_MOVE"==D.LastAction||"SP_MOVE"==D.LastAction)var l="move";else if("DIALOG_COPY"==D.LastAction||"SP_COPY"==D.LastAction)var l="copy";var s=m.data.getWorkBook(r,a),c=s.SheetList.getIdByName(e.sheetName),v=[];v.push(c),UserAction.movePivot(r,v,a,n,t,!0,!1,l);break;case"DIALOG_INSERT":P.Pivot.Util.insertFromRecommendation(!1,!0)}}},{text:C.No}],A={buttons:T,isHtml:!0};P.ZSAlert(E,A)}}}function s(){L.value.trim().length>0?S.querySelector("#confirmPivot").classList.remove("zsDisable"):S.querySelector("#confirmPivot").classList.add("zsDisable")}function c(){S.querySelector("#nSheet").checked=!0,o(),g.close()}function v(){}function u(){L.value=""}var d,g,S,m=e.sPlusPlus,P=(e.document,e.UIUtil.Component,e.ZSClass),I=e.ZSConstants.FeatureConstants,p=e.ZSConstants.CommandConstants,C=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),f=(e.ZSConstants.wCC,e.ZSEvents),T=P.Editors,A=(P.Editors.TextAreaEditor,P.Editors.Utility,f.topic,f.Groups,f.Names,!1),O=!1,D=P.Pivot,E=m.view.Toolbar.Feature[I.PIVOT_MOVE],L=void 0;E.openDialog=t,E.handleError=l}(this);
!function(e){function t(){var e=R.getKeyContext(),t=e.keyDown;t[h.ENTER]=function(){o()}}function n(e){var t=f.view.getActiveGridID(),n=f.view.getResourceID(t),r=f.view.getSheetID(t),i=f.view.getVersionID(t),o=(f.view.getSelectedSheets(t),f.view.getSheetState(t,r)),s=o.getActiveCellRange(),l=f.data.getWorkBook(n,i).getSheetObj(r),g=(O.hash(s.startRow,s.startCol,T),l.sparklines.groupranges.getInfo(s.startRow,s.startCol));g&&!e?_.publish(P.UI,b.SidePanel.Sparklines.OPEN):a()}function a(){var n={width:400,dialogClass:"",title:N["SidePanel.Sparklines.Insert"]},a=A.getTemplate(["sparklineCreateTemplate"]).sparklineCreateTemplate;I=document.createElement("div"),I.id=C.DI+w.SPARKLINE+C.IDENTITY,I.appendChild(a),R=new e.ZSClass.Dialog(I,n),i(),t(),setTimeout(function(){r()},0),R.open()}function r(){var e=f.view.getActiveGridID(),t=f.view.getResourceID(e),n=f.view.getSheetID(e),a=f.view.getVersionID(e),r=f.data.getWorkBook(t,a),i=(r.getSheetObj(n),f.view.getSheetState(e,n)),o=i.getActiveRange();U.sourceRange.value="",U.sourceRange.focus(),_.publish(P.Listener,b.RangePicker.Update,{SHEETID:n,RANGE:o,RID:t,VERSION:a}),U.destinationRange.focus()}function i(){g(["sourceRange","destinationRange"],I,R);var e=I.querySelector("#ok"),t=I.querySelector("#cancel");e.addEventListener("click",o),t.addEventListener("click",s)}function o(){var e=U.sourceRange.value.split(";"),t=U.destinationRange.value.split(";"),n=v();c(e,t,n,void 0,"SPARKLINE_CREATE")}function s(){R.close()}function l(e){var t=e.keyCode||e.which;return 13===t?(e.preventDefault(),!0):void 0}function g(e,t,n){e.forEach(function(e){var a=t.querySelector("#"+e),r=new p.RangeEditor(a,!0);r.customPreventDefault=l,k.register(r,!0);var i=a.nextSibling;D.RangePicker.Dialog.register(r,n,i,"Select Range"),U[e]=r})}function c(e,t,n,a,r){for(var i,o=f.view.getActiveGridID(),s=f.view.getResourceID(o),l=f.view.getSheetID(o),g=f.view.getVersionID(o),c=f.view.getSelectedSheets(o),v=f.data.getWorkBook(s,g).getSheetObj(l),I=[],E=[],h=0;h<e.length;h++){var w=JSUtil.Range.parseRange(s,g,e[h]);if(void 0==w)return void d("INVALID_SOURCE_RANGE");I.push(w)}for(var h=0;h<t.length;h++){var w=JSUtil.Range.parseRange(s,g,t[h]);if(void 0==w)return void d("INVALID_DESTINATION_RANGE");if(void 0==i&&(i=w.sheetID),i!=w.sheetID)return void d("MULTI_SHEET_DESTINATION");E.push(w)}var N=S(I,E,!1);if(N||(E=u(I,E,v)),S(I,E,!0)){for(var C=[],D=[],p=Math.max(I.length,E.length),h=0;p>h;h++){var k=E[h],T=I[h];void 0!=k&&D.push(k.range),void 0!=T&&C.push(T.range)}var O=JSON.parse(JSON.stringify(D));A.createSparklines(s,o,c,O,c,C,l,n,a,r),_.publish(P.UI,b.SidePanel.Sparklines.SELECT,{RID:s,SHEETID:l,VERSION:g,RANGES:D}),"SPARKLINE_CREATE"==r&&R.close()}}function u(e,t,n){for(var a=[],r=0;r<t.length;r++){var i=t[r],o=e[r];if(void 0==i||void 0==o)return;var s=n.Merge.getInfo(i.range.startRow,i.range.startCol);if(void 0!=s&&i.range.startRow==s.startRow&&i.range.endRow==s.endRow&&i.range.startCol==s.startCol&&i.range.endCol==s.endCol){var l=n.Merge.getIntersectedRanges(i.range);if(l)if(o.range.startRow==o.range.endRow||o.range.startCol==o.range.endCol){var g={};g.range=new D.Range(i.range.startRow,i.range.startCol,i.range.startRow,i.range.startCol),g.sheetID=i.sheetID,g.sheetName=i.sheetName,a.push(g)}else a.push(i)}}return a}function S(e,t,n){for(var a="NONE",r=0,i=0,o=0,s=0;s<e.length;s++){var l=e[s];r+=l.range.endRow-l.range.startRow+1,i+=l.range.endCol-l.range.startCol+1}for(var s=0;s<t.length;s++){var l=t[s];l.range.endRow-l.range.startRow>0&&l.range.endCol-l.range.startCol>0&&(a="MULTI_ROL_COL"),o+=(l.range.endRow-l.range.startRow+1)*(l.range.endCol-l.range.startCol+1)}switch(r!=o&&i!=o&&(a="INCONSISTENT_RANGES"),a){case"NONE":return!0;default:n&&d(a)}return!1}function d(e){switch(e){case"MULTI_SHEET_DESTINATION":G.buttons[0].click=function(){U.destinationRange&&U.destinationRange.focus()},G.title=N["Alert.Title.InvalidDestination"],D.ZSAlert(N["SidePanel.Sparklines.Alert.MultiSheet"],G);break;case"MULTI_ROL_COL":G.buttons[0].click=function(){U.destinationRange&&U.destinationRange.focus()},G.title=N["Alert.Title.InvalidDestination"],D.ZSAlert(N["SidePanel.Sparklines.Alert.MultiRowDest"],G);break;case"INVALID_DESTINATION_RANGE":G.buttons[0].click=function(){U.destinationRange&&U.destinationRange.focus()},G.title=N["Alert.Title.InvalidDestination"],D.ZSAlert(N["SidePanel.Sparklines.Alert.DestInvalid"],G);break;case"INVALID_SOURCE_RANGE":G.buttons[0].click=function(){U.sourceRange&&U.sourceRange.focus()},G.title=N["Alert.Title.InvalidSourceRange"],D.ZSAlert(N["SidePanel.Sparklines.Alert.SourceInvalid"],G);break;case"INCONSISTENT_RANGES":G.buttons[0].click=function(){U.destinationRange&&U.destinationRange.focus()},G.title=N["Alert.Title.InvalidCellRange"],D.ZSAlert(N["SidePanel.Sparklines.Alert.Inconsistent"],G)}}function v(){{var e=I.querySelector("#line"),t=I.querySelector("#column");I.querySelector("#winloss")}return e.checked?"line":t.checked?"column":"winloss"}var R,I,f=e.sPlusPlus,E=e.ZSConstants,h=e.ZSConstants.JSKeyCode,w=E.FeatureConstants,N=E.I18N,A=e.UserAction,C=e.ZSConstants.wCC,D=e.ZSClass,p=D.Editors,k=D.RangePicker,T=f.data.Defaults.MAX_COL,O=e.JSUtil.Math,L=e.ZSEvents,_=L.topic,P=L.Groups,b=L.Names,m=f.view.Toolbar.Feature[w.SPARKLINE],U={},y=[{text:N.OK,primary:!0}],G={buttons:y};JSUtil.SparklinePool.create=c,m.openDialog=n}(this);
!function(e){function t(){var t=e.UserAction.getTemplate(["SAVEAS_TEMPLATE"]),s=t.SAVEAS_TEMPLATE,a=f.view.getActiveGridID(),r=f.view.getResourceID(a),c=f.view.getVersionID(a),u=f.view.getSheetID(a),d={modal:!0,width:340,title:R["MenuItem.FileTab.SaveAsTemplate"],open:function(){n(r,u,c)}};S||(T=Z.createElement("div"),T.id=N.DI+D.SAVE_AS_TEMPLATE+N.IDENTITY,T.appendChild(s),S=new e.ZSClass.Dialog(T,d),A=T.querySelector("#saveTemplate"),p=T.querySelector("#cancelTemplate"),A.addEventListener("click",function(){i(r,c)}),p.addEventListener("click",function(){S.close()}),v=A.childNodes[1],m=T.querySelector("#saveAsTemplateName"),E=T.querySelector("#savedTemplateLink"),y=T.querySelector("#savedTemplateCalloutLink"),g=T.querySelector(".zssucState"),C=T.querySelector("#saveAsTemplateInp"),l(r,c),o()),S.open()}function n(e,t,n){A.className="Zsbtn",v.nodeValue=R["Dialog.Button.Save"],g.style.display="none",C.style.display="block",p.style.display="block";var l=s(e,t,n);a(l)}function s(e,t,n){var s=f.data.getWorkBook(e,n),a=s.Name;return a}function a(e){d.value=e,m.select()}function l(e,t){var n=S.getKeyContext();n.keyDown[h.ENTER]=function(){i(e,t)}}function o(){d=new q.TextAreaEditor(m)}function i(t,n){var s=d.value;s&&0!==s.trim().length?(A.className="Zsbtn ZsRt",v.nodeValue=R["Dialog.Button.Saving"]+"...",p.style.display="none",e.UserAction.saveAsTemplate(t,n,s)):r()}function r(){ZSClass.ZSAlert(R["InvalidMsg.TemplateName"],{title:R["Alert.Title.EnterTemplateName"]})}function c(e,t){S.close();var n=UserAction.getTemplate(["STATUS_ALERT"]),s=n.STATUS_ALERT;s.querySelector("#msg").innerText=R["SaveAsTemplate.SuccessMsg"];var a=s.querySelector("#fileLink");a.href=f.data.AppRegistry.ctxpath+f.data.AppRegistry.ClientURI+t,a.innerText=e,a.title=e,ZSClass.ZSAlert(s,{type:"success",title:R["Alert.Title.TemplateSaved"],isHtml:!0,buttons:[{text:R.Close}]})}function u(){S.close()}var S,T,A,p,v,d,m,E,y,g,C,f=e.sPlusPlus,D=e.ZSConstants.FeatureConstants,N=e.ZSConstants.wCC,Z=e.document,I=e.ZSEvents,L=I.topic,k=I.Groups,w=I.Names,R=e.ZSConstants.I18N,q=ZSClass.Editors,h=e.ZSConstants.JSKeyCode,M=f.view.Toolbar.Feature[D.SAVE_AS_TEMPLATE];L.register(k.Listener,w.UserAction.SaveAsTemplateResponse,c,"NEWDOCNAME","NEWDOCRID"),M.openDialog=t,M.closeDialog=u}(this);
!function(e){function t(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getVersionID(e);UserAction.deleteVersion(t,n,function(){var t=a.view.getVersionState(e),n=t.getActiveVersionLog(),i=n.getVersionNumber();n.remove();var r=t.getVersionLogMap();delete r[i];var o;for(var s in r){o=r[s];break}o&&o.dom.click()})}function n(){var t={model:!0,width:390,title:l["Version.DeleteVersion"],close:function(){},open:function(){}};r||(i(),r=new e.ZSClass.Dialog(o,t));var n=a.view.getActiveGridID(),c=a.view.getVersionState(n),v=c.getVersionNumber(),u=JSUtil.fn.replaceParams(l["AT.DeleteVersion.Alert"],["#"+parseFloat(v)]);s.innerText=u,r.open()}function i(){var n=e.UserAction.getTemplate(["DELETE_VERSION"]),i=n.DELETE_VERSION;s=i.querySelector("#message");var a=i.querySelector("#okBtn");a.addEventListener("click",function(){t(),r.close()});var l=i.querySelector("#cancelBtn");l.addEventListener("click",function(){r.close()}),o=v.createElement("div"),o.id=u.DI+c.DELETE_VERSION+u.IDENTITY,o.appendChild(i)}var r,o,s,a=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,l=e.ZSConstants.I18N,v=e.document,u=e.ZSConstants.wCC,E=a.view.Toolbar.Feature[c.DELETE_VERSION];E.openDialog=n}(this);
!function(e){function t(){var t=e.UserAction.getTemplate(["SP_CREATEVERSION"]),o=t.SP_CREATEVERSION,E={modal:!0,width:360,title:y["VersionDialog.CreateVersion"],dialogClass:"",open:function(){n()}};if(!a){i=document.createElement("div"),i.id="DI_CREATEVERSION",i.appendChild(o);var S=i.querySelector("#cv_versionLabel");l=new e.ZSClass.Editors.TextAreaEditor(S);var C={keydown:function(e){var t=e.keyCode||e.which;t==ZSConstants.JSKeyCode.ENTER&&(e.stopPropagation(),s())}};l.addListeners(C),r=i.querySelector("#cv_createBtn"),c=i.querySelector("#cv_cancelBtn"),r.addEventListener("click",s),c.addEventListener("click",function(){a.close()}),d=r.childNodes[1],u=i.querySelector("#createVersionInp"),v=i.querySelector(".zssucState"),a=new e.ZSClass.Dialog(i,E)}a.open(),l.focus()}function n(){i.querySelector("#cv_versionLabel").value="",r.className="Zsbtn",d.nodeValue=y["Dialog.Button.Create"],c.style.display="block",u.style.display="block",v.style.display="none"}function s(){var t=l.value;if(t){r.className="Zsbtn ZsRt",d.nodeValue=y["Dialog.Button.Creating"]+"...",c.style.display="none";var n=E.view.getActiveGridID(),s=E.view.getResourceID(n),o=E.view.getVersionID(n);e.UserAction.CreateVersion(s,o,t),a.close()}else ZSClass.ZSAlert(y.Namecannotbeempty,{title:y["Alert.Title.EnterName"]})}function o(){u.style.display="none",v.style.display="block"}var a,i,l,r,c,d,u,v,E=e.sPlusPlus,S=e.ZSConstants.FeatureConstants,y=ZSConstants.I18N,C=e.ZSEvents,p=C.topic,N=C.Groups,R=C.Names,V=E.view.Toolbar.Feature[S.CREATE_VERSION];V.openDialog=t,p.register(N.Listener,R.UserAction.CreateVersionResponse,o,"VERSION_NAME","RID","VERSION")}(this);
!function(t){function e(){var t={width:400,title:"Apply Password",close:function(){},open:function(){}};if(!o){var e=UserAction.getTemplate(["passwordprotected"]),a=e.passwordprotected;s=p.createElement("div"),s.id=r.DI+i.AUDIT_TRAIL+r.IDENTITY,o=new ZSClass.Dialog(s,t),n(a),s.appendChild(a)}o.open()}function n(){}var o,s,a=t.sPlusPlus,i=t.ZSConstants.FeatureConstants,r=t.ZSConstants.wCC,l=a.view.Toolbar.Feature[i.EXPORT],p=t.document;l.openDialog=e}(this);
!function(e){function t(e){var t=r.view.getActiveGridID(),n=r.view.getResourceID(t),i=r.view.getVersionID(t),s=r.view.getSheetID(t);D.publish(g.Selector.BoundUpdate.Copy,E.Selection.BOUND_UPDATE.HIDE,{RID:n,SHEETID:s,VERSION:i,VisualCueStatus:0}),v.showOpenDialog(o),e.preventDefault()}function o(){var e=new n,t=r.view.Events.Key;t.Entry.Dialog.Node.addChildNode(e);var o=c.querySelector("#attachopenfiledialogdiv");o&&(o.addEventListener("mousedown",function(){i()}),v.bind(o,"dialogclose",function(){s()}))}function n(){l.KeyMapping.call(this)}function i(){var e=r.view.Events.Key;e.focusContext(e.Entry.Dialog.Context)}function s(){var e=r.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function a(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),o=r.data.PageRegistry.wmsOptions.langCode;v.getDocsCompI18N(o,t)}var r=e.sPlusPlus,u=e.ZSConstants.FeatureConstants,v=e.UIUtil.Component,c=e.document,l=e.ZSClass,d=e.ZSEvents,D=d.topic,g=d.Groups,E=d.Names,p=r.view.Toolbar.Feature[u.OPEN];D.register(g.UI,E.Layout.TEMPLATE_LOADED,a),p.openDialog=t}(this);
!function(e){function t(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),n=r.view.getSheetID(e),i=r.view.getVersionID(e);g.publish(D.Selector.BoundUpdate.Copy,E.Selection.BOUND_UPDATE.HIDE,{RID:t,SHEETID:n,VERSION:i,VisualCueStatus:0}),c.showShareDialog(t,o)}function o(){var e=new n,t=r.view.Events.Key;t.Entry.Dialog.Node.addChildNode(e);var o=l.querySelector("#sharedialogdiv");o&&(o.addEventListener("mousedown",function(){i()}),c.bind(o,"dialogclose",function(){s()})),setTimeout(function(){o.querySelector("#zd_initial_sharetextarea").focus(),t.focusContext(t.Entry.Dialog.Context)},300)}function n(){v.KeyMapping.call(this)}function i(){var e=r.view.Events.Key;e.focusContext(e.Entry.Dialog.Context)}function s(){var e=r.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function a(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),o=r.data.PageRegistry.wmsOptions.langCode;c.getDocsCompI18N(o,t)}var r=e.sPlusPlus,u=e.ZSConstants.FeatureConstants,c=e.UIUtil.Component,l=e.document,v=e.ZSClass,d=e.ZSEvents,g=d.topic,D=d.Groups,E=d.Names,C=r.view.Toolbar.Feature[u.SHARE];g.register(D.UI,E.Layout.TEMPLATE_LOADED,a),C.openDialog=t}(this);
!function(e){function t(){ft.isRecording=!1,yt.rr=H.checked,U.innerText=it["Macro.Player.Stopping"];var e=tt.view.getActiveGridID(),t=(tt.view.getSheetID(e),tt.view.getResourceID(e)),n=tt.view.getVersionID(e);at.stopRecordingMacro(t,n,yt,r)}function r(){yt={},F.isAlive()&&n(!1)}function n(e){e?(U.innerText=it["Macro.Player.RecordingMacro"],U.classList.remove("mcrRecNoANi"),B.style.display="",G.style.display="none",H.checked=yt.rr):(U.innerText=it["Macro.Player.RecordSuccessfully"],U.classList.add("mcrRecNoANi"),B.style.display="none",G.style.display="")}function i(e,t,r){if(T(e)){ft.isRecording=!0;var n=tt.view.getActiveGridID(),i=mt.assignMacro?mt.sheetID:tt.view.getSheetID(n),c=mt.assignMacro?mt.rid:tt.view.getResourceID(n),o=mt.assignMacro?mt.version:tt.view.getVersionID(n),s=tt.data.getWorkBook(c,o),l=tt.view.getSheetState(n,i),d=l.getActiveRange(),u=l.getActiveRow(),v=l.getActiveCol(),M=tt.view.getSelectedSheets(n),r=r;yt={},yt.sr=d.startRow,yt.sc=d.startCol,yt.er=d.endRow,yt.ec=d.endCol,yt.r=u,yt.c=v,yt.sn=s.getSheetObj(i).Prop.getName(),yt.mn=e,yt.rr=r,yt.des=encodeURIComponent(t),yt.actionIds=[],at.recordMacro(c,i,o,e,t,M,d,u,v,r,a)}}function c(e){ft.isRecording&&yt.actionIds.push(e)}function a(t){if("Error.Macro.Name"==t.mk)ZSClass.ZSAlert(it["Error.Macro.Name"],{title:it["Alert.Title.MacroNameExists"]});else{var r=_.value;mt.assignMacro&&mt.callback("Macros",r),I.close();var i=nt.createElement("div");i.classList.add("mcrRecCls");var c=240,a=window.innerWidth,s=a-c-25,l={width:c,title:i,maskToolbar:!1,top:100,left:s,closeOnEsc:!1,close:function(){ft.isRecording=!1},open:function(){n(!0)}};F||(o(i),F=new e.ZSClass.Dialog(P,l),P.parentElement.classList.add("mcrRec")),F.open()}}function o(e){var r=at.getTemplate(["MacroRecordingPlayer"]),n=r.MacroRecordingPlayer,i=n.querySelector("#stopRecording"),c=n.querySelector("#unsupportedActions");U=n.querySelector(".mcrRecTxt"),G=n.querySelector("#viewCode"),B=n.querySelector("#recordingPart"),H=n.querySelector("#isRelativeRef");var a=n.querySelector("#openVBAEditor"),o=n.querySelector("#openMacroList");i.addEventListener("click",function(){t()}),c.addEventListener("click",function(){window.open(At.UNSUPPORTED_ACTIONS,"_blank")}),a.addEventListener("click",function(){F.close(),lt.publish(dt.UserAction,ut.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros",macName:_.value,refetchFromServer:!0})}),o.addEventListener("click",function(){F.close(),lt.publish(dt.UserAction,ut.UserAction.MACRO.VIEW_MACRO)}),e.addEventListener("click",function(){F.close()}),H.addEventListener("change",function(){yt.rr=H.checked}),P=document.createElement("div"),P.id=ct.DI+rt.CREATE_MACRO+ct.IDENTITY,P.appendChild(n)}function s(e){if(R(!1),"Error.Macro.Name"==e.mk)ZSClass.ZSAlert(it["Error.Macro.Name"],{title:it["Alert.Title.MacroNameExists"]});else{var t=_.value;mt.assignMacro&&mt.callback("Macros",t),I.close(),lt.publish(dt.UserAction,ut.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros",macName:t,refetchFromServer:!0})}}function l(e,t,r,n){mt.assignMacro=!0,mt.rid=e,mt.sheetID=t,mt.version=r,mt.callback=n}function d(e,t,r,n){l(e,t,r,n),f(!1)}function u(e,t,r,n){l(e,t,r,n),f(!0)}function v(e,t,r,n,i){l(e,t,r,i),D||M(),j=i,D.open();var c=n.getScript();if(c){var a=c.getModule(),o=c.getMacroName();"undefined"!==o?(W.innerText=o,W.setAttribute("data-macrotype",ot.Encoder.encodeForHTMLAttribute(a)),Mt=!0,V.style.display=""):V.style.display="none"}}function M(){var t=at.getTemplate(["ASSIGN_MACRO"]),r=t.ASSIGN_MACRO,n=r.querySelector("#assignMacroContainer");et=r.querySelector("#viewMacroList"),X=r.querySelector("#viewDelugeList");var i=(r.querySelector("manageMacroList"),r.querySelector("#writeMacro")),c=r.querySelector("#recordMacro");V=r.querySelector("#currentlyAssigned"),W=V.querySelector("#macName");var a=V.querySelector("#edit");z=r.querySelector(".ZsLoader");var o=r.querySelector("#assign"),s=r.querySelector("#cancel");o.addEventListener("click",function(){if(J){var e=J.dataset.macrotype;j(e,ot.Encoder.encodeForJavaScript(J.innerHTML)),D.close()}}),s.addEventListener("click",function(){D.close()}),X.addEventListener("click",function(){et.classList.remove("active"),X.classList.add("active"),manageMacroList.innerHTML="",""==K||null==K||"undefined"==typeof K?(K=pt.getDelugeFunctionNameList(),g(K,!0)):g(K,!0)}),et.addEventListener("click",function(){X.classList.remove("active"),et.classList.add("active"),manageMacroList.innerHTML="",(Q=""||null==Q||"undefined"==typeof Q)?E(mt.rid,mt.version,[mt.sheetID],g):g(Q,!1)}),a.addEventListener("click",function(){var e=W.dataset.macrotype,t=W.innerHTML;"Deluge"==e?pt.editMacro(t,!0):(D.close(),lt.publish(dt.UserAction,ut.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:e,macName:t}))}),i.addEventListener("click",function(){D.close(),f(!1)}),c.addEventListener("click",function(){D.close(),f(!0)}),Y=r.querySelector(".asgnMcrList");var l={width:540,title:it["Button.ActionBar.AssignMacro"],modal:!0,close:function(){A()},open:function(){E(mt.rid,mt.version,[mt.sheetID],g),et.classList.add("active")}};w=document.createElement("div"),w.id=ct.DI+rt.CREATE_MACRO+ct.IDENTITY,w.appendChild(n),D=new e.ZSClass.Dialog(w,l)}function g(e,t){if(z.style.display="none",Y.innerHTML="",t?K=e:Q=e,e.length>0)for(var r in e){var n=e[r],i=n[0],c=n[1],a=document.createElement("li");a.textContent=c,a.setAttribute("data-macrotype",i),a.addEventListener("click",m.bind(null,a)),Y.appendChild(a),gt.push(c),W.innerText==c&&m(a)}else{if(!$){var o=at.getTemplate(["EMPTY_MACRO_LIST"]),s=o.EMPTY_MACRO_LIST;$=s.querySelector("#noMacros")}Y.appendChild($)}}function m(e){J&&J.classList.remove("active"),e.classList.add("active"),J=e}function A(){Y.innerHTML="",Mt=!1,J=void 0,W.innerHTML="",V.style.display="none",gt=[],Q="",K="",X.classList.add("active"),X.classList.remove("active"),et.classList.add("active"),et.classList.remove("active")}function E(e,t,r,n){z.style.display="",at.getMacroList(e,t,r,n)}function f(t){var r={width:540,title:it["Macro.CreateMacro"],modal:!0,close:function(){mt={}},open:function(){S(),x.focus()}};I||(y(),I=new e.ZSClass.Dialog(N,r)),p(t),I.open()}function S(){_.value="",b.value="",R(!1)}function p(e){k.style.display=e?"":"none",h.style.display=e?"none":"",O.style.display=e?"":"none",q.checked=e,Z.checked=!e}function y(){var e=at.getTemplate(["createMacro"]),t=e.createMacro;x=t.querySelector("#macroName"),_=new vt.TextAreaEditor(x);var r=t.querySelector("#macroDescription");b=new vt.TextAreaEditor(r),h=t.querySelector("#createBtn"),k=t.querySelector("#recordBtn");var n=t.querySelector("#cancelBtn"),c=t.querySelector("#isRelativeReference");O=t.querySelector("#relativeReferenceDiv"),q=t.querySelector("#recordPlay"),Z=t.querySelector("#writeCode"),x.addEventListener("keydown",function(e){13==e.keyCode&&(""==h.style.display?h.click():k.click())}),h.addEventListener("click",function(){C(_.value,b.value)}),k.addEventListener("click",function(){i(_.value,b.value,c.checked)}),n.addEventListener("click",function(){I.close()}),q.addEventListener("click",function(){p(!0)}),Z.addEventListener("click",function(){p(!1)}),N=document.createElement("div"),N.id=ct.DI+rt.CREATE_MACRO+ct.IDENTITY,N.appendChild(t)}function C(e,t){if(e=e.trim(),T(e)){R(!0);var r=tt.view.getActiveGridID(),n=mt.assignMacro?mt.rid:tt.view.getResourceID(r),i=mt.assignMacro?mt.version:tt.view.getVersionID(r);at.createMacro(n,i,e,t,s)}}function R(e){if(e){h.classList.add("ZsRt"),h.textContent=it["Macro.Creating"],h.disabled=!0;var t=document.createElement("span");h.appendChild(t)}else h.classList.remove("ZsRt"),h.textContent=it["Macro.Create"],h.disabled=!1}function L(e){var t=new RegExp("[\\u00A1-\\uFFFF]+");return t.test(e)?3:(t=new RegExp("^[a-zA-Z0-9_]+$"),t.test(e)?(t=new RegExp("^[a-zA-Z][a-zA-Z0-9_]*$"),t.test(e)?0:2):1)}function T(e,t){var r={title:it["Macro.ErrorMsg.Title"]};if(t&&(r.title=it["Alert.Title.InvalidFunctionName"]),""==e.trim())return r.title=it["Alert.Title.EnterMacroName"],ZSClass.ZSAlert(it["Macros.MacroNameCannotBeEmpty"],r),!1;var n=L(e);if(r.title=t?it["Alert.Title.InvalidFunctionName"]:it["Alert.Title.InvalidMacroName"],n>0){if(1==n){var i=t?it["Deluge.NameCannotContainMsg"]:it["Macros.MacroNameCannotContainMsg"];ZSClass.ZSAlert(i,r)}else if(2==n){var i=t?it["Deluge.NameStartWithMsg"]:it["Macros.MacroNameStartWithMsg"];ZSClass.ZSAlert(i,r)}else{var i=t?it["Deluge.NameInEnglish"]:it["Macros.MacroNameInEnglish"];ZSClass.ZSAlert(i,r)}return!1}return!0}var I,N,D,w,h,k,O,q,Z,_,b,x,F,P,U,B,G,H,V,W,Y,j,z,$,J,K,Q,X,et,tt=e.sPlusPlus,rt=e.ZSConstants.FeatureConstants,nt=e.document,it=e.ZSConstants.I18N,ct=e.ZSConstants.wCC,at=e.UserAction,ot=(e.UIUtil.Component,e.ZSEC),st=e.ZSEvents,lt=st.topic,dt=st.Groups,ut=st.Names,vt=ZSClass.Editors,Mt=!1,gt=[],mt={},At=tt.data.AppRegistry.MACRO,Et=tt.view.Toolbar.Feature[rt.CREATE_MACRO],ft=tt.view.Toolbar.Feature[rt.RECORD_MACRO],St=tt.view.Toolbar.Feature[rt.MACRO_STOP_RECORDING],pt=tt.view.Toolbar.Feature[rt.DELUGE],yt=ft.RecordingObj||(ft.RecordingObj={});at.CreateAndAssignMacro=d,at.RecordAndAssignMacro=u,at.assignExistingMacro=v,at.isValidMacroName=T,Et.openDialog=f,ft.openDialog=f,St.execute=t,lt.register(dt.Listener,ut.DocMeta.ACTION_IDENTIFIER,c,"xaid"),lt.register(dt.UserAction,ut.UserAction.MACRO.CREATE_MACRO,f,"isFromRecordMacro")}(this);
!function(e){function t(){var t={width:540,dialogClass:"runMcr",title:y["Macro.RunMacro"],model:!0,close:function(){a()},open:function(){n(!0),i()}};u||(c(),u=new e.ZSClass.Dialog(d,t)),u.open()}function n(e){g.style.display=e?"":"none"}function i(){var e=w.view.getActiveGridID(),t=w.view.getResourceID(e),n=w.view.getVersionID(e),i=w.view.getSelectedSheets(e);C.getMacroList(t,n,i,r)}function o(){var e=w.view.getActiveGridID(),t=w.view.getResourceID(e),n=w.view.getVersionID(e);C.delugeGetFunctionName(t,n,1235,r)}function r(e,t){t?m=e:f=e,n(!1);var i=C.getTemplate(["runMacroRecords"]),o=i.runMacroRecords,r=o.querySelector("#runMacroRecord");if(e.length>0){S.style.display="none";for(var c=0;c<e.length;c++){var a=e[c],l=r.cloneNode();l.innerText=a[1],l.title=a[1],l.addEventListener("click",s.bind(null,e[c][0],e[c][1])),v.appendChild(l)}}else S.style.display=""}function c(){var e=C.getTemplate(["macroList"]),t=e.macroList,i=t.querySelector("#macroListContainer");v=t.querySelector("#macroListTable"),g=t.querySelector(".ZsLoaderSmall"),S=t.querySelector(".ZsNoMsg");var c=t.querySelector("#viewMacroList"),s=t.querySelector("#viewDelugeList");s.addEventListener("click",function(){n(!0),c.classList.remove("active"),s.classList.add("active"),v.innerHTML="",null==m||"undefined"==typeof m?(n(!0),o()):r(m)}),c.addEventListener("click",function(){n(!0),s.classList.remove("active"),c.classList.add("active"),v.innerHTML="",null==f||"undefined"==typeof f?(n(!0),o()):r(f)});var a=t.querySelector("#cancelBtn");a.addEventListener("click",function(){u.close()}),d=document.createElement("div"),d.id=p.DI+L.CREATE_MACRO+p.IDENTITY,d.appendChild(i)}function s(e,t){u&&u.close(),h.show();var n=w.view.getActiveGridID(),i=w.view.getSheetID(n),o=w.view.getResourceID(n),r=w.view.getVersionID(n),c=w.data.getWorkBook(o,r),s=c.SheetList.getById(i),a=s.getName(),d=w.view.getSheetState(n,i),v=d.getActiveRange(),g=w.view.getSelectedSheets(n);"Deluge"==e?T.runMacro(t):C.runMacro(o,i,r,e,t,g,a,v,l)}function a(){v.innerHTML="",S.style.display="none",f=null,m=null}function l(){h.remove()}var u,d,v,g,S,f,m,w=e.sPlusPlus,L=e.ZSConstants.FeatureConstants,y=(e.document,e.ZSConstants.I18N),p=e.ZSConstants.wCC,C=e.UserAction,D=e.ZSEvents,M=D.topic,I=D.Groups,R=D.Names,T=(ZSClass.Editors,e.UIUtil.Component,w.view.Toolbar.Feature[L.DELUGE_EDITOR]),E=w.view.Toolbar.Feature[L.RUN_MACRO],h=new ZSClass.TBNotification("Running...",{mode:"STD",type:"info"});E.openDialog=t,M.register(I.UserAction,R.UserAction.MACRO.RUN_MACRO,s,"modName","macName")}(this);
!function(e){function t(t){var r=h["Deluge.Title"],o=h["VBAMacros.Title"];D=1==t;var a={width:540,title:h["Macro.ViewMacros"],modal:!0,close:function(){n(),b.unregister(Z.Listener,F.DocAction.DELUGE_FUNCTIONS.INSERT,g),b.unregister(Z.Listener,F.DocAction.DELUGE_FUNCTIONS.REMOVE,E)},open:function(){D?(y.click(),S.setTitle(r)):(m.click(),S.setTitle(o)),b.register(Z.Listener,F.DocAction.DELUGE_FUNCTIONS.INSERT,g,"RID","VERSION","DELUGE"),b.register(Z.Listener,F.DocAction.DELUGE_FUNCTIONS.REMOVE,E,"RID","VERSION","DELUGE")}};S||(i(),S=new e.ZSClass.Dialog(M,a)),S.open()}function n(){R.style.display="none",L.innerHTML="",A=null,f=null,y.classList.add("active"),y.classList.remove("active"),m.classList.add("active"),m.classList.remove("active")}function i(){var e=O.getTemplate(["manageMacroList","manageMacro"]),t=e.manageMacroList,n=t.querySelector("#manageMacroContainer");L=n.querySelector("#manageMacroTable"),C=n.querySelector("#manageMacro"),m=t.querySelector("#viewMacroList"),y=t.querySelector("#viewDelugeList");var i=t.querySelector("#cancelBtn");i.addEventListener("click",function(){S.close()}),T=n.querySelector(".ZsLoaderSmall"),R=n.querySelector(".ZsNoMsg"),N=n.querySelector("#noMsg"),m.addEventListener("click",function(){c(!0),y.classList.remove("active"),m.classList.add("active"),L.innerHTML="",R.style.display="none",null==A||"undefined"==typeof A?o():a(A,!1)}),y.addEventListener("click",function(){c(!0),R.style.display="none",m.classList.remove("active"),y.classList.add("active"),L.innerHTML="",null==f||"undefined"==typeof f?(f=V.getDelugeFunctionNameList(),a(f,!0)):a(f,!0)}),M=document.createElement("div"),M.id=U.DI+w.CREATE_MACRO+U.IDENTITY,M.appendChild(n)}function r(){"active"==y.classList.value?(S.close(),V.createInsertDialog()):(S.close(),b.publish(Z.UserAction,F.UserAction.MACRO.CREATE_MACRO,{isFromRecordMacro:!1}))}function o(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),n=I.view.getVersionID(e),i=I.view.getSelectedSheets(e);O.getMacroList(t,n,i,a)}function a(e,t){c(!1);var n=O.getTemplate(["viewMacroRecords"]),i=n.viewMacroRecords,r=i.querySelector(".viewMacroRecord"),o=r.querySelector(".macroNameCell"),a=r.querySelector(".macroActionsCell"),d=a.querySelector(".runThisMacro"),v=a.querySelector(".editThisMacro"),g=a.querySelector(".deleteThisMacro"),E=I.view.getActiveGridID(),D=I.view.getResourceID(E),S=(I.view.getSheetID(E),I.view.getVersionID(E)),M=I.data.getWorkBook(D,S);if(e.length>0){R.style.display="none";for(var m=0;m<e.length;m++){var y=r.cloneNode(),o=o.cloneNode();o.textContent=e[m][1],y.appendChild(o);var a=a.cloneNode();if(M.isEditable()){var d=d.cloneNode(!0);d.addEventListener("click",l.bind(null,e[m][0],e[m][1])),a.appendChild(d)}var v=v.cloneNode(!0);if(v.addEventListener("click",s.bind(null,e[m][0],e[m][1])),a.appendChild(v),M.isEditable()&&_){var g=g.cloneNode(!0);g.addEventListener("click",u.bind(null,e[m][0],e[m][1],y)),a.appendChild(g)}y.appendChild(a),L.appendChild(y)}C.appendChild(L)}else R.style.display="",N.innerHTML="",p(t);t?f=e:A=e}function c(e){T.style.display=e?"":"none"}function s(e,t){"Deluge"==e?V.editMacro(t,!0,S):(S.close(),b.publish(Z.UserAction,F.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:e,macName:t}))}function l(e,t){"Deluge"==e?(S.close(),V.runMacro(t,!1)):(S.close(),b.publish(Z.UserAction,F.UserAction.MACRO.RUN_MACRO,{modName:e,macName:t}))}function u(t,n,i){var r=[{text:h.Yes,primary:!0,click:function(){var r=I.view.getActiveGridID(),o=I.view.getSheetID(r),a=I.view.getResourceID(r),c=I.view.getVersionID(r),s=I.data.getWorkBook(a,c),l=(s.SheetList.getById(o),I.view.getSelectedSheets(r));"Deluge"==t?(e.UserAction.delugeDeleteAction(a,c,n,d,i),P=!0):(O.deleteMacro(a,o,c,l,t,n,d,i),P=!1)}},{text:h.No}],o={buttons:r},a="Deluge"==t?h["Deluge.AreYouSureToDelete"]:h.AreYouSureToDeleteMacro;o.title="Deluge"==t?h["Alert.Title.FunctionDelete"]:h["Alert.Title.MacroDelete"],ZSClass.ZSAlert(k.fn.replaceParams(a,[n]),o)}function d(e,t){t.remove();var n=L.childElementCount;P&&v(e),0==n&&(p(P),R.style.display="")}function v(e){var t=e.delugeResponse;if(t&&"success"==t.status)for(var n=t.function.name,i=0;i<f.length;i++)f[i][1]==n&&f.splice(i,1)}function g(e,t,n){var i=n[0];f?f[f.length]=["Deluge",i]:(f=[],f[0]=["Deluge",i])}function E(e,t,n){for(var i=0;i<n.length;i++)for(var r=0;r<f.length;r++)f[r][1]==n[i]&&f.splice(r,1)}function p(e){if(e){var t=I.data.UserInfo.Permission;if(0==t.isCoOwner&&1==t.isEditable){N.innerHTML=k.fn.replaceParams(h["Deluge.EmptyState"],new Array("<span id='create' class='ZsLink' >","</span>"));var n=N.querySelector("#create");n.addEventListener("click",function(){r()})}else N.innerText=h["Deluge.Owner.EmptyState"]}else{N.innerHTML=k.fn.replaceParams(h["Macros.NoMacrosFound"],new Array("<span id='create' class='ZsLink' >","</span>"));var n=N.querySelector("#create");n.addEventListener("click",function(){r()})}}var D,S,M,L,f,A,L,C,m,y,T,N,R,I=e.sPlusPlus,w=e.ZSConstants.FeatureConstants,h=(e.document,e.ZSConstants.I18N),U=e.ZSConstants.wCC,O=e.UserAction,k=e.JSUtil,q=(e.ZSConstants.JSKeyCode,e.ZSEvents),b=q.topic,Z=q.Groups,F=q.Names,G=(ZSClass.Editors,I.view.Toolbar.Feature[w.MANAGE_MACRO]),_=I.view.Toolbar.Feature[w.CREATE_MACRO],V=I.view.Toolbar.Feature[w.DELUGE],P=!1;b.register(Z.UserAction,F.UserAction.MACRO.VIEW_MACRO,t),G.openDialog=t}(this);
!function(t,i){function o(t,i,o){return this.Editor.getSearchCursor(t,o?o:this.getCursor(),i)}function n(t,o){var n=this;this.Editor=i.fromTextArea(t,o),this.Editor.on("keyup",function(t,o){if(!n.Editor.getOption("readOnly"))if(o.which>=65&&o.which<=90||190==o.which)t.showHint({hint:i.hint.vision,completeSingle:!1});else if(8==o.which){var e=t.getTokenAt(t.getCursor()).string,r=e.charCodeAt(e.length-1);(r>=65&&90>=r||r>=97&&122>=r||46==r)&&t.showHint({hint:i.hint.vision,completeSingle:!1})}}),this.Editor.on("keydown",function(t,i){70==i.which&&(i.metaKey||i.ctrlKey)&&i.preventDefault()})}var e=t.ZSClass,r=e.Editors;n.prototype={set value(t){this.Editor.setValue(t)},get value(){return this.Editor.getValue()},select:function(t,i){this.Editor.setSelection(t,i)},selections:function(t){this.Editor.setSelections(t)},focus:function(){this.Editor.focus()},blur:function(){this.Editor.focus()},setSize:function(t){this.Editor.setSize(t,t)},undo:function(){this.Editor.undo()},redo:function(){this.Editor.redo()},goto:function(t,i){isNaN(t)||isNaN(i)&&void 0!=i||(this.focus(),this.setCursor(t,i))},find:function(t,i){var n=o.call(this,t,i);if(n.findNext()){this.select(n.from(),n.to());{n.to()}return!0}return!1},findFromOrigin:function(t,i,n){var e=o.call(this,t,i,{line:0,ch:0});if(e.findNext()){{e.to()}return n?this.goto(e.from().line+1):this.select(e.from(),e.to()),!0}return!1},findPrev:function(t,i){var n=o.call(this,t,i);if(n.findPrevious()){{n.from()}return this.select(n.from(),n.to()),!0}return!1},replace:function(t,i,n){var e=o.call(this,t,n);if(e.findNext()||(e=o.call(this,t,n,{line:0,ch:0}),e=e.findNext()?e:null),null!=e){e.replace(i);{e.to()}return this.select(e.from(),e.to()),!0}return!1},replaceAll:function(t,i,n){for(var e=o.call(this,t,n,{line:0,ch:0}),r=[];e.findNext();){var s={};e.replace(i),s.anchor=e.from(),s.head=e.to(),r.push(s)}this.selections(r)},getCursor:function(){return this.Editor.getCursor()},setCursor:function(t,i){var o={line:t,ch:i};this.Editor.setCursor(o)},clearUndo:function(){this.Editor.clearHistory()},getLineCount:function(){return this.Editor.lineCount()},setOption:function(t,i){this.Editor.setOption(t,i)},getOption:function(t){return this.Editor.getOption(t)}},r.MacroEditor=n}(this,CodeMirror);
!function(e){function t(e,t,i,o){this.dom=e,this.name=t,this.events=o,this.state={content:i,position:{line:0,ch:0}}}function i(e,t){this.editor=e,this.header={nameHolder:t.querySelector("#moduleName"),eventHolder:t.querySelector("#eventList")},this.ModuleList={}}var o=e.UserAction,n=e.sPlusPlus;o.Macro={};var s=o.Macro;t.prototype={setContent:function(e){this.state.content=e},setPosition:function(e){this.state.position=e},getDom:function(){return this.dom},getName:function(){return this.name},getContent:function(){return this.state.content},getPosition:function(){return this.state.position},getEvents:function(){return this.events}},s.Module=t,i.prototype={setMacroModule:function(e,i,o,n){this.ModuleList[i]=new t(e,i,o,n)},getMacroModule:function(e){return this.ModuleList[e]},setActiveModule:function(e){this.ActiveModule=e},getActiveModule:function(){return this.ActiveModule},save:function(){this.ActiveModule.setContent(this.editor.value),this.ActiveModule.setPosition(this.editor.getCursor()),this.ActiveModule.getDom().classList.remove("active")},revoke:function(){this.editor.value=this.ActiveModule.getContent();var e=this.ActiveModule.getPosition();this.editor.focus(),this.editor.setCursor(e.line,e.ch),this.ActiveModule.getDom().classList.add("active"),this.header.nameHolder.textContent=this.ActiveModule.getName();var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),o=(n.view.getSheetID(t),n.view.getVersionID(t)),s=n.data.getWorkBook(i,o),r=this.ActiveModule.getEvents();if(r&&s.isEditable()){this.header.eventHolder.innerHTML="";var d=document.createElement("option");d.innerText="-Select Event-",this.header.eventHolder.appendChild(d);for(var u in r)d=document.createElement("option"),d.innerText=u,this.header.eventHolder.appendChild(d);this.header.eventHolder.style.display=""}else this.header.eventHolder.style.display="none";this.editor.clearUndo()}},s.MacroModule=i}(this);
!function(e){function t(){this.init()}function i(){var e=b.view.getActiveGridID(),t=b.view.getResourceID(e),i=(b.view.getSheetID(e),b.view.getVersionID(e)),o=b.data.getWorkBook(t,i);o.isEditable()?(W?(this.menuBar.undoButton.style.display="",this.menuBar.redoButton.style.display="",this.menuBar.findButton.style.display="",this.menuBar.insertProcedureButton.style.display="",this.menuBar.saveButton.style.display="",this.menuBar.saveAndRunButton.style.display="",this.enableReadOnlyMode(!1)):(this.menuBar.undoButton.style.display="none",this.menuBar.redoButton.style.display="none",this.menuBar.findButton.style.display="none",this.menuBar.insertProcedureButton.style.display="none",this.menuBar.saveButton.style.display="none",this.menuBar.saveAndRunButton.style.display="none",this.enableReadOnlyMode(!0)),x?(this.menuBar.runButton.style.display="",this.menuBar.errorButton.style.display="",this.menuBar.infoButton.style.display="",this.menuBar.warningButton.style.display=""):(this.menuBar.runButton.style.display="none",this.menuBar.errorButton.style.display="none",this.menuBar.infoButton.style.display="none",this.menuBar.warningButton.style.display="none")):(this.menuBar.undoButton.style.display="none",this.menuBar.redoButton.style.display="none",this.menuBar.findButton.style.display="none",this.menuBar.insertProcedureButton.style.display="none",this.menuBar.saveButton.style.display="none",this.menuBar.runButton.style.display="none",this.menuBar.saveAndRunButton.style.display="none",this.menuBar.errorButton.style.display="none",this.menuBar.infoButton.style.display="none",this.menuBar.warningButton.style.display="none",this.enableReadOnlyMode(!0))}function o(){var e=b.view.getActiveGridID(),t=b.view.getResourceID(e),i=b.view.getSheetID(e),o=b.view.getVersionID(e),r=b.data.getWorkBook(t,o),a=(r.SheetList.getById(i),b.view.getSelectedSheets(e));R.getMacroEditorInfo(t,o,a,this.cache.modName,this.cache.macName,n,this)}function n(e,t,i){var o,n,r=R.getTemplate(["MACRO_MODULES"]),a=r.MACRO_MODULES,s=a.querySelector(".macroModules"),c=a.querySelector(".forMacroModules"),l=i.macroEditorWrapper.querySelector("#eventContainer");i.MacroModule=new P.MacroModule(i.editor,l),i.showLoader(!1);var d=b.view.getActiveGridID(),u=b.view.getResourceID(d),h=(b.view.getSheetID(d),b.view.getVersionID(d)),m=b.data.getWorkBook(u,h);for(var g in e){if("ThisWorkbook"==g)o=i.thisWorkbook,m.isEditable()&&W&&(n={Open:{fName:"Workbook_Open",scope:"Private",type:"Sub"},"New Sheet":{fName:"Workbook_NewSheet",scope:"Private",type:"Sub",arguments:{argName:"sh",type:"Object"}}});else if(e[g].referenceName){var v=s.cloneNode(!0),M=c.cloneNode();M.for=g,M.addEventListener("click",i.loadModule.bind(i,g)),M.textContent=g+"("+e[g].referenceName+")",v.appendChild(M),i.spreadsheetObjects.appendChild(v),o=v,m.isEditable()&&W&&(n={Change:{fName:"Worksheet_Change",scope:"Private",type:"Sub",arguments:{argName:"Target",type:"Range"},defaultContent:"\nApplication.EnableEvents = false\nOn Error Goto ENEV\nREM add your code below\n\nENEV:\nApplication.EnableEvents = true\n"}})}else{var v=s.cloneNode(!0),M=c.cloneNode();M.textContent=g,M.addEventListener("click",i.loadModule.bind(i,g)),v.appendChild(M),i.customMacroObjects.appendChild(v),o=v,n=void 0}var p=e[g].moduleContent;i.MacroModule.setMacroModule(o,g,p,n)}if(void 0==i.MacroModule.getMacroModule("Macros")){var v=s.cloneNode(!0),M=c.cloneNode();M.textContent="Macros",M.addEventListener("click",i.loadModule.bind(i,"Macros")),v.appendChild(M),i.customMacroObjects.appendChild(v),o=v,i.MacroModule.setMacroModule(o,"Macros","",void 0)}i.showLoader(!1),i.loadModule(i.cache.modName),i.goto(i.cache.lineNumber?i.cache.lineNumber:t)}function r(e,t){t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveButton,A["Macro.Editor.Save"]),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveAndRunButton,A["Macro.Editor.SaveAndRun"])}function a(e,t){if(e){var i=e.me;if(i){var o=i.m;t.errorMsgbox.innerHTML=JSUtil.fn.replaceParams(A.EncounteredErrorLNCN,new Array(i.l,i.c))+o,t.showMessagePanel(!0,"error")}var n=e.MACROTABLE;n&&s(n)}t.menuBar.changeMenuButtonState(!1,!1,t.menuBar.runButton,A["Macro.Editor.Run"])}function s(t){var i={width:340,title:A["Macro.RunMacro"],model:!0,closePreviousDialog:!1,open:function(){l(t)}};if(!E){var o=c();E=new e.ZSClass.Dialog(o,i)}E.open()}function c(){E=R.getTemplate(["macrosList"]).macrosList,S=E.querySelector("#macroListTable");var e=E.querySelector("#cancelBtn");e.addEventListener("click",function(){E.close()});var t=document.createElement("div");return t.id=C.DI+L.CREATE_MACRO+C.IDENTITY,t.appendChild(E),t}function l(e){S.innerHTML="";for(var t=0;t<e.length;t++){var i=e[t],o=i.MACRONAME,n=i.MODULENAME,r=document.createElement("li");r.innerText=o,r.title=o,r.addEventListener("click",d.bind(null,n,o)),S.appendChild(r)}}function d(e,t){E.close(),T.publish(k.UserAction,I.UserAction.MACRO.RUN_MACRO,{modName:e,macName:t})}function u(e,t){if(e){var i=e.me;if(i){var o=i.m;t.errorMsgbox.innerHTML=JSUtil.fn.replaceParams(A.EncounteredErrorLNCN,new Array(i.l,i.c))+o,t.showMessagePanel(!0,"error")}var n=e.MACROTABLE;n&&s(n)}t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveButton,A["Macro.Editor.Save"]),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveAndRunButton,A["Macro.Editor.SaveAndRun"])}function h(){var e=this.dialog.getKeyContext(),t=e.keyDown;t[D.PURE_PRINTABLE_CHAR]=B.bind(this),t[D.DELETE]=B.bind(this),t[D.ENTER]=B.bind(this),t[D.BACKSPACE]=B.bind(this),t[D.ESC]=y.bind(this),t[D.SUPER+"+"+D.C]=p,t[D.SUPER+"+"+D.V]=B.bind(this),t[D.SUPER+"+"+D.F]=M.bind(this),t[D.SUPER+"+"+D.S]=m.bind(this),t[D.SUPER+"+"+D.Z]=g.bind(this),t[D.SUPER+"+"+D.SHIFT+"+"+D.Z]=v.bind(this)}function m(e){e.preventDefault(),this.menuBar.saveButton.disabled||this.menuBar.saveMacro()}function g(){this.editor.undo()}function v(){this.editor.redo()}function M(e){e.preventDefault();var t=b.view.getActiveGridID(),i=b.view.getResourceID(t),o=(b.view.getSheetID(t),b.view.getVersionID(t)),n=b.data.getWorkBook(i,o);return n.isEditable()?(this.showSearchBar(!0),!1):void 0}function p(){return!1}function B(){return this.menuBar.changeMenuButtonState(!1,!1,this.menuBar.saveButton,A["Macro.Editor.Save"]),this.menuBar.changeMenuButtonState(!1,!1,this.menuBar.saveAndRunButton,A["Macro.Editor.SaveAndRun"]),!1}function y(){return this.showMessagePanel(!1),this.searchBar&&this.showSearchBar(!1),!1}function f(){for(var e=this.macroEditorWrapper.querySelectorAll(".macroModules"),t=0;t<e.length;t++)e[t].remove();this.searchBar&&this.showSearchBar(!1);var i=this.MacroModule.getActiveModule();i&&i.getDom().classList.remove("active"),this.showMessagePanel(!1),this.spreadsheetTree.checked=!0,this.macroTree.checked=!0,this.titleBar.clearCache(),this.editor.value="",this.cache={}}var E,S,b=e.sPlusPlus,w=e.ZSConstants.FeatureConstants,C=e.ZSConstants.wCC,A=e.ZSConstants.I18N,P=e.UserAction.Macro,R=e.UserAction,D=e.ZSConstants.JSKeyCode,N=e.ZSEvents,T=N.topic,k=N.Groups,I=N.Names,O=ZSClass.Editors,L=e.ZSConstants.FeatureConstants,W=b.view.Toolbar.Feature[L.CREATE_MACRO],x=b.view.Toolbar.Feature[L.MANAGE_MACRO];t.prototype={init:function(){this.initComponents(),this.initTitleBar(),this.initMenuBar(),this.initDialog(),this.initSearchBar(),this.initMessagePanel()},initComponents:function(){this.fragments=R.getTemplate(["MACRO_EDITOR_TITLE","MACRO_EDITOR","MACRO_GOTO","MACRO_PROCEDURE"]);var e=this.fragments.MACRO_EDITOR,t=this;this.spreadsheetObjects=e.querySelector("#spreadsheetObjects"),this.thisWorkbook=e.querySelector("#thisWorkbook"),this.customMacroObjects=e.querySelector("#customMacroObjects"),this.loader=e.querySelector("#macroEditorLoading"),this.spreadsheetTree=e.querySelector("#mcr-tree-1-1"),this.macroTree=e.querySelector("#mcr-tree-1-2"),this.macroBody=e.querySelector("#macroBody"),this.leftPanel=e.querySelector(".mcrLfn"),this.collapseDiv=e.querySelector(".mcrClpse"),this.thisWorkbook.addEventListener("click",function(){t.loadModule("ThisWorkbook")}),this.collapseDiv.addEventListener("click",function(){t.leftPanel.style.marginLeft="0px"==t.leftPanel.style.marginLeft||""==t.leftPanel.style.marginLeft?"-210px":"0px"}),this.eventList=e.querySelector("#eventList"),this.eventList.addEventListener("change",function(){t.addPredefinedFunction(this.value),this.selectedIndex=0})},initDialog:function(){var t=this,i={width:1e3,title:this.fragments.MACRO_EDITOR_TITLE,modal:!0,closeOnEsc:!1,close:function(){t.gotoDialog&&t.gotoDialog.close(),t.insertProcedureDialog&&t.insertProcedureDialog.close(),f.call(t),t.clearMessagePanelCache()},open:function(){!t.editor&&t.initEditor(),t.showLoader(!0),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveButton,A["Macro.Editor.Save"]),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveAndRunButton,A["Macro.Editor.SaveAndRun"]),o.call(t)}};this.macroEditorWrapper=document.createElement("div"),this.macroEditorWrapper.id=C.DI+w.MACRO_EDITOR+C.IDENTITY,this.macroEditorWrapper.appendChild(this.fragments.MACRO_EDITOR),this.dialog=new e.ZSClass.Dialog(this.macroEditorWrapper,i),this.dialog.Dom.classList.add("mcrEdtr"),h.call(this)},initTitleBar:function(){this.titleBar=new P.MacroVBAEditorTitle(this)},initSearchBar:function(){this.searchBar=this.macroEditorWrapper.querySelector("#searchBar"),this.searchPanel=new P.MacroVBAEditorSearchBar(this)},initMessagePanel:function(){var e=this;this.bottomBanner=this.macroEditorWrapper.querySelector("#bottomBanner"),this.errorMsgbox=this.macroEditorWrapper.querySelector("#errorMsgbox"),this.infoMsgbox=this.macroEditorWrapper.querySelector("#infoMsgbox"),this.warningMsgbox=this.macroEditorWrapper.querySelector("#warningMsgbox"),this.infoTab=this.macroEditorWrapper.querySelector("#infoTab"),this.errorTab=this.macroEditorWrapper.querySelector("#errorTab"),this.warningTab=this.macroEditorWrapper.querySelector("#warningTab"),this.infoPart=this.macroEditorWrapper.querySelector("#infoPart"),this.errorPart=this.macroEditorWrapper.querySelector("#errorPart"),this.warningPart=this.macroEditorWrapper.querySelector("#warningPart"),this.infoTab.addEventListener("click",function(){e.showMessagePanel(!0,"info")}),this.errorTab.addEventListener("click",function(){e.showMessagePanel(!0,"error")}),this.warningTab.addEventListener("click",function(){e.showMessagePanel(!0,"warning")})},initMenuBar:function(){this.menuBar=new P.MacroVBAEditorMenu(this)},open:function(e,t,o,n){n?(this.dialog.close(),this.open(e,t,o)):this.dialog.isMinimize()?(this.titleBar.maximize(),this.loadModule(e),this.find(t),this.goto(this.editor.getCursor().line+2)):(this.cache={modName:e,macName:t,lineNumber:o},this.dialog.open(),i.call(this))},close:function(){this.dialog.close()},minimize:function(){this.dialog.minimize()},maximize:function(){this.dialog.maximize()},isAlive:function(){return this.dialog.isAlive()},setValue:function(e){this.editor.value=e},isMinimize:function(){return this.dialog.isMinimize()},getValue:function(){return this.editor.value()},initEditor:function(){var e=this.macroEditorWrapper.querySelector("#macroEditorCodeArea"),t={mode:"vbscript",lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,autoFocus:!0,extraKeys:{"Ctrl-Space":"autocomplete"},electricChars:!1,smartIndent:!1,showCursorWhenSelecting:!0};this.editor=new O.MacroEditor(e,t)},openGotoDialog:function(){!this.gotoDialog&&(this.gotoDialog=new P.MacroVBAEditorGoto(this)),this.gotoDialog.open()},closeGotoDialog:function(){this.gotoDialog&&this.gotoDialog.close()},openInsertProcedureDialog:function(){!this.insertProcedureDialog&&(this.insertProcedureDialog=new P.MacroVBAEditorInsertProcedure(this)),this.insertProcedureDialog.open()},closeInsertProcedureDialog:function(){this.insertProcedureDialog&&this.insertProcedureDialog.close()},showSearchBar:function(e){e?(this.searchBar.style.display="",this.searchPanel.searchBox.focus()):this.searchBar.style.display="none"},showMessagePanel:function(e,t){if(e){switch(t){case"info":if(""==this.bottomBanner.style.display&&this.infoPart.checked)return void(this.bottomBanner.style.display="none");this.infoPart.checked=!0;break;case"error":if(""==this.bottomBanner.style.display&&this.errorPart.checked)return void(this.bottomBanner.style.display="none");this.errorPart.checked=!0;break;case"warning":if(""==this.bottomBanner.style.display&&this.warningPart.checked)return void(this.bottomBanner.style.display="none");this.warningPart.checked=!0}this.bottomBanner.style.display=""}else this.bottomBanner.style.display="none"},clearMessagePanelCache:function(){this.infoMsgbox.innerHTML="",this.errorMsgbox.innerHTML="",this.warningMsgbox.innerHTML=""},showLoader:function(e){e?(this.loader.style.display="",this.macroBody.style.display="none"):(this.loader.style.display="none",this.macroBody.style.display="")},loadModule:function(e){this.MacroModule.getActiveModule()&&this.MacroModule.save();var t=this.MacroModule.getMacroModule(e);this.MacroModule.setActiveModule(t),this.MacroModule.revoke()},saveMacro:function(e,t,i,o){this.clearMessagePanelCache(),this.showMessagePanel(!1);var n=this.MacroModule.getActiveModule().getName(),a=JSON.stringify([{mname:n,mcontent:encodeURIComponent(this.editor.value)}]);R.saveMacro(e,o,i,t,a,r,this)},runMacro:function(){this.clearMessagePanelCache(),this.showMessagePanel(!1);var e,t=this.MacroModule.getActiveModule().getName(),i=b.view.getActiveGridID(),o=b.view.getSheetID(i),n=b.view.getResourceID(i),r=b.view.getVersionID(i),s=b.data.getWorkBook(n,r),c=s.SheetList.getById(o),l=c.getName(),d=b.view.getSheetState(i,o),u=d.getActiveRange(),h=this.editor.getCursor().line+1,m=b.view.getSelectedSheets(i);this.menuBar.saveButton.disabled||(e=JSON.stringify([{mname:t,mcontent:encodeURIComponent(this.editor.value)}])),R.runMacroByLineNumber(n,o,r,t,e,h,m,l,u,a,this)},saveAndRunMacro:function(){this.clearMessagePanelCache(),this.showMessagePanel(!1);var e=this.MacroModule.getActiveModule().getName(),t=JSON.stringify([{mname:e,mcontent:encodeURIComponent(this.editor.value)}]),i=b.view.getActiveGridID(),o=b.view.getResourceID(i),n=b.view.getSheetID(i),r=b.view.getVersionID(i),a=b.data.getWorkBook(o,r),s=a.SheetList.getById(n),c=s.getName(),l=b.view.getSelectedSheets(i),d=b.view.getSheetState(i,n),h=d.getActiveRange(),m=this.editor.getCursor().line;R.saveAndRunMacro(o,n,r,e,t,l,h,m,c,u,this)},undo:function(){this.editor.undo()},redo:function(){this.editor.redo()},goto:function(e){var e=e.toString(),t=e.split(":");this.editor.goto(t[0]-1,t[1])},getLineCount:function(){return this.editor.getLineCount()},isFunctionExists:function(e){return this.editor.findFromOrigin(e+"(",!0,!0)},addPredefinedFunction:function(e){var t=this.MacroModule.getActiveModule().getEvents(),i=t[e];void 0!=i&&(this.isFunctionExists(i.fName)||this.insertProcedure(i.fName,i.type,i.scope,i.arguments,i.defaultContent))},insertProcedure:function(e,t,i,o,n){if(""!=e.trim()){var r=i+" "+t+" "+e+(o?"(ByVal "+o.argName+" As "+o.type+")":"()")+(n?n:"\n\n")+"End "+t,a=(void 0!=this.editor.value?this.editor.value+"\n":"")+r;this.editor.value=a}},find:function(e,t){this.editor.find(e,t)||this.editor.findFromOrigin(e,t)},replace:function(e,t,i){this.editor.replace(e,t,i)},replaceAll:function(){this.editor.replaceAll(this.searchBoxNameEditor.value,this.replaceBoxNameEditor.value,this.caseSensitive.checked)},enableReadOnlyMode:function(e){this.editor.setOption("readOnly",e)}},P.MacroEditorDialog=t}(this);
!function(t){function e(t){this.parent=t,this.fragment=t.fragments.MACRO_GOTO,this.init()}var o=t.UserAction.Macro,i=t.ZSConstants.I18N,n=ZSClass.Editors,s=t.ZSConstants.FeatureConstants,r=t.ZSConstants.wCC;e.prototype={init:function(){var e=this;this.lineNumber=this.fragment.querySelector("#goto"),this.lineNumEditor=new n.TextAreaEditor(this.lineNumber),this.gotoBtn=this.fragment.querySelector("#gotoBtn"),this.cancelBtn=this.fragment.querySelector("#cancel"),this.gotoBtn.addEventListener("click",function(){e.goto(e.lineNumEditor.value)}),this.lineNumber.addEventListener("keypress",function(t){13==t.keyCode&&e.goto(e.lineNumEditor.value)}),this.cancelBtn.addEventListener("click",function(){e.close()});var o={width:300,title:i["Macro.Editor.Goto"],model:!0,closePreviousDialog:!1,open:function(){e.lineNumber.value="",e.lineNumber.focus()},close:function(){e.parent.dialog.focus()}};this.gotoWrapper=document.createElement("div"),this.gotoWrapper.id=r.DI+s.MACRO_GOTO+r.IDENTITY,this.gotoWrapper.appendChild(this.fragment),this.dialog=new t.ZSClass.Dialog(this.gotoWrapper,o)},open:function(){this.dialog&&this.dialog.open()},close:function(){this.dialog.close()},goto:function(t){isNaN(t)?ZSClass.ZSAlert(i["Macros.PleaseEnterAnInteger"]):(this.parent.goto(t),this.close())}},o.MacroVBAEditorGoto=e}(this);
!function(e){function r(e){this.parent=e,this.fragment=e.fragments.MACRO_PROCEDURE,this.init()}var t=e.UserAction.Macro,i=e.ZSConstants.I18N,n=e.ZSClass.Editors,o=(e.ZSConstants.FeatureConstants,e.ZSConstants.wCC);r.prototype={init:function(){var r=this;this.name=this.fragment.querySelector("#procedureName"),this.nameEditor=new n.TextAreaEditor(this.name),this.create=this.fragment.querySelector("#createProcedure"),this.cancel=this.fragment.querySelector("#cancel"),this.create.addEventListener("click",function(){{var e=r.insertProcedureWrapper.querySelectorAll("[name=moduleType]:checked")[0],t=r.insertProcedureWrapper.querySelectorAll("[name=scope]:checked")[0];r.nameEditor.value.trim()}r.insertProcedure(r.nameEditor.value,e.value,t.value)}),this.name.addEventListener("keypress",function(e){if(13==e.keyCode){{var t=r.insertProcedureWrapper.querySelectorAll("[name=moduleType]:checked")[0],i=r.insertProcedureWrapper.querySelectorAll("[name=scope]:checked")[0];r.nameEditor.value.trim()}r.insertProcedure(r.nameEditor.value,t.value,i.value)}}),this.cancel.addEventListener("click",function(){r.close()});var t={width:400,title:i["Macro.Editor.InsertProcedure"],model:!0,closePreviousDialog:!1,open:function(){r.name.value="",r.name.focus(),r.insertProcedureWrapper.querySelectorAll("[name=moduleType]")[0].checked=!0,r.insertProcedureWrapper.querySelectorAll("[name=scope]")[0].checked=!0},close:function(){r.parent.dialog.focus()}};this.insertProcedureWrapper=document.createElement("div"),this.insertProcedureWrapper.id=o.DI+"11111"+o.IDENTITY,this.insertProcedureWrapper.appendChild(this.fragment),this.dialog=new e.ZSClass.Dialog(this.insertProcedureWrapper,t)},isFunctionExists:function(e){return this.parent.isFunctionExists(e)?(ZSClass.ZSAlert(i["Error.Macro.Name"],{title:i["Alert.Title.MacroNameExists"]}),!0):!1},open:function(){this.dialog.open()},close:function(){this.dialog.close()},insertProcedure:function(e,r,t,i,n){UserAction.isValidMacroName(e)&&!this.isFunctionExists(e)&&(this.close(),this.parent.insertProcedure(e,r,t,i,n),this.parent.goto(this.parent.getLineCount()-1))}},t.MacroVBAEditorInsertProcedure=r}(this);
!function(t){function n(t){this.dialog=t,this.fragment=t.fragments.MACRO_EDITOR,this.init()}{var e=t.UserAction.Macro,i=t.sPlusPlus,o=(t.ZSConstants.FeatureConstants,t.ZSConstants.wCC,t.ZSConstants.I18N),r=(t.UserAction.Macro,t.UserAction,t.ZSEvents);r.topic,r.Groups,r.Names,ZSClass.Editors}n.prototype={init:function(){this.undoButton=this.fragment.querySelector("#mcrundo"),this.redoButton=this.fragment.querySelector("#mcrredo"),this.findButton=this.fragment.querySelector("#mcrfind"),this.gotoButton=this.fragment.querySelector("#mcrgoto"),this.insertProcedureButton=this.fragment.querySelector("#mcrinsertProcedure"),this.saveButton=this.fragment.querySelector("#mcrsave"),this.runButton=this.fragment.querySelector("#mcrrun"),this.saveAndRunButton=this.fragment.querySelector("#mcrsaveAndRun"),this.errorButton=this.fragment.querySelector("#mcrerror"),this.infoButton=this.fragment.querySelector("#mcrinfo"),this.warningButton=this.fragment.querySelector("#mcrwarning"),this.bindEvents()},bindEvents:function(){var t=this;this.undoButton.addEventListener("click",function(){t.dialog.undo()}),this.redoButton.addEventListener("click",function(){t.dialog.redo()}),this.findButton.addEventListener("click",function(){t.dialog.showSearchBar(!0)}),this.gotoButton.addEventListener("click",function(){t.dialog.openGotoDialog()}),this.insertProcedureButton.addEventListener("click",function(){t.dialog.openInsertProcedureDialog()}),this.saveButton.addEventListener("click",function(){t.saveMacro()}),this.runButton.addEventListener("click",function(){t.runMacro()}),this.saveAndRunButton.addEventListener("click",function(){t.saveAndRunMacro()}),this.errorButton.addEventListener("click",function(){t.dialog.showMessagePanel(!0,"error")}),this.infoButton.addEventListener("click",function(){t.dialog.showMessagePanel(!0,"info")}),this.warningButton.addEventListener("click",function(){t.dialog.showMessagePanel(!0,"warning")})},saveMacro:function(){var t=i.view.getActiveGridID(),n=i.view.getResourceID(t),e=i.view.getSheetID(t),r=i.view.getVersionID(t),s=i.data.getWorkBook(n,r),a=(s.SheetList.getById(e),i.view.getSelectedSheets(t));s.isEditable()&&(this.changeMenuButtonState(!0,!0,this.saveButton,o["Macro.Editor.Saving"]),this.dialog.saveMacro(n,e,a,r,s))},runMacro:function(){this.changeMenuButtonState(!0,!0,this.runButton,o["Macro.Editor.Running"]),this.dialog.runMacro()},saveAndRunMacro:function(){this.changeMenuButtonState(!0,!0,this.saveAndRunButton,o["Macro.Editor.Processing"]),this.dialog.saveAndRunMacro()},changeMenuButtonState:function(t,n,e,i){t?e.classList.add("ZsLoadingIcon"):e.classList.remove("ZsLoadingIcon"),e.disabled=n,e.querySelector("span").textContent=i}},e.MacroVBAEditorMenu=n}(this);
!function(t){function r(t){this.fragment=t,this.init()}var i=t.UserAction.Macro;r.prototype={init:function(){this.errorTab=this.fragment.querySelector("#errorTab"),this.warningTab=this.fragment.querySelector("#warningTab"),this.infoTab=this.fragment.querySelector("#infoTab"),this.errorPart=this.fragment.querySelector("#errorPart"),this.infoPart=this.fragment.querySelector("#infoPart"),this.warningPart=this.fragment.querySelector("#warningPart")},bindEvents:function(){this.errorTab.addEventListener("click",function(){this.errorPart.checked=!0}),this.warningTab.addEventListener("click",function(){this.warningPart.checked=!0}),this.infoTab.addEventListener("click",function(){this.infoPart.checked=!0})}},i.MacroVBAEditorMessagePanel=r}(this);
!function(e){function t(e){this.parent=e,this.init()}var r=e.UserAction.Macro,a=e.ZSClass.Editors;t.prototype={init:function(){this.searchBox=this.parent.searchBar.querySelector("#search"),this.searchBoxNameEditor=new a.TextAreaEditor(this.searchBox),this.searchBtn=this.parent.searchBar.querySelector("#searchBtn"),this.replaceBox=this.parent.searchBar.querySelector("#replace"),this.replaceBoxNameEditor=new a.TextAreaEditor(this.replaceBox),this.replaceBtn=this.parent.searchBar.querySelector("#replaceBtn"),this.replaceAllbtn=this.parent.searchBar.querySelector("#replaceAllBtn"),this.caseSensitive=this.parent.searchBar.querySelector("#caseSensitive"),this.searchClose=this.parent.searchBar.querySelector(".mcrFindClose"),this.bindEvents()},bindEvents:function(){var e=this;this.searchBtn.addEventListener("click",function(){e.find(e.searchBoxNameEditor.value,e.caseSensitive.checked)}),this.searchBox.addEventListener("keydown",function(t){13==t.keyCode&&e.find(e.searchBoxNameEditor.value,e.caseSensitive.checked)}),this.replaceBtn.addEventListener("click",function(){e.replace(e.searchBoxNameEditor.value,e.replaceBoxNameEditor.value,e.caseSensitive.checked)}),this.replaceBox.addEventListener("keydown",function(t){13==t.keyCode&&(t.preventDefault(),e.replace(e.searchBoxNameEditor.value,e.replaceBoxNameEditor.value,e.caseSensitive.checked))}),this.replaceAllbtn.addEventListener("click",function(){e.replaceAll(e.searchBoxNameEditor.value,e.replaceBoxNameEditor.value,e.caseSensitive.checked)}),this.searchClose.addEventListener("click",function(){e.close()})},find:function(e,t){this.parent.find(e,t)},replace:function(e,t,r){this.parent.replace(e,t,r)},replaceAll:function(){this.parent.replaceAll(this.searchBoxNameEditor.value,this.replaceBoxNameEditor.value,this.caseSensitive.checked)},close:function(){this.parent.showSearchBar(!1)}},r.MacroVBAEditorSearchBar=t}(this);
!function(t){function i(t){this.minimizeButton.style.display=t?"none":"",this.maximizeButton.style.display=t?"":"none",this.helpButton.style.display=t?"none":""}function e(t){this.dialog=t,this.fragment=t.fragments.MACRO_EDITOR_TITLE,this.init()}var n=t.sPlusPlus,a=t.UserAction.Macro,o=(t.ZSConstants.FeatureConstants,t.ZSConstants.wCC),l=t.ZSConstants.I18N,s=n.data.AppRegistry.MACRO,r=t.UIUtil.Component;e.prototype={init:function(){var t=this;this.closeButton=this.fragment.querySelector("#closeDialog"),this.minimizeButton=this.fragment.querySelector("#minimizeDialog"),this.maximizeButton=this.fragment.querySelector("#maximizeDialog"),this.helpButton=this.fragment.querySelector("#macroHelp"),this.closeButton.addEventListener("click",function(){t.dialog.close()}),this.minimizeButton.addEventListener("click",function(){t.minimize()}),this.maximizeButton.addEventListener("click",function(){t.maximize()}),this.clearCache(),this.initHelpMenu()},initHelpMenu:function(){this.helpButton.setAttribute("data-menu-id",o.SUBMENUITEM+"MACRO_HELP"+o.IDENTITY);var t={id:o.SUBMENUITEM+"MACRO_HELP"+o.IDENTITY,ctype:"zmenu",relativeto:"parent",data:'{"componentOptions":{"type":"text_only"}}'},i=[{data:'{"label": "'+l.VBAProgramming+'","url":"'+s.VBA_PROGRAMMING+'"}'},{data:'{"label": "'+l.VBAObjectExplorer+'","url":"'+s.VBA_OBJECT_EXPLORER+'"}'},{data:'{"label": "'+l.WhatIsMacro+'","url":"'+s.VBA_PROGRAMMING+'"}'},{data:'{"label": "'+l.SampleMacros+'","url":"'+s.SAMPLE_MACROS+'"}'},{data:'{"label": "'+l.UserContributedMacros+'", "url":"'+s.USER_CONTRIBUTED_MACROS+'"}'}];n.view.Menu.create(i,t).then(function(){r.bind("#"+o.SUBMENUITEM+"MACRO_HELP"+o.IDENTITY,"zmenuitemclick",function(t,i){var e=i.data;window.open(e.url)})})},minimize:function(){i.call(this,!0),this.dialog.minimize()},maximize:function(){i.call(this,!1),this.dialog.maximize()},clearCache:function(){i.call(this,!1)}},a.MacroVBAEditorTitle=e}(this);
!function(e){function t(){this.init()}var s=(e.sPlusPlus,e.ZSConstants.FeatureConstants),i=e.ZSConstants.wCC,n=e.UserAction.Macro,o=e.UserAction,a=e.ZSConstants.I18N;t.prototype={init:function(){var t=this,n=o.getTemplate(["MSGBOX","MSGLIST"]),r=n.MSGBOX;this.container=r.querySelector("#messageBoxContainer"),this.header=r.querySelector("#msgHead"),this.list=r.querySelector("#msgList"),this.cancel=r.querySelector("#close");var c=n.MSGLIST;this.msg=c.querySelector("#msg"),this.content=c.querySelector("#content"),this.link=c.querySelector("#link"),this.cancel.addEventListener("click",function(){t.dialog.close()});var l={width:500,model:!0,title:a["Macro.MessageBox.MessageBox"],close:this.clearCache.bind(this)};this.messageBoxWrapper=document.createElement("div"),this.messageBoxWrapper.id=i.DI+s.MACRO_EDITOR+i.IDENTITY,this.messageBoxWrapper.appendChild(this.container),this.dialog=new e.ZSClass.Dialog(this.messageBoxWrapper,l)},open:function(){this.dialog.open()},clearCache:function(){this.list.innerHTML=""},close:function(){this.dialog.close()}},n.MessageBox=t}(this);
!function(e){function r(e){this.parent=e,this.init()}var t=(e.sPlusPlus,e.ZSConstants.FeatureConstants),i=e.ZSConstants.wCC,o=e.UserAction.Macro,s=e.UserAction,n=e.ZSConstants.I18N,a=e.ZSEvents,c=a.topic,l=a.Groups,h=a.Names;r.prototype={init:function(){var r=this,o=s.getTemplate(["ERRORBOX"]),a=o.ERRORBOX;this.container=a.querySelector("#errorBoxContainer"),this.header=a.querySelector("#errorHead"),this.list=a.querySelector("#errorList"),this.debug=a.querySelector("#debug"),this.close=a.querySelector("#close"),this.close.addEventListener("click",function(){r.dialog.close()}),this.debug.addEventListener("click",function(){var e=r.errorLine;r.dialog.close(),c.publish(l.UserAction,h.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:r.moduleName,macName:"",lineNumber:e})});var u={width:500,model:!0,title:n["Macro.MessageBox.ErrorBox"],close:this.clearCache.bind(this)};this.errorBoxWrapper=document.createElement("div"),this.errorBoxWrapper.id=i.DI+t.MACRO_EDITOR+i.IDENTITY,this.errorBoxWrapper.appendChild(this.container),this.dialog=new e.ZSClass.Dialog(this.errorBoxWrapper,u)},open:function(){this.dialog.open()},setErrorDetails:function(e,r){this.errorLine=e,this.moduleName=r},clearCache:function(){this.list.innerHTML="",this.errorLine=""},close:function(){this.dialog.close()}},o.ErrorBox=r}(this);
!function(e){function t(e,t,n,o){s||(s=new S.MacroEditorDialog),s.open(e,t,n,o)}function n(e){s&&s.clearMessagePanelCache();for(var t in e){var n=e[t],o=n[O.TYPE],r=n[O.META],i=s&&s.isAlive();switch(o){case M.MACRO_INFO:E||(E=new S.MessageBox);var a=r.length;for(var l in r){var d=r[l],N=E.msg.cloneNode(),A=E.content.cloneNode(),u=E.link.cloneNode(),v=E.list.cloneNode();u.addEventListener("click",function(){E.close(),i?s.goto.bind(s,d[p.LINENUMBER]):(s=new S.MacroEditorDialog,s.open("Macros","",d[p.LINENUMBER]))}),A.textContent=d[p.MESSAGE],u.textContent=d[p.MODULENAME]+"("+d[p.LINENUMBER]+")",N.appendChild(A),N.appendChild(u),v.appendChild(N),i?(s.infoMsgbox.appendChild(v),N.addEventListener("click",s.goto.bind(s,d[p.LINENUMBER]))):(E.header.innerText=a+C["Macro.Editor.Messages"],E.list.appendChild(v))}i?s.showMessagePanel(!0,"info"):E.open();break;case M.MACRO_ERROR:if(c||(c=new S.ErrorBox),i){var I="Encountered error at line "+r[p.LINENUMBER]+" : "+r[p.MESSAGE];s.errorMsgbox.appendChild(document.createTextNode(I)),s.showMessagePanel(!0,"error")}else c.header.innerText="Encountered error at line "+r[p.LINENUMBER],c.list.innerText=r[p.MESSAGE],c.setErrorDetails(r[p.LINENUMBER],r[p.MODULENAME]),c.open();break;case M.MACRO_WARNING:}}}function o(e){var n=(d.ContextConstant,document.createElement("li"));n.setAttribute("data",'{"label":"View Code", "relatedButton": "#'+N.MI+"VIEWCODE"+N.MENU+'" }'),n.id=N.MI+"TABCOLOR"+N.MENU,n.addEventListener("click",function(){var e=l.view.getActiveGridID(),n=l.view.getResourceID(e),o=l.view.getSheetID(e),r=l.view.getVersionID(e),i=l.data.getWorkBook(n,r),a=i.SheetList.getById(o),s=a.getName();t(s)}),e[ZSConstants.ContextConstant.SHEET_VIEWCODE]=n}function r(e,t){var n=l.view.getActiveGridID(),o=l.view.getResourceID(n),r=l.view.getSheetID(n),a=l.view.getVersionID(n);A.pullMacroContent(o,r,a,e,t,i)}function i(e){for(var t=e.mc,n=0;n<t.length;n++){var o=t[n].c,r=t[n].n;s.loadModule(r),s.setValue(o)}}function a(e,t){if(s)if(s.isMinimize())r(e,t);else if(s.isAlive()){var n=[{text:C.Yes,primary:!0,click:function(){r(e,t)}},{text:C.No}],o={buttons:n,title:C["Alert.Title.MacroUpdated"]};ZSClass.ZSAlert(u.fn.replaceParams(C["Macros.UserhasModifiedTheModule"],[t,e]),o)}}var s,E,c,l=e.sPlusPlus,d=e.ZSConstants.FeatureConstants,M=e.ZSConstants.CommandConstants,C=e.ZSConstants.I18N,N=(e.UIUtil.Component,e.ZSConstants.JSKeyCode,e.ZSConstants.wCC),A=e.UserAction,u=(e.document,e.JSUtil),v=e.ZSEvents,I=v.topic,g=v.Groups,U=v.Names,S=(ZSClass.Editors,e.UserAction.Macro),R=l.view.Toolbar.Feature[d.VBA_EDITOR],O={TYPE:0,META:1},p={MODULENAME:0,MESSAGE:1,LINENUMBER:2};R.openDialog=t,I.register(g.UserAction,U.UserAction.MACRO.MACRO_CONTENT_CHANGED,a,"moduleNames","actionOwner"),I.register(g.UserAction,U.UserAction.MACRO.OPEN_MACRO_EDITOR,t,"modName","macName","lineNumber","refetchFromServer"),I.register(g.UserAction,U.UserAction.MACRO.UPDATE_MACROACTION_RESULTS,n,"meta"),I.register(g.UI,U.Menu.INIT_SHEET_CONTEXT,o,"MENU_BAG")}(this);
!function(e){function t(e){var t;if(!Ct){n(),initializeDelugeEditor(V,Gt);var r=document.getElementById("dreTopBar");r.style.display="none"}var i=lt.view.getActiveGridID(),o=lt.view.getResourceID(i),c=d(o);c&&(E(c),e&&(t=qt&&qt[e],ct=t)),u(!1),Ct.isMinimize()?Ct.maximize():Ct.open()}function n(){var t=gt.getTemplate(["DELUGE_EDITOR_TITLE","DELUGE_EDITOR","DELUGE_RUN","DELUGE_INSERT","DELUGE_ERROR"]),n=t.DELUGE_EDITOR;H=t.DELUGE_EDITOR_TITLE,V=n.querySelector("#delugeEditorArea");var i=n.querySelector("#undo"),c=n.querySelector("#redo"),a=n.querySelector("#find"),l=n.querySelector("#goto"),d=n.querySelector("#insertProcedure");Y=n.querySelector("#save"),nt=n.querySelector("#run");var v=H.querySelector("#minimizeDialog"),E=H.querySelector("#maximizeDialog"),g=H.querySelector("#closeDialog"),f=H.querySelector("#macroHelp"),D=n.querySelector(".mcrClpse"),p=n.querySelector(".mcrLfn");et=n.querySelector(".delugeEditor"),g.title=dt.Close,Y.addEventListener("click",function(){q(!0,!0,Y,"Saving"),Z.editor.saveScript()}),nt.addEventListener("click",function(){Z.isEditorContentModified()?x(!0):o(null,!0)}),i.addEventListener("click",function(){Z.editor.undo()}),c.addEventListener("click",function(){Z.editor.redo()}),a.addEventListener("click",function(){Z.editor.execCommand("replace")}),l.addEventListener("click",function(){Z.editor.execCommand("goToLine")}),d.addEventListener("click",function(){r(!1)}),v.addEventListener("click",function(){u(!0),Ct.minimize()}),E.addEventListener("click",function(){u(!1),Ct.maximize()}),g.addEventListener("click",function(){Z.isEditorContentModified()?x(!1,!0):Ct.close()}),f.addEventListener("click",function(){s(f)}),D.addEventListener("click",function(){"0px"==p.style.marginLeft||""==p.style.marginLeft?(p.style.marginLeft="-210px",V.style.width="990px",Z.resize()):(p.style.marginLeft="0px",V.style.width="808px",Z.resize())});var m={width:1e3,modal:!0,title:H,closeOnEsc:!1,open:function(){Dt.register(pt.Listener,mt.DocAction.DELUGE_FUNCTIONS.INSERT,G,"RID","VERSION","DELUGE"),Dt.register(pt.Listener,mt.DocAction.DELUGE_FUNCTIONS.REMOVE,_,"RID","VERSION","DELUGE"),ct?ct.click():Z.setEditorContent(""),ct=""},close:function(){Z.V1Response.hide(),Dt.unregister(pt.Listener,mt.DocAction.DELUGE_FUNCTIONS.REMOVE,_),Dt.unregister(pt.Listener,mt.DocAction.DELUGE_FUNCTIONS.INSERT,G),Z.setEditorContent(""),it&&it.open(),it=""}};O=document.createElement("div"),O.id=Et.DI+ut.DELUGE_EDITOR+Et.IDENTITY,O.appendChild(t.DELUGE_EDITOR),Ct=new e.ZSClass.Dialog(O,m),Ct.Dom.classList.add("mcrEdtr")}function r(t){var n=gt.getTemplate(["DELUGE_INSERT"]),r=n.DELUGE_INSERT;if(!b){K=r.querySelector("#procedureName"),j=r.querySelector("#macroDescription"),X=r.querySelector("#createProcedure"),J=r.querySelector("#createProcedure").childNodes[1],Q=r.querySelector("#returntype");var o=r.querySelector("#addArgument");$=r.querySelector("#argumentsDiv");var c=r.querySelector("#cancel"),a={width:500,modal:!0,title:dt["Deluge.Create.Title"],open:function(){K.focus()},close:function(){$.innerHTML="",j.value="",K.value="",A(!1,!1,X,J,"Save")}};K.addEventListener("keydown",function(e){13==e.keyCode&&X.click()}),X.addEventListener("click",function(){var e=K.value;e=e.toUpperCase();var n=lt.view.getActiveGridID(),r=lt.view.getResourceID(n),o=d(r),c=o&&o.get(e);if(c)i();else if(gt.isValidMacroName(e,!0)){var a=j.value;a||(a=dt["Deluge.DefaultDescription"]);var s=Q.value,l=[];if(wt>0)for(var u=0;wt>u;u++){var v=Rt[u];if(v){var E=v.querySelector(".params").value,g=v.querySelector(".paramName").value,f=[g,E];l[u]=f}}Rt=[],wt=0,w(e,a,s,l,t)}}),c.addEventListener("click",function(){b.close()}),o.addEventListener("click",function(){h($)}),N(Q,!1),z=document.createElement("div"),z.id=Et.DI+ut.DELUGE_EDITOR+"_1"+Et.IDENTITY,z.appendChild(r),b=new e.ZSClass.Dialog(z,a)}b.open()}function i(){at=z.parentNode.querySelector(".shNtfyWrpr"),at&&z.parentNode.removeChild(at);var t=e.UserAction.getTemplate([kt]);at=t[kt],at.querySelector(".shNtfyCtn").innerText="function name alreade exists",st&&clearTimeout(st),st=setTimeout(M,2e3),z.parentNode.appendChild(at)}function o(e,t){var n=gt.getTemplate(["DELUGE_RUN"]),r=n.DELUGE_RUN;if(null==e){var i=getEditorValue();e=i.substring(i.indexOf(" "),i.indexOf("(")).trim()}var o=y(e);if(o&&o.length>0)a(r,e,t),P.open();else{var c=I(e),s=lt.view.getActiveGridID(),l=lt.view.getResourceID(s),u=lt.view.getVersionID(s);gt.delugeExecuteAction(l,u,yt.DRE_EXECUTE,c,null,m)}}function c(e,t,n,r){for(var i=[],o=0;o<e.length;o++){var c=e[o],a=c.name,s=n.querySelector("#"+a),l=n.querySelector("#"+a+"_zsRangePicker"),u=new St.RangeEditor(s);ZSClass.RangePicker.register(u,!0);var r=l.querySelector("#DelugerangePickerIcon");i[o]=u,ZSClass.RangePicker.Dialog.register(u,t,r,dt["Deluge.Execute.Title"])}return i}function a(n,r,i){i&&(Z.isEditorContentModified()?x(!0):Ct.close());for(var o=(n.querySelector("#run"),y(r)),a=n.querySelector("#param"),s=[],l=!1,u=0;u<o.length;u++){var d=o[u],v=d.name,E=gt.getTemplate(["DELUGE_PARAMS"]),g=E.DELUGE_PARAMS,f=g.querySelector(".zsRangePicker"),D=g.querySelector("#paramName");D.innerText=v;var m=g.querySelector("#paramValue");m.setAttribute("id",v),a.appendChild(g),f.setAttribute("id",v+"_zsRangePicker"),l=!0}var S=n.querySelector("#executeBtn"),L=n.querySelector("#executeBtn").childNodes[1],I=n.querySelector("#cancel");S.addEventListener("click",function(){A(!0,!0,S,L,"Running");for(var e=y(r),t={},n=0;n<e.length;n++){{var i=e[n],o=i.name;F.querySelector("#"+o),F.querySelector("#_"+o)}t[o]=s[n].value}p(t,r)}),I.addEventListener("click",function(){P.close()});var C={width:350,title:dt["Deluge.Execute.Title"],open:function(){var e=o[0],t=e.name;F.querySelector("#"+t).focus()},close:function(){i&&t(),F=""}};F=document.createElement("div"),F.classList.add("executeMacroDlg"),F.id=Et.DI+ut.MACRO_GOTO+Et.IDENTITY,F.appendChild(n),P=new e.ZSClass.Dialog(F,C),l&&(s=c(o,P,F))}function s(e){e.setAttribute("data-menu-id",Et.SUBMENUITEM+"DELUGE_HELP"+Et.IDENTITY);var t={id:Et.SUBMENUITEM+"DELUGE_HELP"+Et.IDENTITY,ctype:"zmenu",relativeto:"parent",data:'{"componentOptions":{"type":"text_only"}}'},n=[{data:'{"label":"'+dt["Deluge.SheetHelp"]+'","url":"https://www.zoho.com/deluge/help/"}'},{data:'{"label":"'+dt["Deluge.Learn"]+'","url":"https://creator.zoho.com/learndeluge/"}'}];lt.view.Menu.create(n,t).then(function(){vt.bind("#"+Et.SUBMENUITEM+"DELUGE_HELP"+Et.IDENTITY,"zmenuitemclick",function(e,t){var n=t.data;window.open(n.url)})})}function l(e){var t=gt.getTemplate(["DELUGE_TREE"]),n=t.DELUGE_TREE,r=n.querySelector(".customMacro"),i=n.querySelector(".sheetMacros");return i.innerText=e,r.addEventListener("click",function(){ht||!Z.isEditorContentModified()?(ht=!1,et.classList.add("loader"),""!=Tt&&Tt.classList.remove("active"),r.classList.add("active"),Tt=r,R(e,!1)):x(!1,!1,r)}),W=O.querySelector("#macroTree"),W.appendChild(n),r}function u(e){var t=Ct.getDialog(),n=t.querySelector("#minimizeDialog"),r=t.querySelector("#maximizeDialog"),i=t.querySelector("#macroHelp");n.style.display=e?"none":"",r.style.display=e?"":"none",i.style.display=e?"none":""}function d(e){return lt.data.DocRegistry[e].delugeFunctions}function v(e){var t=e.delugeResponse,n=t.function,r=n.workflow.name,i=n.script;"success"==t.status&&(et.classList.remove("loader"),delugeEditor.setEditorContent(i),f(r,i))}function E(e){var t,n=0;W&&(W.innerHTML="",qt={});for(var r in e.getMap())if(0==n)rt=l(r);else{var i=e.get(r);i&&(t=i.getId()),qt[t]=l(r),n++}}function g(){var e=new Array,t=lt.view.getActiveGridID(),n=lt.view.getResourceID(t),r=d(n);if(r)for(var i in r.getMap()){var o=["Deluge",i];e.push(o)}return e}function f(e,t){var n=lt.view.getActiveGridID(),r=lt.view.getResourceID(n),i=d(r),o=i&&i.get(e);o.setScript(t);var c=lt.data.DocRegistry;c[r].delugeFunctions.set(e,o)}function D(e){var t=lt.view.getActiveGridID(),n=lt.view.getResourceID(t),r=lt.view.getVersionID(t);gt.delugeGetDetailsAction(n,r,e,v)}function p(e,t){if(null==t){var n=getEditorValue();t=n.substring(n.indexOf(" "),n.indexOf("(")).trim()}var r=I(t),i=lt.view.getActiveGridID(),o=lt.view.getResourceID(i),c=lt.view.getVersionID(i),a=JSON.stringify(e);if(null==r||""==r||"undefined"==typeof r){var s=yt.DRE_CREATEANDEXECUTE;gt.delugeCreateAndExecuteAction(o,c,s,n,a,m)}else{var s=yt.DRE_EXECUTE;gt.delugeExecuteAction(o,c,s,r,a,m)}}function m(e,n){var r=n.delugeResponse;F&&P.close(),q(!1,!1,nt,dt["Macro.Editor.Run"]),t(e),Z.V1Response.show(r)}function S(){var e=getEditorValue(),t=e.substring(e.indexOf(" "),e.indexOf("(")).trim(),n=t.toUpperCase();e=e.replace(t,n);var r=I(n),i=lt.view.getActiveGridID(),o=lt.view.getResourceID(i),c=lt.view.getVersionID(i);if(null==r||""==r||"undefined"==typeof r){var a=yt.DRE_CREATE;e=encodeURIComponent(e);var s=dt["Deluge.DefaultDescription"];gt.delugeCreateAction(o,c,a,e,s,L)}else{var a=yt.DRE_UPDATE;e=encodeURIComponent(e),gt.delugeUpdateAction(o,c,a,r,e,L)}}function L(e){var t=e.delugeResponse;if(q(!1,!1,Y,dt["Macro.Editor.Save"]),Z.V1Response.show(t),t&&"success"==t.status){var n=lt.view.getActiveGridID(),r=lt.view.getResourceID(n),i=(lt.view.getVersionID(n),d(r)),c=t.function.workflow.name,a=i&&i.get(c);a&&(a.setScript(t.function.script),a.setArguments(t.function.workflow.params)),Ut?(Ut=!1,o(t.function.workflow.name,!0)):Nt?(Nt=!1,Ct.close()):(ot&&ot.click(),ot="")}}function I(e){var t=lt.view.getActiveGridID(),n=lt.view.getResourceID(t),r=(lt.view.getVersionID(t),d(n)),i=r&&r.get(e);return i?i.getId():null}function y(e){var t=lt.view.getActiveGridID(),n=lt.view.getResourceID(t),r=(lt.view.getVersionID(t),d(n)),i=r&&r.get(e);return i?i.getArguments():null}function C(){window.open("https://www.zoho.com/deluge/help/")}function R(e,n,r){it=r;var i=lt.view.getActiveGridID(),o=lt.view.getResourceID(i),c=d(o),a=c&&c.get(e);if(a){var s=a.getScript();s?(et.classList.remove("loader"),delugeEditor.setEditorContent(s)):D(e)}n&&t()}function w(e,t,n,r,i){var o="",c="";if(null!=r)for(var a=r.length,s=0;a>s;s++){var l=r[s];o+=l[1]+" "+l[0],s!=a-1&&(o+=",")}switch(n){case"int":c="return 0;";break;case"boolean":n="bool",c="return false;";break;case"date":c="return zoho.currentdate;";break;case"datetime":c="return zoho.currentdate;";break;case"decimal":c="return 0;";break;case"collection":c="return Collection()";break;case"map":c="return Map(); ";break;case"list":c="return List();";break;case"string":c="return null;"}var u=n+" "+e.toUpperCase()+"("+o+"){\n"+c+"\n } ",d=lt.view.getActiveGridID(),v=lt.view.getResourceID(d),E=lt.view.getVersionID(d),g=yt.DRE_CREATE;tt=u,i?(b.close(),gt.delugeCreateAction(v,E,g,u,t,T)):(A(!0,!0,X,J,"Creating"),gt.delugeCreateAction(v,E,g,u,t,k))}function T(e){if(null!=e){var t=e.delugeResponse;"success"==t.status&&B(t.function.workflow.name)}}function U(e){r(!0),B=e}function A(e,t,n,r,i){e?n.classList.add("ZsLoadingIcon"):n.classList.remove("ZsLoadingIcon"),r.nodeValue=i}function q(e,t,n,r){e?n.classList.add("ZsLoadingIcon"):n.classList.remove("ZsLoadingIcon"),n.disabled=t,n.querySelector("span").textContent=r}function k(e){var n=e.delugeResponse;if(A(!1,!1,X,J,"Save"),b.close(),t(),n)if(Z.V1Response.show(n),"success"==n.status){Z.setEditorContent(n.function.script);var r=n.function.id;qt[r]||(qt[r]=l(n.function.workflow.name))}else"failure"==n.status&&Z.setEditorContent(tt)}function N(e,t){var n,r=["string","int","date","boolean","map","list"],i=["string","int","date","boolean","map","list"];n=t?i:r;for(var o=0;o<n.length;o++){var c=document.createElement("option");c.setAttribute("value",n[o]),c.text=n[o],e.appendChild(c)}}function h(e){var t=gt.getTemplate(["DELUGE_SELECT"]),n=t.DELUGE_SELECT;e.classList.add("addList");var r=n.querySelector(".params"),i=n.querySelector(".paramName"),o=n.querySelector(".selectDiv"),c=n.querySelector(".delugeClose");c.addEventListener("click",function(){o.parentNode.removeChild(o);var t=Rt.indexOf(o);Rt.splice(t,1),0==Rt.length&&e.classList.remove("addList")}),o.setAttribute("id","selectDiv"+wt),vt.zcombo(r),N(r,!0),e.appendChild(n),i.focus(),Rt[wt++]=o}function G(e,t,n){{var r=n[0],i=n[1];n[2],n[3],n[4],n[5]}if(!qt[i]){var o=l(r);qt[i]=o,o.click()}}function _(e){var t=d(e);E(t),Z.setEditorContent("")}function x(e,t,n){var r=[{text:dt.Yes,primary:!0,click:function(){Z.editor.saveScript()}},{text:dt.No,click:function(){n?(ht=!0,n.click()):t&&Ct.close()}}],i={buttons:r,title:dt["Alert.Title.SaveChanges"]};ZSClass.ZSAlert(dt["Deluge.SaveChanges"],i),ot=n,Ut=e,Nt=t}function M(){z.parentNode.querySelector(".shNtfyWrpr").style.display="none"}var O,b,z,V,Z,P,F,H,B,Y,X,J,W,K,j,Q,$,et,tt,nt,rt,it,ot,ct,at,st,lt=e.sPlusPlus,ut=e.ZSConstants.FeatureConstants,dt=(e.ZSConstants.CommandConstants,e.ZSConstants.I18N),vt=e.UIUtil.Component,Et=(e.ZSConstants.JSKeyCode,e.ZSConstants.wCC),gt=e.UserAction,ft=(e.document,e.ZSEvents),Dt=ft.topic,pt=ft.Groups,mt=ft.Names,St=ZSClass.Editors,Lt=(e.UserAction.Macro,lt.view.Toolbar.Feature[ut.DELUGE]),It=e.ZSConstants,vt=e.UIUtil.Component,dt=e.ZSConstants.I18N,yt=It.ActionConstants,Ct=void 0,Rt=[],wt=0,Tt="",Ut=!1,At=ZSClass.RangePicker,qt=(At.register,{}),kt="ERRORBANNER",Nt=!1,ht=!1,Gt={save:function(){S()},execute:function(){p()},callback:function(e){Z=e}};Lt.openDialog=t,Lt.openHelpPage=C,Lt.editMacro=R,Lt.runMacro=o,Lt.buttonAssignMacro=U,Lt.createInsertDialog=r,Lt.getDelugeFunctionNameList=g}(this);
!function(e){function t(e){var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),n=s.data.getSharePublishMeta(i),c=n.getPublishMeta();if(c.isPublished())return void UserAction.UIViewEmbedURL();l||(o(),a.querySelector("#okBtn").addEventListener("click",r),a.querySelector("#clBtn").addEventListener("click",function(){l.close()}));var u=(s.data.UserInfo.orgName,a.querySelector("#publicInfoMessage"));u.innerText="org"==e?E["Public.Org.Warning"]:E.MakingThisDocumentPublicMsg,l.open()}function o(){var t=e.UserAction.getTemplate(["PUBLISH_TEMPLATE","OK_CANCEL_TEMPLATE"]),o={modal:!0,width:520,title:E.EmbedToWebsiteBlog,open:i};a=c.createElement("div"),a.Id=h.DI+d.EMBED+h.IDENTITY,a.appendChild(t.PUBLISH_TEMPLATE),a.appendChild(t.OK_CANCEL_TEMPLATE),l=new u.Dialog(a,o)}function i(){var e=s.data.getSharePublishMeta(l.rID),t=e.getPublishMeta(),o=void 0!=t.isAllowExport()?t.isAllowExport():!0,i=void 0!=t.isShowFormula()?t.isShowFormula():!1;a.querySelector("#allowExport").checked=o,a.querySelector("#lockFormula").checked=i}function r(){var e=l.rID,t=l.version,o=a.querySelector("#allowExport").checked,i=a.querySelector("#lockFormula").checked,r="external";UserAction.PublishSpreadsheet(e,t,r,o,i,"Make Public",n),l.close()}function n(){UserAction.UIViewEmbedURL()}var l,a,s=e.sPlusPlus,c=e.document,u=e.ZSClass,d=e.ZSConstants.FeatureConstants,E=e.ZSConstants.I18N,h=e.ZSConstants.wCC,S=e.ZSEvents,v=(S.topic,S.Groups,S.Names,s.view.Toolbar.Feature[d.EMBED]);v.openDialog=t}(this);
!function(e){function r(e){c=e,l||(t(),a.querySelector("#okBtn").addEventListener("click",o),a.querySelector("#clBtn").addEventListener("click",function(){l.close()}));var r="org"==e?P["Public.Org.Warning"]:P.MakingThisDocumentPublicMsg;a.querySelector("#publicInfoMessage").innerText=r,l.open()}function t(){var r=e.UserAction.getTemplate(["PUBLISH_OPTIONS","PUBLISH_TEMPLATE","OK_CANCEL_TEMPLATE"]),t={width:520,title:P["Publish.Spreadsheet"],modal:!0,open:n};a=S.createElement("div"),a.Id=h.DI+d.PUBLISH+h.IDENTITY,u=sPlusPlus.data.UserInfo.orgName,void 0!=u&&a.appendChild(r.PUBLISH_OPTIONS),a.appendChild(r.PUBLISH_TEMPLATE),a.appendChild(r.OK_CANCEL_TEMPLATE),l=new ZSClass.Dialog(a,t)}function n(){var e=s.data.getSharePublishMeta(l.rID),r=e.getPublishMeta(),t=void 0!=r.isAllowExport()?r.isAllowExport():!0,n=void 0!=r.isShowFormula()?r.isShowFormula():!1;if(a.querySelector("#allowExport").checked=t,a.querySelector("#lockFormula").checked=n,void 0!=u){a.querySelector("#withinNetworkLabel").innerText=JSUtil.fn.replaceParams(P["Share.Public.MakePublicWithin"],[u]),a.querySelector("#withinNetwork").checked=!0,a.querySelector("#publicInfoMessage").innerText=P["Public.Org.Warning"];var o=a.querySelector("#externalWorld");o.addEventListener("change",function(){a.querySelector("#publicInfoMessage").innerText=P.MakingThisDocumentPublicMsg});var i=a.querySelector("#withinNetwork");i.addEventListener("change",function(){a.querySelector("#publicInfoMessage").innerText=P["Public.Org.Warning"]})}}function o(){var e=l.rID,r=l.version,t=a.querySelector("#allowExport").checked,n=!a.querySelector("#lockFormula").checked;void 0!=u&&(c=a.querySelector("#externalWorld").checked?"external":"org"),UserAction.PublishSpreadsheet(e,r,c,t,n,"Make Public",i),l.close()}function i(){T.openDialog()}var l,a,c,u,s=e.sPlusPlus,d=e.ZSConstants.FeatureConstants,S=e.document,P=e.ZSConstants.I18N,h=e.ZSConstants.wCC,g=e.ZSEvents,p=(g.topic,g.Groups,g.Names,s.view.Toolbar.Feature[d.PUBLISH]),T=s.view.Toolbar.Feature[d.PUBLISH+"_ViewPublish"];p.openDialog=r}(this);
!function(e){function t(){s||(o(),n()),s.open()}function o(){var t=e.UserAction.getTemplate(["REMOVE_PUBLISH_TEMPLATE"]),o={width:520,title:c.RemovePublic};a=u.createElement("div"),a.Id=P.DI+r.PUBLISH+"_RemovePublish"+P.IDENTITY,a.appendChild(t.REMOVE_PUBLISH_TEMPLATE),s=new ZSClass.Dialog(a,o)}function n(){a.querySelector("#removeBtn").addEventListener("click",i),a.querySelector("#dontRemoveBtn").addEventListener("click",function(){s.close()})}function i(){var e=s.rID,t=s.version,o=l.data.getSharePublishMeta(e),n=o.getPublishMeta();UserAction.PublishSpreadsheet(e,t,n.getType(),n.isAllowExport(),n.isShowFormula(),"Remove Public"),s.close()}{var s,a,l=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,u=e.document,c=e.ZSConstants.I18N,P=e.ZSConstants.wCC,v=e.ZSEvents,S=(v.topic,v.Groups,v.Names,l.view.Toolbar.Feature[r.PUBLISH+"_RemovePublish"]);l.view.Toolbar.Feature[r.PUBLISH+"_ViewPublish"]}S.openDialog=t}(this);
!function(e){function t(){h||(s(),o(),n()),h.open()}function o(){var t=e.UserAction.getTemplate(["CHANGE_PUBLISH_OPTIONS","VIEW_PUBLIC_TEMPLATE","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]),o=t.EMBED_SNIPPET_TEMPLATE,n=o.querySelector("#embedCode"),a='<iframe style="position:absolute;height:100%;width:99%;border:none;" frameborder=0 src="',l='"></iframe>';n.innerText=a+v+"&mode=embed"+l;var s={width:620,title:I["Share.ViewPublicURL"],modal:!0,open:r,close:i};L=m.createElement("div"),L.Id=y.DI+A.PUBLISH+"_ViewPublish"+y.IDENTITY,T=sPlusPlus.data.UserInfo.orgName,void 0!=T&&(L.appendChild(t.CHANGE_PUBLISH_OPTIONS),L.querySelector("option[value='org']").innerText=JSUtil.fn.replaceParams(I["Share.Public.MakePublicWithin"],[T])),L.appendChild(t.VIEW_PUBLIC_TEMPLATE),L.appendChild(o),L.appendChild(t.EMBED_REVERT_CANCEL_TEMPLATE),b=L.querySelector("#zsPublicUrlLink");var c=L.querySelector("#publicURL"),u={inputToSelect:b,cssClass:"frmSnpt"},p=new R.CopyToClipboard(c,u);p.createElement();var S=L.querySelector("#embedSnippetCode"),d={inputToSelect:n,cssClass:"frmSnpt"},p=new R.CopyToClipboard(S,d);p.createElement(),h=new R.Dialog(L,s);var E=h.getKeyContext(),P=E.keyDown;P[f.SUPER+"+"+f.C]=function(){return!1},b.href=v,b.innerText=v}function n(){L.querySelector("#btnRemovePublic").addEventListener("click",u),L.querySelector("#btnCancel").addEventListener("click",function(){h.close()});var e=L.querySelectorAll("[name=publishTab]");e.forEach(function(e){e.addEventListener("change",a)});var t=L.querySelector("#vpAllowExport");t.addEventListener("change",l.bind(t,_.ALLOW_EXPORT));var o=L.querySelector("#vpLockFormula");o.addEventListener("change",l.bind(o,_.LOCK_FORMULA));var n=L.querySelector("#pubOption");U.bind(n,"zselectboxchange",function(e,t){var o=h.rID,n=h.version,r=(L.querySelector("#vpAllowExport").checked,L.querySelector("#vpLockFormula").checked,t.previousValue);UserAction.changePublishType(o,n,t.value,r)})}function r(){var e=C.data.getSharePublishMeta(h.rID),t=e.getPublishMeta(),o=void 0!=t.isAllowExport()?t.isAllowExport():!0,n=void 0!=t.isShowFormula()?t.isShowFormula():!1;if(L.querySelector("#vpAllowExport").checked=o,L.querySelector("#vpLockFormula").checked=!n,L.querySelector("#embedSnipetMsg").innerText=JSUtil.fn.replaceParams(I["Dialog.Publish.EmbedMessage"],[I["Dialog.Publish.Spreadsheet"]]),void 0!=T){L.querySelector("#publishMsg").innerText=JSUtil.fn.replaceParams(I["Share.Public.PublishType"],[I["Dialog.Publish.Spreadsheet"]]);var r=L.querySelector("#pubOption");"external"==t.type?U.zcombo(r,"setValue","external"):U.zcombo(r,"setValue","org")}}function i(){var e=L.querySelector("#btnEmbed");N&&c.call(e)}function a(){var e="",t=this.value;"html"==t?e="&mode=html":"print"==t&&(e="&mode=print"),b.href=v+e,b.innerText=v+e}function l(e){var t,o,n=h.rID,r=h.version;e==_.ALLOW_EXPORT?(t="ALLOWEXPORT",o=this.checked):e==_.LOCK_FORMULA&&(t="SHOWFORMULAS",o=!this.checked);var i=C.data.getSharePublishMeta(h.rID),a=i.getPublishMeta();UserAction.changePublishOptions(n,r,a.getType(),t,o,"Change Options")}function s(t){var o=e.location.protocol,n=e.location.host,r=C.data.AppRegistry.ctxpath,i=C.view.getActiveGridID(),a=t?t:C.view.getResourceID(i);v||(v=o+"//"+n+r+"published.do?rid="+a)}function c(){var e=L.querySelector("#embedSnipet");N?(e.style.display="none",this.classList.remove("zsbtn-ArrowOpen")):(e.style.display="block",this.classList.add("zsbtn-ArrowOpen")),N=!N}function u(){h.close(),B.openDialog()}function p(){window.open(v,"_blank")}function S(e){D.publish(O.Listener,M.DocAction.TOPBAND_ICONS.ADD,{SPACE:"PUBLIC",TEMPLATE_NAME:"org"==e?"ORG_PUBLISH_ICON":"EXTERNAL_PUBLISH_ICON",CALLBACK:p})}function d(){D.publish(O.Listener,M.DocAction.TOPBAND_ICONS.REMOVE,{SPACE:"PUBLIC"})}function E(e,t){t&&t.type?(s(),S(t.type)):d()}function P(e,t){if(t&&t[_.PUBLISH]&&t[_.PUBLISH][_.PUBLISH_TYPE]){s(e);var o=t[_.PUBLISH],n=o[_.PUBLISH_TYPE];S(n)}}var h,L,b,v,T,C=e.sPlusPlus,A=e.ZSConstants.FeatureConstants,m=e.document,I=e.ZSConstants.I18N,y=e.ZSConstants.wCC,U=e.UIUtil.Component,_=ZSConstants.CommandConstants,f=ZSConstants.JSKeyCode,g=e.ZSEvents,D=g.topic,O=g.Groups,M=g.Names,w=C.view.Toolbar.Feature[A.PUBLISH+"_ViewPublish"],B=C.view.Toolbar.Feature[A.PUBLISH+"_RemovePublish"],R=e.ZSClass;w.openDialog=t;var N=0;D.register(O.Listener,M.ShareMeta.UPDATE,P,"RID","META"),D.register(O.Listener,M.DocAction.DOCUMENT.PUBLISHED,E,"RID","META")}(this);
!function(e){function t(){var e=h.view.getActiveGridID(),t=h.view.getSheetID(e),n=h.view.getSheetState(e,t),l=n.isMultiRangeSelected();if(l)return void b.ZSAlert(m["action.not.support.multiselection"],m["Alert.Title.InvalidCellRange"]);if(!u){var a=UserAction.getTemplate(["PUBLISH_RANGE_OPTIONS","RANGE_PUBLISH_TEMPLATE"]),o={width:560,title:m.PublishRange,dialogClass:"publshRange",open:i};g=document.createElement("div"),g.Id=T.DI+f.PUBLISH_RANGE+T.IDENTITY,d=sPlusPlus.data.UserInfo.orgName,void 0!=d&&g.appendChild(a.PUBLISH_RANGE_OPTIONS),g.appendChild(a.RANGE_PUBLISH_TEMPLATE),u=new b.Dialog(g,o),g.querySelector("#cancelBtn").addEventListener("click",function(){u.close()})}g.querySelector("#publicRangeInfoMessage").innerText=m["RangePublish.PublishRangeDialog.ExternalPublicConfirmMsg"],g.querySelector("#continueBtn").addEventListener("click",r),u.open()}function i(){if(n(g),void 0!=d){g.querySelector("#withinNetwork").checked=!0,g.querySelector("#withinNetworkLabel").innerText=JSUtil.fn.replaceParams(m["Share.Public.MakePublicWithin"],[d]),g.querySelector("#publicRangeInfoMessage").innerText=JSUtil.fn.replaceParams(m["RangePublish.PublishRangeDialog.OrganizationPublicConfirmMsg"],[d,d]);var e=g.querySelector("#externalWorld");e.addEventListener("change",function(){g.querySelector("#publicRangeInfoMessage").innerText=m["RangePublish.PublishRangeDialog.ExternalPublicConfirmMsg"]});var t=g.querySelector("#withinNetwork");t.addEventListener("change",function(){g.querySelector("#publicRangeInfoMessage").innerText=JSUtil.fn.replaceParams(m["RangePublish.PublishRangeDialog.OrganizationPublicConfirmMsg"],[d,d])})}}function n(e){var t=h.view.getActiveGridID(),i=h.view.getResourceID(t),n=h.view.getSheetID(t),r=h.view.getVersionID(t),l=h.data.getWorkBook(i,r),a=l.getSheetObj(n),o=a.Prop.getName(),c=h.view.getSheetState(t,n),s=c.getActiveRange(),g=s.getLabel(),d=o+"."+g,S=e.querySelector("#nR_expression");_=new y.RangeEditor(S,!0),_.value=d,b.RangePicker.register(_,!0,!1);var P=S.nextElementSibling;b.RangePicker.Dialog.register(_,u,P,"Select Range"),_.focus()}function r(){var e=u.rID,t=u.sheetList,i=u.version;P="external",void 0!=d&&(P=g.querySelector("#externalWorld").checked?"external":"org");var n=_.value;UserAction.publishRange(e,t,i,n,P,l),u.close()}function l(t){var i='<iframe style="height:200px; width:335px;" marginwidth="0" marginheight="0" scrolling="auto" frameborder=0 src="',n='"></iframe>';if("Failure"==t)return void I.publish(C.Listener,A.ERROR.SHOW,{ERRORMSG:"Error.Internal.Server"});var r=t.id;if(p=r,!D){var l=e.UserAction.getTemplate(["CHANGE_RANGE_PUBLISH_OPTIONS","VIEW_RANGE_PUBLISH_URL","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]),s={width:520,title:m.PublishRange,model:!0,open:a};U=document.createElement("div"),void 0!=d&&U.appendChild(l.CHANGE_RANGE_PUBLISH_OPTIONS),U.appendChild(l.VIEW_RANGE_PUBLISH_URL),U.appendChild(l.EMBED_SNIPPET_TEMPLATE),U.appendChild(l.EMBED_REVERT_CANCEL_TEMPLATE),D=new b.Dialog(U,s),U.querySelector("#btnRemovePublic").addEventListener("click",function(){c.call(null,r)}),U.querySelector("#btnCancel").addEventListener("click",function(){D.close()}),S=U.querySelector("#zsPublicUrlLink");var u=U.querySelector("#publicURL"),g={inputToSelect:S,cssClass:"frmSnpt"},P=new b.CopyToClipboard(u,g);P.createElement();var h=U.querySelector("#embedCode"),v=U.querySelector("#embedSnippetCode"),E={inputToSelect:h,cssClass:"frmSnpt"},P=new b.CopyToClipboard(v,E);P.createElement()}var R=o(r),f=U.querySelector("#embedCode");f.innerText=i+R+n,S.href=R,S.innerText=R,D.open()}function a(){if(U.querySelector("#embedSnipetMsg").innerText=JSUtil.fn.replaceParams(m["Dialog.Publish.EmbedMessage"],[m["Dialog.Publish.Range"]]),void 0!=d){U.querySelector("#publishMsg").innerText=JSUtil.fn.replaceParams(m["Share.Public.PublishType"],[m["Dialog.Publish.Range"]]);var e=U.querySelector("#pubRangeOption");U.querySelector("option[value='org']").innerText=JSUtil.fn.replaceParams(m["Share.Public.MakePublicWithin"],[d]),"external"==P?R.zcombo(e,"setValue","external"):R.zcombo(e,"setValue","org"),R.bind(e,"zselectboxchange",function(e,t){var i=D.rID,n=D.version,r=t.previousValue,l=t.selectedValue;UserAction.changePublishRangeType(i,n,l,r,p)})}}function o(e){var t=JSUtil.fn.getServerPath();return t+=h.data.AppRegistry.ctxpath,t+="publishrange.do?id="+e}function c(e){var t={type:"warning",noIcon:!0,title:m["Alert.Title.RemovePublicMode"],buttons:[{primary:!0,text:m.OK,click:function(){s(e),D.close()}},{text:m["Dialog.Button.Cancel"]}]};b.ZSAlert(m["RangePublish.ShowPublishedRangeDialog.RevertRangePublishAlert.ConfirmMsg"],t)}function s(e){var t=D.rID,i=D.sheetList,n=D.version;UserAction.updatePublishRange(t,i,n,e,"public","Remove")}var u,g,d,S,P,p,h=e.sPlusPlus,v=e.ZSConstants,b=e.ZSClass,E=e.ZSEvents,R=e.UIUtil.Component,f=v.FeatureConstants,m=v.I18N,T=v.wCC,I=E.topic,C=E.Groups,A=E.Names,L=h.view.Toolbar.Feature[f.PUBLISH_RANGE],_=void 0,y=b.Editors;L.openDialog=t;var U,D}(this);
!function(e){function t(){if(!v){var e=N.getTemplate(["VIEW_PUBLISHED_RANGE","CLOSE_BUTTON_TEMPLATE"]),t={width:800,title:w["MenuItem.data.ManagePublish"],dialogClass:"pubRangeMng",close:function(){n()}};y=document.createElement("div"),y.id=I.DI+T.MANAGE_PUBLISH_RANGE+I.IDENTITY,y.appendChild(e.VIEW_PUBLISHED_RANGE),y.appendChild(e.CLOSE_BUTTON_TEMPLATE),y.querySelector("#closeBtn").addEventListener("click",function(){v.close()}),v=new _.Dialog(y,t)}v.open(),r(),a()}function i(e){var t=e.Dom,i=e.type,n=e.rangeID;if(void 0!=b){var r=t.querySelector(".rPubOnCombo");"public"==i?A.zcombo(r,"setValue","external"):A.zcombo(r,"setValue","org"),A.bind(r,"zselectboxchange",function(t,i){var r=v.rID,a=v.version,l=i.previousValue,o=i.selectedValue;e.type=o,N.changePublishRangeType(r,a,o,l,n)})}}function n(){m=void 0;var e=y.querySelector("#embedSnipet");e&&(e.style.display="none")}function r(){E=document.createElement("div"),E.classList.add("ZsLoader");var e=y.querySelector("#viewPublishTable");e.innerHTML="",e.appendChild(E)}function a(){var e=v.rID,t=v.sheetList,i=v.version,n=R.data.UserInfo.orgName;N.getPublishRanges(e,t,i,n,l)}function l(e){var t=y.querySelector("#viewPublishTable"),i=e.NORANGESPUBLISHED;if("false"==i){var n=document.createDocumentFragment();f=e.PUB_SHEETS.length;var r=e.PUB_SHEETS,a=e.PUB_RANGE_SROW,l=e.PUB_RANGE_SCOL,s=e.PUB_RANGE_EROW,c=e.PUB_RANGE_ECOL,u=e.PUB_DATE,d=e.PUB_ENC_URL,p=e.PUB_TYPE;y.querySelector("#viewPublishHead").style.display="";for(var S=0;f>S;S++)P=new o(n,r[S],a[S],l[S],s[S],c[S],u[S],d[S],p[S]);t.appendChild(n)}else{var g=N.getTemplate(["NO_RANGE_PUBLISHED"]);y.querySelector("#viewPublishHead").style.display="none",t.appendChild(g.NO_RANGE_PUBLISHED)}E.remove()}function o(e,t,i,n,r,a,l,o,s){l=l.substring(l.indexOf(" ")+1),this.range=u(t,i,n,r,a),this.Dom=d(this.range,l,s,o),this.rangeID=o,this.type=s,S(this),e.appendChild(this.Dom)}function s(e,t){e.querySelector("#editRange").style.display="view"==t?"":"none",e.querySelector("#removeRange").style.display="view"==t?"":"none",e.querySelector("#rangeName").style.display="view"==t?"":"none",e.querySelector("#updateRange").style.display="view"==t?"none":"",e.querySelector("#cancelEdit").style.display="view"==t?"none":"",e.querySelector("#rangeNameEdit").style.display="view"==t?"none":""}function c(t,i,n){var r=R.view.getActiveGridID(),a=R.view.getResourceID(r),l=R.view.getVersionID(r),o=R.view.getSelectedSheets(r),s=JSUtil.Range.parseRange(a,l,t);e.UserAction.updatePublishRange(a,o,l,i,n,"Update",s)}function u(e,t,i,n,r){var a;return a=t==n&&i==r?JSUtil.Cell.getReference(t,i):JSUtil.Cell.getReference(t,i)+":"+JSUtil.Cell.getReference(n,r),e+"."+a}function d(e,t,i,n){b=sPlusPlus.data.UserInfo.orgName;var r=N.getTemplate(["PUBLISHED_RANGE_ROW"]),a=r.PUBLISHED_RANGE_ROW;a.querySelector("option[value='org']").innerText=JSUtil.fn.replaceParams(w["Share.Public.MakePublicWithin"],[b]),a.querySelector("#rangeName").innerText=e,a.querySelector("#publishedOn span").innerText=t,a.querySelector(".rPubOnCombo").id="pubRangeOption_"+n;var l=document.createElement("div");return l.className="dspTblRow",l.appendChild(a),A.initComponent(l),l}function p(){var e=this.Dom.querySelector("#nR_expression");this.rangeEditor=new U.RangeEditor(e,!0),_.RangePicker.register(this.rangeEditor,!0,!1);var t=e.nextElementSibling;_.RangePicker.Dialog.register(this.rangeEditor,v,t,"Select Range")}function S(e){var t=e.Dom,n=t.querySelector("#editRange"),r=t.querySelector("#removeRange"),a=t.querySelector("#updateRange"),l=t.querySelector("#cancelEdit"),o=t.querySelector("#showSnippet"),s=t.querySelector("#hideSnippet");n.addEventListener("click",function(){e.edit.call(e)}),r.addEventListener("click",function(){e.remove.call(e)}),o.addEventListener("click",function(){m&&(m.classList.remove("active"),m.querySelector("#showSnippet").style.display="",m.querySelector("#hideSnippet").style.display="none"),t.classList.add("active"),e.showSnippet.call(e)}),s.addEventListener("click",function(){t.classList.remove("active"),e.hideSnippet.call(e)}),a.addEventListener("click",function(){e.update.call(e)}),l.addEventListener("click",function(){e.cancelEdit.call(e)}),i(e)}function g(e,t,i){var n={type:"warning",noIcon:!0,title:w["Alert.Title.RemovePublicMode"],buttons:[{primary:!0,text:w.OK,click:function(){h(e,t);var n=y.querySelector("#embedSnipet"),r=y.querySelector("#embedCode"),a=r?r.getAttribute("domvalue"):void 0;a&&e==a&&(n.style.display="none"),i()}},{text:w["Dialog.Button.Cancel"]}]};_.ZSAlert(w["RangePublish.ShowPublishedRangeDialog.RevertRangePublishAlert.ConfirmMsg"],n)}function h(t,i){var n=R.view.getActiveGridID(),r=R.view.getResourceID(n),a=R.view.getVersionID(n),l=R.view.getSelectedSheets(n);e.UserAction.updatePublishRange(r,l,a,t,i,"Remove")}var v,y,E,m,P,b,f,R=e.sPlusPlus,D=e.ZSConstants,_=e.ZSClass,q=e.ZSEvents,T=D.FeatureConstants,w=D.I18N,I=D.wCC,N=(q.topic,q.Groups,q.Names,e.UserAction),U=_.Editors,C=R.view.Toolbar.Feature[T.MANAGE_PUBLISH_RANGE],A=e.UIUtil.Component;C.openDialog=t,o.prototype={edit:function(){s(this.Dom,"edit"),this.rangeEditor||p.call(this),this.rangeEditor.value=this.range,this.rangeEditor.focus()},update:function(){s(this.Dom,"view"),this.range=this.rangeEditor.value,this.Dom.querySelector("#rangeName").innerText=this.range,c(this.range,this.rangeID,this.type)},remove:function(){var e=this;g(this.rangeID,this.type,function(){if(e.Dom.remove(),f-=1,0==f){y.querySelector("#viewPublishHead").style.display="none";var t=N.getTemplate(["NO_RANGE_PUBLISHED"]),i=y.querySelector("#viewPublishTable");i.appendChild(t.NO_RANGE_PUBLISHED)}})},showSnippet:function(){var e='<iframe style="height:200px; width:335px;" marginwidth="0" marginheight="0" scrolling="auto" frameborder=0 src="',t='"></iframe>',i=y.querySelector("#embedCode");if(!i){var n=N.getTemplate(["EMBED_SNIPPET_TEMPLATE"]),r=n.EMBED_SNIPPET_TEMPLATE;r.className="publishRangeSnippet",y.appendChild(r),y.querySelector("#embedSnipetMsg").innerText=JSUtil.fn.replaceParams(w["Dialog.Publish.EmbedMessage"],[w["Dialog.Publish.Range"]]),i=y.querySelector("#embedCode");var a=y.querySelector("#embedSnippetCode"),l={inputToSelect:i,cssClass:"frmSnpt"},o=new _.CopyToClipboard(a,l);o.createElement()}i.setAttribute("domvalue",this.rangeID),m=this.Dom;var s=JSUtil.fn.getServerPath();s+=R.data.AppRegistry.ctxpath,s+="publishrange.do?id="+this.rangeID,i.innerText=e+s+t,y.querySelector("#embedSnipet").style.display="",this.Dom.querySelector("#showSnippet").style.display="none",this.Dom.querySelector("#hideSnippet").style.display=""},hideSnippet:function(){this.Dom.querySelector("#showSnippet").style.display="",this.Dom.querySelector("#hideSnippet").style.display="none",y.querySelector("#embedSnipet").style.display="none"},cancelEdit:function(){s(this.Dom,"view")}}}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),o=s.view.getVersionID(e),n=s.view.getSheetState(e,i),c=n.getActiveCellRange(),a=c.startCol,r=s.data.getWorkBook(t,o),u=r.getSheetObj(i);l.value=u.Column.axis.getDim(a),l.focus(),l.select()}function i(){g||n(),g.open()}function o(){g.close()}function n(){var i=e.UserAction.getTemplate(["ColumnCustomFitTemplate"]),n=i.ColumnCustomFitTemplate;w=document.createElement("div"),w.id="DI_COLCUSTOMFIT",w.appendChild(n),l=w.querySelector("#col_width");var s={width:300,title:u.ColumnWidth,open:function(){t()}};g=new e.ZSClass.Dialog(w,s);var a=g.getKeyContext();a.keyDown[C.ENTER]=function(){c(l.value)},w.querySelector("#okBtn").addEventListener("click",function(){c(l.value)}),w.querySelector("#clBtn").addEventListener("click",o)}function c(t){var i=s.view.getActiveGridID(),n=s.view.getResourceID(i),c=s.view.getVersionID(i),l=s.view.getSheetID(i),a=s.view.getSheetState(i,l),r=a.getActiveRange(),u=r.endCol,v=r.startCol,C=u-v+1,d=s.view.getSelectedSheets(i),g=parseInt(t);g?e.UserAction.ResizeCol(n,d,c,g,v,C,!1,!0):e.UserAction.HideCol(n,d,c,"HIDE",r),o()}var l,s=e.sPlusPlus,a=(e.document,e.ZSConstants),r=a.FeatureConstants,u=a.I18N,v=(a.wCC,e.ZSEvents),C=(v.topic,v.Groups,v.Names,a.JSKeyCode),d=s.view.Toolbar.Feature[r.COL_OPTIONS],g=void 0,w=void 0;d.showDialog=i}(this);
!function(e){function t(){var e=c.view.getActiveGridID(),t=c.view.getResourceID(e),i=c.view.getSheetID(e),o=c.view.getVersionID(e),n=c.data.getWorkBook(t,o),a=n.getSheetObj(i),r=c.view.getSheetState(e,i),v=r.getActiveRange(),u=(v.endRow,v.startRow),w=a.Row.axis.getDim(u);s.value=w,s.focus(),s.select()}function i(){R||n(),R.open()}function o(){R.close()}function n(){var i=e.UserAction.getTemplate(["RowCustomFitTemplate"]),n=i.RowCustomFitTemplate;S=r.createElement("div"),S.id="DI_ROWCUSTOMFIT",S.appendChild(n),s=S.querySelector("#row_height");var c={width:300,title:w.RowHeight,open:function(){t()}};R=new e.ZSClass.Dialog(S,c);var v=R.getKeyContext();v.keyDown[g.ENTER]=function(){a(s.value)},S.querySelector("#okBtn").addEventListener("click",function(){a(s.value)}),S.querySelector("#clBtn").addEventListener("click",o)}function a(t){var i=c.view.getActiveGridID(),n=c.view.getResourceID(i),a=c.view.getSheetID(i),s=c.view.getVersionID(i),r=c.view.getSheetState(i,a),v=r.getActiveRange(),u=v.endRow,w=v.startRow,l=u-w+1,g=c.view.getSelectedSheets(i),d=parseInt(t);d?e.UserAction.ResizeRow(n,g,s,d,w,l,!1,!0):e.UserAction.HideRow(n,g,s,"HIDE",v),o()}var s,c=e.sPlusPlus,r=e.document,v=e.ZSConstants,u=v.FeatureConstants,w=(v.wCC,v.I18N),l=e.ZSEvents,g=(l.topic,l.Groups,l.Names,v.JSKeyCode),d=(c.data.Defaults,c.view.Toolbar.Feature[u.ROW_OPTIONS]),R=void 0,S=void 0;d.showDialog=i}(this);
!function(e){function t(){v||i(),h.appendChild(T),v.open()}function i(){T=f.createElement("div"),T.classList.add("ZsLoader");var e=f.createElement("div");e.id="DI_MY_TEMPLATES";var t=y.getTemplate(["TEMPLATE_CONTAINER"]).TEMPLATE_CONTAINER;e.appendChild(t),h=e.querySelector("#tmplHolder");var i={modal:!0,width:761,title:S.SystemTemplatesTitle,close:n,open:s};v=new ZSClass.Dialog(e,i)}function s(){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),i=E.view.getVersionID(e);y.getMyTemplates(t,i,a)}function n(){h.innerHTML="",C=0}function a(e){if(u=e,h.removeChild(T),u.templateInfo){var t=y.getTemplate(["NEW_TEMPLATE_SMALL"]).NEW_TEMPLATE_SMALL,i=new r(t);h.appendChild(i.dom);for(var s=u.templateInfo,n=s.length-1;n>=0;n--){var a=new l(s[n].rid,s[n].dn);h.appendChild(a.dom),C++}}else{var o=y.getTemplate(["NEW_TEMPLATE_LARGE"]).NEW_TEMPLATE_LARGE,i=new r(o);h.appendChild(i.dom)}}function r(e){this.dom=e.querySelector("#newTemplateItem"),this.init()}function l(e,t){this.rID=e,this.templateName=t;var i=y.getTemplate(["TEMPLATE_ITEM"]).TEMPLATE_ITEM;this.dom=i.querySelector("#templateItem"),this.init()}function o(){if(0==C){h.innerHTML="";var e=y.getTemplate(["NEW_TEMPLATE_LARGE"]).NEW_TEMPLATE_LARGE,t=new r(e);h.appendChild(t.dom)}}function m(){var e={import:function(){p(this.files,this.isURLImport)},importCancel:function(){c.close()},openDialog:function(){},closeDialog:function(){}};c||(c=new ZSClass.ImportDialog(e,!1)),c.open()}function p(t,i){var s="IMPORT_AS_TEMPLATE",n=E.view.getActiveGridID(),a=E.view.getResourceID(n),r=E.view.getVersionID(n),l=E.view.getSelectedSheets(n);e.UserAction.fileImport(a,l,r,t,i,s,void 0,d)}function d(e,t,i,s){if(s&&s.url){c.close(),v.close();var n=y.getTemplate(["STATUS_ALERT"]),a=n.STATUS_ALERT;a.querySelector("#msg").innerText=S["Import.SuccessMsg"];var r=a.querySelector("#fileLink");r.href=E.data.AppRegistry.ctxpath+E.data.AppRegistry.ClientURI+s.rid,r.innerText=s.fname,r.title=s.fname;var l=[{text:S["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(r.href,"_blank")}},{text:S.Close,cilck:function(){c.close()}}];ZSClass.ZSAlert(a,{type:"success",isHtml:!0,buttons:l,title:S["Alert.Title.ImportSuccessful"]})}}var c,u,v,h,T,E=e.sPlusPlus,f=e.document,A=e.ZSEvents,L=(A.topic,A.Groups,A.Names,e.ZSConstants),g=L.FeatureConstants,S=L.I18N,I=(L.wCC,ZSConstants.JSKeyCode),y=e.UserAction,R=e.JSUtil,C=0,_=E.view.Toolbar.Feature[g.MY_TEMPLATES];_.openDialog=t,r.prototype={init:function(){var e=this.dom.querySelector("#crtTmpl"),t="https://"+E.data.AppRegistry.DOCS_SERVER_URL+"/createnew.do?service=zohosheet&parentid=-1&type=template";e.href=t,e.rel="noopener",e.target="_blank";var i=this.dom.querySelector("#impTmpl");i.addEventListener("click",m),this.dom.addEventListener("mouseover",function(){this.classList.add("tmplHover")}),this.dom.addEventListener("mouseleave",function(){this.classList.remove("tmplHover")})}},l.prototype={init:function(){this.bindEventsAndAttributes(),this.setImage()},bindEventsAndAttributes:function(){this.dom.useBtn=this.dom.querySelector("#useTmpl"),this.dom.useBtn.addEventListener("click",this.useTemplate.bind(this));var e=this.dom.querySelector("#tmplDel");e.addEventListener("click",this.deleteTemplate.bind(this)),e.title=S["File.MyTemplates.Delete"];var t=this.dom.querySelector("#tmplName");t.value=this.templateName,t.addEventListener("blur",this.renameTemplate.bind(this)),t.addEventListener("keydown",function(e){if(e.keyCode==I.ENTER){var t=new Event("mouseleave");e.target.blur(),this.dom.dispatchEvent(t)}}.bind(this));var i=this.dom.querySelector("#viewTmpl");i.rel="noopener",i.target="_blank",i.href=E.data.AppRegistry.ctxpath+E.data.AppRegistry.ClientURI+this.rID,this.dom.addEventListener("mouseover",function(){this.classList.add("tmplHover")}),this.dom.addEventListener("mouseleave",function(){this.classList.remove("tmplHover")})},setImage:function(){var e=this.dom.querySelector("#tmlImg");e.onerror=function(){this.src=E.data.AppRegistry.ctxpath+"appsheet/styles/images/thumbNailPlaceHolder.svg",this.classList.remove("tmplImg"),this.classList.add("tmplNoImg")},e.src="https://"+E.data.AppRegistry.DOCS_SERVER_URL+"/thumbnail/"+this.rID+"?width=200&height=150",e.classList.add("tmplImg")},renameTemplate:function(e){var t=e.target.value;""==t?(ZSClass.ZSAlert(S["InvalidMsg.TemplateName"],{title:S["Alert.Title.InvalidTemplateName"]}),e.target.value=this.templateName):(y.renameTemplate(this.rID,v.version,t),this.templateName=t)},deleteTemplate:function(){var e=S["File.MyTemplates.DeleteConfirmationMsgOnTemplates"];e=R.fn.replaceParams(e,[this.templateName]);var t=this,i=[{text:S.Yes,primary:!0,click:function(){y.deleteTemplate(t.rID,v.version),t.dom.remove(),C--,o()}},{text:S.No}],s={buttons:i,title:S["Delete.Template"]};ZSClass.ZSAlert(e,s)},useTemplate:function(){var e=this.dom.useBtn;e.classList.add("ZsRt");var t=f.createElement("SPAN");e.appendChild(t),y.useTemplate(this.rID,v.version,this.templateName,function(t){if(t&&t.di){var i=E.data.AppRegistry.ctxpath+E.data.AppRegistry.ClientURI+t.di;e.classList.remove("ZsRt"),e.removeChild(e.querySelector("SPAN")),window.location.href=i}})}}}(this);
!function(e){function t(e,t,o,c){var a=Ft.view.getActiveGridID();t=t||Ft.view.getResourceID(a),c=c||Ft.view.getVersionID(a),o=o||Ft.view.getSheetID(a);var s=Ft.data.getWorkBook(t,c),u=1==Ft.data.UserInfo.Permission.isEditable?s.isEditable():Ft.data.UserInfo.Permission.isEditable,d=u?"Find.Dialog.Title":"Find.Title",v={width:440,title:_t[d],close:function(){zt=!1,I()},open:function(){l(),setTimeout(function(){qt.zcombo("#"+kt,"setValue",Pt)},10)}};u?n(e,v):i(e,v),J.open(),zt=!0,r(),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.SHOWERRORMSG,m,"ERRORMSG"),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.STATUS,F,"STATUS","RESPONSE"),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.WRAP,N,"isEOS","replaceCount"),Et.register(Ct.Gesture.Selector.Range,yt.GESTURE.ACTION.END,r),Et.register(Ct.Selector.BoundUpdate.Cell,yt.Selection.BOUND_UPDATE.ADD,E)}function i(e,t){if(!j){Y=c("FIND_DIALOG",Y),j=new mt.Dialog(Y,t);var i=j.getKeyContext(),n=i.keyDown;n[Ut.ENTER]=function(e){return e.stopPropagation(),!1},qt.bind("#searchInCombo","combochange",function(){D()})}kt="searchInCombo",Z=Y,J=j}function n(e,t){if(!$){et=c("FIND_REPLACE_DIALOG",et),$=new mt.Dialog(et,t);var i=$.getKeyContext(),n=i.keyDown;n[Ut.ENTER]=function(e){return e.stopPropagation(),!1},qt.bind("#searchInComboFR","combochange",function(){D()})}kt="searchInComboFR",J=$,Z=et}function r(){var e=Ft.view.getActiveGridID(),t=Ft.view.getSheetID(e),i=Ft.view.getSheetState(e,t),n=i.getActiveRange();n.isSingle()?qt.zcombo("#"+kt,"setValue","sheet"):(qt.zcombo("#"+kt,"setValue","range"),o())}function o(){var e=Ft.view.getActiveGridID(),t=Ft.view.getSheetID(e),i=Ft.view.getSheetState(e,t),n=i.getActiveRange();It=n}function c(t,i){var n=e.UserAction.getTemplate([t]),r=n[t],c=r.querySelector("#searchInput");st=new xt.TextAreaEditor(c);var a=r.querySelector("#replaceInput");return a&&(lt=new xt.TextAreaEditor(a)),d(r),o(),i=bt.createElement("div"),i.id=Tt.DI+Lt.FIND+Tt.IDENTITY,i.appendChild(r),i}function a(t){var i=e.UserAction.getTemplate([t]),n=i[t];n.querySelector(".shNtfyClose").style.display="none",s(n)}function s(e){ti=Z.parentNode.querySelector(".shNtfyWrpr"),ti&&Z.parentNode.removeChild(ti),Z.parentNode.appendChild(e),ti=Z.parentNode.querySelector(".shNtfyWrpr"),ti.style.display="none",Vt=0}function l(){tt=Z.querySelector("#searchInput"),tt.value=ut.value,f(),tt.select(),it=Z.querySelector("#replaceInput"),nt=Z.querySelector("#"+kt),rt=Z.querySelector("#matchCaseChkBox"),ot=Z.querySelector("#matchCellChkBox"),ct=Z.querySelector("#dirUpRadio"),at=Z.querySelector("#dirDownRadio")}function u(){Vt&&(ti.style.display="none",Vt=0)}function d(e){var t=e.querySelector("#searchInput");t.addEventListener("input",u);var i=e.querySelector("#searchNext");i.addEventListener("click",H);var n=e.querySelector("#replaceButton");n&&n.addEventListener("click",Q);var r=e.querySelector("#replaceAllButton");r&&r.addEventListener("click",X);var o=e.querySelector("#searchCloseBtn");o.addEventListener("click",S),st.addListeners({keydown:v.bind("find"),input:f}),lt&&lt.addListeners({keydown:v.bind("replace"),input:f})}function v(e){var t=e.keyCode||e.which;switch(t){case 13:"find"==this?H():Q()}}function f(){var e=st.value,t=e?1:lt&&lt.value?1:0;Z.querySelector("#searchNext").disabled=!t;var i=Z.querySelector("#replaceButton");i&&(i.disabled=!t);var n=Z.querySelector("#replaceAllButton");n&&(n.disabled=!t)}function g(){return{findString:tt.value,replaceString:it?it.value:"",searchIn:qt.zcombo(nt,"getValue"),matchCase:rt.checked,matchCell:ot.checked,isNext:at.checked}}function h(e){switch(e){case"workbook":return Ot.FIND_IN_WORKBOOK;case"sheet":return Ot.FIND_IN_SHEET;case"row":return Ot.FIND_IN_ROW;case"column":return Ot.FIND_IN_COL;case"range":return Ot.FIND_IN_RANGE;default:return Ot.FIND_IN_SHEET}}function I(){var e=Ft.view.getActiveGridID(),t=Ft.view.getResourceID(e),i=Ft.view.getVersionID(e),n=(Ft.view.getSelectedSheets(e),Ft.view.getSheetID(e)),o=Ft.view.getSheetState(e,n),c=o.getActiveCellRange();Mt.gotoCell(t,n,i,c,c.startRow,c.startCol),ht=void 0,u(),Et.unregister(Ct.Listener,yt.CellAction.VALUE.FIND.SHOWERRORMSG,m),Et.unregister(Ct.Listener,yt.CellAction.VALUE.FIND.STATUS,F),Et.unregister(Ct.Listener,yt.CellAction.VALUE.FIND.WRAP,N),Et.unregister(Ct.Gesture.Selector.Range,yt.GESTURE.ACTION.END,r),Et.unregister(Ct.Selector.BoundUpdate.Cell,yt.Selection.BOUND_UPDATE.ADD,E)}function S(){J.close()}function p(e,t,i,n){Et.publish(Ct.Selector.BoundUpdate.Range,yt.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:n})}function k(e,t,i){var n=Ft.view.getActiveGridID(),t=Ft.view.getSheetID(n),r=Ft.view.getSheetState(n,t),o=r.getActiveCellRange();Mt.gotoCell(e,t,i,o,o.startRow,o.startCol)}function w(e,t,i,n){var r,c=Ft.data.Defaults,a=c.MAX_COL,s=c.MAX_ROW,l=Ft.view.getActiveGridID(),u=Ft.view.getSheetID(l),d=Ft.view.getSheetState(l,u),v=d.getActiveCellRange(),f=d.getActiveRange(),g=v.startRow,h=v.startCol;switch(n){case Ot.FIND_IN_ROW:r=new Bt(g,0,g,a-1);break;case Ot.FIND_IN_COL:r=new Bt(0,h,s-1,h);break;case Ot.FIND_IN_RANGE:f.isRowRange()||f.isColRange()||o(),r=It}return r}function D(){var e=Ft.view.getActiveGridID(),t=Ft.view.getResourceID(e),i=Ft.view.getVersionID(e),n=Ft.view.getSheetID(e),r=Ft.view.getSelectedSheets(e),o=g(),c=h(o.searchIn),a=w(r,t,i,c);Wt&&(k(t,n,i),Wt=!1),a&&(p(t,n,i,a),Wt=!0)}function F(e,t){ht==t||(ht={col:t.col,row:t.row,sheet:t.sheet}),ti&&(ti.style.display="none"),Vt=0}function N(e,t){var i,n,r=g(),o=h(r.searchIn);switch(o){case Ot.FIND_IN_WORKBOOK:n="Workbook";break;case Ot.FIND_IN_SHEET:n="Sheet";break;case Ot.FIND_IN_COL:n="Column";break;case Ot.FIND_IN_ROW:n="Row";break;case Ot.FIND_IN_RANGE:n="Range"}switch(e){case 0:i=_t["Find.StartOf"+n];break;case 1:i=_t["Find.EndOf"+n];break;case 2:t?i=1==t?_t["Find.replaceMsgForOne"]:At.fn.replaceParams(_t["Find.replaceMsg"],[t]):(a("ERRORBANNER"),i=_t["Find.NoMoreOccurrrence"])}ti.querySelector(".shNtfyCtn").textContent=i,ti.style.display="block",Vt=1,St&&clearTimeout(St),St=setTimeout(u,3e3)}function m(e){e.contains("CannotFindSearch")&&(Vt&&u(),a("INFOBANNER"),N(2,0))}function A(e,t,i){return e>i.left&&e<i.right&&t>i.top&&t<i.bottom?!0:!1}function E(){if(zt){var e=bt.querySelector(".gridholder").children[0],t=bt.querySelector(".cellSelection"),i=J.getDialog(),n=Ft.view.measures,r={top:n.gridTop,left:n.gridLeft},o={left:e.scrollLeft,top:e.scrollTop,offLeft:e.offsetLeft,offTop:e.offsetTop},c={top:t.offsetTop-(o.top-o.offTop),bottom:t.offsetTop-(o.top-o.offTop)+t.offsetHeight,left:t.offsetLeft-(o.left-o.offLeft),right:t.offsetLeft-(o.left-o.offLeft)+t.offsetWidth},a={top:i.offsetTop-r.top,bottom:i.offsetTop-r.top+i.offsetHeight,left:i.offsetLeft-r.left,right:i.offsetLeft-r.left+i.offsetWidth},s=A(c.left,c.top,a),l=A(c.right,c.top,a),u=A(c.right,c.bottom,a),d=A(c.left,c.bottom,a);(l||s||u||d)&&(window.innerWidth-c.right>=i.offsetWidth?i.style.left=c.right+r.left+"px":c.left>=i.offsetWidth&&(i.style.left=c.left-i.offsetWidth+r.left+"px"))}}function C(){return Gt.Stack[Gt.Stack.length-1]}function y(e){Gt.focusContext(e)}function b(e){Yt?(Ht=!0,wt=e,L()):$t.openDialog()}function q(e){vt=e.target}function R(){var e=Yt;e.classList.add("glowFind")}function L(){wt&&R(),P();var e=Ft.view.Events.Key.Entry.QuickFind.Context;C()!=e&&(Dt=C());var t=bt.querySelector("#quickFind");t.select(),y(Gt.Entry.QuickFind.Context);var i=bt.querySelector(".mainGrid");i.addEventListener("click",K),bt.addEventListener("mousedown",q),""!=t.value&&(dt.innerText=""==Zt?"":Xt+"/"+Zt,x())}function _(){var e;if(vt)switch(e=""==vt.id?vt.parentNode.id:vt.id){case"quickFindMoreIcon":case"quickFind_wb":case"quickFind_sheet":case"quickFind_row":case"quickFind_col":case"quickFind_range":case"quickPrev":case"quickNext":return void b()}y(Dt);var t=bt.querySelector(".mainGrid");t.removeEventListener("click",K),bt.removeEventListener("click",q),dt.innerText=""}function T(e,t){var i,n;-1===e.row||-1===e.col?i=0:e.nom?(i=e.nom,n=e.ma):(i=Zt,t?(n=Xt+1,n>i&&(n=1)):(n=Xt-1,1>n&&(n=i))),x(),i||jt.show(),Zt=i,Xt=n,dt.innerText=""==Zt||""==Xt?"":Xt+"/"+Zt}function U(e,t){switch(V(),t.data.id){case"quickFind_range":Pt="range",ut.placeholder=ei.range,qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!1),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",!1);break;case"quickFind_wb":Pt="workbook",ut.placeholder=ei.wb,qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!1),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!1);break;case"quickFind_sheet":Pt="sheet",ut.placeholder=ei.sheet,qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!1),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",!1);break;case"quickFind_more":$t.openDialog()}}function O(){var e=bt.getElementById("popupmenu"),t=bt.createElement("ul");t.id="quickFindMenu",t.setAttribute("data-ctype","zmenu"),t.setAttribute("data-content-type","icon-text");for(var i in ei){var n=bt.createElement("li");if(n.id="quickFind_"+i,n.textContent=ei[i],"more"==i){var r=bt.createElement("li");r.setAttribute("mtype","separator"),t.appendChild(r)}else"sheet"==i?(n.setAttribute("data-item-type","checkbox"),n.setAttribute("data-checked",!0)):n.setAttribute("data-item-type","checkbox");t.appendChild(n)}e.appendChild(t),qt.bind(t,"zmenushow",function(){var e=parseInt(t.style.left),i=parseInt(t.style.width);Ht?Ht&&""===ut.value&&(t.style.left=e+i-40+"px"):t.style.left=e+i-50+"px";var n=parseInt(t.style.top);t.style.top=n+10+"px"}),qt.bind(t,"zmenuitemclick",function(e,t){U(e,t)})}function M(){gt.style.display="none",ft.style.display="none"}function x(){gt.style.display="",ft.style.display=""}function B(){""==ut.value?M():x(),dt.innerText="",Zt="",V()}function G(){if(Yt){Jt=!0;var e=Mt.getTemplate(["QUICK_FIND"]),t=e.QUICK_FIND,i=t.querySelector("#tbholder");ut=t.querySelector("#quickFind"),ut.placeholder=ei.sheet,i.addEventListener("click",L),ut.addEventListener("blur",_),ut.addEventListener("input",B),dt=t.querySelector("#quickCount"),ft=t.querySelector("#quickNext"),ft.addEventListener("click",function(e){z(e,!0)}),gt=t.querySelector("#quickPrev"),gt.addEventListener("click",function(e){z(e,!1)}),M(),Yt.appendChild(t),O();var n=bt.querySelector(".shFindBarIcon");n.setAttribute("data-menu-id","quickFindMenu")}}function V(){Qt=!0}function W(){Qt=!1}function z(e,t){var i=bt.querySelector("#quickFind"),n={findString:i.value,replaceString:"",isNext:t,matchCase:!1,matchCell:!1,searchIn:Pt};H(e,n),W()}function P(){if(Jt){var e=Ft.view.getActiveGridID(),t=Ft.view.getResourceID(e),i=Ft.view.getSheetID(e),n=Ft.view.getVersionID(e),r=Ft.view.getSheetState(e,i),c=r.getActiveRange(),a=Pt;Kt||"workbook"!=a?"sheet"==Pt&&(Kt=!1):Kt=!0;var s=Ft.data.getWorkBook(t,n),l=s.getSheetObj(i),u=l.Merge.isXists(c.startRow,c.startCol)&&l.Merge.isXists(c.endRow,c.endCol);u||c.isSingle()?"range"==Pt&&(Kt?(ut&&(ut.placeholder=ei.wb),Pt="workbook"):(ut&&(ut.placeholder=ei.sheet),Pt="sheet"),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!1),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",Kt),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!Kt)):(ut.placeholder=ei.range,Pt="range",qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",!1),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!0),qt.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!1),o()),a!=Pt&&V()}}function K(){ut.removeEventListener("blur",_),M(),setTimeout(function(){P()},100),dt.innerText="",Ht=!1,ut.blur(),V();var e=Yt;e.classList.remove("glowFind"),y(Dt);var t=bt.querySelector(".mainGrid");t.removeEventListener("click",K),bt.removeEventListener("click",q),ut.addEventListener("blur",_)}function H(e,t){pt=!1;var i=Ft.view.getActiveGridID(),n=Ft.view.getResourceID(i),r=Ft.view.getVersionID(i),o=Ft.view.getSelectedSheets(i);!ht||-1!=ht.row&&-1!=ht.col||(ht=void 0);var c=Ft.view.getSheetID(i),s=Ft.view.getSheetState(i,c),l=s.getActiveRange();l.isColRange()||l.isRowRange()||(It=l),Vt&&u(),!t&&a("INFOBANNER");var d=t?t:g(),v=t?!0:!1;Mt.Find(n,c,o,r,d.findString,d.isNext,d.matchCase,d.matchCell,h(d.searchIn),ht,v,Qt)}function Q(){pt=!0;var e=Ft.view.getActiveGridID(),t=Ft.view.getResourceID(e),i=Ft.view.getVersionID(e),n=Ft.view.getSelectedSheets(e),r=Ft.view.getSheetID(e);Vt&&u(),a("INFOBANNER");var o=g();Mt.Replace(t,r,n,i,o.findString,o.replaceString,o.isNext,o.matchCase,o.matchCell,h(o.searchIn))}function X(){var e=Ft.view.getActiveGridID(),t=Ft.view.getResourceID(e),i=Ft.view.getVersionID(e),n=Ft.view.getSelectedSheets(e),r=g();Vt&&u(),a("INFOBANNER"),Mt.ReplaceAll(t,n,i,r.findString,r.replaceString,r.isNext,r.matchCase,r.matchCell,h(r.searchIn))}var Z,J,j,Y,$,et,tt,it,nt,rt,ot,ct,at,st,lt,ut,dt,vt,ft,gt,ht,It,St,pt,kt,wt,Dt,Ft=e.sPlusPlus,Nt=e.ZSEvents,mt=e.ZSClass,At=e.JSUtil,Et=Nt.topic,Ct=Nt.Groups,yt=Nt.Names,bt=e.document,qt=e.UIUtil.Component,Rt=e.ZSConstants,Lt=Rt.FeatureConstants,_t=Rt.I18N,Tt=Rt.wCC,Ut=Rt.JSKeyCode,Ot=Rt.ActionConstants,Mt=e.UserAction,xt=(Ft.SML.Client,mt.Editors),Bt=mt.Range,Gt=Ft.view.Events.Key,Vt=0,Wt=!1,zt=!1,Pt="sheet",Kt=!1,Ht=!1,Qt=!0,Xt="",Zt="",Jt=!1,jt=new mt.TBNotification(_t["Find.NoDataFound"],{type:"error"}),Yt=bt.querySelector(".shFindBar"),$t=Ft.view.Toolbar.Feature[Lt.FIND],ei={range:_t["Find.SearchInRange"],sheet:_t["Find.SearchInSheet"],wb:_t["Find.SearchInWorkbook"],more:_t["Find.MoreOptions"]+"..."};$t.openDialog=t;var ti;$t.quickFind=b,Et.register(Ct.UI,yt.Layout.TEMPLATE_LOADED,G),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.QUICKFIND,z,"ev","isNext"),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.BLURQUICKFIND,K),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.FOCUSQUICKFIND,L),Et.register(Ct.Selector.DomUpdate.Range,yt.Selection.BOUND_UPDATE.ADD,P),Et.register(Ct.Listener,yt.CellAction.VALUE.FIND.QUICKCOUNTUPDATE,T,"resp","isNext")}(this);
!function(e){function t(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),n=S.view.getSheetID(e),i=S.view.getVersionID(e),r={model:!0,width:320,title:E.MoveThisSheet};d||(o(t,n,i),d=new g.Dialog(v,r));var l=v.querySelector("#newLocMsg"),s=S.data.getWorkBook(t,i),c=s.SheetList.getById(n).Name,u=JSUtil.fn.replaceParams(E.NewLocation,[c]);l.innerText=u,a(t,n,i),d.open()}function o(t,o,n){var i=e.UserAction.getTemplate(["MOVE_SHEET"]),r=i.MOVE_SHEET;l(r,t,o,n),v=document.createElement("div"),v.id="DI_SHEET_RENAME",v.appendChild(r)}function n(e){var t=M.cloneNode();t.title=E.MoveEnd,t.value="MoveEnd",t.innerText=E.MoveEnd,e.appendChild(t)}function i(e){var t=M.cloneNode();t.title=E.MoveStart,t.value="MoveStart",t.innerText=E.MoveStart,e.appendChild(t)}function r(e,t,o){for(var n=0;n<t.length;n++)if(n!=o-1&&n!=o){var i=t[n].Name,r=t[n].Id,a=M.cloneNode();a.title=i,a.value=r,a.innerText=i,e.appendChild(a)}}function a(e,t,o){var a=S.data.getWorkBook(e,o),l=(a.getSheetObj(t),a.SheetList),s=a.SheetList.getSheets(),c=l.getPosById(t),d=s.length,g=v.querySelector("#moveDlgSelect");if(g.innerHTML="",c>0&&i(g),c!=d-1&&n(g),d>2){var E=document.createElement("optgroup");E.label="or After",E.setAttribute("mtype","group"),r(E,s,c),g.appendChild(E)}C?u.zcombo(g,"refresh"):C=!0}function l(e,t,o,n){var i=e.querySelector("#moveDlgOk");i.addEventListener("click",c.bind(this,t,o,n));var r=e.querySelector("#moveDlgCancel");r.addEventListener("click",s)}function s(){d.close()}function c(t,o,n){var i,r=S.data.getWorkBook(t,n),a=(r.getSheetObj(o),S.view.getActiveGridID()),l=r.SheetList,c=l.getSheets(),d=v.querySelector("#moveDlgSelect"),g=u.zcombo(d,"getValue"),E=0;if("MoveEnd"==g)E=c.length-1,i=l.getByPos(E).Id;else if("MoveStart"==g)E=0,i=l.getByPos(E).Id;else{E=l.getPosById(g,!0);var h=l.getPosById(o,!0);h>E&&E++,i=g}var l=S.view.getSelectedSheets(a);e.UserAction.MoveSheet(t,l,n,E),p.publish(m.Listener,f.DocMeta.SCROLL_SHEET,{RID:t,SHEETID:i,VERSION:n}),s()}var d,v,S=e.sPlusPlus,u=(e.document,e.UIUtil.Component),g=e.ZSClass,E=(e.ZSConstants.FeatureConstants,e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),h=(e.ZSConstants.wCC,e.ZSEvents),p=(g.Editors.TextAreaEditor,g.Editors.Utility,h.topic),m=h.Groups,f=h.Names,I=S.view.Toolbar.Feature.MOVE_SHEET,C=!1,M=document.createElement("option");I.openDialog=t}(this);
!function(e){function t(e,t){p=t;var i=s.view.getActiveGridID(),l=s.view.getResourceID(i),a=(s.view.getSheetID(i),s.view.getVersionID(i)),d=s.view.getSelectedSheets(i),h={width:570,open:function(){n()},close:function(){o()},title:S.ZohoSheet};u||(r(),u=new ZSClass.Dialog(v,h)),u.open(),v.querySelector("#okBtn").addEventListener("click",function(){c(l,d,a,e)}),v.querySelector("#clBtn").addEventListener("click",function(){u.close()})}function o(){var e=v.querySelector("#includeSheets");e.checked&&(e.checked=!1)}function i(){for(var e=v.querySelector("#sheetsList"),t=v.querySelectorAll("#sheetsList li"),o=0;o<t.length;o++)e.removeChild(t[o])}function n(){i();for(var e=v.querySelector("#sheetsList"),t=0;t<p.length;t++){var o=a.createElement("li");o.innerText=p[t],e.appendChild(o)}}function c(t,o,i,n){var c=s.view.getActiveGridID(),r=s.data.getWorkBook(t,i),l=s.view.getSheetID(c),a=r.getSheetObj(l),d=a.Prop.Name,S=v.querySelector("#includeSheets");"sdoc"==n?S.checked?UserAction.serverClipCopytoNewSheet(t,o,i,d,!0):UserAction.serverClipCopytoNewSheet(t,o,i,d,!1):"ddoc"==n&&(S.checked?e.UserAction.PasteSheet(t,o,i,d,!0):e.UserAction.PasteSheet(t,o,i,d,!1)),u.close()}function r(){var t=e.UserAction.getTemplate(["copyRefSheets"]),o=t.copyRefSheets;v=a.createElement("div"),v.id="DI_PASTESHEET",v.appendChild(o)}var s=e.sPlusPlus,l=e.ZSConstants,a=e.document,d=(l.FeatureConstants,e.UserAction,e.ZSEvents),S=(d.topic,d.Groups,d.Names,e.ZSConstants.I18N),h=s.view.Toolbar.Feature.PASTE_SHEET,u=void 0,v=void 0,p=void 0;h.openDialog=t}(this);
!function(e){function t(){O.call(this)}function n(){var e=T.view.Events.Key;e.focusContext(Y)}function a(){$.focusContext($.Entry.CellEditor.Context)}function l(){var e=H.getTemplate(["dcIcon"]);this.icon.appendChild(e.dcIcon);var t=F["MenuItem.DataTab.DC"]||"Data Cleaning";this.icon.setAttribute("title",t)}function i(){x||(I=Z.add({onCreate:l,callBack:u,allowed:V,direction:B}),I.onOpen=o,I.onClose=d,I.hide(),I.panel.addEventListener("click",n),x=!0)}function s(){I&&(D(),I&&I.toggle(),I.alive||(h(),S(),I.hide(),X=!1,global.SA.Controller.SheetAppUIController.close()))}function r(){I&&(I.show(),I.open(),X=!0)}function o(){c("block"),W.highlightCurrentColumn(),M.Right.sidePanel=350,this.holder.setWidth(350),n(),J=!0,X=!0}function c(e){if(j){var t=I.panel.querySelector("#sPDcNtf");t.style.display=e}Q&&(N.style.display=e)}function d(){var e=T.view.getActiveGridID(),t=T.view.getVersionID(e),n=T.view.getResourceID(e),l=T.view.getSheetID(e);b.publish(K.Listener,q.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:n,SHEETID:l,VERSION:t,RANGEIDS:[200]}),c("none"),M.Right.sidePanel=0,I.holder.setWidth(0),a(),J=!1,y("")}function u(){N=document.createElement("span"),N.classList.add("ZsLoader"),N.style.display="none",this.panel.appendChild(N);var e=H.getTemplate(["DC_SP_HDR"]);this.panel.appendChild(e.DC_SP_HDR);var t=H.getTemplate(["DC_RANGE_TEMPLATE"]);this.panel.appendChild(t.DC_RANGE_TEMPLATE),this.panel.classList.add("sPDatCln"),v()}function p(e){var t=document.createElement("DIV");t.id="sPDcNtf",t.classList.add("spDatantfy"),t.style.display="none";var n=document.createElement("p");n.classList.add("fnt13"),n.innerHTML=F["SidePanel.DataCleaning.Datachanged"];var a=document.createElement("DIV");a.className+="wid wid100 mt20";var l=document.createElement("a");l.addEventListener("click",S),l.style.color="#2da1ef",l.className+="fnt13 flt_left dsp_Blk mt5 curPtr",l.innerHTML=F["SidePanel.DataCleaning.Ignore"];var i=document.createElement("button");return i.addEventListener("click",function(){S(),e()}),i.className+="Zsbtn ZsbtnInfo flt_right",i.innerHTML=F["SidePanel.DataCleaning.Regenerate"],a.appendChild(l),a.appendChild(i),t.appendChild(n),t.appendChild(a),I.panel.appendChild(t),t}function E(){j=!0;var e=I.panel.querySelector("#sPDcNtf");e&&(e.style.display="block")}function S(){j=!1;var e=I.panel.querySelector("#sPDcNtf");e&&(e.style.display="none")}function y(e){m&&(m.value=e)}function C(){return m?m.value:void 0}function g(){N&&J&&(Q=!0,N.style.display="block")}function h(){N&&(Q=!1,N.style.display="none")}function v(){var e=I.panel,t=e.querySelector("#dcBtns"),n=t.children,a=n[1].children;n[0].addEventListener("click",f),a[0].addEventListener("click",A),a[1].addEventListener("click",D);var l=e.querySelector("#dcCellRef");e.querySelector(".zsRangePicker").classList.add("zRDisable"),m=new U.Editors.RangeEditor(l),U.RangePicker.register(m,!0),e.querySelector("#dcPanelClose").addEventListener("click",W.togglePanel)}function f(){var e=I.panel;e.querySelector("#dcSrc").classList.add("editRange"),e.querySelector(".zsRangePicker").classList.remove("zRDisable"),e.querySelector("#dcCellRef").focus(),this.style.display="none",e.querySelector("#dcSaveCnl").style.display=""}function D(){var e=I.panel;e.querySelector("#dcSrc").classList.remove("editRange"),e.querySelector("#dcSaveCnl").style.display="none",e.querySelector("#dcEdit").style.display="",e.querySelector(".zsRangePicker").classList.add("zRDisable")}function A(){var e=I.panel;e.querySelector("#dcSrc").classList.remove("editRange"),e.querySelector(".zsRangePicker").classList.add("zRDisable"),this.parentNode.style.display="none",e.querySelector("#dcEdit").style.display="",b.publish(G.UI,q.SidePanel.DATACLEANING.UPDATE_RANGE,{RANGE:m.value}),3!=global.SA.Controller.SheetAppUIController.getOperationMenuValue()&&4!=global.SA.Controller.SheetAppUIController.getOperationMenuValue()&&W.cleanseData(W.ACTION_FIX_MISSPELLING,null,!0,m.value)}function R(){return I.panel}function L(){return J}function P(){L()&&s(),X&&I.hide()}var I,N,m,T=e.sPlusPlus,_=e.ZSEvents,b=_.topic,G=_.Groups,q=_.Names,k=e.ZSConstants,w=k.FeatureConstants,H=e.UserAction,U=e.ZSClass,M=T.view.measures,O=U.KeyMapping,U=e.ZSClass,Z=U.SidePanel,z=U.SidePanelClassList,V=[z.right,z.left,z.bottom],B=z.right,F=(e.ZSConstants.JSKeyCode,U.Editors,k.I18N),_=e.ZSEvents,b=_.topic,K=_.Groups,q=_.Names,W=T.view.Toolbar.Feature[w.DATA_CLEANING],x=!1,J=!1,X=!1,j=!1,Q=!1,Y=new t,$=T.view.Events.Key;$.Entry.RightPane.Node.addChildNode(Y),W.initPanel=i,W.openPanel=r,W.togglePanel=s,W.setRange=y,W.getRange=C,W.getPanel=R,W.isOpen=L,W.showLoader=g,W.hideLoader=h,W.showNotification=E,W.hideNotification=S,W.constructBanner=p,b.register(G.UI,q.SidePanel.DATACLEANING.SHOW_LOADER,g),b.register(G.UI,q.SidePanel.DATACLEANING.HIDE_LOADER,h),b.register(G.UI,q.SidePanel.DATACLEANING.UPDATE_RANGE,W.setRange,"RANGE"),b.register(K.UserAction,q.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,P)}(this);
!function(e){function t(){w=k.add({onCreate:n,callBack:i,allowed:q,direction:Z}),w.onOpen=r,w.onClose=s,w.hide()}function i(){if(!V){var e=UserAction.getTemplate([_]);V=e[_]}this.panel.appendChild(V),m=this.panel.querySelector("#titleVersion");var t=this.panel.querySelector("#settings"),i="SP_VERSION_SETTINGS";t.setAttribute("data-menu-id",y.SUBMENUITEM+i+y.IDENTITY);var n={id:y.SUBMENUITEM+i+y.IDENTITY,"data-ctype":"zmenu","data-content-type":"icon-text"},r=[{data:'{"label": "'+O["AT.ShowAllVersions"]+'", "type":0 }',"data-item-type":"checkbox",checked:!0},{data:'{"label": "'+O["AT.ShowNamedVersions"]+'", "type":1}',"data-item-type":"checkbox"}],s=this;B||(D.view.Menu.create(r,n,P).then(function(){var e=document.querySelector("#"+y.SUBMENUITEM+i+y.IDENTITY),t=e.children[0];U.bind(e,"zmenuitemclick",function(e,n){U.zmenu("#"+y.SUBMENUITEM+i+y.IDENTITY,"setMenuItemsAttribute",[t],"checked",!1),t=n.menuitem,U.zmenu("#"+y.SUBMENUITEM+i+y.IDENTITY,"setMenuItemsAttribute",[t],"checked",!0);var r=n.menuitem.data(),o=1==~~r.metadata.type?!0:!1,a=D.view.getActiveGridID(),d=D.view.getResourceID(a),c=D.view.getVersionID(a);UserAction.getVersionDetails(d,c,o,u.bind(s))})}),B=!0);var a=this.panel.querySelector("#hgtChanges");a.addEventListener("click",o);var d=this.panel.querySelector("#version");d.innerHTML="",d.appendChild(Y),T=this.panel.querySelector("#versionClose"),T.addEventListener("click",function(){{var e=D.view.getActiveGridID(),t=D.view.getVersionState(e);t.isCloseButton()}c()})}function n(){var e=UserAction.getTemplate(["versionIcon"]);this.icon.appendChild(e.versionIcon),this.icon.title=O.VersionHistory}function r(){R.Right.sidePanel=330,this.holder.setWidth(330)}function s(){R.Right.sidePanel=0,this.holder.setWidth(0)}function o(){var e=D.view.getActiveGridID(),t=D.view.getVersionState(e),i=t.getActiveVersionLog(),n=i.getVersionNumber();if(n!==D.data.Defaults.version){var r=t.getHighlightVersionChanges();r=!r,t.setHighlightVersionChanges(r),r?L.publish(N.UI,f.SidePanel.VersionHistory.HIGHLIGHT_CHANGES):L.publish(N.UI,f.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES)}}function a(){{var e=D.view.getActiveGridID();D.view.getVersionState(e)}L.publish(N.UI,f.SidePanel.VersionHistory.HIGHLIGHT_CHANGES)}function d(e,t,i){L.register(N.Listener,f.DocAction.WORKSHEETS.SWITCHSHEET,a,"NEWSHEETID","RID","VERSION"),w.show(),w.open();var n=w.panel.querySelector("#version");n&&(n.innerHTML="",n.appendChild(Y));var r=D.view.getActiveGridID(),e=D.view.getResourceID(r),s=D.view.getVersionID(r);UserAction.getVersionDetails(e,s,!1,function(e){u.call(w,e,z,F)}),z=t,F=i}function c(){L.unregister(N.Listener,f.DocAction.WORKSHEETS.SWITCHSHEET,a),w.close();var e=D.view.getActiveGridID(),t=D.view.getVersionID(e);t===D.data.Defaults.version&&w.hide()}function l(){w.showOthers(),w.hide()}function v(){w.hideOthers(),w.show()}function u(e,t,i){var n=e.length,r=this.panel.querySelector("#version");r.innerHTML="",n||(x.textContent="There were no Version History for this SpreadSheet",r.appendChild(x));var s=D.view.getActiveGridID(),o=D.view.getVersionState(s);o.clearVersionLogMap();var a=0;if(e[0]){e[0].ver||(a=1);var d=h(r,G.CurrentVersionLogBinds);d.addEventListener(G.ChangeLogBinds);var c=D.view.getVersionID(s);c!=D.data.Defaults.version&&d.dom.click(),o.addVersionLog(d),o.setActiveVersionLog(d),I()}for(var l=a;n>l;l++){var d=E(r,e[l],G.VersionLogBinds);d.addEventListener(G.ChangeLogBinds),o.addVersionLog(d)}i&&S(t,i,o)}function I(){var e=D.view.getActiveGridID(),t=D.view.getVersionState(e),i=t.isCloseButton();i?T.classList.remove("vHBack"):T.classList.add("vHBack")}function g(){var e=D.view.getActiveGridID(),t=D.view.getResourceID(e),i=D.view.getVersionID(e),n=D.data.getWorkBook(t,i);n.isEditable()?w.showOthers():v()}function S(e,t,i){var n,r=i.getVersionLogMap();if(e){if(n=r[e]){var s=new Event("click");s.data={version:e,range:t},n.dom.dispatchEvent(s),n.dom.scrollIntoView()}}else{for(var o in r){n=r[o];break}n&&(n.dom.click(),n.dom.scrollIntoView())}}function h(e,t){var i=new b;return i.setVersionNumber(sPlusPlus.data.Defaults.version),i.append(e),i.addEventListener(t),i}function E(e,t,i){var n=new M;return n.setTime(t.ts),t.ver&&n.setVersionNumber(t.ver),t.r_v_no?n.addRevertVersion(t.r_v_no,t.vl):t.vl&&n.setDescription(t.vl),n.setUserNameAndColor(t.al),n.append(e),n.addEventListener(i),n}function p(e){m.textContent=e?" #"+parseFloat(e):""}var V,T,m,w,D=e.sPlusPlus,H=e.ZSEvents,L=H.topic,N=H.Groups,f=H.Names,C=e.ZSConstants.FeatureConstants,A=D.view.Toolbar.Feature[C.VIEW_VERSION],U=e.UIUtil.Component,y=e.ZSConstants.wCC,O=e.ZSConstants.I18N,P=document.getElementById("popupmenu"),R=D.view.measures,G=e.ZSClass,M=G.UIVersionLog,b=G.UICurrentVersionLog,_="SP_VERSION",B=!1,k=G.SidePanel,W=G.SidePanelClassList,q=[W.right,W.left,W.bottom],Z=W.right,Y=e.document.createElement("span");Y.className="ZsLoader ZsLoaderSmall";var x=e.document.createElement("span");x.classList.add("ZsNoMsg");var z,F;A.openPanel=d,L.register(N.UI,f.SidePanel.VersionHistory.OPEN,d,"RID","VERSION","RANGE"),L.register(N.UI,f.SidePanel.VersionHistory.CLOSE,c),L.register(N.UI,f.Layout.TEMPLATE_LOADED,t),L.register(N.UI,f.SidePanel.VersionHistory.UPDATE_TITLE,p,"VERSION_NUMBER"),L.register(N.UI,f.SidePanel.VersionHistory.HIDE_ICON,l),L.register(N.UI,f.Toolbar.VERSION_HISTORY.SHOW,v),L.register(N.Listener,f.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE,g)}(this);
!function(t){function e(t){this.data=t,this.next=null}function i(){this.head}i.prototype={add:function(t){var i=new e(t);if(this.isEmpty())return void(this.head=i);for(var n=this.head;n.next;)n=n.next;n.next=i},remove:function(t){if(!this.isEmpty())for(var e=this.head,i=null;e;){if(e.data===t)return this.removeNode(i,e),e;i=e,e=e.next}},removeNode:function(t,e){null==t?this.head=this.head.next:t.next=e.next},isEmpty:function(){return!this.head}},t.ZSClass.SingleLinkedList=i}(this);
!function(t){function e(){this.length=0}var n=t.ZSClass.SingleLinkedList;e.prototype=Object.assign({},n.prototype),e.prototype.insert=function(t){this.add(t),this.length++},e.prototype.delete=function(t){var e=this.remove(t);return this.length--,e},e.prototype.getSize=function(){return this.length},e.prototype.findAndInsertAtEnd=function(t){for(var e=this.head,n=null;e;){if(e.data===t)return this.removeNode(n,e),this.add(t),!0;n=e,e=e.next}return!1},e.prototype.deleteFirst=function(){return this.delete(this.head.data)},t.ZSClass.LinkedListExtended=e}(this);
!function(t){function i(t){this.frameSize=t,this.list=new e}var e=t.ZSClass.LinkedListExtended;i.prototype={add:function(t){var i=this.list.findAndInsertAtEnd(t);if(!i){var e,s=this.list.getSize();return s>=this.frameSize&&(e=this.list.deleteFirst()),this.list.insert(t),e}},removeFirst:function(){var t=this.list.getSize();t>0&&this.list.deleteFirst()},removeAll:function(){for(var t=this.list.getSize(),i=0;t>i;i++)this.removeFirst()},getListAsArray:function(){for(var t=this.list.getSize(),i=[],e=this.list.head,s=0;t>s;s++)i.push(e.data),e=e.next;return i}},t.ZSClass.PageReplacement=i}(this);
!function(e){function i(){var e=s.view.getActiveGridID(),i=s.view.getVersionState(e);if(i.getHighlightVersionChanges()){var t,r=s.view.getResourceID(e),o=s.view.getSheetID(e),v=s.view.getVersionID(e),l=i.getVersionActionList(),h=l[o];for(var D in h)if(i.isEditAction(h[D].a)){var E=h[D].lp.length;t=h[D].lp[E-1];var H=JSUtil.Range.parseRange(r,v,t),t=H.range,S=H.sheetID,c=JSUtil.Math.hash(t.startRow,t.startCol,I);n.publish(a.Listener,g.Layers.HighlightVersion.Place,{RID:r,SHEETID:S,VERSION:v,RANGEID:c,RANGE:t,COLORCODE:h[D].cc,USER_NAME:h[D].un})}}}function t(){var e=s.view.getActiveGridID(),i=s.view.getResourceID(e),t=s.view.getSheetID(e),r=s.view.getVersionID(e);n.publish(a.Listener,g.Layers.HighlightVersion.RemoveAll,{RID:i,SHEETID:t,VERSION:r})}var s=e.sPlusPlus,r=e.ZSEvents,n=r.topic,a=r.Groups,g=r.Names,o=s.data.Defaults,I=o.MAX_COL;n.register(a.UI,g.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES,t),n.register(a.UI,g.SidePanel.VersionHistory.HIGHLIGHT_CHANGES,i)}(this);
!function(e){function t(){Y.call(this)}function n(){var e=H.getTemplate(["functionIcon"]);this.icon.appendChild(e.functionIcon),this.icon.setAttribute("data-shortcutkey","Shift+F3"),this.icon.title=K["Formulas.Function"]}function i(){z=ct.add({onCreate:n,callBack:d,allowed:ut,direction:dt}),z.onOpen=s,z.onClose=c}function o(){z&&z.toggle()}function r(){z&&z.open()}function s(){k.Right.sidePanel=320,this.holder.setWidth(320),P&&P.focus(),M.register(b.Listener,Z.DocAction.DELUGE_FUNCTIONS.INSERT,A,"RID","VERSION","DELUGE"),M.register(b.Listener,Z.DocAction.DELUGE_FUNCTIONS.REMOVE,N,"RID","VERSION","DELUGE")}function a(){var e=x.view.Events.Key;e.focusContext(W)}function c(){k.Right.sidePanel=0,this.holder.setWidth(0),l(),M.unregister(b.Listener,Z.DocAction.DELUGE_FUNCTIONS.INSERT,A),M.unregister(b.Listener,Z.DocAction.DELUGE_FUNCTIONS.REMOVE,N)}function l(){var e=x.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function u(){var e=st.editor.value;at.classList.remove("noHelp"),st.suggest(e.toUpperCase()),rt.reset(),rt.select(),""==st.container.innerHTML&&(at.classList.add("noHelp"),st.container.appendChild(L("No matches found",!1)))}function d(){if(!R){var e=H.getTemplate([vt]);R=e[vt]}this.panel.appendChild(R),this.panel.addEventListener("mousedown",a),j=this.panel.querySelector("#fnName");var t=this.panel.querySelector("#helpContainer");Q=t.querySelector("#fnDesc"),$=t.querySelector("#syntaxDesc"),et=t.querySelector("#argDesc"),tt=t.querySelector("#desc"),nt=t.querySelector("#addInfo"),ot=this.panel.querySelector("#readMore"),it=t.querySelector("#funDesc");var n=this.panel.querySelector(".spClsIcon");n.addEventListener("click",function(){this.close()}.bind(this)),at=this.panel.querySelector("#functionData"),g(at),_.initComponent("#functionData"),_.bind(w,"zselectboxchange",function(){at.classList.remove("noHelp");var e=w.value;if(st.suggest("",e),rt.reset(),rt.select(),this.value==K["Deluge.Title"]&&""==st.container.innerHTML){at.classList.add("noHelp");var t=x.data.UserInfo.Permission;st.container.appendChild(0==t.isCoOwner&&1==t.isSharable?L(K["Deluge.Owner.EmptyState"],!0):L(K["Deluge.Collabarator.EmptyState"],!1))}})}function v(){_.zcombo("#"+w.id,"setValue","All")}function E(e){var t=JSUtil.Key.getKeyCombination(e);switch(t){case V.SUPER+"+"+V.ENTER:rt.insert(),e.stopPropagation(),e.preventDefault();break;case V.UP:rt.decrement(),rt.select(),e.stopPropagation(),e.preventDefault();break;case V.DOWN:rt.increment(),rt.select(),e.stopPropagation(),e.preventDefault()}}function g(t){function n(){f();var t=e.ZSConstants.Function,n=t.commonlyused,i=st.getCategory(K["FunctionCategory.CommonlyUsed"]),o=t.functions;for(var r in o){var s=o[r],a=s[gt.CATEGORY],c=st.getCategory(a),l=document.createElement("div"),u=s[0],d=new q.AutoSuggest.Entry(l,r,S,p);m(l,d,s[0],a),c.addEntry(u,d),-1!=n.indexOf(r)&&i.addEntry(u,d)}}var i=t.querySelector(".fnSrch>input");P=new q.Editors.TextAreaEditor(i),P.addListeners({input:v,keydown:E});var o=t.querySelector(".fnRs");w=t.querySelector("select#category"),F=t.querySelector(".fnHlp");var r=t.querySelector("button#insert");r.addEventListener("click",function(){O.onInsert(O)}),o.addEventListener("keydown",E);var s={active:28,inActive:28,container:200};rt=new q.AutoSuggest.selector(o,s),st=new q.AutoSuggest.Search(o,P,w,rt),n(ZSConstants.Functions),M.register(b.Listener,Z.DocAction.FUNCTIONS.FETCH,n,"JSON");var c=x.view.getActiveGridID(),l=x.view.getResourceID(c),d=x.data.DocRegistry[l].delugeFunctions&&x.data.DocRegistry[l].delugeFunctions.getMap(),g=K["Deluge.Title"],h=st.getCategory(g);for(var D in d){var I=document.createElement("div"),L=new q.AutoSuggest.Entry(I,D,C,y);m(I,L,D,g),h.addEntry(D,L)}var T=st.list;st.select.addEventListener("change",function(){st.suggest("",T[this.value])});var R={input:u,focus:u};st.editor.addListeners(R),M.register(b.Listener,Z.DocAction.DELUGE_FUNCTIONS.INSERT,A,"RID","VERSION","DELUGE"),M.register(b.Listener,Z.DocAction.DELUGE_FUNCTIONS.REMOVE,N,"RID","VERSION","DELUGE"),w.value=K["FunctionCategory.All"],st.suggest("",K["FunctionCategory.All"]),O=rt.active,rt.reset(),rt.select(),U||(P.focus(),a()),U=!1}function f(){var t;if(e.text=t=st.list,t)for(var n in t)if(n!=K["Deluge.Title"]){var i=st.getCategory(n);st.flush(i)}}function p(e){e=e?e:this;var t=x.view.getActiveGridID(),n=x.view.getResourceID(t),i=x.view.getSheetID(t),o=x.view.getVersionID(t),r=ZSConstants.Function.functions,s=r[e.text];M.publish(b.Listener,"InsertFunction",{RID:n,SHEETID:i,VERSION:o,FUNCTION:s[gt.NAME]})}function S(){var e=this;O&&O.dom.classList.remove("active"),e.dom.classList.add("active"),O=e,I(e.text)}function C(){var e=this;O&&O.dom.classList.remove("active"),e.dom.classList.add("active"),O=e;var t=x.view.getActiveGridID(),n=x.view.getResourceID(t),i=x.data.DocRegistry[n].delugeFunctions,o=i.get(e.text),r=e.text;j.textContent=r,Q.textContent=o.description||"MY TEST DESCRIPTION";var s=o.returntype,a=o.arguments,c="",l=(document.createDocumentFragment(),0);if(null!=a)for(var u=a.length,l=0;u>l;l++){var d=a[l];c+=d.type+" "+d.name,l!=u-1&&(c+=",")}$.textContent=s+" "+r+"("+c+")",tt.style.display="none",it.style.display="none"}function y(){var e=this,t=x.view.getActiveGridID(),n=x.view.getResourceID(t),i=x.view.getSheetID(t),o=x.view.getVersionID(t);M.publish(b.Listener,"InsertFunction",{RID:n,SHEETID:i,VERSION:o,FUNCTION:"_"+e.text})}function h(){if(!Et){var e=H.getTemplate(["ARG_DESC"]);Et=e.ARG_DESC}return Et.cloneNode(!0)}function D(e,t){var n=h(),i=n.querySelector("p"),o=i.querySelector("#key");o.textContent=e+":";var r=i.querySelector("#value");return r.textContent=t,i}function I(e){var t=ZSConstants.Function.functions,n=t[e.trim()],i=n[gt.NAME];j.textContent=i,Q.textContent=n[gt.DESCRIPTION];var o=n[gt.MAX_ARGS],r=n[gt.NECESSARY],s="",a=document.createDocumentFragment(),c=0;if(nt.style.display="none",r&&r.length){var l=r[ft.NAMES],u=r[ft.DESCRIPTIONS],d=l[0],v=u[0],E=D(d,v);a.appendChild(E),s=l[0];for(var g=1,f=l.length;f>g;g++){var d=l[g],v=u[g];s+=", "+d;var E=D(d,v);a.appendChild(E)}c=l.length,tt.style.display="",it.style.display=""}else tt.style.display="none",it.style.display="none";ot.href="/sheet/functions#"+e;var p=n[gt.OPTIONAL];if(p&&p.length){var l=p[ft.NAMES],u=p[ft.DESCRIPTIONS];c+=l.length;var S=!1,C="";c!==o&&(S=!0,C="1");var y=0;if(!r.length){var d=l[0],v=u[0],E=D(d,v);a.appendChild(E),s=l[0],y=1,C="1"}for(var g=y,f=l.length;f>g;g++){var d=l[g];d+=C;var v=u[g];s+=", ["+d+"]";var E=D(d,v);a.appendChild(E)}if(S){for(var g=0,f=l.length;f>g;g++){var d=l[g];d+="2",s+=", ["+d+"]"}s+="..."}}var h=n[gt.EXTRA_PARAMS];if(h&&h.length){nt.innerHTML="";for(var g=0;g<h.length;g++){var I=document.createElement("div");I.classList.add("supFunc");var m=h[g],A=document.createElement("div");A.innerHTML=m[0],A.classList.add("fntBld","mt10"),nt.appendChild(A);for(var N=m[1],L=m[2],T=0;T<N.length;T++){var d=N[T],v=L[T],R=D(d,v);I.appendChild(R)}nt.appendChild(I)}nt.style.display=""}$.textContent=i+"("+s+")",et.innerHTML="",et.appendChild(a)}function m(t,n,i,o){t.innerText=i;var r=e.document.createElement("span");r.className="plus",t.setAttribute("category",o),r.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),n.insert(this)}),t.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),n.select(this)}),t.appendChild(r)}function A(e,t,n){var i=K["Deluge.Title"],o=st.getCategory(i),r=n[0],s=document.createElement("div"),a=new q.AutoSuggest.Entry(s,r,C,y);m(s,a,r,i),o.addEntry(r,a)}function N(e,t,n){for(var i=K["Deluge.Title"],o=st.getCategory(i),r=0;r<n.length;r++)o.deleteEntry(n[r],value);P.value="",st.suggest("","FunctionCategory.All"),_.zcombo(w,"setValue",K["FunctionCategory.All"]),rt.reset(),rt.select()}function L(e,t){var n=document.createElement("div");n.classList.add("emptyState","wid100","fnt12");var i=document.createElement("div");if(t){var o=document.createElement("span");o.classList.add("createDeluge","ZsLink","fnt14"),o.innerText="Create",o.addEventListener("click",function(){J.createInsertDialog(!1)}),i.appendChild(o)}var r=document.createElement("span");return r.classList.add("fnt14"),r.innerText=e,i.appendChild(r),n.appendChild(i),n}function T(e){U=!0,r(),st.suggest(e),rt.reset(),rt.select(),U=!1}var R,w,F,P,O,U,x=e.sPlusPlus,G=e.ZSEvents,M=G.topic,b=G.Groups,Z=G.Names,H=e.UserAction,q=e.ZSClass,_=e.UIUtil.Component,k=x.view.measures,V=e.ZSConstants.JSKeyCode,K=e.ZSConstants.I18N,q=e.ZSClass,Y=q.KeyMapping,B=e.ZSConstants.FeatureConstants,J=x.view.Toolbar.Feature[B.DELUGE],W=new t,X=x.view.Events.Key;X.Entry.RightPane.Node.addChildNode(W);var R,z,j,Q,$,et,tt,nt,it,ot,rt,st,at,q=e.ZSClass,ct=q.SidePanel,lt=q.SidePanelClassList,ut=[lt.right,lt.left,lt.bottom],dt=lt.right,vt="SP_FUNCTION_final";M.register(b.UI,Z.SidePanel.Function.toggle,o),M.register(b.UI,Z.SidePanel.Function.open,r),M.register(b.UI,Z.SidePanel.Function.open,r);var Et,gt={NAME:0,CATEGORY:1,DESCRIPTION:2,SHORT_DESCRIPTION:3,MAX_ARGS:4,NECESSARY:5,OPTIONAL:6,EXTRA_PARAMS:7},ft={NAMES:0,DESCRIPTIONS:1,DATATYPES:2},X=e.sPlusPlus.view.Events.Key,pt=X.Entry.ReadOnlyShortCut.Context,St=pt.keyDown,Ct=W.keyDown;Ct[V.SHIFT+"+"+V.F3]=o,St[V.SHIFT+"+"+V.F3]=o,M.register(b.UI,Z.Layout.TEMPLATE_LOADED,i),e.UserAction.functionSelection=T}(this),function(e){function t(){var e=s.view.Events.Key;e.focusContext(e.Entry.SpotLight.Context)}function n(){var e=s.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function i(){if(""==this.value)y.flush();else{var e=this.value;h.suggest(e.toUpperCase())}}function o(){d.style.display="",v.style.display="",t(),E.select()}function r(){d.style.display="none",v.style.display="none",n()}var s=e.sPlusPlus,a=e.document,c=e.ZSEvents,l=c.topic,u=c.Groups,d=(c.Names,a.createElement("div")),v=a.createElement("div"),E=a.createElement("input"),g=a.createElement("div"),f=a.createElement("select");d.className="spotlight",v.className="spotLightMask",g.className="results",E.placeholder="Search...",d.appendChild(E),d.appendChild(g),d.style.display="none",v.style.display="none";var p={active:32,inActive:32,container:300};v.addEventListener("mousedown",function(){r()},!0);var S={focus:function(e){i.call(this,e),t()},input:function(e){i.call(this,e)}},C=new ZSClass.Editors.TextAreaEditor(E),y=new ZSClass.AutoSuggest.selector(g,p),h=new ZSClass.AutoSuggest.Search(g,C,f,y);C.addListeners(S),function(){function e(e,t,n){e.innerHTML="Insert Function <b>"+n+"</b>",e.addEventListener("mousedown",function(){t.select(this)})}function t(t){var o=t.functions,r=h.getCategory("Functions");for(var s in o){var c=a.createElement("div"),l=new ZSClass.AutoSuggest.Entry(c,s,n,i);e(c,l,s),r.addEntry(s,l)}}function n(e){e.preventDefault(),e.stopPropagation(),r();var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=s.view.getSheetID(t),o=s.view.getVersionID(t);l.publish(u.Listener,"InsertFunction",{RID:n,SHEETID:i,VERSION:o,FUNCTION:this.text})}function i(){}ZSConstants.Function&&t(ZSConstants.Function)}(e),function(){function e(e,t,n){e.innerText=n,e.addEventListener("mousedown",function(){t.select(this)})}function t(){}var n=ZSConstants.FeatureConstants,i=h.getCategory("Features");for(var o in n)!function(o){var s=o,c=a.createElement("div"),l=new ZSClass.AutoSuggest.Entry(c,s,function(e){r(),e.preventDefault(),e.stopPropagation(),sPlusPlus.view.Toolbar.Feature[n[o]].execute(e)},t);e(c,l,s),i.addEntry(s,l)}(o)}(this),function(){function e(e,t,n){e.innerText=n,e.addEventListener("mousedown",function(){t.select(this)})}function t(){}var n="PRECEDANCE",i=a.createElement("div"),o=h.getCategory("Features"),c=new ZSClass.AutoSuggest.Entry(i,n,function(e){r(),e.preventDefault(),e.stopPropagation();var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=s.view.getSheetID(t),o=s.view.getVersionID(t),a=s.view.getSheetState(t,i),c=a.getActiveCellRange();UserAction.PlacePrecedance(n,i,o,c.startRow,c.startCol)},t);e(i,c,n),o.addEntry(n,c)}();var D=e.sPlusPlus.view.Events.Key,I=D.Entry.SpotLight.Context,m=I.keyDown,A=e.ZSConstants.JSKeyCode;m[A.PURE_PRINTABLE_CHAR]=function(){return a.activeElement!==h.editor.Editor&&h.editor.Editor.focus(),!1},m[A.ENTER]=function(e){return y.select(e),!1},m[A.UP]=function(){return y.decrement(),!1},m[A.DOWN]=function(){return y.increment(),!1},m[A.ESC]=function(){r()},a.body.appendChild(d),a.body.appendChild(v);var I=D.Entry.Base.Context,m=I.keyDown;m[A.SUPER+"+"+A.SLASH]=o}(this);
!function(e){function t(){X.call(this)}function n(e){e.preventDefault();for(var t=Mt.dltDivStack,n=t.pop();n&&!n.del.parentElement;)n=t.pop();n&&(n.del.remove(),n.cmt&&(n.cmt.style.overflow=""))}function i(){var e=ft.keyDown;e[ct.ESC]=n}function a(){var e=Y.getTemplate(["commentIcon"]);this.icon.appendChild(e.commentIcon),this.icon.id="SP_COMMENTS_ICON",this.icon.title=lt["Discussion.PanelHeader"],L(Mt.NotificationCnt)}function o(){H=K.add({onCreate:a,callBack:m,allowed:Q,direction:$}),H.onOpen=s,H.onClose=d,i()}function l(){H&&H.toggle()}function r(){H&&H.open()}function s(){J.Right.sidePanel=320,this.holder.setWidth(320),c(),W.publish(x.UI,V.SidePanel.Comments.PANELSTATUS,{isShown:!0}),q(),Mt.initialLoad&&(Mt.NotificationCnt>0?g():O())}function c(){var e=z.view.Events.Key;e.focusContext(ft)}function d(){J.Right.sidePanel=0,this.holder.setWidth(0),u(),Et=!1,W.publish(x.UI,V.SidePanel.Comments.PANELSTATUS,{isShown:!1})}function u(){W.publish(x.Listener,V.KeyBoard.ChangeContext,{CONTEXT:"Grid"})}function m(){if(!F){var e=Y.getTemplate([yt]);F=e[yt]}this.panel.appendChild(F),this.panel.addEventListener("mousedown",c),this.panel.querySelector("#AddBtn").addEventListener("click",function(){W.publish(x.Listener,V.UserAction.REVIEW_COMMENTS.TRIGGER_ADD)}),this.panel.querySelector("#NtfnBtn").addEventListener("click",function(){g()}),this.panel.querySelector("#sPCmtGoBck1").addEventListener("click",function(){O()}),this.panel.querySelector("#sPCmtGoBck2").addEventListener("click",function(){O()}),this.panel.querySelector(".spClsIcon").addEventListener("click",l),C(It),I(It),y(It),M(It),p(It),Mt.createFilterMenuLayout(It),Mt.initSheetFilter(It),f(It),B(),this.panel.querySelector("#cmtStatusFilter").setAttribute("data-menu-id","reviewCommentFilterMenu"),Mt.updateFilterDOM(Mt.currentFilter),this.panel.querySelector("#cmtSheetFilter").setAttribute("data-menu-id","sheetFilterMenu"),Mt.resetSheetFilterCount(),Mt.updateSheetFilterDOM(Mt.currentSheetFilter),Mt.NotificationCnt>0?(D(),h(gt)):v("active"),Mt.initialLoad=!0}function S(){if(et.querySelector("#"+rt.MI+"deleteAll"+rt.MENU)){var e=0==Mt.displayCnt?!0:!1;e?(tt.disable("#"+rt.MI+"deleteAll"+rt.MENU),tt.disable("#"+rt.MI+"printAll"+rt.MENU)):(tt.enable("#"+rt.MI+"deleteAll"+rt.MENU),tt.enable("#"+rt.MI+"printAll"+rt.MENU)),z.data.UserInfo.Permission.isSharable||et.querySelector("#commentPanelMenu").querySelector("#"+rt.MI+"deleteAll"+rt.MENU).remove()}var t=z.view.getActiveGridID(),n=z.view.getResourceID(t),i=z.view.getVersionID(t),a=z.data.getWorkBook(n,i);tt.zmenu("#commentPanelMenu","setMenuItemsAttribute",["#"+rt.MI+"HighlightComments"+rt.MENU],"checked",a.highlightComments)}function E(){var e=Mt.Comment.Thread;for(var t in e)e[t].highlight(!1);et.querySelector("#sPCmtHolder").innerHTML="",Mt.hideHighlightComment()}function v(e,t){Mt.init(),W.publish(x.Listener,V.UserAction.REVIEW_COMMENTS.FETCH,{status:e,sheets:t,disId:void 0,newComment:!1,action:it.DISCUSSION,SR:0,SC:0,ER:z.data.Defaults.MAX_ROW-1,EC:z.data.Defaults.MAX_COL-1})}function C(){var e={id:rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_activeCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},t=[{data:'{"label":"'+lt["Discussion.Resolve"]+'", "action": '+nt.DISCUSSION_RESOLVE+"}"},{mtype:"separator"},{data:'{"label":"'+lt["Discussion.Edit"]+'", "action": '+nt.DISCUSSION_UPDATE_RANGE_CONTENT+"}"},{data:'{"label":"'+lt["MenuItem.FileTab.Print"]+'", "action": '+Tt+"}"},{data:'{"label":"'+lt["Discussion.Delete"]+'", "action": '+nt.DISCUSSION_DELETE+"}"}];if(!ut){z.view.Menu.create(t,e,It).then(function(){tt.bind("#"+rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_activeCmtMenu","zmenuitemclick",function(e,t){t.data;N(e,t),e.stopPropagation()})});{et.getElementById(e.id)}ut=!0}}function p(){var e={id:rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_docOwnerActiveCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},t=[{data:'{"label":"'+lt["Discussion.Resolve"]+'", "action": '+nt.DISCUSSION_RESOLVE+"}"},{mtype:"separator"},{data:'{"label":"'+lt["MenuItem.FileTab.Print"]+'", "action": '+Tt+"}"},{data:'{"label":"'+lt["Discussion.Delete"]+'", "action": '+nt.DISCUSSION_DELETE+"}"}];if(!St){z.view.Menu.create(t,e,It).then(function(){tt.bind("#"+rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_docOwnerActiveCmtMenu","zmenuitemclick",function(e,t){t.data;N(e,t),e.stopPropagation()})});{et.getElementById(e.id)}St=!0}}function y(){var e={id:rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_collabActiveCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},t=[{data:'{"label":"'+lt["MenuItem.FileTab.Print"]+'", "action": '+Tt+"}"}];if(!vt){z.view.Menu.create(t,e,It).then(function(){tt.bind("#"+rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_collabActiveCmtMenu","zmenuitemclick",function(e,t){t.data;N(e,t),e.stopPropagation()})});{et.getElementById(e.id)}vt=!0}}function I(){var e={id:rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_resolvedCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},t=[{data:'{"label":"'+lt["Discussion.reopen"]+'", "action": '+nt.DISCUSSION_REOPEN+"}"},{mtype:"separator"},{data:'{"label":"'+lt["MenuItem.FileTab.Print"]+'", "action": '+Tt+"}"},{data:'{"label":"'+lt["Discussion.Delete"]+'", "action": '+nt.DISCUSSION_DELETE+"}"}];if(!dt){z.view.Menu.create(t,e,It).then(function(){tt.bind("#"+rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_resolvedCmtMenu","zmenuitemclick",function(e,t){t.data;N(e,t)})});{et.getElementById(e.id)}dt=!0}}function M(){var e={id:rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_collabResolvedCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},t=[{data:'{"label":"'+lt["MenuItem.FileTab.Print"]+'", "action": '+Tt+"}"}];if(!mt){z.view.Menu.create(t,e,It).then(function(){tt.bind("#"+rt.SUBMENUITEM+ot.COMMENTS+rt.IDENTITY+"_collabResolvedCmtMenu","zmenuitemclick",function(e,t){t.data;N(e,t)})});{et.getElementById(e.id)}mt=!0}}function f(){var e={id:"commentPanelMenu",ctype:"zmenu",relativeto:"parent","data-type":"list","data-content-type":"text"},t=[{id:rt.MI+"HighlightComments"+rt.MENU,data:'{"label":"'+lt["Discussion.HighlightComments"]+'", "action": '+Dt+', "itemType": "checkbox"}'},{id:rt.MI+"printAll"+rt.MENU,data:'{"label":"'+lt["MenuItem.FileTab.Print"]+'", "action": '+ht+"}"},{id:rt.MI+"deleteAll"+rt.MENU,data:'{"label":"'+lt["Discussion.Delete"]+'", "action": '+nt.DISCUSSION_DELETE_ALL+"}"},{"data-item-type":"separator"},{data:'{"label":"'+lt["Discussion.notification"]+'", "action": '+gt+"}"},{data:'{"label":"'+lt["Notification.EmailSettings"]+'", "action": '+nt.NOTIFICATION_SETTINGS+"}"}];if(!Ct){z.view.Menu.create(t,e,It).then(function(){tt.bind("#commentPanelMenu","zmenuitemclick",function(e,t){t.data;T(e,t)})});{et.getElementById(e.id)}Ct=!0,tt.bind(et.getElementById("commentPanelMenu"),"zmenubeforeshow",function(){Mt.updatePanelOption()})}}function N(e,t){var n=t.forElement[0].dataset.uid,i=t.data.action;W.publish(x.Listener,V.UserAction.REVIEW_COMMENTS.EXECUTE_ACTION,{uid:n,action:i})}function T(e,t){var n=t.data.action;switch(n){case ht:b();break;case nt.NOTIFICATION_SETTINGS:Mt.openNotificationSetingsDialog();break;case nt.DISCUSSION_DELETE_ALL:P();break;case gt:g();break;case Dt:Mt.triggerHighlightAllComments()}}function h(){v(pt.all),g()}function g(){L(0);var e=et.getElementById("comments");e.classList.add("sPFlip"),e.querySelector("#sPNoNtfy")&&(e.querySelector("#sPNoNtfy").style.display="block"),et.querySelector("#sPCmtNotfy").style.display="block",et.querySelector("#sPCmtNtfyHldr").style.display="block",et.querySelector("#sPCmtFltr").style.display="none",0==Mt.displayCnt&&et.querySelector("#sPNoCmt")&&(et.querySelector("#sPNoCmt").style.display="none");var t=z.view.getActiveGridID(),n=z.view.getResourceID(t),i=z.view.getVersionID(t),a=(z.data.getWorkBook(n,i),z.view.getSelectedSheets(t)),o=z.view.getSheetID(t),l=z.view.getSheetState(t,o),r=l.getActiveRange();Y.updateDocClosedTime(n,i,a,r)}function D(){var e,t=et.querySelector("#comments");t&&(e=t.querySelector("#sPNoNtfy")),e&&e.remove()}function b(){var e=et.getElementById("sPCmtHolder");Mt.print(e)}function P(){if(null==et.getElementById("dltDiv")){var t=et.getElementById("comments");t.scrollTop=0;var n=Y.getTemplate(["SP_DELETE"]).SP_DELETE;t.appendChild(n),t.querySelector("#dltMsg").innerHTML=U();var i=t.querySelector("#dltDiv"),a=t.querySelector("#cnlBtn"),o=t.querySelector("#dltBtn"),l=et.getElementById("comments");l.style.overflow="hidden",o.addEventListener("click",function(){i.remove();var t=z.view.getActiveGridID(),n=z.view.getResourceID(t),a=z.view.getSheetID(t),o=z.view.getVersionID(t),r=z.data.getWorkBook(n,o),s=(r.getSheetObj(a),sPlusPlus.data.UserInfo.loginName,z.view.getSelectedSheets(t)),c=z.view.getSheetID(t),d=z.view.getSheetState(t,c),u=d.getActiveRange(),m="active"==Mt.currentFilter?0:"resolved"==Mt.currentFilter?1:2;e.UserAction.deleteAllReviewComment(n,o,s,u,m),l.style.overflow=""}),a.addEventListener("click",function(){i.remove(),l.style.overflow=""})}}function U(){var e,t="all"==Mt.currentSheetFilter?lt["Discussion.HDAllSheet"]:Mt.currentSheetFilter;switch(Mt.currentFilter){case pt.active:e=JSUtil.fn.replaceParams(lt["Discussion.UnresolvedCommentDeleteConfirmation"],new Array(t+""));break;case pt.resolved:e=JSUtil.fn.replaceParams(lt["Discussion.ResolvedCommentDeleteConfirmation"],new Array(t+""));break;case pt.all:e=JSUtil.fn.replaceParams(lt["Discussion.AllCommentDeleteConfirmation"],new Array(t+""))}return e}function A(){W.publish(x.Listener,V.UserAction.REVIEW_COMMENTS.FETCH,{status:pt.all,sheets:void 0,disId:void 0,newComment:!1,action:"INIT_NOTIFICATION",sr:0,sc:0,er:z.data.Defaults.MAX_ROW-1,ec:z.data.Defaults.MAX_COL-1})}function O(){var e=et.querySelector("#comments");e.classList.remove("sPFlip"),et.querySelector("#sPCmtNotfy").style.display="none",e.querySelector("#sPNoNtfy")&&(e.querySelector("#sPNoNtfy").style.display="none"),et.querySelector("#sPCmtNtfyHldr").style.display="none",et.querySelector("#sPCmtFltr").style.display="",0==Mt.displayCnt&&et.querySelector("#sPNoCmt")&&(et.querySelector("#sPNoCmt").style.display="block"),L(0)}function L(e){if(H){0!=e&&D();var t=H.icon,n=Et?et.querySelector("#NtfnBtn"):t;0==e?(t.classList.remove("shNtfyCount"),t.setAttribute("data-count",e),n.classList.remove("shNtfyCount"),n.setAttribute("data-count",e)):(n.classList.add("shNtfyCount"),n.setAttribute("data-count",e)),Mt.NotificationCnt=e}}function w(){A()}function _(e){var t=e.lastChild,n=t.textContent.length,i=window.getSelection(),a=et.createRange();a.setStart(t,n),a.setEnd(t,n),a.collapse(!0),i.removeAllRanges(),i.addRange(a),e.focus()}function k(){var e=this.dataset.value,t=Mt.divToAddSmiley.querySelector("#editableContent");t.innerHTML+=" "+e,_(t);var n=Mt.divToAddSmiley.querySelector("#submitBtn");!n&&(n=Mt.divToAddSmiley.querySelector("#replyBtn")),n.disabled=!1;var i=Mt.divToAddSmiley.querySelector(".sPCmtSmiley");tt.zpopover(i,"close")}function q(){if(!R){var e=et.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=st,et.body.appendChild(e),R=et.createElement("ul"),R.id="smileySuggestions",R.className="smileySuggestions";var t=JSUtil.LinkMaker.wmsSmiley;for(var n in t)if(!R.querySelector("#"+t[n])){var i=JSUtil.LinkMaker.convert(n).msg,a=et.createElement("li");a.innerHTML=i,a.id=t[n],a.setAttribute("data-value",n),a.addEventListener("click",k),R.appendChild(a)}var o=et.getElementById("popupmenu");o.appendChild(R)}}function B(){var e=et.createElement("ul");e.id="sPLikeList";var t=et.getElementById("popupmenu");t.appendChild(e)}var R,F,H,z=e.sPlusPlus,G=e.ZSEvents,W=G.topic,x=G.Groups,V=G.Names,Y=e.UserAction,Z=e.ZSClass,J=z.view.measures,X=Z.KeyMapping,Z=e.ZSClass,K=Z.SidePanel,j=Z.SidePanelClassList,Q=[j.right,j.left,j.bottom],$=j.right,et=e.document,tt=e.UIUtil.Component,nt=e.ZSConstants.ActionConstants,it=e.ZSConstants.CommandConstants,at=e.ZSConstants,ot=at.FeatureConstants,lt=at.I18N,rt=at.wCC,st=(z.data.AppRegistry.CSSPath,z.data.AppRegistry.WMS_CSS_URL),ct=ZSConstants.JSKeyCode,dt=!1,ut=!1,mt=!1,St=!1,Et=!1,vt=!1,Ct=!1,pt={all:"all",resolved:"resolved",active:"active"},yt="SP_COMMENTS",It=et.querySelector("#popupmenu"),Mt=z.view.Toolbar.Feature[ot.COMMENTS];Mt.NotificationCnt=0,Mt.initialLoad=!1;var ft=new t,Nt=z.view.Events.Key;Nt.Entry.RightPane.Node.addChildNode(ft);var Tt=(new t,0),ht=1,gt=2,Dt=3;Mt.updateNotificationCount=L,Mt.showNotificationPanel=g,Mt.updatePanelOption=S,Mt.loadComments=v,Mt.goToComment=O,Mt.ClearPanel=E,W.register(x.UI,V.SidePanel.Comments.TOGGLE,l),W.register(x.UI,V.SidePanel.Comments.OPEN,r),W.register(x.UI,V.Layout.TEMPLATE_LOADED_DEFER,o),W.register(x.UI,V.SidePanel.Comments.FOCUS,c),W.register(x.Listener,V.UserAction.REVIEW_COMMENTS.GET_SUCCESS,w)}(this);
!function(e){function t(){E.call(this)}function n(){P=N.add({onCreate:a,callBack:l,allowed:I,direction:k}),P.onOpen=o,P.onClose=i,P.hide(),S(B)}function o(){C(),L.Right.sidePanel=320,this.holder.setWidth(320),d(),x&&(Z.load(50),x=!1),Z.isPanelOpen=!0,Z.panel&&(Z.panel.querySelector(".colbChatPanel").scrollTop=Z.panel.querySelector(".colbChatPanel").scrollHeight)}function s(){P&&P.open()}function i(){L.Right.sidePanel=0,this.holder.setWidth(0),u(),Z.isPanelOpen=!1}function a(){var e=UserAction.getTemplate(["collaboratorIcon"]);this.icon.appendChild(e.collaboratorIcon),this.icon.title=_.Chat}function l(){var e=UserAction.getTemplate(["CHAT_PANEL_TEMPLATE"]),t=e.CHAT_PANEL_TEMPLATE;this.panel.appendChild(t),this.panel.addEventListener("mousedown",d),this.panel.id=w.SP+"CollabChat"+w.HOLDER;var n=this.panel;if(Z.panel=n,h(this.panel),M){var o=M.getPanelDom();n.querySelector("#collabChatContainer").appendChild(o),n.querySelector("#sPuserOpt").addEventListener("click",function(){n.querySelector("#spChat").style.display="none",n.querySelector("#spUsers").style.display="block",n.querySelector("#sPchatOpt").classList.remove("active"),n.querySelector("#sPuserOpt").classList.add("active")}.bind(this))}else n.querySelector("#sPuserOpt").style.display="none";var s=this.panel.querySelector(".spClsIcon");s.addEventListener("click",function(){this.close()}.bind(this)),n.querySelector("#sPchatOpt").addEventListener("click",function(){n.querySelector("#spUsers").style.display="none",n.querySelector("#spChat").style.display="block",n.querySelector("#sPuserOpt").classList.remove("active"),n.querySelector("#sPchatOpt").classList.add("active")}.bind(this));var i=n.querySelector("#colbChatLoader").cloneNode(!0);n.querySelector(".colbChatPanel").appendChild(i),i.id="initChatLoader",i.style.display="";var a=n.querySelector(".colbChatPanel");a.addEventListener("scroll",function(){0===a.scrollTop&&y(this.panel)});var l=new O.TextAreaEditor(this.panel.querySelector("#chat"));l.addListeners(z),M&&M.load()}function r(e){return 0===e.length||!e.trim()}function c(e){return e.which!=U.ENTER||e.shiftKey||(e.preventDefault(),r(this.value)||(Z.add(encodeURIComponent(this.value)),this.value="")),e.stopPropagation(),!1}function d(){var e=f.view.Events.Key;e.focusContext(K)}function u(){W.focusContext(W.Entry.CellEditor)}function h(e){H.bind(document.getElementById("chatPanelMenu"),"zmenubeforeshow",function(){document.querySelector("#highlightPresence").checked=F.showUserPresence}),e.querySelector("#spNotifyColb").addEventListener("click",function(){D.execute()}),e.querySelector("#highlightPresence").addEventListener("click",function(){p(this.checked)})}function p(e){F.execute(e)}function y(){var e=P.panel.querySelector("#colbChatLoader");return void 0==e?void(P.panel.querySelector("#chatInfo").style.display="none"):(P.panel.querySelector("#chatInfo").style.display="block",e.style.display="",Z.load(50),void 0)}function C(){var e=P.icon;e.classList.remove("sPCmtNtfyPnt")}function S(e){if(B=e,e&&P){P.show();var t=P.icon;t.classList.remove("sPAddNew")}}function v(){var e=P.icon;e.classList.add("sPCmtNtfyPnt")}var P,f=e.sPlusPlus,E=ZSClass.KeyMapping,L=f.view.measures,q=e.ZSConstants,A=e.ZSEvents,b=A.topic,T=A.Groups,g=A.Names,O=ZSClass.Editors,m=q.FeatureConstants,w=q.wCC,N=ZSClass.SidePanel,R=ZSClass.SidePanelClassList,I=[R.right],k=R.right,U=e.ZSConstants.JSKeyCode,_=e.ZSConstants.I18N,H=e.UIUtil.Component,D=f.view.Toolbar.Feature[m.NOTIFY_COLLABORATOR],Z=f.view.Toolbar.Feature[m.COLLAB_CHAT],M=f.view.Toolbar.Feature[m.COLLABORATORS],F=f.view.Toolbar.Feature[m.USER_PRESENCE],x=!0,B=!1,K=new t,W=f.view.Events.Key;W.Entry.RightPane.Node.addChildNode(K);var z={keypress:c};Z.addPanelNotification=v,b.register(T.UI,g.SidePanel.Chat.open,s),b.register(T.UI,g.Layout.TEMPLATE_LOADED,n),b.register(T.Listener,g.WMSAction.ON_SHARE,S,"ISSHARED"),b.register(T.Listener,g.ShareMeta.SHARE_UPDATE,S,"ISSHARED")}(this);
!function(t){function e(){var t=UserAction.getTemplate(["COLLAB_PANEL_TEMPLATE"]),e=t.COLLAB_PANEL_TEMPLATE;return e}var n=t.sPlusPlus,s=t.ZSConstants,L=s.FeatureConstants,a=n.view.Toolbar.Feature[L.COLLABORATORS];a.getPanelDom=e}(this);
!function(e){function t(){Z.call(this)}function i(){var e=W.getTemplate(["pivotIcon"]);this.icon.appendChild(e.pivotIcon),this.icon.title=et["Menuitem.InsertTab.Pivot"]}function n(){D=j.add({onCreate:i,callBack:p,allowed:J,direction:Q}),D.onOpen=l,D.onClose=P,D.hide()}function o(){var e=M.view.getActiveGridID(),t=M.view.getResourceID(e),i=M.view.getVersionID(e),n=M.data.getWorkBook(t,i),o=M.view.getSheetID(e),e=M.view.getActiveGridID(),s=n.getSheetObj(o),r=M.view.getSheetState(e,o),l=r.getActiveCellRange(),d=s.Pivot;d.isXists(l.startRow,l.startCol)?D&&D.toggle():a()}function s(){D.alive?l():D&&D.show()}function a(){X.SP&&0!==Object.keys(X.SP).length&&"false"!=X.SP.isEditMode||D&&D.hide()}function r(){D&&D.open()}function l(){if(K.Right.sidePanel=320,c(),X.PanelID!=X.ID)if(S(),y&&y.setValue(),G&&G.setValue(),U&&U.setValue(),_&&"temp"==X.ID&&C("pivotGen"),"temp"!=X.ID){var e=M.view.getActiveGridID(),t=M.view.getResourceID(e),i=M.view.getVersionID(e),n=F.Pivot.ID,o=M.data.getWorkBook(t,i).PivotCollection.get(n),s=o[x.SOURCE],a=s[1],r=s[2],l=s[3],d=s[4],P=[];P.push(s[0]);var v=new F.ParamGenerator(P,t,i),u=v.getSheets(),p=new F.Range(a,r,l,d);W.getPivotFields(t,u[0],i,p,X.ID)}else R?E():setTimeout(function(){E()},1e3);this&&this.holder&&this.holder.setWidth(320),X.PanelID=X.ID}function d(){D&&D.close()}function c(){var e=M.view.Events.Key;e.focusContext(it)}function P(){if(X.PanelID){A.closeErrBanner(),X.PanelID=void 0,K.Right.sidePanel=0,this.holder.setWidth(0),v();var e=M.view.getActiveGridID(),t=M.view.getResourceID(e),i=M.view.getVersionID(e),n=M.data.getWorkBook(t,i),o=M.view.getSheetID(e),e=M.view.getActiveGridID(),s=n.getSheetObj(o),r=M.view.getSheetState(e,o),l=r.getActiveCellRange(),d=s.Pivot;d.isXists(l.startRow,l.startCol)||a()}}function v(){q.publish(k.Listener,H.KeyBoard.ChangeContext,{CONTEXT:"Grid"})}function S(){u("#pB_allFields"),u("#pf ul,#rf ul,#cf ul,#df ul"),R&&(R.querySelector("#pvtSearchField").value="")}function u(e){if(R){var t=R.querySelectorAll(e);t.forEach(function(e){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild)})}}function p(){var e=W.getTemplate(["SPP_HEADER","SP_PIVOT","SPP_ERRORBLOCK","SPP_ERRORMSG_DIV","SPP_TAB","SPP_CHANGESOURCE","SPP_BUILDER","SPP_TOTALOPTION","SPP_COLOR","SPP_MENUOPTION"]),t=Y.createElement("div");t.id="SPPIVOT",t.className="wid wid100 hgt100",t.appendChild(e.SP_PIVOT),this.panel.appendChild(t);var i=t.querySelector("#spp_header");i.appendChild(e.SPP_HEADER),i=t.querySelector("#err"),i.appendChild(e.SPP_ERRORBLOCK),i=t.querySelector("#errMaxField"),i.appendChild(e.SPP_ERRORMSG_DIV),i=t.querySelector("#pivotTab"),i.appendChild(e.SPP_TAB),i.appendChild(e.SPP_CHANGESOURCE),i=t.querySelector("#pivotGenTab"),i.appendChild(e.SPP_BUILDER),i=t.querySelector("#pivotMoreArea"),i.appendChild(e.SPP_TOTALOPTION),i.appendChild(e.SPP_COLOR),i.appendChild(e.SPP_MENUOPTION),R=this.panel,I(),X.SP={},y.setValue(),G&&G.setValue(),U.setValue()}function I(){T=R.querySelector("#pivotGen"),w=R.querySelector("#pivotMore"),T.addEventListener("click",h),w.addEventListener("click",h),L=R.querySelector("#pivotMoreTab"),_=R.querySelector("#pivotGenTab");var e=R.querySelector("#sPClose");e.addEventListener("click",d),A=new X.BuilderModel(R),A.init(),y=new X.ChangeSource(R),y.bindEvent(),m=new X.Refresh(R),m.bindEvent(),V=new X.Delete(R),V.bindEvent(),N=new X.Move(R),N.bindEvent(),G=new X.Style(R),G.init(),U=new X.TotalController(R),U.bindEvent(),b=new X.Chart(R),b.bindEvent()}function h(e){var t=e.target.id;C(t)}function C(e){"pivotGen"===e?(_.style.display="",L.style.display="none",T.classList.add("active"),w.classList.remove("active")):"temp"!=X.ID&&(_.style.display="none",L.style.display="",T.classList.remove("active"),w.classList.add("active"))}function E(){"temp"==X.ID?w.classList.add("zsDisable"):w.classList.remove("zsDisable"),A.construct()}function g(e){A&&A.handleError(e)}function O(e){A.createPivotinNewSheet(e)}function f(){A.cancel()}var D,R,T,w,_,L,A,y,N,m,V,G,U,b,M=e.sPlusPlus,B=e.ZSEvents,q=B.topic,k=B.Groups,H=B.Names,W=e.UserAction,F=e.ZSClass,K=M.view.measures,Z=F.KeyMapping,F=e.ZSClass,X=F.Pivot,j=F.SidePanel,x=e.ZSConstants.CommandConstants,z=F.SidePanelClassList,J=[z.right,z.left,z.bottom],Q=z.right,Y=e.document,$=(e.UIUtil.Component,M.data.Defaults.MAX_COL,M.data.Defaults.MAX_ROW,e.ZSConstants),et=($.FeatureConstants,$.I18N),B=($.wCC,e.ZSEvents),q=B.topic,tt=B.Groups,H=B.Names,it=new t,nt=M.view.Events.Key;nt.Entry.RightPane.Node.addChildNode(it),q.register(k.UI,H.SidePanel.PIVOT.TOGGLE,o),q.register(k.UI,H.SidePanel.PIVOT.SHOW_ICON,s),q.register(k.UI,H.SidePanel.PIVOT.HIDE_ICON,a),q.register(k.UI,H.SidePanel.PIVOT.OPEN,r),q.register(k.UI,H.SidePanel.PIVOT.CLOSE,d),q.register(k.UI,H.Layout.TEMPLATE_LOADED,n),q.register(tt.Listener,H.UserAction.PIVOT.GET_FIELDS,E),q.register(tt.UserAction,H.UserAction.PIVOT.HANDLE_ERROR,g,"ERRORMSG"),q.register(tt.Listener,H.UserAction.PIVOT.CREATE_INNEWSHEET,O,"NEWSHEETID"),q.register(tt.Listener,H.UserAction.PIVOT.CANCEL_BUILDER,f)}(this);
!function(e){function t(){yt.call(this)}function r(){var e=J.view.Events.Key;e.focusContext(ft)}function o(){var e=J.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function i(){if(!H){var e=it.getTemplate([wt]);H=e[wt]}this.panel.appendChild(H),w()}function a(){var e=it.getTemplate(["sparkLineIcon"]);this.icon.appendChild(e.sparkLineIcon),this.icon.title=gt["SidePanel.Sparklines.Sparkline"]}function n(){F=Pt.add({onCreate:a,callBack:i,allowed:Rt,direction:It}),F.onOpen=l,F.onClose=s,F.hide()}function l(){var e=J.view.getActiveGridID(),t=J.view.getVersionID(e),r=J.view.getResourceID(e),o=J.view.getSheetID(e),i=J.view.getSheetState(e,o),a=i.getActiveCellRange(),n=J.data.getWorkBook(r,t).getSheetObj(o),l=n.sparklines.groupranges.getInfo(a.startRow,a.startCol);l&&d(),ut.Right.sidePanel=320,this.holder.setWidth(320),setTimeout(function(){UIUtil.Component.initComponent("#sprklne"),T(),V(),St&&A(),k(r,o,t,a.startRow,a.startCol)},0),F.show()}function s(){document.activeElement.blur(),E(),ut.Right.sidePanel=0,this.holder.setWidth(0)}function c(){if(F.alive){document.activeElement.blur(),F.open(),d();{S()}T(),V(),St&&A()}}function g(){F||n(),F.open()}function u(e){F||n(),e&&F.open(),F.show(),c()}function v(){F&&F.hide()}function p(){ht&&(u(!0),ht=!1)}function d(){var e=J.view.getActiveGridID(),t=(J.view.getResourceID(e),J.view.getSheetID(e)),r=(J.view.getVersionID(e),J.view.getSelectedSheets(e),J.view.getSheetState(e,t)),o=r.getActiveRange(),i=r.getActiveCellRange();kt.activeRange=o,kt.activeCell=i}function S(){return kt.activeCell}function h(e,t,r,o){var i,a=J.view.getActiveGridID(),n=J.view.getSheetState(a,t);ht=!0,Q.publish($.Selector.BoundUpdate.Range,et.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:r,RANGEID:n.getActiveID()});for(var l=0;l<o.length;l++){var s=o[l];Q.publish($.Selector.BoundUpdate.Range,et.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:r,RANGE:s,TYPE:void 0}),0==l&&(i=new st.Range(s.startRow,s.startCol,s.startRow,s.startCol),Q.publish($.Selector.BoundUpdate.Cell,et.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:r,ActiveCellRange:i,ROW:i.startRow,COL:i.startCol,TYPE:void 0}))}it.ScrollCellIntoView(e,t,r,i.startRow,i.startCol)}function k(e,t,r,o,i){var a=J.view.getActiveGridID(),e=J.view.getResourceID(a),t=J.view.getSheetID(a),r=J.view.getVersionID(a),n=J.data.getWorkBook(e,r).getSheetObj(t),l=n.sparklines.groupranges.getInfo(o,i);F&&F.alive&&(l?F.panel.querySelector(Et.groupArea).classList.remove("sPDisable"):F.panel.querySelector(Et.groupArea).classList.add("sPDisable"))}function w(){for(var e=[Et.showHidden,Et.highPoint,Et.firstPoint,Et.negativePoint,Et.lowPoint,Et.lastPoint,Et.allPoints,Et.showAxis,Et.reverse],t=[Et.lineType,Et.colType,Et.winlossType,Et.gap,Et.zero,Et.lines,Et.skip,Et.autoMin,Et.sameMin,Et.custMin,Et.autoMax,Et.sameMax,Et.custMax],r=F.panel.querySelectorAll(".cP"),o=0;o<r.length;o++){var i=r[o];x("#"+i.id)}for(var o=0;o<t.length;o++)F.panel.querySelector(t[o]).addEventListener("click",b);for(var o=0;o<e.length;o++)F.panel.querySelector(e[o]).addEventListener("click",b);F.panel.querySelector(Et.group).addEventListener("click",function(){U(!1,!1)}),F.panel.querySelector(Et.wholeGroup).addEventListener("click",function(){U(!0,!1)}),F.panel.querySelector(Et.orientation).addEventListener("click",N),F.panel.querySelector(Et.close).addEventListener("click",function(){F.close()}),F.panel.querySelector(Et.remove).addEventListener("click",f),F.panel.querySelector(Et.removeGroup).addEventListener("click",m),F.panel.querySelector(Et.editButton).addEventListener("click",A),F.panel.querySelector(Et.editCloseButton).addEventListener("click",E),F.panel.querySelector(Et.editSubmit).addEventListener("click",D),F.panel.querySelector(Et.editClose).addEventListener("click",E),F.panel.querySelector(Et.editGroupCheckbox).addEventListener("click",L),F.panel.querySelector(Et.editSingleCheckbox).addEventListener("click",q),F.panel.querySelector(Et.minValue).addEventListener("focus",I),F.panel.querySelector(Et.maxValue).addEventListener("focus",y),F.panel.querySelector(Et.minValue).addEventListener("blur",R),F.panel.querySelector(Et.maxValue).addEventListener("focus",R),F.panel.querySelector(Et.verticalAxisMenu).addEventListener("click",P),F.panel.querySelector(Et.horizontalAxisMenu).addEventListener("click",C)}function P(){var e=F.panel.querySelector("#vrtAxis"),t=F.panel.querySelector("#hrzAxis");t.classList.remove("tgl"),e.classList.contains("tgl")?(F.panel.querySelector(Et.verticalAxisMenu).checked=!1,e.classList.remove("tgl")):e.classList.add("tgl")}function C(){var e=F.panel.querySelector("#hrzAxis"),t=F.panel.querySelector("#vrtAxis");t.classList.remove("tgl"),e.classList.contains("tgl")?(F.panel.querySelector(Et.horizontalAxisMenu).checked=!1,e.classList.remove("tgl")):e.classList.add("tgl")}function R(){o(),b()}function I(){F.panel.querySelector(Et.custMin).checked=!0,r()}function y(){F.panel.querySelector(Et.custMax).checked=!0,r()}function f(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=(J.view.getVersionID(e),J.view.getSelectedSheets(e)),i=J.view.getSheetState(e,r),a=i.getRanges();it.removeSparklines(t,e,o,r,a,"SPARKLINE_REMOVE"),Q.publish($.UI,et.SidePanel.Sparklines.CLOSE),document.activeElement.blur()}function m(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getVersionID(e),i=J.view.getSelectedSheets(e),a=J.view.getSheetState(e,r),n=a.getRanges(),l=J.data.getWorkBook(t,o).getSheetObj(r),s={};for(var c in n)for(var g=n[c],u=g.startRow;u<=g.endRow;u++)for(var v=g.startCol;v<=g.endCol;v++){var p=l.sparklines.groupranges.getInfo(u,v);if(p)var d=l.sparklines.groupranges.getInfo(u,v).id;s[d]=p.outputRange}var S=[];for(var h in s)for(var k=s[h],c=0;c<k.length;c++)S.push(k[c]);it.removeSparklines(t,e,i,r,G(S),"SPARKLINE_GROUP_REMOVE"),Q.publish($.UI,et.SidePanel.Sparklines.CLOSE),document.activeElement.blur()}function D(){var e=J.view.getActiveGridID(),t=J.view.getSheetID(e),r=(J.view.getSheetState(e,t),S()),o=F.panel.querySelector(Et.editGroupCheckbox).checked;o?W(r):_(r),E()}function A(){St=!0;var e=F.panel.querySelector(Et.editArea);F.panel.querySelector(Et.editSingleCheckbox).checked=!0,F.panel.querySelector(Et.panelArea).classList.add("sPDisable"),z(),r(),e.classList.add("shEdArea")}function E(){St=!1;var e=F.panel.querySelector(Et.editArea);F.panel.querySelector(Et.panelArea).classList.remove("sPDisable"),e.classList.remove("shEdArea"),o()}function q(){z()}function L(){B()}function x(e){var t=F.panel.querySelector(e);UIUtil.Component.initComponent(e),at.bind(t,"zcolorselectboxselect",function(t,r){M(),qt[e]=r.currentValue,Lt[e]&&(F.panel.querySelector(Lt[e]).checked=!0),b()})}function b(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getVersionID(e),i=J.view.getSelectedSheets(e),a=J.view.getSheetState(e,r),n=(a.getActiveRange(),S()),l=J.data.getWorkBook(t,o).getSheetObj(r),s=(ot.hash(n.startRow,n.startCol,rt),l.sparklines.groupranges.getInfo(n.startRow,n.startCol).properties),c=l.sparklines.groupranges.getInfo(n.startRow,n.startCol).outputRange;s=JSON.parse(JSON.stringify(s)),F.panel.querySelector(Et.lineType).checked?s.sparklineType="line":F.panel.querySelector(Et.colType).checked?s.sparklineType="column":F.panel.querySelector(Et.winlossType).checked&&(s.sparklineType="winloss");var g;g=F.panel.querySelector(Et.gap).checked?"gap":F.panel.querySelector(Et.zero).checked?"zero":F.panel.querySelector(Et.lines).checked?"connect":"skip";var u,v,p,d;if(F.panel.querySelector(Et.autoMin).checked)u="automatic";else if(F.panel.querySelector(Et.sameMin).checked)u="same";else if(u="custom",p=parseInt(F.panel.querySelector(Et.minValue).value),isNaN(p))return;if(F.panel.querySelector(Et.autoMax).checked)v="automatic";else if(F.panel.querySelector(Et.sameMax).checked)v="same";else if(v="custom",d=parseInt(F.panel.querySelector(Et.maxValue).value),isNaN(d))return;s.highPoint=F.panel.querySelector(Et.highPoint).checked,s.firstPoint=F.panel.querySelector(Et.firstPoint).checked,s.lowPoint=F.panel.querySelector(Et.lowPoint).checked,s.lastPoint=F.panel.querySelector(Et.lastPoint).checked,s.negativePoints=F.panel.querySelector(Et.negativePoint).checked,s.marker=F.panel.querySelector(Et.allPoints).checked,s.sparklineColor=qt[Et.sparklineColor],s.markerColor=qt[Et.markerColor],s.firstPointColor=qt[Et.firstPointColor],s.highPointColor=qt[Et.highPointColor],s.lastPointColor=qt[Et.lastPointColor],s.lowPointColor=qt[Et.lowPointColor],s.negativePointColor=qt[Et.negativePointColor],s.hidden=F.panel.querySelector(Et.showHidden).checked,s.emptyCell=g,s.showAxis=F.panel.querySelector(Et.showAxis).checked,s.reverse=F.panel.querySelector(Et.reverse).checked,s.verticalAxisMinimum=u,s.verticalAxisMaximum=v,s.minValue=p,s.maxValue=d,it.modifySparklineProperties(t,e,r,i,s,G(c),"SPARKLINE_PROPERTIES")}function M(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getVersionID(e),i=(J.view.getSelectedSheets(e),J.view.getSheetState(e,r)),a=J.data.getWorkBook(t,o).getSheetObj(r),n=(i.getActiveRange(),S()),l=a.sparklines.groupranges.getInfo(n.startRow,n.startCol).properties;qt[Et.highPointColor]=l.highPointColor,qt[Et.lowPointColor]=l.lowPointColor,qt[Et.firstPointColor]=l.firstPointColor,qt[Et.lastPointColor]=l.lastPointColor,qt[Et.negativePointColor]=l.negativePointColor,qt[Et.markerColor]=l.markerColor,qt[Et.sparklineColor]=l.sparklineColor}function O(e){var t=e.highPointColor,r=e.lowPointColor,o=e.firstPointColor,i=e.lastPointColor,a=e.negativePointColor,n=e.markerColor,l=e.sparklineColor;at.zcolorselectbox(Et.highPointColor,"setValue",t),at.zcolorselectbox(Et.lowPointColor,"setValue",r),at.zcolorselectbox(Et.firstPointColor,"setValue",o),at.zcolorselectbox(Et.lastPointColor,"setValue",i),at.zcolorselectbox(Et.negativePointColor,"setValue",a),at.zcolorselectbox(Et.markerColor,"setValue",n),at.zcolorselectbox(Et.sparklineColor,"setValue",l)}function V(){var e,t=J.view.getActiveGridID(),r=J.view.getResourceID(t),o=J.view.getSheetID(t),i=J.view.getVersionID(t),a=J.data.getWorkBook(r,i),n=(J.view.getSelectedSheets(t),J.view.getSheetState(t,o),J.data.getWorkBook(r,i).getSheetObj(o)),l=S(),s=(n.sparklines.cellRange[ot.hash(l.startRow,l.startCol,rt)],X.SparklinePool.getDataRange(r,i,n,l.startRow,l.startCol));e=void 0!=s?a.SheetList.getById(s.sheetID).Name+"."+s.range.getLabel():pt,F.panel.querySelector(Et.sourceRange).innerText=gt["SidePanel.Sparklines.Source"]+": "+e}function T(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getVersionID(e),i=(J.view.getSelectedSheets(e),J.view.getSheetState(e,r)),a=J.data.getWorkBook(t,o).getSheetObj(r),n=(i.getActiveRange(),S()),l=a.sparklines.groupranges.getInfo(n.startRow,n.startCol);if(void 0!=l){var s=l.properties,c=l.orientationChangeable;if("line"==s.sparklineType?F.panel.querySelector(Et.lineType).checked=!0:"column"==s.sparklineType?F.panel.querySelector(Et.colType).checked=!0:F.panel.querySelector(Et.winlossType).checked=!0,"gap"==s.emptyCell?F.panel.querySelector(Et.gap).checked=!0:"zero"==s.emptyCell?F.panel.querySelector(Et.zero).checked=!0:"lines"==s.emptyCell?F.panel.querySelector(Et.lines).checked=!0:"skip"==s.emptyCell&&(F.panel.querySelector(Et.skip).checked=!0),M(),O(s),F.panel.querySelector(Et.highPoint).checked=s.highPoint,F.panel.querySelector(Et.lowPoint).checked=s.lowPoint,F.panel.querySelector(Et.firstPoint).checked=s.firstPoint,F.panel.querySelector(Et.lastPoint).checked=s.lastPoint,F.panel.querySelector(Et.negativePoint).checked=s.negativePoints,F.panel.querySelector(Et.allPoints).checked=s.marker,F.panel.querySelector(Et.showAxis).checked=s.showAxis,F.panel.querySelector(Et.reverse).checked=s.reverse,c){var g=F.panel.querySelector(Et.orientation);g.classList.remove("sPDisable")}else{var g=F.panel.querySelector(Et.orientation);g.classList.add("sPDisable")}"automatic"==s.verticalAxisMinimum?F.panel.querySelector(Et.autoMin).checked=!0:"same"==s.verticalAxisMinimum?F.panel.querySelector(Et.sameMin).checked=!0:(F.panel.querySelector(Et.custMin).checked=!0,F.panel.querySelector(Et.minValue).value=s.minValue),"automatic"==s.verticalAxisMaximum?F.panel.querySelector(Et.autoMax).checked=!0:"same"==s.verticalAxisMaximum?F.panel.querySelector(Et.sameMax).checked=!0:(F.panel.querySelector(Et.custMax).checked=!0,F.panel.querySelector(Et.maxValue).value=s.maxValue)}}function N(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getVersionID(e),i=J.view.getSelectedSheets(e),a=(J.view.getSheetState(e,r),S()),n={r:a.startRow,c:a.startCol,s:r},l=J.data.getWorkBook(t,o).getSheetObj(r),s=256*a.startRow+a.startCol,c=l.sparklines.groupranges.RangeList.cellRange[s].id,g=l.sparklines.groupranges.getInfo(a.startRow,a.startCol).outputRange;l.sparklines.groupranges.RangeList.cellRange[s].orientationChangeable&&it.changeSparklineOrientation(t,e,r,i,c,G(g),n)}function G(e){for(var t=[],r=[],o=0;o<e.length;o++){var i=e[o],a=new st.Range(i[0],i[1],i[2],i[3]);X.SparklinePool.mergeRanges(a,r)}for(var n=0;n<r.length;n++){var a=r[n];t.push(a)}return t}function U(e,t){var r=J.view.getActiveGridID(),o=J.view.getResourceID(r),i=J.view.getSheetID(r),a=J.view.getVersionID(r),n=J.view.getSelectedSheets(r),l=J.view.getSheetState(r,i),s=l.getRanges(),c=S(),g={r:c.startRow,c:c.startCol,s:i},u=J.data.getWorkBook(o,a).getSheetObj(i);if(t)it.ungroupSparklines(o,r,n,i,s,"SPARKLINE_UNGROUP");else if(e){var v={};for(var p in s)for(var d=s[p],h=d.startRow;h<=d.endRow;h++)for(var k=d.startCol;k<=d.endCol;k++){var w=u.sparklines.groupranges.getInfo(h,k);if(w)var P=u.sparklines.groupranges.getInfo(h,k).id;v[P]=w.outputRange}var C=[];for(var R in v)for(var I=v[R],p=0;p<I.length;p++)C.push(I[p]);it.groupSparklines(o,r,i,n,G(C),g,!0,"SPARKLINE_GROUP")}else it.groupSparklines(o,r,i,n,s,g,!1,"SPARKLINE_GROUP");document.activeElement.blur()}function B(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getVersionID(e),i=J.data.getWorkBook(t,o),a=i.getSheetObj(r),n=a.sparklines.groupranges.RangeList.cellRange,l=(J.view.getSheetState(e,r),S()),s=ot.hash(l.startRow,l.startCol,rt),c=n[s];void 0==c&&(c=a.sparklines.groupranges.RangeList.colRange[l.startCol]);for(var g=c.inputRange,u=c.outputRange,v=c.orientationArray,p="",d="",h=0;h<g.length;h++){var k=u[h],w=v[h],P=X.SparklinePool.getDataRange(t,o,a,k[0],k[1]);if(void 0!=P){var C;if(k[0]==k[2]){var R=0,I=0;"HORIZONTAL"==w?R=k[3]-k[1]:I=k[3]-k[1],C=new st.Range(P.range.startRow,P.range.startCol,P.range.endRow+R,P.range.endCol+I)}else{var R=0,I=0;"HORIZONTAL"==w?R=k[2]-k[0]:I=k[2]-k[0],C=new st.Range(P.range.startRow,P.range.startCol,P.range.endRow+R,P.range.endCol+I)}var y=i.SheetList.getById(P.sheetID).Name+"."+C.getLabel()+";";p+=y}else p+=pt}p=p.substring(0,p.length-1);for(var h=0;h<u.length;h++){var k=u[h],f=new st.Range(k[0],k[1],k[2],k[3]),y=i.SheetList.getById(k[4]).Name+"."+f.getLabel()+";";d+=y}d=d.substring(0,d.length-1),j([Et.sourceRangePicker,Et.destRangePicker],F.panel,void 0,!1),dt[Et.sourceRangePicker].value=p,dt[Et.destRangePicker].value=d,dt[Et.destRangePicker].Editor.classList.remove("sPDisable")}function z(){var e,t=J.view.getActiveGridID(),r=J.view.getResourceID(t),o=J.view.getSheetID(t),i=J.view.getVersionID(t),a=J.data.getWorkBook(r,i),n=a.getSheetObj(o),l=(n.sparklines.cellRange,J.view.getSheetState(t,o),S()),s=X.SparklinePool.getDataRange(r,i,n,l.startRow,l.startCol);e=void 0==s?pt:s.sheetName+"."+s.range.getLabel();var c=a.SheetList.getById(o).Name+"."+l.getLabel();j([Et.sourceRangePicker,Et.destRangePicker],F.panel,void 0,!0),dt[Et.sourceRangePicker].value=e,dt[Et.destRangePicker].value=c,dt[Et.destRangePicker].Editor.classList.add("sPDisable")}function W(e){var t=J.view.getActiveGridID(),r=J.view.getResourceID(t),o=J.view.getSheetID(t),i=J.view.getVersionID(t),a=J.data.getWorkBook(r,i).getSheetObj(o),n=(J.view.getSheetState(t,o),a.sparklines.groupranges.getInfo(e.startRow,e.startCol)),l=n.id,s=n.properties,c=(n.outputRange,dt[Et.sourceRangePicker].value.split(";")),g=dt[Et.destRangePicker].value.split(";"),u=s.sparklineType;X.SparklinePool.create(c,g,u,l,"EDIT_SPARKLINE_GROUP_DATA")}function _(){var e=J.view.getActiveGridID(),t=J.view.getResourceID(e),r=J.view.getSheetID(e),o=J.view.getSelectedSheets(e),i=J.view.getVersionID(e),a=dt[Et.sourceRangePicker].value,n=JSUtil.Range.parseRange(t,i,a),l=[];if(K(n)){l.push([n.sheetID]);var s=S();it.editSparkline(t,e,r,o,l,[n.range],[s])}}function K(e){return void 0==e?(Z(1),!1):e.range.startRow!=e.range.endRow&&e.range.startCol!=e.range.endCol?(Z(2),!1):!0}function Z(e){var t=[{text:gt.OK,primary:!0}],r={buttons:t,title:gt["Alert.Title.InvalidSourceRange"]};switch(e){case 1:st.ZSAlert(gt["SidePanel.Sparklines.Alert.SourceInvalidTryAgain"],r);break;case 2:st.ZSAlert(gt["SidePanel.Sparklines.Alert.MultiRowSource"],r)}}function j(e,t,r,o){{var i=J.view.getActiveGridID();J.view.getResourceID(i),J.view.getSheetID(i),J.view.getVersionID(i)}e.forEach(function(e){var r=t.querySelector(e),i=new st.Editors.RangeEditor(r);ct.register(i,o),dt[e]=i})}var H,F,J=e.sPlusPlus,Y=e.ZSEvents,X=e.JSUtil,Q=Y.topic,$=Y.Groups,et=Y.Names,tt=J.data.Defaults,rt=tt.MAX_COL,ot=e.JSUtil.Math,it=e.UserAction,at=e.UIUtil.Component,nt=(e.ZSConstants.wCC,e.ZSConstants),lt=nt.FeatureConstants,st=e.ZSClass,ct=(st.Editors,st.RangePicker),gt=e.ZSConstants.I18N,ut=(document.getElementById("popupmenu"),J.view.measures),vt=J.view.Toolbar.Feature[lt.SPARKLINE],pt="#REF!",dt={},St=!1,ht=!1,kt={activeRange:{},activeCell:{}},wt="sparklineSidePanel",Pt=st.SidePanel,Ct=st.SidePanelClassList,Rt=[Ct.right],It=Ct.right,st=e.ZSClass,yt=st.KeyMapping,ft=new t,mt=J.view.Events.Key;mt.Entry.RightPane.Node.addChildNode(ft);var Dt=e.document.createElement("span");Dt.classList.add("ZsLoader");var At=e.document.createElement("span");At.classList.add("ZsNoMsg");var Et={lineType:"#lineTyp",colType:"#colTyp",winlossType:"#winlosTyp",highPoint:"#hP",firstPoint:"#pvtFP",negativePoint:"#pvtNP",lowPoint:"#pvtLP",lastPoint:"#pvtLstP",allPoints:"#AllP",showHidden:"#pvtShR",showAxis:"#pvtSA",reverse:"#pvtPD",gap:"#pvtGap",zero:"#pvtZero",lines:"#pvtLines",skip:"#pvtSkip",autoMin:"#autoSpMin",sameMin:"#sameSpMin",custMin:"#custSpMin",autoMax:"#autoSpMax",sameMax:"#sameSpMax",custMax:"#custSpMax",group:"#grp",ungroup:"#ugrp",groupDropDown:"#spkGroupte",wholeGroup:"#wgrp",highPointColor:"#hPC",firstPointColor:"#pvtFPC",negativePointColor:"#pvtNPC",lowPointColor:"#pvtLPC",lastPointColor:"#pvtLstPC",markerColor:"#AllPC",sparklineColor:"#inputSpk1",minValue:"#custMin",maxValue:"#custMax",orientation:"#orientation",sourceRange:"#sRange",back:".back",remove:"#rmv",removeGroup:"#rmvgrp",editArea:"#spkEditArea",editButton:"#edit",editCloseButton:"#editClose",sourceRangePicker:"#sPicker",destRangePicker:"#dPicker",editSubmit:"#CreateButton",editClose:"#CancelButton",editGroupCheckbox:"#spkGrp",editSingleCheckbox:"#spkSel",close:"#sPClose",panelArea:"#sPArea",groupArea:"#spkGrpArea",verticalAxisMenu:"#vtAx",horizontalAxisMenu:"#hzAx"},qt={},Lt={"#hPC":Et.highPoint,"#pvtLPC":Et.lowPoint,"#pvtFPC":Et.firstPoint,"#pvtLstPC":Et.lastPoint,"#pvtNPC":Et.negativePoint,"#AllPC":Et.allPoints,"#inputSpk1":void 0};vt.openSidePanel=g,Q.register($.UI,et.SidePanel.Sparklines.OPEN,u,"ISRIGHTCLICK"),Q.register($.UI,et.SidePanel.Sparklines.CLOSE,v),Q.register($.UI,et.SidePanel.Sparklines.SELECT,h,"RID","SHEETID","VERSION","RANGES"),Q.register($.UI,et.SidePanel.Sparklines.CREATE,p),Q.register($.Listener,et.SheetAction.ACTIVE_CELL.INFO,k,"RID","SHEETID","VERSION","ROW","COLUMN")}(this);
!function(e){function t(e,t,i,l){if(!l)return void c.log("value is not defined",l,A);var A=I.FONTFAMILY,E=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),v=n.view.getSheetID(E),g=(n.view.getActiveState(E),new s.ParamGenerator(t,e,i,!0,!0)),u=g.getSheets(),L=g.getRanges(),C=g.getActiveCell(),O={RID:e,sheetList:u,rangeList:L,activeCell:C,action:A,VERSION:i,value:l},T=new d(A,O,l),f=JSUtil.fn.getIndexOf(v,u),D=L[f];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:v,VERSION:i});var N=new R;N.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:v,VERSION:i,ACTION:A,RANGELIST:D,VALUE:l})}),N.addEventListeners("onComplete",function(e){e.qaid;T.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(T)}),N.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(N,T),N.send(O)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=e.ZSDevTools.Logger,d=e.ZSClass.ActionObject,I=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,l=n.SML.Client,R=l.Utility.WorkerRequest;e.UserAction}e.UserAction.FONTFAMILY=t}(this);
!function(e){function t(e,t,i,l){if(!l)return void S.log("value is not defined",l,R);var R=d.FONTSIZE,v=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),A=n.view.getSheetID(v),g=(n.view.getActiveState(v),new s.ParamGenerator(t,e,i,!0,!0)),u=g.getSheets(),C=g.getRanges(),O=g.getActiveCell(),L={RID:e,sheetList:u,rangeList:C,activeCell:O,action:R,VERSION:i,value:l},T=new c(R,L,l),f=JSUtil.fn.getIndexOf(A,u),D=C[f];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:i});var N=new E;N.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:i,ACTION:R,RANGELIST:D,VALUE:l})}),N.addEventListeners("onComplete",function(e){e.qaid;T.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(T)}),N.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(I.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(N,T),N.send(L)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,S=e.ZSDevTools.Logger,c=e.ZSClass.ActionObject,d=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,l=n.SML.Client,E=l.Utility.WorkerRequest;e.UserAction}e.UserAction.FONTSIZE=t}(this);
!function(e){function t(e,t,o,s,i,r,S){n.data.getWorkBook(e,o);c.activeInfo.setCopyState(0),a(e,t,o,s,i,r,S)}function o(e,t,o,s,i,r){n.data.getWorkBook(e,o);c.activeInfo.setCopyState(1),a(e,t,o,s,i,r)}function a(t,o,a,s,E,l){var u=n.data.getWorkBook(t,a),D=u.getSheetObj(o[0]).Prop.Name,_=new e.ZSClass.ParamGenerator(o,t,a,!0,!0),A=_.getSheets(),p=_.getRanges(),T=_.getActiveCell(),f=c.activeInfo.getCopyState(),g=f?O.SERVERCLIP_COPY_RANGE:O.SERVERCLIP_CUT_RANGE,v={RID:t,RS_ID:n.data.PageRegistry.RS_ID,sheetList:A,VERSION:a,action:g,rangeList:p,activeCell:T,isSolidCopy:E,isRequiredTabSeparatedValues:l,sheetName:D},L=S.fn.getIndexOf(T.s,A),U=p[L],N=new I;N.addEventListeners("onComplete",function(e){if(e.a&&e.a===O.SHOW_ERROR_MESSAGE)return void R.log("COPY Error case has to be handled");if(e[d.COPY_TO_CLIP]){var s=(U.endRow-U.startRow+1)*(U.endCol-U.startCol+1);if(s>n.data.Defaults.MAX_COPY_LIMIT){var S=U.getColSpan(),E=Math.floor(n.data.Defaults.MAX_COPY_LIMIT/S);U.endRow=U.startRow+E}i.publish(r.Listener,C.CellAction.ADDCOPYINFO,{RID:t,SHEETID:o[0],VERSION:a,ActiveCellRange:U,DATA:e[d.COPY_TO_CLIP][d.DATA],DATATYPE:e[d.COPY_TO_CLIP][d.TYPE]})}}),N.addEventListeners("onError",function(e){i.publish(r.Selector.BoundUpdate.Copy,C.Selection.BOUND_UPDATE.REMOVE,{RID:t,SHEETID:o[0],VERSION:a}),i.publish(r.Listener,C.ERROR.SHOW,{ERRORMSG:e.mk})});var h=f?P.COPY:P.CUT;N.open(h),N.send(v),i.publish(r.Selector.BoundUpdate.Copy,C.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:T.s,VERSION:a,RANGES:U,SHEETS:A[L],IS_SERVER_CLIP:!1,IS_COPY:f})}var n=e.sPlusPlus,s=e.ZSEvents,i=s.topic,r=s.Groups,S=e.JSUtil,C=s.Names,S=e.JSUtil,R=e.ZSDevTools.Logger,E=e.ZSConstants,l=n.SML.Client,I=(e.ZSClass,l.Utility.WorkerRequest),O=E.ActionConstants,d=E.CommandConstants,P=E.URI,c=n.data.UserInfo;e.UserAction.Copy=o,e.UserAction.Cut=t}(this);
!function(e){function t(e,t,n,a,s){R.publish(c.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.FLUSH,{RID:e,SHEETID:t,VERSION:a});for(var o=(d.fn.getIndexOf(t,n),0);o<s.length;o++){var i=new S.Range(s[o].sr,s[o].sc,s[o].er,s[o].ec);R.publish(c.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:a,RANGE:i,accumulate:1})}}function n(e,t){for(var n=t.Sheets,a=t.Ranges,s=0,o=0;o<n.length;o++){var i=a[o],r=n[o],S=e.getSheetObj(r);if(S){var R=S.DataFilters.isIntersecting(i);R&&(s=S.Row.Filter.getOnCount(i.startRow,i.endRow))}}return s}function a(a,s,o,r,E){var C=i.data.getWorkBook(a,o),f=i.view.getActiveGridID(),m=i.view.getActiveState(f),h=m.getFormatPainterRange(),_=T.activeInfo.getCopyState(),U=m.getFormatPainterState(),L=U?h:T.activeInfo.getCopyDetails();if(0!=Object.keys(L).length){var N=L.Sheets,w=new S.ParamGenerator(N,a,o,!0,!0),M=w.getSheets(),y=w.getCustomRanges(L.Ranges,!0),F=new S.ParamGenerator(s,a,o,!0,!0),H=F.getSheets(),Y=F.getRanges(),B=F.getActiveCell(),G=d.fn.getIndexOf(B.s,H),b=Y[G];if(U||R.publish(c.Selector.BoundUpdate.Copy,l.Selection.BOUND_UPDATE.HIDE,{RID:a,SHEETID:B.s,VERSION:o,VisualCueStatus:P.CUESTATUS.HIDDEN}),L.Ranges.length>1&&Y[0].length>1||L.Ranges[0].startRow!==L.Ranges[0].endRow&&Y[0].length>1||L.Ranges[0].startCol!==L.Ranges[0].endCol&&Y[0].length>1){var k=g["action.not.support.multiselection"],V=new e.ZSClass.TBNotification(k,{type:"error"});return void V.show()}var Z=!(-1==L.Sheets.indexOf(B.s)),W=(Z?n(C,L):0,Y);U&&(r=void 0),U&&(E=void 0);var q=_?v.COPY_PASTE:U?v.PASTESPECIAL_FORMATS:v.CUT_PASTE,x=U?!1:T.activeInfo.isClipped()?T.activeInfo.isClipped():!1,j=0==b[0].startRow&&b[0].endRow==p-1?1:0==b[0].startCol&&b[0].endCol==A-1?2:0,J={RID:a,RS_ID:i.data.PageRegistry.RS_ID,srcSheetList:M,sheetList:H,rangeList:W,activeCell:B,isSameSheet:Z,srcRangeList:y,pasteType:r,isTranspose:E,VERSION:o,isServerClip:x,type:j,isFormatPainter:U,action:x?v.SERVERCLIP_PASTE_RANGE:q},K=new I(q,J),X=new u;X.addEventListeners("onComplete",function(e){var n=e[D.SYNC_RESPONSE][D.DOCUMENT_META][a][D.USER_NOTIFICATION][0][1][0][1];t(a,B.s,H,o,n[0]),K.qaid=e.qaid,i.data.UserInfo.ActionRecorder.record(K)}),X.addEventListeners("askConfirm",function(e){var t=new S.ZSConfirm(g[e.mk]);t.onYES(function(){X.resend()});var n=t.execute();R.publish(c.Listener,l.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),X.addEventListeners("onError",function(e){R.publish(c.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})});var z=_?"COPY_PASTE":U?"COPY_PASTE":"CUT_PASTE";return X.open(O[z]),X.send(J),U&&L.isSingleTap?void R.publish(c.Selector.BoundUpdate.FormatPainter,l.Selection.BOUND_UPDATE.REMOVE,{RID:a,SHEETID:B.s,VERSION:o}):void 0}}function s(e,t,n,a,s){var o=new S.ParamGenerator(t,e,n,!0,!0),r=o.getSheets(),E=o.getRanges(),d=o.getActiveCell();s&&(E=o.getCustomRanges(s),d.r=s.startRow,d.c=s.startCol);var C={RID:e,RS_ID:i.data.PageRegistry.RS_ID,sheetList:r,activeCell:d,action:v.COPY_PASTE_CONTENT,VERSION:n,rangeList:E,val:a},f=new I(v.COPY_PASTE_CONTENT,C),p=new u;p.addEventListeners("onComplete",function(e){f.qaid=e.qaid,i.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("askConfirm",function(e){var t=new S.ZSConfirm(g[e.mk]);t.onYES(function(){p.resend()});var n=t.execute();R.publish(c.Listener,l.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),p.addEventListeners("onError",function(e){R.publish(c.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(O.COPY_PASTE_CONTENT),p.send(C)}function o(t,n,a,s,o,r){var E=new S.ParamGenerator(n,t,a,!0,!0),d=E.getSheets(),g=E.getRanges(),C=E.getActiveCell();if("undefined"!=typeof r){var f=[];f.push(r),e.UserAction.uploadImage(t,C.s,a,f)}else{var p="undefined"!=typeof o&&o?!0:!1,A=p===!0?!0:!1,C=E.getActiveCell(),P={RID:t,RS_ID:i.data.PageRegistry.RS_ID,sheetList:d,activeCell:C,VERSION:a,rangeList:g,cellContent:s,isHtmlData:p,isFormatApply:A,action:v.SYSTEMCLIP_PASTE},T=new I(v.SYSTEMCLIP_PASTE,P),D=new u;D.addEventListeners("onComplete",function(e){T.qaid=e.qaid,i.data.UserInfo.ActionRecorder.record(T)}),D.addEventListeners("onError",function(e){R.publish(c.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(O.SYSTEMCLIP_PASTE),D.send(P)}}var i=e.sPlusPlus,r=e.ZSEvents,S=e.ZSClass,R=r.topic,c=r.Groups,l=r.Names,E=e.ZSConstants,d=e.JSUtil,g=E.I18N,C=(e.ZSDevTools.Logger,i.SML.Client),u=C.Utility.WorkerRequest,v=E.ActionConstants,S=e.ZSClass,I=S.ActionObject,O=E.URI,f=i.data.Defaults,p=f.MAX_ROW,A=f.MAX_COL,P=S.SelectorHelper.Constants,T=i.data.UserInfo,D=e.ZSConstants.CommandConstants;e.UserAction.PasteFromSheet=a,e.UserAction.PasteFromClipBoard=s,e.UserAction.PasteSpecial=a,e.UserAction.PasteOutsideSource=o}(this);
!function(e){function t(t,n,a){var d=(s.data.getWorkBook(t,a),s.data.UserInfo.Transients.UndoRedo.getObj(t)),O=new e.ZSClass.ParamGenerator(n,t,a),I=O.getSheets();if(d.isUndoPossible()){o.publish(i.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:s.view.getSheetID(s.view.getActiveGridID()),VERSION:a});var g={RID:t,sheetList:I,VERSION:a,TYPE:"UNDO"},D=new c(S.UNDO,g),U=new E;U.addEventListeners("onComplete",function(e){o.publish(i.Selector.ReDraw,r.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:a,qaid:e.qaid}),D.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(D);var n=d.UndoTransientAO,R=s.data.UserInfo.Transients.UndoRedo.getObj(t),E=R.getNextNthData(1),S=O.getRanges();E.params.rangeList||(E.params.rangeList=S),n[e.qaid]=E}),U.addEventListeners("onError",function(e){o.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(l.UNDO),U.send(g)}else R.log("NO MORE UNdo action's...!!!!")}function n(t,n,a){var d=(s.data.getWorkBook(t,a),s.data.UserInfo.Transients.UndoRedo.getObj(t)),R=new e.ZSClass.ParamGenerator(n,t,a),I=R.getSheets();if(d.isRedoPossible()){var g={RID:t,sheetList:I,VERSION:a,TYPE:"REDO"},D=new c(S.REDO,g),U=new E;U.addEventListeners("onComplete",function(e){o.publish(i.Selector.ReDraw,r.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:a,qaid:e.qaid}),D.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(D);var n=d.RedoTransientAO,E=s.data.UserInfo.Transients.UndoRedo.getObj(t),O=E.getPrevNthData(1),S=R.getRanges();O.params.rangeList||(O.params.rangeList=S),n[e.qaid]=O}),U.addEventListeners("onError",function(e){o.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(l.REDO),U.send(g)}else O.RepeatAction&&O.RepeatAction(t,n,a)}var s=e.sPlusPlus,a=e.ZSEvents,o=a.topic,i=a.Groups,r=a.Names,d=s.SML.Client,R=e.ZSDevTools.Logger,E=d.Utility.WorkerRequest,O=e.UserAction,S=e.ZSConstants.ActionConstants,c=e.ZSClass.ActionObject,l=e.ZSConstants.URI;O.Undo=t,O.Redo=n}(this);
!function(e){function t(e,t,i,I){I=1==I?1:0;var l=R.WRAP,A=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),E=n.view.getSheetID(A),v=(n.view.getActiveState(A),new s.ParamGenerator(t,e,i,!0,!0)),g=v.getSheets(),C=v.getRanges(),u=v.getActiveCell(),L={RID:e,sheetList:g,rangeList:C,activeCell:u,action:l,VERSION:i,value:I},O=new c(l,L,I),T=JSUtil.fn.getIndexOf(E,g),D=C[T];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:E,VERSION:i});var f=new d;f.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:E,VERSION:i,ACTION:l,RANGELIST:D,VALUE:I})}),f.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(O)}),f.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(f,O),f.send(L)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),R=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,I=n.SML.Client,d=I.Utility.WorkerRequest;e.UserAction}e.UserAction.WRAP=t}(this);
!function(e){function t(e,t,n,s,i){var o=new r.ParamGenerator(t,e,n,!0),c=o.getSheets(),E=s?o.getCustomRanges(s):o.getRanges(),C=o.getActiveCell(),L={rID:e,sheetList:c,rangeList:E,VERSION:n,action:S.READ_DATA_DUPLICATES,activeCell:C,type:i},T=new R;T.addEventListeners("onComplete",function(e){a.publish(l.Listener,A.UserAction.DATA_DUPLICATE.TABLE_DETAILS,{TABLE_DETAILS:e.tableRange})}),T.addEventListeners("onError",function(e){a.publish(l.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(u.READ_DATA_DUPLICATES),T.send(L)}function n(e,t,n,s,o,c,E,L,T,d,g,I,D,p,_,U){var v=new r.ParamGenerator(t,e,n,!0,!0),O=v.getSheets(),m=s?v.getCustomRanges(JSUtil.Range.parseRange(e,n,s).range):v.getRanges(),f=v.getActiveCell(),h={RID:e,sheetList:O,rangeList:m,VERSION:n,action:S.GET_DATA_DUPLICATES,activeCell:f,frl:o,columnAry:c,includeFirstOccurence:E,operationType:L,isCaseSensitive:T,isBlanks:d,actionType:_,value:g,includeHiddenCells:p,isNewSheet:U},P=new R,N=new C(S.GET_DATA_DUPLICATES,h);P.addEventListeners("onComplete",function(e){1!=U&&(N.qaid=e.qaid,i.data.UserInfo.ActionRecorder.record(N))}),P.addEventListeners("onError",function(e){a.publish(l.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(u.GET_DATA_DUPLICATES),P.send(h)}function s(e,t,n,s,i,o,c,E,L,T){{var d=new r.ParamGenerator(t,e,n,!0,!0),g=d.getSheets(),I=s?d.getCustomRanges(JSUtil.Range.parseRange(e,n,s).range):d.getRanges(),D=d.getActiveCell(),p={RID:e,sheetList:g,rangeList:I,VERSION:n,action:S.DATA_DUPLICATES_INFO,activeCell:D,frl:i,columnAry:o,includeFirstOccurence:c,isCaseSensitive:E,includeHiddenCells:L,actionType:T},_=new R;new C(S.DATA_DUPLICATES_INFO,p)}_.addEventListeners("onComplete",function(e){a.publish(l.Listener,A.UserAction.DATA_DUPLICATE.TABLE_INFO,{TABLE_INFO:e.duplicatesInfo})}),_.addEventListeners("onError",function(e){a.publish(l.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(u.DATA_DUPLICATES_INFO),_.send(p)}{var i=e.sPlusPlus,o=e.ZSEvents,r=e.ZSClass,a=o.topic,l=o.Groups,A=o.Names,c=e.ZSConstants,r=e.ZSClass,E=(c.I18N,i.SML.Client),R=E.Utility.WorkerRequest,u=c.URI,C=(e.encodeURIComponent,r.ActionObject),S=c.ActionConstants,L=e.module,T=(L.getModule("SA/Controller/SheetAppController"),L.getModule("SA/Controller/SheetAppUIController"),e.ZSConstants.FeatureConstants);i.view.Toolbar.Feature[T.DATA_CLEANING]}e.UserAction.ReadTable=t,e.UserAction.getDuplicates=n,e.UserAction.getDuplicatesInfo=s}(this);
!function(e){function t(e,t,i,R){R=1==R?1:0;var l=S.BOLD,E=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),A=n.view.getSheetID(E),v=(n.view.getActiveState(E),new s.ParamGenerator(t,e,i,!0,!0)),L=v.getSheets(),g=v.getRanges(),C=v.getActiveCell(),O={RID:e,sheetList:L,rangeList:g,activeCell:C,action:l,VERSION:i,value:R},u=new c(l,O,R),D=JSUtil.fn.getIndexOf(A,L),T=g[D];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:i});var f=new d;f.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:i,ACTION:l,RANGELIST:T,VALUE:R})}),f.addEventListeners("onComplete",function(e){e.qaid;u.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(u)}),f.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(I.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(f,u),f.send(O)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),S=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,R=n.SML.Client,d=R.Utility.WorkerRequest;e.UserAction}e.UserAction.BOLD=t}(this);
!function(e){function t(e,t,i,R){R=1==R?1:0;var l=c.ITALIC,A=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),E=n.view.getSheetID(A),C=(n.view.getActiveState(A),new s.ParamGenerator(t,e,i,!0,!0)),v=C.getSheets(),L=C.getRanges(),g=C.getActiveCell(),u={RID:e,sheetList:v,rangeList:L,activeCell:g,action:l,VERSION:i,value:R},O=new I(l,u,R),T=JSUtil.fn.getIndexOf(E,v),D=L[T];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:E,VERSION:i});var f=new d;f.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:E,VERSION:i,ACTION:l,RANGELIST:D,VALUE:R})}),f.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(O)}),f.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(f,O),f.send(u)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,I=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,R=n.SML.Client,d=R.Utility.WorkerRequest;e.UserAction}e.UserAction.ITALIC=t}(this);
!function(e){function t(e,t,i,R){R=1==R?1:0;var d=E.UNDERLINE,l=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),A=n.view.getSheetID(l),v=(n.view.getActiveState(l),new s.ParamGenerator(t,e,i,!0,!0)),L=v.getSheets(),g=v.getRanges(),C=v.getActiveCell(),u={RID:e,sheetList:L,rangeList:g,activeCell:C,action:d,VERSION:i,value:R},O=new c(d,u,R),D=JSUtil.fn.getIndexOf(A,L),N=g[D];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:i});var T=new S;T.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:i,ACTION:d,RANGELIST:N,VALUE:R})}),T.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(O)}),T.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(I.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(T,O),T.send(u)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),E=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,R=n.SML.Client,S=R.Utility.WorkerRequest;e.UserAction}e.UserAction.UNDERLINE=t}(this);
!function(e){function t(e,t,i,I){I=1==I?1:0;var d=S.STRIKETHROUGH,l=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),A=n.view.getSheetID(l),v=(n.view.getActiveState(l),new s.ParamGenerator(t,e,i,!0,!0)),g=v.getSheets(),C=v.getRanges(),O=v.getActiveCell(),T={RID:e,sheetList:g,rangeList:C,activeCell:O,action:d,VERSION:i,value:I},u=new R(d,T,I),L=JSUtil.fn.getIndexOf(A,g),D=C[L];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:i});var U=new E;U.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:i,ACTION:d,RANGELIST:D,VALUE:I})}),U.addEventListeners("onComplete",function(e){e.qaid;u.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(u)}),U.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(c.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(U,u),U.send(T)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,R=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),S=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI,I=n.SML.Client,E=I.Utility.WorkerRequest;e.UserAction}e.UserAction.STRIKETHROUGH=t}(this);
!function(e){function n(e,n,t,s){s||(s=1);var E,d=new r.ParamGenerator(n,e,t,!0,!0),l=d.getSheets(),u=d.getRanges(),g=d.getActiveCell();switch(s){case 1:E=M.MERGE_RANGE;break;case 2:E=M.MERGE_AND_CENTER;break;case 3:E=M.MERGE_DOWN;break;case 4:E=M.MERGE_ACROSS;break;default:E=M.MERGE_RANGE}var L={RID:e,sheetList:l,rangeList:u,activeCell:g,type:s,VERSION:t,action:E},G=new C(M.MERGE_RANGE,L,s),v=new S;v.addEventListeners("onComplete",function(e){G.qaid=e.qaid,c.data.UserInfo.ActionRecorder.record(G)}),v.addEventListeners("askConfirm",function(e){var n=new r.ZSConfirm(R[e.mk]);n.onYES(function(){v.resend()});var t=n.execute();i.publish(a.Listener,o.DocAction.ConfirmMsg.SHOW,{MSG:n.getMsg(),KEY:t,CONFIRMOBJ:n})}),v.addEventListeners("onError",function(e){i.publish(a.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(f.MERGE_CELLS_ADD),c.data.UserInfo.registerForRepeat(v,G),v.send(L)}function t(e,n,t,s){var E=new r.ParamGenerator(n,e,t,!0,!0),d=E.getSheets(),l=E.getRanges(),u=E.getActiveCell(),g={RID:e,sheetList:d,activeCell:u,action:M.MERGE_SPLIT,VERSION:t,rangeList:l},L=new C(M.MERGE_SPLIT,g),G=new S;G.addEventListeners("onComplete",function(e){L.qaid=e.qaid,c.data.UserInfo.ActionRecorder.record(L),s()}),G.addEventListeners("askConfirm",function(e){var n=new r.ZSConfirm(R[e.mk]);n.onYES(function(){G.resend()});var t=n.execute();i.publish(a.Listener,o.DocAction.ConfirmMsg.SHOW,{MSG:n.getMsg(),KEY:t,CONFIRMOBJ:n})}),G.addEventListeners("onError",function(e){i.publish(a.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),G.open(f.MERGE_CELLS_REMOVE),c.data.UserInfo.registerForRepeat(G,L),G.send(g)}var s=e.ZSEvents,r=e.ZSClass,i=s.topic,a=s.Groups,o=s.Names,E=e.ZSConstants,R=E.I18N,c=e.sPlusPlus,r=e.ZSClass,d=c.SML.Client,S=d.Utility.WorkerRequest,C=r.ActionObject,M=E.ActionConstants,f=E.URI;e.UserAction.MergeRange=n,e.UserAction.SplitRange=t}(this);
!function(t){function n(t,n,e){var o={RID:t,newName:e},s=new l;s.addEventListeners("onComplete",function(){}),s.open(C.DOCUMENT_RENAME),s.send(o)}function e(t,n){if(I)document.location.reload(!0);else{var e=[{text:R.OK,primary:!0,click:function(){document.location.reload(!0)}}],o={countDown:15,buttons:e,title:R[n]};r.ZSAlert(R[t],o)}}function o(){I=!0}var s=t.sPlusPlus,i=t.ZSEvents,r=t.ZSClass,a=i.topic,c=i.Groups,u=i.Names,E=s.SML.Client,l=E.Utility.WorkerRequest,C=t.ZSConstants.URI,R=(s.data.UserInfo,ZSConstants.ActionConstants,t.ZSConstants.I18N),I=!1;a.register(c.Listener,u.UserAction.REVERT_VERSION,o),a.register(c.Listener,u.DocMeta.TRIGGER_DOCUMENT_EXIT,e,"EXCEPTIONKEY","TITLE"),t.UserAction.RenameDocument=n}(this);
!function(t){function n(t,n,s,e){var i={RID:t,VERSION:n,action:s?"unfavourite":"favourite"},r=new o;r.addEventListeners("onComplete",function(t){var n=t.isFavorite;e(n)}),r.open(a.DOCUMENT_FAVORATE),r.send(i)}{var s=t.sPlusPlus,e=s.SML.Client,o=e.Utility.WorkerRequest,a=t.ZSConstants.URI;s.data.UserInfo,ZSConstants.ActionConstants,t.ZSConstants.I18N}t.UserAction.MakeFavorate=n}(this);
!function(e){function t(t,o,S,l,E,C,c){var A,d=new e.ZSClass.ParamGenerator(o,t,S,!0,!0),g=d.getActiveSheet(),v=R.data.getWorkBook(t,S),I=v.getSheetObj(g),w=R.view.getActiveGridID(),T=R.view.getSheetState(w,o[0]),D=T.getActiveRange(),L=T.isMultiRangeSelected();if(L)return void ZSClass.ZSAlert(u["action.not.support.multiselection"]);var p,f,h,N=I.DataFilters;if(E){var Z=N.getAllRanges();for(var _ in Z)var G=Z[_],U=new ZSClass.Range(G.startRow,G.startCol,G.endRow,G.endCol);var m=N.getSubsets(D);A=m.length>0?D:U}else A=D;if(!C){var P={},b=[];P.f=c?c:0,P.s="ASC"==l[0]?"TRUE":"FALSE",b.push(P),p=!1,f=void 0,h=!1}a.publish(r.Listener,i.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:g,VERSION:S}),0==A.startRow&&A.endRow==O-1||C?n(t,o,S,A,C,b,p,f,h):s(t,o,S,b,A,p,void 0,h)}function n(t,n,o,R,l,d,u,v,I){var w,T=new e.ZSClass.ParamGenerator(n,t,o),D=T.getSheets(),L=new ZSClass.Range(R.startRow,R.startCol,R.endRow,R.endCol),p=T.getCustomRanges(L),f=T.getActiveCell(),h={RID:t,sheetList:D,activeCell:f,VERSION:o,rangeList:p,action:C.SORT_DETAILS},N=(new c(C.SORT_DETAILS,h),new E);N.addEventListeners("onComplete",function(e){var R,E=e.response_array,C=E[0];C.hasOwnProperty("ch")&&(R=C.ch);var c=S.fn.getIndexOf(f.s,D),A=p[c][0];A.isCol()&&"true"==C.ES?(w=new ZSClass.Range(A.startRow,C.ESC,A.endRow,C.EEC),w.endRow==O-1&&w.endCol==g-1?w.type=3:w.endRow==O-1&&(w.type=2),a.publish(r.Selector.BoundUpdate.Range,i.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:T.getActiveSheet(),RANGE:w,TYPE:w.type,VERSION:o})):w=A,l?a.publish(r.Listener,i.CellAction.VALUE.CUSTOM_SORT_EXPANDRANGE,{ACTIVERANGE:w,HEADER_DETAILS:R}):s(t,n,o,d,w,u,v,I)}),N.addEventListeners("onError",function(e){a.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(A.SORT_DETAILS),N.send(h)}function s(t,n,s,o,S,l,d,O,g){var u=new e.ZSClass.ParamGenerator(n,t,s,!1,!1),v=u.getSheets(),I=new ZSClass.Range(S.startRow,S.startCol,S.endRow,S.endCol),w=u.getCustomRanges(I),T=u.getActiveCell(),D=g?g:S.endCol-S.startCol+1,L={RID:t,sheetList:v,rangeList:w,activeCell:T,SORTANDINDEX:JSON.stringify(o),NOOFCOLS:D,ISSORTCOLS:l,VERSION:s,ISCASESENSITIVE:O,action:C.SORT};"undefined"!=typeof d&&(L.ISCONTAINSHEADER=d);var p=new c(C.SORT,L),f=new E;f.addEventListeners("onComplete",function(){R.data.UserInfo.ActionRecorder.record(p)}),f.addEventListeners("onError",function(e){a.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(A.SORT_RANGE),f.send(L)}var o=e.ZSEvents,a=o.topic,r=o.Groups,i=o.Names,S=e.JSUtil,R=e.sPlusPlus,l=R.SML.Client,E=l.Utility.WorkerRequest,C=e.ZSConstants.ActionConstants,c=ZSClass.ActionObject,A=e.ZSConstants.URI,d=R.data.Defaults,O=d.MAX_ROW,g=d.MAX_COL,u=ZSConstants.I18N;e.UserAction.Sort=t,e.UserAction.executeSort=s}(this);
!function(e){function t(e,t,i,l){if(!l)return void c.log("value is not defined",l,E);var E=R.COLOR,v=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),A=n.view.getSheetID(v),C=(n.view.getActiveState(v),new s.ParamGenerator(t,e,i,!0,!0)),O=C.getSheets(),g=C.getRanges(),u=C.getActiveCell(),L={RID:e,sheetList:O,rangeList:g,activeCell:u,action:E,VERSION:i,value:l},f=new d(E,L,l),T=JSUtil.fn.getIndexOf(A,O),D=g[T];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:i});var p=new I;p.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:i,ACTION:E,RANGELIST:D,VALUE:l})}),p.addEventListeners("onComplete",function(e){e.qaid;f.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(p,f),p.send(L)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=e.ZSDevTools.Logger,d=e.ZSClass.ActionObject,R=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,l=n.SML.Client,I=l.Utility.WorkerRequest;e.UserAction}e.UserAction.COLOR=t}(this);
!function(e){function t(e,t,i,l){if(!l)return void c.log("value is not defined",l,I);var I=R.TEXTCOLOR,v=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),A=n.view.getSheetID(v),C=(n.view.getActiveState(v),new s.ParamGenerator(t,e,i,!0,!0)),O=C.getSheets(),g=C.getRanges(),u=C.getActiveCell(),L={RID:e,sheetList:O,rangeList:g,activeCell:u,action:I,VERSION:i,value:l},T=new d(I,L,l),f=JSUtil.fn.getIndexOf(A,O),D=g[f];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:i});var p=new E;p.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:i,ACTION:I,RANGELIST:D,VALUE:l})}),p.addEventListeners("onComplete",function(e){e.qaid;T.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(T)}),p.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(p,T),p.send(L)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=e.ZSDevTools.Logger,d=e.ZSClass.ActionObject,R=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,l=n.SML.Client,E=l.Utility.WorkerRequest;e.UserAction}e.UserAction.TEXTCOLOR=t}(this);
!function(e){function t(t,n,s,i,c,C,E,L,O,d,g,p,T,v){var f=new e.ZSClass.ParamGenerator(n,t,s,!0),n=f.getSheets(),h=f.getParmsFromDataString(i),M=h.sheets,T=h.ranges,P=void 0;if(v||(P=f.getCustomRanges(c)),P||v){var U={RID:t,srcSheetList:n,sheetList:M,rangeList:T,delimiters:C,enclosure:E,isMergeDelimitersChecked:L,srcRangeList:P,columnHeads:JSON.stringify(O),cellContent:r(d),countryName:g,startsFromRow:p,VERSION:s},A=(new S(m.TEXTTOCOLUMNS_APPLY,U),new R);A.addEventListeners("onError",function(e){o.publish(a.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(u.TEXTTOCOLUMNS_APPLY),A.send(U)}}function n(e,t,n,s,i){var r={cellContent:e,delimiters:t,mergeDelimiter:n,textDelimiter:s},c=new R;c.addEventListeners("onComplete",function(e){e&&i&&i(e)}),c.addEventListeners("onError",function(e){o.publish(a.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),c.open(u.TEXTTOCOLUMNS_DELIMITERS),c.send(r)}{var s=e.sPlusPlus,i=e.ZSEvents,r=e.encodeURIComponent,o=i.topic,a=i.Groups,l=i.Names,c=s.SML.Client,R=c.Utility.WorkerRequest,S=e.ZSClass.ActionObject,m=e.ZSConstants.ActionConstants,u=e.ZSConstants.URI;ZSClass.Range}UserAction.splitOperation=n,UserAction.ApplyTexttoColumn=t}(this);
!function(a){function t(a,t,s,d,v){var A=R.RECAST,I=(e.data.getWorkBook(a,s),e.view.getActiveGridID()),l=(e.view.getSheetID(I),e.view.getActiveState(I),new n.ParamGenerator(t,a,s,!0,!0)),C=l.getSheets(),f=l.getRanges(),u=l.getActiveCell();switch(e.data.RecastInfo.action){case R.SYSTEMCLIP_PASTE:e.data.RecastInfo.aparams.format=v.data.value;break;case R.SERVERCLIP_PASTE_RANGE:case R.COPY_PASTE:e.data.RecastInfo.aparams.pstype=v.data.value,e.data.RecastInfo.action=R.COPY_PASTE;break;case R.FILLSERIES:e.data.RecastInfo.aparams.fst=v.data.value}var p={RID:a,sheetList:C,rangeList:f,activeCell:u,action:A,VERSION:s,aaid:e.data.RecastInfo.actionId,aaction:e.data.RecastInfo.action,aparams:e.data.RecastInfo.aparams},g=(new r(R.RECAST,p),new E);g.addEventListeners("onComplete",function(a){a&&(e.data.isRecastAction=a.isRecastAction)}),g.addEventListeners("onError",function(a){o.publish(i.Listener,c.ERROR.SHOW,{ERRORMSG:a.mk})}),g.open(S.RECAST),g.send(p)}{var e=a.sPlusPlus,s=a.ZSEvents,n=a.ZSClass,o=s.topic,i=s.Groups,c=s.Names,r=(a.ZSDevTools.Logger,a.ZSClass.ActionObject),R=a.ZSConstants.ActionConstants,S=a.ZSConstants.URI,d=e.SML.Client,E=d.Utility.WorkerRequest;a.UserAction}a.UserAction.invokeRecastAction=t}(this);
!function(e){function t(e,t,i,R){R||(R="center");var l=I.HALIGN,A=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),E=n.view.getSheetID(A),v=(n.view.getActiveState(A),new s.ParamGenerator(t,e,i,!0,!0)),L=v.getSheets(),g=v.getRanges(),C=v.getActiveCell(),u={RID:e,sheetList:L,rangeList:g,activeCell:C,action:l,VERSION:i,value:R},O=new c(l,u,R),T=JSUtil.fn.getIndexOf(E,L),D=g[T];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:E,VERSION:i});var N=new d;N.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:E,VERSION:i,ACTION:l,RANGELIST:D,VALUE:R})}),N.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(O)}),N.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(N,O),N.send(u)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),I=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,R=n.SML.Client,d=R.Utility.WorkerRequest;e.UserAction}e.UserAction.HALIGN=t}(this);
!function(e){function t(e,t,i,R){R||(R="vcenter");var l=I.VALIGN,A=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),E=n.view.getSheetID(A),v=(n.view.getActiveState(A),new s.ParamGenerator(t,e,i,!0,!0)),L=v.getSheets(),g=v.getRanges(),C=v.getActiveCell(),u={RID:e,sheetList:L,rangeList:g,activeCell:C,action:l,VERSION:i,value:R},O=new c(l,u,R),T=JSUtil.fn.getIndexOf(E,L),D=g[T];o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:E,VERSION:i});var N=new d;N.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:E,VERSION:i,ACTION:l,RANGELIST:D,VALUE:R})}),N.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(O)}),N.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(S.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(N,O),N.send(u)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,c=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),I=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,R=n.SML.Client,d=R.Utility.WorkerRequest;e.UserAction}e.UserAction.VALIGN=t}(this);
!function(e){function t(t,s,a,c,d,u){var I=new e.ZSClass.ParamGenerator(s,t,a,!0),C=I.getSheets(),v=I.getRanges(),L=I.getActiveCell(),A=n.view.getActiveGridID(),g=n.view.getSheetID(A);i.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:g,VERSION:a});var p=e.encodeURIComponent,O={RID:t,sheetList:C,VERSION:a,rangeList:v,activeCell:L,subMode:c,action:E.HYPERLINK};"add"==c&&(O.cellValue=p(d),O.url=p(u));var h=new R(E.HYPERLINK,O),D=new l;D.addEventListeners("onComplete",function(){n.data.UserInfo.ActionRecorder.record(h)}),D.addEventListeners("onError",function(e){i.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(S.HYPERLINK),D.send(O)}var n=e.sPlusPlus,s=e.ZSEvents,i=(e.ZSClass,s.topic),o=s.Groups,r=s.Names,a=e.ZSConstants,c=n.SML.Client,l=c.Utility.WorkerRequest,R=e.ZSClass.ActionObject,E=a.ActionConstants,S=a.URI;e.UserAction.HyperLink=t}(this);
!function(e){function t(e,t,i,d,E){d=d?d:17;var I=c.BORDERS,A=(n.data.getWorkBook(e,i),n.view.getActiveGridID()),v=n.view.getSheetID(A),g=(n.view.getActiveState(A),new s.ParamGenerator(t,e,i,!0,!0)),C=g.getSheets(),O=g.getRanges(),u=g.getActiveCell(),L={RID:e,sheetList:C,rangeList:O,activeCell:u,action:I,VERSION:i,value:d,borderStyle:E},D=new S(I,L,d),T=JSUtil.fn.getIndexOf(v,C),f=O[T],p={action:I,borderStyle:E};o.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:v,VERSION:i});var N=new l;N.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:v,VERSION:i,ACTION:p,RANGELIST:f,VALUE:d})}),N.addEventListeners("onComplete",function(e){e.qaid;D.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(D)}),N.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(R.FORMAT_MODIFY),n.data.UserInfo.registerForRepeat(N,D),N.send(L)}{var n=e.sPlusPlus,i=e.ZSEvents,s=e.ZSClass,o=i.topic,r=i.Groups,a=i.Names,S=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI,d=n.SML.Client,l=d.Utility.WorkerRequest;e.UserAction}e.UserAction.BORDER=t}(this);
!function(e){function t(t,n,o,E,L,O){var S=R.FORMAT_DATE,A=new e.ZSClass.ParamGenerator(n,t,o),M=A.getSheets(),T=A.getRanges(),f=A.getActiveCell(),m={action:S,sheetList:M,rangeList:T,activeCell:f,RID:t,VERSION:o,formatType:E,formatString:L,formatCellsParam:O},u=new c(S,m),d=new l;d.addEventListeners("onComplete",function(e){if(S===R.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(C.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,c=e.ZSClass.ActionObject,R=e.ZSConstants.ActionConstants,C=e.ZSConstants.URI;e.UserAction.FORMAT_DATE=t}(this);
!function(e){function t(t,n,o,E,L,O){var S=C.FORMAT_CURRENCY,M=new e.ZSClass.ParamGenerator(n,t,o),A=M.getSheets(),T=M.getRanges(),f=M.getActiveCell(),m={action:S,sheetList:A,rangeList:T,activeCell:f,RID:t,VERSION:o,formatType:E,formatString:L,formatCellsParam:O},u=new R(S,m),d=new l;d.addEventListeners("onComplete",function(e){if(S===C.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(c.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,R=e.ZSClass.ActionObject,C=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.FORMAT_CURRENCY=t}(this);
!function(e){function t(t,n,o,O,L,S){var A=c.FORMAT_ACCOUNTING,E=new e.ZSClass.ParamGenerator(n,t,o),M=E.getSheets(),T=E.getRanges(),f=E.getActiveCell(),m={action:A,sheetList:M,rangeList:T,activeCell:f,RID:t,VERSION:o,formatType:O,formatString:L,formatCellsParam:S},u=new C(A,m),d=new l;d.addEventListeners("onComplete",function(e){if(A===c.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,C=e.ZSClass.ActionObject,c=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;e.UserAction.FORMAT_ACCOUNTING=t}(this);
!function(e){function t(t,n,o,E,L,O){var S;S="STANDARD"==E?C.FORMAT_CURRENCY:C.FORMAT_PERCENT;var T=new e.ZSClass.ParamGenerator(n,t,o),A=T.getSheets(),M=T.getRanges(),f=T.getActiveCell(),m={action:S,sheetList:A,rangeList:M,activeCell:f,RID:t,VERSION:o,formatType:E,formatString:L,formatCellsParam:O},u=new l(S,m),d=new R;d.addEventListeners("onComplete",function(e){if(S===C.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(c.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,R=o.Utility.WorkerRequest,l=e.ZSClass.ActionObject,C=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.FORMAT_PERCENT=t}(this);
!function(e){function t(t,n,o,E,L,M){var O=R.FORMAT_INCREMENT_DECIMAL,S=new e.ZSClass.ParamGenerator(n,t,o,!0),A=S.getSheets(),T=S.getRanges(),f=S.getActiveCell(),m={action:O,sheetList:A,rangeList:T,activeCell:f,RID:t,VERSION:o,formatType:E,formatString:L,formatCellsParam:M},u=new C(O,m),I=new l;I.addEventListeners("onComplete",function(e){if(O===R.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),I.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(c.NUMBER_FORMAT_MODIFY),I.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,C=e.ZSClass.ActionObject,R=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.FORMAT_INCREMENT_DECIMAL=t}(this);
!function(e){function t(t,n,o,c,L,M){var O=E.FORMAT_DECREMENT_DECIMAL,S=new e.ZSClass.ParamGenerator(n,t,o,!0),A=S.getSheets(),T=S.getRanges(),f=S.getActiveCell(),m={action:O,sheetList:A,rangeList:T,activeCell:f,RID:t,VERSION:o,formatType:c,formatString:L,formatCellsParam:M},u=new C(O,m),d=new l;d.addEventListeners("onComplete",function(e){if(O===E.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,C=e.ZSClass.ActionObject,E=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;e.UserAction.FORMAT_DECREMENT_DECIMAL=t}(this);
!function(e){function t(t,n,o,T,E,L){var O;O="STANDARD"==T?c.FORMAT_CURRENCY:c.FORMAT_TEXT;var S=new e.ZSClass.ParamGenerator(n,t,o),A=S.getSheets(),M=S.getRanges(),f=S.getActiveCell(),m={action:O,sheetList:A,rangeList:M,activeCell:f,RID:t,VERSION:o,formatType:T,formatString:E,formatCellsParam:L},u=new R(O,m),d=new l;d.addEventListeners("onComplete",function(e){if(O===c.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(C.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,R=e.ZSClass.ActionObject,c=e.ZSConstants.ActionConstants,C=e.ZSConstants.URI;e.UserAction.FORMAT_TEXT=t}(this);
!function(e){function t(t,n,o,M,O,L){var S=C.FORMAT_COMMA,A=new e.ZSClass.ParamGenerator(n,t,o),E=A.getSheets(),T=A.getRanges(),f=A.getActiveCell(),m={action:S,sheetList:E,rangeList:T,activeCell:f,RID:t,VERSION:o,formatType:M,formatString:O,formatCellsParam:L},u=new c(S,m),d=new l;d.addEventListeners("onComplete",function(e){if(S===C.FORMATCELLS_CLIENT){var t=e.format?e.format:{};a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),e.format||JSUtil.Object.isEmpty(e)||a.publish(i.Listener,r.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else{{e.qaid}u.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(u)}}),d.addEventListeners("onError",function(e){a.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.NUMBER_FORMAT_MODIFY),d.send(m)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,i=n.Groups,r=n.Names,o=s.SML.Client,l=o.Utility.WorkerRequest,c=e.ZSClass.ActionObject,C=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;e.UserAction.FORMAT_COMMA=t}(this);
!function(e){function t(e,t,n){var i=new d.ParamGenerator(t,e,n,!1),r=i.getSheets(),o=i.getRanges(),s=i.getActiveCell(),a={RID:e,sheetList:r,VERSION:n,activeCell:s,rangeList:o},R=new C;R.addEventListeners("onComplete",function(){S.publish(A.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:i.getActiveSheet(),VERSION:n})}),R.addEventListeners("onError",function(e){S.publish(A.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),R.open(u.FILTER_REMOVE,"sheetaction"),R.send(a)}function n(e,t,n,i){var r=new d.ParamGenerator(t,e,n,!1),o=c.data.getWorkBook(e,n),s=o.getSheetObj(r.getActiveSheet()),a=s.DataFilters,R=a.getAllRanges();for(var E in R){var l=R[E];i=new d.Range(l.startRow,l.startCol,l.endRow,l.endCol)}var L=r.getSheets(),g=r.getCustomRanges(i),v=r.getActiveCell(),O={RID:e,sheetList:L,VERSION:n,activeCell:v,rangeList:g},h=new C;h.addEventListeners("onComplete",function(){S.publish(A.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:r.getActiveSheet(),VERSION:n})}),h.addEventListeners("onError",function(e){S.publish(A.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(u.FILTER_REAPPLY),h.send(O)}function i(e,n,i){var r=new d.ParamGenerator(n,e,i),o=r.getSheets(),s=r.getRanges(),a=r.getActiveCell(),R={RID:e,sheetList:o,VERSION:i,activeCell:a,rangeList:s},E=c.data.getWorkBook(e,i),l=E.getSheetObj(r.getActiveSheet()),L=l.DataFilters;if(L.isRangesAvailable())return void t(e,n,i);var g=new v(O.CREATE_FILTER,R),h=new C;h.addEventListeners("onComplete",function(t){S.publish(A.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:r.getActiveSheet(),VERSION:i}),g.qaid=t.qaid,c.data.UserInfo.ActionRecorder.record(g)}),h.addEventListeners("onError",function(e){S.publish(A.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(u.CREATE_FILTER),h.send(R)}function r(e,t,n,i,r,o,s,a,R,E,l,L){var g=new d.ParamGenerator(t,e,n,!1),h=g.getSheets(),f=g.getCustomRanges(i),T=g.getActiveCell(),p={RID:e,sheetList:h,index:r,VERSION:n,activeCell:T,rangeList:f};void 0!=L&&isNaN(L)&&(L=O.SPECIAL_CRITERIA),(l&&l.length>0||E&&E.length>0||L||s&&s.length>0||a&&a.length>0||R||o)&&(p.fc2=l,p.fv2=E,p.filtertype=L,p.fv1=s,p.fc1=a,p.fo=R,p.dt=o);var D=new v(O.APPLY_FILTER,p),F=new C;F.addEventListeners("onComplete",function(t){S.publish(A.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:g.getActiveSheet(),VERSION:n}),D.qaid=t.qaid,c.data.UserInfo.ActionRecorder.record(D)}),F.addEventListeners("onError",function(e){S.publish(A.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),F.open(u.APPLYFILTER),F.send(p)}function o(e,t,n,i){var r=(c.data.getWorkBook(e,n),new d.ParamGenerator(t,e,n,!1)),o=r.getSheets(),s=r.getRanges(),a=r.getActiveCell(),R={RID:e,sheetList:o,rangeList:s,VERSION:n,activeCell:a,constant:i},E=new v(i,R),l=new C;l.addEventListeners("onComplete",function(t){S.publish(A.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:r.getActiveSheet(),VERSION:n}),E.qaid=t.qaid,c.data.UserInfo.ActionRecorder.record(E)}),l.addEventListeners("onError",function(e){S.publish(A.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),l.open(u.FILTERBYVALUE),l.send(R)}function s(e,t,n,i,r){o(e,t,n,O.FILTER_BY_FONT_COLOR,i,r)}function a(e,t,n,i,r){o(e,t,n,O.FILTER_BY_VALUE,i,r)}function R(e,t,n,i,r){o(e,t,n,O.FILTER_BY_CELL_COLOR,i,r)}function E(e,t,n,i,r,o,s,a){var R=(c.data.getWorkBook(e,n),new d.ParamGenerator(t,e,n,!1,!1)),E=R.getSheets(),l=R.getActiveSheet();s=void 0!=s?s:!0;var L={RID:e,filterCol:r,sheetList:E,filterRange:i,VERSION:n,index:o,isDataNeed:s},g=new C;g.addEventListeners("onComplete",function(t){var r=l,R={RID:e,SHEETID:r,VERSION:n,RANGE:i,INDEX:o,data:t};!s&&(R.clientData=a),S.publish(A.UserAction,I.SheetAction.DATAFILTER.FILTER_INFO,R)}),g.addEventListeners("onError",function(e){S.publish(A.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(u.GETFILTERINFO),g.send(L)}function l(e,t,n,i,o){var s=O.APPLY_FILTER_ALL;r(e,t,n,i,o,"","","","","","",s)}var c=e.sPlusPlus,L=e.ZSEvents,d=e.ZSClass,S=L.topic,A=L.Groups,I=L.Names,g=c.SML.Client,C=g.Utility.WorkerRequest,v=e.ZSClass.ActionObject,O=e.ZSConstants.ActionConstants,u=e.ZSConstants.URI;e.UserAction.RemoveFilter=t,e.UserAction.AddFilter=i,e.UserAction.ApplyFilter=r,e.UserAction.ReApplyFilter=n,e.UserAction.ClearFilter=l,e.UserAction.FilterByCellValue=a,e.UserAction.FilterByCellColor=R,e.UserAction.FilterByTextColor=s,e.UserAction.GetFilterInfo=E}(this);
!function(e){function t(t,n,s,i,E,u){var C=new e.ZSClass.ParamGenerator(n,t,s),N=C.getSheets(),O={RID:t,sheetList:N,countryName:i,timeZoneId:E,VERSION:s,setDefault:!1,sheetDirection:!1,docView:u},d=(new r(T.DOCUMENT_SETTING,O),new o);d.addEventListeners("onComplete",function(){}),d.addEventListeners("onError",function(e){S.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.DOCUMENT_SETTING),d.send(O)}function n(t,n,s){var i=new e.ZSClass.ParamGenerator(n,t,s),E=(i.getSheets(),{RID:t,VERSION:s}),u=(new r(T.FETCH_DOCUMENTSETTINGS,E),new o);u.addEventListeners("onComplete",function(e){if(e){var t=e.documentSettings;S.publish(a.Listener,c.UserAction.FETCH_DOCUMENT_SETTINGS,{RESPONSE:t})}}),u.addEventListeners("onError",function(e){S.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(R.FETCH_DOCUMENTSETTINGS),u.send(E)}var s=e.sPlusPlus,i=s.SML.Client,o=i.Utility.WorkerRequest,r=e.ZSClass.ActionObject,E=e.ZSEvents,S=E.topic,a=E.Groups,c=E.Names,u=e.ZSConstants,R=u.URI,T=(u.I18N,u.ActionConstants);e.UserAction.DocumentSetting=t,e.UserAction.fetchDocumentSettings=n}(this);
!function(t){function e(e,s,d,S){var E=new t.ZSClass.ParamGenerator(s,e,d,!0,!0),u=E.getSheets(),O={STOPSELECTION:!0},l={sheetList:u,ISSHOWGRID:S,VERSION:d,RID:e,action:a.HIDE_GRID,undoRedoOptions:O},C=a.HIDE_GRID,D=new R(C,l),G=new I;G.addEventListeners("onComplete",function(t){D.qaid=t.qaid,n.data.UserInfo.ActionRecorder.record(D)}),G.addEventListeners("onError",function(t){o.publish(i.Listener,r.ERROR.SHOW,{ERRORMSG:t.mk})}),G.open(c.HIDE_GRID),G.send(l)}var n=t.sPlusPlus,s=t.ZSEvents,o=s.topic,i=s.Groups,r=s.Names,a=t.ZSConstants.ActionConstants,R=t.ZSClass.ActionObject,c=t.ZSConstants.URI,d=n.SML.Client,I=d.Utility.WorkerRequest;t.UserAction.hideGridInViewport=e}(this);
!function(e){function t(e,t,n,s){o(e,t,n,s,0)}function n(e,t,n,s){o(e,t,n,0,s)}function o(e,t,n,o,r){var d=s.data.getWorkBook(e,n),S=d.getSheetObj(t[0]),A=new i.ParamGenerator(t,e,n),O=A.getSheets(),L=A.getActiveCell();(o>F.MAX_ROW_FREEZE||r>F.MAX_COL_FREEZE)&&(a.publish(R.Listener,E.ERROR.SHOW,{ERRORMSG:"FreezePanes.LastRowColNotAllowed"}),o=S.Row.FreezedCount,r=S.Column.FreezedCount);var Z=0===o&&0===r?c.UNFREEZE_PANES:c.FREEZE_PANES,p=new i.Range(o,r,o,r),w=A.getCustomRanges(p),z={RID:e,sheetList:O,rangeList:w,activeCell:L,VERSION:n,action:Z},U=new l(Z,z),f=new C;f.addEventListeners("onComplete",function(e){U.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(U),a.publish(R.Listener,E.UserAction.UpdateFreezeOptions,{FreezedRow:o,FreezedCol:r})}),f.addEventListeners("onError",function(e){a.publish(R.Listener,E.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(u.FREEZE_MODIFY),f.send(z)}var s=e.sPlusPlus,r=e.ZSEvents,i=e.ZSClass,a=r.topic,R=r.Groups,E=r.Names,c=e.ZSConstants.ActionConstants,l=e.ZSClass.ActionObject,u=e.ZSConstants.URI,d=s.SML.Client,C=d.Utility.WorkerRequest,F=s.data.Defaults;e.UserAction.Freeze=o,e.UserAction.FreezeRow=t,e.UserAction.FreezeCol=n}(this);
!function(e){function t(t,n,s,a,c){var R=new e.ZSClass.ParamGenerator(n,t,s),u=R.getSheets(),C=R.getRanges(),L=R.getActiveCell(),v={RID:t,VERSION:s,sheetList:u,rangeList:C,activeCell:L,ISTYPEAHEAD:a,action:S.PICK_LIST},I=new l;I.addEventListeners("onComplete",function(e){L.s;c&&c(e.result)}),I.addEventListeners("onError",function(e){i.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(E.PICK_LIST),I.send(v)}function n(t,n,s,a){var c=new e.ZSClass.ParamGenerator(n,t,s),R=c.getActiveCell(),S={RID:t,VERSION:s,activeCell:R},u=new l;u.addEventListeners("onComplete",function(e){a(t,R.s,s,e)}),u.addEventListeners("onError",function(e){i.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(E.PICK_LIST_RANGE),u.send(S)}var s=e.ZSEvents,i=s.topic,o=s.Groups,r=s.Names,a=e.ZSConstants,c=e.sPlusPlus,R=c.SML.Client,l=R.Utility.WorkerRequest,S=(e.ZSClass.ActionObject,a.ActionConstants),E=a.URI;e.UserAction.PickFromList=t,e.UserAction.getPickListRange=n}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,i=n.Groups,o=n.Names,r=t.SML.Client,a=r.Utility.WorkerRequest,c=e.ZSClass.ActionObject,E=e.ZSConstants,I=E.URI,R=E.ActionConstants,S=function(e,n,r,c){var E=t.view.getActiveGridID(),r=t.view.getVersionID(E),R={RID:e,VERSION:r,files:c},S=new a;S.addEventListeners("onComplete",function(t){s.publish(i.Listener,o.SheetAction.IMAGES.UPLOAD,{RID:e,SHEETID:n,VERSION:r,IMAGES:t.IMAGES})}),S.open(I.IMAGE_DRAG_DROP),S.send(R)},d=function(n,r,E,S,d,l){var u=new e.ZSClass.ParamGenerator(r,n,E),A=u.getSheets(),v=u.getActiveCell(),O=R[d],C=I[d],p={STOPSELECTION:!0},m={actionCnst:O,sheetList:A,sheetName:S,activeCell:v,VERSION:E,imageJson:l,RID:n,undoRedoOptions:p},D=new c(O,m),G=new a;G.addEventListeners("onComplete",function(e){D.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(D)}),G.addEventListeners("onError",function(e){s.publish(i.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),G.open(C),G.send(m)};e.UserAction.ImageAction=d,e.UserAction.uploadImage=S}(this);
!function(e){function t(t,n,a,l,R){var S=new e.ZSClass.ParamGenerator(n,t,a,!0,!0),d=S.getSheets(),C=R?S.getCustomRanges(R):S.getRanges(),E="HIDE"==l?c.HIDEROWS_ADD:c.HIDEROWS_REMOVE,I="HIDE"==l?s.HIDE_ROWS:s.UNHIDE_ROWS,u=S.getActiveCell(),D={allowRowScroll:!0},O={RID:t,sheetList:d,rangeList:C,VERSION:a,activeCell:u,action:I,undoRedoOptions:D},g=new o(I,O),H=new r;H.addEventListeners("onComplete",function(e){g.qaid=e.qaid,i.data.UserInfo.ActionRecorder.record(g)}),H.open(E),H.send(O)}var n=e.ZSConstants,s=n.ActionConstants,o=e.ZSClass.ActionObject,i=e.sPlusPlus,a=i.SML.Client,r=a.Utility.WorkerRequest,c=e.ZSConstants.URI;e.UserAction.HideRow=t}(this);
!function(e){function t(t,n,a,C,c){var S=new e.ZSClass.ParamGenerator(n,t,a,!0,!0),d=S.getSheets(),E=c?S.getCustomRanges(c):S.getRanges(),I="HIDE"==C?r.HIDECOLS_ADD:r.HIDECOLS_REMOVE,u="HIDE"==C?s.HIDE_COLUMNS:s.UNHIDE_COLUMNS,D=S.getActiveCell(),R={allowColScroll:!0},L={RID:t,sheetList:d,rangeList:E,VERSION:a,activeCell:D,action:u,undoRedoOptions:R},O=new o(u,L),g=new l;g.addEventListeners("onComplete",function(e){O.qaid=e.qaid,i.data.UserInfo.ActionRecorder.record(O)}),g.open(I),g.send(L)}var n=e.ZSConstants,s=n.ActionConstants,o=e.ZSClass.ActionObject,i=e.sPlusPlus,a=i.SML.Client,l=a.Utility.WorkerRequest,r=e.ZSConstants.URI;e.UserAction.HideCol=t}(this);
!function(e){function t(e,t,s,n,C,i,T,l,A,c){var I=new E.ParamGenerator(s,e,t),_=N.Range.parseRange(e,t,n),O=N.Range.parseRange(e,t,C),g=_.sheetName,u=O.sheetName,V=O.range,H=_.range,_=N.Cell.getReference(H.startRow,H.startCol),s=I.getSheets(),p=I.getCustomRanges(V),v=I.getActiveCell(),P={RID:e,VERSION:t,SHEET_LIST:s,RANGE_LIST:p,activeCell:v,OBJECTIVE_CELL:_,OBJECTIVE_CELL_SHEETNAME:g,VARIANT_CELLS_SHEETNAME:u,NON_NEG_RESTRICTION:T,IS_VALUEBOX_SELECTED:l,SPECIFICVALUE:A,GOAL_TYPE:i,CONSTRAINTS_LHS:c.constrLHS,CONSTRAINTS_REL:c.constrREL,CONSTRAINTS_RHS:c.constrRHS},U=(o.SOLVER,new L);U.addEventListeners("onComplete",function(e){S.publish(R.Listener,a.UserAction.SOLVER.RESP_HANDLE,{RESPONSE:e})}),U.open(r.SOLVER),U.send(P)}var s=e.sPlusPlus,n=e.ZSEvents,E=e.ZSClass,S=n.topic,R=n.Groups,a=n.Names,o=e.ZSConstants.ActionConstants,r=(e.ZSClass.ActionObject,e.ZSConstants.URI),C=s.SML.Client,L=C.Utility.WorkerRequest,N=e.JSUtil;e.UserAction.solver=t}(this);
!function(e){function t(e,t,s,u,d,C,R,L){var I=new l.ParamGenerator(t,e,s),O=I.getSheets(),m=I.getActiveCell(),A={RID:e,sheetList:O,vCellSheetName:u,tCellSheetName:d,vCellLbl:C,tCellLbl:R,VERSION:s,activeCell:m,action:r.GOAL_SEEK,desiredValue:L},v=r.GOAL_SEEK,g=new c(v,A),h=new E;h.addEventListeners("onComplete",function(t){o.publish(i.Listener,a.UserAction.GOALSEEK_PROMPT,{response:t,RID:e,SHEETID:m.s,VERSION:s,columnIndex:t.columnIndex,rowIndex:t.rowIndex,message:t.message,TargetCellValue:t.TargetCellValue,solution:t.solution}),g.qaid=t.qaid,n.data.UserInfo.ActionRecorder.record(g)}),h.addEventListeners("onError",function(e){o.publish(i.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(S.GOALSEEK),h.send(A)}var n=e.sPlusPlus,s=e.ZSEvents,l=e.ZSClass,o=s.topic,i=s.Groups,a=s.Names,r=e.ZSConstants.ActionConstants,c=e.ZSClass.ActionObject,S=e.ZSConstants.URI,u=n.SML.Client,E=u.Utility.WorkerRequest;e.UserAction.goalSeek=t}(this);
!function(e){function t(e,t,n,o,s,r,i,E,R){var c={VERSION:n,RID:e,isURLImport:s,files:o,action:r,delimiter:i,password:R};s&&(c.xurl=encodeURIComponent(o));var l=new a;l.addEventListeners("onComplete",function(o){E(e,t,n,o,r)}),l.open(d.IMPORT_CREATE_NEW),l.send(c)}function n(e,t,n,o,i){var E=s.data.getWorkBook(e,n),u=E.getSheetObj(t[0]),C=u.Prop.Name,m=i.fname,p=I[o],L=d[o],S=new ZSClass.ParamGenerator(t,e,n),N=S.getSheets(),O=i.startCell?S.getCustomRanges(i.startCell):S.getRanges(),f={RID:e,srID:i.rid,sheetList:N,currentSheet:C,VERSION:n,sourceDocName:m,action:p,rangeList:O},_=(new r(p,f),new a);_.addEventListeners("onComplete",function(t){p==I[o]&&R.publish(c.Listener,l.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:n,qaid:t.qaid})}),_.addEventListeners("onError",function(e){R.publish(c.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(L),_.send(f)}function o(e,t,n,o){var s={RID:e,VERSION:t,url:n,action:I.GET_FILE_CONTENT_FROM_URL},r=new a;r.addEventListeners("onError",function(e){o&&o(e)}),r.addEventListeners("onComplete",function(e){o&&o(e)}),r.open(d.GET_FILE_CONTENT_FROM_URL),r.send(s)}var s=e.sPlusPlus,r=e.ZSClass.ActionObject,i=s.SML.Client,a=i.Utility.WorkerRequest,E=e.ZSEvents,R=E.topic,c=E.Groups,l=E.Names,u=e.ZSConstants,d=u.URI,I=(u.I18N,u.ActionConstants);e.UserAction.fileImport=t,e.UserAction.import=n,e.UserAction.getFileContentFromUrl=o}(this);
!function(e){function n(e,n,t,o,i,u,E,D,R){var l={RID:e,VERSION:n,SOURCE:t,FOLDERID:i,DOCNAME:u},C=new r;C.addEventListeners("onError",function(e){R&&R(e)}),C.addEventListeners("onComplete",function(e){R&&R(e)}),C.open(s.EXPORT_TO_CLOUD_DRIVES),C.send(l)}var t=e.sPlusPlus,o=t.SML.Client,s=e.ZSConstants.URI,r=(e.ZSDevTools.Logger,o.Utility.WorkerRequest),i=e.UserAction;i.exportToCloudDrives=n}(this);
!function(e){function n(e,n,t,s,r,i){var o=new ZSClass.ParamGenerator(n,e,t,!0,!0),a=o.getSheets(),R=s?o.getCustomRanges(s):o.getRanges(),d=o.getActiveCell(),O=I.CONDITIONAL_FORMAT_READ_DATATYPE,A={RID:e,VERSION:t,rangeList:R,sheetList:a,activeCell:d,action:O},v=(new C(O,A),new S);v.addEventListeners("onComplete",function(n){E.publish(l.Listener,c.UserAction.CONDITIONAL_FORMAT.FIND_DATA_TYPE,{RID:e,SHEETID:d.s,VERSION:t,DATA_TYPE:n.DATATYPE,CR_TYPE:r,MANAGE_REQ:i})}),v.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(L.CONDITIONAL_FORMAT_READ_DATATYPE),v.send(A)}function t(n,t,s,r,i,o,a,R){var d=new ZSClass.ParamGenerator(t,n,r),O=d.getActiveCell(),s=d.getCustomRanges(s,!0),A=d.getSheets(),v=I.VALIDATE_INPUT_CF,u={RID:n,sheetList:A,rangeList:s,activeCell:O,VERSION:r,valCFInpsJson:e.JSON.stringify(i),validateFor:o,action:v},g=(new C(v,u),new S);g.addEventListeners("onComplete",function(e){e.valinp.isError?R&&R(e,i):a&&a(i,e,n,t,r)}),g.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(L.VALIDATE_INPUT_CF),g.send(u)}function s(n,t,s,r,i,o,a){var d=new ZSClass.ParamGenerator(r,s,i,!0),O=n.datarange,A=d.getParmsFromDataString(O),v=d.getActiveCell(),u=A.ranges,g=A.sheets,T=I[o];n.asn||(e.ZSDevTools.Logger.log("Handle this ::: 'asn' should be set on CF inputJson"),n.asn=r[0]);var m={RID:s,sheetList:g,activeCell:v,rangeList:u,VERSION:i,conditionsparam:e.JSON.stringify(n),action:T},D=new C(T,m),N=new S;N.addEventListeners("onComplete",function(e){D.qaid=e.qaid,R.data.UserInfo.ActionRecorder.record(D),a&&a()}),N.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(L[o]),N.send(m)}function r(e,n,t,s){var r=new ZSClass.ParamGenerator(n,e,t,!0),i=r.getSheets(),o=r.getCustomRanges(s),a=r.getActiveCell(),d=I.CONDITIONAL_FORMAT_CLEAR_RULE,O={RID:e,sheetList:i,rangeList:o,activeCell:a,VERSION:t,endCol:s.endCol,action:d},A=new C(d,O),v=new S;v.addEventListeners("onComplete",function(e){A.qaid=e.qaid,R.data.UserInfo.ActionRecorder.record(A)}),v.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(L.CONDITIONAL_FORMAT_CLEAR_RULE),v.send(O)}function i(e,n,t,s,r,i,o){var a=new ZSClass.ParamGenerator(t,e,s),d=a.getActiveCell(),O=I.CONDITIONAL_STYLE_REORDER,A=a.getParmsFromDataString(o),v={RID:e,currentSheet:n,sheetList:A.sheets,rangeList:A.ranges,activeCell:d,VERSION:s,reoderObj:i,currSheetName:r,action:O},u=new C(O,v),g=new S;g.addEventListeners("onComplete",function(e){u.qaid=e.qaid,R.data.UserInfo.ActionRecorder.record(u)}),g.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(L.CONDITIONAL_STYLE_REORDER),g.send(v)}function o(e,n,t,s,r,i){var o=new ZSClass.ParamGenerator(n,e,t,!0,!0),a=o.getSheets(),R=o.getActiveCell(),d=I[s],O=void 0;O=r&&-1==r.startRow?void 0:r?o.getCustomRanges(r):o.getRanges();var A={RID:e,activeCell:R,sheetList:a,version:t,action:d,rangeList:O,dateFormat:i},v=(new C(d,A),new S);v.addEventListeners("onComplete",function(e){E.publish(l.Listener,c.UserAction.CONDITIONAL_FORMAT.READ_RULES,{RESPONSE:e.CONDITIONALFORMAT})}),v.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(L[s]),v.send(A)}function a(e,n,t,s,r,i){var o=R.view.getActiveGridID(),a=R.view.getVersionID(o),d=new ZSClass.ParamGenerator(n,e,a),O=(d.getActiveCell(),I.CONDITIONAL_FORMAT_DELETE),A=d.getParmsFromDataString(r),v={RID:e,conditionsparam:s,sheetList:A.sheets,rangeList:A.ranges,VERSION:a,action:O},u=new C(O,v),g=new S;g.addEventListeners("onComplete",function(e){i.classList.add("bOr","aDd"),setTimeout(function(){i.remove()},1e3),u.qaid=e.qaid,R.data.UserInfo.ActionRecorder.record(u)}),g.addEventListeners("onError",function(e){E.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(L.CONDITIONAL_FORMAT_DELETE),g.send(v)}{var R=e.sPlusPlus,d=e.ZSEvents,E=d.topic,l=d.Groups,c=d.Names,O=e.ZSConstants,A=R.SML.Client,L=(A.Utility.WorkerRequest,O.URI),C=e.ZSClass.ActionObject,I=O.ActionConstants,S=A.Utility.WorkerRequest;e.ZSConstants.I18N,JSUtil.fn}e.UserAction.dataType=n,e.UserAction.CFValidation=t,e.UserAction.applyConditionalFormat=s,e.UserAction.clearConditionalFormat=r,e.UserAction.reordeRules=i,e.UserAction.readConditionalFormatRules=o,e.UserAction.deleteConditionalFormat=a}(this);
!function(e){function t(t,n,s,i,R,S,T,u,A){switch(i){case"FORMATCELLS_GRID":i=E.FORMATCELLS_GRID;break;case"FORMATCELLS_CLIENT":i=E.FORMATCELLS_CLIENT;break;default:return void logger.log("undefined action : ",i)}var O=new e.ZSClass.ParamGenerator(n,t,s,!0,!0),M=O.getSheets(),d=O.getRanges(),f=O.getActiveCell(),I={action:i,sheetList:M,rangeList:d,activeCell:f,RID:t,VERSION:s,formatType:R,formatString:S,formatCellsParam:T},F=new l(i,I),_=new C;_.addEventListeners("onComplete",function(e){if(i===E.FORMATCELLS_CLIENT){var t=e.format?e.format:{};r.publish(o.Listener,L.CellMeta.FORMATCELLS_CLIENT,{FORMAT:t}),u&&u(e)}else{{e.qaid}F.qaid=e.qaid,a.data.UserInfo.ActionRecorder.record(F)}A&&A()}),_.addEventListeners("onError",function(e){r.publish(o.Listener,L.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(c.NUMBER_FORMAT_MODIFY),_.send(I)}function n(e,n,s,a,i,r){t(e,n,s,"FORMATCELLS_GRID",a,i,r)}function s(e,n,s,a,i,r){t(e,n,s,"FORMATCELLS_CLIENT",null,null,a,i,r)}var a=e.sPlusPlus,i=e.ZSEvents,r=i.topic,o=i.Groups,L=i.Names,R=a.SML.Client,C=R.Utility.WorkerRequest,l=e.ZSClass.ActionObject,E=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.FORMATCELLS_GRID=n,e.UserAction.FORMATCELLS_CLIENT=s}(this);
!function(e){function t(e,t,n,a,i){var s=new E.ParamGenerator(t,e,n,!1),o=s.getSheets(),r=s.getRanges(),N=s.getActiveCell(),R={sheetList:o,RID:e,rangeList:r,activeCell:N,VERSION:n,RANGENAME:a,RANGE:encodeURIComponent(i),type:"add",action:c.NAMEDRANGE_ADD},d=new A;d.open(g.NAMED_RANGE_ADD),d.addEventListeners("onComplete",function(){}),d.send(R)}function n(e,t,n,a){var i=new E.ParamGenerator(t,e,n,!1),s=i.getSheets(),o=i.getRanges(),r=i.getActiveCell(),N={RID:e,RANGENAME:a,activeCell:r,VERSION:n,sheetList:s,rangeList:o,type:"delete",action:c.NAMEDRANGE_DELETE},R=new A;R.open(g.NAMED_RANGE_DELETE),R.addEventListeners("onComplete",function(){}),R.send(N)}function a(e,t,n,a,i){var o=(s.data.getWorkBook(e,n),s.view.getActiveGridID()),n=s.view.getVersionID(o),r=(s.view.getSheetState(o,t[0]),new E.ParamGenerator(t,e,n,!1)),N=r.getSheets(),R=r.getRanges(),d=r.getActiveCell(),l={sheetList:N,rangeList:R,RID:e,activeCell:d,RANGENAME:a,RANGE:encodeURIComponent(i),VERSION:n,type:"modify",action:c.NAMEDRANGE_MODIFY},v=new A;v.open(g.NAMED_RANGE_MODIFY),v.addEventListeners("onComplete",function(){}),v.send(l)}function i(e,t,n){var a=(s.data.getWorkBook(e,n),s.view.getActiveGridID()),n=s.view.getVersionID(a),i=(s.view.getSheetState(a,t[0]),new E.ParamGenerator(t,e,n,!1)),o=i.getSheets(),r=i.getRanges(),N=i.getActiveCell(),R={RID:e,VERSION:n,sheetList:o,rangeList:r,activeCell:N,type:"getNamedRanges",action:c.JSP_NAMEDRANGE},d=new A;d.open(g.GET_NAMED_RANGES),d.addEventListeners("onComplete",function(){}),d.send(R)}var s=e.sPlusPlus,o=e.ZSEvents,E=(o.topic,o.Groups,o.Names,e.ZSClass),r=s.SML.Client,A=r.Utility.WorkerRequest,g=(E.ActionObject,e.ZSConstants.URI),c=e.ZSConstants.ActionConstants;e.UserAction.addNamedRange=t,e.UserAction.deleteNamedRange=n,e.UserAction.modifyNamedRange=a,e.UserAction.getNamedRangeList=i}(this);
!function(e){function t(e,t,n,s,i,a){var r=new L.ParamGenerator(t,e,s),o=r.getSheets(),A=i?r.getCustomRanges(i,!0):r.getRanges(),R=r.getActiveCell(),d={RID:e,VERSION:s,sheetList:o,rangeList:A,activeCell:R,currSheetName:n,action:g.DATA_VALIDATION_READRANGE,dateFormat:a},E=new D;E.addEventListeners("onComplete",function(e){c.publish(l.Listener,I.UserAction.DATA_VALIDATION.VALIDATION,{DV_JSON:e.dataval})}),E.addEventListeners("onError",function(e){c.publish(l.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(u.DATA_VALIDATION_READRANGE),E.send(d)}function n(e,t,n,s,i,a){var r=new L.ParamGenerator(t,e,n,!0),o=r.getSheets(),R=r.getCustomRanges(i,!0),d=r.getActiveCell(),E={RID:e,dvJSON:s,VERSION:n,SHEETID:s.asn,action:g.DATA_VALIDATION_APPLY,sheetList:o,rangeList:R,activeCell:d},v=new S(g.DATA_VALIDATION_APPLY,E),O=new D;O.addEventListeners("onComplete",function(e){v.qaid=e.qaid,A.data.UserInfo.ActionRecorder.record(v),a&&c.publish(l.Listener,I.UserAction.DATA_VALIDATION.MANAGE_DIALOG,{REQ_NEED:!0})}),O.addEventListeners("onError",function(e){c.publish(l.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(u.DATAVALIDATION_ADD),O.send(E)}function s(e,t,n,s,i,a){var r=new L.ParamGenerator(t,e,n,!0),o=r.getSheets(),A=s?r.getCustomRanges(s,!0):r.getRanges(),R=r.getActiveCell(),d={rID:e,sheetList:o,rangeList:A,VERSION:n,action:g.DATA_VALIDATION_CLEAR,activeCell:R},v=new D;v.addEventListeners("onComplete",function(){if(i){var e=i.parentElement;i.remove(),0==e.childElementCount&&e.appendChild(a)}}),v.addEventListeners("askConfirm",function(e){var t=new L.ZSConfirm(E[e.mk]);t.onYES(function(){v.resend()});var n=t.execute();c.publish(l.Listener,I.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),v.addEventListeners("onError",function(e){c.publish(l.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(u.DATA_VALIDATION_CLEAR),v.send(d)}function i(e,t,n){var s=new L.ParamGenerator(t,e,n),i=s.getSheets(),a={RID:e,sheetList:i,VERSION:n},r=new D;r.addEventListeners("onComplete",function(){}),r.addEventListeners("onError",function(e){c.publish(l.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),r.open(u.DATA_HIGHLIGHT_INVALID),r.send(a)}function a(e,t,n,s,i,a,r){var o=new L.ParamGenerator(t,e,n),A=o.getSheets(),R=o.getCustomRanges(i,!0),d=o.getActiveCell(),E="datavalidation",v=JSON.stringify(s),O={RID:e,sheetList:A,VERSION:n,validateFor:E,activeCell:d,valInpsJson:v,rangeList:R,action:g.VALIDATE_INPUT},T=(new S(g.VALIDATE_INPUT,O),new D);T.addEventListeners("onComplete",function(o){o.valinp.isError?r&&r(o,s):a&&a(e,t,n,s,i)}),T.addEventListeners("onError",function(e){c.publish(l.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(u.VALIDATE_INPUT),T.send(O)}function r(e,t,n,s,i,a,r){var o=new L.ParamGenerator(t,e,s),A=o.getSheets(),R=a?o.getCustomRanges(a):o.getRanges(),d=o.getActiveCell(),E={RID:e,sheetList:A,rangeList:R,activeCell:d,VERSION:s,action:g[i],dateFormat:r},v=new D;v.addEventListeners("onComplete",function(e){c.publish(l.Listener,I.UserAction.DATA_VALIDATION.MANAGE,{ALL_DV:e.dataval})}),v.addEventListeners("onError",function(e){c.publish(l.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(u[i]),v.send(E)}function o(e,t,n,s,i,a,r,o,R,d){var E=(A.data.getWorkBook(e,n),A.view.getActiveGridID()),v=A.view.getSelectedSheets(E),S=new L.ParamGenerator(v,e,n),g=S.getSheets(),O=S.getRanges(),T=S.getActiveCell();if(!o||!R){var m=[];for(var C in R)m.push(decodeURIComponent(R[C]));return m=d?m.sort():m,void c.publish(l.Listener,I.UserAction.DATA_VALIDATION.SHOW_LIST,{LIST_ARRAY:m})}R=JSUtil.Range.parseRange(e,n,R);var N={RID:e,sheetID:t,VERSION:n,row:s,col:i,sheetList:g,rangeList:O,activeCell:T,totalParts:a,partNum:r,rangeObj:R},p=new D;p.addEventListeners("onComplete",function(e){c.publish(l.Listener,I.UserAction.DATA_VALIDATION.LIST_RESPONSE,{LIST_JSON:d?e.sort():e})}),p.addEventListeners("onError",function(){}),p.open(u.DATA_VALIDATION_READLIST),p.send(N)}var A=e.sPlusPlus,R=e.ZSEvents,L=e.ZSClass,c=R.topic,l=R.Groups,I=R.Names,d=e.ZSConstants,L=e.ZSClass,E=d.I18N,v=A.SML.Client,D=v.Utility.WorkerRequest,u=d.URI,S=(e.encodeURIComponent,L.ActionObject),g=d.ActionConstants;e.UserAction.ValidateInput=a,e.UserAction.CreateDataValidation=n,e.UserAction.RemoveDataValidation=s,e.UserAction.HighlightInvalidData=i,e.UserAction.ValidateDvRange=t,e.UserAction.ReadDataValidation=r,e.UserAction.getListValues=o}(this);
!function(e){function n(n,t,s,o,r,i,c,l,d,u,I){var p=new e.ZSClass.ParamGenerator(s,n,t,!0),v=p.getSheets(),W=p.getActiveCell(),b=e.encodeURIComponent,m={RID:n,VERSION:t,sheetList:v,SHEETID:o,sheetName:r,mode:i,activeCell:W,url:b(c),webDataSheet:l,webDataCell:d,webDataInterval:u,selectTbls:I},O=new D(L.WEB_DATA,m),_=new S;_.addEventListeners("onComplete",function(e){O.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(O)}),_.addEventListeners("onError",function(e){a.publish(R.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(T.WEB_DATA),_.send(m)}function t(n,t,s,o,E,r){r.classList.add("ZsRt");var i=e.encodeURIComponent,c={RID:n,VERSION:s,SHEETID:t,mode:o,url:i(E)},l=(new D(L.GET_HTML_WEBDATA,c),new S);l.addEventListeners("onComplete",function(e){a.publish(R.Listener,A.UserAction.WEB_DATA.READ_TABLES,{TABLES:e.webdataXML}),r.classList.remove("ZsRt")}),l.addEventListeners("onError",function(e){a.publish(R.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),l.open(T.GET_HTML_WEBDATA),l.send(c)}function s(e,n,t,s){var o={RID:e,SHEETID:n,VERSION:t,versionNo:s},E=(new D(L.WEBDATA_LIST,o),new S);E.addEventListeners("onComplete",function(e){a.publish(R.Listener,A.UserAction.WEB_DATA.LIST,{LIST_ARRAY:e.WEBDATA_LIST})}),E.addEventListeners("onError",function(e){a.publish(R.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(T.WEBDATA_LIST),E.send(o)}function o(e,n,t,s,o,E,r,c,l,u,I,p,v,W){var b=new i.ParamGenerator(n,e,o,!0,!0),m=b.getSheets(),O={RID:e,SHEETLIST:m,VERSION:o,SHEETID:t,SHEETNAME:s,WEBDATA_SHEET:r,MODE:E,CELL:u,ID:c,url:p?d(p):"",FEED:l,webDataInterval:v,selectTbls:W},_=(new D(L.UPDATE_WEB_DATA,O),new S);_.addEventListeners("onComplete",function(){I&&I()}),_.addEventListeners("onError",function(e){a.publish(R.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(T.UPDATE_WEB_DATA),_.send(O)}var E=e.sPlusPlus,r=e.ZSEvents,i=e.ZSClass,a=r.topic,R=r.Groups,A=r.Names,c=e.ZSConstants,i=e.ZSClass,l=(c.I18N,E.SML.Client),S=l.Utility.WorkerRequest,T=c.URI,d=e.encodeURIComponent,D=i.ActionObject,L=c.ActionConstants;e.UserAction.ApplyWebData=n,e.UserAction.ReadTables=t,e.UserAction.getWebDataList=s,e.UserAction.refreshWebData=o}(this);
!function(e){function n(e,n,t,s,r,o,i,a){var R=new d.ParamGenerator(n,e,s,!0),c=R.getSheets(),u=R.getActiveCell(),g=t?R.getCustomRanges(t,!0):R.getRanges(),v={RID:e,sheetList:c,unAuthUsers:o.toString(",",!0),VERSION:s,rangeList:g,activeCell:u,isSheet:i,isExtend:a,action:C.LOCK_RANGE};r.length>0&&(v.authUsers=r.toString(",",!0));var f=new l(C.LOCK_RANGE,v),p=new h;p.addEventListeners("onComplete",function(e){f.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(A.LOCK_RANGE_ADD),p.send(v)}function t(e,n,t,s,r,o){var i=new d.ParamGenerator(n,e,t,!0),a=i.getSheets(),R=void 0==o?i.getRanges():i.getCustomRanges(o),E=i.getActiveCell(),c=C.PROTECT_RANGE_DIALOG,u={RID:e,sheetList:a,VERSION:t,activeCell:E,rangeList:R,isSheet:s,isExtend:r,action:c},g=(new l(c,u),new h);g.addEventListeners("onComplete",function(e){L.publish(S.Listener,O.UserAction.SHOW_LOCK_INFO,{lockInfo:e,isSheet:s})}),g.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(A.PROTECT_RANGE_DIALOG),g.send(u)}function s(e,n,t,s){var r=new d.ParamGenerator([n],e,s,!0),o=r.getSheets(),i=r.getActiveCell(),a=t?r.getCustomRanges([t],!0):r.getRanges(),R=C.UNLOCK_RANGE,c={RID:e,sheetList:o,activeCell:i,VERSION:s,rangeList:a,action:R},u=new l(R,c),g=new h;g.addEventListeners("onComplete",function(e){u.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(u)}),g.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(A.UNLOCK_RANGE),g.send(c)}function r(e,n,t,s,r){var o=new d.ParamGenerator(n,e,t,!1),i=o.getSheets(),a=C.LOCK_SHEET,R={RID:e,sheetList:i,VERSION:t,unAuthUsers:r.toString(",",!0),action:a};s.length>0&&(R.authUsers=s.toString(",",!0));var c=new l(a,R),u=new h;u.addEventListeners("onComplete",function(e){c.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(c)}),u.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(A.LOCK_SHEET),u.send(R)}function o(e,n,t){var s=new d.ParamGenerator([n],e,t,!1),r=s.getSheets(),o=C.UNLOCK_SHEET,i={RID:e,VERSION:t,sheetList:r,action:o},a=new l(o,i),R=new h;R.addEventListeners("onComplete",function(e){a.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(a)}),R.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),R.open(A.UNLOCK_SHEET),R.send(i)}function i(e,n,t,s,r){var o=new d.ParamGenerator(r?n:[t],e,s,!0),i=o.getSheets(),a=r?"":t,R=C.READ_PROTECTED_RANGES,E={RID:e,sheetList:i,currentSheet:a,VERSION:s,validateSharedUsers:!0,action:R},c=(new l(R,E),new h);c.addEventListeners("onComplete",function(e){L.publish(S.Listener,O.UserAction.READ_LOCKS,{lockInfo:e.pr,isSheet:!1,isWholeDoc:r})}),c.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),c.open(A.READ_PROTECTED_RANGES),c.send(E)}function a(e,n,t){var s=new d.ParamGenerator(n,e,t,!0),r=s.getSheets(),o=C.READ_PROTECTED_SHEETS,i={RID:e,sheetList:r,VERSION:t,action:o},a=(new l(o,i),new h);a.addEventListeners("onComplete",function(e){L.publish(S.Listener,O.UserAction.READ_LOCKS,{lockInfo:e.ps,isSheet:!0})}),a.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(A.READ_PROTECTED_SHEETS),a.send(i)}function R(e,n,t,s,r){var o=new d.ParamGenerator(t,e,s,!0),i=o.getSheets(),a={RID:e,sheetList:i,prObj:n,VERSION:s,isSheet:r,action:C.LOCK_MULTIPLE},R=new l(C.LOCK_MULTIPLE,a),c=new h;c.addEventListeners("onComplete",function(e){R.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(R)}),c.addEventListeners("onError",function(e){L.publish(S.Listener,O.ERROR.SHOW,{ERRORMSG:e.mk})}),c.open(A.LOCK_MULTIPLE),c.send(a)}var E=e.sPlusPlus,c=e.ZSEvents,d=e.ZSClass,L=c.topic,S=c.Groups,O=c.Names,u=E.SML.Client,h=u.Utility.WorkerRequest,l=e.ZSClass.ActionObject,C=e.ZSConstants.ActionConstants,A=e.ZSConstants.URI;e.UserAction.LockRange=n,e.UserAction.checkRangeLockInfo=t,e.UserAction.RemoveLockRange=s,e.UserAction.LockSheet=r,e.UserAction.UnlockSheet=o,e.UserAction.readProtectedRanges=i,e.UserAction.readProtectedSheets=a,e.UserAction.manageLockRange=R}(this);
!function(e){function t(){it.call(this)}function n(){var e=H.view.Events.Key;e.focusContext(dt)}function i(){var e=H.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function a(){var e=k.getTemplate(["ziaIcon"]);this.icon.appendChild(e.ziaIcon),this.icon.classList.add("sPZIABtm"),At=this.icon}function r(){setTimeout(function(){b=V.add({onCreate:a,callBack:u,allowed:J,direction:j}),b.onOpen=A,b.onClose=c,s(),l()},1e3)}function l(){var e=dt.keyDown;e[tt.UP]=function(){return F.publish(K.UI,x.SidePanel.ZIA.SEARCH_SELECT,{DIRECTION:tt.UP}),!1},e[tt.DOWN]=function(){return F.publish(K.UI,x.SidePanel.ZIA.SEARCH_SELECT,{DIRECTION:tt.DOWN}),!1}}function s(){var e=q.Wrapper.DOMUtils;e.addAttributes(At,{title:et["MenuItem.DataTab.Explore"]}),e.addEventByNode(At,e.Events.CLICK,o)}function o(){}function d(){b&&b.toggle(),w&&clearTimeout(w)}function E(){m&&(m.value=""),m&&(m.Editor.style.border="")}function A(){Y.Right.sidePanel=340,this.holder.setWidth(340),n();var e=new ZSZIA.Controller.ZController;e.openPanel()}function c(){Y.Right.sidePanel=0,this.holder.setWidth(0),i();var e=new ZSZIA.Controller.ZController;e.closePanel()}function u(){var e=q.Wrapper.DOMUtils,t=k.getTemplate(["SP_ZIA_FILTER_TEMPLATE","SP_ZIA_AGGREGATE_REPORT_TEMPLATE","SP_ZIA_WRAPPER_TEMPLATE","SP_ZIA_REPORT_WRAPPER_TEMPLATE","SP_ZIA_RECOMMEND_LIST","SP_ZIA_QUERY_TEMPLATE","SP_ZIA_MIXED_REPORT_TEMPLATE","SP_ZIA_TABLE_REPORT_TEMPLATE","SP_ZIA_GRAPH_REPORT_TEMPLATE","SP_ZIA_ERROR_REPORT_TEMPLATE","SP_ZIA_MORE_REPORT_TEMPLATE","SP_ZIA_ICON_TEMPLATE","SP_ZIA_CONTAINER","SP_ZIA_RANGE_TEMPLATE"]);this.panel.addEventListener("mousedown",n),this.panel.appendChild(t.SP_ZIA_CONTAINER),D=this.panel.querySelector("#pivotRec_container"),z=document.createElement("span"),z.classList.add("ZsLoader"),G=document.createElement("div"),G.classList.add("ziaTxt"),e.hide(G),N=document.createElement("div"),N.classList.add("ziaLoadArea"),D.appendChild(t.SP_ZIA_ICON_TEMPLATE),D.appendChild(t.SP_ZIA_RANGE_TEMPLATE),D.appendChild(t.SP_ZIA_WRAPPER_TEMPLATE);var i=D.querySelector("#zWrapper");i.appendChild(t.SP_ZIA_REPORT_WRAPPER_TEMPLATE),i.appendChild(t.SP_ZIA_MORE_REPORT_TEMPLATE);var a=document.getElementById("popupmenu");a.appendChild(t.SP_ZIA_FILTER_TEMPLATE);var r=i.querySelector("#rPlC");r.appendChild(t.SP_ZIA_RECOMMEND_LIST),N.appendChild(z),N.appendChild(G),r.appendChild(N),e.hide(N);var l=r.querySelector("#recommendedReportList");l.appendChild(t.SP_ZIA_AGGREGATE_REPORT_TEMPLATE),l.appendChild(t.SP_ZIA_QUERY_TEMPLATE),l.appendChild(t.SP_ZIA_MIXED_REPORT_TEMPLATE),l.appendChild(t.SP_ZIA_TABLE_REPORT_TEMPLATE),l.appendChild(t.SP_ZIA_GRAPH_REPORT_TEMPLATE),l.appendChild(t.SP_ZIA_ERROR_REPORT_TEMPLATE),I(D),F.publish(K.UI,x.SidePanel.ZIA.SHOW_LOADER)}function I(e){var t=q.Wrapper.DOMUtils,n=e.querySelector("#explBtns");B=e.querySelector("#expFilter");var i=n.children,a=i[i.length-1].children,r=e.querySelector("#Formula");t.addEventByNode(i[0],t.Events.CLICK,R),t.addEventByNode(a[1],t.Events.CLICK,S),t.addEventByNode(a[0],t.Events.CLICK,p),B.setAttribute("data-content","#zFltWrapper"),B.setAttribute("data-is-content-html-encoded",!0),B.setAttribute("data-class-name","sPZIAFltr"),B.setAttribute("data-position","bottom-right"),nt.zpopover(B);var l=e.querySelector("#expCellRef");D.querySelector(".zsRangePicker").classList.add("zRDisable"),m=new Q.Editors.RangeEditor(l),Q.RangePicker.register(m,!0),t.addEvent("pivotRec_container",t.Events.CLICK,function(){F.publish(K.UI,x.SidePanel.ZIA.SCROLL)}),t.addEventByNode(e.querySelector("#closeZia"),t.Events.CLICK,function(){F.publish(K.UI,x.SidePanel.ZIA.TOGGLE)}),t.addEventByNode(e.querySelector("#voice_cancel"),t.Events.CLICK,function(){P(this)}),t.addEventByNode(e.querySelector("#askQuestion"),t.Events.KEYUP,function(e){var t=e.keyCode||e.which;if(13===t)F.publish(K.UI,x.SidePanel.ZIA.PROCESS_QUERY,{QUERY:this.value.trim()});else if(32==t)F.publish(K.UI,x.SidePanel.ZIA.ADD_SEARCH_SELECT,{QUERY:this.value.trim()});else if(!(t>=37&&40>=t)){if(27==t)return void F.publish(K.UI,x.SidePanel.ZIA.SCROLL);F.publish(K.UI,x.SidePanel.ZIA.SEARCH,{TEXT:this.value})}e.stopPropagation(),e.preventDefault()}),t.addEventByNode(e.querySelector("#askQuestion"),t.Events.CLICK,function(e){F.publish(K.UI,x.SidePanel.ZIA.SHOW_DEFAULT_SUGGESTION,{TEXT:this.value}),e.stopPropagation(),e.preventDefault()}),t.addEventByNode(e,t.Events.KEYUP,function(e){var t=e.keyCode||e.which;27==t&&F.publish(K.UI,x.SidePanel.ZIA.HIDE_SEARCH),e.stopPropagation(),e.preventDefault()}),t.addEventByNode(e,t.Events.SCROLL,function(){F.publish(K.UI,x.SidePanel.ZIA.SCROLL)}),t.addEventByNode(e,t.Events.MOUSEWHEEL,function(){F.publish(K.UI,x.SidePanel.ZIA.SCROLL)}),t.addEventByNode(e,t.Events.DOMMOUSEWHEEL,function(){F.publish(K.UI,x.SidePanel.ZIA.SCROLL)}),nt.draggable(r,{helper:function(){var e=r;return e.cloneNode(!0)}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(e){ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this);var t=ZSZIA.Utility.getAbsoluteRowPosbyInMouseEvent(e),n=ZSZIA.Utility.getAbsoluteColPosbyInMouseEvent(e),i=new rt(t,n,t,n);ZSZIA.Client.Range.Highlight.ADD.fn.call(this,121,i)},onStop:function(e){if(ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this),ZSZIA.Client.isAllowToAddOnDragEnd(e)){var t=ZSZIA.Utility.getAbsoluteRowPosbyInMouseEvent(e),n=ZSZIA.Utility.getAbsoluteColPosbyInMouseEvent(e);ZSZIA.Client.onDragEnd.FORMULA.fn.call(this,t,n,r.dataset.formula,r.dataset.pattern)}}}),v(m)}function P(e){var t=e.dataset;F.publish(K.UI,x.SidePanel.ZIA.QUERY_TOOGLE,{STATE:t.state})}function R(){D.querySelector("#expSrc").classList.add("editRange"),D.querySelector(".zsRangePicker").classList.remove("zRDisable"),D.querySelector("#expCellRef").focus();var e=ZSZIA.Manager.ZPManager;e.enableRangeEditor(),e.setRangeValue(m.value,""),F.publish(K.UI,x.SidePanel.ZIA.HIDE_AGG_LAYER)}function S(){D.querySelector("#expSrc").classList.remove("editRange");var e=ZSZIA.Manager.ZPManager;e.disableRangeEditor();var t=e.getRange();F.publish(K.UI,x.SidePanel.ZIA.UPDATE_RANGE,{RANGE:t.prevValue}),D.querySelector(".zsRangePicker").classList.add("zRDisable")}function p(){var e=m.value,t=T(e);if(t){D.querySelector("#expSrc").classList.remove("editRange"),D.querySelector(".zsRangePicker").classList.add("zRDisable");var n=ZSZIA.Manager.ZPManager;n.enableRangeEditor();var i=n.getRange();n.setRangeValue(i.prevValue,e),_(e)}else Q.ZSAlert(et.InvalidRange,{title:et["Alert.Title.InvalidCellRange"]})}function _(e){var t=new ZSZIA.Controller.ZController,n=new ZSZIA.Manager.ZiaViewManager;F.publish(K.UI,x.SidePanel.ZIA.UPDATE_RANGE,{RANGE:e});var i=n.getActiveHolder();i&&(i.isInsideRange(e)||t.doRangeUpdate({ranges:e}))}function T(e){var t=e.trim().split(";"),n=H.view.getActiveGridID(),i=H.view.getResourceID(n),a=H.view.getVersionID(n),r=!1;for(var l in t)if(r=JSUtil.Range.parseRange(i,a,t[l])?!0:""==t[l]?!0:!1,!r)return r;return r}function v(e){$.addValidator(e,function(){return T(e.value)},function(){e.Editor.style.border=""},function(){e.Editor.style.border="1px solid red"},200)}function L(e){function t(e){for(var t=e.split(";"),n="",i=0;i<t.length;i++){var a=t[i].split(".");n=0==n.length?n:n+";",n+=a[1]||a[0]}return n}m&&(m.value=t(e))}function Z(){var e=q.Wrapper.DOMUtils;e.hide(N),e.hide(G),clearTimeout(w)}function g(){try{var e=q.Wrapper.DOMUtils;ZSZIA.Utility.hideError(),Z(),e.show(N),F.publish(K.UI,x.SidePanel.ZIA.CLEAR),F.publish(K.UI,x.SidePanel.ZIA.QUERY_TOOGLE),w&&clearTimeout(w),w=setTimeout(function(){var t=y(ot,0),n=st[t];G.innerHTML=n,e.show(G)},lt)}catch(e){}}function h(){var e=["queryList","recommendedGraphList","recommendedTableList","recommendedMixedList"];e.forEach(function(e){D.querySelector("#"+e).innerHTML=""})}function C(e){var t=q.Wrapper.DOMUtils;t.getElementById("askQuestion").value=e,t.getElementById("askQuestion").focus()}function f(){B&&nt.zpopover(B,"close")}function M(e){e&&B&&B.classList.contains("zsDisable")&&B.classList.remove("zsDisable"),!e&&B&&!B.classList.contains("zsDisable")&&B.classList.add("zsDisable")}function U(){B&&!B.classList.contains("ziaFltredBtn")&&B.classList.add("ziaFltredBtn")}function O(){B&&B.classList.contains("ziaFltredBtn")&&B.classList.remove("ziaFltredBtn")}function y(e,t){return+parseInt(Math.random()*(e-t)+t)}var b,D,m,N,z,G,w,B,H=e.sPlusPlus,q=e.ZSChart,W=e.ZSEvents,F=W.topic,K=W.Groups,x=W.Names,k=e.UserAction,Q=e.ZSClass,Y=H.view.measures,Q=e.ZSClass,V=Q.SidePanel,X=Q.SidePanelClassList,J=[X.right,X.left,X.bottom],j=X.right,$=Q.Editors.Utility,et=ZSConstants.I18N,tt=e.ZSConstants.JSKeyCode,nt=e.UIUtil.Component,it=Q.KeyMapping,at=new Q.SBFeature("ZIA"),rt=(at.div,Q.Range),lt=1e3,st=[et.ziaLoadingMessage1,et.ziaLoadingMessage2,et.ziaLoadingMessage3,et.ziaLoadingMessage4,et.ziaLoadingMessage5,et.ziaLoadingMessage6,et.ziaLoadingMessage7],ot=7,dt=new t,Et=H.view.Events.Key;Et.Entry.RightPane.Node.addChildNode(dt);var At;F.register(K.UI,x.SidePanel.ZIA.FILTER.APPLY,U),F.register(K.UI,x.SidePanel.ZIA.FILTER.REMOVE,O),F.register(K.UI,x.SidePanel.ZIA.CLEAR,h),F.register(K.UI,x.SidePanel.ZIA.SHOW_LOADER,g),F.register(K.UI,x.SidePanel.ZIA.HIDE_LOADER,Z),F.register(K.UI,x.SidePanel.ZIA.TOGGLE,d),F.register(K.UI,x.SidePanel.ZIA.OPEN_PANEL,E),F.register(K.UI,x.Layout.TEMPLATE_LOADED,r),F.register(K.UI,x.SidePanel.ZIA.UPDATE_RANGE,L,"RANGE"),F.register(K.UI,x.SidePanel.ZIA.UPDATE_QUERY,C,"QUERY"),F.register(K.UI,x.SidePanel.ZIA.FILTER.HIDE,f),F.register(K.UI,x.SidePanel.ZIA.FILTER.TOGGLE,M,"HAS_FILTER")}(this);
!function(t){function e(){!n.Manager&&(n.Manager={}),!n.Constants&&(n.Constants={}),!n.Model&&(n.Model={}),!n.Controller&&(n.Controller={}),!n.Utility&&(n.Utility={}),!n.Client&&(n.Client={}),!n.Server&&(n.Server={}),!n.Layer&&(n.Layer={})}!t.ZSZIA&&(t.ZSZIA={});var n=(t.window,t.sPlusPlus,t.ZSZIA);e()}(this);
!function(E){var R=E.ZSZIA;const t={META:"META",REFRESH:"REFRESH"},s={NLP:"NLP",CHART:"CHART",PIVOT:"PIVOT",FORMULA:"FORMULA"},A={TABLE:1,GENERAL:2,MIXED:3,QUERY:4,CDVIEW:!0},n={VALID:1,DROP:2,SINGLE:3,ERROR:4},C={BAD_QUERY:502,DROP_REQUEST:501,SERVER_ERROR:500,BAD_REQUEST:400},T={CHART:1e3,PIVOT:2e3},I=["XYLINE","COL","BAR","SCATTER","COMBOCHART","PIE"],S="#::_::::_::#";R.Constants.META={},R.Constants.Parser=t,R.Constants.META.Type=s,R.Constants.View=A,R.Constants.ID_SEPRATOR=S,ZSZIA.Constants.RESPONSE=n,ZSZIA.Constants.Index=T,ZSZIA.Constants.SupportedChart=I,ZSZIA.Constants.ErrorCode=C}(this);
!function(n){function t(n,t){for(var a,s="",e={},i=0;s+=t[i].getLabel(),i++,i!=t.length;)s+=",";for(var u in n){var o=n[u];switch(u){case"sum":a=c.Function.functions.SUM[0];break;case"avg":a=c.Function.functions.AVERAGE[0];break;case"min":a=c.Function.functions.MIN[0];break;case"max":a=c.Function.functions.MAX[0];break;case"cn":a=c.Function.functions.COUNTA[0];break;case"count":a=c.Function.functions.COUNT[0]}e[u]={},e[u].value=o,e[u].formula="="+a+"("+s+")"}return e}var c=n.ZSConstants;ZSZIA.Utility.cellStatusResponseParser=t}(this);
!function(e){function t(){}function r(){y={},w=null}function o(){S=null}function i(){var e=I.Manager.ZPManager,t=new I.Manager.ZiaViewManager;if(e.isPanelOpen()){var r=t.getActiveHolder();r&&r.flushTransient()}}function n(e){P=e}function a(e){e==Z.GENERAL?C&&C.toggle():C&&C.hide()}function s(){C&&C.hide()}function l(){var e=I.Manager.ZPManager,t=new I.Manager.ZiaViewManager;if(e.isPanelOpen()){var r=t.getActiveHolder();r&&r.flushProrityHeader()}}function c(){var e=I.Manager.ZPManager,t=new I.Manager.ZiaViewManager;if(e.isPanelOpen()){var r=t.getActiveHolder();r&&r.flushFilterHeader()}}function d(e){function t(){Object.keys(o).forEach(function(e){var t=n.querySelector("#"+o[e]);t.remove()})}function r(){e.forEach(function(e){var t=i.createElement("article",{id:o[e]});i.appendChild(n,t)})}var o={MIXED:"recommendedMixedList",CHARTS:"recommendedGraphList",PIVOT:"recommendedTableList"},i=u.Wrapper.DOMUtils,n=i.getElementById("recommendedReportList");t.call(this),r.call(this)}{var I=(e.window,e.ZSZIA),g=e.sPlusPlus,u=e.ZSChart,v=e.ZSEvents,p=v.topic,h=v.Groups,R=v.Names,A=I.Constants.RESPONSE,E=I.Constants.META.Type,D=e.ZSConstants.CommandConstants,f=e.ZSClass,y={},w=null,S=null,C=null,P=I.Constants.View.GENERAL,O=e.ZSDevTools.Logger,Z=I.Constants.View;ZSConstants.I18N}t.prototype.isAggregationAlive=function(){return C&&C.isAlive()},t.prototype.resetView=function(e){var t=g.view.getActiveGridID(),r=g.view.getResourceID(t),o=g.view.getVersionID(t),i=g.view.getSheetID(t),n=g.data.getWorkBook(r,o),a=n.getSheetObj(i),s=a.Prop.Name,l=new I.Controller.ZController,c=new I.Model.RequestObject;c.setProperties({fn:I.Server.doZiaReset,action:"ZIA_RESET",params:[{aConst:"ZIA_RESET",RID:r,VERSION:o,sheetID:i,sheetName:s,holderID:w,resetAction:e.action,callback:l.processResponse}]});var d=I.Manager.ZiaRequestManager;d.addActionIntoQueue(c),p.publish(h.UI,R.SidePanel.ZIA.SHOW_LOADER),p.publish(h.UI,R.SidePanel.ZIA.CLEAR_PRIORITY_HEADER)},t.prototype.refresh=function(){var e=g.view.getActiveGridID(),t=g.view.getResourceID(e),r=g.view.getVersionID(e),o=g.view.getSheetID(e),i=g.data.getWorkBook(t,r),n=i.getSheetObj(o),a=n.Prop.Name,s=new I.Controller.ZController,l=new I.Model.RequestObject;l.setProperties({fn:I.Server.doZiaRefresh,action:"ZIA_REFESH_UPDATE",params:[{aConst:"ZIA_REFRESH",RID:t,VERSION:r,sheetID:o,sheetName:a,holderID:w,callback:s.processResponse}]});var c=I.Manager.ZiaRequestManager;c.addActionIntoQueue(l),p.publish(h.UI,R.SidePanel.ZIA.SHOW_LOADER),p.publish(h.UI,R.SidePanel.ZIA.CLEAR_PRIORITY_HEADER)},t.prototype.doFilterAction=function(e){function t(){v&&v.setFilterHeader(e),v&&v.flushProrityHeader(),u.setProperties({fn:I.Server.doFilterAction,action:"ZIA_FILTER_HEADER",params:[{aConst:"ZIA_FILTER_HEADER",RID:i,VERSION:n,sheetID:a,sheetName:c,holderID:w,filterRanges:JSON.stringify(e),callback:d.processResponse}]});var t=I.Manager.ZiaRequestManager;t.addActionIntoQueue(u),p.publish(h.UI,R.SidePanel.ZIA.SHOW_LOADER)}function r(){p.publish(h.UI,R.SidePanel.ZIA.FILTER.REMOVE_SELECTION)}var o=g.view.getActiveGridID(),i=g.view.getResourceID(o),n=g.view.getVersionID(o),a=g.view.getSheetID(o),s=g.data.getWorkBook(i,n),l=s.getSheetObj(a),c=l.Prop.Name,d=new I.Controller.ZController,u=new I.Model.RequestObject,v=this.getActiveHolder();if(v)if(v.hasPriorityHeader()){var A=new f.ZSConfirm("Zia is detecting priority Headers, Do you want to continue ?");A.onYES(function(){t()}),A.onNO(function(){r()}),A.execute()}else t()},t.prototype.setPriorityHeader=function(e){function t(){u&&u.flushFilterHeader(),u&&u.setPriorityHeader(e),d.setProperties({fn:I.Server.doZiaPriorityHeader,action:"ZIA_PRIORITY_HEADER",params:[{aConst:"ZIA_PRIORITY_HEADER",RID:o,VERSION:i,sheetID:n,sheetName:l,holderID:w,priorityRanges:e,callback:c.processResponse}]});var t=I.Manager.ZiaRequestManager;t.addActionIntoQueue(d),p.publish(h.UI,R.SidePanel.ZIA.SHOW_LOADER)}var r=g.view.getActiveGridID(),o=g.view.getResourceID(r),i=g.view.getVersionID(r),n=g.view.getSheetID(r),a=g.data.getWorkBook(o,i),s=a.getSheetObj(n),l=s.Prop.Name,c=new I.Controller.ZController,d=new I.Model.RequestObject,u=this.getActiveHolder();if(u)if(u.hasFilter()){var v=new f.ZSConfirm("Zia is detecting filter Headers, Do you want to continue ?");v.onYES(function(){t(),p.publish(h.UI,R.SidePanel.ZIA.FILTER.REMOVE_SELECTION)}),v.execute()}else t()},t.prototype.fetchRecommededQueries=function(e){var t=g.view.getActiveGridID(),r=g.view.getResourceID(t),o=g.view.getVersionID(t),i=g.view.getSheetID(t),n=g.data.getWorkBook(r,o),a=n.getSheetObj(i),s=a.Prop.Name,l=new I.Controller.ZController;w&&I.Server.fetchRecommededQueries({aConst:"ZIA_RECOMMEND_QUERIES",RID:r,VERSION:o,sheetID:i,sheetName:s,holderID:w,limit:e,callback:l.processRecommendQueries})},t.prototype.doBeforeSwitchAction=function(){var e=this.getActiveHolder();e&&this.flushHolderByID(e.getID())},t.prototype.syncZiaAffectedHolder=function(e,t,r,o){O.isEnabled&&O.log("[ZIA] >>>> SYNC AFFECFED HOLDERS ",o);var i=new I.Controller.ZController;o.forEach(function(e){this.getActiveHolderID()==e&&i.syncUpdate({isModified:!0})}.bind(this))},t.prototype.sync=function(){var e=g.view.getActiveGridID(),t=g.view.getResourceID(e),r=g.view.getVersionID(e),o=g.view.getSheetID(e),i=g.data.getWorkBook(t,r),n=i.getSheetObj(o),a=n.Prop.Name,s=new I.Controller.ZController,l=new I.Model.RequestObject;if(w){l.setProperties({fn:I.Server.doZiaSync,action:"ZIA_SYNC_UPDATE",params:[{aConst:"ZIA_SYNC",RID:t,VERSION:r,sheetID:o,sheetName:a,holderID:w,callback:s.syncUpdate}]});var c=I.Manager.ZiaRequestManager;c.addActionIntoQueue(l)}},t.prototype.reConnectZia=function(e){var t=g.view.getActiveGridID(),r=g.view.getResourceID(t),o=g.view.getVersionID(t),i=g.view.getSheetID(t),n=g.data.getWorkBook(r,o),a=n.getSheetObj(i),s=a.Prop.Name,l=new I.Controller.ZController,c=new I.Model.RequestObject;c.setProperties({fn:I.Server.doReconnect,action:"ZIA_RECONNECT",params:[{aConst:"ZIA_RECONNECT",RID:r,VERSION:o,sheetID:i,sheetName:s,holderID:e,callback:l.processResponse}]});var d=I.Manager.ZiaRequestManager;d.addActionIntoQueue(c)},t.prototype.doRangeUpdate=function(e){var t=g.view.getActiveGridID(),r=g.view.getResourceID(t),o=g.view.getVersionID(t),i=g.view.getSheetID(t),n=g.data.getWorkBook(r,o),a=n.getSheetObj(i),s=a.Prop.Name,l=new I.Controller.ZController,c=new I.Model.RequestObject,d=e.ranges;c.setProperties({fn:I.Server.doUpdateRange,action:"ZIA_RANGE_UPDATE",params:[{aConst:"ZIA_SAVE",RID:r,VERSION:o,sheetID:i,sheetName:s,holderID:w||"dummy",range:d,callback:l.processResponse}]});var u=I.Manager.ZiaRequestManager;u.addActionIntoQueue(c),p.publish(h.UI,R.SidePanel.ZIA.SHOW_LOADER),p.publish(h.UI,R.SidePanel.ZIA.CLEAR_PRIORITY_HEADER)},t.prototype.updateRecommendQuery=function(e){var t=this.getActiveHolder();t&&t.updateRecommendQuery(e)},t.prototype.process=function(e){var t=e[D.META].ZID,r=this.getHolder(t),o=I.Manager.ZAutoComplete;w=t,r.process(e),p.publish(h.UI,R.SidePanel.ZIA.UPDATE_RANGE,{RANGE:r.getRanges()}),p.publish(h.UI,R.SidePanel.ZIA.HIDE_LOADER);var i=document.querySelector("#recommendedNLPQuery > #askQuestion");o.create(),o.setParentElement(i),this.updateView(e)},t.prototype.updateView=function(e){try{var t,r=e[D.META];r.RENDERING_PRIORITY&&d.call(this,r.RENDERING_PRIORITY),Object.keys(r).forEach(function(e){t=new Promise(function(t){I.Client[e]&&I.Client[e].fn.call(this,r[e]),setTimeout(function(){t()},100)})})}catch(e){}},t.prototype.searchRelated=function(e){var t=e.trim().split(" "),r=t[t.length-1],o=I.Manager.ZAutoComplete,i=o.getAllWordConstainsCharset(r);return i.length<1&&""==e.trim()?void p.publish(h.UI,R.SidePanel.ZIA.SHOW_DEFAULT_SUGGESTION,{TEXT:e.trim()}):void o.buildLayer(i)},t.prototype.onChartTypeChange=function(e,t){var r=new u.Utility.ChartAgent,o=this.getActiveHolder();if(o){var i=o.getChartMetaByID(e);if(i){i.setType(t);var n=r.getRequestObject(i,"preview",!0),a=g.view.getActiveGridID(),s=g.view.getResourceID(a),l=g.view.getVersionID(a),c=g.view.getSheetID(a);u.Server.Action.updatePreview(s,c,l,n,function(t){this.processPreviewResponse(e,t)}.bind(this))}}},t.prototype.processPreviewResponse=function(e,t){var r=new u.Utility.ChartAgent,o=this.getActiveHolder();if(o){o.setChartMeta(e,r.clone(t,!0));var i=o.getChartLayerByID(e),n=new I.Model.ChartView(i.parentNode,e,t,220,330,void 0,void 0,i,!0);n.render()}},t.prototype.getAllHolder=function(){var e=Object.keys(y);return e},t.prototype.addChartLayer=function(e,t){var r=this.getActiveHolder();r&&r.addChartLayer(e,t)},t.prototype.insert=function(e,t){switch(S&&S.destroy(),t){case E.CHART:this.insertChart(e);break;case E.PIVOT:this.insertPivot(e)}},t.prototype.createZoomLayer=function(){S=new I.Layer.UIZoomLayer,S.create()},t.prototype.zoom=function(e,t){switch(!S&&this.createZoomLayer(),t){case E.CHART:this.zoomChart(e,S);break;case E.PIVOT:this.zoomPivot(e,S)}S.hideELement(this.getViewMode())},t.prototype.zoomViewByIndex=function(e){var t=this.getActiveHolder();if(!t)return void Layer.destroy();var r=t.getIndexElement(e);r&&this.zoom(r.id,r.type)},t.prototype.zoomPivot=function(e,t){var r=this.getActiveHolder();if(t.setTableView(E.PIVOT),!r)return O.isEnabled&&O.log("[ZIA] >>>>>>> holder is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void t.destroy();var o=r.getPivotMetaByID(e);if(!o)return O.isEnabled&&O.log("[ZIA] >>>>>>> Pivot META is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void t.destroy();var i=t.getViewSpace();i.innerHTML="";var n=t.getHeaderSpace();n.innerHTML=o.title;var a=r.getIndex(e);t.setIndex(a,r.getSize()),t.setActiveElement({id:e,type:E.PIVOT});var s=i.getBoundingClientRect(),l=new I.Model.PivotView(void 0,e,o,s.height,s.width,!0,i);l.render()},t.prototype.zoomChart=function(e,t){var r=new u.Utility.ChartAgent,o=this.getActiveHolder();if(t.setTableView(E.CHART),!o)return O.isEnabled&&O.log("[ZIA] >>>>>>> holder is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void t.destroy();var i=o.getChartMetaByID(e);if(!i)return O.isEnabled&&O.log("[ZIA] >>>>>>> Chart META is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void t.destroy();var n=i.getDetails(),a=r.clone(i.getOptions(),!0),s=t.getViewSpace();s.innerHTML="",n.co=a;var l=n.co.title.text;n.co.title.text="";var c=t.getHeaderSpace();c.innerHTML=l;var d=o.getIndex(e);t.setIndex(d,o.getSize());var g=new I.Model.ChartView(void 0,e,n,null,null,!0,s);g.render(),t.setActiveElement({id:e,type:E.CHART}),t.setTableView(E.CHART)},t.prototype.insertChart=function(e){var t=new u.Utility.ChartAgent,r=this.getActiveHolder();if(r){var o=r.getChartMetaByID(e);if(o){var i=t.getRequestObject(o,"new",!0),n=g.view.getActiveGridID(),a=g.view.getResourceID(n),s=g.view.getVersionID(n),l=g.view.getSheetID(n);u.Server.Action.updateChartOnGrid(a,l,s,i)}}},t.prototype.insertPivot=function(e){var t=this.getActiveHolder();if(t){var r=t.getPivotMetaByID(e);r&&f.Pivot.Util.getLocationToInsert(r)}},t.prototype.placeAggergationLayer=function(e){var t=u.Wrapper.DOMUtils,r=t.getElementById("aggregationList");C=new I.Layer.LYAggregation(r,e),C.place()},t.prototype.getActiveHolder=function(){return y[w]},t.prototype.getActiveHolderID=function(){return w},t.prototype.getHolder=function(e){return y[e]||(y[e]=new I.Model.ZiaHolder),y[e]},t.prototype.flushHolderByID=function(e){y[e]&&delete y[e]},t.prototype.isValidResponse=function(e){if(this.successful=e&&!("ERROR"===(e.mt||e.mk)),!e||!this.successful)return A.ERROR;var t=e.single;if(t)return A.SINGLE;var r=e.drop;if(r)return A.DROP;var o=e[D.META];try{var i=o.MIXED&&o.MIXED.length>0,n=o.CHART&&o.CHART.length>0,a=o.PIVOT&&o.PIVOT.length>0;if(!(i||n||a))return A.ERROR}catch(e){return A.ERROR}return A.VALID},t.prototype.preprocessQueriesMeta=function(e){var t=this.getActiveHolder();t&&e.forEach(function(e){switch(e.Type){case E.CHART:t.addInTransient(t.addInChartMeta(e[E.CHART]),E.CHART);break;case E.PIVOT:t.addInTransient(t.addInPivotMeta(e[E.PIVOT]),E.PIVOT)}})},t.prototype.onDragEnd=function(e,t,r,o){switch(t){case E.CHART:this.onChartDragEnd(e,r,o);break;case E.PIVOT:this.onPivotDragEnd(e,r,o)}},t.prototype.onChartDragEnd=function(e,t,r){var o=this.getActiveHolder(),i=new u.Utility.ChartAgent;if(o){var n=o.getChartMetaByID(e);if(n){var a=I.Utility.getleftByColPos(r),s=I.Utility.getTopByRowPos(t);n.setLeft(a),n.setTop(s),n.setStartColIndex(r),n.setStartRowIndex(t),n.setDragMode(!0);var l=i.getRequestObject(n,"new",!0),c=g.view.getActiveGridID(),d=g.view.getResourceID(c),v=g.view.getVersionID(c),p=g.view.getSheetID(c);n.setDragMode(!1),n.resetRowColIndex(),u.Server.Action.updateChartOnGrid(d,p,v,l)}}},t.prototype.onPivotDragEnd=function(e,t,r){var o=this.getActiveHolder();if(o){var i=o.getPivotMetaByID(e);i&&f.Pivot.Util.getLocationToInsert(i,t,r)}},t.prototype.processQuery=function(e){var t=g.view.getActiveGridID(),r=g.view.getResourceID(t),o=g.view.getVersionID(t),i=g.view.getSheetID(t),n=g.data.getWorkBook(r,o),a=n.getSheetObj(i),s=a.Prop.Name,l=new I.Controller.ZController,c=new I.Model.RequestObject;c.setProperties({fn:I.Server.doZiaQuery,action:"ZIA_QUERY_UPDATE",params:[{aConst:"NL_QUERY",RID:r,VERSION:o,sheetID:i,sheetName:s,holderID:w,query:e,callback:l.processQueryResponse}]});var d=I.Manager.ZiaRequestManager;d.addActionIntoQueue(c),p.publish(h.UI,R.SidePanel.ZIA.QUERY.PROCESSS.QUEUE);var u=this.getActiveHolder();u&&u.cachedPreviousQuery(e)},t.prototype.updateQueryResult=function(e){p.publish(h.UI,R.SidePanel.ZIA.QUERY.PROCESSS.COMPLETE),I.Utility.hideReportComponent(),n.call(this,I.Constants.View.QUERY),I.Utility.processQueryResult(e)},t.prototype.showErrorMessage=function(){I.Utility.clearComponent(),I.Utility.hideQueryComponent(),!this.isAggregationAlive()&&I.Utility.showError(),p.publish(h.UI,R.SidePanel.ZIA.HIDE_LOADER)},t.prototype.getViewMode=function(){return P},I.Manager.ZiaViewManager=t,p.register(h.UI,R.SidePanel.ZIA.HIDE_AGG_LAYER,s),p.register(h.UI,R.SidePanel.ZIA.UPDATE_VIEW,a,"MODE"),p.register(h.UI,R.SidePanel.ZIA.UPDATE_VIEW,n,"MODE"),p.register(h.UI,R.SidePanel.ZIA.CLOSE_PANEL,r),p.register(h.UI,R.SidePanel.ZIA.CLOSE_ZOOM_VIEW,o),p.register(h.UI,R.SidePanel.ZIA.QUERY.CLEAR,i),p.register(h.UI,R.SidePanel.ZIA.CLEAR_PRIORITY_HEADER,l),p.register(h.UI,R.SidePanel.ZIA.CLEAR_PRIORITY_HEADER,c)}(this);
!function(i){function n(){this.panel={open:!1,close:!0},this.rangeEditor={isEditing:!1,value:{prevValue:"",currValue:""}}}var e=(i.sPlusPlus,i.ZSZIA),t=(i.sPlusPlus,i.ZSEvents),s=t.topic,a=t.Groups,l=t.Names;n.prototype={open:function(){this.panel.open=!0,this.panel.close=!1,s.publish(a.UI,l.SidePanel.ZIA.OPEN_PANEL),s.publish(a.UI,l.SidePanel.ZIA.FILTER.TOGGLE,{HAS_FILTER:!1})},close:function(){this.init(),s.publish(a.UI,l.SidePanel.ZIA.HIDE_AGG_LAYER),s.publish(a.UI,l.SidePanel.ZIA.CLOSE_PANEL),s.publish(a.UI,l.SidePanel.ZIA.FILTER.RESET)},init:function(){this.panel.open=!1,this.panel.close=!0,s.publish(a.UI,l.SidePanel.ZIA.HIDE_SEARCH)},isPanelOpen:function(){return this.panel.open},enableRangeEditor:function(){this.rangeEditor.isEditing=!0},disableRangeEditor:function(){this.rangeEditor.isEditing=!1},isRangeEditing:function(){return this.rangeEditor.isEditing},setRangeValue:function(i,n){this.rangeEditor.value={prevValue:i,currValue:n}},getRange:function(){return this.rangeEditor.value}},e.Manager.ZPManager=new n}(this);
!function(e){function t(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=u[e.aConst],r=m[e.aConst],l=new ZSClass.ParamGenerator([n],t,s,!1,!1),i=l.getSheets(),I=l.getActiveCell(),c=[];c.push(e.ranges);var d={actionCnst:o,sheetId:n,RID:t,VERSION:s,rangeList:c,activeCell:I,sheetList:i,holderID:e.holderID},C=(new R(o,d),new v);C.addEventListeners("onComplete",function(e){a&&a(e)}),C.open(r),C.send(d)}function n(e){if(e.drop)return void(g.isEnabled&&g.log("[ZIA] >>>>>>>>>>>>> Droping zia close request >>>>>> ",e));var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=u[e.aConst],o=m[e.aConst],r=new ZSClass.ParamGenerator([n],t,s,!1,!1),l=r.getSheets(),i=r.getActiveCell(),I={actionCnst:a,sheetId:n,RID:t,VERSION:s,activeCell:i,sheetList:l,holderID:e.holderID},c=(new R(a,I),new v);c.open(o),c.send(I)}function s(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=u[e.aConst],r=m[e.aConst],l=new ZSClass.ParamGenerator([n],t,s,!1,!1),i=l.getSheets(),I=l.getActiveCell(),c={actionCnst:o,sheetId:n,RID:t,VERSION:s,activeCell:I,sheetList:i,rangeList:e.range,holderID:e.holderID},d=(new R(o,c),new v);d.addEventListeners("onComplete",function(e){a&&a(e)}),d.open(r),d.send(c)}function a(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=u[e.aConst],r=m[e.aConst],l=new ZSClass.ParamGenerator([n],t,s,!1,!1),i=l.getSheets(),I=l.getActiveCell(),c={actionCnst:o,sheetId:n,RID:t,VERSION:s,activeCell:I,sheetList:i,holderID:e.holderID},d=(new R(o,c),new v);d.addEventListeners("onComplete",function(e){a&&a(e)}),d.open(r),d.send(c)}function o(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=u[e.aConst],r=m[e.aConst],l=new ZSClass.ParamGenerator([n],t,s,!1,!1),i=l.getSheets(),I=l.getActiveCell(),c={actionCnst:o,sheetId:n,RID:t,VERSION:s,activeCell:I,sheetList:i,resetAction:e.resetAction,holderID:e.holderID},d=(new R(o,c),new v);d.addEventListeners("onComplete",function(e){a&&a(e)}),d.open(r),d.send(c)}function r(e){var t=e.RID,n=e.sheetID,s=e.sheetName,a=e.VERSION,o=e.callback,r=u[e.aConst],l=m[e.aConst],i=new ZSClass.ParamGenerator([n],t,a,!1,!1),I=i.getSheets(),c=i.getActiveCell(),d={actionCnst:r,sheetId:n,RID:t,VERSION:a,sheetName:s,activeCell:c,sheetList:I,holderID:e.holderID,query:e.query},C=(new R(r,d),new v);C.addEventListeners("onComplete",function(e){o&&o(e)}),C.open(l),C.send(d)}function l(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=e.holderID,r=u[e.aConst],l=m[e.aConst],i=new ZSClass.ParamGenerator([n],t,s,!1,!1),I=i.getSheets(),c=i.getActiveCell(),d={actionCnst:r,sheetId:n,RID:t,VERSION:s,activeCell:c,sheetList:I,holderID:o},C=(new R(r,d),new v);C.addEventListeners("onComplete",function(e){a&&a(e)}),C.open(l),C.send(d)}function i(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=e.holderID,r=e.filterRanges,l=u[e.aConst],i=m[e.aConst],I=new ZSClass.ParamGenerator([n],t,s,!1,!1),c=I.getSheets(),d=I.getActiveCell(),C={actionCnst:l,sheetId:n,RID:t,VERSION:s,activeCell:d,sheetList:c,holderID:o,filterRanges:r},h=(new R(l,C),new v);h.addEventListeners("onComplete",function(e){a&&a(e)}),h.open(i),h.send(C)}function I(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=e.holderID,r=e.priorityRanges,l=u[e.aConst],i=m[e.aConst],I=new ZSClass.ParamGenerator([n],t,s,!1,!1),c=I.getSheets(),d=I.getActiveCell(),C={actionCnst:l,sheetId:n,RID:t,VERSION:s,activeCell:d,sheetList:c,holderID:o,pRanges:r},h=(new R(l,C),new v);h.addEventListeners("onComplete",function(e){a&&a(e)}),h.open(i),h.send(C)}function c(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),a=e.callback,o=e.holderID,r=e.limit,l=u[e.aConst],i=m[e.aConst],I=new ZSClass.ParamGenerator([n],t,s,!1,!1),c=I.getSheets(),d=I.getActiveCell(),C={actionCnst:l,sheetId:n,RID:t,VERSION:s,activeCell:d,sheetList:c,holderID:o,limit:r},h=(new R(l,C),new v);h.addEventListeners("onComplete",function(e){a&&a(e)}),h.open(i),h.send(C)}var d=e.sPlusPlus,C=e.ZSZIA,d=e.sPlusPlus,h=e.ZSEvents,S=(h.topic,h.Groups,h.Names,d.SML.Client),v=S.Utility.WorkerRequest,R=e.ZSClass.ActionObject,D=e.ZSConstants,m=D.URI,u=(e.encodeURIComponent,D.ActionConstants),g=(D.CommandConstants,e.ZSDevTools.Logger);C.Server.doZiaQuery=r,C.Server.doUpdateRange=s,C.Server.sendOpenZiaRequest=t,C.Server.sendCloseZiaRequest=n,C.Server.doZiaRefresh=a,C.Server.doZiaSync=a,C.Server.doReconnect=l,C.Server.doZiaPriorityHeader=I,C.Server.fetchRecommededQueries=c,C.Server.doZiaReset=o,C.Server.doFilterAction=i}(this);
!function(e){function a(){var e=O.view.getActiveGridID(),a=O.view.getResourceID(e),t=O.view.getVersionID(e),r=O.view.getSheetID(e),i=O.view.getSheetState(e,r),o=O.data.getWorkBook(a,t),l=o.getSheetObj(r),s=l.Prop.Name,g=i.getRanges(),I=new T.Controller.ZController,u=[],S="";u.push(g.pop()),S+=s+"."+(""==S?u[0].getLabel():";"+u[0].getLabel()),L.publish(H.UI,N.SidePanel.ZIA.UPDATE_RANGE,{RANGE:S});var E=new T.Model.RequestObject;E.setProperties({fn:n,action:"ZIA_OPEN",params:[{aConst:"ZIA_OPEN",ranges:u,callback:I.processResponse,RID:a,sheetID:r,sheetName:s,VERSION:t}]});var A=T.Manager.ZiaRequestManager;A.addActionIntoQueue(E),L.publish(H.UI,N.SidePanel.ZIA.SHOW_LOADER)}function n(e){T.Server.sendOpenZiaRequest(e)}function t(e){T.Server.sendCloseZiaRequest(e)}function r(){var e=new T.Manager.ZiaViewManager,a=O.view.getActiveGridID(),n=O.view.getResourceID(a),r=O.view.getVersionID(a),i=O.view.getSheetID(a),o=O.data.getWorkBook(n,r),l=o.getSheetObj(i),s=l.Prop.Name,g=e.getAllHolder(),I=new T.Model.RequestObject;I.setProperties({fn:t,action:"ZIA_CLOSE",params:[{aConst:"ZIA_CLOSE",RID:n,sheetID:i,sheetName:s,VERSION:r,holderID:JSON.stringify(g),drop:0==g.length}]});var u=T.Manager.ZiaRequestManager;u.addActionIntoQueue(I),L.publish(H.UI,N.SidePanel.ZIA.SHOW_LOADER),L.publish(H.UI,N.SidePanel.ZIA.QUERY_TOOGLE,{STATE:"result"}),T.Utility.hideQueryComponent();var S=T.Manager.ZPManager;S.init(),L.publish(H.UI,N.SidePanel.ZIA.SCROLL),L.publish(H.UI,N.SidePanel.ZIA.FILTER.HIDE)}function i(){var e=T.Manager.ZPManager;if(e.isPanelOpen()){var n=new T.Model.RequestObject;n.setProperties({fn:a,action:"SHEET_SWITCH",params:[]});var t=T.Manager.ZiaRequestManager;t.addActionIntoQueue(n);var r=T.Manager.ZAutoComplete;r.flush(),L.publish(H.UI,N.SidePanel.ZIA.SHOW_LOADER)}}function o(e,a,n){function t(e){for(var a=n.length,t=0;a>t;t++){var r=n[t];if(e.range==r.range)return!1}return!0}return a.forEach(function(a){var r=T.Utility.parsePriority(e,a);r&&t(r)&&n.push(r)}),n.length>=1}function l(){function e(e){try{var a=e[0];return T.Utility.isCellBeneathPivot(a.startRow,a.startCol)}catch(e){return!1}}function a(e){try{var a=e[0],t=new ZSChart.Utility.ChartAgent;t.detectTable(a,n.bind(this),function(){})}catch(e){return!0}}function n(e){if(t(e.dataRange)){var a=e.dataRange,n=new T.Controller.ZController,r=[];r.push(e.dataRange),P&&P.setRange(a),L.publish(H.UI,N.SidePanel.ZIA.UPDATE_RANGE,{RANGE:a}),n.doRangeUpdate({ranges:a})}}function t(e){return e=e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";"),r.call(this,e)}function r(e){var a=T.Manager.ZPManager,n=new T.Manager.ZiaViewManager;if(a.isPanelOpen()&&!a.isRangeEditing()){var t=O.view.getActiveGridID(),r=O.view.getResourceID(t),i=O.view.getVersionID(t),o=n.getActiveHolder();if(o&&o.isInsideRange(e))return!1;var l=e.split(";"),g=JSUtil.Range.parseRange(r,i,l[0]),I=[];return g&&g.range&&I.push(g.range),s(I)?!1:!0}}var i=T.Manager.ZPManager,l=new T.Manager.ZiaViewManager;if(i.isPanelOpen()&&!i.isRangeEditing()){var g=O.view.getActiveGridID(),I=O.view.getResourceID(g),u=O.view.getVersionID(g),S=O.view.getSheetID(g),E=O.view.getSheetState(g,S),A=O.data.getWorkBook(I,u),c=A.getSheetObj(S),d=c.Prop.Name,R=E.getRanges(),P=l.getActiveHolder();if(s(R)&&P&&P.isInsideRange&&P.isInsideRange(R)){if(P.hasPriorityHeader()){var v=new T.Controller.ZController;v.resetView({action:"ALL"})}}else{if(s(R))return void(e.call(this,R)||a.call(this,R));var Z=[];if(P&&o(d,R,Z)){var v=new T.Controller.ZController;v.setPriorityHeader(Z)}else{var p="",v=new T.Controller.ZController,h=[];R.forEach(function(e){p+=d+"."+(""==p?e.getLabel():";"+e.getLabel()),e.id=e.type=0,h.push(e)}),P&&P.setRange(p),L.publish(H.UI,N.SidePanel.ZIA.UPDATE_RANGE,{RANGE:p}),v.doRangeUpdate({ranges:p})}}}}function s(e){try{var a=e.length,n=e[0];return 1==a&&n.startRow==n.endRow&&n.startCol==n.endCol}catch(e){return!1}}function g(){var e=T.Manager.ZPManager,a=new T.Controller.ZController;e.isPanelOpen()&&a.syncZia()}function I(e,a,n,t){var r=T.Manager.ZPManager,i=new T.Controller.ZController;r.isPanelOpen()&&i.syncZiaAffectedHolder(e,a,n,t)}function u(e,a){T.Client.Range.Highlight[a]&&T.Client.Range.Highlight[a].fn.call(this,e)}function S(e){var a=new T.Manager.ZiaViewManager;a.zoomViewByIndex(e)}function E(){var e=T.Manager.ZAutoComplete;return e.isSelectedSuggestion()?void e.performSelection():void 0}function A(e){var a=T.Manager.ZAutoComplete;if(a.isSelectedSuggestion())return void a.performSelection();if(L.publish(H.UI,N.SidePanel.ZIA.UPDATE_QUERY,{QUERY:e}),L.publish(H.UI,N.SidePanel.ZIA.HIDE_SEARCH),e&&1!=e.length){var n=T.Manager.ZPManager,t=new T.Controller.ZController;n.isPanelOpen()&&t.processQuery(e)}}function c(){var e=new T.Manager.ZiaViewManager,a=e.getViewMode(),n=ZSChart.Wrapper.DOMUtils;switch(a){case y.GENERAL:break;case y.QUERY:L.publish(H.UI,N.SidePanel.ZIA.QUERY.CLEAR),n.hide(n.getElementById("zRelatedQry")),n.getElementById("askQuestion").value="",T.Utility.showReportComponent(),L.publish(H.UI,N.SidePanel.ZIA.UPDATE_VIEW,{MODE:y.GENERAL})}}function d(e){var a=T.Manager.ZPManager,n=new T.Manager.ZiaViewManager;if(a.isPanelOpen()&&e){var t=e.chartJSON,r=e.pivotJSON;t&&(t.co.title.text=t.co.title.text.length>2?t.co.title.text:e.naturalString);var i=[];t&&i.push({CHART:t,Type:_.CHART}),r&&i.push({PIVOT:r,Type:_.PIVOT}),n.preprocessQueriesMeta(i)}}function R(e,a){var n=T.Manager.ZPManager,t=new T.Manager.ZiaViewManager;n.isPanelOpen()&&t.addChartLayer(e,a)}function P(e,a){var n=T.Manager.ZPManager,t=new T.Controller.ZController;n.isPanelOpen()&&t.doChangeChartType(e,a)}function v(e){var a=T.Manager.ZPManager,n=new T.Manager.ZiaViewManager;a.isPanelOpen()&&n.searchRelated(e)}function Z(e,a){var n=document.querySelector("#recommendedNLPQuery > #askQuestion"),t=n.value,r=t.trim().split(" "),i=r.length;r[i-1]=e,r[i]="";var o=r.join(" ");L.publish(H.UI,N.SidePanel.ZIA.UPDATE_QUERY,{QUERY:o}),"SUBMIT"==a&&L.publish(H.UI,N.SidePanel.ZIA.PROCESS_QUERY,{QUERY:e.trim()})}function p(){h.call(this)}function h(){var e=T.Manager.ZAutoComplete;e.hide()}function C(e,a){e.clearAllSelection(),e.setChartSelection(a)}function M(e){function a(e,a){for(var n=a.length,t=e.length,r=e,i=0;n>i;i++){for(var o=a[i],l=!1,s=0;t>s;s++){var g=e[s];if(g.toLowerCase()==o.toLowerCase()){l=!0;break}}!l&&r.push(o)}return r}if(!(e.length>=1)){var n=T.Manager.ZPManager,t=new T.Manager.ZiaViewManager;if(n.isPanelOpen()){var r=t.getActiveHolder();if(r){var i=r.getQueries(),o=r.getCachedQuery(),l=a.call(this,i,o),s=T.Manager.ZAutoComplete;s.buildLayer(l,"SUBMIT")}}}}function U(e){var a=T.Manager.ZAutoComplete;a.selectSuggestion(e)}function f(e,a,n){var t=T.Manager.ZPManager,r=new T.Manager.ZiaViewManager;t.isPanelOpen()&&r.doBeforeSwitchAction(e,a,n)}function w(e){var a=T.Manager.ZPManager,n=new T.Manager.ZiaViewManager;if(a.isPanelOpen()){var t=O.view.getActiveGridID(),r=O.view.getSheetID(t),i=O.view.getSheetState(t,r),o=i.getRanges();L.publish(H.UI,N.SidePanel.ZIA.SCROLL),n.placeAggergationLayer(T.Utility.cellStatusResponseParser(e,o))}}{var T=(e.window,e.ZSZIA),O=e.sPlusPlus,D=e.ZSEvents,L=D.topic,H=D.Groups,N=D.Names,_=T.Constants.META.Type,y=(ZSClass.Range,T.Constants.View);O.data.Defaults,e.ZSDevTools}L.register(H.Gesture.Selector.Range,N.GESTURE.ACTION.DOWN,p),L.register(H.UserAction,N.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,f,"RID","SHEETID","VERSION"),L.register(H.UI,N.SidePanel.ZIA.ADD_SEARCH_SELECT,E,"QUERY"),L.register(H.UI,N.SidePanel.ZIA.SEARCH_SELECT,U,"DIRECTION"),L.register(H.UI,N.SidePanel.ZIA.SHOW_DEFAULT_SUGGESTION,M,"TEXT"),L.register(H.UI,N.SidePanel.ZIA.META.CHART.SELECT,C,"LAYER","TYPE"),L.register(H.UI,N.SidePanel.ZIA.SCROLL,p),L.register(H.UI,N.SidePanel.ZIA.MOVE,S,"index"),L.register(H.Listener,N.Mouse.RangeEnd,l),L.register(H.Listener,N.DocAction.WORKSHEETS.SWITCHSHEET,i),L.register(H.UI,N.SidePanel.ZIA.CLOSE_PANEL,r),L.register(H.UI,N.SidePanel.ZIA.OPEN_PANEL,a),L.register(H.UI,N.SidePanel.ZIA.SYNC,g),L.register(H.UI,N.SidePanel.ZIA.SYNC_AFFECTED,I,"RID","SHEETID","VERSION","HOLDERS"),L.register(H.UI,N.SidePanel.ZIA.HIGHLIGHT_RANGE,u,"ID","TYPE"),L.register(H.UI,N.SidePanel.ZIA.PROCESS_QUERY,A,"QUERY"),L.register(H.UI,N.SidePanel.ZIA.QUERY_TOOGLE,c,"STATE"),L.register(H.UI,N.SidePanel.ZIA.QUERY.RENDER.PREPROCESS,d,"META"),L.register(H.UI,N.SidePanel.ZIA.META.CHART.ADD_LAYER,R,"ID","LAYER"),L.register(H.UI,N.SidePanel.ZIA.CHANGE_TYPE,P,"ID","Type"),L.register(H.UI,N.SidePanel.ZIA.SEARCH,v,"TEXT"),L.register(H.UI,N.SidePanel.ZIA.SEARCH_ITEM_CLICK,Z,"VALUE","ETYPE"),L.register(H.UI,N.SidePanel.ZIA.HIDE_SEARCH,h),L.register(H.Listener,N.SheetAction.ACTIVE_CELL_RANGE.STATUS,w,"STATUS")}(this);
!function(E){function e(){}var R=(E.window,E.sPlusPlus,E.ZSZIA),s=(E.sPlusPlus,E.ZSEvents),n=E.ZSDevTools,a=n.Logger,o=s.topic,r=s.Groups,i=s.Names,t=R.Manager,A=R.Constants.RESPONSE,M=E.ZSConstants.CommandConstants,c={},O=R.Constants.ErrorCode;c[M.DOCUMENT_META]=function(E){for(var e in E){var R=E[e];R[M.SHEET_META]&&c[M.SHEET_META](R[M.SHEET_META])}},c[M.SHEET_META]=function(E){for(var e in E){var R=E[e];R[M.ZIA]&&c[M.ZIA](R[M.ZIA]),R[M.ERROR]&&c[M.ERROR](R[M.ERROR])}},c[M.QUERY]=function(E){var e=new t.ZiaViewManager;e.updateQueryResult(E)},c[M.ERROR]=function(E){a.isEnabled&&a.log("[ZIA] >>>>>>>>>>> ERROR RESPONSE >>>>>>>>>>>> ",n.Response.Decode(E));var e=E.statusCode,R=new t.ZiaViewManager;switch(e){case O.BAD_QUERY:R.updateQueryResult(E);break;case O.SERVER_ERROR:case O.BAD_REQUEST:R.showErrorMessage();break;case O.DROP_REQUEST:a.isEnabled&&a.log("[ZIA]>>>> Drop response")}},c[M.META]=function(E){var e=new t.ZiaViewManager,s=e.isValidResponse(E);switch(s){case A.SINGLE:case A.ERROR:E&&E.RANGE&&o.publish(r.UI,i.SidePanel.ZIA.UPDATE_RANGE,{RANGE:E.RANGE}),e.showErrorMessage();break;case A.VALID:R.Utility.hideError(),R.Utility.clearComponent(),R.Utility.showQueryComponent(),R.Utility.resetIndex(),o.publish(r.UI,i.SidePanel.ZIA.QUERY_TOOGLE,{STATE:"result"}),e.process(E);break;case A.DROP:a.isEnabled&&a.log("[ZIA]>>>> Drop response")}},c[M.ZIA_RECOMMEND_QUERY]=function(E){var e=new t.ZiaViewManager;e.updateRecommendQuery(E)},c[M.ZIA]=function(E){E[M.ERROR]?c[M.ERROR](E[M.ERROR]):(E[M.META]&&c[M.META](E),E[M.QUERY]&&c[M.QUERY](E[M.QUERY]),E[M.ZIA_RECOMMEND_QUERY]&&c[M.ZIA_RECOMMEND_QUERY](E[M.ZIA_RECOMMEND_QUERY]))},c[A.ERROR]=function(E){var e=new t.ZiaViewManager,R=e.isValidResponse(E);switch(R){case A.SINGLE:case A.ERROR:E&&E.RANGE&&o.publish(r.UI,i.SidePanel.ZIA.UPDATE_RANGE,{RANGE:E.RANGE}),e.showErrorMessage();break;case A.DROP:a.isEnabled&&a.log("[ZIA]>>>> Drop response")}},e.prototype.process=function(E){a.isEnabled&&a.log("[ZIA] >>>>>>>>>>> RESPONSE >>>>>>>>>>>> ",n.Response.Decode(E));try{E[M.DOCUMENT_META]&&c[M.DOCUMENT_META](E[M.DOCUMENT_META]),!E[M.DOCUMENT_META]&&c[A.ERROR](E)}catch(E){a.isEnabled&&a.log("[ZIA] >>>>>>>>>>> RESPONSE PARSING ERROR>>>>>>>>>>>> ",E)}},e.prototype.processQueryResponse=function(E){a.isEnabled&&a.log("[ZIA] >>>>>>>>>>> RESPONSE >>>>>>>>>>>> ",n.Response.Decode(E));try{E[M.DOCUMENT_META]&&c[M.DOCUMENT_META](E[M.DOCUMENT_META]),!E[M.DOCUMENT_META]&&c[M.QUERY](E)}catch(E){a.isEnabled&&a.log("[ZIA] >>>>>>>>>>> RESPONSE PARSING ERROR>>>>>>>>>>>> ",E)}},R.Manager.ZResponseParser=e}(this);
!function(e){function n(){}var r=(e.window,e.sPlusPlus,e.ZSZIA),a=(e.sPlusPlus,e.ZSEvents),i=a.topic,o=a.Groups,s=a.Names,t=r.Manager;n.prototype={closePanel:function(){var e=t.ZPManager;e.close()},openPanel:function(){var e=t.ZPManager;e.open()},processResponse:function(e){var n=new t.ZResponseParser;n.process(e);var r=new t.ZiaViewManager;r.fetchRecommededQueries(-1)},refreshZia:function(){var e=new t.ZiaViewManager;e.refresh()},doRangeUpdate:function(e){var n=new t.ZiaViewManager;n.doRangeUpdate(e),i.publish(o.UI,s.SidePanel.ZIA.FILTER.RESET)},syncZia:function(){var e=new t.ZiaViewManager;e.sync()},syncZiaAffectedHolder:function(e,n,r,a){var i=new t.ZiaViewManager;i.syncZiaAffectedHolder(e,n,r,a)},syncUpdate:function(e){if(e.isModified){var n=new r.Controller.ZController;n.refreshZia()}else if(e.RECONNECT){var n=new r.Controller.ZController;n.reConnectZia(e.ZID)}},reConnectZia:function(e){var n=new t.ZiaViewManager;n.reConnectZia(e)},insert:function(e,n){if(!r.Utility.isReadOnlyView()){var a=new t.ZiaViewManager;a.insert(e,n)}},zoom:function(e,n){var r=new t.ZiaViewManager;r.zoom(e,n)},processQuery:function(e){var n=new t.ZiaViewManager;n.processQuery(e)},processQueryResponse:function(e){var n=new t.ZResponseParser;n.processQueryResponse(e)},onDragEnd:function(e,n,a,i){if(!r.Utility.isReadOnlyView()){var o=new t.ZiaViewManager;o.onDragEnd(e,n,a,i)}},doChangeChartType:function(e,n){var r=new t.ZiaViewManager;r.onChartTypeChange(e,n)},setPriorityHeader:function(e){var n=new t.ZiaViewManager;n.setPriorityHeader(e)},processRecommendQueries:function(e){var n=new t.ZResponseParser;n.process(e)},resetView:function(e){var n=new t.ZiaViewManager;n.resetView(e)},doFilterAction:function(e){var n=new t.ZiaViewManager;n.doFilterAction(e)}},r.Controller.ZController=n}(this);
!function(t){function e(){this.CHARTS={},this.PIVOT={},this.QUERIES=[],this.ID=void 0,this.range=void 0,this.PROFILE={},this.cIndex=d.Index.CHART,this.pIndex=d.Index.PIVOT,this.index=[],this.transiant={QUERY:[],CHART:[],PIVOT:[]},this.P_HEADERS=[],this.FILTER=[]}function n(t){var e=new T.Utility.ChartAgent;t&&t[c.Constants.META.Type.CHART]&&i.call(this,c.Constants.META.Type.CHART+"_"+this.getChartIndex(),e.clone(t[c.Constants.META.Type.CHART],!0)),t&&t[c.Constants.META.Type.PIVOT]&&o.call(this,c.Constants.META.Type.PIVOT+"_"+this.getPivotIndex(),e.clone(t[c.Constants.META.Type.PIVOT],!0))}function i(t,e){var n=new T.Model.DialogMeta;return n.constructPropertyFromObject(e),this.CHARTS[t]={},this.CHARTS[t].META=n,this.index.push({id:t,type:"CHART"}),t}function r(t,e){var n=new T.Model.DialogMeta;n.constructPropertyFromObject(e),this.CHARTS[t].META=n}function o(t,e){return this.PIVOT[t]=e,this.index.push({id:t,type:"PIVOT"}),t}function s(){var t=this.transiant.CHART;t.forEach(function(t){h.call(this,t,f.CHART)}.bind(this))}function a(){var t=this.transiant.PIVOT;t.forEach(function(t){h.call(this,t,f.PIVOT)}.bind(this))}function h(t,e){switch(e){case f.PIVOT:delete this.PIVOT[t];break;case f.CHART:delete this.CHARTS[t]}p.call(this,t)}function p(t){var e=[];this.index.forEach(function(n){n&&n.id!==t&&e.push(n)}),this.index=e}var c=(t.window,t.ZSZIA),u=t.sPlusPlus,T=t.ZSChart,d=c.Constants,I=t.ZSConstants.CommandConstants,f=c.Constants.META.Type,l=ZSClass.Range,y=u.data.Defaults;e.prototype.init=function(){this.CHARTS={},this.PIVOT={},this.QUERIES=[],this.ID=void 0,this.range=void 0,this.PROFILE={},this.cIndex=d.Index.CHART,this.pIndex=d.Index.PIVOT,this.index=[],this.initTransient()},e.prototype.process=function(t){this.init(),t=t[I.META],this.setID(t.ZID),this.setRange(t.RANGE),this.setProfile(t.PROFILE),this.constructMeta(t),this.setQueries(t),this.setHeaders(t)},e.prototype.setQueries=function(t){var e=t.NLP_RECOMMEND_QUERIES;e&&(this.QUERIES=e.RecQueries)},e.prototype.setHeaders=function(t){var e=c.Manager.ZiaFilterManager;e.initLayer(t.HEADERS)},e.prototype.updateRecommendQuery=function(t){var e={NLP_RECOMMEND_QUERIES:{RecQueries:t.recQueries}};this.setQueries(e)},e.prototype.getQueries=function(){return this.QUERIES},e.prototype.setPriorityHeader=function(t){this.P_HEADERS=t},e.prototype.flushProrityHeader=function(){this.P_HEADERS=[]},e.prototype.flushFilterHeader=function(){this.FILTER=[]},e.prototype.getPriorityHeader=function(){return this.P_HEADERS},e.prototype.hasPriorityHeader=function(){return this.P_HEADERS.length>=1},e.prototype.setFilterHeader=function(t){this.FILTER=t},e.prototype.hasFilter=function(){return this.FILTER.length>=1},e.prototype.cachedPreviousQuery=function(t){for(var e=this.transiant.QUERY,n=e.length,i=!1,r=0;n>r;r++){var o=e[r];if(o.toLowerCase()==t.toLowerCase()){i=!0;break}}!i&&this.transiant.QUERY.push(t)},e.prototype.getCachedQuery=function(){return this.transiant.QUERY},e.prototype.setID=function(t){this.ID=t},e.prototype.setProfile=function(t){this.PROFILE=t},e.prototype.setRange=function(t){this.range=t},e.prototype.getID=function(){return this.ID},e.prototype.getRanges=function(){return this.range},e.prototype.setMixedMeta=function(t){this.MIXED=t},e.prototype.getMixedMeta=function(){return this.MIXED},e.prototype.isInsideRange=function(t){var e=!1;for(var n in t){var i=t[n];e=i&&this.hasRange(i)}return e},e.prototype.getChartMetaByID=function(t){return this.CHARTS[t].META},e.prototype.addChartLayer=function(t,e){this.CHARTS[t].Layer=e},e.prototype.getPivotMetaByID=function(t){return this.PIVOT[t]},e.prototype.setChartMeta=function(t,e){r.call(this,t,e)},e.prototype.getChartLayerByID=function(t){return this.CHARTS[t].Layer},e.prototype.hasRange=function(t){var e=u.view.getActiveGridID(),n=u.view.getResourceID(e),i=u.view.getVersionID(e),r=this.getRanges().replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";"),o=r.split(";"),s=[];for(var a in o){var h=JSUtil.Range.parseRange(n,i,o[a]);if(h&&h.range){var p=new l(Math.max(h.range.startRow-1,0),Math.max(h.range.startCol-1,0),Math.min(h.range.endRow+1,y.MAX_ROW-1),Math.min(h.range.endCol+1,y.MAX_COL));s.push(p)}}var c=!1;for(var a in s){var h=s[a];if(c=this.isInRange(t,h))break}return c},e.prototype.getIndex=function(t){for(var e=-1,n=0;n<this.index.length;n++){var i=this.index[n];if(e++,i.id===t)break}return e},e.prototype.getSize=function(){return this.index.length},e.prototype.getIndexElement=function(t){return this.index[t]},e.prototype.isInRange=function(t,e){return e.startRow<=t.startRow&&e.startCol<=t.startCol&&e.endRow>=t.endRow&&e.endCol>=t.endCol},e.prototype.addInTransient=function(t,e){this.transiant[e].push(t)},e.prototype.flushTransient=function(){var t=Object.keys(this.transiant);t.forEach(function(t){switch(t){case f.CHART:s.call(this);break;case f.PIVOT:a.call(this)}}.bind(this)),this.initTransient()},e.prototype.initTransient=function(){this.transiant.CHART=[],this.transiant.PIVOT=[]},e.prototype.addInChartMeta=function(t){var e=new T.Utility.ChartAgent;return i.call(this,c.Constants.META.Type.CHART+"_"+this.getChartIndex(),e.clone(t,!0))},e.prototype.addInPivotMeta=function(t){var e=new T.Utility.ChartAgent;return o.call(this,c.Constants.META.Type.PIVOT+"_"+this.getPivotIndex(),e.clone(t,!0))},e.prototype.constructMeta=function(t){for(var e=new T.Utility.ChartAgent,r=t.MIXED||[],s=0;s<r.length;s++){var a=r[s];n.call(this,a)}for(var h=t.CHART?t.CHART:[],s=0;s<h.length;s++){var p=h[s];i.call(this,c.Constants.META.Type.CHART+"_"+this.getChartIndex(),e.clone(p,!0))}for(var u=t.PIVOT?t.PIVOT:[],s=0;s<u.length;s++){var p=u[s];o.call(this,c.Constants.META.Type.PIVOT+"_"+this.getPivotIndex(),e.clone(p,!0))}},e.prototype.getChartIndex=function(){return this.cIndex++},e.prototype.getPivotIndex=function(){return this.pIndex++},c.Model.ZiaHolder=e}(this);
!function(t){function e(t,e,s,i,h,r,a,c,n){this.parentNode=t,this.ID=e,this.chartObject=s,this.tempID=a||void 0,this.height=i||null,this.width=h||null,this.Layer=c||null,this.stopPreProcess=r?r:!1,this.stopRecommendation=n?n:!1}var s=(t.window,t.ZSZIA),i=t.ZSChart,h=t.ZSEvents,r=h.topic,a=h.Groups,c=h.Names,n=i.Constants.ChartType;e.prototype={render:function(){return new Promise(function(t){!this.stopPreProcess&&this.preProcess(),this.chartObject.co.chart.renderTo=this.tempID,this.chartObject.wd=this.width,this.chartObject.ht=this.height,!this.stopPreProcess&&this.Layer&&r.publish(a.UI,c.SidePanel.ZIA.META.CHART.ADD_LAYER,{ID:this.ID,LAYER:this.Layer}),!this.stopPreProcess&&this.Layer&&r.publish(a.UI,c.SidePanel.ZIA.META.CHART.SELECT,{LAYER:this.Layer,TYPE:this.chartObject.type}),!this.stopRecommendation&&!this.stopPreProcess&&this.Layer&&this.recommendChartType(this.chartObject),i.Action.createPreview(this.tempID,this.chartObject),setTimeout(function(){t()},200)}.bind(this))},preProcess:function(){this.Layer||(this.Layer=new s.Layer.UIChartLayer(this.ID,this.chartObject.co.title.text),this.parentNode.appendChild(this.Layer.container)),this.trimUnwantedProperty(),this.setTempID(this.Layer.ID),this.appendInsights(this.Layer)},trimUnwantedProperty:function(){this.chartObject.co.plotOptions.series.dataLabels||(this.chartObject.co.plotOptions.series.dataLabels={}),this.chartObject.co.plotOptions.series.dataLabels.enabled=!1,this.chartObject.co.legend.enabled=!1,this.chartObject.co.plotOptions[this.chartObject.co.chart.type].dataLabels.enabled=!1,this.chartObject.co.plotOptions[this.chartObject.co.chart.type].showInLegend=!1,this.chartObject.lf="N",this.chartObject.co.title.text="",this.chartObject.co.plotOptions.series.marker||(this.chartObject.co.plotOptions.series.marker={}),this.chartObject.co.plotOptions.series.marker.enabled=-1!==this.chartObject.type.indexOf(n.SCATTER.toUpperCase())},appendInsights:function(t){this.chartObject.insights&&r.publish(a.UI,c.SidePanel.ZIA.UPDATE_INSIGHTS,{LAYER:t,INSIGHTS:this.chartObject.insights||void 0})},recommendChartType:function(t){var e=new i.Manager.ZRecommendation;e.init(),e.setMetaData(t,!0);var s=e.predict();r.publish(a.UI,c.SidePanel.ZIA.META.CHART.RECOMMEND,{LAYER:this.Layer,TYPE:s})},setTempID:function(t){this.tempID=t},getLayer:function(){return this.Layer}},s.Model.ChartView=e}(this);
!function(t){function i(t,i,e,s,h,o,r){this.parentNode=t,this.ID=i,this.pivotObject=e,this.tempID=void 0,this.height=s||240,this.width=h||330,this.Layer=r||null,this.stopPreProcess=o?o:!1,this.pivotLayer=null}{var e=(t.window,t.ZSZIA),s=t.ZSClass;s.Pivot.Util}i.prototype={render:function(){return new Promise(function(t){!this.stopPreProcess&&this.preProcess(),this.pivotObject.width=this.width,this.pivotObject.height=this.height;var i=s.Pivot.Util.create();this.Layer.appendChild(i);var e=i.getContext("2d"),h=new s.Pivot.Util.CanvasGrid(i,e,this.pivotObject);h.draw(),setTimeout(function(){t()},200)}.bind(this))},preProcess:function(){this.pivotLayer=new e.Layer.UIPivotLayer(this.ID,this.pivotObject.title,this.pivotObject.data.length),this.Layer=this.pivotLayer.getViewSpace(),this.parentNode.appendChild(this.pivotLayer.getContainer())},setTempID:function(t){this.tempID=t},getLayer:function(){return this.pivotLayer}},e.Model.PivotView=i}(this);
!function(t){function e(t,e,i){this.pivotsectionTag=document.createElement("section");var n=t;this.pivotsectionTag.id="pivot_explorepreview"+n,this.pivotsectionTag.classList.add("pb10");var s=document.createElement("div");s.classList.add("tCg"),this.pivotsectionTag.appendChild(s);var p=document.createElement("label");p.className="tCg",p.setAttribute("for","pivot_explorepreview"+n),s.appendChild(p);var v=document.createElement("div");v.classList.add("pTcH"),v.innerHTML=e,p.appendChild(v);var h=document.createElement("div");h.classList.add("cHaA"),h.setAttribute("id","rpId"+n),p.appendChild(h);var u=document.createElement("div");u.className="sHoP",this.pivotsectionTag.appendChild(u);var g=document.createElement("div");g.className="zIn pivot_zIn_Tab",g.id=n+"_zoom_explorepreview"+n,g.title=c["Zia.Zoom"];var E=document.createElement("div");E.className="ins_Tab pivot_ins_Tab",E.id=n+"_ins_explorepreview"+n,E.title=c["Zia.Insert.Pivot"],E.pivotTitle="",u.appendChild(E),u.appendChild(g);var m=document.createElement("div");m.classList.add("pivotFade"),m.style.height=this.height,m.style.width=this.width,h.appendChild(m);var C=document.createElement("div");C.className="fadeOutArea fadeOutBox",12>i&&(C.style.display="none");var y=document.createElement("div");y.classList.add("fOa"),C.appendChild(y),this.pivotLayer=document.createElement("div"),this.pivotLayer.id="explorepreview"+n,this.pivotLayer.classList.add("pvtAutoWidth"),m.appendChild(this.pivotLayer),m.appendChild(C),this.ID=this.pivotLayer.id;var I=o.Wrapper.DOMUtils;I.addEventByNode(this.pivotsectionTag,I.Events.MOUSEOVER,function(){l.publish(d.UI,r.SidePanel.ZIA.HIGHLIGHT_RANGE,{ID:t,TYPE:"PIVOT"})}),I.addEventByNode(this.pivotsectionTag,I.Events.MOUSELEAVE,function(){a.Client.Range.Highlight.REMOVE.fn.call(this)}),I.addEventByNode(g,I.Events.CLICK,function(){a.Client.Zoom.PIVOT.fn.call(this,t)}),I.addEventByNode(E,I.Events.CLICK,function(){a.Client.Insert.PIVOT.fn.call(this,t)}),this.attachDragable(t)}function i(t){var e=document.createElement("canvas"),i=e.getContext("2d"),n=t.querySelector("canvas");return e.width=320,e.height=220,i.drawImage(n,0,0,320,220),e}function n(t){t&&t._collapseHeader()}{var a=(t.window,t.ZSZIA),o=t.ZSChart,s=t.ZSEvents,l=s.topic,d=s.Groups,r=s.Names,c=t.ZSConstants.I18N,c=(t.UserAction,t.ZSConstants.I18N),p=t.UIUtil.Component,v=ZSClass.Range;a.Constants.META.Type}e.prototype.getViewSpace=function(){return this.pivotsectionTag.querySelector("#"+this.ID)},e.prototype.getContainer=function(){return this.pivotsectionTag},e.prototype.getDraggableLayer=function(){return this.pivotLayer},e.prototype.attachDragable=function(t){var e=1;p.draggable(this.pivotsectionTag,{helper:function(){var t=this.getDraggableLayer();return i(t)}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(t){a.Client.Range.Highlight.REMOVE.fn.call(this);var i=a.Utility.getAbsoluteRowPosbyInMouseEvent(t),n=a.Utility.getAbsoluteColPosbyInMouseEvent(t),o=new v(i,n,i,n);a.Client.Range.Highlight.ADD.fn.call(this,e,o)},onStop:function(e){if(a.Client.Range.Highlight.REMOVE.fn.call(this),a.Client.isAllowToAddOnDragEnd(e)){var i=a.Utility.getAbsoluteRowPosbyInMouseEvent(e),n=a.Utility.getAbsoluteColPosbyInMouseEvent(e);a.Client.onDragEnd.PIVOT.fn.call(this,t,i,n)}}})},e.prototype._collapseHeader=function(){this.pivotsectionTag.setAttribute("data-pchead","same")},a.Layer.UIPivotLayer=e,l.register(d.UI,r.SidePanel.ZIA.META.PIVOT.HEADER.COLLAPSE,n,"LAYER")}(this);
!function(e){var n=(e.window,e.ZSZIA),t=e.sPlusPlus,i=e.ZSEvents,r=i.topic,o=i.Groups,l=i.Names,a=n.Constants.META.Type,g=e.UserAction;n.Client.NLP_RECOMMEND_QUERIES={fn:function(e){var t=e.RecQueries;n.Utility.renderQueries(t)}},n.Client.CHART={fn:function(e,t){new Promise(function(i){n.Utility.renderChartRecommendations(e,t),setTimeout(function(){i()},200)})}},n.Client.PIVOT={fn:function(e,t){new Promise(function(i){n.Utility.renderPivotRecommendations(e,t),setTimeout(function(){i()},200)})}},n.Client.MIXED={fn:function(e){new Promise(function(t){n.Utility.renderMixedRecommendations(e),setTimeout(function(){t()},200)})}},n.Client.Range={},n.Client.Range.Highlight={},n.Client.Range.Highlight.REMOVE={fn:function(){var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),i=t.view.getVersionID(e),a=t.view.getSheetID(e);r.publish(o.Listener,l.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:n,SHEETID:a,VERSION:i})}},n.Client.Range.Highlight.CHART={fn:function(e){var i=new n.Manager.ZiaViewManager,r=i.getActiveHolder();if(r){var o=r.getChartMetaByID(e);if(o){var l=t.view.getActiveGridID(),a=t.view.getResourceID(l),g=t.view.getVersionID(l),s=(t.view.getSheetID(l),o.getRange());n.Client.Range.Highlight.REMOVE.fn.call(this);var c=s.trim().split(";"),f=1;c.forEach(function(e){var t=JSUtil.Range.parseRange(a,g,e);t&&n.Client.Range.Highlight.ADD.fn.call(this,f,t.range),f++})}}}},n.Client.Range.Highlight.ADD={fn:function(e,n,i){var a=t.view.getActiveGridID(),g=t.view.getResourceID(a),s=t.view.getVersionID(a),c=t.view.getSheetID(a);r.publish(o.Listener,l.UserAction.HIGHLIGHT_RANGE.ADD,{RID:g,SHEETID:c,VERSION:s,RANGEID:e,RANGE:n,COLOR:i||"#f7b44b"})}},n.Client.Range.Highlight.PIVOT={fn:function(e){var i=new n.Manager.ZiaViewManager,r=i.getActiveHolder();if(r){var o=r.getPivotMetaByID(e);if(o){var l=t.view.getActiveGridID(),a=t.view.getResourceID(l),g=t.view.getVersionID(l),s=(t.view.getSheetID(l),o.pa_json),c=s.dataRangeStr;if(c){n.Client.Range.Highlight.REMOVE.fn.call(this);var f=c.trim().split(";"),v=1;f.forEach(function(e){var t=JSUtil.Range.parseRange(a,g,e);t&&n.Client.Range.Highlight.ADD.fn.call(this,v,t.range),v++})}}}}},n.Client.Insert={},n.Client.Zoom={},n.Client.onDragEnd={},n.Client.Insert.CHART={fn:function(e){var t=new n.Controller.ZController;t.insert(e,a.CHART)}},n.Client.Insert.PIVOT={fn:function(e){var t=new n.Controller.ZController;t.insert(e,a.PIVOT)}},n.Client.Zoom.CHART={fn:function(e){var t=new n.Controller.ZController;t.zoom(e,a.CHART)}},n.Client.Zoom.PIVOT={fn:function(e){var t=new n.Controller.ZController;t.zoom(e,a.PIVOT)}},n.Client.isAllowToAddOnDragEnd=function(e){var t=n.Utility.getWrapperNode(),i=t.getBoundingClientRect();return i.left-50<e.clientX?!1:!0},n.Client.onDragEnd.CHART={fn:function(e,t,i){var r=new n.Controller.ZController;r.onDragEnd(e,a.CHART,t,i)}},n.Client.onDragEnd.PIVOT={fn:function(e,t,i){var r=new n.Controller.ZController;r.onDragEnd(e,a.PIVOT,t,i)}},n.Client.onDragEnd.FORMULA={fn:function(e,i,r,o){if(!n.Utility.isReadOnlyView()){var l=t.view.getActiveGridID(),a=t.view.getResourceID(l),s=t.view.getVersionID(l),c=t.view.getSheetID(l),f=[];f.push(c),g.SubmitCellAlongWithPattern(a,f,s,r,o,e,i)}}}}(this);
!function(e){function t(e){function t(e){var t=[];"string"==typeof e?t.push(e):t=e,i(t),s.showById("zResult")}function i(e){var t=I.Wrapper.DOMUtils,i=t.getElementById("zResultTable");i.innerHTML="";var n=t.createElement("table");n.classList.add("wid100"),e.forEach(function(e){var i=t.createElement("tr"),r=t.createElement("td");r.innerHTML=e,t.appendChild(i,r),t.appendChild(n,i)}),t.appendChild(i,n),e.length>6&&t.showById("zTableFade")}function n(e){s.setInnerHTML("Question",e),s.showById("Question"),s.showById("zQQuestion")}function r(e,t){function i(e){for(var t=u.length,i=0;t>i;i++){var n=u[i];if(n.toLowerCase()==e.toLowerCase())return!0}return!1}function n(e){for(var t=c.length,i=0;t>i;i++){var n=c[i];if(n.toLowerCase()==e.toLowerCase())return!0}return!1}function r(e){var t=[];return e.forEach(function(e){var i=e.trim().split(" ");i.forEach(function(e){-1==t.indexOf(e)&&t.push(e)})}),t}function o(e){var t=s.createElement("span");t.innerHTML=e,t.classList.add("ziaBold"),t.classList.add("ziaTokenLeft"),t.classList.add("pr5"),s.appendChild(I,t)}function a(e){var t=s.createElement("span");t.innerHTML=e,t.classList.add("ziaBold"),t.classList.add("ziaTokenLeft"),t.classList.add("pr5"),s.appendChild(I,t)}function d(e){var t=s.createElement("span");t.innerHTML=e,t.classList.add("ziaTokenLeft"),t.classList.add("pr5"),s.appendChild(I,t)}var l=e.trim().split(" "),u=t.functions,c=r(t.columns),I=s.getElementById("Answar");l.forEach(function(e){i(e)?o(e):n(e)?a(e):d(e)}),s.showById("Answar"),s.showById("zQAnswar")}function o(e,t){var i=s.getElementById("Formula");i.setAttribute("data-formula",e),i.setAttribute("data-pattern",t),s.setInnerHTML("Formula",e),s.showById("Formula"),s.showById("zQFormula")}var s=I.Wrapper.DOMUtils;s.addClass(s.getElementById("recommendedNLPQuery"),"startQry"),s.show(s.getElementByClassName("relatedQry")),s.setInnerHTML("Question",""),s.setInnerHTML("Answar",""),s.setInnerHTML("Formula",""),s.hideById("Question"),s.hideById("zQQuestion"),s.hideById("Answar"),s.hideById("zQAnswar"),s.hideById("Formula"),s.hideById("zQFormula"),s.hideById("zResult"),s.hideById("zTableFade"),e&&e.userQuery&&n(e.userQuery),e&&e.naturalString&&r(e.naturalString,e.keywords),e&&e.formula&&o(e.formula,e.pattern),e&&e.result&&t(e.result),s.addAttributes("voice_cancel",{"data-state":"result"})}function i(e){var t=I.Wrapper.DOMUtils;c.Utility.renderQueries(e);var i=e&&e.length>=1;i?t.showById("zRelatedQry"):t.hideById("zRelatedQry")}function n(e){var t=I.Wrapper.DOMUtils,i=t.getElementById("qryResult");t.show(i),c.Client.CHART.fn.call(this,o(e),i)}function r(e){var t=I.Wrapper.DOMUtils,i=t.getElementById("qryResult");t.show(i),c.Client.PIVOT.fn.call(this,o(e),i)}function o(e){var t=[];return t.push(e),t}function s(){var e=I.Wrapper.DOMUtils;e.addClass(e.getElementById("recommendedNLPQuery"),"loading")}function a(){var e=I.Wrapper.DOMUtils,t=e.getElementById("recommendedNLPQuery");t.classList.remove("loading"),h.publish(g.UI,p.SidePanel.ZIA.QUERY.CLEAR)}function d(){var e=I.Wrapper.DOMUtils;e.removeClass(e.getElementById("recommendedNLPQuery"),"startQry"),e.setInnerHTML("qryResult",""),e.hide(e.getElementByClassName("invalidQuest"))}function l(){var e=I.Wrapper.DOMUtils;e.show(e.getElementByClassName("invalidQuest"))}function u(e){try{var t=!0;if(!e.naturalString)return!1;switch(e.naturalString){case"invalid":t=!1}return t}catch(e){return!1}return!0}var c=(e.window,e.ZSZIA),I=e.ZSChart,y=e.sPlusPlus,v=e.ZSEvents,h=v.topic,g=v.Groups,p=v.Names,E=c.Constants,f=E.Index.CHART,m=E.Index.PIVOT,R=ZSConstants.I18N,w=e.ZSDevTools,U=w.Logger;c.Utility.parsePriority=function(e,t){var i=t.isColRange(),n=null,r=i?1:2,o=i?t.isCol():t.isRow();return o&&(n={type:r,range:e+"."+t.getLabel()}),n},c.Utility.isReadOnlyView=function(){var e=y.view.getActiveGridID(),t=y.view.getResourceID(e),i=y.view.getVersionID(e),n=y.view.getSheetID(e),r=y.data.getWorkBook(t,i);return r.isEditable()?r.ProtectedSheets.isSheetLocked(n)?(ZSClass.ZSAlert(R["ProtectRange.UI.SheetLocked"]),!0):!1:(ZSClass.ZSAlert(R["Banner.ReadOnly.App.Server"],{title:R["Alert.Title.ROMode"]}),!0)},c.Utility.isCellBeneathPivot=function(e,t){var i=y.view.getActiveGridID(),n=y.view.getResourceID(i),r=y.view.getVersionID(i),o=y.view.getSheetID(i),s=y.data.getWorkBook(n,r),a=s.getSheetObj(o),d=a.Pivot;return!!d.isXists(e,t)},c.Utility.getAbsoluteRowPosbyInMouseEvent=function(e){var t=y.view.getActiveGridID(),i=(y.view.getResourceID(t),y.view.getVersionID(t),y.view.getSheetID(t)),n=y.view.getSheetState(t,i),r=n.getZoom(),o=c.Utility.getRowPosbyInMouseEvent(e),s=c.Utility.getTopByRowPos(o);s-=(e.offsetY-19)/r;var a=new I.Utility.ChartAgent,d=a.getRowPosbyTop(s);return d},c.Utility.getAbsoluteColPosbyInMouseEvent=function(e){var t=y.view.getActiveGridID(),i=(y.view.getResourceID(t),y.view.getVersionID(t),y.view.getSheetID(t)),n=y.view.getSheetState(t,i),r=n.getZoom(),o=c.Utility.getColPosbyInMouseEvent(e),s=c.Utility.getleftByColPos(o);s-=(e.offsetX-18)/r;var a=new I.Utility.ChartAgent,d=a.getColPosbyLeft(s);return d},c.Utility.getRowPosbyInMouseEvent=function(e){var t=y.view.getActiveGridID(),i=y.view.getResourceID(t),n=y.view.getVersionID(t),r=y.view.getSheetID(t),o=y.data.getWorkBook(i,n),s=o.getSheetObj(r),a=y.view.getGridComponent(t),d=a.getRelativeCoordinates(e),l=s.Row.axis.findAbs(d.y);return l},c.Utility.getleftByColPos=function(e){var t=y.view.getActiveGridID(),i=y.view.getResourceID(t),n=y.view.getVersionID(t),r=y.view.getSheetID(t),o=y.data.getWorkBook(i,n),s=o.getSheetObj(r),a=s.Column;return a.axis.getPos(e)},c.Utility.getTopByRowPos=function(e){var t=y.view.getActiveGridID(),i=y.view.getResourceID(t),n=y.view.getVersionID(t),r=y.view.getSheetID(t),o=y.data.getWorkBook(i,n),s=o.getSheetObj(r),a=s.Row;return a.auxiliaryAxis.getPos(e)},c.Utility.getColPosbyInMouseEvent=function(e){var t=y.view.getActiveGridID(),i=y.view.getResourceID(t),n=y.view.getVersionID(t),r=y.view.getSheetID(t),o=y.data.getWorkBook(i,n),s=o.getSheetObj(r),a=y.view.getGridComponent(t),d=a.getRelativeCoordinates(e),l=s.Column.axis.findAbs(d.x);return l},c.Utility.getWrapperNode=function(){return document.getElementById("pivotRec_container")},c.Utility.renderMixedRecommendations=function(e){for(var t=document.getElementById("recommendedMixedList"),i=0;i<e.length;i++){{var n=e[i];Object.keys(n).length-1}this.render(n,this,t)}},c.Utility.renderQueries=function(e,t){!e&&(e=[]);var i=document.getElementById("queryList"),n=t&&-1!=t?e.slice(0,t):e,r=new c.Layer.LYQuery(i,n);r.place()},c.Utility.render=function(e,t,i){return new Promise(function(n){function r(e){try{var t=new c.Model.ChartView(i,c.Constants.META.Type.CHART+"_"+c.Utility.getChartIndex(),e,220,330);t.render()}catch(e){U.isEnabled&&U.log("[ZIA] >>>>>>>> Chart Thrown exception while rendering ",e)}}function o(e){try{var t=new c.Model.PivotView(i,c.Constants.META.Type.PIVOT+"_"+c.Utility.getPivotIndex(),e,220,330);t.render(),h.publish(g.UI,p.SidePanel.ZIA.META.PIVOT.HEADER.COLLAPSE,{LAYER:t.getLayer()})}catch(e){U.isEnabled&&U.log("[ZIA] >>>>>>>> Pivot Thrown exception while rendering ",e)}}e&&e[c.Constants.META.Type.CHART]&&r.call(this,e[c.Constants.META.Type.CHART]),e&&e[c.Constants.META.Type.PIVOT]&&o.call(this,e[c.Constants.META.Type.PIVOT]),setTimeout(function(){n(t)},200)})},c.Utility.renderPivotRecommendations=function(e,t){var i=t||document.getElementById("recommendedTableList");this.processPivotResponse(i,e)},c.Utility.processPivotResponse=function(e,t){var i=t.shift();if(i){var n=c.Utility.getPivotIndex(),r=new c.Model.PivotView(e,c.Constants.META.Type.PIVOT+"_"+n,i,220,344);r.render().then(function(){setTimeout(function(){this.processPivotResponse(e,t)}.bind(this),200)}.bind(this))}},c.Utility.renderChartRecommendations=function(e,t){var i=t||document.getElementById("recommendedGraphList");this.processChartResponse(i,e)},c.Utility.processChartResponse=function(e,t){var i=t.shift();if(i){var n=c.Utility.getChartIndex(),r=new c.Model.ChartView(e,c.Constants.META.Type.CHART+"_"+n,i,220,344);r.render().then(function(){setTimeout(function(){this.processChartResponse(e,t)}.bind(this),200)}.bind(this))}},c.Utility.clearComponent=function(){var e=I.Wrapper.DOMUtils,t=["queryList","recommendedGraphList","recommendedTableList","recommendedMixedList"];t.forEach(function(t){e.setInnerHTML(t,"")})},c.Utility.hideReportComponent=function(){var e=I.Wrapper.DOMUtils,t=["recommendedGraphList","recommendedTableList","recommendedMixedList"];t.forEach(function(t){e.hideById(t)})},c.Utility.showReportComponent=function(){var e=I.Wrapper.DOMUtils,t=["recommendedGraphList","recommendedTableList","recommendedMixedList"];t.forEach(function(t){e.showById(t)});var i=new c.Manager.ZiaViewManager,n=i.getActiveHolder();if(n){var r=n.getQueries();c.Utility.renderQueries(r,3)}},c.Utility.hideQueryComponent=function(){var e=I.Wrapper.DOMUtils,t=["recommendedNLPQuery"];t.forEach(function(t){e.hideById(t)})},c.Utility.showQueryComponent=function(){var e=I.Wrapper.DOMUtils,t=["recommendedNLPQuery"];t.forEach(function(t){e.showById(t)})},c.Utility.processQueryResult=function(e){var t=e,i=u(t);i||h.publish(g.UI,p.SidePanel.ZIA.QUERY.ERROR),h.publish(g.UI,p.SidePanel.ZIA.QUERY.UPDATE.DOM,{META:t}),h.publish(g.UI,p.SidePanel.ZIA.QUERY.RENDER.PREPROCESS,{META:t}),i&&h.publish(g.UI,p.SidePanel.ZIA.QUERY.RENDER.RELATED_QUERY,{META:t.related}),i&&h.publish(g.UI,p.SidePanel.ZIA.QUERY.RENDER.PIVOT,{META:t.pivotJSON}),i&&h.publish(g.UI,p.SidePanel.ZIA.QUERY.RENDER.CHART,{META:t.chartJSON})},c.Utility.showError=function(){var e=I.Wrapper.DOMUtils;e.showById("ZIAMessage")},c.Utility.hideError=function(){var e=I.Wrapper.DOMUtils;e.hideById("ZIAMessage")},c.Utility.getChartIndex=function(){return f++},c.Utility.getPivotIndex=function(){return m++},c.Utility.resetIndex=function(){f=E.Index.CHART,m=E.Index.PIVOT},h.register(g.UI,p.SidePanel.ZIA.QUERY.RENDER.RELATED_QUERY,i,"META"),h.register(g.UI,p.SidePanel.ZIA.QUERY.RENDER.CHART,n,"META"),h.register(g.UI,p.SidePanel.ZIA.QUERY.RENDER.PIVOT,r,"META"),h.register(g.UI,p.SidePanel.ZIA.QUERY.UPDATE.DOM,t,"META"),h.register(g.UI,p.SidePanel.ZIA.QUERY.PROCESSS.QUEUE,s),h.register(g.UI,p.SidePanel.ZIA.QUERY.PROCESSS.COMPLETE,a),h.register(g.UI,p.SidePanel.ZIA.QUERY.CLEAR,d),h.register(g.UI,p.SidePanel.ZIA.QUERY.ERROR,l)}(this);
!function(t){function s(){this.fn=void 0,this.args=void 0,this.action=void 0}{var i=(t.window,t.sPlusPlus,t.ZSZIA),o=(t.sPlusPlus,t.ZSEvents);o.topic,o.Groups,o.Names,t.JSUtil,t.ZSDevTools.Logger}s.prototype={process:function(){this.fn.apply(this,this.args)},getAction:function(){return this.action},setProperties:function(t){this.fn=t.fn,this.action=t.action,this.args=t.params}},i.Model.RequestObject=s}(this);
!function(t){function i(){this.queue=[],this.quid=-1,this.xuid=-1,this.ttl=void 0,this.queueing=!1}var e=(t.window,t.sPlusPlus,t.ZSZIA),s=(t.sPlusPlus,t.ZSEvents),u=(s.topic,s.Groups,s.Names,t.JSUtil,t.ZSDevTools.Logger);i.prototype.addActionIntoQueue=function(t){u.isEnabled&&u.log("[ZIA] >>>>>>>>>> Added Request to Queue  of action ",t.getAction()),this.queueing=!0,this.queue.push(t),this.getNextQuid(),clearTimeout(this.ttl),this.ttl=setTimeout(this.execute.bind(this),500),this.queueing=!1},i.prototype.execute=function(){if(!this.queueing){var t=(this.quid,this.queue.pop());u.isEnabled&&u.log("[ZIA] >>>>>>>>>> going to perfromAction ",t.getAction()),this.perfromAction(t);var i=this.getNextXaid();u.isEnabled&&u.log("[ZIA] >>>>>>>>>> last perfomed xaid ",i)}},i.prototype.flush=function(){u.isEnabled&&u.log("[ZIA] >>>>>>>>>> Flushing Unwnated Request "),this.queue=[],this.quid=-1,this.xuid=-1,this.ttl=void 0,this.queueing=!1},i.prototype.perfromAction=function(t){try{t.process(),this.ttl=setTimeout(this.flush.bind(this),1e3)}catch(i){u.isEnabled&&u.log("[ZIA] >>>>>>>>>> last perfomed action is failed due to ",t.getAction(),i)}},i.prototype.getNextQuid=function(){this.quid++},i.prototype.getNextXaid=function(){var t=this.quid;return this.quid--,t},e.Manager.ZiaRequestManager=new i}(this);
!function(e){function t(e,t){this.chartsectionTag=document.createElement("section");var i=e;this.chartsectionTag.id="chart_explorepreview"+i;var a=document.createElement("div");a.classList.add("tCg"),this.chartsectionTag.appendChild(a);var n=document.createElement("label");n.className="tCg",n.setAttribute("for","chart_explorepreview"+i),a.appendChild(n);var o=document.createElement("div");o.classList.add("pTcH"),o.innerHTML=t,n.appendChild(o),this.initInsightsLayer(n,i);var d=document.createElement("div");d.classList.add("cHaA"),d.setAttribute("id","rcId"+i),n.appendChild(d);var T=document.createElement("div");T.className="sHoP",this.chartsectionTag.appendChild(T);var E=document.createElement("div");E.className="zIn chart_zIn_Tab",E.id=i+"_zoom_explorepreview"+i,E.title=p["Zia.Zoom"];var g=document.createElement("div");g.className="ins_Tab chart_ins_Tab",g.id=i+"_ins_explorepreview"+i,g.title=p["Zia.Insert.Chart"],T.appendChild(g),T.appendChild(E),this.chartLayer=document.createElement("div"),this.chartLayer.id="explorepreview"+i,this.chartLayer.style.height=this.height,this.chartLayer.style.width=this.width,d.appendChild(this.chartLayer),this.container=this.chartsectionTag,this.ID=this.chartLayer.id;var u=s.Wrapper.DOMUtils;u.addEventByNode(this.chartsectionTag,u.Events.MOUSEOVER,function(){c.publish(l.UI,h.SidePanel.ZIA.HIGHLIGHT_RANGE,{ID:e,TYPE:"CHART"})}),u.addEventByNode(this.chartsectionTag,u.Events.MOUSELEAVE,function(){r.Client.Range.Highlight.REMOVE.fn.call(this)}),u.addEventByNode(E,u.Events.CLICK,function(){r.Client.Zoom.CHART.fn.call(this,e)}),u.addEventByNode(g,u.Events.CLICK,function(){r.Client.Insert.CHART.fn.call(this,e)}),this.initTypeLayer(i),this.attachDragable(e)}function i(e,t){var i=e.getInsightsSpace();t.length>1&&(i.innerHTML=t)}function a(e,t){e&&e.updateProposedChartTypes(t)}function n(e){e&&e._collapseHeader()}{var r=(e.window,e.ZSZIA),s=e.ZSChart,o=e.ZSEvents,c=o.topic,l=o.Groups,h=o.Names,d=e.UserAction,p=e.ZSConstants.I18N,T=e.UIUtil.Component,E=ZSClass.Range;r.Constants.META.Type,r.Constants.SupportedChart}t.prototype.initTypeLayer=function(e){var t=s.Wrapper.DOMUtils,i=d.getTemplate(["SP_ZIA_CHART_TYPE_TEMPLATE"]);this.chartsectionTag.appendChild(i.SP_ZIA_CHART_TYPE_TEMPLATE);var a=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE"),n=a.children;for(var r in n){var o=n[r];1==o.nodeType&&t.addEventByNode(o,t.Events.CLICK,function(){c.publish(l.UI,h.SidePanel.ZIA.CHANGE_TYPE,{ID:e,Type:this.id})})}},t.prototype.initInsightsLayer=function(e){var t=d.getTemplate(["SP_ZIA_INSIGHTS_TEMPLATE"]);e.appendChild(t.SP_ZIA_INSIGHTS_TEMPLATE)},t.prototype.getInsightsSpace=function(){return this.chartsectionTag.querySelector("#zInsigts")},t.prototype.getDraggableLayer=function(){return this.chartLayer},t.prototype.setChartSelection=function(e){var t=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE"),i=t.children;for(var a in i){var n=i[a];if(1==n.nodeType&&-1!==n.id.indexOf(e)){n.classList.add("sel");break}}},t.prototype.clearAllSelection=function(){var e=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE"),t=e.children;for(var i in t){var a=t[i];1==a.nodeType&&a.classList.remove("sel")}},t.prototype.updateProposedChartTypes=function(e){var t=s.Wrapper.DOMUtils,i=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE"),a=i.children;for(var n in a){var r=a[n];1==r.nodeType&&(-1==e.indexOf(r.id)?t.hide(r):t.show(r))}},t.prototype.attachDragable=function(e){var t=1;T.draggable(this.chartsectionTag,{helper:function(){var e=this.getDraggableLayer();return e.cloneNode(!0)}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(e){r.Client.Range.Highlight.REMOVE.fn.call(this);var i=r.Utility.getAbsoluteRowPosbyInMouseEvent(e),a=r.Utility.getAbsoluteColPosbyInMouseEvent(e),n=new E(i,a,i,a);r.Client.Range.Highlight.ADD.fn.call(this,t,n)},onStop:function(t){if(r.Client.Range.Highlight.REMOVE.fn.call(this),r.Client.isAllowToAddOnDragEnd(t)){var i=r.Utility.getAbsoluteRowPosbyInMouseEvent(t),a=r.Utility.getAbsoluteColPosbyInMouseEvent(t);r.Client.onDragEnd.CHART.fn.call(this,e,i,a)}}})},t.prototype._collapseHeader=function(){this.chartsectionTag.setAttribute("data-pchead","same")},r.Layer.UIChartLayer=t,c.register(l.UI,h.SidePanel.ZIA.META.CHART.HEADER.COLLAPSE,n,"LAYER"),c.register(l.UI,h.SidePanel.ZIA.UPDATE_INSIGHTS,i,"LAYER","INSIGHTS"),c.register(l.UI,h.SidePanel.ZIA.META.CHART.RECOMMEND,a,"LAYER","TYPE")}(this);
!function(e){function t(){this.parent=document.querySelector("body")}var r,i=(e.window,e.ZSZIA),a=e.ZSChart,n=e.ZSEvents,d=n.topic,s=n.Groups,o=n.Names,p=e.ZSConstants.I18N,c=i.Constants.View,l=-1,h={};t.prototype.create=function(){var e=a.Wrapper.DOMUtils;r=e.createElement("div"),r.id="rPtMd",r.classList.add("rPtM"),e.addEventByNode(this.parent,e.Events.KEYUP,function(e){var t=e.keyCode||e.which;switch(t){case 27:this.destroy();break;case 37:this.onLeftMove();break;case 39:this.onRightMove()}}.bind(this)),e.appendChild(this.parent,r);var t=e.createElement("div");t.classList.add("rPtMc");var i=e.createElement("div");i.classList.add("rPtMcB"),e.appendChild(r,i),e.appendChild(r,t);var n=e.createElement("div");n.classList.add("pEsc"),n.innerText=p["Zia.Esc"],e.addEventByNode(i,e.Events.CLICK,this.destroy),e.appendChild(i,n);var d=e.createElement("article");d.classList.add("rPtMcA"),e.appendChild(t,d);var s=e.createElement("div");s.classList.add("ziaLeftArw"),e.addEventByNode(s,e.Events.CLICK,this.onLeftMove),e.appendChild(r,s);var o=e.createElement("section");o.classList.add("rPtMcAs"),e.appendChild(d,o);var c=e.createElement("div");c.id="rPtGrd",e.appendChild(o,c);var l=e.createElement("div");l.id="rPtCrt",l.classList.add("bgClr");var h=document.createElement("button");h.className="Zsbtn flt_right mt10 mr20",h.innerText=p["Zia.Insert"]||"Insert",e.addEventByNode(h,e.Events.CLICK,this.onInsert),e.appendChild(d,h);var v=e.createElement("article");v.classList.add("rPtMcAc"),v.id="zViewSpace",e.appendChild(t,v);var u=e.createElement("div");u.id="rPtCGrd",e.appendChild(v,u);var y=e.createElement("div");y.classList.add("ziaRightArw"),e.addEventByNode(y,e.Events.CLICK,this.onRightMove),e.appendChild(r,y);var E=e.createElement("div");E.classList.add("pgNumber"),e.appendChild(r,E)},t.prototype.destroy=function(){var e=a.Wrapper.DOMUtils;e.remove("rPtMd"),d.publish(s.UI,o.SidePanel.ZIA.CLOSE_ZOOM_VIEW)},t.prototype.getViewSpace=function(){return r.querySelector("#zViewSpace")},t.prototype.getHeaderSpace=function(){return r.querySelector("#rPtGrd")},t.prototype.setActiveElement=function(e){h.id=e.id,h.type=e.type},t.prototype.onInsert=function(){i.Client.Insert[h.type].fn.call(this,h.id)},t.prototype.setIndex=function(e,t){l=e+1,this.setPageIndex(t)},t.prototype.setPageIndex=function(e){var t=a.Wrapper.DOMUtils,i=r.querySelector(".pgNumber");i.innerText=l+"/"+e;var n=r.querySelector(".ziaLeftArw"),d=r.querySelector(".ziaRightArw");t.show(n),t.show(d),1>=l&&t.hide(n),l>=e&&t.hide(d)},t.prototype.hideELement=function(e){var t=a.Wrapper.DOMUtils,i=r.querySelector(".pgNumber"),n=r.querySelector(".ziaLeftArw"),d=r.querySelector(".ziaRightArw");t.show(i),e==c.QUERY&&(t.hide&&t.hide(n),t.hide&&t.hide(d),t.hide&&t.hide(i))},t.prototype.setTableView=function(e){var t=a.Wrapper.DOMUtils,r=t.getElementByClassName("rPtMc");r.setAttribute("data-type",e)},t.prototype.onLeftMove=function(){d.publish(s.UI,o.SidePanel.ZIA.MOVE,{index:l-2})},t.prototype.onRightMove=function(){d.publish(s.UI,o.SidePanel.ZIA.MOVE,{index:l})},i.Layer.UIZoomLayer=t}(this);
!function(e){function t(e,t){this.parentNode=e,this.recQueries=t}function r(){var e=this.dataset;a.publish(o.UI,p.SidePanel.ZIA.PROCESS_QUERY,{QUERY:e.query})}var i=(e.window,e.ZSZIA),n=e.ZSChart,s=e.ZSEvents,a=s.topic,o=s.Groups,p=s.Names;t.prototype.place=function(){var e=n.Wrapper.DOMUtils;this.parentNode.innerHTML="",this.recQueries&&this.recQueries.forEach(function(t){var i=e.createElement("li",{"data-query":t});i.innerHTML=t,e.addEventByNode(i,e.Events.CLICK,r),e.appendChild(this.parentNode,i)}.bind(this))},t.prototype.remove=function(){var e=n.Wrapper.DOMUtils;e.setInnerHTML("queryList","")},i.Layer.LYQuery=t}(this);
!function(t){function e(t,e,i){this.parent=t,this.properties=e,this.lisetener=i,this.eType=null,this.DOM=null,this.index=0,this.active=!1}var i=(t.window,t.ZSZIA),s=t.ZSChart,n=(t.sPlusPlus,t.ZSEvents),o=(n.topic,n.Groups,n.Names,t.ZSConstants.JSKeyCode);e.prototype={init:function(t,e,i,s){t&&(this.parent=t),e&&(this.properties=e),i&&(this.lisetener=i),this.eType=s?s:"NONE",this.initProperty()},initProperty:function(){this.flush(),this.create(),this.refresh(),this.toogle()},create:function(){if(!this.DOM){var t=s.Wrapper.DOMUtils,e=UserAction.getTemplate(["SP_ZIA_AUTOCOMPLETE_TEMPLATE"]);this.DOM=t.createElement("div"),this.DOM.appendChild(e.SP_ZIA_AUTOCOMPLETE_TEMPLATE),t.appendChild(document.querySelector("#recommendedNLPQuery"),this.DOM),this.DOM.classList.add("arrowQry"),t.addEventByNode(this.DOM,t.Events.SCROLL,function(t){t.stopPropagation()}),t.addEventByNode(this.DOM,t.Events.MOUSEWHEEL,function(t){t.stopPropagation()}),t.addEventByNode(this.DOM,t.Events.DOMMOUSEWHEEL,function(t){t.stopPropagation()})}},refresh:function(){var t=this.DOM.querySelector("#autoCompleteList"),e=s.Wrapper.DOMUtils,i=0;this.properties.forEach(function(s){var n=e.createElement("li");n.innerHTML=s,n.id="zSuggestion"+ ++i,n.setAttribute("data-query",s),n.setAttribute("data-etype",this.eType),e.addEventByNode(n,e.Events.CLICK,this.lisetener.click),e.addEventByNode(n,e.Events.CLICK,function(){e.hide(this.DOM)}.bind(this)),e.appendChild(t,n)}.bind(this))},flush:function(){this.active=!1,this.index=0,this.DOM&&(this.DOM.querySelector("#autoCompleteList").innerHTML="")},destroy:function(){this.DOM.remove(),this.DOM=null},toogle:function(){var t=s.Wrapper.DOMUtils;this.DOM.style.top=this.parent.offsetHeight+this.parent.offsetTop+"px",this.properties.length>=1?t.show(this.DOM):t.hide(this.DOM)},hide:function(){var t=s.Wrapper.DOMUtils;this.DOM&&t.hide(this.DOM),this.active=!1},select:function(t){this.active=!0;var e;if(this.properties){switch(t){case o.DOWN:this.index++,this.properties.length<this.index&&(this.index=1),e=this.index;break;case o.UP:this.index--,this.index<=0&&(this.index=this.properties.length),e=this.index}this.selectElementOnIndex(e)}},selectElementOnIndex:function(t){this.deselectAll();var e=document.getElementById("zSuggestion"+t);e.scrollIntoViewIfNeeded(),e.classList.add("sel")},deselectAll:function(){var t=0;this.properties.forEach(function(){document.getElementById("zSuggestion"+ ++t).classList.remove("sel")})},isSelected:function(){return this.active},onSelectionClick:function(){this.active=!1,document.getElementById("zSuggestion"+this.index).click()}},i.Layer.LYAutoComplete=e}(this);
!function(t){function o(t){this.tokens=null,this.init(t)}function e(t,o){var e=t.toLowerCase(),n=o.toLowerCase();return n>e?-1:e>n?1:0}{var n=(t.window,t.ZSZIA),s=(t.ZSChart,t.sPlusPlus,t.ZSEvents);s.topic,s.Groups,s.Names}o.prototype.init=function(t){t.forEach(function(t){this.addToken(t)}.bind(this))},o.prototype.addTokens=function(t){this.init(t),this.sort()},o.prototype.sort=function(){this.tokens.sort(e)},o.prototype.addToken=function(t){this.tokens||(this.tokens=[]),-1==this.tokens.indexOf(t)&&this.tokens.push(t)},o.prototype.getTokens=function(t){var o=[];return this.getAllTokenContains(this.tokens,t,o)},o.prototype.getAllTokenContains=function(t,o,e){return t.forEach(function(t){if(o.length>=1&&0==t.toLowerCase().indexOf(o.toLowerCase())&&t.toLowerCase()!==o.toLowerCase())e.push(t);else if(o.length>=1)for(var n=t.split(" "),s=n.length,i=0;s>i;i++){var r=n[i];0==r.toLowerCase().indexOf(o.toLowerCase())&&r.toLowerCase()!==o.toLowerCase()&&e.push(t)}}),e},n.Model.AutoComplete=o}(this);
!function(t){function e(){this.Layer=null,this.parent=null,this.model=null,this.init()}var i=(t.window,t.ZSZIA),n=t.ZSChart,o=t.sPlusPlus,s=t.ZSEvents,a=s.topic,r=s.Groups,u=s.Names,l=t.ZSConstants.I18N;const g=[l["Zia.Suggestions.Average"],l["Zia.Suggestions.Best"],l["Zia.Suggestions.Chart"],l["Zia.Suggestions.Count"],l["Zia.Suggestions.Difference"],l["Zia.Suggestions.Maximum"],l["Zia.Suggestions.Minimum"],l["Zia.Suggestions.Product"],l["Zia.Suggestions.Sum"],l["Zia.Suggestions.Top"],l["Zia.Suggestions.between"],l["Filter.of"]];var c={click:function(){var t=this.dataset,e=t.query,i=t.etype;a.publish(r.UI,u.SidePanel.ZIA.SEARCH_ITEM_CLICK,{VALUE:e,ETYPE:i})}};e.prototype.init=function(){this.model=new i.Model.AutoComplete(g),this.Layer=new i.Layer.LYAutoComplete},e.prototype.setParentElement=function(t){this.parent=t},e.prototype.initLayer=function(t,e,i){this.Layer.init(this.parent,t,e,i)},e.prototype.create=function(){var t=new i.Manager.ZiaViewManager,e=t.getActiveHolder(),s=new n.Utility.ChartAgent;if(e){var a=e.getRanges(),r=a.trim().split(";"),u=o.view.getActiveGridID(),l=o.view.getResourceID(u),g=o.view.getVersionID(u),c=o.view.getSheetID(u),p=o.data.getWorkBook(l,g),h=p.getSheetObj(c),d=h.Prop.Name;r.forEach(function(t){if(t.length>1){var e=JSUtil.Range.parseRange(l,g,t);if(e){var i=e.range,n=new ZSClass.Range(i.startRow,i.startCol,i.startRow,i.endCol),o=d+"."+n.getLabel();s.fetchRangeValue(o,"ActualValue",this.addTokens.bind(this),function(){})}}}.bind(this))}},e.prototype.getAllWordConstainsCharset=function(t){return this.getModel().getTokens(t)},e.prototype.getModel=function(){return this.model},e.prototype.addTokens=function(t){var e=[];Object.keys(t).forEach(function(i){var n=t[i];Object.keys(n).forEach(function(t){var i=n[t]||{},o=i.ActualValue||i.DisplayValue||"";o.length>1&&e.push(o)}.bind(this))}.bind(this)),this.getModel().addTokens(e)},e.prototype.buildLayer=function(t,e){this.initLayer(t,c,e)},e.prototype.selectSuggestion=function(t){this.Layer.select(t)},e.prototype.hide=function(){this.Layer.hide()},e.prototype.performSelection=function(){this.Layer.onSelectionClick()},e.prototype.isSelectedSuggestion=function(){return this.Layer.isSelected()},e.prototype.flush=function(){this.model=new i.Model.AutoComplete(g)},i.Manager.ZAutoComplete=new e}(this);
!function(t){function e(t,e){this.parentNode=t,this.response=e,this.alive=!1}var i=(t.window,t.ZSZIA),n=t.ZSChart,a=t.ZSConstants.I18N,s=t.UIUtil.Component,o=ZSClass.Range,r={sum:a["StatusBar.Sum"],avg:a["StatusBar.Average"],min:a["StatusBar.Minimum"],max:a["StatusBar.Maximum"],count:a["StatusBar.Count"],cn:a["StatusBar.CountNumbers"]},l=["sum","avg","min","max","count","cn"];e.prototype.place=function(){n.Wrapper.DOMUtils;this.parentNode.innerHTML="",this.create(),this.toggle()},e.prototype.create=function(){var t=n.Wrapper.DOMUtils,e=1;this.response&&l.forEach(function(n){if(this.response[n]){var a=t.createElement("div",{"data-formula":this.response[n].formula||this.response[n]}),l=t.createElement("span"),p=t.createElement("span");t.appendChild(this.parentNode,a),t.appendChild(a,l),t.appendChild(a,p),l.innerText=r[n],p.innerText=this.response[n].value||this.response[n],l.classList.add("ziaBold"),l.classList.add("colorDimGray"),p.classList.add("ziaTokenRight"),a.classList.add("ziaAggElemWrp"),s.draggable(a,{helper:function(){var e=t.createElement("div");return e.innerText=a.dataset.formula,e.cloneNode(!0)}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(t){i.Client.Range.Highlight.REMOVE.fn.call(this);var n=i.Utility.getAbsoluteRowPosbyInMouseEvent(t),a=i.Utility.getAbsoluteColPosbyInMouseEvent(t),s=new o(n,a,n,a);i.Client.Range.Highlight.ADD.fn.call(this,e,s)},onStop:function(t){if(i.Client.Range.Highlight.REMOVE.fn.call(this),i.Client.isAllowToAddOnDragEnd(t)){var e=i.Utility.getAbsoluteRowPosbyInMouseEvent(t),n=i.Utility.getAbsoluteColPosbyInMouseEvent(t);i.Client.onDragEnd.FORMULA.fn.call(this,e,n,a.dataset.formula)}}})}}.bind(this))},e.prototype.remove=function(){var t=n.Wrapper.DOMUtils;this.parentNode.innerHTML="",t.hide(this.parentNode),this.alive=!1},e.prototype.toggle=function(){var t=n.Wrapper.DOMUtils;t.show(this.parentNode),this.alive=!0,0==Object.keys(this.response).length&&(t.hide(this.parentNode),this.alive=!1)},e.prototype.hide=function(){var t=n.Wrapper.DOMUtils;t.hide(this.parentNode),this.alive=!1},e.prototype.isAlive=function(){return this.alive},i.Layer.LYAggregation=e}(this);
!function(e){function t(){this.parentNode=null,this.headers=null,this.filterHeadsers=[],this.alive=!1}function i(){var e=this.parentNode.querySelectorAll("input:checked");this.filterHeadsers=[];for(var t=[],i=e.length,s=(v.Wrapper.DOMUtils,0);i>s;s++){var r=e[s],a="selectAllChkBox"===r.id,l=r.parentNode.id,n=r.parentNode.getAttribute("fdata");!a&&l&&this.filterHeadsers.push({assciatedFilterID:l,filtervalue:n}),n&&t.push(this.headers.values[this.headers.keys.indexOf(n)])}o.call(this,this.filterHeadsers&&this.filterHeadsers.length>=1),this.listeners.filter(t),t.length>=1&&N.publish(A.UI,C.SidePanel.ZIA.FILTER.APPLY)}function s(e){var t=this.parentNode.querySelectorAll("input"),i=t.length,s=v.Wrapper.DOMUtils,r=s.getElementById("selectAllChkBox");s.removeClass(r.parentNode,"partialSelection");for(var a=0;i>a;a++){var l=t[a];l.checked=e}o.call(this,!0)}function r(){var e=this.parentNode.querySelectorAll("input:checked"),t=e.length,i=v.Wrapper.DOMUtils,s=i.getElementById("selectAllChkBox");s.checked&&(t-=1),i.removeClass(s.parentNode,"partialSelection");var r=t==h.call(this),a=!r&&t>0;r&&(s.checked=!0),!r&&(s.checked=!1),a&&i.addClass(s.parentNode,"partialSelection")}function a(){r.call(this)}function l(){this.filterHeadsers=[],n.call(this),this.listeners.clear(),o.call(this,!1),this.selectAllChecked=!1}function n(){for(var e=this.parentNode.querySelectorAll("input:checked"),t=e.length,i=0;t>i;i++){var s=e[i];s.checked=!1}}function h(){return this.headers?this.headers.keys.length:0}function d(){o.call(this,this.filterHeadsers&&this.filterHeadsers.length>=1);var e=v.Wrapper.DOMUtils,t=this.filterHeadsers?this.filterHeadsers.length:0,i=t==h.call(this),s=!i&&t>0;this.filterHeadsers&&this.filterHeadsers.forEach(function(e){var t="#"+e.assciatedFilterID,i=this.parentNode.querySelector(t);if(i){var s=i.querySelector("input");s&&(s.checked=!0)}}.bind(this));var r=e.getElementById("selectAllChkBox");e.removeClass(r.parentNode,"partialSelection"),i&&(r.checked=!0),!i&&(r.checked=!1),s&&e.addClass(r.parentNode,"partialSelection")}function o(e){!e&&this.cancelBtn.setAttribute("disabled",!0),e&&this.cancelBtn.removeAttribute("disabled")}function c(){var e=E.getTemplate(["SP_ZIA_SEARCH_TEMPLATE"]);e&&this.parentNode.appendChild(e.SP_ZIA_SEARCH_TEMPLATE);var t=v.Wrapper.DOMUtils,i=this.parentNode.querySelector("#chrtSearchField"),s=this;t.addEventByNode(i,t.Events.INPUT,function(){p.call(s,this.value)})}function p(e){var t=this.parentNode.querySelectorAll("span");u.call(this);var i=v.Wrapper.DOMUtils;if(""!=e)for(var s=t.length,r=0;s>r;r++){var a=t[r].dataset;-1==a.value.toLowerCase().indexOf(e.toLowerCase())&&i.hide(t[r].parentNode)}}function u(){for(var e=this.parentNode.querySelectorAll("label"),t=e.length,i=v.Wrapper.DOMUtils,s=0;t>s;s++)i.show(e[s])}var f=(e.window,e.ZSZIA),v=e.ZSChart,E=(e.ZSConstants.I18N,e.UIUtil.Component,e.UserAction),y=e.ZSEvents,N=y.topic,A=y.Groups,C=y.Names;t.prototype.hasParent=function(){return!!this.parentNode},t.prototype.setParent=function(e){this.parentNode=e},t.prototype.init=function(e,t){this.headers=e,this.listeners=t},t.prototype.place=function(){v.Wrapper.DOMUtils;this.flush(),this.create(),d.call(this)},t.prototype.create=function(){var e=v.Wrapper.DOMUtils;c.call(this);var t=e.createElement("div");t.classList.add("sPZIAFltrCtn","pl10","pt1"),e.appendChild(this.parentNode,t);var r=1,n="zfilter";this.headers&&this.headers.keys&&this.headers.keys.forEach(function(i){var s=e.createElement("label",{id:n+r});s.setAttribute("fdata",i);var l=e.createElement("input",{type:"checkbox"}),h=e.createElement("span");s.classList.add("sPZIAChk"),h.innerHTML=i,h.setAttribute("data-value",i),e.appendChild(t,s),e.appendChild(s,l);var d=this;e.addEventByNode(l,e.Events.CHANGE,function(){a.call(d)}),e.appendChild(s,h),r++}.bind(this));var h=e.createElement("button");h.classList.add("Zsbtn","flt_right"),h.innerHTML="Filter",this.cancelBtn=e.createElement("button"),this.cancelBtn.classList.add("Zsbtn","Zsbtn-grey","mb"),this.cancelBtn.innerHTML="Clear";var d=e.createElement("div");d.classList.add("wid100","wid","mt10","pt10","pr10","bdrTop"),e.appendChild(d,this.cancelBtn),e.appendChild(d,h),e.appendChild(this.parentNode,d);var o=e.getElementById("selectAllChkBox");e.addEventByNode(o,e.Events.CHANGE,function(e){var t=e.target.checked;s.call(this,t)}.bind(this)),e.addEventByNode(h,e.Events.CLICK,function(){i.call(this)}.bind(this)),e.addEventByNode(this.cancelBtn,e.Events.CLICK,function(){l.call(this)}.bind(this)),N.publish(A.UI,C.SidePanel.ZIA.FILTER.TOGGLE,{HAS_FILTER:this.headers&&this.headers.keys.length>=1})},t.prototype.flush=function(){this.parentNode&&(this.parentNode.innerHTML="")},t.prototype.destroy=function(){this.flush(),this.headers={},this.filterHeadsers=[],N.publish(A.UI,C.SidePanel.ZIA.FILTER.REMOVE)},t.prototype.toggle=function(){this.alive?this.hide():this.show(),this.headers&&0==this.headers.keys.length&&this.hide()},t.prototype.show=function(){var e=v.Wrapper.DOMUtils;e.show(this.parentNode),this.alive=!0},t.prototype.hide=function(){var e=v.Wrapper.DOMUtils;e.hide(this.parentNode),this.alive=!1},t.prototype.get=function(){return this.parentNode},t.prototype.removeSelection=function(){this.filterHeadsers=[],this.selectAllChecked=!1,n.call(this),N.publish(A.UI,C.SidePanel.ZIA.FILTER.REMOVE)},f.Layer.LYFilter=t}(this);
!function(e){function t(){this.Layer=null,this.init()}function r(){var e=n.Manager.ZiaFilterManager;e.destroy()}function i(){var e=n.Manager.ZiaFilterManager;e.removeSelection()}var n=(e.window,e.ZSZIA),a=e.ZSChart,o=(e.sPlusPlus,e.ZSEvents),s=o.topic,l=o.Groups,p=o.Names,h={filter:function(e){s.publish(l.UI,p.SidePanel.ZIA.FILTER.HIDE);var t=new n.Controller.ZController;t.doFilterAction(e)},clear:function(){s.publish(l.UI,p.SidePanel.ZIA.FILTER.HIDE);var e=new n.Controller.ZController;e.resetView({action:"ALL"}),s.publish(l.UI,p.SidePanel.ZIA.FILTER.REMOVE)}};t.prototype.init=function(){this.Layer=new n.Layer.LYFilter,this.setParentElement()},t.prototype.setParentElement=function(){var e=a.Wrapper.DOMUtils,t=e.getElementById("zFltWrapper");this.parent=t,this.Layer.setParent(this.parent)},t.prototype.initLayer=function(e,t){!this.Layer.hasParent()&&this.setParentElement(),this.Layer.init(e||{},t||h),this.Layer.place()},t.prototype.destroy=function(){this.Layer&&this.Layer.destroy()},t.prototype.removeSelection=function(){this.Layer&&this.Layer.removeSelection()},n.Manager.ZiaFilterManager=new t,s.register(l.UI,p.SidePanel.ZIA.FILTER.REMOVE_SELECTION,i),s.register(l.UI,p.SidePanel.ZIA.FILTER.RESET,r)}(this);
!function(e){function n(e,n,s){var E=(t.data.getWorkBook(e,n),{RID:e,VERSION:n,newDocName:s}),c=new i(o.SAVEAS_NEW_DOCUMENT,E),A=new u;A.addEventListeners("onComplete",function(e){r.publish(S.Listener,a.UserAction.SheetCopyResponse,{COPIEDSPREADSHEETNAME:s,RID:e.di,VERSION:n}),c.qaid=e.qaid}),A.addEventListeners("onError",function(e){r.publish(S.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(R.SAVEAS),A.send(E)}var t=e.sPlusPlus,s=e.ZSConstants,o=s.ActionConstants,i=e.ZSClass.ActionObject,E=e.ZSEvents,r=E.topic,S=E.Groups,a=E.Names,R=s.URI,c=t.SML.Client,u=c.Utility.WorkerRequest;e.UserAction.saveAs=n}(this);
!function(e){function t(e,t,n,s,a,r,o,i,l,R,g){if(-1!=o){var S=new ZSClass.ParamGenerator(n,t,s,!1,!1),v=S.getSheets(),I=r?S.getCustomRanges(JSUtil.Range.parseRange(t,s,r).range):S.getRanges(),_=S.getActiveCell(),m={RID:t,sheetList:v,rangeList:I,VERSION:s,activeCell:_,constant:E.DATA_CLEANSING,column:null==o?_.c:o,dataRange:r};l?m.findTableRangeOnly=!0:m.findTableRange=i,i?(L.tableInstance.reset(),m.sheetName=null==a?_.s:a):(m.startRow=L.tableInstance.sr,m.endRow=L.tableInstance.er,m.sheetName=L.tableInstance.sn);var w=new c;w.addEventListeners("onComplete",function(t){R&&R(e,t,g)}),w.addEventListeners("onError",function(e){u.publish(d.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),w.open(C.DC_CLUSTER),w.send(m)}}function n(e,t,n,a){var r=l.view.getActiveGridID(),i=l.view.getResourceID(r),R=l.view.getVersionID(r),c=l.view.getSelectedSheets(r),C=L.tableInstance;s(i,c,R,C.sn,C.sr,C.er,C.getCurrentCol(),e,o(i,R,n,a),t)}function s(t,n,s,a,r,o,i,R,L,S){if(-1!=i){var v=new e.ZSClass.ParamGenerator(n,t,s,!0,!0),I=v.getSheets(),_=v.getRanges(),m=v.getActiveCell(),_=v.getCustomRanges(L,!1),w={RID:t,sheetList:I,rangeList:_,activeCell:m,VERSION:s,isNext:!0,isCaseSensitive:!0,isExactMatch:!0,traverseMode:E.FIND_IN_SHEET,action:E.DATA_CLEANSING_REPLACE_ALL,startRow:r,endRow:o,column:i,replaceCellsArray:R},N=new g(E.DATA_CLEANSING_REPLACE_ALL,w),f=new c;f.addEventListeners("onComplete",function(e){N.qaid=e.qaid,l.data.UserInfo.ActionRecorder.record(N),S&&S("success")}),f.addEventListeners("onError",function(e){u.publish(d.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(C.DC_CLUSTER_REPLACE_ALL),f.send(w)}}function a(t,n,s,a,r){var o=new e.ZSClass.ParamGenerator(s,t,n,!1,!1),i=o.getSheets(),R=a?o.getCustomRanges(a):o.getRanges(),S=o.getActiveCell(),v={RID:t,VERSION:n,sheetList:i,rangeList:R,activeCell:S,action:E.COUNT_EMPTY_CELLS},I=new g(E.COUNT_EMPTY_CELLS,v),_=new c;_.addEventListeners("onComplete",function(e){I.qaid=e.qaid,l.data.UserInfo.ActionRecorder.record(I),L.EmptyRows=e.count,r(e.count.length)}),_.addEventListeners("onError",function(e){u.publish(d.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(C.DC_EMPTY_CELLS_COUNT),_.send(v)}function r(t,n,s,a,r,o,i){var l=new e.ZSClass.ParamGenerator(s,t,n,!1,!1),R=l.getSheets(),L=a?l.getCustomRanges(a):l.getRanges(),S=l.getActiveCell(),I={},_={};o&&(_[v.FILL_EMPTY_VALUE]=o),I[v.FILL_EMPTY_TYPE]=r,I[v.FILL_EMPTY_SUB_PARAMS]=_;var m={RID:t,sheetList:R,activeCell:S,rangeList:L,VERSION:n,action:E.FILL_EMPTY,ap:e.JSON.stringify(I)},w=(new g(E.FILL_EMPTY,m),new c);w.addEventListeners("onComplete",function(){i()}),w.addEventListeners("onError",function(e){u.publish(d.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),w.open(C.DC_FILL_EMPTY_CELLS),w.send(m)}function o(e,t,n,s){var a=JSUtil.Range.parseRange(e,t,n).range;return new ZSClass.Range(a.startRow,s,a.endRow,s)}var i=e.module,l=e.sPlusPlus,R=l.SML.Client,c=R.Utility.WorkerRequest,C=e.ZSConstants.URI,E=e.ZSConstants.ActionConstants,L=l.view.Toolbar.Feature[e.ZSConstants.FeatureConstants.DATA_CLEANING],g=e.ZSClass.ActionObject,S=(i.getModule("SA/UI/Registry"),i.getModule("SA/UI/Constants/ClassNames"),e.ZSEvents),u=S.topic,d=S.Groups,A=S.Names,v=L.JSONConstants;e.UserAction.clusterData=t,e.UserAction.replaceAll=n,e.UserAction.getEmptyCellsCount=a,e.UserAction.fillEmptyCells=r}(this);
!function(e){function t(e,t,r,s,R,S){var l=new ZSClass.ParamGenerator(t,e,r),m=l.getSheets(),c={RID:e,sheetList:m,VERSION:r,formName:s,formDesc:R,sheetName:S},O=new i;O.addEventListeners("onError",function(e){o.log("CreateForm error :",e)}),O.addEventListeners("onComplete",function(t){if(t.mt)return void E.publish(a.Listener,u.ERROR.SHOW,{ERRORMSG:t.mk});if(E.publish(a.Listener,u.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:r,qaid:t.qaid}),t.result){var n=t.result.form_rid;E.publish(a.Listener,u.UserAction.CREATE_FORM_RESPONSE,{FORM_RID:n,FORM_NAME:s})}}),O.open(n.FORM_CREATE),O.send(c)}var r=e.sPlusPlus,s=r.SML.Client,n=e.ZSConstants.URI,o=e.ZSDevTools.Logger,i=s.Utility.WorkerRequest,R=e.ZSEvents,E=R.topic,a=R.Groups,u=R.Names;UserAction.createForm=t}(this);
!function(e){function t(e,t,o,u){var E=n.view.getActiveGridID(),o=n.view.getVersionID(E),d={RID:e,SHEETID:t,VERSION:o,formRid:u},l=new s;l.addEventListeners("onError",function(e){i.log("AutoSum error :",e)}),l.addEventListeners("onComplete",function(){}),l.open(r.FORM_DELETE),l.send(d)}var n=e.sPlusPlus,o=n.SML.Client,r=e.ZSConstants.URI,i=e.ZSDevTools.Logger,s=o.Utility.WorkerRequest;UserAction.deleteForm=t}(this);
!function(n){function e(n,e,t,s){var d=i.view.actionListManager.isEmpty(),L={RID:n,VERSION:e,isActionListRequired:d,isNamedVersionOnly:t},l=new a;l.addEventListeners("onError",function(n){r.log("VersionHistory error :",n)}),l.addEventListeners("onComplete",function(n){n.lists&&i.view.actionListManager.appendAction(n.lists[c.ACTION_LIST]),s(n.vi)}),l.open(o.GET_VERSION_DETAILS),l.send(L)}function t(n,e,t,s,d){var L={RID:n,VERSION:e,versionNumber:t},l=new a;l.addEventListeners("onError",function(n){r.log("VersionHistory error :",n)}),l.addEventListeners("onComplete",function(n){var n=n.lists[c.ACTION_LIST];d&&i.view.actionListManager.appendAction(n),s(n)}),l.open(o.GET_VERSION_ACTION_LIST),l.send(L)}var i=n.sPlusPlus,s=i.SML.Client,o=n.ZSConstants.URI,r=n.ZSDevTools.Logger,a=s.Utility.WorkerRequest,c=ZSConstants.CommandConstants;UserAction.getVersionDetails=e,UserAction.getActionListBasedOnVersion=t}(this);
!function(t){function e(t,e,n,s){if(s[ZSConstants.CommandConstants.DOCUMENT_META]){I.publish(C.Listener,R.ServerAction.PROCESSRESPONSE,{RESPONSE:s,VERSION:n});var a=s[ZSConstants.CommandConstants.DOCUMENT_META];for(var o in a){var i=a[o][ZSConstants.CommandConstants.ACTIVE_INFO];if(i){var e=i[ZSConstants.CommandConstants.ACTIVESHEET_NAME];I.publish(C.Listener,R.SheetAction.CHARTS.REPAINT,{RID:t,SHEETID:e,VERSION:n}),I.publish(C.Listener,R.SheetAction.BUTTONS.REPAINT,{RID:t,SHEETID:e,VERSION:n}),I.publish(C.Listener,R.SheetAction.IMAGES.REPAINT,{RID:t,SHEETID:e,VERSION:n})}}}}function n(t){for(var e=l.getListAsArray(),n=a.data.DocRegistry[t],s=e.length;s>0;s--)delete n[e[s]];l.removeAll()}function s(t,s,o,S,I){var C=a.data.getWorkBook(t,o),R=!1;if(C){var d=C.SheetList.getSheets(),A=d[0];s=A.getID();var T=C.getSheetObj(s);T.Visited&&(R=!0)}var v=new i,u={RID:t,SHEET_ID:s,VERSION:o,isAvailable:R};if(o!==a.data.Defaults.version){var D=l.add(o);if(D){var N=D.data,O=a.data.DocRegistry;O[t]&&O[t][N]&&delete O[t][N]}}v.addEventListeners("onError",function(t){E.log("LoadVersion error :",t)}),v.addEventListeners("onComplete",function(a){e(t,s,o,a),S&&n(t),I&&I(a)}),v.open(r.VERSION_FETCH_DATA),v.send(u)}var a=t.sPlusPlus,o=a.SML.Client,i=o.Utility.WorkerRequest,r=t.ZSConstants.URI,E=t.ZSDevTools.Logger,S=t.ZSEvents,I=S.topic,C=S.Groups,R=S.Names,d=ZSClass.PageReplacement,l=new d(a.data.Defaults.MAX_WORKBOOK_LIMIT);t.UserAction.LoadVersion=s}(this);
!function(e){function n(e,n,o,s,u,l){var S={RID:e,SHEETID:n,formRid:s,publishType:u,isPublish:l,VERSION:o},c=new r;c.addEventListeners("onError",function(e){i.log("AutoSum error :",e)}),c.addEventListeners("onComplete",function(){}),c.open(t.FORM_PUBLISH),c.send(S)}var o=e.sPlusPlus,s=o.SML.Client,t=e.ZSConstants.URI,i=e.ZSDevTools.Logger,r=s.Utility.WorkerRequest;UserAction.publishForm=n}(this);
!function(t){function n(t,n,s,e,o){var E={RID:t,VERSION:n,showAll:s,withMeta:e},I=new l;I.addEventListeners("onError",function(t){r.log("AuditTrail error :",t)}),I.addEventListeners("onComplete",function(t){o(t.lists[a.USER_INFO],t.lists[a.SHEET_LIST],t.lists[a.ACTION_LIST])}),I.open(i.GET_ACTION_LIST),I.send(E)}function s(t,n,s){var e={RID:t,SHEETID:n,VERSION:s},o=new l;o.addEventListeners("onError",function(){r.log("ClearActionList error :")}),o.open(i.CLEAR_ACTION_LIST),o.send(e)}var e=t.sPlusPlus,o=e.SML.Client,i=t.ZSConstants.URI,r=t.ZSDevTools.Logger,l=o.Utility.WorkerRequest,a=ZSConstants.CommandConstants;UserAction.getActionList=n,UserAction.clearActionList=s}(this);
!function(e){function t(e,t,n,r){var o={RID:e,VERSION:t,sheetName:n},i=new a;i.addEventListeners("onError",function(e){d.log("AuditTrailFilter error :",e)}),i.addEventListeners("onComplete",function(e){r(e.reverse())}),i.open(s.AUDIT_FILTER_BY_SHEET),i.send(o)}function n(e,t,n,r){var o={RID:e,VERSION:t,rangeText:n},i=new a;i.addEventListeners("onError",function(e){d.log("AuditTrailFilter error :",e)}),i.addEventListeners("onComplete",function(e){r(e.reverse())}),i.open(s.AUDIT_FILTER_BY_RANGE),i.send(o)}function r(e,t,n,r,o,i){var l={RID:e,VERSION:t,fromDate:r,toDate:o,dateType:n},u=new a;u.addEventListeners("onError",function(e){d.log("AuditTrailFilter error :",e)}),u.addEventListeners("onComplete",function(e){i(e.reverse())}),u.open(s.AUDIT_FILTER_BY_DATE),u.send(l)}var o=e.sPlusPlus,i=o.SML.Client,s=e.ZSConstants.URI,d=e.ZSDevTools.Logger,a=i.Utility.WorkerRequest;UserAction.AuditFilterBySheet=t,UserAction.AuditFilterByRange=n,UserAction.AuditFilterByDate=r}(this);
!function(e){function t(e,t,s,o,a,d,v,R,c){var u=n.view.getActiveGridID(),I=n.view.getSheetID(u),l=n.view.getSheetState(u,I),E=l.getActiveRange(),S=E.startRow+":"+E.startCol+":"+E.endRow+":"+E.endCol,w={RID:e,SHEETID:t,VERSION:s,RANGE:S,printType:R,addGridlines:o,addChart:a,addImage:d,addButton:v},g=new r;g.addEventListeners("onComplete",function(e){c&&c(e)}),g.open(i.PRINT_PREVIEW),g.send(w)}var n=e.sPlusPlus,i=(e.UserAction,e.ZSConstants.URI),s=e.ZSEvents,o=(s.topic,s.Groups,s.Names,n.SML.Client),r=o.Utility.WorkerRequest;e.UserAction.PrintPreview=t}(this);
!function(e){function t(e,t){return e.SheetList.isNameExists(t)}function i(e,t){return e.NamedRange.has(t)}function n(e){var n=g.view.getActiveGridID(),a=g.view.getResourceID(n),R=g.view.getSheetID(n),S=g.view.getVersionID(n),D=g.data.getWorkBook(a,S);t(D,e)&&(e+="!A1");var u=JSUtil.Range.parseRange(a,S,e);if(i(D,e)){var d=D.NamedRange.get(e),A=JSUtil.FormRange(d);u=JSUtil.Range.parseRange(a,S,A)}if(!u)return void o.publish(s.Listener,l.ERROR.SHOW,{ERRORMSG:"InvalidCellReference"});var D=g.data.getWorkBook(a,S),R=u.sheetID?u.sheetID:R,E=u.range;R&&E.startRow>=0&&E.startCol>=0&&E.endRow<v&&E.endCol<c?(r(a,R,S,E,E.startRow,E.startCol),i(D,e)&&o.publish(s.Listener,l.UserAction.NamedRangePriorityHandler,{RANGENAME:e})):o.publish(s.Listener,l.ERROR.SHOW,{ERRORMSG:"InvalidCellReference"})}function r(e,t,i,n,r,a,S){var c=(g.data.getWorkBook(e,i),g.view.getActiveGridID()),v=g.view.getSheetID(c);if(v!=t)UserAction.SwitchSheet(e,v,i,t,n);else{var c=g.view.getActiveGridID(),D=(g.view.getSheetState(c,t),new R.Range(r,a,r,a));o.publish(s.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:n,TYPE:S}),o.publish(s.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:D,ROW:r,COL:a,TYPE:S}),UserAction.ScrollCellIntoView(e,t,i,r,a)}}{var a=e.ZSEvents,o=a.topic,s=a.Groups,l=a.Names,R=e.ZSClass,g=e.sPlusPlus,S=(g.SML.Client,g.data.Defaults),c=S.MAX_COL,v=S.MAX_ROW;e.ZSDevTools.Logger}e.UserAction.Goto=n,e.UserAction.gotoCell=r}(this);
!function(e){function n(e,n,t,a){var c=o.view.actionListManager.actionList,v=(Object.keys(c),{RID:e,VERSION:n,versionNo:n,versionName:t}),u=new r;u.addEventListeners("onError",function(e){i.log("Rename version error :",e)}),u.addEventListeners("onComplete",function(){a()}),u.open(s.RENAME_VERSION),u.send(v)}var o=e.sPlusPlus,t=o.SML.Client,s=e.ZSConstants.URI,i=e.ZSDevTools.Logger,r=t.Utility.WorkerRequest;UserAction.renameVersion=n}(this);
!function(e){function n(e,n,r){var o={RID:e,VERSION:n,versionNo:n},v=new i;v.addEventListeners("onError",function(e){r&&r.remove(),t.log("Rename version error :",e)}),v.open(s.REVERT_VERSION),v.send(o)}var r=e.sPlusPlus,o=r.SML.Client,s=e.ZSConstants.URI,t=e.ZSDevTools.Logger,i=o.Utility.WorkerRequest;UserAction.revertVersion=n}(this);
!function(e){function n(e,n,t,s,o,i,a,r,E,C){var I={rID:e,version:n,sheetList:t,disId:s,range:o,filter:i},S=new N;S.addEventListeners("onComplete",function(e){O.publish(p.Listener,w.UserAction.REVIEW_COMMENTS.LOAD,{response:e.comments?e.comments:e,callback:a,newComment:r,action:E,COUNTOBJ:e.count,REOPENID:C}),!!e.count&&O.publish(p.UI,w.SidePanel.Comments.UPDATE_COUNT,{COUNTOBJ:e.count})}),S.open(g.FETCH_REVIEW_COMMENTS),S.send(I)}function t(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(o),E=i.getActiveCell(),C={rID:e,version:n,sheetList:a,rangeList:r,activeCell:E,action:u.DISCUSSION_ADD,content:s},I=new N;I.addEventListeners("onComplete",function(){}),I.open(g.ADD_REVIEW_COMMENT),I.send(C)}function s(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(o),E={rID:e,version:n,sheetList:a,rangeList:r,action:u.DISCUSSION_DELETE,disId:s},C=new N;C.addEventListeners("onComplete",function(){}),C.open(g.DELETE_REVIEW_COMMENT),C.send(E)}function o(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(o),E={rID:e,version:n,sheetList:a,rangeList:r,action:u.DISCUSSION_RESOLVE,disId:s},C=new N;C.open(g.RESOLVE_REVIEW_COMMENT),C.send(E)}function i(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(o),E={rID:e,version:n,sheetList:a,rangeList:r,action:u.DISCUSSION_REOPEN,disId:s},C=new N;C.addEventListeners("onComplete",function(){}),C.open(g.REOPEN_REVIEW_COMMENT),C.send(E)}function a(e,n,t,s,o,i){var a=new ZSClass.ParamGenerator(t,e,n),r=a.getSheets(),E=a.getCustomRanges(i),C={rID:e,version:n,sheetList:r,rangeList:E,action:u.DISCUSSION_UPDATE_RANGE_CONTENT,disId:s,content:o},I=new N;I.addEventListeners("onComplete",function(){}),I.open(g.UPDATE_REVIEW_COMMENT),I.send(C)}function r(e,n,t,s,o,i){var a=new ZSClass.ParamGenerator(t,e,n),r=a.getSheets(),E=a.getCustomRanges(i),C={rID:e,version:n,sheetList:r,rangeList:E,action:u.DISCUSSION_ADD_REPLY,disId:s,content:o},I=new N;I.addEventListeners("onComplete",function(){}),I.open(g.ADD_REVIEW_COMMENT_REPLY),I.send(C)}function E(e,n,t,s,o,i){var a=new ZSClass.ParamGenerator(t,e,n),r=a.getSheets(),E=a.getCustomRanges(i),C={rID:e,version:n,sheetList:r,rangeList:E,disId:s,cid:o,action:u.DISCUSSION_DELETE_REPLY},I=new N;I.addEventListeners("onComplete",function(){}),I.open(g.DELETE_REVIEW_COMMENT_REPLY),I.send(C)}function C(e,n,t,s,o,i,a){var r=new ZSClass.ParamGenerator(t,e,n),E=r.getSheets(),C=r.getCustomRanges(a),I={rID:e,version:n,sheetList:E,rangeList:C,disId:s,cid:o,content:i,action:u.DISCUSSION_UPDATE_REPLY},S=new N;S.addEventListeners("onComplete",function(){}),S.open(g.UPDATE_REVIEW_COMMENT_REPLY),S.send(I)}function I(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(o),E={rID:e,version:n,sheetList:a,rangeList:r,action:u.DISCUSSION_LIKE,disId:s},C=new N;C.addEventListeners("onComplete",function(){}),C.open(g.LIKE_REVIEW_COMMENT),C.send(E)}function S(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(o),E={rID:e,version:n,sheetList:a,rangeList:r,action:u.DISCUSSION_UNLIKE,disId:s},C=new N;C.addEventListeners("onComplete",function(){}),C.open(g.UNLIKE_REVIEW_COMMENT),C.send(E)}function d(e,n,t,s,o,i){var a=new ZSClass.ParamGenerator(t,e,n),r=a.getSheets(),E=a.getCustomRanges(i),C={rID:e,version:n,sheetList:r,rangeList:E,action:u.DISCUSSION_LIKE_REPLY,cid:o,disId:s},I=new N;I.addEventListeners("onComplete",function(){}),I.open(g.LIKE_REVIEW_COMMENT_REPLY),I.send(C)}function m(e,n,t,s,o,i){var a=new ZSClass.ParamGenerator(t,e,n),r=a.getSheets(),E=a.getCustomRanges(i),C={rID:e,version:n,sheetList:r,rangeList:E,action:u.DISCUSSION_UNLIKE_REPLY,disId:s,cid:o},I=new N;I.addEventListeners("onComplete",function(){}),I.open(g.UNLIKE_REVIEW_COMMENT_REPLY),I.send(C)}function L(e,n,t,s,o){var i=new ZSClass.ParamGenerator(t,e,n),a=i.getSheets(),r=i.getCustomRanges(s),E={rID:e,version:n,sheetList:a,rangeList:r,action:u.DISCUSSION_DELETE_ALL,state:o},C=new N;C.addEventListeners("onComplete",function(){}),C.open(g.DELETE_ALL_REVIEW_COMMENT),C.send(E)}function c(e,n,t,s){var o=new ZSClass.ParamGenerator(t,e,n),i=o.getSheets(),a=o.getCustomRanges(s),r={rID:e,version:n,sheetList:i,rangeList:a,action:u.DISCUSSION_UPDATE_DOC_CLOSEDTIME},E=new N;E.addEventListeners("onComplete",function(){}),E.open(g.REVIEW_COMMENT_UPDATE_DOC_CLOSEDTIME),E.send(r)}function _(e,n,t,s,o,i,a){var r=new ZSClass.ParamGenerator(t,e,n),E=r.getSheets(),C=r.getCustomRanges(s),I={rID:e,version:n,sheetList:E,rangeList:C,subaction:a,notifyType:i,action:u.NOTIFICATION_SETTINGS},S=new N;S.addEventListeners("onComplete",function(e){O.publish(p.Listener,w.UserAction.REVIEW_COMMENTS.UPDATE_NOTIFICATION_STATE,{state:e,callback:o})}),S.open(g.REVIEW_COMMENT_NOTIFICATION_SETTINGS),S.send(I)}var R=e.sPlusPlus,v=e.UserAction,l=e.ZSConstants,u=l.ActionConstants,g=l.URI,D=R.SML.Client,N=D.Utility.WorkerRequest,T=e.ZSEvents,O=T.topic,p=T.Groups,w=T.Names;v.fetchReviewComments=n,v.addReviewComment=t,v.deleteReviewComment=s,v.updateReviewComment=a,v.addReviewCommentReply=r,v.deleteReviewCommentReply=E,v.updateReviewCommentReply=C,v.resolveReviewComment=o,v.reopenReviewComment=i,v.likeReviewComment=I,v.unlikeReviewComment=S,v.likeReviewCommentReply=d,v.unlikeReviewCommentReply=m,v.deleteAllReviewComment=L,v.updateDocClosedTime=c,v.emailNotificationType=_}(this);
!function(t){function e(t,e,s,n){var a=new ZSClass.ParamGenerator(e,t,s,!0),i=a.getSheets(),r={sheetList:i,VERSION:s,RID:t,msg:n},C=new o;C.open(A.COLLAB_CHAT),C.send(r)}function s(t,e,s,n,a,i){var u=new ZSClass.ParamGenerator(e,t,s,!0),h=u.getSheets(),l={sheetList:h,VERSION:s,RID:t,chatCount:n,latestChatTime:a,lastChatCount:i},L=new o;L.addEventListeners("onComplete",function(t){r.publish(C.Listener,c.UserAction.COLLAB_CHAT.GETCHAT,{response:t})}),L.open(A.COLLAB_GETCHAT),L.send(l)}{var n=t.sPlusPlus,a=(t.ZSClass.ActionObject,n.SML.Client),o=a.Utility.WorkerRequest,i=t.ZSEvents,r=i.topic,C=i.Groups,c=i.Names,u=t.ZSConstants,A=u.URI;u.I18N,u.ActionConstants}t.UserAction.chat=e,t.UserAction.getChat=s}(this);
!function(e){function t(e,t,n,r,a,o,i,s,c,v){var d=E.data.getWorkBook(e,n),l=d.getSheetObj(t),C=l.Prop.Name,S=[],R="CHART_MOVE",h={id:r,sc:s,sr:i,srd:c,scd:v,left:a,top:o,isReadChartOptions:!1};S.push(h),P.Server.Action.sendRequest(e,t,n,C,R,S)}function n(e,t,n,r,a,o,i,s,c,v,d,l){var C=E.data.getWorkBook(e,n),S=C.getSheetObj(t),R=S.Prop.Name,h=[],A="CHART_RESIZE",g={id:r,sc:s,sr:i,srd:c,scd:v,left:a,top:o,ht:Math.abs(l),wd:Math.abs(d),isReadChartOptions:!1};h.push(g),P.Server.Action.sendRequest(e,t,n,R,A,h)}function r(e,t,n,r,a,o){var i=E.data.getWorkBook(e,n),s=E.view.getActiveGridID(),c=E.view.getSheetID(s),v=i.getSheetObj(c),d="CHART_QUICK_EDIT",l=[];for(var C in r){var S={};S.id=r[C],S.value=o,S.subAction=a,l.push(S)}P.Server.Action.sendRequest(e,t,n,v.Prop.Name,d,l)}function a(e,t,n,r){var a=E.data.getWorkBook(e,n),o=a.getSheetObj(t),i=o.Prop.Name,s="CHART_DELETE",c=[{id:r}];P.Server.Action.sendRequest(e,t,n,i,s,c)}function o(e,t,n,r,a,o,i){var s=O[a],c=T[a],v=new ZSClass.ParamGenerator([t],e,n,!1,!1),d=v.getSheets(),l=v.getActiveCell(),C=v.getRanges(),S={action:s,sheetList:d,rangeList:C,activeCell:l,sheetName:r,chartJson:o,RID:e,VERSION:n};i&&(S.url=i);var R=new D(s,S),h=new f;h.addEventListeners("onComplete",function(e){R.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(R)}),h.addEventListeners("onError",function(e){p.topic.publish(I.Listener,L.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(c),h.send(S)}function i(e){var t=E.view.getActiveGridID(),n=E.view.getResourceID(t),r=E.view.getVersionID(t),a=E.data.getWorkBook(n,r),o=E.view.getSheetID(t),i=a.getSheetObj(o),s=i.Prop.Name,c=e.action,v=e.parameters;P.Server.Action.sendRequest(n,o,r,s,c,v)}function s(e,t,n,r,a,o,i){var s=O[r],c=T[r],v=new ZSClass.ParamGenerator([t],e,n,!0),d=v.getSheets(),l=v.getRanges(),C=v.getActiveCell(),S=a?ZSClass.Pivot.ID:null,R={action:s,sheetList:d,rangeList:l,activeCell:C,pivotId:S,RID:e,VERSION:n,isNotQueuedAction:i||!1},h=(new D(s,R),new f);h.addEventListeners("onComplete",function(e){var t=e.response_array;o(t.co)}),h.open(c),h.send(R)}function c(e,t,n,r,a,o,i){var s=O[a],c=T[a],v=new ZSClass.ParamGenerator([t],e,n,!0),d=v.getSheets(),l=v.getActiveCell(),C={action:s,sheetList:d,rangeList:r,activeCell:l,RID:e,VERSION:n,isNotQueuedAction:!1},S=(new D(s,C),new f);S.addEventListeners("onComplete",function(e){var t=e.response_array;o(t.co,i)}),S.open(c),S.send(C)}function v(e,t,n,r,a){var o=r.action,i=O[o],s=T[o],c=new ZSClass.ParamGenerator([t],e,n,!1,!1),v=c.getSheets(),d=c.getActiveCell(),l={action:i,activeCell:d,sheetList:v,RID:e,VERSION:n,actionProps:r.parameters,URL:r.url},C=(new D(i,l),new f);C.addEventListeners("onComplete",function(e){var t=e.chartOptions||e.response_array;a&&a(t.co)}),C.open(s),C.send(l)}function d(e,t,n,r,a,o,i){var s="FETCH_DECLARATIVE_TABLE",c=O[s],v=T.FETCH_DECLARATIVE_TABLE,d=new ZSClass.ParamGenerator([t],e,n,!1,!1),l=d.getSheets(),C=d.getActiveCell(),S={actionCnst:c,sheetList:l,RID:e,VERSION:n,actionProps:r.parameters,URL:"previewaction",activeCell:C},R=(new D(c,S),new f);R.addEventListeners("onComplete",function(e){var t=e;i&&i(r.parameters.isCol,a,o,t.decTable)}),R.open(v),R.send(S)}function l(e,t,n,r,a,o){var i="DETECT_TABLE",s=O[i],c=T[i],v=new ZSClass.ParamGenerator([t],e,n,!1,!1),d=v.getSheets(),l=v.getActiveCell(),C=[],S=[];S.push(r),C.push(S);var R={actionCnst:s,sheetList:d,rangeList:C,RID:e,VERSION:n,URL:"useraction",activeCell:l},h=(new D(s,R),new f);h.addEventListeners("onComplete",function(e){a&&a(e)}),h.addEventListeners("onError",function(e){o&&o(e)}),h.open(c),h.send(R)}function C(e,t,n,r){N.log("[CHART] >>>> moveChart from one sheet to another sheet ",r);var a=r.ID,o=(r.dSN,E.data.getWorkBook(e,n)),i=o.getSheetObj(r.sSN);r.sSN=i.Prop.Name;var s=(a[0],"CHART_MOVE_TO_NEW_SHEET"),c=O[s],v=T[s],d=new ZSClass.ParamGenerator([t],e,n,!1,!1),l=d.getSheets(),C=d.getActiveCell(),S={action:c,sheetList:l,activeCell:C,RID:e,VERSION:n,actionProps:r,URL:"chartaction"},R=new D(c,S),h=new f;h.addEventListeners("onComplete",function(e){R.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(R)}),h.open(v),h.send(S)}function S(e,t,n,r){var a=r.action,o=O[a],i=T[a],s=new ZSClass.ParamGenerator([t],e,n,!1,!1),c=s.getSheets(),v=s.getActiveCell(),d={action:o,sheetList:c,RID:e,activeCell:v,VERSION:n,actionProps:r.parameters,URL:r.url},l=new D(o,d),C=new f;C.addEventListeners("onComplete",function(e){l.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(l)}),C.open(i),C.send(d)}function R(e,t,n,r,a){var o="ADD_CHART_TO_IMAGE_LIBRARY",i=O[o],s=T[o],c=new ZSClass.ParamGenerator([t],e,n,!0),v=c.getSheets(),d=c.getRanges(),l=c.getActiveCell(),C={action:i,sheetList:v,rangeList:d,activeCell:l,RID:e,VERSION:n,chartID:r},S=(new D(i,C),new f);S.addEventListeners("onComplete",function(e){var t=e.status;a&&a(t)}),S.open(s),S.send(C)}function h(e,t,n,r,a,o){var i=(E.data.getWorkBook(e,n),E.view.getActiveGridID()),s=E.view.getSheetID(i),c="CHART_QUICK_STYLE",v={};v.id=r,v.currentSheet=s,v.subAction=a,v.chartStyles=JSON.stringify(o);var d={};d.parameters=v,d.url="chartaction",d.action=c,P.Server.Action.updateChartOnGrid(e,t,n,d)}function A(e,t,n,r){N.log("[Chart]>>>> Updating Chart Server Clip ");var a=new ZSClass.ParamGenerator([t],e,n,!1,!1),o=a.getSheets(),i=a.getActiveCell(),s=r.sID,c="CHART_COPY_STYLE",v=O[c],d=T[c],l={action:v,activeCell:i,sheetList:o,RID:e,VERSION:n,sID:s,URL:"useraction"},C=(new D(v,l),new f);C.open(d),C.send(l)}function g(e,t,n,r){N.log("[Chart]>>>> Pasting Chart Clip >>>>>");var a=r.sID,o=r.cID,i="CHART_PASTE_STYLE",s=O[i],c=T[i],v=new ZSClass.ParamGenerator([t],e,n,!1,!1),d=v.getSheets(),l=v.getActiveCell(),C={action:s,sheetList:d,activeCell:l,RID:e,VERSION:n,sID:a,cID:o,URL:r.URL},S=(new D(s,C),new f);S.open(c),S.send(C)}function u(t,n,r){N.log("[CHART] >>>> Refreshing Affected Chart Meta",n);var a=E.view.getActiveGridID(),o=E.view.getResourceID(a),i=E.view.getVersionID(a),s="CHART_REFRESH",c=O[s],v=T[s],d=new ZSClass.ParamGenerator([t],o,i,!1,!1),l=d.getSheets(),C=d.getActiveCell(),S={actionCnst:c,sheetList:l,RID:o,VERSION:i,URL:"useraction",activeCell:C,chartList:e.JSON.stringify(n)},R=(new D(c,S),new f);R.addEventListeners("onComplete",function(e){r&&r({rID:o,version:i,sheetID:t,isActionOwner:!0,CHARTS:e[O.CHART].chartdetails})}),R.open(v),R.send(S)}var p=e.ZSEvents,I=p.Groups,E=e.sPlusPlus,L=p.Names,w=E.SML.Client,f=w.Utility.WorkerRequest,D=e.ZSClass.ActionObject,m=e.ZSConstants,T=m.URI,O=(e.encodeURIComponent,m.ActionConstants),P=(m.CommandConstants,e.ZSChart),N=e.ZSDevTools.Logger;P.Server.Action.sendRequest=o,P.Server.Action.RefreshChart=u,P.Server.Action.pasteDesign=g,P.Server.Action.Reposition=t,P.Server.Action.Resize=n,P.Server.Action.RemoveChart=a,P.Server.Action.fetchChart=s,P.Server.Action.updatePreview=v,P.Server.Action.updateChartOnGrid=S,P.Server.Action.doQuickEditAction=r,P.Server.Action.doQuickStyleAction=h,P.Server.Action.switchChart=C,P.Server.Action.copyClipToServer=A,P.Server.Action.doPublicChart=i,P.Server.Action.fetchDecTable=d,P.Server.doDetectTable=l,P.Server.Action.insertChartForRange=c,P.Server.Action.addChartToImageLibrary=R}(this);
!function(e){function t(){Q.Manager.DialogManager.call(this),this.unProcessed={},this.filterColumns=null,this.panel={open:!1,close:!0},this.rangeEditor={isEditing:!1,value:{prevValue:"",currValue:""}},this.SPMeta=new Q.Model.SPMeta,this.SPMeta.init(),this.RECOMMENDATION=!1,this.TABEL_DEFINATION=!1,this.UPDATE_PANEL=!1}function a(){var e=Q.Manager.SidePanelManager;e.setIsSidePanel(!0),e.setType("edit"),e.attachEventsForSP(),i()}function i(){var e=Q.Wrapper.DOMUtils,t=e.getElementByClassName("spChrtTypes"),a=e.getElementByClassName("sPanel");e.addEventByNode(t,"click",l),e.addEventByNode(a,"click",o)}function n(){try{var e=Q.Manager.SidePanelManager,t=e.getChartType(e.getActiveChartID()[0]),a={COL3D:"COL",BAR3D:"BAR",PIE3D:"PIE",DOUGHNUT3D:"DOUGHNUT",STACKEDCOL3D:"STACKEDCOL",STACKEDCOL3D_PERCENT:"STACKEDCOL_PERCENT",STACKEDBAR3D:"STACKEDBAR",STACKEDBAR3D_PERCENT:"STACKEDBAR_PERCENT"};return a[t]||t}catch(e){}}function r(e){var t=["theme1","theme2","theme3","theme4","theme5","theme6"];t.forEach(function(t){e.classList.remove(t)});var a={"SHEET-OFFICE-COLORFUL-THEME1":"theme1","SHEET-OFFICE-COLORFUL-THEME2":"theme2","SHEET-OFFICE-COLORFUL-THEME3":"theme3","SHEET-OFFICE-COLORFUL-THEME4":"theme4","SHEET-OFFICE-COLORFUL-THEME5":"theme5","SHEET-OFFICE-COLORFUL-THEME6":"theme6"},i=Q.Manager.SidePanelManager,n=i.getActiveChartThemeName(i.getActiveChartID()[0]);e.classList.add(a[n]||t[0])}function l(e){var t=Q.Wrapper.DOMUtils,a=(Q.Manager.SidePanelManager,new Q.Manager.ZSCColorManager),i=t.getElementByClassName("spChrtTypesList");if("none"==i.style.display){t.show(i);var l=t.getElementById("chartspContentDiv").getBoundingClientRect(),o=i.getBoundingClientRect(),g=l.height-o.top+l.top-10+"px";t.addStyle(i,{height:g});var s=n(),s=n();if(!s)return;var S=i.querySelector("#"+s);if(null!=S){{var c=S.parentNode.getBoundingClientRect(),I=i.getBoundingClientRect();c.y-I.y-20}S.checked=!0}r(i)}else{var I=i.getBoundingClientRect(),c=t.getElementById("chartRecommendTitle").getBoundingClientRect();setTimeout(function(){t.hide(i)},10)}a.hideColorScheme(),e.stopPropagation()}function o(){var e=Q.Wrapper.DOMUtils;e.hideByClassName("spChrtTypesList")}function g(e){var t=Q.Manager.SidePanelManager,a=new Q.Utility.CommanAgent;a.resetTitleCombo(),t.updateSidePanel(e||t.getActiveChartID()[0]),t.UPDATE_PANEL=!1,t.hideUnwantedProperty(e)}function s(e){var t=Q.Manager.SidePanelManager;t.TABEL_DEFINATION=!0;var a=it.view.getActiveGridID(),i=it.view.getResourceID(a),n=it.view.getVersionID(a),r=it.view.getSheetID(a),l=v(e.getRange(),e.getSeriesIn(),e.getCombinedWay());if(null!=l&&0!=l.length){var o={};o.parameters={},o.parameters.currentSheet=r,o.parameters.dataRange=e.getRange(),o.parameters.isCol="COLS"===e.getSeriesIn();var g=Q.DecTable.initializeRangeMap(l);Q.Server.Action.fetchDecTable(i,r,n,o,l,g,Q.DecTable.processDecTableResponse)}}function S(e){if(e){var t=Q.Manager.SidePanelManager;t.removeActiveChartID(),t.setActiveChartId(e),t.setIsSidePanel(!0),t.setType("edit")}}function c(e){var t=new Q.Utility.ChartAgent,a=t.getChartMeta(e),i=Q.Manager.SidePanelManager;i.constructDialogMetaObject(a,e);var n=i.getMetaObject(e);return n.setInstance(a.getInstance()),n}function I(){var e=new Q.Utility.AgentDom;e.hideRecommendationDOM()}function T(e){var t=Q.Manager.SidePanelManager;if(I(),t.isPanelOpen()&&!it.view.Toolbar.showChartPopup){var a=t.getDialogUtil(),i=a.getMetaObject(e);i&&(Q.Action.doRecommendation(i,!0),t.RECOMMENDATION=!1)}}function C(e){var t=Q.Manager.SidePanelManager;if(t.isPanelOpen()){var a=t.getDialogUtil(),i=a.getMetaObject(e);i&&(Q.Aggregation.resetAggregationDom(i.getSeriesIn()),s(i))}}function d(e){var t=Q.Manager.SidePanelManager;t.isPanelOpen()&&D(e)}function E(e){if(o(),e){var t=Q.Manager.SidePanelManager;if(t.isPanelOpen()){S(e);{c(e)}t.RECOMMENDATION||t.checkForRecommendationsPopulated(t.getUnProcessed())}}}function D(e){g(e)}function A(e,t){var a=Q.Manager.SidePanelManager;if(a.isPanelOpen()&&e){var i=a.getDialogUtil().getDialogMeta(e),n=new Q.Utility.AgentDom;n.hidePropertyBasedOnMeta(i,!this.sidePanelState,t)}}function v(e,t,a){var i="",n=";",r=[];return e&&""!==e?(n?r=e.split(n):r.push(e),i="COLS"==t&&"VERTICAL"==a||"ROWS"==t&&"HORIZONTAL"==a?r[0]:e):[]}function u(){var e=Q.Manager.SidePanelManager;!e.rangeEditor.isEditing&&at.publish(tt.UI,et.Names.SidePanel.CHARTS.CLOSE)}function P(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil();a.updateSeriesCustomization(e);var i=new Q.Controller.ZSCController;i.doChartCustomization("series",e)}function M(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=e.cID,n=a.getDialogMeta(i),r=new Q.Utility.ChartAgent,l={cbc:e.color,pbc:e.color};n.updateChartColor(e.color);var o=(new Q.Model.ChartModel).getRGBA(e.color);nt.zcolorselectbox("#chartcustomcolorDropDown1","setValue",o);var g=it.view.getActiveGridID(),s=it.view.getVersionID(g),S=it.view.getResourceID(g),c=it.view.getSheetID(g),I=new Q.Controller.ZSCController;I.updateCBC(S,c,s,r.getChartMeta(i),l)}function R(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=e.cID,n=a.getDialogMeta(i),r=new Q.Utility.ChartAgent,l={style:{fontFamily:e.fontFamily}};nt.zcombo("#chartfontfamilys","setValue",e.fontFamily),n.updateFontFamily(l);var o=it.view.getActiveGridID(),g=it.view.getVersionID(o),s=it.view.getResourceID(o),S=it.view.getSheetID(o),c=new Q.Controller.ZSCController;c.updateFontFamily(s,S,g,r.getChartMeta(i),l)}function O(e){var t=e.fontSize;nt.zcombo("#chartFont","setValue",t);var a=Q.Manager.SidePanelManager,i=a.getDialogUtil(),n=new Q.Utility.ChartAgent,r=e.cID,l=Q.Utility.getTitleRelative(e.props.subAction),o=i.getSubAction(l,[r]),g=i.getTitleStyle(l,[r]),s=it.view.getActiveGridID(),S=it.view.getVersionID(s),c=it.view.getResourceID(s),I=it.view.getSheetID(s),T={};g.fontSize=e.fontSize,118==o&&(T.index=i.getActiveTitleIndex([r])),T.style=g;var C=new Q.Controller.ZSCController;C.updateTitleStyle(c,I,S,n.getChartMeta(r),T,o)}function U(e){var t=e.color,a=Q.Manager.SidePanelManager,i=a.getDialogUtil(),n=new Q.Utility.ChartAgent,r=e.cID,l=Q.Utility.getTitleRelative(e.props.subAction),o=(i.getSubAction(l,[r]),i.getTitleStyle(l,[r])),g=(new Q.Model.ChartModel).getRGBA(o.color),s=g&&n.isUniqueValue(g.replace(/ /g,""),t.replace(/ /g,""));s&&nt.zcolorselectbox("#chartTitleFontColor","setValue",t)}function h(){var e=Q.Wrapper.DOMUtils,t=e.getElementById("chartTitlebold");t.click()}function p(){var e=Q.Wrapper.DOMUtils,t=e.getElementById("chartTitleitalic");t.click()}function y(e){var t=Q.Wrapper.DOMUtils,a=Q.Manager.SidePanelManager,i=(a.getDialogUtil(),t.getElementById("titleTextBox"));i.value=e.txt;var n=new Event("input");i.dispatchEvent(n)}function w(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=(new Q.Utility.ChartAgent,e.cID),n=it.view.getActiveGridID(),r=(it.view.getVersionID(n),it.view.getResourceID(n),it.view.getSheetID(n),e.fontSize);a&&a.updateXAxiesLabelStyle(i,{key:"fontSize",value:r});var l=new Q.Controller.ZSCController;l.doChartCustomization("haxis",{ID:i,style:{key:"fontSize",value:r}})}function L(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=(new Q.Utility.ChartAgent,e.cID),n=it.view.getActiveGridID(),r=(it.view.getVersionID(n),it.view.getResourceID(n),it.view.getSheetID(n),e.bold?"normal":"bold");a&&a.updateXAxiesLabelStyle(i,{key:"fontWeight",value:r});var l=new Q.Controller.ZSCController;l.doChartCustomization("haxis",{ID:i,style:{key:"fontWeight",value:r}})}function m(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=new Q.Utility.ChartAgent,n=e.cID,r=it.view.getActiveGridID(),l=(it.view.getVersionID(r),it.view.getResourceID(r),it.view.getSheetID(r),e.color),o=a.getDialogMeta(n),g=o.getXAxis(),s=g.labels||{},S=s.style||{},c=(new Q.Model.ChartModel).getRGBA(S.color),I=c&&i.isUniqueValue(c.replace(/ /g,""),l.replace(/ /g,""));if(I){a&&a.updateXAxiesLabelStyle(n,{key:"color",value:l});var T=new Q.Controller.ZSCController;T.doChartCustomization("haxis",{ID:n,style:{key:"color",value:l}})}}function f(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=(new Q.Utility.ChartAgent,e.cID),n=it.view.getActiveGridID(),r=(it.view.getVersionID(n),it.view.getResourceID(n),it.view.getSheetID(n),e.italic?"normal":"italic");a&&a.updateXAxiesLabelStyle(i,{key:"fontStyle",value:r});var l=new Q.Controller.ZSCController;l.doChartCustomization("haxis",{ID:i,style:{key:"fontStyle",value:r}})}function N(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=(new Q.Utility.ChartAgent,e.cID),n=it.view.getActiveGridID(),r=(it.view.getVersionID(n),it.view.getResourceID(n),it.view.getSheetID(n),e.fontSize);a&&a.updateYAxiesLabelStyle(i,{key:"fontSize",value:r},e.props.index);var l=new Q.Controller.ZSCController;l.doChartCustomization("vaxis",{ID:i,style:{key:"fontSize",value:r},yIndex:e.props.index})}function H(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=(new Q.Utility.ChartAgent,e.cID),n=it.view.getActiveGridID(),r=(it.view.getVersionID(n),it.view.getResourceID(n),it.view.getSheetID(n),e.bold?"normal":"bold");a&&a.updateYAxiesLabelStyle(i,{key:"fontWeight",value:r},e.props.index);var l=new Q.Controller.ZSCController;l.doChartCustomization("vaxis",{ID:i,style:{key:"fontWeight",value:r},yIndex:e.props.index})}function _(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=new Q.Utility.ChartAgent,n=e.cID,r=it.view.getActiveGridID(),l=(it.view.getVersionID(r),it.view.getResourceID(r),it.view.getSheetID(r),e.color),o=a.getDialogMeta(n),g=o.getYAxis()[e.props.index],s=g.labels||{},S=s.style||{},c=(new Q.Model.ChartModel).getRGBA(S.color),I=c&&i.isUniqueValue(c.replace(/ /g,""),l.replace(/ /g,""));if(I){a&&a.updateYAxiesLabelStyle(n,{key:"color",value:l},e.props.index);var T=new Q.Controller.ZSCController;T.doChartCustomization("vaxis",{ID:n,style:{key:"color",value:l},yIndex:e.props.index})}}function b(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=(new Q.Utility.ChartAgent,e.cID),n=it.view.getActiveGridID(),r=(it.view.getVersionID(n),it.view.getResourceID(n),it.view.getSheetID(n),e.italic?"normal":"italic");a&&a.updateYAxiesLabelStyle(i,{key:"fontStyle",value:r},e.props.index);var l=new Q.Controller.ZSCController;l.doChartCustomization("vaxis",{ID:i,style:{key:"fontStyle",value:r},yIndex:e.props.index})}function B(e){var t=Q.Wrapper.DOMUtils,a=t.getElementById("min");a.value=e.min;var i=new Event("change");a.dispatchEvent(i)}function F(e){var t=Q.Wrapper.DOMUtils,a=t.getElementById("max");a.value=e.max;var i=new Event("change");a.dispatchEvent(i)}function V(e){var t=Q.Wrapper.DOMUtils,a=t.getElementById("interval");a.value=e.interval;var i=new Event("change");a.dispatchEvent(i)}function G(e){nt.zcombo("#legendFont","setValue",e.fontSize);{var t=e.fontSize,a=it.view.getActiveGridID(),i=it.view.getVersionID(a),n=it.view.getResourceID(a),r=it.view.getSheetID(a),l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=Q.Manager.SidePanelManager,s=g.getDialogUtil(),S=e.cID,c=(s.getDialogMeta(S),l.getChartMeta(S)),I={};c.getOptions()}I=c.getUpdateLegendStyle({fontSize:t}),o.updateLegendStyle(n,r,i,c,I)}function x(){var e=Q.Wrapper.DOMUtils,t=e.getElementById("chartBold");t.click()}function X(e){var t=e.color;nt.zcolorselectbox("#chartFontColor2","setValue",t);var a,i=it.view.getActiveGridID(),n=it.view.getVersionID(i),r=it.view.getResourceID(i),l=it.view.getSheetID(i),o=e.cID,g=new Q.Utility.ChartAgent,s=new Q.Controller.ZSCController,S=g.getChartMeta(o),c={},I=S.getLegend();a=(new Q.Model.ChartModel).getRGBA(I.itemStyle.color),c=S.getUpdateLegendStyle({color:t});var T=g.isUniqueValue(a,t);T&&s.updateLegendStyle(r,l,n,S,c)}function Y(){var e=Q.Wrapper.DOMUtils,t=e.getElementById("chartitalic");t.click()}function k(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.ID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r);o.changeChartType(i,n,a,[g],e.value)}function Z(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.ID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r);o.updatePlotlineStyle(i,n,a,g,e)}function z(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.ID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r);o.updatePlotlineColor(i,n,a,g,e)}function W(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.ID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r);o.updatePlotlineDashStyle(i,n,a,g,e)}function K(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.cID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r),s=g.getDataLabelStyle()||{};s.fontSize=e.fontSize,g.setDataLabelStyle(s),o.updateDataLabelStyle(i,n,a,g)}function j(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.cID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r),s=g.getDataLabelStyle()||{};s.fontWeight=e.bold?"normal":"bold",g.setDataLabelStyle(s),o.updateDataLabelStyle(i,n,a,g)}function q(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.cID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r),s=g.getDataLabelStyle()||{};s.color=e.color,g.setDataLabelStyle(s),o.updateDataLabelStyle(i,n,a,g)}function J(e){var t=it.view.getActiveGridID(),a=it.view.getVersionID(t),i=it.view.getResourceID(t),n=it.view.getSheetID(t),r=e.cID,l=new Q.Utility.ChartAgent,o=new Q.Controller.ZSCController,g=l.getChartMeta(r),s=g.getDataLabelStyle()||{};s.fontStyle=e.italic?"normal":"italic",g.setDataLabelStyle(s),o.updateDataLabelStyle(i,n,a,g)}var Q=e.ZSChart,$=e.ZSClass,et=e.ZSEvents,tt=et.Groups,at=(et.Names,et.topic),it=(Q.Model,e.sPlusPlus),nt=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component),rt=(Q.Constants.ChartRangePickerType,$.Editors.Utility,e.JSUtil,Q.Constants.QuickStyleActions),lt=Q.Constants.QuickEditActions;t.prototype=new Q.Manager.DialogManager,t.prototype.setUnProcessed=function(e){this.unProcessedTask=e},t.prototype.getUnProcessed=function(){return this.unProcessedTask||{}},t.prototype.setPanelStatus=function(e){return this.panel=e,!0},t.prototype.enableRangeEditor=function(){this.rangeEditor.isEditing=!0},t.prototype.disableRangeEditor=function(){this.rangeEditor.isEditing=!1},t.prototype.isRangeEditing=function(){return this.rangeEditor.isEditing},t.prototype.setRangeValue=function(e,t){this.rangeEditor.value={prevValue:e,currValue:t}},t.prototype.isPanelOpen=function(){return this.panel.open},t.prototype.closeSidePanel=function(){var e=new Q.Utility.CommanAgent;e.setDialogStatus(!1),e.removeDailogUtil(),this.clearSidePanelCached(),e.resetSidePanel()},t.prototype.setCurrentActionOwner=function(){this.currentActionOwner=!0},t.prototype.isCurrentActionOwner=function(){return this.currentActionOwner},t.prototype.resetCurrentActionOwner=function(){this.currentActionOwner=!1},t.prototype.clearDecTableAndAggregationUtility=function(){Q.DecTable.clearRangeDecTableMap()},t.prototype.clearCache=function(){this.closeSidePanel(),this.clearDecTableAndAggregationUtility()},t.prototype.getActiveMeta=function(){var e=this.getActiveChartID(),t=null;return e?(e.length>0&&(t=this.getMetaObject(e[0])),t):void 0},t.prototype.initPanelManager=function(){this.setIsSidePanel(!0)},t.prototype.init=function(e){{var t=it.view.getActiveGridID(),a=it.view.getResourceID(t),i=it.view.getVersionID(t),n=it.view.getSheetID(t),r=it.view.getSheetState(t,n),l=r.getActiveRange();l.startRow,l.startCol,l.endRow,l.endCol}Q.Server.Action.fetchChart(a,n,i,"CHART_DETAILS",e,this.SPMeta.processResponse.bind(this.SPMeta)),this.RECOMMENDATION=!0},t.prototype.setFilterColumns=function(e){this.filterColumns=e},t.prototype.getFilterColumns=function(){return this.filterColumns},t.prototype.resetFocus=function(){return this.focusEventTwise=!1},Q.Utility.UpdateSidePanel={LEGEND:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateLegendRelatedDom(i),n.hidePropertyBasedOnMeta(i,!1)}},TITLE:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateTitleRelatedDom(i),n.hidePropertyBasedOnMeta(i,!1)}},XAXIS:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateXAxisRelatedDom(i),n.hidePropertyBasedOnMeta(i,!1)}},YAXIS:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateYAxisRelatedDom(i),n.hidePropertyBasedOnMeta(i,!1)}},FONTFAMILY:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateChartFontFamily(i),n.hidePropertyBasedOnMeta(i,!1)}},DATALABELS:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateDataLabelsDom(i),n.hidePropertyBasedOnMeta(i,!1)}},TOOLTIP:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateTooltipToggle(i),n.hidePropertyBasedOnMeta(i,!1)}},ANIMATION:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateAnimationToggle(i),n.hidePropertyBasedOnMeta(i,!1)}},AUTOEXPAND:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateAutoExpandToggle(i),n.hidePropertyBasedOnMeta(i,!1)}},MAJORMINOR:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateMajorMinor(i),n.hidePropertyBasedOnMeta(i,!1)}},BACKGROUNDCOLOR:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateBackgroundColorDom(i),n.hidePropertyBasedOnMeta(i,!1)}},GRIDLINECOLOR:function(e){var t=Q.Manager.SidePanelManager,a=t.getDialogUtil(),i=a.dialogMeta[e];if(i){var n=new Q.Utility.AgentDom;n.updateGlColorDom(i),n.hidePropertyBasedOnMeta(i,!1)}}},Q.Utility.updatePartOfPanel=function(e,t){var a=[];switch(e){case rt.LEGEND_STYLE:case lt.LEGEND:a.push("LEGEND");break;case lt.DATALABELS:a.push("DATALABELS");break;case rt.XY_LABELS:a.push("XAXIS"),a.push("YAXIS");break;case rt.STAGGER_LINES:case rt.XY_REVERSE:case rt.SLANT:case rt.XAXIS_LABEL_STYLE:a.push("XAXIS");break;case rt.XAXIS_TITLE_STYLE:case rt.YAXIS_TITLE_STYLE:case rt.TITLE_STYLE:case rt.SUB_TITLE_STYLE:a.push("TITLE");break;case rt.FONT_FAMILY:a.push("FONTFAMILY");break;case rt.BACKGROUND_COLOR:a.push("BACKGROUNDCOLOR");break;case rt.GRIDLINE_COLOR:a.push("GRIDLINECOLOR");break;case rt.YAXIS_LABEL_STYLE:case rt.YAXIS_MIN:case rt.YAXIS_MAX:case rt.YAXIS_INTERVAL:case rt.PLOTLINE_TITLE:case rt.PLOTLINE_TITLE_STYLE:case rt.PLOTLINE_LABEL_STYLE:case rt.ADD_OR_DELETE_PLOTLINE:case rt.XY_LOGARITHMIC:case rt.XY_BASEVALUE:case rt.XY_OPPOSITE:a.push("YAXIS");break;case lt.MAJOR:case lt.MINOR:a.push("MAJORMINOR");break;case lt.TOOLTIP:a.push("TOOLTIP");break;case lt.ANIMATION:a.push("ANIMATION")}var i=Q.Manager.SidePanelManager;if(i.isPanelOpen())for(var n=0;n<a.length;n++){var r=a[n];Q.Utility.UpdateSidePanel[r].call(this,t)}},Q.Manager.SidePanelManager=new t,Q.Action.doDeclarativeTableCall=s,at.register(tt.UI,et.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,r,"PARENT"),at.register(tt.UserAction,et.Names.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,u),at.register(tt.UI,et.Names.SidePanel.CHARTS.BINDEVENTS,a),at.register(tt.UI,et.Names.SidePanel.CHARTS.METACONVERSION,E,"CHART_ID"),at.register(tt.UI,et.Names.SidePanel.CHARTS.HIDEPROPERTY,A,"CHART_ID","SUBACTION"),at.register(tt.UI,et.Names.SidePanel.CHARTS.REFRESHBYMETA,D,"CHART_ID"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,P,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FILL,M,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FONT_FAMILY,R,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.TRANSPARACY,M,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_SIZE,O,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_COLOR,U,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_WEIGHT,h,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_STYLE,p,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.TEXT,y,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_SIZE,w,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_WEIGHT,L,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_COLOR,m,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_STYLE,f,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_SIZE,N,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_WEIGHT,H,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_COLOR,_,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_STYLE,b,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MIN,B,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MAX,F,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.INTERVAL,V,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_SIZE,G,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_WEIGHT,x,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_COLOR,X,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_STYLE,Y,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CALL_RECOMMENDATION,T,"CHART_ID"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CALL_TABLE_DEFINITION,C,"CHART_ID"),at.register(tt.UI,et.Names.SidePanel.CHARTS.REFRESH_SIDE_PANEL,d,"CHART_ID"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES_TYPE,k,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.COLOR,z,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,Z,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.DASHSTYLE,W,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_SIZE,K,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_WEIGHT,j,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_COLOR,q,"PROPERTIES"),at.register(tt.UI,et.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_STYLE,J,"PROPERTIES")}(this);
!function(e){function t(){}function o(){var e=n.Wrapper.DOMUtils,t=e.getElementById("chartcustomcolorDropDown"),o=new n.Utility.ChartAgent,a=o.getCustomColorForActiveChart();c.zcolorselectbox(t,"setValue",a)}function a(){var e=n.Wrapper.DOMUtils,t=e.getElementById("chartThemePallate"),o=null;return t&&(o=t.dataset),o}function l(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),o=i.view.getVersionID(e),a=i.view.getSheetID(e),l=i.data.getWorkBook(t,o),r=l.getSheetObj(a),c=r.Charts,s=n.Utility.getActiveChart(),d=c.get(s[0]),C=d.getStyleOptions();return C.colorTheme}function r(e){for(var t=n.Wrapper.DOMUtils,o=["zcolorpicker__commandbaractionsright","zcolorpicker__currentcolorpreview","zcolorpicker__slidercontainer","zcolorpicker--advanced","zcolorpicker__commandbaractionsleft","zcolorpicker__default","zselectbox__arrow","zselectbox__icon","zcolorpicker__shades","zcolorpicker__navigatable","chartColorPallete","toggleCustomCheckBox","colorCustomPallete","cPaletteHolder","cPaletteCode","ui-zadvcolorpalette-bar","ui-zspinner-down","ui-zspinner-up","ui-zadvcolorpalette-spinnerpane","ui-zspinner-content","ui-zadvcolorpalette-swatchmain","ui-zcolorpalette-colors-container","ui-zcolorpalette-morecolors-text","ui-zcolorpalette-shadecontainer","ui-button-icon-primary"],a=0;a<o.length;a++)if(e&&e.target){if("customColorToggle"==e.target.id||t.hasClass(e.target,o[a]))return;if(e.target.parentElement){if("chartColPallate"==e.target.parentElement.id||"pivotchartColPallate"==e.target.parentElement.id||"chartcustomcolorDropDown"==e.target.parentElement.id||"MI_6006_IDENTITY"==e.target.parentElement.id||"colorpaletteContainer"==e.target.parentElement.id||t.hasClass(e.target.parentElement,o[a]))return;if(e.target.parentElement.parentElement&&t.hasClass(e.target.parentElement.parentElement,o[a]))return}}t.hideById("DI_CHART_COLOR_SCHEME")}var i=e.sPlusPlus,n=e.ZSChart,c=e.UIUtil.Component,s=e.document;t.prototype.fetchAndAddTemplate=function(){var t=n.Wrapper.DOMUtils;if(!t.getElementById("DI_CHART_COLOR_SCHEME")){var o=e.UserAction.getTemplate(["chartColorSchemeTemplate"]),a=s.createElement("div");a.id="DI_CHART_COLOR_SCHEME",a.style.display="none",a.classList.add("zSChrtClrPlt"),a.appendChild(o.chartColorSchemeTemplate),t.appendChild(document.body,a);var l=new n.Controller.ZSCController;l.initColoSchemeEvents()}},t.prototype.showColorScheme=function(e){var t=new n.Utility.CommanAgent,a=n.Wrapper.DOMUtils,l=t.getDialogStatus();this.init(l);var r=e.getBoundingClientRect(),i="";if(l){var c=n.Utility.getDialog();i=parseInt(c.style.zIndex)+1}var s={left:r.left+"px",top:r.top+r.height+"px",position:"absolute",zIndex:i};!a.getElementById("DI_CHART_COLOR_SCHEME")&&this.fetchAndAddTemplate(),a.addStyle("DI_CHART_COLOR_SCHEME",s),a.toggle("DI_CHART_COLOR_SCHEME");{var d=new n.Utility.ChartAgent,C=d.getActiveChartMeta()[0];C.getOptions().colorOptions.colorTheme.name}o()},t.prototype.hideColorScheme=function(){var e=n.Wrapper.DOMUtils;e.hideById("DI_CHART_COLOR_SCHEME")},t.prototype.init=function(e){var t={};e&&(t=a()),!e&&(t=l());var o={};o.colorObject={},o.colorObject.colorTheme=t;var r=new n.Utility.AgentDom;r.resetColorDOMProperty(o,e)},t.prototype.initEvents=function(){var e=n.Wrapper.DOMUtils,t=new n.Utility.CommanAgent;s.body.addEventListener("click",function(e){"customColorToggle"!==e.target.id&&"customColorToggle"!==e.target.htmlFor&&r(e)}),e.addEvent("cMenuPaletteHolder > .cPaletteClose","click",function(){e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("sPCMenuPaletteHolder > .sPCPaletteClose","click",function(){e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("ul#chartColorPaletteHolder > li","click",function(){e.removeClass(e.findByClassName("ul#chartColorPaletteHolder > li","active"),"active"),e.removeClass(e.getElementByClassName("colorDialogCustomPallete"),"active");e.addClass(this,"active"),t.updateTheme(this.dataset),e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("ul#chartDialogCPalletteCode > li","click",function(){e.removeClass(e.findByClassName("ul#chartDialogCPalletteCode > li","active"),"active"),e.removeClass(e.getElementByClassName("colorDialogCustomPallete"),"active");e.addClass(this,"active"),t.updateTheme(this.dataset),e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("colorDialogCustomPallete","click",function(){e.removeClass(e.findByClassName("cPaletteCode > li","active"),"active");e.addClass(this,"active"),t.updateTheme(this.dataset),e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("customColorToggle","click",function(){t.reveseColorScheme(e.getElementById("customColorToggle").checked)});var a=e.getElementById("chartcustomcolorDropDown");c.bind(a,"zcolorselectboxchange",function(o,a){var l=a.rgb,r=e.getElementByClassName("colorDialogCustomPallete"),i=r.dataset.basecolor,c={"data-basecolor":l};e.addAttributes("colorDialogCustomPallete",c);var s=new n.Utility.SheetChartColor(l).getLinerGradient(6);e.addStyle("colorDialogCustomPallete",{"background-image":s});var d=new n.Utility.ChartAgent,C=d.isUniqueValue(i,l);C&&t.updateTheme(r.dataset),C&&(e.removeClass(e.findByClassName("cPaletteCode > li","active"),"active"),e.addClass(e.getElementByClassName("colorDialogCustomPallete"),"active"))}),c.bind(a,"zcolorselectboxpickeropen",function(){o()})},n.Manager.ZSCColorManager=t}(this);
!function(t){function e(){!o&&(o=new r.Manager.PublishDialogManager)}var i=t.sPlusPlus,r=t.ZSChart,a=r.Constants.ChartPublishConstant,n=r.Server.Action,s=t.JSUtil,h=t.ZSConstants.I18N,o=null,u=null;e.prototype.getFirstInstance=function(t){var e;return t&&(e=t[0]),e},e.prototype.isActionOwner=function(){return u?!0:!1},e.prototype.setActionOwner=function(){var t=i.data.UserInfo;u=t.zuid},e.prototype.showUrlPublishDialog=function(t){var e=s.fn.getServerPath();e+="/sheet/",e+="publicgraphs/";var i=null,r=null,a=t?t[0]:null;i=this.getActiveChartMeta(),r=this.getFirstInstance(i);var n=a?a.pcn:r.getPubChartName();e+=n;var u=h.PublishedChart,l={width:550,modal:!0,title:u},c={url:e,height:r.getHeight(),width:r.getWidth(),title:r.getTitle()};o.init(l,c),o.open()},e.prototype.publishChart=function(){var t=this.getActiveChartMeta(),e=this.getRequestObject(t,a.PUBLISH);n.doPublicChart(e)},e.prototype.getActiveChartMeta=function(){var t=new r.Utility.ChartAgent,e=t.getActiveChartMeta();return e},e.prototype.unPublishChart=function(){var t=this.getActiveChartMeta(),e=this.getRequestObject(t,a.REVERT);n.doPublicChart(e)},e.prototype.doPublishAction=function(t,e,i){switch(t.status){case a.PUBLISH:this.publishChart();break;case a.REVERT:this.unPublishChart();break;case a.SHOWURL:i&&this.showUrlPublishDialog(e)}this.setActionOwner()},e.prototype.getRequestObject=function(t,e){var i={publish:"chartaction",unpublish:"chartaction",showUrl:"chartaction"},r={publish:"CHART_PUBLISH",unpublish:"CHART_UNPUBLISH",showUrl:"CHART_PUBLISH"},a=[];for(var n in t){var s=t[n];a.push({id:s.getID()})}var h={parameters:a,url:i[e],action:r[e]};return h},r.Manager.ZSCPublishManager=e}(this);
!function(t){function e(t,e){var o=new i.Utility.ChartAgent,r=e.co,n=o.clone(e,!0),s=(o.clone(n.co,!0),e.ts||","),c=e.ds||".";delete n.co;var l=new i.Model.ChartModel(t,n,r.chart,r.colorOptions,r.xAxis,r.yAxis,r.series,r.title,r.subtitle,r.tooltip,r.plotOptions,r.legend,r.credits,s,c,r.isStockChart);return l.setSeparatorOptions(),l.init(!1,!1),l.restoreDefaultSpacing(),l.showPreview()}function o(t,e){return new Promise(function(o){var r=new i.Utility.ChartAgent,n=e.co,s=r.clone(e,!0),c=(r.clone(s.co,!0),e.ts||","),l=e.ds||".";delete s.co;var a=new i.Model.ChartModel(t,s,n.chart,n.colorOptions,n.xAxis,n.yAxis,n.series,n.title,n.subtitle,n.tooltip,n.plotOptions,n.legend,n.credits,c,l,n.isStockChart);a.setSeparatorOptions(),a.init(!1,!1),a.restoreDefaultSpacing(),a.showPreview(),setTimeout(function(){o()},200)})}var i=(t.sPlusPlus,t.ZSChart);i.Action.createPreview=e,i.Action.renderChart=o}(this);
!function(e){function t(){this.dailogOptions=null,C=null}function n(e,t){var n=d.querySelector("#zsPublicUrlLink");n.innerText=e.url,n.href=e.url;var i;t?i='<img title src="'+e.url+'.png">':(i='<iframe style="position:absolute;height:100%;width:99%;border:none;" frameborder=0 src="',i+=e.url,i+='"></iframe>');var o=document.createTextNode(i);d.querySelector("#embedCode").innerText=o.wholeText,d.querySelector("#embedSnipetMsg").innerText=r.fn.replaceParams(l["Dialog.Publish.EmbedMessage"],[l["Dialog.Publish.Chart"]]);var s=d.querySelector("#embedSnipet"),c=s.querySelector("#embedCode"),u=s.querySelector("#embedSnippetCode"),p={inputToSelect:c,cssClass:"frmSnpt"},C=new a.CopyToClipboard(u,p);C.createElement();var g=d.querySelector("#publicURL"),E={inputToSelect:n,cssClass:"frmSnpt"},C=new a.CopyToClipboard(g,E);C.createElement()}var i,o=(e.sPlusPlus,e.ZSChart),r=(o.Constants.ChartPublishConstant,o.Action,e.JSUtil),l=e.ZSConstants.I18N,a=e.ZSClass,s=e.ZSConstants.FeatureConstants,c=e.ZSConstants.wCC,u=(e.document,!1),d=null,p=null,C=null;t.prototype.init=function(e,t){this.dailogOptions=e,C=t},t.prototype.open=function(){!i&&(i=o.Wrapper.DOMUtils),this.initDialog(),this.dailogOptions.open=function(){this.openDialogHandler()}.bind(this),this.dailogOptions.close=function(){this.closeDialogHandler()}.bind(this),p=new a.Dialog(d,this.dailogOptions),p.open()},t.prototype.initDialog=function(){if(!p){u=!0;var t=e.UserAction.getTemplate(["PUBLIC_CHART_TEMPLATE","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]);d=i.createElement("div",{id:c.DI+s.PUBLISH_CHART+c.IDENTITY}),i.appendChild(d,t.PUBLIC_CHART_TEMPLATE),i.appendChild(d,t.EMBED_SNIPPET_TEMPLATE),i.appendChild(d,t.EMBED_REVERT_CANCEL_TEMPLATE)}return p},t.prototype.getUrlOptions=function(){return C},t.prototype.openDialogHandler=function(){u&&this._bindEvents(d);var e=new o.Utility.ChartAgent,t=e.clone(this.getUrlOptions());n(t)},t.prototype.closeDialogHandler=function(){var e=d.querySelector("#interactiveView");e.checked=!0},t.prototype._bindEvents=function(e){u=!1;var t=new o.Utility.ChartAgent,r=t.clone(this.getUrlOptions()),l=i.getNodeInParent(e,"interactiveView")[0];i.addEventByNode(l,"click",function(){n(r),i.getNodeInParent(e,"zsPublicUrlLink")[0].innerText=r.url,i.getNodeInParent(e,"zsPublicUrlLink")[0].href=r.url});var a=i.getNodeInParent(e,"pnglView")[0];i.addEventByNode(a,"click",function(){n(r,!0),i.getNodeInParent(e,"zsPublicUrlLink")[0].innerText=r.url+".png",i.getNodeInParent(e,"zsPublicUrlLink")[0].href=r.url+".png"});var s=i.getNodeInParent(e,"btnRemovePublic")[0];i.addEventByNode(s,"click",function(){var e=new o.Controller.ZSCController;e.revertPubishChart(),p.close()});var c=i.getNodeInParent(e,"btnCancel")[0];i.addEventByNode(c,"click",function(){p.close()})},o.Manager.PublishDialogManager=t}(this);
!function(t){var n=t.ZSChart,e=(t.sPlusPlus,t.ZSConstants.ActionConstants),i=function(t){this.rID=null,this.sheetID=null,this.aConst=t,this.version=null,this.ttl=null,this.ttlTimer=null,this.ID=null,this.aOwner=null};i.prototype={getRID:function(){return this.rID},setRID:function(t){this.rID=t},setID:function(t){this.ID=t},getID:function(){return this.ID},setActionOwner:function(t){this.aOwner=t},getActionOwner:function(){return this.aOwner},setActionConst:function(t){this.action=t},getActionConst:function(){return this.action},isSameDocument:function(t){return this.getRID()==t&&-1!=this.getActionConst()},setSheetID:function(t){this.sheetID=t},getSheetID:function(){return this.sheetID},isSameSheet:function(t){return this.isSameDocument()&&this.getSheetID()==t},resetAction:function(){this.action=-1},setVersion:function(t){this.version=t},getVersion:function(){return this.version}},i.setObjectProperties=function(t){var i=null;return t.isRelatedToDesign&&(i=new n.Model.DesignClip(e.CHART_COPY_STYLE),i.setRID(t.RID),i.setSheetID(t.sheetID),i.setID(t.sID),i.setActionOwner(t.aOwner),i.setVersion(t.version)),i},n.Model.CHARTCLIP=i}(this);
!function(t){var e,i=t.ZSChart,s=t.sPlusPlus,o=i.Model.CHARTCLIP,n=function(t){o.call(this,t),this.init()};n.prototype=new o,n.prototype.init=function(){this.startTime=null,this.copyStatus=!1,this.pasteStatus=!1,this.clearTTL()},n.prototype.setStatus=function(t){this.copyStatus=-1!=this.a?!0:!1,this.setActionOwner(t.zuid),this.setPasteStatus(t.isPasteEnable)},n.prototype.setPasteStatus=function(t){this.pasteStatus=t},n.prototype.isPasteEnable=function(){return this.pasteStatus},n.prototype.getClipObject=function(){return isUndefined(e)&&(e=new n(-1)),e},n.prototype.clip=function(t){i.Server.Action.copyClipToServer(t.RID,t.sheetID,t.version,{sID:t.sID})},n.prototype.paste=function(t){var e=s.view.getActiveGridID(),o=s.view.getResourceID(e),n=s.view.getSheetID(e),r=s.view.getVersionID(e),p=this.getID(),a=p==t;!a&&i.Server.Action.pasteDesign(o,n,r,{cID:t,sID:p,URL:"chartaction"})},n.prototype.setTTL=function(t){this.ttl=1e3*t,this.startTime=(new Date).getTime();var e=this;this.ttl>0&&(this.ttlTimer=setTimeout(function(){e.hasClip()&&e.removeClip()},this.ttl))},n.prototype.getTTL=function(){var t=this.ttl-((new Date).getTime()-this.startTime);return t>=0?(t/6e4).toFixed(1):-1},n.prototype.removeClip=function(){-1!=this.a&&(this.resetAction(),this.init())},n.prototype.clearTTL=function(){clearTimeout(this.ttlTimer)},n.prototype.hasClip=function(){return-1!=this.a},n.prototype.updateResponse=function(t){var e=t.copiedStyle;e&&(this.setStatus(e),this.setTTL(e.ttl))},n.prototype.setConfig=function(t){this.setSheetID(t.sheetID),this.setActionOwner(t.aOwner),this.setRID(t.RID),this.setVersion(t.version),this.setID(t.sID)},i.Model.DesignClip=n}(this);
!function(e){function t(){}function i(e){var t=new r.Manager.ZSCCManager;t.processMessage(e)}var r=e.ZSChart,n=e.sPlusPlus,s=e.ZSEvents,o=s.topic,a=s.Groups,l=s.Names,g=r.Model.CHARTCLIP,p=null,c=e.ZSConstants,C=c.ActionConstants;t.prototype.copyStyle=function(){var e=new r.Utility.ChartAgent,t=n.view.getActiveGridID(),i=e.getActiveChartMeta()[0],s=n.view.getResourceID(t),o=n.view.getSheetID(t),a=n.view.getVersionID(t),l=n.data.UserInfo,g={RID:s,sheetID:o,sID:i.getID(),aOwner:l.zuid,version:a};!p&&(p=new r.Model.DesignClip(C.CHART_COPY_STYLE)),p.setConfig(g),p.clip(g)},t.prototype.resetDesignToDefault=function(){var e=new r.Utility.ChartAgent,t=n.view.getActiveGridID(),i=n.view.getResourceID(t),s=n.view.getSheetID(t),o=n.view.getVersionID(t),a=r.Utility.getActiveChart();for(var l in a){var g=e.getChartMeta(a[l]);r.Server.Action.doQuickStyleAction(i,s,o,g.getID(),128,[{cStyle:"default"}])}p&&p.removeClip()},t.prototype.pasteStyle=function(){var e=new r.Utility.ChartAgent,t=r.Utility.getActiveChart();for(var i in t){var n=e.getChartMeta(t[i]);this.hasStyleClip()&&p.paste(n.getID())}},t.prototype.hasStyleClip=function(){return p?p.hasClip():!1},t.prototype.getClip=function(){return!p&&(p=this.getDefaultStyleClip()),p},t.prototype.getDefaultStyleClip=function(){var e=(new r.Utility.ChartAgent,n.view.getActiveGridID()),t=n.view.getResourceID(e),i=n.view.getSheetID(e),s=n.view.getVersionID(e),o=n.data.UserInfo,a={RID:t,sheetID:i,sID:null,isRelatedToDesign:!0,aOwner:o.zuid,version:s};return g.setObjectProperties(a)},t.prototype.processMessage=function(e){this.getClip().updateResponse(e)},t.prototype.performStyleAction=function(e){switch(e){case"CS":this.copyStyle();break;case"PS":this.pasteStyle();break;case"RS":this.resetDesignToDefault()}},o.register(a.Listener,l.ServerClip.CHART.STYLE_CLIP,i,"STYLE_CLIP"),r.Manager.ZSCCManager=t}(this);
!function(e){function t(t,n,r,o,i,a){i=i?i:!1,a=a?a:!1;var s=new l.ParamGenerator(n,t,r),d=s.getRanges(),R=s.getSheets();if(!i)var c=o[u.TARGET],v=new l.Range(c[1],c[2],c[3],c[4]),I=s.getActiveCell(),E=s.getCustomRanges(v);var T=o[u.SOURCE],P=[];P.push(T[0]);var f,g=new l.ParamGenerator(P,t,r),w=g.getSheets(),_=new l.Range(T[1],T[2],T[3],T[4]),N=g.getCustomRanges(_),V=O.view.getActiveGridID(),t=O.view.getResourceID(V),r=O.view.getVersionID(V),h=e.ZSClass.Pivot.Util.getPrimitiveFnFromStr(o.fn),m={RID:t,sheetList:R,rangeList:d,srcSheetList:w,srcRangeList:N,dstnSheetList:i?void 0:R,dstnRangeList:i?void 0:E,activeCell:I,VERSION:r,pf:o.pf,rf:o.rf,cf:o.cf,df:o.df,fn:h,pivotId:o.id,group:o.gr,isNewSheet:i,overwriteData:a,pfd:o[C.PIVOT_FILTER_DETAILS],psd:o[C.PIVOT_SORT_DETAILS],theme:o.ptid,sto:o.sto?1:0,rgto:o.rgto?1:0,cgto:o.cgto?1:0};f="temp"===m.pivotId?new L(S.CREATE_PIVOT,m):new L(S.EDIT_PIVOT,m);var G=new A;G.addEventListeners("onComplete",function(e){var t=e.qaid;f.qaid=t,O.data.UserInfo.ActionRecorder.record(f)}),G.open("temp"===m.pivotId?p.CREATE_PIVOT:p.EDIT_PIVOT),G.send(m)}function n(e,t,n,r,o,i,a,s){var d=new l.ParamGenerator(t,e,n),R=d.getSheets(),c=d.getRanges();if(a)var v=new l.Range(0,0,0,0);else var v=o,P=d.getActiveCell();var C=d.getCustomRanges(v),u={RID:e,sheetList:R,activeCell:P,VERSION:n,isNewSheet:a,rangeList:c,dstnSheetList:a?void 0:R,dstnRangeList:a?void 0:C,overwriteData:i,pivotId:r,actionType:s};if("copy"===s)var f=new L(S.COPY_PIVOT,u);else if("move"===s)var f=new L(S.MOVE_PIVOT,u);var g=new A;g.addEventListeners("onComplete",function(t){a&&I.publish(E.Listener,T.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:n,qaid:t.qaid});var r=t.qaid;f.qaid=r,O.data.UserInfo.ActionRecorder.record(f)}),g.addEventListeners("onError",function(e){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].handleError(e.mk)}),"copy"===s?g.open(p.COPY_PIVOT):"move"===s&&g.open(p.MOVE_PIVOT),g.send(u)}function r(e,t,n,r,o,i){var a=new l.ParamGenerator(t,e,n),s=a.getSheets(),d=a.getActiveCell(),R=a.getCustomRanges(o),c={RID:e,sheetList:s,activeCell:d,VERSION:n,rangeList:R,overwriteData:i,pivotId:r,action:S.CHANGE_PIVOT_SOURCE},v=new L(S.CHANGE_PIVOT_SOURCE,c),P=new A;P.addEventListeners("onComplete",function(e){var t=e.qaid;v.qaid=t,O.data.UserInfo.ActionRecorder.record(v)}),P.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(p.CHANGE_PIVOT_SOURCE),P.send(c)}function o(e,t,n,r){var o=new l.ParamGenerator(t,e,n),i=o.getSheets(),a=o.getActiveCell(),s={RID:e,sheetList:i,activeCell:a,VERSION:n,pivotId:r};if(r)var d=new L(S.REFRESH_PIVOT,s);else var d=new L(S.REFRESH_ALL_PIVOT,s);var R=new A;R.addEventListeners("onComplete",function(e){var t=e.qaid;d.qaid=t,O.data.UserInfo.ActionRecorder.record(d)}),R.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),R.open(r?p.REFRESH_PIVOT:p.REFRESH_ALL_PIVOT),R.send(s)}function i(e,t,n,r,o,i,a,s,d,R,c,v,P){var C=new l.ParamGenerator(t,e,n),u=C.getSheets(),f=C.getActiveCell(),g={RID:e,sheetList:u,activeCell:f,VERSION:n,pivotID:r,fieldType:o,headerIndex:i,pivotFilterJsonParam:a,selectAll:s,filterType:d,operator:R,value:c,value2:v,dataFieldIndex:P},w=new L(S.APPLYFILTER_PIVOT,g),_=new A;_.addEventListeners("onComplete",function(e){var t=e.qaid;w.qaid=t,O.data.UserInfo.ActionRecorder.record(w)}),_.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(p.APPLYFILTER_PIVOT),_.send(g)}function a(e,t,n,r,o,i,a,s,d){var R=new l.ParamGenerator(t,e,n),c=R.getSheets(),v=R.getActiveCell(),P={RID:e,sheetList:c,activeCell:v,VERSION:n,pivotID:r,filterType:o,headerIndex:i,displayMemberMode:a,count:s,sortMode:d},C=new L(S.CHANGE_DISPLAYINFO_PIVOT,P),u=new A;u.addEventListeners("onComplete",function(e){var t=e.qaid;C.qaid=t,O.data.UserInfo.ActionRecorder.record(C)}),u.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(p.CHANGE_DISPLAYINFO_PIVOT),u.send(P)}function s(e,t,n,r,o,i,a,s){var d=new l.ParamGenerator(t,e,n),R=d.getSheets(),c=d.getActiveCell(),v={RID:e,sheetList:R,activeCell:c,VERSION:n,pivotID:r,filterType:o,headerIndex:i,isAscending:a,sortMode:s},P=new L(S.SORT_PIVOT,v),C=new A;C.addEventListeners("onComplete",function(e){var t=e.qaid;P.qaid=t,O.data.UserInfo.ActionRecorder.record(P)}),C.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),C.open(p.SORT_PIVOT),C.send(v)}function d(e,t,n,r,o,i,a){var s=new l.ParamGenerator(t,e,n),d=s.getSheets(),R=s.getActiveCell(),c={RID:e,sheetList:d,activeCell:R,VERSION:n,pivotId:r,themeId:i,colorId:o,accentId:a},v=new L(S.CHANGE_PIVOT_THEME,c),P=new A;P.addEventListeners("onComplete",function(e){var t=e.qaid;v.qaid=t,O.data.UserInfo.ActionRecorder.record(v)}),P.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(p.CHANGE_PIVOT_THEME),P.send(c)}function R(e,t,n,r){var o=O.view.getActiveGridID(),e=O.view.getResourceID(o),n=O.view.getVersionID(o),i=new l.ParamGenerator(t,e,n),a=i.getSheets(),s=i.getActiveCell(),d={RID:e,sheetList:a,activeCell:s,VERSION:n,pivotId:r},R=new L(S.DELETE_PIVOT,d),c=new A;c.addEventListeners("onComplete",function(e){var t=e.qaid;R.qaid=t,O.data.UserInfo.ActionRecorder.record(R)}),c.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),c.open(p.DELETE_PIVOT),c.send(d)}function c(e,t,n,r,o,i){var a,s=new l.ParamGenerator(t,e,n),d=s.getSheets(),R=s.getActiveCell(),c={RID:e,sheetList:d,activeCell:R,VERSION:n,pivotId:r,value:i,groupId:o};switch(o){case C.SUBTOTALOPTION:a=new L(S.CHANGE_PIVOT_SUBTOTALOPTION,c);break;case C.ROWGRANDTOTALOPTION:a=new L(S.CHANGE_PIVOT_GRANDTOTALROWOPTION,c);break;case C.COLGRANDTOTALOPTION:a=new L(S.CHANGE_PIVOT_SUBTOTALOPTION,c)}var v=new A;switch(v.addEventListeners("onComplete",function(e){var t=e.qaid;a.qaid=t,O.data.UserInfo.ActionRecorder.record(a)}),v.addEventListeners("onError",function(e){I.publish(E.Listener,T.ERROR.SHOW,{ERRORMSG:e.mk})}),o){case C.SUBTOTALOPTION:v.open(p.CHANGE_PIVOT_SUBTOTALOPTION);break;case C.ROWGRANDTOTALOPTION:v.open(p.CHANGE_PIVOT_GRANDTOTALROWOPTION);break;case C.COLGRANDTOTALOPTION:v.open(p.CHANGE_PIVOT_GRANDTOTALROWOPTION)}v.send(c)}var O=e.sPlusPlus,v=e.ZSEvents,I=v.topic,E=v.Groups,T=v.Names,l=e.ZSClass,P=O.SML.Client,A=P.Utility.WorkerRequest,L=l.ActionObject,S=e.ZSConstants.ActionConstants,C=e.ZSConstants.PivotConstant,p=e.ZSConstants.URI,u=e.ZSConstants.CommandConstants;e.UserAction.createPivot=t,e.UserAction.changePivotSource=r,e.UserAction.deletePivot=R,e.UserAction.movePivot=n,e.UserAction.refreshPivot=o,e.UserAction.changePivotStyle=d,e.UserAction.changeTotalOption=c,e.UserAction.applyPivotFilter=i,e.UserAction.applyPivotCustomFilter=a,e.UserAction.sortPivot=s}(this);
!function(e){function t(e,t,n){var s=new l.ParamGenerator(t,e,n,!0,!0),i=s.getSheets(),o=s.getActiveCell(),R={RID:e,sheetList:i,activeCell:o,VERSION:n,action:u.DETECT_PIVOT_RANGE},A=(new I(u.DETECT_PIVOT_RANGE,R),new c);A.addEventListeners("onComplete",function(e){r.publish(E.Listener,a.UserAction.PIVOT.DETECT_RANGE,{resp_Range:e})}),A.addEventListeners("onError",function(e){r.publish(E.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(T.DETECT_PIVOT_RANGE),A.send(R)}function n(e,t,n,s,i){var o=new l.ParamGenerator(t,e,n),r=o.getSheets(),E=o.getCustomRanges(s),a=o.getActiveCell(),R={RID:e,sheetList:r,VERSION:n,rangeList:E,activeCell:a,action:u.READ_PIVOT_FIELDS},A=(new I(u.READ_PIVOT_FIELDS,R),new c);A.addEventListeners("onComplete",function(e){l.Pivot.Util.checkSourceChanges(e.data,i)}),A.addEventListeners("onError",function(e){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_TABLE].handleError(e.mk)}),A.open(T.READ_PIVOT_FIELDS),A.send(R)}function s(e,t,n,s,i,o){var l=getCell(s,i).data.DisplayValue,R={RID:e,SHEETID:t,VERSION:n,pivotID:o,cellValue:l},A=(new I(u.READ_PIVOT_FILTER_DATA,R),new c);A.addEventListeners("onComplete",function(e){r.publish(E.Listener,a.SheetAction.PIVOT.FILTER_INFO,{filterInfo:e})}),A.addEventListeners("onError",function(e){r.publish(E.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(T.READ_PIVOT_FILTER_DATA),A.send(R)}var i=e.sPlusPlus,o=e.ZSEvents,r=o.topic,E=o.Groups,a=o.Names,l=e.ZSClass,R=i.SML.Client,c=R.Utility.WorkerRequest,I=l.ActionObject,u=e.ZSConstants.ActionConstants,T=e.ZSConstants.URI;e.UserAction.getPivotSRange=t,e.UserAction.getPivotFields=n,e.UserAction.getPivotFilterInfo=s}(this);
!function(e){function t(e,t,n,s,r,i,a,R,d,l){var p=L.getVersionID(t),m=c[l],v=new ZSClass.ParamGenerator(n,e,p),h=new ZSClass.ParamGenerator(r,e,p),D=v.getSheets(),O=h.getSheets(),i=h.getCustomRanges(i,!0),s=v.getCustomRanges(s,!0),f=v.getActiveCell(),w={action:m,RID:e,gridID:t,sheetID:a,VERSION:p,type:R,sparklineID:d,sheetList:D,rangeList:s,srcSheetList:O,srcRangeList:i,activeCell:f},A=new u(m,w),k=new E;k.addEventListeners("onComplete",function(e){A.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(A)}),k.addEventListeners("onError",function(e){g.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),k.open(C[l]),k.send(w)}function n(e,t,n,s,r,i){var a=L.getVersionID(t),R=c[i],d=new ZSClass.ParamGenerator(n,e,a),l=d.getSheets(),p=d.getCustomRanges(r,!0),m=d.getActiveCell(),v={action:R,RID:e,gridID:t,sheetID:s,sheetList:l,VERSION:a,rangeList:p,activeCell:m},h=new u(R,v),D=new E;D.addEventListeners("onComplete",function(e){h.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(h)}),D.addEventListeners("onError",function(e){g.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(C[i]),D.send(v)}function s(e,t,n,s,r,i,a){var R=L.getVersionID(t),d=c[a],l=new ZSClass.ParamGenerator(s,e,R),p=l.getSheets(),m=l.getCustomRanges(i,!0),v=l.getActiveCell(),h={action:d,RID:e,gridID:t,sheetID:n,sheetList:p,VERSION:R,rangeList:m,properties:r,activeCell:v},D=new u(d,h),O=new E;O.addEventListeners("onComplete",function(e){D.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(D)}),O.addEventListeners("onError",function(e){g.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(C[a]),O.send(h)}function r(e,t,n,s,r,i,a){var R=L.getVersionID(t),d="CHANGE_SPARKLINE_ORIENTATION",l=c[d],p=new ZSClass.ParamGenerator(s,e,R),m=p.getSheets(),v=p.getCustomRanges(i,!0),h={action:l,RID:e,gridID:t,sheetID:n,sheetList:m,VERSION:R,rangeList:v,sparklineID:r,activeCell:a},D=new u(l,h),O=new E;O.addEventListeners("onComplete",function(e){D.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(D)}),O.addEventListeners("onError",function(e){g.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(C[d]),O.send(h)}function i(e,t,n,s,r,i,a){var R=L.getVersionID(t),d="EDIT_SPARKLINE_DATA",l=c[d],p=new ZSClass.ParamGenerator(s,e,R),m=(new ZSClass.ParamGenerator(r,e,R),p.getCustomRanges(a,!0)),v=p.getCustomRanges(i,!0),h=p.getActiveCell(),D=p.getSheets(),O={action:l,RID:e,gridID:t,sheetID:n,sheetList:D,VERSION:R,srcRangeList:v,srcSheetList:r,rangeList:m,activeCell:h},f=new u(l,O),w=new E;w.addEventListeners("onComplete",function(e){f.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(f)}),w.addEventListeners("onError",function(e){g.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),w.open(C[d]),w.send(O)}function a(e,t,n,s,r,i,a,R){var d=L.getVersionID(t),l=c[R],p=new ZSClass.ParamGenerator(s,e,d),m=p.getSheets(),v=p.getCustomRanges(r,!0),h={action:l,RID:e,gridID:t,sheetID:n,sheetList:m,VERSION:d,rangeList:v,sparklineCellRange:i,isCompleteGroup:a},D=new u(l,h),O=new E;O.addEventListeners("onComplete",function(e){D.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(D)}),O.addEventListeners("onError",function(e){g.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(C[R]),O.send(h)}var o=e.sPlusPlus,R=o.SML.Client,d=e.ZSConstants,c=d.ActionConstants,l=e.ZSEvents,g=l.topic,S=l.Groups,I=l.Names,u=e.ZSClass.ActionObject,E=R.Utility.WorkerRequest,p=e.UserAction,C=d.URI,L=o.view;p.createSparklines=t,p.removeSparklines=n,p.modifySparklineProperties=s,p.changeSparklineOrientation=r,p.editSparkline=i,p.groupSparklines=a,p.ungroupSparklines=n}(this);
!function(e){function n(e,n,s){var t={RID:e,newDocName:s,VERSION:n},E=new o(i.SAVEAS_NEW_TEMPLATE,t),S=new c;S.addEventListeners("onComplete",function(e){a.publish(r.Listener,A.UserAction.SaveAsTemplateResponse,{NEWDOCNAME:s,NEWDOCRID:e.di,VERSION:n}),E.qaid=e.qaid}),S.addEventListeners("onError",function(e){a.publish(r.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),S.open(R.SAVE_AS_TEMPLATE),S.send(t)}var s=e.sPlusPlus,t=e.ZSConstants,i=t.ActionConstants,o=e.ZSClass.ActionObject,E=e.ZSEvents,a=E.topic,r=E.Groups,A=E.Names,R=t.URI,S=s.SML.Client,c=S.Utility.WorkerRequest;e.UserAction.saveAsTemplate=n}(this);
!function(e){function n(e,n,o){var t={RID:e,VERSION:n,versionNo:n},l=new i;l.addEventListeners("onError",function(e){r.log("Delete version error :",e)}),l.addEventListeners("onComplete",function(){o()}),l.open(s.DELETE_VERSION),l.send(t)}var o=e.sPlusPlus,t=o.SML.Client,s=e.ZSConstants.URI,r=e.ZSDevTools.Logger,i=t.Utility.WorkerRequest;UserAction.deleteVersion=n}(this);
!function(e){function n(n,t,o){var a=(s.data.getWorkBook(n,t),e.encodeURIComponent),C={RID:n,VERSION:t,label:a(o)},I=(new c(S.CREATE_VERSION,C),new E);I.addEventListeners("onComplete",function(){var e=new ZSClass.TBNotification(u["Version.infoMessage"],{type:"info"});e.show(),i.publish(r.Listener,R.UserAction.CreateVersionResponse,{VERSION_NAME:o,RID:n,VERSION:t})}),I.addEventListeners("onError",function(e){i.publish(r.Listeners,R.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(l.CREATE_VERSION),I.send(C)}var s=e.sPlusPlus,t=e.ZSConstants,o=e.ZSEvents,i=o.topic,r=o.Groups,R=o.Names,a=s.SML.Client,E=a.Utility.WorkerRequest,c=e.ZSClass.ActionObject,S=t.ActionConstants,l=t.URI,u=t.I18N;e.UserAction.CreateVersion=n}(this);
!function(t){function e(t,e,s,n){var o={RID:t,SHEETID:e,VERSION:s},a=new i;a.addEventListeners("onComplete",function(t){n&&n(t)}),a.open(r.EXPORT_DOCUMENT),a.send(o)}function s(e,s,n,r){var o=new ZSClass.AjaxRequest(e,s),a={params:["rid","currentSheet","version","ftype"],paramVal:[e,n,"",r],URL:"export",action:u.EXPORT_DOCUMENT},i=new t.ZSClass.RequestParameters(a),c={formObj:{},method:"POST",URL:i.getURL(e),params:i.getParametersAsString(),csrf:!0,respType:"text"};o.init(null,c),o.sendRequest()}var n=t.sPlusPlus,r=(t.UserAction,t.ZSConstants.URI),o=t.ZSEvents,a=(o.topic,o.Groups,o.Names,n.SML.Client),i=a.Utility.WorkerRequest,u=t.ZSConstants.ActionConstants;t.UserAction.downloadAs=s,t.UserAction.ExportDocument=e}(this);
!function(e){function n(e,n,t,s,r){var c={RID:e,VERSION:n,ACTION:t},u=new i;u.addEventListeners("onError",function(){}),u.addEventListeners("onComplete",function(e){s&&s(e,r)}),u.open(o.CHECKIN_CHECKOUT_SPREADSHEET),u.send(c)}var t=e.sPlusPlus,s=t.SML.Client,o=e.ZSConstants.URI,i=(e.ZSDevTools.Logger,s.Utility.WorkerRequest),r=e.UserAction;r.checkinCheckoutSpreadsheet=n}(this);
!function(e){function n(e,n,t,o,i){var R={RID:e,VERSION:n,MACRONAME:t,MACRODESCRIPTION:o},c=new r;c.addEventListeners("onError",function(e){i&&i(e)}),c.addEventListeners("onComplete",function(e){i&&i(e)}),c.open(s.CREATE_MACRO),c.send(R)}var t=e.sPlusPlus,o=t.SML.Client,s=e.ZSConstants.URI,r=(e.ZSDevTools.Logger,o.Utility.WorkerRequest),i=e.UserAction;i.createMacro=n}(this);
!function(e){function n(e,n,r,o,t,E,R,a,C,d,u){var I=new ZSClass.ParamGenerator(E,e,r,!0,!0);R=I.getCustomRanges(R);var O=I.getSheets(),l={RID:e,VERSION:r,MACRONAME:o,MACRODESCRIPTION:t,SHEETLIST:O,ACTIVERANGE:R,ACTIVEROW:a,ACTIVECOL:C,ISRELATIVEREFERENCE:d},g=new i;g.addEventListeners("onError",function(e){c.log("Error while executing record macro: ",e)}),g.addEventListeners("onComplete",function(e){u&&u(e)}),g.open(s.RECORD_MACRO),g.send(l)}function r(e,n){var r={RID:e,VERSION:n},o=new i;o.addEventListeners("onError",function(e){c.log("Error while executing cancel recording macro: ",e)}),o.open(s.CANCEL_RECORDING_MACRO),o.send(r)}function o(e,n,r,o){var t={RID:e,VERSION:n,RECORDOBJ:r},E=new i;E.addEventListeners("onError",function(e){c.log("Error while executing stop recording macro: ",e)}),E.addEventListeners("onComplete",function(e){o&&o(e)}),E.open(s.STOP_RECORDING_MACRO),E.send(t)}var t=e.sPlusPlus,E=t.SML.Client,s=e.ZSConstants.URI,c=e.ZSDevTools.Logger,i=E.Utility.WorkerRequest,R=e.UserAction;R.recordMacro=n,R.cancelRecordingMacro=r,R.stopRecordingMacro=o}(this);
!function(e){function n(e,n,t,r){var o=new ZSClass.ParamGenerator(t,e,n,!0,!0),E=o.getSheets(),S={RID:e,VERSION:n,SHEETLIST:E},c=new i;c.addEventListeners("onError",function(e){a.log("Error while executing getMacroList : ",e)}),c.addEventListeners("onComplete",function(e){r(e,!1)}),c.open(s.GET_MACRO_LIST),c.send(S)}function t(e,n,t,r,o,E,S,c,l){var u=new ZSClass.ParamGenerator(E,e,t,!0,!0);c=u.getCustomRanges(c);var R=u.getSheets(),d={RID:e,SHEETID:n,VERSION:t,MODULENAME:r,MACRONAME:o,SHEETLIST:R,ACTIVERANGE:c,CURRSHEETNAME:S},L=new i;L.addEventListeners("onError",function(e){a.log("Error while runnning macro: ",e)}),L.addEventListeners("onComplete",function(e){l&&l(e)}),L.open(s.RUN_MACRO),L.send(d)}function r(e,n,t,r,o,E,S,c){var l=new ZSClass.ParamGenerator(r,e,t,!0,!0),u=l.getSheets(),R={RID:e,SHEETID:n,VERSION:t,SHEETLIST:u,MODULENAME:o,MACRONAME:E},d=new i;d.addEventListeners("onError",function(e){a.log("Error while deleting macro: ",e)}),d.addEventListeners("onComplete",function(e){S&&S(e,c)}),d.open(s.DELETE_MACRO),d.send(R)}var o=e.sPlusPlus,E=o.SML.Client,s=e.ZSConstants.URI,a=e.ZSDevTools.Logger,i=E.Utility.WorkerRequest,S=e.UserAction;S.getMacroList=n,S.runMacro=t,S.deleteMacro=r}(this);
!function(e){function n(e,n,r,E,o,t,s){var a=new ZSClass.ParamGenerator(r,e,n,!0,!0),R=a.getSheets(),c={RID:e,VERSION:n,SHEETLIST:R};E&&o&&(c.MODULENAME=E,c.MACRONAME=o);var S=new u;S.addEventListeners("onError",function(e){N.log("Error while executing getMacroEditorInfo : ",e)}),S.addEventListeners("onComplete",function(e){t&&t(e[0],e[1],s)}),S.open(i.MACRO_EDITOR_INFO),S.send(c)}function r(e,n,r,E,o,t,s){var a=new ZSClass.ParamGenerator(r,e,n,!0,!0),R=a.getSheets(),c={RID:e,SHEETID:E,VERSION:n,SHEETLIST:R,MODULECONTENT:o},S=new u;S.addEventListeners("onError",function(e){N.log("Error while executing save macro: ",e)}),S.addEventListeners("onComplete",function(e){t&&t(e,s)}),S.open(i.SAVE_MACRO),S.send(c)}function E(e,n,r,E,o,t,s,a,R,c,S){var M=new ZSClass.ParamGenerator(t,e,r,!0,!0),s=M.getCustomRanges(s),d=M.getSheets(),C={RID:e,SHEETID:n,VERSION:r,MODULENAME:E,MODULECONTENT:o,SHEETLIST:d,ACTIVERANGE:s,LINENUMBER:a,CURRSHEETNAME:R},I=new u;I.addEventListeners("onError",function(e){N.log("Error while executing save and run macro: ",e)}),I.addEventListeners("onComplete",function(e){c&&c(e,S)}),I.open(i.SAVE_AND_RUN_MACRO),I.send(C)}function o(e,n,r,E,o,t,s,a,R,c,S){var M=new ZSClass.ParamGenerator(s,e,r,!0,!0);R=M.getCustomRanges(R);var d=M.getSheets(),C={RID:e,SHEETID:n,VERSION:r,MODULENAME:E,MODULECONTENT:o,SHEETLIST:d,ACTIVERANGE:R,LINENUMBER:t,CURRSHEETNAME:a},I=new u;I.addEventListeners("onError",function(e){N.log("Error while executing run macro: ",e)}),I.addEventListeners("onComplete",function(e){c&&c(e,S)}),I.open(i.RUN_MACRO_BY_LINE_NUMBER),I.send(C)}function t(e,n,r,E,o,t){var s={RID:e,SHEETID:n,VERSION:r,MODULENAMES:E,ACTIONOWNER:o},a=new u;a.addEventListeners("onError",function(e){N.log("Error while executing run macro: ",e)}),a.addEventListeners("onComplete",function(e){t&&t(e)}),a.open(i.PULL_MACRO_CONTENT),a.send(s)}var s=e.sPlusPlus,a=s.SML.Client,i=e.ZSConstants.URI,N=e.ZSDevTools.Logger,u=a.Utility.WorkerRequest,R=e.UserAction;R.saveMacro=r,R.saveAndRunMacro=E,R.getMacroEditorInfo=n,R.runMacroByLineNumber=o,R.pullMacroContent=t}(this);
!function(n){function e(n,e,t,o,i,r){var s={RID:n,version:e,action:t,script:o,description:i},E=new v;E.addEventListeners("onComplete",function(n){r&&r(n,t)}),E.addEventListeners("onError",function(){}),E.open(L.DELUGE_CREATE),E.send(s)}function t(n,e,t,o,i,r){var s={RID:n,version:e,action:t,funcId:o,parameter:i},E=new v;E.addEventListeners("onComplete",function(n){r&&r(o,n,t)}),E.addEventListeners("onError",function(){}),E.open(L.DELUGE_EXECUTE),E.send(s)}function o(n,e,t,o,i,r){var s={RID:n,version:e,action:t,funcId:o,script:i},E=new v;E.addEventListeners("onComplete",function(n){r&&r(n,t)}),E.addEventListeners("onError",function(){}),E.open(L.DELUGE_UPDATE),E.send(s)}function i(n,e,t,o){var i=A.DRE_GETDETAIL,r={RID:n,version:e,action:i,funcName:t},s=new v;s.addEventListeners("onComplete",function(n){o&&o(n)}),s.addEventListeners("onError",function(){}),s.open(L.DELUGE_GETDETAIL),s.send(r)}function r(n,e,t,o){var i={RID:n,version:e,action:t},r=new v;r.addEventListeners("onComplete",function(n){o&&o(n,t)}),r.addEventListeners("onError",function(){}),r.open(L.DELUGE_GETALL),r.send(i)}function s(n,e,t,o,i){var r={RID:n,version:e,action:A.DRE_DELETE,funcName:t},s=new v;s.addEventListeners("onComplete",function(n){o&&o(n,i)}),s.addEventListeners("onError",function(){}),s.open(L.DELUGE_DELETE),s.send(r)}function E(n,e,t,o,i,r){var s={RID:n,version:e,action:t,script:o,parameter:i},E=new v;E.addEventListeners("onComplete",function(n){r&&r(n,t)}),E.addEventListeners("onError",function(){}),E.open(L.DELUGE_CREATEANDEXECUTE),E.send(s)}function c(n,e,t,o,i,r,s){var E={RID:n,version:e,action:t,funcName:o,script:i,parameter:r},c=new v;c.addEventListeners("onComplete",function(n){s&&s(n)}),c.addEventListeners("onError",function(){}),c.open(L.DELUGE_UPDATEANDEXECUTE),c.send(E)}function d(n,e,t,o){var i={RID:n,version:e,action:t},r=new v;r.addEventListeners("onComplete",function(n){o&&o(n.delugeResponse,!0)}),r.addEventListeners("onError",function(){}),r.open(L.DELUGE_GETNAME),r.send(i)}var a=n.sPlusPlus,u=a.SML.Client,v=u.Utility.WorkerRequest,L=ZSConstants.URI,f=n.ZSConstants,A=f.ActionConstants;n.UserAction.delugeGetAllAction=r,n.UserAction.delugeCreateAction=e,n.UserAction.delugeExecuteAction=t,n.UserAction.delugeUpdateAction=o,n.UserAction.delugeGetDetailsAction=i,n.UserAction.delugeDeleteAction=s,n.UserAction.delugeCreateAndExecuteAction=E,n.UserAction.delugeUpdateAndExecuteAction=c,n.UserAction.delugeGetFunctionName=d}(this);
!function(e){function t(e,t,n,s,a,E,P){var L=o.data.getWorkBook(e,t).Name,R={RID:e,VERSION:t,TYPE:n,docName:L,ALLOW_EXPORT:s,LOCK_FORMULA:a,SUB_ACTION:E},A=new S;A.addEventListeners("onComplete",function(){var t=o.data.getSharePublishMeta(e),i=t.getPublishMeta();if("Make Public"===E){var S={};S[O.PUBLISH_TYPE]=n,S[O.ALLOW_EXPORT]=s,S[O.SHOW_FORMULAS]=a,i.update(S)}else"Remove Public"===E&&i.update({});r.publish(u.Listener,l.DocAction.DOCUMENT.PUBLISHED,{RID:e,META:i}),P&&P()}),A.open(i.SPREADSHEET_PUBLISH),A.send(R)}function n(e,t,n,s,a,E){var P={RID:e,VERSION:t,TYPE:n,PROPERTY_NAME:s,PROPERTY_VALUE:a,SUB_ACTION:E},r=new S;r.addEventListeners("onComplete",function(){var t=o.data.getSharePublishMeta(e),n=t.getPublishMeta();"ALLOWEXPORT"==s?n.setAllowExport(a):"SHOWFORMULAS"==s&&n.setShowFormula(a)}),r.open(i.SPREADSHEET_PUBLISH_OPTION_CHANGE),r.send(P)}function s(e,t,n,s){var a={RID:e,VERSION:t,TYPE:n,prevType:s},E=new S;E.addEventListeners("onComplete",function(){var t=o.data.getSharePublishMeta(e),s=t.getPublishMeta(),a=s.isAllowExport(),i=s.isShowFormula(),E={};E[O.PUBLISH_TYPE]=n,E[O.ALLOW_EXPORT]=a,E[O.SHOW_FORMULAS]=i,s.update(E)}),E.open(i.SPREADSHEET_PUBLISH_TYPE_CHANGE),E.send(a)}var o=e.sPlusPlus,a=o.SML.Client,i=e.ZSConstants.URI,E=(e.ZSDevTools.Logger,e.ZSEvents),P=e.ZSConstants,S=a.Utility.WorkerRequest,r=E.topic,u=E.Groups,l=E.Names,O=P.CommandConstants;UserAction.PublishSpreadsheet=t,UserAction.changePublishOptions=n,UserAction.changePublishType=s}(this);
!function(e){function n(e,n,t,a,o,E){var i=new r.ParamGenerator(n,e,t),a=i.getParmsFromDataString(a).ranges,l=i.getActiveSheet(),N=s.data.getWorkBook(e,t),P=N.getSheetObj(l),c=P.Prop.Name,u={RID:e,VERSION:t,SHEET_NAME:c,RANGE_LIST:a,TYPE:o},A=new S;A.addEventListeners("onComplete",function(e){E.call(null,e)}),A.open(R.RANGE_PUBLISH),A.send(u)}function t(e,n,t,a,o,s,E){var r=o.replace("public","external"),i={RID:e,VERSION:t,RANGE_ID:a,MODE:s,TYPE:r};E&&(i.SHEETNAME=E.sheetName,i.START_ROW=E.range.startRow,i.START_COL=E.range.startCol,i.END_ROW=E.range.endRow,i.END_COL=E.range.endCol);var l=new S;l.open(R.UPDATE_RANGE_PUBLISH),l.send(i)}function a(e,n,t,a,o){var E=new r.ParamGenerator(n,e,t),i=E.getActiveSheet(),l=s.data.getWorkBook(e,t),N=l.getSheetObj(i),P=N.Prop.Name,c={RID:e,VERSION:t,SHEET_NAME:P,ORG_NAME:a},u=new S;u.addEventListeners("onComplete",function(e){o.call(null,e)}),u.open(R.GET_PUBLISHED_RANGES),u.send(c)}function o(e,n,t,a,o){var s={RID:e,VERSION:n,CURR_TYPE:t,PREV_TYPE:a,RANGE_ID:o},E=new S;E.open(R.CHANGE_RANGEPUBLISH_TYPE),E.send(s)}var s=e.sPlusPlus,E=e.ZSEvents,r=e.ZSClass,R=(E.topic,E.Groups,E.Names,e.ZSConstants.ActionConstants,e.ZSClass.ActionObject,e.ZSConstants.URI),i=s.SML.Client,S=i.Utility.WorkerRequest,l=(e.JSUtil,e.UserAction);l.publishRange=n,l.updatePublishRange=t,l.getPublishRanges=a,l.changePublishRangeType=o}(this);
!function(t){function e(t,e,s,c){var a={RID:t,VERSION:e,ISNEWDOC:s},r=new o;r.addEventListeners("onComplete",function(){n.data.DocRegistry[t].isNewDoc=!1,c&&c()}),r.open(i.CHANGE_DOC_STATUS),r.send(a)}var n=t.sPlusPlus,s=n.SML.Client,i=t.ZSConstants.URI,o=(t.ZSEvents,s.Utility.WorkerRequest);UserAction.changeDocStatus=e}(this);
!function(e){function t(t,n,o,s,i){var r=new e.ZSClass.ParamGenerator(o,t,s,!0,!0),S=r.getSheets(),O=100*i,u={RID:t,sheetList:S,VERSION:s,zoomValue:O},E=new c;E.addEventListeners("onComplete",function(){}),E.open(l.ZOOM),E.send(u)}var n=e.sPlusPlus,o=n.SML.Client,s=e.ZSEvents,i=s.topic,r=s.Groups,S=s.Names,O=e.Math,o=n.SML.Client,c=o.Utility.WorkerRequest,l=(e.ZSConstants.ActionConstants,e.ZSClass.ActionObject,e.ZSConstants.URI),u=function(e,t,n,o,s,c,l,u,E){i.publish(r.Selector.BoundUpdate.CellEdit,S.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:n,isSubmittable:!0}),c=O.round(c/o*s),l=O.round(l/o*s),u=O.round(u/o*s),E=O.round(E/o*s),i.publish(r.Listener,S.SheetAction.ZOOM.OnBefore,{RID:e,SHEETID:t,VERSION:n}),i.publish(r.Listener,S.SheetAction.ZOOM.On,{RID:e,SHEETID:t,VERSION:n,ZOOM:s,sTop:l,sLeft:c,fsTop:E,fsLeft:u}),UserAction.UpdateScreenViewPort(e,t,n),UserAction.UpdateContentViewport(e,t,n),UserAction.ScrollTo(e,t,n,c,l,u,E),i.publish(r.Listener,S.SheetAction.ZOOM.OnEnd),i.publish(r.Listener,S.SheetAction.CHARTS.REPAINT,{RID:e,SHEETID:t,VERSION:n,ZOOM:!0})};e.UserAction.Zoom=u,e.UserAction.setZoom=t}(window);
!function(t){function e(e,s,a,d){var I=i.GRID_VIEW,S=new t.ZSClass.ParamGenerator(s,e,a),l=S.getSheets(),u={RID:e,sheetList:l,action:I,VERSION:a,VALUE:d},E=new o(I,u,d),C=new c;C.addEventListeners("onComplete",function(t){t.qaid;E.qaid=t.qaid,n.data.UserInfo.ActionRecorder.record(E)}),C.addEventListeners("onError",function(){}),C.open(r.GRID_VIEW),C.send(u)}{var n=t.sPlusPlus,s=t.ZSEvents,o=(t.ZSClass,s.topic,s.Groups,s.Names,t.ZSDevTools.Logger,t.ZSClass.ActionObject),i=t.ZSConstants.ActionConstants,r=t.ZSConstants.URI,a=n.SML.Client,c=a.Utility.WorkerRequest;t.UserAction}t.UserAction.GRID_VIEW=e}(this);
!function(e){function t(e,t,n){var i=S.CLEARALL,r=(o.data.getWorkBook(e,n),o.view.getActiveGridID()),c=o.view.getSheetID(r),L=(o.view.getActiveState(r),new s.ParamGenerator(t,e,n,!0,!0)),l=L.getSheets(),g=L.getRanges(),C=L.getActiveCell(),v={RID:e,sheetList:l,rangeList:g,activeCell:C,action:i,VERSION:n},O=new I(i,v),T=JSUtil.fn.getIndexOf(c,l),D=g[T];a.publish(E.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:c,VERSION:n});var u=new A;u.addEventListeners("onAcknowledge",function(){a.publish(E.Listener,R.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:c,VERSION:n,ACTION:i,RANGELIST:D})}),u.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(O)}),u.addEventListeners("onError",function(e){a.publish(E.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(d.FORMAT_MODIFY),o.data.UserInfo.registerForRepeat(u,O),u.send(v)}function n(e,t,n){var i=S.CLEARSTYLES,r=(o.data.getWorkBook(e,n),o.view.getActiveGridID()),c=o.view.getSheetID(r),L=(o.view.getActiveState(r),new s.ParamGenerator(t,e,n,!0,!0)),l=L.getSheets(),g=L.getRanges(),C=L.getActiveCell(),v={RID:e,sheetList:l,rangeList:g,activeCell:C,action:i,VERSION:n},O=new I(i,v),T=JSUtil.fn.getIndexOf(c,l),D=g[T];a.publish(E.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:c,VERSION:n});var u=new A;u.addEventListeners("onAcknowledge",function(){a.publish(E.Listener,R.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:c,VERSION:n,ACTION:i,RANGELIST:D})}),u.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(O)}),u.addEventListeners("onError",function(e){a.publish(E.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(d.FORMAT_MODIFY),o.data.UserInfo.registerForRepeat(u,O),u.send(v)}function i(e,t,n){var i=S.CLEARCONTENTS,r=(o.data.getWorkBook(e,n),o.view.getActiveGridID()),c=o.view.getSheetID(r),L=(o.view.getActiveState(r),new s.ParamGenerator(t,e,n,!0,!0)),l=L.getSheets(),g=L.getRanges(),C=L.getActiveCell();a.publish(E.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:c,VERSION:n});var v={RID:e,sheetList:l,rangeList:g,activeCell:C,action:i,VERSION:n},O=new I(i,v),T=JSUtil.fn.getIndexOf(c,l),D=g[T],u=new A;u.addEventListeners("onAcknowledge",function(){a.publish(E.Listener,R.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:c,VERSION:n,ACTION:i,RANGELIST:D})}),u.addEventListeners("onComplete",function(e){e.qaid;O.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(O)}),u.addEventListeners("onError",function(e){a.publish(E.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(d.FORMAT_MODIFY),o.data.UserInfo.registerForRepeat(u,O),u.send(v)}var o=e.sPlusPlus,r=e.ZSEvents,s=e.ZSClass,a=r.topic,E=r.Groups,R=r.Names,I=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),S=e.ZSConstants.ActionConstants,d=e.ZSConstants.URI,c=o.SML.Client,A=c.Utility.WorkerRequest,L=e.UserAction;L.CLEARALL=t,L.CLEARSTYLES=n,L.CLEARCONTENTS=i}(this);
!function(e){function t(t,n,i,s,r,a,c,g){if(0>s)return void I.log('Dimension "'+s+'" Less than Zero, RESIZE NOT POSSIBLE');var v=o.view.getActiveGridID(),A=o.view.getSheetID(v),L=r+a-1,T=new e.ZSClass.ParamGenerator(n,t,i,g,!0),u=T.getSheets(),N=new ZSClass.Range(r,0,L,l.MAX_COL-1),_=g?T.getRanges():T.getCustomRanges(N),w=T.getActiveCell(),c=c?c:!1,h={RID:t,sheetList:u,rangeList:_,activeCell:w,value:s,VERSION:i,ISOPTIMAL:c,action:C.HEIGHT},f=new O(C.HEIGHT,h,s);R.publish(E.Listener,S.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:A,VERSION:i});var p=new d;c||p.addEventListeners("onAcknowledge",function(){var e=JSUtil.fn.getIndexOf(A,u),n=_[e];R.publish(E.Listener,S.GridAction.CLIENTFIRSTACTIONS,{RID:t,SHEETID:A,ACTION:"RESIZEROW",VERSION:i,RANGELIST:n,VALUE:s})}),p.addEventListeners("onComplete",function(e){var t=e.qaid;f.qaid=t,o.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){R.publish(E.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(D.ROW_HEADERS_RESIZE),o.data.UserInfo.registerForRepeat(p,f),p.send(h)}function n(t,n,i,s){var r=new e.ZSClass.ParamGenerator(n,t,i,!0,!0),a=r.getSheets(),s=r.getCustomRanges(s,!0),I=r.getActiveCell(),c={RID:t,sheetList:a,activeCell:I,action:C.INSERT_ROW,rangeList:s,VERSION:i},l=o.view.getActiveGridID(),g=o.view.getSheetID(l),v=o.view.getSheetState(l,g),A=v.getRanges();A=r.getCustomRanges(A,!0);var L={RID:t,sheetList:a,activeCell:I,action:C.INSERT_ROW,rangeList:A,VERSION:i};R.publish(E.Listener,S.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:g,VERSION:i});var T=new O(C.INSERT_ROW,L),u=new d;u.addEventListeners("onComplete",function(e){R.publish(E.Selector.ReDraw,S.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:i,qaid:e.qaid}),T.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(T)}),u.addEventListeners("onError",function(e){R.publish(E.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(D.ROW_HEADERS_INSERT),o.data.UserInfo.registerForRepeat(u,T),u.send(c)}function i(t,n,i,s){var r=new e.ZSClass.ParamGenerator(n,t,i,!0,!0),a=r.getSheets(),s=r.getCustomRanges(s,!0),I=r.getActiveCell(),c={RID:t,sheetList:a,action:C.DELETE_ROW,rangeList:s,activeCell:I,VERSION:i},l=o.view.getActiveGridID(),v=o.view.getSheetID(l);R.publish(E.Listener,S.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:v,VERSION:i});var A=new O(C.DELETE_ROW,c),L=new d;L.addEventListeners("onComplete",function(e){R.publish(E.Selector.ReDraw,S.Selection.BOUND_UPDATE.SHIFT.ONDELETE,{RID:t,VERSION:i,qaid:e.qaid}),A.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(A)}),L.addEventListeners("askConfirm",function(e){var t=new ZSClass.ZSConfirm(JSUtil.fn.replaceParams(g[e.mk],new Array(e.mc+"")));t.onYES(function(){L.resend()});var n=t.execute();R.publish(E.Listener,S.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),L.addEventListeners("onError",function(e){R.publish(E.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(D.ROW_HEADERS_DELETE),o.data.UserInfo.registerForRepeat(L,A),L.send(c)}function s(t,n,i,s,r,a){var I=new e.ZSClass.ParamGenerator(n,t,i,!0,!0),c=I.getSheets(),s=I.getCustomRanges(s,!0);a&&(a=I.getCustomRanges(a,!0));var l=I.getActiveCell(),g={RID:t,rangeList:s,isDragDrop:r,action:C.INSERT_CUT_ROW,activeCell:l,VERSION:i,sheetList:c,srcRangeList:a},v=new O(C.INSERT_CUT_ROW,g),A=new d,L=o.view.getActiveGridID(),T=o.view.getSheetID(L);R.publish(E.Listener,S.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:T,VERSION:i}),A.addEventListeners("onComplete",function(e){R.publish(E.Selector.ReDraw,S.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:i,qaid:e.qaid}),v.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("onError",function(e){R.publish(E.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(D.ROW_HEADERS_INSERT_CUT),A.send(g)}function r(t,n,i,s,r){var a=new e.ZSClass.ParamGenerator(n,t,i,!0,!0),I=a.getSheets(),s=a.getCustomRanges(s,!0),c=a.getActiveCell(),l={RID:t,rangeList:s,sheetList:I,activeCell:c,action:C.INSERT_COPY_ROW,isSameSheet:r,VERSION:i},g=new O(C.INSERT_COPY_ROW,l),v=new d,A=o.view.getActiveGridID(),L=o.view.getSheetID(A);R.publish(E.Listener,S.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:L,VERSION:i}),v.addEventListeners("onComplete",function(e){R.publish(E.Selector.ReDraw,S.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:i,qaid:e.qaid}),g.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(g)}),v.addEventListeners("onError",function(e){R.publish(E.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(D.ROW_HEADERS_INSERT_COPY),v.send(l)}var o=e.sPlusPlus,a=e.ZSEvents,R=a.topic,E=a.Groups,S=a.Names,I=e.ZSDevTools.Logger,c=o.SML.Client,l=o.data.Defaults,d=c.Utility.WorkerRequest,O=e.ZSClass.ActionObject,C=e.ZSConstants.ActionConstants,D=(ZSClass.SelectorHelper.Constants,e.ZSConstants.URI),g=ZSConstants.I18N;e.UserAction.ResizeRow=t,e.UserAction.InsertRow=n,e.UserAction.DeleteRow=i,e.UserAction.InsertCutRow=s,e.UserAction.InsertCopyRow=r}(this);
!function(e){function t(e,t,n,i,r,s,a,d){var g=o.view.getActiveGridID(),v=o.view.getSheetID(g);if(R.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:v,VERSION:n}),0>i)return void l.log('Dimension "'+i+'" Less than Zero, RESIZE NOT POSSIBLE');var g=o.view.getActiveGridID(),v=o.view.getSheetID(g),a=a?a:!1,A=r+s-1,T=new E.ParamGenerator(t,e,n,d,!0),u=T.getSheets(),N=new E.Range(0,r,c.MAX_ROW-1,A),_=d?T.getRanges():T.getCustomRanges(N),U=T.getActiveCell(),h={RID:e,value:i,sheetList:u,rangeList:_,activeCell:U,VERSION:n,action:O.WIDTH,ISOPTIMAL:a},p=new D(O.WIDTH,h,i);R.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:v,VERSION:n});var f=new C;a||f.addEventListeners("onAcknowledge",function(){var t=JSUtil.fn.getIndexOf(v,u),r=_[t];R.publish(S.Listener,I.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:v,VERSION:n,ACTION:"RESIZECOL",RANGELIST:r,VALUE:i})}),f.addEventListeners("onComplete",function(e){var t=e.qaid;p.qaid=t,o.data.UserInfo.ActionRecorder.record(p)}),f.addEventListeners("onError",function(e){R.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(L.COLUMN_HEADERS_RESIZE),o.data.UserInfo.registerForRepeat(f,p),f.send(h)}function n(e,t,n,i){var r=o.view.getActiveGridID(),s=o.view.getSheetID(r);R.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:s,VERSION:n});var a=new E.ParamGenerator(t,e,n,!0,!0),c=a.getSheets(),i=a.getCustomRanges(i,!0),l=a.getActiveCell(),d={RID:e,rangeList:i,action:O.INSERT_COL,activeCell:l,VERSION:n,sheetList:c},g=new D(O.INSERT_COL,d),v=new C;v.addEventListeners("onComplete",function(t){R.publish(S.Selector.ReDraw,I.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:e,VERSION:n,qaid:t.qaid}),g.qaid=t.qaid,o.data.UserInfo.ActionRecorder.record(g)}),v.addEventListeners("onError",function(e){R.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(L.COLUMN_HEADERS_INSERT),o.data.UserInfo.registerForRepeat(v,g),v.send(d)}function i(e,t,n,i){var r=o.view.getActiveGridID(),s=o.view.getSheetID(r);R.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:s,VERSION:n});var a=new E.ParamGenerator(t,e,n,!0,!0),c=a.getSheets(),i=a.getCustomRanges(i,!0),l=a.getActiveCell(),d={RID:e,sheetList:c,activeCell:l,action:O.DELETE_COL,rangeList:i,VERSION:n},v=new D(O.DELETE_COL,d),A=new C;A.addEventListeners("onComplete",function(t){R.publish(S.Selector.ReDraw,I.Selection.BOUND_UPDATE.SHIFT.ONDELETE,{RID:e,qaid:t.qaid}),v.qaid=t.qaid,o.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("askConfirm",function(e){var t=new E.ZSConfirm(JSUtil.fn.replaceParams(g[e.mk],new Array(e.mc+"")));t.onYES(function(){A.resend()});var n=t.execute();R.publish(S.Listener,I.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),A.addEventListeners("onError",function(e){R.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(L.COLUMN_HEADERS_DELETE),o.data.UserInfo.registerForRepeat(A,v),A.send(d)}function r(e,t,n,i,r,s){var a=o.view.getActiveGridID(),c=o.view.getSheetID(a);R.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:c,VERSION:n});var l=new E.ParamGenerator(t,e,n,!0,!0),d=l.getSheets(),i=l.getCustomRanges(i,!0);s&&(s=l.getCustomRanges(s,!0));var g=l.getActiveCell(),v={RID:e,rangeList:i,srcRangeList:s,action:O.INSERT_CUT_COLUMN,activeCell:g,sheetList:d,VERSION:n,isDragDrop:r},A=new D(O.INSERT_CUT_COLUMN,v),T=new C;T.addEventListeners("onComplete",function(t){R.publish(S.Selector.ReDraw,I.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:e,qaid:t.qaid}),A.qaid=t.qaid,o.data.UserInfo.ActionRecorder.record(A)}),T.addEventListeners("onError",function(e){R.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(L.COLUMN_HEADERS_INSERT_CUT),T.send(v)}function s(e,t,n,i,r){var s=o.view.getActiveGridID(),a=o.view.getSheetID(s);R.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:a,VERSION:n});var c=new E.ParamGenerator(t,e,n,!0,!0),l=c.getSheets(),i=c.getCustomRanges(i,!0),d=c.getActiveCell(),g={RID:e,rangeList:i,activeCell:d,action:O.INSERT_COPY_COLUMN,sheetList:l,isSameSheet:r,VERSION:n},v=new D(O.INSERT_COPY_COLUMN,g),A=new C;A.addEventListeners("onComplete",function(t){R.publish(S.Selector.ReDraw,I.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:e,qaid:t.qaid}),v.qaid=t.qaid,o.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("onError",function(e){R.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(L.COLUMN_HEADERS_INSERT_COPY),A.send(g)}var o=e.sPlusPlus,a=e.ZSEvents,E=e.ZSClass,R=a.topic,S=a.Groups,I=a.Names,c=o.data.Defaults,l=e.ZSDevTools.Logger,d=o.SML.Client,C=d.Utility.WorkerRequest,D=e.ZSClass.ActionObject,O=e.ZSConstants.ActionConstants,L=(E.SelectorHelper.Constants,e.ZSConstants.URI),g=ZSConstants.I18N;e.UserAction.DeleteCol=i,e.UserAction.ResizeCol=t,e.UserAction.InsertCol=n,e.UserAction.InsertCutCol=r,e.UserAction.InsertCopyCol=s}(this);
!function(e){function t(e,t,n,o){var r,i=new E.ParamGenerator(n,t,o,!0,!0),s=i.getSheets(),c=i.getRanges(),f=i.getActiveCell();"left"===e?r=C.INSERT_CELL_LEFT:"top"===e&&(r=C.INSERT_CELL_TOP);var u={RID:t,sheetList:s,activeCell:f,VERSION:o,rangeList:c,action:r},O=new d(r,u),g=new L;g.addEventListeners("onComplete",function(e){l.publish(R.Selector.ReDraw,S.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:o,qaid:e.qaid}),O.qaid=e.qaid,a.data.UserInfo.ActionRecorder.record(O)}),g.addEventListeners("onError",function(e){l.publish(R.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(I.CELL_INSERT),a.data.UserInfo.registerForRepeat(g,O),g.send(u)}function n(e,t,n,o){var r,i=new E.ParamGenerator(n,t,o,!0,!0),s=i.getSheets(),c=i.getRanges(),u=i.getActiveCell();"right"===e?r=C.DELETE_CELL_RIGHT:"bottom"===e&&(r=C.DELETE_CELL_BOTTOM);var O={RID:t,sheetList:s,activeCell:u,rangeList:c,VERSION:o,action:r},g=new d(r,O),T=new L;T.addEventListeners("onComplete",function(e){l.publish(R.Selector.ReDraw,S.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:t,VERSION:o,qaid:e.qaid}),g.qaid=e.qaid,a.data.UserInfo.ActionRecorder.record(g)}),T.addEventListeners("askConfirm",function(e){var t=new E.ZSConfirm(JSUtil.fn.replaceParams(f[e.mk],new Array(e.mc+"")));t.onYES(function(){T.resend()});var n=t.execute();l.publish(R.Listener,S.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),T.addEventListeners("onError",function(e){l.publish(R.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(I.CELL_DELETE),a.data.UserInfo.registerForRepeat(T,g),T.send(O)}function o(e,n,o){t("left",e,n,o)}function r(e,n,o){t("top",e,n,o)}function i(e,t,o){n("right",e,t,o)}function s(e,t,o){n("bottom",e,t,o)}var a=e.sPlusPlus,c=e.ZSEvents,E=e.ZSClass,l=c.topic,R=c.Groups,S=c.Names,L=a.SML.Client.Utility.WorkerRequest,d=e.ZSClass.ActionObject,C=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,f=ZSConstants.I18N;e.UserAction.InsertCellLeft=o,e.UserAction.InsertCellTop=r,e.UserAction.DeleteCellBottom=s,e.UserAction.DeleteCellRight=i}(this);
!function(e){function t(e,t,n){var r={rID:e,VERSION:t,zuid:n},u=new E;u.addEventListeners("onComplete",function(t){var n=s.data.getSharePublishMeta(e),r=n.getShareMeta(),u=r.getSharedUserInfo();u.add(t.usr),i.publish(o.Listener,a.DocAction.COLLAB_LIST.ADDUSERINFO,{COLLABJSON:t.usr})}),u.addEventListeners("onError",function(){}),u.open(d.GET_NEWLY_ADDED_USER),u.send(r)}var s=e.sPlusPlus,n=e.UserAction,r=e.ZSEvents,i=r.topic,o=r.Groups,a=r.Names,u=e.ZSConstants,d=u.URI,S=s.SML.Client,E=S.Utility.WorkerRequest;n.getNewlyAddedUserDetails=t}(this);
!function(e){function n(e,n,t){var s={RID:e,VERSION:n,SORT_VAL:"modifydes",FILTER_VAL:"all"},E=new T;E.addEventListeners("onComplete",function(e){t(e)}),E.open(i.GET_TEMPLATES),E.send(s)}function t(e,n,t,s){var E={RID:e,VERSION:n,NEW_DOC_NAME:t},o=new T;o.addEventListeners("onComplete",function(e){s(e)}),o.open(i.USE_TEMPLATE),o.send(E)}function s(e,n,t){var s={RID:e,VERSION:n,NEW_DOC_NAME:t},E=new T;E.open(i.RENAME_TEMPLATE),E.send(s)}function E(e,n){var t={RID:e,VERSION:n},s=new T;s.open(i.DELETE_TEMPLATE),s.send(t)}var o=e.sPlusPlus,i=(e.ZSEvents,e.ZSClass,e.ZSConstants.ActionConstants,e.ZSClass.ActionObject,e.ZSConstants.URI),a=o.SML.Client,T=a.Utility.WorkerRequest;e.UserAction.renameTemplate=s,e.UserAction.deleteTemplate=E,e.UserAction.useTemplate=t,e.UserAction.getMyTemplates=n}(this);
!function(e){function t(e,t,s,i){A.publish(E.Selector.BoundUpdate.Range,I.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:s,RANGE:i})}function s(e,t,s,i,n,l){A.publish(E.Selector.BoundUpdate.Cell,I.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:s,ActiveCellRange:i,ROW:n,COL:l})}function i(e,i,n,l,r,a){var c=new o.Range(r.row,r.col,r.row,r.col),S=r.row,A=r.col,E=!1;i!=n&&(UserAction.SwitchSheet(e,i,l,n,c),E=!0),E||((a==N.FIND_IN_SHEET||a==N.FIND_IN_WORKBOOK)&&t(e,n,l,c),s(e,n,l,c,S,A),UserAction.ScrollCellIntoView(e,n,l,S,A))}function n(t,s,n,o,r,S,C,h,L,O,p,F){var d,T=a.data.getWorkBook(t,o),g=new e.ZSClass.ParamGenerator(n,t,o,!0,!0),v=g.getSheets(),w=g.getRanges(),V=g.getActiveCell(),b=V.s,_=V.r,f=V.c;L==N.FIND_IN_ROW?d=new U(_,0,_,D-1):L==N.FIND_IN_COL&&(d=new U(0,f,u-1,f)),d&&(w=g.getCustomRanges(d,!1)),O&&(_=O.row,f=O.col,b=T.SheetList.getIdByName(O.sheet));var M={RID:t,sheetList:v,rangeList:w,activeCell:V,VERSION:o,value:r,isNext:S,isCaseSensitive:C,isExactMatch:h,getNoOfMatch:F,traverseMode:L},P=new R;P.addEventListeners("onComplete",function(e){if(A.publish(E.Listener,I.CellAction.VALUE.FIND.STATUS,{STATUS:1,RESPONSE:e}),-1===e.row||-1===e.col)return A.publish(E.Listener,I.CellAction.VALUE.FIND.SHOWERRORMSG,{ERRORMSG:"CannotFindSearch#"+r}),p&&A.publish(E.Listener,I.CellAction.VALUE.FIND.FOCUSQUICKFIND),void(p&&A.publish(E.Listener,I.CellAction.VALUE.FIND.QUICKCOUNTUPDATE,{resp:e,isNext:S}));var n=T.SheetList.getIdByName(e.sheet);n&&(i(t,s,n,o,e,L),n==b&&S&&l.hash(_,f,D)>=l.hash(e.row,e.col,D)&&A.publish(E.Listener,I.CellAction.VALUE.FIND.WRAP,{isEOS:1}),n==b&&!S&&l.hash(_,f,D)<=l.hash(e.row,e.col,D)&&A.publish(E.Listener,I.CellAction.VALUE.FIND.WRAP,{isEOS:0}),p&&A.publish(E.Listener,I.CellAction.VALUE.FIND.FOCUSQUICKFIND),p&&A.publish(E.Listener,I.CellAction.VALUE.FIND.QUICKCOUNTUPDATE,{resp:e,isNext:S}))}),P.addEventListeners("onError",function(e){A.publish(E.Listener,I.CellAction.VALUE.FIND.STATUS,{STATUS:0}),A.publish(E.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(c.FIND),P.send(M)}var l=e.JSUtil.Math,o=e.ZSClass,r=e.ZSConstants,a=e.sPlusPlus,c=r.URI,S=e.ZSEvents,A=S.topic,E=S.Groups,I=S.Names,N=r.ActionConstants,U=o.Range,C=a.SML.Client,R=C.Utility.WorkerRequest,h=a.data.Defaults,D=h.MAX_COL,u=h.MAX_ROW;e.UserAction.Find=n}(this);
!function(e){function t(t,n,i,l,d,u,v,L,A,S){var g,p=(s.data.getWorkBook(t,l),s.view.getActiveGridID()),f=new e.ZSClass.ParamGenerator(i,t,l,!0,!0),m=f.getSheets(),h=f.getRanges(),P=f.getActiveCell(),w=P.r,O=P.c,I=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],U=function(e){g=e[w][O].Formula},M=function(t){e.ZSClass.Logger.log("Couldn't retrieve Content",t)};s.view.fetchCellData(t,P.s,l,w,O,I,p,U,M);var Z;if(g&&(Z=g.search(L?d:new RegExp(d,"i"))),-1==Z)UserAction.Find(t,n,i,l,d,v,L,A,S);else{var k={RID:t,sheetList:m,rangeList:h,activeCell:P,value:d,replaceString:u,isNext:v,isCaseSensitive:L,isExactMatch:A,VERSION:l,traverseMode:S,action:R.REPLACE},G=new C(R.REPLACE,k),q=new c;q.addEventListeners("onComplete",function(e){G.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(G),UserAction.Find(t,n,i,l,d,v,L,A,S)}),q.addEventListeners("onError",function(e){a.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),q.open(E.REPLACE),q.send(k)}}function n(t,n,i,l,d,u,v,L,A){var S=new e.ZSClass.ParamGenerator(n,t,i,!0,!0),g=S.getSheets(),p=S.getRanges(),f=S.getActiveCell(),m={RID:t,sheetList:g,rangeList:p,activeCell:f,value:l,replaceString:d,isNext:u,isCaseSensitive:v,isExactMatch:L,VERSION:i,traverseMode:A,action:R.REPLACE_ALL},h=new C(R.REPLACE_ALL,m),P=new c;P.addEventListeners("onComplete",function(e){h.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(h)}),P.addEventListeners("onError",function(e){a.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(E.REPLACE_ALL),P.send(m)}var s=e.sPlusPlus,i=e.ZSEvents,a=i.topic,r=i.Groups,o=i.Names,l=s.SML.Client,c=l.Utility.WorkerRequest,R=e.ZSConstants.ActionConstants,C=e.ZSClass.ActionObject,E=e.ZSConstants.URI;e.UserAction.Replace=t,e.UserAction.ReplaceAll=n}(this);
!function(e){function n(e,n,t,o,r){var E=new ZSClass.ParamGenerator([n],e,t,!1,!1),s=E.getSheets(),T=E.getActiveCell(),i={RID:e,SHEETID:n,VERSION:t,BUTTON:o,SHEETLIST:s,ACTIVECELL:T},S=new C;S.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),S.addEventListeners("onComplete",function(o){r&&r(e,n,t,o)}),S.open(d.BUTTON_ADD),S.send(i)}function t(e,n,t,o,r){var E=new ZSClass.ParamGenerator([n],e,t,!1,!1),s=E.getSheets(),T=E.getActiveCell(),i={RID:e,SHEETID:n,VERSION:t,BUTTON:r,ID:o,SHEETLIST:s,ACTIVECELL:T},S=new C;S.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),S.addEventListeners("onComplete",function(){}),S.open(d.BUTTON_RESIZE),S.send(i)}function o(e,n,t,o,r){var E=new ZSClass.ParamGenerator([n],e,t,!1,!1),s=E.getSheets(),T=E.getActiveCell(),i={RID:e,SHEETID:n,VERSION:t,BUTTON:r,ID:o,SHEETLIST:s,ACTIVECELL:T},S=new C;S.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),S.addEventListeners("onComplete",function(){}),S.open(d.BUTTON_MOVE),S.send(i)}function r(e,n,t,o){var r=new ZSClass.ParamGenerator([n],e,t,!1,!1),E=r.getSheets(),s=r.getActiveCell(),T={RID:e,SHEETID:n,VERSION:t,ID:o,SHEETLIST:E,ACTIVECELL:s},i=new C;i.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),i.addEventListeners("onComplete",function(){}),i.open(d.BUTTON_DELETE),i.send(T)}function E(e,n,t,o,r){var E=new ZSClass.ParamGenerator([n],e,t,!1,!1),s=E.getSheets(),T=E.getActiveCell(),i={RID:e,SHEETID:n,VERSION:t,BUTTON:r,ID:o,SHEETLIST:s,ACTIVECELL:T},S=new C;S.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),S.addEventListeners("onComplete",function(){}),S.open(d.BUTTON_SETCAPTION),S.send(i)}function s(e,n,t,o,r){var E=new ZSClass.ParamGenerator([n],e,t,!1,!1),s=E.getSheets(),T=E.getActiveCell(),i=r.getScript(),S=i.toString(),I={RID:e,SHEETID:n,VERSION:t,ID:o,MACRO:S,SHEETLIST:s,ACTIVECELL:T},l=new C;l.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),l.addEventListeners("onComplete",function(){}),l.open(d.BUTTON_ASSIGNMACRO),l.send(I)}function T(e,n,t,o,r){var E=new ZSClass.ParamGenerator([n],e,t,!1,!1),s=E.getSheets(),T=E.getActiveCell(),i=o.getScript();i&&(i=i.toString());var S={RID:e,SHEETID:n,VERSION:t,BUTTON:o,MACRO:i,SHEETLIST:s,ACTIVECELL:T},I=new C;I.addEventListeners("onError",function(e){a.log("Add Button error:",e)}),I.addEventListeners("onComplete",function(o){r&&r(e,n,t,o)}),I.open(d.BUTTON_CLONE),I.send(S)}var i=e.sPlusPlus,S=e.UserAction,a=e.ZSDevTools.Logger,d=e.ZSConstants.URI,C=i.SML.Client.Utility.WorkerRequest;S.AddButton=n,S.ResizeButton=t,S.MoveButton=o,S.DeleteButton=r,S.SetCaptionButton=E,S.SetMacroButton=s,S.CloneButton=T}(this);
!function(t){function e(e,n,s,r){var u=new t.ZSClass.ParamGenerator(n,e,s,!1),L=u.getSheets(),l={sheetList:L,VERSION:s,action:c.RECALCULATE,RID:e},S=(new C(c.RECALCULATE,l),new R);S.addEventListeners("onComplete",function(t){r&&r(t)}),S.addEventListeners("onError",function(t){o.publish(i.Listener,a.ERROR.SHOW,{ERRORMSG:t.mk})}),S.open(E.RECALCULATE),S.send(l)}var n=t.sPlusPlus,s=t.ZSEvents,o=s.topic,i=s.Groups,a=s.Names,r=n.SML.Client,R=r.Utility.WorkerRequest,c=t.ZSConstants.ActionConstants,C=t.ZSClass.ActionObject,E=t.ZSConstants.URI;t.UserAction.Recalculate=e}(this);
!function(e){function t(t,n,o,C,l,S){var L=e.encodeURIComponent,N=s.data.getWorkBook(t,o),T=N.getSheetObj(n[0]).Prop.Name;if(!S){var M=s.view.getActiveGridID(),d=s.view.getSheetState(M,n[0]);S=d.getActiveCellRange()}var g=new i.ParamGenerator(n,t,o),v=g.getSheets(),A=g.getCustomRanges(S),D=g.getActiveCell(),M=s.view.getActiveGridID(),u=s.view.getSheetID(M);a.publish(E.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:u,VERSION:o});var h={RID:t,sheetList:v,sheetName:T,rangeList:A,activeCell:D,VERSION:o,subMode:C,comment:L(l),action:R.CELL_COMMENT},m=new c(R.CELL_COMMENT,h),p=new O;p.addEventListeners("onAcknowledge",function(){switch(a.publish(E.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:t,SHEETID:u,VERSION:o,ACTION:R.CELL_COMMENT,RANGELIST:[S],VALUE:C}),C){case"remove":a.publish(E.Listener,r.CellAction.COMMENT.DELETE,{RID:t,SHEETID:u,VERSION:o,ROW:S.startRow,COL:S.startCol});break;case"add":a.publish(E.Listener,r.CellAction.COMMENT.ADD,{RID:t,SHEETID:u,VERSION:o,ROW:S.startRow,COL:S.startCol,COMMENT:[l]})}}),p.addEventListeners("onComplete",function(){s.data.UserInfo.ActionRecorder.record(m)}),p.addEventListeners("onError",function(e){a.publish(E.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(I.CELL_COMMENT),p.send(h)}function n(t,n,o,C,l,c,S){var L=new i.ParamGenerator([n],t,o),N=L.getSheets(),T=new i.Range(C,l,C,l),M=L.getCustomRanges(T),d=L.getActiveCell(),g=s.data.getWorkBook(t,o),v=g.getSheetObj(n).Prop.Name,A={RID:t,SHEETID:n,VERSION:o,ROW:C,COL:l,X:c,Y:S,WIDTH:180,HEIGHT:70,action:R.RESET_ANNOTE_POSITION,sheetList:N,sheetName:v,rangeList:M,activeCell:d},D=new O;D.addEventListeners("onComplete",function(){var i=s.data.getWorkBook(t,o),O=i.getSheetObj(n),R=s.data.Defaults.MAX_COL,I=e.JSUtil.Math.hash(C,l,R),L=O.Notes.get(I),N=[L.value,c,S];a.publish(E.Listener,r.CellAction.COMMENT.ADD,{RID:t,SHEETID:n,VERSION:o,ROW:C,COL:l,COMMENT:N})}),D.open(I.MOVE_CELL_COMMENT),D.send(A)}var s=e.sPlusPlus,o=e.ZSEvents,i=e.ZSClass,a=o.topic,E=o.Groups,r=o.Names,C=e.ZSConstants,l=(C.I18N,s.SML.Client),O=l.Utility.WorkerRequest,c=e.ZSClass.ActionObject,R=C.ActionConstants,I=C.URI;e.UserAction.CellComment=t,e.UserAction.MoveCellComment=n}(this);
!function(e){function t(e,t,n,i,o){var r=(s.data.getWorkBook(e,n),s.view.getActiveGridID()),A=s.view.getSheetID(r),R=s.view.getActiveState(r),d=new a.ParamGenerator(t,e,n,!0,!0),O=d.getSheets(),D=d.getRanges(),u=d.getActiveCell(),g=R.getFormatPainterState(),v={RID:e,sheetList:O,rangeList:D,activeCell:u,action:i,VERSION:n,value:o},L=new S(i,v,o),T=JSUtil.fn.getIndexOf(A,O),U=D[T];E.publish(c.Listener,C.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:n});var f=new l;f.addEventListeners("onAcknowledge",function(){E.publish(c.Listener,C.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:n,ACTION:i,RANGELIST:U,VALUE:o})}),f.addEventListeners("onComplete",function(t){t.qaid;g&&E.publish(c.Selector.BoundUpdate.Copy,C.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:A}),L.qaid=t.qaid,s.data.UserInfo.ActionRecorder.record(L)}),f.addEventListeners("onError",function(e){E.publish(c.Listener,C.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(I.FORMAT_MODIFY),s.data.UserInfo.registerForRepeat(f,L),f.send(v)}function n(e,n,i,o,s,r,a,E){t(e,n,i,A.CHECKBOX_EDIT,o,s,r,a,E)}function i(e,n,i,o,s,r,a){t(e,n,i,A.CHECKBOX_ADD,o,s,r,a)}function o(e,n,i,o,s,r,a){t(e,n,i,A.CHECKBOX_CLEAR,o,s,r,a)}{var s=e.sPlusPlus,r=e.ZSEvents,a=e.ZSClass,E=r.topic,c=r.Groups,C=r.Names,S=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),A=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,R=s.SML.Client,l=R.Utility.WorkerRequest;e.UserAction}e.UserAction.CHECKBOX_EDIT=n,e.UserAction.CHECKBOX_ADD=i,e.UserAction.CHECKBOX_CLEAR=o}(this);
!function(e){function t(e,t,s,g,S,R){var c=new ZSClass.ParamGenerator(t,e,s,!0,!0),d=c.getSheets(),C=c.getRanges(),A=c.getActiveCell(),E=i.view.getActiveGridID(),u=i.view.getSheetState(E,A.s),v=u.getActiveRange(),w=v.isSingle(),I="COUNTA"===g||"COUNT"===g,U=w?a.ALT_EQUAL_RANGE:a.COMPUTE_SUM,L={rid:e,sheetList:d,VERSION:s,rangeList:C,isRangeSingle:w,range:v,activeCell:A,includeString:I,functionName:g,action:U},O=new l;O.addEventListeners("onError",function(e){r.log("AggregateFunctionAction error :",e)}),O.addEventListeners("onComplete",function(t){n(e,c.getActiveSheet(),s,g,t,S,R)}),O.open(o.AUTO_SUM),O.send(L)}function n(e,t,n,s,o,a,r){var l,g,C=i.view.getActiveGridID(),A=i.view.getSheetState(C,t),E=i.data.getWorkBook(e,n),u=E.getSheetObj(t);if(o.startRow>=0&&o.startCol>=0){g=new d(o.startRow,o.startCol,o.endRow,o.endCol);{var v;u.DataFilters}g.isColRange()?(v=u.Row.Visibility,(v.isHidden(g.startRow)||v.nextHidden(g.startRow)<g.endRow)&&(l=r,s=a)):(v=u.Column.hidden,(v.isHidden(g.startCol)||v.nextHidden(g.startCol)<g.endCol)&&(l=r,s=a))}S.publish(R.Listener,c.CellAction.VALUE.SET,{RID:e,SHEETID:t,VERSION:n,ROW:A.getActiveRow(),COL:A.getActiveCol(),VALUE:{DisplayValue:""},FOCUS:!0}),S.publish(R.Listener,"InsertFunction",{RID:e,SHEETID:t,VERSION:n,FUNCTION:s,ARGS:l}),!!g&&S.publish(R.Listener,c.RangePicker.Update,{RID:e,SHEETID:t,VERSION:n,RANGE:g})}var i=e.sPlusPlus,s=i.SML.Client,o=e.ZSConstants.URI,a=e.ZSConstants.ActionConstants,r=e.ZSDevTools.Logger,l=s.Utility.WorkerRequest,g=e.ZSEvents,S=g.topic,R=g.Groups,c=g.Names,d=ZSClass.Range;UserAction.aggregateFunctions=t}(this);
!function(e){function t(e,t,n){var E=(u.data.getWorkBook(e,n),C.activeInfo.getVisualCueStatus()),o=u.view.getActiveGridID(),r=u.view.getSheetID(o),S=u.view.getActiveState(o),i=S.getFormulaState();t===r&&(_.publish(v.Selector.BoundUpdate.Cell,f.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:n}),E&&_.publish(v.Selector.BoundUpdate.Copy,f.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:n,VisualCueStatus:A.CUESTATUS.VISIBLE}),_.publish(v.Selector.BoundUpdate.Range,f.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:n}),_.publish(v.Selector.BoundUpdate.CellEdit,f.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:n}),_.publish(v.Selector.BoundUpdate.FillSeries,f.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:n}),_.publish(v.Listener,f.SheetAction.PROTECTED_RANGES.HIDE,{RID:e,SHEETID:t,VERSION:n}),i&&_.publish(v.Selector.BoundUpdate.Formula,f.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:n}))}function n(e,t,n,E,o,r,S){var i=new h.ParamGenerator(t,e,n,!0,!0),s=i.getSheets(),a={RID:e,sheetList:s,VERSION:n,INSERT:[[E,o]],isPivotSheet:r,USE_ACTIVE_SHEET_POS:S,action:m.SHEET_INSERT},R=new P(m.SHEET_INSERT,a),d=new N;d.addEventListeners("onComplete",function(t){_.publish(v.Listener,f.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:n,qaid:t.qaid,isPivotSheet:r}),R.qaid=t.qaid,u.data.UserInfo.ActionRecorder.record(R)}),d.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(w.WORKSHEETS_INSERT),d.send(a)}function E(e,n,E){var o=new h.ParamGenerator(n,e,E,!0,!0),r=o.getSheets(),S={RID:e,VERSION:E,sheetList:r,action:m.SHEET_REMOVE},i=new P(m.SHEET_REMOVE,S);t(e,n[0],E);var s=new N;s.addEventListeners("onComplete",function(e){i.qaid=e.qaid,u.data.UserInfo.ActionRecorder.record(i)}),s.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),s.open(w.WORKSHEETS_DELETE),s.send(S)}function o(e,t,n,E){var o=u.data.getWorkBook(e,n);if(o.SheetList.getPosById(t[0])!=E){var r=new h.ParamGenerator(t,e,n,!0,!0),S=r.getSheets(),i={RID:e,VERSION:n,sheetList:S,POSITION:E,action:m.SHEET_MOVE},s=new P(m.SHEET_MOVE,i),a=new N;a.addEventListeners("onComplete",function(e){s.qaid=e.qaid,u.data.UserInfo.ActionRecorder.record(s)}),a.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(w.WORKSHEETS_MOVE),a.send(i)}}function r(e,t,n,E){var o=u.data.getWorkBook(e,n),r=new h.ParamGenerator(t,e,n),S=r.getSheets(),i={RID:e,VERSION:n,sheetList:S,newSheetName:E,oldSheetName:o.SheetList.getById(t[0]).Name,action:m.SHEET_RENAME},s=new P(m.SHEET_RENAME,i),a=new N;a.addEventListeners("onComplete",function(e){s.qaid=e.qaid,u.data.UserInfo.ActionRecorder.record(s)}),a.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(w.WORKSHEETS_RENAME),a.send(i)}function S(e,t,n,E){var o=u.data.getWorkBook(e,n),r=new h.ParamGenerator(t,e,n,!0,!0),S=r.getSheets(),i={RID:e,sheetList:S,currSheetName:o.getSheetObj(t[0]).Prop.Name,TABCOLOR:E,VERSION:n,action:m.SHEET_TABCOLOR},s=new P(m.SHEET_TABCOLOR,i),a=new N;a.addEventListeners("onComplete",function(e){s.qaid=e.qaid,u.data.UserInfo.ActionRecorder.record(s)}),a.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(w.WORKSHEETS_TABCOLOR),a.send(i)}function i(e,t,n,E,o){var r=(u.data.getWorkBook(e,n),new h.ParamGenerator(t,e,n,!0,!0)),S=r.getSheets(),i={RID:e,VERSION:n,sheetList:S,sheetName:E,subMode:o,action:m.SHEET_COPY},s=new P(m.SHEET_COPY,i),a=new N;a.addEventListeners("onComplete",function(t){_.publish(v.Listener,f.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:n,qaid:t.qaid}),s.qaid=t.qaid,u.data.UserInfo.ActionRecorder.record(s)}),a.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(w.WORKSHEETS_COPYSHEET),a.send(i)}function s(e,t,n,E,o){var r=(u.data.getWorkBook(e,n),u.view.getActiveGridID()),S=new h.ParamGenerator(t,e,n,!0,!0),i=S.getSheets(),s=u.view.getSheetID(r),a={RID:e,sheetList:i,CURRENTSHEETID:s,SHEETNAME:E,VERSION:n,action:m.SERVERCLIP_PASTE_SHEET,isCopyRefSheets:o},R=new P(m.SERVERCLIP_PASTE_SHEET,a),d=new N;d.addEventListeners("onComplete",function(t){_.publish(v.Listener,f.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:n,qaid:t.qaid}),R.qaid=t.qaid,u.data.UserInfo.ActionRecorder.record(R)}),d.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(w.WORKSHEETS_PASTESHEET),d.send(a)}function a(e,t,n,E){var o=(u.data.getWorkBook(e,n),new h.ParamGenerator(t,e,n,!0,!0)),r=o.getSheets(),S={RID:e,sheetList:r,SHEETSTOCOPY:r[0],VERSION:n,SHEETNAME:E,action:m.SERVERCLIP_COPY_SHEET},i=p.fn.replaceParams(g["CopySheet.ProgressMessage"],[E]);T=new h.TBNotification(i,{mode:"STD",type:"info"}),T.show(!0);var s=(new P(m.SERVERCLIP_COPY_SHEET,S),new N);s.addEventListeners("onComplete",function(){T.remove();var e=g["CopyClip.SheetCopy.SuccessMsg"],t=new h.TBNotification(e,{type:"info"});t.show()}),s.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),s.open(w.WORKSHEETS_SERVERCOPYSHEET),s.send(S)}function R(e,t,n,E,o){var r=(u.data.getWorkBook(e,n),new h.ParamGenerator(t,e,n,!0,!0)),S=r.getSheets(),i={RID:e,sheetList:S,SHEETNAME:E,VERSION:n,isCopyRefSheets:o,action:m.SHEET_COPY_CREATE_NEW_SPREADSHEET},s=g["CopySheet.Create.New.Spreadsheet.ProgressMessage"];T=new h.TBNotification(s,{mode:"STD",type:"info"}),T.show(!0);var a=(new P(m.SHEET_COPY_CREATE_NEW_SPREADSHEET,i),new N);a.addEventListeners("onComplete",function(E){E.newRID&&_.publish(v.Listener,f.DocAction.WORKSHEETS.SERVERCOPYSHEET,{RID:e,VERSION:n,SHEETID:t[0],NEWRID:E.newRID}),T.remove()}),a.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(w.WORKSHEETS_COPY_TO_NEW_SPREADSHEET),a.send(i)}function d(e,t,n,E,o,r){var S=(u.data.getWorkBook(e,n),new h.ParamGenerator(t,e,n,!0,!0)),i=S.getSheets(),s={RID:e,sheetList:i,VERSION:n,copyLocks:o,insertAfter:r,action:m.SHEET_DUPLICATE},a=(new P(m.SHEET_DUPLICATE,s),new N);a.addEventListeners("onComplete",function(t){_.publish(v.Listener,f.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:n,qaid:t.qaid})}),a.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(w.DUPLICATE_SHEET),a.send(s)}function I(e,t,n){var E=new h.ParamGenerator(t,e,n,!0,!0),o=E.getSheets(),r={RID:e,SHEETLIST:o,VERSION:n,isHidden:!0,action:m.SHEET_VISIBLE},S=new N;S.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),S.open(w.HIDE_SHEET),S.send(r)}function O(e,t,n,E){var o=new h.ParamGenerator(t,e,n,!0,!0),r=o.getSheets(),S={RID:e,SHEETLIST:r,VERSION:n,isHidden:!1,action:m.SHEET_VISIBLE},i=new N;i.addEventListeners("onComplete",function(){E&&E(e,t[0],n)}),i.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})}),i.open(w.UNHIDE_SHEET),i.send(S)}function c(t,n,E,o,r){var S=u.data.getWorkBook(t,n),i=S.getSheetObj(E[0]).Prop.Name,s=(new e.ZSClass.ParamGenerator(E,t,n,!0,!0),u.view.getActiveGridID()),a=u.view.getSheetID(s),R=m.SERVERCLIP_GET_REFSHEETS,d={RID:t,VERSION:n,from:o,currentSheet:a,currentSheetName:i,action:R},I=new N;I.addEventListeners("onComplete",function(e){return e.refsheetList&&r(t,E,n,e.refsheetList,o),e.a&&e.a===m.SHOW_ERROR_MESSAGE?void Logger.log("COPY Error case has to be handled"):void 0}),I.addEventListeners("onError",function(e){_.publish(v.Listener,f.ERROR.SHOW,{ERRORMSG:e.mk})});var O=w.SERVERCLIP_GET_REFSHEETS;I.open(O),I.send(d)}var T,u=e.sPlusPlus,H=e.ZSConstants,h=e.ZSClass,L=e.ZSEvents,p=e.JSUtil,D=e.UserAction,l=u.SML.Client,C=u.data.UserInfo,N=l.Utility.WorkerRequest,_=L.topic,v=L.Groups,f=L.Names,P=h.ActionObject,m=H.ActionConstants,w=H.URI,A=h.SelectorHelper.Constants,g=H.I18N;D.InsertSheet=n,D.RemoveSheet=E,D.MoveSheet=o,D.RenameSheet=r,D.TabColorSheet=S,D.CopySheet=i,D.PasteSheet=s,D.serverClipCopySheet=a,D.serverClipCopytoNewSheet=R,D.DuplicateSheet=d,D.HideSheet=I,D.unHideSheet=O,D.CopyRefSheets=c}(this);
!function(e){function t(t,n,i,r,a,I,v){var g=s.view.getActiveGridID(),C=s.view.getSheetID(g),L=(s.view.getSheetState(g,p),new e.ZSClass.ParamGenerator(n,t,i)),T=L.getSheets(),O=new c.Range(a,I,a,I),D=L.getCustomRanges(O),O=L.getActiveCell(),U={RID:t,VERSION:i,sheetList:T,rangeList:D,activeCell:O,value:r,ISARRAYFORMULA:!1,validateDV:v},h=new d(E.SUBMIT,U),w=0,p=n[w],N=D[w],m=new l;p===C&&m.addEventListeners("onAcknowledge",function(){o.publish(S.Listener,R.GridAction.CLIENTFIRSTACTIONS,{RID:t,SHEETID:p,RANGELIST:N,ACTION:"SUBMIT",VERSION:i,VALUE:r})}),m.addEventListeners("onComplete",function(e){var t=e.qaid;h.qaid=t,s.data.UserInfo.ActionRecorder.record(h)}),m.addEventListeners("onError",function(e){o.publish(S.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),m.open(A.SUBMIT),m.send(U),p===C&&o.publish(S.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:p,VERSION:i}),o.publish(S.Selector.BoundUpdate.Copy,R.Selection.BOUND_UPDATE.HIDE,{RID:t,SHEETID:p,VERSION:i,VisualCueStatus:u.CUESTATUS.HIDDEN})}function n(t,n,i,r,a,I,u){var v=s.view.getActiveGridID(),g=s.view.getSheetID(v),C=(s.view.getSheetState(v,w),new e.ZSClass.ParamGenerator(n,t,i)),L=C.getSheets(),T=new c.Range(I,u,I,u),O=C.getCustomRanges(T),T=C.getActiveCell(),D={RID:t,VERSION:i,sheetList:L,rangeList:O,activeCell:T,value:r,ISARRAYFORMULA:!1};a&&"undefined"!==a&&(D.formatType=a);var U=new d(E.SUBMIT,D),h=0,w=n[h],p=O[h],N=new l;w===g&&N.addEventListeners("onAcknowledge",function(){o.publish(S.Listener,R.GridAction.CLIENTFIRSTACTIONS,{RID:t,SHEETID:w,RANGELIST:p,ACTION:"SUBMIT",VERSION:i,VALUE:r})}),N.addEventListeners("onComplete",function(e){var t=e.qaid;U.qaid=t,s.data.UserInfo.ActionRecorder.record(U)}),N.addEventListeners("onError",function(e){o.publish(S.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(A.SUBMIT),N.send(D),w===g&&o.publish(S.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:w,VERSION:i})}function i(t,n,i,r,a,I){var u=s.view.getActiveGridID(),v=s.view.getSheetID(u),g=s.view.getSheetState(u,v),C=new e.ZSClass.ParamGenerator(n,t,i),L=C.getSheets(),T=s.data.getWorkBook(t,i),O=T.getSheetObj(v),D=new c.Range(a,I,a,I);O.Merge.extendRange(D);var U,h=g.getActiveRange(),w=h.equals(D),p=O.ArrayFormula.isXists(a,I);U=w&&p?C.getCustomRanges(p.root.clone()):C.getRanges();var D=C.getActiveCell(),N={RID:t,VERSION:i,sheetList:L,rangeList:U,activeCell:D,value:r,ISARRAYFORMULA:!0},m=new d(E.SUBMIT,N),f=new l;f.addEventListeners("onComplete",function(e){var t=e.qaid;m.qaid=t,s.data.UserInfo.ActionRecorder.record(m)}),f.addEventListeners("onError",function(e){o.publish(S.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(A.SUBMIT),f.send(N)}var s=e.sPlusPlus,r=e.ZSConstants,a=e.ZSEvents,o=a.topic,S=a.Groups,R=a.Names,I=(e.JSUtil,r.I18N,s.SML.Client),l=I.Utility.WorkerRequest,E=r.ActionConstants,c=e.ZSClass,d=c.ActionObject,A=r.URI,u=c.SelectorHelper.Constants;e.UserAction.SubmitCell=t,e.UserAction.SubmitArrayFormula=i,e.UserAction.SubmitCellAlongWithPattern=n}(this);
!function(e){function t(e,t,a,s,i,E,I,O,v){"undefined"!=typeof o.data.isRecastAction&&o.data.isRecastAction&&(o.data.isRecastAction=!1);var f=(o.data.getWorkBook(e,a),o.view.getActiveGridID()),A=o.view.getSheetState(f,t[0]),T=new r.ParamGenerator(t,e,a,!0,!0),L=T.getSheets(),w=T.getCustomRanges(s),p=T.getActiveCell();if(n(e,T.getActiveSheet(),a,s),i&&E){var U=s.startRow,D=s.startCol,_=s.endRow,m=s.endCol;"TO_BOTTOM"===E&&(U+=i),"TO_TOP"===E&&(_-=i),"TO_RIGHT"===E&&(D+=i),"TO_LEFT"===E&&(m-=i);var F=new r.Range(U,D,_,m),h=T.getCustomRanges(F);I=A.getFillRange()?A.getFillRange():I;var G=new r.Range(I.startRow,I.startCol,I.endRow,I.endCol);I=T.getCustomRanges(G);var N={RID:e,sheetList:L,VERSION:a,isCtrlPressed:!!O,action:c.FILLSERIES,srcCount:i,rangeList:w,activeCell:p,fixedRange:I,wholeRange:h,fillDirection:E,type:v?v:"default"},H=new S(c.FILLSERIES,N);status=g.activeInfo.getVisualCueStatus();var P=new C;P.addEventListeners("onComplete",function(e){H.params.RANGES=[A.getActiveRange()],H.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(H)}),P.addEventListeners("onError",function(e){R.publish(l.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(u.FILL_SERIES),o.data.UserInfo.registerForRepeat(P,H),P.send(N)}}function a(e,a,n,s,o,i,r){if(s.endRow>o.endRow)var R="TO_BOTTOM",l=o.endRow-o.startRow+1;else if(s.startRow<o.startRow)var R="TO_TOP",l=o.endRow-o.startRow+1;else if(s.endCol>o.endCol)var R="TO_RIGHT",l=o.endCol-o.startCol+1;else if(s.startCol<o.startCol)var R="TO_LEFT",l=o.endCol-o.startCol+1;t(e,a,n,s,l,R,o,i,r)}function n(e,t,a,n){R.publish(l.Selector.BoundUpdate.Range,d.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:a,RANGE:n}),status&&R.publish(l.Selector.BoundUpdate.Copy,d.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:a,VisualCueStatus:I.CUESTATUS.HIDDEN})}function s(e,t,a,n){"undefined"!=typeof o.data.isRecastAction&&(o.data.isRecastAction=!1);var s=new r.ParamGenerator(t,e,a,!0,!0),i=s.getSheets(),E=s.getCustomRanges(n),I=s.getActiveCell(),O={RID:e,sheetList:i,rangeList:E,VERSION:a,activeCell:I,action:c.FILLSERIES_AUTO},v=new S(c.FILLSERIES_AUTO,O);status=g.activeInfo.getVisualCueStatus();var f=new C;f.addEventListeners("onComplete",function(e){v.params.RANGES=[n],v.qaid=e.qaid,o.data.UserInfo.ActionRecorder.record(v)}),f.addEventListeners("onError",function(e){R.publish(l.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(u.FILL_SERIES_AUTO),f.send(O)}var o=e.sPlusPlus,i=e.ZSEvents,r=e.ZSClass,R=i.topic,l=i.Groups,d=i.Names,r=e.ZSClass,c=e.ZSConstants.ActionConstants,S=r.ActionObject,u=e.ZSConstants.URI,E=o.SML.Client,C=E.Utility.WorkerRequest,I=r.SelectorHelper.Constants,g=o.data.UserInfo;e.UserAction.CalcFillDetails=a,e.UserAction.FillSeriesAuto=s}(this);
!function(e){function n(n,o){var t={RID:n,VERSION:o},R=l.REDIRECT_ROPEN,c=(new E(R,t),new d);c.addEventListeners("onComplete",function(n){if(n.isRemoved){var o=e.location.href.replace("/hopen/","/open/"),o=o.replace("/hopen.do","/ropen.do");window.location.href=o}}),c.addEventListeners("onError",function(e){i.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),c.open(a.REDIRECT_ROPEN),c.send(t)}var o=e.sPlusPlus,t=e.ZSEvents,i=t.topic,s=t.Groups,r=t.Names,R=e.ZSConstants,c=o.SML.Client,a=(c.Utility.WorkerRequest,R.URI),E=e.ZSClass.ActionObject,l=R.ActionConstants,d=c.Utility.WorkerRequest;e.UserAction.doRedirect=n}(this);
!function(e){function t(t,n,o,a,l,S){var p=s.data.getWorkBook(t,o),u=p.getSheetObj(n[0]).Prop.Name,d=new e.ZSClass.ParamGenerator(n,t,o),g=d.getSheets(),v=d.getRanges(),R=d.getActiveCell(),y=(c.activeInfo.getCopyState(),e.JSON.stringify(v)),A=e.JSON.stringify(g),f=e.JSON.stringify(R),m={params:["sheetList","activeCell","rangeList","isSolidCopy","isRequiredTabSeparatedValues","rid","ver","currSheetName"],paramVal:[A,f,y,l,S,t,"",u],URL:"useraction",action:r.SERVERCLIP_COPY_RANGE},L=new i.AjaxRequest(t,o);L.init(m,{async:!1}),L.addEventListener("onComplete",function(t){var s=JSON.parse(t.responseText),n=s[C.COPY_TO_CLIP],o=n[C.DATA];e.UserAction.CopyResponseHandling(o)}),L.addEventListener("onError",function(){}),L.sendRequest(),e.UserAction.Copy(t,n,o,void 0,!0,!0)}var s=e.sPlusPlus,n=e.ZSEvents,o=(n.topic,n.Groups,n.Names,e.ZSDevTools.Logger,e.ZSConstants),a=s.SML.Client,i=e.ZSClass,r=(a.Utility.WorkerRequest,o.ActionConstants),C=o.CommandConstants,c=(o.URI,s.data.UserInfo);e.UserAction.CopyToClipAction=t}(this);
!function(t){function e(t,e){this.request=t,this.actionObject=e}function s(t,e){c.setRequest(t),c.setActionObject(e)}function n(t,e,s){if(c.isRepeatPossible()){var n=(i.view.getActiveGridID(),new o.ParamGenerator(e,t,s,!0,!0)),r=n.getSheets(),a=n.getRanges(),u=n.getActiveCell(),g=c.getParams();g.hasOwnProperty("sheetList")&&(g.sheetList=r),g.hasOwnProperty("rangeList")&&(g.rangeList=a),g.hasOwnProperty("activeCell")&&(g.activeCell=u);var h=c.getRequest();h.send(g)}}var i=t.sPlusPlus,r=(t.ZSConstants.ActionConstants,t.UserAction),o=(t.ZSDevTools.Logger,t.ZSClass),a=i.data.UserInfo;e.prototype={setRequest:function(t){this.request=t},setActionObject:function(t){this.actionObject=t},getRequest:function(){return this.request},getAction:function(){return this.actionObject.getAction()},getParams:function(){return this.actionObject.getParams()},getValue:function(){return this.actionObject.getValue()},isRepeatPossible:function(){return this.request&&this.actionObject?!0:!1}};var c=new e;a.registerForRepeat=s,r.RepeatAction=n}(this);
!function(t){function e(t,e,s){var r=(n.data.getWorkBook(t,e),{RID:t,VERSION:e,ExpValue:s}),u=new i;u.open(o.EXPIRECLIP),u.send(r)}var n=t.sPlusPlus,s=n.SML.Client,i=s.Utility.WorkerRequest,o=t.ZSConstants.URI;t.UserAction.expireClip=e}(this);
!function(e){function t(t,n,i,a,o,r,E){var v,S=new e.ZSClass.ParamGenerator(n,t,i,!1,!1),u=S.getSheets(),L=S.getRanges(),R=S.getActiveCell(),f=S.getActiveSheet(),C=s.data.getWorkBook(t,i),I=C.getSheetObj(f),U=I.Prop.Name,A=WebMessanger.getRawSid(),m=s.data.UserInfo.loginName,w=s.data.UserInfo.zuid,h=s.view.getActiveGridID(),N=s.view.getSheetState(h,f),O=N.cellEdit;if(v=O?!0:!1,!s.data.UserInfo.isIncognito&&s.data.DocRegistry[t].ActiveUserList.isListAvailable()){var p={RID:t,sheetList:u,rangeList:L,activeCell:R,sheetname:U,rsid:A,loginname:m,userid:w,color:E,VERSION:i,editstatus:v},D=(new c(l.USER_PRESENCE,p),new d);D.addEventListeners("onComplete",function(){}),D.addEventListeners("onError",function(){}),D.addEventListeners("onTimeOut",function(){}),D.open(g.USER_PRESENCE),D.send(p)}}function n(t,n,i,a,o,r,E){var v=new e.ZSClass.ParamGenerator(n,t,i,!1,!1),S=v.getSheets(),u=v.getRanges(),L=v.getActiveCell(),R=WebMessanger.getRawSid(),f=s.data.UserInfo.loginName,C=s.data.UserInfo.zuid;if(!s.data.UserInfo.isIncognito&&s.data.DocRegistry[t].ActiveUserList.isListAvailable()){var I={RID:t,sheetList:S,rangeList:u,activeCell:L,rsid:R,loginname:f,userid:C,VERSION:i,color:E},U=(new c(l.COLLAB_USER_EDIT,I),new d);U.addEventListeners("onComplete",function(){}),U.addEventListeners("onError",function(){}),U.addEventListeners("onTimeOut",function(){}),U.open(g.COLLAB_USER_EDIT),U.send(I)}}var s=e.sPlusPlus,i=e.ZSClass,a=e.ZSEvents,o=(a.topic,a.Groups,a.Names,e.ZSConstants),r=s.SML.Client,d=r.Utility.WorkerRequest,c=i.ActionObject,l=o.ActionConstants,g=o.URI;e.UserAction.onSelection=t,e.UserAction.onEdit=n}(this);
!function(e){function t(e,t,n){switch(n){case 1:return e<c.MAX_ROW-1;case 2:return e>0;case 3:return t<c.MAX_COL-1;case 4:return t>0}}function n(n,s,r,i,C,v,g){if(t(i,C,v)){var A=new e.ZSClass.ParamGenerator(s,n,r),L=A.getSheets(),d=new ZSClass.Range(i,C,c.MAX_ROW,c.MAX_COL),R=A.getCustomRanges(d),S=A.getActiveCell(),f={rid:n,sheetList:L,version:r,activeCell:S,row:i,col:C,rangeList:R,action:u.CTRL_NAVIGATION,traverseMode:v||3},w=new l;w.addEventListeners("onError",function(e){o.log("Ctrl Navigation error :",e)}),w.addEventListeners("onComplete",function(e){g&&g(n,s[0],r,e.row,e.col)}),w.open(a.CTRL_NAVIGATION),w.send(f)}}var s=e.sPlusPlus,r=e.ZSEvents,o=(r.Groups,e.ZSDevTools.Logger),a=e.ZSConstants.URI,i=s.SML.Client,c=s.data.Defaults,l=i.Utility.WorkerRequest,u=e.ZSConstants.ActionConstants;UserAction.CtrlNavigate=n}(this);
!function(e){function a(e,a,t,r,n,u){var v=new l.Range(r,n,r,n);if(s.publish(i.Listener,c.Layers.Precedance.RemoveAll,{RID:e,SHEETID:a,VERSION:t}),u.startsWith("=")){var E=u.match(R),f=0;for(var I in E){var h=E[I];if(g.test(h)){var D=o.Range.parseRange(e,t,h);D&&D.sheetID===a&&s.publish(i.Listener,c.Layers.Precedance.Place,{RID:e,SHEETID:a,VERSION:t,ID:f++,RANGE:D.range,CELL:v})}}}}function t(t,n,s,i,c){var l=r.view.getActiveGridID(),o=["Formula"],u=function(e){var r=e[i][c],l=r.Formula;a(t,n,s,i,c,l)},v=function(a){e.ZSClass.Logger.log("Couldnt retrieve cell content",a)};r.view.fetchCellData(t,n,s,i,c,o,l,u,v)}var r=e.sPlusPlus,n=e.ZSEvents,s=n.topic,i=n.Groups,c=n.Names,l=e.ZSClass,o=e.JSUtil,u=e.UserAction,v=o.REGEXP,R=v.matchRegex,g=v.rangeRegex;u.PlacePrecedance=t}(this);
!function(e){function t(e,t,o,R,S,c){var D=new ZSClass.ParamGenerator([t],e,o,!1,!1),E=D.getSheets(),u=D.getActiveCell(),O=D.getCustomRanges(S),g=D.getCustomRanges(R),A={FOCUS_SOURCE:!0},U={RID:e,SHEETID:t,sheetList:E,rangeList:O,action:d.DRAG_DROP,activeCell:u,srcRangeList:g,VERSION:o,undoRedoOptions:A},p=new C(d.DRAG_DROP,U),v=new a;v.addEventListeners("onError",function(e){r.publish(i.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),v.addEventListeners("onComplete",function(s){r.publish(i.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:o,RANGE:S});var a=c.startRow-R.startRow,d=c.startCol-R.startCol,C=R.endRow-c.endRow,D=R.endCol-c.endCol,E=new ZSClass.Range(S.startRow+a,S.startCol+d,S.endRow-C,S.endCol-D);r.publish(i.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:o,ActiveCellRange:E,ROW:E.startRow,COL:E.startCol});var u=s.qaid;p.qaid=u,n.data.UserInfo.ActionRecorder.record(p)}),v.open(s.DRAG_DROP),v.send(U)}var n=e.sPlusPlus,o=n.SML.Client,s=e.ZSConstants.URI,a=(e.ZSDevTools.Logger,o.Utility.WorkerRequest),R=e.ZSEvents,r=R.topic,i=R.Groups,l=R.Names,d=e.ZSConstants.ActionConstants,C=e.ZSClass.ActionObject;e.UserAction.dragAndDropRange=t}(this);
!function(t){function e(t,e,l,u){var E=o.data.getWorkBook(t,l),D=o.view.getActiveGridID(),g=o.view.getSheetID(D),R=o.data.UserInfo.Transients.UndoRedo.getObj(t),v=R.getNextNthData(0);if(v&&u<=v.qaid){var d=v.params.sheetList,I=v.params.rangeList,C=v.params.activeCell,A=r(g,d,I),p=new ZSClass.Range(C.r,C.c,C.r,C.c),O=I[A.oIndex];p=p?p:O;var h=O[0].startCol,U=O[0].startRow;if(g!==e){var N=E.getSheetObj(e),b=N.Prop.getName();return void n.publish(s.Listener,S.ERROR.SHOW,{ERRORMSG:"DataVal.SheetSwitchResponseOnError#"+b+"."+c.Object.getCharForNum(h+1)+(U+1)})}i(t,g,l,p,O),a(t,e,l,u,U,h),R.undo(),R.deQueue(1)}}function a(e,a,r,i,l,E){function g(){var t=o.view.getActiveGridID(),i=o.view.getSheetState(t,a);n.publish(s.Selector.BoundUpdate.CellEdit,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:a,VERSION:r,RANGE:i.getActiveCellRange(),RANGEID:0}),n.publish(s.Listener,S.CellAction.VALUE.SET,{RID:e,SHEETID:a,VERSION:r,ROW:i.getActiveCellRange().startRow,COL:i.getActiveCellRange().startCol,VALUE:{DisplayValue:sPlusPlus.view.CellEditor.getValue()},FOCUS:!0})}D.buttons[0].click=function(){g()},D.buttons[1].click=function(){};var R="DataVal.StopMsg#"+c.Object.getCharForNum(E+1)+(l+1),v=R.split("#"),d=v.splice(0,1),I=o.data.getWorkBook(e,r),C=I.getSheetObj(a),A=C.DataValidation.isXists(l,E),p=v,d=u[d]?d:"Error.Internal.Server",O=t.JSUtil.fn.replaceParams(u[d],p);u["DataVal.StopErrorMsg"]!=A.root.messageContent&&(O=A.root.messageContent),ZSClass.ZSAlert(O,D)}function r(t,e){for(var a={},r=0,i=0,o=0;o<e.length;o++)for(var l=0;l<e[o].length;l++)if(t===e[o][l]){r=o,i=l;break}return a.oIndex=r,a.iIndex=i,a}function i(e,a,r,i,l){var c=(o.data.getWorkBook(e,r),o.view.getActiveGridID()),u=(o.view.getSheetState(c,a),o.view.CellEditor.getEditStatus());u&&n.publish(s.Selector.BoundUpdate.CellEdit,S.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:a,VERSION:r,isSubmittable:0}),u&&n.publish(s.UserAction,S.KeyBoard.ForceQuit,{RID:e,SHEETID:a});for(var E=0;E<l.length;E++){var D=l[E];n.publish(s.Selector.BoundUpdate.Cell,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:a,VERSION:r,ActiveCellRange:i,ROW:i.startRow,COL:i.startCol}),n.publish(s.Selector.BoundUpdate.Range,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:a,VERSION:r,RANGE:D})}t.UserAction.ScrollCellIntoView(e,a,r,l[0].startRow,l[0].starCol)}var o=t.sPlusPlus,l=t.ZSEvents,n=l.topic,s=l.Groups,S=l.Names,c=(o.SML.Client,t.JSUtil),u=ZSConstants.I18N,E=[{text:u.Retry,primary:!0},{text:u["Dialog.Button.Cancel"]}],D={buttons:E,title:u["Alert.Title.InvalidData"]};t.UserAction.revokeLastAction=e}(this);
!function(e){function t(e,t,E){var i=s.data.getWorkBook(e,E),S=i.getSheetObj(t),o=s.view.getActiveGridID(),I=s.view.getActiveState(o);if(S){var n=u.activeInfo.getVisualCueStatus();if(n)r.publish(D.Selector.BoundUpdate.Copy,l.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E,VisualCueStatus:A.CUESTATUS.VISIBLE});else{var R=I.getFormatPainterState();R&&r.publish(D.Selector.BoundUpdate.FormatPainter,l.Selection.BOUND_UPDATE.REMOVEDOM,{RID:e,SHEETID:t,VERSION:E})}r.publish(D.Listener,l.SheetAction.PROTECTED_RANGES.HIDE,{RID:e,SHEETID:t,VERSION:E}),r.publish(D.Listener,l.DocAction.COLLAB_LIST.HIDE,{RID:e,SHEETID:t,VERSION:E}),r.publish(D.Listener,l.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:e,SHEETID:t,VERSION:E});var a=S.DataFilters,T=a.getAllRanges();for(var c in T){var O=T[c],h=new ZSClass.Range(O.startRow,O.startCol,O.endRow,O.endCol);r.publish(D.UserAction,l.SheetAction.DATAFILTER.HIDE,{RID:e,SHEETID:t,VERSION:E,FRANGE:h})}r.publish(D.UI,l.Layout.DATA_LOADER.SHOW)}}function E(e){var t=s.view.getActiveGridID(),E=s.view.getVersionID(t);e[a.CommandConstants.DOCUMENT_META]&&r.publish(D.Listener,l.ServerAction.PROCESSRESPONSE,{RESPONSE:e,VERSION:E});var i=s.view.getResourceID(t),S=s.view.getSheetID(t);r.publish(D.Listener,l.UserAction.PIVOT.FILTER_SHOW,{RID:i,SHEETID:S,VERSION:E})}function i(e,t,E){{var i=s.data.getWorkBook(e,E);i.getSheetObj(t)}r.publish(D.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.SHOW,{RID:e,SHEETID:t,VERSION:E}),r.publish(D.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.SHOW,{RID:e,SHEETID:t,VERSION:E}),r.publish(D.Listener,l.RangePicker.ReHighlight)}function S(t,E,i,S){var o=s.data.getWorkBook(t,i),I=s.view.getActiveGridID(),n=s.view.getSheetState(I,E),R=s.view.getActiveState(I),a=n.getZoom();if(S){var T=u.activeInfo.getVisualCueStatus(),c=n.getScrollTops(),O=n.getScrollLefts();if(r.publish(D.Listener,l.SheetAction.ZOOM.On,{RID:t,SHEETID:E,VERSION:i,ZOOM:a}),T)r.publish(D.Selector.BoundUpdate.Copy,l.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:E,VERSION:i});else{var A=R.getFormatPainterState(),h=n.getActiveRange();A&&r.publish(D.Selector.BoundUpdate.FormatPainter,l.Selection.BOUND_UPDATE.ADDDOM,{RID:t,SHEETID:E,VERSION:i,RANGE:h,TYPE:0,IS_SERVER_CLIP:!1})}r.publish(D.UserAction,l.SheetAction.DATAFILTER.SHOW,{RID:t,SHEETID:E,VERSION:i}),r.publish(D.Listener,l.UserAction.PIVOT.FILTER_SHOW,{RID:t,SHEETID:E,VERSION:i}),o.ProtectedSheets.isSheetLocked(E)||r.publish(D.Listener,l.SheetAction.PROTECTED_RANGES.SHOW,{RID:t,SHEETID:E,VERSION:i}),e.UserAction.ScrollTo(t,E,i,O[0],c[0],O[1],c[1])}r.publish(D.Listener,l.DocAction.COLLAB_LIST.SHOW,{RID:t,SHEETID:E,VERSION:i}),r.publish(D.Listener,l.SheetAction.BUTTONS.REPAINT,{RID:t,SHEETID:E,VERSION:i}),r.publish(D.Listener,l.SheetAction.IMAGES.REPAINT,{RID:t,SHEETID:E,VERSION:i}),o.highlightComments&&r.publish(D.Listener,l.SheetAction.HIGHLIGHT_COMMENTS.REPAINT,{RID:t,SHEETID:E,VERSION:i})}function o(t,E,i,S){r.publish(D.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:E,VERSION:i,RANGE:S,TYPE:S.TYPE}),r.publish(D.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:E,VERSION:i,ActiveCellRange:S,ROW:S.startRow,COL:S.startCol,TYPE:S.TYPE}),e.UserAction.ScrollCellIntoView(t,E,i,S.startRow,S.startCol)}function I(e,t,E,i){r.publish(D.UserAction,l.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,{RID:e,SHEETID:t,VERSION:E,TARGET_SHEET:i}),!h()&&r.publish(D.Selector.BoundUpdate.CellEdit,l.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:E,isSubmittable:!0}),r.publish(D.Listener,l.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:t,VERSION:E})}function n(n,R,a,T,A,u,h){var H=s.data.getWorkBook(n,a);if(void 0!=H.SheetList.getPosById(T,!0)){var N=H.getSheetObj(T),p=N.Visited,U={RID:n,toSheet:T,VERSION:a,visited:p};if(T!=R){N&&I(n,R,a,T);var C=new c;C.addEventListeners("onComplete",function(I){var c=I,O=s.data.getWorkBook(n,a);N=O.getSheetObj(T),t(n,R,a),E(c),S(n,T,a,p),p&&!A&&i(n,T,a),A&&o(n,T,a,A),r.publish(D.Listener,l.Browser.UISheetLoad),e.UserAction.UpdateContentViewport(n,T,a),r.publish(D.Listener,l.DocAction.WORKSHEETS.SWITCHSHEET,{NEWSHEETID:T,RID:n,VERSION:a}),r.publish(D.Listener,l.SheetAction.CHARTS.REPAINT,{RID:n,SHEETID:T,VERSION:a}),u&&r.publish(D.Listener,l.UserAction.PIVOT.SHEETINSERT_CALLBACK,{NEWSHEETID:T}),h&&h()}),C.addEventListeners("onError",function(e){r.publish(D.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),C.open(O.ACTIVE_SHEET_SWITCH),C.send(U)}}}var s=e.sPlusPlus,R=e.ZSEvents,r=R.topic,D=R.Groups,l=R.Names,a=e.ZSConstants,T=s.SML.Client,c=T.Utility.WorkerRequest,O=a.URI,A=e.ZSClass.SelectorHelper.Constants,u=s.data.UserInfo,h=ZSClass.RangePicker.isSelection;e.UserAction.SwitchSheet=n}(this);
!function(e){function t(e,t){var a=o.data.getWorkBook(e,t);if(a){var c,v,R=o.view.getActiveGridID(),g=o.view.getSheetID(R),S=a.getSheetObj(g),u=o.view.getSheetState(R,g),C=u.getActiveRow(),f=u.getActiveCol(),D=u.getRanges(),O=u.getScrollTops(),U=u.getScrollLefts(),m=O[0],L=U[0],y=S.Row.FreezedCount,E=S.Column.FreezedCount;(y>0||E>0)&&(c=O[1],v=O[1]),d.activeInfo.setCopyState(1);var I={},N={activeRowIndex:C,activeColIndex:f,currRanges:D,positionTop:m,positionLeft:L,FreezedRow:y,FreezedCol:E};(y>0||E>0)&&(N.FreezedPositionTop=c,N.FreezedPositionLeft=v),I[g]=N;var h={URL:"hclosedoc",params:["activeSheetId","workBookDetails","copyDoc","versionNo","rid"],paramVal:[g,JSON.stringify(I),!1,null,e],action:p.HCLOSE_DOCUMENT},w=new l(h),P=UserAction.CollaborationNotifier.getRemoveUserProfile();if(navigator.sendBeacon){var k=new FormData;k.append("action",p.HCLOSE_DOCUMENT),k.append("activeSheetId",g),k.append("workBookDetails",JSON.stringify(I)),k.append("copyDoc",!1),k.append("versionNo",null),k.append("rid",e),k.append("removeUserProfile",P),k.append(o.data.PageRegistry.csrfParamName,o.data.PageRegistry.csrfToken),k.append("rsid",o.data.PageRegistry.RS_ID),k.append("utid",o.data.PageRegistry.UT_ID),k.append("tabType","cached"),navigator.sendBeacon(w.getURL(e,t)+"?proxyURL=hclosedoc",k)}else{var h={URL:"hclosedoc",params:["activeSheetId","workBookDetails","copyDoc","versionNo","rid","removeUserProfile"],paramVal:[g,JSON.stringify(I),!1,null,e,P],action:p.HCLOSE_DOCUMENT},T=new n.AjaxRequest(e,t);T.init(h,{async:!1}),T.addEventListener("onComplete",function(){}),T.addEventListener("onError",function(){i.publish(r.Listener,s.ERROR.SHOW,{ERRORMSG:responseObj.mk})}),T.sendRequest()}i.publish(r.Listener,s.DocAction.DOCUMENT.CLOSE,{RID:e,VERSION:t})}}var o=e.sPlusPlus,a=e.ZSEvents,n=e.ZSClass,i=a.topic,r=a.Groups,s=a.Names,c=o.SML.Client,d=(c.Utility.WorkerRequest,e.ZSConstants.URI,o.data.UserInfo),p=ZSConstants.ActionConstants,l=(n.AjaxRequest,n.RequestParameters);e.UserAction.CloseDocument=t}(this);
!function(t){function e(){if(f&&!C){var t="WORKER_CHECK",e=new E,n=setTimeout(function(){var t=setTimeout(function(){window.location.reload()},1e4);L.buttons[0].click=function(){clearTimeout(t),window.location.reload()},m||(d.ZSAlert(R["WorkerCheck.Terminated"],L),m=!0),C=!1},2e4);e.addEventListeners("onComplete",function(){C=!1,clearTimeout(n)}),e.addEventListeners("onError",function(t){c.publish(u.Listener,a.ERROR.SHOW,{ERRORMSG:t.mk})}),e.open(s[t]),e.send({}),C=!0}}function n(){f=!0}var o=t.sPlusPlus,i=t.ZSConstants,s=i.URI,r=t.ZSEvents,c=r.topic,u=r.Groups,a=r.Names,l=o.SML.Client,d=t.ZSClass,E=(i.ActionConstants,t.ZSClass.ActionObject,l.Utility.WorkerRequest),R=(t.UserAction,i.I18N),f=!1,m=!1,C=!1,w=[{text:R.Refresh,primary:!0}],L={buttons:w,countDown:10,timerMsg:R["WorkerCheck.Reloading"]};window.addEventListener("focus",e),c.register(u.UI,a.Layout.TEMPLATE_LOADED,n)}(this);
!function(e){function t(){var e=n.view.getActiveGridID(),t=n.view.getVersionID(e),s=n.view.getResourceID(e),o="REQUEST_BANNER",l=R[o],S=localStorage?localStorage.getItem("AB"):null,v={bv:n.data.AppRegistry.buildVersion,bannerName:S,actionConstant:l,RID:s,VERSION:t},A=(new u(l,v),new E);A.addEventListeners("onComplete",function(e){r.publish(a.Listener,c.DocAction.BANNER.ADD,{RESPONSE:e})}),A.addEventListeners("onError",function(e){r.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(i[o]),A.send(v)}{var n=e.sPlusPlus,s=e.ZSConstants,i=s.URI,o=e.ZSEvents,r=o.topic,a=o.Groups,c=o.Names,l=n.SML.Client,R=(e.ZSClass,s.ActionConstants),u=e.ZSClass.ActionObject,E=l.Utility.WorkerRequest;e.UserAction,s.I18N}t()}(this);
!function(n){function e(n,e,t,s){var o={RID:n,VERSION:e,ACTION:t},r=new i;r.addEventListeners("onComplete",function(n){n&&!n.isViewed&&s&&s(!0)}),r.open(u.USER_ANNOUNCEMENT),r.send(o)}var t=n.sPlusPlus,s=t.SML.Client,i=s.Utility.WorkerRequest,o=n.ZSConstants,u=o.URI;n.UserAction.Announcement=e}(this);
!function(e){function t(e){e.innerHTML="";for(var t=0;t<S.length;t++){var n=S[t],i=p.createElement("option");i.value=n[1],i.style.fontFamily=n[1],i.title=n[2],i.text=n[2],h.push(n[1]),e.appendChild(i)}}function n(){f.register(m.Listener,d.SheetAction.ACTIVE_CELL.INFO,i,"VALUE"),l()}function i(e){return a(e.styleName[3])}function a(e){T&&e&&-1!=h.indexOf(e)?(s=e,g.zcombo(b,"setValue",e)):o(e)}function o(e){if(T&&e){b.innerHTML="";for(var t=-1,n=0;n<h.length;n++){if(0==n&&e<h[n]){var i=p.createElement("option");i.value=e,i.style.fontFamily=e,i.title=e,i.text=e,b.appendChild(i),t=n}else if(n>0&&h[n-1]<e&&e<h[n]){var i=p.createElement("option");i.value=e,i.style.fontFamily=e,i.title=e,i.text=e,b.appendChild(i),t=n}var o=h[n],l=p.createElement("option");l.value=o,l.style.fontFamily=o,l.title=o,l.text=o,b.appendChild(l)}if(t>=0)h.splice(t,0,e);else{var i=p.createElement("option");i.value=e,i.style.fontFamily=e,i.title=e,i.text=e,b.appendChild(i),h.splice(h.length,0,e)}g.zcombo(b,"refresh"),a(e)}}function l(){g.bind(b,"zselectboxitemclick",function(e,t){r(t)}),g.bind(b,"zselectboxbeforedropdownlistclose",function(){setTimeout(function(){e.document.activeElement.blur()},10)})}function r(t){var n=c.view.getActiveGridID(),i=c.view.getResourceID(n),a=c.view.getSheetID(n),o=c.view.getVersionID(n),l=c.view.getSelectedSheets(n),r=c.view.getSheetState(n,a),u=r.getRanges(),f=u[0];(!f.isSingle()||f.isSingle()&&s!=t.value)&&e.UserAction.FONTFAMILY(i,l,o,t.value)}var s,c=e.sPlusPlus,u=e.ZSEvents,f=u.topic,m=u.Groups,d=u.Names,v=e.ZSConstants.FeatureConstants,p=e.document,C=e.ZSConstants.wCC,g=e.UIUtil.Component,h=[],S=[["fnal","Arial","Arial"],["fnab","Arial Black","Arial Black"],["fnba","Book Antiqua","Book Antiqua"],["fnci","Calibri","Calibri"],["fncs","Comic Sans MS","Comic Sans MS"],["fncn","Courier New","Courier New"],["fngd","Garamond","Garamond"],["fnga","Georgia","Georgia"],["fnlc","Lucida Console","Lucida Console"],["fnta","Tahoma","Tahoma"],["fntn","Times New Roman","Times New Roman"],["fntms","Trebuchet MS","Trebuchet MS"],["fnva","Verdana","Verdana"]],b=p.getElementById(C.MI+v.FONT_FAMILY+C.IDENTITY),T=b?b.parentElement:void 0;b&&t(b),n()}(this);
!function(e){function t(e){e.innerHTML="";for(var t=0;t<E.length;t++){var n=E[t],i=m.createElement("option");i.value=n,i.title=n+"pt",i.text=n,10==n&&i.setAttribute("selected","true"),e.appendChild(i)}}function n(){p.register(v.Listener,d.SheetAction.ACTIVE_CELL.INFO,i,"VALUE"),s()}function i(e){return o(e.styleName[2])}function o(e){C&&e&&-1!=E.indexOf(e)?(c=e,g.zcombo(h,"setValue",e)):l(e)}function l(e){if(C&&e){h.innerHTML="";for(var t=-1,n=0;n<E.length;n++){if(0==n&&e<E[n]){var i=document.createElement("option");i.value=e,i.style.fontSize=e,i.title=e+"pt",i.text=e,h.appendChild(i),t=n}else if(n>0&&E[n-1]<e&&e<E[n]){var i=document.createElement("option");i.value=e,i.style.fontSize=e,i.title=e+"pt",i.text=e,h.appendChild(i),t=n}var l=E[n],s=m.createElement("option");s.value=l,s.title=l+"pt",s.text=l,h.appendChild(s)}if(t>=0)E.splice(t,0,e);else{var i=document.createElement("option");i.value=e,i.style.fontSize=e,i.title=e+"pt",i.text=e,h.appendChild(i),E.splice(E.length,0,e)}g.zcombo(h,"refresh"),o(e)}}function s(){g.bind(h,"zselectboxitemclick",function(e,t){a(t)}),g.bind(h,"zselectboxbeforedropdownlistclose",function(){setTimeout(function(){e.document.activeElement.blur()},10)})}function a(t){var n=r.view.getActiveGridID(),i=r.view.getResourceID(n),o=r.view.getSheetID(n),l=r.view.getVersionID(n),s=r.view.getSelectedSheets(n),a=t.value?t.value+"pt":t.value,u=r.view.getSheetState(n,o),p=u.getRanges(),v=p[0];(!v.isSingle()||v.isSingle()&&c!=t.value)&&e.UserAction.FONTSIZE(i,s,l,a)}var c,r=e.sPlusPlus,u=e.ZSEvents,p=u.topic,v=u.Groups,d=u.Names,f=e.ZSConstants.FeatureConstants,m=e.document,S=e.ZSConstants.wCC,g=e.UIUtil.Component,E=[8,9,10,11,12,14,16,18,20,22,24,26,28,32,40,48,56,64,72],h=m.getElementById(S.MI+f.FONT_SIZE+S.IDENTITY),C=h?h.parentElement:void 0;h&&t(h),n()}(this);
!function(e){function t(e){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),o=s.view.getSelectedSheets(t),u=s.view.getVersionID(t);i(e,n,o,u)}function i(e,t,i,s){u.Cut(t,i,s,void 0,!1,!0)}var s=e.sPlusPlus,n=e.ZSConstants,o=n.FeatureConstants,u=e.UserAction,r=s.view.Toolbar.Feature[o.CUT];r.execute=t}(this);
!function(e){function t(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),a=n.view.getSheetID(t),s=n.view.getVersionID(t),r=n.view.getSelectedSheets(t),S=n.view.getSheetState(t,a),c=S.getRanges();g.show(!0),o(e,i,a,t,r,s,c)}function o(t,o,i,a,n,s,r){t.repeat||(t.preventDefault(),e.UserAction.CopyData(o,i,a,n,s,r))}function i(){var e=g.isShown;if(g.remove(),n.data.UserInfo.activeInfo.getCopyState()&&e){var t=new r.TBNotification(S["Statusbar.Copied"],{timeOut:1e3,type:"info"});t.show()}}function a(e,t,o){var i=n.view.getActiveGridID(),a=n.view.getSelectedSheets(i),s=n.view.getActiveState(i),r=I.activeInfo.getCopyState(),S=s.getFormatPainterState();S||(r?D.publish(v.Selector.BoundUpdate.Copy,p.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:a[0],VERSION:o,VisualCueStatus:E.CUESTATUS.HIDDEN}):D.publish(v.Selector.BoundUpdate.Copy,p.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:a[0],VERSION:o}))}var n=e.sPlusPlus,s=e.ZSConstants,r=(e.UserAction,e.ZSClass),S=e.ZSConstants.I18N,c=e.ZSEvents,u=s.FeatureConstants,D=c.topic,v=c.Groups,p=c.Names,I=n.data.UserInfo,E=r.SelectorHelper.Constants,l=n.view.Toolbar.Feature[u.COPY],g=new r.TBNotification(S["Statusbar.Copying"],{mode:"STD",type:"info"});l.execute=t,D.register(v.Listener,p.KeyBoard.Escape,a,"RID","SHEETID","VERSION"),D.register(v.Selector.BoundUpdate.Copy,p.Selection.BOUND_UPDATE.ADD,i)}(this);
!function(e){function t(e,t){var a=t.action,n=!1;"TRANSPOSE"==a&&(n=!0);var o=s.view.getActiveGridID(),i=s.view.getResourceID(o),l=(s.view.getSheetID(o),s.view.getVersionID(o)),r=s.view.getSelectedSheets(o);UserAction.PasteFromSheet(i,r,l,a,n)}function a(e){var t=p.getHolder();if(t){var a=t.querySelector("#"+u.MI+c.PASTE+u.IDENTITY),n=t.querySelector("#"+u.MI+c.PASTE+u.SPLIT+u.IDENTITY);e=e>=0?"enable":"disable",T.doToolbarAction(t.id,{item:d.PASTE,action:e,callback:function(){T[e]("#"+a.id),T[e]("#"+n.id)}})}}function n(e){var t=p.getHolder();if(t){var a=t.querySelector("#"+u.MI+c.PASTE+u.SPLIT+u.IDENTITY);e="enable",T.doToolbarAction(t.id,{item:d.PASTE,action:e,callback:function(){T[e]("#"+a.id)}})}}function o(){E.addEventListener("paste",i)}function i(e){var t=e.clipboardData,a=t.getData("text/plain"),n=t.getData("text/html"),o=l(a,n,e);if(-1===n.indexOf(m)){if(n.length>1e6&&a.length>1e6)return void ZSClass.ZSAlert(A.ErrorExceedingPastedData);n.length>1e6&&(n="")}e.preventDefault(),S.handleClipData(a,n,o),E.removeEventListener("paste",i)}function l(e,t,a){var n,o=a.clipboardData,i=new DOMParser,l=i.parseFromString(t,"text/html"),r=!1;if(o.files.length>0&&0==t.length)n=o.files[0];else{if(!o.items)return;for(var s=0;s<o.items.length;s++)if(-1!==o.items[s].type.indexOf("image")){r=!0;break}var d=l.childNodes[0].childNodes,c="undefined"!=typeof d&&"undefined"!=typeof d[0]&&"HEAD"===d[0].nodeName&&"undefined"!=typeof d[1]&&"BODY"===d[1].nodeName&&"undefined"!=typeof d[1].childNodes[0]&&"IMG"===d[1].childNodes[0].nodeName;if(c||0===e.length&&0===t.length||r&&0==t.length)for(var s=0;s<o.items.length;s++)if(-1!==o.items[s].type.indexOf("image")){n=o.items[s].getAsFile();break}}return n}function r(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),a=(s.view.getSheetID(e),s.view.getVersionID(e)),n=s.view.getSelectedSheets(e);UserAction.PasteFromSheet(t,n,a,"ALL",!1)}var s=e.sPlusPlus,d=e.ZSConstants,c=d.FeatureConstants,u=e.ZSConstants.wCC,m=u.ZOHOSHEET_COPY_SRC,S=e.UserAction,T=e.UIUtil.Component,I=e.ZSEvents,E=e.document,A=e.ZSConstants.I18N,b=I.topic,f=I.Groups,v=I.Names,P=E.getElementById("popupmenu"),p=s.view.Toolbar.Feature[c.PASTE];!function(){var e={id:u.SUBMENUITEM+c.PASTE+u.IDENTITY,mtype:"submenu",data:'{"componentOptions":{"label":"'+A["MenuItem.HomeTab.PasteSpecial"]+'","type":"text_only"}}',relativeto:"parent"},a=[{data:'{"label":"'+A["MenuItem.HomeTab.Paste.All"]+'", "action": "ALL"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.Values"]+'", "action": "VALUES"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.Formats"]+'", "action": "FORMATS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.Formulas"]+'", "action": "FORMULAS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.Notes"]+'", "action": "COMMENTS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.ValuesAndNumberFormats"]+'", "action": "VALUES_AND_NUMBERFORMATS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.FormulasAndNumberFormats"]+'", "action": "FORMULAS_AND_NUMBERFORMATS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.AllExceptNotes"]+'", "action": "ALL_EXCEPT_COMMENTS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.AllExceptBorders"]+'", "action": "ALL_EXCEPT_BORDERS"}'},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.Validation"]+'", "action": "VALIDATION"}'},{mtype:"separator"},{data:'{"label":"'+A["MenuItem.HomeTab.Paste.Transpose"]+'", "action": "TRANSPOSE"}'}];s.view.Menu.create(a,e,P).then(function(){T.bind("#"+u.SUBMENUITEM+c.PASTE+u.IDENTITY,"zmenuitemclick",function(e,a){var n=a.data;t(e,n)})})}(),b.register(f.Selector.BoundUpdate.Copy,v.Selection.BOUND_UPDATE.ADD,a,"IS_COPY"),b.register(f.Selector.BoundUpdate.Copy,v.Selection.BOUND_UPDATE.HIDE,n,"VisualCueStatus"),p.execute=r,p.executeShortCut=o}(this);
!function(e){function t(e){n(e)}function n(e){var t=e?"enable":"disable";"enable"==t?D.enable(S):i()}function i(){D.disable(S)}function s(e){var t=r.view.getActiveGridID(),n=r.view.getResourceID(t),i=(r.view.getSheetID(t),r.view.getVersionID(t)),s=r.view.getSelectedSheets(t);o(e,n,s,i)}function o(e,t,n,i){if(!e.repeat){e.preventDefault();var s=r.view.getActiveGridID(),n=r.view.getSelectedSheets(s);v.Undo(t,n,i)}}var r=e.sPlusPlus,a=e.ZSConstants,c=a.FeatureConstants,u=e.ZSConstants.wCC,v=e.UserAction,D=e.UIUtil.Component,l=e.ZSEvents,I=l.topic,d=l.Groups,g=l.Names,w=r.view.Toolbar.Feature[c.UNDO],S=document.getElementById(u.MI+c.UNDO+u.IDENTITY);i(),I.register(d.Listener,g.DocAction.UNDO_REDO.COUNTS,t,"UNDO","REDO"),w.execute=s}(this);
!function(e){function t(e,t){i(t)}function i(e){var t=e?"enable":"disable";"enable"==t?l.enable(f):n()}function n(){l.disable(f)}function s(e){var t=r.view.getActiveGridID(),i=r.view.getResourceID(t),n=(r.view.getSheetID(t),r.view.getVersionID(t)),s=r.view.getSelectedSheets(t);o(e,i,s,n)}function o(e,t,i,n){if(!e.repeat){e.preventDefault();var s=r.view.getActiveGridID(),o=r.view.getSelectedSheets(s);D.Redo(t,o,n)}}function c(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),i=r.view.getVersionID(e),n=r.view.getSelectedSheets(e);D.RepeatAction(t,n,i)}var r=e.sPlusPlus,v=e.ZSConstants,a=v.FeatureConstants,u=e.ZSConstants.wCC,D=e.UserAction,l=e.UIUtil.Component,g=e.ZSEvents,w=g.topic,I=g.Groups,d=g.Names,S=r.view.Toolbar.Feature[a.REDO],f=document.getElementById(u.MI+a.REDO+u.IDENTITY);n(),w.register(I.Listener,d.DocAction.UNDO_REDO.COUNTS,t,"UNDO","REDO"),S.execute=s,S.executeRepeat=c}(this);
!function(e){function t(){c.register(a.Listener,r.SheetAction.ACTIVE_CELL.INFO,s,"VALUE")}function s(e){I=e.styleName[8]&&"wrap"==e.styleName[8]?1:0;var t=document.getElementById(v.MI+u.WRAPTEXT+v.IDENTITY);t&&(I?t.parentElement.classList.add("shIconActive"):t.parentElement.classList.remove("shIconActive"))}function n(){I=1==I?0:1;var t=i.view.getActiveGridID(),s=i.view.getResourceID(t),n=(i.view.getSheetID(t),i.view.getVersionID(t)),o=i.view.getSelectedSheets(t);e.UserAction.WRAP(s,o,n,I)}var i=e.sPlusPlus,o=e.ZSEvents,c=o.topic,a=o.Groups,r=o.Names,u=e.ZSConstants.FeatureConstants,v=(e.document,e.ZSConstants.wCC),I=(e.UIUtil.Component,e.ZSConstants.I18N,0),l=i.view.Toolbar.Feature[u.WRAPTEXT];t(),l.execute=n}(this);
!function(e){function t(){a=document.createElement("ul"),a.id=i.SUBMENUITEM+E.HIDE_UNHIDE+i.IDENTITY,a.setAttribute("data-ctype","zmenu"),n(a),C.appendChild(a),l.bind(a,"zmenubeforeshow",function(){c.publish(m.UI,I.Toolbar.INIT_MENU,{DOM:a})})}function n(e){p&&p.createMenuElement(e),d&&d.createMenuElement(e),T&&T.createMenuElement(e),o(e),p&&p.constructShowRowMenuElement(e),d&&d.createShowColMenuElement(e),b&&b.createMenuElement(e)}function o(e){var t=document.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}var a,u=e.sPlusPlus,r=e.document,E=(e.UserAction,e.ZSConstants.FeatureConstants),i=(e.ZSConstants.I18N,e.ZSConstants.wCC),l=e.UIUtil.Component,s=e.ZSEvents,c=s.topic,m=s.Groups,I=s.Names,p=(u.view.Toolbar.Feature[E.HIDE_UNHIDE],u.view.Toolbar.Feature[E.HIDE_ROWS]),d=u.view.Toolbar.Feature[E.HIDE_COLUMNS],T=u.view.Toolbar.Feature[E.HIDE_SHEET],b=u.view.Toolbar.Feature[E.UNHIDE_SHEET],C=r.getElementById("popupmenu");t()}(this);
!function(e){function t(e,t){{var a=n.view.getActiveGridID(),r=n.view.getResourceID(a),s=n.view.getVersionID(a),u=(n.view.getSheetID(a),n.view.getSelectedSheets(a));new ZSClass.ParamGenerator(u,r,s,!0)}e=e?e:l.getRange();var c=e?JSUtil.Range.parseRange(r,s,e).range:"";i.ReadTable(r,u,s,c,t),o.querySelector("#removeDuplicates").style.display="none",o.querySelector(".sPDatCln .ZsLoader").style.display="none",o.querySelector("#columnContainer").innerHTML="",o.querySelector("#columnLoader").style.display="block"}var n=e.sPlusPlus,a=e.ZSEvents,r=(a.topic,a.Groups,a.Names,e.ZSConstants.FeatureConstants),o=e.document,i=e.UserAction,s=(e.ZSConstants.wCC,e.UIUtil.Component,n.view.Toolbar.Feature[r.DATA_DUPLICATES]),l=n.view.Toolbar.Feature[r.DATA_CLEANING],u={};u.CLUSTER=1,u.MISSING_VALUE=2,u.DUPLICATE=3,u.FIND_UNIQUE=4,window.addEventListener("DC_Duplicate_view_On_Open",function(e){var n=e.detail.curentScope==u.DUPLICATE?"duplicate":"unique";t(void 0,n)}),s.readTable=t}(this);
!function(e){function t(){a.register(v.Listener,u.DocAction.DOCUMENT.TOGGLE_VIEW,i,"isRegister"),a.register(v.Listener,u.SheetAction.ACTIVE_CELL.INFO,s,"RID","SHEETID","VERSION","VALUE")}function i(e){var i=e?"register":"unregister";t(i)}function s(e,t,i,s){var r=o.data.getWorkBook(e,i),n=r.CellStyle.getStyleDef(s.Format),c=g.getElementById(D.MI+I.BOLD+D.IDENTITY);E=0,"bold"==n[4]&&(E=1),c&&(E?c.classList.add("shIconActive"):c.classList.remove("shIconActive"))}function r(e){var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),s=(o.view.getSheetID(t),o.view.getVersionID(t)),r=o.view.getSelectedSheets(t);n(e,i,r,s)}function n(e,t,i,s){if(!e.repeat){var r=o.view.getActiveGridID(),i=o.view.getSelectedSheets(r);return E=1==E?0:1,l.BOLD(t,i,s,E),e.preventDefault(),e.stopPropagation(),!1}}var o=e.sPlusPlus,c=e.ZSEvents,a=c.topic,v=c.Groups,u=c.Names,I=e.ZSConstants.FeatureConstants,g=e.document,l=e.UserAction,D=e.ZSConstants.wCC,S=(e.UIUtil.Component,o.view.Toolbar.Feature[I.BOLD]),E=0;t("register"),S.execute=r}(this);
!function(e){function t(){a.register(I.Listener,v.SheetAction.ACTIVE_CELL.INFO,i,"RID","SHEETID","VERSION","VALUE")}function i(e,t,i,s){var o=r.data.getWorkBook(e,i),c=o.CellStyle.getStyleDef(s.Format);"italic"==c[5]?(g=1,n(!0)):(g=0,n(!1))}function n(){var e=document.getElementById(S.MI+u.ITALIC+S.IDENTITY);e&&(g?e.classList.add("shIconActive"):e.classList.remove("shIconActive"))}function s(e){var t=r.view.getActiveGridID(),i=r.view.getResourceID(t),n=(r.view.getSheetID(t),r.view.getVersionID(t)),s=r.view.getSelectedSheets(t);o(e,i,s,n)}function o(e,t,i,n){if(!e.repeat){g=1==g?0:1;var s=r.view.getActiveGridID(),i=r.view.getSelectedSheets(s);return l.ITALIC(t,i,n,g),e.preventDefault(),e.stopPropagation(),!1}}var r=e.sPlusPlus,c=e.ZSEvents,a=c.topic,I=c.Groups,v=c.Names,u=e.ZSConstants.FeatureConstants,l=(e.UIUtil.Component,e.document,e.UserAction),S=(e.ZSConstants.I18N,e.ZSConstants.wCC),C=r.view.Toolbar.Feature[u.ITALIC],g=0;t(),C.execute=s}(this);
!function(e){function t(){c.register(I.Listener,u.SheetAction.ACTIVE_CELL.INFO,n,"RID","SHEETID","VERSION","VALUE")}function n(e,t,n,s){var i=r.data.getWorkBook(e,n),a=i.CellStyle.getStyleDef(s.Format);"solid"==a[7]?(S=1,o(!0)):(S=0,o(!1))}function o(){var e=document.getElementById(E.MI+v.UNDERLINE+E.IDENTITY);e&&(S?e.classList.add("shIconActive"):e.classList.remove("shIconActive"))}function s(e){var t=r.view.getActiveGridID(),n=r.view.getResourceID(t),o=(r.view.getSheetID(t),r.view.getVersionID(t)),s=r.view.getSelectedSheets(t);i(e,n,s,o)}function i(e,t,n,o){return e.repeat?void 0:(S=1==S?0:1,l.UNDERLINE(t,n,o,S),e.preventDefault(),e.stopPropagation(),!1)}var r=e.sPlusPlus,a=e.ZSEvents,c=a.topic,I=a.Groups,u=a.Names,v=e.ZSConstants.FeatureConstants,E=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),l=(e.UIUtil.Component,e.UserAction),D=r.view.Toolbar.Feature[v.UNDERLINE],S=0;t(),D.execute=s}(this);
!function(e){function t(){I.register(a.Listener,u.SheetAction.ACTIVE_CELL.INFO,n,"RID","SHEETID","VERSION","VALUE")}function n(e,t,n,o){var i=c.data.getWorkBook(e,n),r=i.CellStyle.getStyleDef(o.Format);T="solid"==r[6]?1:0,s(T)}function s(e){var t=document.getElementById(S.MI+v.STRIKETHROUGH+S.IDENTITY);t&&(e?t.classList.add("shIconActive"):t.classList.remove("shIconActive"))}function o(e){var t=c.view.getActiveGridID(),n=c.view.getResourceID(t),s=(c.view.getSheetID(t),c.view.getVersionID(t)),o=c.view.getSelectedSheets(t);i(e,n,o,s)}function i(e,t,n,s){e.repeat||(T=1==T?0:1,l.STRIKETHROUGH(t,n,s,T))}var c=e.sPlusPlus,r=e.ZSEvents,I=r.topic,a=r.Groups,u=r.Names,v=e.ZSConstants.FeatureConstants,S=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),l=(e.UIUtil.Component,e.UserAction),E=c.view.Toolbar.Feature[v.STRIKETHROUGH],T=0;t(),E.execute=o}(this);
!function(e){function t(){d.register(R.Selector.DomUpdate.Range,D.Selection.BOUND_UPDATE.ADD,K,"RID","SHEETID","VERSION","ActiveRange")}function n(){var e=S.action?S.action:_,t=r(e);E(t,e),i(w),d.unregister(R.Listener,D.SheetAction.MERGE_CELLS.ADD,n),d.unregister(R.Listener,D.SheetAction.MERGE_ACROSS.ADD,n)}function a(){i(F),d.unregister(R.Listener,D.SheetAction.MERGE_CELLS.REMOVE,a)}function i(e){var t=r(e);c(t);var n=o(e);s(n),_=e}function o(e){var t;switch(e){case w:t=b["MenuItem.HomeTab.Unmerge"];break;case N:t=b["MenuItem.HomeTab.Merge.Cells"];break;case U:t=b["MenuItem.HomeTab.MergeAndCenter"];break;case L:t=b["MenuItem.HomeTab.Merge.Down"];break;case O:t=b["MenuItem.HomeTab.Merge.Across"]}return t}function r(e){var t;switch(e){case w:t=H;break;case N:t=k;break;case U:t=V;break;case L:t=B;break;case O:t=y}var n=p.getTemplate([t]);return n[t]}function c(e){J.innerHTML="",J.appendChild(e)}function s(e){J.title=e}function E(e,t){j=e,F=t}function I(e,t,n,a){var o=M.data.getWorkBook(e,n),r=o.getSheetObj(t);if(a.isSingle())i(F),T.disable(q);else{if(T.enable(q),r.Merge.isIntersecting(a))return void i(w);i(a.isRowRange()&&F===L||a.isColRange()&&F===O?h:F)}}function u(e){var t=void 0!=e.action?e.action:_,i=M.view.getActiveGridID(),o=M.view.getResourceID(i),r=(M.view.getSheetID(i),M.view.getVersionID(i)),c=M.view.getSelectedSheets(i);t===w?(p.SplitRange(o,c,r,l),d.register(R.Listener,D.SheetAction.MERGE_CELLS.REMOVE,a)):(p.MergeRange(o,c,r,t),d.register(R.Listener,D.SheetAction.MERGE_CELLS.ADD,n),d.register(R.Listener,D.SheetAction.MERGE_ACROSS.ADD,n)),S=e}function g(){var e={id:A.SUBMENUITEM+v.MERGE+A.IDENTITY,"data-type":"list","data-content-type":"icon-text",relativeto:"parent"},t=[{type:"radio",data:'{"SVGIconId":"#'+Y+'","label":"'+b["MenuItem.HomeTab.Merge.Cells"]+'", "action": '+N+"}"},{type:"radio",data:'{"SVGIconId":"#'+W+'","label":"'+b["MenuItem.HomeTab.Merge.Across"]+'", "action": '+O+"}"},{type:"radio",data:'{"SVGIconId":"#'+x+'","label":"'+b["MenuItem.HomeTab.Merge.Down"]+'", "action": '+L+"}"},{type:"radio",data:'{"SVGIconId":"#'+Z+'","label":"'+b["MenuItem.HomeTab.MergeAndCenter"]+'", "action": '+U+"}"},{mtype:"separator"},{type:"radio",data:'{"SVGIconId":"#'+P+'","label":"'+b["MenuItem.HomeTab.Unmerge"]+'", "action": '+w+"}"}];M.view.Menu.create(t,e,G).then(function(){T.bind("#"+A.SUBMENUITEM+v.MERGE+A.IDENTITY,"zmenuitemclick",function(e,t){var n=t.menuitem.data();u(n.metadata)})})}function l(){var e=M.view.getActiveGridID(),t=M.view.getResourceID(e),n=M.view.getSheetID(e),a=M.view.getSheetState(e,n),i=a.getActiveCellRange(),o=M.view.getVersionID(e);d.publish(R.Selector.BoundUpdate.Cell,D.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,ActiveCellRange:i,ROW:i.startRow,COL:i.startCol,TYPE:void 0})}var S,M=e.sPlusPlus,m=e.ZSEvents,d=m.topic,R=m.Groups,D=m.Names,v=e.ZSConstants.FeatureConstants,C=e.document,b=e.ZSConstants.I18N,A=e.ZSConstants.wCC,T=e.UIUtil.Component,p=e.UserAction,G=C.getElementById("popupmenu"),f=M.view.Toolbar.Feature[v.MERGE],w=0,N=1,U=2,L=3,O=4,h=U,_=h,H="UNMERGE_ICON",k="MERGE_CELL_ICON",V="MERGE_CENTER_ICON",y="MERGE_ACROSS_ICON",B="MERGE_DOWN_ICON",P="unmergeIco",Y="mergeCellIco",Z="mergeCenterIco",W="mergeAcrossIco",x="mergeDownIco",F=(e.UIUtil,h),j=Z,z=!0,J=C.getElementById(A.MI+v.MERGE+A.IDENTITY),q=J.parentElement,K=JSUtil.fn.debounce(function(e,t,n,a){z&&I(e,t,n,a)},200);t(),g(),f.execute=u}(this);
!function(e){function t(){var e={id:u.SUBMENUITEM+d.SORT+u.IDENTITY,"data-type":"list","data-content-type":"icon-text"},t=[{id:u.SUBMENUITEM+d.SORT+u.IDENTITY+"_ASC",data:'{"SVGIconId" : "#ascendingIco", "label":"'+E["MenuItem.DataTab.Sort.SortAscending"]+'", "action": '+l+"}"},{id:u.SUBMENUITEM+d.SORT+u.IDENTITY+"_DSC",data:'{"SVGIconId" : "#descendingIco", "label":"'+E["MenuItem.DataTab.Sort.SortDescending"]+'", "action": '+v+"}"},{id:u.SUBMENUITEM+d.SORT+u.IDENTITY+"_CUSTOM",data:'{"SVGIconId" : "#customSortIco", "label":"'+E["MenuItem.DataTab.Sort.CustomSort"]+'", "action": '+b+"}"}];C||(T.view.Menu.create(t,e,s).then(function(){D.bind("#"+u.SUBMENUITEM+d.SORT+u.IDENTITY,"zmenuitemclick",function(e,t){n(e,t.data)}),D.bind("#"+u.SUBMENUITEM+d.SORT+u.IDENTITY,"zmenubeforeshow",function(){c()})}),C=!0)}function n(e,t){var n=t.action,a=T.view.getActiveGridID(),S=T.view.getResourceID(a),c=(T.view.getSheetID(a),T.view.getVersionID(a)),r=T.view.getSelectedSheets(a);switch(n){case l:i(S,r,c);break;case v:o(S,r,c);break;case b:I(S,r,c)}}function i(t,n,i){e.UserAction.Sort(t,n,i,["ASC"],!1,!1)}function o(t,n,i){e.UserAction.Sort(t,n,i,["DESC"],!1,!1)}function I(t,n,i){e.UserAction.Sort(t,n,i,[],!1,!0)}function a(e){if("TB_DATA_POPUP_CONTAINER"==e.id){var t=T.view.getActiveGridID(),n=T.view.getSheetID(t),i=T.view.getSheetState(t,n),o=T.view.getResourceID(t),I=i.getActiveRange(),a=T.view.getVersionID(t),S=T.data.getWorkBook(o,a),c=S.getSheetObj(n).ProtectedRanges.isIntersecting(I)||S.ProtectedSheets.isSheetLocked(n)?!0:!1;c?D.disable(e.querySelector("#"+u.MI+d.SORT+u.IDENTITY)):D.enable(e.querySelector("#"+u.MI+d.SORT+u.IDENTITY))}}function S(){for(var e=T.view.getActiveGridID(),t=T.view.getSheetID(e),n=T.view.getSheetState(e,t),i=n.getRanges(),o=0;o<i.length;o++){var I=i[o];if(I.endRow>I.startRow||I.endCol>I.startCol)return!0}return!1}function c(){S()?(D.enable("#"+u.SUBMENUITEM+d.SORT+u.IDENTITY+"_ASC"),D.enable("#"+u.SUBMENUITEM+d.SORT+u.IDENTITY+"_DSC")):(D.disable("#"+u.SUBMENUITEM+d.SORT+u.IDENTITY+"_ASC"),D.disable("#"+u.SUBMENUITEM+d.SORT+u.IDENTITY+"_DSC"))}var T=e.sPlusPlus,r=e.document,s=(e.UserAction,r.getElementById("popupmenu")),d=e.ZSConstants.FeatureConstants,E=e.ZSConstants.I18N,u=e.ZSConstants.wCC,D=e.UIUtil.Component,U=e.ZSEvents,M=U.topic,g=U.Groups,N=U.Names,l=0,v=1,b=2,C=!1;t();var R=JSUtil.fn.debounce(function(e){a(e)},200);M.register(g.UI,N.Toolbar.INIT_MENU,R,"DOM")}(this);
!function(e){function t(e){d=e,v&&(v.style.borderBottom="3px solid "+d)}function o(){var t=l.view.getActiveGridID(),o=l.view.getResourceID(t),r=l.view.getVersionID(t),n=(l.view.getSheetID(t),l.view.getSelectedSheets(t));e.UserAction.COLOR(o,n,r,d)}function r(){var t=O.getElementById(g.MI+C.FILL_COLOR+g.SPLIT+g.IDENTITY);w.bind(t,"zcolorchooserpick",function(t,o){var r=l.view.getActiveGridID(),n=l.view.getResourceID(r),i=(l.view.getSheetID(r),l.view.getVersionID(r)),c=l.view.getSelectedSheets(r),s="transparent"!=o.color?"#"+o.color:o.color;e.UserAction.COLOR(n,c,i,s),R.publish(D.Listener,I.FormatAction.ONCHANGE_FILLCOLOR,{COLOR_CODE:s})}),w.bind(t,"zcolorchoosercolorpanmouseover zcolorchoosernocolorbuttonmouseover",function(e,t){var o="transparent";t.colorpanData&&(o=t.colorpanData.color),c(o)}),w.bind(t,"zcolorchooserpickerclose",function(){s()}),w.bind(t,"zcolorchooserbeforepickeropen",function(){v&&(v.parentElement.style.backgroundColor="#F5F5F5");var e=a();e&&w.zcolorchooser(t,"setValue",e);var o=p.Entry.Menu.Context;p.focusContext(o)}),w.bind(t,"zcolorchooserbeforepickerclose",function(){e.document.activeElement.blur(),v&&(v.parentElement.style.backgroundColor=""),p.focusContext(p.Entry.CellEditor.Context)}),w.bind(t,"zcolorchoosercolorpanmouseout zcolorchoosernocolorbuttonmouseout",function(){s()})}function n(e,t,o,r,n){return"transparent"!==L?(n[S.BACKGROUNDCOLOR]=L,n[S.BORDER][0]||(n[S.BORDER][0]="transparent"),n[S.BORDER][1]||(n[S.BORDER][1]="transparent"),n[S.BORDER][2]||(n[S.BORDER][2]="transparent"),n[S.BORDER][3]||(n[S.BORDER][3]="transparent")):n[S.BACKGROUNDCOLOR]="#fff",n=ZSClass.CellDecorator.getStyle(n,r)}function i(e){var t=window.ZSEvents,o=t.topic,r=t.Groups,i=t.Names,c=l.view.getActiveGridID(),s=l.view.getResourceID(c),a=l.view.getSheetID(c),v=l.view.getVersionID(c);o.publish(r.Listener,i.Layers.Preview.Place,{RID:s,SHEETID:a,VERSION:v,RANGE:e,CALLBACK:n})}function c(e){L=e;var t=l.view.getActiveGridID(),o=l.view.getSheetID(t),r=l.view.getSheetState(t,o),n=r.getRanges();for(var c in n){var s=n[c];i(s)}}function s(){var e=window.ZSEvents,t=e.topic,o=e.Groups,r=e.Names,n=l.view.getActiveGridID(),i=l.view.getResourceID(n),c=l.view.getSheetID(n),s=l.view.getVersionID(n);t.publish(o.Listener,r.Layers.Preview.RemoveAll,{RID:i,SHEETID:c,VERSION:s})}function a(){var e,t=l.view.getActiveGridID(),o=l.view.getResourceID(t),r=l.view.getSheetID(t),n=l.view.getVersionID(t),i=(l.view.getSelectedSheets(t),l.data.getWorkBook(o,n)),c=l.view.getSheetState(t,r),s=c.getActiveRow(),a=c.getActiveCol(),v=l.view.getGridComponent(t),u=v.getCellRef(o,r,n,s,a);if(u){var R=u.data.Format,D=i.CellStyle.getStyleDef(R);e=D[0]}return e}var v,l=e.sPlusPlus,u=e.ZSEvents,R=u.topic,D=u.Groups,I=u.Names,C=e.ZSConstants.FeatureConstants,O=e.document,g=(e.ZSConstants.I18N,e.ZSConstants.wCC),w=e.UIUtil.Component,E=l.view.Toolbar.Feature[C.FILL_COLOR],d="#FCE6A4",p=l.view.Events.Key;!function(){v=O.getElementById(g.MI+C.FILL_COLOR+g.IDENTITY),v&&(v.style.borderBottom="3px solid "+d),R.register(D.Listener,I.FormatAction.ONCHANGE_FILLCOLOR,t,"COLOR_CODE"),r()}();var L,S={BACKGROUNDCOLOR:0,BORDER:11};E.quickAction=o}(this);
!function(e){function t(){f=document.getElementById(g.MI+E.TEXT_COLOR+g.IDENTITY),f&&(f.style.borderBottom="3px solid "+S),D.register(C.Listener,I.FormatAction.ONCHANGE_FONTCOLOR,o,"COLOR_CODE")}function o(e){S=e;var t=document.getElementById(g.MI+E.TEXT_COLOR+g.IDENTITY);t&&(t.style.borderBottom="3px solid "+S)}function r(){var t=O.view.getActiveGridID(),o=O.view.getResourceID(t),r=(O.view.getSheetID(t),O.view.getVersionID(t)),n=O.view.getSelectedSheets(t);e.UserAction.TEXTCOLOR(o,n,r,S)}function n(){D.register(C.Listener,I.SheetAction.ACTIVE_CELL.INFO,i,"VALUE")}function i(e){p=e.styleName[1],""===p&&(p="#000000")}function c(){var t=document.getElementById(g.MI+E.TEXT_COLOR+g.SPLIT+g.IDENTITY);w.bind(t,"zcolorchooserpick",function(t,o){"default"==o.color&&(o.color="#000000"),p="#"+o.color;var r=O.view.getActiveGridID(),n=O.view.getResourceID(r),i=(O.view.getSheetID(r),O.view.getVersionID(r)),c=O.view.getSelectedSheets(r);e.UserAction.TEXTCOLOR(n,c,i,p),D.publish(C.Listener,I.FormatAction.ONCHANGE_FONTCOLOR,{COLOR_CODE:p})}),w.bind(t,"zcolorchoosercolorpanmouseover zcolorchooserdefaultcolorbuttonmouseover",function(e,t){var o="#000";t.colorpanData&&(o=t.colorpanData.color),l(o)}),w.bind(t,"zcolorchooserpickerclose",function(){v()}),w.bind(t,"zcolorchooserbeforepickeropen",function(){f&&(f.parentElement.style.backgroundColor="#F5F5F5");var e=u();w.zcolorchooser(t,"setValue",e?e:"#000000");var o=L.Entry.Menu.Context;L.focusContext(o)}),w.bind(t,"zcolorchooserbeforepickerclose",function(){e.document.activeElement.blur(),f&&(f.parentElement.style.backgroundColor="")}),w.bind(t,"zcolorchoosercolorpanmouseout zcolorchooserdefaultcolorbuttonmouseout",function(){v()})}function s(e,t,o,r,n){return n[A.COLOR]=m,n=ZSClass.CellDecorator.getStyle(n,r),n[A.BACKGROUNDCOLOR]&&!n[A.BORDER][0]&&(n[A.BORDER][0]="transparent"),n[A.BACKGROUNDCOLOR]&&!n[A.BORDER][1]&&(n[A.BORDER][1]="transparent"),n[A.BACKGROUNDCOLOR]&&!n[A.BORDER][2]&&(n[A.BORDER][2]="transparent"),n[A.BACKGROUNDCOLOR]&&!n[A.BORDER][3]&&(n[A.BORDER][3]="transparent"),n}function a(e){var t=window.ZSEvents,o=t.topic,r=t.Groups,n=t.Names,i=O.view.getActiveGridID(),c=O.view.getResourceID(i),a=O.view.getSheetID(i),l=O.view.getVersionID(i);o.publish(r.Listener,n.Layers.Preview.Place,{RID:c,SHEETID:a,VERSION:l,RANGE:e,CALLBACK:s})}function l(e){m=e;var t=O.view.getActiveGridID(),o=O.view.getSheetID(t),r=O.view.getSheetState(t,o),n=r.getRanges();for(var i in n){var c=n[i];a(c)}}function v(){var e=window.ZSEvents,t=e.topic,o=e.Groups,r=e.Names,n=O.view.getActiveGridID(),i=O.view.getResourceID(n),c=O.view.getSheetID(n),s=O.view.getVersionID(n);t.publish(o.Listener,r.Layers.Preview.RemoveAll,{RID:i,SHEETID:c,VERSION:s})}function u(){var e,t=O.view.getActiveGridID(),o=O.view.getResourceID(t),r=O.view.getSheetID(t),n=O.view.getVersionID(t),i=(O.view.getSelectedSheets(t),O.data.getWorkBook(o,n)),c=O.view.getSheetState(t,r),s=c.getActiveRow(),a=c.getActiveCol(),l=O.view.getGridComponent(t),v=l.getCellRef(o,r,n,s,a);if(v){var u=v.data.Format,R=i.CellStyle.getStyleDef(u);e=R[1]}return e}var O=e.sPlusPlus,R=e.ZSEvents,D=R.topic,C=R.Groups,I=R.Names,E=e.ZSConstants.FeatureConstants,g=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),w=e.UIUtil.Component,d=O.view.Toolbar.Feature[E.TEXT_COLOR],S="#E31414",L=O.view.Events.Key;t();var f,p;n(),c();var m,A={BACKGROUNDCOLOR:0,COLOR:1,BORDER:11};d.quickAction=r}(this);
!function(e){function t(e){return d||(d=h.createElement("div"),d.className="shIcon shMoreMenuIcon",d.id=y.MI+g.TOOLBAR_RESIZE+y.IDENTITY,f=h.createElement("span"),f.className="shMoreMenuPtr",d.appendChild(f),r(f,!1),d.addEventListener("click",function(){if(B){r(c,!0),d.classList.add("shIconActive");var e=d.offsetLeft+d.clientWidth,t=d.offsetParent.offsetTop+d.offsetTop+30;if(c.style.top=t+"px",r(f,!0),u>=850)c.style.removeProperty("left"),c.style.right=u-e-20+"px";else{c.style.removeProperty("right");var i=c.offsetWidth,n=u-i,s=n/2;c.style.left=s+"px"}B=!1}else r(f,!1),r(c,!1),d.classList.remove("shIconActive"),B=!0}),i(),e.appendChild(d)),d}function i(){c=h.createElement("ul"),c.id=y.SUBMENUITEM+g.TOOLBAR_RESIZE+y.IDENTITY,c.className="shMoreMenu shIconsHldr",h.body.appendChild(c)}function n(i){var f=v.view.getActiveGridID(),p=v.view.getVersionID(f);p==v.data.Defaults.version&&(u=h.body.clientWidth,e.clearTimeout(a),a=e.setTimeout(function(){l();var e=h.querySelector(".shTopMenu"),a=v.view.getViewMenu().TBObject.quickAccessContainer,u=e.querySelector(".shFindBar"),f=e.offsetWidth,p=a.offsetWidth,y=u.offsetWidth;if(p+y+C>f&&"remove"!=i){var g=s(a.lastElementChild,d);if(g){g.childElementCount<=1&&r(g,!1);var B=g.lastElementChild;L.push({ButtonSet:g,Element:B}),d=t(a),T=!0,r(d,!0),c.appendChild(B),n("add")}}else if(T){var M=L.length;if(M>0&&"add"!=i){var w=L[M-1].ButtonSet,b=L[M-1].Element;o(c,!1),r(c,!0);var A=a.offsetWidth+b.offsetWidth+C+y;if(o(c,!0),r(c,!1),f>A){var N=w.style.display,P="none"==N?!0:!0;r(w,P),w.appendChild(b),L.splice(M-1,1),0==L.length?(r(d,!1),L=[],T=!1):n("remove")}}}else L=[],T=!1,d&&r(d,!1);S&&(m.unregister(E.Listener,I.Browser.UIPageLoad,n),S=!1)},0))}function s(e,t){e===t&&(e=e.previousElementSibling);var i=e;if(0!=i.childElementCount)return i;var n=i.previousElementSibling;return null!=n?s(n,t):void 0}function r(e,t){e.style.display=t?"":"none"}function o(e,t){e.style.visibility=t?"visible":"hidden"}function l(){c&&r(c,!1),f&&r(f,!1),d&&d.classList.remove("shIconActive"),B=!0}var a,d,c,u,f,v=e.sPlusPlus,h=e.document,p=e.ZSEvents,m=p.topic,E=p.Groups,I=p.Names,y=e.ZSConstants.wCC,g=e.ZSConstants.FeatureConstants,C=(v.view.Toolbar.Feature[g.TOOLBAR_RESIZE],h.getElementById("popupmenu"),100),T=!1,L=[],S=!0,B=!0;m.register(E.Listener,I.Browser.RESIZE,n),m.register(E.Listener,I.Browser.UIPageLoad,n),m.register(E.Listener,I.ContextMenu.INIT,l)}(this);
!function(t){function n(t,n,s,o,e){i.invokeRecastAction(t,n,s,o,e)}var s=t.sPlusPlus,o=t.ZSEvents,e=(o.topic,o.Groups,o.Names,t.ZSConstants.FeatureConstants),i=(t.document,t.UserAction),a=(t.ZSConstants.wCC,t.UIUtil.Component,s.view.Toolbar.Feature[e.RECAST]);a.recastAction=n}(this);
!function(e){function t(e){var t={id:g.SUBMENUITEM+r.HALIGN+g.IDENTITY,"data-type":"list","data-content-type":"icon-text"},I=[{data:'{"label":"'+u["MenuItem.Horizontal.Alignment"]+'", "itemType": "itemgroup"}'},{id:g.MI+r.HALIGN+"_LEFT"+g.IDENTITY,data:'{"SVGIconId":"#alignmentIco","label":"'+u["MenuItem.HomeTab.Align.Left"]+'", "direction":"left", "align":"halign", "itemType":"radio"}'},{id:g.MI+r.HALIGN+"_CENTER"+g.IDENTITY,data:'{"SVGIconId":"#centerAlignIco","label":"'+u["MenuItem.HomeTab.Align.Center"]+'", "direction":"center", "align":"halign", "itemType":"radio"}'},{id:g.MI+r.HALIGN+"_RIGHT"+g.IDENTITY,data:'{"SVGIconId":"#rightAlignIco","label":"'+u["MenuItem.HomeTab.Align.Right"]+'", "direction":"right", "align":"halign", "itemType":"radio"}'},{data:'{"label":"'+u["MenuItem.Vertical.Alignment"]+'", "itemType": "itemgroup"}'},{id:g.MI+r.VALIGN+"_TOP"+g.IDENTITY,data:'{"SVGIconId":"#topAlignIco","label":"'+u["MenuItem.HomeTab.Align.Top"]+'", "direction":"top", "align":"valign", "itemType":"radio"}'},{id:g.MI+r.VALIGN+"_MIDDLE"+g.IDENTITY,data:'{"SVGIconId":"#middleAlignIco","label":"'+u["MenuItem.HomeTab.Align.Middle"]+'", "direction":"middle", "align":"valign", "itemType":"radio"}'},{id:g.MI+r.VALIGN+"_BOTTOM"+g.IDENTITY,data:'{"SVGIconId":"#bottomAlignIco","label":"'+u["MenuItem.HomeTab.Align.Bottom"]+'", "direction":"bottom", "align":"valign", "itemType":"radio"}'}];l.view.Menu.create(I,t,e).then(function(){s.bind("#"+g.SUBMENUITEM+r.HALIGN+g.IDENTITY,"zmenuitemclick",function(e,t){var I=t.data.direction,i=l.view.getActiveGridID(),n=l.view.getResourceID(i),a=l.view.getVersionID(i),o=(l.view.getSheetID(i),l.view.getSelectedSheets(i));"halign"==t.data.align?c.HALIGN(n,o,a,I):c.VALIGN(n,o,a,I)})}),i(),s.bind("#"+g.SUBMENUITEM+r.HALIGN+g.IDENTITY,"zmenubeforeshow",function(){a()})}function I(){o=void 0}function i(){E.register(m.Listener,A.SheetAction.ACTIVE_CELL.INFO,n,"RID","SHEETID","VERSION","VALUE")}function n(e,t,I,i){var n=l.data.getWorkBook(e,I);o=n.CellStyle.getStyleDef(i.Format)[9],T=n.CellStyle.getStyleDef(i.Format)[10],o||"FLOAT"!=i.CellType||(o="end")}function a(){var e="#"+g.MI+r.HALIGN+"_LEFT"+g.IDENTITY,t="#"+g.MI+r.VALIGN+"_TOP"+g.IDENTITY;if(o)switch(o){case"start":e="#"+g.MI+r.HALIGN+"_LEFT"+g.IDENTITY;break;case"center":e="#"+g.MI+r.HALIGN+"_CENTER"+g.IDENTITY;break;case"end":e="#"+g.MI+r.HALIGN+"_RIGHT"+g.IDENTITY}if(T)switch(T){case"top":t="#"+g.MI+r.VALIGN+"_TOP"+g.IDENTITY;break;case"middle":t="#"+g.MI+r.VALIGN+"_MIDDLE"+g.IDENTITY;break;case"bottom":t="#"+g.MI+r.VALIGN+"_BOTTOM"+g.IDENTITY}var I=document.getElementById(g.SUBMENUITEM+r.HALIGN+g.IDENTITY).querySelectorAll("li");I.forEach(function(e){e.id&&s.zmenu("#"+g.SUBMENUITEM+r.HALIGN+g.IDENTITY,"setMenuItemsAttribute",["#"+e.id],"checked",!1)}),s.zmenu("#"+g.SUBMENUITEM+r.HALIGN+g.IDENTITY,"setMenuItemsAttribute",[e],"checked",!0),s.zmenu("#"+g.SUBMENUITEM+r.HALIGN+g.IDENTITY,"setMenuItemsAttribute",[t],"checked",!0)}var o,T,l=e.sPlusPlus,d=e.document,c=e.UserAction,r=e.ZSConstants.FeatureConstants,N=e.ZSEvents,E=N.topic,m=N.Groups,A=N.Names,M=d.getElementById("popupmenu"),u=e.ZSConstants.I18N,g=e.ZSConstants.wCC,s=e.UIUtil.Component;t(M),l.view.SubMenu.transient[r.HALIGN]=t,l.view.Toolbar.transient.destructor[r.HALIGN]=I}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getVersionID(e),n=s.view.getSelectedSheets(e);UserAction.HyperLink(t,n,i,"remove",null,null)}function i(e){if(e.id==v.TB+"INSERT"+v.POPUP+v.CONTAINER){var t=s.view.getActiveGridID(),i=s.view.getSheetID(t),o=s.view.getSheetState(t,i),r=s.view.getResourceID(t),a=o.getActiveRange(),g=s.view.getVersionID(t),S=s.data.getWorkBook(r,g),c=S.getSheetObj(i).ProtectedRanges.isIntersecting(a)||S.ProtectedSheets.isSheetLocked(i)?!0:!1;c||!I.isSingleCell()?l.disable("#"+v.MI+n.HYPERLINK+v.IDENTITY):l.enable("#"+v.MI+n.HYPERLINK+v.IDENTITY)}}var s=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,o=e.ZSEvents,r=o.topic,a=o.Groups,g=o.Names,I=(e.ZSConstants.CommandConstants,s.view.Toolbar.Feature[n.HYPERLINK]),v=e.ZSConstants.wCC,l=e.UIUtil.Component;I.isSingleCell=function(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),n=s.view.getSheetState(e,i),o=n.getRanges(),r=o[0],a=s.view.getVersionID(e),g=s.data.getWorkBook(t,a),I=g.getSheetObj(i),v=I.Merge.getInfo(r.startRow,r.startCol);return r.isSingle()||v&&v.equals(r)?!0:!1},r.register(a.UI,g.Toolbar.INIT_MENU,i,"DOM"),I.Clear=t}(this);
!function(e){function t(t,n){var o=v.children[0].getAttribute("category")+" "+zoho.color.rgbToHex(h),r=I.view.getActiveGridID(),i=I.view.getResourceID(r),s=(I.view.getSheetID(r),I.view.getVersionID(r)),c=I.view.getSelectedSheets(r),a=n?n.bt:w;w=a,e.UserAction.BORDER(i,c,s,a,o),n&&f.publish(C.Listener,g.FormatAction.ONCHANGE_BORDER_DATA,{BORDER_INFO:n})}function n(n){O.bind(n,"zcolorselectboxpick",function(e,n){if(h=n.rgb,p){var o={bt:p};t(e,o)}}),O.bind(n,"zcolorselectboxpickeropen",function(e,t){var n=t.picker;n.css("zIndex",1e5)}),O.bind(n,"zcolorselectboxbeforepickeropen",function(){var e=B.Entry.Menu.Context;B.focusContext(e)}),O.bind(n,"zcolorselectboxbeforepickerclose",function(){e.document.activeElement.blur()}),UIUtil.Component.initComponent(n)}function o(){D=document.getElementById(A.MI+y.BORDER+A.IDENTITY);var e=UserAction.getTemplate(["BORDER_TEMPLATE"]),t=e.BORDER_TEMPLATE.querySelector("#borderMenu");E=t,T.appendChild(t),D.setAttribute("data-content","#borderMenu"),D.setAttribute("data-is-content-html-encoded",!0),D.setAttribute("data-class-name","bdrpop"),O.bind(D,"zpopoverbeforeopen",function(){var e=I.view.getActiveGridID(),t=I.view.getGridDom(e);t.classList.add("rangeBdrRmv")}),O.bind(D,"zpopoverbeforeclose",function(){p=void 0,d.style.display="none",L=!1;var e=I.view.getActiveGridID(),t=I.view.getGridDom(e);t.classList.remove("rangeBdrRmv")}),O.zpopover(D),s(E)}function r(e){e.stopPropagation();var n=this.innerHTML;if(v.innerHTML=n,v.children[0].id="bSa",d.style.display="none",p){var o={bt:p};t(e,o)}}function i(e){p=this.getAttribute("bt");var n={bt:p};t(e,n)}function s(e){d=e.querySelector("#bdrDrpDwn"),u=e.querySelector("#sbF"),v=e.querySelector("#bdrSelBox"),b=e.querySelector("#dropDownPart");var t=e.querySelector("#borderVariety");u.addEventListener("click",c),e.addEventListener("click",a);for(var o=e.querySelector("#bdrDrpDwnList").children,s=0;s<o.length;s++)o[s].addEventListener("click",r);o=t.children;for(var s=0;s<o.length;s++)o[s].addEventListener("click",i);n(e.querySelector("#borderColorPalette"))}function c(){L?(d.style.display="none",L=!1):(d.style.display="block",L=!0)}function a(e){L&&-1==e.path.indexOf(b)&&(d.style.display="none",L=!1)}function l(e){var t=e.relatedPaneId;"TB_HOME_CONTAINER"==t&&setTimeout(function(){document.querySelector("#menuitem_"+A.MI+y.BORDER+A.IDENTITY)},100)}var d,u,v,b,p,E,D,I=e.sPlusPlus,R=e.document,m=e.ZSEvents,f=m.topic,C=m.Groups,g=m.Names,y=e.ZSConstants.FeatureConstants,T=(e.ZSConstants.ActionConstants,R.getElementById("popupmenu")),O=e.UIUtil.Component,A=(e.ZSConstants.I18N,e.ZSConstants.wCC),S=I.view.Toolbar.Feature[y.BORDER],B=I.view.Events.Key,h="rgb(0, 0, 0)",w=17,L=!1;S.execute=t,f.register(C.UI,g.Layout.TEMPLATE_LOADED,o),f.register(C.UI,g.Toolbar.DROPDOWN_CLICK,l,"UI")}(this),function(e){function t(){i.register(s.Listener,c.FormatAction.ONCHANGE_BORDER_DATA,n,"BORDER_INFO")}function n(e){var t=p?p.parentElement.parentElement:void 0;b=e.bt;var n="#"+t.id;u.zbutton(n,"changeIcon",{primary:e.icon},"#"+d.MI+a.BORDER+d.IDENTITY)}{var o=e.sPlusPlus,r=e.ZSEvents,i=r.topic,s=r.Groups,c=r.Names,a=e.ZSConstants.FeatureConstants,l=e.document,d=(e.ZSConstants.I18N,e.ZSConstants.wCC),u=e.UIUtil.Component,v=e.ZSConstants.ActionConstants,b=v.BORDER_BOTTOM;o.view.Toolbar.Feature[a.BORDER]}t();var p=l.getElementById(d.MI+a.BORDER+d.IDENTITY)}(this);
!function(e){function t(e){e&&e[o.DATE]&&(e=e[o.DATE],n.view.SubMenu.transient[s.DATE](e))}{var n=e.sPlusPlus,i=e.ZSEvents,a=i.topic,r=i.Groups,u=i.Names,s=e.ZSConstants.FeatureConstants,o=(e.document,e.UserAction,e.ZSConstants.wCC,e.ZSConstants.CommandConstants);e.UIUtil.Component}a.register(r.Listener,u.DocMeta.DOC_SETTINGS,t,"DOC_SETTINGS")}(this),function(e){function t(e){var t=e[M.FORMAT_DATE],a=e[M.TIME],r=e[M.TIME_DURATION],u=e[M.DEFAULT_DATETIME],s=e[M.DATETIME];n(t,s,u),i(a,r)}function n(e,t,n){var i=!1;D?(D.innerHTML="",i=!0):(D=document.createElement("ul"),D.id=S.SUBMENUITEM+d.DATE+S.IDENTITY,D.setAttribute("data-mtype","submenu"),v.appendChild(D)),a("Date",p["MenuItem.FormatTab.Date"],e,D),a("DateTime",p["MenuItem.FormatTab.DateAndTime"],n.concat(t),D),i&&(b.zmenu(D,"destroy"),b.zmenu(D))}function i(e,t){var n=!1;m?(m.innerHTML="",n=!0):(m=document.createElement("ul"),m.id=S.SUBMENUITEM+"DURATION"+S.IDENTITY,m.setAttribute("data-mtype","submenu"),v.appendChild(m)),a("Time",p["MenuItem.FormatTab.Time"],e,m),a("Time",p["MenuItem.FormatTab.Duration"],t,m),n&&(b.zmenu(m,"destroy"),b.zmenu(m))}function a(e,t,n,i){var a=document.createElement("li");a.setAttribute("data",'{"label":"'+t+'"}'),a.setAttribute("data-item-type","itemgroup"),i.appendChild(a),r(n,e,i)}function r(e,t,n){if(e)for(var i=e.length-1;i>=0;i--)if(void 0!=e[i])for(var a in e[i]){var r=e[i][a],s='{"label":"'+a+'"}',o=document.createElement("li");o.setAttribute("data",s),o.setAttribute("data-shortcutkey",r),o.setAttribute("data-skip-shortcut-format",!0),o.addEventListener("click",u.bind(null,t,r)),n.appendChild(o)}}function u(t,n){var i=I.view.getActiveGridID(),a=I.view.getResourceID(i),r=(I.view.getSheetID(i),I.view.getVersionID(i)),u=I.view.getSelectedSheets(i);e.UserAction.FORMAT_DATE(a,u,r,t,n)}function s(e,t){t.preventDefault();var n=I.view.getActiveGridID(),i=I.view.getResourceID(n),a=I.view.getSheetID(n),r=I.view.getVersionID(n),u=I.view.getSheetState(n,a),s=(I.view.getSelectedSheets(n),u.getRanges()),o=(s[0],"");o="TIME"==e?w.Date.currentTime():"DATEANDTIME"==e?w.Date.currentDate(l,A)+" "+w.Date.currentTime():w.Date.currentDate(l,A),g.publish(U.Gesture.Selector.CellEdit,N.GESTURE.ACTION.ACTUATE,{RID:i,SHEETID:a,VERSION:r}),g.publish(U.Listener,N.CellAction.VALUE.SET,{RID:i,SHEETID:a,VERSION:r,ROW:u.getActiveRow(),COL:u.getActiveCol(),VALUE:{DisplayValue:o},FOCUS:!0})}function o(e){s("DATE",e)}function T(e){s("TIME",e)}function E(e){s("DATEANDTIME",e)}function c(e,t){e&&(A=e,l=t)}var D,m,A,l,I=e.sPlusPlus,d=e.ZSConstants.FeatureConstants,C=e.document,S=e.ZSConstants.wCC,v=C.getElementById("popupmenu"),p=e.ZSConstants.I18N,M=e.ZSConstants.CommandConstants,b=e.UIUtil.Component,f=e.ZSEvents,g=f.topic,U=f.Groups,w=e.JSUtil,N=f.Names,O=I.view.Toolbar.Feature[d.DATE];O.execute=o,O.currentDate=o,O.currentTime=T,O.currentDateAndTime=E,g.register(U.Listener,N.DocMeta.DOCUMENT_LOCALE,c,"DATE_SEPARATOR","LOCALE_DATEFORMAT"),I.view.SubMenu.transient[d.DATE]=t}(this);
!function(e){function t(e){if(e&&e[N.CURRENCY]){r=e[N.CURRENCY];var t=r[N.WORKBOOKLOCALE].language,n=r[N.WORKBOOKLOCALE].country;U=t+"_"+n,r.currencyType=U,m&&d.doToolbarAction(m.id,{item:c.CURRENCY,action:"changeLabel",callback:function(){d.zbutton(m,"changeLabel",r[N.CURRENCYSYMBOL],v.id),document.querySelector("#"+v.id).title=l[r[N.CURRENCYNAME]]}}),o.view.SubMenu.transient[c.CURRENCY](r)}}function n(e){e.type&&(d.zbutton(m,"changeLabel",e.iconText,v.id),document.querySelector("#"+v.id).title=e.label,U=e.type)}function i(){var t=o.view.getActiveGridID(),n=o.view.getResourceID(t),i=(o.view.getSheetID(t),o.view.getVersionID(t)),r=o.view.getSelectedSheets(t);e.UserAction.FORMAT_CURRENCY(n,r,i,U)}var r,o=e.sPlusPlus,a=e.ZSEvents,C=a.topic,s=a.Groups,u=a.Names,c=e.ZSConstants.FeatureConstants,R=e.document,l=e.ZSConstants.I18N,E=e.ZSConstants.wCC,d=e.UIUtil.Component,N=e.ZSConstants.CommandConstants,U="en_US",d=e.UIUtil.Component,S=o.view.Toolbar.Feature[c.CURRENCY],v=R.getElementById(E.MI+c.CURRENCY+E.IDENTITY),m=v&&v.parentElement;S.execute=i,C.register(s.Listener,u.DocMeta.DOC_SETTINGS,t,"DOC_SETTINGS"),C.register(s.Listener,u.FormatAction.ONCHANGE_CURRENCY,n,"CURRENCY_INFO")}(this),function(e){function t(e){var t=e[d.LOCALUTILCURSYMBOLS][0],i=e[d.CURRENCYSYMBOL],o=e[d.CURRENCYNAME],C=!1;a?(a.innerHTML="",C=!0):(a=s.createElement("li"),a.id=c.SUBMENUITEM+u.CURRENCY+c.IDENTITY,a.setAttribute("data-content-type","icon-text"),a.setAttribute("data-ctype","zmenu"),N.appendChild(a));var E=r(t,i);E||n(e.currencyType,i,R[o]),n("en_US",t.USD,R["Format.Currency.USDollar"]),n("en_DE",t.EUR,R["Format.Currency.Euro"]),n("en_GB",t.GBP,R["Format.Currency.BritishPound"]),n("en_JP",t.CNY,R["Format.Currency.ChineseYuan"]),n("en_IN",t.INR,R["Format.Currency.IndianRupee"]),N.appendChild(a),C&&(l.zmenu(a,"destroy"),l.zmenu(a))}function n(e,t,n){var r=s.createElement("li");r.setAttribute("data-icon-text",t),r.setAttribute("data-label",n),r.addEventListener("click",i.bind(null,e,t,n)),a.appendChild(r)}function i(t){var n=C.view.getActiveGridID(),i=C.view.getResourceID(n),r=(C.view.getSheetID(n),C.view.getVersionID(n)),o=C.view.getSelectedSheets(n);e.UserAction.FORMAT_CURRENCY(i,o,r,t)}function r(e,t){for(var n in e){var i=e[n];if(i==t)return!0}return!1}function o(){}{var a,C=e.sPlusPlus,s=e.document,u=e.ZSConstants.FeatureConstants,c=e.ZSConstants.wCC,R=e.ZSConstants.I18N,l=e.UIUtil.Component,E=e.ZSEvents,d=(E.topic,E.Groups,E.Names,e.ZSConstants.CommandConstants),N=s.getElementById("popupmenu");C.view.Toolbar.Feature[u.CURRENCY]}C.view.SubMenu.transient[u.CURRENCY]=t,C.view.Toolbar.transient.destructor[u.CURRENCY]=o}(this);
!function(e){function t(e){if(e&&e[d.CURRENCY]){i=e[d.CURRENCY];var t=i[d.WORKBOOKLOCALE].language,n=i[d.WORKBOOKLOCALE].country;T=t+"_"+n,i.currencyType=T,S&&U.doToolbarAction(S.id,{item:c.ACCOUNTING,action:"changeLabel",callback:function(){U.zbutton(S,"changeLabel",i[d.CURRENCYSYMBOL],O.id),document.querySelector("#"+O.id).title=I[i[d.CURRENCYNAME]]}}),r.view.SubMenu.transient[c.ACCOUNTING](i)}}function n(e){e.type&&(U.zbutton(S,"changeLabel",e.iconText,O.id),document.querySelector("#"+O.id).title=e.label,T=e.type)}function C(){var t=r.view.getActiveGridID(),n=r.view.getResourceID(t),C=(r.view.getSheetID(t),r.view.getVersionID(t)),i=r.view.getSelectedSheets(t);e.UserAction.FORMAT_ACCOUNTING(n,i,C,T)}var i,r=e.sPlusPlus,o=e.ZSEvents,a=o.topic,s=o.Groups,u=o.Names,c=e.ZSConstants.FeatureConstants,N=e.document,I=e.ZSConstants.I18N,l=e.ZSConstants.wCC,U=e.UIUtil.Component,d=e.ZSConstants.CommandConstants,T="en_US",U=e.UIUtil.Component,A=r.view.Toolbar.Feature[c.ACCOUNTING],O=N.getElementById(l.MI+c.ACCOUNTING+l.IDENTITY),S=O&&O.parentElement;A.execute=C,a.register(s.Listener,u.DocMeta.DOC_SETTINGS,t,"DOC_SETTINGS"),a.register(s.Listener,u.FormatAction.ONCHANGE_CURRENCY,n,"CURRENCY_INFO")}(this),function(e){function t(e){var t=e[U.LOCALUTILCURSYMBOLS][0],C=e[U.CURRENCYSYMBOL],r=e[U.CURRENCYNAME],a=!1;o?(o.innerHTML="",a=!0):(o=s.createElement("li"),o.id=c.SUBMENUITEM+u.ACCOUNTING+c.IDENTITY,o.setAttribute("data-content-type","icon-text"),o.setAttribute("data-ctype","zmenu"),d.appendChild(o));var l=i(t,C);l||n(e.currencyType+"_ACCOUNTING",C,N[r]),n("en_US_ACCOUNTING",t.USD,N["Format.Currency.USDollar"]),n("en_DE_ACCOUNTING",t.EUR,N["Format.Currency.Euro"]),n("en_GB_ACCOUNTING",t.GBP,N["Format.Currency.BritishPound"]),n("en_JP_ACCOUNTING",t.CNY,N["Format.Currency.ChineseYuan"]),n("en_IN_ACCOUNTING",t.INR,N["Format.Currency.IndianRupee"]),d.appendChild(o),a&&(I.zmenu(o,"destroy"),I.zmenu(o))}function n(e,t,n){var i=s.createElement("li");i.setAttribute("data-icon-text",t),i.setAttribute("data-label",n),i.addEventListener("click",C.bind(null,e,t,n)),o.appendChild(i)}function C(t){var n=a.view.getActiveGridID(),C=a.view.getResourceID(n),i=(a.view.getSheetID(n),a.view.getVersionID(n)),r=a.view.getSelectedSheets(n);e.UserAction.FORMAT_ACCOUNTING(C,r,i,t)}function i(e,t){for(var n in e){var C=e[n];if(C==t)return!0}return!1}function r(){}{var o,a=e.sPlusPlus,s=e.document,u=e.ZSConstants.FeatureConstants,c=e.ZSConstants.wCC,N=e.ZSConstants.I18N,I=e.UIUtil.Component,l=e.ZSEvents,U=(l.topic,l.Groups,l.Names,e.ZSConstants.CommandConstants),d=s.getElementById("popupmenu");a.view.Toolbar.Feature[u.CURRENCY]}a.view.SubMenu.transient[u.ACCOUNTING]=t,a.view.Toolbar.transient.destructor[u.ACCOUNTING]=r}(this);
!function(e){function t(){a.register(s.Listener,E.SheetAction.ACTIVE_CELL.INFO,n,"RID","SHEETID","VERSION","VALUE")}function n(e,t,n,o){var i=void 0!=o?o.CellType:"",l="PERCENTAGE"===i?"check":"uncheck",a=C.getElementById(u.MI+c.PERCENTAGE+u.IDENTITY);a&&r.doToolbarAction(a.parentElement.id,{item:c.PERCENTAGE,action:l,callback:function(){r.zbutton("#"+a.parentElement.id,l,"#"+a.id)}})}function o(){var t,n=i.view.getActiveGridID(),o=i.view.getResourceID(n),l=i.view.getSheetID(n),a=i.view.getVersionID(n),s=i.view.getSheetState(n,l),E=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],c=s.Cell,r=c.row,C=c.col,u=function(e){t=e[r][C]},T=function(t){e.ZSClass.Logger.log("couldn't retrieve data",t)};i.view.fetchCellData(o,l,a,r,C,E,n,u,T);var v=void 0!=t?t.CellType:"",A=i.view.getSelectedSheets(n);"PERCENTAGE"===v?e.UserAction.FORMAT_PERCENT(o,A,a,"STANDARD"):e.UserAction.FORMAT_PERCENT(o,A,a)}var i=e.sPlusPlus,l=e.ZSEvents,a=l.topic,s=l.Groups,E=l.Names,c=e.ZSConstants.FeatureConstants,r=e.UIUtil.Component,C=e.document,u=(e.ZSConstants.I18N,e.ZSConstants.wCC),r=(e.ZSConstants.JSKeyCode,e.UIUtil.Component),T=i.view.Toolbar.Feature[c.PERCENTAGE];t("register"),T.execute=o}(this);
!function(e){function t(e){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),o=s.view.getVersionID(t),r=s.view.getSheetID(t);i(e,n,r,o)}function i(t,i,n,o){if(!t.repeat){var r=s.view.getActiveGridID(),u=s.view.getSelectedSheets(r);e.UserAction.FORMAT_INCREMENT_DECIMAL(i,u,o)}}var s=e.sPlusPlus,n=e.ZSEvents,o=(n.topic,n.Groups,n.Names,e.ZSConstants.FeatureConstants),r=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component,s.view.Toolbar.Feature[o.INCREASE_DEC]);r.execute=t,r.ShortCut=t}(this);
!function(e){function t(e){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),o=s.view.getVersionID(t),r=s.view.getSheetID(t);i(e,n,r,o)}function i(t,i,n,o){if(!t.repeat){var r=s.view.getActiveGridID(),u=s.view.getSelectedSheets(r);e.UserAction.FORMAT_DECREMENT_DECIMAL(i,u,o)}}var s=e.sPlusPlus,n=e.ZSEvents,o=(n.topic,n.Groups,n.Names,e.ZSConstants.FeatureConstants),r=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component,s.view.Toolbar.Feature[o.DECREASE_DEC]);r.execute=t,r.ShortCut=t}(this);
!function(e){function t(){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=(s.view.getSheetID(t),s.view.getVersionID(t)),o=s.view.getSelectedSheets(t);e.UserAction.FORMAT_TEXT(n,o,i)}var s=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,i=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component,e.ZSEvents),o=(i.topic,i.Groups,i.Names,s.view.Toolbar.Feature[n.SET_AS_TEXT]);o.execute=t}(this);
!function(e){function t(e){if(e&&e[O.DECIMAL_SEPARATOR]){D.innerHTML="";var t=e[O.DECIMAL_SEPARATOR],n=v[t.codePointAt(0)],s=UserAction.getTemplate([n]);D.appendChild(s[n])}}function n(){C.register(A.Listener,S.SheetAction.ACTIVE_CELL.INFO,s,"RID","SHEETID","VERSION","VALUE")}function s(e,t,n,s){var i=s.Pattern;E=i&&i[O.ISGROUPINGUSED]?1:0,D&&(E?D.classList.add("shIconActive"):D.classList.remove("shIconActive"))}function i(){var t=o.view.getActiveGridID(),n=o.view.getResourceID(t),s=(o.view.getSheetID(t),o.view.getVersionID(t)),i=o.view.getSelectedSheets(t);e.UserAction.FORMAT_COMMA(n,i,s)}var o=e.sPlusPlus,I=e.ZSEvents,C=I.topic,A=I.Groups,S=I.Names,r=e.ZSConstants.FeatureConstants,a=e.document,c=(e.ZSConstants.I18N,e.ZSConstants.wCC),O=(e.UIUtil.Component,e.ZSConstants.CommandConstants),E=(e.ZSConstants.JSKeyCode,e.UIUtil.Component,e.UIUtil,0),T=o.view.Toolbar.Feature[r.THOUSAND_SEPARATOR],D=a.getElementById(c.MI+r.THOUSAND_SEPARATOR+c.IDENTITY),v={44:"COMMA_ICON",46:"DOT_ICON",39:"COMMA_ICON",160:"SPACE_ICON"};n("register"),C.register(A.Listener,S.DocMeta.DOC_SETTINGS,t,"DOC_SETTINGS"),T.execute=i}(this);
!function(e){function t(){var e=F.view.getActiveGridID(),t=F.view.getResourceID(e),i=F.view.getSheetID(e),o=F.view.getVersionID(e),r=F.data.getWorkBook(t,o),a=r.getSheetObj(i),n=F.view.getSheetState(e,i),l=n.getActiveCellRange().startCol,s=!1,c=!1,g=(a.DataFilters,a.DataFilters.getAllRanges());for(var v in g){var d=g[v];s=d&&d.appliedColumns&&d.appliedColumns.length?!0:!1,c=s&&-1!==d.appliedColumns.indexOf(l)?!0:!1}var I=s?!1:!0,S=c?!1:!0;y.zmenu("#"+L.SUBMENUITEM+m.FILTER+L.IDENTITY,"setMenuItemsAttribute",["#clearFilter"],"disabled",S),y.zmenu("#"+L.SUBMENUITEM+m.FILTER+L.IDENTITY,"setMenuItemsAttribute",["#reApplyFilter"],"disabled",I)}function i(t,i,o,r,a){var n=F.view.getActiveGridID(),t=F.view.getResourceID(n),o=F.view.getVersionID(n),l=F.view.getSelectedSheets(n),i=F.view.getSheetID(n),s=F.data.getWorkBook(t,o),c=s.getSheetObj(i).DataFilters,g=F.view.getSheetState(n,i),v=g.getActiveCellRange(),d=c.getIntersectedRanges(v),I=d.length&&v.startCol-d[0].startCol;if(a){var S=a.action;switch(S){case B:e.UserAction.FilterByCellValue(t,l,o);break;case G:e.UserAction.FilterByCellColor(t,l,o);break;case P:e.UserAction.FilterByTextColor(t,l,o);break;case W:e.UserAction.ClearFilter(t,l,o,I);break;case H:e.UserAction.ReApplyFilter(t,l,o)}}else c.isRangesAvailable()?e.UserAction.RemoveFilter(t,l,o):e.UserAction.AddFilter(t,l,o)}function o(){_={isFilterDialogOpen:!0,col:void 0}}function r(e,t,i,o){var r={dateFormat:C};if(!_.isFilterDialogOpen&&_.col==o)return void n();_.isFilterDialogOpen=!1,_.col=o;var c=F.view.getActiveGridID(),v=F.view.getResourceID(c),d=F.view.getSheetID(c),I=F.view.getVersionID(c),A=F.data.getWorkBook(v,I),E=A.ProtectedSheets.isSheetLocked(d);if(A.isEditable()&&!E){var T=F.view.getGridComponent(c);T.allowToScroll=!1;var R=F.view.getSheetState(c,d),m=R.getZoom(),h=A.getSheetObj(d),f=h.Column.axis.getPos(o),O=h.Row.auxiliaryAxis.getPos(i),b=h.Row.auxiliaryAxis.getDim(i)*m,p=(h.Column.axis.getDim(o)-e)*m,U=h.Row.FreezedCount,L=h.Column.FreezedCount,y=o>=L,N=i>=U,k={applyFilter:u,clearFilter:S,sortFilter:D,dialogClose:a};w||(w=new ZSClass.Filter.Dialog(k,r),s());var M=w.getDialogPos(),x=M.height,B=M.width,G=R.getScrollLefts(),P=R.getScrollTops(),W=R.getScreenWidths(),H=R.getScreenHeights(),V=0,Z=0,j=y?G[0]-W[1]:G[1],Y=N?P[0]-H[1]:P[1],z=W[0]+W[1],K=H[0]+H[1],f=V+f*m-j,O=Z+O*m-Y;O=Math.max(O,Z),f=Math.max(f,V);var X=F.view.measures.gridLeft,J=F.view.measures.gridTop;f=f+X+p,O=O+J+b;var q=!1;O+x>=K&&(O=0>O-x?J:O-x-t,q=!0),f+B>=z&&(f=0>f-B?e+X:f-B+e),w.show(O,f,q),l(),g(v,d,I,i,o)}}function a(){var e=F.view.getActiveGridID(),t=F.view.getGridComponent(e);t.allowToScroll=!0,o()}function n(){if(w){w.close();var e=F.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function l(){var e=F.view.Events.Key;e.focusContext(e.Entry.Filter.Context)}function s(){var e=F.view.Events.Key,t=e.Entry.Filter.Context,i=t.keyDown;i[N.ESC]=function(){n()},i[N.PURE_PRINTABLE_CHAR]=c,i[N.TAB]=c,i[N.SUPER+"+"+N.V]=c,i[N.LEFT]=c,i[N.RIGHT]=c,i[N.UP]=c,i[N.DOWN]=c,i[N.ENTER]=c}function c(){return!1}function g(t,i,o,r,a){var n=F.data.getWorkBook(t,o),l=n.getSheetObj(i),s=F.view.getActiveGridID(),c=(F.view.getSelectedSheets(s),l.DataFilters),g=new ZSClass.Range(r,a,r,a),v=c.getIntersectedRanges(g),d=v[0],I=a-d.startCol;w.index=I,e.UserAction.GetFilterInfo(t,[i],o,g,a,I,void 0,void 0)}function v(e){var t=T.getElementById(L.MI+m.FILTER+L.IDENTITY).parentElement;t.classList[e]("shIconActive"),"remove"==e&&n()}function d(t,i,o,r,a,n,l){var s=F.data.getWorkBook(t,o),c=s.getSheetObj(i),g=F.view.getActiveGridID(),v=(F.view.getSelectedSheets(g),c.DataFilters),d=v.getIntersectedRanges(r),S=d[0];if(Object.keys(l).length){var u={};u.cD=l.DisplayValue,u.tcs=l.Format.color,u.ccs=l.Format.bgColor,S.data[n]?I(S.data[n],u):e.UserAction.GetFilterInfo(t,[i],o,r,a,n,!1,u)}else e.UserAction.GetFilterInfo(t,[i],o,r,a,n,void 0,void 0)}function I(e,t,i){void 0!=i&&(e.cD=i.cD,e.ccs=i.ccs,e.tcs=i.tcs),t==w.index&&w.generateData(e)}function S(t){{var i=F.view.getActiveGridID(),o=F.view.getResourceID(i),r=F.view.getSelectedSheets(i),a=F.view.getVersionID(i),n=F.view.getSheetID(i),l=F.data.getWorkBook(o,a),s=l.getSheetObj(n),c=s.DataFilters,g=_.col,v=new ZSClass.Range(0,g,M-1,g),d=c.getIntersectedRanges(v),I=d[0];new ZSClass.Range(I.startRow,I.startCol,I.endRow,I.endCol)}e.UserAction.ClearFilter(o,r,a,v,t)}function u(t,i,o,r,a,n,l,s){var c=F.view.getActiveGridID(),g=F.view.getResourceID(c),v=F.view.getSelectedSheets(c),d=F.view.getVersionID(c),I=F.view.getSheetID(c),S=F.data.getWorkBook(g,d),u=S.getSheetObj(I),D=u.DataFilters,A=_.col,E=new ZSClass.Range(0,A,M-1,A),w=D.getIntersectedRanges(E),C=w[0],T=new ZSClass.Range(C.startRow,C.startCol,C.endRow,C.endCol);e.UserAction.ApplyFilter(g,v,d,T,t,i,o,r,a,n,l,s)}function D(t){var i=F.view.getActiveGridID(),o=F.view.getResourceID(i),r=F.view.getSelectedSheets(i),a=F.view.getVersionID(i),n=F.view.getSheetID(i),l=F.data.getWorkBook(o,a),s=l.getSheetObj(n),c=s.DataFilters,g=(F.view.getSheetState(i,n),_.col),v=new ZSClass.Range(0,g,M-1,g),d=c.getIntersectedRanges(v),I=d[0],S=v.startCol-I.startCol,u=[],D={};D.f=S,D.s="ASC"==t?!0:!1,u.push(D),e.UserAction.executeSort(o,r,a,u,I,!1,!0,!1,1)}function A(e,t,i){var o=F.data.getWorkBook(e,i),r=o.getSheetObj(t),a=r.DataFilters.isRangesAvailable();v(a?"add":"remove")}function E(t,i){C=e.JSUtil.Range.getDateFormat(t,i),w&&w.changeDateFormat(C)}var w,C,F=e.sPlusPlus,T=e.document,R=(e.UserAction,e.ZSConstants),m=R.FeatureConstants,h=e.ZSEvents,f=h.topic,O=h.Groups,b=h.Names,p=T.getElementById("popupmenu"),U=R.I18N,L=R.wCC,y=e.UIUtil.Component,N=e.ZSConstants.JSKeyCode,k=F.data.Defaults,M=k.MAX_ROW,x=F.view.Toolbar.Feature[m.FILTER],B=0,G=1,P=2,W=3,H=4,V=!1;!function(){var e={id:L.SUBMENUITEM+m.FILTER+L.IDENTITY,"data-ctype":"zmenu","data-min-width":150},o=[{id:"cellValueFilter",data:'{"label":"'+U["MenuItem.HomeTab.Filter.CellValue"]+'", "action": '+B+"}"},{id:"cellColorFilter",data:'{"label":"'+U["MenuItem.HomeTab.Filter.CellColor"]+'", "action": '+G+"}"},{id:"textColorFilter",data:'{"label":"'+U["MenuItem.HomeTab.Filter.TextColor"]+'", "action": '+P+"}"},{id:"clearFilter",data:'{"label":"'+U["MenuItem.HomeTab.Filter.ClearFilter"]+'", "action": '+W+"}"},{mtype:"separator"},{id:"reApplyFilter",data:'{"label":"'+U["MenuItem.HomeTab.Filter.Reapply"]+'", "action": '+H+"}"}];if(!V){F.view.Menu.create(o,e,p).then(function(){y.bind("#"+L.SUBMENUITEM+m.FILTER+L.IDENTITY,"zmenuitemclick",function(e,t){var o=t.data;i(void 0,void 0,void 0,e,o)})});var r=T.getElementById(e.id);y.bind(r,"zmenubeforeshow",function(){t()}),V=!0}}();var _={};o(),x.execute=i,f.register(O.UI,b.Menu.SHOW_FILTER_OPTION,r,"WIDTH","HEIGHT","ROW","COL"),f.register(O.Listener,b.SheetAction.ACTIVE_CELL.INFO,n),f.register(O.UserAction,b.SheetAction.DATAFILTER.FILTER_INFO,I,"data","INDEX","clientData"),f.register(O.UserAction,b.SheetAction.DATAFILTER.FILTER_DATA,d,"RID","SHEETID","VERSION","RANGE","COL","INDEX","DATA"),f.register(O.UserAction,b.SheetAction.DATAFILTER.ONAPPLY,v,"TYPE"),f.register(O.UserAction,b.SheetAction.DATAFILTER.REMOVE,v,"TYPE"),f.register(O.Listener,b.DocAction.WORKSHEETS.SWITCHSHEET,A,"RID","NEWSHEETID","VERSION"),f.register(O.UserAction,b.SheetAction.SCROLL_POSITION.DummyScroll,n),f.register(O.UI,b.Toolbar.DIALOG_OPEN,n),f.register(O.Listener,b.DocMeta.DOCUMENT_LOCALE,E,"DATE_SEPARATOR","LOCALE_DATEFORMAT")}(this);
!function(e){function t(){o=!o;var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),r=(s.view.getSheetID(t),s.view.getVersionID(t)),n=s.view.getSelectedSheets(t);e.UserAction.hideGridInViewport(i,n,r,o)}function i(e,t,i){var r=s.data.getWorkBook(e,i),n=r.getSheetObj(t);o=n.IsShowGrid}function r(e){o=!!e[1]}function n(e){for(var t=document.querySelectorAll("#"+D.MI+u.HIDEGRIDLINES+D.MENU),i=0;i<t.length;i++){var r=t[i].parentElement;if(r.id==e.id){var n=o?E["View.Gridlines.Hide"]:E["View.Gridlines.Show"];l.zmenu("#"+r.id,"setMenuItemsAttribute",["#"+D.MI+u.HIDEGRIDLINES+D.MENU],"label",n);var s=document.querySelector(".gridContainer");o?s.classList.add("hideGrid"):s.classList.remove("hideGrid")}}}{var o,s=e.sPlusPlus,I=e.ZSConstants,a=e.ZSEvents,c=a.topic,d=a.Groups,S=a.Names,u=I.FeatureConstants,E=I.I18N,l=e.UIUtil.Component,D=I.wCC,v=s.view.Toolbar.Feature[u.HIDEGRIDLINES];document.querySelector(".gridContainer")}c.register(d.Listener,S.SheetAction.GRID_LINES.META,r,"SHOW_GRID"),c.register(d.Listener,S.SheetAction.GRID_LINES.MODIFY,r,"SHOW_GRID"),c.register(d.Listener,S.DocMeta.ACTIVE_SHEET,i,"RID","ACTIVE_SHEET","VERSION"),v.execute=t,c.register(d.UI,S.Toolbar.INIT_MENU,n,"DOM")}(this);
!function(e){function t(){var e=b.createElement("li");return e.setAttribute("mtype","separator"),e}function n(){var e=b.createElement("li");return e.setAttribute("data",'{"label":"'+X["MenuItem.DataTab.Freeze.FreezeFirstRow"]+'"}'),e.setAttribute("id","freezeFirstRow"),e.addEventListener("click",function(){l(O)}),e}function r(){var e=b.createElement("li");return e.setAttribute("data",'{"label":"'+X["MenuItem.DataTab.Freeze.FreezeFirstColumn"]+'"}'),e.setAttribute("id","freezeFirstCol"),e.addEventListener("click",function(){l(_)}),e}function i(){return d=b.createElement("li"),d.setAttribute("data",'{"label":"freeze upto 2nd Row"}'),d.setAttribute("id","freezeRow"),d.addEventListener("click",function(){l(L)}),d}function a(){return A=b.createElement("li"),A.setAttribute("data",'{"label":"freeze upto B Column"}'),A.setAttribute("id","freezeCol"),A.addEventListener("click",function(){l(M)}),A}function o(){return C=b.createElement("li"),C.setAttribute("data",'{"label":"'+X["FreezePanes.UnfreezeRow"]+'"}'),C.addEventListener("click",function(){l(Z)}),C}function s(){return g=b.createElement("li"),g.setAttribute("data",'{"label":"'+X["FreezePanes.UnfreezeCol"]+'"}'),g.addEventListener("click",function(){l(U)}),g}function E(e,t){var n,r,i,a=w.view.getActiveGridID(),o=w.view.getResourceID(a),s=w.view.getSheetID(a),E=w.view.getVersionID(a),l=w.data.getWorkBook(o,E),c=l.getSheetObj(s),u=c.Column.FreezedCount,v=c.Row.FreezedCount,F=w.view.getSheetState(a,s),S=(F.getActiveCellRange(),F.getActiveRange()),b=S.startRow,h=S.startCol,I=S.endRow,p=S.endCol,z="";0==b&&I+1==y.MAX_ROW?(z="column",r=p>y.MAX_COL_FREEZE-1?y.MAX_COL_FREEZE-1:p,r=p,n=0):0==h&&p+1==y.MAX_COL?(z="row",n=I>y.MAX_ROW_FREEZE-1?y.MAX_ROW_FREEZE-1:I,n=I,r=0):(n=I,r=p,n=I>y.MAX_ROW_FREEZE-1?y.MAX_ROW_FREEZE-1:I,r=p>y.MAX_COL_FREEZE-1?y.MAX_COL_FREEZE-1:p),i=m.Object.getCharForNum(r+1),f.zmenu(t.menu,"setMenuItemsAttribute",[d],"label",k.replaceParams(X["FreezePanes.FreezeRowUpto"],new Array(n+1+""))),f.zmenu(t.menu,"setMenuItemsAttribute",[A],"label",k.replaceParams(X["FreezePanes.FreezeColUpto"],new Array(i))),z?"row"==z?(f.disable(A),f.enable(d)):"column"==z&&(f.disable(d),f.enable(A)):(f.enable(A),f.enable(d)),C.style.display=0==v?"none":"",g.style.display=0==u?"none":"",R.style.display=0==v&&0==u?"none":""}function l(e){var t=w.view.getActiveGridID(),n=w.view.getResourceID(t),r=w.view.getSheetID(t),i=w.view.getVersionID(t),a=w.data.getWorkBook(n,i),o=w.view.getSelectedSheets(t),s=w.view.getSheetState(t,r),E=s.getActiveRow()>y.MAX_ROW_FREEZE-1?y.MAX_ROW_FREEZE-1:s.getActiveRow(),l=s.getActiveCol()>y.MAX_COL_FREEZE-1?y.MAX_COL_FREEZE-1:s.getActiveCol(),c=a.getSheetObj(r),u=c.Column.FreezedCount,d=c.Row.FreezedCount;switch(e){case L:UserAction.Freeze(n,o,i,E+1,u);break;case M:UserAction.Freeze(n,o,i,d,l+1);break;case Z:UserAction.Freeze(n,o,i,0,u);break;case U:UserAction.Freeze(n,o,i,d,0);break;case O:UserAction.Freeze(n,o,i,1,u);break;case _:UserAction.Freeze(n,o,i,d,1)}}function c(){var e=b.createElement("t");e.innerText=X["FreezePanes.GetBetterVisibility"],e.className="shBtnNtftInfoTxt",v=new ZSClass.InfoBanner(e),T=!0,u()}function u(e,t,n,r,i){if(v){var a=w.view.getActiveGridID();if(e&&t&&n){if(e!==w.view.getResourceID(a)||t!==w.view.getSheetID(a)||n!==w.view.getVersionID(a))return}else e=w.view.getResourceID(a),t=w.view.getSheetID(a),n=w.view.getVersionID(a);var o=w.data.getWorkBook(e,n),s=w.view.getSheetState(a,t),E=o.getSheetObj(t),l=i?i:E.Column.FreezedCount,c=r?r:E.Row.FreezedCount,u=w.view.getGridComponent(a),d=u.getRects(),A=s.getZoom(),R=(d.height-(h.Grid.ColHeader+h.Grid.HScrollBar))/A,C=(d.width-(h.Grid.RowHeader+h.Grid.VScrollBar))/A,g=(E.Row.axis.findAbs(R),E.Column.axis.findAbs(C),E.Row.axis.getPos(c)/R*100),F=E.Column.axis.getPos(l)/C*100;g>=90||F>=90?v.show():v.isShown&&v.hide()}}var d,A,R,C,g,v,w=e.sPlusPlus,F=e.ZSConstants.FeatureConstants,S=e.ZSConstants.wCC,b=e.document,m=e.JSUtil,f=e.UIUtil.Component,h=w.view.measures,I=(e.ZSEvents,ZSEvents.topic),p=ZSEvents.Names,z=ZSEvents.Groups,D=w.view.Toolbar.Feature[F.FREEZE],O=1,_=2,L=4,M=5,Z=6,U=7,k=m.fn,X=e.ZSConstants.I18N,y=w.data.Defaults,T=!1;!function(){var e=b.getElementById("popupmenu"),l=b.createElement("ul");l.id=S.SUBMENUITEM+F.FREEZE+S.IDENTITY,l.setAttribute("data-ctype","zmenu"),l.appendChild(n()),l.appendChild(r()),l.appendChild(t()),l.appendChild(i()),l.appendChild(a()),R=t(),l.appendChild(R),l.appendChild(o()),l.appendChild(s()),e.appendChild(l),f.bind(l,"zmenubeforeshow",function(e,t){E(e,t)})}(),D.execute=l,I.register(z.UI,p.Layout.TEMPLATE_LOADED_DEFER,c),I.register(z.Listener,p.Browser.RESIZE,u),I.register(z.Listener,p.SheetAction.ZOOM.On,u),I.register(z.Listener,p.SheetAction.HIDEROWS.ADD,u),I.register(z.Listener,p.SheetAction.HIDEROWS.REMOVE,u),I.register(z.Listener,p.SheetAction.ROW_HEADERS.RESIZE.ENUMERATE,u),I.register(z.Listener,p.SheetAction.HIDECOLS.ADD,u),I.register(z.Listener,p.SheetAction.HIDECOLS.REMOVE,u),I.register(z.Listener,p.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,u),I.register(z.Listener,p.SheetMeta.FREEZE,u,"RID","SHEETID","VERSION","FreezedRow","FreezedCol")}(this);
!function(e){function t(){if(v){var t=v.getDisplay();if(""==t)return}var r=l.view.getActiveGridID(),o=l.view.getResourceID(r),s=l.view.getSelectedSheets(r),n=l.view.getSheetID(r),a=l.view.getVersionID(r),g=l.view.getSheetState(r,n),u=g.getActiveRow(),w=g.getActiveCol();c={row:u,col:w};var S=i;e.UserAction.getPickListRange(o,s,a,S)}function i(t,i,o,s){var n=r.bind(this,t,i,o),a={allowToSort:!0,skipNumbers:!0,activeCell:c,skipActiveCellData:!0};if(s&&s.range){if(!s.hasString){var v=[];return void n(v)}{new ZSClass.UniqueData(t,i,o,s.range,["DisplayValue","CellType"],n,a)}}else e.UserAction.PickFromList(t,[i],o,!1,n)}function r(e,t,i,r){var c={submit:a,close:n};v||(v=new ZSClass.PickFromList(c));var l=r.DisplayValue?r.DisplayValue:r,g=o(e,t,i);v.show(l,g),s()}function o(e,t,i){var r,o,s=l.data.getWorkBook(e,i),n=s.getSheetObj(t),a=l.view.getActiveGridID(),v=l.view.getSheetState(a,t),c=v.getActiveRow(),g=v.getActiveCol(),u=n.Column.axis.getPos(g),w=n.Row.auxiliaryAxis.getPos(c),S=n.Row.auxiliaryAxis.getDim(c),C=n.Row.FreezedCount,h=n.Column.FreezedCount,f=g>=h,A=c>=C,D=v.getScrollLefts(),d=v.getScrollTops(),r=f?D[0]:D[1],o=A?d[0]:d[1],I=f?v.getScreenWidths()[1]:0,p=A?v.getScreenHeights()[1]:0,m=l.view.measures.gridTop,y=l.view.measures.gridLeft,w=w+p-o,u=u+I-r,L=v.getScreenHeights()[0];w=w+S+m,u+=y;var x=L+m-w,P={height:x,top:w,left:u};return P}function s(){var e=l.view.Events.Key;e.focusContext(e.Entry.PickList.Context)}function n(){if(v){v.close();var e=l.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function a(t){var i=l.view.getActiveGridID(),r=l.view.getResourceID(i),o=l.view.getSelectedSheets(i),s=l.view.getSheetID(i),a=l.view.getVersionID(i),v=l.view.getSheetState(i,s),c=v.getActiveRow(),g=v.getActiveCol();e.UserAction.SubmitCell(r,o,a,t,c,g),n()}var v,c,l=e.sPlusPlus,g=e.ZSConstants,u=g.FeatureConstants,w=e.ZSEvents,S=w.topic,C=w.Groups,h=w.Names,f=l.view.Toolbar.Feature[u.PICKFROMLIST];f.execute=t,S.register(C.Listener,h.SheetAction.ACTIVE_CELL.INFO,n),S.register(C.Listener,h.GridAction.WheelXYPaneContainerScroll,n)}(this);
!function(e){function t(e,t){if(O.isEnabled){var o=u.view.getActiveGridID(),r=u.view.getResourceID(o),n=u.view.getSheetID(o),a=u.view.getVersionID(o),c=u.view.getSheetState(o,n),C=c.getActiveRow(),f=c.getActiveCol(),v=e.slice(0,t),L=v.length,w=new RegExp("[a-zA-Z]");if(w.test(v)&&L==t&&!g)return l=v,E&&0==E.toLowerCase().indexOf(v.toLowerCase())?void s(E,r,n,a):void i(v,r,n,a,C,f)}}function i(t,i,o,n,s,a){if(d.length)return void r(i,o,n,t,d);d=[];var l=r.bind(this,i,o,n,t),u=function(e,t,i,o){if(S=!0,o&&o.range){var r={activeCell:{row:s,col:a},skipNumbers:!0,skipActiveCellData:!0};if(!o.hasString)return;{new ZSClass.UniqueData(e,t,i,o.range,["DisplayValue","CellType"],l,r)}}else A(e,t,i,l)};!S&&e.UserAction.getPickListRange(i,[o],n,u)}function o(e,t){var i=e.toLowerCase(),o=t.toLowerCase();return o>i?-1:i>o?1:0}function r(e,t,i,o,r){clearTimeout(D),D=setTimeout(function(){var a=n(o,r);a&&s(a,e,t,i)},10)}function n(e,t){d=t.DisplayValue?t.DisplayValue:t,d=d.sort(o);for(var i="",r=!1,n=d.length,s=0,a=n-1,l=e.toLowerCase();a>=s;){var u=(a+s)/2|0,c=d[u],C=c.toLowerCase();if(c&&0==C.indexOf(l)){i&&i.toLowerCase()==C&&(r=!1),i=d[u];var f=d[u-1],v=d[u+1];if(f&&C!=f.toLowerCase()&&0==f.toLowerCase().indexOf(l)||v&&C!=v.toLowerCase()&&0==v.toLowerCase().indexOf(e.toLowerCase()))return;if(r)return;r=!0}if(d[u].toLowerCase()<l)s=u+1;else{if(!(d[u].toLowerCase()>l))return;a=u-1}}return""==i&&(g=!0),i}function s(e,t,i,o){var r=l.length,n=e.length;if(!(r>=n)&&-1!=e.toLowerCase().indexOf(l.toLowerCase())){var s=e.slice(l.length,e.length);v.publish(L.Listener,w.CellAction.CELLSUGGESTION.ADD,{RID:t,SHEETID:i,VERSION:o,VALUE:l+s,POS:r}),E=e}}function a(){d=[],g=!1,S=!1,E=void 0}var l,u=e.sPlusPlus,c=e.ZSConstants,C=c.FeatureConstants,f=e.ZSEvents,v=f.topic,L=f.Groups,w=f.Names,g=!1,E=void 0,S=!1,d=[],D=0,O=u.view.Toolbar.Feature[C.AUTOCOMPLETE],A=JSUtil.fn.debounce(function(t,i,o,r){e.UserAction.PickFromList(t,[i],o,!0,r)},100);v.register(L.Listener,w.CellAction.CELLSUGGESTION.GET,t,"VALUE","SELCTIONPOS"),v.register(L.Selector.DomUpdate.CellEdit,w.Selection.BOUND_UPDATE.REMOVE,a)}(this);
!function(e){function t(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),n=I.view.getVersionID(e);E.publish(c.Listener,d.UserAction.IMAGES.DELETE,{RID:t,SHEETID:i,VERSION:n})}function i(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),n=I.view.getVersionID(e);E.publish(c.Listener,d.UserAction.IMAGES.CLONE,{RID:t,SHEETID:i,VERSION:n})}function n(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),n=I.view.getVersionID(e);E.publish(c.Listener,d.UserAction.IMAGES.RESIZE_TO_ORIGINAL,{RID:t,SHEETID:i,VERSION:n})}function o(){var e=I.view.getActiveGridID(),t=I.view.getGridComponent(e),i=t.Image.getActive(),n=Object.keys(i),o=n[0],r=I.view.getResourceID(e),s=I.view.getSheetID(e),a=I.view.getVersionID(e),g=I.data.getWorkBook(r,a),E=g.getSheetObj(s),c=E.Images.get(o),d=document.createElement("img"),v=c.getURL();d.src=v;var A=c.getWidth(),D=c.getHeight();document.body.appendChild(d),d.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=A,e.height=D,t.drawImage(d,0,0,A,D);var i,n=-1!=v.indexOf("u_n")?!1:!0;n?i=v:(i=e.toDataURL("image/png;base64"),i=i.replace("image/png","image/octet-stream"));var o=document.createElement("a");o.href=i,o.download=c.getName(),document.body.appendChild(o),o.click(),document.body.removeChild(o)},document.body.removeChild(d)}function r(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),n=I.view.getVersionID(e);E.publish(c.Listener,d.UserAction.IMAGES.REPLACE,{RID:t,SHEETID:i,VERSION:n})}function s(t,i,n,o){e.UserAction.uploadImage(t,i,n,o)}function a(e,t,i,n){var o=n[0],r=o.name,a=r.lastIndexOf("."),I=r.substring(a+1).toLowerCase(),g={onDrop:s},E={allowedFileTypes:["png","bmp","jpeg","jpg","svg","gif"],maxFileSize:1e7,alertMsg:A["LP.UPLOAD.ERROR_MSG.MAX_LIMIT"]};if(-1!=E.allowedFileTypes.indexOf(I)){var c=new ZSClass.DragAndDrop(e,t,i,n,E,g);c.validate()}}var I=e.sPlusPlus,g=e.ZSEvents,E=g.topic,c=g.Groups,d=g.Names,v=(e.UIUtil.Component,e.ZSConstants),A=e.ZSConstants.I18N,D=(v.CommandConstants,v.FeatureConstants),u=I.view.Toolbar.Feature[D.IMAGE],S=function(e,t,i,n){var o=Math.min(i/e,n/t);return{width:e*o,height:t*o}},l=function(t,i,n,o,r){var s=I.data.getWorkBook(t,n),a=s.getSheetObj(i),g=a.Prop.Name,E=I.view.getActiveGridID(),c=I.view.getSheetState(E,i),d=I.view.getSelectedSheets(E),v=[],A=!1,D=a.Row.auxiliaryAxis,u=a.Column.axis;e.ZSDevTools.Logger.log("Inserting image data >>> ",r),r&&e.ZSDevTools.Logger.log("cond check >>> ","INSERT"!==r.onInsertType);var l,m,h,R,w=r&&"INSERT"!==r.onInsertType?"IMAGE_REPLACE":"IMAGE_NEW",M=r&&"Library"===r.insertFrom?!0:!1,p=r?r.isInsertFromWeb:!1;for(var G in o){var f={},T=o[G],L=["IMAGE_EXTENSION","IMAGE_NAME","IMAGE_HEIGHT","IMAGE_WIDTH","AUTHOR_ID","RESOURCE_ID","IMAGE_URL","IMAGE_ID"],O={};L.forEach(function(e){T[e]&&(O[e]=encodeURIComponent(T[e]))});var C=c.getScreenHeights()[0],b=c.getScreenWidths()[0],N=Math.round(b/1.3),_=Math.round(C/1.3),U=O.IMAGE_WIDTH,H=O.IMAGE_HEIGHT;if(U&&H){var y=U>N||H>_?!0:!1;if(y){var P=S(U,H,N,_);U=Math.round(P.width),H=Math.round(P.height)}}var V,x,F,W,k,Z,j=c.getScrollTops()[0],z=c.getScrollLefts()[0];if(m)F=Math.round(l+parseInt(h)/2),W=Math.round(m+parseInt(R)/2),V=D.findAbs(W),x=u.findAbs(F),k=W-D.getPos(V),Z=F-u.getPos(x);else{var B=H?H:0,X=U?U:0;W=Math.round(C/2-B/2+j),F=Math.round(b/2-X/2+z),V=a.Row.axis.findAbs(W),x=a.Column.axis.findAbs(F),k=0,Z=0}l=F,m=W,h=U?U:40,R=H?H:40,f={row:V,column:x,sRowDiff:k,sColDiff:Z,resId:O.RESOURCE_ID,imgNm:O.IMAGE_NAME,isRemoteMode:A,insertFromLib:M},r&&"INSERT"!==r.onInsertType&&(f.imgId=r.onInsertType),r&&O.IMAGE_URL&&p&&(f.imgurl=O.IMAGE_URL),U&&(f.imgWd=U),H&&(f.imgHt=H),v.push(f)}o.length&&e.UserAction.ImageAction(t,d,n,g,w,v)};u.remove=t,u.saveAS=o,u.clone=i,u.resize=n,u.replace=r,E.register(c.Listener,d.SheetAction.IMAGES.UPLOAD,l,"RID","SHEETID","VERSION","IMAGES","DATA"),E.register(c.Listener,d.UserAction.DRAG_DROP.DROPEND,a,"RID","SHEETID","VERSION","FILES")}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=(s.view.getSheetID(e),s.view.getVersionID(e)),v=s.view.getSelectedSheets(e);o.HideRow(t,v,i,"HIDE")}function i(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=(s.view.getSheetID(e),s.view.getVersionID(e)),v=s.view.getSelectedSheets(e);o.HideRow(t,v,i,"SHOW")}var s=e.sPlusPlus,v=e.ZSConstants.FeatureConstants,o=e.UserAction,r=s.view.Toolbar.Feature[v.HIDE_ROWS];r.hide=t,r.show=i}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=(s.view.getSheetID(e),s.view.getVersionID(e)),v=s.view.getSelectedSheets(e);o.HideCol(t,v,i,"HIDE")}function i(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=(s.view.getSheetID(e),s.view.getVersionID(e)),v=s.view.getSelectedSheets(e);o.HideCol(t,v,i,"SHOW")}var s=e.sPlusPlus,v=e.ZSConstants.FeatureConstants,o=e.UserAction,r=s.view.Toolbar.Feature[v.HIDE_COLUMNS];r.show=i,r.hide=t}(this);
!function(e){function t(e,t,r,s,o,l,i){var a=w.view.getActiveGridID();R=w.view.getResourceID(a),g=w.view.getVersionID(a),f=sPlusPlus.view.getSheetID(a);var c=w.view.getSelectedSheets(a);if(n(R,g,e,t,l)){var u={};u.constrLHS="",u.constrRHS="",u.constrREL="",l.forEach(function(e,t,n){var r=(e.getExpression(),P.Range.parseRange(R,g,e.getExpression())),s=r.sheetName,o=r.range,l=P.Cell.getReference(o.startRow,o.startCol);u.constrLHS+=s+","+l+",",u.constrRHS+=e.getValue()+",",u.constrREL+=e.getOperator()+",",t==n.length-1&&(u.constrLHS=u.constrLHS.slice(0,u.constrLHS.length-1),u.constrRHS=u.constrRHS.slice(0,u.constrRHS.length-1),u.constrREL=u.constrREL.slice(0,u.constrREL.length-1))}),UserAction.solver(R,g,c,e,t,r,s,i,o,u),p=R,d=g;var v=new P.Range.parseRange(R,g,t);E=[v.sheetID],h=v.range}else Z.ZSAlert(T["GoalSeek.Msg.InvalidCell"],{title:T["Alert.Title.InvalidCellRange"]})}function n(e,t,n,o,l){var i=!0;r(e,t,n)&&r(e,t,o)||(i=!1);for(var a=0;a<l.length;a++)if(!r(e,t,l[a].getExpression())||!s(e,t,l[a].getValue())){i=!1;break}return i}function r(e,t,n){return P.Range.parseRange(e,t,n)}function s(e,t,n){return P.Range.parseRange(e,t,n)||!isNaN(n)}function o(e){var e=e,t=e.solution,n=e.noNumber,r=e.exceptionformulaConstraint,s=e.exceptionformula,o=e.exception;if(null!=n)return void Z.ZSAlert(n);if(null!=s)return void Z.ZSAlert(s);if(null!=r)return void Z.ZSAlert(r);if(null!=o)return void Z.ZSAlert(o);if(null!=t){var i=(e.clientUpdatJson,e.resultValue),a=e.variableCellValues;L=a;{e.oldValues}return c(i),void l(e.clientUpdatJson)}}function l(t){var n=w.view.getActiveGridID(),r=w.view.getResourceID(n),s=w.view.getSheetID(n),o=w.view.getVersionID(n);A={};var l=e.ZSResponseParser.ExtractCellInfo(t,r,s);l.forEach(function(e){A[P.Math.hash(e.r,e.c,b)]=e.displayValue,m.publish(V.Listener,H.Layers.Preview.Place,{RID:r,SHEETID:s,VERSION:o,RANGE:new x(e.r,e.c,e.r,e.c),CALLBACK:i})})}function i(e,t,n,r){var s=A[P.Math.hash(e,t,b)];s.startsWith("'")&&(s=s.substring(1,s.length-1)),r.DisplayValue=s}function a(){m.publish(V.Listener,H.Layers.Preview.RemoveAll,{RID:R,SHEETID:f,VERSION:g})}function c(e){I||u(),D.innerText=e,I.open()}function u(){var t=e.UserAction.getTemplate(["solverResponseTemplate"]).solverResponseTemplate;D=t.querySelector("#solverResultVal"),t.querySelector("#okBtn").addEventListener("click",S),t.querySelector("#clBtn").addEventListener("click",function(){I.close()});var n=document.createElement("div");n.id="DI_SOLVER_RESULT",n.appendChild(t);var r={modal:!0,width:560,title:T["MenuItem.DataTab.Solver"],close:v,open:function(){}};I=new Z.Dialog(n,r)}function v(){a()}function S(){UserAction.PasteFromClipBoard(p,E,d,L,h),I.close()}var R,g,f,p,E,d,h,L,I,D,A,w=e.sPlusPlus,C=e.ZSEvents,m=C.topic,V=C.Groups,H=C.Names,N=e.ZSConstants.FeatureConstants,P=e.JSUtil,T=e.ZSConstants.I18N,Z=(e.document,e.ZSClass),x=Z.Range,b=w.data.Defaults.MAX_COL,O=w.view.Toolbar.Feature[N.SOLVER];O.execute=t,m.register(V.Listener,H.UserAction.SOLVER.RESP_HANDLE,o,["RESPONSE"])}(this);
!function(e){function t(){var t,a,n=c.view.getActiveGridID(),s=c.view.getResourceID(n),u=c.view.getSheetID(n),g=c.view.getVersionID(n),v=c.data.getWorkBook(s,g),S=v.getSheetObj(u),d=S.Prop.getName(),I=d,p=d,A=document.querySelector("#gsTargetCell").textContent,D=document.querySelector("#gsVariantCell").textContent;if(A.contains(".")){var R=A.split(".");p=R[0],A=R[1]}if(D.contains(".")){var f=D.split(".");I=f[0],D=f[1]}A&&D||(t=w["GoalSeek.Msg.InvalidCell"],a=w["Alert.Title.InvalidCellRange"]);var E=document.querySelector("#gsResult").value;if(t||E||(t=w["GoalSeek.Msg.Blank"],a=w["Alert.Title.EnterResultValue"]),t)return void C.ZSAlert(t,{title:a});var m=c.view.getSelectedSheets(n),L=v.SheetList.getIdByName(I);i=s,l=g,r=[L],o=new h.Range.parseRange(s,g,D).range,e.UserAction.goalSeek(s,m,g,I,p,D,A,E)}function a(e,t,a,s,u,c){if(void 0!=c){D.closeDialog(),D.openResultDialog(s,u,c);{e.clientUpdatJson}D.initCopyParams(i,l,r,o,c),n(e.clientUpdatJson)}else C.ZSAlert(s)}function n(t){var a=c.view.getActiveGridID(),n=c.view.getResourceID(a),i=c.view.getSheetID(a),r=c.view.getVersionID(a);u={};var l=e.ZSResponseParser.ExtractCellInfo(t,n,i);l.forEach(function(e){var t=new p(e.r,e.c,e.r,e.c);u[h.Math.hash(e.r,e.c,A)]=e.displayValue,v.publish(S.Listener,d.Layers.Preview.Place,{RID:n,SHEETID:i,VERSION:r,RANGE:t,CALLBACK:s})})}function s(e,t,a,n){var s=u[h.Math.hash(e,t,A)];s.startsWith("'")&&(s=s.substring(1,s.length-1)),n.DisplayValue=s}var i,r,l,o,u,c=e.sPlusPlus,g=e.ZSEvents,v=g.topic,S=g.Groups,d=g.Names,I=e.ZSConstants.FeatureConstants,h=e.JSUtil,C=(e.document,e.ZSClass),p=C.Range,w=e.ZSConstants.I18N,A=c.data.Defaults.MAX_COL,D=c.view.Toolbar.Feature[I.GOAL_SEEK];D.execute=t,v.register(S.Listener,d.UserAction.GOALSEEK_PROMPT,a,"response","columnIndex","rowIndex","message","TargetCellValue","solution")}(this);
!function(e){function t(){this.importOption;switch(this.importOption){case"createNew":p="IMPORT_CREATE_NEW";break;case"importAsTemplate":p="IMPORT_AS_TEMPLATE";break;case"replaceSpreadsheet":p="IMPORT_REPLACE_SPREADSHEET";break;case"insertSheets":p="IMPORT_INSERT_AS_NEW_SHEETS";break;case"replaceCurrSheet":p="IMPORT_REPLACE_CURRENTSHEET";break;case"appendRows":p="IMPORT_APPEND_ROWS_TO_CURRENTSHEET";break;case"replaceData":p="IMPORT_REPLACE_DATA_STARTING_AT_CELL";var e=this.DOM.container.querySelector("#scell").textContent;m=e.trim()}("csv"==this.format||"tsv"==this.format)&&(this.isURLImport?(T=UIUtil.Component.zcombo(this.DOM.delimiter2,"getValue"),"Custom"==T&&(T=this.DOM.customDelimiter2.value.trim(),""==T&&(T="csv"==this.format?"Comma":"Tab"))):(T=UIUtil.Component.zcombo(this.DOM.delimiter1,"getValue"),"Custom"==T&&(T=this.DOM.customDelimiter1.value.trim(),""==T&&(T="csv"==this.format?"Comma":"Tab")))),g=this.isURLImport,r(p,this.files,g,T,null)}function r(t,r,i,s,o){var a=S.view.getActiveGridID(),n=S.view.getResourceID(a),l=S.view.getVersionID(a),c=S.view.getSelectedSheets(a);e.UserAction.fileImport(n,c,l,r,i,t,s,C.initial,o)}function i(e,t){r(p,t,g,T,e)}function s(e,t,r,i){h.openDialog(),h.Dialog.fileAttach(i)}function o(t,r,i,s,o,n,l){var i=S.view.getSelectedSheets(t),c=S.view.getSheetID(t),E=S.view.getSheetState(t,c),m=E.getActiveRange(),p=m.getLabel(),g=D.Range.parseRange(r,s,p);o.startCell=g.range,e.UserAction.import(r,i,s,n,o,a),h.closeDialog();var T=new _.TBNotification(l,{type:"info"});T.show()}function a(e){R&&R.remove();var t,r=!1,i=v["Error.Import"],s=!0;if(400===e.status||500==e.status)r=!0,"Error.Import.FileSizeExceed"==e.responseText&&(h.Dialog?h.Dialog.errorMsg="errorMsg2":t=v["Import.Error.FileSizeExceed"]);else if(200===e.status&&null!=e.em){var o=e.em;if(-2==o)h.openEncryptedDialog(e.files),document.getElementById("SetPassword").focus(),r=!0;else if(103==o)n();else{s=!1,r=!0;var a=o.split("#");i=D.fn.replaceParams(v[a[0]],new Array(a[1]+""))}}if(r)if(h.Dialog)h.Dialog.showErrorMsg(i,s);else{var l=t?t:i;R=new _.TBNotification(l,{mode:"STD",type:"error",showCloseBtn:!0}),R.show()}return r||h.closePasswordDialog(),r}function n(){document.getElementById("wrongPasswordMessage").style.visibility="visible",document.getElementById("SetPassword").focus(),document.getElementById("SetPassword").select(),document.getElementById("ApplyBtn").disabled=!0}function l(){document.getElementById("wrongPasswordMessage").style.visibility="hidden",document.getElementById("ApplyBtn").disabled=!1}function c(){h.openDialog(),importOptions[1].checked=!0;var e=importDialogObject.querySelector("#importOptions");e.style.display="none"}function E(e,t,r,i){var o=i[0],a=o.name,n=a.lastIndexOf("."),l=a.substring(n+1).toLowerCase(),c={onDrop:s},E={allowedFileTypes:["ods","xlsx","xls","xlsm","csv","tsv","sxc"],maxFileSize:1e7,alertMsg:v["Error.Import.FileSizeExceed"]};if(-1!=E.allowedFileTypes.indexOf(l)){var m=new _.DragAndDrop(e,t,r,i,E,c);m.validate()}}var m,p,g,T,R,S=e.sPlusPlus,I=e.ZSEvents,u=e.ZSConstants,d=I.topic,A=I.Groups,P=I.Names,f=e.ZSConstants.FeatureConstants,D=e.JSUtil,_=(e.document,e.ZSClass),v=(_.Range,u.I18N),h=(e.UIUtil.Component,S.view.Toolbar.Feature[f.IMPORT]),C={replaceDocument:function(t,r,i){var s=i.ln,o=S.data.UserInfo.loginName;e.location.reload()},replaceCurrentSheet:function(e,t,r){var i=r.ln,s=S.data.UserInfo.loginName;i==s&&h.closeDialog()},initial:function(t,r,i,s,n){if(UserAction.importingNotification&&UserAction.importingNotification.remove(),!a(s)&&s.rid){var l=S.view.getActiveGridID();switch(n){case"IMPORT_CREATE_NEW":case"IMPORT_AS_TEMPLATE":h.closeDialog();var c=UserAction.getTemplate(["STATUS_ALERT"]),E=c.STATUS_ALERT;E.querySelector("#msg").innerText=v["Import.SuccessMsg"];var p=E.querySelector("#fileLink");p.href=S.data.AppRegistry.ctxpath+S.data.AppRegistry.ClientURI+s.rid,p.target="_blank",p.innerText=s.fname,p.title=s.fname;var g=[{text:v["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(p.href,"_blank")}},{text:v.Close,cilck:function(){h.closeDialog()}}];_.ZSAlert(E,{type:"success",title:v["Alert.Title.ImportSuccessful"],isHtml:!0,buttons:g});break;case"IMPORT_REPLACE_DATA_STARTING_AT_CELL":var r=S.view.getSelectedSheets(l),T=D.Range.parseRange(t,i,m);s.startCell=T.range,e.UserAction.import(t,r,i,n,s,a),h.closeDialog();var R=new _.TBNotification(v["Import.ProgressMsg.ReplaceDataStartingAtCell"],{type:"info"});R.show();break;case"IMPORT_INSERT_AS_NEW_SHEETS":o(l,t,r,i,s,n,v["Import.ProgressMsg.InsertNewSheets"]);break;case"IMPORT_REPLACE_SPREADSHEET":o(l,t,r,i,s,n,v["Import.ProgressMsg.ReplaceSpreadsheet"]);break;case"IMPORT_REPLACE_CURRENTSHEET":o(l,t,r,i,s,n,v["Import.ProgressMsg.ReplaceCurrentSheet"]);break;case"IMPORT_APPEND_ROWS_TO_CURRENTSHEET":o(l,t,r,i,s,n,v["Import.ProgressMsg.AppendRowsToCurrentSheet"])}}}};h.execute=t,h.executeFromCloudImport=r,h.importEncryptedAction=i,h.hideWrongPasswordMessage=l,d.register(A.Listener,P.UserAction.TEMPLATE_IMPORT,c),d.register(A.Listener,P.DocAction.IMPORT.REPLACE_SPREADSHEET,C.replaceDocument,"RID","VERSION","IMPORT"),d.register(A.Listener,P.DocAction.IMPORT.REPLACE_CURRENTSHEET,C.replaceCurrentSheet,"RID","VERSION","IMPORT"),d.register(A.Listener,P.UserAction.DRAG_DROP.DROPEND,E,"RID","SHEETID","VERSION","FILES")}(this);
!function(e){function t(){o||(o=s(a["MenuItem.FileTab.LoadingCloudDrives"],"STD","info")),o.show();var e=window.location.host,t=r.createElement("iframe");t.id="cloudPicker",t.style.width="100%",t.style.height="100%",t.style.zIndex="999",t.style.top="0px",t.style.position="absolute",t.src="//"+l.gadgetUrl+"/CloudPicker?frameorigin=https://"+e+"&sources=gdrive,box,skydrive,dropbox&fileExtensions=xlsx,xls,xlsm,ods,sxc,csv,tsv&fileMimeTypes=googleDocs&zservice=zsheet&attachLimit=1&serURL=https://"+e+"/sheet/appsheet/pages/CloudPicker.jsp",t.addEventListener("load",function(){o.remove()}),t.addEventListener("error",function(){o.remove()}),r.body.appendChild(t)}function s(e,t,s){var o={mode:t,type:s,showCloseBtn:!1};return new ZSClass.TBNotification(e,o)}var o,i=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,r=e.document,a=(e.UserAction,e.ZSConstants.wCC,e.ZSConstants.I18N),l=(e.UIUtil.Component,i.data.AppRegistry),d=i.view.Toolbar.Feature[n.IMPORT_FROM_CLOUD_DRIVES];d.openDialog=t}(this);
!function(e){function o(){n||(n=t(D["MenuItem.FileTab.LoadingCloudDrives"],"STD","info")),n.show();var e=window.location.host,o=u.view.getActiveGridID(),r=u.view.getResourceID(o),s=u.view.getVersionID(o),i=u.data.getWorkBook(r,s),a=c.createElement("iframe");a.style.width="100%",a.style.height="100%",a.style.zIndex="999",a.style.top="0px",a.style.position="absolute",a.src="//"+f.gadgetUrl+"/CloudUploader?frameorigin=https://"+e+"&sources=gdrive,box,skydrive,dropbox&fileName="+i.Name+"&zservice=zsheet&serURL=https://"+e+"/sheet/appsheet/pages/CloudUploader.jsp",a.addEventListener("load",function(){n.remove()}),a.addEventListener("error",function(){n.remove()}),c.body.appendChild(a)}function t(e,o,t,r){var s={mode:o,type:t,showCloseBtn:r};return new ZSClass.TBNotification(e,s)}function r(e,o,r,n,l,d){a||(a=t(g.fn.replaceParams(D["MenuItem.FileTab.ExportToCloudDrives.SavingTo"],[i(e)]),"STD","info")),a.show();var v=u.view.getActiveGridID(),c=u.view.getResourceID(v),f=u.view.getVersionID(v);p.exportToCloudDrives(c,f,e,o,r,n,l,d,s.bind(null,e))}function s(e,o){a.remove(),e=i(e),"success"==o.status?(l||(l=t(g.fn.replaceParams(D["MenuItem.FileTab.ExportToCloudDrives.SavedTo"],[e]),"DYN","info",!0)),l.show()):(d||(d=t(g.fn.replaceParams(D["MenuItem.FileTab.ExportToCloudDrives.ErrorMsg"],[e]),"DYN","info",!0)),d.show())}function i(e){var o;switch(e){case"gdrive":o="Google Drive";break;case"box":o="Box";break;case"skydrive":o="SkyDrive";break;case"dropbox":o="Dropbox"}return o}var n,a,l,d,u=e.sPlusPlus,v=e.ZSConstants.FeatureConstants,c=e.document,p=e.UserAction,D=(e.ZSConstants.wCC,e.ZSConstants.I18N),g=e.JSUtil,f=(e.UIUtil.Component,u.data.AppRegistry),m=u.view.Toolbar.Feature[v.EXPORT_TO_CLOUD_DRIVES];m.openDialog=o,m.execute=r}(this);
!function(e){function t(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),s=n.view.getSheetID(t),g=n.view.getSheetState(t,s),r=n.view.getSelectedSheets(t),S=n.view.getVersionID(t),c=o[e];c.istheme=!0,c.datarange=JSUtil.Range.getRangesInString(i,S,g.getRanges()),c.asn=JSUtil.Range.findASN(i,S,c.datarange),a.applyConditionalFormat(c,void 0,i,r,S,"COLOR_SCALES_APPLY")}var n=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,a=(e.document,e.UserAction),s=n.view.Toolbar.Feature[i.COLOR_SCALE],o=e.ZSConstants.ColorscaleTheme;s.quickAction=t}(this);
!function(e){function t(){var e=_.createElement("ul");e.id="formatCellsMenu",e.className="shMenuNoRadius";for(var t=0;t<Z.length;t++){if(t==Z.length-1){var r=_.createElement("li");r.setAttribute("mtype","separator"),e.appendChild(r)}var r=_.createElement("li"),i=Z[t];r.innerText=i[1],n(i[0],r),r.addEventListener("click",a.bind(r,i[0])),e.appendChild(r)}B.appendChild(e)}function n(e,t){switch(e){case"CURRENCY":t.setAttribute("data-menu-id",k.SUBMENUITEM+P.CURRENCY+k.IDENTITY);break;case"DATE":t.setAttribute("data-menu-id",k.SUBMENUITEM+P.DATE+k.IDENTITY);break;case"TIME":t.setAttribute("data-menu-id",k.SUBMENUITEM+"DURATION"+k.IDENTITY);break;case"REGIONAL":F=t;break;case"CUSTOM":v=t;break;case"ACCOUNTING":t.setAttribute("data-menu-id",k.SUBMENUITEM+P.ACCOUNTING+k.IDENTITY)}}function a(e){var t=g.view.getActiveGridID(),n=g.view.getResourceID(t),a=g.view.getSelectedSheets(t),r=g.view.getVersionID(t);switch(e){case"GENERAL":V.GENERAL(n,a,r);break;case"FLOAT":var i="0",E=!1,T="2",l="1";V.FLOAT(n,a,r,i,E,T,l,V.LOCALE());break;case"FRACTION":var o="0/0?";V.FRACTION(n,a,r,o);break;case"SCIENTIFIC":var A=2;V.SCIENTIFIC(n,a,r,A,V.LOCALE());break;case"STRING":V.TEXT(n,a,r);break;case"REGIONAL":V.REGIONAL(n,a,r,V.LOCALE(),"ZipCode");break;case"PERCENTAGE":var A="2";V.PERCENTAGE(n,a,r,A,V.LOCALE());break;case"THOUSANDSEPARATOR":x.execute();break;case"MoreFormats":V.openDialog()}}function r(e){"DATETIME"==e?e="DATE":"DURATION"==e&&(e="TIME");for(var t=0;t<Z.length;t++){var n=Z[t],a=n[0];e==a&&(j.innerText=n[1])}}function i(t,n,a,i,E,T){var l="GENERAL";if(i.hasOwnProperty("Pattern")){var o=i.Pattern;JSUtil.Object.isEmpty(o)||(l=o[h.FORMATTYPE]),r(l)}else{var A=g.view.getActiveGridID(),I=g.view.getSelectedSheets(A),a=g.view.getVersionID(A),u=function(e){var t=e[E][T].Pattern;JSUtil.Object.isEmpty(t)||(l=t[h.FORMATTYPE]),r(l)},C=function(t){e.ZSClass.Logger.log(" couldn't retrieve data from cell  ",t)};g.view.fetchCellData(t,I,a,E,T,["Pattern"],A,u,C)}}function E(e,t,n){y.FORMATCELLS_GRID(e,t,n,null,null,C())}function T(e,t,n,a,r,i,E,T){y.FORMATCELLS_GRID(e,t,n,null,null,c(a,r,i,E,T))}function l(e,t,n,a){y.FORMATCELLS_GRID(e,t,n,null,null,s(a))}function o(e,t,n,a,r){y.FORMATCELLS_GRID(e,t,n,null,null,R(a,r))}function A(e,t,n){y.FORMATCELLS_GRID(e,t,n,null,null,S())}function I(e,t,n,a,r){y.FORMATCELLS_GRID(e,t,n,null,null,L(a,r))}function u(e,t,n,a,r){y.FORMATCELLS_GRID(e,t,n,null,null,O(a,r))}function C(){return{formatType:"AUTOMATIC",frmtAction:"generate"}}function c(e,t,n,a,r){return{formatType:"NUMBER",frmtAction:"generate",negFrmt:e,thousandsep:t,decimals:n,leadingzeroes:a,language:r}}function s(e){return{formatType:"FRACTION",frmtAction:"generate",format:e}}function R(e,t){return{formatType:"SCIENTIFIC",frmtAction:"generate",decimals:e,language:t}}function S(){return{formatType:"TEXT",frmtAction:"generate"}}function L(e,t){return{formatType:"REGIONAL",frmtAction:"generate",language:e,format:t}}function O(e,t){return{formatType:"PERCENTAGE",frmtAction:"generate",decimals:e,language:t}}function M(e,t,n,a){if(e){var r=_.createElement("ul");r.id=t,r.setAttribute("data-height",240);for(var i in e){var E=_.createElement("li");E.innerText=a?decodeURIComponent(e[i]):e[i],E.action=i,E.addEventListener("click",n.bind(null,E)),r.appendChild(E)}B.appendChild(r)}}function N(e,t){t&&!JSUtil.Object.isEmpty(t.USERLEVELCUSTOMFORMATS)?(M(t.USERLEVELCUSTOMFORMATS,k.SUBMENUITEM+"FORMATCELLS_CUSTOM"+k.IDENTITY,m,!0),v.setAttribute("data-menu-id",k.SUBMENUITEM+"FORMATCELLS_CUSTOM"+k.IDENTITY),Y.enable(v)):Y.disable(v),JSUtil.Object.isEmpty(e)?Y.disable(F):(M(e,k.SUBMENUITEM+"FORMATCELLS_REGIONAL"+k.IDENTITY,d,!1),F.setAttribute("data-menu-id",k.SUBMENUITEM+"FORMATCELLS_REGIONAL"+k.IDENTITY),Y.enable(F))}function m(e){var t=g.view.getActiveGridID(),n=g.view.getResourceID(t),a=g.view.getSelectedSheets(t),r=g.view.getVersionID(t),i={formatType:"CUSTOM",frmtAction:"submit",format:encodeURIComponent(e.innerText)};y.FORMATCELLS_GRID(n,a,r,null,null,i)}function d(e){var t=e.action,n=g.view.getActiveGridID(),a=g.view.getResourceID(n),r=g.view.getSelectedSheets(n),i=g.view.getVersionID(n);V.REGIONAL(a,r,i,V.LOCALE(),t)}function f(e){var t=_.querySelector("#"+k.SUBMENUITEM+"FORMATCELLS_CUSTOM"+k.IDENTITY);if(t&&(Y.zmenu(t,"destroy"),t.innerHTML=""),0==e.length)return void Y.disable(v);Y.enable(v);for(var n=[],a=0;a<e.length;a++)n.push(e[a].value);U(n,k.SUBMENUITEM+"FORMATCELLS_CUSTOM"+k.IDENTITY,m,!0),Y.zmenu(t)}function U(e,t,n,a){if(e){var r=_.querySelector("#"+t);if(!r){var r=_.createElement("ul");r.id=t}r.setAttribute("data-height",240),r.setAttribute("data-width",150);for(var i in e){var E=_.createElement("li");E.innerText=a?decodeURIComponent(e[i]):e[i],E.action=i,E.addEventListener("click",n.bind(null,E)),r.appendChild(E)}}}var F,v,g=e.sPlusPlus,D=e.ZSEvents,p=D.topic,b=D.Groups,G=D.Names,P=e.ZSConstants.FeatureConstants,h=e.ZSConstants.CommandConstants,_=e.document,w=ZSConstants.I18N,y=e.UserAction,k=e.ZSConstants.wCC,Y=e.UIUtil.Component,B=_.getElementById("popupmenu"),V=(_.getElementById("popupmenu"),g.view.Toolbar.Feature[P.FORMATCELLS]),x=g.view.Toolbar.Feature[P.THOUSAND_SEPARATOR],Z=[["GENERAL",w.General],["FLOAT",w.Number],["ACCOUNTING",w["SidePanel.FormatCells.Accounting"]],["CURRENCY",w["SidePanel.FormatCells.Currency"]],["DATE",w["MenuItem.FormatTab.Date"]],["TIME",w.Time],["PERCENTAGE",w["MenuItem.FormatTab.Percentage"]],["FRACTION",w["SidePanel.FormatCells.Fraction"]],["SCIENTIFIC",w["SidePanel.FormatCells.Scientific"]],["STRING",w["SidePanel.FormatCells.Text"]],["REGIONAL",w["SidePanel.FormatCells.Regional"]],["CUSTOM",w["Chart.Colors.Custom"]],["MoreFormats",w["MenuItem.FormatTab.MoreFormats"]]],j=_.getElementById(k.MI+"AUTOMATIC_FORMAT"+k.IDENTITY);t(),V.GENERAL=E,V.FLOAT=T,V.FRACTION=l,V.SCIENTIFIC=o,V.TEXT=A,V.REGIONAL=I,V.PERCENTAGE=u,V.GENERAL_PARAMS=C,V.FLOAT_PARAMS=c,V.FRACTION_PARAMS=s,V.SCIENTIFIC_PARAMS=R,V.TEXT_PARAMS=S,V.REGIONAL_PARAMS=L,V.PERCENTAGE_PARAMS=O,V.UpdateCustomFormats=f,p.register(b.Listener,G.SheetAction.ACTIVE_CELL.INFO,i,"RID","SHEETID","VERSION","VALUE","ROW","COLUMN"),p.register(b.Listener,G.DocMeta.DOCUMENT_LOCALE,N,"FORMATCELLS_REGIONAL","FORMATCELLS_CUSTOM"),p.register(b.Listener,G.CellMeta.FORMATCELLS_CLIENT_CUSTOM,f)}(this);
!function(e){function t(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),s=n.view.getSheetID(t),g=n.view.getSheetState(t,s),r=n.view.getVersionID(t),S=n.view.getSelectedSheets(t),c=o[e];c.istheme=!0,c.datarange=JSUtil.Range.getRangesInString(i,r,g.getRanges()),c.asn=JSUtil.Range.findASN(i,r,c.datarange),a.applyConditionalFormat(c,void 0,i,S,r,"ICON_SET_APPLY")}var n=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,a=(e.document,e.UserAction),s=n.view.Toolbar.Feature[i.ICON_SET],o=e.ZSConstants.IconSetTheme;s.quickAction=t}(this);
!function(e){function t(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getSheetID(e),s=i.view.getVersionID(e),a=i.view.getSheetState(e,n),r=i.view.getSelectedSheets(e),c=a.getActiveRange();o.clearConditionalFormat(t,r,s,c)}var i=e.sPlusPlus,n=(i.SML.Client,e.ZSConstants),s=n.FeatureConstants,o=(e.document,e.ZSConstants.wCC,e.ZSConstants.I18N,e.UserAction),a=i.view.Toolbar.Feature[s.CONDITIONAL_FORMAT_CLEAR_RULE];a.execute=t}(this);
!function(e){function t(){var e=r.createElement("ul");e.setAttribute("ctype","zmenu"),e.id=o.SUBMENUITEM+n.CONDITIONFORMAT+o.IDENTITY,s&&s.createElement(e),C&&C.createElement(e),l&&l.createElement(e),T&&T.createElement(e),u.appendChild(e)}var a=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,r=e.document,o=(e.ZSConstants.I18N,e.ZSConstants.wCC),u=(a.view.Toolbar.Feature[n.CONDITIONFORMAT],r.getElementById("popupmenu")),C=a.view.Toolbar.Feature[n.COLOR_SCALE],l=a.view.Toolbar.Feature[n.ICON_SET],s=a.view.Toolbar.Feature[n.CF_CLASSIC],T=a.view.Toolbar.Feature[n.CF_MANAGE];t()}(this);
!function(e){function t(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),s=a.view.getSheetID(e),i=a.view.getSelectedSheets(e),n=a.view.getVersionID(e),o=a.view.getSheetState(e,s),r=o.getRanges(),g=a.data.getWorkBook(t,n),v=g.getSheetObj(s).Prop.Name;UserAction.ValidateDvRange(t,i,v,n,r,JSUtil.Range.getDateFormats())}var a=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,i=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,a.view.Toolbar.Feature[s.CREATE_DATA_VALIDATION]);i.readDataValidation=t}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=s.view.getVersionID(e),a=(s.view.getSheetID(e),s.view.getSelectedSheets(e)),i=new ZSClass.ParamGenerator(a,t,n,!0),o=i.getRanges();UserAction.RemoveDataValidation(t,a,n,o[0])}var s=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,s.view.Toolbar.Feature[n.CLEAR_DATA_VALIDATION]);a.execute=t}(this);
!function(t){function e(){{var t=i.view.getActiveGridID(),e=i.view.getResourceID(t),I=i.view.getSheetID(t),a=i.view.getVersionID(t),r=i.data.getWorkBook(e,a);r.getSheetObj(I).Prop.Name}N=N?!1:!0,N?A.zmenu("#"+T.SUBMENUITEM+n.DATA_VALIDATION+T.IDENTITY,"setAttribute","contentType","icon-text"):A.zmenu("#"+T.SUBMENUITEM+n.DATA_VALIDATION+T.IDENTITY,"setAttribute","contentType","text"),i.data.UserInfo.HighlightInvalidData=void 0==i.data.UserInfo.HighlightInvalidData?!0:!i.data.UserInfo.HighlightInvalidData,D.publish(s.Listener,o.DocAction.DATAVALIDATION.HIGHLIGHT_INVALID_DATA,{RID:e,SHEETID:I,VERSION:a})}function I(t){("sidePanelViewSetting"==t.id||t.id==T.SUBMENUITEM+n.DATA_VALIDATION+T.IDENTITY)&&(A.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#"+T.MI+n.HIGHLIGHT_DATA_VALIDATION+T.IDENTITY],"checked",i.data.UserInfo.HighlightInvalidData),A.zmenu("#"+T.SUBMENUITEM+n.DATA_VALIDATION+T.IDENTITY,"setMenuItemsAttribute",["#"+T.MI+n.HIGHLIGHT_DATA_VALIDATION+T.IDENTITY],"checked",i.data.UserInfo.HighlightInvalidData))}var i=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,T=ZSConstants.wCC,A=t.UIUtil.Component,a=t.ZSEvents,D=a.topic,s=a.Groups,o=a.Names,r=i.view.Toolbar.Feature[n.HIGHLIGHT_DATA_VALIDATION],N=!1;r.execute=e,D.register(s.UI,o.Toolbar.INIT_MENU,I,"DOM")}(this);
!function(e){function t(){var e=a.createElement("ul");e.setAttribute("data-ctype","zmenu"),e.setAttribute("data-content-type","text"),e.setAttribute("relativeto","parent"),e.id=o.SUBMENUITEM+n.DATA_VALIDATION+o.IDENTITY,u&&u.createElement(e),N&&N.createElement(e),c&&c.createMenuElement(e),s.appendChild(e),l.bind(e,"zmenuitemclick",function(e,t){var i=t.data.action;switch(i){case"createvalid":u.readDataValidation();break;case"managevalid":N.openDialog(!0);break;case"highlightinvalid":c.execute()}}),l.bind(e,"zmenubeforeshow",function(){D.publish(E.UI,T.Toolbar.INIT_MENU,{DOM:e})})}function i(e,t,i,I,n){var a=A.data.getWorkBook(e,i),o=a.getSheetObj(t),s=o.DataValidation.isXists(I,n);if(D.publish(E.Listener,T.UserAction.DATA_VALIDATION.HIDE_DV_HINT,{RID:e,SHEETID:t,VERSION:i}),!s&&D.publish(E.Listener,T.UserAction.DATA_VALIDATION.HIDE_DV_BTN,{RID:e,SHEETID:t,VERSION:i}),0!=s){var r=!0,l=function(e){r=e[I][n].IsContentValid};sPlusPlus.view.fetchCellData(e,t,i,I,n,["DV_IsValid"],A.view.getActiveGridID(),l),(s&&s.root&&s.root.helpMsg||0==r)&&D.publish(E.Listener,T.UserAction.DATA_VALIDATION.PLACE_DV_HINT,{RID:e,SHEETID:t,VERSION:i,ROW:I,COL:n,TEXT:s.root.helpMsg,TYPE:s.root.messageType,MESSAGE:s.root.messageContent}),s&&s.root.type&&D.publish(E.Listener,T.UserAction.DATA_VALIDATION.LIST_DECIDE,{RID:e,SHEETID:t,VERSION:i,ROW:I,COL:n,DV_RANGE:s})}}function I(e,t,i,I,A,n,a){D.publish(E.Listener,T.UserAction.DATA_VALIDATION.PLACE_DV_BTN,{RID:e,SHEETID:t,VERSION:i,ROW:I,COL:A,ALIGN:a})}var A=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=e.document,o=(e.ZSConstants.I18N,e.ZSConstants.wCC),s=(A.view.Toolbar.Feature[n.DATA_VALIDATION],a.getElementById("popupmenu")),r=e.ZSEvents,D=r.topic,E=r.Groups,T=r.Names,l=e.UIUtil.Component,u=A.view.Toolbar.Feature[n.CREATE_DATA_VALIDATION],N=A.view.Toolbar.Feature[n.MANAGE_DATA_VALIDATION],c=A.view.Toolbar.Feature[n.HIGHLIGHT_DATA_VALIDATION];t(),D.register(E.Listener,T.SheetAction.ACTIVE_CELL.INFO,i,"RID","SHEETID","VERSION","ROW","COLUMN","VALUE"),D.register(E.Listener,T.UserAction.DATA_VALIDATION.LIST_DECIDE,I,"RID","SHEETID","VERSION","ROW","COL","DV_RANGE","ALIGN")}(this);
!function(e){function t(e,t){var r={width:570,title:v["LinkExternalData.Create"],dialogClass:"leTCls",close:function(){l()},open:function(){}};if(!a){o=document.createElement("div"),o.id="DI_LINK_EXTERNAL_DATA";var n=T.getTemplate(["LINKEXTERNALDATA"]).LINKEXTERNALDATA;o.appendChild(n),a=new ZSClass.Dialog(o,r),s()}a.open(),i(t)}function s(){c=new r}function l(){c.closeHandling()}function i(e){c.addSheetNames(),e?(o.querySelector("#scheduleDiv").style.display="none",e&&c.loadRuleObj(e)):(o.querySelector("#"+R.csv).click(),o.querySelector("#onceNow").click())}function r(){this.wrapper=o,this.showIndex=0,this.schValue="",this.state="ADD",this.URLType=R.csv,this.schedulerType=R.schOnce,this.create()}function n(e){for(var t=new DOMParser,s=t.parseFromString(e,"text/xml"),l=s.firstChild.childNodes,i=0;i<l.length;i++){var r=l.item(i);if("sheet"===r.nodeName){var n=(r.attributes,r.childNodes[0].nodeValue);o.querySelector("#htmlDiv").innerHTML="",o.querySelector("#htmlDiv").innerHTML=n,c.showContainer(),"EDIT"==c.state&&c.selectHtmlEditTables(),u=c.URLtext,c.handleHTML()}}}var a,o,c,h,u,d=e.sPlusPlus,y=e.ZSConstants.FeatureConstants,v=(e.ZSConstants.ActionConstants,e.document,e.ZSConstants.I18N),g=(e.ZSConstants.wCC,ZSClass.Editors.RangeEditor),m=e.ZSEvents,S=m.topic,p=m.Groups,f=m.Names,b=e.UIUtil.Component,T=e.UserAction,w=d.view.Toolbar.Feature[y.CREATE_LINK_EXTERNAL],L=d.view.Toolbar.Feature[y.LINK_EXTERNAL_DATA],D={periodic:"periodic",daily:"daily",weekly:"weekly",monthly:"monthly"},R={csv:"csvsave",rss:"rsssave",html:"htmlsave",schOnce:"onceNow",schPeriod:"onceRegular"},I=/^(http+[s]*?:\/\/)|(www.)/,x=[{text:v.OK,primary:!0}],q={buttons:x,title:v["Alert.Title.InvalidURL"]};r.prototype={create:function(){this.bindButtonActions(),this.bindRangeSelector(),this.nextButton.classList.remove("ZsRt")},bindButtonActions:function(){this.selectData=o.querySelector("#selectData"),this.schedulerTags=o.querySelector("#schedulerTags"),this.tabs=document.querySelector(".lnkUrl").children,this.nextButton=o.querySelector("#letNext");var e=this;o.querySelector("#letBack").addEventListener("click",function(){e.showIndex>=0&&e.goBack()}),o.querySelector("#letNext").addEventListener("click",function(){e.showIndex<=4&&e.goNext()}),o.querySelector("#letClose").addEventListener("click",function(){a.close()}),b.bind(o.querySelector("#repeatinterval"),"zselectboxchange",function(){e.showSelectTag()}),o.querySelectorAll('input[type="radio"]').forEach(function(t){t.addEventListener("click",function(){e.changeRadioBtnAction(t)})})},bindRangeSelector:function(){h=new g(o.querySelector("#startCell"),!0),ZSClass.RangePicker.register(h,!0,!0)},goBack:function(){this.showIndex--,1==this.showIndex&&this.URLType!=R.html&&this.showIndex--,this.nextButton.classList.remove("ZsRt"),this.showContainer()},goNext:function(){return this.nextButton.classList.remove("ZsRt"),0!=this.showIndex||this.validateURL()?(0==this.showIndex&&this.URLType!=R.html&&this.showIndex++,this.showIndex++,void(4==this.showIndex?this.sendReq():1==this.showIndex&&this.URLType==R.html?this.getTables():this.showContainer())):(q.buttons[0].click=function(){o.querySelector("#webURL").focus()},void ZSClass.ZSAlert(v["Error.Hyperlink.Invalid.Url"],q))},showContainer:function(){o.querySelector("#letBack").style.display=0==this.showIndex?"none":"block",o.querySelector("#letNext").querySelector("div").innerText=3==this.showIndex?"Done":"Next > ";for(var e=o.querySelector("#container"),t=0;t<e.children.length;t++)t!=this.showIndex?(this.tabs[t].className="",e.children[t].style.display="none"):(this.tabs[t].className="active",e.children[t].style.display="block")},loadRuleObj:function(e){this.state="EDIT",this.webDataId=e.wdCellId,this.loadObj=e,this.URLtext=e.fullURL,o.querySelector("#webURL").value=e.fullURL;var t=-1==this.URLtext.indexOf(".csv")&&-1!==this.URLtext.indexOf("feed")?R.rss:"null"!==e.htmlTblList&&-1==this.URLtext.indexOf(".csv")?R.html:R.csv;o.querySelector("#"+t).click();var s=JSUtil.Range.parseRange(a.rID,a.version,e.cellName).sheetID;if(b.zcombo(o.querySelector("#sheetNameTag"),"setValue",s),h.value=e.cellName,o.querySelector("#selectType").className="disableDiv","-"==e.schTime)o.querySelector("#onceNow").click();else{o.querySelector("#onceRegular").click();var l=this.getRepeat(e);b.zcombo("#repeatinterval","setValue",l),this.showSelectTag();{e.schName.split("_")[1]}}},getRepeat:function(e){return-1!==e.schName.indexOf("hr")||-1!==e.schName.indexOf("min")?"periodic":e.interval},selectHtmlEditTables:function(){for(var e=this.loadObj.htmlTblList.split("-"),t=0;t<e.length;t++){var s="scraptbl_"+t;o.querySelector("#"+s).checked=!0;for(var l=e[t].split(","),i=1;i<l.length;i++){var r=s+"_"+l[i];o.querySelector("#"+r)&&(o.querySelector("#"+r).checked=!0)}}},validateURL:function(){return this.URLtext=o.querySelector("#webURL").value,I.test(this.URLtext)},changeRadioBtnAction:function(e){var t=e.getAttribute("id");switch(t){case R.csv:case R.rss:case R.html:this.URLType=t,this.selectData.style.display=t==R.html?"inline-block":"none";break;case R.schOnce:this.schedulerType=t,this.schValue="",o.querySelector("#scheduleDiv").style.display="none";break;case R.schPeriod:this.schedulerType=t,o.querySelector("#scheduleDiv").style.display="",this.showSelectTag()}},showSelectTag:function(){var e=b.zcombo("#repeatinterval","getValue");if(this.hideAllSchedular(),e!==D.daily){var t=b.zcombo("#"+e,"getElement");t.style.display="block"}switch(e!==D.daily&&(this.schValue=b.zcombo("#"+e,"getValue")),e){case D.periodic:break;case D.daily:o.querySelector("#scPerform").style.display="none",o.querySelector("#daily").style.display="",this.schValue=o.querySelector("#daily input").value;break;case D.weekly:break;case D.monthly:}},hideAllSchedular:function(){var e=this.schedulerTags;e.querySelectorAll("select").forEach(function(e){var t=b.zcombo(e,"getElement");t.style.display="none"}),o.querySelector("#scPerform").style.display="table-cell",o.querySelector("#daily").style.display="none"},addSheetNames:function(){var e=a.rID,t=a.version,s=d.data.getWorkBook(e,t),l=s.SheetList.getSheets(!0),i=o.querySelector("#sheetNameTag");i.innerHTML="";for(var r=0,n=l.length;n>r;r++){var c=l[r].Name,u=document.createElement("option");u.value=l[r].Id,u.innerText=c,i.appendChild(u)}b.zcombo(i,"refresh"),b.zcombo(i,"setValue",a.sheetID),h.value=d.view.getSheetState(a.gridID,a.sheetID).getActiveCellRange().getLabel()},getTables:function(){var e="parseHtml",t=(d.data.getWorkBook(a.rID,a.version),this.URLtext);u!=this.URLtext&&T.ReadTables(a.rID,a.sheetID,a.version,e,t,this.nextButton),u==this.URLtext&&this.showContainer()},sendReq:function(){var e=d.view.getActiveGridID(),t=d.view.getVersionID(e),s=d.view.getResourceID(e),l=d.view.getSelectedSheets(e),i=d.view.getSheetID(e),r=d.data.getWorkBook(s,t),n=r.getSheetObj(i).Prop.Name,o=b.zcombo("#sheetNameTag","getValue"),c=JSUtil.Range.parseRange(s,t,h.value.trim()),u=new ZSClass.Range(c.range.startRow,c.range.startCol).getLabel(),y=this.schedulerType==R.schOnce?"":this.getScheduleName(),v=this.URLType==R.html?this.getSelectedTabs():"";"EDIT"==this.state?T.refreshWebData(s,l,a.sheetID,n,a.version,"edit",o,this.webDataId,!0,u,void 0,this.URLtext,y,v):T.ApplyWebData(s,t,l,i,n,this.URLType,this.URLtext,o,u,y,v),a.close()},getTimeMinutes:function(e){var t=e.split(":"),s=parseInt(60*t[0])+parseInt(t[1]);return s},getScheduleName:function(){var e=b.zcombo("#repeatinterval","getValue");if(e===D.periodic)return b.zcombo("#"+e,"getValue");if(e===D.daily){{o.querySelector("#timeVal").value}return"daily_0"}if(e===D.weekly){{var t=b.zcombo("#weekly","getValue");o.querySelector("#timeVal","getValue")}return"weekly_"+t+"_0"}if(e===D.monthly){{var s=b.zcombo("#monthly","getValue");o.querySelector("#timeVal","getValue")}return"monthly_"+s+"_0"}},handleHTML:function(){var e=this;this.result=o.querySelector("#htmlDiv").querySelectorAll("input"),this.result.forEach(function(t){t.addEventListener("change",function(){t.id.match(/scraptbl_[0-9]*\b/)?e.toggleExtDataFields(t,this.checked):e.deSelectExtDataTables(t,this.checked)})})},toggleExtDataFields:function(e,t){var s=e.getAttribute("id");o.querySelector("#htmlDiv").querySelectorAll("[id^="+s+"] input").forEach(function(e){e.checked=t})},deSelectExtDataTables:function(e,t){var s=e.getAttribute("id").substring(0,e.getAttribute("id").lastIndexOf("_")),l=o.querySelector("#htmlDiv").querySelectorAll("[id^="+s+"] input"),i=t;if(!t)for(var r=0;r<l.length;r++)if(l[r].checked){i=!0;break}o.querySelector("#htmlDiv").querySelector("#"+s).checked=i,this.getSelectedTabs()},getSelectedTabs:function(){var e="",t="{",s="",l=0,i=0,r=[],n=Array.prototype.filter,a=n.call(this.result,function(e){return e.id.match(/scraptbl_[0-9]*\b/)});for(l=0;l<a.length;l++){var o=document.getElementById("scraptbl_"+l);if(o&&o.checked){r[i]=l,i++;for(var c=[],h=0,u=0,d=0;document.getElementById("scraptbl_"+l+"_"+h);){var y=0;if(document.getElementById("scraptbl_"+l+"_"+h+"_colspan").colSpan&&(y=document.getElementById("scraptbl_"+l+"_"+h+"_colspan").colSpan),document.getElementById("scraptbl_"+l+"_"+h).checked){c[u]=d,u++;for(var v=1;y>v;v++)c[u]=d+1,u++,d++}else for(var v=1;y>v;v++)d++;d++,h++}e=e+"&selectcols_"+l+"="+c,s+=""+l+':"'+c+'",'}}return""!==s&&(t+=s+"tblcnt:"+l),t+="}"},closeHandling:function(){this.showIndex=0,this.URLtext="",u="",this.showContainer(),o.querySelector("#webURL").value="",o.querySelector("#selectType").className="",o.querySelector("#onceNow").click(),"EDIT"==this.state&&S.publish(p.Listener,f.UserAction.WEB_DATA.MANAGE_DIALOG),this.state="ADD"}},w.openDialog=t,L.openDialog=t,S.register(p.Listener,f.UserAction.WEB_DATA.READ_TABLES,n,"TABLES"),S.register(p.Listener,f.UserAction.WEB_DATA.EDIT_DIALOG,t,"EV","EDIT_OBJ")}(this);
!function(e){function t(){var t={modal:!1,width:500,title:E["Menu.ProtectRange.ProtectSheet"],close:function(){n()},open:function(){i()}};A||(r(),A=new e.ZSClass.Dialog(m,t)),m.querySelector("#appliestorange").style.display="none",m.querySelector("#Note").innerText=E["ProtectedRange.UI.SheetLockCollaboratorsInfo"],A.open()}function r(){var t=e.UserAction.getTemplate(["LOCKCELL"]),r=t.LOCKCELL;m=document.createElement("div"),m.id="DI_LOCK_CELLS",m.appendChild(r),h=m.querySelector("#usersContainer"),m.querySelector("#saveBtn").addEventListener("click",l),m.querySelector("#cancelBtn").addEventListener("click",o),m.querySelector("#select12").addEventListener("change",c)}function o(){A.close()}function n(){for(var e=h.querySelectorAll('input[type="checkbox"]'),t=0;t<e.length;t++)e[t].checked=!1;h.innerHTML=""}function i(){m.querySelector("#lockCellsLoader").style.display="block",D.disable("#saveBtn"),d(),a()}function c(){for(var e=m.querySelector("#select12").checked,t=h.querySelectorAll('input[type="checkbox"]'),r=0;r<t.length;r++)t[r].checked=e;D.enable("#saveBtn")}function s(){var e=m.querySelector("#select12"),t=h.querySelectorAll('[type="checkbox"]:checked').length,r=Object.keys(P).length;r>t?e.checked=!1:r==t&&(e.checked=!0)}function l(){for(var t=p.view.getActiveGridID(),r=p.view.getResourceID(t),n=p.view.getVersionID(t),i=(p.data.getWorkBook(r,n),p.view.getSelectedSheets(t)),c=h.querySelectorAll('[type="checkbox"]:checked'),s=[],l=P,a=0;a<c.length;a++){var d=c[a].value;s[a]=d,delete l[d]}q=s.join(","),O=Object.keys(l).join(","),0==s.length?e.UserAction.UnlockSheet(r,i,n):e.UserAction.LockSheet(r,i,n,O,q),o()}function a(){var t=p.view.getActiveGridID(),r=p.view.getResourceID(t),o=p.view.getVersionID(t),n=p.view.getSelectedSheets(t);e.UserAction.checkRangeLockInfo(r,n,o,!0,!1)}function d(){var e=p.view.getActiveGridID(),t=p.view.getResourceID(e),r=p.view.getSheetID(e),o=p.view.getVersionID(e),n=p.data.getWorkBook(t,o),i=n.getSheetObj(r),c=i.Prop.getName(),s=m.querySelector("#appliestofieldcs");s.innerText=c,s.disabled=!0}function u(e,t){this.parent=e,this.addCollaborators(t.pr)}function S(){var e=p.view.getActiveGridID(),t=p.view.getSheetID(e),r=(p.view.getSheetState(e,t),p.view.getResourceID(e)),o=p.view.getVersionID(e),n=p.data.getWorkBook(r,o);return n.ProtectedSheets.isSheetLocked(t)}function v(e,t){if(t){for(;h.firstChild;)h.removeChild(h.firstChild);m.querySelector("#lockCellsLoader").style.display="none";{new u(h,e)}}}function g(){var e=p.view.getViewMenu();S()?e.toolbar.container.classList.add("zsDisable"):e.toolbar.container.classList.remove("zsDisable")}var h,p=e.sPlusPlus,f=e.ZSConstants,y=f.FeatureConstants,C=e.document,E=e.ZSConstants.I18N,k=(e.ZSConstants.wCC,e.ZSEvents),w=k.topic,L=k.Groups,I=k.Names,U=e.UserAction,D=(C.getElementById("popupmenu"),e.UIUtil.Component),R=e.JSUtil,b=(e.ZSConstants.ActionConstants,ZSClass.Editors.RangeEditor,ZSClass.Editors.TextAreaEditor,ZSClass.Editors.Utility,p.data.AppRegistry.USER_PHOTO_SERVER_URL),T=p.view.Toolbar.Feature[y.LOCK_SHEET],A=void 0,m=void 0,q=new R.StringBuffer,O=new R.StringBuffer,P={};u.prototype={createUser:function(e,t,r){var o=e.zuid,n=U.getTemplate(["LOCK_USERS_TEMPLATE"]).LOCK_USERS_TEMPLATE,i=document.createElement("div");i.className="dspTblRow",i.appendChild(n),i.querySelector("#profile").src=b+"/file?fs=thumb&ID="+o,i.querySelector("#name").textContent=e.name,i.querySelector("#name").title=e.email,i.querySelector("#userType").textContent=r;var c=i.querySelector('input[type="checkbox"]');e.lock&&(c.checked=!0),o==p.data.UserInfo.zuid&&(i.querySelector("#me").style.display="block"),c.id="lockCheckBox_"+t,c.value=o,c.addEventListener("change",function(){D.enable("#saveBtn"),s()}),P[o]=o,i.querySelector("label").setAttribute("for","lockCheckBox_"+t),this.parent.appendChild(i)},addCollaborators:function(e){var t=p.view.getActiveGridID(),r=(p.view.getResourceID(t),e.owner,e.rwU?e.rwU:[]),o=e.coU?e.coU:[],n=e.roU?e.roU:[],i=0;this.createUser(e.owner,i,E["ProtectRange.UI.Owner"]),i++;for(var c=0;c<o.length;c++,i++)this.createUser(o[c],i,E["ProtectRange.UI.CoOwner"]);for(var l=0;l<r.length;l++,i++)this.createUser(r[l],i,E["ProtectRange.UI.ReadWrite"]);for(var l=0;l<n.length;l++,i++)this.createUser(n[l],i,E["ProtectRange.UI.ReadOnly"]);s()}},T.isLockedSheet=S,T.openDialog=t,w.register(L.Listener,I.UserAction.SHOW_LOCK_INFO,v,"lockInfo","isSheet"),w.register(L.Listener,I.DocMeta.PROTECTED_SHEETS,g),w.register(L.Listener,I.DocAction.PROTECTED_SHEETS.MODIFY,g),w.register(L.Listener,I.DocAction.PROTECTED_SHEETS.REMOVE,g)}(this);
!function(e){function t(e,t,n){t?l.SheetLocksContainer.construct(e):l.RangeLocksContainer.construct(e,n)}function n(e){var t=e?"block":"none";l.manageDlgWrapper.querySelector("#saveBtn").style.display=t,l.manageDlgWrapper.querySelector("#manageLockInfo").style.display=t}var s=e.sPlusPlus,o=e.ZSEvents,a=o.topic,r=o.Groups,c=o.Names,i=(e.ZSConstants.I18N,e.ZSConstants.FeatureConstants),l=(e.JSUtil,s.view.Toolbar.Feature[i.MANAGE_LOCK_SETTINGS]);l.enableManageLocks=n,a.register(r.Listener,c.UserAction.READ_LOCKS,t,"lockInfo","isSheet","isWholeDocument")}(this);
!function(e){function t(e){this.container=e}function o(e,t){this.container=e,this.curSheetContainer=t,this.setAsActiveTab(),this.sheetHolders={}}function s(e,t,o){this.LockedRange=e,this.sheetName=o,this.container=t,this.userStrand={},this.constructLock(),this.constructLockUserStand(),this.addLockSectionEvents()}function r(e,t,o){this.LockedRange=e,this.container=t,this.range=o,this.userStrand={},this.constructLock(),this.constructLockUserStand(),this.addLockSectionEvents()}function n(e,t,o,s){this.user=e,this.userType=t,this.usersContainer=o,this.range=s,this.name=e.name,this.email=e.email,this.zuid=e.zuid,this.locked=this.user.lock,this.checked=this.user.lock,this.constructUser()}function i(e,t,o,s,r,n,i){for(var a=!1,c=0;c<y.modifiedRanges.length;c++)if(y.modifiedRanges[c].pr===e){a=!0,y.modifiedRanges[c].isAllUnlocked=i,y.modifiedRanges[c].au=t,y.modifiedRanges[c].uau=o,y.modifiedRanges[c].ag=s?s:y.modifiedRanges[c].ag,y.modifiedRanges[c].ao=r?r:y.modifiedRanges[c].ao,y.modifiedRanges[c].isPubA=n?n:y.modifiedRanges[c].isPubA;break}a||y.modifiedRanges.push(i?{pr:e,isAllUnlocked:i}:{pr:e,au:t.toString(),uau:o.toString(),ag:s,ao:r,isPubA:n})}var a=e.sPlusPlus,c=e.document,l=e.ZSConstants.FeatureConstants,h=(e.ZSConstants.CommandConstants,e.ZSConstants.wCC,e.ZSClass),d=e.ZSEvents,l=(d.topic,d.Groups,d.Names,e.ZSConstants),g=l.FeatureConstants,u=(l.wCC,h.Editors.RangeEditor,h.Editors.TextAreaEditor,h.Editors.Utility,e.ZSConstants.I18N),p=(a.data.AppRegistry.CSSPath,a.data.UserInfo.zuid,e.UIUtil.Component),S="active",k=e.JSUtil,y=a.view.Toolbar.Feature[g.MANAGE_LOCK_SETTINGS];t.prototype={construct:function(e){this.lockInfo=e;y.manageDlgWrapper.querySelector("#lockOpts");this.addContainerEvents();for(var t=a.view.getActiveGridID(),o=(a.view.getResourceID(t),0);o<e.length;o++){var s=e[o].sn;y.sheetLocks[s]=new h.LockSheetSection(e[o],this.container,s)}y.sheetLocksConstructed=!0,this.show()},get:function(){y.sheetLocksConstructed||this.getLocksInfoAction()},show:function(){this.setAsActiveTab(),void 0==this.lockInfo?this.get():(y.manageDlgWrapper.querySelector("#sheetLocksLoader").style.display="none",this.lockInfo.length>0?this.showLocks():this.showNoSheetLocksAvailable())},getLocksInfoAction:function(){var t=a.view.getActiveGridID(),o=a.view.getResourceID(t),s=a.view.getVersionID(t),r=a.view.getSelectedSheets(t);y.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none",y.manageDlgWrapper.querySelector("#lockOpts").style.display="block",y.manageDlgWrapper.querySelector("#sheetLocksLoader").style.display="block",e.UserAction.readProtectedSheets(o,r,s),y.sheetLocksConstructed=!0},setAsActiveTab:function(){this.appliesToEditor=y.manageDlgWrapper.querySelector("#appliestofieldM"),y.manageDlgWrapper.querySelector("#appliesTo").innerText=u["ProtectedRange.UI.ViewProtectedSheets"],y.manageDlgWrapper.querySelector("#rangeOpt").classList.remove(S),y.manageDlgWrapper.querySelector("#sheetOpt").classList.add(S),this.container.style.display="block",y.RangeLocksContainer.container.style.display="none",p.zcombo(this.appliesToEditor,"setValue","All"),p.zcombo("#appliestofieldM","disable"),y.isSheetTabSelected=!0},showLocks:function(){this.container.style.display="block",y.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none",y.manageDlgWrapper.querySelector("#lockOpts").style.display="block"},showNoSheetLocksAvailable:function(){this.container.style.display="none";var e=y.manageDlgWrapper.querySelector("#noLocksMsg");e.querySelector("#noLocksMsgSpan").innerText=u["ProtectRange.UI.NoProtectedSheet"],e.style.display="block",y.manageDlgWrapper.querySelector("#lockOpts").style.display="none"},addContainerEvents:function(){var e=y.manageDlgWrapper;y.manageDlgWrapper.querySelector("#lockOpts").style.display="block",e.querySelector("#expandAll").addEventListener("click",function(){if(y.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="table";for(var o=this.container.querySelectorAll('input[type="checkbox"]'),t=0;t<o.length;t++)o[t].checked=!0}}.bind(this)),e.querySelector("#collapseAll").addEventListener("click",function(){if(y.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="none";for(var o=this.container.querySelectorAll('input[type="checkbox"]'),t=0;t<o.length;t++)o[t].checked=!1}}.bind(this))}},h.SheetLocksContainer=t,o.prototype={construct:function(e){this.lockInfo=e;y.manageDlgWrapper.querySelector("#lockOpts");this.addContainerEvents(this.container),this.isWholeDocument&&(y.loadedSheets.All=1);for(var t=0;t<e.length;t++){var o=e[t].prArray,s=e[t].sn,r=a.view.getActiveGridID(),n=a.view.getResourceID(r),i=a.view.getVersionID(r),l=a.data.getWorkBook(n,i),d=l.SheetList.getIdByName(s);if(0==y.loadedSheets[d]){var g=c.createElement("div");g.id=s,g.className="wid wid100",this.container.appendChild(g),this.sheetHolders[s]=g;for(var u=0;u<o.length;u++){var p=o[u].pr;y.rangeLocks[p]=new h.LockRangeSection(o[u],g,p)}}else this.container.querySelector("#"+s).style.display="block";y.loadedSheets[d]=1}y.rangeLocksConstructed=!0,this.setAsActiveTab(),0==this.lockInfo.length?this.showNoRangeLocksAvailable():this.showLocks()},show:function(){this.setAsActiveTab();var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),o=a.view.getVersionID(e),s=a.data.getWorkBook(t,o),r="";this.isWholeDocument?0==Object.keys(this.sheetHolders).childElementCount?this.showNoRangeLocksAvailable():this.showLocks():(r=s.getSheetObj(y.selectedSheetId).Prop.Name,this.sheetHolders[r]&&0!=this.sheetHolders[r].childElementCount?this.showLocks():this.showNoRangeLocksAvailable())},setAsActiveTab:function(){this.appliesToEditor=y.manageDlgWrapper.querySelector("#appliestofieldM"),y.manageDlgWrapper.querySelector("#rangeOpt").classList.add(S),y.manageDlgWrapper.querySelector("#sheetOpt").classList.remove(S),p.zcombo(this.appliesToEditor,"setValue",y.selectedSheetId),y.manageDlgWrapper.querySelector("#appliesTo").innerText=u["ProtectedRange.UI.ViewProtectedRanges"],p.zcombo("#appliestofieldM","enable"),y.isSheetTabSelected=!1,y.SheetLocksContainer.container.style.display="none",this.container.style.display="block",y.manageDlgWrapper.querySelector("#rangeLocksLoader").style.display="block"},showLocks:function(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),o=a.view.getVersionID(e),s=a.data.getWorkBook(t,o);if(this.isWholeDocument)this.showAllLocks();else{this.hideAllLocks();var r=s.getSheetObj(y.selectedSheetId).Prop.Name;this.sheetHolders[r]&&(this.sheetHolders[r].style.display="block")}this.container.style.display="block",y.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none",y.manageDlgWrapper.querySelector("#rangeLocksLoader").style.display="none",y.manageDlgWrapper.querySelector("#lockOpts").style.display="block"},showAllLocks:function(){{var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),o=a.view.getVersionID(e);a.data.getWorkBook(t,o)}for(var s in this.sheetHolders)this.sheetHolders[s].style.display="block"},hideAllLocks:function(){{var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),o=a.view.getVersionID(e);a.data.getWorkBook(t,o)}for(var s in this.sheetHolders)this.sheetHolders[s].style.display="none"},showNoRangeLocksAvailable:function(){var e=y.manageDlgWrapper.querySelector("#noLocksMsg");e.querySelector("#noLocksMsgSpan").innerText=u["ProtectRange.UI.NoProtectedRange"],e.style.display="block",y.manageDlgWrapper.querySelector("#rangeLocksLoader").style.display="none",this.container.style.display="none",y.manageDlgWrapper.querySelector("#lockOpts").style.display="none"},addContainerEvents:function(){var e=y.manageDlgWrapper;e.querySelector("#lockOpts").style.display="block",e.querySelector("#expandAll").addEventListener("click",function(){if(!y.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="table";for(var o=this.container.querySelectorAll('input[type="checkbox"]'),t=0;t<o.length;t++)o[t].checked=!0}}.bind(this)),e.querySelector("#collapseAll").addEventListener("click",function(){if(!y.isSheetTabSelected){for(var e=this.container.querySelectorAll("#usersContainer"),t=0;t<e.length;t++)e[t].style.display="none";for(var o=this.container.querySelectorAll('input[type="checkbox"]'),t=0;t<o.length;t++)o[t].checked=!1}}.bind(this))}},h.RangeLocksContainer=o;var L=0;s.prototype={constructLock:function(){var e=UserAction.getTemplate(["LOCK_CONTENTS_TEMPLATE"]).LOCK_CONTENTS_TEMPLATE;this.container.appendChild(e);var t="lockSection_"+L++;this.container.querySelector("#lockSection").id=t,this.lockSection=this.container.querySelector("#"+t);var o="rangeLbl_"+L;this.lockSection.querySelector("#rangeLbl").id=o,this.lockSection.querySelector("label").setAttribute("for",o),this.lockSection.querySelector("label").querySelector("#label").textContent=this.sheetName},constructLockUserStand:function(){this.usersContainer=this.lockSection.querySelector("#usersContainer");var e=(this.LockedRange.owner,this.LockedRange.rwU?this.LockedRange.rwU:[]),t=this.LockedRange.coU?this.LockedRange.coU:[];this.userStrand[this.LockedRange.owner.zuid]=new h.LockUserStrand(this.LockedRange.owner,u["ProtectRange.UI.Owner"],this.usersContainer,this.sheetName);for(var o=0;o<t.length;o++)this.userStrand[t[o].zuid]=new h.LockUserStrand(t[o],u["ProtectRange.UI.CoOwner"],this.usersContainer,this.sheetName);for(var s=0;s<e.length;s++)this.userStrand[e[s].zuid]=new h.LockUserStrand(e[s],u["ProtectRange.UI.ReadWrite"],this.usersContainer,this.sheetName)},addLockSectionEvents:function(){this.lockSection.querySelector("#trashLock").addEventListener("click",function(){delete y.sheetLocks[this.sheetName];var t=a.view.getActiveGridID(),o=a.view.getResourceID(t),s=a.view.getVersionID(t),r=a.data.getWorkBook(o,s),n=r.SheetList.getIdByName(this.sheetName);e.UserAction.UnlockSheet(o,n,s),this.showNoSheetLocksAvailable(this.container),this.lockSection.remove()}.bind(this))},showNoSheetLocksAvailable:function(e){if(0==Object.keys(y.sheetLocks).length){var t=y.manageDlgWrapper.querySelector("#noLocksMsg");t.querySelector("#noLocksMsgSpan").innerText=u["ProtectRange.UI.NoProtectedSheet"],t.style.display="block",e.style.display="none",y.manageDlgWrapper.querySelector("#lockOpts").style.display="none"}else y.manageDlgWrapper.querySelector("#lockOpts").style.display="block"}},h.LockSheetSection=s;var v=0;r.prototype={constructLock:function(){var e=UserAction.getTemplate(["LOCK_CONTENTS_TEMPLATE"]).LOCK_CONTENTS_TEMPLATE;this.container.appendChild(e);var t="lockSection_"+v++;this.container.querySelector("#lockSection").id=t,this.lockSection=this.container.querySelector("#"+t);var o="rangeLbl_"+v;this.lockSection.querySelector("#rangeLbl").id=o,this.lockSection.querySelector("label").setAttribute("for",o),this.lockSection.querySelector("label").querySelector("#label").textContent=this.range},constructLockUserStand:function(){this.usersContainer=this.lockSection.querySelector("#usersContainer");var e=(this.LockedRange.owner,this.LockedRange.rwU?this.LockedRange.rwU:[]),t=this.LockedRange.coU?this.LockedRange.coU:[];this.userStrand[this.LockedRange.owner.zuid]=new h.LockUserStrand(this.LockedRange.owner,u["ProtectRange.UI.Owner"],this.usersContainer,this.range);for(var o=0;o<t.length;o++)this.userStrand[t[o].zuid]=new h.LockUserStrand(t[o],u["ProtectRange.UI.CoOwner"],this.usersContainer,this.range);for(var s=0;s<e.length;s++)this.userStrand[e[s].zuid]=new h.LockUserStrand(e[s],u["ProtectRange.UI.ReadWrite"],this.usersContainer,this.range)},addLockSectionEvents:function(){this.lockSection.querySelector("#trashLock").addEventListener("click",function(){delete y.rangeLocks[this.range];var t=a.view.getActiveGridID(),o=a.view.getResourceID(t),s=a.view.getVersionID(t),r=JSUtil.Range.parseRange(o,s,this.range),n=(r.sheetName,r.range),i=a.data.getWorkBook(o,s),c=i.SheetList.getIdByName(r.sheetName);e.UserAction.RemoveLockRange(o,c,n,s),this.checkLocksAvalability(this.container),this.lockSection.remove()}.bind(this))},checkLocksAvalability:function(){if(0==Object.keys(y.rangeLocks).length){this.container.style.display="none";var e=y.manageDlgWrapper.querySelector("#noLocksMsg");e.querySelector("#noLocksMsgSpan").innerText=u["ProtectRange.UI.NoProtectedRange"],e.style.display="block",y.manageDlgWrapper.querySelector("#lockOpts").style.display="none",y.RangeLocksContainer.container.style.display="none"}else y.manageDlgWrapper.querySelector("#lockOpts").style.display="block"}},h.LockRangeSection=r;var f=0;n.prototype={constructUser:function(){var e=UserAction.getTemplate(["MANAGE_LOCK_USERS_TEMPLATE"]).MANAGE_LOCK_USERS_TEMPLATE;this.usersContainer.appendChild(e),this.userStrand=this.usersContainer.querySelector("#userStrand"),this.userStrand.querySelector("#profile").src="https://contacts.zoho.com/file?fs=thumb&ID="+this.zuid,this.userStrand.querySelector("#name").textContent=this.name,this.userStrand.querySelector("#name").title=this.email,this.userStrand.querySelector("#userType").textContent=this.userType,this.userStrand.id="";var t="ZSLR_"+f++,o=this.userCheck=this.userStrand.querySelector("#lockCell1");o.id=t,this.userStrand.querySelector("label").setAttribute("for",t),o.checked=this.locked;var s=this.range;this.zuid==a.data.UserInfo.zuid&&(this.userStrand.querySelector("#me").style.display=""),this.userCheck.addEventListener("change",function(){this.checked=o.checked,this.toggleChangeManageProtect(s,this)}.bind(this))},toggleChangeManageProtect:function(e){y.enableManageLocks(!0);var t=new k.StringBuffer,o=new k.StringBuffer,s=new k.StringBuffer,r=new k.StringBuffer,n=null,a=!0,c=y.isSheetTabSelected?y.sheetLocks[e].userStrand:y.rangeLocks[e].userStrand;for(var l in c)c[l].checked?(o.append(l),a=!1):t.append(l);i(e,t.toString(",",!0),o.toString(",",!0),s.toString(",",!0),r.toString(",",!0),n,a)}},h.LockUserStrand=n}(this);
!function(e){function t(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),i=S.view.getVersionID(e),I=S.data.getWorkBook(t,i),o=S.view.getSheetID(e);I.highlightLocks=N=N?!1:!0,N?v.zmenu("#"+a.SUBMENUITEM+c.LOCK_CELLS+a.IDENTITY,"setAttribute","contentType","icon-text"):v.zmenu("#"+a.SUBMENUITEM+c.LOCK_CELLS+a.IDENTITY,"setAttribute","contentType","text"),n(t,o,i)}function i(){{var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),i=S.view.getVersionID(e);S.data.getWorkBook(t,i),S.view.getSheetID(e)}N&&v.zmenu("#"+a.SUBMENUITEM+c.LOCK_CELLS+a.IDENTITY,"setAttribute","contentType","icon-text")}function n(e,t,i){var n=S.data.getWorkBook(e,i),s=n.ProtectedSheets,r=n.getSheetObj(t),T=r.ProtectedRanges.RangeList.masterList,s=n.ProtectedSheets;N?I(e,t,i,T,s):o(e,t,i,T,s),E()}function I(e,t,i,n,I){u.publish(D.Listener,g.UserAction.HIGHLIGHT_LOCKS,{RID:e,SHEETID:t,VERSION:i,RANGELIST:n,SHEETLIST:I})}function o(e,t,i,n,I){u.publish(D.Listener,g.UserAction.REMOVE_HIGHLIGHT_LOCKS,{RID:e,SHEETID:t,VERSION:i,RANGELIST:n,SHEETLIST:I})}function s(e){("sidePanelViewSetting"==e.id||e.id==a.SUBMENUITEM+c.LOCK_CELLS+a.IDENTITY)&&(v.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#"+a.SUBMENUITEM+c.HIGHLIGHT_LOCKS+a.IDENTITY],"checked",N),v.zmenu("#"+a.SUBMENUITEM+c.LOCK_CELLS+a.IDENTITY,"setMenuItemsAttribute",["#"+a.SUBMENUITEM+c.HIGHLIGHT_LOCKS+a.IDENTITY],"checked",N))}function r(){var e=S.view.getActiveGridID(),t=S.view.getSheetID(e),i=(S.view.getSheetState(e,t),S.view.getResourceID(e)),n=S.view.getVersionID(e),I=S.data.getWorkBook(i,n);return I.ProtectedSheets.isSheetLocked(t)}function E(){var e=S.view.getViewMenu();r()?e.toolbar.container.classList.add("zsDisable"):e.toolbar.container.classList.remove("zsDisable")}var S=e.sPlusPlus,T=e.ZSConstants,c=T.FeatureConstants,a=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),L=e.ZSEvents,u=L.topic,D=L.Groups,g=L.Names,v=e.UIUtil.Component,N=!1,C=S.view.Toolbar.Feature[c.HIGHLIGHT_LOCKS];C.execute=t,u.register(D.Listener,g.DocAction.WORKSHEETS.SWITCHSHEET,i,"RID","NEWSHEETID","VERSION"),u.register(D.UI,g.Toolbar.INIT_MENU,s,"DOM")}(this);
!function(s){function t(){i.publish(o.UI,r.SidePanel.ZIA.TOGGLE)}var e=s.sPlusPlus,n=(s.ZSZIA,s.ZSConstants.FeatureConstants),u=e.view.Toolbar.Feature[n.ZIA],a=s.ZSEvents,i=a.topic,o=a.Groups,r=a.Names;u.execute=t}(this);
!function(e){function t(e,t){S.closeDialog();var r=UserAction.getTemplate(["STATUS_ALERT"]),i=r.STATUS_ALERT;i.querySelector("#msg").innerText=n["SaveAsNewSpreadsheet.SuccessMsg"];var a=i.querySelector("#fileLink");a.href=s.data.AppRegistry.ctxpath+s.data.AppRegistry.ClientURI+t,a.innerText=e,a.title=e;var o=[{text:n["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(a.href,"_blank")}},{text:n.Close}];ZSClass.ZSAlert(i,{type:"success",title:n["Alert.Title.SpreadsheetSaved"],isHtml:!0,buttons:o})}var s=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,n=ZSConstants.I18N,i=e.ZSEvents,a=i.topic,o=i.Groups,l=i.Names,S=s.view.Toolbar.Feature[r.SAVEAS];a.register(o.Listener,l.UserAction.SheetCopyResponse,t,"COPIEDSPREADSHEETNAME","RID")}(this);
!function(e){function t(){H||(T.init(E.getPanel()),H=!0)}function a(t){var a=t.col;E.tableInstance.created&&void 0!=a&&E.tableInstance.setCurrentCol(a);var n=t.mode;if(n==P){var r,i=N.getModule("SA/UI/Component/FillMissingValue/Constants"),o=t.level,c=E.JSONConstants,u=c.FILL_EMPTY_WITH_PREVIOUS_NON_EMPTY;switch(o){case i.DEFAULT_VALUE:u=c.FILL_EMPTY_WITH_VALUE,r=t.value;break;case i.MAX_OCCUR:u=c.FILL_EMPTY_WITH_MODE;break;case i.AVERAGE:u=c.FILL_EMPTY_WITH_AVERAGE}s(u,r)}else{var d=t.data.clusters;if(d){var g=l(d);g&&e.UserAction.replaceAll(g,t.callback,E.getRange(),E.tableInstance.getCurrentCol())}}}function n(e,t,a,n){for(var l=D.view.getActiveGridID(),e=D.view.getResourceID(l),t=D.view.getSheetID(l),a=D.view.getVersionID(l),r=0,i=(E.tableInstance.getCurrentCol(),0);i<n.length;i++){var s=n[i];R.publish(m.Listener,f.Layers.Recalculate.Place,{RID:e,SHEETID:t,VERSION:a,ID:r++,RANGE:new ZSClass.Range(s[0],s[1],s[2],s[3])})}}function l(t){if(t){var a=[];for(var n in t){var l=t[n];if(l.checked){var r=l.groups,i=l.replaceBy;for(var s in r)r[s].checked&&r[s].value!==i&&a.push({v:e.encodeURIComponent(r[s].value),rv:e.encodeURIComponent(i)})}}return a}}function r(a,n,l,r,i){l&&E.tableInstance.reset();var s=D.view.getActiveGridID(),c=D.view.getResourceID(s),u=D.view.getVersionID(s),g=D.view.getSelectedSheets(s);switch(a){case G:e.UserAction.clusterData(a,c,g,u,null,r,n,l,!1,E.clusterCallback,i);break;case P:!l&&E.tableInstance.created?(d(),o(i)):e.UserAction.clusterData(a,c,g,u,null,null,n,l,!0,E.clusterCallback,i);break;case M:var I=3;t(),T.load({columns:[{key:k,value:""}],mode:I}),T.onSidebarOperationMenuChange(void 0,void 0,void 0,I),_.readTable(void 0,"duplicate");break;case O:var v=4;t(),T.load({columns:[{key:k,value:""}],mode:v}),T.onSidebarOperationMenuChange(void 0,void 0,void 0,v),_.readTable(void 0,"unique")}}function i(t,a,n){if(a){var l=!E.tableInstance.created,r=JSON.parse(JSON.stringify(a)).clusters;if(E.tableInstance.setCurrentCol(r.col),null!=r.tableRange&&E.tableInstance.setRange(r.tableRange.sn,r.tableRange.sr,r.tableRange.sc,r.tableRange.er,r.tableRange.ec,r.tableRange.headers),E.tableInstance.created){var i=D.view.getActiveGridID(),s=D.view.getResourceID(i),c=D.view.getVersionID(i),g=D.data.getWorkBook(s,c),I=g.getSheetObj(E.tableInstance.sn).Prop.getName();I=(/[-\s]/.test(I)?"'"+I+"'":I)+".";var v=e.JSUtil.Cell.getReference(E.tableInstance.sr,E.tableInstance.sc),C=e.JSUtil.Cell.getReference(E.tableInstance.er,E.tableInstance.ec);E.openPanel(),E.setRange(I+v+":"+C),l?(u(r.values,E.tableInstance.headers,r.col,t),t==P&&(d(),o(n))):n&&n(r.values)}R.publish(m.UI,f.SidePanel.DATACLEANING.HIDE_LOADER)}}function s(t,a){var n=D.view.getActiveGridID(),l=D.view.getResourceID(n),r=D.view.getVersionID(n);if(E.tableInstance.created){var i=E.tableInstance,s=i.sr,o=i.currCol,c=o,u=i.er,d=i.sn,g=new Array;g.push(d);var I=new ZSClass.Range(s,c,u,o)}else var g=D.view.getSelectedSheets(n);e.UserAction.fillEmptyCells(l,r,g,I,t,a,E.getEmptyCellsCount)}function o(t){{var a=D.view.getActiveGridID(),n=D.view.getResourceID(a),l=D.view.getVersionID(a);D.view.getSheetID(a)}if(E.tableInstance.created){var r=E.tableInstance,i=r.sr,s=r.currCol,o=s,u=r.er,d=r.sn,g=new Array;g.push(d);var I=new ZSClass.Range(i,o,u,s)}else var g=D.view.getSelectedSheets(a);var v=e.module;!t&&(t=v.getModule("SA/Controller/SheetAppUIController").showFillMissingValueView),e.UserAction.getEmptyCellsCount(n,l,g,I,function(e){c(e,t)})}function c(e,t){var a=E.tableInstance.getColumnType(E.tableInstance.getCurrentCol());t&&t(e,a),A=e}function u(a,n,l,r){{var i=e.module;i.getModule("SA/Sheet2App")}if(n){n.forEach(function(e,t,a){e.value||(a[t]={key:e.key,value:"COLUMN "+p.Object.getCharForNum(e.key+1)})});var s={columns:n,currentCol:l,mode:r};t(),T.load(s,Z)}}function d(){}function g(){if(E.tableInstance.created){var e=D.view.getActiveGridID(),t=D.view.getResourceID(e),a=D.view.getVersionID(e),n=D.view.getSheetID(e),l=E.tableInstance,r=l.sr,i=l.currCol,s=i,o=l.er,c=l.sn,u="#b79715",d=new Array;d.push(c);var g=new ZSClass.Range(r,s,o,i);R.publish(m.Listener,f.UserAction.HIGHLIGHT_RANGE.ADD,{RID:t,SHEETID:n,VERSION:a,RANGEID:200,RANGE:g,COLOR:u})}}function I(e,t,a,n){N.getModule("SA/Sheet2App");n.isCol()&&E.isOpen()&&T.triggerColumnChange(n.startCol,!0)}function v(){return A}function C(e,t,a,n){if(U.showMessage(n+" "+w["SidePanel.DataCleaning.Updated"]),V){var l=E.tableInstance.getCurrentCol();T.triggerColumnChange(l,!0),V=!1}}var A,D=e.sPlusPlus,S=e.ZSConstants.FeatureConstants,w=e.ZSConstants.I18N,b=e.ZSConstants.wCC,E=D.view.Toolbar.Feature[S.DATA_CLEANING],h=e.ZSEvents,R=h.topic,m=h.Groups,f=h.Names,p=(e.document,e.JSUtil),L=e.UIUtil.Component,N=e.module,T=N.getModule("SA/Controller/SheetAppController"),U=N.getModule("SA/Controller/SheetAppUIController"),_=D.view.Toolbar.Feature[S.DATA_DUPLICATES],G=1,P=2,M=3,O=4,y=!1,V=!1,k=-2,H=!1;window.addEventListener("DC_CANCEL",function(){E.togglePanel()}),window.addEventListener("showEmptyRecords",function(){{var t=E.tableInstance.getCurrentCol(),a=new e.DCZoomLayer,n=E.tableInstance.sc,l=E.tableInstance.ec;new e.DataAccumulator(E.EmptyRows,n,l,function(){var e=arguments[0];a.hideLoader(),a.setData(e),a.setHeaders(E.tableInstance.headers),a.scrollIntoView(0,t+1),a.highlightSelectedCol(t,e.length)})}}),window.addEventListener("DC",function(){var t=arguments[0].detail,a=t.col;if(a==k){var n=D.view.getActiveGridID(),l=D.view.getSheetID(n),i=sPlusPlus.view.getSheetState(n,l),s=i.getActiveCellRange();r(t.mode,s.startCol,!0,E.getRange(),arguments[0].detail.callback)}var o=(t.level,t.mode);E.tableInstance.created&&void 0!=a&&E.tableInstance.setCurrentCol(a);var c=e.module,u=c.getModule("SA/UI/Registry"),g=c.getModule("SA/UI/Constants/ClassNames"),I=u.getComponent(g.SIDEBAR_FOOTER);I.updateBand(""),d(),F(o,a,arguments[0].detail.callback)});var F=JSUtil.fn.debounce(function(e,t,a){g(),r(e,t,!1,E.getRange(),a)},500);window.addEventListener("DC_Action",function(){V=!1,a(arguments[0].detail)}),function(t){var a=e.ZSConstants.I18N,n={id:b.SUBMENUITEM+S.DATA_CLEANING+b.IDENTITY,ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},l=[{id:"dc1",data:'{"label":"'+a["SidePanel.DataCleaning.FixSpelling"]+'", "action": '+G+"}"},{id:"dc2",data:'{"label":"'+a["SidePanel.DataCleaning.FixMissing"]+'", "action": '+P+"}"},{id:"dc3",data:'{"label":"'+a["SidePanel.DataCleaning.Duplicates"]+'", "action": '+M+"}"},{id:"dc4",data:'{"label":"'+a["SidePanel.DataCleaning.Uniques"]+'", "action": '+O+"}"}];y||(D.view.Menu.create(l,n,t).then(function(){L.bind("#"+b.SUBMENUITEM+S.DATA_CLEANING+b.IDENTITY,"zmenuitemclick",function(e,t){var n=D.view.getActiveGridID(),l=D.view.getResourceID(n),i=D.view.getVersionID(n),s=(D.view.getSheetID(n),D.view.getSelectedSheets(n)),o=new ZSClass.ParamGenerator(s,l,i,!0),c=o.getRanges()[0];return c.length>=2?void ZSClass.ZSAlert(a["action.not.support.multiselection"],{title:a["Alert.Title.InvalidCellRange"]}):(E.initPanel(),E.openPanel(),"dc3"!=t.data.id&&"dc4"!=t.data.id&&E.showLoader(),void r(t.data.action,null,!0))})}),y=!0)}();var Z=function(t,a){var n=D.view.getActiveGridID(),l=(D.view.getVersionID(n),D.view.getResourceID(n),D.view.getSheetID(n)),r=(D.view.getSheetState(n,l),a[0].srcElement);if("A"==r.nodeName){var i=a[1].row,s=E.tableInstance.getCurrentCol(),o=new e.DCZoomLayer;o.setHeaders(E.tableInstance.headers);{var c=E.tableInstance.sc,u=E.tableInstance.ec;new e.DataAccumulator(t,i,c,u,function(){var e=arguments[0];o.setData(e),o.highlightSelectedCol(s,e.length)})}}};window.addEventListener("DC_PREVIEW",function(){var t=E.tableInstance.getCurrentCol(),a=new e.DCZoomLayer;a.showLoader();{var n=E.tableInstance.sc,l=E.tableInstance.ec;new e.DataAccumulator(arguments[0].detail.rows,n,l,function(){var e=arguments[0];a.hideLoader(),a.setData(e),a.setHeaders(E.tableInstance.headers),a.scrollIntoView(0,t+1),a.highlightSelectedCol(t,e.length)})}}),window.addEventListener("DC_Action_Refresh",function(){a(arguments[0].detail),V=!0;var e=E.tableInstance.getCurrentCol();T.triggerColumnChange(e,!0)}),E.cleanseData=r,E.clusterCallback=i,E.getEmptyCellsCount=o,E.getPreviousFillCount=v,E.ACTION_FIX_MISSPELLING=G,E.highlightCurrentColumn=g,E.ACTION_FILL_MISSING_VALUES=P,R.register(m.Selector.BoundUpdate.Range,f.Selection.BOUND_UPDATE.ADD,I,"RID","SHEETID","VERSION","RANGE","accumulate","TYPE"),R.register(m.Listener,f.UserAction.DATACLEANING.HIGHLIGHT,n,"RID","SHEETID","VERSION","DATA"),R.register(m.Listener,f.UserAction.DATACLEANING.COUNT,C,"RID","SHEETID","VERSION","DATA")}(this);
!function(e){function t(){this.parent=document.querySelector("body"),this.create()}{var a,i=(e.window,e.ZSEvents),r=(i.topic,i.Groups,i.Names,e.ZSConstants.I18N);ZSZIA.Constants.View}t.prototype.create=function(){a=document.createElement("div"),a.id="rPtMd",a.classList.add("rPtM","sPDCLayer");var e=this;window.onkeydown=function(t){t=t||window.event,27==t.keyCode&&e.destroy()},this.parent.appendChild(a);var t=document.createElement("div");t.classList.add("rPtMc");var i=document.createElement("div");i.classList.add("rPtMcB"),a.appendChild(i),a.appendChild(t);var s=document.createElement("div");s.classList.add("pEsc"),s.innerText=r["Zia.Esc"],i.addEventListener("click",this.destroy),i.appendChild(s);var n=document.createElement("article");n.classList.add("rPtMcA"),t.appendChild(n);var d=document.createElement("section");d.classList.add("rPtMcAs"),n.appendChild(d);var o=document.createElement("div");o.id="rPtGrd",o.innerText=r["SidePanel.DataCleaning.Preview"],d.appendChild(o);var c=document.createElement("div");c.id="rPtCrt",c.classList.add("bgClr");var l=document.createElement("div");l.classList.add("rPtMcAc"),this.loader=document.createElement("span"),this.loader.classList.add("ZsLoader"),this.loader.style.display="none",l.appendChild(this.loader);var h=document.createElement("article");h.id="zViewSpace",l.appendChild(h),t.appendChild(l)},t.prototype.createGrid=function(){if(!this.grid){var t=a.querySelector("#zViewSpace");this.grid=new e.Handsontable(t,{rowHeaders:!1,colHeaders:!0}),e.grid=this.grid}},t.prototype.showLoader=function(){this.loader&&(this.loader.style.display="block")},t.prototype.hideLoader=function(){this.loader&&(this.loader.style.display="none")},t.prototype.setHeaders=function(e){var t=[];t.push("");for(var a in e){var i=e[a];-1!=i.key&&t.push(i.value)}this.grid&&this.grid.updateSettings({colHeaders:t,manualColumnFreeze:!0,fixedColumnsLeft:1})},t.prototype.highlightSelectedCol=function(e,t){for(var a=0;t>a;a++)this.grid.setCellMeta(a,e+1,"className","sPDataHighLight");this.grid.render()},t.prototype.setData=function(e){this.grid||this.createGrid(),this.grid.loadData(e)},t.prototype.scrollIntoView=function(e,t){this.grid&&this.grid.selectCell(e,t)},t.prototype.destroy=function(){var e=document.querySelector("#rPtMd");e.parentNode.removeChild(e)},e.DCZoomLayer=t}(this),function(e){function t(e,t,a,i){this.callback=i,this.numOfFetches=0,this.create(),this.iterateClusters(e,t,a)}var a=e.sPlusPlus,i=e.ZSClass;t.prototype={create:function(){this.store={},this.ranges=[]},iterateClusters:function(e,t,a){for(var r in e){var s=e[r],n=new i.Range(s,t,s,a);this.accumulateRanges(n)}this.fetchData()},accumulateRanges:function(e){this.ranges.push(e)},fetchData:function(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getSheetID(e),r=a.view.getVersionID(e),s=this;for(var n in this.ranges){var d=this.ranges[n],o=function(e){s.setData.call(s,e)};this.numOfFetches++,a.view.fetchRangeData(t,i,r,d,["DisplayValue"],!0,e,o,function(){})}},setData:function(e){this.numOfFetches--;var t=Object.keys(e);for(var a in t){var i=[],r=t[a],s=parseInt(r);if(!isNaN(s)){i.push(s+1);var n=e[r],d=Object.keys(n);for(var o in d){var c=d[o],l=e[r][c].DisplayValue;i.push(l)}this.store[s+1]=i}}0==this.numOfFetches&&this.callback(this.getData())},getData:function(){var e=[],t=Object.keys(this.store);for(var a in t){var i=t[a],r=[];r.push(this.store[i]);for(var s=0;s<r.length;s++)e.push(r[s])}return e}},e.DataAccumulator=t}(this);
!function(e){function t(e,t){R.closeDialog();var r=UserAction.getTemplate(["STATUS_ALERT"]),s=r.STATUS_ALERT;s.querySelector("#msg").innerText=n["CreateForm.SuccessMsg"];var i=s.querySelector("#fileLink");i.href=c+"/ropen.do?rid="+e+u,i.target="_blank",i.innerText=t,i.onclick=function(){o.publish(l.Listener,a.DocAction.AlertMsg.TRIGGER_CLOSE)};var S=[{text:n["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(i.href,"_blank")}},{text:n.Close}];ZSClass.ZSAlert(s,{type:"success",title:n["Alert.Title.FormCreated"],isHtml:!0,buttons:S})}var r=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,n=ZSConstants.I18N,i=e.ZSEvents,o=i.topic,l=i.Groups,a=i.Names,c=r.data.AppRegistry.FORM_SERVER_URL,u="&type=builder",R=r.view.Toolbar.Feature[s.CREATE_FORM];o.register(l.Listener,a.UserAction.CREATE_FORM_RESPONSE,t,"FORM_RID","FORM_NAME")}(this);
!function(e){function t(){var e=document.createElement("li");return e.setAttribute("data-item-type","separator"),e}var n=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,u=e.ZSConstants.wCC,r=e.UIUtil.Component,o=n.view.Toolbar.Feature[a.EDIT_FORM],i=n.view.Toolbar.Feature[a.DELETE_FORM],l=n.view.Toolbar.Feature[a.LIVE_FORM],m=n.view.Toolbar.Feature[a.PUBLISH_FORM];!function(){var e=document.getElementById("popupmenu"),n=document.createElement("ul");n.id=u.SUBMENUITEM+a.MANAGE_FORM+u.IDENTITY,n.setAttribute("data-ctype","zmenu"),o.createMenuElement(n),l.createMenuElement(n),m.createMenuElement(n),n.appendChild(t()),i.createMenuElement(n),e.appendChild(n),r.bind(n,"zmenubeforeshow",function(){m.updateMenuItemState()})}()}(this);
!function(e){function t(){var t=n.view.getActiveGridID(),s=n.view.getResourceID(t),u=n.view.getSheetID(t),R=n.view.getVersionID(t),d=n.data.getWorkBook(s,R),v=d.FormSheets[u],w=v[i.FORM_RID];o=a+"/ropen.do?rid="+w+r,e.window.open(o,"_blank")}var o,n=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,i=ZSConstants.CommandConstants,a=n.data.AppRegistry.FORM_SERVER_URL,r="&type=builder",u=n.view.Toolbar.Feature[s.EDIT_FORM];u.execute=t}(this);
!function(e){function t(){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),u=s.view.getSheetID(t),R=s.view.getVersionID(t),v=s.data.getWorkBook(n,R),w=v.FormSheets[u],d=w[a.FORM_RID];o=i+"/ropen.do?rid="+d+r,e.window.open(o,"_blank")}var o,s=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=ZSConstants.CommandConstants,i=s.data.AppRegistry.FORM_SERVER_URL,r="&type=showform",u=s.view.Toolbar.Feature[n.LIVE_FORM];u.execute=t}(this);
!function(e){function t(e){if(G=e,!j){var t=new w.PrintToolbar;j=new w.UIView("Print",t)}W=C.Top.menuBar.Tab,C.Top.menuBar.Tab=0,j.show(),S.querySelector(".mainGrid").style.display="none",S.querySelector("#TB_SHEET_CONTAINER").style.display="none",S.getElementById("SHEET_SB_CONTAINER").style.display="none",Z.style.display="block",p(),i(),A||(f(),A=!0)}function n(){G="PRINT",B.notif=q,i()}function i(){var e=O.Options,t=T.view.getActiveGridID(),n=T.view.getResourceID(t),i=T.view.getSheetID(t),o=T.view.getVersionID(t),s=T.view.getSheetState(t,i),a=s.getActiveRange(),l=T.data.getWorkBook(n,o),c=l.getSheetObj(i),d=c.Merge.isXists(a.startRow,a.startCol)&&c.Merge.isXists(a.endRow,a.endCol),u="SHEET";d||a.isSingle()||(u="RANGE"),B.notif.show(),UserAction.PrintPreview(n,i,o,e.addGridLines,e.addChart,e.addImage,e.addButton,u,r)}function r(e){var t=O.Options.Orientation,n=d(O.Options.PageWidth),i=d(O.Options.PageHeight),r="0"==t?n:i,s="0"==t?i:n,a={PaperWidth:r,PaperHeight:s,TopMargin:d(O.Options.MarginTop),BottomMargin:d(O.Options.MarginBottom),LeftMargin:d(O.Options.MarginLeft),RightMargin:d(O.Options.MarginRight),isFitToWidth:O.Options.FitToWidth,showGridLines:O.Options.addGridLines,showButtons:O.Options.addButton,showCharts:O.Options.addChart,showImage:O.Options.addImage},c=S.getElementById("previewContainer");!E.printPreviewObj&&(E.printPreviewObj=new w.PrintPreview(e,c,a)),l(E.printPreviewObj.getPageCount()),"PRINT"==G&&o(),D=g(),u(b.Entry.Print.Context)}function o(){E.printPreviewObj.getAllPageFragment()}function s(e){function t(){r++,r==i.length&&setTimeout(function(){K.contentWindow.print(),B.notif=M},500)}K||(K=S.createElement("iframe"),S.body.appendChild(K));var n=a(),i=e.getElementsByTagName("img"),r=0;if(0!=i.length)for(var o=0;o<i.length;o++)i[o].addEventListener("load",t);K.contentDocument.body.innerHTML=n+e.outerHTML,0==i.length&&setTimeout(function(){K.contentWindow.print(),B.notif=M},500)}function a(){var e=T.data.AppRegistry.CSSPath,t=0==O.Options.Orientation?"portrait":"landscape",n="<link rel='stylesheet' type='text/css' href='"+e+"common.css'/>",i="<link rel='stylesheet' type='text/css' href='"+e+"GridContainer.css'/>",r="<link rel='stylesheet' type='text/css' href='"+e+"SheetPane.css'/>",o="<link rel='stylesheet' type='text/css' href='"+e+"fontcustom.css'/>",s="<link rel='stylesheet' type='text/css' href='"+e+"defer/print.css'/>",a="<style type='text/css'> @page { size: "+O.Options.PageWidth+"in "+O.Options.PageHeight+"in "+t+"; margin: 0cm;} </style>";return n+i+r+o+s+a}function l(e){U.querySelector("#totPages").innerText=e,U.querySelector("#currPageIdx").value=1,H=e,p(),PrintContainer.scrollTop=0}function c(){E.printPreviewObj=void 0,B.notif.isShown&&B.notif.remove(),C.Top.menuBar.Tab=W,S.querySelector(".mainGrid").style.display="",S.querySelector("#TB_SHEET_CONTAINER").style.display="",PrintContainer.style.display="none",S.getElementById("previewContainer").innerHTML="",S.getElementById("SHEET_SB_CONTAINER").style.display="",j.hide(),u(D)}function d(e){return Math.round(96*e)}function u(e){b.focusContext(e)}function g(){return b.Stack[b.Stack.length-1]}function p(){var e=m.innerHeight-(C.Top.topBand+C.Top.menuBar.toolBar+C.Bottom.bottomBand);Z.style.height=e+"px",Z.style.width=m.innerWidth+"px";S.getElementById("previewContainer").offsetLeft}function f(){!U&&(U=S.querySelector("#printBtnCont")),Z.addEventListener("scroll",JSUtil.fn.debounce(function(e){v(e,this)},200)),U.querySelector("#currPageIdx").addEventListener("change",function(){y(this)}),U.querySelector("#fImg").addEventListener("click",function(){y(this)}),U.querySelector("#pImg").addEventListener("click",function(){y(this)}),U.querySelector("#nImg").addEventListener("click",function(){y(this)}),U.querySelector("#lImg").addEventListener("click",function(){y(this)})}function v(e,t){var n=d(O.Options.PageHeight),i=t.scrollTop,r=Math.ceil(i/n);r=r?r:1,F!=r&&(E.printPreviewObj.unloadPages(),E.printPreviewObj.loadPages(r-1,r+1),F=r,h())}function y(e){var t=1,n=e.id;switch(n){case"fImg":t=1;break;case"pImg":t=F-1;break;case"nImg":t=F+1;break;case"lImg":t=H;break;default:t=isNaN(e.value)?F:parseInt(e.value),t=t>H?H:t,e.value=t}if(H>=t&&t>0){var i=S.getElementById("previewContainer").children[t-1].offsetTop;Z.scrollTop=i,E.printPreviewObj.unloadPages(),E.printPreviewObj.loadPages(t-1,t+1)}}function h(){H>=F&&F>0&&(U.querySelector("#currPageIdx").value=F)}var T=e.sPlusPlus,P=e.ZSConstants,w=e.ZSClass,m=e.window,S=e.document,I=P.FeatureConstants,E=T.view.Toolbar.Feature[I.PRINT],O=T.view.Toolbar.Feature[I.PRINT_SETTINGS],B=T.view.Toolbar.Feature[I.PRINT+"_from_Preview"],C=T.view.measures,b=T.view.Events.Key,N=e.ZSEvents,R=N.topic,k=N.Groups,x=N.Names,L=e.ZSConstants.I18N,M=new w.TBNotification(L["Print.ProgressMessage1"],{type:"info",mode:"STD"}),q=new w.TBNotification(L["Print.ProgressMessage"],{type:"info",mode:"STD"});B.notif=M;var _=T.view.Toolbar.Feature[I.BACK_TO_EDITOR];E.printPreviewObj=void 0;var H,A,G,j,D,W,F=1,Z=S.querySelector("#PrintContainer"),U=S.querySelector("#printBtnCont");E.execute=t,B.execute=n;var K;_.execute=c,R.register(k.Listener,x.DocAction.PRINT.TRIGGER_PRINT,s,"CONTENT")}(window);
!function(e){function t(e,t,i){this.data=e,this.container=t,this.options=i,this.pageCount=1,this.pageDetails={},this.pageFragments={},this.activeBuffer=[],this.inActiveBuffer=[],this.init()}function i(e,t,i,a,s){for(var n in e){var r=e[n],o=r.startRow<t&&r.endRow<t,l=r.startCol<i&&r.endCol<i,p=r.startRow>a&&r.endRow>a,g=r.startCol>s&&r.endCol>s;return!(o||l||p||g)}}function a(e,t){var i=e/t,a=Math.floor(100*i)/100;return a>1&&(a=1),a}function s(e,t,i){if(t){var a=t.META;if(a[i]){var s=a[i].cs,n=s.indexOf(e);if(-1!=n)return s.substring(n+e.length+1,s.indexOf(";",n)+1)}}return""}function n(e){var t=e.cn,i=e.cs,a=e.cv,s=e.height,n=e.width,o=e.iconHtml,l=e.chbox,p="";if(l){var g="TRUE"==a;p=r(g),t+=" fac"}var h=document.createElement("div");h.className=t,h.setAttribute("style",i),h.style.width=n+"px",h.style.height=s+"px",h.style.overflow="hidden";var c=!1,d=c?/( (fa|ta)[lc])(\b)/i:/( (fa|ta)[rc])(\b)/i;if(d.test(t)){var f=document.createElement("div");f.className="w100",f.innerHTML=p?p:a+o,h.appendChild(f)}else h.innerHTML=p?p:a+o;return h}function r(e){var t="<input type=checkbox >";return e&&(t="<input type=checkbox checked >"),t}function o(e,t){return 256*e+t}function l(e,t,i){for(var a=0,s=e;t>=s;s++)a+=i.getDim(s);return a}function p(e,t,i){for(var a=0,s=e;t>=s;s++)a+=i.getDim(s);return a}function g(e,t,i,a,s,r,g,h,c,d){for(var f=i.length,u=c.getPos(s),v=d.getPos(r),x=(c.getPos(g),d.getPos(h),0);f>x;x++){var m,P,C=i[x],w=C.sr,y=C.sc,R=C.er,I=C.ec,E=c.getPos(w),D=d.getPos(y),T=(c.getPos(R),d.getPos(I),E-u),b=D-v,L=o(w,y),M=!1;if(w>=s&&g>w&&y>=r&&h>=y?(m=T+"px",P=b+"px",M=!0):w>=s&&g>w&&r>=y?(m=T+"px",P=-(v-D)+"px",M=!0):s>w&&y>=r&&h>=y?(m=-(u-E)+"px",P=b+"px",M=!0):s>w&&r>y&&R>=s&&I>=r&&(m=-(u-E)+"px",P=-(v-D)+"px",M=!0),M){C.sr!=C.er&&(C.height=l(C.sr,C.er,c)),C.sc!=C.ec&&(C.width=p(C.sc,C.ec,d));var A=n(C);A.id="mer_"+L,A.style.top=m,A.style.left=P,A.style.height=parseInt(A.style.height)+"px",A.style.zIndex="260",a.appendChild(A),e.pageDetails[t].mergeCellDetails[L]={startRow:w,startCol:y,endRow:R,endCol:I}}}}function h(e,t,i,a,s){for(var n=e.length,r=0;n>r;r++){var l=e[r];if(t>=l.sr&&t<=l.er&&i>=l.sc&&i<=l.ec){var p={cellid:o(l.sr,l.sc),cellHeight:parseInt(a)*(l.er-l.sr+1)+"px",cellWidth:parseInt(s)*(l.ec-l.sc+1)+"px"};return p}}return null}function c(e,t,i,a,s,n,r,o,l,p,g,c,d,f,u,v,x){var m,P=I.SparklinePool.getDataRange(a,r,n,p,g),C=u,w=h(v,p,g,c,d);if(w){var E=w.cellid;c=w.cellHeight,d=w.cellWidth,m=C.querySelector("#mer_"+E)}else{var D=C.querySelectorAll(".pRow"),T=D[p-o].children;m=T[g-l]}var b=e,L=t,M=function(e){var t=new R.Sparkline(p,g,c,d,f,P,e),i=new Image;if(i.src=t.toDataURL(),i.style.height="inherit",i.style.width="inherit",m.appendChild(i),b.pageDetails[L].sparkLineReqCount--,0==b.pageDetails[L].sparkLineReqCount){var a=document.createDocumentFragment();a.appendChild(C),b.renderPage(L-1,L,a,x)}};b.pageDetails[L].sparkLineReqCount++,y.view.fetchRangeDataFromWorker(a,s,r,P.range,["ActualValue"],!f.hidden,i,M,function(){})}function d(e,t,i,a,s,n,r,o,l,p,g,d,f,u,v,x,m){for(var P in f){for(var C=f[P],w=C.startRow,y=C.startCol,R=C.endRow,I=C.endCol,E=C.properties,P=(v.getPos(l),x.getPos(p),w);R>=P;P++)for(var D=y;I>=D;D++){var T=v.getDim(P)+"px",b=x.getDim(D)+"px",L=(v.getPos(P),x.getPos(D),!1);-1==h(u,P,D,T,b)?L=!1:P>=l&&g>P&&D>=p&&d>=D&&(L=!0),L&&c(e,t,i,a,s,n,r,l,p,P,D,T,b,E,o,u,m)}var M=e.pageDetails[t].mergeCellDetails,A=n.sparklines.groupranges;for(var P in M){var k=M[P].startRow,S=M[P].startCol,H=A.isXists(k,S);if(H){var F=H.root.properties,T=v.getDim(k)+"px",b=x.getDim(S)+"px";c(e,t,i,a,s,n,r,l,p,k,S,T,b,F,o,u,m)}}}}function f(e,t,i,a,s,n,r,o){var l=r.getPos(t),p=r.getPos(a),g=o.getPos(i),h=o.getPos(s);for(var c in n){var d=n[c],f=d.getRow(),u=d.getCol(),v=d.getRowDiff(),x=d.getColDiff(),m=r.getPos(f)+v,P=o.getPos(u)+x,C=d.getHeight(),w=d.getWidth(),p=m+C,h=P+w,y=r.find(p).idx,R=o.find(h).idx,I=r.getPos(f),E=o.getPos(u),D=I-l,T=E-g,b=!1;if(f>=t&&a>=f&&u>=i&&s>=u?(m=D+v+"px",P=T+x+"px",b=!0):f>=t&&a>f&&i>=u?(m=D+v+"px",P=-(g-(E+x))+"px",b=!0):t>f&&u>=i&&s>=u?(m=-(l-(I+v))+"px",P=T+x+"px",b=!0):t>f&&i>u&&y>=t&&R>=i&&(m=-(l-(I+v))+"px",P=-(g-(E+x))+"px",b=!0),b){var L=document.createElement("img");L.src=d.URL,L.style.position="absolute",L.style.top=m,L.style.left=P,L.style.height=C+"px",L.style.width=w+"px",L.style.zIndex="261",e.appendChild(L)}}}function u(e,t,i,a,s,n,r,o){var l=r.getPos(t),p=r.getPos(a),g=o.getPos(i),h=o.getPos(s);for(var c in n){var d=n[c],f=d.getY(),u=d.getX(),v=d.getWidth(),x=d.getHeight(),h=u+v,p=f+x,m=r.find(f),P=o.find(u),C=m.idx,w=P.idx,y=r.find(p).idx,R=o.find(h).idx,I=r.getPos(C),E=o.getPos(w),D=I-l,T=E-g,b=m.rsdue,L=P.rsdue,M=!1;if(C>=t&&a>=C&&w>=i&&s>=w?(f=D+b+"px",u=T+L+"px",M=!0):C>=t&&a>C&&i>=w?(f=D+b+"px",u=-(g-(E+L))+"px",M=!0):t>C&&w>=i&&s>=w?(f=-(l-(I+b))+"px",u=T+L+"px",M=!0):t>C&&i>w&&y>=t&&R>=i&&(f=-(l-(I+b))+"px",u=-(g-(E+L))+"px",M=!0),M){var A=document.createElement("div");A.style.zIndex="261",A.style.position="absolute",A.style.top=f,A.style.left=u,A.style.height=x+"px",A.style.width=v+"px",A.style.textAlign="center",A.innerText=d.label,A.className="ZSOLEBtn",e.appendChild(A)}}}function v(e,t,i,a,s,n,r,o){for(var l=n.length,p=r.getPos(t),g=o.getPos(i),h=r.getPos(a),c=o.getPos(s),d=0;l>d;d++){var f=n[d],u=f.getTop(),v=f.getLeft(),x=f.getWidth(),m=f.getHeight(),c=v+x,h=u+m,P=r.find(u),C=o.find(v),w=P.idx,y=C.idx,R=r.find(h).idx,I=o.find(c).idx,E=r.getPos(w),D=o.getPos(y),T=E-p,b=D-g,L=P.rsdue,M=C.rsdue,A=!1;if(w>=t&&a>=w&&y>=i&&s>=y?(u=T+L+"px",v=b+M+"px",A=!0):w>=t&&a>w&&i>=y?(u=T+L+"px",v=-(g-(D+M))+"px",A=!0):t>w&&y>=i&&s>=y?(u=-(p-(E+L))+"px",v=b+M+"px",A=!0):t>w&&i>y&&R>=t&&I>=i&&(u=-(p-(E+L))+"px",v=-(g-(D+M))+"px",A=!0),A&&f.chartInstance[0]){var k=f.chartInstance[0].renderTo.cloneNode(!0);k.removeAttribute("id"),k.style.position="absolute",k.style.zIndex="261",k.style.top=u,k.style.left=v,e.appendChild(k)}}}function x(){var e=document.createElement("div");return e.className="pRow",e}function m(e){var t=document.createElement("div");return t.style.marginLeft=e.LeftMargin+"px",t.style.marginRight=e.RightMargin+"px",t.style.marginTop=e.TopMargin+"px",t.style.marginBottom=e.BottomMargin+"px",t.className="pageDom",t}function P(e,t){var i=document.createElement("div");return i.style.height=e+"px",i.style.width=t+"px",i.className="paperDom",i}function C(e){k=[],S=!1;for(var t=0;e>t;t++)k.push(!1)}function w(e){if(!S){for(var t=!0,i=0;i<k.length;i++)if(!k[i]){t=!1;break}t&&(S=!0,D.publish(T.Listener,b.DocAction.PRINT.TRIGGER_PRINT,{CONTENT:e}))}}var y=e.sPlusPlus,R=e.ZSClass,I=e.JSUtil,E=e.ZSEvents,D=E.topic,T=E.Groups,b=E.Names,L=e.ZSConstants.FeatureConstants,M=y.view.Toolbar.Feature[L.PRINT+"_from_Preview"],A=""===document.createElement("detect").style.zoom,k=[],S=!1;t.prototype={init:function(){this.unloadPages(),this.generateRange(null,null,!0),this.loadPages(1,3),this.container.style.width=this.options.PaperWidth+"px"},generateRange:function(e,t,i){if(this.data&&this.data.SHEET_META){var s=1,n=this.options.PaperHeight-(this.options.BottomMargin+this.options.TopMargin),r=this.options.PaperWidth-(this.options.LeftMargin+this.options.RightMargin),o=this.options.isFitToWidth,l=this.data.SHEET_META,p=Object.keys(l),g=p.length,h=0;e=e?e:0,t=t?t:0;var c,d,f=e,u=t;for(c=e;g>c;c++){var v=parseInt(p[c]),x=l[v],m=x.HEIGHT;if(h+m>=n)break;var C=x.META,w=Object.keys(C),y=w.length;if(c==e){var R=0;for(d=t;y>d;d++){var I=parseInt(w[d]),E=C[I],D=E.width;if(R+D>=r&&!o)break;R+=D,u=d}if(o){s=a(r,R);var T=100*s/100*n,b=n-T,L=b/T;n+=n*L}}h+=m,f=c}var M=P(this.options.PaperHeight,this.options.PaperWidth);i&&(this.container.innerHTML=""),this.container.appendChild(M),this.pageDetails[this.pageCount]={startRow:e,endRow:f,startCol:t,endCol:u,zoom:s,sparkLineReqCount:0,mergeCellDetails:{}},g>c?(this.pageCount++,this.generateRange(c,t)):y>d&&(this.pageCount++,this.generateRange(0,d))}},loadPages:function(e,t){var i=y.data.Defaults.VIEW;this.container.classList.contains("classic")?this.container.classList.remove("classic"):this.container.classList.contains("comfort")&&this.container.classList.remove("comfort"),this.container.classList.add(i==y.data.View.CLASSIC?"classic":"comfort");for(var a=e;t>=a;a++)this.pageDetails[a]&&this.getPageFragment(a)},renderPage:function(e,t,i,a){!this.pageFragments[t]&&(this.pageFragments[t]=i.cloneNode(!0)),a?(a.children[e].appendChild(this.pageFragments[t].cloneNode(!0)),k[e]=!0,w(a)):this.container.children[e].appendChild(this.pageFragments[t].cloneNode(!0)),this.activeBuffer.push(this.container.children[e]),M.notif.isShown&&M.notif.remove()},getPageFragment:function(e,t){this.pageFragments[e]?this.renderPage(e-1,e,this.pageFragments[e],t):this.createPreviewPage(e,t)},getAllPageFragment:function(){C(this.pageCount);var e=document.getElementById("previewContainer").cloneNode(!0);e.style.top="0px",e.className="prevContainer";var t=y.data.Defaults.VIEW;e.classList.add(t==y.data.View.CLASSIC?"classic":"comfort");for(var i=1;i<=this.pageCount;i++)this.getPageFragment(i,e)},unloadPages:function(){for(var e=this.activeBuffer.length,t=0;e>t;t++)this.activeBuffer[t].innerHTML=""},createPreviewPage:function(e,t){var a=this.pageDetails[e];if(a){for(var r,o=a.startRow,l=a.startCol,p=a.endRow,h=a.endCol,c=a.zoom,P=this.data.SHEET_META,C=Object.keys(P),w=document.createDocumentFragment(),R=m(this.options),I=0,E=0,D=o;p>=D;D++){var T=parseInt(C[D]),b=P[T],L=b.HEIGHT,M=b.META;r=Object.keys(M);var k=x();k.style.height=L+"px",k.style.top=I+"px",I+=L,E=0;for(var S=l;h>=S;S++){var H=parseInt(r[S]),F=M[H];if(F.height=L,F){var N=F.width,O=F.cs;if(D==o){var B=s("border-bottom",P[T-1],H);B&&-1==B.indexOf("transparent")?O+="border-top:"+B:this.options.showGridLines&&-1==O.indexOf("border-top")&&(O+="border-top:1px solid #ccc;")}if(S==l){var W=s("border-right",P[T],H-1);W&&-1==W.indexOf("transparent")?O+="border-left:"+W:this.options.showGridLines&&-1==O.indexOf("border-left")&&(O+="border-left:1px solid #ccc;")}F.cs=O;var G=n(F);G.style.left=E+"px",k.appendChild(G),E+=N}}k.style.width=E+"px",R.appendChild(k)}{var _=y.view.getActiveGridID(),z=y.view.getResourceID(_),j=y.view.getSheetID(_),q=y.view.getVersionID(_),V=y.data.getWorkBook(z,q),U=V.getSheetObj(j);U.Merge.RangeList}if(this.data.MERGE_META.length&&g(this,e,this.data.MERGE_META,R,parseInt(C[o]),parseInt(r[l]),parseInt(C[p]),parseInt(r[h]),U.Row.axis,U.Column.axis),this.options.showCharts){var Z=new ZSChart.Utility.ChartAgent,X=Z.getAllMetaOfSheet(z,j,q);v(R,o,l,p,h,X,U.Row.axis,U.Column.axis)}if(this.options.showImage){var J=U.Images.map;f(R,o,l,p,h,J,U.Row.axis,U.Column.axis)}if(this.options.showButtons){var Y=U.Buttons.map;u(R,o,l,p,h,Y,U.Row.axis,U.Column.axis)}R.style.width=E+"px",R.style.height=I+"px",A?R.style.zoom=c:R.style.transform="scale("+c+")";var K=U.sparklines.groupranges.RangeList.masterList;if(Object.keys(K).length&&i(K,parseInt(C[o]),parseInt(r[l]),parseInt(C[p]),parseInt(r[h])))d(this,e,_,z,j,U,q,R,parseInt(C[o]),parseInt(r[l]),parseInt(C[p]),parseInt(r[h]),K,this.data.MERGE_META,U.Row.auxiliaryAxis,U.Column.axis,t);else{var w=document.createDocumentFragment();w.appendChild(R),this.renderPage(e-1,e,w,t)}}},getPageCount:function(){return this.pageCount}},R.PrintPreview=t}(window);
!function(e){function t(){var e=n.getTemplate(["PROPERTIES_USER_PROFILE"]),t=e.PROPERTIES_USER_PROFILE;r(t),u.elem&&u.elem.appendChild(t)}function r(e){var t=a.view.getActiveGridID(),r=a.view.getResourceID(t),i=a.data.getSharePublishMeta(r);if(i){{var s=i.getShareMeta(),R=s.OWNER_ID,E=s.OWNER;a.data.AppRegistry.USER_PHOTO_SERVER_URL}e.querySelector("#popup_profilePic").src=a.data.AppRegistry.USER_PHOTO_SERVER_URL+"/file?fs=thumb&ID="+R,e.querySelector("#profileName").innerText=E}}var a=e.sPlusPlus,i=e.ZSEvents,s=i.topic,R=i.Groups,E=i.Names,o=e.ZSConstants.FeatureConstants,n=(e.document,e.UserAction),u=(e.ZSConstants.wCC,a.view.Toolbar.Feature[o.PROPERTIES]);s.register(R.UI,E.Layout.TEMPLATE_LOADED,t)}(this);
!function(e){function t(){I.publish(r.UI,n.Toolbar.VERSION_HISTORY.HIDE),I.publish(r.UI,n.SidePanel.VersionHistory.CLOSE),I.publish(r.UI,n.SidePanel.VersionHistory.HIDE_ICON);var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),o=s.view.getVersionID(e),a=s.view.getVersionState(e);a.setIsCloseButton(!0),I.publish(r.Listener,n.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS,{RID:t,VERSION:o});var O=s.data.getWorkBook(t,E);O.setIsEditable(!0),E==o&&I.publish(r.Listener,n.SheetAction.VERSION_HISTORY.BACK_TO_EDITOR,{RID:t,SHEETID:i,VERSION:E}),UserAction.LoadVersion(t,i,E,!0)}var s=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,o=e.ZSEvents,I=o.topic,r=o.Groups,n=o.Names,a=s.view.Toolbar.Feature[i.BACK_TO_EDITOR_VERSION],E=sPlusPlus.data.Defaults.version;a.execute=t,I.register(r.UI,n.Toolbar.VERSION_HISTORY.BACK_TO_EDITOR.CLICK,t)}(this);
!function(t){function e(){u.publish(o.UI,i.SidePanel.Function.open)}var s=t.sPlusPlus,n=t.ZSEvents,u=n.topic,o=n.Groups,i=n.Names,a=t.ZSConstants.FeatureConstants,c=s.view.Toolbar.Feature[a.INSERT_FUNCTION];c.execute=e}(this);
!function(e){function t(e){if(e.id==h.SUBMENUITEM+M.COMMENTS+h.IDENTITY||"sidePanelViewSetting"==e.id){var t=r.view.getActiveGridID(),i=r.view.getResourceID(t),n=r.view.getVersionID(t),s=r.data.getWorkBook(i,n);e.id==h.SUBMENUITEM+M.COMMENTS+h.IDENTITY?(A.zmenu("#"+h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,"setMenuItemsAttribute",["#showAllComments"],"hidden",N),A.zmenu("#"+h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,"setMenuItemsAttribute",["#hideAllComments"],"hidden",!N),A.zmenu("#"+h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,"setMenuItemsAttribute",["#highlightAllComments"],"checked",s.highlightComments)):"sidePanelViewSetting"==e.id&&A.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#highlightAllComments"],"checked",s.highlightComments)}}function i(e){N=e}function n(){T.publish(c.UI,C.SidePanel.Comments.TOGGLE)}function s(){T.publish(c.Listener,C.ERROR.SHOW,{ERRORMSG:"ErrorMsg.YetToImplement"})}function a(e,t,i,n,s){var a=I.createElement("li");!!s&&(a.id=s),a.setAttribute(t,i),e.appendChild(a)}function o(e){T.publish(c.UI,C.SidePanel.Comments.OPEN),T.publish(c.UI,C.SidePanel.Comments.FOCUS),T.publish(c.Listener,C.UserAction.REVIEW_COMMENTS.TRIGGER_ADD),e&&e.preventDefault()}function l(){var e=I.getElementById("popupmenu"),t=I.createElement("ul");t.id=h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,t.setAttribute("data-ctype","zmenu"),t.setAttribute("relativeto","parent"),t.setAttribute("data-content-type","text"),a(t,"data",'{"label":"'+S["MenuItem.InsertTab.Comments.AddComment"]+'", "action":"add"}'),m(t),d(t),a(t,"data-item-type","separator"),a(t,"data",'{"label":"'+S["MenuItem.InsertTab.Comments.NotificationSettings"]+'", "action": "notify"}'),a(t,"data-item-type","separator"),g.createHighlightMenuElement(t),e.appendChild(t),A.bind(t,"zmenuitemclick",function(e,t){var i=t.data.action;switch(i){case"add":o(e);break;case"showAll":n();break;case"hideAll":n();break;case"notify":g.openNotificationSetingsDialog();break;case"highlight":g.triggerHighlightAllComments()}}),A.bind(t,"zmenubeforeshow",function(){u(t)})}function m(e){var t=I.createElement("li");t.id="showAllComments",t.setAttribute("data-value","showAll"),t.setAttribute("data",'{"action":"showAll", "itemType": "checkbox", "label":"'+S["MenuItem.InsertTab.Comments.ShowComment"]+'"}'),e.appendChild(t)}function d(e){var t=I.createElement("li");t.id="hideAllComments",t.setAttribute("data-value","hideAll"),t.setAttribute("data",'{"action":"hideAll", "itemType": "checkbox", "label":"'+S["Discussion.HideComments"]+'"}'),e.appendChild(t)}function u(e){if(e.id==h.SUBMENUITEM+M.COMMENTS+h.IDENTITY){var t=r.view.getActiveGridID(),i=r.view.getResourceID(t),n=r.view.getVersionID(t),s=r.data.getWorkBook(i,n);A.zmenu("#"+h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,"setMenuItemsAttribute",["#showAllComments"],"hidden",N),A.zmenu("#"+h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,"setMenuItemsAttribute",["#hideAllComments"],"hidden",!N),A.zmenu("#"+h.SUBMENUITEM+M.COMMENTS+h.IDENTITY,"setMenuItemsAttribute",["#highlightAllComments"],"checked",s.highlightComments)}}var r=e.sPlusPlus,I=e.document,M=e.ZSConstants.FeatureConstants,h=e.ZSConstants.wCC,E=(e.ZSClass,e.ZSEvents),T=E.topic,c=E.Groups,C=E.Names,S=e.ZSConstants.I18N,A=e.UIUtil.Component,g=(ZSConstants.CommandConstants,r.data.Defaults.MAX_COL,r.data.Defaults.MAX_ROW,r.view.Toolbar.Feature[M.COMMENTS]),N=!1;g.toggleCmtPanel=n,g.openDialog=s,g.openAndAddComment=o,l(),T.register(c.UI,C.Toolbar.INIT_MENU,t,"DOM"),T.register(c.UI,C.SidePanel.Comments.PANELSTATUS,i,"isShown")}(this);
!function(e){function t(){c.contentWindow.print();var e=c.contentDocument.body,t=e.firstElementChild;e.removeChild(t)}function n(e){var n=i.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=d+"defer/sidepanel/ReviewComments.css",n.addEventListener("load",t);var a=i.createElement("link");a.type="text/css",a.rel="stylesheet",a.href=d+"common.css";var o=i.createElement("div");o.id="commentContainer",o.innerHTML=e.innerHTML,c.contentDocument.head.appendChild(n),c.contentDocument.head.appendChild(a),c.contentDocument.body.appendChild(o)}var a=sPlusPlus,i=e.document,o=e.ZSConstants,s=o.FeatureConstants,r=a.view.Toolbar.Feature[s.COMMENTS],d=a.data.AppRegistry.CSSPath,c=i.createElement("iframe");c.style.display="none",i.body.appendChild(c),r.print=n}(this);
!function(e){function t(e,t,i,s,o,r,l,c,a,m,h,d,v,u,p){this.parent=n(),this.commentID=t,this.content=i,this.likes=s,this.ownerID=o,this.ownerName=r,this.range=l,this.sheetID=c,this.state=a,this.time=m,this.type=h,this.unRead=d,this.newComment=v,this.replies=new Array,this.repliesCnt=u,this.liked=!1,this.iswms=p,this.isReply=!1,this.contentClassName="sPCmtLess",this.allowedHgt=57,this.constructComment(),this.updateCount(),this.constructNotification(),this.bindShowLikedList()}function i(e,t,i,s,n,o,r,l,c,a,m,h){this.parent=e,this.parentID=t,this.commentID=i,this.content=s,this.likes=n,this.ownerID=o,this.ownerName=r,this.time=l,this.type=c,this.unRead=a,this.liked=!1,this.newReply=m,this.iswms=h,this.isReply=!0,this.contentClassName="sPCmtLesser",this.allowedHgt=38,this.constructReply(),this.constructNotification(),this.bindShowLikedList()}function s(e,t,i,s,n,o,r,l){this.parent=e,this.parentID=t,this.commentID=i,this.content=s,this.ownerID=n,this.ownerName=o,this.time=r,this.type=l,this.contentClassName="sPCmtLesser",this.allowedHgt=38,this.isNotification=!0,this.construct()}function n(){return D.querySelector("#sPCmtHolder")}function o(e,t){var i=S.view.getActiveGridID(),s=S.view.getResourceID(i),n=S.view.getVersionID(i),o=S.data.getWorkBook(s,n),r=o.getSheetObj(e),l=r.Prop.getName(),c=l+"."+JSUtil.Cell.getReference(t.sr,t.sc);return(t.sr!=t.er||t.sc!=t.ec)&&(c=c+":"+JSUtil.Cell.getReference(t.er,t.ec)),c}function r(e,t,i,s){var n=e.querySelector("#replyCard"),o=e.querySelector("#replyBtn"),r=e.querySelector("#cancelBtn"),c=e.querySelector("#editableContent"),m=e.querySelector(".sPCmtSmiley");m.setAttribute("data-content","#smileySuggestions"),m.setAttribute("data-is-content-html-encoded",!0),m.setAttribute("data-class-name","shRenameAni"),m.addEventListener("click",function(){N.divToAddSmiley=e}),_.zpopover(m),c.addEventListener("keydown",function(r){l(r,i,s,c,t,o,e,n)}),c.addEventListener("keyup",function(){N.commentContentValidation(c,o)}),c.addEventListener("input",function(){c.textContent&&c.classList.remove("sPPlaceHolder")}),o.disabled=!0,o.addEventListener("click",function(){a(i,s,c,t,o,e,n)}),r.addEventListener("click",function(){t.style.display="block",e.removeChild(r.parentNode)})}function l(e,t,i,s,n,o,r,l){var c=e.keyCode||e.which;27==c&&(n.style.display="block",r.removeChild(l)),N.validateContent(s)&&(e.metaKey||e.ctrlKey)&&13==c&&a(t,i,s,n,o,r,l)}function c(e,t,i,s,n,o){var r=e.keyCode||e.which;27==r&&(n.querySelector("#sPRplyCmtEdit").style.display="",n.querySelector("#sPCmtDateHlr").style.display="block",n.querySelector("#content").style.display="block",t.remove()),N.validateContent(o)&&(e.metaKey||e.ctrlKey)&&13==r&&m(t,i,s,n)}function a(e,t,i,s,n,o){var r=D.getElementById("commentsLoader").cloneNode(!0);o.appendChild(r);var l=JSUtil.RCMentionDataShim.getRichTextContent(i);g.publish(f.Listener,P.UserAction.REVIEW_COMMENTS.TRIGGER_REPLY,{content:l,commentID:e,range:t})}function m(t,i,s,n){var o=D.getElementById("commentsLoader").cloneNode(!0);n.appendChild(o);var r=S.view.getActiveGridID(),l=S.view.getResourceID(r),c=S.view.getSheetID(r),a=S.view.getVersionID(r),m=S.data.getWorkBook(l,a),h=(m.getSheetObj(c),w.loginName,S.view.getSelectedSheets(r)),d=S.view.getSheetID(r),v=S.view.getSheetState(r,d),u=v.getActiveRange(),p=t.querySelector("#editableContent"),y=JSUtil.RCMentionDataShim.getRichTextContent(p);e.UserAction.updateReviewCommentReply(l,a,h,i,s,y,u)}function h(e,t,i,s,n,o){var r=e.keyCode||e.which;27==r&&(o.querySelector(".sPCmtMenu").style.display="block",o.querySelector("#sPCmtCardHldr").style.display="block",n.remove()),N.validateContent(s)&&(e.metaKey||e.ctrlKey)&&13==r&&d(t,i,s,n,o)}function d(t,i,s,n){var o=D.getElementById("commentsLoader").cloneNode(!0);n.appendChild(o);var r=S.view.getActiveGridID(),l=S.view.getResourceID(r),c=S.view.getSheetID(r),a=S.view.getVersionID(r),m=S.data.getWorkBook(l,a),h=(m.getSheetObj(c),w.loginName,S.view.getSelectedSheets(r)),d=JSUtil.Range.parseRange(l,a,i.value).range,v=JSUtil.RCMentionDataShim.getRichTextContent(s);e.UserAction.updateReviewComment(l,a,h,t,v,d)}function v(e,t,i){var s,n=S.view.getActiveGridID(),o=S.view.getResourceID(n);s=i?"/comments/"+e+"/replies/"+t:"/comments/"+e;var r=S.data.AppRegistry.ctxpath+S.data.AppRegistry.ClientURI+o+s;return r}function u(e,t){return e=JSUtil.RCMentionDataShim.convertRichTextContent(e),e=JSUtil.LinkMaker.convert(e,t,!0).msg}function p(e){var t=UserAction.getTemplate(["SP_LIKED_USER_PROFILE"]),i=t.SP_LIKED_USER_PROFILE,s=D.getElementById("popupmenu").querySelector("#sPLikeList");!s&&(s=D.getElementById("sPLikeList")),s.innerHTML="";for(var n=0;n<e.length;n++){var o=D.createElement("li"),r=i.cloneNode(!0);r.querySelector("#sPLikedPhoto").src=q+"/file?fs=thumb&ID="+e[n][C.USER_ID],r.querySelector("#sPLikedUsrName").innerText=e[n][C.USER_NAME],o.appendChild(r),s.appendChild(o)}}var S=e.sPlusPlus,D=e.document,y=e.ZSConstants.FeatureConstants,C=e.ZSConstants.CommandConstants,E=e.ZSConstants.wCC,k=e.ZSClass,R=e.ZSEvents,g=R.topic,f=R.Groups,P=R.Names,y=e.ZSConstants,I=y.FeatureConstants,E=y.wCC,T=k.Editors.RangeEditor,L=(k.Editors.TextAreaEditor,k.Editors.Utility,e.ZSConstants.I18N),w=(S.data.AppRegistry.CSSPath,S.data.UserInfo),_=e.UIUtil.Component,N=(S.view.Events.Key,S.view.Toolbar.Feature[I.COMMENTS]);N.Notifier=[],N.currentCards=[],N.dltDivStack=[];var q=S.data.AppRegistry.USER_PHOTO_SERVER_URL,A=2,M=3,U=0,b=1,O=2;t.prototype={commentDiv:null,commentHldrDiv:null,commentMenuDiv:null,profileDiv:null,contentDiv:null,dateDiv:null,replyDiv:null,constructComment:function(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),i=(S.view.getSheetID(e),S.view.getVersionID(e)),s=S.data.getWorkBook(t,i),n=s.highlightComments;this.createCommentTemplate(),this.createProfileTemplate(),this.content&&this.createContentTemplate(),this.createDateTemplate(),this.createReplyTemplate(),this.createCommentMenu(),this.createResolvedState(),n&&this.highlight(n)},createCommentTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_THREAD"]).SP_COMMENTS_THREAD;this.commentDiv=D.createElement("div"),this.commentDiv.id="sPCmtCard_"+this.commentID,this.commentDiv.className="sPCmtCard wid wid100 mb20",this.commentDiv.appendChild(e),this.newComment?this.parent.prepend(this.commentDiv):this.parent.appendChild(this.commentDiv),this.commentHldrDiv=this.commentDiv.querySelector("#sPCmtCardHldr"),this.commentMenuDiv=this.commentDiv.querySelector(".sPCmtMenu"),this.unRead&&this.ownerID!=w.zuid&&this.commentHldrDiv.classList.add("sPCmtUnread"),this.commentDiv.addEventListener("click",function(){N.updatePanelHighlights([this.commentID]),this.commentHldrDiv.classList.remove("sPCmtUnread"),N.triggerHighlight(this.range,this.sheetID,this.commentID)}.bind(this))},createProfileTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_PROFILE"]).SP_COMMENTS_PROFILE;this.commentHldrDiv.appendChild(e),this.profileDiv=this.commentDiv.querySelector("#sPCmtPrf"),this.setPhoto(),this.setName(),this.setRange()},createContentTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_CONTENT"]).SP_COMMENTS_CONTENT;this.commentHldrDiv.appendChild(e),this.contentDiv=this.commentDiv.querySelector("#content"),this.setContent()},createDateTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_DATE"]).SP_COMMENTS_DATE;this.commentHldrDiv.appendChild(e),this.dateDiv=this.commentDiv.querySelector("#sPCmtDate"),this.setTime(),this.setLikes(),this.showRepliesOption()},createReplyTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_REPLY"]).SP_COMMENTS_REPLY;this.commentDiv.appendChild(e)},createCommentMenu:function(){var e=E.SUBMENUITEM+I.COMMENTS+E.IDENTITY,t="active"==this.state?e+"_collabActiveCmtMenu":e+"_collabResolvedCmtMenu";this.ownerID==w.zuid?t="active"==this.state?e+"_activeCmtMenu":e+"_resolvedCmtMenu":w.Permission.isSharable&&(t="active"==this.state?e+"_docOwnerActiveCmtMenu":e+"_resolvedCmtMenu"),this.commentDiv.querySelector("#"+t),this.commentMenuDiv.setAttribute("data-menu-id",t),this.commentMenuDiv.setAttribute("data-uid",this.commentID)},createReplyTemplate:function(){var e=UserAction.getTemplate(["SP_COMMENTS_REPLY"]).SP_COMMENTS_REPLY;this.commentDiv.appendChild(e),this.replyDiv=this.commentDiv.querySelector("#sPCmtRplyCard");var t=this.replyDiv.querySelector("#sPCmtRplyTxt");t.addEventListener("click",function(){this.commentDiv.querySelector("#cnlBtn")&&this.commentDiv.querySelector("#cnlBtn").click();var e=t.parentNode;t.style.display="none";var i=UserAction.getTemplate(["SP_REPLY_CARD"]).SP_REPLY_CARD;e.appendChild(i);var s=e.querySelector("#editableContent");s.focus(),r(e,t,this.commentID,this.range),this.replyBtn=t,this.addReplyBtn=this.replyDiv.querySelector("#replyBtn"),JSUtil.RCMentionDataShim.connectProcessMention(s)}.bind(this))},createResolvedState:function(){if("active"!=this.state){var e=UserAction.getTemplate(["SP_RESOLVE_STATE"]).SP_RESOLVE_STATE;this.commentDiv.querySelector("#sPCmtCardHldr").appendChild(e)}},setPhoto:function(){this.profileDiv.querySelector("#sPCmtPhoto").src=q+"/file?fs=thumb&ID="+this.ownerID},setName:function(){this.profileDiv.querySelector("#sPCmtUsrName").innerText=this.ownerName},setRange:function(){this.profileDiv.querySelector("#sPCmtRng").innerText=o(this.sheetID,this.range)},setContent:function(){var e=u(this.content,this.sheetName,this.iswms);this.contentDiv.innerHTML=e,this.iswms?this.contentDiv.classList.remove(this.contentClassName):JSUtil.RCMentionDataShim.checkEllipse(this.contentDiv,e,this.allowedHgt,this.contentClassName)},setLikes:function(){var t=this.commentDiv.querySelector("#splike");(1==this.type||2==this.type)&&t&&t.remove();var i=this.likes;this.likeCount=i.length,this.updateLikeCnt();for(var s=0;s<this.likeCount;s++){{var n=i[s][C.USER_ID];i[s][C.USER_NAME]}n==w.zuid&&(this.liked=!0)}this.updateLikeCntTitle(),this.liked&&this.updateLikeElStyle(this.liked),this.updateLikeTitle(this.liked);var o=this.commentID;t.addEventListener("click",function(t){var i=S.view.getActiveGridID(),s=S.view.getResourceID(i),n=S.view.getSheetID(i),r=S.view.getVersionID(i),l=S.data.getWorkBook(s,r),c=(l.getSheetObj(n),w.loginName,S.view.getSelectedSheets(i)),a=S.view.getSheetID(i),m=S.view.getSheetState(i,a),h=m.getActiveRange();this.classList.contains("shLikeActive")?e.UserAction.unlikeReviewComment(s,r,c,o,h):e.UserAction.likeReviewComment(s,r,c,o,h),t.stopPropagation()})},updateLikeCnt:function(){var e=this.commentDiv.querySelector("#likeCnt");this.likeCount>0?(e.innerText=this.likeCount,e.style.display=""):e.style.display="none"},updateLikeElStyle:function(e){var t=this.commentDiv.querySelector("#splike");e?t.classList.add("shLikeActive"):t.classList.remove("shLikeActive")},updateLikeTitle:function(e){var t=this.commentDiv.querySelector("#splike");t.title=e?L["Discussion.Liked"]:L["Discussion.Like"]},updateLikeCntTitle:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=[];switch(this.likeCount){case 0:e.title="";break;case 1:var i=this.liked?L["Discussion.You"]:this.likes[0][C.USER_NAME];e.title=JSUtil.fn.replaceParams(L["Discussion.LikedBy"],new Array(i));break;case 2:if(this.liked){var s=this.likes[0][C.USER_ID]==w.zuid?1:0;t.push(L["Discussion.You"],this.likes[s][C.USER_NAME])}else t.push(this.likes[0][C.USER_NAME],this.likes[1][C.USER_NAME]);e.title=JSUtil.fn.replaceParams(L["Discussion.LikedByAnd"],t);break;default:if(this.liked){var s=this.likes[0][C.USER_ID]==w.zuid?1:0;t.push(L["Discussion.You"],this.likes[s][C.USER_NAME],this.likeCount-2)}else t.push(this.likes[0][C.USER_NAME],this.likes[1][C.USER_NAME],this.likeCount-2);e.title=JSUtil.fn.replaceParams(L["Discussion.LikedByAndMore"],t)}},updateLikes:function(e){var t=e[C.USER_ID],i=e[C.USER_NAME],s=e[C.STATE];if(s){var n={};n[C.USER_ID]=t,n[C.USER_NAME]=i,this.likes.push(n)}else for(var o=0;o<this.likes.length;o++)if(this.likes[o][C.USER_ID]==t){this.likes.splice(o,1);break}t==w.zuid&&(this.liked=s,this.updateLikeElStyle(s),this.updateLikeTitle(s)),s?this.likeCount++:this.likeCount--,this.updateLikeCnt(),this.updateLikeCntTitle()},setTime:function(){var e=this.dateDiv;e.innerText=this.time,e.href=N.getLink(this.commentID,null,!1),e.addEventListener("click",function(){event.stopPropagation()})},setState:function(e){e=1==e?"resolved":"active","active"===e?this.commentDiv.querySelector("#spCmtRslvd")&&this.commentDiv.querySelector("#spCmtRslvd").remove():this.createResolvedState(),"all"!=N.currentFilter&&N.currentFilter!=e&&this.commentDiv.remove(),this.removeCommentMenu(),this.state=e,this.createCommentMenu()},updateCount:function(){},constructNotification:function(){this.unRead&&this.ownerID!=w.zuid&&(N.Notifier[this.commentID]=new s(this.commentDiv,this.commentID,this.commentID,this.content,this.ownerID,this.ownerName,this.time,M))},updateContent:function(e,t){var i=u(e,this.sheetName,!0);this.contentDiv.innerHTML=i,this.content=e,t==w.zuid&&this.commentDiv.querySelector("#editCmtCard")&&(this.commentDiv.querySelector("#sPCmtCardHldr").style.display="block",this.commentDiv.querySelector("#editCmtCard").remove(),this.commentDiv.querySelector(".sPCmtMenu").style.display="block")},updateRange:function(e,t){this.sheetID=e,this.range=t,this.profileDiv.querySelector("#sPCmtRng").innerText=o(e,t),N.triggerHighlight(t,e,this.commentID)},updateState:function(){},showRepliesOption:function(){var e=this.repliesCnt,t=this.commentID,i=this.commentDiv;if(e>A){var s=JSUtil.fn.replaceParams(L["Discussion.ViewOlderReplies"],new Array(e-A+"")),n=i.querySelector("#sPCmt_viewOlderReplies");n.innerText=s,n.style.display=""}else A>=e&&e>0&&(i.querySelector("#spCmt_hideReplies").style.display="");this.commentDiv.querySelector("#sPCmt_viewOlderReplies").addEventListener("click",function(){var e=0;this.remove(),i.querySelector("#spCmt_hideReplies").style.display="",g.publish(f.Listener,P.UserAction.REVIEW_COMMENTS.FETCH,{disId:t,action:e})}),this.commentDiv.querySelector("#sPCmt_viewAllReplies").addEventListener("click",function(){for(var e=i.querySelector("#sPRepCardHldr").children,t=0;t<e.length;t++)e[t].style.display="block";this.style.display="none",i.querySelector("#spCmt_hideReplies").style.display=""}),this.commentDiv.querySelector("#spCmt_hideReplies").addEventListener("click",function(){for(var e=i.querySelector("#sPRepCardHldr").children,t=0;t<e.length;t++)e[t].style.display="none";this.style.display="none",i.querySelector("#sPCmt_viewAllReplies").style.display=""})},viewReplies:function(e){for(var t=this.repliesCnt-A;t>=1;t--)this.addReply(e[t].parentID,e[t].commentID,e[t].content,e[t].likes,e[t].ownerID,e[t].ownerName,e[t].time,e[t].type,e[t].unRead,!1)},updateRepliesOptionOnDelete:function(){this.repliesCnt=this.repliesCnt-1,0==this.repliesCnt&&(this.commentDiv.querySelector("#sPCmt_viewOlderReplies").style.display="none",this.commentDiv.querySelector("#spCmt_hideReplies").style.display="none")},updateRepliesOptionOnAdd:function(){var e="none";this.commentDiv.querySelector("#sPCmt_viewOlderReplies")&&this.commentDiv.querySelector("#sPCmt_viewOlderReplies").style.display==e&&this.commentDiv.querySelector("#spCmt_hideReplies").style.display==e&&this.commentDiv.querySelector("#sPCmt_viewAllReplies").style.display==e&&(this.commentDiv.querySelector("#spCmt_hideReplies").style.display=""),this.replyBtn&&(this.replyBtn.style.display="block",this.replyDiv.querySelector("#replyCard")&&this.replyDiv.querySelector("#replyCard").remove(),this.replyDiv.querySelector("#commentsLoader")&&this.replyDiv.querySelector("#commentsLoader").remove())},remove:function(t){var i=UserAction.getTemplate(["SP_DELETE"]).SP_DELETE;this.commentDiv.appendChild(i);var s=this.commentDiv.querySelector("#dltDiv"),n=this.commentDiv.querySelector("#cnlBtn"),o=this.commentDiv.querySelector("#dltBtn"),r=this.commentDiv,l=this.range,c=new k.Range(l.sr,l.sc,l.er,l.ec);this.commentDiv.style.overflow="hidden",N.dltDivStack.push({del:s,cmt:r}),o.addEventListener("click",function(i){r.remove(),N.hideHighlightComment(!0);var s=S.view.getActiveGridID(),n=S.view.getResourceID(s),o=S.view.getSheetID(s),l=S.view.getVersionID(s),a=S.data.getWorkBook(n,l),m=(a.getSheetObj(o),w.loginName,S.view.getSelectedSheets(s));e.UserAction.deleteReviewComment(n,l,m,t,c),r.style.overflow="",i.stopPropagation()}),n.addEventListener("click",function(){s.remove(),r.style.overflow=""})},resolve:function(t){var i=S.view.getActiveGridID(),s=S.view.getResourceID(i),n=S.view.getSheetID(i),o=S.view.getVersionID(i),r=S.data.getWorkBook(s,o),l=(r.getSheetObj(n),w.loginName,S.view.getSelectedSheets(i)),c=this.range,a=new k.Range(c.sr,c.sc,c.er,c.ec);e.UserAction.resolveReviewComment(s,o,l,t,a)},reopen:function(t){var i=S.view.getActiveGridID(),s=S.view.getResourceID(i),n=S.view.getSheetID(i),o=S.view.getVersionID(i),r=S.data.getWorkBook(s,o),l=(r.getSheetObj(n),w.loginName,S.view.getSelectedSheets(i)),c=this.range,a=new k.Range(c.sr,c.sc,c.er,c.ec);e.UserAction.reopenReviewComment(s,o,l,t,a)},edit:function(e){var t=this.commentDiv;t.querySelector("#sPCmtCardHldr").style.display="none",t.querySelector(".sPCmtMenu").style.display="none";var i=JSUtil.RCMentionDataShim.convertRichTextContent(this.content);t.querySelector("#cnlBtn")&&this.commentDiv.querySelector("#cnlBtn").click(),t.querySelector("#cancelBtn")&&this.commentDiv.querySelector("#cancelBtn").click();var s=UserAction.getTemplate(["SP_EDIT_COMMENT"]).SP_EDIT_COMMENT;t.prepend(s);var n=t.querySelector("#editCmtCard");n.querySelector("#sPCmtUsrName").innerText=this.ownerName,n.querySelector("#sPCmtPhoto").src=q+"/file?fs=thumb&ID="+this.ownerID;var r=n.querySelector("#submitBtn"),l=n.querySelector(".sPCmtSmiley");l.setAttribute("data-content","#smileySuggestions"),l.setAttribute("data-is-content-html-encoded",!0),l.setAttribute("data-class-name","shRenameAni"),l.addEventListener("click",function(){N.divToAddSmiley=n}),_.zpopover(l);var c=new T(n.querySelector("#rng"),!0);k.RangePicker.register(c,!0,!1);var a=n.querySelector("#editableContent");JSUtil.RCMentionDataShim.connectProcessMention(a),a.addEventListener("keydown",function(i){h(i,e,c,a,n,t)}),a.addEventListener("keyup",function(){N.commentContentValidation(a,r)}),r.addEventListener("click",function(){d(e,c,a,n,t)}),n.querySelector("#cnlBtn").addEventListener("click",function(){t.querySelector(".sPCmtMenu").style.display="block",t.querySelector("#sPCmtCardHldr").style.display="block",n.remove()});var m=o(this.sheetID,this.range),v=n.querySelector("#editableContent");t.querySelector("#rng").innerText=m,v.innerHTML=i,v.focus()},addReply:function(e,t,s,n,o,r,l,c,a,m,h){var d=new i(this.commentDiv,e,t,s,n,o,r,l,c,a,m,h);this.replies[t]=d},removeCommentMenu:function(){var e=E.SUBMENUITEM+I.COMMENTS+E.IDENTITY,t="active"==this.state?e+"_activeCmtMenu":e+"_resolvedCmtMenu";void 0!=this.commentDiv.querySelector("#"+t)&&this.commentDiv.querySelector("#"+t).remove()},print:function(){N.print(this.commentDiv)},highlight:function(e){{var t=S.view.getActiveGridID(),i=S.view.getResourceID(t),s=S.view.getVersionID(t),n=S.data.getWorkBook(i,s),o=S.view.getSheetID(t),r=this.sheetID;n.highlightComments}if(o===r){var l=this.range;N.highlightEvent(i,r,s,l,this.commentID,e?P.UserAction.REVIEW_COMMENTS.PLACE_HIGHLIGHT:P.UserAction.REVIEW_COMMENTS.REMOVE_HIGHLIGHT)}},highlightComment:function(){this.commentDiv.classList.add("sPCurCard")},removeHighlightComment:function(){this.commentDiv.classList.remove("sPCurCard")},scrollIntoPanelView:function(){this.commentDiv.scrollIntoView(!1)},bindShowLikedList:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=this.likes;e.setAttribute("data-content","#sPLikeList"),e.setAttribute("data-is-content-html-encoded",!0),e.setAttribute("data-class-name","shRenameAni"),e.addEventListener("click",function(){p(t)});var i={title:L["Discussion.LikeListTitle"]};_.zpopover(e),_.zpopover(e,"setAttributes",i)}},i.prototype={commentDiv:null,commentHldrDiv:null,profileDiv:null,contentDiv:null,dateDiv:null,replyDiv:null,constructReply:function(){this.createCommentTemplate(),this.createProfileTemplate(),this.createContentTemplate(),this.createDateTemplate()},createCommentTemplate:function(){this.commentDiv=D.createElement("div"),this.commentDiv.id="sPRepCard_"+this.commentID,this.commentDiv.className=this.unRead&&this.ownerID!=w.zuid?"wid wid100 p10 sPCmtUnread":"wid wid100 p10",this.commentDiv.addEventListener("click",function(){this.classList.remove("sPCmtUnread")}),this.commentDiv.style="border-bottom: 1px dashed #dfdfdf",this.newReply?this.parent.querySelector("#sPRepCardHldr").appendChild(this.commentDiv):this.parent.querySelector("#sPRepCardHldr").prepend(this.commentDiv),this.commentHldrDiv=this.parent.querySelector("#sPRepCardHldr")},createProfileTemplate:function(){var e=UserAction.getTemplate(["SP_REPLIES_PROFILE"]).SP_REPLIES_PROFILE;this.commentDiv.appendChild(e),this.profileDiv=this.commentDiv.querySelector("#sPCmtPrf"),this.setPhoto(),this.setName();var t=this,i=this.commentDiv;this.ownerID!=w.zuid&&w.Permission.isSharable?this.commentDiv.querySelector("#sPRpEdit")&&this.commentDiv.querySelector("#sPRpEdit").remove():this.ownerID!=w.zuid&&(this.commentDiv.querySelector("#sPRpEdit")&&this.commentDiv.querySelector("#sPRpEdit").remove(),this.commentDiv.querySelector("#sPRpDlt")&&this.commentDiv.querySelector("#sPRpDlt").remove()),this.commentDiv.querySelector("#sPRpEdit")&&this.commentDiv.querySelector("#sPRpEdit").addEventListener("click",function(e){i.querySelector("#sPRplyCmtEdit").style.display="none",t.edit(),e.stopPropagation()}),this.commentDiv.querySelector("#sPRpDlt")&&this.commentDiv.querySelector("#sPRpDlt").addEventListener("click",function(e){t.remove(),e.stopPropagation()})},createContentTemplate:function(){var e=UserAction.getTemplate(["SP_REPLY_CONTENT"]).SP_REPLY_CONTENT;this.commentDiv.appendChild(e),this.contentDiv=this.commentDiv.querySelector("#content"),this.setContent()},createDateTemplate:function(){var e=UserAction.getTemplate(["SP_REPLY_DATE"]).SP_REPLY_DATE;this.commentDiv.appendChild(e),this.dateDiv=this.commentDiv.querySelector("#sPCmtDate"),this.setTime(),this.setLikes()},setLikes:function(){var t=this.commentDiv.querySelector("#splike");if(1==this.type||2==this.type)return void(t&&t.remove());var i=this.likes;this.likeCount=i.length,this.updateLikeCnt();for(var s=0;s<this.likeCount;s++){{var n=i[s][C.USER_ID];i[s][C.USER_NAME]}n==w.zuid&&(this.liked=!0)}this.updateLikeCntTitle(),this.liked&&this.updateLikeElStyle(this.liked),this.updateLikeTitle(this.liked);var o=this.commentID,r=this.parentID;t.addEventListener("click",function(t){var i=S.view.getActiveGridID(),s=S.view.getResourceID(i),n=S.view.getSheetID(i),l=S.view.getVersionID(i),c=S.data.getWorkBook(s,l),a=(c.getSheetObj(n),w.loginName,S.view.getSelectedSheets(i)),m=S.view.getSheetID(i),h=S.view.getSheetState(i,m),d=h.getActiveRange();this.classList.contains("shLikeActive")?(e.UserAction.unlikeReviewCommentReply(s,l,a,r,o,d),this.classList.remove("shLikeActive")):(e.UserAction.likeReviewCommentReply(s,l,a,r,o,d),this.classList.add("shLikeActive")),t.stopPropagation()})},updateLikeTitle:function(e){var t=this.commentDiv.querySelector("#splike");t.title=e?L["Discussion.Liked"]:L["Discussion.Like"]},updateLikeCnt:function(){var e=this.commentDiv.querySelector("#likeCnt");this.likeCount>0?(e.innerText=this.likeCount,e.style.display=""):e.style.display="none"},updateLikeElStyle:function(e){var t=this.commentDiv.querySelector("#splike");e?t.classList.add("shLikeActive"):t.classList.remove("shLikeActive")},updateLikeCntTitle:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=[];switch(this.likeCount){case 0:e.title="";break;case 1:var i=this.liked?L["Discussion.You"]:this.likes[0][C.USER_NAME];e.title=JSUtil.fn.replaceParams(L["Discussion.LikedBy"],new Array(i));break;case 2:if(this.liked){var s=this.likes[0][C.USER_ID]==w.zuid?1:0;t.push(L["Discussion.You"],this.likes[s][C.USER_NAME])}else t.push(this.likes[0][C.USER_NAME],this.likes[1][C.USER_NAME]);e.title=JSUtil.fn.replaceParams(L["Discussion.LikedByAnd"],t);break;default:if(this.liked){var s=this.likes[0][C.USER_ID]==w.zuid?1:0;t.push(L["Discussion.You"],this.likes[s][C.USER_NAME],this.likeCount-2)}else t.push(this.likes[0][C.USER_NAME],this.likes[1][C.USER_NAME],this.likeCount-2);e.title=JSUtil.fn.replaceParams(L["Discussion.LikedByAndMore"],t)}},updateLikes:function(e){var t=e[C.USER_ID],i=e[C.USER_NAME],s=e[C.STATE];if(s){var n={};n[C.USER_ID]=t,n[C.USER_NAME]=i,this.likes.push(n)}else for(var o=0;o<this.likes.length;o++)if(this.likes[o][C.USER_ID]==t){this.likes.splice(o,1);break}t==w.zuid&&(this.liked=s,this.updateLikeElStyle(s),this.updateLikeTitle(s)),s?this.likeCount++:this.likeCount--,this.updateLikeCnt(),this.updateLikeCntTitle()},setContent:function(){if(this.content){var e=u(this.content,this.sheetName,this.iswms);this.contentDiv.innerHTML=e,this.iswms?this.contentDiv.classList.remove(this.contentClassName):JSUtil.RCMentionDataShim.checkEllipse(this.contentDiv,e,this.allowedHgt,this.contentClassName)}else this.contentDiv.classList.remove(this.contentClassName)},setPhoto:function(){this.profileDiv.querySelector("#sPCmtPhoto").src=q+"/file?fs=thumb&ID="+this.ownerID},setName:function(){var e=this.ownerName,t=D.createElement("span");1==this.type?(this.commentDiv.querySelector("#sPRplyCmtEdit").remove(),t.classList.add("sPCmtRslvd"),t.innerText=L["Discussion.MarkedAsResolved"]):2==this.type&&(this.commentDiv.querySelector("#sPRplyCmtEdit").remove(),t.classList.add("sPCmtROpen"),t.innerText=L["Discussion.Reopened"]),this.profileDiv.querySelector("#sPCmtUsrName").innerText=e,this.profileDiv.querySelector("#sPCmtUsrName").appendChild(t)},setTime:function(){var e=this.dateDiv;e.innerText=this.time,e.href=N.getLink(this.parentID,this.commentID,!0),e.addEventListener("click",function(){event.stopPropagation()})},updateContent:function(e,t){this.content=e,this.contentDiv.innerHTML=u(e,this.sheetName,!0),t==w.zuid&&this.commentDiv.querySelector("#commentsLoader")&&(this.commentDiv.querySelector("#sPCmtDateHlr").style.display="block",this.commentDiv.querySelector("#content").style.display="block",this.commentDiv.querySelector("#sPRplyCmtEdit").style.display="",this.commentDiv.querySelector("#sPCmtRply").remove(),this.commentDiv.querySelector("#commentsLoader").remove())},remove:function(){var t=UserAction.getTemplate(["SP_DELETE"]).SP_DELETE;this.commentDiv.appendChild(t);var i=this.commentDiv.querySelector("#dltDiv"),s=this.commentDiv.querySelector("#cnlBtn"),n=this.commentDiv.querySelector("#dltBtn"),o=this.commentDiv,r=this.commentID,l=this.parentID;N.dltDivStack.push({del:i}),n.addEventListener("click",function(){var t=S.view.getActiveGridID(),i=S.view.getResourceID(t),s=S.view.getSheetID(t),n=S.view.getVersionID(t),c=S.data.getWorkBook(i,n),a=(c.getSheetObj(s),w.loginName,S.view.getSelectedSheets(t)),m=S.view.getSheetID(t),h=S.view.getSheetState(t,m),d=h.getActiveRange();e.UserAction.deleteReviewCommentReply(i,n,a,l,r,d),o.remove()}),s.addEventListener("click",function(){i.remove()})},edit:function(){var e=this.commentDiv;e.querySelector("#sPCmtDateHlr").style.display="none",e.querySelector("#content").style.display="none";var t=JSUtil.RCMentionDataShim.convertRichTextContent(this.content);this.parent.querySelector("#cnlBtn")&&this.parent.querySelector("#cnlBtn").click(),this.parent.querySelector("#cancelBtn")&&this.parent.querySelector("#cancelBtn").click();var i=UserAction.getTemplate(["SP_EDIT_REPLY"]).SP_EDIT_REPLY;e.appendChild(i);var s=e.querySelector("#sPCmtRply"),n=s.querySelector("#editableContent"),o=s.querySelector("#submitBtn"),r=this.commentID,l=this.parentID,a=s.querySelector(".sPCmtSmiley");a.setAttribute("data-content","#smileySuggestions"),a.setAttribute("data-is-content-html-encoded",!0),a.setAttribute("data-class-name","shRenameAni"),a.addEventListener("click",function(){N.divToAddSmiley=s}),_.zpopover(a),JSUtil.RCMentionDataShim.connectProcessMention(n),n.addEventListener("keydown",function(t){c(t,s,l,r,e,this)}),n.addEventListener("keyup",function(){N.commentContentValidation(n,o)}),o.disabled=!0,o.addEventListener("click",function(){m(s,l,r,e)}),s.querySelector("#cnlBtn").addEventListener("click",function(){e.querySelector("#sPRplyCmtEdit").style.display="",e.querySelector("#sPCmtDateHlr").style.display="block",e.querySelector("#content").style.display="block",s.remove()});var h=s.querySelector("#editableContent");h.innerHTML=t,h.focus()},delete:function(){},constructNotification:function(){this.unRead&&this.ownerID!=w.zuid&&(N.Notifier[this.commentID]=new s(this.commentDiv,this.parentID,this.commentID,this.content,this.ownerID,this.ownerName,this.time,this.type))},bindShowLikedList:function(){var e=this.commentDiv.querySelector("#likeCnt"),t=this.likes;e.setAttribute("data-content","#sPLikeList"),e.setAttribute("data-is-content-html-encoded",!0),e.setAttribute("data-class-name","shRenameAni"),e.addEventListener("click",function(){p(t)});var i={title:L["Discussion.LikeListTitle"]};_.zpopover(e),_.zpopover(e,"setAttributes",i)}},s.prototype={notifyDiv:null,construct:function(){this.constructNotifiyTemplate(),this.setTime(),this.setContent(),this.setName(),this.setPhoto()},constructNotifiyTemplate:function(){var e=this.parentID,t=this.getNotifyTemplate(),i=this.getParent();i.appendChild(t);var s=this.notifyDiv=i.querySelector("#sPCmtNtyCard");s.id="sPCmtNtyCard_"+this.commentID,this.notifyDiv.addEventListener("click",function(){N.goToComment(),N.Comment.Thread[e].scrollIntoPanelView()})},getNotifyTemplate:function(){var e=null;switch(this.type){case M:e=UserAction.getTemplate(["SP_COMMENT_NOTIFICATION"]).SP_COMMENT_NOTIFICATION;break;case U:e=UserAction.getTemplate(["SP_REPLIED_COMMENT_NOTIFICATION"]).SP_REPLIED_COMMENT_NOTIFICATION;break;case b:e=UserAction.getTemplate(["SP_RESOLVE_COMMENT_NOTIFICATION"]).SP_RESOLVE_COMMENT_NOTIFICATION;break;case O:e=UserAction.getTemplate(["SP_REOPEN_COMMENT_NOTIFICATION"]).SP_REOPEN_COMMENT_NOTIFICATION}return e},setName:function(){this.notifyDiv.querySelector("#sPCmtUsrName").innerText=this.ownerName},setPhoto:function(){this.notifyDiv.querySelector("#sPCmtPhoto").src=q+"/file?fs=thumb&ID="+this.ownerID},setTime:function(){this.notifyDiv.querySelector("#sPCmtDate").innerText=this.time},setContent:function(){if(this.content){var e=u(this.content);this.notifyDiv.querySelector("#content").innerHTML=e,JSUtil.RCMentionDataShim.checkEllipse(this.notifyDiv.querySelector("#content"),e,this.allowedHgt,this.contentClassName,this.isNotification)}},getParent:function(){return D.querySelector("#sPCmtNtfyHldr")}},N.getLink=v,e.ZSClass.UIComment=t}(this);
!function(e){function t(t,r,i,o,a,s,c,C,d,E){var m=A.view.getActiveGridID(),S=A.view.getResourceID(m),I=(A.view.getSheetID(m),A.view.getVersionID(m)),l=A.data.getWorkBook(S,I),D=r?[l.SheetList.getIdByName(r[0])]:n(l.SheetList.getAllSheetNames());e.UserAction.fetchReviewComments(S,I,D,i,{sr:s,sc:c,er:C,ec:d},t,u,o,a,E)}function n(e){for(var t=[],n=A.view.getActiveGridID(),r=A.view.getResourceID(n),i=(A.view.getSheetID(n),A.view.getVersionID(n)),o=A.data.getWorkBook(r,i),a=0;a<e.length;a++)t.push(o.SheetList.getIdByName(e[a]));return t}function r(){var e=d();if(!e.querySelector("#addCmtCard")){g(),G.goToComment();var t=A.view.getActiveGridID(),n=A.view.getResourceID(t),r=A.view.getSheetID(t),o=A.view.getVersionID(t),a=A.data.getWorkBook(n,o),s=a.getSheetObj(r),c=s.Prop.getName(),C=sPlusPlus.data.UserInfo.loginName,E=A.view.getSelectedSheets(t),m=A.view.getSheetState(t,r),S=m.getActiveRange();i(n,o,E,C,v(c,S))}}function i(e,t,n,r,i){var o=d(),a=UserAction.getTemplate(["SP_ADD_COMMENT"]).SP_ADD_COMMENT;o.prepend(a);var C=o.querySelector("#addCmtCard");C.querySelector("#sPCmtUsrName").innerText=r;var E=C.querySelector("#submitBtn"),m=C.querySelector(".sPCmtSmiley");m.setAttribute("data-content","#smileySuggestions"),m.setAttribute("data-is-content-html-encoded",!0),m.setAttribute("data-class-name","shRenameAni"),m.addEventListener("click",function(){G.divToAddSmiley=C}),b.zpopover(m),C.querySelector("#sPCmtPhoto").src=V+"/file?fs=thumb&ID="+A.data.UserInfo.zuid;var S=new k(C.querySelector("#rng"),!0);U.RangePicker.register(S,!0,!1),S.value=i;var I=o.querySelector("#editableContent");I.addEventListener("keydown",function(r){s(r,e,t,n,S,I,C)}),I.addEventListener("keyup",function(){G.commentContentValidation(I,E)}),I.addEventListener("input",function(){I.textContent&&I.classList.remove("sPPlaceHolder")}),E.disabled=!0,E.addEventListener("click",function(){c(e,t,n,S,I,C)}),C.querySelector("#cnlBtn").addEventListener("click",function(){o.querySelector("#addCmtCard").remove(),R()}),C.querySelector("#editableContent").focus(),JSUtil.RCMentionDataShim.connectProcessMention(C.querySelector("#editableContent"))}function o(e,t){t.disabled=G.validateContent(e)?!1:!0}function a(e){var t=JSUtil.RCMentionDataShim.getActualContent(e);return t.trim().length>0}function s(e,t,n,r,i,o,a){var s=e.keyCode||e.which;27==s&&a.remove(),G.validateContent(o)&&(e.metaKey||e.ctrlKey)&&13==s&&c(t,n,r,i,o,a)}function c(t,n,r,i,o,a){var s=L.getElementById("commentsLoader").cloneNode(!0);a.appendChild(s);var c=A.view.getActiveGridID(),r=A.view.getSelectedSheets(c),C=JSUtil.Range.parseRange(t,n,i.value).range,d=JSUtil.RCMentionDataShim.getRichTextContent(o);e.UserAction.addReviewComment(t,n,r,d,C)}function C(){d()&&d().querySelector("#addCmtCard")&&d().querySelector("#addCmtCard").remove()}function d(){return L.querySelector("#sPCmtHolder")}function E(){G.clearHighlights(),G.Comment.Thread=[]}function m(t,n,r){var i=A.view.getActiveGridID(),o=A.view.getResourceID(i),a=A.view.getSheetID(i),s=A.view.getVersionID(i),c=A.data.getWorkBook(o,s),C=(c.getSheetObj(a),sPlusPlus.data.UserInfo.loginName,A.view.getSelectedSheets(i)),d=new U.Range(r.sr,r.sc,r.er,r.ec);e.UserAction.addReviewCommentReply(o,s,C,n,t,d)}function S(e,t,n,r,i,o){switch(e.length<1?R():g(),r){case P.MODIFY:var a=e[0].content,s=e[0].range,c=e[0].sheetID,C=e[0].ownerID;e[0].parentID?G.Comment.Thread[e[0].parentID].replies[e[0].commentID].updateContent(a,C):(G.Comment.Thread[e[0].commentID].updateContent(a,C),G.Comment.Thread[e[0].commentID].updateRange(c,s));break;case P.RESOLVE:G.Comment.Thread[e[0].commentID].setState("resolved");break;case P.REOPEN:G.Comment.Thread[e[0].commentID].setState("active");break;case P.DISCUSSION:t&&t(e,n,i);break;case P.ADD:t&&t(e,n,null,!0);break;case P.ADD_REPLY:if(o){var d={commentID:o,parentID:e[0].parentID,ownerID:e[0].ownerID,ownerName:e[0].ownerName,time:e[0].time,content:void 0,likes:[],unRead:!0,type:2};u([d],!0,null,!0),G.Comment.Thread[e[0].parentID].setState(2)}t&&t(e,n,null,!0);break;case K:G.Comment.Thread[e[0].commentID].viewReplies(e);break;case B:G.highlightAllComments(e);break;case q:G.showNotificationPanel();break;case"INIT_NOTIFICATION":G.NotificationCnt=i.unReadCount,G.updateNotificationCount(i.unReadCount);break;case"HIGHLIGHT_MY_COMMENTS":G.highlightMyRangeComments(e)}}function I(e,t){var n=A.data.UserInfo.zuid;t==n||e!=P.ADD&&e!=P.ADD_REPLY||G.updateNotificationCount(G.NotificationCnt+1)}function l(e,n,r,i,o,a,s,c){if(I(r,a),d()&&G.initialLoad)switch(t("active",void 0,i,!0,r,void 0,void 0,void 0,void 0,c),r){case P.ADD:C();break;case P.ADD_REPLY:G.Comment.Thread[o].updateRepliesOptionOnAdd(),s&&G.Comment.Thread[o].setState(s);break;case P.DELETE:G.triggerFilter();break;case P.DELETE_REPLY:G.Comment.Thread[o].updateRepliesOptionOnDelete();break;case P.RESOLVE:}}function D(e,t,n,r,i,o){if(d())switch(n){case P.DISCUSSION_LIKE:G.Comment.Thread[r].updateLikes(o);break;case P.DISCUSSION_UNLIKE:G.Comment.Thread[r].updateLikes(o);break;case P.DISCUSSION_LIKE_REPLY:G.Comment.Thread[r].replies[i].updateLikes(o);break;case P.DISCUSSION_UNLIKE_REPLY:G.Comment.Thread[r].replies[i].updateLikes(o)}}function u(t,n,r,i){if(T(!1),d()){var o=A.view.getActiveGridID(),a=A.view.getResourceID(o),s=(A.view.getSheetID(o),A.view.getVersionID(o)),c=A.view.State[o],C=c[a][s],E=A.data.getWorkBook(a,s);if(0==t.length)return void R();var m=0;!E.highlightComments&&G.hideHighlightComment(),G.currentThread=t[0].commentID;for(var S=0;S<t.length;S++){var I=t[S].commentID;if(void 0==t[S].parentID){m=r&&r.replyCount[I];var l=new e.ZSClass.UIComment(t[S].parentID,I,t[S].content,t[S].likes,t[S].ownerID,t[S].ownerName,t[S].range,t[S].sheetID,t[S].state,t[S].time,t[S].type,t[S].unRead,n,m,i);G.Comment.Thread[I]=l,C.setCommentState(I,new U.CommentState(I))}else G.Comment.Thread[t[S].parentID].addReply(t[S].parentID,I,t[S].content,t[S].likes,t[S].ownerID,t[S].ownerName,t[S].time,t[S].type,t[S].unRead,!0,i)}n&&t[0].range&&G.Comment.Thread[t[0].commentID].highlight(!0)}}function R(){if(!(G.displayCnt>0||d()&&void 0!=d().querySelector("#addCmtCard"))){g();var e=L.querySelector("#comments"),t=UserAction.getTemplate(["SP_NO_COMMENT"]).SP_NO_COMMENT;e&&e.prepend(t),e&&e.querySelector("#addCmtLnk").addEventListener("click",function(){g(),r()})}}function g(){var e,t=L.querySelector("#comments");t&&(e=t.querySelector("#sPNoCmt")),e&&e.remove()}function T(e){L.querySelector("#comments")&&(L.querySelector("#comments").querySelector("#ZsLoader").style.display=e?"":"none")}function N(e,t){switch(t){case y.DISCUSSION_UPDATE_RANGE_CONTENT:G.Comment.Thread[e].edit(e);break;case y.DISCUSSION_RESOLVE:G.Comment.Thread[e].resolve(e);break;case y.DISCUSSION_REOPEN:G.Comment.Thread[e].reopen(e);break;case y.DISCUSSION_DELETE:G.Comment.Thread[e].remove(e);break;case W:G.Comment.Thread[e].print(e)}}function v(e,t){var n=e+"."+JSUtil.Cell.getReference(t.startRow,t.startCol);return(t.startRow!=t.endRow||t.startCol!=t.endCol)&&(n=n+":"+JSUtil.Cell.getReference(t.endRow,t.endCol)),n}function h(e){var t=A.view.getActiveGridID(),n=A.view.getResourceID(t),r=(A.view.getSheetID(t),A.view.getVersionID(t)),i=A.data.getWorkBook(n,r);if(G.currentThread&&(e||!i.highlightComments)){var o=G.Comment.Thread[G.currentThread];if(!o)return;o.highlight(!1),G.currentThread=void 0}}function O(e){h(),G.currentThread=e}var A=e.sPlusPlus,L=e.document,M=e.ZSConstants.FeatureConstants,U=(e.ZSConstants.wCC,e.ZSClass),_=e.ZSEvents,f=_.topic,p=_.Groups,w=_.Names,k=U.Editors.RangeEditor,y=(U.Editors.TextAreaEditor,U.Editors.Utility,U.Range,e.ZSConstants.ActionConstants),P=e.ZSConstants.CommandConstants,V=(e.ZSConstants.JSKeyCode,A.data.AppRegistry.USER_PHOTO_SERVER_URL),b=e.UIUtil.Component,W=(A.data.Defaults.MAX_COL,A.data.Defaults.MAX_ROW,0),q=2,G=A.view.Toolbar.Feature[M.COMMENTS];G.getSheetListByName=n,G.commentContentValidation=o,G.validateContent=a,G.Comment={Thread:[],Notification:[]},G.init=E;var K=0,B=3;G.togglePanelLoader=T,G.addNoCommentTemplate=R,G.hideHighlightComment=h,f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.TRIGGER_ADD,r,"response"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.TRIGGER_REPLY,m,"content","commentID","range"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.EXECUTE_ACTION,N,"uid","action"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.FETCH,t,"status","sheets","disId","newComment","action","SR","SC","ER","EC"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.LOAD,S,"response","callback","newComment","action","COUNTOBJ","REOPENID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.ADD_SUCCESS,l,"RID","VERSION","ACTION","COMMENTID","PARENTID","OWNERID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.UPDATE_SUCCESS,l,"RID","VERSION","ACTION","COMMENTID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.DELETE_SUCCESS,l,"RID","VERSION","ACTION","COMMENTID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.RESOLVE_SUCCESS,l,"RID","VERSION","ACTION","COMMENTID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.ADD_REPLY_SUCCESS,l,"RID","VERSION","ACTION","COMMENTID","PARENTID","OWNERID","STATE","R_ID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.DELETE_REPLY_SUCCESS,l,"RID","VERSION","ACTION","COMMENTID","PARENTID"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.LIKE_SUCCESS,D,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.UNLIKE_SUCCESS,D,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.LIKE_REPLY_SUCCESS,D,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.UNLIKE_REPLY_SUCCESS,D,"RID","VERSION","ACTION","PARENTID","COMMENTID","LIKES"),f.register(p.Listener,w.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,O,"commentID"),f.register(p.Selector.DomUpdate.Cell,w.Selection.BOUND_UPDATE.ADD,h)}(this);
!function(e){function t(e){var t=S.view.getActiveGridID(),i=S.view.getResourceID(t),r=(S.view.getSheetID(t),S.view.getVersionID(t)),o=S.view.State[t],s=o[i][r];s.setActive(s.getCommentState(e)),A.register(f.Selector.BoundUpdate.Range,w.Selection.BOUND_UPDATE.ADD,n,"SHEETID")}function n(e){var t=S.view.getActiveGridID(),i=S.view.getActiveState(t);i.setActive(i.getSheetState(e)),A.unregister(f.Selector.BoundUpdate.Range,w.Selection.BOUND_UPDATE.ADD,n)}function i(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),n=(S.view.getSheetID(e),S.view.getVersionID(e)),i=S.data.getWorkBook(t,n),r=i.highlightComments;i.highlightComments=r?!1:!0,g(),r?(N.zmenu("#"+T.SUBMENUITEM+D.COMMENTS+T.IDENTITY,"setAttribute","contentType","text"),N.zmenu("#commentPanelMenu","setAttribute","contentType","text")):(N.zmenu("#"+T.SUBMENUITEM+D.COMMENTS+T.IDENTITY,"setAttribute","contentType","icon-text"),N.zmenu("#commentPanelMenu","setAttribute","contentType","icon-text"))}function r(e){if(0!=e.length)for(var t=S.view.getActiveGridID(),n=S.view.getResourceID(t),i=S.view.getVersionID(t),r=S.data.getWorkBook(n,i),o=r.highlightComments,s=S.view.getSheetID(t),a=0;a<e.length;a++)void 0==e[a].parentID&&p.highlightEvent(n,s,i,e[a].range,e[a].commentID,o?w.UserAction.REVIEW_COMMENTS.PLACE_HIGHLIGHT:w.UserAction.REVIEW_COMMENTS.REMOVE_HIGHLIGHT)}function o(e){var t=[];for(var n in e)void 0==e[n].parentID&&t.push(e[n].commentID);p.updatePanelHighlights(t);var i=t.length;if(i>0&&p.Comment.Thread[t[0]].scrollIntoPanelView(),i>1){var r=new d.TBNotification(JSUtil.fn.replaceParams(M["Discussion.Highlighted"],new Array(i+"")),{type:"info",parent:C.querySelector("#sPCmtTop")});r.show()}}function s(e){var t="all"==p.currentSheetFilter?void 0:[p.currentSheetFilter];p.Comment.Thread&&Object.keys(p.Comment.Thread).length>0&&a(e[0],t)}function a(e,t){A.publish(f.Listener,w.UserAction.REVIEW_COMMENTS.FETCH,{status:p.currentFilter,sheets:t,disId:void 0,newComment:!1,action:"HIGHLIGHT_MY_COMMENTS",SR:e.startRow,SC:e.startCol,ER:e.endRow,EC:e.endCol})}function g(){var e=S.view.getActiveGridID(),t=S.view.getResourceID(e),n=S.view.getVersionID(e),i=S.data.getWorkBook(t,n),r=S.view.getSheetID(e),o=i.getSheetObj(r),s=o.Prop.getName();A.publish(f.Listener,w.UserAction.REVIEW_COMMENTS.FETCH,{status:p.currentFilter,sheets:[s],disId:void 0,newComment:!1,action:H,SR:0,SC:0,ER:S.data.Defaults.MAX_ROW-1,EC:S.data.Defaults.MAX_COL-1})}function c(e,t,n){var i=S.data.getWorkBook(e,n),r=i.highlightComments;if(r){var o=[],s=p.Comment.Thread;for(var a in s)void 0===s[a].parentID&&o.push(s[a].commentID);if(0!=o.length)for(var g=0;g<o.length;g++)p.Comment.Thread[o[g]].highlight(r)}}function h(e){m();for(var t=0;t<e.length;t++){var n=e[t];p.Comment.Thread[n].highlightComment(),p.currentCards.push(n)}}function l(e,t,n,i,r,o){var s=new d.Range(i.sr,i.sc,i.er,i.ec);A.publish(f.Listener,o,{RID:e,SHEETID:t,VERSION:n,RANGE:s,RANGEID:r})}function m(){for(var e=(p.Comment.Thread,0);e<p.currentCards.length;e++)p.Comment.Thread[p.currentCards[e]].removeHighlightComment();p.currentCards=[]}function u(e,t,n){var i=S.view.getActiveGridID(),r=S.view.getResourceID(i),o=S.view.getVersionID(i),s=(S.data.getWorkBook(r,o),S.view.getSheetID(i));if(s!=t){var a=new d.Range(e.sr,e.sc,e.er,e.ec);O(r,s,o,a,t,n)}else I(r,t,o,e,n)}function I(e,t,n,i,r){new d.Range(i.sr,i.sc,i.er,i.ec);UserAction.ScrollCellIntoView(e,t,n,i.sr,i.sc),A.publish(f.Listener,w.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,{commentID:r}),p.Comment.Thread[r].highlight(!0)}function E(e,t,n,i,r,o){UserAction.SwitchSheet(e,t,n,r,i,!1,function(){I(e,r,n,i,o)})}function v(e,t,n){var i=S.data.getWorkBook(e,n),r=i.getSheetObj(t),o=r.Prop.getName();(p.currentSheetFilter==p.FilterValues.all||p.currentSheetFilter==o)&&p.getDisplayComment()}var S=e.sPlusPlus,C=e.document,D=e.ZSConstants.FeatureConstants,T=e.ZSConstants.wCC,d=e.ZSClass,R=e.ZSEvents,A=R.topic,f=R.Groups,w=R.Names,M=e.ZSConstants.I18N,N=e.UIUtil.Component,p=(ZSConstants.CommandConstants,S.view.Toolbar.Feature[D.COMMENTS]),H=3,U=JSUtil.fn.debounce(function(e,t,n,i,r){s(r)},200),O=JSUtil.fn.debounce(function(e,t,n,i,r,o){E(e,t,n,i,r,o)},500);p.updatePanelHighlights=h,p.highlightEvent=l,p.getDisplayComment=g,p.highlightAllComments=r,p.highlightMyRangeComments=o,p.triggerHighlightAllComments=i,p.clearHighlights=m,p.triggerHighlight=u,A.register(f.Listener,w.SheetAction.HIGHLIGHT_COMMENTS.REPAINT,v,"RID","SHEETID","VERSION"),A.register(f.Listener,w.SheetAction.ZOOM.On,c,"RID","SHEETID","VERSION"),A.register(f.Listener,w.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,t,"commentID"),A.register(f.Selector.DomUpdate.Range,w.Selection.BOUND_UPDATE.ADD,U,"RID","SHEETID","VERSION","ActiveRange","RANGES","RANGEID","TYPE","isSingleCell")}(this);
!function(e){function t(e){S=D.createElement("ul"),S.id="reviewCommentFilterMenu",S.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),S.setAttribute("ctype","zmenu"),r(),e.appendChild(S),y.bind(S,"zmenubeforeshow",function(){i(S)})}function r(){for(var e in V){var t=D.createElement("li");t.id=e,t.setAttribute("data",'{"label":"'+V[e]+'"}'),t.addEventListener("click",function(){P.currentFilter=this.id,P.triggerFilter()}),S.appendChild(t)}}function i(e){var t=e.id,r={active:E["Discussion.PanelHeader.Active"]+"  ("+L.active+")",resolved:E["Discussion.PanelHeader.Resolved"]+"  ("+L.resolved+")",all:E["Discussion.PanelHeader.All"]+"  ("+L.all+")"};for(var i in V)y.zmenu("#"+t,"setMenuItemsAttribute",["#"+i],"label",r[i])}function l(e){var t=V[e],r=L[e]?L[e]:0,i=D.querySelector("#cmtStatusFilter");i&&(i.querySelector("#stFilterLbl").innerText=t);var l="("+r+")",a=parseInt(r)>0?l:"";i&&(i.querySelector("#stFilterCount").innerText=a),P.displayCnt=r,P.addNoCommentTemplate()}function a(e){var t=D.querySelector("#cmtSheetFilter");t.addEventListener("click",function(){n(e)})}function n(e){D.querySelector("#sheetFilterMenu")&&D.querySelector("#sheetFilterMenu").remove(),h=D.createElement("ul"),h.id="sheetFilterMenu",h.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),h.setAttribute("ctype","zmenu"),s(),e.appendChild(h),y.bind(h,"zmenuitemclick",function(e,t){var r=g.view.getActiveGridID(),i=g.view.getResourceID(r),l=g.view.getVersionID(r),a=g.data.getWorkBook(i,l),n=t.menuitem[0].dataset.itemValue;P.currentSheetFilter=n!=P.FilterValues.all?a.getSheetObj(n).Prop.getName():n,v()})}function s(){var e=g.view.getActiveGridID(),t=g.view.getResourceID(e),r=g.view.getVersionID(e),i=g.data.getWorkBook(t,r),l=i.SheetList.getSheets(),a=D.createElement("li");a.setAttribute("data",'{"label":"'+E["Discussion.AllSheet"]+o(F.all)+'"}'),a.setAttribute("data-item-value",P.FilterValues.all),h.appendChild(a);for(var n=0;n<l.length;n++){var s=D.createElement("li");s.setAttribute("data",'{"label": "'+l[n].Name+o(F[l[n].Name])+'"}'),s.setAttribute("data-item-value",l[n].Id),h.appendChild(s)}}function o(e){return e>0?"  ("+e+")":""}function u(e){var t=g.view.getActiveGridID(),r=g.view.getResourceID(t),i=g.view.getVersionID(t),l=g.data.getWorkBook(r,i),a=F[e]?F[e]:0,n=D.querySelector("#cmtSheetFilter"),s="all"==e?E["Discussion.AllSheet"]:e;n&&(n.querySelector("#shtFilterLbl").innerText=s);var o="("+a+")";n&&(n.querySelector("#shtFilterCnt").innerText=o),N=e!=P.FilterValues.all?l.SheetList.getIdByName(e):!1,P.displayCnt=a}function c(){F={all:0}}function v(){var e=P.currentFilter,t=P.currentSheetFilter;l(e),u(t),P.ClearPanel(),"all"==t?P.loadComments(e):P.loadComments(e,[t])}function d(e){var t=0,r=0,i=0;c(),e.unReadCount>0&&!P.initialLoad&&(P.currentFilter=P.FilterValues.all);var a=g.view.getActiveGridID(),n=g.view.getResourceID(a),s=g.view.getVersionID(a),o=g.data.getWorkBook(n,s),v=P.getSheetListByName(o.SheetList.getAllSheetNames()),d=P.currentFilter;if("all"==P.currentSheetFilter){for(var m in e.active)t+=e.active[m]?e.active[m]:0;for(var S in e.resolved)r+=e.resolved[S]?e.resolved[S]:0}else{var h=o.SheetList.getIdByName(P.currentSheetFilter);t=e.active[h]?e.active[h]:0,r=e.resolved[h]?e.resolved[h]:0}for(var p=0,m=0;m<v.length;m++){var b=0;d==P.FilterValues.all?(e.active&&!!e.active[v[m]]&&(b+=e.active[v[m]]),e.resolved&&!!e.resolved[v[m]]&&(b+=e.resolved[v[m]])):e[d]&&!!e[d][v[m]]&&(b+=e[d][v[m]]);var f=o.getSheetObj(v[m]),A=f.Prop.getName();F[A]=b,p+=b}switch(F.all=p,d){case P.FilterValues.all:i=t+r;break;case P.FilterValues.resolved:i=r;break;case P.FilterValues.active:i=t}L.active=t,L.resolved=r,L.all=t+r,F[P.currentSheetFilter]=i,l(d),u(P.currentSheetFilter)}function m(e,t,r){r[0][0]==N&&D.querySelector("#shtFilterLbl")&&(D.querySelector("#shtFilterLbl").innerText=r[0][1])}var S,F,h,g=e.sPlusPlus,p=e.ZSEvents,b=p.topic,f=p.Groups,A=p.Names,C=(e.UserAction,e.ZSClass),C=(g.view.measures,C.KeyMapping,e.ZSClass),D=(C.SidePanel,e.document),y=e.UIUtil.Component,I=e.ZSConstants,w=I.FeatureConstants,E=I.I18N,N=!1,V={active:E["Discussion.PanelHeader.Active"],resolved:E["Discussion.PanelHeader.Resolved"],all:E["Discussion.PanelHeader.All"]},L={active:0,resolved:0,all:0},P=g.view.Toolbar.Feature[w.COMMENTS];P.currentFilter="active",P.currentSheetFilter="all",P.FilterValues={all:"all",resolved:"resolved",active:"active"},P.createFilterMenuLayout=t,P.initSheetFilter=a,P.updateFilterDOM=l,P.updateSheetFilterDOM=u,P.resetSheetFilterCount=c,P.triggerFilter=v,b.register(f.UI,A.SidePanel.Comments.UPDATE_COUNT,d,"COUNTOBJ"),b.register(f.Listener,A.DocAction.WORKSHEETS.RENAME,m,"RID","VERSION","RENAME")}(this);
!function(s){{var t=s.sPlusPlus,e=s.ZSConstants,a=e.FeatureConstants,n=(s.document,e.I18N,e.wCC,s.ZSClass,s.ZSEvents);n.Groups,n.Names,n.topic,t.view.Toolbar.Feature[a.COLLAB_CHAT]}}(this);
!function(e){function t(t,l){if(m.isPanelOpen||m.addPanelNotification(),!p){document.querySelector("#ZspNoChat")&&document.querySelector("#ZspNoChat").remove();var n=S.zuid==l?!0:!1,u=n?h.CollbChatMe:r(l),i=t.t,c=o(i),s=t.msg,d="red",C=a(i),f=new e.ZSClass.Chat(l,u,c,s,d,n,F,i,C,!0);f.setScroll(!0)}}function l(t){var l=t.userList,a=t.chatDetails,r=null,u=0;if(p&&0==a.length&&(document.querySelector("#ZspNoChat").style.display=""),0==a.length)return document.querySelector("#chatInfo").style.display="none",void(p=!1);document.querySelector("#colbChatLoader").style.display="none";for(var i=0;i<a.length;i++)for(var c,s=a[i].CHAT_CONTENT.length-1;s>=0;s--){var d=a[i].CHAT_CONTENT[s],C=d.msg,f=C.split("<br>"),g=d.uid,m=S.zuid==g?!0:!1,v=m?h.CollbChatMe:l[g],L="red";c=d.t;for(var D=o(c),A=n(c),F=f.length-1;F>=0;F--,u++){var C=f[F];r=new e.ZSClass.Chat(g,v,D,C,L,m,y,c,A,!1),A=!1}}if(50>u){var U=document.querySelector(".colbChatPanel").querySelector("#colbChatLoader");U.remove();var b=JSUtil.fn.dateLocaleFormat(c,null,null,null,!0),w=JSUtil.fn.replaceParams(h.CollabChatCoversionInfo,new Array(b)),T=document.querySelector("#dayBlock").cloneNode(!0);document.querySelector("#chatInfo").style.display="none",T.id=c,T.style.display="block",T.innerHTML=w,document.querySelector(".colbChatHistory").prepend(T)}if(p){var U=document.querySelector(".colbChatPanel").querySelector("#initChatLoader");U.remove(),p=!1,r.setScroll(!0)}}function n(e){L=e;var t=!1;return null==y?(y=JSUtil.fn.dateLocaleFormat(e,null,null,null,null,!0),v=new Date(e),A=e,D=e,U=v):u(v,e)||(t=!0,y=JSUtil.fn.dateLocaleFormat(A,null,null,null,null,!0),A=e,v=new Date(e)),t}function a(e){var t=!1;return null!=U&&u(U,e)||(F=JSUtil.fn.dateLocaleFormat(e,null,null,null,null,!0),U=new Date(e),t=!0),D=e,t}function r(e){var t=i.view.getActiveGridID(),l=i.view.getResourceID(t);if(!e)return h.CollabChatGuest;var n=i.data.getSharePublishMeta(l).getShareMeta(),a=n.getSharedUserInfo();return a.getNameByID(e)}function o(e){var t=e,l=0,n=new Date(l),a=new Date(t),r=null;return n.getYear()!==a.getYear()?r=JSUtil.fn.dateLocaleFormat(a):n.getMonth()!==a.getMonth()?r=JSUtil.fn.dateLocaleFormat(a):n.getDay()!==a.getDay()?r=JSUtil.fn.dateLocaleFormat(a):n.getHours()!==a.getHours()?r=JSUtil.fn.dateLocaleFormat(a):n.getMinutes()!==a.getMinutes()?r=JSUtil.fn.dateLocaleFormat(a):0===l&&(r=JSUtil.fn.dateLocaleFormat(a)),r}function u(e,t){var l=new Date(t);return l.getDate()==e.getDate()&&l.getMonth()==e.getMonth()&&l.getFullYear()==e.getFullYear()}var i=e.sPlusPlus,c=e.ZSEvents,s=c.topic,d=c.Groups,C=c.Names,f=(e.ZSClass,e.ZSConstants),S=i.data.UserInfo,h=f.I18N,g=f.FeatureConstants,m=i.view.Toolbar.Feature[g.COLLAB_CHAT],y=null,v=new Date,L=0,D=null,p=!0,A=0,F=null,U=null;s.register(d.Listener,C.DocAction.COLLAB_CHAT.ADD,t,"response","zuid"),s.register(d.Listener,C.UserAction.COLLAB_CHAT.GETCHAT,l,"response")}(this);
!function(t){function e(t,e,h,a,r,c,o,l,n,u){this.parent=i(),this.scrollElement=s(),this.isCurrUser=c,this.zuid=t,this.name=e,this.displayTime=h,this.msg=a,this.color=r,this.time=l,this.isAppend=u,this.addDayBlock(o,l,n),this.constructChat()}function i(){return document.querySelector(".colbChatHistory")}function s(){return document.querySelector(".colbChatPanel")}var h=t.sPlusPlus,a=t.ZSEvents,r=(a.topic,a.Groups,a.Names,t.ZSClass,t.ZSConstants,h.data.AppRegistry.USER_PHOTO_SERVER_URL);e.prototype={chatDiv:null,constructChat:function(){this.isAppend?this.addChat():this.loadChat(),this.setName(),this.setPhoto(),this.setColor(),this.setTime(),this.setMessage()},addChat:function(){var t=UserAction.getTemplate(["SP_COLLABCHAT_ENTRY"]).SP_COLLABCHAT_ENTRY;this.chatDiv=document.createElement("div"),this.chatDiv.id=this.zuid,this.chatDiv.appendChild(t),this.setClass();var e=this.parent.lastChild,i=e?e.id:void 0;void 0==i&&(document.querySelector(".colbChatHistory").lastChild.remove(),i=this.parent.lastChild.id),i==this.zuid&&(this.chatDiv.querySelector(".colbChatMsg").classList.add(this.className),this.chatDiv.querySelector(".colbChatUsr")&&this.chatDiv.querySelector(".colbChatUsr").remove(),this.chatDiv.querySelector("#name")&&this.chatDiv.querySelector("#name").remove()),this.parent.appendChild(this.chatDiv),this.chatDiv.querySelector(".colbChatList").setAttribute("id",this.time)},loadChat:function(){var t=UserAction.getTemplate(["SP_COLLABCHAT_ENTRY"]).SP_COLLABCHAT_ENTRY;this.chatDiv=document.createElement("div"),this.chatDiv.id=this.zuid,this.chatDiv.appendChild(t),this.setClass();var e=this.parent.firstChild,i=e?e.id:void 0;i==this.zuid&&(e.querySelector(".colbChatMsg").classList.add(this.className),e.querySelector(".colbChatUsr")&&e.querySelector(".colbChatUsr").remove(),e.querySelector("#name")&&e.querySelector("#name").remove()),this.parent.prepend(this.chatDiv),this.chatDiv.querySelector(".colbChatList").setAttribute("id",this.time)},setName:function(){this.chatDiv.querySelector("#name")&&(this.chatDiv.querySelector("#name").innerText=this.name)},setPhoto:function(){this.chatDiv.querySelector(".colbChatUsr")&&(this.chatDiv.querySelector(".colbChatUsr").src=r+"/file?fs=thumb&ID="+this.zuid)},setColor:function(){},setTime:function(){this.chatDiv.querySelector("#time").setAttribute("data-timeStamp",this.displayTime)},setMessage:function(){var e=this.msg,i=t.JSUtil.LinkMaker.convert(e);e=i.msg;var s=i.hasLinkMsg;s?this.chatDiv.querySelector("#msg").innerHTML=e:this.chatDiv.querySelector("#msg").innerText=e},setScroll:function(t){t&&(this.scrollElement.scrollTop=this.scrollElement.scrollHeight)},addDayBlock:function(t,e,i){if(i){var s=document.querySelector("#dayBlock").cloneNode(!0);s.id=e,s.style.display="block",s.innerHTML=t,this.isAppend?this.parent.appendChild(s):this.parent.prepend(s)}},setClass:function(){this.isCurrUser?(this.chatDiv.querySelector(".colbChatList").classList.add("colbChatListCur"),this.chatDiv.querySelector(".colbChatUsr").remove(),this.className="colbChatMsgMore"):this.className="colbChatListOthCur"}},t.ZSClass.Chat=e}(this);
!function(e){function t(e){var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),r=s.view.getVersionID(t),o=s.view.getSelectedSheets(t);UserAction.chat(i,o,r,e)}function i(e){var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),r=s.view.getVersionID(t),a=s.view.getSelectedSheets(t),c=n?parseInt(o.querySelectorAll(".colbChatList")[0].id):-1;n=!0;var l=o.querySelectorAll(".colbChatList").length;UserAction.getChat(i,a,r,e,c,l)}var s=e.sPlusPlus,r=(e.ZSConstants.wCC,e.ZSClass,e.ZSConstants.FeatureConstants),o=e.document,n=!1,a=s.view.Toolbar.Feature[r.COLLAB_CHAT];a.add=t,a.load=i}(this);
!function(e){function t(e,t,s,i){this.parent=document.querySelector(e),this.zuid=s,this.block=t,this.userInfo=i,this.constructUser(),this.updateCount()}function s(e){var t=l+"/file?fs=thumb&ID="+e;return t}function i(e,t,s,i,r,o){var n=o?u["CollabPanel.Msg.Editing"]:u["CollabPanel.Msg.IsOn"],c=e+"."+JSUtil.Cell.getReference(t,s);t!=i&&(c+=":"+JSUtil.Cell.getReference(i,r));var l=void 0==e?"":JSUtil.fn.replaceParams(n,new Array(c));return l}function r(e,t,s,i,r){var o=e+"."+JSUtil.Cell.getReference(t,s);return t!=i&&s!=r&&(o=o+":"+JSUtil.Cell.getReference(i,r)),o}var o=e.sPlusPlus,n=e.ZSEvents,c=(n.topic,n.Groups,n.Names,e.ZSClass,e.ZSConstants),u=c.I18N,l=o.data.AppRegistry.USER_PHOTO_SERVER_URL;t.prototype={userDiv:null,constructUser:function(){this.createUserTemplate(),this.setName(),this.setPhoto(),this.setColor(),this.setUserPresence()},createUserTemplate:function(){var e=UserAction.getTemplate(["SP_COLLABORATOR_ENTRY"]).SP_COLLABORATOR_ENTRY;this.userDiv=document.createElement("div"),this.userDiv.id="SP_COLLABORATOR_"+this.zuid,this.userDiv.appendChild(e),this.parent.appendChild(this.userDiv)},goToUserRef:function(){if(this.sheetName){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),s=o.view.getVersionID(e),i=o.data.getWorkBook(t,s),n=i.SheetList.getIdByName(this.sheetName),c=o.view.getSheetID(e),u=this.col,l=this.row;c!=n?UserAction.SwitchSheet(t,c,s,n,void 0,!1,function(){UserAction.ScrollCellIntoView(t,n,s,l,u)}):UserAction.ScrollCellIntoView(t,n,s,l,u),UserAction.Goto(r(this.sheetName,this.row,this.col,this.erow,this.ecol))}},setName:function(){this.userDiv.querySelector("#name").innerText=this.userInfo.dname},setPhoto:function(){var e=this.userDiv.querySelector(".colbImg");e.src=s(this.userInfo.zuid),e.style.boxShadow="0 0 0 2px #fff, 0 0 0 3px #"+(this.userInfo.color?this.userInfo.color:"f2f2f2"),e.addEventListener("onerror",function(){e.src=s("-1")})},setUserPresence:function(){var e="";this.userInfo.isActive&&(e=this.userPresence?this.userPresence:""),this.userDiv.querySelector("#usrPresence").innerText=e},setColor:function(){var e=this.userInfo.color?"#"+this.userInfo.color:"#f2f2f2";this.userDiv.querySelector(".colUsrPresence").style.background=e},updateCount:function(){var e=document.querySelector(this.block),t=this.parent.childElementCount;e.querySelector(this.block+"_cnt").innerHTML="("+t+")",e.style.display=0==t?"none":"block"},remove:function(){this.parent.removeChild(this.userDiv),this.updateCount()},updateSession:function(e,t,s,r,o,n){this.userPresence,this.updateReference(t,s,r,o,n),this.userPresence=1==e?i(this.sheetName,this.row,this.col,this.erow,this.ecol,this.editstatus):JSUtil.fn.replaceParams(u["CollabPanel.Msg.Session"],new Array(e+"")),this.updateUserPresence(this.userPresence)},updateUserPresence:function(e){this.userDiv.querySelector("#usrPresence").innerText=e},updateUserInfo:function(e){this.userInfo=e,this.setPhoto(),this.setColor()},moveToActive:function(){var e=this.userDiv.cloneNode(!0);this.remove(),this.userDiv=e,this.parent=document.querySelector("#activeCollabList"),this.block="#activeBlock",document.querySelector("#activeCollabList").prepend(this.userDiv),this.updateCount()},moveToInActive:function(){var e=this.userDiv.cloneNode(!0);this.remove(),this.userDiv=e,this.parent=document.querySelector("#InActiveCollabList"),this.block="#inActiveBlock",document.querySelector("#InActiveCollabList").prepend(this.userDiv),this.updateCount(),this.updateUserPresence("")},updateReference:function(e,t,s,i,r){this.sheetName=e,this.row=t,this.col=s,this.erow=i,this.ecol=r}},e.ZSClass.Collaborator=t}(this);
!function(e){function i(){var e=l.view.getActiveGridID(),i=l.view.getResourceID(e),t=l.data.getSharePublishMeta(i),a=t.getShareMeta(),o=a.getSharedUserInfo();r(o)}function t(e){if(c=e,u){var i,t={};for(var r in I)for(var o in c)c[o].zuid==r&&(t[r]=!0,i=c[o],i.isActive=!0,I[r].updateUserInfo(i));for(var r in c){var n=c[r],v=t[n.zuid];v||(i=n,i.isActive=!0,a(i,"#activeCollabList","#activeBlock"))}var d=l.view.getActiveGridID(),A=l.view.getResourceID(d),f=l.data.getSharePublishMeta(A),L=f.getShareMeta(),S=L.getSharedUserInfo(),g=S.get();for(var r in C){var D=!1;for(var o in g){var O=g[o];if(O.id==r){i={dname:C[r].dname,zuid:r,isActive:!1},C[r].updateUserInfo(i),D=!0;break}}D||s(r)}}}function r(e){for(var i=e.get(),t=c,r=0;r<i.length;r++){var o=i[r],n=o.id,s="#inActiveBlock",v={dname:o.fullname,zuid:n,isActive:!1},l="#InActiveCollabList";if(t)for(var d=0;d<t.length;d++){var A=t[d],f=A.zuid;if(n===f){v=A,v.isActive=!0,l="#activeCollabList",s="#activeBlock";break}}a(v,l,s)}u=!0}function a(i,t,r){if(i.zuid!=l.data.UserInfo.zuid){var a=i.zuid,o=new e.ZSClass.Collaborator(t,r,a,i);i.isActive?I[a]=o:C[a]=o}}function o(e){var i=e.zuid,t=I[i];t&&t.updateSession(1,e.sheetName,e.row,e.col,e.erow,e.ecol,e.editstatus)}function n(e,i){if(u)for(var t=e.length,r=0;t>r;r++){var a=e[r],o=a.zuid;switch(i){case"ADD":var n=C[o];if(!n)return;n.moveToActive(),I[o]=n,delete C[o];break;case"DELETE":var n=I[o];if(!n)return;n.moveToInActive(),C[o]=n,delete I[o]}}}function s(e){var i;I[e]?(i=I[e],i.remove(),delete I[e]):C[e]&&(i=C[e],i.remove(),delete C[e])}function v(e){if(u){var i={dname:e.fullname,zuid:e.id,isActive:!1};a(i,"#InActiveCollabList","#inActiveBlock")}}{var c,u,l=e.sPlusPlus,d=e.ZSEvents,A=d.topic,f=d.Groups,L=d.Names,S=e.ZSConstants,g=S.FeatureConstants,I={},C={},D=l.view.Toolbar.Feature[g.COLLABORATORS];l.data.AppRegistry.USER_PHOTO_SERVER_URL}D.load=i,A.register(f.Listener,L.CollabAction.SYNCCOLLABUSER,t,"META"),A.register(f.Listener,L.DocAction.COLLAB_LIST.ADD,o,"LIST"),A.register(f.Listener,L.DocAction.COLLAB_LIST.REMOVE,s,"ID"),A.register(f.Listener,L.UserAction.COLLAB_LIST.STATUS,n,"MSG","ACTION"),A.register(f.Listener,L.DocAction.COLLAB_LIST.ADDUSERINFO,v,"COLLABJSON")}(this);
!function(e){function r(e,r){if(f.view.Toolbar.showChartPopup&&!r)D.publish(_.UI,g.Toolbar.CHART.POPUP.OPEN_POPUP);else{var t=b.Utility.isAllowdToInsertChartInSheet();if(t==L.ERROR.READONLY)return void ZSClass.ZSAlert(H["Banner.ReadOnly.App.Server"],{title:H["Alert.Title.ROMode"]});if(t==L.ERROR.SHEET_LOCKED)return void ZSClass.ZSAlert(H["ProtectRange.UI.SheetLocked"],{title:H["Alert.Title.LockedSheet"]});var o=b.Manager.SidePanelManager;o.initPanelManager(),o.init(r)}}function t(){M=document.getElementById(m.MI+y.CHART+m.IDENTITY);var e=UserAction.getTemplate(["CHART_POPOVER_TEMPLATE"]);d=e.CHART_POPOVER_TEMPLATE.querySelector("#CHART_POPUP"),B.appendChild(d),M.setAttribute("data-content","#CHART_POPUP"),M.setAttribute("data-is-content-html-encoded",!0),M.setAttribute("data-class-name","chrtPopup"),n.call(this,d,V),D.publish(_.UI,g.SidePanel.CHARTS.LINKED_ICON,{PARENT:d}),k.zpopover(M),a.call(this)}function o(e){var r=z+e,t=UserAction.getTemplate([r]);return t[r]}function n(e,r){Object.keys(r).forEach(function(t){var a=r[t];if("object"==typeof a){var E=Object.keys(a)[0];if(e.id!=E){var l=o(E),i=l.querySelector("#"+E);e.appendChild(l),n(i,a[E])}else n(e,a[E])}else{var l=o(a);e.appendChild(l)}})}function a(){k.bind(M,"zpopoveropen",function(){f.view.Toolbar.showChartPopup&&D.publish(_.UI,g.Toolbar.CHART.POPUP.OPEN),!f.view.Toolbar.showChartPopup&&D.publish(_.UI,g.Toolbar.CHART.POPUP.CLOSE)}),k.bind(M,"zpopoverclose",function(){f.view.Toolbar.showChartPopup&&D.publish(_.UI,g.Toolbar.CHART.POPUP.CLEAR)}),E(),c(),u()}function E(){var e=U(),r=d.querySelector("#MENULINE");Object.keys(e).forEach(function(t){var o=e[t],n=r.querySelector("#"+o);n.addEventListener("click",function(){D.publish(_.UI,g.Toolbar.CHART.POPUP.SELECT,{ID:o})})})}function l(){var e=P();return{othrCht1:e[0],othrCht2:e[1]}}function i(){function e(e){e&&Object.keys(e).forEach(function(r){var t=e[r];t&&(t.checked=!1)})}var r=(b.Wrapper.DOMUtils,d.querySelector("#MENUWRAPPER"));Object.keys(j).forEach(function(t){var o=j[t],n=r.querySelector("#"+o),a=null;if("OTHERSMENU"==o){var E=P();a=[],E.forEach(function(r){var t=n.querySelector("#"+r);a=t.querySelectorAll("input"),e(a)})}else a=n.querySelectorAll("input"),e(a)})}function c(){function e(e){e&&Object.keys(e).forEach(function(r){var t=e[r];t.addEventListener&&t.addEventListener("click",function(){D.publish(_.UI,g.Toolbar.CHART.POPUP.EDIT,{TYPE:this.previousElementSibling.id})})})}var r=b.Wrapper.DOMUtils,t=d.querySelector("#MENUWRAPPER");Object.keys(j).forEach(function(o){var n=j[o],a=t.querySelector("#"+n),E=null;if("OTHERSMENU"==n){var i=P();E=[],i.forEach(function(r){var t=a.querySelector("#"+r);E=t.querySelectorAll("label"),e(E)});var c=t.querySelector("#botNav"),u=c.querySelectorAll("input");r.addEventByNode(u,r.Events.CLICK,function(){var e=l();D.publish(_.UI,g.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:e[this.id]}),s(this.id)})}else E=a.querySelectorAll("label"),e(E)})}function u(){function e(e){switch(e){case"NEXT":D.publish(_.UI,g.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:r()});break;case"PREV":D.publish(_.UI,g.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:t()})}}function r(){var e=P(),r=e.length,t=(e.indexOf(F)+1)%r;return e[t]}function t(){var e=P(),r=e.length,t=e.indexOf(F)-1;return e[0>t?r-1:t]}var o=d.querySelector("#MENUWRAPPER");Object.keys(w).forEach(function(r){var t=w[r],n=o.querySelector("#"+t);n.addEventListener("click",function(){e(w[r]),s(w[r])})})}function s(e){var r=d.querySelector("#MENUWRAPPER"),t=null,o=b.Wrapper.DOMUtils,n=null;switch(e){case"PREV":case"othrCht1":t=r.querySelector("#PREV"),n=r.querySelector("#NEXT");break;case"NEXT":case"othrCht2":n=r.querySelector("#PREV"),t=r.querySelector("#NEXT")}n&&o.show(n),t&&o.hide(t)}function P(){return["OTHERSMENU_SUBMENU_1","OTHERSMENU_SUBMENU_2"]}function U(){return Z.concat(j)}function T(){var e=b.Wrapper.DOMUtils;D.publish(_.UI,g.Toolbar.CHART.POPUP.SELECT,{ID:X});var r=A(),t=e.createElement("div",{id:"recommendChartPreview"}),o=r.querySelector("#recommendChartPreview");o?o.innerHTML="":r.appendChild(t),e.hide(o);var n=r.querySelector("#RECOMMENDALERT");n.setAttribute("noChart","false"),e.hide(n),i(),D.publish(_.UI,g.Toolbar.CHART.POPUP.SELECT_SUBMENU,{ID:P()[0]})}function R(){k.zpopover(M,"close")}function S(){k.zpopover(M,"open",{target:M})}function O(e){function r(){var e=U();Object.keys(e).forEach(function(r){var n=e[r];t.querySelector("#"+n).classList.add("dsp_none"),o.querySelector("#"+n).classList.remove("active")})}if(e!=x){x=e;var t=d.querySelector("#MENUWRAPPER"),o=d.querySelector("#MENULINE");r.call(this),t.querySelector("#"+x).classList.remove("dsp_none"),o.querySelector("#"+x).classList.add("active");var n=I.getFooterBar();U().indexOf(x)>0?D.publish(_.UI,g.Toolbar.CHART.POPUP.SETDATASOURCE,{HOLDER:n}):D.publish(_.UI,g.Toolbar.CHART.POPUP.SETRECOMMENDATIONSOURCE,{HOLDER:n})}}function C(e){function r(){var e=P();Object.keys(e).forEach(function(r){var t=e[r];o.querySelector("#"+t).classList.add("dsp_none")})}if(e!=F){F=e;var t=d.querySelector("#MENUWRAPPER"),o=t.querySelector("#OTHERSMENU");r.call(this);var n={OTHERSMENU_SUBMENU_1:"othrCht1",OTHERSMENU_SUBMENU_2:"othrCht2"};o.querySelector("#"+e).classList.remove("dsp_none"),o.querySelector("#"+e).classList.remove("dsp_blk");var a=o.querySelector("#botNav");a.querySelector("#"+n[e]).checked=!0}}function A(){var e=d.querySelector("#MENUWRAPPER"),r=e.querySelector("#"+Z[0]);return r}function h(){var e=d.querySelector("#MENUWRAPPER"),r=e.querySelector("#footerBar");return r}function v(){var e=b.Wrapper.DOMUtils,r=I.getRecommendationHolder(),t=r.querySelector(".ZsLoader");t.setAttribute("loadData","true"),e.show(t)}function N(){var e=b.Wrapper.DOMUtils,r=I.getRecommendationHolder(),t=r.querySelector(".ZsLoader");t.setAttribute("loadData","false"),e.hide(t)}var d,M,p=e.document,f=e.sPlusPlus,b=e.ZSChart,y=e.ZSConstants.FeatureConstants,I=f.view.Toolbar.Feature[y.CHART],L=b.Constants.MessageConstant,H=ZSConstants.I18N,q=e.ZSEvents,D=q.topic,_=q.Groups,g=q.Names,m=e.ZSConstants.wCC,k=e.UIUtil.Component,B=p.getElementById("popupmenu"),W=e.ZSDevTools,w=(W.Logger,["NEXT","PREV"]),Z=["RECOMMEND"],j=["COLMENU","BARMENU","LINEMENU","PIEMENU","AREAMENU","SCATTERMENU","OTHERSMENU"],V=[{CHART_POPUP:["MENULINE",{MENUWRAPPER:[{RECOMMEND:["ZSLOADER","RECOMMEND_PREVIEW_WRAPPER","RECOMMEND_ALERT"]},"COLMENU","BARMENU","LINEMENU","PIEMENU","AREAMENU","SCATTERMENU",{OTHERSMENU:["NEXT","PREV"]},"BOTTOMLINE"]}]}],X="RECOMMEND",z="CHART_POPUP_",x="RECOMMEND",F="OTHERSMENU_SUBMENU_1";I.execute=r,I.getRecommendationHolder=A,I.getFooterBar=h,D.register(_.UI,g.Toolbar.CHART.POPUP.CLOSE,R),D.register(_.UI,g.Toolbar.CHART.POPUP.OPEN_POPUP,S),D.register(_.UI,g.Toolbar.CHART.POPUP.CLEAR,T),D.register(_.UI,g.Toolbar.CHART.POPUP.LOADER.SHOW,v),D.register(_.UI,g.Toolbar.CHART.POPUP.LOADER.HIDE,N),D.register(_.UI,g.Toolbar.CHART.POPUP.SELECT,O,"ID"),D.register(_.UI,g.Toolbar.CHART.POPUP.SELECT_SUBMENU,C,"ID"),D.register(_.UI,g.Layout.TEMPLATE_LOADED,t)}(this);
!function(e){function t(e){if(e){for(var t=[],i=0;i<e.length;i++){var o,r,n=e[i];for(o in n)r=n[o];var s,a,n={};"sum"===o?s=1:"count"===o?s=2:"max"===o?s=3:"min"===o?s=4:"product"===o?s=5:"average"===o?s=6:"stdev"===o?s=7:"stdevp"===o?s=8:"var"===o?s=9:"varp"===o?s=10:"median"===o?s=11:"countnums"===o&&(s=12),"none"===r?a=0:"row-percentage"===r?a=5:"column-percentage"===r?a=6:"total-percentage"===r&&(a=7),n[s]=a,t.push(n)}return t}}function i(e,t,i){for(var o=V.view.getActiveGridID(),r=V.view.getResourceID(o),n=V.view.getVersionID(o),s=V.data.getWorkBook(r,n).PivotCollection,a=s.PivotNameList.keys(),v=Array.from(a),c=0;c<v.length;c++){var l=v[c],g=s.get(l),p=g[B.TARGET],I=p[0],h=p[1],d=p[2],f=p[3],u=p[4];if(I===e&&t>=h&&f>=t&&i>=d&&u>=i){b.currentPivotId=l,b.ID=l;break}}}function o(e,t){if(t==m.Pivot.ID){var i=V.view.getActiveGridID(),o=V.view.getResourceID(i),r=V.view.getVersionID(i),n=m.Pivot.ID,s=!1,a=!1;if("temp"!=t)var v=V.data.getWorkBook(o,r).PivotCollection.get(n),c=v.af;for(var l=[],g=0;g<e.length;g++){var p=e[g],I=p.content;if(!I){s=!0;break}if(l.indexOf(I)>-1){a=!0;break}if(l.push(I),c&&c.length)for(var h=0;h<c.length;h++){var d=!0,f=c[g];if(f.content===I&&f.colIndex===p.colIndex){d=!1,void 0!==f[W.GROUP]&&(p[W.GROUP]=f[W.GROUP]);break}}}return(a||s)&&"temp"!=t&&U.publish(k.Listener,y.UserAction.PIVOT.CANCEL_BUILDER),a?(U.publish(k.Listener,y.ERROR.SHOW,{ERRORMSG:"Error.Pivot.Invalid.Source"}),!1):s?(U.publish(k.Listener,y.ERROR.SHOW,{ERRORMSG:"Error.Pivot.Invalid.Source.Empty"}),!1):void("temp"===t?U.publish(k.Listener,y.UserAction.PIVOT.NEW_GET_FIELDS,{allFields:e}):(v.af=e,U.publish(k.Listener,y.UserAction.PIVOT.GET_FIELDS)))}}function r(e,t,i){var o=V.view.getActiveGridID(),r=V.view.getResourceID(o),n=V.view.getVersionID(o),s=V.data.getWorkBook(r,n).PivotCollection,a=[],v=s.get(e);if(v){for(var c="row"==t?v[W.ROW_FIELDS]:v[W.COLUMN_FIELDS],l=v[W.FUNCTION],g=v[W.ALL_FIELDS],p=v[W.DATA_FIELDS],I=[],h=c[i],d=0;d<g.length;d++)h==g[d].colIndex&&a.push(g[d].content);for(var f=0;f<p.length;f++)for(var u=p[f],d=0;d<g.length;d++)u==g[d].colIndex&&I.push(g[d].content);for(var d=0;d<l.length;d++){var E,P,T=l[d];for(E in T)P=T[E];var O=E.charAt(0).toUpperCase()+E.slice(1),S=JSUtil.fn.replaceParams(G["Pivot.UI.Datafield.Content."+O],new Array(I[d]));a.push(S)}}return a}function n(e,t,o,r){if(r.pivot)i(r.id,r.row,r.col),U.publish(k.UI,y.SidePanel.PIVOT.SHOW_ICON);else{var n=m.Pivot.InsertSheetCallBack;"NEW_PIVOT"==n&&0!=r.row&&0!=r.col&&(m.Pivot.InsertSheetCallBack=void 0),"NEW_PIVOT"!=n&&U.publish(k.UI,y.SidePanel.PIVOT.HIDE_ICON)}}function s(t,i){var o=V.view.getActiveGridID(),r=V.view.getResourceID(o),n=V.view.getSheetID(o),s=V.view.getVersionID(o),a=i.top,l=i.left,h=i.height,d=i.width,f=t.row,u=t.col,E=t.pId,P={applyFilter:g,applyCustomFilter:p,sortPivot:I};L||(L=new m.Pivot.Dialog.Filter(P),c());L.getDialogPos();L.show(a,l,h,d,t),v(),e.UserAction.getPivotFilterInfo(r,n,s,f,u,E)}function a(t,i,o,r){var n=V.view.getActiveGridID(),s=V.view.getResourceID(n),a=V.view.getSheetID(n),l=V.view.getVersionID(n),h=V.data.getWorkBook(s,l);if(h.isEditable()){var d,f,u=h.getSheetObj(a),E=u.Column.axis.getPos(i),P=u.Row.auxiliaryAxis.getPos(t),T=u.Row.auxiliaryAxis.getDim(t),O=u.Column.axis.getDim(i),n=V.view.getActiveGridID(),S=V.view.getSheetState(n,a),D=u.Row.FreezedCount,w=u.Column.FreezedCount,R=i>=w,A=t>=D,C=S.getScrollLefts(),_=S.getScrollTops(),F=S.getScreenHeights(),x=S.getScreenWidths(),N=A?F[0]:F[1],U=R?x[0]:x[1],k=R?x[1]:0,y=A?F[1]:0,d=R?C[0]:C[1],f=A?_[0]:_[1],G={applyFilter:g,applyCustomFilter:p,sortPivot:I};L||(L=new m.Pivot.Dialog.Filter(G),c());var b=L.getDialogPos(),W=b.height,B=b.width,P=P-f,E=E-d;P+W+T>N?(P=P+y-W,P=0>P?0:P,T=0):P+=y,E+B+O>U?(E=E+k-B,E=0>E?0:E):E+=k,L.show(P,E,T,O,o),v(),e.UserAction.getPivotFilterInfo(s,a,l,t,i,r)}}function v(){var e=V.view.Events.Key;e.focusContext(e.Entry.Filter.Context)}function c(){var e=V.view.Events.Key,t=e.Entry.Filter.Context,i=t.keyDown;i[x.ESC]=function(){d()},i[x.PURE_PRINTABLE_CHAR]=l}function l(){return!1}function g(t,i,o,r,n,s,a,v,c,l){var g=V.view.getActiveGridID(),p=V.view.getResourceID(g),I=V.view.getSelectedSheets(g),h=V.view.getVersionID(g);e.UserAction.applyPivotFilter(p,I,h,t,i,o,r,n,s,a,v,c,l)}function p(t,i,o,r,n,s){var a=V.view.getActiveGridID(),v=V.view.getResourceID(a),c=V.view.getSelectedSheets(a),l=V.view.getVersionID(a);e.UserAction.applyPivotCustomFilter(v,c,l,t,i,o,r,n,s)}function I(t,i,o,r,n){var s=V.view.getActiveGridID(),a=V.view.getResourceID(s),v=V.view.getSelectedSheets(s),c=V.view.getVersionID(s);e.UserAction.sortPivot(a,v,c,t,i,o,r,n)}function h(e){L.generatePivotData(e)}function d(){if(L){L.close();var e=V.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}}function f(e){var t=e.getContext("2d"),i=window.devicePixelRatio||1,o=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/o}function u(){var e=document.createElement("canvas");return e.className="canvasStyle",e}function E(e,t,i,o){var r=H.getPixelRatio(e);return o||(o=r),e.width=t*o,e.height=i*o,e.style.width=t+"px",e.style.height=i+"px",e.getContext("2d").setTransform(o,0,0,o,0,0),e}function P(e,t,i){e.font=i;var o=e.measureText(t);return o.width}function T(e){var t=V.view.getActiveGridID(),i=V.view.getResourceID(t),o=V.view.getVersionID(t),r=m.Pivot.ID,n=m.Pivot.InsertSheetCallBack,s=V.view.getSelectedSheets(t),a=V.data.getWorkBook(i,o).PivotCollection.get(r);if(e)switch(n){case"ERR_NEW_PIVOT":U.publish(k.Listener,y.UserAction.PIVOT.CREATE_INNEWSHEET,{NEWSHEETID:e});break;case"NEW_PIVOT":e&&(a[B.TARGET]=[e,0,0,0,0]),U.publish(k.UI,y.SidePanel.PIVOT.OPEN);break;case"COPY_PIVOT":case"MOVE_PIVOT":var v=new m.Range(0,0,0,0),c="MOVE_PIVOT"===n?"move":"copy";UserAction.movePivot(i,s,o,r,v,!1,!1,c);break;case"INSERT_PIVOT":e&&(a[B.TARGET]=[e,0,0,0,0]),m.Pivot.Util.insertFromRecommendation()}}function O(e,t){var i=V.view.getActiveGridID(),o=V.view.getResourceID(i),r=V.data.getWorkBook(o,t).PivotCollection.get(e),n=new _(r,t);n.init()}function S(t){var i=V.view.getActiveGridID(),o=V.view.getResourceID(i),r=V.view.getVersionID(i),n=e.ZSConstants.CommandConstants,s=V.data.getWorkBook(o,r).PivotCollection.get(t),a=s[n.TARGET],v=new m.Range(a[1],a[2],a[1],a[2]);e.UserAction.gotoCell(o,a[0],r,v,a[1],a[2])}function D(e,t,i){var o=V.data.getWorkBook(e,t).PivotCollection.get(i),r=new _(o,t);return r.getFilterDetails()}function w(e,t,i){for(var o=V.data.getWorkBook(e,i).PivotCollection.getPivotList(t),r=0;r<o.length;r++){var n=V.data.getWorkBook(e,i).PivotCollection.get(o[r]),s=new _(n,i);s.init()}}function R(e,t,i){var o=V.view.getActiveGridID(),r=V.view.getResourceID(o),n=V.view.getVersionID(o),s=V.data.getWorkBook(r,n).PivotCollection,a=e[W.PIVOT_ACTION_JSON];if(a[B.SOURCE]=[a[W.ASSOCIATED_SOURCE_SHEET_NAME],a[W.SOURCE_START_ROW],a[W.SOURCE_START_COLUMN],a[W.SOURCE_END_ROW],a[W.SOURCE_END_COLUMN]],a.id="temp",a[W.SUBTOTALOPTION]=a.pto[0],a[W.ROWGRANDTOTALOPTION]=a.pto[1],a[W.COLGRANDTOTALOPTION]=a.pto[2],s.add("temp",a),m.Pivot.ID="temp",m.Pivot.InsertSheetCallBack="INSERT_PIVOT",t&&i){var v=V.view.getSheetID(o);a[B.TARGET]=[v,t,i,t,i];var c=V.view.getSelectedSheets(o);UserAction.createPivot(r,c,n,a)}else sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].openDialog(void 0)}function A(e){var t=m.Pivot.LastAction;switch(t){case"SP_MOVE":case"DIALOG_MOVE":case"DIALOG_COPY":case"DIALOG_INSERT":sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].handleError(e);break;default:U.publish(k.UserAction,y.UserAction.PIVOT.HANDLE_ERROR,{ERRORMSG:e})}}function C(e,t){var i=V.view.getActiveGridID(),o=V.view.getResourceID(i),r=V.view.getVersionID(i),n=V.data.getWorkBook(o,r).PivotCollection.get("temp"),s=V.view.getSelectedSheets(i);UserAction.createPivot(o,s,r,n,e,t)}function _(e,t){this.pivot=e,this.version=t}var L,V=e.sPlusPlus,m=e.ZSClass,F=e.ZSConstants,x=(V.view.Events.Key,F.JSKeyCode),N=e.ZSEvents,U=N.topic,k=N.Groups,y=N.Names,G=e.ZSConstants.I18N,b=m.Pivot,W=e.ZSConstants.PivotConstant,B=e.ZSConstants.CommandConstants,H=b.Util||(b.Util={});_.prototype={init:function(){this.createPivotObject()},createPivotObject:function(){var e=this.getFilterCells();this.pivot[W.FILTER_CELLS]=e,this.createFilterIcon(e)},createFilterIcon:function(e){var t=V.view.getActiveGridID(),i=V.view.getResourceID(t),o=this.pivot[B.TARGET],r=o[0],n=V.view.getSheetID(t);n===r&&U.publish(k.Listener,y.UserAction.PIVOT.FILTER_ADD,{RID:i,SHEETID:r,VERSION:this.version,F_CEllS:e,TYPE:"add"})},isFilterApplied:function(e,t,i){if(e)for(var o=0;o<e.length;o++){var r=e[o];if(r[W.PIVOT_FIELD_TYPE]===t&&r[W.HEADER_INDEX]===i)return!0}return!1},getSortType:function(e,t,i){if(e)for(var o=0;o<e.length;o++){var r=e[o];if(r[W.PIVOT_FIELD_TYPE]===t&&r[W.HEADER_INDEX]===i)return r[W.ASCENDING_SORT]?0:1}return-1},getIconType:function(e,t){switch(t){case-1:return e?"filterApplied":"filter_new";case 0:return e?"pivot_filter_ascending":"pivot_ascending";case 1:return e?"pivot_filter_descending":"pivot_descending"}return"pivotdown"},getValueObj:function(){var e=this.pivot.rf,t=this.pivot.cf;return e&&-1!==e.indexOf(-1)?{pft:"row",hidx:e.indexOf(-1)}:t&&-1!==t.indexOf(-1)?{pft:"column",hidx:t.indexOf(-1)}:void 0},getFilterCells:function(){var e=this.pivot[B.TARGET],t=e[0],i=e[1],o=e[2],r=V.view.getActiveGridID(),n=V.view.getResourceID(r),s=V.data.getWorkBook(n,this.version).getSheetObj(t),a=s.Prop.getName(),v=this.pivot.rf.length,c=this.pivot.cf.length,l=this.pivot.pf.length,g=this.pivot.pb,p=this.pivot.pfd,I=this.pivot.psd,h=this.getValueObj();g&&g.indexOf("'")>-1&&a.indexOf(" ")>-1&&(a="'"+a+"'");var d,f=[];if(g=g?g.trim():""){var u=g.split(a);u.splice(0,1);for(var E=0;E<u.length;E++){var P=u[E];P=P.substring(P.indexOf(".")+1).trim();var T,O;if(d=JSUtil.fn.getCellPosByLabel(P),l>E?(T="page",O=E,d.pft=T,d.hidx=O):l+v>E?(T="row",O=E-l,d.pft=T,d.hidx=O):(T="column",O=E-l-v,d.pft=T,d.hidx=O),!h||T!==h[W.PIVOT_FIELD_TYPE]||O!==h[W.HEADER_INDEX]){var S=this.isFilterApplied(p,T,O),D=this.getSortType(I,T,O);d.pic=this.getIconType(S,D),d.sa=!S,d.pId=this.pivot.id,f.push(d)}}}else{for(var w=0===l?0:1,E=0;c>E;E++){d={row:i+l+w,col:o+E+Math.max(v,1),pft:"column",hidx:E};var S=this.isFilterApplied(p,"row",E),D=this.getSortType(I,"row",E);d.pic=this.getIconType(S,D),d.pId=this.pivot.id,d.sa=!S,f.push(d)}for(var R=0;v>R;R++){d={row:i+Math.max(c,1)+l+w,col:o+R,pft:"row",hidx:R};var S=this.isFilterApplied(p,"col",R),D=this.getSortType(I,"col",R);d.pic=this.getIconType(S,D),d.pId=this.pivot.id,d.sa=!S,f.push(d)}for(var A=0;l>A;A++){d={row:i+A,col:o,pft:"page",hidx:A};var S=this.isFilterApplied(p,"page",A),D=this.getSortType(I,"page",A);d.pic=this.getIconType(S,D),d.pId=this.pivot.id,d.sa=!S,f.push(d)}}return f},getFilterDetails:function(){var e=this.pivot[B.TARGET],t=e[0],i=e[1],o=e[2],r=V.view.getActiveGridID(),n=V.view.getResourceID(r),s=V.data.getWorkBook(n,this.version).getSheetObj(t),a=s.Prop.getName(),v=this.pivot.af,c=this.pivot.rf.length,l=this.pivot.cf.length,g=this.pivot.pf.length,p=this.pivot.pb,I=this.pivot.pfd,h=this.pivot.psd,d=this.getValueObj();p&&p.indexOf("'")>-1&&a.indexOf(" ")>-1&&(a="'"+a+"'");var f,u={},E=[],P=[],T=[];if(p=p?p.trim():""){var O=p.split(a);O.splice(0,1);for(var S=0;S<O.length;S++){var D=O[S];D=D.substring(D.indexOf(".")+1).trim();var w,R;if(f=JSUtil.fn.getCellPosByLabel(D),g>S){w="page",R=S,f.pft=w,f.hidx=R;var A=this.pivot.pf[R],C=v[A].content;f.content=C}else if(g+c>S){w="row",R=S-g,f.pft=w,f.hidx=R;var A=this.pivot.rf[R],C=v[A].content;f.content=C}else{w="column",R=S-g-c,f.pft=w,f.hidx=R;var A=this.pivot.cf[R],C=v[A].content;f.content=C}if(!d||w!==d[W.PIVOT_FIELD_TYPE]||R!==d[W.HEADER_INDEX]){var _=this.isFilterApplied(I,w,R),L=this.getSortType(h,w,R);f.pic=this.getIconType(_,L),f.sa=!_,f.pId=this.pivot.id,"page"===w?T.push(f):"row"===w?E.push(f):"column"===w&&P.push(f)}}}else{for(var m=0===g?0:1,S=0;l>S;S++){f={row:i+g+m,col:o+S+Math.max(c,1),pft:"column",hidx:S};var _=this.isFilterApplied(I,"row",S),L=this.getSortType(h,"row",S);f.pic=this.getIconType(_,L),f.pId=this.pivot.id,f.sa=!_,filterCells.push(f)}for(var F=0;c>F;F++){f={row:i+Math.max(l,1)+g+m,col:o+F,pft:"row",hidx:F};var _=this.isFilterApplied(I,"col",F),L=this.getSortType(h,"col",F);f.pic=this.getIconType(_,L),f.pId=this.pivot.id,f.sa=!_,filterCells.push(f)}for(var x=0;g>x;x++){f={row:i+x,col:o,pft:"page",hidx:x};var _=this.isFilterApplied(I,"page",x),L=this.getSortType(h,"page",x);f.pic=this.getIconType(_,L),f.pId=this.pivot.id,f.sa=!_,filterCells.push(f)}}return u.pf=T,u.rf=E,u.cf=P,u}},H.getPrimitiveFnFromStr=t,H.getsortByValues=r,H.checkSourceChanges=o,H.getLocationToInsert=R,H.insertFromRecommendation=C,H.getPixelRatio=f,H.create=u,H.setHiDPI=E,H.getTextWidth=P,H.getPivotChartFilterDetails=D,H.openPivotChartFilterDialog=s,U.register(k.UI,y.Menu.SHOW_PIVOTFILTER_OPTION,a,"ROW","COL","PIVOT_FILTERCELL","PIVOT_ID"),U.register(k.Listener,y.SheetAction.ACTIVE_CELL.INFO,d),U.register(k.Listener,y.SheetAction.PIVOT.FILTER_INFO,h,"filterInfo"),U.register(k.Listener,y.SheetAction.ACTIVE_CELL.INFO,n,"RID","SHEETID","VERSION","VALUE"),U.register(k.Listener,y.UserAction.PIVOT.RESUSCITATE_PIVOTMODEL,O,"pivotId","version"),U.register(k.Listener,y.UserAction.PIVOT.MOVE_ACTIVECELL,S,"pivotId"),U.register(k.Listener,y.UserAction.PIVOT.FILTER_SHOW,w,"RID","SHEETID","VERSION"),U.register(k.Listener,y.UserAction.PIVOT.SHEETINSERT_CALLBACK,T,"NEWSHEETID"),U.register(k.Listener,y.ERROR.SHOW,A,"ERRORMSG")}(this);
!function(t){function i(t,i,o){this.pivotType=h(o.pa_json),this.canvas=t,this.context=i,this.pivotData=o.height<300&&o.data.length>50?o.data.splice(0,50):o.height>300&&o.data.length>700?o.data.splice(0,700):o.data,this.containerWidth=Math.round(o.width-10),this.containerHeight=o.height,this.widthArray=[],this.gridCoObj=[],this.defaultRowHeight=17,this.defaultColWidth=70,this.rowCount,this.colCount,this.rowHeight=22,this.gridWidth,this.gridHeight,this.algLeft=5,this.algTop=5,this.algRight=12}function h(t){var i="";return t[n.PAGE_FIELDS].length>0&&(i="P"+t[n.PAGE_FIELDS].length+"_"),t[n.ROW_FIELDS].length>0&&(i=i+"R"+t[n.ROW_FIELDS].length+"_"),t[n.COLUMN_FIELDS].length>0&&(i=i+"C"+t[n.COLUMN_FIELDS].length+"_"),t[n.DATA_FIELDS].length>0&&(i=i+"D"+t[n.DATA_FIELDS].length),i=r[i]?i:"R1_D1"}var o=(t.sPlusPlus,t.ZSClass),s=o.Pivot,e=s.Util||(s.Util={}),n=t.ZSConstants.PivotConstant,r=t.ZSConstants.PivotColorConstant;i.prototype={draw:function(){this.getRowColCount(),this.getMaxWidth(),this.defaultColWidth=this.containerWidth/this.colCount,this.maxCanvasWidth=this.containerWidth,this.gridWidth=this.colCount*this.defaultColWidth,this.gridHeight=this.rowCount*this.rowHeight;for(var t=0,i=0;i<this.colCount;i++)o=this.widthArray[i]&&this.widthArray[i]>this.defaultColWidth?this.widthArray[i]:this.defaultColWidth,t+=o;e.setHiDPI(this.canvas,t>this.maxCanvasWidth?this.maxCanvasWidth:t,this.gridHeight);var h,o,s=0;this.setCoordinates();for(var n=this.gridCoObj.R0,i=0;i<=this.colCount;i++){h=s,this.context.beginPath(),this.context.moveTo(s,0),this.context.lineTo(s,this.gridHeight);var r=this.getBorderColor("C",i);this.context.strokeStyle=r,this.context.stroke();{n[i]}o=this.defaultColWidth,s+=o,this.context.closePath()}h>this.gridWidth&&(this.gridWidth=h);for(var a=.5,i=0;i<=this.rowCount;i++){var r=this.getBorderColor("R",i);this.context.strokeStyle=r,this.context.beginPath(),this.rowCount==i?(this.context.moveTo(0,a-1),this.context.lineTo(this.gridWidth,a-1)):(this.context.beginPath(),this.context.moveTo(0,a),this.context.lineTo(this.gridWidth,a)),a+=this.rowHeight,this.context.stroke(),this.context.closePath()}this.parseData();this.canvas.offsetLeft,this.canvas.offsetTop},setCoordinates:function(){for(var t=0,i=0,h=0;h<=this.rowCount;h++){var o=[];t=0;for(var s=0;s<this.colCount;s++){var e;e=this.defaultColWidth;var n={x:t,y:i,wd:e,ht:this.rowHeight};t+=e,o.push(n)}i+=this.rowHeight,this.gridCoObj["R"+h]=o}},parseData:function(){for(var t=0;t<this.rowCount;t++)for(var i=this.gridCoObj["R"+t],h=this.pivotData[t],o=this.getCellBGColor(t),s=this.getTextColor(t),n=0;n<this.colCount;n++){var r=h[n],a=i[n],l="undefined"==typeof r.v?"":r.v,d=r.gp;if(this.context.beginPath(),this.context.fillStyle=o,this.rowCount-1==t?(this.context.fillRect(a.x+.5,a.y+1,a.wd-1,a.ht-2),this.context.font=this.colCount>1?"bold 10pt Arial":"10pt Arial"):0==t||1==t?(this.context.fillRect(a.x+.5,a.y+1,a.wd-1,a.ht-1),this.context.font="bold 10pt Arial"):(this.context.fillRect(a.x+.5,a.y+1,a.wd-1,a.ht-1),this.context.font="10pt Arial"),this.context.fillStyle=s,"GRIDROW"==d){var g=e.getTextWidth(this.context,l,"10pt Arial")+10;this.context.textAlign=a.wd>g?"end":"start",this.context.fillText(l,a.wd>g?a.x+a.wd-this.algRight:a.x+this.algLeft,a.y+a.ht-this.algTop)}else this.context.textAlign="start",this.context.fillText(l,a.x+this.algLeft,a.y+a.ht-this.algTop);this.context.closePath()}},getRowColCount:function(){this.rowCount=this.pivotData.length,this.colCount=this.pivotData[0].length},getMaxWidth:function(){for(var t=0;t<this.pivotData.length;t++)for(var i=this.pivotData[t],h=0;h<i.length;h++){var o=this.widthArray[h],s=i[h],n="v",r=s[n];if(r){var a=e.getTextWidth(this.context,r,"10pt Arial");(!o||a>o)&&(this.widthArray[h]=a)}}},getBorderColor:function(t,i){return"R"===t&&this.rowCount==i||"C"===t&&this.colCount==i?r[this.pivotType][t][99][n.STROKE_STYLE]:r[this.pivotType][t].hasOwnProperty(i)?r[this.pivotType][t][i][n.STROKE_STYLE]:r[this.pivotType][t][999][n.STROKE_STYLE]},getCellBGColor:function(t){return r[this.pivotType][n.ROW].hasOwnProperty(t)?r[this.pivotType][n.ROW][t][n.BACKGROUND_STYLE]:this.rowCount-1==t?r[this.pivotType][n.ROW][99][n.BACKGROUND_STYLE]:r[this.pivotType][n.ROW][999][n.BACKGROUND_STYLE]},getTextColor:function(t){return r[this.pivotType][n.ROW].hasOwnProperty(t)?r[this.pivotType][n.ROW][t][n.FONT_STYLE]:this.rowCount-1==t?r[this.pivotType][n.ROW][99][n.FONT_STYLE]:r[this.pivotType][n.ROW][999][n.FONT_STYLE]}},e.CanvasGrid=i}(this);
!function(e){function t(e){l=e,this.tempModel,this.usedFields=[],this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1},this.placeholder={element:void 0,parent:void 0,position:void 0}}function i(){var e=e||window.event,t=e.target,r=t.className,n=t.parentNode.className,l=t.parentNode.parentNode.className,o=r;-1!=r.indexOf("zselectbox pDtmBox")?o=n:-1!=r.indexOf("ui-icon-triangle-1-s")?o=l:(-1!=r.indexOf("ui-zmenu-item")||-1!=r.indexOf("ui-zmenu-text"))&&(o="pDtmBox");var a=document.getElementsByClassName("pvtDataMenuBox");if(-1==o.indexOf("pDtmBox")){for(var s=0;s<a.length;s++)a[s].style.display="none";document.body.removeEventListener("mousedown",i)}}function r(t){return e.UserAction.getTemplate([t])}function n(e,t){if(l){var i=l.querySelector("#createPivot");e?(i.classList.remove("ZsRt"),i.children[0].classList.remove("generate"),i.children[1].innerText=g["Pivot.UI.Generate"],t&&(v.SP.isEditMode="false",i.classList.add("ui-button-disabled","ui-state-disabled"))):(i.children[1].innerText=g["Pivot.UI.Progress"],i.children[0].classList.add("generate"),i.classList.add("ZsRt"))}}var l,o,a=e.sPlusPlus,s=e.ZSEvents,d=s.topic,c=s.Groups,h=s.Names,u=e.ZSClass,v=u.Pivot,p=u.Editors,g=e.ZSConstants.I18N,f=e.ZSConstants.PivotConstant,m=e.ZSConstants.CommandConstants,S=e.UIUtil.Component,F=0,E=void 0;t.prototype={init:function(){if(l.querySelector("#createPivot")&&l.querySelector("#createPivot").addEventListener("click",this.create.bind(this)),l.querySelector("#confirmPivot")&&l.querySelector("#confirmPivot").addEventListener("click",this.create.bind(this)),l.querySelector("#resetPivot")&&l.querySelector("#resetPivot").addEventListener("click",this.reset.bind(this)),l.querySelector("#pvtSearchField")&&l.querySelector("#pvtSearchField").addEventListener("keyup",this.searchField.bind(this)),this.constructDateMenu(),this.constructDataMenu(),UIUtil.Component.initComponent("#pivot"),l.querySelector("#cancelPivot")&&l.querySelector("#cancelPivot").addEventListener("click",this.cancel.bind(this)),l.querySelector("#nSheetErr")&&l.querySelector("#nSheetErr").addEventListener("click",this.eSheetHide),l.querySelector("#eSheetErr")&&l.querySelector("#eSheetErr").addEventListener("click",this.eSheetShow.bind(this)),l.querySelector("#overwrite")&&l.querySelector("#overwrite").addEventListener("click",this.overwrite.bind(this)),l.querySelector("#targetCellErr")){var e=l.querySelector("#targetCellErr");E=new p.RangeEditor(e,!0),u.RangePicker.register(E,!0,!0),E.addListeners({valueChanged:this.targetCellErrEditorInputHandler})}l.querySelector(".errMaxFieldClose")&&l.querySelector(".errMaxFieldClose").addEventListener("click",this.hideMaxFieldError.bind(this))},targetCellErrEditorInputHandler:function(){E.value.trim().length>0?l.querySelector("#confirmPivot").classList.remove("ui-button-disabled","ui-state-disabled"):l.querySelector("#confirmPivot").classList.add("ui-button-disabled","ui-state-disabled")},eSheetHide:function(){l.querySelector("#targetLocErr").classList.add("pvtHide"),l.querySelector("#confirmPivot").classList.contains("ui-button-disabled")&&l.querySelector("#confirmPivot").classList.remove("ui-button-disabled","ui-state-disabled")},eSheetShow:function(){this.targetCellErrEditorInputHandler(),l.querySelector("#targetLocErr").classList.remove("pvtHide");var e=l.querySelector("#targetCellErr");e.focus()},create:function(e){v.LastAction=void 0;var t=e&&e.target.id;if("confirmPivot"==t||!l.querySelector("#createPivot").classList.contains("ui-button-disabled")&&!l.querySelector("#createPivot").classList.contains("ui-state-disabled")){if(this.tempModel[f.ROW_FIELDS].length<1&&this.tempModel[f.COLUMN_FIELDS].length<1&&this.tempModel[f.DATA_FIELDS].length<1)return this.showAlertDialog(g["Error.Pivot.RowOrColOrData.Field"]),!1;var i=a.view.getActiveGridID(),r=a.view.getResourceID(i),o=a.view.getVersionID(i),s=a.view.getSelectedSheets(i),d=!1,c=!1;if("confirmPivot"===t){if(l.querySelector("#nSheetErr").checked){var s=a.view.getSelectedSheets(i);d=!0}else{var h=JSUtil.Range.parseRange(r,o,E.value.trim());if(!h){var p=g["GoalSeek.Msg.InvalidCell"],S=[{text:g.OK,primary:!0,click:function(){E.value="",E.focus()}}],F={buttons:S,title:g["Alert.Title.InvalidCellRange"]};return u.ZSAlert(p,F),!1}this.tempModel[m.TARGET]=[h.sheetID,h.range.startRow,h.range.startCol,h.range.startRow,h.range.startCol]}l.querySelector("#err").style.display="none"}this.setGroupObj(),n(!1),UserAction.createPivot(r,s,o,this.tempModel,d,c)}},showAlertDialog:function(e){var t=[{text:g.OK,primary:!0}],i={buttons:t};u.ZSAlert(e,i)},setGroupObj:function(){for(var e=this.tempModel[f.ALL_FIELDS],t={},i=0;i<e.length;i++){var r=e[i],n=r[f.GROUP];if(void 0!==n){var l=r.colIndex;t[l.toString()]=n}}this.tempModel[f.GROUP]=t},createPivotinNewSheet:function(e){this.tempModel[m.TARGET]=[e,0,0,0,0],this.create()},toggleButton:function(e,t){t?(v.SP.isEditMode="false",l.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled")):(v.SP.isEditMode="true",l.querySelector("#createPivot").classList.remove("ui-button-disabled","ui-state-disabled"))},closeErrBanner:function(){E.value="";var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getVersionID(e);l.querySelector("#err").style.display="none";var r=a.data.getWorkBook(t,i).PivotCollection;r.remove("temp")},cancel:function(){this.closeErrBanner(),d.publish(c.UI,h.SidePanel.PIVOT.CLOSE)},reset:function(){for(var e=l.querySelector("#df ul").children,t=[],i=e.length,r=0;i>r;r++){var n=e[r];if(n){var o=n.getAttribute("content");t[r]=o}}for(var a=l.querySelector("#pB_allFields").children,s=0;s<a.length;s++){var d=a[s],c=d.textContent.trim(),h=this.getUsedField(c);h&&this.removeDroppedElement(h,c,!0);for(var r=0;r<t.length;r++){var o=t[r];o===c&&this.removeDroppedElement(f.DATA_FIELDS,o,!0)}}this.toggleButton("createPivot",!0)},constructDataMenu:function(){var t=document.querySelector("#dataDropDown");if(!t){var i=document.getElementById("popupmenu"),r=e.UserAction.getTemplate(["DataMenuTemplate"]),n=r.DataMenuTemplate,a=n.querySelector("#dataDropDown"),s=n.querySelector(".PvtDataClsBtn");s.addEventListener("click",this.pvtClosePopOver.bind(this),!1),i.appendChild(a),S.initComponent("#pvtFunctnOpt"),S.initComponent("#pvtShowDataOpt"),S.bind("#pvtFunctnOpt","zselectboxchange",function(e,t){var i=t.value,r=this.tempModel[f.FUNCTION],n="none",a=r[o];for(var s in a)n=a[s];var d={};d[i.toLowerCase()]=n,r[o]=d;var c=l.querySelector("#df ul").children[o],h=c.getAttribute("content"),u=JSUtil.fn.replaceParams(g["Pivot.UI.Datafield.Content."+i],new Array(h));"none"!=n&&(u="% "+u);var h=c.querySelector(".fldL");h.innerText=u,this.toggleButton("createPivot",!1)}.bind(this)),S.bind("#pvtShowDataOpt","zselectboxchange",function(e,t){var i=t.value,r=this.tempModel[f.FUNCTION],n=r[o];for(var a in n)var s=n[a];var d={};d[a]=i,r[o]=d;var c=l.querySelector("#df ul").children[o],h=c.getAttribute("content"),a=a.charAt(0).toUpperCase()+a.slice(1),u=JSUtil.fn.replaceParams(g["Pivot.UI.Datafield.Content."+a],new Array(h));"none"!=i&&(u="% "+u);var h=c.querySelector(".fldL");h.innerText=u,this.toggleButton("createPivot",!1)}.bind(this))}},pvtClosePopOver:function(){var e=l.querySelector("#df ul").children[o].querySelector(".pDrpdwn");UIUtil.Component.zpopover(e,"close")},constructDateMenu:function(){var e=document.querySelector("#dateDropDown");if(!e){var t,i,r=[g.None,g["Pivot.Submenu.Year"],g["Pivot.Submenu.Quarter"],g["Pivot.Submenu.Month"],g["Pivot.Submenu.Day"],g["Pivot.Submenu.Day.Week"],g["Pivot.Submenu.Quarter.Year"],g["Pivot.Submenu.Month.Year"]],n=document.getElementById("popupmenu"),l=document.createElement("ul");l.id="dateDropDown",l.setAttribute("data-ctype","zmenu"),l.setAttribute("relativeto","parent"),l.setAttribute("data-content-type","icon-text");for(var o=r.length,a=0;o>a;a++){var s=r[a],d=document.createElement("li"),c=a+1;d.id="gr"+c,d.textContent=s,d.setAttribute("data-item-type","checkbox"),l.appendChild(d)}n.appendChild(l),S.bind(l,"zmenushow",function(e,r){var n=r.target[0],l=n.parentNode;i=l.textContent.trim();for(var o,a=this.tempModel[f.ALL_FIELDS],s=0;s<a.length;s++){var d=a[s];"Td"===d.type&&d.content===i&&(o=d[f.GROUP])}t=void 0===o?"#gr1":"#gr"+(o+1),S.zmenu("#dateDropDown","setMenuItemsAttribute",[t],"checked",!0)}.bind(this)),S.bind(l,"zmenuhide",function(){t&&S.zmenu("#dateDropDown","setMenuItemsAttribute",[t],"checked",!1)}),S.bind(l,"zmenuitemclick",function(e,t){for(var r=t.data.id,n=r.substring(2)-1,l=this.tempModel[f.ALL_FIELDS],o=0;o<l.length;o++){var a=l[o];"Td"===a.type&&a.content===i&&(a[f.GROUP]=n)}this.toggleButton("createPivot",!1)}.bind(this))}},overwrite:function(){if(!l.querySelector("#overwrite").classList.contains("ui-button-disabled")){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getVersionID(e),r=a.view.getSelectedSheets(e),n=!1,o=!0;l.querySelector("#err").style.display="none",UserAction.createPivot(t,r,i,this.tempModel,n,o)}},handleError:function(e){var t=e.split("#"),i=t[0];if("Error.Pivot.Table.Overlaps.Create"===i||"Error.Pivot.Overwrite.Data"==i){n(!0,!0);var t=e.split("#"),i=t[0],r=t.slice(1,t.length),o=this.tempModel[m.TARGET],s=a.view.getActiveGridID(),d=a.view.getResourceID(s),c=a.view.getVersionID(s),h=a.data.getWorkBook(d,c),v=h.getSheetObj(o[0]),p=v.Prop.getName(),f=new u.Range(o[1],o[2],o[3],o[4]);r.length<1&&(r=p+"."+f.getLabel());var S,F;return"Error.Pivot.Table.Overlaps.Create"===i?(S=g["Error.Pivot.Table.Overlaps.Create"],F=g["Error.Pivot.Table.Overlaps.Header"],l.querySelector("#overwrite").style.display="none"):(S=g[i],F=g["Error.Pivot.Overwrite.Data.Header"],l.querySelector("#overwrite").style.display="block"),S=JSUtil.fn.replaceParams(S,new Array(r)),l.querySelector("#builder_err_msg").innerHTML=S,l.querySelector("#builder_err_msg_title").innerText=F,l.querySelector("#err").style.display="block",l.querySelector("#confirmPivot").classList.add("ui-button-disabled","ui-state-disabled"),this.eSheetShow(),!0}return!1},searchField:function(){for(var e=l.querySelector("#pvtSearchField").value.toLowerCase(),t=l.querySelector("#pB_allFields").children,i=0;i<t.length;i++){var r=t[i];r.style.display=-1===r.textContent.trim().toLowerCase().indexOf(e)?"none":"block"}},wipe:function(){this.wipeContainer("#pB_allFields"),this.wipeContainer("#pf ul,#rf ul,#cf ul,#df ul")},wipeContainer:function(e){var t=l.querySelectorAll(e);t.forEach(function(e){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild)})},construct:function(e){var t=a.view.getActiveGridID(),i=a.view.getResourceID(t),r=a.view.getVersionID(t);e||(e=u.Pivot.ID),v.SP||(v.SP={});var n=a.data.getWorkBook(i,r).PivotCollection.get(e);this.tempModel=JSON.parse(JSON.stringify(n)),this.usedFields=[],this.wipe(),this.allFields=this.tempModel[f.ALL_FIELDS],this.constructFieldList(),this.constructMainList(),this.bindElementEvent(),this.clearSelections(),F=0},constructMainList:function(){for(var e=l.querySelector("#pB_allFields"),t=this.tempModel.af,i=document.createDocumentFragment(),n=0;n<t.length;n++){var o=t[n],a=o.colIndex,s=o.content,d=o.type;if(-1!==a){o.i=n+1;var c=r("allFieldsTemplate").allFieldsTemplate,h=c.querySelector("li"),u=c.querySelector(".fldL");u.classList.add("txtOverflow");var v=c.querySelector(".fldIns");v.addEventListener("click",this.insertField.bind(this),!1),u.parentNode.children[0].className="fld"+d,u.innerText=s,this.isUsedField(a)&&(h.className+=" used-element"),i.appendChild(c)}}e.appendChild(i),this.toggleButton("createPivot",!0)},constructFieldList:function(){for(var e=[f.PAGE_FIELDS,f.ROW_FIELDS,f.COLUMN_FIELDS,f.DATA_FIELDS],t=this.tempModel[f.ALL_FIELDS],i=this.tempModel[f.FUNCTION],n=0;n<e.length;n++){var o=e[n],a=this.tempModel[o],s=l.querySelector("#"+o+" ul");if(a&&a.length>0)for(var d=0;d<a.length;d++){var c=a[d];if(-1===c){var h={content:"Values",colIndex:-1,type:"Tt"},u=document.createDocumentFragment(),v=r("fieldTemplate").fieldTemplate,p=v.querySelector("li"),m=v.querySelector(".fldRmv");m.addEventListener("click",this.removeField.bind(this),!1);var F=v.querySelector(".fldL");F.innerText=h.content,u.appendChild(p),s.appendChild(u),p.addEventListener("dragstart",this,!1),this.usedFields.push({content:h.content,colIndex:h.colIndex,field:o}),this.allFields.push(h)}else for(var E=0;E<t.length;E++){var D=t[E];if(c===D.colIndex){var y=D.content;if(o===f.DATA_FIELDS){var L,A=i[d];for(L in A)var b=A[L];var I=L.charAt(0).toUpperCase()+L.slice(1),y=JSUtil.fn.replaceParams(g["Pivot.UI.Datafield.Content."+I],new Array(D.content));"none"!=b&&(y="% "+y)}var u=document.createDocumentFragment(),v=r("fieldTemplate").fieldTemplate,p=v.querySelector("li");if("Td"===D.type){var C=v.querySelector(".pDrpdwn");C.style.visibility="visible",C.setAttribute("data-menu-id","dateDropDown")}else if(o===f.DATA_FIELDS){p.setAttribute("content",D.content);var C=v.querySelector(".pDrpdwn");C.style.visibility="visible",C.setAttribute("data-content","#dataDropDown"),C.setAttribute("data-is-content-html-encoded",!0),C.setAttribute("data-class-name","pvtBldrDataMenu"),S.zpopover(C),S.bind(C,"zpopoveropen",function(e,t){t.popover[0].style.zIndex=1e3}),S.bind(C,"zpopoverbeforeopen",this.updateDataMenuValues.bind(this))}p.addEventListener("dragover",this,!1),p.addEventListener("dragstart",this,!1),p.addEventListener("dragenter",this,!1);var m=v.querySelector(".fldRmv");m.addEventListener("click",this.removeField.bind(this),!1);var F=v.querySelector(".fldL");F.innerText=y,u.appendChild(p),s.appendChild(u),this.usedFields.push({content:D.content,colIndex:D.colIndex,field:o})}}}}},updateDataMenuValues:function(e){var t=e.target[0],i=t.parentNode.parentNode,r=t.parentNode.parentNode.parentNode,n=Array.prototype.slice.call(r.children),l=n.indexOf(i),a=this.tempModel[f.FUNCTION],s="Sum",d="none",c=a[l];for(s in c)d=c[s];o=l;var h=s.charAt(0).toUpperCase()+s.slice(1);S.zcombo("#pvtFunctnOpt","setValue",h),S.zcombo("#pvtShowDataOpt","setValue",d)},isUsedField:function(e){for(var t=[f.PAGE_FIELDS,f.ROW_FIELDS,f.COLUMN_FIELDS,f.DATA_FIELDS],i=!1,r=0;r<t.length;r++){var n=t[r],l=this.tempModel[n];if(l.indexOf(e)>-1){i=!0;break}}return i},getUsedField:function(e){for(var t=0;t<this.usedFields.length;t++){var i=this.usedFields[t];if(i.content===e&&i.field!==f.DATA_FIELDS)return i.field}return void 0},insertField:function(e){var t,i=e.target,r=i.parentNode.parentNode,n=r.textContent.trim(),o=this.getUsedField(n);if(o)if(this.tempModel[f.DATA_FIELDS].length>=5)this.showMaxFieldError("all",g["Error.Pivot.Field.Already.Exist.Please.Rearrange"]);else{var a=l.querySelector("#df ul"),s=a.children.length;this.addDataField(a,n,s)}else{var d=r.children[0].children[0];if(t=this.getDefaultField(d)){r.className+=" used-element";var a=l.querySelector("#"+t+" ul"),s=a.children.length;this.selection.sender="allFields",t===f.DATA_FIELDS?this.addDataField(a,n,s):this.addField(t,n,s)}}},removeField:function(e){var t,i=e.target,r=void 0,n=i.parentNode.parentNode,l=n.parentNode.parentNode,o=l.id;t=o===f.DATA_FIELDS?n.getAttribute("content"):n.textContent.trim(),o&&this.removeDroppedElement(o,t,!0,r)},addValuesField:function(){var e=f.COLUMN_FIELDS,t=l.querySelector("#"+e+" ul").children.length;if(t>=5){e=f.ROW_FIELDS;var t=l.querySelector("#"+e+" ul").children.length}if(t>=5)return!1;var i="Values";return this.addListElement(e,i,t),this.allFields.push({content:i,colIndex:-1,type:"Tt"}),this.addElementToUsedField(e,i,t),!0},addDataField:function(e,t,i){var r=f.DATA_FIELDS;return this.isMaxField(r)?!1:1!==this.getFieldLength(f.DATA_FIELDS)||this.addValuesField()?(this.addListElement(f.DATA_FIELDS,t,i),this.addElementToUsedField(f.DATA_FIELDS,t,i),!0):!1},addField:function(e,t,i){if(!this.isMaxField(e)){if(e===f.DATA_FIELDS){{l.querySelector("#"+f.DATA_FIELDS+" ul").children}if(1===this.getFieldLength(f.DATA_FIELDS)&&!this.addValuesField())return!1}("allFields"===this.selection.sender||this.selection.sender===f.DATA_FIELDS)&&(this.addListElement(e,t,i),this.addElementToUsedField(e,t,i))}},addListElement:function(e,t,i){var n,o=l.querySelector("#"+e+" ul"),a=this.getFieldType(t),s="";if(e===f.DATA_FIELDS){var d,c={},h=this.tempModel[f.FUNCTION];d="Tn"===a?"sum":"count",c[d]="none",h.splice(i,0,c),d=d.charAt(0).toUpperCase()+d.slice(1),s="data",n=t,t=JSUtil.fn.replaceParams(g["Pivot.UI.Datafield.Content."+d],new Array(t))}else"Td"===a&&(s="date");var u=document.createDocumentFragment(),v=r("fieldTemplate").fieldTemplate,p=v.querySelector(".pDrpdwn"),m=v.querySelector("li");e===f.DATA_FIELDS?(m.setAttribute("content",n),p.style.visibility="visible",p.setAttribute("data-content","#dataDropDown"),p.setAttribute("data-is-content-html-encoded",!0),S.zpopover(p),S.bind(p,"zpopoveropen",function(e,t){t.popover[0].style.zIndex=1e3}),S.bind(p,"zpopoverbeforeopen",this.updateDataMenuValues.bind(this))):"Td"===a&&(p.style.visibility="visible",p.setAttribute("data-menu-id","dateDropDown"));var F=v.querySelector(".fldRmv");F.addEventListener("click",this.removeField.bind(this),!1);var E=v.querySelector(".fldL");E.innerText=t,u.appendChild(v),m.addEventListener("dragstart",this,!1),m.addEventListener("dragover",this,!1),m.addEventListener("dragenter",this,!1);var D=o.querySelector(".dropPos");D?D.replaceWith(u):o.appendChild(u)},replacePlaceHolderWithElem:function(){if(this.selection.sender===f.DATA_FIELDS&&this.selection.receiver!=f.DATA_FIELDS){var e=this.selection.draggingField.getAttribute("content"),t=this.selection.draggingField.querySelector(".pDrpdwn");t.style.visibility="hidden",t.removeEventListener("click",this.showPivotBuilderDataMenu.bind(this));var i=this.selection.draggingField.querySelector(".fldL");i.innerText=e}var r=this.selection.receiver,n=l.querySelector("#"+r+" ul"),o=n.querySelector(".dropPos"),r=this.selection.receiver;o&&("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"),o.replaceWith(this.selection.draggingField))},addElementToUsedField:function(e,t,i){var r=this.getColIndex(t);this.usedFields.push({content:t,colIndex:r,field:e}),this.changeElementInFieldArray(r,i,e)},changeElementInFieldArray:function(e,t,i,r,n){this.usedFields.length>0?this.toggleButton("createPivot",!1):this.toggleButton("createPivot",!0);var l=void 0;if(r){var o=this.tempModel[r];if(void 0!==n&&n>-1&&r===f.DATA_FIELDS){o.splice(n,1);var a=this.tempModel[f.FUNCTION];l=a.splice(n,1)[0]}else for(var s=0;s<o.length;s++)if(o[s]===e){o.splice(s,1),r===f.DATA_FIELDS&&(a=this.tempModel[f.FUNCTION],l=a.splice(s,1)[0]);break}}if(i){var d=this.tempModel[i];d.splice(t,0,e),l&&i===f.DATA_FIELDS&&a.splice(t,0,l)}},removeALLDataField:function(){for(var e=l.querySelector("#"+f.DATA_FIELDS+" ul").children,t=e.length,i=0;t>i;i++){var r=e[0];this.removeDroppedElement(f.DATA_FIELDS,r.getAttribute("content"),!0)}},removeDroppedElement:function(e,t,i,r){this.removeListElement(e,t,r);var n=this.removeElementFromUsedField(e,t,i,r);i&&-1===n&&this.removeALLDataField()},removeListElement:function(e,t,i){var r,n=l.querySelector("#"+e+" ul").children,o=e===f.DATA_FIELDS;if(void 0!==i&&i>-1)r=n[i],"dropPos"===r.getAttribute("class")?(r=n[i+1],r.parentNode.removeChild(r)):r.parentNode.removeChild(r);else for(var a=0;a<n.length;a++){r=n[a];var s=o?r.getAttribute("content"):r.textContent.trim();s===t&&r.parentNode.removeChild(r)}if(o&&this.getFieldLength(f.DATA_FIELDS)<=1){var d=this.getUsedField("Values");d&&this.removeDroppedElement(d,"Values",!1)}},getFieldLength:function(e){for(var t=0,i=l.querySelector("#"+e+" ul").children,r=0;r<i.length;r++){var n=i[r];n.classList.contains("dropPos")||t++}return t},showMaxFieldError:function(e,t){l.querySelector(".errMaxFieldMsg").innerText=t,l.querySelector("#errMaxField").classList.add("showErr"),setTimeout(function(){l.querySelector("#errMaxField").classList.contains("showErr")&&l.querySelector("#errMaxField").classList.remove("showErr")},4e3)},hideMaxFieldError:function(){l.querySelector("#errMaxField").classList.contains("showErr")&&l.querySelector("#errMaxField").classList.remove("showErr")},removeElementFromUsedField:function(e,t,i,r){for(var n=-2,l=0;l<this.usedFields.length;l++){var o=this.usedFields[l];if(o.field===e&&o.content===t){n=o.colIndex,this.usedFields.splice(l,1);break}}return n>=-1&&this.changeElementInFieldArray(n,void 0,void 0,e,r),i&&-1!==n&&this.toggleAllFieldCheck(t,n,!1),n},toggleAllFieldCheck:function(e,t,i){if(!this.isUsedField(t))for(var r=l.querySelector("#pB_allFields").children,n=0;n<r.length;n++){var o=r[n];if(o.textContent.trim()===e){i?o.classList.add("used-element"):o.classList.remove("used-element");break}}},getFieldType:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content.trim()===e)return i.type}return"Tt"},isMaxField:function(e){if(this.getFieldLength(e)>=5){var t=g["Error.Pivot.Max.Field"];return this.showMaxFieldError(e,t),!0}return!1},unbindEvent:function(){for(var e=l.querySelector("#pB_allFields").children,t=0;t<e.length;t++){var i=e[t];i.removeEventListener("dragstart",this,!1)}for(var r=l.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul"),t=0;t<r.length;t++){var n=r[t];n.removeEventListener("dragenter",this,!1),n.removeEventListener("dragover",this,!1),n.removeEventListener("drop",this,!1),n.removeEventListener("dragend",this,!1)}},bindElementEvent:function(){var e=document.createElement("li");e.className="dropPos",this.placeholder.element=e;for(var t=l.querySelector("#pB_allFields").children,i=0;i<t.length;i++){var r=t[i];r.addEventListener("dragstart",this,!1)}for(var n=l.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul"),i=0;i<n.length;i++){var o=n[i];o.addEventListener("dragenter",this,!1),o.addEventListener("dragover",this,!1),o.addEventListener("drop",this,!1),o.addEventListener("dragleave",this,!1)}},handleEvent:function(e){var t=e.target.parentNode,i=e.target.nodeName;if("dragend"===e.type)this.pFieldDragEnd(e);else if("LI"===i){var r=t.id?t.id:t.parentNode.id;if("pB_allFields"===r)switch(e.type){case"dragstart":this.allField_dragstart(e)}else if("pf"===r||"rf"===r||"cf"===r||"df"===r)switch(e.type){case"dragstart":this.field_dragstart(e);break;case"dragenter":this.field_dragEnter(e);break;case"dragover":this.field_dragover(e);break;case"drop":this.fieldContainer_drop(e)}}else if("UL"===i)switch(e.type){case"dragenter":this.fieldContainer_dragEnter(e);break;case"dragover":this.fieldContainer_dragover(e);break;case"drop":this.fieldContainer_drop(e);break;case"dragend":this.fieldContainer_dropEnd(e);break;case"dragleave":this.fieldContainer_dragLeave(e)}else if("SPAN"===i)switch(e.type){case"dragenter":this.field_eventDPrevent(e);break;case"dragover":this.field_eventDPrevent(e);break;case"drop":this.fieldContainer_drop(e)}},pFieldDragEnd:function(){var e=this.selection.draggingField.textContent.trim();if(this.selection.sender===f.DATA_FIELDS&&(e=this.selection.draggingField.getAttribute("content")),this.selection.dropped){this.getUsedField(e)}else{var t=this.selection.sender;"allFields"!=t&&this.removeDroppedElement(t,e,!0)}for(var i=[f.PAGE_FIELDS,f.ROW_FIELDS,f.COLUMN_FIELDS,f.DATA_FIELDS],r=0;r<i.length;r++){var n=l.querySelector("#"+i[r]).children[0];n.contains(this.placeholder.element)&&n.removeChild(this.placeholder.element)}this.applyOrRemoveHoverClass(!1),document.body.removeEventListener("dragend",this,!1)},addSelection:function(e){if(this.selection.owner){if(this.selection.owner!=e.parentNode)return}else this.selection.owner=e.parentNode;this.selection.draggingField=e},clearSelections:function(){this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1}},allField_dragstart:function(e){var t=e.target;this.clearSelections(),this.addSelection(e.target),e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("text/html",this.outerHTML),this.selection.sender="allFields",this.selection.usedElement=t.classList.contains("used-element")?!0:!1,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},field_dragstart:function(e){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.outerHTML),e.stopImmediatePropagation();var t=e.target;this.clearSelections(),this.addSelection(t),this.selection.sender=t.parentNode.parentNode.id,this.selection.receiver=t.parentNode.parentNode.id,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},fieldContainer_dragEnter:function(e){e.preventDefault(),"UL"==e.target.nodeName&&(this.selection.receiver=e.target.parentNode.id,e.target.contains(this.placeholder.element)||e.target.appendChild(this.placeholder.element))},fieldContainer_dragover:function(e){e.preventDefault(),e.stopPropagation()},field_dragEnter:function(){event.preventDefault(),event.stopPropagation()},field_dragover:function(e){e.preventDefault(),e.stopPropagation();var t=e.target,i=this._index(this.placeholder.element),r=this._index(t);this.placeholder.position=i,"allFields"!=this.selection.sender&&"none"!==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="none"),r>i?this._after(t,this.placeholder.element):this._before(t,this.placeholder.element)},fieldContainer_drop:function(e){e.target.parentNode,e.target.nodeName;e.preventDefault(),e.stopPropagation(),this.checkAddField(),this.selection.dropped=!0},field_eventDPrevent:function(e){e.preventDefault()},fieldContainer_dragLeave:function(e){var t=e.target.parentNode.id,i=this.placeholder.parent;"pf"!==t&&"rf"!==t&&"cf"!==t&&"df"!==t||"pf"!==i&&"rf"!==i&&"cf"!==i&&"df"!==i||e.target.contains(this.placeholder.element)&&e.target.removeChild(this.placeholder.element)},checkAddField:function(){var e=this.selection.draggingField.textContent.trim();this.selection.sender===f.DATA_FIELDS&&(e=this.selection.draggingField.getAttribute("content"));var t=this.selection.receiver,i=l.querySelector("#"+t+" ul"),r=i.querySelector(".dropPos"),n=this._index(r),t=this.selection.receiver;if(this.isMaxField(t))return void("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"));if(this.selection.receiver===f.DATA_FIELDS)if(d=this.getColIndex(e),this.selection.draggingField.classList.contains("used-element")||(this.selection.draggingField.className+=" used-element"),this.selection.sender===f.DATA_FIELDS)this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(d,n,this.selection.sender,this.selection.sender);else{this.removeElementFromUsedField(this.selection.sender,e,!1);var o=l.querySelector("#df").children[0];o.contains(this.placeholder.element)&&o.removeChild(this.placeholder.element);var a=l.querySelector("#df ul");this.addDataField(a,e,n)}else if("allFields"===this.selection.sender)if(this.selection.usedElement){var s=this.getUsedField(e);s?s!==this.selection.receiver&&(this.removeDroppedElement(s,e,!1),this.addField(t,e,n)):this.addField(t,e,n)}else this.selection.draggingField.className+=" used-element",this.addField(t,e,n);else if(this.selection.sender===this.selection.receiver){var d=this.getColIndex(e);n>=0&&(this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(d,n,this.selection.sender,this.selection.sender))}else{this.removeElementFromUsedField(this.selection.sender,e,!1);var s=this.getUsedField(e);s&&this.removeDroppedElement(s,e,!1),this.replacePlaceHolderWithElem(),this.addElementToUsedField(t,e,n)}if(this.selection.sender===f.DATA_FIELDS&&1===this.getFieldLength(f.DATA_FIELDS)){var c=this.getUsedField("Values");c&&this.removeDroppedElement(c,"Values",!1)}},_index:function(e){return e.parentElement?Array.prototype.indexOf.call(e.parentElement.children,e):0},_before:function(e,t){e.parentElement.insertBefore(t,e)},_after:function(e,t){e.parentElement.insertBefore(t,e.nextElementSibling)},applyOrRemoveHoverClass:function(e,t,i){i=this.selection.draggingField.textContent.trim(),t=this.selection.sender;for(var r=[f.PAGE_FIELDS,f.ROW_FIELDS,f.COLUMN_FIELDS,f.DATA_FIELDS],n=0;n<r.length;n++){var o=r[n],a=5,s=l.querySelector("#"+o+" ul"),d=void 0;"allFields"===t&&i&&(d=this.getUsedField(i)),e&&d!==o&&(s.children.length<a||o===this.selection.sender)?s.classList.add("dragStart"):s.classList.remove("dragStart")}},getDefaultField:function(e){return e.classList.contains("fldTn")&&this.tempModel[f.DATA_FIELDS].length<5?f.DATA_FIELDS:e.classList.contains("fldTd")&&this.tempModel[f.ROW_FIELDS].length<5?f.ROW_FIELDS:this.getMinUsedField()},getColIndex:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content.trim()===e)return i.colIndex}return void 0},getMinUsedField:function(){var e=this.tempModel[f.ROW_FIELDS].length,t=this.tempModel[f.COLUMN_FIELDS].length;return 5>e||5>t?e>t?f.COLUMN_FIELDS:f.ROW_FIELDS:0===this.tempModel[f.DATA_FIELDS].length?f.DATA_FIELDS:this.tempModel[f.PAGE_FIELDS].length<5?f.PAGE_FIELDS:void 0},showPivotBuilderDataMenu:function(){var t=e.UserAction.getTemplate(["pivotBuilderDataMenuTemplate"]),r=e.UIUtil.Component,n=document.getElementById("DI_PIVOT_BUILDER_DATAMENU");if(!n){var l=document.createElement("div");l.id="DI_PIVOT_BUILDER_DATAMENU",l.appendChild(t.pivotBuilderDataMenuTemplate),document.body.appendChild(l)}for(var o=document.getElementsByClassName("pvtDataMenuBox"),a=0;a<o.length;a++)o[a].style.display="none";var s,d,c,h,u,v=event.target,p=v.parentNode.parentNode,m=p.parentNode,S=Array.prototype.slice.call(m.children),E=S.indexOf(p),D=p.children,y=l.querySelector("#pvtDataMenus");if(D.length<2){s=y.cloneNode(!0),s.removeAttribute("id");var L=s.getElementsByTagName("select"),h=L[0],u=L[1];F+=1,h.setAttribute("id","Data"+F),r.bind(h,"combochange",function(){var e=new Event("change");h.dispatchEvent(e)}),h.addEventListener("change",function(e){var t=e.target,i=t.parentNode.parentNode.parentNode.parentNode,r=i.parentNode,n=Array.prototype.slice.call(r.children),l=n.indexOf(i),o=e.target.value,a=this.tempModel[f.FUNCTION],s="none",d=a[l];for(var c in d)s=d[c];var h={};h[o.toLowerCase()]=s,a[l]=h;var u=i.getAttribute("content"),v=JSUtil.fn.replaceParams(g["Pivot.UI.Datafield.Content."+o],new Array(u));"none"!=s&&(v="% "+v);var u=i.querySelector(".fldL");u.innerText=v}.bind(this)),F+=1,u.setAttribute("id","Data"+F),r.bind(u,"combochange",function(e){var t=e.target,i=t.parentNode.parentNode.parentNode.parentNode,r=i.parentNode,n=Array.prototype.slice.call(r.children),l=n.indexOf(i),o=e.target.value,a=this.tempModel[f.FUNCTION],s=a[l];for(var d in s)_=s[d];var c={};c[d]=o,a[l]=c;var h=i.getAttribute("content"),u=d.charAt(0).toUpperCase()+d.slice(1),v=JSUtil.fn.replaceParams(g["Pivot.UI.Datafield.Content."+u],new Array(h));"none"!=o&&(v="% "+v);var h=i.querySelector(".fldL");h.innerText=v}.bind(this)),r.initComponent(s),p.appendChild(s)}d=p.children[1],c=p.offsetTop-(parseInt(y.style.height)+p.offsetHeight-5),d.style.top=c+"px",d.style.display="block";var A=this.tempModel[f.FUNCTION],b=E+(E+1),I="#Data"+b,C="#Data"+(b+1),T="Sum",_="none",P=A[E];for(T in P)_=P[T];var q=T.charAt(0).toUpperCase()+T.slice(1);d.querySelector(I).value=q,d.querySelector(C).value=_,r.zcombo(h,"refresh"),r.zcombo(u,"refresh"),setTimeout(function(){document.body.addEventListener("mousedown",i)},10)}},v.BuilderModel=t,d.register(c.Listener,h.UserAction.PIVOT.CHANGE_CREATEPIVOT_BUTTON,n,"setToGenerate","isDisable")}(this);
!function(t){function i(t){this.PivotPanel=t}var n=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,e=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC,ZSClass.Editors,ZSClass.Pivot);i.prototype={bindEvent:function(){var t=this.PivotPanel.querySelector("#pvtChrt");t.addEventListener("click",this.initPivotChart.bind(this))},initPivotChart:function(){n.view.Toolbar.Feature[s.CHART].execute(this,!0)}},e.Chart=i}(this);
!function(e){function t(e){this.PivotPanel=e}var i,a=e.sPlusPlus,s=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,ZSClass.Pivot),n=e.ZSConstants.CommandConstants,o=e.ZSConstants.PivotConstant;t.prototype={bindEvent:function(){var e=this.PivotPanel.querySelector("#explBtns"),t=e.children,a=this.PivotPanel.querySelector("#expSave"),s=this.PivotPanel.querySelector("#expCancel");t[0].addEventListener("click",this._editRange.bind(this)),s.addEventListener("click",this._cancelRange.bind(this)),a.addEventListener("click",this._saveRange.bind(this));var n=this.PivotPanel.querySelector("#expCellRef");this.PivotPanel.querySelector(".zsRangePicker").classList.add("zRDisable"),i=new ZSClass.Editors.RangeEditor(n),ZSClass.RangePicker.register(i,!0)},setValue:function(){var e=s.ID;"temp"==e?this.PivotPanel.querySelector("#expEdit").classList.add("disableHLink"):this.PivotPanel.querySelector("#expEdit").classList.remove("disableHLink");var t=a.view.getActiveGridID(),o=a.view.getResourceID(t),r=a.view.getVersionID(t),l=a.data.getWorkBook(o,r).PivotCollection.get(e),c=l[n.SOURCE],v=a.data.getWorkBook(o,r).getSheetObj(c[0]).Prop.Name;v=v?-1!==v.indexOf(" ")?"'"+v+"'":v:"";var g=new ZSClass.Range(c[1],c[2],c[3],c[4]);i.value=v+"."+g.getLabel()},_editRange:function(){s.SP.isEditMode="true",e.UserAction.Goto(i.value),this.PivotPanel.querySelector("#expSrc").classList.add("editRange"),this.PivotPanel.querySelector(".zsRangePicker").classList.remove("zRDisable"),this.PivotPanel.querySelector("#expCellRef").focus()},_cancelRange:function(){s.SP.isEditMode="false",this.setValue(),this.PivotPanel.querySelector("#expSrc").classList.remove("editRange"),this.PivotPanel.querySelector(".zsRangePicker").classList.add("zRDisable");var t=s.ID,i=a.view.getActiveGridID(),o=a.view.getResourceID(i),r=a.view.getVersionID(i),l=a.data.getWorkBook(o,r).PivotCollection.get(t),c=l[n.TARGET],v=new ZSClass.Range(c[1],c[2],c[1],c[2]);e.UserAction.gotoCell(o,c[0],r,v,c[1],c[2])},_saveRange:function(){var t=s.ID,r=a.view.getActiveGridID(),l=a.view.getResourceID(r),c=a.view.getVersionID(r),v=a.data.getWorkBook(l,c).PivotCollection.get(t),g=v[n.TARGET],d=new ZSClass.Range(g[1],g[2],g[1],g[2]);e.UserAction.gotoCell(l,g[0],c,d,g[1],g[2]),s.SP.isEditMode="false",this.PivotPanel.querySelector("#expSrc").classList.remove("editRange"),this.PivotPanel.querySelector(".zsRangePicker").classList.add("zRDisable");var P=v[n.SOURCE],S=JSUtil.Range.parseRange(l,c,i.value.trim()),u=!1;if(P[0]!==S.sheetID||P[1]!==S.range.startRow)u=!0;else if(P[2]!==S.range.startCol||P[4]!==S.range.endCol){for(var R=P[4],C=P[2],h=[o.PAGE_FIELDS,o.ROW_FIELDS,o.COLUMN_FIELDS,o.DATA_FIELDS],D=0;D<h.length;D++){var E=h[D],L=v[E];if(L&&L.length>0)for(var f=0;f<L.length;f++){var I=L[f];R>I&&(R=I),I>C&&(C=I)}}(R<S.range.startCol||C>S.range.endCol)&&(u=!0)}if(!u){v[n.SOURCE]=[S.sheetID,S.range.startRow,S.range.startCol,S.range.endRow,S.range.endCol];var k=a.view.getSelectedSheets(r);UserAction.changePivotSource(l,k,c,t,S.range,!1)}}},s.ChangeSource=t}(this);
!function(e){function t(e){this.PivotPanel=e,this.action="move"}function i(e){var t=a.getElementById("ZsAlertBtn");-1==e.path.indexOf(t)&&-1==e.path.indexOf(n)&&(ZSClass.RangePicker.isActiveOn(v)||o())}function o(){l.SP.isEditMode="false",v&&(v.value=""),n.querySelector("#nSheet").checked=!0,n.querySelector("#targetLoc").classList.add("pvtHide"),n.style.display="none",a.body.removeEventListener("mousedown",i,!1)}var n,s=e.sPlusPlus,a=(e.ZSConstants.FeatureConstants,e.document),r=e.ZSConstants.I18N,c=(e.ZSConstants.wCC,ZSClass.Editors),l=ZSClass.Pivot,v=(e.ZSConstants.CommandConstants,e.ZSConstants.PivotConstant,void 0);t.prototype={bindEvent:function(){var e=this.PivotPanel.querySelector("#pvtMove");e.addEventListener("click",this.popupDialog.bind(this));var t=this.PivotPanel.querySelector("#pvtCopy");t.addEventListener("click",this.popupDialog.bind(this)),this.construct()},popupDialog:function(e){l.SP.isEditMode="true";var t=(e.target.id,this.PivotPanel.querySelector(".pbMoveDlg")),o=a.getElementById("pvtCopy");e.path.indexOf(o)?(this.action="copy",t.classList.add("ptrChange")):(this.action="move",t.classList.remove("ptrChange")),t.style.display="block",a.body.addEventListener("mousedown",i,!1)},construct:function(){n=this.PivotPanel.querySelector(".pbMoveDlg");var t=e.UserAction.getTemplate(["pivotDestinationTemplate","pivotButtonTemplate"]),i=a.createDocumentFragment();i.appendChild(t.pivotDestinationTemplate),i.appendChild(t.pivotButtonTemplate),n.appendChild(i);var s=n.querySelector("#targetLoc");s.classList.add("moveTable"),n.querySelector("#confirmPivot").addEventListener("click",this.doAction.bind(this)),n.querySelector("#cancelPivot").addEventListener("click",o),n.querySelector("#nSheet").addEventListener("click",this.eSheetHide),n.querySelector("#eSheet").addEventListener("click",this.eSheetShow.bind(this));var r=n.querySelector("#pivotTargetCell");v=new c.RangeEditor(r,!0),ZSClass.RangePicker.register(v,!0,!0),v.addListeners({valueChanged:this.changeBtnStyle})},eSheetHide:function(){n.querySelector("#targetLoc").classList.add("pvtHide"),n.querySelector("#confirmPivot").classList.contains("zsDisable")&&n.querySelector("#confirmPivot").classList.remove("zsDisable")},eSheetShow:function(){this.changeBtnStyle(),n.querySelector("#targetLoc").classList.remove("pvtHide"),v.value="";var e=n.querySelector("#pivotTargetCell");e.focus()},changeBtnStyle:function(){v.value.trim().length>0?n.querySelector("#confirmPivot").classList.remove("zsDisable"):n.querySelector("#confirmPivot").classList.add("zsDisable")},doAction:function(){l.SP.isEditMode="false";var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSelectedSheets(e),a=s.view.getVersionID(e),c=ZSClass.Pivot.ID;if(n.querySelector("#nSheet").checked){"copy"===this.action?l.InsertSheetCallBack="COPY_PIVOT":"move"===this.action&&(l.InsertSheetCallBack="MOVE_PIVOT");var d=new ZSClass.Range(0,0,0,0);UserAction.movePivot(t,i,a,c,d,!1,!0,this.action)}else{"copy"===this.action?l.LastAction="SP_COPY":"move"===this.action&&(l.LastAction="SP_MOVE");var u=JSUtil.Range.parseRange(t,a,v.value.trim());if(!u){var h=r["GoalSeek.Msg.InvalidCell"],S=[{text:r.OK,primary:!0,click:function(){v.value="",v.focus()}}],p={buttons:S,title:r["Alert.Title.InvalidCellRange"]};return ZSClass.ZSAlert(h,p),!1}var y=[];y.push(u.sheetID),u&&UserAction.movePivot(t,y,a,c,u.range,!1,!1,this.action)}o()}},l.Move=t}(this);
!function(e){function t(e){this.PivotPanel=e}{var i=e.sPlusPlus,s=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,ZSClass.Pivot);e.document.getElementById("popupmenu"),e.jQuery,e.UIUtil.Component}t.prototype={bindEvent:function(){var e=this.PivotPanel.querySelector(".pvtRefBtn");e.addEventListener("click",this.selected.bind(this));var t=this.PivotPanel.querySelector("#ref");t.addEventListener("click",this.selected.bind(this));var i=this.PivotPanel.querySelector("#refAll");i.addEventListener("click",this.refreshPivot.bind(this))},selected:function(){this.refreshPivot(!0)},refreshPivot:function(e){var t=e&&e===!0?ZSClass.Pivot.ID:void 0,s=i.view.getActiveGridID(),n=i.view.getResourceID(s),o=i.view.getSelectedSheets(s),r=i.view.getVersionID(s);UserAction.refreshPivot(n,o,r,t)}},s.Refresh=t}(this);
!function(t){function e(){var t=s["Pivot.UI.Delete.Confirm"],e=[{text:s.Yes,primary:!0,click:function(){i()}},{text:s.No}],n={buttons:e,title:s["Alert.Title.PivotTableDelete"]};ZSClass.ZSAlert(t,n)}function i(){var t=o.view.getActiveGridID(),e=o.view.getResourceID(t),i=o.view.getVersionID(t),n=o.view.getSelectedSheets(t);UserAction.deletePivot(e,n,i,r.currentPivotId)}function n(t){this.PivotPanel=t}var o=t.sPlusPlus,s=(t.ZSConstants.FeatureConstants,t.document,t.ZSConstants.I18N),r=(t.ZSConstants.wCC,ZSClass.Pivot);n.prototype={bindEvent:function(){var t=this.PivotPanel.querySelector("#pvtDelete");t.addEventListener("click",e)}},r.Delete=n,r.pivotDeleteConfirmation=e}(this);
!function(e){function t(e){this.PivotPanel=e}var i=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,a=e.ZSConstants.PivotConstant,l=e.document,r=(e.ZSConstants.I18N,e.ZSConstants.wCC,i.view.Toolbar.Feature[o.PIVOT_STYLES],ZSClass.Pivot),s=e.UIUtil.Component;t.prototype={init:function(){this.constructCSchemeMenu();var e=this.PivotPanel.querySelector("#prev");e.addEventListener("click",this.slideTheme.bind(this));var t=this.PivotPanel.querySelector("#next");t.addEventListener("click",this.slideTheme.bind(this));var i=this.PivotPanel.querySelector("#pvtThemeContainer").querySelectorAll("ul");i.forEach(function(e){for(var t=e.children,i=0;i<t.length;i++){var o=t[i];o.addEventListener("click",this.changeTheme.bind(this),!1)}}.bind(this))},constructCSchemeMenu:function(){var t=l.getElementById("popupmenu"),i=e.UserAction.getTemplate(["pivotColorSchemeTemplate"]),o=i.pivotColorSchemeTemplate,a=o.querySelector("#pivotColorpaletteContainer");t.appendChild(a);var r=this.PivotPanel.querySelector("#pivotColorPalette");s.zpopover(r),s.bind(r,"zpopoverbeforeopen",this.updateColorPalette.bind(this));var n=l.getElementById("pvtCPaletteClose");n.addEventListener("click",this.pvtCSThemeClosePopOver.bind(this),!1),s.bind("ul#pvtColorPaletteHolder > li > .wid100","click",function(e){var t=e.target.parentElement,i=t.dataset,o=i.basecolor,a=i.name.split("-")[3].replace("THEME",""),r=this.pivotStyleID.split("_")[0],s=this.pivotStyleID.split("_")[1];if(r!==a){for(var n=l.querySelector("#pvtColorPaletteHolder").childNodes,c=0;c<n.length;c++){var v=n[c];if("LI"===v.nodeName&&v.className.contains("active")){v.classList.remove("active");var h=v.dataset.name.split("-")[3].replace("THEME","");break}}var p=new ZSChart.Utility.SheetChartColor(JSON.parse(o)),d=p.generateLinearGradient();this.PivotPanel.querySelector("#pivotColorPalette").style["background-image"]=d,t.classList.add("active"),this.pivotStyleID=a+"_"+s,this.PivotPanel.querySelector("#pvtThemeContainer").classList.contains("cScheme"+h)&&this.PivotPanel.querySelector("#pvtThemeContainer").classList.remove("cScheme"+h),this.PivotPanel.querySelector("#pvtThemeContainer").classList.add("cScheme"+a),this.changePivotStyle()}}.bind(this))},pvtCSThemeClosePopOver:function(){var e=this.PivotPanel.querySelector("#pivotColorPalette");s.zpopover(e,"close")},updateColorPalette:function(){for(var e=this.pivotStyleID.split("_")[0],t=l.querySelector("#pvtColorPaletteHolder").childNodes,i=0;i<t.length;i++){var o=t[i];if("LI"===o.nodeName&&o.dataset.name.split("-")[3].replace("THEME","")===e){o.classList.add("active");break}}},selectColorPalette:function(e){var t=e.target,i=e.target.dataset,o=i.name.split("-")[3].replace("THEME",""),a=this.pivotStyleID.split("_")[0],l=this.pivotStyleID.split("_")[1];if(a!==o){var r=this.PivotPanel.querySelectorAll("ul.cPaletteCode > li");r.forEach(function(e){e.className.contains("active")&&e.classList.remove("active")}),t.classList.add("active"),this.pivotStyleID=o+"_"+l,this.PivotPanel.querySelector("#pvtThemeContainer")[0].classList.add("cScheme"+o),this.changePivotStyle()}},slideTheme:function(e){var t,i=e.target.id,o=this.PivotPanel.querySelector("#pvtThemeContainer").querySelectorAll("input");o.forEach(function(e){e.checked&&(t=parseInt(e.id.substr(4)))});var a;a="prev"===i?1==t?5:t-1:5==t?1:t+1,this.PivotPanel.querySelector("#pvtThemeContainer").querySelector("#them"+a).checked=!0},setValue:function(){this.resetValue();var e=r.ID,t=i.view.getActiveGridID(),o=i.view.getResourceID(t),s=i.view.getVersionID(t),n=i.data.getWorkBook(o,s).PivotCollection.get(e),c=n[a.PIVOTTEMPLATE_ID];if(c.contains("_"))var v=c.split("_")[0],h=c.split("_")[1];else{c="0_"+c;var v=0,h=c.split("_")[1]}var p=l.getElementById(h);p.classList.add("active");var d=h.split("tc")[0];if(this.pivotStyleID=c,this.PivotPanel.querySelector("#pvtThemeContainer").querySelector("#them"+d).checked=!0,this.PivotPanel.querySelector("#pivotColorPalette")){v=0==v?1:v,this.PivotPanel.querySelector("#pvtThemeContainer").classList.add("cScheme"+v);for(var S=l.querySelector("#pvtColorPaletteHolder").childNodes,P=0;P<S.length;P++){var u=S[P];if("LI"===u.nodeName){var y=u.dataset.name.split("-")[3].replace("THEME","");if(v===y){var m=u.dataset.basecolor,C=new ZSChart.Utility.SheetChartColor(JSON.parse(m)),I=C.generateLinearGradient();this.PivotPanel.querySelector("#pivotColorPalette").style["background-image"]=I;break}}}}},resetValue:function(){if(this.pivotStyleID){if(this.pivotStyleID.contains("_"))var e=this.pivotStyleID.split("_")[0],t=this.pivotStyleID.split("_")[1];else var e=0,t=this.pivotStyleID.split("_")[1];var i=l.getElementById(t);if(i.classList.remove("active"),this.PivotPanel.querySelector("#pivotColorPalette")){e=0==e?1:e,this.PivotPanel.querySelector("#pvtThemeContainer").classList.remove("cScheme"+e);for(var o=l.querySelector("#pvtColorPaletteHolder").childNodes,a=0;a<o.length;a++){var r=o[a];if("LI"===r.nodeName&&r.className.contains("active")){r.classList.remove("active");break}}}}},changeTheme:function(e){for(var t,i=0;4>i&&(t=e.path[i],"LI"!==t.tagName);i++);var o=t.id,a=this.pivotStyleID.split("_")[0],r=this.pivotStyleID.split("_")[1];if(r!==o){var s=l.getElementById(r);s.classList.remove("active"),this.pivotStyleID=a+"_"+o;var n=l.getElementById(o);n.classList.add("active"),this.changePivotStyle()}},changePivotStyle:function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),o=i.view.getSelectedSheets(e),l=i.view.getVersionID(e),r=ZSClass.Pivot.ID,s=i.data.getWorkBook(t,l).PivotCollection.get(r);s[a.PIVOTTEMPLATE_ID]=this.pivotStyleID;var n=0,c=this.pivotStyleID.split("_")[1],v=c.split("tc")[0],h=c.split("tc")[1];this.PivotPanel.querySelector("#pivotColorPalette")&&(n=this.pivotStyleID.split("_")[0]),UserAction.changePivotStyle(t,o,l,r,n,v,h)}},r.Style=t}(this);
!function(t){function e(t){this.PivotPanel=t}{var n=t.sPlusPlus,o=t.ZSConstants.FeatureConstants,i=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC,n.view.Toolbar.Feature[o.PIVOT_TOTALS],t.UIUtil.Component,ZSClass.Pivot);t.ZSConstants.PivotConstant}e.prototype={bindEvent:function(){var t=this.PivotPanel.querySelectorAll('input[type="checkbox"]');t.forEach(function(t){t.addEventListener("change",this._changeOption)}.bind(this))},setValue:function(){var t=ZSClass.Pivot.ID,e=n.view.getActiveGridID(),o=n.view.getResourceID(e),i=n.view.getVersionID(e),s=n.data.getWorkBook(o,i).PivotCollection.get(t),a=this.PivotPanel.querySelectorAll('input[type="checkbox"]');a.forEach(function(t){t.checked=s[t.id]?!0:!1})},_changeOption:function(t){var e=t.target.id,o=t.target.checked,i=n.view.getActiveGridID(),s=n.view.getResourceID(i),a=n.view.getSelectedSheets(i),c=n.view.getVersionID(i),r=ZSClass.Pivot.ID;UserAction.changeTotalOption(s,a,c,r,e,o)}},i.TotalController=e}(this);
!function(t){function e(t,e){var a=e.action;"CREATE"==a?c.openDialog(!0):c.openSidePanel(t)}var a=t.sPlusPlus,n=t.ZSConstants,s=n.FeatureConstants,o=t.ZSConstants.wCC,i=t.ZSEvents,l=t.UIUtil.Component,r=t.document.getElementById("popupmenu"),u=a.data.Defaults,S=(u.MAX_COL,t.JSUtil),E=(S.Math,i.topic,i.Groups,i.Names,t.ZSConstants.I18N),c=a.view.Toolbar.Feature[s.SPARKLINE],p={id:o.SUBMENUITEM+s.SPARKLINE+o.IDENTITY,mtype:"submenu",data:'{"componentOptions":{"label":"'+E["MenuTab.Tab.Sparkline"]+'","type":"text_only"}}',relativeto:"parent"},I=[{data:'{"label":"'+E["MenuTab.Tab.Sparkline.Create"]+'", "action": "CREATE"}'},{data:'{"label":"'+E["MenuTab.Tab.Sparkline.Edit"]+'", "action": "EDIT"}',id:"sPsplitEditButton"}];a.view.Menu.create(I,p,r).then(function(){l.bind("#"+o.SUBMENUITEM+s.SPARKLINE+o.IDENTITY,"zmenuitemclick",function(t,a){var n=a.data;e(t,n)})})}(this),function(t){function e(){var t=a.view.getActiveGridID(),e=a.view.getResourceID(t),n=a.view.getSheetID(t),s=a.view.getVersionID(t),o=(a.view.getSelectedSheets(t),a.view.getSheetState(t,n)),i=o.getActiveCellRange(),r=a.data.getWorkBook(e,s).getSheetObj(n),S=(u.hash(i.startRow,i.startCol,l),r.sparklines.groupranges.getInfo(i.startRow,i.startCol)),E=document.querySelector("#sPsplitEditButton");E&&(S?E.classList.remove("sPDisable"):E.classList.add("sPDisable"))}{var a=t.sPlusPlus,n=t.ZSConstants,s=n.FeatureConstants,o=(t.ZSConstants.wCC,t.ZSEvents),i=(t.document.getElementById("popupmenu"),a.data.Defaults),l=i.MAX_COL,r=t.JSUtil,u=r.Math,S=o.topic,E=o.Groups,c=o.Names;a.view.Toolbar.Feature[s.SPARKLINE]}S.register(E.Listener,c.SheetAction.ACTIVE_CELL.INFO,e,"RID","SHEETID","VERSION","ROW","COLUMN")}(this);
!function(e){function t(e,t){S.closeDialog();var a=UserAction.getTemplate(["STATUS_ALERT"]),i=a.STATUS_ALERT;i.querySelector("#msg").innerText=r["SaveAsTemplate.SuccessMsg"];var n=i.querySelector("#fileLink");n.href=s.data.AppRegistry.ctxpath+s.data.AppRegistry.ClientURI+t,n.innerText=e,n.title=e,ZSClass.ZSAlert(i,{type:"success",title:r["Alert.Title.TemplateSaved"],isHtml:!0,buttons:[{text:r.Close}]})}var s=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,r=ZSConstants.I18N,i=e.ZSEvents,n=i.topic,l=i.Groups,o=i.Names,S=s.view.Toolbar.Feature[a.SAVE_AS_TEMPLATE];n.register(l.Listener,o.UserAction.SaveAsTemplateResponse,t,"NEWDOCNAME","NEWDOCRID")}(this);
!function(t){function n(n,e,u,o,s,i,c){var S=a.view.getActiveGridID(),r=(a.view.getSheetState(S,u),a.view.getSelectedSheets(S));t.UserAction.aggregateFunctions(e,r,o,s,i,c)}function e(t,e,u,o){if(!t.repeat){var s=ZSConstants.Function.functions,i=s.SUM[0],c=s.SUBTOTAL[0],a="109,";n(t,e,u,o,i,c,a)}}function u(t,e,u,o){var s=ZSConstants.Function.functions,i=s.AVERAGE[0],c=s.SUBTOTAL[0],a="101,";n(t,e,u,o,i,c,a)}function o(t,e,u,o){var s=ZSConstants.Function.functions,i=s.COUNTA[0],c=s.SUBTOTAL[0],a="102,";n(t,e,u,o,i,c,a)}function s(t,e,u,o){var s=ZSConstants.Function.functions,i=s.COUNT[0],c=s.SUBTOTAL[0],a="103,";n(t,e,u,o,i,c,a)}function i(t,e,u,o){var s=ZSConstants.Function.functions,i=s.MAX[0],c=s.SUBTOTAL[0],a="104,";n(t,e,u,o,i,c,a)}function c(t,e,u,o){var s=ZSConstants.Function.functions,i=s.MIN[0],c=s.SUBTOTAL[0],a="105,";n(t,e,u,o,i,c,a)}var a=t.sPlusPlus,S=t.ZSConstants.FeatureConstants,r=t.ZSEvents,T=(r.topic,r.Groups,r.Names,a.view.Toolbar.Feature[S.AUTOSUM]);T.executeSum=e,T.executeAverage=u,T.executeCount=o,T.executeCountNumber=s,T.executeMax=i,T.executeMin=c}(this);
!function(e){function t(t){i||(i=o(r["MenuItem.FileTab.Downloading"],"STD","info"));var n=s.view.getActiveGridID(),a=s.view.getResourceID(n),c=s.view.getVersionID(n),u=s.view.getSheetID(n),l=s.data.getWorkBook(a,c),I=l.getSheetObj(u),w=I.Prop.getName(),g=s.data.Defaults.version===c?"":"&version="+c,C="https://"+v.DOCS_SERVER_URL+"/downloaddoc.do?docId="+a+"&docExtn="+t+g;if("csv"!=t&&"tsv"!=t){var D=d.createElement("iframe");D.src=C,D.addEventListener("load",function(){}),D.addEventListener("error",function(){});var E=d.body;E.appendChild(D)}else C+="&skipL7Check=true",e.UserAction.downloadAs(a,c,w,"."+t,C)}function o(e,t,o){var n={mode:t,type:o,showCloseBtn:!1};return new ZSClass.TBNotification(e,n)}function n(e){if(e.id==w.TB+"FILE"+w.POPUP+w.CONTAINER){var t=s.view.getActiveGridID(),o=s.view.getResourceID(t),n=s.view.getVersionID(t),i=(s.view.getSheetID(t),s.data.getWorkBook(o,n)),a=i.allowExport;a||g.disable(C.menuElem)}}var i,s=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,r=e.ZSConstants.I18N,d=e.document,v=s.data.AppRegistry,c=e.ZSEvents,u=c.topic,l=c.Groups,I=c.Names,w=e.ZSConstants.wCC,g=e.UIUtil.Component,C=s.view.Toolbar.Feature[a.EXPORT];u.register(l.UI,I.Toolbar.INIT_MENU,n,"DOM"),C.execute=t}(this);
!function(e){function t(e,t){var s=t.action;switch(s){case c.ACTION_VIEW_MACRO:n.publish(i.UserAction,r.UserAction.MACRO.VIEW_MACRO);break;case c.ACTION_VBA_EDITOR:n.publish(i.UserAction,r.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros"});break;case c.ACTION_MACRO_HELP:window.open(a.VBA_PROGRAMMING)}}var s=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,a=(e.document,s.view.Toolbar.Feature[o.MACRO]),A=(e.UIUtil.Component,e.ZSEvents),n=A.topic,i=A.Groups,r=A.Names,a=s.data.AppRegistry.MACRO,c=s.view.Toolbar.Feature[o.MACRO];c.execute=t}(this);
!function(e){function t(){this.isLocked=!1,this.removeUserProfile=!1}var i=e.UserAction;t.prototype={pauseCollaboration:function(e,t,i){this.isLocked=e,this.lockedBy=t,this.lockedByZuid=i},isSpreadsheetLocked:function(){return this.isLocked},getLockedBy:function(){return this.lockedBy},getLockedByZuid:function(){return this.lockedByZuid},setRemoveUserProfile:function(e){this.removeUserProfile=e},getRemoveUserProfile:function(){return this.removeUserProfile}},i.CollaborationNotifier=new t}(this),function(e){function t(e){if(S.parent==e){var t=h.view.getActiveGridID(),o=h.view.getResourceID(t);if(i(o)||n(o)){E.zmenu("#"+S.parent.id,"setMenuItemsAttribute",["#"+y.MI+f.CHECKIN_CHECKOUT+y.MENU],"hidden",!1);var r=k.isSpreadsheetLocked()?O["MenuItem.FileTab.CheckIn"]:O["MenuItem.FileTab.CheckOut"];E.zmenu("#"+S.parent.id,"setMenuItemsAttribute",["#"+y.MI+f.CHECKIN_CHECKOUT+y.MENU],"label",r)}else E.zmenu("#"+S.parent.id,"setMenuItemsAttribute",["#"+y.MI+f.CHECKIN_CHECKOUT+y.MENU],"hidden",!0)}}function i(e){return h.data.getSharePublishMeta(e).isShared()}function n(e){return h.data.getSharePublishMeta(e).isPublished()}function o(e,t){var i=h.view.getActiveGridID(),n=h.view.getResourceID(i),o=h.view.getVersionID(i),r=k.isSpreadsheetLocked()?T.CHECKIN_SPREADSHEET:T.CHECKOUT_SPREADSHEET;UserAction.checkinCheckoutSpreadsheet(n,o,r,e,t)}function r(e){e.disabled=!0,e.classList.add("ZsRt");var t=document.createElement("span");t.id="loader",e.appendChild(t),o(s,e)}function s(e,t){t.disabled=!1,t.classList.remove("ZsRt"),E.zpopover(P,"close");e.action,e.result}function c(e,t,i){C&&"STD"===C.mode&&C.remove();var n={mode:t,type:i,showCloseBtn:!0};C=new v.TBNotification(e,n),C.show()}function a(e,t,i,n){if("RESOURCE_LOCKED"==e)if(t==h.data.UserInfo.zuid){var o=O["Checkin.CheckoutBanner"];c(o,"STD","success")}else if(n){var o=JSUtil.fn.replaceParams(O["Checkin.CheckoutBannerForSharedUser"],[i]);c(o,"STD","warning")}else{var r=[{text:O["Checkin.reloadButton"],primary:!0,click:function(){document.location.reload(!0)}}],s={countDown:15,buttons:r,title:O["Alert.Title.FileLocked"]},o=JSUtil.fn.replaceParams(O["Checkin.dialog.CheckOut"],[i]);k.setRemoveUserProfile(!0),v.ZSAlert(o,s)}else if(t==h.data.UserInfo.zuid){var o=O["Checkin.CheckinBanner"];c(o,"DYN","success")}else{var r=[{text:O["Checkin.reloadButton"],primary:!0,click:function(){document.location.reload(!0)}}],s={countDown:15,buttons:r,title:O["Alert.Title.FileUnlocked"]},o=JSUtil.fn.replaceParams(O["Checkin.dialog.CheckIn"],[i]);k.setRemoveUserProfile(!0),v.ZSAlert(o,s)}}function u(e,t){var i=h.data.getSharePublishMeta(e).isPublished(),n=h.data.getSharePublishMeta(e).isShared();d||(d=t.querySelector("#pop_checkinOutBox")),d.style.display=i||n?"":"none",(i||n)&&(t.querySelector("#header").innerText=O["Checkout.LiveSheet"],k.isSpreadsheetLocked()?(t.querySelector("#action").innerText=O["Checkout.On"],t.querySelector("#content").innerText=O["Checkout.TurnOff"]):(t.querySelector("#action").innerText=O["Checkout.Off"],t.querySelector("#content").innerText=O["Checkout.TurnOn"]))}function l(e,t,i,n){k.pauseCollaboration(e,t,i),a(e?"RESOURCE_LOCKED":"RESOURCE_UNLOCKED",i,t,n)}var d,C,h=e.sPlusPlus,f=e.ZSConstants.FeatureConstants,S=h.view.Toolbar.Feature[f.CHECKIN_CHECKOUT],k=UserAction.CollaborationNotifier,E=e.UIUtil.Component,U=e.ZSEvents,v=e.ZSClass,m=U.topic,I=U.Groups,p=U.Names,T=e.ZSConstants.ActionConstants,O=e.ZSConstants.I18N,P=document.querySelector("#TB_SHARE_BTN"),b=e.ZSConstants,y=b.wCC;m.register(I.Listener,p.DocMeta.LOCKED_INFO,l,"isLocked","lockedBy","lockedByZuid","isInitialFetch"),m.register(I.UI,p.Menu.SHARE_POPUP_OPEN,u,"RID","DOM"),m.register(I.UI,p.Toolbar.INIT_MENU,t,"DOM"),S.execute=r,S.executeAction=o}(this);
!function(e){function t(e){var t=document.createElement("li");t.setAttribute("id","invite"),t.setAttribute("data",'{"label":"'+g.Invite+'"}'),t.addEventListener("click",function(){D.openDialog()}),e.appendChild(t),f.createMenuElement(e),y.createMenuElement(e)}function n(e){return A.data.getSharePublishMeta(e).isShared()}function i(e){if(D.parent==e){var t=A.view.getActiveGridID(),i=A.view.getResourceID(t);n(i)?(P.zmenu("#"+D.parent.id,"setMenuItemsAttribute",["#"+_.MI+U.SHARE+_.MENU],"hidden",!0),P.zmenu("#"+D.parent.id,"setMenuItemsAttribute",["#"+_.MI+U.SHARE+"_SUBMENU"+_.MENU],"hidden",!1)):(P.zmenu("#"+D.parent.id,"setMenuItemsAttribute",["#"+_.MI+U.SHARE+_.MENU],"hidden",!1),P.zmenu("#"+D.parent.id,"setMenuItemsAttribute",["#"+_.MI+U.SHARE+"_SUBMENU"+_.MENU],"hidden",!0))}}function r(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),i=document.getElementById(_.MI+U.NOTIFY_COLLABORATOR+_.MENU);i.style.display=n(t)?"block":"none";var r=document.getElementById(_.MI+T.COLLAB_CHAT+_.MENU);r.style.display=n(t)?"block":"none";var o=A.data.UserInfo.Permission.isSharable,a=document.getElementById("invite");a.style.display=o?"block":"none"}function o(){if(!I){var e=document.getElementById("popupmenu"),t=document.createElement("ul");t.id="sharePublishMenu",t.className="sharePub wid",a(t),N&&N.createElement(t),C&&C.createElement(t),I=document.createElement("div"),I.id="sharePublishPopOver",I.appendChild(t),e.appendChild(I),c()}}function a(e){var t=UserAction.getTemplate(["SHARE_POPUP_TEMPLATE"]),n=t.SHARE_POPUP_TEMPLATE,i=n.querySelector("#zspopup_shareMsg");A.data.UserInfo.Permission.isSharable||(i.innerText=g["TopBar.Shared"]),s(n),e.appendChild(n),S=e.querySelector("#popup_shareOptions")}function s(e){L=e.querySelector("#pop_invite");var t=e.querySelector("#pop_notify"),n=e.querySelector("#pop_chat");L.addEventListener("click",function(){u(),P.zpopover(v,"close")}),t.addEventListener("click",function(){f.execute(),P.zpopover(v,"close")}),n.addEventListener("click",function(){R.publish(b.UI,O.SidePanel.Chat.open),P.zpopover(v,"close")})}function u(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),n=A.view.getVersionID(e),i=A.data.DocRegistry[t].isNewDoc;i?UserAction.changeDocStatus(t,n,i,D.openDialog):D.openDialog()}function c(){v=document.querySelector("#TB_SHARE_BTN"),v.setAttribute("data-content","#sharePublishPopOver"),v.setAttribute("data-is-content-html-encoded",!0),P.zpopover(v),P.bind(v,"zpopoverbeforeopen",function(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e);d(t),R.publish(b.UI,O.Menu.SHARE_POPUP_OPEN,{RID:t,DOM:I})})}function d(e){var t=n(e);S.style.display=t?"":"none",L.style.display=A.data.UserInfo.Permission.isSharable?"":"none"}function l(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),n=A.data.getSharePublishMeta(t);if(n){var i,r=document.querySelector("#PUBLISH_SHARE_ICON"),o=n.getShareMeta(),a=n.getPublishMeta(),s=o.getType(),u=a.getType();i="personal"===s?"external"==u?G:"org"==u?q:z:"external"===u?F:"org"===u?k:w,i&&(r.innerHTML="",m.fn.addIcon(r,i),r.style.display="")}}function E(){P.zpopover(v,"close")}function p(e){var t=e.RESOURCE_ID,n=A.data.getSharePublishMeta(t);if(n){var i=e.ACTION,r=JSON.parse(e.ACTION_INFO),o=r.SHARED_TO,a=n.getShareMeta(),s=a.getSharedUserInfo().get();switch(i){case"RESOURCE_SHARED":var u=A.view.getActiveGridID(),c=A.view.getVersionID(u);h.getNewlyAddedUserDetails(t,c,o);break;case"RESOURCE_UNSHARED":for(var d in s){var l=s[d];if(l.id==o){s.splice(d,1);break}}R.publish(b.Listener,O.DocAction.COLLAB_LIST.REMOVE,{ID:o})}}}var I,v,S,A=e.sPlusPlus,T=e.ZSConstants,m=e.UIUtil,_=T.wCC,U=T.FeatureConstants,g=T.I18N,h=(T.CommandConstants,e.UserAction),M=e.ZSEvents,R=M.topic,b=M.Groups,O=M.Names,P=m.Component,D=(A.data.UserInfo.Permission,A.view.Toolbar.Feature[U.SHARE]),N=A.view.Toolbar.Feature[U.PUBLISH],C=A.view.Toolbar.Feature[U.CHECKIN_CHECKOUT],f=A.view.Toolbar.Feature[U.NOTIFY_COLLABORATOR],y=A.view.Toolbar.Feature[U.COLLAB_CHAT],B=(document.querySelector("#TB_SHARE_BTN"),document.getElementById("popupmenu")),H=!1;!function(){var e=document.createElement("ul");e.id=_.SUBMENUITEM+U.SHARE+_.IDENTITY,e.setAttribute("data-ctype","zmenu"),H||(t(e),B.appendChild(e),P.bind(e,"zmenubeforeshow",function(){r()}),H=!0)}();var L,w="TB_SHARE_ICON",z="TB_SHARED_ICON",k="TB_INTPUB_ICON",F="TB_EXTPUB_ICON",q="TB_SHARE_INTPUB_ICON",G="TB_SHARE_EXTPUB_ICON";R.register(b.Listener,O.Browser.RESIZE,E),R.register(b.UI,O.Toolbar.INIT_MENU,i,"DOM"),R.register(b.Listener,O.WMSAction.ON_SHARE,l,"ISSHARED"),R.register(b.Listener,O.ShareMeta.PUBLISH_UPDATE,l,"ISSHARED"),R.register(b.Listener,O.DocAction.Collaborators.UPDATE,p,"MSG"),R.register(b.UI,O.Layout.TEMPLATE_LOADED,l),D.execute=o}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,a=(n.topic,n.Groups,n.Names,e.ZSConstants.FeatureConstants),i=e.document,s=(e.UserAction,e.ZSConstants.wCC),o=e.UIUtil.Component,u=i.getElementById("popupmenu"),c=t.view.Toolbar.Feature[a.DELUGE_EDITOR],l=t.view.Toolbar.Feature[a.CREATE_MACRO],r={id:s.SUBMENUITEM+a.CREATE_MACRO+s.IDENTITY,ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}'},E=[{data:'{"label": "Using VBA"}'},{mtype:"separator"},{data:'{"label": "Using Deluge"}'}];t.view.Menu.create(E,r,u).then(function(){o.bind("#"+s.SUBMENUITEM+a.CREATE_MACRO+s.IDENTITY,"menuitemclicked",function(e,n){{var a=n.menuitem.metadata(),i=t.view.getActiveGridID();t.view.getSelectedSheets(i),t.view.getResourceID(i),t.view.getSheetID(i),t.view.getVersionID(i)}switch(a.label){case"Using VBA":l.openDialog();break;case"Using Deluge":c.createInsertDialog()}})})}(this);
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){e.defineMode("vbscript",function(e,t){function n(e){return new RegExp("^(("+e.join(")|(")+"))\\b","i")}function r(e,t){t.currentIndent++}function a(e,t){t.currentIndent--}function i(e,t){if(e.eatSpace())return"space";var n=e.peek();if("'"===n)return e.skipToEnd(),"comment";if(e.match(K))return e.skipToEnd(),"comment";if(e.match(/^((&H)|(&O))?[0-9\.]/i,!1)&&!e.match(/^((&H)|(&O))?[0-9\.]+[a-z_]/i,!1)){var i=!1;if(e.match(/^\d*\.\d+/i)?i=!0:e.match(/^\d+\.\d*/)?i=!0:e.match(/^\.\d+/)&&(i=!0),i)return e.eat(/J/i),"number";var c=!1;if(e.match(/^&H[0-9a-f]+/i)?c=!0:e.match(/^&O[0-7]+/i)?c=!0:e.match(/^[1-9]\d*F?/)?(e.eat(/J/i),c=!0):e.match(/^0(?![\dx])/i)&&(c=!0),c)return e.eat(/L/i),"number"}return e.match(z)?(t.tokenize=o(e.current()),t.tokenize(e,t)):e.match(l)||e.match(s)||e.match(h)?"operator":e.match(u)?null:e.match(d)?"bracket":e.match(W)?(t.doInCurrentLine=!0,"keyword"):e.match(q)?(r(e,t),t.doInCurrentLine=!0,"keyword"):e.match(B)?(t.doInCurrentLine?t.doInCurrentLine=!1:r(e,t),"keyword"):e.match(M)?"keyword":e.match(N)?(a(e,t),a(e,t),"keyword"):e.match(A)?(t.doInCurrentLine?t.doInCurrentLine=!1:a(e,t),"keyword"):e.match(T)?"keyword":e.match(j)?"atom":e.match(R)?"variable-2":e.match(F)?"builtin":e.match(O)?"variable-2":e.match(v)?"variable":(e.next(),b)}function o(e){var n=1==e.length,r="string";return function(a,o){for(;!a.eol();){if(a.eatWhile(/[^'"]/),a.match(e))return o.tokenize=i,r;a.eat(/['"]/)}if(n){if(t.singleLineStringErrors)return b;o.tokenize=i}return r}}function c(e,t){{var n=t.tokenize(e,t);e.current()}return n}var b="error",s=new RegExp("^[\\+\\-\\*/&\\\\\\^<>=]"),l=new RegExp("^((<>)|(<=)|(>=))"),u=new RegExp("^[\\.,]"),d=new RegExp("^[\\(\\)]"),v=new RegExp("^[A-Za-z][_A-Za-z0-9]*"),m=["class","sub","select","while","if","function","property","with","for"],p=["else","elseif","case"],f=["next","loop","wend","end"],h=n(["and","or","not","xor","is","mod","eqv","imp"]),y=["dim","redim","then","until","randomize","byval","b2yref","new","property","exit","in","const","private","public","get","set","let","stop","on error resume next","on error goto 0","option explicit","call","me"],g=["true","false","nothing","empty","null"],x=["abs","array","asc","atn","cbool","cbyte","ccur","cdate","cdbl","chr","cint","clng","cos","csng","cstr","date","dateadd","datediff","datepart","dateserial","datevalue","day","escape","eval","execute","exp","filter","formatcurrency","formatdatetime","formatnumber","formatpercent","getlocale","getobject","getref","hex","hour","inputbox","instr","instrrev","int","fix","isarray","isdate","isempty","isnull","isnumeric","isobject","join","lbound","lcase","left","len","loadpicture","log","ltrim","rtrim","trim","maths","mid","minute","month","monthname","msgbox","now","oct","replace","rgb","right","rnd","round","scriptengine","scriptenginebuildversion","scriptenginemajorversion","scriptengineminorversion","second","setlocale","sgn","sin","space","split","sqr","strcomp","string","strreverse","tan","time","timer","timeserial","timevalue","typename","ubound","ucase","unescape","vartype","weekday","weekdayname","year"],k=["vbBlack","vbRed","vbGreen","vbYellow","vbBlue","vbMagenta","vbCyan","vbWhite","vbBinaryCompare","vbTextCompare","vbSunday","vbMonday","vbTuesday","vbWednesday","vbThursday","vbFriday","vbSaturday","vbUseSystemDayOfWeek","vbFirstJan1","vbFirstFourDays","vbFirstFullWeek","vbGeneralDate","vbLongDate","vbShortDate","vbLongTime","vbShortTime","vbObjectError","vbOKOnly","vbOKCancel","vbAbortRetryIgnore","vbYesNoCancel","vbYesNo","vbRetryCancel","vbCritical","vbQuestion","vbExclamation","vbInformation","vbDefaultButton1","vbDefaultButton2","vbDefaultButton3","vbDefaultButton4","vbApplicationModal","vbSystemModal","vbOK","vbCancel","vbAbort","vbRetry","vbIgnore","vbYes","vbNo","vbCr","VbCrLf","vbFormFeed","vbLf","vbNewLine","vbNullChar","vbNullString","vbTab","vbVerticalTab","vbUseDefault","vbTrue","vbFalse","vbEmpty","vbNull","vbInteger","vbLong","vbSingle","vbDouble","vbCurrency","vbDate","vbString","vbObject","vbError","vbBoolean","vbVariant","vbDataObject","vbDecimal","vbByte","vbArray"],w=["WScript","err","debug","RegExp"],I=["description","firstindex","global","helpcontext","helpfile","ignorecase","length","number","pattern","source","value","count"],C=["clear","execute","raise","replace","test","write","writeline","close","open","state","eof","update","addnew","end","createobject","quit"],L=["server","response","request","session","application"],E=["buffer","cachecontrol","charset","contenttype","expires","expiresabsolute","isclientconnected","pics","status","clientcertificate","cookies","form","querystring","servervariables","totalbytes","contents","staticobjects","codepage","lcid","sessionid","timeout","scripttimeout"],D=["addheader","appendtolog","binarywrite","end","flush","redirect","binaryread","remove","removeall","lock","unlock","abandon","getlasterror","htmlencode","mappath","transfer","urlencode"],S=C.concat(I);w=w.concat(k),e.isASP&&(w=w.concat(L),S=S.concat(D,E));var T=n(y),j=n(g),F=n(x),O=n(w),R=n(S),z='"',B=n(m),M=n(p),A=n(f),N=n(["end"]),q=n(["do"]),W=n(["on error resume next","exit"]),K=n(["rem"]),U={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:i,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:!1,ignoreKeyword:!1}},token:function(e,t){e.sol()&&(t.currentIndent+=t.nextLineIndent,t.nextLineIndent=0,t.doInCurrentLine=0);var n=c(e,t);return t.lastToken={style:n,content:e.current()},"space"===n&&(n=null),n},indent:function(t,n){var r=n.replace(/^\s+|\s+$/g,"");return r.match(A)||r.match(N)||r.match(M)?e.indentUnit*(t.currentIndent-1):t.currentIndent<0?0:t.currentIndent*e.indentUnit}};return U}),e.defineMIME("text/vbscript","vbscript")});
!function(e){var t=e.ZSConstants.MacroKeyWords.keyWordJson,n=e.ZSConstants.MacroKeyWords.parentChildJson;!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){function r(e,t){if(!Array.prototype.indexOf){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1}return-1!=e.indexOf(t)}function i(n,r,i,o){var s=n.getCursor(),f=i(n,s);if(!/\b(?:string|comment)\b/.test(f.type)){f.state=e.innerMode(n.getMode(),f.state).state,/^[\w$_]*$/.test(f.string)?f.end>s.ch&&(f.end=s.ch,f.string=f.string.slice(0,s.ch-f.start)):f={start:s.ch,end:s.ch,string:"",state:f.state,type:"."==f.string?"property":null};var u=f;u=i(n,l(s.line,u.start));var g=i(n,l(s.line,u.start)),c=!1;if("As"==g.string&&(c=!0),"."==u.string){if(u=i(n,l(s.line,u.start)),!d)var d=[];if(d.push(u),u=i(n,l(s.line,u.start)),g=i(n,l(s.line,u.start)),"As"==g.string)return}var p=[];if(void 0==d)for(var v=e.hint.anyword(n),y=v.list,h=0;h<y.length;h++)if(void 0==t[y[h]]){var m={type:void 0,text:y[h],displayText:y[h],arguments:""};p.push(m)}var y=0==p.length?a(f,d,r,o,n,c):a(f,d,r,o,n,c).concat(p);return{list:y,from:l(s.line,f.start),to:l(s.line,f.end)}}}function o(e,t){return i(e,o,function(e,t){return e.getTokenAt(t)},t)}function s(e,t){for(var n=0;n<e.length;n++)t(e[n])}function a(e,i,o,a,l,f){function u(e){var t=e.text,n=x;0!=t.toLowerCase().lastIndexOf(n.toLowerCase(),0)||r(m,e.text)||m.push(e)}function g(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=i.name;(""==t.string||o.indexOf(t.string)>-1)&&n.push({text:o,displayText:o})}return n}function c(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],o=i.name,s="",a=i.args;if(a)for(var l=0;l<Object.keys(a).length;l++){var f=a[l];f&&(s+='"'+f+'"')}var u=t.string,g=o;(""==t.string||g.toLowerCase().indexOf(u.toLowerCase())>-1)&&n.push({type:i.type,text:o,displayText:o,arguments:s})}return n}function d(e,t){for(var n=[],r=e,i=0;i<r.length;i++){var o=r[i],s=o.name,a="",l=o.args;if(l)for(var f=0;f<Object.keys(l).length;f++){var u=l[f];u&&(a+='"'+u+'"')}var g=t.string,c=s;(""==g||c.toLowerCase().indexOf(g.toLowerCase())>-1)&&n.push({type:o.type,text:s,displayText:s,arguments:a})}return n}function p(e,t){var n=new RegExp(e+"[ 	]*=[ 	]*"),t=l.getSearchCursor(n,t.to());if(t.findPrevious()){var r=t.to(),i=l.getLineHandle(r.line);if("comment"!=i.stateAfter.lastToken.style){i=i.text,i=i.substr(i.indexOf("=")+1);var o=i.split(".");if(e=o[o.length-1].trim(),o.length>1)return e;void 0==C[e]&&(e=p(e,t))}}return e}function v(e,t){if(-1!=e){var r=l.getLineHandle(e),i=r.text.split(" ");return keyword=i[i.length-1].trim(),i=keyword.split("."),keyword=i[i.length-1].trim(),t?n[keyword]:keyword}}function y(e){for(var t=l.getSearchCursor(e,l.getCursor());t.findPrevious();){var n=t.to(),r=l.getLineHandle(n.line);if("comment"!=r.stateAfter.lastToken.style){var i,o=new RegExp(e+"[ 	]+As","i"),s=l.getSearchCursor(o,n);s.findPrevious()?(r=l.getLineHandle(s.pos.to.line),"comment"!=r.stateAfter.lastToken.style?i=s.pos.to:a={line:-1}):i={line:-1},o=new RegExp(e+"[ 	]*=[ 	]*");var a,f=l.getSearchCursor(o,n);f.findPrevious()?(r=l.getLineHandle(f.pos.to.line),a="comment"!=r.stateAfter.lastToken.style?f.pos.to:{line:-1}):a={line:-1},o=new RegExp(e+"[ 	]+In","i"),cursor_forEach=l.getSearchCursor(o,n);var u;return cursor_forEach.findPrevious()?(r=l.getLineHandle(f.pos.to.line),u="comment"!=r.stateAfter.lastToken.style?cursor_forEach.pos.to:{line:-1}):u={line:-1},i.line>a.line&&i.line>u.line?v(i.line,!1):a.line>i.line&&a.line>u.line?p(e,f):v(u.line,!0)}}}function h(e,t,n){var r=[];r=t?d(e,n):f?g(e,n):c(e,n),s(r,u)}var m=[],x=e.string,C=a&&a.globalScope||t;if(i&&i.length){var k,w=i.pop();if(w.type&&0===w.type.indexOf("variable")){if(a&&a.additionalContext&&(k=a.additionalContext[w.string]),a&&a.useGlobalScope===!1||(k=k||C[w.string]),void 0==k){var b=y(w.string);k=C[b],e=l.getTokenAt(l.getCursor()),e.string=""}}else if("string"==w.type)k="";else if("atom"==w.type)k=1;else if("function"==w.type)null==C.jQuery||"$"!=w.string&&"jQuery"!=w.string||"function"!=typeof C.jQuery?null!=C._&&"_"==w.string&&"function"==typeof C._&&(k=C._()):k=C.jQuery();else if("bracket"==w.type){var A=l.getCursor(),L={line:A.line,ch:w.start,sticky:null},T=l.findMatchingBracket(L);if(null!=T){var O=l.getTokenAt(T.to);k=C[O.string],w=O}}null!=k&&i.length&&(k=k[i.pop().string]),null!=k&&h(k,w,e)}else h(C.Global,w,e);return m}var l=e.Pos;e.registerHelper("hint","vision",o)})}(this);
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){var r=/[\w$]+/,o=500;e.registerHelper("hint","anyword",function(t,i){for(var n=i&&i.word||r,a=i&&i.range||o,s=t.getCursor(),f=t.getLine(s.line),c=s.ch,l=c;l&&n.test(f.charAt(l-1));)--l;for(var d=l!=c&&f.slice(l,c),u=i&&i.list||[],p={},g=new RegExp(n.source,"g"),h=-1;1>=h;h+=2)for(var m=s.line,w=Math.min(Math.max(m+h*a,t.firstLine()),t.lastLine())+h;m!=w;m+=h)for(var v,y=t.getLine(m);v=g.exec(y);){var L=v[0],b=d;(m!=s.line||v[0]!==d)&&(d&&0!=L.toLowerCase().lastIndexOf(b.toLowerCase(),0)||Object.prototype.hasOwnProperty.call(p,v[0])||(p[v[0]]=!0,u.push(v[0])))}return{list:u,from:e.Pos(s.line,l),to:e.Pos(s.line,c)}})});
!function(e){function t(){window.open(c.VBA_PROGRAMMING)}var n=e.sPlusPlus,a=e.ZSConstants.FeatureConstants,o=n.view.Toolbar.Feature[a.MACRO_HELP],i=e.ZSEvents,s=(i.topic,i.Groups,i.Names,e.document),r=(e.UserAction,e.ZSConstants.wCC),u=e.UIUtil.Component,c=n.data.AppRegistry.MACRO,l=s.getElementById("popupmenu"),p=n.view.Toolbar.Feature[a.DELUGE_EDITOR],E={id:r.SUBMENUITEM+a.MACRO_HELP+r.IDENTITY,ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}'},I=[{data:'{"label": "For VBA"}'},{mtype:"separator"},{data:'{"label": "For Deluge"}'}];n.view.Menu.create(I,E,l).then(function(){u.bind("#"+r.SUBMENUITEM+a.MACRO_HELP+r.IDENTITY,"menuitemclicked",function(e,a){{var o=a.menuitem.metadata(),i=n.view.getActiveGridID();n.view.getSelectedSheets(i),n.view.getResourceID(i),n.view.getSheetID(i),n.view.getVersionID(i)}switch(o.label){case"For VBA":t();break;case"For Deluge":p.openHelpPage()}})}),o.execute=t}(this);
!function(e){function t(e){var t=s.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}function n(e){var t=s.createElement("li");t.innerText=E["Deluge.Create"],t.addEventListener("click",function(){D.createInsertDialog()}),e.appendChild(t)}function a(e){var t=s.createElement("li");t.innerText=E["Deluge.Editor"],t.addEventListener("click",function(){D.openDialog()}),e.appendChild(t)}function i(e){var t=s.createElement("li");t.innerText=E["Deluge.Help"],t.addEventListener("click",function(){D.openHelpPage()}),e.appendChild(t)}function o(e){var t=s.createElement("li");t.id=u.MI+c.MANAGE_MACRO+u.IDENTITY,t.setAttribute("data",'{"label" : "'+E["VBAMacros.Manage"]+'"}'),t.addEventListener("click",function(){f.openDialog(!0)}),e.appendChild(t)}function r(){var e=s.createElement("ul");e.id=u.SUBMENUITEM+c.DELUGE+u.IDENTITY,e.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),e.setAttribute("data-ctype","zmenu"),n(e),t(e),a(e),o(e),t(e),i(e),p.appendChild(e),v.register(m.UI,A.Layout.TEMPLATE_LOADED_DEFER,L)}var l=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,s=e.document,u=e.ZSConstants.wCC,d=(e.UIUtil.Component,l.data.AppRegistry),p=s.getElementById("popupmenu"),E=e.ZSConstants.I18N,C=e.ZSEvents,v=C.topic,m=C.Groups,A=C.Names,D=l.view.Toolbar.Feature[c.DELUGE],f=l.view.Toolbar.Feature[c.MANAGE_MACRO],L=JSUtil.fn.once(function(){var e=[d.DELUGE_URL],t=new ZSClass.LazyLoad;t.JS(e)});r()}(this);
!function(e){function t(e){var t=I.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}function n(){var e=I.createElement("ul");e.id=o.SUBMENUITEM+a.VBA+o.IDENTITY,e.setAttribute("ctype","zmenu"),e.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),T&&T.createElement(e),s&&s.createElement(e),M&&M.createElement(e),T&&t(e),A&&A.createElement(e),C&&C.createElement(e),t(e),m&&m.createElement(e),u.bind(e,"zmenubeforeshow",function(){s&&(s.isRecording?(u.zmenu("#"+o.SUBMENUITEM+a.VBA+o.IDENTITY,"setMenuItemsAttribute",["#"+o.MI+a.RECORD_MACRO+o.IDENTITY],"hidden",!0),u.zmenu("#"+o.SUBMENUITEM+a.VBA+o.IDENTITY,"setMenuItemsAttribute",["#"+o.MI+a.MACRO_STOP_RECORDING+o.IDENTITY],"hidden",!1)):(u.zmenu("#"+o.SUBMENUITEM+a.VBA+o.IDENTITY,"setMenuItemsAttribute",["#"+o.MI+a.RECORD_MACRO+o.IDENTITY],"hidden",!1),u.zmenu("#"+o.SUBMENUITEM+a.VBA+o.IDENTITY,"setMenuItemsAttribute",["#"+o.MI+a.MACRO_STOP_RECORDING+o.IDENTITY],"hidden",!0)))}),i.appendChild(e)}var r=e.sPlusPlus,E=e.ZSEvents,a=(E.topic,E.Groups,E.Names,e.ZSConstants.FeatureConstants),I=e.document,o=(e.UserAction,e.ZSConstants.wCC),u=(e.ZSConstants.I18N,e.UIUtil.Component),i=I.getElementById("popupmenu"),T=(r.view.Toolbar.Feature[a.VBA],r.view.Toolbar.Feature[a.CREATE_MACRO]),s=r.view.Toolbar.Feature[a.RECORD_MACRO],M=r.view.Toolbar.Feature[a.MACRO_STOP_RECORDING],A=r.view.Toolbar.Feature[a.VBA_EDITOR],m=r.view.Toolbar.Feature[a.MACRO_HELP],C=r.view.Toolbar.Feature[a.MANAGE_MACRO];n()}(this);
!function(e){function t(){if(!a){var e=s.getElementById(p.MI+d.EMBED+p.IDENTITY);a=e.parentElement}return a}function n(e){var n=t();if(e==n.id){var a=o.data.UserInfo.orgName,r=n.id,l=n.querySelector("#"+p.MI+d.EMBED+p.IDENTITY),c=n.querySelector("#"+p.MI+d.EMBED+"_POP_"+p.IDENTITY);if(a){u.zbutton("#"+r,"show",c),u.zbutton("#"+r,"hide",l);var E=s.createElement("ul");E.id=p.SUBMENUITEM+d.EMBED+p.IDENTITY,E.setAttribute("ctype","zmenu"),i(E,a),T.appendChild(E)}else u.zbutton("#"+r,"hide",c),u.zbutton("#"+r,"show",l)}}function i(e){var t=s.createElement("li");t.setAttribute("data",'{"icon": "zsicon zsicon-intranet-site", "label":"'+b["Share.Public.PublishRangeInIntranetBlog"]+'"}'),t.addEventListener("click",function(){h.openDialog("org")}),e.appendChild(t);var n=s.createElement("li");n.setAttribute("data",'{"icon": "zsicon zsicon-external-site", "label":"'+b["Share.Public.PublishRangeInExternalBlog"]+'"}'),n.addEventListener("click",function(){h.openDialog("external")}),e.appendChild(n)}var a,o=e.sPlusPlus,r=e.ZSConstants,l=e.ZSEvents,s=e.document,u=(e.UserAction,e.UIUtil.Component),c=l.topic,E=l.Groups,I=l.Names,d=r.FeatureConstants,p=r.wCC,b=r.I18N,T=s.getElementById("popupmenu"),h=o.view.Toolbar.Feature[d.EMBED];c.register(E.UI,I.Toolbar.INIT_TOOLBAR,n,"DOM")}(this);
!function(e){function t(e){var t=e.id;"removePublish"==t?v.openDialog():"viewPublish"==t&&S.openDialog()}function i(e){return l.data.getSharePublishMeta(e).isPublished()}function n(e){if(U.parent==e){var t=l.view.getActiveGridID(),n=l.view.getResourceID(t);i(n)?(d.zmenu("#"+U.parent.id,"setMenuItemsAttribute",["#"+p.MI+r.PUBLISH+p.MENU],"hidden",!0),d.zmenu("#"+U.parent.id,"setMenuItemsAttribute",["#"+p.MI+r.PUBLISH+"_SUBMENU"+p.MENU],"hidden",!1)):(d.zmenu("#"+U.parent.id,"setMenuItemsAttribute",["#"+p.MI+r.PUBLISH+p.MENU],"hidden",!1),d.zmenu("#"+U.parent.id,"setMenuItemsAttribute",["#"+p.MI+r.PUBLISH+"_SUBMENU"+p.MENU],"hidden",!0))}}function o(){U.openDialog("external"),d.zpopover(M,"close")}function u(){S.openDialog(),d.zpopover(M,"close")}function s(){v.openDialog(),d.zpopover(M,"close")}function a(e,t){var i=l.data.getSharePublishMeta(e).isPublished(),n=t.querySelector("#pop_publish"),o=t.querySelector("#popup_publishOptions");i?(o.style.display="",n.style.display="none"):(n.style.display="",o.style.display="none")}var l=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,d=e.UIUtil.Component,p=e.ZSConstants.wCC,I=e.ZSEvents,c=I.topic,P=I.Groups,b=I.Names,U=l.view.Toolbar.Feature[r.PUBLISH],S=l.view.Toolbar.Feature[r.PUBLISH+"_ViewPublish"],v=l.view.Toolbar.Feature[r.PUBLISH+"_RemovePublish"],M=document.querySelector("#TB_SHARE_BTN"),h=(e.ZSConstants.CommandConstants,e.ZSConstants.I18N),m=document.getElementById("popupmenu"),E=!1;!function(){var e={id:p.SUBMENUITEM+r.PUBLISH+p.IDENTITY,"data-ctype":"zmenu"},i=[{id:"viewPublish",data:'{"label":"'+h["Share.Public.ViewPublishedURL"]+'"}'},{id:"removePublish",data:'{"label":"'+h["Share.Public.RemovePublic"]+'"}'}];E||(l.view.Menu.create(i,e,m).then(function(){d.bind("#"+p.SUBMENUITEM+r.PUBLISH+p.IDENTITY,"zmenuitemclick",function(e,i){var n=i.data;t(n)})}),E=!0)}(),c.register(P.UI,b.Menu.SHARE_POPUP_OPEN,a,"RID","DOM"),c.register(P.UI,b.Toolbar.INIT_MENU,n,"DOM"),U.execute=o,U.viewPublishUrl=u,U.removePublic=s}(this);
!function(e){function n(){var e=a.createElement("ul");e.id=i.SUBMENUITEM+l.PUBLISH_RANGE+i.IDENTITY,e.appendChild(s.createRangePublishMenuElement()),e.appendChild(r.createManagePublishedRangeMenuElement()),E.appendChild(e)}var t=e.sPlusPlus,a=e.document,u=e.ZSConstants,l=u.FeatureConstants,i=(u.I18N,u.wCC),s=t.view.Toolbar.Feature[l.PUBLISH_RANGE],r=t.view.Toolbar.Feature[l.MANAGE_PUBLISH_RANGE],E=a.getElementById("popupmenu");n()}(this);
!function(e){function n(){w.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",["#"+E.MI+y.FULLSCREEN+E.MENU],"checked",g)}function t(){g=g?!1:!0,g?u():(window.clearTimeout(S),c()),i()}function r(e){M.className="flt_right "+e}function o(){var e="sbFsrn";g&&(e+=" sbFsrnClicked"),r(e)}function i(){o();var e=v.view.getActiveGridID(),n=v.view.getResourceID(e),t=v.view.getSheetID(e),r=v.view.getVersionID(e);F.Top.menuBar.Tab=g?0:14,F.Top.menuBar.toolBar=g?0:44,F.Top.topBand=g?0:30;var i=b.querySelector(".shTopMenu");a(g),l(g),i.style.display=g?"none":"",U.UpdateViewport(n,t,r)}function a(e){var n="flex";F.Top.menuBar.Tab=e?0:14,F.Top.topBand=e?0:30,e&&(n="none");var t=b.querySelector(".shMenuBar");t&&(t.style.display=n)}function l(e){var n="flex";F.Top.menuBar.toolBar=e?0:44,e&&(n="none");var t=b.querySelector("#quickToolBar");t&&(t.style.display=n)}function s(){M.className="flt_right sbFsrn",h.add(),p=b.createElement("input"),p.setAttribute("type","button"),p.id=E.SB+y.FULLSCREEN+E.MENU;var e=b.createElement("label");e.title=L["Bottomband.FullScreen"],e.className="shIcon sTFullScrn",e.setAttribute("for",E.SB+y.FULLSCREEN+E.MENU),M.appendChild(p),M.appendChild(e),p.addEventListener("click",function(){t()})}function u(){var e=b.querySelector("#fullScreenBanner");e.style.display="block",S=setTimeout(c,3e3)}function c(){var e=b.querySelector("#fullScreenBanner");e.style.display="none",window.clearTimeout(S)}function d(){var e=b.createElement("div");e.addEventListener("click",c),e.id="fullScreenBanner",e.classList.add("fullScreenDOM"),e.innerText=L["Screen.hiddenMsg"],b.body.appendChild(e)}{var p,S,v=e.sPlusPlus,f=e.ZSConstants,E=f.wCC,m=e.ZSClass,y=f.FeatureConstants,w=e.UIUtil.Component,T=e.ZSEvents,B=T.topic,C=T.Groups,N=T.Names,U=e.UserAction,b=e.document,L=f.I18N,F=v.view.measures,I=v.view.Toolbar.Feature[y.FULLSCREEN],h=new m.SBFeature("FULLSCREEN"),M=h.div,g=!1;b.querySelector("#"+E.MI+y.FULLSCREEN+E.MENU)}I.execute=t,window.onkeydown=function(e){e=e||window.event,27==e.keyCode&&g&&t()},s(),d(),B.register(C.UI,N.Toolbar.INIT_MENU,n)}(this);
!function(e){function t(e,t,i,n,o){var s=o.getActiveRange(),r=o.getActiveCellRange(),a=z.view.getActiveGridID(),u=z.view.getSelectedSheets(a),t=z.view.getSheetID(a),c=z.view.getSheetState(a,t),l=c.getZoom();l!=n&&(L.Zoom(e,t,i,l,n,o.sLefts[0],o.sTops[0],o.sLefts[1],o.sTops[1],s,r),K(e,t,u,i,n,o.sLefts[0],o.sTops[0],o.sLefts[1],o.sTops[1],s,r))}function i(e,t){if(p.value=parseInt(e)+"%",t&&W&&H.indexOf(e+"%")>=0){var i="#zoom_"+e;U.zmenu("#zoomOptions","setMenuItemsAttribute",[W],"checked",!1),W=i,U.zmenu("#zoomOptions","setMenuItemsAttribute",[i],"checked",!0)}}function n(){if(p){var e=p.value;e=e.slice(0,e.length-1);var t=parseInt(e);return t}}function o(e){for(var t=H.length-1;t>1;t--){var i=H[t],n=H[t-1],o=parseInt(i.slice(0,i.length-1)),s=parseInt(n.slice(0,n.length-1));if(e>s&&o>e)return t}}function s(e,t){var s=z.view.CellEditor;if(s.getEditStatus()){var r=z.view.getActiveGridID(),a=z.view.getResourceID(r),u=z.view.getSheetID(r),l=z.view.getSelectedSheets(r),v=z.view.getVersionID(r),d=s.getValue(),g=z.view.getSheetState(r,u),m=g.getActiveCellRange();L.SubmitCell(a,l,v,d,m.startRow,m.startCol)}e.preventDefault();var S,f=n();if("DEFAULT"===t)S=100;else{var I=H.indexOf(f+"%");S=-1!=I?"PLUS"===t?I==H.length-1?H[I]:H[I+1]:1==I?H[I]:H[I-1]:"PLUS"===t?H[o(f)]:H[o(f)-1],S=S.slice(0,S.length-1)}i(S,!0),c(e)}function r(e){s(e,"PLUS")}function a(e){s(e,"MINUS")}function u(e){s(e,"DEFAULT")}function c(){var e=z.view.getActiveGridID(),i=z.view.getResourceID(e),o=z.view.getSheetID(e),s=z.view.getVersionID(e),r=z.view.getSheetState(e,o),a=n(),u=a/100;t(i,o,s,u,r)}function l(e,t){var n=z.view.CellEditor;if(n.getEditStatus()){var o=z.view.getActiveGridID(),s=z.view.getResourceID(o),r=z.view.getSheetID(o),a=z.view.getSelectedSheets(o),u=z.view.getVersionID(o),l=n.getValue(),v=z.view.getSheetState(o,r),d=v.getActiveCellRange();L.SubmitCell(s,a,u,l,d.startRow,d.startCol)}var g,m;"default"==t.data.id?(g="#zoom_100",m=100):(g=t.data.id,m=t.data.label.slice(0,t.data.label.length-1)),U.zmenu("#zoomOptions","setMenuItemsAttribute",[W],"checked",!1),W=g,U.zmenu("#zoomOptions","setMenuItemsAttribute",[g],"checked",!0),i(m,!0),c(e)}function v(){A=b.createElement("ul"),A.id="zoomOptions",A.setAttribute("data-ctype","zmenu"),A.setAttribute("data-min-width",120),A.setAttribute("data-content-type","icon-text");for(var e=H.length,t=e-1;t>=0;t--){var i=H[t],o=b.createElement("li");if(o.id="zoom_"+i.slice(0,i.length-1),0==t){o.id="default";var s=b.createElement("li");s.setAttribute("mtype","separator"),A.appendChild(s)}else o.setAttribute("data-item-type","checkbox");o.textContent=i,A.appendChild(o)}T.appendChild(A),U.bind(A,"zmenushow",function(){var e=n();W?-1==H.indexOf(e+"%")&&U.zmenu("#zoomOptions","setMenuItemsAttribute",[W],"checked",!1):(W="#zoom_"+e,H.indexOf(e+"%")>=0&&U.zmenu("#zoomOptions","setMenuItemsAttribute",[W],"checked",!0))}),U.bind(A,"zmenuitemclick",function(e,t){l(e,t)})}function d(){return G.Stack[G.Stack.length-1]}function g(e){G.focusContext(e)}function m(){p.blur()}function S(){E=d(),g(G.Entry.Zoom.Context),p.select()}function f(){g(E)}function I(e){var t=z.view.CellEditor;if(t.getEditStatus()){var o=z.view.getActiveGridID(),s=z.view.getResourceID(o),r=z.view.getSheetID(o),a=z.view.getSelectedSheets(o),u=z.view.getVersionID(o),l=t.getValue(),v=z.view.getSheetState(o,r),d=v.getActiveCellRange();L.SubmitCell(s,a,u,l,d.startRow,d.startCol)}var o=z.view.getActiveGridID(),r=z.view.getSheetID(o),g=z.view.getSheetState(o,r),S=p.value;S.endsWith("%")&&(S=n()),isNaN(S)&&(S=100*g.getZoom(),i(S)),q>S?S=q:S>B&&(S=B),i(S,!0),c(e),m()}function h(){var e=z.view.getActiveGridID(),t=z.view.getSheetID(e),n=z.view.getSheetState(e,t),o=L.getTemplate(["ZOOM_SLIDER"]),s=o.ZOOM_SLIDER;P.appendChild(s),p=P.querySelector(".zoomInput").firstElementChild,i(100*n.getZoom(),!1),p.addEventListener("focus",S),p.addEventListener("blur",f),D=P.querySelector(".zoomInc"),D.addEventListener("click",r),C=P.querySelector(".zoomDec"),C.addEventListener("click",a),O=P.querySelector(".zoomMoreOpt"),v(),O.setAttribute("data-menu-id","zoomOptions")}function w(e,t,o,s){var r=n()/100;r&&s!=r&&i(100*s,!0)}var p,D,C,O,A,E,z=e.sPlusPlus,b=e.document,Z=e.ZSClass,L=e.UserAction,M=e.ZSEvents,R=M.topic,k=M.Groups,y=M.Names,T=b.getElementById("popupmenu"),U=e.UIUtil.Component,G=(z.view.measures,z.view.Events.Key),N=e.ZSConstants.FeatureConstants,x=e.ZSConstants.FeatureConstants,V=e.ZSConstants.wCC,_=e.ZSConstants.I18N,F=(Z.ZSAlert,new Z.SBFeature("GRIDZOOM")),P=F.div,q=(_["Zoom.NotSupported"],50),B=400,W=null,_=(b.querySelector("#"+V.MI+x.ZOOM+V.MENU),e.ZSConstants.I18N),H=[_["Zoom.Default"],"50%","75%","100%","125%","150%","200%","250%","300%","400%"],J=z.view.Toolbar.Feature[N.ZOOM],K=JSUtil.fn.debounce(function(e,t,i,n,o,s,r,a,u,c,l){var v=z.data.getWorkBook(e,n),d=v.isEditable();d&&L.setZoom(e,t,i,n,o,s,r,a,u,c,l)},1e3);J.Increment=r,J.Decrement=a,J.setDefault=u;var j=function(){P.className="zoomGrid",h(),F.add()};R.register(k.UI,y.Layout.TEMPLATE_LOADED,j),R.register(k.Listener,y.SheetAction.ZOOM.OnCustomInput,I),R.register(k.Listener,y.SheetAction.ZOOM.On,w,"RID","SHEETID","VERSION","ZOOM","sTop","sLeft","fsTop","fsLeft")}(this);
!function(e){function t(){var e=new ZSClass.SBFeature("VIEW_SETTINGS"),t=e.div;v.fn.addIcon(t,"GRID_VIEW_ICON"),t.className="sTGridView",t.title=I["View.GridSpacing"],t.setAttribute("data-menu-id","gridViewOptions"),e.add()}function i(){var e=u.createElement("ul");e.id="gridViewOptions",e.className="sTGridView curPtr",e.setAttribute("data-ctype","zmenu"),e.setAttribute("data-content-type","icon-text"),a(e),n(e),g.appendChild(e),S.bind(e,"zmenubeforeshow",function(){var e=C.VIEW;e==c.data.View.CLASSIC?(S.zmenu("#gridViewOptions","setMenuItemsAttribute",[D],"checked",!0),S.zmenu("#gridViewOptions","setMenuItemsAttribute",[T],"checked",!1)):e==c.data.View.COMFORT&&(S.zmenu("#gridViewOptions","setMenuItemsAttribute",[T],"checked",!0),S.zmenu("#gridViewOptions","setMenuItemsAttribute",[D],"checked",!1))}),S.bind(e,"zmenuitemclick",function(e,t){var i=t.data.value,a=c.view.getActiveGridID(),n=c.view.getResourceID(a),s=c.view.getVersionID(a),r=c.view.getSelectedSheets(a);UserAction.GRID_VIEW(n,r,s,i)})}function a(e){D=u.createElement("li"),D.setAttribute("data-value","CLASSIC"),D.setAttribute("data-item-type","checkbox"),D.setAttribute("data-checked",!0),D.innerText=I["View.GridSpacing.Classic"],e.appendChild(D)}function n(e){T=u.createElement("li"),T.setAttribute("data-value","COMFORT"),T.setAttribute("data-item-type","checkbox"),T.innerText=I["View.GridSpacing.Comfort"],e.appendChild(T)}function s(e,t,i){for(var a=c.data.getWorkBook(e,i),n=a.getSheetObj(t),s=n.Row.axis,r=n.Row.auxiliaryAxis,o=C.MAX_ROW,d=c.data.Defaults.PADDING,u=0;o>u;u++){var I=s.getDim(u);r.setDim(u,1,I?I+d:I)}}function r(e,t,i){var a=c.view.getActiveGridID(),e=c.view.getResourceID(a),n=c.view.getSheetID(a),t=c.view.getVersionID(a),r=i[E.VIEW];C.VIEW!=c.data.View[r]&&("CLASSIC"==r?(A.classList.remove("comfort"),A.classList.add("classic")):"COMFORT"==r&&(A.classList.remove("classic"),A.classList.add("comfort")),C.VIEW=c.data.View[r],s(e,n,t),c.view.getGridComponent(a).onReload(e,n,t),UserAction.UpdateViewport(e,n,t),V.publish(w.Listener,p.SheetMeta.GRIDVIEW,{RID:e,SHEETID:n,VERSION:t}))}function o(e,t,i,a){var n=c.data.getWorkBook(e,i),r=n.getSheetObj(a);r.Visited&&s(e,a,i)}{var c=e.sPlusPlus,d=e.ZSConstants,u=e.document,I=d.I18N,l=(d.wCC,d.FeatureConstants),E=d.CommandConstants,S=e.UIUtil.Component,m=e.ZSEvents,V=m.topic,w=m.Groups,p=m.Names,v=e.UIUtil,C=c.data.Defaults,g=u.getElementById("popupmenu"),A=u.querySelector(".gridContainer");c.view.Toolbar.Feature[l.VIEW_SETTINGS]}V.register(w.UI,p.Layout.TEMPLATE_LOADED,t);var D,T;i(),V.register(w.Listener,p.DocMeta.DOC_SETTINGS,r,"RID","VERSION","DOC_SETTINGS"),V.register(w.UserAction,p.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,o,"RID","SHEETID","VERSION","TARGET_SHEET")}(this);
!function(e){function t(){var e=p.createElement("ul");e.id=d.SUBMENUITEM+E.CLEAR_ALL+d.IDENTITY,e.appendChild(L.createClearAllMenuElement()),e.appendChild(A.createMenuElement()),e.appendChild(w.createMenuElement()),e.appendChild(a()),e.appendChild(T.createMenuElement()),e.appendChild(I.createMenuElement()),e.appendChild(R.createClearMenuElement()),e.appendChild(a()),e.appendChild(g.createElement()),e.appendChild(D.createElement()),h.appendChild(e)}function a(){var e=p.createElement("li");return e.setAttribute("data-item-type","separator"),e}function r(e){if(!e.repeat){var t=v.view.getActiveGridID(),a=v.view.getResourceID(t),r=(v.view.getSheetID(t),v.view.getVersionID(t)),i=v.view.getSelectedSheets(t);s.CLEARALL(a,i,r),e.preventDefault(),e.stopPropagation()}}function i(e){if(!e.repeat){var t=v.view.getActiveGridID(),a=v.view.getResourceID(t),r=(v.view.getSheetID(t),v.view.getVersionID(t)),i=v.view.getSelectedSheets(t);s.CLEARSTYLES(a,i,r),e.preventDefault(),e.stopPropagation()}}function n(e){if(!e.repeat){var t=v.view.getActiveGridID(),a=v.view.getResourceID(t),r=(v.view.getSheetID(t),v.view.getVersionID(t)),i=v.view.getSelectedSheets(t);s.CLEARCONTENTS(a,i,r),e.preventDefault(),e.stopPropagation()}}function o(){var e=v.view.Toolbar.Feature[E.NOTE];e.Clear()}function l(){var e=v.view.Toolbar.Feature[E.HYPERLINK];e.Clear()}function u(){var e=v.view.Toolbar.Feature[E.INPUT_CONTROLS];e.Clear(ev)}var v=e.sPlusPlus,p=e.document,c=e.ZSEvents,C=(c.topic,c.Groups,c.Names,e.ZSConstants),E=C.FeatureConstants,d=(C.I18N,C.wCC),s=e.UserAction,L=v.view.Toolbar.Feature[E.CLEAR_ALL],A=v.view.Toolbar.Feature[E.CLEAR_ALL+"_Formats"],w=v.view.Toolbar.Feature[E.CLEAR_ALL+"_Contents"],T=v.view.Toolbar.Feature[E.CLEAR_NOTE],I=v.view.Toolbar.Feature[E.CLEAR_HYPERLINK],R=v.view.Toolbar.Feature[E.INPUT_CONTROLS],g=v.view.Toolbar.Feature[E.CLEAR_DATA_VALIDATION],D=v.view.Toolbar.Feature[E.CONDITIONAL_FORMAT_CLEAR_RULE],h=p.getElementById("popupmenu");L.execute=r,A.execute=i,w.execute=n,T.execute=o,I.execute=l,R.execute=u,t()}(this);
!function(e){function t(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_ROW+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+C["HomeTab.Row.Insert"]+'"}'),e.addEventListener("click",function(){E(b.INSERT_ROW)}),e}function o(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_ROW_ABOVE+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+C.RowAbove+'"}'),e.addEventListener("click",function(){E(b.INSERT_ROW_ABOVE)}),e}function n(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_ROW_BELOW+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-below","label": "'+C.RowBelow+'"}'),e.addEventListener("click",function(){E(b.INSERT_ROW_BELOW)}),e}function i(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_COPY_ROW_ABOVE+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+C["Insert.Copied.Rows.Above"]+'"}'),e.addEventListener("click",function(){E(b.INSERT_COPY_ROW_ABOVE)}),e}function r(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_COPY_ROW_BELOW+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-below","label": "'+C["Insert.Copied.Rows.Below"]+'"}'),e.addEventListener("click",function(){E(b.INSERT_COPY_ROW_BELOW)}),e}function a(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_CUT_ROW_ABOVE+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-above","label": "'+C["Insert.Cut.Rows.Above"]+'"}'),e.addEventListener("click",function(){E(b.INSERT_CUT_ROW_ABOVE)}),e}function s(){var e=A.createElement("li");return e.id=U.SUBMENUITEM+b.INSERT_CUT_ROW_BELOW+U.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-row-below","label": "'+C["Insert.Cut.Rows.Below"]+'"}'),e.addEventListener("click",function(){E(b.INSERT_CUT_ROW_BELOW)}),e}function c(){var e=document.createElement("ul");e.id=U.SUBMENUITEM+b.INSERT_ROW_OPTIONS+U.IDENTITY,e.setAttribute("ctype","zmenu"),e.setAttribute("relativeto","parent"),e.appendChild(g.constructRowAboveMenuItem()),e.appendChild(g.constructRowBelowMenuItem()),e.appendChild(g.constructCopyRowAboveMenuItem()),e.appendChild(g.constructCopyRowBelowMenuItem()),e.appendChild(g.constructCutRowAboveMenuItem()),e.appendChild(g.constructCutRowBelowMenuItem()),M.appendChild(e),W.bind(e,"zmenubeforeshow",function(){u(e)})}function I(e){for(var t=w.data.Defaults,o=[],n=0;n<e.length;n++){var i=e[n],r=i.endRow-i.startRow+1;(i.endRow!=t.MAX_ROW-1||0!=i.startRow)&&(i.endRow=i.endRow+r,i.startRow=i.startRow+r),o.push(i)}return o}function E(t){var o=w.view.getActiveGridID(),n=w.view.getResourceID(o),i=w.view.getSheetID(o),r=w.view.getVersionID(o),a=w.view.getSheetState(o,i),s=w.view.getSelectedSheets(o),c=a.getRanges(),E=w.data.getWorkBook(n,r),R=a.getActiveRange(),u=E.getSheetObj(i),T=R.startRow,S=R.endRow,d=S-T+1,O=w.view.CellEditor.getEditStatus();if(!l(u,T,d))return void ZSClass.ZSAlert(C["InsertRow.Alert.InsertingNotPossibleBeyondMaxRow"],{title:C["Alert.Title.RowLimitExceeded"]});O&&_.publish(N.Gesture.Selector.CellEdit,v.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:i,VERSION:r,isSubmittable:1});var A=f.activeInfo.getCopyState();if(A&&(t==b.INSERT_COPY_ROW_ABOVE||t==b.INSERT_COPY_ROW_BELOW)){var U=f.activeInfo.copyRanges.Ranges;if(U&&U.length>1)return void ZSClass.ZSAlert(C["action.not.support.multiselection"],{title:C["Alert.Title.InvalidSelection"]})}switch(t){case b.INSERT_ROW:case b.INSERT_ROW_ABOVE:case b.INSERT_ROW_OPTIONS:e.UserAction.InsertRow(n,s,r,c);break;case b.INSERT_ROW_BELOW:c=I(c),e.UserAction.InsertRow(n,s,r,c);break;case b.INSERT_CUT_ROW_ABOVE:e.UserAction.InsertCutRow(n,s,r,c);break;case b.INSERT_CUT_ROW_BELOW:c=I(c),e.UserAction.InsertCutRow(n,s,r,c);break;case b.INSERT_COPY_ROW_ABOVE:e.UserAction.InsertCopyRow(n,s,r,c);break;case b.INSERT_COPY_ROW_BELOW:c=I(c),e.UserAction.InsertCopyRow(n,s,r,c)}}function l(e,t,o){var n=w.data.Defaults.MAX_ROW,i=e.MaxUsedRow;return i+o>=n||t===n||t+o>n?!1:!0}function R(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var t=w.view.getActiveGridID(),o=w.view.getSheetID(t),n=w.view.getSheetState(t,o),i=w.view.getResourceID(t),r=w.data.Defaults,a=n.getActiveRange(),s=w.view.getVersionID(t),c=w.data.getWorkBook(i,s),I=a.endRow+1===r.MAX_ROW||c.ProtectedSheets.isSheetLocked(o)?!0:!1;I?W.disable("#"+U.MI+b.INSERT_ROW_OPTIONS+U.MENU):W.enable("#"+U.MI+b.INSERT_ROW_OPTIONS+U.MENU)}}function u(e){var t=e.id,o=w.view.getActiveGridID(),n=w.view.getResourceID(o),i=w.view.getSheetID(o),r=w.view.getSheetState(o,i),a=w.view.getVersionID(o),s=w.data.getWorkBook(n,a),c=s.getSheetObj(i),I=(w.data.Defaults,r.getActiveRange()),E=w.data.UserInfo,l=new ZSClass.Range(I.startRow,I.startCol,I.endRow,I.endCol),R=E.activeInfo.getVisualCueStatus(),u=w.data.UserInfo.activeInfo.isCopy;if(T(e),R&&l.isRow()&&void 0!=u)0==u?(e.querySelector("#"+U.SUBMENUITEM+b.INSERT_CUT_ROW_ABOVE+U.IDENTITY).style.display="block",e.querySelector("#"+U.SUBMENUITEM+b.INSERT_CUT_ROW_BELOW+U.IDENTITY).style.display="block"):(e.querySelector("#"+U.SUBMENUITEM+b.INSERT_COPY_ROW_ABOVE+U.IDENTITY).style.display="block",e.querySelector("#"+U.SUBMENUITEM+b.INSERT_COPY_ROW_BELOW+U.IDENTITY).style.display="block");else{var S=I.endRow-I.startRow+1;S-=c.Row.Visibility.getOnCount(I.startRow,I.endRow);var d,O;S>1?(d=JSUtil.fn.replaceParams(C.NoofRowsAbove,new Array(S+"")),O=JSUtil.fn.replaceParams(C.NoofRowsBelow,new Array(S+""))):(d=C.RowAbove,O=C.RowBelow),W.zmenu("#"+t,"setMenuItemsAttribute",["#"+U.SUBMENUITEM+b.INSERT_ROW_ABOVE+U.IDENTITY],"label",d),W.zmenu("#"+t,"setMenuItemsAttribute",["#"+U.SUBMENUITEM+b.INSERT_ROW_BELOW+U.IDENTITY],"label",O),e.querySelector("#"+U.SUBMENUITEM+b.INSERT_ROW_ABOVE+U.IDENTITY).style.display="block",e.querySelector("#"+U.SUBMENUITEM+b.INSERT_ROW_BELOW+U.IDENTITY).style.display="block"}}function T(e){for(var t=e.querySelectorAll("li"),o=0;o<t.length;o++)t[o].style.display="none"}function S(){E(b.INSERT_ROW_ABOVE)}var w=e.sPlusPlus,d=e.ZSConstants,O=e.ZSEvents,_=O.topic,N=O.Groups,v=O.Names,A=e.document,b=(w.data.Defaults.MAX_COL,e.UserAction,d.FeatureConstants),C=d.I18N,U=d.wCC,B=d.JSKeyCode,M=(w.view.Toolbar.transient,A.getElementById("popupmenu")),W=(w.SML.Client,e.UIUtil.Component),f=w.data.UserInfo,p=!0,g=w.view.Toolbar.Feature[b.INSERT_ROW_OPTIONS];g.constructMenuItemLayout=t,g.constructRowAboveMenuItem=o,g.constructRowBelowMenuItem=n,g.constructCopyRowAboveMenuItem=i,g.constructCopyRowBelowMenuItem=r,g.constructCutRowAboveMenuItem=a,g.constructCutRowBelowMenuItem=s,g.execute=E;var y=(JSUtil.fn.debounce(function(){p&&R()},500),e.sPlusPlus.view.Events.Key),m=y.Entry.ShortCut.Context,D=m.keyDown;D[B.CTRL+"+"+B.ALT+"+"+B.EQUAL]=S,c(),g.execute=E,g.changeRowOptions=u,_.register(N.UI,v.Toolbar.INIT_MENU,R,"DOM")}(this);
!function(e){function t(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_COL+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+M["HomeTab.Column.Insert"]+'"}'),e.addEventListener("click",function(){s(_.INSERT_COL)}),e}function n(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_COLUMN_BEFORE+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+M.ColumnBefore+'"}'),e.addEventListener("click",function(){s(_.INSERT_COLUMN_BEFORE)}),e}function o(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_COLUMN_AFTER+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-after","label": "'+M.ColumnAfter+'"}'),e.addEventListener("click",function(){s(_.INSERT_COLUMN_AFTER)}),e}function r(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_COPY_COLUMN_BEFORE+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+M["Insert.Copied.Columns.Before"]+'"}'),e.addEventListener("click",function(){s(_.INSERT_COPY_COLUMN_BEFORE)}),e}function i(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_COPY_COLUMN_AFTER+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-after","label": "'+M["Insert.Copied.Columns.After"]+'"}'),e.addEventListener("click",function(){s(_.INSERT_COPY_COLUMN_AFTER)}),e}function l(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_CUT_COLUMN_BEFORE+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-before","label": "'+M["Insert.Cut.Columns.Before"]+'"}'),e.addEventListener("click",function(){s(_.INSERT_CUT_COLUMN_BEFORE)}),e}function a(){var e=d.createElement("li");return e.id=R.SUBMENUITEM+_.INSERT_CUT_COLUMN_AFTER+R.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-insert-column-after","label": "'+M["Insert.Cut.Columns.After"]+'"}'),e.addEventListener("click",function(){s(_.INSERT_CUT_COLUMN_AFTER)}),e}function E(){var e=document.createElement("ul");e.id=R.SUBMENUITEM+_.INSERT_COLUMN_OPTIONS+R.IDENTITY,e.setAttribute("ctype","zmenu"),e.setAttribute("relativeto","parent"),e.appendChild(g.constructColBeforeMenuItem(e)),e.appendChild(g.constructColAfterMenuItem(e)),e.appendChild(g.constructCopyColBeforeMenuItem(e)),e.appendChild(g.constructCopyColAfterMenuItem(e)),e.appendChild(g.constructCutColBeforeMenuItem(e)),e.appendChild(g.constructCutColAfterMenuItem(e)),L.appendChild(e),b.bind(e,"zmenubeforeshow",function(){I(e)})}function c(e){for(var t=S.data.Defaults,n=[],o=0;o<e.length;o++){var r=e[o],i=r.endCol-r.startCol+1;(r.endCol!=t.MAX_COL-1||0!=r.startCol)&&(r.endCol=r.endCol+i,r.startCol=r.startCol+i),n.push(r)}return n}function s(t){var n=S.view.getActiveGridID(),o=S.view.getResourceID(n),r=S.view.getSheetID(n),i=S.view.getVersionID(n),l=S.view.getSelectedSheets(n),a=S.view.getSheetState(n,r),E=a.getRanges(),s=S.view.CellEditor.getEditStatus(),C=S.data.getWorkBook(o,i),I=a.getActiveRange(),u=C.getSheetObj(r),T=I.startCol,d=I.endCol,U=d-T+1;if(!N(u,T,U))return void ZSClass.ZSAlert(M["InsertCol.Alert.InsertingNotPossibleBeyondMaxCol"],{title:M["Alert.Title.ColumnLimitExceeded"]});s&&v.publish(A.Gesture.Selector.CellEdit,m.GESTURE.ACTION.ENUMERATE,{RID:o,SHEETID:r,VERSION:i,isSubmittable:1});var R=B.activeInfo.getCopyState();if(R&&(t==_.INSERT_COPY_COLUMN_AFTER||t==_.INSERT_COPY_COLUMN_BEFORE)){var O=B.activeInfo.copyRanges.Ranges;if(O&&O.length>1)return void ZSClass.ZSAlert(M["action.not.support.multiselection"],{title:M["Alert.Title.InvalidSelection"]})}switch(t){case _.INSERT_COL:case _.INSERT_COLUMN_BEFORE:case _.INSERT_COLUMN_OPTIONS:e.UserAction.InsertCol(o,l,i,E);break;case _.INSERT_COLUMN_AFTER:E=c(E),e.UserAction.InsertCol(o,l,i,E);break;case _.INSERT_CUT_COLUMN_BEFORE:e.UserAction.InsertCutCol(o,l,i,E);break;case _.INSERT_CUT_COLUMN_AFTER:E=c(E),e.UserAction.InsertCutCol(o,l,i,E);break;case _.INSERT_COPY_COLUMN_BEFORE:e.UserAction.InsertCopyCol(o,l,i,E);break;case _.INSERT_COPY_COLUMN_AFTER:E=c(E),e.UserAction.InsertCopyCol(o,l,i,E)}}function C(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var t=S.data.Defaults,n=S.view.getActiveGridID(),o=S.view.getResourceID(n),r=S.view.getSheetID(n),i=S.view.getSheetState(n,r),l=i.getActiveRange(),a=S.view.getVersionID(n),E=S.data.getWorkBook(o,a),c=l.endCol+1===t.MAX_COL||E.ProtectedSheets.isSheetLocked(r)?!0:!1;c?b.disable("#"+R.MI+_.INSERT_COLUMN_OPTIONS+R.MENU):b.enable("#"+R.MI+_.INSERT_COLUMN_OPTIONS+R.MENU)}}function I(e){var t,n,o=e.id,r=(S.data.Defaults,S.view.getActiveGridID()),i=S.view.getResourceID(r),l=S.view.getSheetID(r),a=S.view.getVersionID(r),E=S.data.getWorkBook(i,a),c=E.getSheetObj(l),s=S.view.getSheetState(r,l),C=s.getActiveRange(),I=S.data.UserInfo,T=new ZSClass.Range(C.startRow,C.startCol,C.endRow,C.endCol),N=I.activeInfo.getVisualCueStatus(),d=S.data.UserInfo.activeInfo.isCopy;if(u(e),N&&T.isCol()&&void 0!=d)0==d?(e.querySelector("#"+R.SUBMENUITEM+_.INSERT_CUT_COLUMN_BEFORE+R.IDENTITY).style.display="block",e.querySelector("#"+R.SUBMENUITEM+_.INSERT_CUT_COLUMN_AFTER+R.IDENTITY).style.display="block"):(e.querySelector("#"+R.SUBMENUITEM+_.INSERT_COPY_COLUMN_BEFORE+R.IDENTITY).style.display="block",e.querySelector("#"+R.SUBMENUITEM+_.INSERT_COPY_COLUMN_AFTER+R.IDENTITY).style.display="block");else{var U=C.endCol-C.startCol+1;U-=c.Column.hidden.getOnCount(C.startCol,C.endCol),U>1?(t=JSUtil.fn.replaceParams(M.NoofColumnsBefore,new Array(U+"")),n=JSUtil.fn.replaceParams(M.NoofColumnsAfter,new Array(U+""))):(t=M.ColumnBefore,n=M.ColumnAfter),b.zmenu("#"+o,"setMenuItemsAttribute",["#"+R.SUBMENUITEM+_.INSERT_COLUMN_BEFORE+R.IDENTITY],"label",t),b.zmenu("#"+o,"setMenuItemsAttribute",["#"+R.SUBMENUITEM+_.INSERT_COLUMN_AFTER+R.IDENTITY],"label",n),e.querySelector("#"+R.SUBMENUITEM+_.INSERT_COLUMN_BEFORE+R.IDENTITY).style.display="block",e.querySelector("#"+R.SUBMENUITEM+_.INSERT_COLUMN_AFTER+R.IDENTITY).style.display="block"}}function u(e){for(var t=e.querySelectorAll("li"),n=0;n<t.length;n++)t[n].style.display="none"}function T(){s(_.INSERT_COLUMN_BEFORE)}function N(e,t,n){var o=S.data.Defaults.MAX_COL,r=e.MaxUsedCol;return r+n>=o||t===o||t+n>o?!1:!0}var S=e.sPlusPlus,d=e.document,U=e.ZSConstants,_=U.FeatureConstants,M=U.I18N,R=U.wCC,O=U.JSKeyCode,f=e.ZSEvents,v=f.topic,A=f.Groups,m=f.Names,L=(S.view.Toolbar.transient,d.getElementById("popupmenu")),b=(S.SML.Client,e.UIUtil.Component),B=S.data.UserInfo,p=!0,g=S.view.Toolbar.Feature[_.INSERT_COLUMN_OPTIONS];g.constructMenuItemLayout=t,g.constructColBeforeMenuItem=n,g.constructColAfterMenuItem=o,g.constructCopyColBeforeMenuItem=r,g.constructCopyColAfterMenuItem=i,g.constructCutColBeforeMenuItem=l,g.constructCutColAfterMenuItem=a;var y=(JSUtil.fn.debounce(function(){p&&C()},500),e.sPlusPlus.view.Events.Key),D=y.Entry.ShortCut.Context,F=D.keyDown;F[O.CTRL+"+"+O.SHIFT+"+"+O.EQUAL]=T,E(),g.execute=s,v.register(A.UI,m.Toolbar.INIT_MENU,C,"DOM")}(this);
!function(e){function t(){var e=T.createElement("li");return e.id=d.SUBMENUITEM+I.SHIFT_CELLS_RIGHT+d.IDENTITY,e.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-right","label": "'+S["Shift.Cells.To.The.Right"]+'"}'),e.addEventListener("click",o),e}function i(){var e=T.createElement("li");return e.id=d.SUBMENUITEM+I.SHIFT_CELLS_DOWN+d.IDENTITY,e.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-down","label": "'+S["Shift.Cells.Down"]+'"}'),e.addEventListener("click",l),e}function n(){var e=document.createElement("ul");e.setAttribute("ctype","zmenu"),e.setAttribute("relativeto","parent"),e.id=d.SUBMENUITEM+I.INSERT_CELL_OPTIONS+d.IDENTITY,e.appendChild(N.constructCellsDownMenuItem()),e.appendChild(N.constructCellsToRightMenuItem()),v.appendChild(e)}function s(e){if("TB_INSERT_POPUP_CONTAINER"==e.id){var t=r.view.getActiveGridID(),i=r.view.getSheetID(t),n=r.view.getResourceID(t),s=r.view.getVersionID(t),o=r.data.getWorkBook(n,s),l=r.view.getSheetState(t,i),E=l.getActiveRange(),c=r.data.Defaults,a=E.endRow+1===c.MAX_ROW||o.ProtectedSheets.isSheetLocked(i)?!0:!1;a?C.disable("#"+d.MI+I.INSERT_CELL_OPTIONS+d.MENU):C.enable("#"+d.MI+I.INSERT_CELL_OPTIONS+d.MENU)}}function o(){var t=r.view.getActiveGridID(),i=r.view.getResourceID(t),n=r.view.getSheetID(t),s=r.view.getSelectedSheets(t),o=r.view.getVersionID(t),l=r.view.CellEditor.getEditStatus();l&&c.publish(a.Gesture.Selector.CellEdit,u.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:n,VERSION:o,isSubmittable:1}),e.UserAction.InsertCellLeft(i,s,o)}function l(){var t=r.view.getActiveGridID(),i=r.view.getResourceID(t),n=r.view.getSheetID(t),s=r.view.getVersionID(t),o=r.view.getSelectedSheets(t),l=r.view.CellEditor.getEditStatus();l&&c.publish(a.Gesture.Selector.CellEdit,u.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:n,VERSION:s,isSubmittable:1}),e.UserAction.InsertCellTop(i,o,s)}var r=e.sPlusPlus,I=e.ZSConstants.FeatureConstants,E=e.ZSEvents,c=E.topic,a=E.Groups,u=E.Names,S=e.ZSConstants.I18N,T=e.document,d=e.ZSConstants.wCC,v=(r.view.Toolbar.transient,T.getElementById("popupmenu")),C=e.UIUtil.Component,N=r.view.Toolbar.Feature[I.INSERT_CELL_OPTIONS];N.constructCellsToRightMenuItem=t,N.constructCellsDownMenuItem=i;JSUtil.fn.debounce(function(){buttonState&&s()},500);n(),N.doShiftRight=o,c.register(a.UI,u.Toolbar.INIT_MENU,s,"DOM")}(this);
!function(e){function t(){var e=u.createElement("li");return e.id=c.SUBMENUITEM+a.SHIFT_CELLS_LEFT+c.IDENTITY,e.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-left","label": "'+S["Shift.Cells.To.The.Left"]+'"}'),e.addEventListener("click",s),e}function i(){var e=u.createElement("li");return e.id=c.SUBMENUITEM+a.SHIFT_CELLS_UP+c.IDENTITY,e.setAttribute("data",'{"icon": "zsicon zsicon-shift-cells-up","label": "'+S["Shift.Cells.Up"]+'"}'),e.addEventListener("click",o),e}function n(){var e=document.createElement("ul");e.id=c.SUBMENUITEM+a.CELL_OPTIONS+c.IDENTITY,e.setAttribute("ctype","zmenu"),e.appendChild(l(S["MenuTab.Tab.Insert"])),e.appendChild(N.constructCellsToRightMenuItem()),e.appendChild(N.constructCellsDownMenuItem()),e.appendChild(l(S.Delete)),e.appendChild(D.constructCellsLeftMenuItem()),e.appendChild(D.constructCellsUpMenuItem()),I.appendChild(e),T.bind(e,"menubeforeshow",function(){r(e)})}function l(e){var t=u.createElement("li");return t.setAttribute("mtype","group"),t.setAttribute("relativeto","parent"),t.setAttribute("data",'{"label": "'+e+'"}'),t}function r(e){var t=e.querySelector("#"+c.SUBMENUITEM+a.SHIFT_CELLS_DOWN+c.IDENTITY),i=e.querySelector("#"+c.SUBMENUITEM+a.SHIFT_CELLS_UP+c.IDENTITY),n=e.querySelector("#"+c.SUBMENUITEM+a.SHIFT_CELLS_RIGHT+c.IDENTITY),l=e.querySelector("#"+c.SUBMENUITEM+a.SHIFT_CELLS_LEFT+c.IDENTITY),r=E.view.getActiveGridID(),s=E.view.getSheetID(r),o=E.view.getSheetState(r,s),u=o.getActiveRange(),I=E.data.Defaults,S=u.endRow+1===I.MAX_ROW,d=u.endCol+1===I.MAX_COL,C=S?"disable":"enable",v=d?"disable":"enable";T[C](t),T[C](i),T[v](n),T[v](l)}function s(){var t=E.view.getActiveGridID(),i=E.view.getResourceID(t),n=E.view.getSheetID(t),l=E.view.getVersionID(t),r=E.view.getSelectedSheets(t),s=E.view.CellEditor.getEditStatus();s&&C.publish(v.Gesture.Selector.CellEdit,p.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:n,VERSION:l,isSubmittable:1}),e.UserAction.DeleteCellRight(i,r,l)}function o(){var t=E.view.getActiveGridID(),i=E.view.getResourceID(t),n=E.view.getSheetID(t),l=E.view.getVersionID(t),r=E.view.getSelectedSheets(t),s=E.view.CellEditor.getEditStatus();s&&C.publish(v.Gesture.Selector.CellEdit,p.GESTURE.ACTION.ENUMERATE,{RID:i,SHEETID:n,VERSION:l,isSubmittable:1}),e.UserAction.DeleteCellBottom(i,r,l)}var E=e.sPlusPlus,u=e.document,I=u.getElementById("popupmenu"),a=e.ZSConstants.FeatureConstants,c=e.ZSConstants.wCC,S=e.ZSConstants.I18N,T=(E.view.Toolbar.transient,e.UIUtil.Component),d=e.ZSEvents,C=d.topic,v=d.Groups,p=d.Names,D=E.view.Toolbar.Feature[a.CELL_OPTIONS],N=E.view.Toolbar.Feature[a.INSERT_CELL_OPTIONS];D.constructCellsLeftMenuItem=t,D.constructCellsUpMenuItem=i,n()}(this);
!function(e){function t(){var e=s.createElement("li");return e.id=C.SUBMENUITEM+c.DELETE_COLUMN+C.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon-delete-column","label": "'+T["HomeTab.Column.Delete"]+'"}'),e.addEventListener("click",u),e}function n(){var e=s.createElement("li");return e.id=C.SUBMENUITEM+c.COLUMN_WIDTH+C.IDENTITY,e.setAttribute("data",'{"icon": "custFitCol","label": "'+T["HomeTab.Column.CustomFit"]+'"}'),e.addEventListener("click",b.showDialog),e}function a(){var e=s.createElement("li");return e.id=C.SUBMENUITEM+c.COLUMN_FIT+C.IDENTITY,e.setAttribute("data",'{"icon": "autoFitCol","label": "'+T["HomeTab.Column.AutoFit"]+'"}'),e.addEventListener("click",r),e}function i(){var e=document.createElement("ul");e.id=C.SUBMENUITEM+c.COL_OPTIONS+C.IDENTITY,e.setAttribute("ctype","zmenu"),e.appendChild(o(T["MenuItem.InsertTab.Column"])),e.appendChild(M.constructMenuItemLayout(e)),e.appendChild(b.constructMenuItemLayout(e)),e.appendChild(o(T["HomeTab.Column.ColumnWidth"])),e.appendChild(a()),e.appendChild(n()),I.appendChild(e),d.bind(e,"menubeforeshow",function(){l(e)})}function o(e){var t=s.createElement("li");return t.setAttribute("mtype","group"),t.setAttribute("relativeto","parent"),t.setAttribute("data",'{"label": "'+e+'"}'),t}function l(e){var t=e.id,n=E.view.getActiveGridID(),a=E.view.getSheetID(n),i=E.view.getSheetState(n,a),o=E.data.Defaults,l=i.getActiveRange(),u=l.endCol+1===o.MAX_COL,r=u?"disable":"enable",s=e.querySelector("#"+C.SUBMENUITEM+c.INSERT_COL+C.IDENTITY),I=e.querySelector("#"+C.SUBMENUITEM+c.DELETE_COLUMN+C.IDENTITY),m=l.endCol-l.startCol+1;d[r](s),d[r](I),m>1&&!u?(d.zmenu("#"+t,"changeLabel",C.SUBMENUITEM+c.INSERT_COL+C.IDENTITY,JSUtil.fn.replaceParams(T["HomeTab.Column.InsertNoofCols"],new Array(m+""))),d.zmenu("#"+t,"changeLabel",C.SUBMENUITEM+c.DELETE_COLUMN+C.IDENTITY,JSUtil.fn.replaceParams(T["HomeTab.Column.DeleteNoofCols"],new Array(m+"")))):(d.zmenu("#"+t,"changeLabel",C.SUBMENUITEM+c.INSERT_COL+C.IDENTITY,T["HomeTab.Column.Insert"]),d.zmenu("#"+t,"changeLabel",C.SUBMENUITEM+c.DELETE_COLUMN+C.IDENTITY,T["HomeTab.Column.Delete"]))}function u(){var t=E.view.getActiveGridID(),n=E.view.getResourceID(t),a=E.view.getSheetID(t),i=E.view.getVersionID(t),o=E.view.getSheetState(t,a),l=E.view.getSelectedSheets(t),u=E.view.CellEditor.getEditStatus(),r=o.getRanges();u&&S.publish(N.Gesture.Selector.CellEdit,v.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:a,VERSION:i,isSubmittable:1}),e.UserAction.DeleteCol(n,l,i,r)}function r(){var t=E.view.getActiveGridID(),n=E.view.getResourceID(t),a=E.view.getSheetID(t),i=E.view.getVersionID(t),o=E.data.getWorkBook(n,i),l=o.getSheetObj(a),u=E.view.getSheetState(t,a),r=u.getActiveRange(),s=r.endCol,I=r.startCol,c=s-I+1,T=l.Column.axis.getDim(I),C=E.view.getSelectedSheets(t);e.UserAction.ResizeCol(n,C,i,T,I,c,!0)}var E=e.sPlusPlus,s=e.document,I=s.getElementById("popupmenu"),c=e.ZSConstants.FeatureConstants,T=e.ZSConstants.I18N,C=e.ZSConstants.wCC,d=(E.view.Toolbar.transient,E.SML.Client,e.UIUtil.Component),m=(E.data.Defaults.MAX_ROW,e.ZSEvents),S=m.topic,N=m.Groups,v=m.Names,M=E.view.Toolbar.Feature[c.INSERT_COLUMN_OPTIONS],b=E.view.Toolbar.Feature[c.COL_OPTIONS];b.constructMenuItemLayout=t,b.constructCustomFitMenuItemLayout=n,b.constructAutoFitMenuItemLayout=a,i(),b.deleteCol=u}(this);
!function(e){function t(){var e=s.createElement("li");return e.id=d.SUBMENUITEM+c.DELETE_ROW+d.IDENTITY,e.setAttribute("data",'{"icon": "zicon zicon zicon-deleterow","label": "'+T["HomeTab.Row.Delete"]+'"}'),e.addEventListener("click",u),e}function n(){var e=s.createElement("li");return e.id=d.SUBMENUITEM+c.ROW_FIT+d.IDENTITY,e.setAttribute("data",'{"icon": "autoFitRow","label": "'+T["HomeTab.Row.AutoFit"]+'"}'),e.addEventListener("click",l),e}function i(){var e=document.createElement("li");return e.id=d.SUBMENUITEM+c.ROW_HEIGHT+d.IDENTITY,e.setAttribute("data",'{"icon": "custFitRow","label": "'+T["HomeTab.Row.CustomFit"]+'"}'),e.addEventListener("click",D.showDialog),e}function o(){var e=document.createElement("ul");e.id=d.SUBMENUITEM+c.ROW_OPTIONS+d.IDENTITY,e.setAttribute("ctype","zmenu"),e.appendChild(a(T["MenuItem.InsertTab.Row"])),e.appendChild(b.constructRowAboveMenuItem(e)),e.appendChild(D.constructMenuItemLayout(e)),e.appendChild(a(T["HomeTab.Row.RowHeight"])),e.appendChild(n(e)),e.appendChild(i(e)),I.appendChild(e),R.bind(e,"menubeforeshow",function(){r(e)})}function a(e){var t=s.createElement("li");return t.setAttribute("mtype","group"),t.setAttribute("relativeto","parent"),t.setAttribute("data",'{"label": "'+e+'"}'),t}function r(e){var t=e.id,n=E.view.getActiveGridID(),i=E.view.getSheetID(n),o=E.view.getSheetState(n,i),a=E.data.Defaults,r=o.getActiveRange(),u=r.endRow+1===a.MAX_ROW,l=u?"disable":"enable",s=r.endRow-r.startRow+1,I=e.querySelector("#"+d.SUBMENUITEM+c.INSERT_ROW+d.IDENTITY),w=e.querySelector("#"+d.SUBMENUITEM+c.DELETE_ROW+d.IDENTITY);R[l](I),R[l](w),s>1&&!u?(R.zmenu("#"+t,"changeLabel",d.SUBMENUITEM+c.INSERT_ROW+d.IDENTITY,JSUtil.fn.replaceParams(T["HomeTab.Row.InsertNoofRows"],new Array(s+""))),R.zmenu("#"+t,"changeLabel",d.SUBMENUITEM+c.DELETE_ROW+d.IDENTITY,JSUtil.fn.replaceParams(T["HomeTab.Row.DeleteNoofRows"],new Array(s+"")))):(R.zmenu("#"+t,"changeLabel",d.SUBMENUITEM+c.INSERT_ROW+d.IDENTITY,T["HomeTab.Row.Insert"]),R.zmenu("#"+t,"changeLabel",d.SUBMENUITEM+c.DELETE_ROW+d.IDENTITY,T["HomeTab.Row.Delete"]))}function u(){var t=E.view.getActiveGridID(),n=E.view.getResourceID(t),i=E.view.getSheetID(t),o=E.view.getVersionID(t),a=E.view.getSheetState(t,i),r=a.getRanges(),u=E.view.getSelectedSheets(t),l=E.view.CellEditor.getEditStatus();l&&S.publish(m.Gesture.Selector.CellEdit,v.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:i,VERSION:o,isSubmittable:1}),e.UserAction.DeleteRow(n,u,o,r)}function l(){var t=E.view.getActiveGridID(),n=E.view.getResourceID(t),i=E.view.getSheetID(t),o=E.view.getVersionID(t),a=E.data.getWorkBook(n,o),r=a.getSheetObj(i),u=E.view.getSheetState(t,i),l=u.getActiveRange(),s=l.endRow,I=l.startRow,c=s-I+1,T=r.Row.auxiliaryAxis.getDim(I),d=E.view.getSelectedSheets(t);e.UserAction.ResizeRow(n,d,o,T,I,c,!0)}var E=e.sPlusPlus,s=e.document,I=s.getElementById("popupmenu"),c=e.ZSConstants.FeatureConstants,T=e.ZSConstants.I18N,d=e.ZSConstants.wCC,R=(E.view.Toolbar.transient,E.SML.Client,e.UIUtil.Component),w=(E.data.Defaults.MAX_COL,e.ZSEvents),S=w.topic,m=w.Groups,v=w.Names,b=E.view.Toolbar.Feature[c.INSERT_ROW_OPTIONS],D=E.view.Toolbar.Feature[c.ROW_OPTIONS];D.constructMenuItemLayout=t,D.constructAutoFitMenuItemLayout=n,D.constructCustomFitMenuItemLayout=i,o(),D.deleteRow=u}(this);
!function(e){function t(){if(!M){var e=document.createElement("ul");e.id=C.SUBMENUITEM+i.INSERT+C.IDENTITY,e.setAttribute("ctype","zmenu"),e.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),e.appendChild(_.constructRowAboveMenuItem(e)),e.appendChild(_.constructRowBelowMenuItem(e)),e.appendChild(_.constructCopyRowAboveMenuItem(e)),e.appendChild(_.constructCopyRowBelowMenuItem(e)),e.appendChild(_.constructCutRowAboveMenuItem(e)),e.appendChild(_.constructCutRowBelowMenuItem(e));var t=U.cloneNode(!0);t.setAttribute("id",C.SP+i.INSERT+C.IDENTITY),e.appendChild(t),e.appendChild(O.constructColBeforeMenuItem(e)),e.appendChild(O.constructColAfterMenuItem(e)),e.appendChild(O.constructCopyColBeforeMenuItem(e)),e.appendChild(O.constructCopyColAfterMenuItem(e)),e.appendChild(O.constructCutColBeforeMenuItem(e)),e.appendChild(O.constructCutColAfterMenuItem(e));var o=U.cloneNode(!0);o.setAttribute("id",C.SP+i.SHIFT_CELLS_DOWN+C.IDENTITY),e.appendChild(o),e.appendChild(y.constructCellsToRightMenuItem()),e.appendChild(y.constructCellsDownMenuItem()),R.appendChild(e),M=!0,p.bind(e,"zmenubeforeshow",function(){l(e)})}}function o(e){var t=e.id;if(t===C.MI+"GRID_CONTEXT"||t===C.MI+"ROWHEAD_CONTEXT"||t===C.MI+"COLHEAD_CONTEXT"){var o=s.view.getActiveGridID(),l=s.view.getResourceID(o),n=s.view.getSheetID(o),r=s.view.getSheetState(o,n),I=s.data.Defaults,a=r.getActiveRange(),E=s.view.getVersionID(o),T=s.data.getWorkBook(l,E),u=T.ProtectedSheets.isSheetLocked(n),d=e.querySelector("#"+C.MI+i.INSERT+C.IDENTITY);a.endCol+1==I.MAX_COL&&a.endRow+1==I.MAX_ROW||u?d&&(d.style.display="none"):d&&(d.style.display="block")}}function l(e){var t=(e.querySelectorAll("li"),s.view.getActiveGridID()),o=s.view.getResourceID(t),l=s.view.getSheetID(t),E=s.view.getSheetState(t,l),T=s.view.getVersionID(t),u=s.data.getWorkBook(o,T),d=u.getSheetObj(l),c=s.data.Defaults,S=E.getActiveRange(),N=s.data.UserInfo,R=N.activeInfo.getVisualCueStatus(),M=s.data.UserInfo.activeInfo.isCopy,p=s.data.UserInfo.activeInfo.copyRanges;if(n(e),a(e,S,c,M),S.endRow+1!=c.MAX_ROW){var y=d.Row.Visibility.getOnCount(S.startRow,S.endRow);r(e,S,R,M,p,c,y)}if(S.endCol+1!=c.MAX_COL){var _=d.Column.hidden.getOnCount(S.startCol,S.endCol);I(e,S,R,M,p,c,_)}S.endCol+1!=c.MAX_COL&&S.endRow+1!=c.MAX_ROW&&(e.querySelector("#"+C.SP+i.INSERT+C.IDENTITY).style.display="block")}function n(e){for(var t=e.querySelectorAll("li"),o=0;o<t.length;o++)t[o].style.display="none"}function r(e,t,o,l,n,r,I){var a=0==t.startCol&&t.endCol==r.MAX_COL-1,s=n.Ranges?n.Ranges[0].startCol:void 0,E=n.Ranges?n.Ranges[0].endCol:void 0;if(a&&o&&0==s&&E+1==r.MAX_COL&&void 0!=l)0==l?(e.querySelector("#"+C.SUBMENUITEM+i.INSERT_CUT_ROW_ABOVE+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.INSERT_CUT_ROW_BELOW+C.IDENTITY).style.display="block"):(e.querySelector("#"+C.SUBMENUITEM+i.INSERT_COPY_ROW_ABOVE+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.INSERT_COPY_ROW_BELOW+C.IDENTITY).style.display="block");else{var T=t.endRow-t.startRow+1;T-=I;var u,d;T>1?(u=JSUtil.fn.replaceParams(N.NoofRowsAbove,new Array(T+"")),d=JSUtil.fn.replaceParams(N.NoofRowsBelow,new Array(T+""))):(u=N.RowAbove,d=N.RowBelow),p.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+i.INSERT_ROW_ABOVE+C.IDENTITY],"label",u),p.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+i.INSERT_ROW_BELOW+C.IDENTITY],"label",d),e.querySelector("#"+C.SUBMENUITEM+i.INSERT_ROW_ABOVE+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.INSERT_ROW_BELOW+C.IDENTITY).style.display="block"}}function I(e,t,o,l,n,r,I){var a=0==t.startRow&&t.endRow==r.MAX_ROW-1,s=n.Ranges?n.Ranges[0].startRow:void 0,E=n.Ranges?n.Ranges[0].endRow:void 0;if(a&&o&&0==s&&E+1==r.MAX_ROW&&void 0!=l)0==l?(e.querySelector("#"+C.SUBMENUITEM+i.INSERT_CUT_COLUMN_BEFORE+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.INSERT_CUT_COLUMN_AFTER+C.IDENTITY).style.display="block"):(e.querySelector("#"+C.SUBMENUITEM+i.INSERT_COPY_COLUMN_BEFORE+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.INSERT_COPY_COLUMN_AFTER+C.IDENTITY).style.display="block");else{var T=t.endCol-t.startCol+1;T-=I;var u,d;T>1?(u=JSUtil.fn.replaceParams(N.NoofColumnsBefore,new Array(T+"")),d=JSUtil.fn.replaceParams(N.NoofColumnsAfter,new Array(T+""))):(u=N.ColumnBefore,d=N.ColumnAfter),p.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+i.INSERT_COLUMN_BEFORE+C.IDENTITY],"label",u),p.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+i.INSERT_COLUMN_AFTER+C.IDENTITY],"label",d),e.querySelector("#"+C.SUBMENUITEM+i.INSERT_COLUMN_BEFORE+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.INSERT_COLUMN_AFTER+C.IDENTITY).style.display="block"}}function a(e,t,o){e.id==C.SUBMENUITEM+i.INSERT+C.IDENTITY&&t.endCol+1!=o.MAX_COL&&t.endRow+1!=o.MAX_ROW&&(e.querySelector("#"+C.SUBMENUITEM+i.SHIFT_CELLS_RIGHT+C.IDENTITY).style.display="block",e.querySelector("#"+C.SUBMENUITEM+i.SHIFT_CELLS_DOWN+C.IDENTITY).style.display="block",e.querySelector("#"+C.SP+i.SHIFT_CELLS_DOWN+C.IDENTITY).style.display="block")}var s=e.sPlusPlus,E=e.ZSConstants,i=E.FeatureConstants,T=e.ZSEvents,u=T.topic,d=T.Groups,c=T.Names,S=e.document,N=e.ZSConstants.I18N,C=e.ZSConstants.wCC,R=(s.view.SubMenu.transient,S.getElementById("popupmenu")),M=!1,p=e.UIUtil.Component,y=s.view.Toolbar.Feature[i.INSERT_CELL_OPTIONS],_=s.view.Toolbar.Feature[i.INSERT_ROW_OPTIONS],O=s.view.Toolbar.Feature[i.INSERT_COLUMN_OPTIONS],U=function(){var e=S.createElement("li");return e.setAttribute("mtype","separator"),e}();t(),u.register(d.UI,c.Menu.CONTEXT_BEFORE_SHOW,o,"UI")}(this);
!function(e){function t(){if(!p){var e=document.createElement("ul");e.id=C.SUBMENUITEM+S.DELETE+C.IDENTITY,e.setAttribute("ctype","zmenu"),e.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),e.appendChild(y.constructMenuItemLayout()),e.appendChild(L.constructMenuItemLayout());var t=U.cloneNode(!0);t.setAttribute("id",C.SP+S.SHIFT_CELLS_UP+C.IDENTITY),e.appendChild(t),e.appendChild(m.constructCellsUpMenuItem()),e.appendChild(m.constructCellsLeftMenuItem()),N.appendChild(e),p=!0,D.bind(e,"zmenubeforeshow",function(){o(e)})}}function n(e){var t=e.id;if(t===C.MI+"GRID_CONTEXT"||t===C.MI+"ROWHEAD_CONTEXT"||t===C.MI+"COLHEAD_CONTEXT"){var n=E.view.getActiveGridID(),o=E.view.getResourceID(n),l=E.view.getSheetID(n),a=E.view.getSheetState(n,l),i=E.data.Defaults,r=a.getActiveRange(),s=E.view.getVersionID(n),u=E.data.getWorkBook(o,s),I=u.ProtectedSheets.isSheetLocked(l),T=e.querySelector("#"+C.MI+S.DELETE+C.IDENTITY);r.endCol+1==i.MAX_COL&&r.endRow+1==i.MAX_ROW||I?T&&(T.style.display="none"):T&&(T.style.display="block")}}function o(e){var t=(e.id,E.view.getActiveGridID()),n=E.view.getSheetID(t),o=E.view.getSheetState(t,n),s=o.getActiveRange(),u=E.data.Defaults;l(e),a(e,s,u),i(e,s,u),r(e,s,u)}function l(e){for(var t=e.querySelectorAll("li"),n=0;n<t.length;n++)t[n].style.display="block"}function a(e,t,n){t.endRow+1===n.MAX_ROW&&(e.querySelector("#"+C.SUBMENUITEM+S.DELETE_ROW+C.IDENTITY).style.display="none");var o=t.endRow-t.startRow+1;if(o>1){var l=JSUtil.fn.replaceParams(M["HomeTab.Row.DeleteNoofRows"],new Array(o+""));D.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+S.DELETE_ROW+C.IDENTITY],"label",l)}else D.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+S.DELETE_ROW+C.IDENTITY],"label",M["HomeTab.Row.Delete"])}function i(e,t,n){t.endCol+1===n.MAX_COL&&(e.querySelector("#"+C.SUBMENUITEM+S.DELETE_COLUMN+C.IDENTITY).style.display="none");var o=t.endCol-t.startCol+1;if(o>1){var l=JSUtil.fn.replaceParams(M["HomeTab.Column.DeleteNoofCols"],new Array(o+""));D.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+S.DELETE_COLUMN+C.IDENTITY],"label",l)}else D.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+C.SUBMENUITEM+S.DELETE_COLUMN+C.IDENTITY],"label",M["HomeTab.Column.Delete"])}function r(e,t,n){(t.endCol+1===n.MAX_COL||t.endRow+1===n.MAX_ROW)&&(e.querySelector("#"+C.SUBMENUITEM+S.SHIFT_CELLS_LEFT+C.IDENTITY).style.display="none",e.querySelector("#"+C.SUBMENUITEM+S.SHIFT_CELLS_UP+C.IDENTITY).style.display="none",e.querySelector("#"+C.SP+S.SHIFT_CELLS_UP+C.IDENTITY).style.display="none")}var E=e.sPlusPlus,s=e.ZSEvents,u=s.topic,I=s.Groups,T=s.Names,d=e.ZSConstants,S=d.FeatureConstants,c=e.document,M=e.ZSConstants.I18N,C=e.ZSConstants.wCC,N=(E.view.SubMenu.transient,c.getElementById("popupmenu")),p=!1,D=(E.SML.Client,e.UIUtil.Component),m=E.view.Toolbar.Feature[S.CELL_OPTIONS],y=E.view.Toolbar.Feature[S.ROW_OPTIONS],L=E.view.Toolbar.Feature[S.COL_OPTIONS],U=function(){var e=c.createElement("li");return e.setAttribute("mtype","separator"),e}();t(),u.register(I.UI,T.Menu.CONTEXT_BEFORE_SHOW,n,"UI")}(this);
!function(t){function e(){if(!r){var t=document.createElement("ul");t.id=i.SUBMENUITEM+o.ROW_HEIGHT_OPTIONS+i.IDENTITY,t.setAttribute("ctype","zmenu"),t.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),t.setAttribute("relativeto","parent"),t.appendChild(c.constructAutoFitMenuItemLayout()),t.appendChild(c.constructCustomFitMenuItemLayout()),p.appendChild(t),r=!0}}var n=t.sPlusPlus,u=t.ZSConstants,o=u.FeatureConstants,s=t.ZSEvents,a=(s.topic,s.Groups,s.Names,t.document),i=(t.ZSConstants.I18N,t.ZSConstants.wCC),p=(n.view.SubMenu.transient,a.getElementById("popupmenu")),r=!1,c=(t.UIUtil.Component,n.view.Toolbar.Feature[o.ROW_OPTIONS]);e()}(this);
!function(t){function e(){if(!r){var t=document.createElement("ul");t.id=i.SUBMENUITEM+o.COLUMN_WIDTH_OPTIONS+i.IDENTITY,t.setAttribute("ctype","zmenu"),t.setAttribute("data",'{"componentOptions":{"type":"text_only"}}'),t.setAttribute("relativeto","parent"),t.appendChild(c.constructAutoFitMenuItemLayout()),t.appendChild(c.constructCustomFitMenuItemLayout()),p.appendChild(t),r=!0}}var n=t.sPlusPlus,u=t.ZSConstants,o=u.FeatureConstants,s=t.ZSEvents,a=(s.topic,s.Groups,s.Names,t.document),i=(t.ZSConstants.I18N,t.ZSConstants.wCC),p=(n.view.SubMenu.transient,a.getElementById("popupmenu")),r=!1,c=(t.UIUtil.Component,n.view.Toolbar.Feature[o.COL_OPTIONS]);e()}(this);
!function(e){function t(){var t="https://"+c.DOCS_SERVER_URL+"/createnew.do?service=zohosheet&parentid=-1&type=document",n=e.window.open(t);n=null}function n(){var e=document.getElementById("popupmenu"),t=r.createElement("ul");t.id=i.SPLIT+u.NEW_FILE+i.MENU,t.setAttribute("mtype","submenu");var n=document.createElement("li");n.id=i.MI+u.NEW_FILE+i.IDENTITY,n.setAttribute("data",'{"icon":"zicon zicon-newdocument", "label":"'+d["MenuItem.FileTab.NewSpreadsheet"]+'"}'),n.addEventListener("click",function(e){E.createNewDocument(e)}),t.appendChild(n),l.createMenuElement(t),e.appendChild(t)}var a=e.sPlusPlus,o=e.ZSConstants,u=o.FeatureConstants,i=o.wCC,c=a.data.AppRegistry,r=e.document,s=e.ZSEvents,d=(s.topic,s.Groups,s.Names,e.ZSConstants.I18N),E=a.view.Toolbar.Feature[u.NEW_FILE],l=a.view.Toolbar.Feature[u.NEW_TEMPLATE];E.createNewDocument=t,n()}(this);
!function(t){function e(){var e="https://"+n.DOCS_SERVER_URL+"/createnew.do?service=zohosheet&parentid=-1&type=template",s=t.window.open(e);s=null}var s=t.sPlusPlus,a=t.ZSConstants.FeatureConstants,n=(t.ZSConstants.wCC,s.data.AppRegistry),o=s.view.Toolbar.Feature[a.NEW_TEMPLATE];o.createNewTemplate=e}(this);
!function(t){function e(){ZSClass.KeyMapping.call(this)}function n(){I.initFcomponents(),g.focusContext(g.Entry.Dialog.Context),A||(I.bind("#znotifycollaborator","zdialogclose",function(){g.focusContext(g.Entry.CellEditor.Context)}),A=!0);var t=r.view.getActiveGridID(),e=r.view.getResourceID(t);I.notifyCollaborator(e)}function o(t){d=t}function i(t){I.zmenu(t,"setMenuItemsAttribute",["#"+u.MI+a.NOTIFY_COLLABORATOR+u.MENU],"disabled",!d)}function s(){{var t=r.view.getActiveGridID();r.view.getResourceID(t)}}var r=t.sPlusPlus,a=t.ZSConstants.FeatureConstants,u=(t.document,t.ZSConstants.I18N,t.ZSConstants.wCC),c=t.ZSEvents,l=c.topic,C=c.Groups,v=c.Names,I=t.UIUtil.Component,d=!1,f=r.view.Toolbar.Feature[a.NOTIFY_COLLABORATOR],E=new e,g=r.view.Events.Key;g.Entry.Dialog.Node.addChildNode(E);var A=!1;f.execute=n,s(),l.register(C.Listener,v.ShareMeta.SHARE_UPDATE,o,"ISSHARED"),l.register(C.UI,v.Toolbar.INIT_MENU,i,"DOM")}(this);
!function(e){function t(e){var t=i.view.getActiveGridID(),s=i.view.getResourceID(t),n=i.view.getSheetID(t),r=i.view.getVersionID(t);e?(a.showUserPresence=!0,u.publish(I.Listener,c.DocAction.COLLAB_LIST.SHOW,{RID:s,SHEETID:n,VERSION:r})):(a.showUserPresence=!1,u.publish(I.Listener,c.DocAction.COLLAB_LIST.HIDE,{RID:s,SHEETID:n,VERSION:r}))}function s(e){return i.data.getSharePublishMeta(e).isShared()}function n(e){if(a.parent==e){var t=i.view.getActiveGridID(),n=i.view.getResourceID(t);s(n)?S.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+o.MI+r.USER_PRESENCE+o.MENU],"hidden",!1):S.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+o.MI+r.USER_PRESENCE+o.MENU],"hidden",!0)}S.zmenu("#"+e.id,"setMenuItemsAttribute",["#"+o.MI+r.USER_PRESENCE+o.MENU],"checked",a.showUserPresence)}var i=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,o=(e.document,e.ZSConstants.I18N,e.ZSConstants.wCC),E=e.ZSEvents,u=E.topic,I=E.Groups,c=E.Names,S=e.UIUtil.Component,a=i.view.Toolbar.Feature[r.USER_PRESENCE];a.showUserPresence=!0,a.execute=t,u.register(I.UI,c.Toolbar.INIT_MENU,n,"DOM")}(this);
!function(e){function t(){E&&clearTimeout(E),E=setTimeout(function(){R=!0},500),u()}function i(){clearTimeout(E),R=!1,u()}function r(e){var t=e.isProtected?"disable":"enable";$(A.parentNode).zbutton(t,"#"+D.MI+C.FORMAT_PAINTER+D.IDENTITY)}function n(){S.register(T.Listener,v.ContextMenu.UPDATE,r,"CELL_VALUE")}function s(){if(A){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),r=I.view.getVersionID(e);A=!1,R=!0,c(),a(),S.publish(T.Gesture.Selector.FormatPainter,v.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:i,VERSION:r})}}function o(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSelectedSheets(e),r=I.view.getVersionID(e);if(UserAction.PasteFromSheet(t,i,r,void 0,!1),R){A=!A;var n=I.view.getSheetID(e);S.publish(T.Gesture.Selector.FormatPainter,v.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:n,VERSION:r})}c(),a()}function a(){if(A){var t=e.document.querySelector(".fpCur");t.addEventListener("mouseup",o)}else{var t=e.document.querySelector(".mainGrid");"mainGrid fpCur"!=t.className&&t.removeEventListener("mouseup",o)}}function c(){if(A){var t=e.document.querySelector(".mainGrid");"mainGrid fpCur"!=t.className&&(t.classList.add("fpCur"),f.parentNode.classList.add("shIconActive"))}else if(R){var t=e.document.querySelector(".fpCur");t.className="mainGrid",f.parentNode.classList.remove("shIconActive")}}function u(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),r=I.view.getVersionID(e);N.activeInfo.setCopyState(0),A=!A,S.publish(T.Listener,v.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:i,VERSION:r}),A?S.publish(T.Gesture.Selector.FormatPainter,v.GESTURE.ACTION.ACTUATE,{RID:t,SHEETID:i,VERSION:r,isSingleTap:R}):(S.publish(T.Gesture.Selector.FormatPainter,v.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:i,VERSION:r,isSingleTap:R}),R||(R=!0)),c(),a()}var E,I=e.sPlusPlus,l=e.ZSEvents,S=l.topic,T=l.Groups,v=l.Names,d=e.ZSConstants.FeatureConstants,m=e.document,A=!1,R=!0,D=(e.ZSConstants.I18N,e.ZSConstants.wCC),N=(e.UserAction,I.data.UserInfo),f=m.querySelector("#"+D.MI+d.FORMAT_PAINTER+D.IDENTITY),p=I.view.Toolbar.Feature[d.FORMAT_PAINTER];p.singleClick=t,p.doubleClick=i,n(),p.negateFormatPainter=s}(this);
!function(e){function t(){var e=n.view.getActiveGridID(),t=n.view.getResourceID(e),i=n.view.getVersionID(e),o=n.data.getWorkBook(t,i),r=o.Name;s.disabled=!0,a.classList.add("ZsIconLoader"),UserAction.useTemplate(t,i,r,function(e){if(a.classList.remove("ZsIconLoader"),e&&e.di){var t=window.location.origin+n.data.AppRegistry.ctxpath+n.data.AppRegistry.ClientURI+e.di;s.disabled=!1,window.location.href=t}})}function i(e){if(e){var n=r.querySelector("#TB_SHARE_BTN");s=r.createElement("button");var l=r.createElement("div");a=r.createElement("div"),E.fn.addIcon(a,"TB_TEMPLATE_ICON"),s.id=c.MI+o.MY_TEMPLATES+c.IDENTITY,s.className="Zsbtn ZsShare ZsNoDropDown",l.innerText=d["Topbar.UsethisTemplate"],s.title=d["Topbar.UsethisTemplate"],s.addEventListener("click",t),s.appendChild(a),s.appendChild(l),n.appendChild(s)}p.unregister(T.Listener,u.DocMeta.DOCUMENT_MODE,i)}var s,a,n=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,r=e.document,d=e.ZSConstants.I18N,c=e.ZSConstants.wCC,l=e.ZSEvents,p=l.topic,T=l.Groups,u=l.Names,E=e.UIUtil;p.register(T.Listener,u.DocMeta.DOCUMENT_MODE,i,"isTemplate")}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=s.view.getVersionID(e),r=s.view.getSheetID(e),o=s.view.getGridComponent(e),S=o.getCenterPoint(),E=25,v=85,u=S.x-v/2,c=S.y-E/2,I=new ZSClass.Button("",u,c,v,E);UserAction.AddButton(t,r,n,I,i)}function i(){S.register(E.Listener,v.ServerAction.PROCESSRESPONSE,n,"RESPONSE")}function n(e){var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),r=s.view.getVersionID(t),o=s.view.getSheetID(t),c=e[u.DOCUMENT_META][i],I=c[u.SHEET_META][o],T=I[u.BUTTON];if(T[u.INSERT]){var a=T[u.INSERT][0];S.publish(E.Listener,v.UserAction.BUTTONS.EDIT,{RID:i,SHEETID:o,VERSION:r,ID:a})}S.unregister(E.Listener,v.ServerAction.PROCESSRESPONSE,n)}var s=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,o=e.ZSEvents,S=o.topic,E=o.Groups,v=o.Names,u=e.ZSConstants.CommandConstants,c=s.view.Toolbar.Feature[r.BUTTON];c.execute=t}(this);
!function(e){function t(){var t=s.view.getActiveGridID(),r=s.view.getResourceID(t),i=(s.view.getSheetID(t),s.view.getVersionID(t)),o=s.view.getSelectedSheets(t);R.show(!0),e.UserAction.Recalculate(r,o,i,n)}function n(){R.remove(),S.register(c.Listener,E.ServerAction.PROCESSTRIMCELLRESPONSE,r,"DOCID","SHEETID","VERSION","ROW_DATA","COLUMN_DATA","XAID","CONDITIONAL_FORMAT")}function r(e,t,n,s,i){if(!s||!i)return void Logger.log("EMPTY DATA RESPONSE",s,i);for(var o=0,a=s.length-1;a>=0;a--)for(var v=s[a],R=v[0]+v[1]-1,u=v[0],l=R;l>=u;l--)for(var C=i[v[2]],I=C.length-1;I>=0;I--){var A=C[I];if(A)for(var D=A[0]+A[1]-1,g=A[0],T=D;T>=g;T--)S.publish(c.Listener,E.Layers.Recalculate.Place,{RID:e,SHEETID:t,VERSION:n,ID:o++,RANGE:new ZSClass.Range(l,T,l,T)})}S.unregister(c.Listener,E.ServerAction.PROCESSTRIMCELLRESPONSE,r)}var s=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,o=e.ZSConstants.I18N,a=e.ZSEvents,S=a.topic,c=a.Groups,E=a.Names,v=(e.ZSConstants.CommandConstants,s.view.Toolbar.Feature[i.RECALCULATE]),R=new ZSClass.TBNotification(o.Recalculating+"...",{mode:"STD",type:"info"});v.execute=t}(this);
!function(e){function t(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),n=s.view.getVersionID(e),o=s.data.getWorkBook(t,n),g=(o.getSheetObj(i),s.view.getSheetState(e,i)),c=g.getActiveCellRange();a.publish(r.Listener,v.CellAction.COMMENT.NEW,{RID:t,SHEETID:i,VERSION:n,ROW:c.startRow,COL:c.startCol})}function i(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),n=s.view.getVersionID(e),o=s.view.getSheetState(e,i),a=o.getActiveRange(),r=s.view.getSelectedSheets(e);UserAction.CellComment(t,r,n,"remove","",a)}var s=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,o=e.ZSEvents,a=o.topic,r=o.Groups,v=o.Names,g=(e.ZSConstants.CommandConstants,e.UIUtil.Component,e.ZSConstants.I18N,s.view.Toolbar.Feature[n.NOTE]);g.execute=t,g.Clear=i}(this);
!function(e){function t(e){u=c.createElement("li"),u.setAttribute("data-value","showAllNotes"),u.setAttribute("data-item-type","checkbox"),u.innerText=S["Viewsettings.notes"],u.addEventListener("click",n),e.appendChild(u)}function i(e,t){r=t,n(e)}function n(e){D?(o(e),D=!1):(s(e),D=!0)}function s(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),n=I.view.getVersionID(e);N.publish(w.Listener,C.CellAction.COMMENT.SHOWALL,{RID:t,SHEETID:i,VERSION:n})}function o(){var e=I.view.getActiveGridID(),t=I.view.getResourceID(e),i=I.view.getSheetID(e),n=I.view.getVersionID(e);N.publish(w.Listener,C.CellAction.COMMENT.HIDEALL,{RID:t,SHEETID:i,VERSION:n})}function l(e){"sidePanelViewSetting"==e.id&&A.zmenu("#sidePanelViewSetting","setMenuItemsAttribute",[u],"checked",D)}var u,r,I=e.sPlusPlus,c=e.document,a=e.ZSConstants.FeatureConstants,A=(e.ZSConstants.wCC,e.UIUtil.Component),E=e.ZSEvents,N=E.topic,w=E.Groups,C=E.Names,S=e.ZSConstants.I18N,v=I.view.Toolbar.Feature[a.NOTE_SHOW_HIDE],D=!1;N.register(w.UI,C.Toolbar.INIT_MENU,l,"DOM"),N.register(w.Listener,C.CellAction.COMMENT.SHOWALL,function(){A.zmenu("#TB_VIEW_POPUP_CONTAINER","setMenuItemsAttribute",[r],"label",S["Notes.HideNotes"])}),N.register(w.Listener,C.CellAction.COMMENT.HIDEALL,function(){A.zmenu("#TB_VIEW_POPUP_CONTAINER","setMenuItemsAttribute",[r],"label",S["MenuItem.View.ShowAllNotes"])}),v.createShowAllMenu=t,v.execute=i,v.ShowAll=s,v.HideAll=o}(this);
!function(e){function t(){var t=v.view.getActiveGridID(),i=v.view.getSelectedSheets(t),s=v.view.getResourceID(t),n=(v.view.getSheetID(t),v.view.getVersionID(t));e.UserAction.CHECKBOX_ADD(s,i,n)}function i(){var t=v.view.getActiveGridID(),i=v.view.getSelectedSheets(t),s=v.view.getResourceID(t),n=(v.view.getSheetID(t),v.view.getVersionID(t));e.UserAction.CHECKBOX_CLEAR(s,i,n)}function s(){var t=v.view.getActiveGridID(),i=v.view.getSelectedSheets(t),s=v.view.getResourceID(t),n=(v.view.getSheetID(t),v.view.getVersionID(t));e.UserAction.CLEARCONTENTS(s,i,n)}var v=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,o=e.ZSEvents,r=(o.topic,o.Groups,o.Names,e.ZSConstants.CommandConstants,v.view.Toolbar.Feature[n.INPUT_CONTROLS]);r.execute=t,r.Clear=i,r.Remove=s}(this);
!function(t){function s(){var t=new o.SBFeature("KEYBOARDSHORTCUT"),s=t.div;s.className="sTKeyBrd",d.fn.addIcon(s,"KEYBOARD_ICON"),s.title=a["StatusBar.KeyBoardShortcuts"],t.add(),s.onclick=e}function e(){var t="https://docs.zoho.com/sheet/published.do?rid=hd3vbaba6ca4cf0d3468d8d6cfe22b15b024e&mode=html";window.open(t)}var o=t.ZSClass,a=t.ZSConstants.I18N,d=t.UIUtil,c=t.ZSEvents,n=c.topic,i=c.Groups,r=c.Names;n.register(i.UI,r.Layout.TEMPLATE_LOADED,s)}(this);
!function(e){function t(){T.className="aggregationHolderVal",T.setAttribute("data-menu-id","aggreateNode"),T.style.display="none",N.add(),a()}function a(){l=document.createElement("ul"),l.id="aggreateNode",l.setAttribute("data-ctype","zmenu"),g.appendChild(l)}function n(){l.innerHTML="";for(var e in C)if(void 0!=C[e]){var t=i(e);l.appendChild(t)}c=l.children[0]}function i(e){var t=document.createElement("li");return s(t,e),t.addEventListener("click",function(){var e=this.dataset.akey,t=this.dataset.value;r(e,t),d(e,t),o(e)}),t}function s(e,t){e.setAttribute("mtype","custom"),e.classList.add("ui-zmenu-item"),e.dataset.akey=t,e.dataset.value=C[t],e.innerText=E[t]+" : "+C[t]}function u(e){if(0==Object.keys(e).length)return void(T.style.display="none");for(var t in E)C[t]=e[t];n();var a=k.akey?k.akey:A.akey;void 0===C[a]&&(a="count");var i=C[a];d(a,i),o(a)}function r(e,t){k.akey=e,k.value=t}function d(e,t){T.textContent=E[e]+" = "+t,T.style.display="block"}function o(e){for(var t=0;t<l.children.length;t++)l.children[t].classList.remove("selected"),e==l.children[t].dataset.akey&&l.children[t].classList.add("selected")}var c,l,m=e.sPlusPlus,v=(e.document,e.ZSClass),y=e.ZSEvents,f=y.topic,S=y.Groups,p=y.Names,g=document.getElementById("popupmenu"),h=e.ZSConstants.I18N,k=(e.UIUtil.Component,m.view.measures,{}),A={akey:"sum",value:0},C={},E={sum:h["StatusBar.Sum"],avg:h["StatusBar.Average"],min:h["StatusBar.Minimum"],max:h["StatusBar.Maximum"],count:h["StatusBar.Count"],cn:h["StatusBar.CountNumbers"]},N=new v.SBFeature("AGGREGATEFUNCTION"),T=N.div;f.register(S.Listener,p.SheetAction.ACTIVE_CELL_RANGE.STATUS,u,"STATUS"),t()}(this);
!function(e){function t(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getSheetID(e),o=a.view.getVersionID(e),u=a.data.getWorkBook(t,o),d=u.SheetList.getSheets();r&&r.remove(),r=s.createElement("ul"),r.setAttribute("data-ctype","zmenu"),r.setAttribute("data-min-width",160),r.setAttribute("data-content-type","icon-text"),r.id=c.SUBMENUITEM+"SHEETLIST"+c.IDENTITY;var v=n(d,i);r.appendChild(v),I.appendChild(r)}function i(e){var t=a.view.getActiveGridID(),i=a.view.getResourceID(t),n=a.view.getSheetID(t),r=a.view.getVersionID(t);UserAction.SwitchSheet(i,n,r,e),u.publish(d.Listener,v.DocMeta.SCROLL_SHEET,{RID:i,SHEETID:e,VERSION:r})}function n(e,t){for(var n=s.createDocumentFragment(),r=e.length,a=0;r>a;a++){var c=e[a],o=s.createElement("li");o.setAttribute("data-item-type","checkbox"),c.Id==t&&o.setAttribute("data-checked",!0),o.innerText=c.Name,o.addEventListener("click",i.bind(null,c.Id)),n.appendChild(o)}return n}var r,a=e.sPlusPlus,s=e.document,c=e.ZSConstants.wCC,o=e.ZSEvents,u=(e.UIUtil.Component,o.topic),d=o.Groups,v=o.Names,I=(a.view.measures,s.getElementById("popupmenu")),E=a.view.Toolbar.Feature.VIEW_SHEET_LIST;E.createSheetList=t}(this);
!function(e){function t(e,t){if(g){l.style.pointerEvents="none",g=!1,o=new ZSClass.TBNotification(E["Statusbar.Sheet.Creating"],{mode:"STD",type:"info"}),o.show(!0);var i=r.view.getActiveGridID(),s=r.view.getResourceID(i),n=(r.view.getSheetID(i),r.view.getVersionID(i)),a=r.view.getSelectedSheets(i),S=!t;UserAction.InsertSheet(s,a,n,void 0,void 0,void 0,S)}}function i(){g||(l.style.pointerEvents="auto",g=!0,o.remove())}function s(){I.style.display="none"}function n(){I.style.display=""}var o,r=e.sPlusPlus,a=e.ZSConstants,S=a.FeatureConstants,c=(e.UserAction,e.ZSEvents),v=c.topic,u=c.Groups,d=c.Names,E=e.ZSConstants.I18N,T=r.view.Toolbar.Feature[S.INSERT_SHEET],l=T.addSheetBtn,I=T.addBtnHolder,g=!0;T.execute=t,v.register(u.Listener,d.DocMeta.SHEET_ACTION_LISTENER,i),v.register(u.Listener,d.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE,s),v.register(u.UI,d.SidePanel.VersionHistory.CLOSE,n)}(this);
!function(e){function t(){L=!0,o("left")}function r(){L=!0,o("right")}function o(e){var t=S.scrollLeft,r="left"===e?t-a:t+a;S.scrollLeft=r,setTimeout(function(){L&&o(e)},5)}function s(){L=!1}function i(){var e=S.scrollWidth,t=S.offsetWidth;f.navHolder.style.display=e>t?"":"none"}var n=e.sPlusPlus,c=e.ZSEvents,l=c.topic,u=c.Groups,E=c.Names,f=n.view.Toolbar.Feature.SHEET_NAVIGATION,S=document.querySelector("#MI_SHEET_HOLDER"),a=20,L=!1;f.scrollLeft=t,f.scrollRight=r,f.stopScroll=s;var T=JSUtil.fn.debounce(i,200);l.register(u.Listener,E.Browser.RESIZE,T),l.register(u.Listener,E.Browser.UISheetLoad,T),l.register(u.Listener,E.DocAction.WORKSHEETS.INSERT,T),l.register(u.Listener,E.DocAction.WORKSHEETS.DELETE,T)}(this);
!function(e){function t(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),s=i.view.getVersionID(e),n=i.data.getWorkBook(t,s),a=i.view.getSheetID(e),r=n.getSheetObj(a),S=r.Prop.Name,r=n.getSheetObj(a),u=n.ProtectedSheets.isSheetLocked(a),l=r.ProtectedRanges.isRangesAvailable(),g=i.view.getSelectedSheets(e);if(u||l){var h=new ZSClass.ZSConfirm(c["DuplicateSheet.LockConfirmMsg"]);h.onYES(function(){o.DuplicateSheet(t,g,s,S,!0,S)}),h.onNO(function(){o.DuplicateSheet(t,g,s,S,!1,S)});{h.execute()}}else o.DuplicateSheet(t,g,s,S,!1,S)}var i=e.sPlusPlus,o=e.UserAction,s=i.view.Toolbar.Feature.DUPLICATE_SHEET,c=e.ZSConstants.I18N;s.execute=t}(this);
!function(e){function t(){var t=s.view.getActiveGridID(),o=s.view.getResourceID(t),r=s.view.getVersionID(t,o),n=s.view.getSelectedSheets(t),v=n[0],S=s.data.getWorkBook(o,r),c=S.SheetList.getById(v),l=c.getName();l='"'+l+'"';var g=a["SheetTab.DeleteSheet.Warning"],u=e.JSUtil.fn.replaceParams(g,[l]),h=[{text:a.Yes,primary:!0,click:function(){i()}},{text:a.No}],w={buttons:h,title:a["Alert.Title.SheetDelete"]};ZSClass.ZSAlert(u,w)}function i(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),o=s.view.getVersionID(e),r=s.data.getWorkBook(t,o),a=(r.getSheetObj(i),r.SheetList.getNextAvalable(i),s.view.getSelectedSheets(e));UserAction.RemoveSheet(t,a,o)}var s=e.sPlusPlus,o=e.ZSConstants,r=(o.FeatureConstants,e.UserAction,e.ZSEvents),a=(r.topic,r.Groups,r.Names,e.ZSConstants.I18N),n=s.view.Toolbar.Feature.DELETE_SHEET;n.execute=t}(this);
!function(e){function t(e,t,o){var r=i.data.getWorkBook(e,o),s=r.getSheetObj(t),a=s.Prop.Name,n=i.view.getActiveGridID(),v=i.view.getSelectedSheets(n);UserAction.serverClipCopySheet(e,v,o,a)}function o(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),o=i.view.getSheetID(e),r=i.view.getVersionID(e),s=i.data.getWorkBook(t,r),a=s.getSheetObj(o),n=a.Prop.Name,v=i.view.getSelectedSheets(e);UserAction.serverClipCopySheet(t,v,r,n)}{var i=e.sPlusPlus,r=e.ZSConstants,s=(r.FeatureConstants,e.UserAction,e.ZSEvents),a=(s.topic,s.Groups,s.Names,e.ZSConstants.I18N,i.view.Toolbar.Feature.COPY_SHEET);i.view.Toolbar.Feature.PASTE_SHEET}a.execute=o,a.copySheetAction=t}(this);
!function(e){function t(t,s,r){var i=o.data.getWorkBook(t,r),n=i.getSheetObj(s),c=(n.Prop.Name,o.view.getActiveGridID()),S=o.view.getSelectedSheets(c);e.UserAction.CopyRefSheets(t,r,S,"sdoc",a)}function s(e,t,s,a){var r=sPlusPlus.data.AppRegistry.ctxpath+o.data.AppRegistry.ClientURI+a,i=document.createElement("div");i.innerHTML=JSUtil.fn.replaceParams(l["CopySheet.Create.New.Spreadsheet.SuccessMessage"],["<a class='ZsLink' href='"+r+"' target='_blank'>","</a>"]);var n=[{text:l["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(r,"_blank")}},{text:l.Close}];ZSClass.ZSAlert(i,{type:"success",title:l["Alert.Title.SpreadsheetCreated"],isHtml:!0,buttons:n})}function a(e,t,s,a,r){var i=o.view.getActiveGridID(),e=o.view.getResourceID(i),n=o.data.getWorkBook(e,s),c=o.view.getSheetID(i),S=n.getSheetObj(c),l=S.Prop.Name;"sdoc"==r&&(0==a.length?UserAction.serverClipCopytoNewSheet(e,t,s,l,!1):u.openDialog(r,a))}var o=e.sPlusPlus,r=e.ZSConstants,i=(r.FeatureConstants,e.UserAction,e.ZSEvents),n=i.topic,c=i.Groups,S=i.Names,l=e.ZSConstants.I18N,p=o.view.Toolbar.Feature.COPY_TO_NEW_SPREADSHEET,u=o.view.Toolbar.Feature.PASTE_SHEET;p.copySheetAction=t,n.register(c.Listener,S.DocAction.WORKSHEETS.SERVERCOPYSHEET,s,"RID","SHEETID","VERSION","NEWRID")}(this);
!function(e){function t(){if(!d){l=this.tab,v=this.name;var e=l.offsetWidth;l.innerText="";var t=document.createElement("input");t.className="shRenameInput",t.setAttribute("maxlength",31),t.style.width=e-N+"px",l.appendChild(t),c=new S.TextAreaEditor(t),c.value=this.name,c.addListeners(w),c.focus(),t.select(),i(),d=!0}}function n(){a(),l.innerText=v;var e=document.createElement("span");e.className="sheetTabArrow",e.setAttribute("data-menu-id","MI_SHEET_CONTEXT"),I.fn.addIcon(e,"PATCHED_DROPDOWN_ICON"),l.appendChild(e)}function i(){var e=u.view.Events.Key;e.focusContext(e.Entry.SheetTab.Context),document.body.addEventListener("mousedown",o)}function a(){var e=u.view.Events.Key;document.body.removeEventListener("mousedown",o),e.focusContext(e.Entry.CellEditor.Context),d=!1}function s(e){var t=u.view.getActiveGridID(),i=u.view.getResourceID(t),a=u.view.getSheetID(t),s=u.view.getVersionID(t),o=e.keyCode||e.which;switch(o){case 13:r(i,a,s,this.value),e.stopPropagation();break;case 27:n()}}function o(e){var t=e.target,n=u.view.getActiveGridID(),i=u.view.getResourceID(n),a=u.view.getSheetID(n),s=u.view.getVersionID(n);return"shRenameInput"==t.className||t.className.contains("activeTab")?!1:void r(i,a,s,c.value)}function r(e,t,i,s){var o=u.data.getWorkBook(e,i),r=[{text:E.OK,primary:!0,click:n}],c={buttons:r,dontSetPrevContextFlag:!0};if(!s||0===s.trim().length)return a(),c.title=E["Alert.Title.InvalidSheetName"],void ZSClass.ZSAlert(E["Rename.SheetNameCannotBeEmpty"],c);var d=o.SheetList.clone();return d.removeById(d.getIdByName(v)),d.isNameExists(s)?(a(),c.title=E["Alert.Title.SheetNameExists"],void ZSClass.ZSAlert(E["Error.Sheet.Name.Exists"],c)):JSUtil.REGEXP.validSheetName.test(s)?void(s!=v?(l.innerText=s,UserAction.RenameSheet(e,[t],i,s),a()):n()):(a(),c.title=E["Alert.Title.InvalidSheetName"],void ZSClass.ZSAlert(E.SheetNameShouldContain,c))}var l,v,c,d,u=e.sPlusPlus,m=e.ZSConstants,h=(m.FeatureConstants,e.UserAction,e.ZSEvents),E=(h.topic,h.Groups,h.Names,m.I18N),S=ZSClass.Editors,C=u.view.Toolbar.Feature.RENAME_SHEET,I=e.UIUtil,w={keydown:s},N=20;C.execute=t,UserAction.UISheetRename=t}(this);
!function(e){function t(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getSheetID(e),s=o.view.getVersionID(e),r=o.data.getWorkBook(t,s),a=(r.getSheetObj(i),o.view.getSelectedSheets(e));n.HideSheet(t,a,s)}function i(e){if(e==c.parent){var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),s=(o.view.getSheetID(t),o.view.getVersionID(t)),n=o.data.getWorkBook(i,s),I=n.SheetList.getSheets(),v=I.length;1>=v?S.disable("#"+a.MI+r.HIDE_SHEET+a.MENU):S.enable("#"+a.MI+r.HIDE_SHEET+a.MENU)}}var o=e.sPlusPlus,s=e.ZSConstants,r=s.FeatureConstants,n=e.UserAction,a=s.wCC,I=e.ZSEvents,v=I.topic,g=I.Groups,E=I.Names,S=e.UIUtil.Component,c=o.view.Toolbar.Feature[r.HIDE_SHEET];c.execute=t,v.register(g.UI,E.Toolbar.INIT_MENU,i,"DOM")}(this);
!function(e){function t(){a&&a.remove(),a=document.createElement("ul"),a.id=p.SUBMENUITEM+v.UNHIDE_SHEET+p.IDENTITY,a.setAttribute("data-ctype","zmenu"),I.appendChild(a)}function n(){a.innerHTML="",h.zmenu(a,"destroy");var e=i();a.appendChild(e),h.zmenu(a)}function i(){for(var e=u.view.getActiveGridID(),t=u.view.getResourceID(e),n=(u.view.getSheetID(e),u.view.getVersionID(e)),i=u.data.getWorkBook(t,n),d=i.SheetList.getHiddenSheets(),a=d.length,s=document.createDocumentFragment(),l=0;a>l;l++){var c=d[l],v=document.createElement("li");v.setAttribute("label",c.Name),v.setAttribute("data-item-value",c.Id),v.innerText=c.Name,v.addEventListener("mousedown",r.bind(null,c.Id)),s.appendChild(v)}o(s);var m=document.createElement("li");return m.innerText=E.UnHideAll,m.addEventListener("mousedown",r.bind(null,void 0)),s.appendChild(m),s}function o(e){var t=document.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}function r(e){var t=u.view.getActiveGridID(),n=u.view.getResourceID(t),i=u.view.getVersionID(t),o=[];if(e)o.push(e);else for(var e=u.view.getSheetID(t),r=u.data.getWorkBook(n,i),s=r.SheetList.getHiddenSheets(),c=0;c<s.length;c++)o.push(s[c].Id);a&&(a.style.display="none"),l.unHideSheet(n,o,i,d)}function d(e,t,n){var i=u.view.getActiveGridID(),o=u.view.getSheetID(i);l.SwitchSheet(e,o,n,t)}var a,u=e.sPlusPlus,s=e.document,l=e.UserAction,c=e.ZSConstants,v=c.FeatureConstants,m=e.ZSEvents,I=(m.topic,m.Groups,m.Names,s.getElementById("popupmenu")),E=c.I18N,p=c.wCC,h=(u.view.Toolbar.Feature[v.UNHIDE_SHEET],e.UIUtil.Component);t(),h.bind("#"+p.SUBMENUITEM+v.UNHIDE_SHEET+p.IDENTITY,"zmenubeforeshow",function(){n()})}(this);
!function(e){function t(){var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),n=s.view.getSheetID(t),c=s.view.getVersionID(t),S=s.data.getWorkBook(i,c),g=s.view.getSelectedSheets(t),h=S.getSheetObj(n),v=h.Prop.Name,d=r.getCopiedSheetName(),u=d.sheetName,l=d.src_rid;if(l==i){var n=S.SheetList.getIdByName(u),h=S.getSheetObj(n),P=S.ProtectedSheets.isSheetLocked(n),f=h.ProtectedRanges.isRangesAvailable();if(P||f){var w=new ZSClass.ZSConfirm(a["CopySheet.LockConfirmMsg"]);w.onYES(function(){e.UserAction.PasteSheet(i,g,c,v,!0)}),w.onNO(function(){e.UserAction.PasteSheet(i,g,c,v,!1)});{w.execute()}}else e.UserAction.PasteSheet(i,g,c,v,!1)}else e.UserAction.CopyRefSheets(i,c,g,"ddoc",o)}function o(t,o,i,n,a){var c=s.view.getActiveGridID(),t=s.view.getResourceID(c),S=s.data.getWorkBook(t,i),g=s.view.getSheetID(c),h=S.getSheetObj(g),v=h.Prop.Name;"ddoc"==a&&(0==n.length?e.UserAction.PasteSheet(t,o,i,v,!1):r.openDialog(a,n))}var s=e.sPlusPlus,i=e.ZSConstants,n=(i.FeatureConstants,e.UserAction,e.ZSEvents),a=(n.topic,n.Groups,n.Names,e.ZSConstants.I18N),r=s.view.Toolbar.Feature.PASTE_SHEET;r.execute=t}(this);
!function(e){var t,n=e.sPlusPlus,r=e.ZSEvents,i=r.topic,o=r.Groups,s=(e.ZSClass,r.Names),a=e.ZSConstants.I18N,u=(e.document,function(e,t,n){e.stopPropagation(),e.preventDefault(),f(e.dataTransfer)&&l(t,n)}),f=function(e){if("undefined"!=typeof Clipboard&&e.constructor==Clipboard)return e.files.length>0?!0:!1;if("undefined"!=typeof DOMStringList){var t=e.types;if(t.constructor==DOMStringList)return t.contains("Files")?!0:!1}if("undefined"!=typeof Array){var t=e.types;if(t.constructor==Array)return-1!=t.indexOf("Files")?!0:!1}},c=function(e,t){e.preventDefault(),e.stopPropagation();var r=n.view.getResourceID(t),a=n.view.getSheetID(t),u=n.view.getVersionID(t),f=e.target.files||e.dataTransfer.files;i.publish(o.Listener,s.UserAction.DRAG_DROP.DROPEND,{RID:r,SHEETID:a,VERSION:u,FILES:f})},d=function(e,n){t.ondragleave=function(t){t.stopPropagation(),t.preventDefault(),p(e)},t.ondrop=function(t){c(t,n),p(e)},t.ondragover=function(e){e.preventDefault(),e.stopPropagation()}},p=function(e){e.removeChild(t),e.classList.remove("dragOver"),t=""},l=function(e,n){t||(t=document.createElement("div"),t.innerText=a.dropYourFile,t.className="dragOverCue",e.appendChild(t),e.classList.add("dragOver"),d(e,n))};i.register(o.Listener,s.UserAction.DRAG_DROP.DRAGOVER,u,"EVENT","DOM","GRID_ID")}(this);
!function(e){function t(t,i,s){var S=r.view.getActiveGridID(),c=r.view.getActiveState(S),D=c.getNiceUrl(t,i,s);e.history.replaceState({state:0},"ZS",D)}function i(){var t=r.view.getActiveGridID(),i=r.view.getActiveState(t),s=r.view.getResourceID(t),S=r.view.getSheetID(t),c=r.view.getVersionID(t),D=i.getNiceUrl(s,S,c);e.history.replaceState({state:0},"ZS",D)}var r=e.sPlusPlus,s=e.ZSEvents,S=s.topic,c=s.Groups,D=s.Names;S.register(c.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.ADD,t,"RID","SHEETID","VERSION"),S.register(c.Gesture.Selector.Range,D.GESTURE.ACTION.END,t,"RID","SHEETID","VERSION"),S.register(c.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.SHOW,t,"RID","SHEETID","VERSION"),S.register(c.Listener,D.UserAction.REVIEW_COMMENTS.CURRENT_THREAD,i,"commentID")}(this);
!function(e){function n(e){if(void 0!=e&&0!==Object.keys(e).length&&!p){var n="BANNER_MSG",o="BANNER_LEARN",c="BANNER_LINK",d="BANNER_TYPE",l=document.querySelector("#ancBnr"),u=l.querySelector("#ancBdy"),f=l.querySelector("#bannerClose"),v=l.querySelector("#ancCtn"),B=l.querySelector("#ancLm");l.classList.add("ntftBanner","txt_cen"),u.classList.add("ntftBannerCtn"),v.classList.add("mr10"),B.classList.add("ml10","ntftBannerBtn"),f.classList.add("ntftBannreCls"),l.style.display=b;var w,A;if(e.readOnlyMode)v.innerText=m["Banner.ReadOnly.App.Server"],B.style.display=y,w="zannouncementbarnewRO";else{w="zannouncementbarnew";{e[d]?e[d]:"announcement"}A=e.bannerName;i(e[o])||""==e[o]?i(e[c])||""==e[c]?(v.innerText=e[n],B.style.display=y,f.style.display=y):(v.innerText=e[n],B.innerText="Learn More",B.addEventListener("click",function(){window.open(e[c],"_blank").focus()})):(v.innerText=e[n],B.innerText=e[o],B.addEventListener("click",function(){window.open(e[c],"_blank").focus()})),e.isRefreshNeeded&&a(e[n])}p=!0,f.addEventListener("click",function(){r(w,A)}),s.view.measures.Top.announcementBanner=40,t()}}function t(){var e=s.view.getActiveGridID(),n=s.view.getResourceID(e),t=s.view.getSheetID(e),a=s.view.getVersionID(e);UserAction.UpdateViewport(n,t,a)}function a(e){var n=setTimeout(function(){window.location.reload(!0)},6e4);v.buttons[0].click=function(){clearTimeout(n),window.location.reload(!0)},v.buttons[1].click=function(){clearTimeout(n)},ZSClass.ZSAlert(e,v)}function r(e,n){var a=document.querySelector("#ancBnr");a.classList.add("ntftBannerHide"),setTimeout(function(){a.style.display=y,t()},500),s.view.measures.Top.announcementBanner=0,"zannouncementbarnew"===e&&n&&localStorage&&localStorage.setItem("AB",n)}function i(e){return"undefined"==typeof e}function o(){var e=document.createElement("div");e.setAttribute("id","ancBnr");var n=document.createElement("div");n.setAttribute("id","ancBdy");var t=document.createElement("span");t.setAttribute("id","ancCtn");var a=document.createElement("button");a.setAttribute("id","ancLm"),n.appendChild(t),n.appendChild(a);var r=document.createElement("div");r.setAttribute("id","bannerClose"),e.appendChild(n),e.appendChild(r),e.style.display=y,document.body.prepend(e)}var c=e.ZSEvents,s=e.sPlusPlus,d=c.topic,l=c.Groups,u=c.Names,m=ZSConstants.I18N,p=!1,f=[{text:m.Refresh,primary:!0},{text:"Cancel"}],v={buttons:f,countDown:60,timerMsg:m["WorkerCheck.Reloading"],reload:!1},y="none",b="block";o(),d.register(l.Listener,u.DocAction.BANNER.ADD,n,"RESPONSE")}(this);
!function(e){function t(e){B=!!e,(!D.data.AppRegistry.isWalkthroughViewed||B)&&(m||n(),y())}function n(){var e=UserAction.getTemplate(["WALKTHROUGH_TEMPLATE"]),t=e.WALKTHROUGH_TEMPLATE;s(t),R.body.append(t),L=R.querySelector("#annBox"),m=!0}function s(e){v=e.querySelector(".anounceBoxCont"),S=R.querySelector(".shProfile"),p=e.querySelector(".dotCont"),h=e.querySelector(".annClsBtn"),T=e.querySelector("#slide0"),q=e.querySelector(".announceBoxData"),A=e.querySelector("#annLeftArw"),E=e.querySelector("#annRightArw"),x=e.querySelectorAll(".dots"),A.addEventListener("mousedown",function(){i()}),E.addEventListener("mousedown",function(){o()}),h.addEventListener("mousedown",function(){u(),B||a()});for(var t=0;t<x.length;t++)x[t].addEventListener("mousedown",c);X[Z.LEFT]=i,X[Z.RIGHT]=o,X[Z.ESC]=u}function i(){T.checked||(w-=1,0>w&&(w=x.length-1),r(),f(w))}function o(){w+=1,w>=x.length-1&&(E.classList.contains("tick")&&(u(),B||a()),l(),w=x.length-1),f(w)}function a(){var t=D.view.getActiveGridID(),n=D.view.getResourceID(t),s=D.view.getVersionID(t),i=1;e.UserAction.Announcement(n,s,i)}function l(){E.classList.add("tick")}function r(){E.classList.contains("tick")&&E.classList.remove("tick")}function c(e){for(var t=0;t<x.length;t++)x[t].classList.remove("active");e.target.classList.add("active");var n=e.target.attributes[1].value;w=parseInt(n),C="slide"+w,g(C),n!=x.length-1?r():l()}function u(){L.classList.add("closeAnn"),S.classList.add("highlightAnn"),v.style.display="none",p.style.display="none",h.style.display="none",A.style.display="none",E.style.display="none",G.focusContext(G.Entry.CellEditor.Context),setTimeout(function(){L.style.display="none",S.classList.remove("highlightAnn"),L.classList.remove("zoomEffect")},1e3)}function y(){L.style.display="",L.classList.remove("closeAnn"),E.classList.remove("tick"),w=0,f(w),L.querySelector("#annceLogo").src="",L.querySelector("#annceLogo").src=H+"announcement/logo.gif",setTimeout(function(){G.focusContext(U),v.style.display="",p.style.visibility="visible",p.style.display="",h.style.display="",E.style.visibility="visible",E.style.display="",A.style.display="",L.classList.add("zoomEffect","firstSldTxt")},600),setTimeout(function(){L.classList.remove("firstSldTxt")},2500)}function d(){for(var e=0;e<x.length;e++)x[e].classList.remove("active");var t=L.querySelector(".lbl"+w);t.classList.add("active")}function f(e){var t=L.querySelector("#slide"+e);C="slide"+e,g(C),t.checked=!0,d()}function g(e){"slide0"==e?(q.style.transform="translateX(2000px)",setTimeout(function(){L.querySelector("#annceLogo").src=""},90),setTimeout(function(){L.querySelector("#annceLogo").src=H+"announcement/logo.gif"},95)):"slide1"==e?(q.style.transform="translateX(1200px)",setTimeout(function(){L.querySelector("#annSidePanel").src=""},90),setTimeout(function(){L.querySelector("#annSidePanel").src=H+"announcement/annSidePanel.gif"},95)):"slide2"==e?(q.style.transform="translateX(400px)",setTimeout(function(){L.querySelector("#annZiaLarge").src=""},90),setTimeout(function(){L.querySelector("#annZiaLarge").src=H+"announcement/annZiaLarge.gif"},95)):"slide3"==e?(q.style.transform="translateX(-400px)",setTimeout(function(){L.querySelector("#annDuplicatesLarge").src=""},90),setTimeout(function(){L.querySelector("#annDuplicatesLarge").src=H+"announcement/annDuplicatesLarge.gif"},95)):"slide4"==e?(q.style.transform="translateX(-1200px)",L.querySelector("#annDelugeLarge").src=H+"announcement/annDelugeLarge.svg"):"slide5"==e&&(q.style.transform="translateX(-2000px)"),"slide0"==e?(A.style.visibility="hidden",A.classList.add("initPos")):(A.style.visibility="visible",A.classList.remove("initPos"))}var m,L,v,S,p,h,T,q,A,E,x,w,C,D=sPlusPlus,P=e.ZSEvents,b=P.topic,k=P.Groups,I=P.Names,R=e.document,G=D.view.Events.Key,U=G.Entry.Announcement.Context,X=U.keyDown,Z=e.ZSConstants.JSKeyCode,H=(e.ZSConstants.I18N,D.data.AppRegistry.IMAGEPath),B=!1;b.register(k.UI,I.Layout.TEMPLATE_LOADED,t),UserAction.showWalkthrough=t}(this);
!function(e){function t(e){V=e,K||(o(),K=!0),J&&(W=document.querySelector("#TB_DATA_IDENTITY"),N=document.querySelector("#TB_DATA_POPUP_CONTAINER"),n(),i(e))}function n(){W.click(),W.click()}function o(){f=document.querySelector("#pageTourCont"),p=document.querySelector(".featureNavigator"),T=p.querySelector(".leftArw"),C=p.querySelector(".rgtArw"),L=p.querySelector(".wtHead"),v=p.querySelector(".navCont"),S=document.querySelector(".walkTBtn"),P=document.querySelector(".tourClsBtn"),y=document.querySelector(".shProfile"),T.addEventListener("mousedown",function(){a()}),C.addEventListener("mousedown",function(){u()}),S.addEventListener("mousedown",function(){r()}),P.addEventListener("mousedown",function(){r()}),H=document.querySelector(".pageTourHighlighter"),R=document.querySelector(".tourHighlightClose"),H.addEventListener("mousedown",function(e){var t=e.target?e.target:e.scrElement,n=t.classList;if("tourHighlightClose"!=n){var o=document.querySelector($[0]),s=document.querySelector($[0]).parentElement,i=s.getBoundingClientRect();H.style.right=window.innerWidth-i.left-40+"px",H.style.top=i.top+"px",H.classList.remove("showHl"),H.classList.add("reachDest"),setTimeout(function(){o.classList.add("highlightAnn")},200),setTimeout(function(){l(),o.classList.remove("highlightAnn"),H.classList.remove("reachDest"),H.removeAttribute("style")},800),setTimeout(function(){document.body.removeChild(H)},801)}}),R.addEventListener("mousedown",function(){r("highlight")})}function s(){document.body.prepend(H),setTimeout(function(){H.classList.add("showHl")},500)}function i(e){setTimeout(function(){Y.focusContext(U)},600),e?l():setTimeout(function(){s()},2300)}function l(){document.body.prepend(f),A=document.getElementById($[2].substring(1,$[2].length));var e=A.offsetTop;w=A.cloneNode(!0),w.classList.add("commentBtnCln"),E=document.getElementsByClassName("mainGrid"),E[0].prepend(w),w.style.top=e-3+"px",x=document.getElementsByClassName($[3].substring(1,$[3].length)),I=x[0].cloneNode(!0),I.classList.add("ziaBtnCln"),E=document.getElementsByClassName("mainGrid"),E[0].prepend(I),f.classList.add(Q[j]),c(1),L.innerText=et[0],v.innerText=tt[0],S.innerText=ot[0],f.addEventListener("contextmenu",d)}function r(e){h(N),"highlight"==e?(H.classList.add("closeAnn"),y.classList.add("highlightAnn"),setTimeout(function(){H.classList.remove("showHl","closeAnn"),document.body.removeChild(H),y.classList.remove("highlightAnn")},800)):(f.classList.add("closeAnn"),y.classList.add("highlightAnn"),p.style.display="none",setTimeout(function(){f.classList.remove(Q[j]),document.body.removeChild(f),y.classList.remove("highlightAnn"),E[0].removeChild(I),E[0].removeChild(w)},1e3),setTimeout(function(){f.classList.remove("closeAnn"),p.removeAttribute("style"),j=0},1010))}function a(){if(j>0){if(f.classList.remove(Q[j]),f.classList.add(Q[j-1]),j-=1,"zia"==Q[j])c(4);else if("share"==Q[j]){{document.querySelector("#topPtr")}c(2),S.innerText=ot[0]}else"functionSP"==Q[j]?c(3):"chart"==Q[j]?c(1):"dataMenuItem"==Q[j]&&c(5);L.innerText=et[j],v.innerText=tt[j]}}function u(){X-1>j&&(j+=1,j>X-1&&(j=X-1),f.classList.remove(Q[j-1]),f.classList.add(Q[j]),"zia"==Q[j]?c(4):"functionSP"==Q[j]?c(3):"listingPage"==Q[j]?c(6):"share"==Q[j]?c(2):"dataMenuItem"==Q[j]&&c(5),L.innerText=et[j],v.innerText=tt[j])}function c(e){switch(_=window.innerWidth,b=window.innerHeight,m(),D=document.querySelector("#imgDt"+e),D.style.display="block",e){case 1:var t=document.querySelector($[0]),n=t.getBoundingClientRect();p.style.right=_-(n.left+p.offsetWidth/2)+"px",p.style.left="auto",p.style.top=n.top+n.height+25+"px";break;case 2:var t=document.querySelector($[1]),n=t.getBoundingClientRect();p.style.right=_-(n.left+n.width+10)+"px",p.style.left="auto",p.style.top=n.top+n.height+20+"px";break;case 3:var o=document.querySelector($[2]),n=o.getBoundingClientRect();p.style.right=n.width+30+"px",p.style.top=n.top-20+"px",setTimeout(function(){o.classList.add("menuItemProp"),o.classList.add("higlit")},1e3);break;case 4:h(N),W.classList.remove("menuItemProp"),g(W,"menuItemProp"),g(N,"menuItemProp");var s=document.querySelector($[3]),n=s.getBoundingClientRect();p.style.right=n.width+30+"px",p.style.top=n.top+n.height-p.offsetHeight+"px";break;case 5:J&&(F[z.LEFT]=a,F[z.RIGHT]=u,F[z.ESC]=r),q=document.querySelector(nt.dataCleaning);var i=W.offsetLeft,l=W.offsetTop;setTimeout(function(){N.style.display="",N.style.left=i+"px",N.style.top=l+30+"px";var e=N.getBoundingClientRect(),t=q.getBoundingClientRect();p.style.right=_-(e.left+p.offsetWidth+e.width+30)+"px",p.style.left="auto",p.style.top=t.top-50+"px"},100),setTimeout(function(){W.classList.add("menuItemProp"),N.classList.add("menuItemProp"),q.classList.add("higlit")},1200);break;case 6:h(N),W.classList.remove("menuItemProp"),g(W,"menuItemProp"),g(N,"menuItemProp");var c=document.querySelector($[4]),n=c.getBoundingClientRect();p.style.right=_-(p.offsetWidth+10)+"px",p.style.left="auto",p.style.top=n.top+n.height+30+"px"}k=document.getElementById("incrCount"),B=document.getElementById("totCount"),k.innerText=e,B.innerText=$.length}function d(e){return e.stopPropagation(),!1}function m(){for(var e=document.getElementsByClassName("imgDetails"),t=0;t<e.length;t++)e[t].style.display="none"}function h(e){var t=W.offsetLeft,n=W.offsetTop;e.style.display="none",e.style.left=t+"px",e.style.top=n+"px"}function g(e,t){(" "+e.className+" ").indexOf(" "+t+" ")>-1&&e.classList.remove(t)}var y,f,p,T,C,L,v,S,x,I,E,A,w,P,k,B,q,N,W,_,b,D,H,R,M=sPlusPlus,G=e.ZSEvents,Y=(G.topic,G.Groups,G.Names,M.view.Events.Key),Z=Y.Entry.Announcement.Context,z=(Z.keyDown,e.ZSConstants.JSKeyCode),O=e.ZSConstants.I18N,U=(M.data.AppRegistry.IMAGEPath,Y.Entry.pageTour.Context),F=U.keyDown,K=!1,V=!1,J=!0,j=0,Q=["chart","share","functionSP","zia","dataMenuItem","listingPage"],X=Q.length,$=["#MI_51_item_IDENTITY","#MI_87_IDENTITY","#SP_COMMENTS_ICON",".sPZIABtm","#TB_DATA_IDENTITY","#tblogo"],W=document.querySelector("#TB_DATA_IDENTITY"),et=[O["Walkthrough.HeadList.VisualizeBetter"],O["Walkthrough.HeadList.WorkAsATeam"],O["Walkthrough.HeadList.ContextualComments"],O["Walkthrough.HeadList.AskZia"],O["Walkthrough.HeadList.CleanYourData"],O["Walkthrough.HeadList.AllYourSpreadsheets"]],tt=[O["Walkthrough.Content.VibrantCharts"],O["Walkthrough.Content.ShareSpreadsheets"],O["Walkthrough.Content.Comments"],O["Walkthrough.Content.Zia"],O["Walkthrough.Content.DataCleaning"],O["Walkthrough.Content.ListingPage"]],nt={dataCleaning:"#MI_240_MENU"},ot=["Got it"];J&&(F[z.LEFT]=a,F[z.RIGHT]=u,F[z.ESC]=r),UserAction.showTour=t}(this);
!function(e){function t(){var e=i.data.PageRegistry.wmsOptions,t={},r=i.data.UserInfo.zuid;return-1!=r&&(t={Name:i.data.UserInfo.loginName,Email:i.data.UserInfo.loginEmailId,PhotoUrl:e.photoServerURL+"/file?fs=thumb&ID="+r,MyAccountUrl:e.photoServerURL,MyAppsUrl:"home.zoho.com",Zuid:r,signOutURL:function(){}}),t}function r(){var e=h.getElementById("popupmenu");if(e){var t=d.getTemplate(["USER_PROFILE"]),r=t.USER_PROFILE,a=r.querySelector("#usrProfMnu");if(U){var n=U.createMenuElement();a.insertBefore(n,a.childNodes[0])}var s=h.createElement("div");s.id="tbUserProfile",s.appendChild(r),e.appendChild(s),E.setAttribute("data-content","#tbUserProfile"),E.setAttribute("data-is-content-html-encoded",!0),E.setAttribute("data-width",260),E.setAttribute("data-class-name","shShareMenu");var l=i.data.UserInfo.isLoggedIn;E.style.display=l?"":"none",f.zpopover(E),o(s)}}function o(e){var r=t();v.src=r.PhotoUrl;var o=e.querySelector("#popup_profilePic");o.src=r.PhotoUrl;var i=e.querySelector("#feedback");i.addEventListener("click",function(){d.showFeedbackDialog(),f.zpopover(E,"close")});var n=U&&e.querySelector("#switchOld");U&&n.addEventListener("click",s.Redirect);var l=e.querySelector("#profileName"),c=e.querySelector("#mailId"),u=e.querySelector("#userid"),S=e.querySelector("#whatsNew"),m=e.querySelector("#iphoneBadge"),y=e.querySelector("#androidBadge"),g=e.querySelector("#myAccounts"),L=e.querySelector("#signOutBtn"),P=e.querySelector("#sheetBlogsTag");l.innerText=r.Name,c.innerText=r.Email,u.innerText=r.Zuid,P.href=p.BlogsURL,g.href=p.ZOHO_ACCOUNTS_URL,m.href=p.APPSTORE_URL,y.href=p.PLAYSTORE_URL,L.addEventListener("click",function(){h.location.href=p.ctxpath+"logout.do"}),S.addEventListener("click",function(){d.showWalkthrough(!0),a()})}function a(){f.zpopover(E,"close")}var i=e.sPlusPlus,n=e.ZSEvents,s=e.ZSClass,l=n.topic,c=n.Groups,u=n.Names,d=e.UserAction,p=i.data.AppRegistry,h=e.document,f=e.UIUtil.Component,S=i.view.Toolbar.Feature.USER_PROFILE,U=i.view.Toolbar.Feature.SWITCH_TO_OLD,v=S.topbarPhoto,E=S.topbarProfile;l.register(c.UI,u.Layout.TEMPLATE_LOADED,r),l.register(c.Listener,u.Browser.RESIZE,a)}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=N.cloneNode(!0);n.addEventListener("click",function(){E.execute()}),t[a.ContextConstant.CUT]=n}}var n=t.sPlusPlus,s=t.ZSEvents,r=s.topic,u=s.Groups,o=s.Names,a=t.ZSConstants,i=a.FeatureConstants,I=t.document,c=t.ZSConstants.I18N,E=n.view.Toolbar.Feature[i.CUT],N=function(){var t=I.createElement("li");return t.setAttribute("data",'{"skipshortcutregister": false, "shortcutkey":"ctrl+x", "label":"'+c["MenuItem.HomeTab.Cut"]+'"}'),t}();r.register(u.UI,o.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),r.register(u.UI,o.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),r.register(u.UI,o.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(e){function t(e){var t=C.cloneNode(!0);t.addEventListener("click",function(e){N.execute(e)}),e[i.ContextConstant.COPY]=t}var n=e.sPlusPlus,r=e.ZSEvents,s=r.topic,u=r.Groups,o=r.Names,i=e.ZSConstants,a=i.FeatureConstants,c=e.document,I=e.ZSConstants.I18N,N=n.view.Toolbar.Feature[a.COPY],C=function(){var e=c.createElement("li");return e.setAttribute("data",'{"skipshortcutregister": true, "shortcutkey":"ctrl+c", "label":"'+I["MenuItem.HomeTab.Copy"]+'"}'),e}();s.register(u.UI,o.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG"),s.register(u.UI,o.Menu.INIT_ROW_HEAD_CONTEXT,t,"MENU_BAG"),s.register(u.UI,o.Menu.INIT_COL_HEAD_CONTEXT,t,"MENU_BAG"),s.register(u.UI,o.Menu.INIT_LOCK_CONTEXT,t,"MENU_BAG")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=C.cloneNode(!0);n.addEventListener("click",function(){N.execute()}),t[ZSConstants.ContextConstant.PASTE]=n}}var n=t.sPlusPlus,s=t.ZSEvents,a=s.topic,u=s.Groups,i=s.Names,r=t.ZSConstants,E=r.FeatureConstants,o=t.ZSConstants.wCC,I=t.document,T=t.ZSConstants.I18N,N=n.view.Toolbar.Feature[E.PASTE],C=function(){var t=I.createElement("li");return t.setAttribute("data",'{"label":"'+T["MenuItem.HomeTab.Paste"]+'"}'),t.setAttribute("data-menu-id",o.SUBMENUITEM+E.PASTE+o.IDENTITY),t.setAttribute("data-item-type","splitmenu"),t}();a.register(u.UI,i.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),a.register(u.UI,i.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),a.register(u.UI,i.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=document.createElement("li");n.setAttribute("data-menu-id",M.SUBMENUITEM+u.SORT+M.IDENTITY),n.setAttribute("id",M.MI+o.SORT+M.MENU),n.innerText=N["MenuItem.DataTab.Sort"],t[o.SORT]=n}}function n(t){var e=t.id;if("MI_GRID_CONTEXT"==e){var n=i(),r=t.querySelector("#"+M.MI+o.SORT+M.MENU);n.startRow!=n.endRow||n.startCol!=n.endCol?r&&(r.style.display=""):r&&(r.style.display="none")}}function i(){var t=r.view.getActiveGridID(),e=r.view.getSheetID(t),n=r.view.getSheetState(t,e),i=n.getRanges(),s=i[0];return s}var r=t.sPlusPlus,s=(t.JSUtil,t.ZSEvents),I=s.topic,E=s.Groups,a=s.Names,T=t.ZSConstants,u=T.FeatureConstants,o=T.ContextConstant,N=T.I18N,M=T.wCC;I.register(E.UI,a.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),I.register(E.UI,a.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),I.register(E.UI,a.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),I.register(E.UI,a.Menu.CONTEXT_BEFORE_SHOW,n,"UI")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=N;n.id=r.MI+c.ADD_HYPERLINK+r.MENU,n.addEventListener("click",C.openDialog),t[c.ADD_HYPERLINK]=n}}function n(t){var e=t.id;if("MI_GRID_CONTEXT"==e){var n=C.isSingleCell(),s=t.querySelector("#"+r.MI+c.ADD_HYPERLINK+r.MENU);n?s&&(s.style.display=""):s&&(s.style.display="none")}}var s=t.sPlusPlus,a=t.document,r=t.ZSConstants.wCC,i=t.ZSEvents,o=i.topic,l=i.Groups,u=i.Names,I=t.ZSConstants.I18N,E=t.ZSConstants,c=ZSConstants.ContextConstant,C=s.view.Toolbar.Feature[E.FeatureConstants.HYPERLINK],N=function(){var t=a.createElement("li");return t.setAttribute("data",'{"skipshortcutregister": false, "shortcutkey":"Ctrl+k","label":"'+I["MenuItem.InsertTab.Hyperlink"]+'...","appData" : { "type": "change"} }'),t}();o.register(l.UI,u.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),o.register(l.UI,u.Menu.CONTEXT_BEFORE_SHOW,n,"UI")}(this);
!function(e){function t(e,t){if("VERSION"!=t){var n=l.cloneNode(!0);n.addEventListener("click",function(){T.execute(void 0,void 0,void 0)}),e[r.ContextConstant.FILTER]=n}}var n=e.sPlusPlus,o=e.document,i=e.ZSEvents,s=i.topic,u=i.Groups,a=i.Names,r=e.ZSConstants,I=r.I18N,E=r.FeatureConstants,c=r.wCC,T=n.view.Toolbar.Feature[E.FILTER],l=function(){var e=o.createElement("li");return e.setAttribute("data",'{"label":"'+I["MenuItem.HomeTab.Filter"]+'", "submenu": "#'+c.SUBMENUITEM+E.FILTER+c.IDENTITY+'"}'),e}();s.register(u.UI,a.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG","VIEW")}(this);
!function(e){function t(e){var t=N.createElement("li");t.setAttribute("data",'{"label":"'+T["MenuItem.DataTab.FreezePanes"]+'"}'),t.setAttribute("data-menu-id",m.SUBMENUITEM+I.FREEZE+m.IDENTITY),t.id=m.MI+I.FREEZE+m.MENU,e[C.ContextConstant.FREEZE]=t}function n(e){a=document.createElement("li"),a.setAttribute("data",'{"label":"freeze upto 2nd Row"}'),a.addEventListener("click",function(){A.execute(U)}),e[C.ContextConstant.FREEZE]=a,i=document.createElement("li"),i.setAttribute("data",'{"label":"unFreeze Row"}'),i.addEventListener("click",function(){A.execute(F)}),e[C.ContextConstant.UNFREEZE]=i}function E(e){u=document.createElement("li"),u.setAttribute("data",'{"label":"freeze upto B Column"}'),u.addEventListener("click",function(){A.execute(b)}),e[C.ContextConstant.FREEZE]=u,o=document.createElement("li"),o.setAttribute("data",'{"label":"unFreeze Col"}'),o.addEventListener("click",function(){A.execute(R)}),e[C.ContextConstant.UNFREEZE]=o}var a,u,i,o,r=e.sPlusPlus,c=e.ZSEvents,s=c.topic,l=c.Groups,d=c.Names,C=e.ZSConstants,I=C.FeatureConstants,N=e.document,m=C.wCC,T=C.I18N,U=(e.JSUtil,e.UIUtil.Component,4),b=5,F=6,R=7,A=r.view.Toolbar.Feature[I.FREEZE];s.register(l.UI,d.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG","VIEW"),s.register(l.UI,d.Menu.INIT_ROW_HEAD_CONTEXT,n,"MENU_BAG","VIEW"),s.register(l.UI,d.Menu.INIT_COL_HEAD_CONTEXT,E,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var s=E();s.addEventListener("click",C.execute),t[r.ContextConstant.PICKLIST]=s}}function s(t){var e=t.id;if("MI_GRID_CONTEXT"==e){var s=n.view.getActiveGridID(),r=n.view.getSheetID(s),o=n.view.getSheetState(s,r),I=o.getRanges(),u=I[0],c=t.querySelector("#"+i.MI+a.PICKFROMLIST+i.MENU);u.startRow!=u.endRow||u.startCol!=u.endCol?c&&(c.style.display="none"):c&&(c.style.display="")}}var n=t.sPlusPlus,r=t.ZSConstants,i=t.ZSConstants.wCC,a=r.FeatureConstants,o=r.I18N,I=t.ZSEvents,u=I.topic,c=I.Groups,l=I.Names,C=n.view.Toolbar.Feature[a.PICKFROMLIST],E=function(){var t=document.createElement("li");return t.setAttribute("data",'{ "skipshortcutregister": true, "shortcutkey":"Alt+Down", "label":"'+o.PickFromList+'..."}'),t.setAttribute("id",i.MI+a.PICKFROMLIST+i.MENU),t};u.register(c.UI,l.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),u.register(c.UI,l.Menu.CONTEXT_BEFORE_SHOW,s,"UI")}(this);
!function(e){function t(e,t){if("VERSION"!=t){var E=I.ContextConstant;e[E.RESIZE_IMAGE]=r(),e[E.SAVE_IMAGE]=a(),e[E.CLONE_IMAGE]=l(),e[E.REPLACE_IMAGE]=s(),e[E.DELETE_IMAGE]=i(),g.register(m.UI,p.Menu.CONTEXT_BEFORE_SHOW,n,"RID","SHEETID","VERSION","UI")}}function n(e,t,n,a){if("MI_IMAGE_CONTEXT"===a){var i=o.view.getActiveGridID(),e=o.view.getResourceID(i),l=o.data.getWorkBook(e,n),r=l.getSheetObj(t),s=r.Ole.Image,I=s.getActive(),d=I.length;d>1?(c.style.display="none",u.style.display="none",E.style.display="none"):(c.style.display="",u.style.display="",E.style.display="")}}function a(){var e=y.createElement("li");return e.setAttribute("data",'{"label":"'+d["Image.SaveImageAs"]+'"}'),e.addEventListener("click",b.saveAS),e}function i(){var e=y.createElement("li");return e.setAttribute("data",'{"label":"'+d.Delete+'"}'),e.addEventListener("click",b.remove),e}function l(){var e=y.createElement("li");return e.setAttribute("data",'{"label":"'+d.Clone+'"}'),e.addEventListener("click",b.clone),e}function r(){var e=y.createElement("li");return e.setAttribute("data",'{"label":"'+d.ResizeToOriginalSize+'"}'),e.addEventListener("click",b.resize),e}function s(){var e=y.createElement("li");return e.setAttribute("data",'{"label":"'+d.ReplaceImage+'"}'),e.addEventListener("click",b.replace),e}{var E,c,u,o=e.sPlusPlus,I=e.ZSConstants,d=I.I18N,v=I.FeatureConstants,A=e.ZSEvents,g=A.topic,m=A.Groups,p=A.Names,y=e.document,b=o.view.Toolbar.Feature[v.IMAGE];y.getElementById("popupmenu")}g.register(m.UI,p.Menu.INIT_IMAGE_CONTEXT,t,"MENU_BAG","VIEW")}(this);
!function(t){function e(){n(),this.init()}function n(){I.publish(r.UI,u.Menu.INIT_IMAGE_CONTEXT,{MENU_BAG:A})}function i(){var t=new e,n="MI_IMAGE_CONTEXT";c.register(n,t),I.register(r.Listener,u.ContextMenu.INIT,function(e){t.init(e)},"VIEW")}var o=t.sPlusPlus,E=t.ZSConstants,s=t.ZSEvents,I=s.topic,r=s.Groups,u=s.Names,M=E.ContextConstant,c=ZSClass.ContextMenu,A=[],a=[[M.RESIZE_IMAGE],[M.SAVE_IMAGE],[M.CLONE_IMAGE,M.REPLACE_IMAGE,M.DELETE_IMAGE]],C=[[M.SAVE_IMAGE]];e.prototype={init:function(t){var e="VERSION"==t?C:a;this.imageContext=c.create("MI_IMAGE_CONTEXT",A,e)},open:function(t){var e=o.view.getActiveGridID(),n=o.view.getResourceID(e),i=o.view.getVersionID(e),E=o.view.getSheetID(e),s=o.data.getWorkBook(n,i),I=s.ProtectedSheets.isSheetLocked(E);I||c.open(t,this.imageContext)}},i()}(this);
!function(t){function e(t,e,i,a){if("MI_ROWHEAD_CONTEXT"===a.id){var r=o.data.getWorkBook(t,i),l=r.getSheetObj(e),I=o.view.getActiveGridID(),d=o.view.getSheetState(I,e),E=d.getActiveRange(),H=E.endRow,_=E.startRow,D=!1,D=l.Row.Visibility.isHidden(_);if(!D){var v=l.Row.Visibility.nextHidden(_);D=H>=v?!0:!1}var C=0==_&&H>=u-1?!0:!1;C?n&&(n.style.display="none"):n&&(n.style.display=""),D?s&&(s.style.display="block"):s&&(s.style.display="none");var N=H-_>0?S["Hide.Rows"]:S["Hide.Row"];O.zmenu(a,"setMenuItemsAttribute",["#"+R.MI+c.HIDE_ROWS+"_HIDE"+R.IDENTITY],"label",N)}}function i(t,e){"VERSION"!=e&&(n=_.cloneNode(!0),n.addEventListener("click",function(){H.hide()}),t[E.ContextConstant.HIDE_ROWS]=n,s=D.cloneNode(!0),s.addEventListener("click",function(){H.show()}),t[E.ContextConstant.UNHIDE_ROWS]=s)}var n,s,o=t.sPlusPlus,a=t.ZSEvents,r=a.topic,l=a.Groups,I=a.Names,d=o.data.Defaults,u=d.MAX_ROW,E=t.ZSConstants,c=E.FeatureConstants,R=t.ZSConstants.wCC,S=E.I18N,H=o.view.Toolbar.Feature[c.HIDE_ROWS],O=t.UIUtil.Component,_=function(){var t=document.createElement("li");return t.setAttribute("data",'{"label":"'+S["Hide.Rows"]+'","shortcutkey":"Ctrl+9"}'),t.setAttribute("id",R.MI+c.HIDE_ROWS+"_HIDE"+R.IDENTITY),t}(),D=function(){var t=document.createElement("li");return t.setAttribute("data",'{"label":"'+S["Show.Rows"]+'","shortcutkey":"Ctrl+Shift+9"}'),t.setAttribute("id",R.MI+c.HIDE_ROWS+"_SHOW"+R.IDENTITY),t}();r.register(l.UI,I.Menu.INIT_ROW_HEAD_CONTEXT,i,"MENU_BAG","VIEW"),r.register(l.UI,I.Menu.CONTEXT_BEFORE_SHOW,e,"RID","SHEETID","VERSION","UI")}(this);
!function(t){function e(t,e,n,a){if("MI_COLHEAD_CONTEXT"===a.id){var l=s.data.getWorkBook(t,n),r=l.getSheetObj(e),d=s.view.getActiveGridID(),I=s.view.getSheetState(d,e),u=I.getActiveRange(),O=u.endCol,S=u.startCol,_=r.Column.hidden.isHidden(S);if(!_){var D=r.Column.hidden.nextHidden(S);_=O>=D?!0:!1}var v=0==S&&O>=C-1?!0:!1;v?i&&(i.style.display="none"):i&&(i.style.display=""),_?o&&(o.style.display="block"):o&&(o.style.display="none");var T=O-S>0?E["Hide.Cols"]:E["Hide.Col"];H.zmenu(a,"setMenuItemsAttribute",["#"+N.MI+c.HIDE_COLUMNS+"_HIDE"+N.IDENTITY],"label",T)}}function n(t,e){"VERSION"!=e&&(i=S.cloneNode(!0),i.addEventListener("click",function(){O.hide()}),t[u.ContextConstant.HIDE_COLS]=i,o=_.cloneNode(!0),o.addEventListener("click",function(){O.show()}),t[u.ContextConstant.UNHIDE_COLS]=o)}var i,o,s=t.sPlusPlus,a=t.ZSEvents,l=a.topic,r=a.Groups,d=a.Names,I=s.data.Defaults,C=I.MAX_COL,u=t.ZSConstants,E=u.I18N,c=u.FeatureConstants,N=t.ZSConstants.wCC,H=t.UIUtil.Component,O=s.view.Toolbar.Feature[c.HIDE_COLUMNS],S=function(){var t=document.createElement("li");return t.setAttribute("data",'{"label":"'+E["Hide.Cols"]+'"}'),t.setAttribute("id",N.MI+c.HIDE_COLUMNS+"_HIDE"+N.IDENTITY),t}(),_=function(){var t=document.createElement("li");return t.setAttribute("data",'{"label":"'+E["Show.Cols"]+'","shortcutkey":"Ctrl+)"}'),t.setAttribute("id",N.MI+c.HIDE_COLUMNS+"_SHOW"+N.IDENTITY),t}();l.register(r.UI,d.Menu.INIT_COL_HEAD_CONTEXT,n,"MENU_BAG","VIEW"),l.register(r.UI,d.Menu.CONTEXT_BEFORE_SHOW,e,"RID","SHEETID","VERSION","UI")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=s.createElement("li");n.setAttribute("data",'{"label":"'+i.FormatCells+'..."}'),n.addEventListener("click",function(t){u.openDialog(t)}),t[ZSConstants.ContextConstant.FORMATCELL]=n}}var n=t.sPlusPlus,s=t.document,a=t.ZSEvents,o=a.topic,r=a.Groups,E=a.Names,i=t.ZSConstants.I18N,I=t.ZSConstants,u=n.view.Toolbar.Feature[I.FeatureConstants.FORMATCELLS];o.register(r.UI,E.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),o.register(r.UI,E.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),o.register(r.UI,E.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(e){function t(e){var t=I.cloneNode(!0);t.onclick=E.openDialog,e[N.ContextConstant.DEFINE_NAME]=t}var n=e.sPlusPlus,s=e.document,r=e.ZSEvents,o=r.topic,a=r.Groups,u=r.Names,i=e.ZSConstants.I18N,N=e.ZSConstants,E=n.view.Toolbar.Feature[N.FeatureConstants.DEFINE_NAME],I=function(){var e=s.createElement("li");return e.setAttribute("data",'{ "skipshortcutregister": true, "label":"'+i["MenuItem.InsertTab.DefineName"]+'..."}'),e}();o.register(a.UI,u.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG"),o.register(a.UI,u.Menu.INIT_ROW_HEAD_CONTEXT,t,"MENU_BAG"),o.register(a.UI,u.Menu.INIT_COL_HEAD_CONTEXT,t,"MENU_BAG")}(this);
!function(e){function t(e){var t=U.cloneNode(!0);t.addEventListener("click",function(){N.openDialog(!1)}),e[M.ContextConstant.LOCK_RANGE]=t}function n(e){var t=O.cloneNode(!0);t.addEventListener("click",function(){N.openDialog(!1)}),e[M.ContextConstant.UNLOCK_RANGE]=t}function o(e){var t=R.cloneNode(!0);t.addEventListener("click",function(){g.openDialog(!0)}),e[M.ContextConstant.SHEET_LOCKSHEET]=t}function r(e,t,n,o){var r=e.id,i=s.data.getWorkBook(t,o);switch(r){case"MI_SHEET_CONTEXT":var c=i.ProtectedSheets[n],E=void 0!=c?C["Menu.ProtectRange.ManageSheet"]:C["Menu.ProtectRange.ProtectSheet"];T.zmenu("#"+r,"setMenuItemsAttribute",["#"+_.MI+l.LOCK_SHEET+_.MENU],"label",E);break;case"MI_GRID_CONTEXT":var E=a()?C["ProtectRange.UI.Menu.LockUnlockRange"]:C["ProtectRange.UI.Menu.ProtectRange"];T.zmenu(e,"setMenuItemsAttribute",["#"+_.MI+l.LOCK_CELLS+_.MENU],"label",E+"..."),e.querySelector("#"+_.MI+l.UNLOCK_RANGE+_.MENU)&&(e.querySelector("#"+_.MI+l.UNLOCK_RANGE+_.MENU).style.display=i.ProtectedSheets.isSheetLocked(n)?"none":"block");case"MI_ROWHEAD_CONTEXT":case"MI_COLHEAD_CONTEXT":var E=a()?C["ProtectRange.UI.Menu.LockUnlockRange"]:C["ProtectRange.UI.Menu.ProtectRange"];T.zmenu(e,"setMenuItemsAttribute",["#"+_.MI+l.LOCK_CELLS+_.MENU],"label",E+"...")}}function a(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=s.view.getSheetID(e),o=s.view.getVersionID(e),r=s.data.getWorkBook(t,o),r=(s.data.DocRegistry[t][o],s.data.getWorkBook(t,o)),a=s.view.getSheetState(e,n),i=a.getActiveRange();return r.getSheetObj(n).ProtectedRanges.isIntersecting(i)}var s=e.sPlusPlus,i=e.document,c=e.ZSEvents,E=c.topic,u=c.Groups,I=c.Names,C=e.ZSConstants.I18N,M=e.ZSConstants,l=M.FeatureConstants,N=s.view.Toolbar.Feature[l.LOCK],g=s.view.Toolbar.Feature[l.LOCK_SHEET],_=e.ZSConstants.wCC,T=e.UIUtil.Component,U=(e.ZSConstants.ActionConstants,function(){var e=i.createElement("li");return e.id=_.MI+l.LOCK_CELLS+_.MENU,e.setAttribute("data",'{"skipshortcutregister": false, "label":"'+C["ProtectRange.UI.Menu.ProtectRange"]+'..."}'),e}()),O=function(){var e=i.createElement("li");return e.id=_.MI+l.UNLOCK_RANGE+_.MENU,e.setAttribute("data",'{"skipshortcutregister": false, "label":"'+C["ProtectRange.UI.Menu.LockUnlockRange"]+'..."}'),e}(),R=function(){var e=i.createElement("li");return e.id=_.MI+l.LOCK_SHEET+_.MENU,e.setAttribute("data",'{"skipshortcutregister": false, "label":"'+C["Menu.ProtectRange.ProtectSheet"]+'"}'),e}();E.register(u.UI,I.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG","VIEW"),E.register(u.UI,I.Menu.INIT_ROW_HEAD_CONTEXT,t,"MENU_BAG","VIEW"),E.register(u.UI,I.Menu.INIT_COL_HEAD_CONTEXT,t,"MENU_BAG","VIEW"),E.register(u.UI,I.Menu.CONTEXT_BEFORE_SHOW,r,"UI","RID","SHEETID","VERSION"),E.register(u.UI,I.Menu.INIT_SHEET_CONTEXT,o,"MENU_BAG","VIEW"),E.register(u.UI,I.Menu.INIT_LOCK_CONTEXT,n,"MENU_BAG")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var a=document.createElement("li");a.innerText=N["FormTab.ManageForm"],a.setAttribute("data-menu-id",c.SUBMENUITEM+I.MANAGE_FORM+c.IDENTITY),a.addEventListener("click",function(){CopySheet.execute()}),a.setAttribute("ctype","splitmenu"),t[T.MANAGE_FORM]=a,s=a,o.register(E.UI,r.Menu.CONTEXT_BEFORE_SHOW,n,"RID","SHEETID","VERSION")}}function n(t,e,n){var i=a.data.getWorkBook(t,n),o=i.FormSheets;o[e]?s&&(s.style.display=""):s&&(s.style.display="none")}var s,a=t.sPlusPlus,i=t.ZSEvents,o=i.topic,E=i.Groups,r=i.Names,u=t.ZSConstants,I=t.ZSConstants.FeatureConstants,c=u.wCC,N=u.I18N,T=u.ContextConstant;o.register(E.UI,r.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=s.createElement("li");n.setAttribute("data",'{"shortcutkey":"ctrl+alt+M", "splitbutton":true,"label":"'+E["MenuItem.InsertTab.Comments.AddComment"]+'"}'),n.addEventListener("click",function(){N.openAndAddComment()}),t[a.ContextConstant.ADD_COMMENT]=n}}var n=t.sPlusPlus,s=t.document,r=t.ZSEvents,I=r.topic,o=r.Groups,u=r.Names,E=t.ZSConstants.I18N,a=t.ZSConstants,i=a.FeatureConstants,N=n.view.Toolbar.Feature[i.COMMENTS];I.register(o.UI,u.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),I.register(o.UI,u.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),I.register(o.UI,u.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),I.register(o.UI,u.Menu.INIT_LOCK_CONTEXT,e,"MENU_BAG")}(this);
!function(t){function e(){return g=Z.createElement("li"),g.setAttribute("data",'{"label":"'+P.Edit+'..."}'),g.addEventListener("click",n),g}function n(){var t=new W.Controller.ZSCController;t.doEdit()}function a(){return w=Z.createElement("li"),w.setAttribute("data",'{"label":"'+P["Image.SaveAsImage"]+'"}'),w.addEventListener("click",r),w}function r(){var t=new W.Controller.ZSCController;t.saveChartAsImage()}function i(){return p=Z.createElement("li"),p.setAttribute("data",'{"label":"'+P.Delete+'"}'),p.addEventListener("click",o),p}function o(){var t=B.view.getActiveGridID(),e=B.view.getResourceID(t),n=B.view.getVersionID(t),a=B.view.getSheetID(t),r=W.Utility.getActiveChart();z.publish(X.Listener,j.UserAction.CHARTS.DELETE,{RID:e,SHEETID:a,VERSION:n,ACTIVE_CHART_ID:r})}function l(){return D=Z.createElement("li"),D.setAttribute("data",'{"label":"'+P["Chart.Clone"]+'"}'),D.addEventListener("click",s),D}function s(){var t=new W.Controller.ZSCController;t.doCloneAction()}function C(){return _=document.createElement("li"),_.id=V.SUBMENUITEM+k.ContextConstant.MOVE_CHART+V.IDENTITY+"_Chart",_.setAttribute("data-label",P["Chart.MoveChart"]),_.setAttribute("data-menu-id",V.SUBMENUITEM+k.ContextConstant.MOVE_CHART+V.IDENTITY),_}function u(){return L=document.createElement("li"),L.setAttribute("data-label",P["Chart.Styles"]),L.setAttribute("data-menu-id",V.SUBMENUITEM+k.ContextConstant.STYLE_CHART+V.IDENTITY),L}function d(){var t=document.createElement("ul");t.id=V.SUBMENUITEM+k.ContextConstant.MOVE_CHART+V.IDENTITY,t.setAttribute("data-ctype","zmenu"),x.bind(t,"zmenuitemclick",function(t,e){var n=e.data;A(t,n)}),Y.appendChild(t)}function c(){var t=document.querySelector("#"+V.SUBMENUITEM+k.ContextConstant.MOVE_CHART+V.IDENTITY);t.innerHTML="";var e=B.view.getActiveGridID(),n=B.view.getResourceID(e),a=B.view.getVersionID(e),r=B.data.getWorkBook(n,a),i=r.SheetList.getSheets(),o=B.view.getSheetID(e),l=W.Wrapper.DOMUtils;if(l.show(_),1==i.length)return l.hide(_),void(F=!0);F=!1;for(var s,C=0;C<i.length;C++)s=i[C].Id,s!==o&&x.zmenu(t,"addMenuItem",{label:i[C].Name,id:k.ContextConstant.MOVE_CHART+"_M_"+parseInt(s),asn:parseInt(s)})}function E(t){var e=new W.Utility.CommanAgent,n=e.getMoveMenuRefreshSheetName();return null==n||n!=t}function h(){return N=document.createElement("li"),N.setAttribute("data",'{"label":"'+P["Chart.Publish"]+'","status":"publish"}'),N.addEventListener("click",function(){var t=new W.Controller.ZSCController;t.doPublishAction({status:q.PUBLISH})}),N}function I(){return y=document.createElement("li"),y.setAttribute("data",'{"label":"'+P["Chart.ShowURL"]+'","status":"showUrl"}'),y.addEventListener("click",function(){var t=new W.Controller.ZSCController;t.doPublishAction({status:q.SHOWURL},void 0,!0)}),y}function v(){return O=document.createElement("li"),O.setAttribute("data",'{"label":"'+P["Chart.UnPublish"]+'","status":"unpublish"}'),O.addEventListener("click",function(){var t=new W.Controller.ZSCController;t.doPublishAction({status:q.REVERT})}),O}function T(){return H=document.createElement("li"),H.setAttribute("data",'{"label":"'+(P["Chart.AddToImageLibrary"]||"Add to Image Library")+'","status":"add"}'),H.addEventListener("click",function(){var t=new W.Controller.ZSCController;t.addChartToImageLibrary(W.Utility.getActiveChart(!0))}),H}function S(){var t={id:V.SUBMENUITEM+k.ContextConstant.STYLE_CHART+V.IDENTITY,"data-ctype":"zmenu",relativeto:"parent"},e=[{data:'{"label":"'+P.Copy+'", "action": "CS"}'},{data:'{"label":"'+P["CopySheet.Paste"]+'", "action": "PS"}',id:"chtpastestyle"},{mtype:"separator"},{data:'{"label":"'+P["Chart.Reset.Styles"]+'", "action": "RS"}'}];B.view.Menu.create(e,t,Y).then(function(){x.bind("#"+V.SUBMENUITEM+k.ContextConstant.STYLE_CHART+V.IDENTITY,"zmenuitemclick",function(t,e){var n=e.data;m(t,n)})})}function A(t,e){var n=e.asn||e.id.split("_")[2];x.hideContextMenu();var a=new W.Utility.ChartAgent;if(a.isLockedSheet(n+"#"))return void ZSClass.ZSAlert(P["ProtectRange.UI.SheetLocked"],{title:P["Alert.Title.LockedSheet"]});var r=new W.Controller.ZSCController;r.switchChart(n)}function m(t,e){var n=new W.Controller.ZSCController;n.doStyleClip(e.action)}function b(t,n){if("VERSION"!=n){var r=k.ContextConstant;t[r.EDIT_CHART]=e(),t[r.STYLE_CHART]=u(),t[r.MOVE_CHART]=C(),t[r.CLONE_CHART]=l(),t[r.DELETE_CHART]=i(),t[r.SAVE_CHART]=a(),t[r.PUBLISH_CHART]=h(),t[r.PUBLISH_CHART_URL]=I(),t[r.REVERT_PUBLISH]=v(),t[r.ADD_TO_IMAGE_LIBRARY]=T(),S(),d(),z.register(X.UI,j.Menu.CONTEXT_BEFORE_SHOW,f,"RID","SHEETID","VERSION","UI")}}function M(){var t=new W.Manager.ZSCCManager,e=t.hasStyleClip(),n=W.Wrapper.DOMUtils,a=n.getElementById("chtpastestyle");e?n.removeClass(a,"disabled"):n.addClass(a,"disabled")}function R(t,e){var n=W.Wrapper.DOMUtils;n.hide(N),n.hide(y),n.hide(O),1==e&&(t?(n.show(y),n.show(O)):n.show(N))}function U(t){var e=W.Wrapper.DOMUtils;e.show(g),e.show(w),e.show(p),e.show(D),e.show(_),e.show(L),t>1&&(e.hide(g),e.hide(w),e.hide(D),e.hide(L),e.hide(_))}function f(t,e,n,a){var r=a.id;if("MI_CHART_CONTEXT"===r){var i=W.Wrapper.DOMUtils,o=B.view.getActiveGridID(),t=B.view.getResourceID(o),l=B.data.getWorkBook(t,n),s=(l.getSheetObj(e),B.view.getSheetID(o)),C=new W.Utility.ChartAgent,u=C.getActiveChartID().length,d=C.getActiveChartMeta()[0],h=d.isPublishChart();if(U(u),R(h,u),M(),E(s)){var I=new W.Utility.CommanAgent;I.setMoveMenuRefreshedSheetName(s),c()}F&&i.hide(_)}}var g,w,p,D,_,L,H,N,y,O,B=t.sPlusPlus,k=t.ZSConstants,Z=t.document,P=t.ZSConstants.I18N,V=t.ZSConstants.wCC,Y=document.getElementById("popupmenu"),x=t.UIUtil.Component,W=t.ZSChart,G=t.ZSEvents,z=G.topic,X=G.Groups,j=G.Names,q=W.Constants.ChartPublishConstant,F=!1;z.register(X.UI,j.Menu.INIT_CHART_CONTEXT,b,"MENU_BAG","VIEW")}(this);
!function(t){function e(){n(),this.init()}function n(){C.publish(r.UI,_.Menu.INIT_CHART_CONTEXT,{MENU_BAG:E})}function i(){var t=new e,n="MI_CHART_CONTEXT";u.register(n,t),C.register(r.Listener,_.ContextMenu.INIT,function(e){t.init(e)},"VIEW")}var o=t.sPlusPlus,s=t.ZSConstants,T=t.ZSEvents,C=T.topic,r=T.Groups,_=T.Names,I=s.ContextConstant,u=ZSClass.ContextMenu,E=[],R=[[I.EDIT_CHART,I.STYLE_CHART],[I.MOVE_CHART,I.CLONE_CHART,I.DELETE_CHART],[I.SAVE_CHART,I.ADD_TO_IMAGE_LIBRARY],[I.PUBLISH_CHART,I.PUBLISH_CHART_URL,I.REVERT_PUBLISH]],A=[];e.prototype={init:function(t){var e="VERSION"==t?A:R;this.chartCtxMenu=u.create("MI_CHART_CONTEXT",E,e)},open:function(t){var e=o.view.getActiveGridID(),n=o.view.getResourceID(e),i=o.view.getVersionID(e),s=o.view.getSheetID(e),T=o.data.getWorkBook(n,i),C=T.ProtectedSheets.isSheetLocked(s);C||u.open(t,this.chartCtxMenu)}},i()}(this);
!function(e){function t(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b["Pivot.UI.Builder"]+'"}'),e.addEventListener("click",n),e}function n(){m.publish(A.UI,V.SidePanel.PIVOT.OPEN)}function i(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b["Pivot.Toolbar.PivotChart"]+'"}'),e.addEventListener("click",r),e}function r(){O.view.Toolbar.Feature[f.CHART].execute(this,!0)}function a(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b["Pivot.UI.Move"]+'"}'),e.addEventListener("click",d),e}function o(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b.Copy+'"}'),e.addEventListener("click",d),e}function l(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b.Refresh+'"}'),e.addEventListener("click",u),e}function u(){var e=new M.Refresh;e.selected()}function s(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b.Delete+'"}'),e.addEventListener("click",c),e}function c(){M.pivotDeleteConfirmation()}function E(){var e=_.createElement("li");return e.setAttribute("data",'{"label":"'+b["MenuItem.InsertTab.Comments.AddComment"]+'"}'),e.addEventListener("click",v),e}function d(){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].openDialog(this)}function v(){N.openAndAddComment()}function I(e,n){if("VERSION"!=n){var r=P.ContextConstant;e[r.PIVOT_BUILDER]=t(),e[r.PIVOT_CHART]=i(),e[r.PIVOT_MOVE]=a(),e[r.PIVOT_COPY]=o(),e[r.PIVOT_REFRESH]=l(),e[r.PIVOT_DELETE]=s(),e[r.ADD_COMMENT]=E(),m.register(A.UI,V.Menu.CONTEXT_BEFORE_SHOW,T,"RID","SHEETID","VERSION","UI")}}function T(e,t,n,i){var r=i.id;if("MI_PIVOT_CONTEXT"===r){var a=O.view.getActiveGridID(),e=O.view.getResourceID(a),o=O.data.getWorkBook(e,n);o.getSheetObj(t)}}var O=e.sPlusPlus,P=e.ZSConstants,b=P.I18N,f=P.FeatureConstants,C=e.ZSEvents,m=C.topic,A=C.Groups,V=C.Names,_=e.document,M=ZSClass.Pivot,N=O.view.Toolbar.Feature[f.COMMENTS];m.register(A.UI,V.Menu.INIT_PIVOT_CONTEXT,I,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=S.cloneNode(!0);n.onclick=i,t[l.ContextConstant.SPARKLINE]=n}}function n(t){var e=t.id;if("MI_GRID_CONTEXT"==e){var n=r.view.getActiveGridID(),i=r.view.getResourceID(n),s=r.view.getVersionID(n),o=r.view.getSheetID(n),a=r.view.getSheetState(n,o),I=a.getActiveCellRange(),C=r.data.getWorkBook(i,s).getSheetObj(o),S=C.sparklines.groupranges.getInfo(I.startRow,I.startCol),c=t.querySelector("#"+u.MI+l.ContextConstant.SPARKLINE+u.MENU);if(void 0==c)return;c.style.display=void 0==S?"none":""}}function i(){o.publish(a.UI,I.SidePanel.Sparklines.OPEN,{ISRIGHTCLICK:!0})}var s=t.ZSEvents,r=t.sPlusPlus,o=s.topic,a=s.Groups,I=s.Names,u=t.ZSConstants.wCC,l=t.ZSConstants,C=t.ZSConstants.I18N,S=function(){var t=document.createElement("li"),e=u.MI+l.ContextConstant.SPARKLINE+u.MENU;return t.setAttribute("data",'{ "skipshortcutregister": true, "label":"'+C["MenuTab.Tab.Sparkline"]+'"}'),t.setAttribute("id",e),t}();o.register(a.UI,I.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),o.register(a.UI,I.Menu.CONTEXT_BEFORE_SHOW,n,"UI")}(this);
!function(e){function t(e,t){if("VERSION"!=t){var s=document.createElement("li");s.innerText=c["Macro.Player.ViewCode"],s.addEventListener("click",function(){var e=n.view.getActiveGridID(),t=(n.view.getResourceID(e),n.view.getSheetID(e)),s=parseInt(t.substr(0,t.length-1)),i="Sheet"+(s+1);E.openDialog(i)}),e[I.VBA_EDITOR]=s}}var n=e.sPlusPlus,s=e.ZSEvents,i=s.topic,r=s.Groups,o=s.Names,a=e.ZSConstants,u=e.ZSConstants.FeatureConstants,c=(a.wCC,a.I18N),I=a.ContextConstant,E=n.view.Toolbar.Feature[u.VBA_EDITOR];i.register(r.UI,o.Menu.INIT_SHEET_CONTEXT,t,"MENU_BAG","VIEW")}(this);
!function(e){function t(e){e[_.PUBLISH_RANGE]=o.createRangePublishMenuElement()}var n=e.sPlusPlus,s=e.ZSEvents,I=s.topic,E=s.Groups,u=s.Names,r=(e.document,e.ZSConstants),N=r.FeatureConstants,_=(r.wCC,r.I18N,r.ContextConstant),o=n.view.Toolbar.Feature[N.PUBLISH_RANGE];I.register(E.UI,u.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG","VIEW"),I.register(E.UI,u.Menu.INIT_ROW_HEAD_CONTEXT,t,"MENU_BAG","VIEW"),I.register(E.UI,u.Menu.INIT_COL_HEAD_CONTEXT,t,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=i.createElement("li");n.setAttribute("data-menu-id",a.SUBMENUITEM+T.CLEAR_ALL+a.IDENTITY),n.setAttribute("id",a.MI+T.CLEAR_ALL+a.IDENTITY),n.innerText=u["MenuItem.HomeTab.Clear"],t[C.ContextConstant.CLEAR]=n}}{var n=t.sPlusPlus,s=t.ZSEvents,E=s.topic,I=s.Groups,r=s.Names,C=t.ZSConstants,T=C.FeatureConstants,a=t.ZSConstants.wCC,i=t.document,u=t.ZSConstants.I18N;n.view.Toolbar.Feature[T.CLEAR_ALL]}E.register(I.UI,r.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),E.register(I.UI,r.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),E.register(I.UI,r.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var I=u.createElement("li");I.setAttribute("data-menu-id",i.SUBMENUITEM+N.INSERT+i.IDENTITY),I.setAttribute("id",i.MI+N.INSERT+i.IDENTITY),I.innerText=a["MenuItem.InsertTab.Insert"],t[r.ContextConstant.INSERT]=I}}{var I=t.sPlusPlus,n=t.ZSEvents,s=n.topic,E=n.Groups,T=n.Names,r=t.ZSConstants,N=r.FeatureConstants,i=t.ZSConstants.wCC,u=t.document,a=t.ZSConstants.I18N;I.view.Toolbar.Feature[N.INSERT]}s.register(E.UI,T.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW"),s.register(E.UI,T.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW"),s.register(E.UI,T.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=u.createElement("li");n.setAttribute("data-menu-id",r.SUBMENUITEM+T.DELETE+r.IDENTITY),n.setAttribute("id",r.MI+T.DELETE+r.IDENTITY),n.innerText=I["Actions.Delete"],t[o.ContextConstant.DELETE]=n}}{var n=t.sPlusPlus,s=t.ZSEvents,E=s.topic,i=s.Groups,a=s.Names,o=t.ZSConstants,T=o.FeatureConstants,r=t.ZSConstants.wCC,u=t.document,I=t.ZSConstants.I18N;n.view.Toolbar.Feature[T.DELETE]}E.register(i.UI,a.Menu.INIT_GRID_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(e){function t(e,t){if("VERSION"!=t){var o=s.view.Toolbar.Feature[l.ROW_OPTIONS],n=R.createElement("li");n.setAttribute("data",'{ "label":"'+T.DeleteRow+'"}'),n.setAttribute("id",I.MI+l.DELETE_ROW+I.IDENTITY),n.onclick=o.deleteRow,e[E.ContextConstant.DELETE_ROW]=n}}function o(e){var t=s.view.getActiveGridID(),o=s.view.getSheetID(t),n=s.view.getSheetState(t,o),i=n.getRanges(),a=s.view.getResourceID(t),r=s.view.getVersionID(t),E=s.data.getWorkBook(a,r),R=E.getSheetObj(o),O=E.ProtectedSheets.isSheetLocked(o);if("MI_ROWHEAD_CONTEXT"==e.id&&!O){for(var w=0,c=0;c<i.length;c++)w+=i[c].endRow-i[c].startRow+1,w-=R.Row.Visibility.getOnCount(i[c].startRow,i[c].endRow);if(w>=D.MAX_ROW)e.querySelector("#"+I.MI+l.DELETE_ROW+I.IDENTITY).style.display="none";else{var S=w>1?JSUtil.fn.replaceParams(T["HomeTab.Row.DeleteNoofRows"],new Array(w+"")):T.DeleteRow;u.zmenu(e,"setMenuItemsAttribute",["#"+I.MI+l.DELETE_ROW+I.IDENTITY],"label",S),e.querySelector("#"+I.MI+l.DELETE_ROW+I.IDENTITY).style.display="block"}}}var s=e.sPlusPlus,n=e.ZSEvents,i=n.topic,a=n.Groups,r=n.Names,E=e.ZSConstants,l=E.FeatureConstants,I=e.ZSConstants.wCC,R=e.document,T=e.ZSConstants.I18N,u=e.UIUtil.Component,D=s.data.Defaults;i.register(a.UI,r.Menu.INIT_ROW_HEAD_CONTEXT,t,"MENU_BAG","VIEW"),i.register(a.UI,r.Menu.CONTEXT_BEFORE_SHOW,o,"UI")}(this);
!function(e){function t(e,t){if("VERSION"!=t){var n=o.view.Toolbar.Feature[C.COL_OPTIONS],s=I.createElement("li");s.setAttribute("id",E.MI+C.DELETE_COLUMN+E.IDENTITY),s.setAttribute("data",'{ "label":"'+u.DeleteColumn+'"}'),s.onclick=n.deleteCol,e[r.ContextConstant.DELETE_COL]=s}}function n(e){var t=o.view.getActiveGridID(),n=o.view.getSheetID(t),s=o.view.getSheetState(t,n),l=s.getRanges(),a=o.view.getResourceID(t),i=o.view.getVersionID(t),r=o.data.getWorkBook(a,i),I=r.ProtectedSheets.isSheetLocked(n),O=r.getSheetObj(n);if("MI_COLHEAD_CONTEXT"==e.id&&!I){if(!r.isEditable())return;for(var N=0,c=0;c<l.length;c++)N+=N=l[c].endCol-l[c].startCol+1,N-=O.Column.hidden.getOnCount(l[c].startCol,l[c].endCol);if(N>=D.MAX_COL)e.querySelector("#"+E.MI+C.DELETE_COLUMN+E.IDENTITY).style.display="none";else{var d=N>1?JSUtil.fn.replaceParams(u["HomeTab.Column.DeleteNoofCols"],new Array(N+"")):u.DeleteColumn;T.zmenu(e,"setMenuItemsAttribute",["#"+E.MI+C.DELETE_COLUMN+E.IDENTITY],"label",d),e.querySelector("#"+E.MI+C.DELETE_COLUMN+E.IDENTITY).style.display="block"}}}var o=e.sPlusPlus,s=e.ZSEvents,l=s.topic,a=s.Groups,i=s.Names,r=e.ZSConstants,C=r.FeatureConstants,E=e.ZSConstants.wCC,I=e.document,u=e.ZSConstants.I18N,T=e.UIUtil.Component,D=o.data.Defaults;l.register(a.UI,i.Menu.INIT_COL_HEAD_CONTEXT,t,"MENU_BAG","VIEW"),l.register(a.UI,i.Menu.CONTEXT_BEFORE_SHOW,n,"UI")}(this);
!function(t){function e(t){var e=r.createElement("li");e.setAttribute("data-menu-id",O.SUBMENUITEM+i.ROW_HEIGHT_OPTIONS+O.IDENTITY),e.setAttribute("id",O.MI+i.ROW_HEIGHT_OPTIONS+O.IDENTITY),e.innerText=u["HomeTab.Row.RowHeight"],t[a.ContextConstant.ROW_HEIGHT_OPTIONS]=e}{var n=t.sPlusPlus,s=t.ZSEvents,I=s.topic,T=s.Groups,o=s.Names,a=t.ZSConstants,i=a.FeatureConstants,O=t.ZSConstants.wCC,r=t.document,u=t.ZSConstants.I18N;n.view.Toolbar.Feature[i.ROW_OPTIONS]}I.register(T.UI,o.Menu.INIT_ROW_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=i.createElement("li");n.setAttribute("data-menu-id",a.SUBMENUITEM+N.COLUMN_WIDTH_OPTIONS+a.IDENTITY),n.setAttribute("id",a.MI+N.COLUMN_WIDTH_OPTIONS+a.IDENTITY),n.innerText=u["HomeTab.Column.ColumnWidth"],t[C.ContextConstant.COLUMN_WIDTH_OPTIONS]=n}}{var n=t.sPlusPlus,s=t.ZSEvents,I=s.topic,T=s.Groups,o=s.Names,C=t.ZSConstants,N=C.FeatureConstants,a=t.ZSConstants.wCC,i=t.document,u=t.ZSConstants.I18N;n.view.Toolbar.Feature[N.COL_OPTIONS]}I.register(T.UI,o.Menu.INIT_COL_HEAD_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(e){function t(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+T["Button.AssignExistingMacro"]+'"}'),e.addEventListener("click",function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getVersionID(e),n=o.view.getSheetID(e);E.publish(u.Listener,a.UserAction.BUTTONS.ASSIGNMACRO,{RID:t,SHEETID:n,VERSION:i,CONTEXT:d.AddExistingMacro})}),e}function i(){var e=document.createElement("li");return e.innerText=T["Button.AssignNewMacro"],e.addEventListener("click",function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getVersionID(e),n=o.view.getSheetID(e);E.publish(u.Listener,a.UserAction.BUTTONS.ASSIGNMACRO,{RID:t,SHEETID:n,VERSION:i,CONTEXT:d.CreateMacro})}),e}function n(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+T["Button.EditLabel"]+'"}'),e.addEventListener("click",function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getVersionID(e),n=o.view.getSheetID(e);E.publish(u.Listener,a.UserAction.BUTTONS.EDIT,{RID:t,SHEETID:n,VERSION:i})}),e}function r(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+T.Clone+'"}'),e.addEventListener("click",function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getVersionID(e),n=o.view.getSheetID(e);E.publish(u.Listener,a.UserAction.BUTTONS.CLONE,{RID:t,SHEETID:n,VERSION:i})}),e}function c(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+T.Delete+'"}'),e.addEventListener("click",function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getVersionID(e),n=o.view.getSheetID(e);E.publish(u.Listener,a.UserAction.BUTTONS.DELETE,{RID:t,SHEETID:n,VERSION:i})}),e}function s(e){e[l.BUTTON_ASSIGN_EXISTING_MACRO]=t(),e[l.BUTTON_ASSIGN_NEW_MACRO]=i(),e[l.BUTTON_EDIT_LABEL]=n(),e[l.BUTTON_CLONE]=r(),e[l.BUTTON_DELETE]=c()}var o=e.sPlusPlus,I=e.ZSEvents,E=I.topic,u=I.Groups,a=I.Names,v=e.ZSConstants,T=(v.wCC,v.I18N),l=v.ContextConstant,D=(e.UIUtil.Component,document.getElementById("popupmenu"),0),d={AddExistingMacro:D++,CreateMacro:D++,RecordMacro:D++};E.register(u.UI,a.Menu.INIT_BUTTON_CONTEXT,s,"MENU_BAG")}(this);
!function(t){function e(){n(),this.init()}function n(){N.publish(I.UI,u.Menu.INIT_BUTTON_CONTEXT,{MENU_BAG:E})}function i(){var t=new e,n="MI_BUTTON_CONTEXT";r.register(n,t),N.register(I.Listener,u.ContextMenu.INIT,function(e){t.init(e)},"VIEW")}var T=t.sPlusPlus,o=t.ZSConstants,s=t.ZSEvents,N=s.topic,I=s.Groups,u=s.Names,_=o.ContextConstant,r=ZSClass.ContextMenu,E=[],O=[[_.BUTTON_ASSIGN_EXISTING_MACRO,_.BUTTON_ASSIGN_NEW_MACRO,_.BUTTON_ASSIGN_EXISTING_DELUGE,_.BUTTON_EDIT_LABEL],[_.BUTTON_CLONE,_.BUTTON_DELETE]],S=[];e.prototype={init:function(t){var e="VERSION"==t?S:O;this.buttonCtxMenu=r.create("MI_BUTTON_CONTEXT",E,e)},open:function(t){var e=T.view.getActiveGridID(),n=T.view.getResourceID(e),i=T.view.getVersionID(e),o=T.view.getSheetID(e),s=T.data.getWorkBook(n,i),N=s.ProtectedSheets.isSheetLocked(o);N||r.open(t,this.buttonCtxMenu)}},i()}(this);
!function(e){function t(e,t){"VERSION"!=t&&(v.onclick=function(e){l.execute(e)},e[g.ContextConstant.ADD_NOTE]=v)}function n(e){if("MI_GRID_CONTEXT"==e.id){var t=i();v.style.display=t?"":"none"}}function i(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=s.view.getSheetID(e),i=s.view.getSheetState(e,n),o=i.getRanges(),r=o[0],a=s.view.getVersionID(e),u=s.data.getWorkBook(t,a),c=u.getSheetObj(n),I=c.Merge.getInfo(r.startRow,r.startCol);return r.isSingle()||I&&I.equals(r)?!0:!1}var s=e.sPlusPlus,o=e.document,r=e.ZSEvents,a=r.topic,u=r.Groups,c=r.Names,I=e.ZSConstants.I18N,g=e.ZSConstants,l=s.view.Toolbar.Feature[g.FeatureConstants.NOTE],v=function(){var e=o.createElement("li");return e.setAttribute("data",'{"label":"'+I["Note.Add"]+'",  "shortcutkey": "Shift+F2" }'),e}();a.register(u.UI,c.Menu.INIT_GRID_CONTEXT,t,"MENU_BAG","VIEW"),a.register(u.UI,c.Menu.CONTEXT_BEFORE_SHOW,n,"UI")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=u.createElement("li");n.setAttribute("data",'{"label":"'+S["SheetsTab.InsertSheet"]+'"}'),n.addEventListener("click",function(){c.execute()}),t[o.ContextConstant.SHEET_INSERT]=n}}var n=t.sPlusPlus,s=t.ZSEvents,a=s.topic,E=s.Groups,i=s.Names,o=t.ZSConstants,r=o.FeatureConstants,u=t.document,S=t.ZSConstants.I18N,c=n.view.Toolbar.Feature[r.INSERT_SHEET];a.register(E.UI,i.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){if("VERSION"!=e){var n=o.createElement("li");n.setAttribute("data",'{"label":"'+c.Duplicate+'"}'),n.addEventListener("click",function(){r.execute()}),t[u.ContextConstant.SHEET_DUPLICATE]=n}}var n=t.sPlusPlus,s=t.ZSEvents,E=s.topic,a=s.Groups,i=s.Names,u=t.ZSConstants,o=t.document,c=t.ZSConstants.I18N,r=n.view.Toolbar.Feature.DUPLICATE_SHEET;E.register(a.UI,i.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){"VERSION"!=e&&(E=T.createElement("li"),E.id=r.MI+ZSConstants.ContextConstant.SHEET_DELETE+r.MENU,E.setAttribute("data",'{"label":"Delete"}'),E.addEventListener("click",function(){u.execute()}),t[ZSConstants.ContextConstant.SHEET_DELETE]=E)}function n(t,e,n,o){if("MI_SHEET_CONTEXT"===o.id){var a=s.data.getWorkBook(t,n),i=a.SheetList.getSheets(),S=i.length;1==S||a.ProtectedSheets.isSheetLocked(e)?C.disable(E):C.enable(E)}}var E,s=t.sPlusPlus,o=t.ZSEvents,a=o.topic,i=o.Groups,S=o.Names,T=(t.ZSConstants,t.document),r=(t.ZSConstants.I18N,ZSConstants.wCC),C=t.UIUtil.Component,u=s.view.Toolbar.Feature.DELETE_SHEET;a.register(i.UI,S.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW"),a.register(i.UI,S.Menu.CONTEXT_BEFORE_SHOW,n,"RID","SHEETID","VERSION","UI")}(this);
!function(e){function t(e){var t=s.createElement("li");t.innerText=T.Copy,t.setAttribute("data-menu-id",p.SUBMENUITEM+"copysheet"+p.IDENTITY),t.addEventListener("click",function(){h.execute()}),e[d.SHEET_COPY]=t,n()}function n(){var e=s.createElement("ul");e.id=p.SUBMENUITEM+"copysheet"+p.IDENTITY,e.setAttribute("data-ctype","zmenu"),i(e),m&&m.createElement(e),v.appendChild(e),S.bind("#"+p.SUBMENUITEM+"copysheet"+p.IDENTITY,"zmenubeforeshow",function(e,t){o(t);var n=s.createElement("span"),i=s.createElement("div");if(n.className="shInfoIcon",i.className="shMenuInfo",!s.querySelector("span.shInfoIcon")){var a=JSUtil.fn.replaceParams(T["CopySheet.helpInfo"],["<br>","<br>","<br>"]);n.setAttribute("title",a),i.innerText=T["CopySheet.Tip"],r.appendChild(n),r.appendChild(i),S.ztooltip(n,{innerHTML:a})}})}function i(e){r=s.createElement("li"),r.setAttribute("data",'{"label":"'+T.Copy+'"}'),r.id=p.SUBMENUITEM+d.SHEET_COPY+p.IDENTITY,r.addEventListener("click",function(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getSheetID(e),i=a.view.getVersionID(e);h.copySheetAction(t,n,i)}),e.appendChild(r)}function o(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getSheetID(e),i=a.view.getVersionID(e),o=a.data.getWorkBook(t,i),s=o.getSheetObj(n),E=s.Prop.Name,c=T.Copy+" '"+E+"'";S.zmenu("#"+p.SUBMENUITEM+"copysheet"+p.IDENTITY,"setMenuItemsAttribute",["#"+r.id],"label",c)}var r,a=e.sPlusPlus,s=e.document,E=e.ZSEvents,c=E.topic,I=E.Groups,u=E.Names,l=e.ZSConstants,p=l.wCC,T=l.I18N,d=l.ContextConstant,v=s.getElementById("popupmenu"),S=e.UIUtil.Component,h=a.view.Toolbar.Feature.COPY_SHEET,m=a.view.Toolbar.Feature.COPY_TO_NEW_SPREADSHEET;c.register(I.UI,u.Menu.INIT_SHEET_CONTEXT,t,"MENU_BAG","VIEW")}(this);
!function(e){function t(){n()}function n(){N.bind("#"+S.SUBMENUITEM+"copysheet"+S.IDENTITY,"zmenubeforeshow",function(){if(!E.querySelector("#copytoNewSheet")){var e=E.querySelector("#"+S.SUBMENUITEM+d.COPYAS_NEW_SHEET+S.MENU),t=E.createElement("div");t.id="copytoNewSheet",t.className="shMenuInfo",t.innerText=l["CopySheet.NewSpreadsheet.Tip"],e.appendChild(t)}})}function i(e){o(e);var t=E.createElement("li");t.setAttribute("data",'{"label":"'+l["CopySheet.CreateNewSpreadsheet"]+'"}'),t.id=S.SUBMENUITEM+d.COPYAS_NEW_SHEET+S.MENU,t.addEventListener("click",function(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),n=r.view.getSheetID(e),i=r.view.getVersionID(e);I.copySheetAction(t,n,i)}),e.appendChild(t)}function o(e){var t=E.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}var r=e.sPlusPlus,E=e.document,a=e.ZSEvents,c=a.topic,s=a.Groups,p=a.Names,u=e.ZSConstants,S=u.wCC,l=u.I18N,d=u.ContextConstant,N=(E.getElementById("popupmenu"),e.UIUtil.Component),I=r.view.Toolbar.Feature.COPY_TO_NEW_SPREADSHEET;I.createElement=i,c.register(s.UI,p.Menu.INIT_SHEET_CONTEXT,t,"MENU_BAG","VIEW")}(this);
!function(e){function t(e,t){"VERSION"!=t&&(i=E.createElement("li"),i.setAttribute("data-label",d["Sheet.TabColor"]),i.id=C.MI+v.ContextConstant.SHEET_TABCOLOR+C.MENU,i.addEventListener("click",function(){var e=E.querySelector(".tab.activeTab");n.zcolorpicker("open",{forElement:e,position:"top"})}),e[v.ContextConstant.SHEET_TABCOLOR]=i,o())}function o(){var e=E.createElement("div");e.id="tabColorPicker",e.setAttribute("data-default-color-button",!1),E.body.appendChild(e),n=I.zcolorpicker(e,{valueColorModel:"hex",defaultPaletteType:"custom",customPalette:c.view.ZSheetPalette}),n.on("zcolorpickerpick",function(e,t){var o=c.view.getActiveGridID(),r=c.view.getResourceID(o),i=c.view.getVersionID(o),n=c.view.getSelectedSheets(o),a="transparent"!=t.color?t.color:"";UserAction.TabColorSheet(r,n,i,a)}).on("zcolorpickerbeforeopen",function(){var e=c.view.getActiveGridID(),t=c.view.getResourceID(e),o=c.view.getSheetID(e),r=c.view.getVersionID(e),i=c.data.getWorkBook(t,r),a=i.getSheetObj(o),l=a.Prop.Style;n.zcolorpicker("setValue",l);var s=S.Entry.Menu.Context;S.focusContext(s)}).on("zcolorpickerbeforeclose",function(){S.focusContext(S.Entry.CellEditor.Context)})}function r(){var e=c.view.getActiveGridID(),t=c.view.getResourceID(e),o=c.view.getSheetID(e),r=c.view.getVersionID(e),n=c.data.getWorkBook(t,r);n.ProtectedSheets.isSheetLocked(o)?I.disable(i):I.enable(i)}var i,n,c=e.sPlusPlus,a=e.ZSEvents,l=a.topic,s=a.Groups,u=a.Names,v=e.ZSConstants,E=e.document,d=e.ZSConstants.I18N,C=v.wCC,I=e.UIUtil.Component,S=(c.view.Toolbar.Feature.SHEET_TAB_COLOR,c.view.Events.Key);l.register(s.UI,u.Menu.INIT_SHEET_CONTEXT,t,"MENU_BAG","VIEW"),l.register(s.UI,u.Menu.CONTEXT_BEFORE_SHOW,r,"UI")}(this);
!function(e){function t(e,t){"VERSION"!=t&&(s=S.createElement("li"),s.setAttribute("data",'{"label":"'+u.Rename+'"}'),s.id=v.MI+ZSConstants.ContextConstant.SHEET_RENAME+v.MENU,s.addEventListener("click",function(){n()}),e[ZSConstants.ContextConstant.SHEET_RENAME]=s)}function n(){var e=o.view.getActiveGridID(),t=o.view.getSheetID(e),n=o.view.getSheetTabHolder(),i=n[e],s=i.getSheetTabList(),a=s[t];l.execute.call(a)}function i(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getSheetID(e),i=o.view.getVersionID(e),a=o.data.getWorkBook(t,i);a.ProtectedSheets.isSheetLocked(n)?I.disable(s):I.enable(s)}var s,o=e.sPlusPlus,a=e.ZSEvents,E=a.topic,r=a.Groups,c=a.Names,S=(e.ZSConstants,e.document),u=e.ZSConstants.I18N,I=e.UIUtil.Component,v=ZSConstants.wCC,l=o.view.Toolbar.Feature.RENAME_SHEET;E.register(r.UI,c.Menu.INIT_SHEET_CONTEXT,t,"MENU_BAG","VIEW"),E.register(r.UI,c.Menu.CONTEXT_BEFORE_SHOW,i,"UI")}(this);
!function(t){function e(t,e){"VERSION"!=e&&(E=s.createElement("li"),E.setAttribute("data",'{"label":"Move"}'),E.id=l.MI+ZSConstants.ContextConstant.SHEET_MOVE+l.MENU,E.addEventListener("click",function(){u.openDialog()}),t[ZSConstants.ContextConstant.SHEET_MOVE]=E,a.register(S.UI,r.Menu.CONTEXT_BEFORE_SHOW,n,"RID","SHEETID","VERSION","UI"))}function n(t,e,n,s){if("MI_SHEET_CONTEXT"===s.id){var i=o.data.getWorkBook(t,n),a=i.SheetList.getSheets(),S=a.length;1==S?I.disable(E):I.enable(E)}}var E,o=t.sPlusPlus,s=t.document,i=t.ZSEvents,a=i.topic,S=i.Groups,r=i.Names,I=t.UIUtil.Component,T=t.ZSConstants,l=(T.I18N,T.wCC),u=o.view.Toolbar.Feature.MOVE_SHEET;a.register(S.UI,r.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){"VERSION"!=e&&(E=o.createElement("li"),E.setAttribute("data",'{"label":"'+T["Sheet.Hide"]+'"}'),E.id=l.MI+ZSConstants.ContextConstant.SHEET_HIDE+l.MENU,E.addEventListener("click",function(){c.execute()}),t[ZSConstants.ContextConstant.SHEET_HIDE]=E,i.register(I.UI,S.Menu.CONTEXT_BEFORE_SHOW,n,"RID","SHEETID","VERSION","UI"))}function n(t,e,n,o){if("MI_SHEET_CONTEXT"===o.id){var a=s.data.getWorkBook(t,n),i=a.SheetList.getSheets(),I=i.length;1==I?r.disable(E):r.enable(E)}}var E,s=t.sPlusPlus,o=t.document,a=t.ZSEvents,i=a.topic,I=a.Groups,S=a.Names,r=t.UIUtil.Component,u=t.ZSConstants,C=u.FeatureConstants,T=u.I18N,l=u.wCC,c=s.view.Toolbar.Feature[C.HIDE_SHEET];i.register(I.UI,S.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(t){function e(t,e){"VERSION"!=e&&(E=o.createElement("li"),E.setAttribute("data",'{"label":"'+C["Sheet.Unhide"]+'"}'),E.setAttribute("data-menu-id",r.SUBMENUITEM+T.UNHIDE_SHEET+r.IDENTITY),E.id=r.MI+ZSConstants.ContextConstant.SHEET_UNHIDE+r.MENU,t[ZSConstants.ContextConstant.SHEET_UNHIDE]=E,I.register(a.UI,S.Menu.CONTEXT_BEFORE_SHOW,n,"RID","VERSION","UI"))}function n(t,e,n){if("MI_SHEET_CONTEXT"===n.id){var E=s.data.getWorkBook(t,e),o=E.SheetList.getHiddenSheets(),i=o.length,I=i>=1?!1:!0;u.zmenu("#"+n.id,"setMenuItemsAttribute",["#"+r.MI+ZSConstants.ContextConstant.SHEET_UNHIDE+r.MENU],"hidden",I)}}{var E,s=t.sPlusPlus,o=t.document,i=t.ZSEvents,I=i.topic,a=i.Groups,S=i.Names,u=t.UIUtil.Component,N=t.ZSConstants,T=N.FeatureConstants,C=N.I18N,r=N.wCC;s.view.Toolbar.Feature[T.UNHIDE_SHEET]}I.register(a.UI,S.Menu.INIT_SHEET_CONTEXT,e,"MENU_BAG","VIEW")}(this);
!function(e){function t(e,t){"VERSION"!=t&&(o=h.cloneNode(!0),o.setAttribute("disabled",!0),o.id="PasteSheet_Context",o.addEventListener("click",function(){M.execute()}),e[N.SHEET_PASTE]=o)}function n(e){S=h.cloneNode(!0),S.id="SheetBar_pasteSheet_Context",S.addEventListener("click",function(){M.execute()}),e[N.SHEET_PASTE]=S}function i(e,t,n,i,E,s,o){b=!0,T=E,r=o}function E(e){if(b){var t=A["CopySheet.Paste"]+" '"+T+"'";e.id==d.MI+"SHEET_CONTEXT"&&(a.Component.zmenu("#"+d.MI+"SHEET_CONTEXT","setMenuItemsAttribute",["#PasteSheet_Context"],"label",t),a.Component.zmenu("#"+d.MI+"SHEET_CONTEXT","setMenuItemsAttribute",["#PasteSheet_Context"],"disabled",!1))}}function s(e){if(e.id==d.MI+"SHEETBAR_CONTEXT")if(b){e.style.visibility="visible",S.style.display="";var t=A["CopySheet.Paste"]+" '"+T+"'";a.Component.zmenu("#"+d.MI+"SHEETBAR_CONTEXT","setMenuItemsAttribute",["#SheetBar_pasteSheet_Context"],"label",t)}else e.style.visibility="hidden",S.style.display="none"}var o,S,T,r,u=e.sPlusPlus,a=e.UIUtil,C=e.ZSEvents,l=C.topic,I=C.Groups,_=C.Names,c=e.ZSConstants,N=c.ContextConstant,d=c.wCC,A=c.I18N,H=e.document,M=u.view.Toolbar.Feature.PASTE_SHEET,b=!1,h=function(){var e=H.createElement("li");return e.setAttribute("data",'{"label":"'+A["CopySheet.Paste"]+'"}'),e}();M.getCopiedSheetName=function(){return{sheetName:T,src_rid:r}},l.register(I.UI,_.Menu.CONTEXT_BEFORE_SHOW,E,"UI"),l.register(I.UI,_.Menu.INIT_SHEET_CONTEXT,t,"MENU_BAG","VIEW"),l.register(I.UI,_.Menu.INIT_SHEETBAR_CONTEXT,n,"MENU_BAG","VIEW"),l.register(I.UI,_.Menu.CONTEXT_SHOW,s,"UI"),l.register(I.Listener,_.ServerClip.SHEET.ADD,i,"RID","SHEETID","VERSION","SRC_SHEETID","SRC_SHEETNAME","LANG","SRC_RID")}(this);
!function(t){function n(){e(),this.init()}function e(){u.publish(E.UI,T.Menu.INIT_SHEETBAR_CONTEXT,{MENU_BAG:r})}function s(){var t=new n,e="MI_SHEETBAR_CONTEXT";c.register(e,t)}var i=(t.sPlusPlus,t.ZSConstants),o=t.ZSEvents,u=o.topic,E=o.Groups,T=o.Names,C=i.ContextConstant,c=ZSClass.ContextMenu,r=[],S=[[C.SHEET_PASTE]];n.prototype={init:function(){this.sheetCtxMenu=c.create("MI_SHEETBAR_CONTEXT",r,S)},open:function(t){c.open(t,this.sheetCtxMenu)}},s()}(this);
!function(E){function t(){n(),this.init()}function n(){s.publish(S.UI,_.Menu.INIT_SHEET_CONTEXT,{MENU_BAG:H})}function T(){var E=new t,n="MI_SHEET_CONTEXT";u.register(n,E),s.register(S.Listener,_.ContextMenu.INIT,function(t){E.init(t)},"VIEW")}var e=(E.sPlusPlus,E.ZSConstants),i=E.ZSEvents,s=i.topic,S=i.Groups,_=i.Names,o=e.ContextConstant,u=ZSClass.ContextMenu,H=[],C=[[o.SHEET_INSERT,o.SHEET_DUPLICATE,o.SHEET_DELETE,o.SHEET_RENAME],[o.SHEET_COPY,o.SHEET_PASTE,o.SHEET_MOVE,o.SHEET_TABCOLOR,o.VBA_EDITOR],[o.SHEET_HIDE,o.SHEET_UNHIDE,o.MANAGE_FORM,o.SHEET_LOCKSHEET]],I=[];t.prototype={init:function(E){var t="VERSION"==E?I:C;this.sheetCtxMenu=u.create("MI_SHEET_CONTEXT",H,t)},open:function(E){u.open(E,this.sheetCtxMenu)}},T()}(this);
!function(t){function e(){i()}function i(){T.publish(o.UI,C.Menu.INIT_GRID_CONTEXT,{MENU_BAG:O}),T.publish(o.UI,C.Menu.INIT_PIVOT_CONTEXT,{MENU_BAG:r}),T.publish(o.UI,C.Menu.INIT_LOCK_CONTEXT,{MENU_BAG:u})}function n(){var t=new e;t.init();var i="MI_GRID_CONTEXT";N.register(i,t),T.register(o.Listener,C.ContextMenu.INIT,function(e){t.init(e)},"VIEW")}var I=t.sPlusPlus,s=t.ZSConstants,E=t.ZSEvents,T=E.topic,o=E.Groups,C=E.Names,_=s.ContextConstant,N=ZSClass.ContextMenu,O=[],r=[],u=[],M=[[_.CUT,_.COPY,_.PASTE,_.CLEAR],[_.INSERT,_.DELETE],[_.ADD_NOTE,_.EDIT_NOTE,_.ADD_COMMENT],[_.ADD_HYPERLINK,_.SPARKLINE,_.DEFINE_NAME,_.PICKLIST],[_.LOCK_RANGE,_.UNLOCK_RANGE,_.PUBLISH_RANGE]],D=[[_.COPY]],R=[[_.PIVOT_BUILDER,_.PIVOT_MOVE,_.PIVOT_COPY,_.PIVOT_REFRESH,_.PIVOT_DELETE],[_.PIVOT_CHART],[_.ADD_COMMENT]],a=[[_.ADD_COMMENT,_.COPY,_.UNLOCK_RANGE]];e.prototype={init:function(t){var e="VERSION"==t?D:M;this.gridCtxMenu=N.create("MI_GRID_CONTEXT",O,e),this.pivotCtxMenu=N.create("MI_GRID_CONTEXT",r,R),this.lockCtxMenu=N.create("MI_GRID_CONTEXT",u,a)},open:function(t){var e=I.view.getActiveGridID(),i=I.view.getResourceID(e),n=I.view.getVersionID(e),s=I.view.getSheetID(e),E=I.view.getSheetState(e,s),T=E.getActiveCellRange(),o=I.data.getWorkBook(i,n),C=o.getSheetObj(s),_=!!C.Pivot.isXists(T.startRow,T.startCol),O=!(!C.ProtectedRanges.isXists(T.startRow,T.startCol)&&!o.ProtectedSheets.isSheetLocked(s));_?N.open(t,this.pivotCtxMenu):O?N.open(t,this.lockCtxMenu):N.open(t,this.gridCtxMenu)}},n()}(this);
!function(t){function n(){E(),this.init()}function E(){o.publish(C.UI,O.Menu.INIT_ROW_HEAD_CONTEXT,{MENU_BAG:u})}function e(){var t=new n;t.init();var E="MI_ROWHEAD_CONTEXT";_.register(E,t),o.register(C.Listener,O.ContextMenu.INIT,function(n){t.init(n)},"VIEW")}{var i=(t.sPlusPlus,t.ZSConstants),s=t.ZSEvents,o=s.topic,C=s.Groups,O=s.Names,N=i.ContextConstant,_=ZSClass.ContextMenu,u=[],I=[[N.CUT,N.COPY,N.PASTE,N.CLEAR],[N.INSERT,N.DELETE_ROW,N.ROW_HEIGHT_OPTIONS,N.HIDE_ROWS,N.UNHIDE_ROWS],[N.ADD_COMMENT],[N.DEFINE_NAME],[N.LOCK_RANGE,N.UNLOCK_RANGE,N.PUBLISH_RANGE]],T=[[N.COPY]];[[N.ADD_COMMENT,N.COPY]]}n.prototype={init:function(t){var n="VERSION"==t?T:I;this.rowHeadCtxMenu=_.create("MI_ROWHEAD_CONTEXT",u,n)},open:function(t){_.open(t,this.rowHeadCtxMenu)}},e()}(this);
!function(t){function n(){C(),this.init()}function C(){s.publish(o.UI,N.Menu.INIT_COL_HEAD_CONTEXT,{MENU_BAG:u})}function E(){var t=new n;t.init();var C="MI_COLHEAD_CONTEXT";_.register(C,t),s.register(o.Listener,N.ContextMenu.INIT,function(n){t.init(n)},"VIEW")}{var e=(t.sPlusPlus,t.ZSConstants),i=t.ZSEvents,s=i.topic,o=i.Groups,N=i.Names,O=e.ContextConstant,_=ZSClass.ContextMenu,u=[],I=[[O.CUT,O.COPY,O.PASTE,O.CLEAR],[O.INSERT,O.DELETE_COL,O.COLUMN_WIDTH_OPTIONS,O.HIDE_COLS,O.UNHIDE_COLS],[O.ADD_COMMENT],[O.DEFINE_NAME],[O.LOCK_RANGE,O.UNLOCK_RANGE,O.PUBLISH_RANGE]],T=[[O.COPY]];[[O.ADD_COMMENT,O.COPY]]}n.prototype={init:function(t){var n="VERSION"==t?T:I;this.colHeadCtxMenu=_.create("MI_COLHEAD_CONTEXT",u,n)},open:function(t){_.open(t,this.colHeadCtxMenu)}},E()}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key,o=n.Entry.ShortCut.Context,u=o.keyDown,C=t.ZSConstants.JSKeyCode,a=e.view.Toolbar.Feature[s.CUT];u[C.SUPER+"+"+C.X]=a.execute,u[C.CTRL+"+"+C.X]=a.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Events.Key,o=s.Entry.ReadOnlyShortCut.Context,a=o.keyDown,u=t.ZSConstants.JSKeyCode,C=e.view.Toolbar.Feature[n.COPY];a[u.SUPER+"+"+u.C]=C.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key,o=n.Entry.ShortCut.Context,u=o.keyDown,S=t.ZSConstants.JSKeyCode,r=e.view.Toolbar.Feature[s.PASTE];u[S.SUPER+"+"+S.V]=r.executeShortCut,u[S.SUPER+"+"+S.SHIFT+"+"+S.V]=r.executeShortCut}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key,o=n.Entry.ShortCut.Context,u=o.keyDown,a=t.ZSConstants.JSKeyCode,r=e.view.Toolbar.Feature[s.UNDO];u[a.SUPER+"+"+a.Z]=r.execute}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,n=t.view.Events.Key,u=n.Entry.ShortCut.Context,o=u.keyDown,a=e.ZSConstants.JSKeyCode,r=t.view.Toolbar.Feature[s.REDO];o[a.SUPER+"+"+a.Y]=r.execute,o[a.SUPER+"+"+a.SHIFT+"+"+a.Z]=r.execute,o[a.F4]=r.executeRepeat,o[a.ALT+"+"+a.ENTER]=r.executeRepeat}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.BOLD],o=e.view.Events.Key,u=o.Entry.ShortCut.Context,a=u.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.B]=n.execute,a[r.CTRL+"+"+r.B]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.ITALIC],o=e.view.Events.Key,u=o.Entry.ShortCut.Context,C=u.keyDown,a=t.ZSConstants.JSKeyCode;C[a.SUPER+"+"+a.I]=n.execute,C[a.CTRL+"+"+a.I]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.UNDERLINE],o=e.view.Events.Key,u=o.Entry.ShortCut.Context,a=u.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.U]=n.execute,a[r.CTRL+"+"+r.U]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.STRIKETHROUGH],o=e.view.Events.Key,u=o.Entry.ShortCut.Context,a=u.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.SHIFT+"+"+r.X]=n.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=t.ZSConstants.JSKeyCode,o=e.view.Toolbar.Feature[n.HYPERLINK],a=e.view.Events.Key,r=a.Entry.ShortCut.Context,u=r.keyDown;u[s.SUPER+"+"+s.K]=o.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,r=e.view.Toolbar.Feature[n.DATE],s=e.view.Events.Key,S=s.Entry.ShortCut.Context,o=S.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.SEMICOLON]=r.currentDate,o[u.SUPER+"+"+u.SHIFT+"+"+u.SEMICOLON]=r.currentTime,o[u.SUPER+"+"+u.ALT+"+"+u.SEMICOLON]=r.currentDateAndTime}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.CURRENCY],o=e.view.Events.Key,u=o.Entry.ShortCut.Context,C=u.keyDown,r=t.ZSConstants.JSKeyCode,o=t.sPlusPlus.view.Events.Key,u=o.Entry.ShortCut.Context,C=u.keyDown;C[r.CTRL+"+"+r.SHIFT+"+"+r.FOUR]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.PERCENTAGE],o=t.sPlusPlus.view.Events.Key,u=o.Entry.ShortCut.Context,C=u.keyDown,a=t.ZSConstants.JSKeyCode;C[a.CTRL+"+"+a.SHIFT+"+"+a.FIVE]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key,o=n.Entry.ShortCut.Context,u=o.keyDown,a=t.ZSConstants.JSKeyCode,r=e.view.Toolbar.Feature[s.THOUSAND_SEPARATOR];u[a.CTRL+"+"+a.SHIFT+"+"+a.ONE]=r.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.FILTER],o=e.view.Events.Key,u=o.Entry.ShortCut.Context,a=u.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.SHIFT+"+"+r.L]=n.execute}(this);
!function(e){var t=e.sPlusPlus,s=t.view.Events.Key,n=(e.ZSClass,e.ZSConstants),u=n.FeatureConstants,o=n.JSKeyCode,a=t.view.Toolbar.Feature[u.PICKFROMLIST],s=e.sPlusPlus.view.Events.Key,r=s.Entry.ShortCut.Context,C=r.keyDown;C[o.ALT+"+"+o.DOWN]=a.execute}(this);
!function(t){function e(){C.isEnabled=C.isEnabled?!1:!0}var n=t.sPlusPlus,s=t.ZSConstants,o=s.FeatureConstants,a=n.view.Events.Key,i=a.Entry.ShortCut.Context,u=s.JSKeyCode,r=i.keyDown,C=n.view.Toolbar.Feature[o.AUTOCOMPLETE];r[u.CTRL+"+"+u.SHIFT+"+"+u.Q]=e}(this);
!function(t){function e(t){t.preventDefault(),u.show()}function n(t){t.preventDefault(),u.hide()}var s=t.sPlusPlus,o=t.ZSConstants.FeatureConstants,u=s.view.Toolbar.Feature[o.HIDE_ROWS],a=s.view.Events.Key,r=a.Entry.ShortCut.Context,i=r.keyDown,S=t.ZSConstants.JSKeyCode;i[S.SUPER+"+"+S.SHIFT+"+"+S.NINE]=e,i[S.SUPER+"+"+S.NINE]=n}(this);
!function(t){function e(t){t.preventDefault(),o.show()}var n=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,o=n.view.Toolbar.Feature[s.HIDE_COLUMNS],u=n.view.Events.Key,a=u.Entry.ShortCut.Context,r=a.keyDown,C=t.ZSConstants.JSKeyCode;r[C.SUPER+"+"+C.SHIFT+"+"+C.ZERO]=e}(this);
!function(t){var s=t.sPlusPlus,e=t.ZSConstants.FeatureConstants,n=s.view.Toolbar.Feature[e.FORMATCELLS],o=t.sPlusPlus.view.Events.Key,u=o.Entry.ShortCut.Context,a=u.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.SHIFT+"+"+r.ONE]=n.Callshortcut}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Events.Key,o=s.Entry.ShortCut.Context,a=o.keyDown,r=t.ZSConstants.JSKeyCode,u=e.view.Toolbar.Feature[n.DEFINE_NAME];a[r.SUPER+"+"+r.F3]=u.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.SAVEAS],o=e.view.Events.Key,S=o.Entry.ShortCut.Context,a=S.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.SHIFT+"+"+r.S]=s.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.PRINT],o=e.view.Events.Key,a=o.Entry.ReadOnlyShortCut.Context,r=a.keyDown,u=t.ZSConstants.JSKeyCode;r[u.SUPER+"+"+u.P]=s.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=e.view.Toolbar.Feature[n.GOTO],s=e.view.Events.Key,a=s.Entry.ReadOnlyShortCut.Context,i=a.keyDown,r=t.ZSConstants.JSKeyCode;i[r.SUPER+"+"+r.G]=o.openDialog,i[r.SUPER+"+"+r.SHIFT+"+"+r.G]=o.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.COMMENTS],o=e.view.Events.Key,C=o.Entry.ShortCut.Context,a=C.keyDown,r=t.ZSConstants.JSKeyCode;a[r.SUPER+"+"+r.ALT+"+"+r.M]=s.openAndAddComment}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key,o=n.Entry.ShortCut.Context,u=o.keyDown,a=t.ZSConstants.JSKeyCode,r=e.view.Toolbar.Feature[s.AUTOSUM];u[a.ALT+"+"+a.EQUAL]=r.executeSum}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=e.view.Toolbar.Feature[n.OPEN],s=e.view.Events.Key,a=s.Entry.ReadOnlyShortCut.Context,i=a.keyDown,r=t.ZSConstants.JSKeyCode;i[r.SUPER+"+"+r.O]=o.openDialog,i[r.CTRL+"+"+r.O]=o.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Events.Key,o=s.Entry.ShortCut.Context,a=o.keyDown,r=t.ZSConstants.JSKeyCode,u=e.view.Toolbar.Feature[n.MANAGE_MACRO];a[r.ALT+"+"+r.F8]=u.openDialog}(this);
!function(t){var s=t.sPlusPlus,e=t.ZSConstants.FeatureConstants,n=s.view.Events.Key,o=n.Entry.ReadOnlyShortCut.Context,a=o.keyDown,r=t.ZSConstants.JSKeyCode,r=(s.view.Toolbar.Feature[e.VBA_EDITOR],t.ZSConstants.JSKeyCode),i=t.ZSEvents,u=i.topic,C=i.Groups,c=i.Names;a[r.ALT+"+"+r.F11]=function(){u.publish(C.UserAction,c.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros"})}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,s=t.view.Toolbar.Feature[n.ZOOM],r=t.view.Events.Key,S=r.Entry.ReadOnlyShortCut.Context,o=S.keyDown,a=e.ZSConstants.JSKeyCode;o[a.SUPER+"+"+a.ADD]=s.Increment,o[a.SUPER+"+"+a.EQUAL]=s.Increment,o[a.SUPER+"+"+a.SUBTRACT]=s.Decrement,o[a.SUPER+"+"+a.MINUS]=s.Decrement,o[a.SUPER+"+"+a.ZERO]=s.setDefault}(this);
!function(e){var t=e.sPlusPlus,E=e.ZSConstants.FeatureConstants,C=t.view.Toolbar.Feature[E.CLEAR_ALL],o=(t.view.Toolbar.Feature[E.CLEAR_ALL+"_Contents"],t.view.Toolbar.Feature[E.CLEAR_ALL+"_Formats"]),s=t.view.Events.Key,u=s.Entry.ShortCut.Context,n=u.keyDown,L=e.ZSConstants.JSKeyCode;n[L.SUPER+"+"+L.BACKSPACE]=C.execute,n[L.SUPER+"+"+L.DELETE]=C.execute,n[L.CTRL+"+"+L.BACKSPACE]=C.execute,n[L.CTRL+"+"+L.DELETE]=C.execute,n[L.SHIFT+"+"+L.BACKSPACE]=o.execute,n[L.SHIFT+"+"+L.DELETE]=o.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.NEW_FILE],o=e.view.Events.Key,a=o.Entry.ShortCut.Context,r=a.keyDown,u=t.ZSConstants.JSKeyCode;r[u.SUPER+"+"+u.N]=s.createNewDocument,r[u.CTRL+"+"+u.N]=s.createNewDocument}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.FORMAT_PAINTER],o=e.view.Events.Key,a=o.Entry.ShortCut.Context,r=a.keyDown,u=t.ZSConstants.JSKeyCode;r[u.ESC]=s.negateFormatPainter}(this);
!function(t){function e(t){t.preventDefault(),u.quickFind(!0)}function n(t){t.preventDefault(),u.openDialog()}var o=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,u=o.view.Toolbar.Feature[s.FIND],a=o.view.Events.Key,i=a.Entry.ReadOnlyShortCut.Context,r=i.keyDown,S=t.ZSConstants.JSKeyCode;r[S.SUPER+"+"+S.H]=n,r[S.SUPER+"+"+S.SHIFT+"+"+S.H]=n,r[S.SUPER+"+"+S.F]=e}(this);
!function(t){function e(t,e,n,s){t.repeat||o.execute(t,e,n,s)}var n=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,o=n.view.Toolbar.Feature[s.RECALCULATE],u=n.view.Events.Key,a=u.Entry.ShortCut.Context,r=a.keyDown,C=t.ZSConstants.JSKeyCode;r[C.F9]=e}(this);
!function(t){var e=t.sPlusPlus,s=t.sPlusPlus.view.Events.Key,n=s.Entry.ShortCut.Context,o=n.keyDown,u=t.ZSConstants.JSKeyCode,a=t.ZSConstants.FeatureConstants,i=e.view.Toolbar.Feature[a.NOTE];o[u.SHIFT+"+"+u.F2]=function(t,e,s,n){!i.isLockedRange()&&i.execute(t,e,s,n)}}(this);
!function(t){var e=t.sPlusPlus,s=t.sPlusPlus.view.Events.Key,n=s.Entry.ShortCut.Context,o=n.keyDown,u=t.ZSConstants.JSKeyCode,a=t.ZSConstants.FeatureConstants,r=e.view.Toolbar.Feature[a.INSERT_SHEET];o[u.SHIFT+"+"+u.F11]=function(t,e,s,n){r.execute(t,e,s,n)}}(this);
!function(e){function t(){m=document.createElement("ul"),m.id="sidePanelViewSetting",m.setAttribute("data-ctype","zmenu"),m.setAttribute("data-content-type","icon-text"),a(m),S.appendChild(m),v.bind(m,"zmenubeforeshow",function(){T.publish(A.UI,I.Toolbar.INIT_MENU,{DOM:m})}),v.bind(m,"zmenuitemclick",function(e,t){var a=t.data.value;switch(a){case"showText":o(t);break;case"showFormulaBar":c(t);break;case"showHeader":break;case"showSheetTabs":u(t);break;case"showUserPresence":d(t);break;case"highlightAllComments":k.triggerHighlightAllComments(t);break;case"highlightLocks":f.execute(t);break;case"highlightInvalidData":C.execute(t)}});var e=h.view.getActiveGridID(),t=h.view.getResourceID(e),i=h.view.getSheetID(e),r=h.view.getVersionID(e);UserAction.UpdateScreenViewPort(t,i,r)}function a(e){r(e),n(e),s(e),E&&E.createShowAllMenu(e),y&&y.createMenuElement(e),i(e),f&&f.createMenuElement(e),C&&C.createMenuElement(e),k&&k.createHighlightMenuElement(e)}function i(e){var t=document.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}function r(e){var t=document.createElement("li");t.setAttribute("data-value","showText"),t.setAttribute("data-item-type","checkbox"),t.innerText=D["Viewsettings.sidebar"],e.appendChild(t)}function n(e){var t=document.createElement("li");t.setAttribute("data-value","showFormulaBar"),t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-checked",!0),t.innerText=D["Viewsettings.formulabar"],e.appendChild(t)}function s(e){var t=document.createElement("li");t.setAttribute("data-value","showSheetTabs"),t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-checked",!0),t.innerText=D["Viewsettings.sheettab"],e.appendChild(t)}function o(e){var t=document.querySelector(".sPHldr"),a=e.menuitem.prop("checked");a?(b.Right.sidePanelBar=60,t.classList.add("spView")):(b.Right.sidePanelBar=50,t.classList.remove("spView")),l()}function c(e){var t=document.querySelector("#formulaBar"),a=e.menuitem.prop("checked");a?(b.Top.formulaBar=24,t.style.display=""):(b.Top.formulaBar=0,t.style.display="none"),l()}function u(e){var t=document.querySelector(".sheetTabHldrCtn"),a=e.menuitem.prop("checked");a?(b.Bottom.sheetTabsBar=30,t.style.display=""):(b.Bottom.sheetTabsBar=0,t.style.display="none"),l()}function l(){var e=h.view.getActiveGridID(),t=h.view.getResourceID(e),a=h.view.getSheetID(e),i=h.view.getVersionID(e);UserAction.UpdateScreenViewPort(t,a,i),UserAction.DummyScroll(t,a,i)}function d(e){var t=e.menuitem.prop("checked"),a=t?!0:!1;y.execute(a)}{var m,h=e.sPlusPlus,p=e.ZSClass,b=h.view.measures,v=(p.SidePanelUtility,e.UIUtil.Component),w=e.ZSConstants.FeatureConstants,g=e.ZSEvents,T=g.topic,A=g.Groups,I=g.Names,S=document.getElementById("popupmenu"),E=h.view.Toolbar.Feature[w.NOTE_SHOW_HIDE],y=h.view.Toolbar.Feature[w.USER_PRESENCE],f=h.view.Toolbar.Feature[w.HIGHLIGHT_LOCKS],C=h.view.Toolbar.Feature[w.HIGHLIGHT_DATA_VALIDATION],k=h.view.Toolbar.Feature[w.COMMENTS],D=e.ZSConstants.I18N;e.ZSConstants.wCC}T.register(A.UI,I.Layout.TEMPLATE_LOADED,t)}(this);
