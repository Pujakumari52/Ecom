//$Id$
/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at docs.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */
function ZDDialog(){}function ZDUtils(){}function ZDMenu(){}function ZDConstants(){this.openTarget="_blank",this.callback=!1,this.folderArray=[],this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.templates="false",this.nameSortArrow="",this.nameSortOrder="",this.timeSortArrow="",this.timeSortOrder="desc",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.isShareEnabled=!1,this.advSearchFile=!1,this.trashsort=!1,this.searchQuery="",this.jsonData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.templateObj={},this.rename_openfile={id:"rename_openfile",label:zd_js_obj.rename,icon:"zdc-rename_css",attr:{title:zd_js_obj.rename}},this.trash_openfile={id:"trash_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.delete_openfile={id:"delete_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.restore_openfile={id:"restore_openfile",label:zd_js_obj.restore,icon:"zdc-restoreicon_css",attr:{title:zd_js_obj.restore}},this.viewer={id:"zd_viewer_perm",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator={id:"zd_collaborator_perm",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner={id:"zd_coowner_perm",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_only={id:"zd_comment_perm",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill={id:"zd_readfill_perm",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.SCR_WTH="",this.SCR_HT="",this.searchType="relevance",this.createFolder={id:"createfolder",label:zd_js_obj.create,icon:"zdc-foldericon_css"},this.renameFolder={id:"renamefolder",label:zd_js_obj.rename,icon:"zdc-rename_css"},this.deleteFolder={id:"deletefolder",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive"},this.viewer_details={id:"viewer_details",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator_details={id:"collaborator_details",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner_details={id:"coowner_details",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_details={id:"comment_details",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill_details={id:"readfill_details",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.trimmedEmails="",this.trimmedPerGroupIds="",this.trimmedOrgGroupIds="",this.groupNameList=[],this.groupNameAndIdList=[],this.docId,this.allShareJson={},this.isInternalMailId=!0,this.isCo_owner=!1,this.isFolderShare=!1,this.isVisibility=!1,this.updateShareStatus=!1,this.folderIds,this.resIds,this.autocomplete_selectValue="",this.G_fromAutoComplete=[],this.G_zdc_permissionType="2",this.defaultText="",this.templateCount=0}function FILEDIALOG(){}function ZDSHAREDIALOG(){}function COMMENTS(){}function TASKS(){}function REMINDER(){}ZDDialog.showCommonDialog=function(e,t,s,i,a,o,n,d,r,l,c,_){_=_?_:1e4;ZD("#"+s).dialog({autoOpen:!0,zIndex:_,title:e,modal:t,resizable:r,closeText:"closeIcon",buttons:i,position:a,width:o,minWidth:l,minHeight:c,draggable:n,height:d,drag:function(){if("sharedialogdiv"==s){if(ZD("#zd_sharetextarea").is(":visible")){var e=ZD("#zd_sharetextarea").offset().top,t=ZD("#zd_sharetextarea").offset().left;ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({top:e+45,left:t})}if(ZD("#zdc_visible_default_hidediv").is(":visible")){var i=ZD("#zdc_visible_changelink"),a=ZD(i).offset(),o=a.left-100,n=a.top+30;ZD("#zdc_visible_default_hidediv").css({top:n,left:o})}}},open:function(){ZD("#"+s).parent().addClass("docsdialog").prev();if("undefined"!=typeof G_OF_OBJ&&!ZD("#docsdialoguidialogzindex").length&&"zohosheet"===G_OF_OBJ.urlInvoker){var e=ZD(this).closest(".ui-dialog"),t=parseInt(e.css("z-index"))+5,i=document.createElement("style");i.type="text/css",i.id="docsdialoguidialogzindex";var a=".docsdialog.ui-dialog{z-index:";a+=t+" !important;}",i.innerHTML=a,document.getElementsByTagName("head")[0].appendChild(i)}},resize:function(e,t){ZDDialog.resizeDialog(e,t,s)}});return ZD("#"+s).bind("dialogclose",function(){return ZDDialog.closePopUp(s),ZD(document).trigger("dialogbeforeclose"),!1}),!1},ZDDialog.resizeDialog=function(e,t,s){if("attachopenfiledialogdiv"==s){var i=t.size.height-92;ZD("#showopenservicefilespace").css("height",i),ZD("#showopenservicefilespace").openfiledatagrid("resize")}else if("sharedialogdiv"==s){ZD("#zd_initial_sharetextarea").is(":visible")&&ZD("#zd_initial_sharetextarea").trigger("focus");var i=t.size.height-279;ZD("#sharedialogdiv").css("overflow","hidden"),ZD(".privateshare-list").css("height",i),ZD("#zd_top_menu").is(":visible")&&ZD(".privateshare-list").css("height",i-93)}else if("attachfiledialogdiv"==s){var i=t.size.height-225;ZD("div#showattachfilespace").css("height",i),ZD("div#showattachfilespace").attachfiledatagrid("resize")}else if("adddocdialogdiv"==s){var i=t.size.height-255;ZD("div#tree_container").css("height",i).parent().css("height",i+40)}},ZDDialog.openAlert=function(e,t,s,i,a,o,n){ZD("#frameDiv").remove(),(void 0==a||""==a)&&(a=[200,350]),o=350;var d=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(d).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:i,position:a,width:o,draggable:n,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),!1}),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.componentAlert=function(e,t,s,i,a,o,n){ZD("#frameDiv").remove(),(void 0==a||""==a)&&(a=[]),o=520;var d=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(d).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,dialogClass:"zdocsalert",buttons:i,position:a,width:o,draggable:n,height:"auto",open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD(".zdocsalert").find(".ui-icon-closethick").hide(),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.createNewFolderDialog=function(e,t,s,i,a,o){ZD("#createnewfolderdiv").remove();var n=ZD('<div id="createnewfolderdiv" style="display:none;"></div>');ZD(n).appendTo("body");ZD("#createnewfolderdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:s,position:i,width:a,draggable:!0,height:o,open:function(){ZD("#createnewfolderdiv").parent().addClass("docsdialog")}});ZD("#createnewfolderdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("createnewfolderdiv"),!1})},ZDDialog.showValidatePasswordDialog=function(e,t,s,i,a,o){ZD("#passworddialogdiv").remove();var n=ZD('<div id="passworddialogdiv" style="display:none;"></div>');ZD(n).appendTo("body");ZD("#passworddialogdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:s,position:i,width:a,draggable:!0,height:o,open:function(){ZD(".ui-dialog-titlebar-close").hide()},closeOnEscape:!1,open:function(){ZD("#passworddialogdiv").parent().addClass("docsdialog")}});ZD("#passworddialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("passworddialogdiv"),!1})},ZDDialog.showDialogForSendingMail=function(e,t,s,i,a,o){ZD("#securesharedialogdiv").remove();var n=ZD('<div id="securesharedialogdiv" style="display:none;"></div>');ZD(n).appendTo("body");ZD("#securesharedialogdiv").dialog({autoOpen:!0,zIndex:100008,title:e,modal:!1,resizable:!1,closeText:"closeIcon",buttons:s,position:i,width:a,draggable:!0,height:o,open:function(){ZD("#securesharedialogdiv").parent().addClass("docsdialog")}});ZD("#securesharedialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("securesharedialogdiv"),!1})},ZDDialog.closePopUp=function(e,t){ZD("#"+e).unbind("dialogclose"),"attachopenfiledialogdiv"==e?(ZD("#zd_leftmenu,#zd_rightmenu").unbind().remove(),ZD("#recentservicedocs").addClass("selectedView"),ZD("#serviceDialogLeftPanel,#showopenservicefilespace,div#selectboxdiv,div#searchdivforservicefiles,#servicefilepagination,table.toolbar").undelegate(),ZD("#attachopenfiledialogdiv").unbind("dialogclose"),ZD("div#showopenservicefilespace").openfiledatagrid("destroy"),ZD("#attachopenfiledialogdiv").dialog("destroy"),ZD("#attachopenfiledialogdiv").filedialog("destroy").remove(),ZD("#createnewfolderdiv,#frameDiv").dialog("destroy").remove()):"passworddialogdiv"==e?ZD("#passworddialogdiv").dialog("destroy").remove():"securesharedialogdiv"==e?(ZD("#securesharedialogdiv").dialog("destroy").remove(),public_PwdExpiryDate="",ZD_G_CurrentVisibility=""):"linkdocsdialogdiv"==e?(ZD("#recentservicedocs").addClass("selectedView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("destroy"),ZD("#linkdocsdialogdiv").dialog("destroy"),ZD("#linkdocsdialogdiv").linkdocsdialog("destroy").remove()):"attachfiledialogdiv"==e?(ZD("#attachfiledialogdiv").unbind("dialogclose"),ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("div#attachfiledialogdiv").attachfiledialog("destroy").remove(),ZD("#attachfiledialogdiv").dialog("destroy").remove()):"zdattachcontainer"==e?(ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("#zdattachcontainer").attachfiledialog("destroy").remove()):"adddocdialogdiv"==e?(ZD("#adddocdialogdiv").unbind("dialogclose"),ZD("#expand_view,#folder_container").undelegate(),ZD("#"+e).dialog("destroy").remove()):"frameDiv"==e||"createnewfolderdiv"==e||"sharedialogdiv"==e||"uploadConfirmDiv"==e?("sharedialogdiv"==e&&(ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zd_leftmenu,#visibilityoptions_top").unbind(),ZD("#zd_leftmenu,#visibilityoptions_top").remove(),ZD("#sharedialogdiv").undelegate(),ZD("#zdc_visible_default_hidediv").undelegate(),ZD("body").undelegate("#sharedialogdiv, #zdc_visible_default_hidediv, .ui-widget-overlay","click"),ZD("#zd_sharetextarea").autocomplete("destroy"),ZD("#zd_sharetextarea,#share_via_link_edit").unbind(),ZD("#frameDiv").dialog("destroy").remove(),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.G_fromAutoComplete=[],G_OF_OBJ.isCo_owner=!1),"passwordvalidation"!=t&&ZD("#zdc_visible_default_hidediv").remove(),ZD("#"+e).dialog("destroy").remove()):"sharecollabupgradediv"==e?ZD("#"+e).dialog("destroy").remove():"mycollaboratorslistdiv"==e?ZD("#"+e).dialog("destroy").remove():"dialogdiv"==e?ZD("#"+e).html("").removeAttr("style").dialog("destroy"):"statusdialogdiv"==e?ZD("#"+e).dialog("destroy").remove():"customfieldsdialogdiv"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"sharefileaslinkcontainer"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zmoveto-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zdocssaveas-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"initSaveAs"===e&&(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove())},ZDDialog.showExternalUsersList=function(e,t,s,i,a,o){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var n=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(n).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"invalidList"==a?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_invalid+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"):3==i&&"externalList"==a&&0==o?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_coowner_permission_not_allowed+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_continue_remove_users_share_again+"</div></div></div>").removeAttr("style"):ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_list_contains_people_not_part_organization+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_are_you_sure_you_want_to_share+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showNonZohoUserList=function(e,t,s){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var i,a=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');i="NONE"==zd_third_party||""==zd_third_party||"undefined"==zd_third_party||void 0==zd_third_party?"zoho":zd_third_party.toLowerCase(),ZD(a).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div  style="display: block;"><div><div>'+ZDUtils.replaceParams(zd_js_obj.label_users_groups_listed_invalid,new Array(i))+':</div><div class="zdc-external-list"></div></div></div>').removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showInactiveUserList=function(e,t,s){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var i=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(i).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_are_inactive+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.sharePolicyFailList=function(e,t,s,i,a){ZD("#frameDiv").remove(),(void 0==s||""==s)&&(s=[200,350]),width=450;var o=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(o).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:s,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"ext_fail"==i?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Your organization policy does not allow you to share with below users:</div><div class="zdc-external-list"></div><div>To continue sharing, please contact your administrator.</div></div></div>').removeAttr("style"):"accept_fail"==i&&ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Organization policy of below user(s) does not allow you to share with them :</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),"undefined"==typeof a&&(ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()),!1}),!1},ZDDialog.showStatusDialog=function(e,t,s,i,a){var o=ZD('<div id="statusdialogdiv" style="display:none;"></div>');if(ZD(o).appendTo("body"),(""===s||void 0===s)&&(s=[SCR_WTH-SCR_WTH/1.6,SCR_HT-SCR_HT/1.6]),ZDdialog=ZD("#statusdialogdiv").dialog({autoOpen:!0,title:e,modal:t,resizable:!1,closeText:"",buttons:"",position:s,width:i,draggable:!0,height:a,open:function(){ZD(".ui-dialog-titlebar-close").hide()}}),!ZD("#statusdialogdiv").parent(".dialog-inner-container").length){var n=ZD('<div class="ui-corner-all dialog-inner-container" style="display:block;"></div>');n.insertBefore(ZD("#statusdialogdiv")).append(ZD("#statusdialogdiv"))}if(ZD(".sshow_layoutcontainer").length){var d=parseInt(ZD(".sshow_layoutcontainer").css("z-index"));ZD("#statusdialogdiv").closest(".ui-dialog").css("z-index",d+5)}ZD("#statusdialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("statusdialogdiv"),!1})},ZDDialog.showPreviewImg=function(e,t,s){ZDDialog.showCommonDialog(e,!0,"dialogdiv","","",SCR_WTH/1.35,!0,SCR_HT/1.5);var i='<div align="center"  style="padding:10px;"><img src="'+s+'" style="max-height:'+SCR_HT/1.5+'px" /></div>';ZD("#dialogdiv").html(i)},ZDUtils.SIZE_CALC_WITH_BYTES=1024,ZDUtils.getHeight=function(){var e;return self.innerHeight?e=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientHeight:document.body&&(e=document.body.clientHeight),e},ZDUtils.getWidth=function(){var e;return self.innerHeight?e=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?e=document.documentElement.clientWidth:document.body&&(e=document.body.clientWidth),e},ZDUtils.isEmailId=function(e){if(!e)return!1;e=e.trim();var t=/^(([\w\.]+)|[\w]([\w\-\.\+\'\/]*)@([\w\.\-]+\.[a-zA-Z]{2,22}))$/i;return t.test(e)},ZDUtils.substringName=function(e,t){var s=e;return s.length>t&&(s=s.substring(0,t),s+=".."),s},ZDUtils.escapeSpecialCharacters=function(e){e+="";var t=e.replace(/"/g,"&quot;"),s=t.replace(/'/g,"&apos;"),i=s.replace(/</g,"&lt;"),a=i.replace(/>/g,"&gt;");return a},ZDUtils.hasSpecialChar=function(e,t){var s="!@#$%^&*()+=-[]\\';,/{}|\":<>?";"docrename"==t?s="<>*%#&?\\',\"()":"emailidchk"==t&&(s="!#$%^&*()+=-[]\\';/{}|\":<>?");for(var i=1,a=0;a<e.length;a++)-1!=s.indexOf(e.charAt(a))&&(i+=1);return i>1?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.special_characters_validaton),!0):!1},ZDUtils.hasWhiteSpaceChar=function(e,t){return""===e?("renamefolder"==t?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.document_name_empty_validation),!0):!1},ZDUtils.showAlertBox=function(e,t){"rename"==t?FILEDIALOG.statusmsg("failure_status boldText",e):"folder"==t?FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_name_empty_validation):ZDDialog.openAlert(zd_js_obj.alert,e,!0)},ZDUtils.LoadingMsg=function(e){var t=zd_js_obj.loading;""!=e&&void 0!=e&&(t=e),ZD("#msgdiv").remove(),ZD("#openloadingmsg").append('<span  id="msgdiv" class="zdcomp_loading">'+t+"</span>")},ZDUtils.hideLoadingMsg=function(){ZD("#openloadingmsg").children().remove()},ZDUtils.openFileLoadingMsg=function(e){var t="Loading...";""!=e&&void 0!=e&&(t=e);var s=ZD("#showopenservicefilespace").height()/2.2,i=ZD("#showopenservicefilespace").width()/2.2;ZD("#openfileloadingdiv").css({"margin-left":i,"margin-top":s,display:"block"}).find("span").html(t)},ZDUtils.hideOpenFileLoadingMsg=function(){ZD("#openfileloadingdiv").hide()},ZDUtils.showLoading=function(e,t){var s=zd_js_obj.loading;void 0!=t&&""!=t&&(s=t);var i=e+"_msg";ZD("#"+i).remove(),ZD("#"+e).append('<span  id="'+i+'" class="zdcomp_loading">'+s+"</span>")},ZDUtils.hideLoading=function(e){ZD("#"+e).hide()},ZDUtils.getI18N=function(e){ZDUtils.getUserRelatedDetails("",e)},ZDUtils.split=function(e){return e.split(/,\s*/)},ZDUtils.extractLast=function(e){var t=e.toString();return ZD.trim(ZDUtils.split(t).pop())},ZDUtils.startsWithRegEx=function(e,t){var s=e.label,i=s.substring(0,s.indexOf("(")-1).trim();if((void 0==i||""==i)&&(i=s),i=i.toLowerCase(),t=t.toLowerCase(),i.substring(0,t.length)==t)return e;var a=ZDUtils.getLastNameOfContact(i);if(a=a.toLowerCase(),a.substring(0,t.length)==t)return e;var o=s.substring(s.indexOf("(")+1,s.length);return o=o.toLowerCase(),void 0==o||""==o?"":o.substring(0,t.length)==t?e:void 0},ZDUtils.getLastNameOfContact=function(e){var t=e.substring(e.lastIndexOf(" ")+1,e.length);return t},ZDUtils.validateResource=function(e,t,s){temp=document.domain.split("."),temp[0]="teamdrive",url="";for(var i=0;i<temp.length;i++)url+=temp[i],i!=temp.length-1&&(url+=".");var a="https://"+url+"/docs/getproductinfo.do?rid="+s;ZD.ajax({url:a,type:"GET",dataType:"html",success:function(i){ZDUtils.getCustomerRelatedDetails(e,t,s,i)}})},ZDUtils.getUserDetails=function(e,t,s){ZDUtils.validateResource(e,t,s)},ZDUtils.getUserRelatedDetails=function(e,t,s){if(s)ZDUtils.validateResource(e,t,s);else{var i='{"isTeamResource":false}';ZDUtils.getCustomerRelatedDetails(e,t,s,i)}},ZDUtils.getCustomerRelatedDetails=function(e,t,s,i){var a=ZD.parseJSON(i),o="";if(a.isTeamResource)return window.ZD_IS_NEW_UI_ENABLED=!0,void(window.tdURL=a.pcUrl);if(o="/docs/zduserdetails.do",""!=t&&void 0!=t){var n=t.charAt(t.length-1);"/"!=n&&(t+="/"),o=t+"docs/zduserdetails.do"}var d="_t="+ZD.now()+(G_COMP_OBJ.isReqFromDocs?"&service=docs":"");void 0!==s&&(d=d+"&resourceId="+s),ZD.ajax({url:o,type:"GET",data:d,dataType:"html",success:function(s){if(ZD("body").append(ZD(s).filter("#zd_user_details")[0]),ZD("body").append(ZD(s).filter("#zd_i18ndetails")[0]),zd_js_obj=JSON.parse(ZD("#zd_i18ndetails").attr("zd_js_obj")),ZD("body").append(ZD(s).filter("#zd_component_variables")[0]),window.ZUID=ZD("#zd_component_variables").attr("zuid"),window.zd_isorguser="true"==ZD("#zd_component_variables").attr("zd_isorguser")?!0:!1,window.orgnameofcurrentuser=ZD("#zd_component_variables").attr("orgnameofcurrentuser"),window.orgLabel=zd_js_obj.label_everyone_org,orgnameofcurrentuser.length){var i=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var i=orgnameofcurrentuser.substring(0,40);orgLabel=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(i))}if(window.userFullName=ZD("#zd_component_variables").attr("userFullName"),window.PC_USER_PLAN_TYPE=parseInt(ZD("#zd_component_variables").attr("PC_USER_PLAN_TYPE")),window.zd_third_party=ZD("#zd_component_variables").attr("zd_third_party"),window.ZOHO_CN=ZD("#zd_component_variables").attr("ZOHO_CN"),window.docsCSRFParamNAME=ZD("#zd_component_variables").attr("docsCSRFParamNAME"),window.docsCSRFCookieName=ZD("#zd_component_variables").attr("docsCSRFCookieName"),window.isCommentEnabled="true"==ZD("#zd_component_variables").attr("isCommentEnabled")?!0:!1,window.serviceUrl=ZD("#zd_component_variables").attr("serviceUrl"),window.pcUrl=ZD("#zd_component_variables").attr("pcUrl"),window.zd_serviceName=ZD("#zd_component_variables").attr("zd_serviceName"),window.zd_udservicekey=ZD("#zd_component_variables").attr("zd_udservicekey"),window.zd_udserverurl=ZD("#zd_component_variables").attr("zd_udserverurl"),window.userCanShareExternally=ZD("#zd_component_variables").attr("userCanShareExternally"),window.IAM_URL=ZD("#zd_component_variables").attr("IAM_URL"),window.currentBrowserDetails=ZD("#zd_component_variables").attr("currentBrowserDetails"),window.isCommonErrorPageEnabled="true"==ZD("#zd_component_variables").attr("isCommonErrorPageEnabled")?!0:!1,window.ZD_GUEST_EDIT_SHEET="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHEET")?!0:!1,window.ZD_GUEST_EDIT_SHOW="true"==ZD("#zd_component_variables").attr("ZD_GUEST_EDIT_SHOW")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHEET="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHEET")?!0:!1,window.ZD_COMMENT_ENABLEDFOR_SHOW="true"==ZD("#zd_component_variables").attr("ZD_COMMENT_ENABLEDFOR_SHOW")?!0:!1,window.ZD_SHARENOTE_GOTIT_ORGSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_ORGSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_LINKSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_LINKSHARE")?!0:!1,window.ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE="true"==ZD("#zd_component_variables").attr("ZD_SHARENOTE_GOTIT_SECUREEMAILSHARE")?!0:!1,window.zdc_ContactsURL=ZD("#zd_component_variables").attr("zdc_ContactsURL"),window.css_lable=ZD("#zd_component_variables").attr("css_lable"),window.compStaticServer=ZD("#zd_component_variables").attr("compStaticServer"),window.staticVersionToLoad=ZD("#zd_component_variables").attr("staticVersionToLoad"),window.READ_CMT_ENABLED_SERVICES="zw",window.ZD_IS_NEW_UI_ENABLED=ZD("#zd_component_variables").attr("ZD_IS_NEW_UI_ENABLED"),ZD_COMMENT_ENABLEDFOR_SHEET&&(READ_CMT_ENABLED_SERVICES+="|zohosheet"),ZD_COMMENT_ENABLEDFOR_SHOW&&(READ_CMT_ENABLED_SERVICES+="|zohoshow"),window.ZDOCScsrfToken=ZD("#zd_component_variables").attr("ZDOCScsrfToken"),serviceUrl=window.location.origin,window.zdcsrfPair=window.docsCSRFParamNAME+"="+window.ZDOCScsrfToken,isCommonErrorPageEnabled&&("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&!currentBrowserDetails.IS_SUPPORTED_BROWSER){var a=ZD("#browser-error-msg").html();if(null!=a)if(ZD(document).znotifier)ZD(document).znotifier({type:"warning",iconclass:"ui-components-icon ui-state-warning-icon",position:"north",content:a,autohide:!1});else{var o='<div id="browserErrorMsg" style="width: auto; text-align: center; margin: 0 auto; -webkit-border-bottom-right-radius: 7px; -webkit-border-bottom-left-radius: 7px; -moz-border-radius-bottomright: 7px; -moz-border-radius-bottomleft: 7px; border-bottom-right-radius: 7px; border-bottom-left-radius: 7px; -moz-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; -webkit-box-shadow: 0px 0px 4px #d8d8d8; box-shadow: 0px 0px 4px #d8d8d8; position: fixed; top: 0; z-index: 9999; left: 40%; margin-left: -25%; background: #fff; border-color: #d1d6ed; color: #000; padding: 10px; font-size: 12px; border-left: 1px solid #d1d6ed; border-right: 1px solid #d1d6ed; overflow: hidden; text-align: center; border-bottom-right-radius: 7px;">'+a+'<span style="padding-left: 5px; padding-right: 5px;">|</span><a href="javascript:void(0)" style="cursor: pointer; text-decoration: underline;" onclick="ZD(\'#browserErrorMsg\').hide();">'+zd_js_obj.label_close+"</a></div>";ZD("body").append(o)}}"undefined"==typeof ZD_G_ContactSearchEnabled&&(window.ZD_G_ContactSearchEnabled=!0),ZDUtils.getPlanType("",t),void 0!=e&&""!=e&&"function"==typeof e&&e()}})},ZDUtils.triggerUploadList=function(e){var t=ZD("#zd_user_details").attr("serviceName"),s=e.files,i=s[0].fileName,a=s[0].fileSize,o=0;(""==i||void 0==i)&&(i=s[0].name),(""==a||void 0==a)&&(a=s[0].size);var n=i.split(".")[i.split(".").length-1],o=0;if(a>SIZE_CALC_WITH_BYTES*SIZE_CALC_WITH_BYTES)return alert("Upload files greater than 10MB"),ZDDialog.closePopUp("uploadConfirmDiv"),!1;if("WRITER"==t){if("doc"!=n.toLowerCase()&&"docx"!=n.toLowerCase()&&"odt"!=n.toLowerCase()&&"rtf"!=n.toLowerCase())return alert("Only this files doc,docx,odt,rtf are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}else if("SHEET"==t){if("xls"!=n.toLowerCase()&&"xlsx"!=n.toLowerCase()&&"sxc"!=n.toLowerCase()&&"ods"!=n.toLowerCase()&&"csv"!=n.toLowerCase()&&"tsv"!=n.toLowerCase())return alert("Only this files xls,xlsx,sxc,ods,csv,tsv are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}else if("SHOW"==t){if("pptx"!=n.toLowerCase()&&"ppsx"!=n.toLowerCase()&&"ppt"!=n.toLowerCase()&&"pps"!=n.toLowerCase()&&"odp"!=n.toLowerCase()&&"sxi"!=n.toLowerCase())return alert("Only this files pptx,ppsx,ppt,pps,odp,sxi are allowed"),ZDDialog.closePopUp("uploadConfirmDiv"),o-=1,!1;ZDUtils.uploadProgress(e)}},ZDUtils.uploadProgress=function(e){var t=ZDUtils.updateFileNameSelected(e),s=ZD("#uploadfilediv"),i="target"+(new Date).getTime(),a=(ZDUtils.createIframe(i),ZDUtils.createForm(t,i)),o=(ZD(e).parent(),ZD(e).clone());ZD(o).unbind(),a.append(e),s.append(a)},ZDUtils.updateFileNameSelected=function(e){var t=ZD(e).attr("value"),s=ZDUtils.getFileName(t);-1!=s.toLowerCase().indexOf(".zip")&&(s=s.substring(0,s.length-4)+".zip");var i=(new Date).getTime();return ZDUtils.showFileList(s,i,!1,!1),i},ZDUtils.showFileList=function(e){return ZD(".fileinfo").text("Selected File"),ZD("#upload_detailview").text(e),ZD(".file_size_info").addClass("hidediv"),!1},ZDUtils.createIframe=function(e){var t=ZD('<iframe  name="'+e+'">').attr({height:"0",width:"0",id:e}).css("display","none");return ZD(t).appendTo("body"),t},ZDUtils.createForm=function(e,t){var s=ZD("<form></form>");return s.attr({id:"form-"+e,target:t,name:"form-"+e,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),s.css({margin:0,display:"none"}),s},ZDUtils.getFileName=function(e){var t,s=e;t=s.lastIndexOf(isWin||chrome7||isSafari?"\\":"/");var i=s.substring(t+1);return i},ZDUtils.deSelectDocs=function(){var e=ZD("div.selecteddoc");e.each(function(){ZD(this).closest("div.dataDiv").removeClass("select"),ZD(this).attr("class","unselecteddoc"),ZD(this).children().attr("class","normalcheckboxicon_css")}),ZD("#selectAllCheckBox").hasClass("selectcheckboxicon_css")&&ZD("#selectAllCheckBox").attr({"class":"normalcheckboxicon_css",name:"allDocsUnSelected"})},ZDUtils.deSelectDoc=function(e){ZD("div[id="+e+"]").removeClass("select").find("div.selecteddoc").attr("class","unselecteddoc").children().attr("class","normalcheckboxicon_css")},ZDUtils.replaceParams=function(e,t){if("undefined"!=t&&t.length>0)for(i=0;i<t.length;i++)e=ZDUtils.replace(e,"{"+i+"}",t[i]);return e},ZDUtils.replace=function(e,t,s){var i=e.length,a=t.length;if(0===i||0===a)return e;var o=e.indexOf(t);if(!o&&t!=e.substring(0,a))return e;if(-1==o)return e;var n=e.substring(0,o)+s;return i>o+a&&(n+=ZDUtils.replace(e.substring(o+a,i),t,s)),n},ZDUtils.statusmsg=function(e,t,s){ZD("#docs_statusmsg_div").length&&ZD("#docs_statusmsg_div").remove();var i='<div style="width:100%;position:absolute;padding-top:5px;" id="docs_statusmsg_div"><div align="center"><span id="statusmsgdiv" class=""></span></div></div>';ZD("#"+s).prepend(i),ZD("span#statusmsgdiv").attr("class",e).html(t).parent().css("display","block"),setTimeout(function(){ZD("#docs_statusmsg_div").remove()},4e3)},ZDUtils.getMyContacts=function(e,t){var s;s="method=getContacts&_t="+ZD.now()+"&"+zdcsrfPair;var i=serviceUrl+"/docs/docsrequest.do";void 0!=t&&""!=t&&(i=t+"docs/docsrequest.do"),ZD.ajax({url:i,data:s,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDUtils.getPersonalContacts=function(e){var t;t="method=getPersonalContacts&_t="+ZD.now()+"&"+zdcsrfPair;var s=serviceUrl+"/docs/docsrequest.do";void 0!=e&&""!=e&&(s=e+"docs/docsrequest.do"),ZD.ajax({url:s,data:t,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDUtils.getPlanType=function(e,t){var s="undefined"==typeof e||""===e?!0:e;if(void 0!=t&&""!=t)var i=t+"docs/docsrequest.do?method=getPlanType";else var i=serviceUrl+"/docs/docsrequest.do?method=getPlanType";return ZD.ajax({async:s,url:i,dataType:"json",type:"GET",success:function(e){zdcomp_userType=e.response.result.PlanType.MESSAGE,("WRITER"==zd_serviceName||"SHEET"==zd_serviceName||"SHOW"==zd_serviceName||"DOCS"==zd_serviceName)&&("FREE_PLAN_TYPE"!=zdcomp_userType&&""!=zdcomp_userType&&void 0!=zdcomp_userType&&"undefined"!=typeof zdcomp_userType?"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getMyContacts("",t):"undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled||ZDUtils.getPersonalContacts(t))},error:function(){zdcomp_userType=""}}),!1},ZDUtils.getSelectedDocuments=function(){var e="";"explorer"===G_SwitchTab?e="#explorergrid":"workspace"===G_SwitchTab?e="#wsdocsgrid":"group"===G_SwitchTab?e="#showgroupdocspace":"tag"===G_SwitchTab?e="#taggrid":"search"===G_SwitchTab&&(e="#searchgrid");var t=ZD("div.selectcheckboxicon_css",e);return t},ZDUtils.getOwnedSelectedDocs=function(){var e=ZDUtils.getSelectedDocuments(),t=[];return e.each(function(e){var s={},i=ZD(this).closest("div.dataDiv"),a=ZD(this).closest("div.folderDiv"),o=i.data("scope");if(0===o){var n=i.attr("id"),d=i.data("permission"),r=i.data("fileName"),l=i.data("encFileName"),c=i.data("encAttrFileName"),_=i.data("encUrlFileName"),p=i.data("serviceType"),u=i.data("fileType"),m=i.data("fileExt"),v=i.data("authorId"),D=i.data("classIconName"),h=i.data("encSharedDocId"),f=i.data("is_doc_author"),g=i.data("parentId"),O=i.attr("fileId");authorName=i.data("authorName"),isLocked=i.data("isLocked"),lockedBy=i.data("lockedBy"),s.isFolder=a.length?!0:!1,s.isDocAuthor=f,s.authorId=v,s.encSharedDocId=h,s.docId=n,s.scope=o,s.permission=d,s.fileId=O,s.file_name=r,s.encFile_name=l,s.encAttrFile_name=c,s.encUrlFile_name=_,s.service=p,s.filetype=u,s.fileext=m,s.classname=D,s.authorName=authorName,s.parentId=g,s.isLocked=isLocked,s.lockedBy=lockedBy,t[e]=s,parseInt(s.scope)>0&&(sharedDocExist=!0)}else 1===o&&(i.removeClass("select"),ZD(this).attr("class","normalcheckboxicon_css"))}),t},ZDUtils.getSelectedDocumentIds=function(){var e=ZDUtils.getOwnedSelectedDocs();if(!e.length)return alert("Document Visibility can be set for owned documents only."),!1;for(var t="",s=0;s<e.length;s++)t+=e[s].docId+",";return t},ZDUtils.insertDynamicButton=function(e,t,s,i,a){var o='<button style="margin-right:5px;"   class="ui-button ui-widget ui-state-default ui-corner-all  zd_dynamicbutton"><span class="ui-button-text">'+e+"</span></button>";if(ZD("#"+s+" button:nth-child("+t+")").remove(),1==t?ZD("#"+s).prepend(o):ZD("#"+s).append(o),i){var n='<span class="ui-button-icon-primary ui-icon ui-icon-loader"></span>';ZD(".zd_dynamicbutton").addClass("ui-button-disabled ui-state-disabled ui-status-icon ui-button-text-icon-primary").prepend(n)}else ZD(".zd_dynamicbutton").addClass("ui-button-text-only");""!=a&&void 0!=a&&ZD(".zd_dynamicbutton").unbind().bind("click",function(){return a(),!1})},ZDUtils.loadComponentsStaticFiles=function(e,t,s){var i=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/),a=(i?parseInt(i[1]):void 0,function(e,t){var s=document.getElementsByTagName("head")[0];if(!jQuery("#css_linkdocscomponents").length){var i=document.createElement("link");i.href=e,i.rel="stylesheet",i.type="text/css",i.id="css_linkdocscomponents",s.appendChild(i)}if(!jQuery("#js_linkdocscomponents").length){var a=document.createElement("script");a.src=t,a.type="text/javascript",a.id="js_linkdocscomponents",s.appendChild(a)}}),o=e+"/docs/docsrequest.do?method=loadComponentsStaticFiles",n="service="+t.toUpperCase()+"&_t="+(new Date).getTime();jQuery.ajax({url:o,type:"GET",dataType:"json",data:n,xhrFields:{withCredentials:!0},success:function(e){if("undefined"==typeof s){var t=e.cssfilepath,i=e.jsfilepath;a(t,i)}else s(e)}})},ZDUtils.loadZDCStaticFilesForEditors=function(e,t,s,i){var a=location.protocol+"//"+location.hostname+"/docs/docsrequest.do?method=loadComponentsStaticFiles",o="service="+e+"&_t="+(new Date).getTime();void 0!==t&&(o+="&jsfilename="+t),void 0!==s&&(o+="&cssfileName="+s),jQuery.ajax({url:a,type:"GET",dataType:"json",data:o,success:function(e){var t=e.cssfilepath,s=e.jsfilepath,a=(e.staticversiontoload,e.jsfilename),o=e.cssfilename;if("undefined"!=typeof i)i(e);else{var n=function(e,t){var s=document.getElementsByTagName("head")[0];if(!jQuery("#"+o).length){var i=document.createElement("link");i.href=e,i.rel="stylesheet",i.type="text/css",i.id=o,s.appendChild(i)}if(!jQuery("#"+a).length){var n=document.createElement("script");n.src=t,n.type="text/javascript",n.id=a,s.appendChild(n)}};n(t,s)}}})},ZDUtils.matchFullNameForCommentMentions=function(e,t){var s=e.name;return s=s.toLowerCase(),t=t.toLowerCase(),s.substring(0,t.length)===t?e:""},"undefined"==typeof READ_CMT_ENABLED_SERVICES&&(READ_CMT_ENABLED_SERVICES="zw"),ZDMenu.initMenu=function(e){("left"==e||"both"==e)&&(ZD("#zd_leftmenu").zmenu().bind("zmenubeforeshow menubeforeshow",function(e,t){var s=ZDMenu.createLeftMenu(e,t);return s}),ZD("#zd_leftmenu").bind("zmenuitemclick menuitemclicked",function(e,t){return ZDMenu.leftMenuItemActions(e,t),!0}))},ZDMenu.showOpenFileDialogActionMenuOption=function(){var e=[];e=ZD("#trashservicedocs").hasClass("selectedView")?[G_OF_OBJ.restore_openfile,G_OF_OBJ.delete_openfile]:ZD("#templates").hasClass("selectedView")?[G_OF_OBJ.delete_openfile]:[G_OF_OBJ.rename_openfile,G_OF_OBJ.trash_openfile],ZDMenu.addMenuItemList(e,"#zd_leftmenu")},ZDMenu.createLeftMenu=function(e,t){var s=ZD(t.target),i=ZD(t.target).attr("id"),a=ZD(t.target).attr("class");if("actionMenuOpenFile"==i){for(var o=FILEDIALOG.getSelectedDocsForOpenFileDialog(),n=o.length,d="",r="",l="",c=0,_=o.length;_>c;c++)d=o[c].docId,r=o[c].isDocumentSharedToMe,l=o[c].isTemplates,"true"==r&&(ZD("#"+d).children("table").removeClass("select"),ZD("#"+d).find("td.checkboxtd").children().toggleClass("normalcheckboxicon_css selectcheckboxicon_css"),n-=1);return 0==n?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.select_the_documents),!1):(ZDMenu.showOpenFileDialogActionMenuOption(),!0)}return"zd_permission_oneshot"==i||"zdperm_visibility"==i?void ZDMenu.showUserPrevilages(s):"sharedocs_listing"==a?void ZDMenu.showShareDetailsMenu(s):void 0},ZDMenu.showVisibilityPermissionOptions=function(){},ZDMenu.addMenuItemList=function(e,t){var s=ZD(t).zmenu("getItemCount");return s>0&&(ZD(t).zmenu("removeAllMenuItems"),s=0),0===s&&ZD(t).zmenu("addMenuItems",e),!1},ZDMenu.leftMenuItemActions=function(e,t){var s,i=t.menuitem.attr("id"),a=(t.menuitem.attr("name"),t.target),o=a.attr("shareType");if("user"==o?s="selectedContactDivs":("group"==o||"org"==o)&&(s="selectedGroupDivs"),"rename_openfile"==i)FILEDIALOG.renameFile();else if("trash_openfile"==i||"delete_openfile"==i)FILEDIALOG.trashFile();else if("restore_openfile"==i)FILEDIALOG.restoreFile();else if("zd_viewer_perm"==i)a.attr("permission","1"),a.find(".ui-zcombo-select-item").children("span:last").text(zd_js_obj.read_only);else if("zd_collaborator_perm"==i)a.attr("permission","2"),a.find(".ui-zcombo-select-item").children("span:last").text(zd_js_obj.read_write);else if("zd_coowner_perm"==i)a.attr("permission","3"),a.find(".ui-zcombo-select-item").children("span:last").text(zd_js_obj.coowner);else if("zd_comment_perm"==i)a.attr("permission","4"),a.find(".ui-zcombo-select-item").children("span:last").text(zd_js_obj.label_read_comment);else if("zd_readfill_perm"==i)a.attr("permission","8"),a.find(".ui-zcombo-select-item").children("span:last").text(zd_js_obj.label_read_fill);else if("viewer_details"==i){if("user"==o){ZD(t.target).closest(".selectedContactDivs").attr("permission","1"),G_OF_OBJ.trimmedEmails=encodeURIComponent(ZD(t.target).closest(".selectedContactDivs").attr("email"))+",";var n=G_OF_OBJ.trimmedEmails.split(",")[0];("undefined"==n||""==n||void 0==n)&&(G_OF_OBJ.trimmedEmails=ZD(t.target).closest(".selectedContactDivs").attr("sharedTo")+","),ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","1"),ZD(t.target).children("span").text(zd_js_obj.read_only)}("group"==o||"org"==o)&&(ZD(t.target).closest(".selectedGroupDivs").attr("permission","1"),"org"==o?G_OF_OBJ.trimmedOrgGroupIds=ZD(t.target).closest(".selectedGroupDivs").attr("groupId")+",":G_OF_OBJ.trimmedPerGroupIds=ZD(t.target).closest(".selectedGroupDivs").attr("groupId")+",",ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","1"),ZD(t.target).children("span").text(zd_js_obj.read_only))}else if("collaborator_details"==i){if("user"==o){ZD(t.target).closest(".selectedContactDivs").attr("permission","2"),G_OF_OBJ.trimmedEmails=encodeURIComponent(ZD(t.target).closest(".selectedContactDivs").attr("email"))+",";var n=G_OF_OBJ.trimmedEmails.split(",")[0];("undefined"==n||""==n||void 0==n)&&(G_OF_OBJ.trimmedEmails=ZD(t.target).closest(".selectedContactDivs").attr("sharedTo")+","),ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","2"),ZD(t.target).children("span").text(zd_js_obj.read_write)}("group"==o||"org"==o)&&(ZD(t.target).closest(".selectedGroupDivs").attr("permission","2"),"org"==o?G_OF_OBJ.trimmedOrgGroupIds=ZD(t.target).closest(".selectedGroupDivs").attr("groupId")+",":G_OF_OBJ.trimmedPerGroupIds=ZD(t.target).closest(".selectedGroupDivs").attr("groupId")+",",ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","2"),ZD(t.target).children("span").text(zd_js_obj.read_write))}else if("coowner_details"==i){G_OF_OBJ.trimmedEmails=encodeURIComponent(ZD(t.target).closest(".selectedContactDivs").attr("email"))+",";var n=G_OF_OBJ.trimmedEmails.split(",")[0];("undefined"==n||""==n||void 0==n)&&(G_OF_OBJ.trimmedEmails=ZD(t.target).closest(".selectedContactDivs").attr("sharedTo")+","),ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","3","",t.target)}else if("comment_details"==i){if("group"==o||"org"==o)ZD(t.target).closest(".selectedGroupDivs").attr("permission","4"),"org"==o?G_OF_OBJ.trimmedOrgGroupIds=ZD(t.target).closest(".selectedGroupDivs").attr("groupId")+",":G_OF_OBJ.trimmedPerGroupIds=ZD(t.target).closest(".selectedGroupDivs").attr("groupId")+",",ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","4"),ZD(t.target).children("span").text(zd_js_obj.label_read_comment);else if("user"==o){G_OF_OBJ.trimmedEmails=encodeURIComponent(ZD(t.target).closest(".selectedContactDivs").attr("email"))+",";var n=G_OF_OBJ.trimmedEmails.split(",")[0];("undefined"==n||""==n||void 0==n)&&(G_OF_OBJ.trimmedEmails=ZD(t.target).closest(".selectedContactDivs").attr("sharedTo")+","),ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","4","",t.target),ZD(t.target).children("span").text(zd_js_obj.label_read_comment)}}else if("readfill_details"==i){G_OF_OBJ.trimmedEmails=encodeURIComponent(ZD(t.target).closest(".selectedContactDivs").attr("email"))+",";var n=G_OF_OBJ.trimmedEmails.split(",")[0];("undefined"==n||""==n||void 0==n)&&(G_OF_OBJ.trimmedEmails=ZD(t.target).closest(".selectedContactDivs").attr("sharedTo")+","),ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!1,"","8","",t.target),ZD(t.target).children("span").text(zd_js_obj.label_read_fill)}return!1},ZDMenu.createContextMenu=function(){var e=[G_OF_OBJ.createFolder,G_OF_OBJ.renameFolder,G_OF_OBJ.deleteFolder];return ZDMenu.addMenuItemList(e,"#zd_rightmenu"),!0},ZDMenu.contextMenuItemActions=function(e,t){var s=t.menuitem.attr("id"),i=(e.type,t.target),a=i.attr("folderId");return"createfolder"==s?(FILEDIALOG.createNewFolder(i,[e.pageX,e.pageY-10]),!1):"renamefolder"==s?(FILEDIALOG.renameFolder(i),!1):"deletefolder"==s?(FILEDIALOG.deleteFolder(i,a),!1):!1},ZDMenu.showShareDetailsMenu=function(e){var t=ZD(e).attr("shareType"),s=[];if(void 0===G_COMP_OBJ.serviceview&&(G_COMP_OBJ.serviceview=""),G_OF_OBJ.isFolderShare){var i=ZD(e).closest(".selectedContactDivs").attr("permission");s=0==G_OF_OBJ.isCo_owner?[G_OF_OBJ.viewer_details,G_OF_OBJ.collaborator_details,G_OF_OBJ.coowner_details]:[G_OF_OBJ.viewer_details,G_OF_OBJ.collaborator_details],ZDMenu.addMenuItemList(s,"#zd_leftmenu"),1==i?(ZD("#viewer_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#viewer_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):2==i?(ZD("#collaborator_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#collaborator_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):3==i&&(ZD("#coowner_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#coowner_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon"))}else if("user"==t){var i=ZD(e).closest(".selectedContactDivs").attr("permission");0==G_OF_OBJ.isCo_owner?(s="zw"===G_OF_OBJ.urlInvoker||"zw"===G_COMP_OBJ.serviceType||"zw"===G_COMP_OBJ.serviceview?[G_OF_OBJ.viewer_details,G_OF_OBJ.comment_details,G_OF_OBJ.collaborator_details,G_OF_OBJ.coowner_details,G_OF_OBJ.readfill_details]:(G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES))&&1==isCommentEnabled?[G_OF_OBJ.viewer_details,G_OF_OBJ.comment_details,G_OF_OBJ.collaborator_details,G_OF_OBJ.coowner_details]:[G_OF_OBJ.viewer_details,G_OF_OBJ.collaborator_details,G_OF_OBJ.coowner_details],"crm"===G_OF_OBJ.urlInvoker&&(s=[G_OF_OBJ.viewer_details,G_OF_OBJ.collaborator_details])):s="zw"===G_OF_OBJ.urlInvoker||"zw"===G_COMP_OBJ.serviceType||"zw"===G_COMP_OBJ.serviceview?[G_OF_OBJ.viewer_details,G_OF_OBJ.comment_details,G_OF_OBJ.collaborator_details,G_OF_OBJ.readfill_details]:(G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES))&&1==isCommentEnabled?[G_OF_OBJ.viewer_details,G_OF_OBJ.comment_details,G_OF_OBJ.collaborator_details]:[G_OF_OBJ.viewer_details,G_OF_OBJ.collaborator_details],ZDMenu.addMenuItemList(s,"#zd_leftmenu"),1==i?(ZD("#viewer_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#viewer_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):2==i?(ZD("#collaborator_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#collaborator_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):3==i?(ZD("#coowner_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#coowner_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):4==i?(ZD("#comment_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#comment_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):8==i&&(ZD("#readfill_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#readfill_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon"))}else if("group"==t||"org"==t){var i=ZD(e).closest(".selectedGroupDivs").attr("permission");s=[G_OF_OBJ.viewer_details,G_OF_OBJ.collaborator_details],(G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES))&&1==isCommentEnabled&&(s=[G_OF_OBJ.viewer_details,G_OF_OBJ.comment_details,G_OF_OBJ.collaborator_details]),ZDMenu.addMenuItemList(s,"#zd_leftmenu"),1==i?(ZD("#viewer_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#viewer_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):2==i?(ZD("#collaborator_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#collaborator_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):4==i&&(ZD("#comment_details").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#comment_details").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon"))}ZD("#zd_leftmenu").addClass("customclassforpermission")},ZDMenu.showUserPrevilages=function(e){void 0===G_COMP_OBJ.serviceview&&(G_COMP_OBJ.serviceview="");var t=[];if(ZD(e).closest("#zdperm_visibility").length){t=[G_OF_OBJ.viewer,G_OF_OBJ.collaborator];var s="zd_pwddoc_visible"===ZD("#zdperm_visibility").closest("li").attr("id")?!0:!1;(G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES))&&1==isCommentEnabled&&(t=!s||"zohosheet"!==G_OF_OBJ.urlInvoker&&"zohosheet"!==G_COMP_OBJ.serviceType&&"zohosheet"!==G_COMP_OBJ.serviceview?"zw"===G_OF_OBJ.urlInvoker||"zw"===G_COMP_OBJ.serviceType||"zw"===G_COMP_OBJ.serviceview?[G_OF_OBJ.viewer,G_OF_OBJ.comment_only,G_OF_OBJ.collaborator,G_OF_OBJ.readfill]:[G_OF_OBJ.viewer,G_OF_OBJ.comment_only,G_OF_OBJ.collaborator]:[G_OF_OBJ.viewer,G_OF_OBJ.collaborator])}else t=G_OF_OBJ.isFolderShare?0==G_OF_OBJ.isCo_owner?[G_OF_OBJ.viewer,G_OF_OBJ.collaborator,G_OF_OBJ.coowner]:[G_OF_OBJ.viewer,G_OF_OBJ.collaborator]:0==G_OF_OBJ.isCo_owner?"zw"===G_OF_OBJ.urlInvoker||"zw"===G_COMP_OBJ.serviceType||"zw"===G_COMP_OBJ.serviceview?[G_OF_OBJ.viewer,G_OF_OBJ.comment_only,G_OF_OBJ.collaborator,G_OF_OBJ.coowner,G_OF_OBJ.readfill]:!G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)&&!G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES)||1!=isCommentEnabled||G_COMP_OBJ.isMultiShare?[G_OF_OBJ.viewer,G_OF_OBJ.collaborator,G_OF_OBJ.coowner]:[G_OF_OBJ.viewer,G_OF_OBJ.comment_only,G_OF_OBJ.collaborator,G_OF_OBJ.coowner]:"zw"===G_OF_OBJ.urlInvoker||"zw"===G_COMP_OBJ.serviceType||"zw"===G_COMP_OBJ.serviceview?[G_OF_OBJ.viewer,G_OF_OBJ.comment_only,G_OF_OBJ.collaborator,G_OF_OBJ.readfill]:(G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES))&&1==isCommentEnabled?[G_OF_OBJ.viewer,G_OF_OBJ.comment_only,G_OF_OBJ.collaborator]:[G_OF_OBJ.viewer,G_OF_OBJ.collaborator];"crm"===G_OF_OBJ.urlInvoker&&(t=[G_OF_OBJ.viewer,G_OF_OBJ.collaborator]),ZDMenu.addMenuItemList(t,"#zd_leftmenu");var i=ZD(e).attr("permission");"1"==i?(ZD("#zd_viewer_perm").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#zd_viewer_perm").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):"2"==i?(ZD("#zd_collaborator_perm").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#zd_collaborator_perm").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):"3"==i?(ZD("#zd_coowner_perm").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#zd_coowner_perm").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):"4"==i?(ZD("#zd_comment_perm").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#zd_comment_perm").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")):"8"==i&&(ZD("#zd_readfill_perm").find(".ui-zmenu-icon-inner").addClass("zdc-tickmark"),ZD("#zd_readfill_perm").siblings("li").find(".ui-zmenu-icon-inner").removeClass("ui-icon").addClass("ui-blankicon")),ZD("#zd_leftmenu").addClass("customclassforpermission")},G_COMP_CONSTANTS=function(){this.isReqFromDocs=!1,this.serviceType=""};var G_COMP_OBJ=new G_COMP_CONSTANTS,zd_isIE="";!function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);zd_isIE=e?parseInt(e[1]):void 0}();var G_OF_OBJ,G_FormDataArray=[],G_FileDataArray=[],G_UploadIndexCounter=0,docs_myContacts=[],user_emailContacts=[],ZD=jQuery,zd_js_obj="",zdcsrfPair,isWin=-1!=navigator.appVersion.indexOf("Win")?!0:!1,isSafari=navigator.userAgent.toLowerCase().indexOf("safari")>-1,userAgent=navigator.userAgent.toLowerCase(),us=userAgent.substring(userAgent.indexOf("chrome/")+7),chrome7=parseInt(us.substring(us,us.indexOf(".")))>=7?!0:!1,zdcomp_userType,ZD_G_CurrentVisibility="private",public_PwdExpiryDate="";FILEDIALOG.initMenu=function(e){("left"==e||"both"==e)&&(ZD("#zd_leftmenu").zmenu().bind("zmenubeforeshow menubeforeshow",function(e,t){var s=ZDMenu.createLeftMenu(e,t);return s}),ZD("#zd_leftmenu").bind("zmenuitemclick menuitemclicked",function(e,t){return ZDMenu.leftMenuItemActions(e,t),!0})),("right"==e||"both"==e)&&(ZD("#zd_rightmenu").zmenu().live("menubeforeshow",function(e,t){var s=ZDMenu.createContextMenu(e,t);return s}),ZD("#zd_rightmenu").live("menuitemclicked",function(e,t){return ZDMenu.contextMenuItemActions(e,t),!0}))},FILEDIALOG.getSelectedDocsForOpenFileDialog=function(){var e=ZD("div#openFileDataDiv table.select"),t=[];return e.each(function(e){var s={},i=ZD(this).closest("div"),a=i.attr("id"),o=i.data("fileId"),n=i.data("service"),d=i.data("docName"),r=i.data("cssName"),l=i.data("isDocumentSharedToMe"),c=i.data("isTemplates"),_=i.data("encryptedId");s.docId=a,s.fileId=o,s.file_name=d,s.service=n,s.classname=r,s.isDocumentSharedToMe=l,s.encryptedId=_,s.isTemplates=c,t[e]=s}),t},FILEDIALOG.restoreFile=function(e){if(ZDUtils.openFileLoadingMsg(zd_js_obj.restoring),void 0!=e&&""!=e){var t="docs/docsrequest.do?method=restoreDocument",s="docId="+e+"&"+zdcsrfPair;ZD.ajax({url:t,type:"POST",data:s,success:function(){ZDUtils.hideOpenFileLoadingMsg(),ZD("#progressBar").css("display","none"),FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.restore_success_msg),FILEDIALOG.resetAll(),ZD("div#showopenservicefilespace").openfiledatagrid("populateDataPanel")}})}},FILEDIALOG.statusmsg=function(e,t){ZD("span#statusmsgdiv").attr("class",e).html(t).parent().css("display","block"),setTimeout(function(){ZD("span#statusmsgdiv").removeClass().html("").parent().css("display","none")},4e3)},FILEDIALOG.renameFile=function(){ZD("#attachopenfiledialogdiv").dialog({closeOnEscape:!1});var e=ZD("table.select","#openFileDataDiv").closest("div");if(e.length>1)return FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.label_only_one_document_to_be_renamed_at_a_time),void FILEDIALOG.clearSelectedFiles();{var t=e.data("docName"),s=e.attr("id"),i=e.find("a.activelink"),a=i.closest("td");i.children("span")}a.empty();var o=ZD("<input>",{value:t,id:"renameinputform",name:"renameoperation",keyup:function(t){var o=t.keyCode||t.which;return 13==o&&FILEDIALOG.validateRenameForm(e,i,a),27==o?(a.empty().append(i),FILEDIALOG.selectOrdeselectRow(s,e),void ZD("#attachopenfiledialogdiv").dialog({closeOnEscape:!0})):void 0},blur:function(){FILEDIALOG.validateRenameForm(e,i,a)}});return a.empty().append(o),ZD("input#renameinputform").focus(),!1},FILEDIALOG.reset=function(){G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.prevIndex="1",G_OF_OBJ.nextIndex="10",G_OF_OBJ.startFrom="0",G_OF_OBJ.templateObj={}},FILEDIALOG.showSelectedDocsToOpen=function(e,t){var s=ZD(e).closest("div.documentDataDiv"),i=s.attr("id"),a=!1;if(a=ZD("input#renameinputform").is(":visible"),"documentname"==t&&a)return!1;if("checkbox"==t||a)FILEDIALOG.selectOrdeselectRow(i,e);else if(G_OF_OBJ.callback){var o="userdocument";ZD("#templates").hasClass("selectedView")?o="templates":ZD("#sharedservicedocs").hasClass("selectedView")&&(o="shared"),ZD(".docsdialog .ui-dialog-titlebar-close").trigger("click"),FileOpen.openWriterDocument(o,i)}else ZD(".docsdialog .ui-dialog-titlebar-close").trigger("click");return!1},FILEDIALOG.selectOrdeselectRow=function(e,t){var s=ZD(t).closest(".documentDataDiv"),i=s.children("table.data-hover").hasClass("select");return i?(s.find("td.checkboxtd").children().removeClass("selectcheckboxicon_css").addClass("normalcheckboxicon_css"),s.children("table.data-hover").removeClass("select")):(s.find("td.checkboxtd").children().removeClass("normalcheckboxicon_css").addClass("selectcheckboxicon_css"),s.children("table.data-hover").addClass("select")),!1},FILEDIALOG.clearSelectedRows=function(){var e=ZD("#openFileDataDiv").find("div.documentDataDiv").children("table.select");ZD(e).each(function(e,t){ZD(t).removeClass("select"),ZD(t).find("td.checkboxtd").children().toggleClass("normalcheckboxicon_css selectcheckboxicon_css")})},FILEDIALOG.getSharedDocs=function(e,t,s,i){ZDUtils.openFileLoadingMsg(zd_js_obj.loading),G_OF_OBJ.selectedLeftPanel="shareddocs",null==e&&(e=0),null==t&&(t="time"),null==s&&(s="desc"),null==i&&(i=G_OF_OBJ.urlInvoker);var a=serviceUrl+"/docs/viewsearchresults.do?method=getSharedDocuments&start="+e+"&field="+t+"&action="+s+"&category="+i+"&_t="+ZD.now();ZD.ajax({url:a,type:"POST",datatype:"html",success:function(e){var t=ZD("#showopenservicefilespace").children();ZD(t).each(function(e,t){ZD(t).empty().remove()}),ZD("#showopenservicefilespace").html(e),ZDUtils.hideOpenFileLoadingMsg()}})},FILEDIALOG.searchFile=function(e){var e=ZD("#searchFileName").val();return ZD("#homebuttondiv").hide(),"*"===ZD.trim(e)||""===ZD.trim(e)?void ZDUtils.hideOpenFileLoadingMsg():(FILEDIALOG.changeAllToNormalView(),G_OF_OBJ.selectedLeftPanel="search",ZD("#actionMenuOpenFile").css("display","none"),void FILEDIALOG.getSearchResults(e,0))},FILEDIALOG.searchSorting=function(e,t){var s=ZD("#searchFileName").val();null==e&&(e="time"),null==t&&(t="desc"),FILEDIALOG.getSearchResults(s,0,e,t)},FILEDIALOG.getSearchResults=function(e,t,s,i){if(ZDUtils.openFileLoadingMsg(zd_js_obj.loading),null==t&&(t=0),null==s&&"relevance"!=G_OF_OBJ.searchType&&(s="time"),null==i&&(i="desc"),"time"===s?G_OF_OBJ.searchType="lastmodified":"author"===s&&(G_OF_OBJ.searchType="author"),"relevance"===G_OF_OBJ.searchType)var a=serviceUrl+"/docs/viewsearchresults.do?method=search&start="+t+"&action="+i+"&searchquery="+encodeURIComponent(e)+"&_t="+ZD.now()+"&category="+G_OF_OBJ.urlInvoker;else var a=serviceUrl+"/docs/viewsearchresults.do?method=search&start="+t+"&field="+s+"&action="+i+"&searchquery="+encodeURIComponent(e)+"&_t="+ZD.now()+"&category="+G_OF_OBJ.urlInvoker;ZD.ajax({url:a,datatype:"html",success:function(t){var s=ZD("#showopenservicefilespace").children();ZD(s).each(function(e,t){ZD(t).empty().remove()}),ZD("#showopenservicefilespace").html(t),ZD("#sort_button").parent().remove(),ZD("#servicefilepagination").find("tr").prepend('<td><button id="sort_button" style="float:left;display:block;" ><a href="javascript:;" title="Sort"><span class="flleft">Sort</span><em class="toolBarDownArrow flleft"></em></a></button><ul id="init_sort" style="list-style: none;display:none;padding: 5px 0;z-index: 9px;position: absolute;border: 1px solid #D5D5D5;border-style: hidden;box-shadow: 1px 1px 5px rgba(0,0,0,0.2);background: #fff;color: #000;width: 150px;"><ul class="" style="list-style: none;display: block; padding: 5px 0;"><li id="relevance_sort" style="white-space: nowrap;cursor: pointer;">  <span style="padding-left:20px;">Relevance</span></li><li id="lastmodified_sort" style="white-space: nowrap;margin-top:8px;cursor: pointer;" > <span style="padding-left:20px;">Last Modified </span></li><li id="author_sort" style="white-space: nowrap;margin-top:8px;cursor: pointer;" > <span style="padding-left:20px;">Author </span></li></ul></ul></td>');var i=ZD("#sort_button").height();ZD("#init_sort").css("margin-top",i+5),"relevance"===G_OF_OBJ.searchType?(ZD("#relevance_sort").addClass("zdc-tickmark"),ZD("#lastmodified_sort,#author_sort").removeClass("zdc-tickmark")):"lastmodified"===G_OF_OBJ.searchType?(ZD("#relevance_sort,#author_sort").removeClass("zdc-tickmark"),ZD("#lastmodified_sort").addClass("zdc-tickmark")):"author"===G_OF_OBJ.searchType&&(ZD("#relevance_sort,#lastmodified_sort").removeClass("zdc-tickmark"),ZD("#author_sort").addClass("zdc-tickmark")),ZDUtils.hideOpenFileLoadingMsg(),""===t&&(ZD("#servicefilepagination").hide(),ZD("#showopenservicefilespace").append('<div align="center" style="margin-top:40px;">'+zd_js_obj.no_results_found_for+' "'+encodeURIComponent(e)+'"</div>'))}})},FILEDIALOG.searchMouseOver=function(e,t,s,i){e!=t&&("asc"==i?ZD("#"+s).attr("class","UpArrow"):ZD("#"+s).attr("class","DownArrow"))},FILEDIALOG.searchMouseOut=function(e,t,s){e!=t&&ZD("#"+s).attr("class","")},FILEDIALOG.clearText=function(){"Searchfiles"==ZD("#searchFileName").value&&(ZD("#searchFileName").value="")},FILEDIALOG.getLeftPanelList=function(e,t){var s;""!==e&&void 0!==e?s=ZD(e).attr("id"):""!==t&&void 0!==t&&(s=t),ZD("#actionMenuOpenFile").css("display","block"),("desktopservicedocs"===s||"sharedservicedocs"===s)&&(G_OF_OBJ.folderId="folder"),""!==s&&void 0!==s&&(FILEDIALOG.changeAllToNormalView(s),G_OF_OBJ.selectedLeftPanel=s);ZD("#serviceDialogLeftPanel").find("td.selectedView").attr("id");ZD("#homebuttondiv").hide(),G_OF_OBJ.folderArray=[],FILEDIALOG.resetAll(),ZD("div#showopenservicefilespace").openfiledatagrid("populateDataPanel")},FILEDIALOG.getDocAsList=function(e,t){var s;""!=e&&void 0!=e?s=ZD(e).attr("id"):""!=t&&void 0!==t&&(s=t),ZD("#actionMenuOpenFile").css("display","block"),"desktopservicedocs"===s&&(G_OF_OBJ.folderId="folder"),""!=s&&void 0!=s&&(FILEDIALOG.changeAllToNormalView(s),G_OF_OBJ.selectedLeftPanel=s);ZD("#serviceDialogLeftPanel").find("td.selectedView").attr("id");ZD("#homebuttondiv").show(),FILEDIALOG.resetAll(),ZD("div#showopenservicefilespace").openfiledatagrid("populateDataPanel")},FILEDIALOG.resetAll=function(){FILEDIALOG.reset();var e=ZD("#showopenservicefilespace").children();ZD(e).each(function(e,t){ZD(t).empty().remove()}),ZD("#showopenservicefilespace").openfiledatagrid("resetOptions"),ZD("#servicefilepagination").css("display","none")},FILEDIALOG.changeAllToNormalView=function(e){ZD("#serviceDialogLeftPanel").find("td.selectedView").toggleClass("selectedView normalView"),""!=e&&void 0!=e&&ZD("#"+e).addClass("selectedView").removeClass("normalView")},FILEDIALOG.setSortOrder=function(e){var t=ZD(e).attr("id");G_OF_OBJ.nameSortArrow="",G_OF_OBJ.timeSortArrow="",G_OF_OBJ.nameSortArrow=ZD(e).children().attr("class"),G_OF_OBJ.timeSortArrow=ZD(e).children().attr("class"),"nameHeader"==t?(G_OF_OBJ.timeSortArrow="",G_OF_OBJ.timeSortOrder="",G_OF_OBJ.nameSortOrder=ZD(e).children().hasClass("DownArrow")||ZD(e).children().hasClass("DownArrowH")?"asc":"desc"):"dateModifiedHeader"==t&&(G_OF_OBJ.nameSortArrow="",G_OF_OBJ.nameSortOrder="",G_OF_OBJ.timeSortOrder=ZD(e).children().hasClass("DownArrow")?"asc":"desc")},FILEDIALOG.setClassAfterSorting=function(e){var t=ZD(e).attr("id");"nameHeader"==t?(ZD("#dateModifiedHeader").children("img:first").removeClass("UpArrow").addClass("DownArrow"),"UpArrow"==G_OF_OBJ.nameSortArrow?ZD("#"+t).children("img:first").removeClass("UpArrow").addClass("DownArrow"):ZD("#"+t).children("img:first").removeClass("DownArrow").addClass("UpArrow")):"dateModifiedHeader"==t&&("UpArrow"==G_OF_OBJ.timeSortArrow?ZD("#"+t).children("img:first").removeClass("UpArrow").addClass("DownArrow"):ZD("#"+t).children("img:first").removeClass("DownArrow").addClass("UpArrow"))},FILEDIALOG.getI18N=function(e,t,s){ZDUtils.getUserRelatedDetails(e,t,s)},FILEDIALOG.getI18NDetails=function(e,t,s){ZDUtils.getUserDetails(e,t,s)},FILEDIALOG.setFileOpenTarget=function(e,t){G_OF_OBJ?(G_OF_OBJ.openTarget=e,G_OF_OBJ.callback=t):(G_OF_OBJ=new FILEDIALOG,G_OF_OBJ.openTarget=e,G_OF_OBJ.callback=t)},FILEDIALOG.injectScript=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!1,document.getElementsByTagName("head")[0].appendChild(t)},FILEDIALOG.showSheetOpenFileDialog=function(e,t,s,i){window.$=ZD,FILEDIALOG.showOpenFileDialog(e,t,s,void 0,i)},FILEDIALOG.showOpenFileDialog=function(e,t,s,i,a){if(null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED)if($("#docscomponent").length)selected_component="FILEOPEN",fileServiceName=e,$("#docs_placeholder").trigger("click");else{var o=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:o,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),fileServiceName=e,selected_component="FILEOPEN",components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),urlJson.jsStaticServer=ZD_JSStaticSever,$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),FILEDIALOG.injectScript(window.manifestJson?ZD_JSStaticSever+"/jsapps/team/dist/"+tp_vendor_js:ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}else if(!ZD("#attachopenfiledialogdiv").length){if(void 0==zd_js_obj||""==zd_js_obj){var n=function(){FILEDIALOG.showOpenFileDialog(e,t,s,i)};return ZDUtils.getUserRelatedDetails(n,""),!1}if(G_OF_OBJ=new ZDConstants,G_OF_OBJ.urlInvoker=e,ZD("body").append('<div id="attachopenfiledialogdiv" style="display:none;">'),ZD("body").append('<ul id="zd_leftmenu" style="display:none;"></ul>'),ZD("body").append('<ul id="zd_rightmenu" style="display:none;"></ul>'),ZDDialog.showCommonDialog(zd_js_obj.label_open_file,!0,"attachopenfiledialogdiv",{},[],650,!0,"auto",!1,400,400),FILEDIALOG.setFileOpenTarget(t,i),s?"zw"==G_OF_OBJ.urlInvoker?ZD("div#attachopenfiledialogdiv").filedialog({recentDocs:{show:!0,name:zd_js_obj.documents,iconClass:"mydocs_icon"},desktopDocs:{show:!0,name:zd_js_obj.my_folders},myTemplates:{show:!0,name:zd_js_obj.label_templates},sharedDocs:{show:!0,name:zd_js_obj.shared_with_me},trashedDocs:{show:!1,name:zd_js_obj.trash},actionsButton:{showAction:!1}}):"zohosheet"==G_OF_OBJ.urlInvoker?ZD("div#attachopenfiledialogdiv").filedialog({recentDocs:{show:!0,name:zd_js_obj.spreadsheets,iconClass:"myspreadsheet_icon"},desktopDocs:{show:!0,name:zd_js_obj.my_folders},myTemplates:{show:!0,name:zd_js_obj.label_templates},sharedDocs:{show:!0,name:zd_js_obj.shared_with_me},trashedDocs:{show:!1,name:zd_js_obj.trash},actionsButton:{showAction:!1}}):"zohoshow"==G_OF_OBJ.urlInvoker&&ZD("div#attachopenfiledialogdiv").filedialog({recentDocs:{show:!0,name:zd_js_obj.presentations,iconClass:"mypresentation_icon"},desktopDocs:{show:!0,name:zd_js_obj.my_folders},myTemplates:{show:!1,name:zd_js_obj.label_my_templates},sharedDocs:{show:!0,name:zd_js_obj.shared_docs},trashedDocs:{show:!1,name:zd_js_obj.trash},actionsButton:{showAction:!1}}):ZD("div#attachopenfiledialogdiv").filedialog({recentDocs:{show:!1,name:zd_js_obj.label_recent_docs},desktopDocs:{show:!1,name:zd_js_obj.my_folders},myTemplates:{show:!1,name:zd_js_obj.label_my_templates},sharedDocs:{show:!0,name:zd_js_obj.shared_docs},trashedDocs:{show:!1,name:zd_js_obj.trash},actionsButton:{showAction:!1},homeButton:!1,upOneLevel:!1}),"zohosheet"===e&&"function"==typeof a&&a(),!s){var d="sharedservicedocs";return ZD("#actionMenuOpenFile").css("display","none"),FILEDIALOG.changeAllToNormalView(d),FILEDIALOG.getSharedDocs(),!1}ZD("div#showopenservicefilespace").openfiledatagrid({hoverclass:"data-hover1",checkboxIconSpace:!1}),ZD("div#attachopenfiledialogdiv").addClass("custommargin_lightgrey dottedborder")}},FILEDIALOG.showMoveDialog=function(e){if($("#docscomponent").length)resId=e.resId,urlJson.ZD_COMP_PROPERTIES=e,selected_component="move",$("#docs_placeholder").trigger("click");else{var t=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:t,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),selected_component="move",urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=e,resId=e.resId,$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e.serviceName?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append('<link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/components/dist/assets/components.css"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append('<link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/components/dist/assets/components.css"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/assets/vendor.js"),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/assets/components.js")}})}},FILEDIALOG.showCopyDialog=function(e){if($("#docscomponent").length)resId=e.resId,urlJson.ZD_COMP_PROPERTIES=e,selected_component="copy",$("#docs_placeholder").trigger("click");else{var t=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:t,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),selected_component="copy",resId=e.resId,urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=e,$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e.serviceName?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append('<link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/components/dist/assets/components.css"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append('<link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/components/dist/assets/components.css"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/assets/vendor.js"),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/assets/components.js")}})}},FILEDIALOG.showChooseFolderDialog=function(e){if($("#docscomponent").length)resId=e.resId,urlJson.ZD_COMP_PROPERTIES=e,selected_component="choose_folder",$("#docs_placeholder").trigger("click");else{var t=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:t,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),selected_component="choose_folder",urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=e,resId=e.resId,$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e.serviceName?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append('<link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/components/dist/assets/components.css"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append('<link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/components/dist/assets/components.css"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/assets/vendor.js"),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/assets/components.js")}})}},FILEDIALOG.validateRenameForm=function(e,t,s){ZD("#attachopenfiledialogdiv").dialog({closeOnEscape:!0}),ZDUtils.openFileLoadingMsg(zd_js_obj.renaming);{var i=ZD("input#renameinputform").val(),a=e.data("docName"),o=e.attr("id");e.data("service")}if(FILEDIALOG.selectOrdeselectRow(o,e),ZDUtils.hasSpecialChar(i,"docrename")||ZDUtils.hasWhiteSpaceChar(i))return s.empty().append(t),void ZDUtils.hideOpenFileLoadingMsg();if(i===a)return s.empty().append(t),ZDUtils.hideOpenFileLoadingMsg(),void FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.document_rename_success_msg);var n="",d="";e.data({docName:i}),n="docs/docsrequest.do?method=renameDoc",d="docId="+o+"&docName="+i+"&"+zdcsrfPair,ZD.ajax({url:n,data:d,type:"POST",success:function(){{var e=ZDUtils.escapeSpecialCharacters(i);ZDUtils.substringName(e,"10")}t.children().text(i),s.empty().append(t),ZDUtils.hideOpenFileLoadingMsg(),FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.document_rename_success_msg)}})},FILEDIALOG.trashFile=function(){var e,t={};t[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),FILEDIALOG.confirmTrashFile()},t[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("frameDiv"),FILEDIALOG.clearSelectedFiles()},e=ZD("#trashservicedocs").hasClass("selectedView")?zd_js_obj.confirm_delete:ZD("#templates").hasClass("selectedView")?zd_js_obj.label_templates_delete_permanently:zd_js_obj.confirm_trash,ZDDialog.openAlert(zd_js_obj.confirmwsreq,e,!0,t)},FILEDIALOG.confirmTrashFile=function(){for(var e="",t="",s=FILEDIALOG.getSelectedDocsForOpenFileDialog(),i=0,a=s.length;a>i;i++)e=s[i].docId,t=t+e+",",ZD("#"+e).css("display","none");var o="",n="";ZD("#templates").hasClass("selectedView")?(ZDUtils.openFileLoadingMsg(zd_js_obj.deleting),o="docs/docsrequest.do?method=deleteTemplate",n="docId="+t+"&"+zdcsrfPair):ZD("#trashservicedocs").hasClass("selectedView")?(ZDUtils.openFileLoadingMsg(zd_js_obj.deleting),o="docs/docsrequest.do?method=deleteDocument",n="docId="+t+"&"+zdcsrfPair):(ZDUtils.openFileLoadingMsg(zd_js_obj.trashing),o="docs/docsrequest.do?method=trashDocument",n="docId="+t+"&"+zdcsrfPair),ZD.ajax({url:o,data:n,type:"POST",success:function(){ZDUtils.hideOpenFileLoadingMsg(),ZD("#trashservicedocs").hasClass("selectedView")?FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.delete_success_msg):FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.trash_success_msg),FILEDIALOG.resetAll(),ZD("div#showopenservicefilespace").openfiledatagrid("populateDataPanel")}})},FILEDIALOG.clearSelectedFiles=function(){for(var e=FILEDIALOG.getSelectedDocsForOpenFileDialog(),t=0,s=e.length;s>t;t++){var i=e[t].docId;FILEDIALOG.selectOrdeselectRow(i)}},FILEDIALOG.createNewFolder=function(e,t){var s={};s[zd_js_obj.add_folder]=function(){FILEDIALOG.validateCreateNewFolder(e)},s[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("createnewfolderdiv")},ZDDialog.createNewFolderDialog(zd_js_obj.create_folder,!0,s,t,350);var i='<table width="100%" cellspacing="0" cellpadding="5" border="0"><tr><td  height="55" width="31%" nowrap="nowrap" align="right"><span class="margright" id="span_create_newfolder"></span></td> <td align="left" ><input type="text" width="160"  id="text_create_newfolder" value=""></td></tr></table>';return ZD("#createnewfolderdiv").html(i),ZD("#span_create_newfolder").text(zd_js_obj.enter_folder_name),ZD("#text_create_newfolder").bind("keyup",function(t){var s=t.keyCode||t.which;return 13==s?(FILEDIALOG.validateCreateNewFolder(e),!1):void 0}).focus(),!1},FILEDIALOG.validateCreateNewFolder=function(e){var t=ZD("#text_create_newfolder").val().trim();if(t.length>100)return FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.folder_validation_max_100_characters),!1;if(ZDUtils.hasSpecialChar(t,"createnewfolder")||ZDUtils.hasWhiteSpaceChar(t))return!1;var s="docs/docsrequest.do?method=createFolder",i=e.attr("folderId");"folder"==i&&(i=1);var a="folderid="+i+"&foldername="+t+"&"+zdcsrfPair;ZDDialog.closePopUp("createnewfolderdiv"),ZD.ajax({url:s,type:"POST",dataType:"text",data:a,success:function(){G_OF_OBJ.folderId=i,1==parseInt(i)?FILEDIALOG.getDocAsList("","desktopservicedocs"):FILEDIALOG.getDocAsList()}})},FILEDIALOG.renameFolder=function(e){ZD("#attachopenfiledialogdiv").dialog({closeOnEscape:!1});{var t=ZD(e),s=t.data("folderName"),i=t.find("a"),a=i.closest("td");i.children("span")}a.empty();var o=ZD("<input>",{value:s,id:"renameinputform",name:"renameoperation",keyup:function(e){var s=e.keyCode||e.which;return 13==s&&FILEDIALOG.validateRenameFormFolder(t,i,a),27==s?(a.empty().append(i),void ZD("#attachopenfiledialogdiv").dialog({closeOnEscape:!0})):void 0},blur:function(){FILEDIALOG.validateRenameFormFolder(t,i,a)}});return a.empty().append(o),ZD("input#renameinputform").focus(),!1},FILEDIALOG.validateRenameFormFolder=function(e,t,s){ZD("#attachopenfiledialogdiv").dialog({closeOnEscape:!0}),ZDUtils.openFileLoadingMsg(zd_js_obj.renaming);var i=ZD("#renameinputform").attr("value").trim(),a=e.data("folderName").trim(),o=e.attr("folderId");return ZDUtils.hasSpecialChar(i,"folderrename")||ZDUtils.hasWhiteSpaceChar(i)?(s.empty().append(t),void ZDUtils.hideOpenFileLoadingMsg()):i===a?(s.empty().append(t),ZDUtils.hideOpenFileLoadingMsg(),void FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.folder_rename_success_msg)):(url="docs/docsrequest.do?method=renameFolder",params="folderid="+o+"&foldername="+i+"&"+zdcsrfPair,void ZD.ajax({url:url,type:"POST",data:params,success:function(){{var e=ZDUtils.escapeSpecialCharacters(i);ZDUtils.substringName(e,"10")}t.text(i),s.empty().append(t),ZDUtils.hideOpenFileLoadingMsg(),FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.folder_rename_success_msg)}}))},FILEDIALOG.deleteFolder=function(e,t){var s={};return s[zd_js_obj.ok]=function(){FILEDIALOG.deleteConfirmFolder(e,t)},s[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert(zd_js_obj.confirmwsreq,zd_js_obj.confirm_delete_folder,!0,s),!1},FILEDIALOG.deleteConfirmFolder=function(e,t){ZDUtils.openFileLoadingMsg(zd_js_obj.deleting),ZDDialog.closePopUp("frameDiv");var s="docs/docsrequest.do?method=deleteFolder",i="folderid="+t+"&"+zdcsrfPair,a=e.attr("pntFolderId");ZD.ajax({url:s,dataType:"text",type:"POST",data:i,success:function(){ZDUtils.hideOpenFileLoadingMsg(),e.remove(),FILEDIALOG.statusmsg("success_status boldText",zd_js_obj.folder_delete_success_msg),G_OF_OBJ.folderId=1==a?"folder":a,FILEDIALOG.getDocAsList()}})},FILEDIALOG.removeShareContact=function(e){ZD(e).closest(".selectedContactDivs").length?ZD(e).closest(".selectedContactDivs").remove():ZD(e).closest(".selectedGroupDivs").length?ZD(e).closest(".selectedGroupDivs").remove():ZD(e).closest(".selectedWsDivs").length&&ZD(e).closest(".selectedWsDivs").remove()},FILEDIALOG.mouseOverContact=function(e){ZD(e).addClass("zdc-shareduser_linethrough")},FILEDIALOG.mouseOutContact=function(e){ZD(e).removeClass("zdc-shareduser_linethrough")},FILEDIALOG.getMyContacts=function(){ZDSHAREDIALOG.getMyContacts()},FILEDIALOG.showShareForm=function(e,t,s){if(void 0!==ZD_IS_NEW_UI_ENABLED&&null!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED)if($("#docscomponent").length)resId=t,selected_component="SHARE",$("#docs_placeholder").trigger("click");else{var i=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:i,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(s){ZD("#zd_user_details").remove(),ZD("body").append(s),ZD(s).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),selected_component="SHARE",resId=t,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),urlJson.jsStaticServer=ZD_JSStaticSever,$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),FILEDIALOG.injectScript(window.manifestJson?ZD_JSStaticSever+"/jsapps/team/dist/"+tp_vendor_js:ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),FILEDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}else ZDSHAREDIALOG.showShareForm(e,t,s)},FILEDIALOG.showFormsShareDialog=function(e,t){ZDSHAREDIALOG.showShareForm("zohoforms",e,!1,void 0,!1,void 0,!0,t,!0,void 0,!0)},function(e){e.widget("ui.filedialog",{options:{recentDocs:{show:!1,name:"Recent Docs",id:"recentservicedocs",action:"getMyDocuments",iconClass:"recentdocs-icon"},desktopDocs:{show:!1,name:"My Folders",id:"desktopservicedocs",action:"getDocs",fid:"folder",iconClass:"zdc-foldericon_css"},myTemplates:{show:!1,name:"Templates",id:"templates",action:"getTemplates",iconClass:"template"},sharedDocs:{show:!1,name:"Shared Docs",id:"sharedservicedocs",iconClass:"shareTome",action:"getSharedToMeDocs"},trashedDocs:{show:!1,name:"Trash",id:"trashservicedocs",action:"getTrashedDocuments",iconClass:"trash-icon",fid:"trash"},selectAllButton:{showAction:!1,action:!0,id:"selectMenuOpenFile",iconClass:"",value:"Select"},actionsButton:{showAction:!0,action:!0,id:"actionMenuOpenFile",iconClass:"action-css",value:"Actions"},exportAsButton:{showAction:!1,action:!0,id:"exportAsOpenFile",iconClass:"export-icon",value:""},statusMessageDiv:!0,homeButton:!0,upOneLevel:!0,createFolder:!1,selectedView:"recentservicedocs",lookIn:!1,documentNameHeader:!0,lastModifiedTimeHeader:!0,advSearchBox:!0},_create:function(){this._constructFileDialog(),this._constructLeftPanel(),this._constructRightPanel(),this._initDelegate()},_constructFileDialog:function(){this.mainPanel=e('<div id="mainPanelforservicefiles" style="overflow:hidden;width:100%;margin: 12px 0px;">'),this.leftPanel=e('<div class="ui-left-panel flleft">'),this.rightPanel=e('<div class="ui-rht-datadiv">'),this.element.append(this.mainPanel),this.mainPanel.append(this.leftPanel),this.mainPanel.append(this.rightPanel)},_constructLeftPanel:function(){var t='<div id="searchdivforservicefiles" style="padding-bottom:0px;margin-top:0px;"><div style="" class="searchdiv ui-corner-all docscursor flright"><input type="submit" class="searchIcon flleft docscursor smallText" value=""><input type="text" id="searchFileName" class="searchtext flleft" value=""><input type="hidden" value="search_all_search" name="Search All" id="search_type_openfile" class=""></div><div style="height:20px;border-bottom:1px solid #efefef;padding-top:13px;margin-bottom:13px;"></div></div>';this.leftPanel.append(t);var s='<table id="serviceDialogLeftPanel" width="100%"  cellpadding="0" cellspacing="0" align="center" class="mailLeftPanel">';for(var i in this.options){var a=this.options[i];void 0!=a&&"undefined"!=a.show&&a.show&&(s+='<tr><td  class="normalView docscursor" id="'+a.id+'" action="'+a.action+'" fid="'+a.fid+'"><span style="width:17px;height:16px;" class="'+a.iconClass+' flleft margright"></span><span class="flleft" style="line-height:16px;">'+a.name+"</span></td></tr>")}s+="</table>",this.leftPanel.append(s),e("#"+this.options.selectedView).removeClass("normalView").addClass("selectedView")},_constructRightPanel:function(){this.rightPaneltopContainer=e("<div>"),this.rightPanel.append(this.rightPaneltopContainer),this._constructActionsRow(),this._constructStatusMessageRow(),this.rightPanelDataContainer=e('<div id="showopenservicefilespace" style="background:#fff; height:354px; margin: 0px 0px 0px 12px;"></div>'),this.loadingDiv=e('<div id="openfileloadingdiv" style="position:absolute;"><span class="loadingspan"></span></div>'),this.rightPanel.append(this.loadingDiv),this.rightPanel.append(this.rightPanelDataContainer)},_constructActionsRow:function(){var e='<div id="ActionsPathDiv" class="toolbar-menu" style="padding: 0px 0px 12px 0px; height: 21px;"><table width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td class="rhtspac" height="24"><div id="homebuttondiv" style="display:none;">';e+='<ul id="homebuttondiv" class="homenavbutton"><li id="moveUpFolder" style="display:none;"><img src="/docs/images/spacer.gif" class="back-folder" align="absmiddle" style="width: 23px;"></li><li class="activeFolder" id="parentFolderSpan" style="display:none; padding-left: 5px;"><img src="/docs/images/spacer.gif" class="zdc-foldericon_css" align="absmiddle" style="width: 16px;"><span style="white-space:nowrap; padding: 0px 3px;" class="foldername"></span></li></ul>',e+="</div></td>";for(var t in this.options){var s=this.options[t];void 0!=s&&"undefined"!=s.action&&s.showAction&&(e+='<li><a id="'+s.id+'"  data-menu-id="zd_leftmenu" popup="zd_leftmenu" href="javascript:void(0);"><em class="flleft '+s.iconClass+'"></em><span class="flleft">'+s.value+'</span><em class="flleft arrow down-arrow"></em></a></li>')}e+='</div><div></div></td><td><div id="openloadingmsg"></div><div id="servicefilepagination"  style="float:right; z-index:1000;display:none;"></div</td></tr></table></div>',this.rightPaneltopContainer.append(e)},_constructStatusMessageRow:function(){this.options.statusMessageDiv&&this.rightPaneltopContainer.append('<div style="width:60%;position:absolute;padding-top:5px;"><div align="center" class="hidediv"><span id="statusmsgdiv" ></span></div></div>')},_initDelegate:function(){G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight();for(var t in this.options){var s=this.options[t];if(void 0!=s&&"undefined"!=s.show&&s.show){var i=s.id;e("#serviceDialogLeftPanel").delegate("td#"+i,"click",function(t){var s=e(t.target);return"leftpanel_createfolder"==s.attr("id")?(FILEDIALOG.createNewFolder(s,[t.pageX+10,t.pageY-10]),!1):(e("#showopenservicefilespace").html(""),e("#servicefilepagination").show(),void FILEDIALOG.getLeftPanelList(this))})}}e("#showopenservicefilespace").delegate("div.folderDataDiv","click",function(t){var s=e(t.target);if("renameinputform"==s.attr("id"))return!1;FILEDIALOG.reset();var i=e(this).data("folderName"),a=e(this).data("folderIcon");e("#parentFolderSpan").show().find(".foldername").html(i),e("#parentFolderSpan").find("img").removeClass().addClass(a);var o=G_OF_OBJ.folderArray.length;G_OF_OBJ.folderArray[o]=i,e("#defaultHomeButton").hide(),e("#homeButton").show(),e("#moveUpFolder").show();var n=e(this).attr("folderId"),d=e(this).attr("pntFolderId");e("#servicefilepagination").show(),e("#showopenservicefilespace").css("display","block"),G_OF_OBJ.parentFolderId=d,G_OF_OBJ.folderId=n,FILEDIALOG.getDocAsList()}),e("div#searchdivforservicefiles").delegate("input#searchFileName","focusin focusout keypress",function(t){if("focusin"==t.type)e("input#searchFileName").val(""),e("input#search_type_openfile").addClass("searchquery");else if("focusout"==t.type)""==e("input#searchFileName").val()&&(e("#servicefilepagination").hide(),e("input#search_type_openfile").removeClass("searchquery"));else if("keypress"==t.type&&"13"==t.keyCode){var s=e("input#searchFileName").val();if(G_OF_OBJ.searchType="relevance",""==s||null==s)return void FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.validation_for_search);e("#servicefilepagination").show(),FILEDIALOG.searchFile(s)}}),e("#showopenservicefilespace").delegate("table.data-hover1","click",function(t){G_OF_OBJ.callback&&t.preventDefault();var s=e(t.target),i=s.closest("td").attr("elem");if(s.hasClass("activelink")||s.is("a")||s.parent().hasClass("activelink")||s.parent("a").length||s.hasClass("selectcheckboxicon_css")||s.hasClass("normalcheckboxicon_css")){if(s.parent("a").length&&"trashservicedocs"==G_OF_OBJ.selectedLeftPanel){FILEDIALOG.clearSelectedFiles();var a=s.closest(".documentDataDiv").attr("id"),o=zd_js_obj.label_do_you_want_restore_message,n={};return n[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),FILEDIALOG.restoreFile(a)},n[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("frameDiv"),FILEDIALOG.selectOrdeselectRow(a,s)},ZDDialog.openAlert(zd_js_obj.confirmwsreq,o,!0,n),FILEDIALOG.selectOrdeselectRow(a,s),!1}FILEDIALOG.showSelectedDocsToOpen(this,i)}}),e("div#searchdivforservicefiles").delegate("input.searchIcon","click",function(){var t=e("input#searchFileName").val(),s=e("input#search_type_openfile").attr("class");return""==t||null==t||"searchquery"!=s?(FILEDIALOG.statusmsg("failure_status boldText",zd_js_obj.validation_for_search),void e("#servicefilepagination").hide()):(e("#servicefilepagination").show(),void FILEDIALOG.searchFile(t))}),e(document).click(function(t){void 0!==e(t.target).attr("id")&&("sort_button"===e(t.target).attr("id")||"sort_tile"===e(t.target).attr("id"))||void 0!==e(t.target).parent().parent().attr("id")&&"sort_button"===e(t.target).parent().parent().attr("id")||e("#init_sort").is(":visible")&&e("#init_sort").hide()}),e("#servicefilepagination").delegate("button#sort_button","click",function(){e("#init_sort").is(":visible")?e("#init_sort").hide():e("#init_sort").show()}),e("#servicefilepagination").delegate("li#relevance_sort","click",function(){if("relevance"!==G_OF_OBJ.searchType){G_OF_OBJ.searchType="relevance";var t=e("input#searchFileName").val();FILEDIALOG.searchFile(t)}e("#init_sort").hide()}),e("#servicefilepagination").delegate("li#lastmodified_sort","click",function(){if("lastmodified"!==G_OF_OBJ.searchType){G_OF_OBJ.searchType="lastmodified";var t=e("input#searchFileName").val();FILEDIALOG.searchFile(t),FILEDIALOG.getSearchResults(t,0,"time","desc")}e("#init_sort").hide()}),e("#servicefilepagination").delegate("li#author_sort","click",function(){if("author"!==G_OF_OBJ.searchType){G_OF_OBJ.searchType="author";var t=e("input#searchFileName").val();FILEDIALOG.getSearchResults(t,0,"author","desc")}e("#init_sort").hide()}),e("#servicefilepagination").delegate("div#prevbuttonid,div#nextbuttonid","click",function(){var t=e(this).attr("id");"prevbuttonid"==t?action="previousPage":"nextbuttonid"==t&&(action="nextPage"),e("#showopenservicefilespace").openfiledatagrid(action)}),e("#showopenservicefilespace").delegate("td#nameHeader,td#dateModifiedHeader","click",function(){e("#templates").hasClass("selectedView")||(e("#trashservicedocs").hasClass("selectedView")&&(G_OF_OBJ.trashsort=!0),e("div#servicefilepagination").hide(),FILEDIALOG.setSortOrder(this),FILEDIALOG.resetAll(),e("#desktopservicedocs").hasClass("selectedView")&&(G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId),FILEDIALOG.getDocAsList("",G_OF_OBJ.selectedLeftPanel),FILEDIALOG.setClassAfterSorting(this))}),e("#moveUpFolder").delegate(".back-folder","click",function(){var t=G_OF_OBJ.folderArray.length,s=G_OF_OBJ.folderArray[t-2];G_OF_OBJ.folderArray.splice(t-1),G_OF_OBJ.folderArray.length>0?e("#parentFolderSpan").show().find(".foldername").html(s):(e("#parentFolderSpan").hide(),e("#defaultHomeButton").hide(),e("#homeButton").hide(),e("#moveUpFolder").hide()),G_OF_OBJ.moveUpFolder=!0,G_OF_OBJ.folderId="0"==G_OF_OBJ.parentFolderId||"1"==G_OF_OBJ.parentFolderId?"folder":G_OF_OBJ.parentFolderId,FILEDIALOG.getDocAsList()}),e("#homeButton").bind("click",function(){G_OF_OBJ.folderArray.length>0&&(e("div#mainPanelforservicefiles").show(),G_OF_OBJ.folderId="folder",e("#parentFolderSpan").hide(),G_OF_OBJ.folderArray=[],e("#defaultHomeButton").hide(),e("#homeButton").hide(),e("#moveUpFolder").hide(),FILEDIALOG.getDocAsList("","desktopservicedocs"))})}}),e.extend(e.ui.filedialog,{version:"1.8"})}(jQuery),function(e){e.widget("ui.openfiledatagrid",{options:{documentNameHeader:!0,lastModifiedTimeHeader:!0,authorNameHeader:!0,checkboxIconSpace:!0,checkboxIcon:"normalcheckboxicon_css flleft",hoverclass:"data-hover",documentIcon:!0,documentName:!0,lastModifiedTime:!0,authorName:!0},_create:function(){this._constructHeader(),this.sendAjaxRequest(),this.resize()},resetOptions:function(){this.options.documentNameHeader=!0,this.options.lastModifiedTimeHeader=!0,this.options.documentIcon=!0,this.options.documentName=!0,this.options.lastModifiedTime=!0},_setOptions:function(){e("#templates").hasClass("selectedView")&&(this.options.lastModifiedTimeHeader=!1)},populateDataPanel:function(){this._constructHeader(),this.sendAjaxRequest(),this.resize()},_constructHeader:function(){this.headerDiv=e('<div id="docsHeaderTab" class="docsheadermargin">');var t='<table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr>';this.options.documentNameHeader&&(t+='<td id="nameHeader" height="23" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+'<img id="_sortname" src="/docs/images/spacer.gif" class="DownArrowH" style="margin-left:2px;"></td>'),this.options.authorNameHeader&&!e("#templates").hasClass("selectedView")&&(t+='<td id="authorNameHeader" width="115" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.author+'<img id="_sortname" src="/docs/images/spacer.gif" class="" style="margin-left:2px;"></td>'),this.options.lastModifiedTimeHeader&&(t+='<td id="dateModifiedHeader" width="109" nowrap="nowrap" class="docscursor sortfield datesortTd" sortfield="date">'+zd_js_obj.date_modified+'<img id="_sortdate" src="/docs/images/spacer.gif" style="margin-left: 2px;" class="DownArrow"></td>'),t+="</tr></table>";var s='<div id="openFileDataDiv" style="overflow:auto;vertical-align:top;"></div>';this.headerDiv.append(t),this.element.append(this.headerDiv),this.element.append(s)},sendAjaxRequest:function(){ZDUtils.openFileLoadingMsg(zd_js_obj.loading);var t=this._constructURLParameters();e.ajax({url:t,type:"GET",dataType:"json",success:function(t,s){return"success"==s?(G_OF_OBJ.jsonData=t,e("#templates").hasClass("selectedView")?e("div#showopenservicefilespace").openfiledatagrid("constructWriterOrSheetTemplateRows","templates"):e("div#showopenservicefilespace").openfiledatagrid("constructDocumentRows"),ZDUtils.hideOpenFileLoadingMsg(),e("#templates").hasClass("selectedView")&&(e("td#dateModifiedHeader").find("img").remove(),e("td#nameHeader").removeClass("docscursor").find("img").remove(),e("td#dateModifiedHeader").removeClass("docscursor").find("img").remove()),G_OF_OBJ.moveUpFolder=!1,!1):void 0}})},getTemplateCount:function(){var t="docs/docsrequest.do?urlInvoker="+G_OF_OBJ.urlInvoker+"&method=getTemplatesCount";t=t+"&_t="+e.now(),e.ajax({url:t,type:"GET",dataType:"text",success:function(t,s){if("success"==s){var i=e.parseJSON(t);G_OF_OBJ.templateCount=i.response.result.templates.templatecount,e("div#showopenservicefilespace").openfiledatagrid("constructWriterOrSheetTemplateRows","templates")}}})},_constructURLParameters:function(){var t="",s="",i=e("#serviceDialogLeftPanel").find("td.selectedView").attr("id");return t="method="+e("#"+i).attr("action")+"&fromIndex="+G_OF_OBJ.startFrom+"&noOfDocuments="+G_OF_OBJ.fetchLimit,e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft"),"templates"!=i&&(t+="&docorder="+G_OF_OBJ.nameSortOrder+"&dateorder="+G_OF_OBJ.timeSortOrder),("desktopservicedocs"===i||"sharedservicedocs"===i)&&(t+="&fid="+G_OF_OBJ.folderId,"folder"!=G_OF_OBJ.folderId&&e("#moveUpFolder").toggleClass("non-hover hover").children().toggleClass("back-folder-inactive back-folder docscursor")),"trashservicedocs"==i&&(t+="&fid=trash"),G_OF_OBJ.moveUpFolder&&"folder"!=G_OF_OBJ.folderId&&(t+="&isParentFolderDocs=true"),s=serviceUrl+"/docs/docsrequest.do?urlInvoker="+G_OF_OBJ.urlInvoker+"&"+t,s=s+"&_t="+e.now()},constructWriterOrSheetTemplateRows:function(t){var s,i="";if(G_OF_OBJ.templateObj=G_OF_OBJ.jsonData.response.result[t],s="template","No Templates"==G_OF_OBJ.jsonData.response.result){this.noDocuments=e("div#openFileDataDiv");var a='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center" style="margin-top:40px;">'+zd_js_obj.no_templates_are_present+"</div></td></tr></table></div>";return void this.noDocuments.append(a)}var o,n=e.isPlainObject(G_OF_OBJ.templateObj[s]);o=n?1:G_OF_OBJ.templateObj[s].length,i=G_OF_OBJ.endIndex>o?o:G_OF_OBJ.endIndex,G_OF_OBJ.totalFiles=i>1?o:o,this._constructPaginationData(),this.documentDataDiv=e("div#openFileDataDiv"),this.documentDataDiv.empty();for(var d=G_OF_OBJ.fromIndex;i>d;d++){var r=e("<div>").addClass("documentDataDiv");o>0&&r.attr({id:G_OF_OBJ.templateObj[s][d][s+"Id"]}).data({docName:G_OF_OBJ.templateObj[s][d][s+"Name"],isDocumentSharedToMe:!1,isTemplates:!0});var l=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),c=e("<tr>"),_=e('<td colspan="4" nowrap="nowrap" width="100%">'),p='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';if(this.options.documentIcon&&(p+='<td width="20" nowrap="nowrap" style="display:none;"><div class="template" flleft docscursor"></div></td>'),this.options.documentName){{var u;e("#zd_user_details").attr("third_party")}"zohosheet"==G_OF_OBJ.urlInvoker?u="/sheet/open/":"zw"==G_OF_OBJ.urlInvoker?u="/writer/open/":"zohoshow"==G_OF_OBJ.urlInvoker&&(u="/show/open/"),o>0&&(p+='<td nowrap="nowrap" style="height:20px;padding-left: 3px;" align="left">&nbsp;<a class="activelink" style="text-decoration: underline;" rel="noopener" href="'+u+G_OF_OBJ.templateObj[s][d][s+"Id"]+'" target="'+G_OF_OBJ.openTarget+'"><span id="fileNameSpan_'+G_OF_OBJ.templateObj[s][d][s+"Id"]+'" docId="'+G_OF_OBJ.templateObj[s][d][s+"Id"]+'" title="'+G_OF_OBJ.templateObj[s][d][s+"Name"]+'" class="docscursor">'+G_OF_OBJ.templateObj[s][d][s+"Name"]+"</span></a></td>")}this.options.lastModifiedTime&&(p+='<td width="107" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<span style="color:#666;">'+G_OF_OBJ.templateObj[s][d].lastModifiedTime+"</span></td>"),p+="</tr></table>",_.append(p),c.append(_),l.append(c),r.append(l),this.documentDataDiv.append(r)}},constructDocumentRows:function(){var t="";return 0==G_OF_OBJ.jsonData.DOC.length&&0==G_OF_OBJ.jsonData.FOLDER.length?(this.noDocuments=e("div#openFileDataDiv"),G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,t+='<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="docs-tabledata"><tr><td colspan="5" nowrap><BR><div align="center" style="margin-top:40px;">'+zd_js_obj.no_documents_are_present+"</div></td></tr></table>",void this.noDocuments.append(t)):(void 0!=G_OF_OBJ.jsonData.FOLDER&&G_OF_OBJ.jsonData.FOLDER.length>0&&1==Math.abs(G_OF_OBJ.prevIndex)?this._constructFolderInfoRows():G_OF_OBJ.parentFolderId=G_OF_OBJ.folderId,G_OF_OBJ.jsonData.DOC.length>0&&(G_OF_OBJ.totalFiles=e("#recentservicedocs").hasClass("selectedView")||e("#trashservicedocs").hasClass("selectedView")?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.jsonData.TOTALDOCS[0].NOOFDOCS,this._constructPaginationData(),this._constructDocInfoRows()),void("folder"==G_OF_OBJ.folderId&&e("#moveUpFolder").removeClass("hover").addClass("non-hover").children().removeClass("back-folder cursor").addClass("back-folder-inactive flleft")))},_constructDocInfoRows:function(){var t="";t=G_OF_OBJ.endIndex>G_OF_OBJ.jsonData.DOC.length?G_OF_OBJ.jsonData.DOC.length:G_OF_OBJ.endIndex,this.containerDiv=e("div#openFileDataDiv"),Math.abs(G_OF_OBJ.prevIndex)>1?this.containerDiv.empty():this.containerDiv.find(".documentDataDiv").remove();for(var s=G_OF_OBJ.fromIndex;t>s;s++){var i=e("<div>").addClass("documentDataDiv").attr({id:G_OF_OBJ.jsonData.DOC[s].DOCID}).data({service:G_OF_OBJ.jsonData.DOC[s].SERVICE_TYPE,cssName:G_OF_OBJ.jsonData.DOC[s].CLASSNAME,docName:G_OF_OBJ.jsonData.DOC[s].ENC_DOCNAME,isDocumentSharedToMe:!1,isTemplates:!1}),a=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="'+this.options.hoverclass+'">'),o=e("<tr>"),n=e('<td colspan="4" nowrap="nowrap" width="100%">'),d=G_OF_OBJ.jsonData.DOC[s].ENCATTR_DOCNAME,r=ZDUtils.substringName(G_OF_OBJ.jsonData.DOC[s].ENC_DOCNAME,"40"),l='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';if(this.options.documentIcon&&(l+='<td width="20" nowrap="nowrap" elem="documenticon" style="display:none;padding-left:5px;"><div class="'+G_OF_OBJ.jsonData.DOC[s].CLASSNAME+' flleft"></div></td>'),this.options.documentName)if("trashservicedocs"!=G_OF_OBJ.selectedLeftPanel){{var c;e("#zd_user_details").attr("third_party")}"zohosheet"==G_OF_OBJ.urlInvoker?c="/sheet/open/":"zw"==G_OF_OBJ.urlInvoker?c="/writer/open/":"zohoshow"==G_OF_OBJ.urlInvoker&&(c="/show/open/"),l+='<td style="height:20px;padding-left: 3px;" nowrap="nowrap" align="left" elem="documentname">&nbsp;<a class="activelink" style="text-decoration: underline;" rel="noopener" href="'+c+G_OF_OBJ.jsonData.DOC[s].DOCID+'" target="'+G_OF_OBJ.openTarget+'"><span id="fileNameSpan_'+G_OF_OBJ.jsonData.DOC[s].DOCID+'" docId="'+G_OF_OBJ.jsonData.DOC[s].DOCID+'" title="'+d+'" class="docscursor">'+r+"</span></a></td>"}else l+='<td nowrap="nowrap" align="left">&nbsp;<a href="javascript:void(0);"><span id="fileNameSpan_'+G_OF_OBJ.jsonData.DOC[s].DOCID+'" docId="'+G_OF_OBJ.jsonData.DOC[s].DOCID+'" title="'+d+'" class="trashlink">'+r+"</span></a></td>";if(this.options.authorName){var _=G_OF_OBJ.jsonData.DOC[s].AUTHOR_NAME,p=G_OF_OBJ.jsonData.DOC[s].ENCATTR_AUTHOR_NAME,u=G_OF_OBJ.jsonData.DOC[s].SCOPE;0==u&&(_="Me",p="Me"),l+='<td width="110" nowrap="nowrap" align="left" class="zdtext-truncate" title="'+p+'" elem="lastmodifiedtime">&nbsp;<span style="color:#666;">'+p+"</span></td>"}this.options.lastModifiedTime&&(l+='<td width="107" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<span style="color:#666">'+G_OF_OBJ.jsonData.DOC[s].LAST_MODIFIEDTIME+"</span></td>"),l+="</tr></table>",n.append(l),o.append(n),a.append(o),i.append(a),this.containerDiv.append(i)}},_constructFolderInfoRows:function(){for(var t=0,s=G_OF_OBJ.jsonData.FOLDER.length;s>t;t++){G_OF_OBJ.parentFolderId!=G_OF_OBJ.jsonData.FOLDER[t].PARENTFOLDERID&&(G_OF_OBJ.parentFolderId=G_OF_OBJ.jsonData.FOLDER[t].PARENTFOLDERID,G_OF_OBJ.folderId=G_OF_OBJ.jsonData.FOLDER[t].PARENTFOLDERID),("1"==G_OF_OBJ.parentFolderId||"0"==G_OF_OBJ.parentFolderId)&&(G_OF_OBJ.folderId="folder");var i=G_OF_OBJ.jsonData.FOLDER[t].SHARED_TYPE,a="zdc-foldericon_css";!e("#desktopservicedocs").hasClass("selectedView")||"PERSONAL"!==i&&"GROUP"!==i&&"ORG"!==i&&"ANYONE_WITHLINK"!==i&&"ANYONE_WITHLINK_PASSWORD"!==i||(a="zdc-sharedfoldericon_css"),this.folderDataDiv=e("div#openFileDataDiv");var o=e("<div>").addClass("folderDataDiv").attr({id:G_OF_OBJ.jsonData.FOLDER[t].FOLDERID,folderId:G_OF_OBJ.jsonData.FOLDER[t].FOLDERID,pntFolderId:G_OF_OBJ.jsonData.FOLDER[t].PARENTFOLDERID,context:"zd_rightmenu"}).data({folderName:G_OF_OBJ.jsonData.FOLDER[t].ENC_FOLDERNAME,folderIcon:a}),n=e('<table width="100%" cellpadding="0" cellspacing="0" border="0" align="center" class="folderDiv">'),d=e("<tr>"),r=e("<td>"),l=ZDUtils.substringName(G_OF_OBJ.jsonData.FOLDER[t].ENC_FOLDERNAME,"40"),c='<table width="100%" border="0" cellpadding="0" class="docs-tablerow"><tr>';if(this.options.checkboxIconSpace&&(c+='<td style="width:20px" height="20"></td>'),this.options.documentIcon&&(c+='<td style="width:15px;height:20px;padding-left: 3px;" nowrap="nowrap"><div class="'+a+'" style="margin-bottom: 2px;" >&nbsp;</div></td>'),this.options.documentName&&(c+='<td style="width:100%" class="docscursor" nowrap="nowrap" align="left" title="'+G_OF_OBJ.jsonData.FOLDER[t].ENC_FOLDERNAME+'"><a class="foldername" style="padding-left:2px;">'+l+"</a></td>"),this.options.authorName){var _=G_OF_OBJ.jsonData.FOLDER[t].AUTHOR_NAME,p=G_OF_OBJ.jsonData.FOLDER[t].ENCATTR_AUTHOR_NAME,u=G_OF_OBJ.jsonData.FOLDER[t].SCOPE;0===u&&(_="Me",p="Me"),c+='<td width="110" nowrap="nowrap" align="left" class="zdtext-truncate" title="'+p+'" elem="lastmodifiedtime">&nbsp;<span style="color:#666;">'+p+"</span></td>"}this.options.lastModifiedTime&&(c+='<td width="107" nowrap="nowrap" align="left" elem="lastmodifiedtime">&nbsp;<span style="color:#666"></span></td>'),c+="</tr></table>",r.append(c),d.append(r),n.append(d),o.append(n),this.folderDataDiv.append(o)}},constructShareDocsPage:function(t){ZDUtils.openFileLoadingMsg(zd_js_obj.loading),null!=t&&""!=t&&void 0!=t&&(G_OF_OBJ.startFrom=t);var s=!0;if(s){var i="";i=G_OF_OBJ.advSearchFile?serviceUrl+"/viewsearchresults.do?method=searchServiceFile&searchquery="+G_OF_OBJ.searchQuery+"&start="+G_OF_OBJ.startFrom+"&field=time&action="+G_OF_OBJ.timeSortOrder+"&searchtype="+G_OF_OBJ.searchType+"&isFromOpenFile=true":serviceUrl+"/viewsearchresults.do?method=sharetome&start="+G_OF_OBJ.startFrom+"&field=time&action="+G_OF_OBJ.timeSortOrder+"&isFromOpenFile=true",i+="&category="+G_OF_OBJ.urlInvoker+"&isShareEnable="+G_OF_OBJ.isShareEnabled+"&_t="+e.now(),e.ajax({url:i,type:"GET",success:function(t){e("#showopenservicefilespace").children().remove().html(""),e("#showopenservicefilespace").html(t),ZDUtils.hideOpenFileLoadingMsg(),"UpArrow"==G_OF_OBJ.timeSortArrow?e("#dateModifiedHeader").children("img:first").removeClass("UpArrow").addClass("DownArrow"):"DownArrow"==G_OF_OBJ.timeSortArrow&&e("#dateModifiedHeader").children("img:first").removeClass("DownArrow").addClass("UpArrow")}})}else{var a='<div id="ActionsPathDiv" class="toolbar-menu"><table width="100%" cellpadding="0" cellspacing="0" border="0" align="center"><tr><td><div class="top-menu hidediv"><ul><li><a id="selectMenuOpenFile" title="'+zd_js_obj.label_select+'" href="#"><span class="flleft">'+zd_js_obj.label_select+'</span><em class="down-arrow flleft arrow"></em></a></li><li><a id="actionMenuOpenFile" title="Actions" href="#"><em class="action-css flleft"></em><span class="flleft">'+zd_js_obj.label_actions+'</span><em class="down-arrow flleft arrow"></em></a></li></ul></div><div></div></td></tr></table></div>';a+='<div id="docsHeaderTab"><table  id="table1" width="100%" cellpadding="0" cellspacing="0" border="0" class="docs-tableheader" align="center"><tr><td  height="23" nowrap="nowrap" align="left" class="docscursor sortfield namesortTd pad-lft" sortfield="name">'+zd_js_obj.name+'<img id="_sortname" src="/docs/images/spacer.gif" class="DownArrowH hidediv" style="margin-left:2px;"></td><td  width="105" nowrap="nowrap" class="docscursor sortfield datesortTd" sortfield="date">'+zd_js_obj.date_modified+'<img id="_sortdate" src="/docs/images/spacer.gif" style="margin-left: 2px;" class="DownArrow hidediv"></td></tr></table></div>',a+='<div style="text-align:center;padding-top:20px;"><span style="text-align:center;">'+zd_js_obj.restriction_msg_to_attach_document_in_external_org+"</span></div>",e("#showopenservicefilespace").html(a),ZDUtils.hideOpenFileLoadingMsg()}},_constructPaginationData:function(){var t="";G_OF_OBJ.totalFiles>0&&(t='<table cellpadding="0" cellspacing="0" border="0"><tr><td id="pagestatusid" nowrap="nowrap" class="pagecount"></td><td><div id="prevbuttonid"  class="zd_prev">&nbsp;</div></td><td><div id="nextbuttonid"  class="zd_next">&nbsp;</div></td></tr></table>',e("#servicefilepagination").html(t),G_OF_OBJ.nextIndex>=G_OF_OBJ.totalFiles&&(G_OF_OBJ.nextIndex=G_OF_OBJ.totalFiles,e("#prevbuttonid").removeClass("zd_preDis").addClass("zd_prev"),e("#nextbuttonid").removeClass("zd_next").addClass("zd_nextDis")),1==G_OF_OBJ.prevIndex&&e("#prevbuttonid").removeClass("zd_prev").addClass("zd_preDis"),e("#pagestatusid").text(G_OF_OBJ.prevIndex+" - "+G_OF_OBJ.nextIndex+" "+zd_js_obj.of+" "+G_OF_OBJ.totalFiles),e("#servicefilepagination").show())},previousPage:function(){e("#prevbuttonid","#servicefilepagination").hasClass("zd_preDis")||(G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.prevIndex)-Math.abs(1),G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)-(Math.abs(G_OF_OBJ.docsPerPage)-Math.abs(1)),G_OF_OBJ.prevIndex<G_OF_OBJ.topLevelFetch?(G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.prevIndex),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.topLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit)-Math.abs(1),G_OF_OBJ.endIndex="10",G_OF_OBJ.fromIndex="0",G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,e("#templates").hasClass("selectedView")?e("#showopenservicefilespace").openfiledatagrid("constructWriterOrSheetTemplateRows","templates"):e("div#showopenservicefilespace").openfiledatagrid("sendAjaxRequest")):G_OF_OBJ.prevIndex<=G_OF_OBJ.bottomLevelFetch&&(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.fromIndex)-Math.abs(10),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)-Math.abs(10),e("#templates").hasClass("selectedView")?e("#showopenservicefilespace").openfiledatagrid("constructWriterOrSheetTemplateRows","templates"):e("div#showopenservicefilespace").openfiledatagrid("constructDocumentRows")),ZDUtils.hideLoadingMsg())},nextPage:function(){return e("#nextbuttonid","#servicefilepagination").hasClass("zd_nextDis")?!1:(G_OF_OBJ.prevIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(1),G_OF_OBJ.nextIndex=Math.abs(G_OF_OBJ.nextIndex)+Math.abs(G_OF_OBJ.docsPerPage),G_OF_OBJ.nextIndex<=G_OF_OBJ.bottomLevelFetch?(G_OF_OBJ.fromIndex=Math.abs(G_OF_OBJ.endIndex),G_OF_OBJ.endIndex=Math.abs(G_OF_OBJ.endIndex)+Math.abs(G_OF_OBJ.docsPerPage),e("#templates").hasClass("selectedView")?e("#showopenservicefilespace").openfiledatagrid("constructWriterOrSheetTemplateRows","templates"):e("div#showopenservicefilespace").openfiledatagrid("constructDocumentRows")):(G_OF_OBJ.fromIndex="0",G_OF_OBJ.endIndex="10",G_OF_OBJ.topLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(1),G_OF_OBJ.bottomLevelFetch=Math.abs(G_OF_OBJ.bottomLevelFetch)+Math.abs(G_OF_OBJ.fetchLimit),G_OF_OBJ.startFrom=G_OF_OBJ.topLevelFetch,e("#templates").hasClass("selectedView")?e("#showopenservicefilespace").openfiledatagrid("getTemplatePaginationData"):e("div#showopenservicefilespace").openfiledatagrid("sendAjaxRequest")),void ZDUtils.hideLoadingMsg())},getTemplatePaginationData:function(){e("div#showopenservicefilespace").openfiledatagrid("sendAjaxRequest")},resize:function(){e("#openFileDataDiv").css({height:this.element.height()-(this.headerDiv.height()+2)})}}),e.extend(e.ui.openfiledatagrid,{version:"1.8"})}(jQuery),"undefined"==typeof READ_CMT_ENABLED_SERVICES&&(READ_CMT_ENABLED_SERVICES="zw"),function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var s=t||0,i=this.length;i>s;s++)if(this[s]===e)return s;return-1})}(),ZDSHAREDIALOG.highlightNameorEmailId=function(e,t,s){var i=ZDUtils.getLastNameOfContact(e);return e.toLowerCase().substring(0,s.length)==s.toLowerCase()?"firstName":i.toLowerCase().substring(0,s.length)==s.toLowerCase()?"lastName":t.toLowerCase().substring(0,s.length)==s.toLowerCase()?"mailId":void 0},ZDSHAREDIALOG.updateDefaultText=function(e,t){var s=ZD(e),i=G_OF_OBJ.defaultText,a=s.attr("id");if("blur"==t.type&&"zd_sharetextarea"==a&&""==s.val().trim()&&s.addClass("graytxt").val(G_OF_OBJ.defaultText),"click"==t.type||"focus"==t.type){var a=ZD(e).attr("id");"notify_checkbox"==a?ZDSHAREDIALOG.showHideMsg(e):"zd_checkbox_add"==a?ZDSHAREDIALOG.showHideShareMsg(e):"zd_initial_sharetextarea"==a?(ZDSHAREDIALOG.constructShareInterface(G_COMP_OBJ.isMultiShare?"zd_container_div":"listing_container"),ZD("#zd_initial_part").remove(),ZD("#zd_sharetextarea").removeClass("graytxt").focus(),ZD("#zdc_visible_default_hidediv").addClass("hidediv"),"FB"==zd_third_party&&ZD("#shareMsgDiv,#button_share_container,.notify_msg_container_div").css("margin-left",32)):"zd_sharetextarea"==a&&(ZD("#zdc_visible_default_hidediv").addClass("hidediv"),(""==s.val()||void 0==s.val()||s.val()==i)&&(s.val(""),s.removeClass("graytxt"),ZD("#zd_sharetextarea").focus()))}return!1},ZDSHAREDIALOG.constructDefaultShareView=function(){var e=G_OF_OBJ.defaultText;ZD("#zd_initial_part").remove();var t,s='<div class="specific-block" id="zd_initial_part"><input type="text" style="width:99%;" class="inputtext createinput graytxt" value="'+e+'" id="zd_initial_sharetextarea" width="90%"></div>';if(G_COMP_OBJ.isMultiShare){t="zd_container_div",ZD("#radiooptions_container").length&&ZD("#radiooptions_container").remove();var i='<div id="radiooptions_container" style="margin-bottom:15px;"> <span style="margin-right:30px;" class="multi_share_members" onClick = "ZDSHAREDIALOG.showHideMultiShareOptions(this);"><input type="radio" id="multi_share_members" name= "multi_share_option" checked="true"/> <label for="multi_share_members"><span>'+zd_js_obj.add_collaborators+'</span></label></span> <span class="multi_set_visibility" style="display:none;" onClick = "ZDSHAREDIALOG.showHideMultiShareOptions(this);"><input type="radio" id= "multi_set_visibility" name= "multi_share_option"/> <label for="multi_set_visibility"><span>'+zd_js_obj.label_visibility+"</span></label></span> </div>";ZD("#"+t).append(i),G_OF_OBJ.isVisibility&&ZD(".multi_set_visibility").show();var a='<div id="multi_visiblity_container"></div>',o='<div id="multidoc_visibility_details" class="hidediv zdc-sharedetail"></div>',n='<textarea id="zd_linklists" class="hidediv" ></textarea>';ZD("#radiooptions_container").after(a),ZD("#radiooptions_container").after(s),ZD("#zd_initial_sharetextarea").focus(function(e){ZDSHAREDIALOG.updateDefaultText(this,e)}),ZD("#multi_visiblity_container").before(o),ZD("#multi_visiblity_container").before(n)}else t="listing_container",ZD("#"+t).prepend(s),ZD("#zd_initial_sharetextarea").focus(function(e){ZDSHAREDIALOG.updateDefaultText(this,e)})},ZDSHAREDIALOG.showHideMultiShareOptions=function(e){var t=ZD(e);t.hasClass("multi_share_members")?(ZD(".specific-block").removeClass("hidediv"),ZD("#multi_visiblity_container").addClass("hidediv")):(ZDSHAREDIALOG.toggleVisibleOptions(),ZD(".specific-block").addClass("hidediv"),ZD("#multi_visiblity_container").removeClass("hidediv"))},ZDSHAREDIALOG.constructShareInterface=function(e){var t='<div class="specific-block" id="zdshare_autocomplete"><div class="specific-invitediv"><div class="zd_add_div"><span style="margin:6px 0 0 0;" class="flleft">'+zd_js_obj.add+':&nbsp;&nbsp;</span></div><div class="flleft" style="width:72%;"><textarea  class="graytxt specific-textarea" value="" placeholder="'+G_OF_OBJ.defaultText+'" id="zd_sharetextarea"></textarea></div>';t+="zohoforms"===G_COMP_OBJ.serviceType?'<div id="zd_permission_oneshot" class="flright docscursor" permission="1"><div class="ui-widget ui-widget-content ui-zcombo ui-corner-all ui-focusable ui-zcombo-textonly" style="height: 18px; width: 111px; outline-width: 0px; outline-style: initial; outline-color: initial; " tabindex="0"><div class="ui-zcombo-dropdown ui-state-default ui-corner-right"><div class="ui-icon ui-components-icon ui-icon-triangle-1-s"></div></div><div class="ui-zcombo-select-item" style="width: 93px; "><span class="ui-zmenu-icon-layout"><span class="ui-icon ui-zmenu-icon-inner ui-zmenu-no-icon"></span></span><span class="ui-zmenu-text">'+zd_js_obj.read_only+"</span></div></div></div>":'<div id="zd_permission_oneshot" class="flright docscursor" data-menu-id="zd_leftmenu" popup="zd_leftmenu" permission="2"><div class="ui-widget ui-widget-content ui-zcombo ui-corner-all ui-focusable ui-zcombo-textonly" style="height: 18px; width: 111px; outline-width: 0px; outline-style: initial; outline-color: initial; " tabindex="0"><div class="ui-zcombo-dropdown ui-state-default ui-corner-right"><div class="ui-icon ui-components-icon ui-icon-triangle-1-s"></div></div><div class="ui-zcombo-select-item" style="width: 93px; "><span class="ui-zmenu-icon-layout"><span class="ui-icon ui-zmenu-icon-inner ui-zmenu-no-icon"></span></span><span class="ui-zmenu-text">'+zd_js_obj.read_write+"</span></div></div></div>",t+="</div>";var s='<div id="notifymsg_textarea_pnt"><div style="margin-left:0px;" class="notify_msg_container_div"><input type="checkbox" checked="true" id="notify_checkbox"><label for="notify_checkbox"><span>'+zd_js_obj.label_notify_through_email+'</span></label><span> - </span><span class="lightbluetxt docscursor checkbox_add"  id="zd_checkbox_add">'+zd_js_obj.label_add_message+'</span></div><div id="shareMsgDiv" class="hidediv" style="margin-left:0px;"><textarea value="" class="addmsg" max-len="2500"></textarea></div></div>',i='<div style="margin:10px 0 0 0px;" id="button_share_container"><button id="zd_share_button" type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only disabled"><span class="ui-button-text">'+zd_js_obj.share+"</span></button>&nbsp;";i+=G_COMP_OBJ.isMultiShare?'&nbsp;<button type="button" id="zd_close_button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+zd_js_obj.cancel+"</span></button></div></div>":'&nbsp;<button type="button" id="zd_cancel_button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">'+zd_js_obj.cancel+"</span></button></div></div>",t+=s+i,ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zdshare_autocomplete").remove(),G_COMP_OBJ.isMultiShare?(ZD("#"+e).append(t),ZD(".zd_add_div").addClass("hidediv")):(ZD("#"+e).prepend(t),"FB"!=zd_third_party?ZD(".zd_add_div").addClass("hidediv"):ZD(".specific-textarea").parent().css("width","66%"),G_COMP_OBJ.shareWithoutSpecificPermission&&(ZD("#zd_permission_oneshot").remove(),ZD("#zd_sharetextarea").width("453"))),ZD("#zd_sharetextarea").click(function(e){ZDSHAREDIALOG.updateDefaultText(this,e)}),ZD("#zd_sharetextarea").blur(function(e){ZDSHAREDIALOG.updateDefaultText(this,e)}),ZD("#notify_checkbox").click(function(e){ZDSHAREDIALOG.updateDefaultText(this,e)}),ZD("#zd_checkbox_add").click(function(e){ZDSHAREDIALOG.updateDefaultText(this,e)}),ZDSHAREDIALOG.initAutoComplete(docs_myContacts,!0)},ZDSHAREDIALOG.integWSShowShareForm=function(e,t,s,i,a,o,n){if(void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),void 0===zd_js_obj||""===zd_js_obj){var d=function(){ZDSHAREDIALOG.integWSShowShareForm(e,t,s,i,a,o)};return ZDUtils.getUserRelatedDetails(d,""),!1}var r=ZD("#zd_user_details").attr("isGroupShareEnabled");G_OF_OBJ.defaultText="true"!=r||s?zd_js_obj.label_enter_name_mailaddress:zd_js_obj.label_enter_name_mailaddress_group,G_OF_OBJ.urlInvoker=e,G_OF_OBJ.docId=t,G_OF_OBJ.folderIds=o,G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1,G_OF_OBJ.enableDirectSharinglone=n,G_OF_OBJ.docId&&(G_OF_OBJ.resIds=G_OF_OBJ.docId+","),G_OF_OBJ.folderIds&&(G_OF_OBJ.resIds+=G_OF_OBJ.folderIds+","),G_OF_OBJ.isCo_owner=s,G_OF_OBJ.updateShareStatus=!1,void 0!=a&&(G_OF_OBJ.isFolderShare=a),G_COMP_OBJ.isMultiShare="object"==typeof i?i.ismultishare:!1,"object"==typeof i&&i.isvisibility&&(G_OF_OBJ.isVisibility=!0),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),ZD("body").append('<div id="sharedialogdiv" style="display:none;">');var l=zd_js_obj.label_share_settings+'<span style="font-weight:normal;font-size:12px;">&nbsp;-&nbsp;'+i.doccount+"&nbsp;selected item(s)</span>";ZDDialog.showCommonDialog(l,!0,"sharedialogdiv",{},[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],600,!0,"auto",!1),ZDUtils.LoadingMsg(zd_js_obj.loading),ZD("#sharedialogdiv").sharesetting({actionsButton:{showAction:!1},isWSShare:n});var c=G_OF_OBJ.defaultText;return ZD("body").delegate(".docs-dialog,.ui-widget-overlay","click",function(e){var t=ZD(e.target);0===t.closest(".zdsharelistingpopupdetails").length&&ZD(".zdsharelistingpopupdetails").is(":visible")&&0==t.closest(".sc-advanced").length&&ZD(".zdsharelistingpopupdetails").remove(),0===t.closest("#zd-collab-filter").length&&ZD("#zd-collabfilter-listpopup").css("display","none"),1===t.closest(".all-collab").length&&(ZD(".sc-list").css("display","block"),ZD("#zd-collab-filter .selected-option").text("All Collaborators")),1===t.closest(".external-collab").length&&(ZD(".sc-list").css("display","none"),ZD(".sc-list.external-shared-list").css("display","block"),ZD("#zd-collab-filter .selected-option").text("External Contact with Encrypted Link"))}),ZD("#sharedialogdiv").delegate("#zd_share_button","click",function(){var e=ZD(this);return e.children("button").addClass("sharing-in-progress").find(".s-btn-label").text("Sharing"),ZDSHAREDIALOG.shareDocument(t,!0,c),!1}),ZD("#sharedialogdiv").delegate("#zd_cancel_button","click",function(){ZD(this);return ZDSHAREDIALOG.cancelShareDocument(),!1}),ZD("#sharedialogdiv").delegate("#zd_close_button","click",function(){return ZDDialog.closePopUp("sharedialogdiv"),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),!1}),"null"!=t&&""!=t&&void 0!=t?ZDSHAREDIALOG.getShareDetails(t):"null"!=o&&""!=o&&void 0!=o&&ZDSHAREDIALOG.getShareDetails(o),!1},ZDSHAREDIALOG.injectScript=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!1,document.getElementsByTagName("head")[0].appendChild(t)},ZDSHAREDIALOG.showSheetShareForm=function(e,t,s,i){window.$=ZD,ZDSHAREDIALOG.showShareForm(e,t,s,void 0,void 0,void 0,void 0,void 0,void 0,i)},ZDSHAREDIALOG.showShareForm=function(e,t,s,i,a,o,n,d,r,l,c){if(void 0===ZD_IS_NEW_UI_ENABLED||null===ZD_IS_NEW_UI_ENABLED||ZD_IS_NEW_UI_ENABLED===!1||"false"===ZD_IS_NEW_UI_ENABLED){if(void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),void 0===zd_js_obj||""===zd_js_obj){var _=function(){ZDSHAREDIALOG.showShareForm(e,t,s,i,a,o,n,d,r,l)};return ZDUtils.getUserRelatedDetails(_,""),!1}var p=ZD("#zd_user_details").attr("isGroupShareEnabled");if(G_COMP_OBJ.shareWithoutSpecificPermission=void 0!=n?n:!1,G_COMP_OBJ.hideOrgFindAccessOpt=void 0!=c?c:!1,G_COMP_OBJ.hidePwdSharing=void 0!=r?r:!1,G_COMP_OBJ.customUrl=d,G_OF_OBJ.defaultText="true"!=p||s?zd_js_obj.label_enter_name_mailaddress:zd_js_obj.label_enter_name_mailaddress_group,G_OF_OBJ.urlInvoker=e,G_OF_OBJ.docId=t,G_OF_OBJ.folderIds=o,G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1,G_OF_OBJ.docId&&(G_OF_OBJ.resIds=G_OF_OBJ.docId+","),G_OF_OBJ.folderIds&&(G_OF_OBJ.resIds+=G_OF_OBJ.folderIds+","),G_OF_OBJ.isCo_owner=s,G_OF_OBJ.updateShareStatus=!1,void 0!=a&&(G_OF_OBJ.isFolderShare=a),G_COMP_OBJ.isMultiShare="object"==typeof i?i.ismultishare:!1,"object"==typeof i&&i.isvisibility&&(G_OF_OBJ.isVisibility=!0),ZD("body").append('<div id="sharedialogdiv" style="display:none;position:relative;">'),ZD("body").append('<ul id="zd_leftmenu" style="display:none;"></ul>'),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),G_COMP_OBJ.isMultiShare){var u=zd_js_obj.label_share_settings+'<span style="font-weight:normal;font-size:12px;">&nbsp;-&nbsp;'+i.doccount+"&nbsp;selected item(s)</span>";ZDDialog.showCommonDialog(u,!0,"sharedialogdiv",{},[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],550,!0,"auto",!1)}else{if("zohodocs"===e&&""!==t){var m=ZD("#"+t).find(".editfile").hasClass("writericon_css")||ZD("#"+t).find(".editfile").hasClass("htmlicon_css")||ZD("#"+t).find(".editfile").hasClass("editwritericon_css"),v=ZD("#"+t).find(".editfile").hasClass("sheeticon_css")||ZD("#"+t).find(".editfile").hasClass("editsheeticon_css"),D=ZD("#"+t).find(".editfile").hasClass("showicon_css")||ZD("#"+t).find(".editfile").hasClass("editshowicon_css");G_COMP_OBJ.serviceview=m?"zw":v?"zohosheet":D?"zohoshow":""}else"zw"===e?G_COMP_OBJ.serviceview="zw":"zohosheet"===e?G_COMP_OBJ.serviceview="zohosheet":"zohoshow"===e&&(G_COMP_OBJ.serviceview="zohoshow");ZDDialog.showCommonDialog(zd_js_obj.label_share_settings,!0,"sharedialogdiv",{},[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],550,!0,"auto",!0,550,350)}if("zohosheet"===e){var h=parseInt(ZD(".docsdialog.ui-dialog").css("z-index"))-1;ZD(".ui-widget-overlay").css("z-index",h)}ZDUtils.LoadingMsg(zd_js_obj.loading),ZD("#sharedialogdiv").addClass("custommargin_lightgrey dottedborder");var f=ZD("#sharedialogdiv"),g='<div id="openloadingmsg"></div><div id="zd_container_div" class="container_lightgrey"></div>';f.html(g),"zohosheet"===e&&"function"==typeof l&&l();{var O=ZD("#zd_container_div");ZD("#zd_user_details").attr("isorguser")}G_COMP_OBJ.isMultiShare||(ZDSHAREDIALOG.constructDocumentVisibility(),ZDSHAREDIALOG.bindEventsForVisiblityActions());{var b=G_OF_OBJ.defaultText;ZD("#zd_user_details").attr("third_party")}if(G_COMP_OBJ.isMultiShare)ZD(".privateshare-list").css("border","0"),ZDSHAREDIALOG.constructDefaultShareView();else{var Z='<div id="listing_container" class="privateshare-both"><div class="privateshare-list"><table cellspacing="0" id="zd_notmembershared" cellpadding="0" style="width:100%; height: 100%" class="hidediv"> <tbody><tr> <td vertical-align="middle"> <div style="text-align:center;" id="nosharedmembers_div" class="graytxt">'+zd_js_obj.no_collaborators+'</div> </td> </tr></tbody></table> <table width="100%" cellspacing="0" cellpadding="0" border="0" class="PC_rowBorder" id="autofilllist"></table></div></div>',y='<div id="members_private_info">'+zd_js_obj.collaborators+":</div>";O.append(y),O.append(Z),ZDSHAREDIALOG.constructDefaultShareView(),ZD(".privateshare-list").css("border","0")}return ZDMenu.initMenu("left"),ZD("#sharedialogdiv").delegate("#zd_share_button","click",function(){ZD(this);return ZDSHAREDIALOG.shareDocument(t,!0,b),!1}),ZD("#sharedialogdiv").delegate("#zd_cancel_button","click",function(){ZD(this);return ZDSHAREDIALOG.cancelShareDocument(),!1}),ZD("#sharedialogdiv").delegate("#zd_close_button","click",function(){return ZDDialog.closePopUp("sharedialogdiv"),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),!1}),"null"!=t&&""!=t&&void 0!=t?ZDSHAREDIALOG.getShareDetails(t):"null"!=o&&""!=o&&void 0!=o&&ZDSHAREDIALOG.getShareDetails(o),!1}if($("#docscomponent").length)resId=t,selected_component="SHARE",$("#docs_placeholder").trigger("click");else{var w=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:w,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(s){ZD("#zd_user_details").remove(),ZD("body").append(s),ZD(s).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),selected_component="SHARE",resId=t,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),urlJson.jsStaticServer=ZD_JSStaticSever,$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),ZDSHAREDIALOG.injectScript(window.manifestJson?ZD_JSStaticSever+"/jsapps/team/dist/"+tp_vendor_js:ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),ZDSHAREDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),ZDSHAREDIALOG.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}},ZDSHAREDIALOG.constructDocumentVisibility=function(){var e=ZD("#zd_container_div"),t="";G_OF_OBJ.isFolderShare?t="undefined"==typeof G_FOLDERID||"sharedtomedocs"!==G_FOLDERID?'<div id="zd_top_menu" style="margin-bottom:15px;"><span class="flleft" style="padding-right:5px;" >'+zd_js_obj.label_visibility+':&nbsp;</span><span id="zdc_visible_changelink" class="docscursor"> <span id="zdc_visibility_text_top" class="ui-icon flleft docscursor" share_type="private" style="margin-top:-3px;"></span><span style="visibility:hidden;" class="docscursor zdcvisibility_downarrow"><img src="/docs/images/spacer.gif" class="chngeopt" style="margin-top:-2px;"/></span></span></div>':'<div id="zd_top_menu" style="margin-bottom:15px;"><span class="flleft" style="padding-right:5px;">'+zd_js_obj.label_visibility+':&nbsp;</span><span id="zdc_visible_changelink" class="docscursor"> <span id="zdc_visibility_text_top" class="ui-icon flleft docscursor" share_type="private" style="margin-top:-3px;"></span><span class="docscursor" style="visibility:hidden;"><img src="/docs/images/spacer.gif" class="chngeopt" style="margin-top:-2px;"/></span></span></div>':0==G_OF_OBJ.isCo_owner?t='<div id="zd_top_menu" style="margin-bottom:15px;"><span class="flleft" style="padding-right:5px;" >'+zd_js_obj.label_visibility+':&nbsp;</span><span id="zdc_visible_changelink" class="docscursor"> <span id="zdc_visibility_text_top" class="ui-icon flleft docscursor" share_type="private" style="margin-top:-3px;"></span><span style="visibility:hidden;" class="docscursor zdcvisibility_downarrow"><img src="/docs/images/spacer.gif" class="chngeopt" style="margin-top:-2px;"/></span></span></div>':1==G_OF_OBJ.isCo_owner&&(t='<div id="zd_top_menu" style="margin-bottom:15px;"><span class="flleft" style="padding-right:5px;">'+zd_js_obj.label_visibility+':&nbsp;</span><span id="zdc_visible_changelink" class="docscursor"> <span id="zdc_visibility_text_top" class="ui-icon flleft docscursor" share_type="private" style="margin-top:-3px;"></span><span class="docscursor" ><img src="/docs/images/spacer.gif" class="chngeopt" style="margin-top:-2px;"/></span></span></div>'),e.prepend(t)},ZDSHAREDIALOG.showSelectedVisibleOptions=function(e,t){var s=ZD(e);if(void 0!=t&&""!=t){ZD(t.target)}var i=s.closest("li"),a=i.attr("id"),o="";G_COMP_OBJ.isMultiShare||(o=ZD("#zdc_visibility_text_top").attr("share_type").trim()),"zd_pwddoc_visible"==i.attr("id")?ZD(".password_refdiv").removeClass("hidediv"):ZD(".zdc-extwrd").addClass("hidediv"),i.addClass("zdl-selection").siblings().removeClass("zdl-selection"),i.siblings().children(".visibility_permission_container").remove(),ZDSHAREDIALOG.addPermissionCombo(s),"crm"!==G_OF_OBJ.urlInvoker&&("FREE_PLAN_TYPE"==zdcomp_userType||""==zdcomp_userType&&void 0==zdcomp_userType||"undefined"==typeof zdcomp_userType)&&("zd_pwddoc_visible"==i.attr("id")?ZD("#zdc_visible_share_button").addClass("disabled"):ZD("#zdc_visible_share_button").removeClass("disabled")),"zd_pwddoc_visible"==a||"zd_nosignin_visible"==a?(ZD(".exp_date_container_div").addClass("hidediv"),ZD("#"+a+" .exp_date_container_div").removeClass("hidediv"),"zd_pwddoc_visible"==a&&(ZD("#password_field,#show_text_field").focus(),ZD("#zd_pwddoc_visible .zdc-extwrd").removeClass("hidediv"))):"secureshare"!=o&&"everyone_internet"!=o&&(ZD(".exp_date_container_div").addClass("hidediv").find("input:checkbox").attr("checked",!1),ZD(".exp_date_container_div").addClass("hidediv").find("input:text").val(""))},ZDSHAREDIALOG.addPermissionCombo=function(e){if(e.children(".visibility_permission_container").length||"zd_anyone_link_visible"!=e.attr("id"))if(e.children(".visibility_permission_container").length||"zd_pwddoc_visible"!=e.attr("id")){if(!e.children(".visibility_permission_container").length&&"zd_nosignin_visible"==e.attr("id")){var t="1",s=zd_js_obj.read_only,i=ZD("#zdc_visibility_text_top").attr("everyone_internet_share_permission");if(null!==i&&"RW"===i&&(t="2",s=zd_js_obj.read_write),null!==i&&"RC"===i&&(t="4",s=zd_js_obj.label_read_comment),!G_COMP_OBJ.shareWithoutSpecificPermission)var a='<div style="margin-top: 10px;float: left;padding-left: 50px;"class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;" >'+zd_js_obj.whoever_accesses_can+':</div><div id="zdperm_visibility" style="margin-left:4px;float:left;" class="docscursor" data-menu-id="zd_leftmenu" popup="zd_leftmenu" permission="'+t+'"><div class="ui-widget ui-widget-content ui-zcombo ui-corner-all ui-focusable ui-zcombo-textonly" style="height: 18px; width: 111px; outline-width: 0px; outline-style: initial; outline-color: initial; " tabindex="0"><div class="ui-zcombo-dropdown ui-state-default ui-corner-right"><div class="ui-icon ui-components-icon ui-icon-triangle-1-s"></div></div><div class="ui-zcombo-select-item" style="width: 93px; "><span class="ui-zmenu-icon-layout"><span class="ui-icon ui-zmenu-icon-inner ui-zmenu-no-icon"></span></span><span class="ui-zmenu-text">'+s+"</span></div></div></div></div>";if(!G_COMP_OBJ.isMultiShare){var o=ZD("#zdc_visibility_text_top").attr("share_type").trim();"org_share"==o&&ZD("#everyone_org_find_access").attr("checked",!0)}}}else{var t="1",s=zd_js_obj.read_only,i=ZD("#zdc_visibility_text_top").attr("secureshare_share_permission");if(null!==i&&"RW"===i&&(t="2",s=zd_js_obj.read_write),null!==i&&"RC"===i&&(t="4",s=zd_js_obj.label_read_comment),!G_COMP_OBJ.shareWithoutSpecificPermission){var a='<div style="margin-top: 10px;float: left;padding-left: 50px;"class="visibility_permission_container"><div id="zdperm_visibility_text" style="line-height:25px;float:left;" >'+zd_js_obj.whoever_accesses_can+':</div><div id="zdperm_visibility" style="margin-left:4px;float:left;" class="docscursor" data-menu-id="zd_leftmenu" popup="zd_leftmenu" permission="'+t+'"><div class="ui-widget ui-widget-content ui-zcombo ui-corner-all ui-focusable ui-zcombo-textonly" style="height: 18px; width: 111px; outline-width: 0px; outline-style: initial; outline-color: initial; " tabindex="0"><div class="ui-zcombo-dropdown ui-state-default ui-corner-right"><div class="ui-icon ui-components-icon ui-icon-triangle-1-s"></div></div><div class="ui-zcombo-select-item" style="width: 93px; "><span class="ui-zmenu-icon-layout"><span class="ui-icon ui-zmenu-icon-inner ui-zmenu-no-icon"></span></span><span class="ui-zmenu-text">'+s+"</span></div></div></div></div>";ZD(e).append(a)}if(!G_COMP_OBJ.isMultiShare){var o=ZD("#zdc_visibility_text_top").attr("share_type").trim();"org_share"==o&&ZD("#everyone_org_find_access").attr("checked",!0)}(G_OF_OBJ.isFolderShare||!("zw"==G_COMP_OBJ.serviceType||ZD_GUEST_EDIT_SHEET&&"zohosheet"===G_COMP_OBJ.serviceType||ZD_GUEST_EDIT_SHOW&&"zohoshow"===G_COMP_OBJ.serviceType))&&"zw"!==G_OF_OBJ.urlInvoker&&(ZD("#zdperm_visibility_text").hide(),ZD("#zdperm_visibility").hide())}else{var t="1",s=zd_js_obj.read_only,i=ZD("#zdc_visibility_text_top").attr("share_permission");null!==i&&"RW"===i&&(t="2",s=zd_js_obj.read_write),null!==i&&"RC"===i&&(t="4",s=zd_js_obj.label_read_comment);var a='<div style="margin-top: 10px;float: left;padding-left: 50px;"class="visibility_permission_container">';if(G_COMP_OBJ.hideOrgFindAccessOpt||(a+='<div><input style="margin:0 5px 0 0;" type="checkbox" id="everyone_org_find_access"><label for="everyone_org_find_access"><span style="line-height:25px;">'+zd_js_obj.allow_everyone_find_access+"</span></label></div>"),G_COMP_OBJ.shareWithoutSpecificPermission||(a+='<div id="zdperm_visibility_text" style="line-height:25px;float:left;margin-top:8px;" >'+zd_js_obj.whoever_accesses_can+':</div><div id="zdperm_visibility" style="margin-left:4px;float:left;" class="docscursor" data-menu-id="zd_leftmenu" popup="zd_leftmenu" permission="'+t+'"><div class="ui-widget ui-widget-content ui-zcombo ui-corner-all ui-focusable ui-zcombo-textonly" style="height: 18px; width: 111px; outline-width: 0px; outline-style: initial; outline-color: initial; " tabindex="0"><div class="ui-zcombo-dropdown ui-state-default ui-corner-right"><div class="ui-icon ui-components-icon ui-icon-triangle-1-s"></div></div><div class="ui-zcombo-select-item" style="width: 93px; "><span class="ui-zmenu-icon-layout"><span class="ui-icon ui-zmenu-icon-inner ui-zmenu-no-icon"></span></span><span class="ui-zmenu-text">'+s+"</span></div></div></div>"),a+="</div>",ZD(e).append(a),!G_COMP_OBJ.isMultiShare){var o=ZD("#zdc_visibility_text_top").attr("share_type").trim();"org_share"==o&&ZD("#everyone_org_find_access").attr("checked",!0)}(G_OF_OBJ.isFolderShare||"zohoforms"===G_COMP_OBJ.serviceType)&&(ZD("#zdperm_visibility_text").hide(),ZD("#zdperm_visibility").hide())}},ZDSHAREDIALOG.toggleVisibleOptions=function(){if(!G_COMP_OBJ.isMultiShare)var e=ZD("#zd_top_menu").children("span:first"),t=ZD("#zdc_visible_changelink"),s=ZD(t).position(),i=s.left,a=ZD(e).offset(),o=a.left,n=a.top;var d="";if(!ZD("#zdc_visible_default_hidediv").length&&!ZD(".zd_visiblity_list_container").length){if(!G_COMP_OBJ.isMultiShare)if("zohosheet"===G_COMP_OBJ.serviceview){var r=parseInt(ZD(".docsdialog.ui-dialog").css("z-index"))+1;d='<div id="zdc_visible_default_hidediv" style="position:absolute;z-index:'+r+' !important" class="ui-widget ui-widget-content ui-widget-shadow-new ui-corner-all ui-zmenu-icontext ui-focusable" ><form name="visible_form"><img class="zdc-chngtop" src="/docs/images/spacer.gif" id="zdc_pointer_position"/>'}else d='<div id="zdc_visible_default_hidediv" style="position:absolute;" class="ui-widget ui-widget-content ui-widget-shadow-new ui-corner-all ui-zmenu-icontext ui-focusable" ><form name="visible_form"><img class="zdc-chngtop" src="/docs/images/spacer.gif" id="zdc_pointer_position"/>';var l=zd_js_obj.collaboratots_only;if("zohoforms"==G_OF_OBJ.urlInvoker&&(l=zd_js_obj.label_selected_recipients_only),d+='<ul id="visibilityoptions_top" class="zd_visiblity_list_container"><li class="zdl-menu zdl-brdtp" id="zd_private_visible" visible_type="private"><span class="zdl-icon"><span class="ui-icon zdc-specific"></span></span><span class="zdl-text">'+l+'</span><span class="zdl-shortcut">'+zd_js_obj.label_private_info+'.</span><span class="ui-zmenu-item-placeholder"></span></li>',1==zd_isorguser){var c=zd_js_obj.label_everyone_org;if(orgnameofcurrentuser.length){var _=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var _=orgnameofcurrentuser.substring(0,40);c=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(_))}d+='<li class="zdl-menu" id="zd_anyone_link_visible" visible_type="anyone_link"><span class="zdl-icon"><span class="ui-icon zdc-anyoneshare"></span></span><span class="zdl-text">'+c+'</span><span class="zdl-shortcut">'+zd_js_obj.label_anyone_link_info+'.</span><span class="ui-zmenu-item-placeholder"></span></li>',(1==userCanShareExternally||"true"==userCanShareExternally)&&(d+=ZDSHAREDIALOG.constructPublicVisibilityOptions())}else d+=ZDSHAREDIALOG.constructPublicVisibilityOptions();d+='</ul><div id="zdc_visible_button_container" style="margin:20px;overflow:hidden; clear:both;float:right;" class="zdc_buttoncontainer"><button style="margin-right:5px;" aria-disabled="false" role="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" type="button" id="zdc_visible_share_button"><span class="ui-button-text">'+zd_js_obj.save+'</span></button><button aria-disabled="false" role="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" id="zdc_visible_cancel_button" type="button"><span class="ui-button-text">'+zd_js_obj.cancel+"</span></button></div>",G_COMP_OBJ.isMultiShare?(ZD(d).appendTo("#multi_visiblity_container"),ZD("#zd_private_visible").addClass("zdl-selection")):(d+="</form></div>",ZD(d).appendTo("body")),ZD("#zdc_visible_share_button").click(function(){ZDSHAREDIALOG.changeVisibleOptions(!0)}),ZD("#zdc_visible_cancel_button").click(function(){ZDSHAREDIALOG.cancelVisiblityAction()});var p=parseInt(ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-sharedialogdiv"]').css("z-index"));ZD("#zdc_visible_default_hidediv").css({"z-index":p+5}),ZD("#zdpublic_datepicker,#zdpwd_datepicker").datepicker({minDate:1}),ZD("#zdc_visible_default_hidediv").delegate("#password_field,#show_text_field","keyup",function(e){var t=e.keyCode||e.which;return 13==t?(ZDSHAREDIALOG.changeVisibleOptions(!0),!1):void 0}),ZD("#zdc_visible_default_hidediv,#multi_visiblity_container").delegate("#zd_private_visible,#zd_anyone_link_visible,#zd_orgshare_visible,#zd_nosignin_visible,#zd_pwddoc_visible","click",function(e){var t=(e.keyCode||e.which,ZD(e.target));"share_extworld"==t.attr("id")?t.attr("checked")?(ZD(".password_refdiv").removeClass("hidediv"),ZD("#password_field").focus()):ZD(".password_refdiv").addClass("hidediv"):"pwd_text_field"==t.attr("id")?ZD("#password_field").is(":visible")?(ZD("#password_field").addClass("hidediv"),ZD("#show_text_field").removeClass("hidediv").focus(),ZD(".pwd_text_field").text(zd_js_obj.label_hide_password),ZD("#show_text_field").val(ZD("#password_field").val().trim())):(ZD("#password_field").val(ZD("#show_text_field").val().trim()),ZD("#password_field").removeClass("hidediv").focus(),ZD("#show_text_field").addClass("hidediv"),ZD(".pwd_text_field").text(zd_js_obj.label_show_password)):t.closest(".zdpublic_setexpirylabel").length?ZD("#set_expir_date_public_web").is(":checked")?ZD(".datepicker_public").removeClass("hidediv"):ZD(".datepicker_public").addClass("hidediv"):t.closest(".zdpwd_setexpirylabel").length&&(ZD("#set_expir_date_pwd").is(":checked")?ZD(".datepicker_pwd").removeClass("hidediv"):ZD(".datepicker_pwd").addClass("hidediv")),ZDSHAREDIALOG.showSelectedVisibleOptions(this,e)})}if(G_COMP_OBJ.isMultiShare)ZD("#zdc_visible_button_container").css("margin-right",1);else{ZD("#zdc_pointer_position").css({top:-15,left:i-5}),ZD("#zdc_visible_default_hidediv").css({top:n+26,left:o});var u=ZD("#zdc_visibility_text_top").attr("share_type").trim()}if("anyone_link"==u||"org_share"==u){var e=ZD("#zd_anyone_link_visible");ZDSHAREDIALOG.showSelectedVisibleOptions(e),ZD("#password_field,#show_text_field").val("")}else if("everyone_internet"==u){var e=ZD("#zd_nosignin_visible");ZDSHAREDIALOG.showSelectedVisibleOptions(e),ZD("#password_field,#show_text_field").val(""),""!=public_PwdExpiryDate&&void 0!=public_PwdExpiryDate&&(ZD("#set_expir_date_pwd").attr("checked",!1),ZD(".datepicker_pwd").addClass("hidediv").children("input").val(""),ZD("#set_expir_date_public_web").attr("checked",!0),ZD(".datepicker_public").removeClass("hidediv").children("input").val(public_PwdExpiryDate))}else if("secureshare"==u){var e=ZD("#zd_pwddoc_visible");ZDSHAREDIALOG.showSelectedVisibleOptions(e);var m="";G_OF_OBJ.docId&&(m=G_OF_OBJ.docId),G_OF_OBJ.folderIds&&(m=G_OF_OBJ.folderIds),ZD("#share_extworld").attr("checked",!0);var v="pwdshare",D=serviceUrl+"/api/v2/files/share";params="type=showpassword&resids="+m,params+="&sharetype="+v,params+="&"+zdcsrfPair,ZD("#password_field,#show_text_field").val(""),ZD.ajax({url:D,data:params,dataType:"json",type:"POST",success:function(e){"SUCCESS"===e.STATUS_MESSAGE&&ZD("#password_field,#show_text_field").val(e.RESPONSE.PASSWORD)}}),""!=public_PwdExpiryDate&&void 0!=public_PwdExpiryDate&&(ZD("#set_expir_date_public_web").attr("checked",!1),ZD(".datepicker_public").addClass("hidediv").children("input").val(""),ZD("#set_expir_date_pwd").attr("checked",!0),ZD(".datepicker_pwd").removeClass("hidediv").children("input").val(public_PwdExpiryDate))}else if("private"==u){var e=ZD("#zd_private_visible");ZDSHAREDIALOG.showSelectedVisibleOptions(e),ZD("#password_field,#show_text_field").val("")}},ZDSHAREDIALOG.constructPublicVisibilityOptions=function(){var e=zd_js_obj.label_expiry_date_help_info,t="";return G_COMP_OBJ.hidePwdSharing||(t+='<li class="zdl-menu zdl-brdtp" id="zd_pwddoc_visible" visible_type="pwddoc"><span class="zdl-icon"><span class="ui-icon zdc-anyonepasswrd"></span></span><span class="zdl-text">'+zd_js_obj.public_web_password_protect+'</span><span class="zdl-shortcut">'+zd_js_obj.anyone_the_link_password_can_access+'.</span><span class="ui-zmenu-item-placeholder"></span><div class="zdc-extwrd hidediv"><div style="margin-bottom:5px;margin-top:5px;">',t+="crm"===G_OF_OBJ.urlInvoker||"FREE_PLAN_TYPE"!=zdcomp_userType&&""!=zdcomp_userType&&void 0!=zdcomp_userType&&"undefined"!=typeof zdcomp_userType?'<div style="margin:0 0 10px 20px;" class="hidediv password_refdiv">'+zd_js_obj.label_password+':&nbsp;<input type="password" id="password_field" value="" autocomplete="off" class="graytxt"><input type="text" id="show_text_field" value=""  class="graytxt hidediv"><span class="pad-lft docscursor pwd_text_field" id="pwd_text_field" style="text-decoration:underline;">'+zd_js_obj.label_show_password+'</span></div><div class="graytxt smallText" style="margin-left:83px;display:block;margin-top:-8px;">'+zd_js_obj.label_musthave_sixcharacters+'</div><div style="margin:0 0 0 20px;" class="graytxt smallText hidediv password_refdiv">'+zd_js_obj.label_share_password_manually+'</div></div><div class="exp_date_container_div hidediv" style="margin-top:10px;float:left;padding-left: 50px;"><div style="margin-bottom:5px;"><span class="zdpwd_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expir_date_pwd"><label for="set_expir_date_pwd"><span>'+zd_js_obj.set_expiry_date+'</span></label><img src="/docs/images/spacer.gif" class="zdc-help" style="margin-left:4px;margin-bottom:-3px;"  title="'+e+'"></span><p class="datepicker_pwd hidediv">'+zd_js_obj.expires_on+': <input type="text" id="zdpwd_datepicker"readonly=true/></p></div></div></li>':"<span>"+zd_js_obj.label_password_protect+'.</span>&nbsp;&nbsp;<span class="docscursor smallText zdc-upgrade" onClick="ZDSHAREDIALOG.showUpgradePage();">'+zd_js_obj.upgrade+"</span></div></li>"),t+='<li class="zdl-menu zdl-brdtp" id="zd_nosignin_visible" visible_type="everyone_internet"><span class="zdl-icon"><span class="ui-icon zdc-anyoneinternet"></span></span><span class="zdl-text">'+zd_js_obj.public_web+'</span><span class="zdl-shortcut">'+zd_js_obj.label_anyone_access+" "+zd_js_obj.label_no_signin+'</span><span class="ui-zmenu-item-placeholder"></span>',t+="crm"===G_OF_OBJ.urlInvoker||"FREE_PLAN_TYPE"!=zdcomp_userType&&""!=zdcomp_userType&&void 0!=zdcomp_userType&&"undefined"!=typeof zdcomp_userType?'<div class="exp_date_container_div zdc-extwrd hidediv" style="margin-top:10px;float:left;padding-left: 50px;"><div style="margin-bottom:5px;"><span class="zdpublic_setexpirylabel"><input style="margin:0 5px 0 0;" type="checkbox" id="set_expir_date_public_web"><label for="set_expir_date_public_web"><span>'+zd_js_obj.set_expiry_date+'</span></label><img src="/docs/images/spacer.gif" class="zdc-help" style="margin-left:4px;margin-bottom:-3px;"  title="'+e+'"></span><p class="datepicker_public hidediv">'+zd_js_obj.expires_on+': <input type="text" id="zdpublic_datepicker" readonly=true/></p></div></div></li>':'<div class="zdc_public_upgrade exp_date_container_div hidediv"><div style="margin-bottom:5px;margin-top:5px;"><span>'+zd_js_obj.set_expiry_date+'.</span>&nbsp;&nbsp;<span class="docscursor smallText zdc-upgrade" onClick="ZDSHAREDIALOG.showUpgradePage();">'+zd_js_obj.upgrade+"</span></div></div></li>"},ZDSHAREDIALOG.showHideDatePicker=function(e){var t=ZD(e),s=t.children("input:checkbox").is(":checked");s?t.next("p").removeClass("hidediv"):t.next("p").addClass("hidediv")},ZDSHAREDIALOG.showUpgradePage=function(){var e=pcUrl+"/ccinfo.do?method=planchange&selectedplan=premium";return window.open(e),!1},ZDSHAREDIALOG.bindEventsForVisiblityActions=function(){ZD("#sharedialogdiv").delegate(".docsdialog, .linkURL","click",function(){ZD(this).select()}),ZD("body").delegate("#sharedialogdiv, #zdc_visible_default_hidediv, .ui-widget-overlay","click",function(e){var t=ZD(e.target);!ZD("#zdc_visible_default_hidediv").is(":visible")||ZD(".password_refdiv").is(":visible")&&!t.closest("#zdc_visible_cancel_button").length?t.closest("#zdc_visible_changelink").length&&(ZDSHAREDIALOG.toggleVisibleOptions(),ZD("#zdc_visible_default_hidediv").removeClass("hidediv")):(ZD(".password_refdiv").is(":visible")&&ZD("#password_field,#show_text_field").val(""),(!t.closest("#zdc_visible_default_hidediv").length&&!ZD(".datepicker_pwd").is(":visible")&&!ZD(".datepicker_public").is(":visible")||t.closest("#zdc_visible_cancel_button").length)&&ZD("#zdc_visible_default_hidediv").addClass("hidediv"))})},ZDSHAREDIALOG.changeVisibleOptions=function(e){var t=ZD("#visibilityoptions_top").find("li.zdl-selection"),s=t.attr("visible_type");"everyone_internet"==s&&ZD("#share_extworld").attr("checked")&&(s="secureshare");var i="",a="";if(G_COMP_OBJ.isMultiShare){if(void 0!=typeof DocsFileChooserHandler)G_OF_OBJ.docId&&(i=G_OF_OBJ.docId+","),G_OF_OBJ.folderIds&&(i+=G_OF_OBJ.folderIds);else if(i=ZDUtils.getSelectedDocumentIds(),""==i||void 0==i)return!1}else a=ZD("#zdc_visibility_text_top").attr("share_type"),G_OF_OBJ.docId&&(i=G_OF_OBJ.docId+","),G_OF_OBJ.folderIds&&(i+=G_OF_OBJ.folderIds);if("private"==s){if(G_COMP_OBJ.isMultiShare)return ZDSHAREDIALOG.restrictAccessForDocument(i,a),ZDSHAREDIALOG.removeOrgPublic(i,a),ZDDialog.closePopUp("sharedialogdiv"),Dialog.feedStatusAlert(zd_js_obj.visibility_changed_successfully,"info"),!1;var o=ZD("#zdc_visibility_text_top").attr("share_type");ZDSHAREDIALOG.toggleVisibleOptions(),"anyone_link"==o||"everyone_internet"==o||"secureshare"==o?ZDSHAREDIALOG.restrictAccessForDocument(i,a):"org_share"==o&&ZDSHAREDIALOG.removeOrgPublic(i,a)}else if("anyone_link"==s||"everyone_org"==s){var n=ZD("#everyone_org_find_access").is(":checked"),d=ZD("#zdperm_visibility").attr("permission")||1;e||ZDSHAREDIALOG.toggleVisibleOptions(),n?ZDSHAREDIALOG.shareToOrg(i,G_OF_OBJ.urlInvoker,d,a):ZDSHAREDIALOG.shareviaLink(i,G_OF_OBJ.urlInvoker,d,a)}else if("secureshare"==s||"pwddoc"==s){if(ZD("#zd_pwddoc_visible .zdc-upgrade").length)return ZDSHAREDIALOG.showUpgradePopup(zd_js_obj.upgrade,"This feature is available only with our Premium and Standard plans. Please upgrade your account."),!1;e||ZDSHAREDIALOG.toggleVisibleOptions();var r="",l="",d=ZD("#zdperm_visibility").attr("permission");if(void 0===d&&(d=1),ZD(".password_refdiv").is(":visible")){r=ZD("#password_field").is(":visible")?ZD("#password_field").val().trim():ZD("#show_text_field").val().trim();var c=ZDSHAREDIALOG.validatePassword(r);if("success"!=c)return alert(c),ZD("#password_field,#show_text_field").blur(),!1}ZD("#zdpwd_datepicker").is(":visible")&&ZD("#set_expir_date_pwd").is(":checked")&&(l=ZD("#zdpwd_datepicker").val()),ZDSHAREDIALOG.createPublicLink(i,G_OF_OBJ.urlInvoker,d,r,"",l)}else if("everyone_internet"==s){var l="",d=ZD("#zdperm_visibility").attr("permission");void 0===d&&(d=1),e||ZDSHAREDIALOG.toggleVisibleOptions(),ZD("#zdpublic_datepicker").is(":visible")&&ZD("#set_expir_date_public_web").is(":checked")&&(l=ZD("#zdpublic_datepicker").val()),ZDSHAREDIALOG.createPublicLink(i,G_OF_OBJ.urlInvoker,d,"",a,l)}G_COMP_OBJ.isMultiShare||ZD("#zdc_visible_default_hidediv").addClass("hidediv")},ZDSHAREDIALOG.makeUniqueList=function(e){for(var t=0;t<e.length;t++){for(var s=e[t],i=s.user_id,a=s.groupID,o=!1,n=0;n<docs_myContacts.length;n++){var d=docs_myContacts[n].user_id,r=docs_myContacts[n].groupID;("undefined"!=typeof i&&i===d||"undefined"!=typeof a&&a===r)&&(o=!0)}o||docs_myContacts.push(s)}},ZDSHAREDIALOG.initAutoComplete=function(e,t){if(zd_isIE&&ZD("#zd_share_button").removeClass("disabled"),null!=e){var s=ZD("#zd_sharetextarea");G_OF_OBJ.G_zdc_permissionType=ZD("#zd_permission_oneshot").attr("permission")||1;var i=!1;ZD("#attach_message").remove(),ZD("#listing_container").prepend('<div class="attach_message" id="attach_message" style="display: none;margin-top: 0px;z-index:10010"><span id="zd_statusmsgdiv"></span></div>'),s.unbind().bind("keyup paste",function(e){var t=s.val();""==t||void 0==t?ZD("#zd_share_button").addClass("disabled"):ZD("#zd_share_button").removeClass("disabled");e.type;if(i===!0)return void(i=!1);G_OF_OBJ.autocomplete_selectValue=t;var a=G_OF_OBJ.autocomplete_selectValue[G_OF_OBJ.autocomplete_selectValue.length-1];if(void 0!==e.type&&"paste"===e.type){i=!0;{e.originalEvent.clipboardData.getData("Text").split(",")}}if(8!==e.which&&46!==e.which&&" "===a&&","!==G_OF_OBJ.autocomplete_selectValue[G_OF_OBJ.autocomplete_selectValue.length-2]){var o=G_OF_OBJ.autocomplete_selectValue.split(","),n=o[o.length-1];ZD.trim(n).match(/^[+a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/)&&(G_OF_OBJ.autocomplete_selectValue=ZD.trim(G_OF_OBJ.autocomplete_selectValue),G_OF_OBJ.autocomplete_selectValue+=","),ZD("#zd_sharetextarea").val(G_OF_OBJ.autocomplete_selectValue)}});var a,o,n,d=25;s.autocomplete({minLength:1,autoFocus:!0,source:function(i,r){var l=s.val().trim().lastIndexOf(","),c=s.val().trim().substring(l+1,s.val().trim().length);if(a=i.term.split(","),o=ZD.trim(a[a.length-1]),0!=i.term.length&&c.length){if("undefined"!=typeof ZD_G_ContactSearchEnabled&&ZD_G_ContactSearchEnabled){var _="/docs/docsrequest.do?method=getContactsViaSearch",p="_t="+ZD.now()+"&sqry="+o,u=[],m=ZD.grep(docs_myContacts,function(e){var s=void 0!=e.groupID&&""!=e.groupID?!0:!1;if(s&&!t)return!1;var i=ZDUtils.startsWithRegEx(e,o);return i});if(m.length>10){for(var v=0;10>v;v++)u.push(m[v]);r(u)}else m.length>0?(u=m,r(u)):(this.close(),ZD.ajax({url:_,data:p,dataType:"json",type:"GET",success:function(e){var s=e.contact_list;if(s.length){ZDSHAREDIALOG.makeUniqueList(s);var i=ZD.grep(docs_myContacts,function(e){var s=void 0!=e.groupID&&""!=e.groupID?!0:!1;if(s&&!t)return!1;var i=ZDUtils.startsWithRegEx(e,o);return i});if(i.length>10)for(var a=0;10>a;a++)u.push(i[a]);else u=i;"zohoshow"===G_OF_OBJ.urlInvoker?ZD("#zd_sharetextarea").autocomplete("search",o):r(u)}}}))}else{n=jQuery.grep(e,function(e){var s=void 0!=e.groupID&&""!=e.groupID?!0:!1;if(s&&!t)return!1;var i=ZDUtils.startsWithRegEx(e,o);return i});var D=[];if(n.length>10){for(d=250,v=0;10>v;v++)D.push(n[v]);r(D)}else d=25*n.length,r(n)}if(void 0!=ZD(".zdc_shareautocompletedialog").data("menu")&&"undefined"!=ZD(".zdc_shareautocompletedialog").data("menu")){var h=ZD(".zdc_shareautocompletedialog").data("menu").active,f=ZD(".zdc_shareautocompletedialog").data("menu").move;void 0!=h&&void 0!==h&&"undefined"!=h&&"undefined"!==h||!f||ZD(".zdc_shareautocompletedialog").menu("move","next",".ui-menu-item:first")}}},select:function(e,t){if(ZD(".zdc_shareautocompletedialog").length>0){if(G_OF_OBJ.autocomplete_selectValue=ZD.trim(G_OF_OBJ.autocomplete_selectValue),G_OF_OBJ.autocomplete_selectValue=G_OF_OBJ.autocomplete_selectValue.replace(new RegExp(o+"$"),""),void 0!=t.item.groupID){t.item.isOrg?G_OF_OBJ.trimmedOrgGroupIds+=t.item.groupID+",":G_OF_OBJ.trimmedPerGroupIds+=t.item.groupID+",";var i=t.item.fullname.trim();i=i.replace(/,/g,""),G_OF_OBJ.groupNameAndIdList.push(encodeURIComponent(i)+":"+t.item.groupID+":"+t.item.isOrg),G_OF_OBJ.groupNameList.push(encodeURIComponent(i)),G_OF_OBJ.autocomplete_selectValue+=" "+i+" ,"}else{var a=t.item.fullname.trim();a=a.replace(/,/g,""),G_OF_OBJ.autocomplete_selectValue+=a+" <"+t.item.email_id.trim()+">, "}if(setTimeout(function(){s.val(G_OF_OBJ.autocomplete_selectValue),s.scrollTop(s[0].scrollHeight-s.height())},10),"shareuser_icon"==t.item.icon||"zdc-shareuser_icon"==t.item.icon){var n=t.item.email_id;void 0!=n&&""!=n&&G_OF_OBJ.G_fromAutoComplete.push(n)}}return!1},focus:function(){return!1}}).data("autocomplete")._renderItem=function(e,t){ZD(e).addClass("zdc_shareautocompletedialog");var s=parseInt(ZD(".docsdialog").css("z-index")),i=ZD("#zd_sharetextarea").width();ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({height:d+"px !important",width:i+"px !important","z-index":s+5});var a,n;if("shareuser_icon"==t.icon||"zdc-shareuser_icon"==t.icon){t.icon="zdc-shareuser_icon";var r=t.fullname,l=ZDSHAREDIALOG.highlightNameorEmailId(t.fullname,t.email_id,o);if("firstName"==l){var c=r.substring(o.length,r.length),_=r.substring(0,o.length);n='<span style="font-weight:bold;">'+_+"</span>"+c+'&nbsp;<span class="graytxt"> &lt'+t.email_id+"&gt</span>"}else if("lastName"==l){var p=t.fullname.lastIndexOf(" "),_=r.substring(p+1,p+1+o.length),u=t.fullname.substring(0,p),m=r.substring(p+o.length+1,r.length);n=u+'&nbsp;<span style="font-weight:bold;">'+_+"</span>"+m+'<span class="graytxt"> &lt'+t.email_id+"&gt</span>"}else if("mailId"==l){var v=t.email_id.substring(o.length,t.email_id.length),_=t.email_id.substring(0,o.length);n=t.fullname+'&nbsp;<span class="graytxt"> &lt</span><span style="font-weight:bold;">'+_+'</span><span class="graytxt">'+v+"&gt</span>"}else n=t.fullname+'&nbsp;<span class="graytxt"> &lt'+t.email_id+"&gt</span>"}if("shareorggroup_icon"==t.icon||"sharegroup_icon"==t.icon||"zdc-shareorggroup_icon"==t.icon||"zdc-sharegroup_icon"==t.icon){a="showdiv",t.icon="shareorggroup_icon"==t.icon?"zdc-shareorggroup_icon":"zdc-sharegroup_icon";var r=t.fullname,D=void 0!==t.email_id?t.email_id:"",l=ZDSHAREDIALOG.highlightNameorEmailId(t.fullname,D,o);if("firstName"==l){var c=r.substring(o.length,r.length),_=r.substring(0,o.length);n='<span style="font-weight:bold;">'+_+"</span>"+c,""!==D&&(n+='&nbsp;<span class="graytxt"> &lt'+D+"&gt</span>")}else if("lastName"==l){var p=t.fullname.lastIndexOf(" "),_=r.substring(p+1,p+1+o.length),u=t.fullname.substring(0,p),m=r.substring(p+o.length+1,r.length);n=u+'&nbsp;<span style="font-weight:bold;">'+_+"</span>"+m,""!==D&&(n+='<span class="graytxt"> &lt'+D+"&gt</span>")}else if("mailId"==l&&""!==D){var v=t.email_id.substring(o.length,t.email_id.length),_=t.email_id.substring(0,o.length);n=t.fullname+'&nbsp;<span class="graytxt"> &lt</span><span style="font-weight:bold;">'+_+'</span><span class="graytxt">'+v+"&gt</span>"}else n=t.fullname,""!==D&&(n+='&nbsp;<span class="graytxt"> &lt'+D+"&gt</span>")}return ZD("<li></li>").data("item.autocomplete",t).append('<a style="white-space:nowrap;"><span class="zdc-autolisticon '+t.icon+'"></span><span class="'+a+'">'+n+"</span></a>").appendTo(e)}}},ZDSHAREDIALOG.statusmsg=function(e){ZD("span#zd_statusmsgdiv").html(e).parent().css("display","block"),ZD("div.attach_message").css("margin-top","0px"),setTimeout(function(){ZD("span#zd_statusmsgdiv").html("").parent().css("display","none")},4e3)},ZDSHAREDIALOG.showStatusmsg=function(e){ZD("span#zd_statusmsgdiv").html(e).parent().css("display","block"),ZD("div.attach_message").css("margin-top","0px"),setTimeout(function(){ZD("span#zd_statusmsgdiv").html("").parent().css("display","none"),ZD("#attach_message").remove(),ZD("#listing_container").prepend('<div class="attach_message" id="attach_message" style="display: none;margin-top: 0px;z-index:10010"><span id="zd_statusmsgdiv"></span></div>')},4e3)},ZDSHAREDIALOG.getShareDetails=function(e,t,s){if(!G_COMP_OBJ.isMultiShare){ZDUtils.LoadingMsg(zd_js_obj.loading);var i=serviceUrl+"/docs/docsrequest.do?method=getShareDetails",a="docId="+e+"&_t="+ZD.now();ZD.ajax({url:i,data:a,dataType:"json",type:"GET",success:function(t){ZDUtils.hideLoadingMsg(),ZDSHAREDIALOG.showShareDetails(t,e,G_OF_OBJ.urlInvoker,s)},error:function(){ZDUtils.hideLoadingMsg()}})}return!1},ZDSHAREDIALOG.getPlanType=function(e){var t=void 0==e?!0:e,s=serviceUrl+"/docs/docsrequest.do?method=getPlanType&_t="+zd.now();return ZD.ajax({async:t,url:s,dataType:"json",type:"GET",success:function(e){zdcomp_userType=e.response.result.PlanType.MESSAGE},error:function(){zdcomp_userType=""}}),!1},ZDSHAREDIALOG.showShareDetails=function(e,t,s,i){var a,o=ZD("#zd_user_details").attr("THIRD_PARTY");1==G_OF_OBJ.isCo_owner&&(a="hidediv");var n=ZD(".docsdialog #autofilllist");n.empty();var d,r,l=ZD("#members_private_info"),c=(ZD("#zdc_visibility_text_top"),e.per_read_only),_=e.per_write_only,p=e.per_readfill;void 0===G_COMP_OBJ.serviceview&&(G_COMP_OBJ.serviceview=""),void 0===G_COMP_OBJ.serviceType&&(G_COMP_OBJ.serviceType="upload"),void 0===G_OF_OBJ.urlInvoker&&(G_OF_OBJ.urlInvoker="zohodocs"),(G_OF_OBJ.urlInvoker.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceType.match(READ_CMT_ENABLED_SERVICES)||G_COMP_OBJ.serviceview.match(READ_CMT_ENABLED_SERVICES))&&(d=e.per_comment_only,r=e.email_comment_only);var u=e.per_coowner,m=e.per_group_readonly,v=e.per_group_writeonly,D=e.per_group_comment_only,h=e.orgshare,f=e.linkshare,g=e.everyone_internet,O=e.secureshare,b=e.email_read_only,Z=e.email_write_only,y=e.email_coowner,w="";if(ZD(".zdcvisibility_downarrow").css("visibility","visible"),ZD("#zd_container_div").is(":visible")){var z=!1;if(""!=f&&void 0!=f){ZD("#top_share_org,#everyone_internet").remove(),ZD("#top_share_via_link,#everyone_internet").remove();var A=f[0].permission,S=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:f[0].url;w=f[0].documentName,G_OF_OBJ.docName=w;var G=f[0].isFromParent;if(0==G_OF_OBJ.isCo_owner){var x='<div class="share_via_link" id="top_share_via_link"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+S+'" readonly="readonly"><div><a class="flright textUnderline" style="cursor:pointer;" id="zd_perma_link_url" >'+zd_js_obj.send_link_email+"</a></div></div></div>";l.before(x)}else if(1==G_OF_OBJ.isCo_owner){if("RW"==A)var x='<div class="share_via_link" id="top_share_via_link"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+S+'" readonly="readonly"><div><a class="flright textUnderline" style="cursor:pointer;" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";else var x='<div class="share_via_link" id="top_share_via_link"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+S+'" readonly="readonly"><div><a style="cursor:pointer;" class="flright textUnderline" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";l.before(x)}if(ZD("#zd_perma_link_url").click(function(){ZDSHAREDIALOG.triggerSendMailDialog(this)}),"AP"==o){var j="mailto:?body=I have shared the following document with you: "+S+"&subject="+w;ZD("#zd_perma_link_url").attr("href",j).removeAttr("onClick")}ZD(".anyonefieldset").children("div").addClass("margbtm"),ZDSHAREDIALOG.constructReadWriteIcon(A),ZD("#zdc_visibility_text_top").attr("share_type","anyone_link").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyoneshare"),ZD("#zdc_visible_changelink").attr("isFromParent",G),G&&(ZD("#zdc_visible_changelink").html('<span style="margin-top:-3px;" class="ui-icon flleft docscursor zdc-anyoneshare" ></span>'),ZD("#zdc_visible_changelink").hide(),ZD("#zd_top_menu").css({"margin-bottom":"24px"})),ZD("#zdc_visibility_text_top").attr("share_permission",A),z=!0}else if(void 0!=h&&""!=h){var I=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:h[0].url,A=h[0].permission;w=h[0].documentName,G_OF_OBJ.docName=w,ZD("#top_share_via_link,#everyone_internet").remove(),ZD("#top_share_org").remove();var G=h[0].isFromParent;if(0==G_OF_OBJ.isCo_owner){var C='<div class="top_share_org" id="top_share_org"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+I+'" readonly="readonly"><div><a style="cursor:pointer;" class="flright textUnderline" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";l.before(C)}else if(1==G_OF_OBJ.isCo_owner){if("RW"==A)var C='<div class="top_share_org" id="top_share_org"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+I+'" readonly="readonly"><div><a style="cursor:pointer;" class="flright textUnderline" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";else var C='<div class="top_share_org" id="top_share_org"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+I+'" readonly="readonly"><div><a style="cursor:pointer;" class="flright textUnderline" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";l.before(C)}if(ZD("#zd_perma_link_url").click(function(){ZDSHAREDIALOG.triggerSendMailDialog(this)}),"AP"==o){var j="mailto:?body=I have shared the following document with you: "+I+"&subject="+w;ZD("#zd_perma_link_url").attr("href",j).removeAttr("onClick")}ZD(".anyonefieldset").children("div").addClass("margbtm"),ZDSHAREDIALOG.constructReadWriteIcon(A),ZD("#zdc_visibility_text_top").attr("share_type","org_share").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyoneshare"),ZD("#zdc_visibility_text_top").attr("share_permission",A),ZD("#zdc_visible_changelink").attr("isFromParent",G),G&&(ZD("#zdc_visible_changelink").html('<span style="margin-top:-3px;" class="ui-icon flleft docscursor zdc-anyoneshare" ></span>'),ZD("#zdc_visible_changelink").hide(),ZD("#zd_top_menu").css({"margin-bottom":"24px"})),z=!0}else if(void 0!=g&&""!=g){var F=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:g[0].url,A=g[0].permission;w=g[0].documentName,G_OF_OBJ.docName=w;var G=g[0].isFromParent;public_PwdExpiryDate="undefined"!=typeof g[0].docExpiryDate?g[0].docExpiryDate:"",ZD("#top_share_via_link,#top_share_org").remove(),ZD("#everyone_internet").remove(),ZD("#zdc_visibility_text_top").attr("share_type","everyone_internet").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyoneinternet"),ZD("#zdc_visible_changelink").attr("isFromParent",G),G&&(ZD("#zdc_visible_changelink").hide(),ZD("#zd_top_menu").css({"margin-bottom":"24px"})),ZD("#zdc_visibility_text_top").attr("everyone_internet_share_permission",A),ZDSHAREDIALOG.showPublicLink(w,F),z=!0}else if(void 0!=O&&""!=O){var B=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:O[0].url,A=O[0].permission;w=O[0].documentName,G_OF_OBJ.docName=w;var G=O[0].isFromParent;public_PwdExpiryDate="undefined"!=typeof O[0].docExpiryDate?O[0].docExpiryDate:"",ZD("#top_share_via_link,#top_share_org").remove(),ZD("#everyone_internet").remove(),ZD("#zdc_visibility_text_top").attr("share_type","secureshare").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyonepasswrd"),ZD("#zdc_visible_changelink").attr("isFromParent",G),G&&(ZD("#zdc_visible_changelink").hide(),ZD("#zd_top_menu").css({"margin-bottom":"24px"})),ZDSHAREDIALOG.showPublicLink(w,B),ZD("#zdc_visibility_text_top").attr("secureshare_share_permission",A),z=!0}z||ZD("#zdc_visibility_text_top").attr("share_type","private").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-specific")}return void 0!=c&&""!=c&&ZDSHAREDIALOG.constructShareDetails(c,1,n,!1,zd_js_obj.read_only,i),void 0!=_&&""!=_&&ZDSHAREDIALOG.constructShareDetails(_,2,n,!1,zd_js_obj.read_write),void 0!=d&&""!=d&&ZDSHAREDIALOG.constructShareDetails(d,4,n,!1,zd_js_obj.label_read_comment),void 0!=u&&""!=u&&ZDSHAREDIALOG.constructShareDetails(u,3,n,!0,zd_js_obj.coowner,i),void 0!=b&&""!=b&&ZDSHAREDIALOG.constructEmailShareDetails(b,1,n,zd_js_obj.read_only,i),void 0!=Z&&""!=Z&&ZDSHAREDIALOG.constructEmailShareDetails(Z,2,n,zd_js_obj.read_write,i),void 0!=r&&""!=r&&ZDSHAREDIALOG.constructEmailShareDetails(Z,4,n,zd_js_obj.label_read_comment,i),void 0!=y&&""!=y&&ZDSHAREDIALOG.constructEmailShareDetails(y,3,n,zd_js_obj.coowner,i),void 0!=m&&""!=m&&ZDSHAREDIALOG.constructGroupShareDetails(m,1,n,zd_js_obj.read_only,i),void 0!=v&&""!=v&&ZDSHAREDIALOG.constructGroupShareDetails(v,2,n,zd_js_obj.read_write,i),void 0!=D&&""!=D&&ZDSHAREDIALOG.constructGroupShareDetails(D,4,n,zd_js_obj.label_read_comment,i),void 0!=p&&ZDSHAREDIALOG.constructShareDetails(p,8,n,!1,zd_js_obj.label_read_fill,i),n.find("tr").length?ZD("#zd_notmembershared").remove():(ZD("#zd_notmembershared").removeClass("hidediv"),"FB"!=zd_third_party&&ZD("#nosharedmembers_div").text(zd_js_obj.label_zero_member)),ZD(".privateshare-list").scrollTop(ZD(".privateshare-list")[0].scrollHeight-ZD(".privateshare-list").height()),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus(),G_OF_OBJ.docName=w,ZDUtils.hideLoadingMsg(),!1},ZDSHAREDIALOG.updateFolderShareStatus=function(){var e=ZD("tr.selectedContactDivs","#autofilllist"),t=ZD("tr.selectedGroupDivs","#autofilllist"),s=ZD("#zdc_visibility_text_top").attr("share_type"),i="";e&&e.length>0?i="PERSONAL":t&&t.length>0?i="GROUP":!s||"anyone_link"!==s&&"org_share"!==s?s&&"everyone_internet"===s?i="ANYONE_WITHLINK":s&&"secureshare"===s&&(i="ANYONE_WITHLINK_PASSWORD"):i="ORG",FOLDER.shareFolderSuccess(G_OF_OBJ.resIds,i),G_OF_OBJ.updateShareStatus=!1},ZDSHAREDIALOG.constructPublicDocDetails=function(e){var t=ZD("#members_private_info"),s='<div class="top_share_org" id="top_share_org"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+e+'" readonly="readonly"></div></div>';ZD("#top_share_org").remove(),t.before(s)},ZDSHAREDIALOG.constructReadWriteIcon=function(e){ZD("#zd_perma_link_url").before("ro"==e||"RO"==e||"1"==e||1==e?'<span class="graytxt smallText"><img src="/docs/images/spacer.gif" class="readnly flleft"></span>':"ro"===e||"RC"===e||"4"===e||4===e?'<span class="graytxt smallText"><img src="/docs/images/spacer.gif" class="readcomment flleft"></span>':'<span class="graytxt smallText"><img src="/docs/images/spacer.gif" class="zdreadwrt flleft"></span>')},ZDSHAREDIALOG.constructShareDetails=function(e,t,s,i,a,o){for(var n=0;n<e.length;n++){var d=e[n].fullname,r=e[n].encAttr_fullname,l=e[n].emailid,c=e[n].sharedTo,_=d,p="",u="",m="hidediv",v=e[n].isFromParent;v||(p="deletegrey",u="zd_leftmenu",m=""),"zohoforms"===G_COMP_OBJ.serviceType&&(p="deletegrey",u="",m="hidediv"),_.length>=45&&(_=_.substring(0,45)+"...");var D=encodeURIComponent(l);if(0==G_OF_OBJ.isCo_owner){var h='<tr fullname="'+r+'" email="'+l+'" permission="'+t+'" sharedTo="'+c+'"class="selectedContactDivs already_shared"><td width="10"><div class="zdc-shareuser_icon" title="'+zd_js_obj.user+'"></div></td><td><span title="'+l+'">'+_+'</span> <span class="graytxt" style="padding-left:3px;"></span></td>';G_COMP_OBJ.shareWithoutSpecificPermission||(h+='<td width="124"><a href="javascript:void(0);"  class="sharedocs_listing" data-menu-id="zd_leftmenu" popup="'+u+'" shareType="user"><span class="margright flleft invite_permission">'+a+'</span><em class="toolBarDownArrow flleft arrow arspc '+m+'"></em></a></td>'),h+='<td width="23"><div class="'+p+' docscursor pad-lft" id="cancelpersonalshare"  title="'+zd_js_obj.remove+'"></div></td></tr>',ZD(s).append(h),ZDSHAREDIALOG.bindCancelShare(D,G_OF_OBJ.docId,l,o)}else if(1==G_OF_OBJ.isCo_owner)if(1==i)h='<tr fullname="'+r+'" email="'+l+'" permission="3" sharedTo="'+c+'" class="selectedContactDivs already_shared"><td width="10"><div class="zdc-shareuser_icon" title="'+zd_js_obj.user+'"></div></td><td><span title="'+l+'">'+_+'<span class="graytxt" style="padding-left:3px;"></span></td><td width="120"><a href="javascript:void(0);" class="sharedocsco_listing"  shareType="user"><span class="margright flleft invite_permission pad-lft">'+zd_js_obj.coowner+'</span></a></td><td width="10" align="right"></td></tr>',ZD(s).append(h);else{var h='<tr fullname="'+r+'" email="'+l+'" permission="'+t+'" sharedTo="'+c+'"class="selectedContactDivs already_shared"><td width="10"><div class="zdc-shareuser_icon" title="'+zd_js_obj.user+'"></div></td><td><span title="'+l+'">'+_+'</span> <span class="graytxt" style="padding-left:3px;"></span></td>';G_COMP_OBJ.shareWithoutSpecificPermission||(h+='<td width="124"><a href="javascript:void(0);"  class="sharedocs_listing"  data-menu-id="zd_leftmenu" popup="'+u+'" shareType="user"><span class="margright flleft invite_permission">'+a+'</span><em class="toolBarDownArrow flleft arrow arspc '+m+'"></em></a></td>'),h+='<td width="23"><div class="'+p+' docscursor pad-lft" id="cancelpersonalshare" title="'+zd_js_obj.remove+'"></div></td></tr>',ZD(s).append(h),ZDSHAREDIALOG.bindCancelShare(D,G_OF_OBJ.docId,l,o)}}},ZDSHAREDIALOG.bindCancelShare=function(e,t,s,i){var a=ZD("table").find('[email="'+s+'"]').find("#cancelpersonalshare");ZD(a).click(function(){ZDSHAREDIALOG.cancelSharedDocumentToUser(e,t,this,i)})},ZDSHAREDIALOG.constructEmailShareDetails=function(e,t,s,i,a){for(var o=0;o<e.length;o++){var n=e[o].emailid,d=n;d.length>=45&&(d=d.substring(0,45)+"...");var r="",l="",c="hidediv",_=e[o].isFromParent;_||(r="deletegrey",l="zd_leftmenu",c=""),"zohoforms"===G_COMP_OBJ.serviceType&&(r="deletegrey",l="",c="hidediv");var p=encodeURIComponent(n),u='<tr fullname="'+n+'" email="'+n+'" permission="'+t+'" sharedTo=" " class="selectedContactDivs already_shared"><td width="10"><div class="zdc-shareuser_icon" title="'+zd_js_obj.user+'"></div></td><td><span title="'+n+'">'+d+'</span><span class="graytxt" style="padding-left:3px;"></td>';G_COMP_OBJ.shareWithoutSpecificPermission||(u+='<td width="124"><a href="javascript:void(0);"  class="sharedocs_listing" data-menu-id="zd_leftmenu" popup="'+l+'" shareType="user"><span class="margright flleft invite_permission">'+i+'</span><em class="toolBarDownArrow flleft arrow arspc '+c+'"></em></a></td>'),u+='<td width="23" ><div class="'+r+' docscursor pad-lft" onclick="ZDSHAREDIALOG.cancelSharedDocumentToUser(\''+p+"','"+G_OF_OBJ.docId+"',this,'"+a+'\');" title="'+zd_js_obj.remove+'"></div></td></tr>',ZD(s).append(u)}},ZDSHAREDIALOG.constructGroupShareDetails=function(e,t,s,i,a){for(var o=e,n=0;n<o.length;n++){var d=o[n].sharedTo,r=o[n].name,l=o[n].enc_attr_name,c=r;c.length>=45&&(c=c.substring(0,45)+"...");var _="zdc-sharegroup_icon",p=zd_js_obj.per_group,u="group",m="",v="",D="hidediv",h=o[n].isFromParent;if(h||(m="deletegrey",v="zd_leftmenu",D=""),"zohoforms"===G_COMP_OBJ.serviceType&&(m="deletegrey",v="",D="hidediv"),"org"==o[n].type&&(u="org",_="zdc-shareorggroup_icon",p=zd_js_obj.org_group),1==G_OF_OBJ.isCo_owner)var f='<tr groupName="'+l+'" groupId="'+d+'" permission="'+t+'" sharedTo="" sharedType="'+u+'" class="selectedGroupDivs already_shared"><td width="10"><div class="'+_+'" title="'+p+'"></div></td><td><span title="'+l+'">'+c+'</span><span class="graytxt" style="padding-left:3px;"></td><td width="120"><a href="javascript:void(0);" class="sharedocsco_listing" shareType="'+u+'"><span class="margright flleft invite_permission pad-lft">'+i+'</span></a></td><td width="23"></td></tr>';else{var f='<tr groupName="'+l+'" groupId="'+d+'" permission="'+t+'" sharedTo="" sharedType="'+u+'" class="selectedGroupDivs already_shared"><td width="10"><div class="'+_+'" title="'+p+'"></div></td><td><span title="'+l+'">'+c+'</span><span class="graytxt" style="padding-left:3px;"></td>';G_COMP_OBJ.shareWithoutSpecificPermission||(f+='<td width="124"><a href="javascript:void(0);"  class="sharedocs_listing" data-menu-id="zd_leftmenu" popup="'+v+'" shareType="'+u+'"><span class="margright flleft invite_permission">'+i+'</span><em class="toolBarDownArrow flleft arrow arspc '+D+'"></em></a></td>'),f+='<td width="23"><div class="'+m+' docscursor pad-lft" onclick="ZDSHAREDIALOG.cancelSharedDocumentToUser(\''+r+"','"+G_OF_OBJ.docId+"',this,'"+a+'\',true);" title="'+zd_js_obj.remove+'"></div></td></tr>'}ZD(s).append(f)}},ZDSHAREDIALOG.showHideShareMsg=function(e){var t=ZD(e).hasClass("editmsg_add");t?(ZD(e).text(zd_js_obj.label_add_message),ZD(e).removeClass("editmsg_add"),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val("")):(ZD(e).text(zd_js_obj.label_discard_message),ZD(e).addClass("editmsg_add"),ZD("#shareMsgDiv").removeClass("hidediv").children("textarea").focus(),ZD("#notify_checkbox").attr("checked")||ZD("#notify_checkbox").attr("checked",!0))},ZDSHAREDIALOG.showHideMsg=function(e){var t=ZD(e).attr("checked");t||(ZD(".docsdialog .checkbox_add").text(zd_js_obj.label_add_message),ZD("#shareMsgDiv").addClass("hidediv").children("textarea").val(""),ZD(".docsdialog .checkbox_add").removeClass("editmsg_add"))},ZDSHAREDIALOG.getMyContacts=function(){var e;e="method=getContacts&_t="+ZD.now()+"&"+zdcsrfPair;var t=serviceUrl+"/docs/docsrequest.do";ZD.ajax({url:t,data:e,dataType:"json",type:"POST",success:function(e){docs_myContacts=e.contact_list}})},ZDSHAREDIALOG.getPersonalContacts=function(){var e;e="method=getPersonalContacts&_t="+ZD.now()+"&"+zdcsrfPair;var t=serviceUrl+"/docs/docsrequest.do";ZD.ajax({url:t,data:e,dataType:"json",type:"POST",success:function(e){user_emailContacts=e.contact_list}})},ZDSHAREDIALOG.processUserList=function(e){if(ZDSHAREDIALOG.resetEmailIds(),e){var t=ZD("#zd_sharetextarea"),s=t.val().trim();s.lastIndexOf(",")==s.length-1&&(s=s.substring(0,s.length-1));for(var i=s.split(","),a=0;a<G_OF_OBJ.G_fromAutoComplete.length;a++)if(void 0!=G_OF_OBJ.G_fromAutoComplete[a]&&""!=G_OF_OBJ.G_fromAutoComplete[a]){for(var o=!0,n=0;n<i.length;n++){var d=i[n],r=d.substring(d.indexOf("<")+1,d.indexOf(">"));if(ZD.trim(G_OF_OBJ.G_fromAutoComplete[a])==ZD.trim(r)){o=!1;break}}o&&delete G_OF_OBJ.G_fromAutoComplete[a]}if(""!=t.val().trim())for(var s=t.val().trim(),i=s.split(","),l=0;l<i.length;l++){for(var c=!1,_=0;_<G_OF_OBJ.G_fromAutoComplete.length;_++)""!=i[l]&&void 0!=i[l]?-1==i[l].indexOf(G_OF_OBJ.G_fromAutoComplete[_])||(c=!0):c=!0;if(!c&&void 0!=ZD.trim(i[l])&&""!=ZD.trim(i[l])){var p=ZD.trim(i[l]);if(-1!=p.indexOf("<"))var u=p.substring(p.lastIndexOf("<")+1,p.lastIndexOf(">")),m=ZDUtils.isEmailId(u);G_OF_OBJ.trimmedEmails+=m?encodeURIComponent(ZD.trim(u))+",":encodeURIComponent(ZD.trim(i[l]))+","}}for(var l=0;l<G_OF_OBJ.G_fromAutoComplete.length;l++)void 0!=ZD.trim(G_OF_OBJ.G_fromAutoComplete[l])&&""!=ZD.trim(G_OF_OBJ.G_fromAutoComplete[l])&&(G_OF_OBJ.trimmedEmails+=encodeURIComponent(G_OF_OBJ.G_fromAutoComplete[l])+",")}},ZDSHAREDIALOG.shareDocument=function(e,t,s,i,a,o){var n="";if(""!=ZD("#shareMsgDiv").children("textarea").val()&&void 0!=ZD("#shareMsgDiv").children("textarea").val()&&(n=encodeURIComponent(ZD("#shareMsgDiv").children("textarea").val()),n.length>2500))return alert(zd_js_obj.validation_share_mail_custom_message),!1;G_OF_OBJ.autocomplete_selectValue="";var d=ZD("#zd_sharetextarea");if(a&&ZDSHAREDIALOG.insertShareButton(),t){if(""==d.val().trim()||void 0==d.val().trim()||d.val().trim()==s)return a||alert(zd_js_obj.label_enter_atleast_one_user_share),!1;ZDSHAREDIALOG.processUserList(t)}G_OF_OBJ.G_zdc_permissionType=ZD("#zd_permission_oneshot").attr("permission")||1,""!=G_OF_OBJ.trimmedPerGroupIds&&(G_OF_OBJ.trimmedPerGroupIds=G_OF_OBJ.trimmedPerGroupIds.substring(0,G_OF_OBJ.trimmedPerGroupIds.length-1)),""!=G_OF_OBJ.trimmedOrgGroupIds&&(G_OF_OBJ.trimmedOrgGroupIds=G_OF_OBJ.trimmedOrgGroupIds.substring(0,G_OF_OBJ.trimmedOrgGroupIds.length-1)),""!=G_OF_OBJ.trimmedEmails&&(G_OF_OBJ.trimmedEmails=G_OF_OBJ.trimmedEmails.substring(0,G_OF_OBJ.trimmedEmails.length-1));var r=[G_OF_OBJ.trimmedEmails],l=[],c=[];if(t){var _=G_OF_OBJ.trimmedEmails.split(","),p=(G_OF_OBJ.trimmedOrgGroupIds.split(","),G_OF_OBJ.trimmedPerGroupIds.split(","),[]);if(G_OF_OBJ.groupNameList.length>0){for(var u=0;u<G_OF_OBJ.groupNameList.length;u++){for(var m=G_OF_OBJ.groupNameList[u],v=0;v<_.length;v++){var D=_[v];D.indexOf(m)>-1&&(p.push(ZD.trim(D)),_.splice(v,1))}r=[_]}for(var u=0;u<p.length;u++)for(var m=p[u],v=0;v<G_OF_OBJ.groupNameAndIdList.length;v++){var D=G_OF_OBJ.groupNameAndIdList[v];if(D.indexOf(m)>-1){var h=D.split(":");"true"==h[2]?c.push(h[1]):l.push(h[1])}}}}else l=[G_OF_OBJ.trimmedPerGroupIds],c=[G_OF_OBJ.trimmedOrgGroupIds];if(r=ZD.unique(r),l=ZD.unique(l),c=ZD.unique(c),(""!=c||""!=l)&&(c.length>0||l.length>0)&&"3"==G_OF_OBJ.G_zdc_permissionType)return alert(zd_js_obj.label_coowner_permission_not_allowed_for_groups),!1;var f="";f="crm"===G_OF_OBJ.urlInvoker?serviceUrl+"/docs/docsrequest.do?method=shareWSResources":serviceUrl+"/docs/docsrequest.do?method=shareResources";var g=zdcsrfPair,n="";""!=ZD("#shareMsgDiv").children("textarea").val()&&void 0!=ZD("#shareMsgDiv").children("textarea").val()&&(n=encodeURIComponent(ZD("#shareMsgDiv").children("textarea").val()));var O=!1;if(t&&(O=ZD("#notify_checkbox").is(":checked")),g+="&docid="+e+"&emailids="+r+"&pergroupIds="+l+"&orggroupIds="+c+"&message="+n+"&notify="+O,G_OF_OBJ.isFolderShare&&(g+="&folderids="+G_OF_OBJ.folderIds),g+=t?"&permission="+G_OF_OBJ.G_zdc_permissionType+"&ischangepermission=false":"&permission="+i+"&ischangepermission=true",ZD("#shareloadingspan").show(),t){var b='<button id="zd_share_loading_button" class="ui-status-icon ui-button ui-widget ui-state-default ui-corner-all ui-button-disabled ui-state-disabled ui-button-text-icon-primary"><span class="ui-button-icon-primary ui-icon  ui-icon-loader"></span><span class="ui-button-text">'+zd_js_obj.sharing+"</span></button>";ZD("#zd_share_button").remove(),ZD("#button_share_container").prepend(b)}return t?(ZDSHAREDIALOG.shareDocAndProcessResponse(f,g,!0,!0),!1):(ZDSHAREDIALOG.shareDocAndProcessResponse(f,g,!1,!0,i,o),!1)},ZDSHAREDIALOG.insertShareButton=function(){var e='<button  id="zd_share_button" type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text">'+zd_js_obj.share+"</span></button>";ZD("#zd_share_loading_button").remove(),ZD("#button_share_container").prepend(e)},ZDSHAREDIALOG.constructConfirmUserDialog=function(){var e={};e[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")};var t=IAM_URL+"/u/h#profile/useremails";return ZDDialog.openAlert(zd_js_obj.confirmwsreq,ZDUtils.replaceParams(zd_js_obj.label_user_is_not_confirmed,new Array(t)),!0,e,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02]),!1},ZDSHAREDIALOG.shareDocAndProcessResponse=function(e,t,s,i,a,o){var n=ZD("#zd_sharetextarea");return i||(t+="&validation="+i),ZD.ajax({url:e,data:t,type:"POST",dataType:"text",success:function(d){if(i){if(-1!=d.indexOf("UNCONFIRMED_USER")){var r={};r[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv")};var l=IAM_URL+"/u/h#profile/useremails";return ZDDialog.openAlert(zd_js_obj.confirmwsreq,ZDUtils.replaceParams(zd_js_obj.label_user_is_not_confirmed,new Array(l)),!0,r,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02]),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument(),!1}if(-1!=d.indexOf("UNAUTHORIZED_USER"))return alert("Invalid user access"),!1;if(-1!=d.indexOf("INVALID_USER"))return alert(zd_js_obj.label_enter_list_contains_users_not_exist),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument(),!1;if(-1!=d.indexOf("ORG_POLICY_ACCEPT_SHARING_FAILURE"))return alert(zd_js_obj.label_error_occured_sharing_document),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument(),!1;if(-1!=d.indexOf("ORG_POLICY_SHARE_EXTERNALLY_FAILURE"))return alert(zd_js_obj.label_cannot_share_people_outside_organization),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument(),!1;if(-1!=d.indexOf("EXT_USER_WITH_COOWNER_PERM"))return alert(zd_js_obj.label_coowner_permission_not_allowed),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument(),!1;if(-1!=d.indexOf("SHARE_USERS_LIMIT_EXCEEDED")){var c=ZD.parseJSON(d),_=c.shareusers_limit,p=ZDUtils.replaceParams(zd_js_obj.free_plan_share_limit_exceeded,new Array(_+""))+'<br><br><a href="javascript:void(0)" id="manageCollabUsersLink">'+zd_js_obj.manage_my_collaborators+"</a>";return ZDSHAREDIALOG.showUpgradePopup(zd_js_obj.upgrade,p,"sharedialog"),ZDSHAREDIALOG.insertShareButton(),!1}-1!=d.indexOf("GROUP_SHARE_NOT_ALLOWED")&&(ZDSHAREDIALOG.showUpgradePopup(zd_js_obj.upgrade,zd_js_obj.free_plan_group_share_not_allowed),ZDSHAREDIALOG.insertShareButton());var u="";u=-1!=d.indexOf("ERROR")?"":d;var m=ZDSHAREDIALOG.processSharedUserDetails(u,e,t,a,o);if("false"==m)return!1;if("allowChange"==m)return ZDSHAREDIALOG.shareDocAndProcessResponse(e,t,!1,!1,a,o),!1}if(a)return ZD(o).closest(".selectedContactDivs").attr("permission",a),3==a&&ZD(o).children("span").text(zd_js_obj.coowner),!0;if(-1!=d.indexOf("INVALID_USER"))alert(zd_js_obj.label_enter_list_contains_users_not_exist),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument();else if(-1!=d.indexOf("ORG_POLICY_ACCEPT_SHARING_FAILURE"))alert(zd_js_obj.label_error_occured_sharing_document),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument();else if(-1!=d.indexOf("ORG_POLICY_SHARE_EXTERNALLY_FAILURE"))alert(zd_js_obj.label_cannot_share_people_outside_organization),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument();else if(-1!=d.indexOf("EXT_USER_WITH_COOWNER_PERM"))alert(zd_js_obj.label_coowner_permission_not_allowed),ZDSHAREDIALOG.insertShareButton(),ZDSHAREDIALOG.resetShareDocument();else if(s){n.val("");var v=d.indexOf("ERROR_WHILE_SHARING");if(-1!=v&&(alert(zd_js_obj.label_sharing_failed_unexpected_server_error),ZDSHAREDIALOG.resetShareDocument()),ZDSHAREDIALOG.cancelShareDocument(),s){if(G_OF_OBJ.updateShareStatus=!0,G_COMP_OBJ.isMultiShare)return"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&(FOLDER.multiShareFolderSuccess(),G_OF_OBJ.updateShareStatus=!1),ZDSHAREDIALOG.resetShareDocument(),Dialog.feedStatusAlert(zd_js_obj.label_share_document_success,"info"),ZDDialog.closePopUp("sharedialogdiv"),!1;ZDSHAREDIALOG.cancelShareDocument(),ZDSHAREDIALOG.getShareDetails(G_OF_OBJ.docId?G_OF_OBJ.docId:G_OF_OBJ.folderIds)}}ZDSHAREDIALOG.resetShareDocument()},error:function(e){var t=ZD.parseJSON(e.responseText);if("PATTERN_NOT_MATCHED"===t.ERROR_CODE)alert("emailids"===t.PARAM_NAME?zd_js_obj.label_invalid_mail_address:zd_js_obj.label_sharing_failed_unexpected_server_error),ZDSHAREDIALOG.cancelShareDocument(),ZDSHAREDIALOG.resetShareDocument();else if("INVALID_CSRF_TOKEN"===t.ERROR_CODE)alert(zd_js_obj.label_logged_off_please_try_again),ZDSHAREDIALOG.cancelShareDocument(),ZDSHAREDIALOG.resetShareDocument();else if("MORE_THAN_MAX_OCCURANCE"===t.ERROR_CODE)alert("emailids"===t.PARAM_NAME?zd_js_obj.label_select_max_email_limit:"docid"===t.PARAM_NAME?zd_js_obj.label_select_max_file_limit:zd_js_obj.label_sharing_failed_unexpected_server_error),ZDSHAREDIALOG.insertShareButton();else if("MORE_THAN_MAX_LENGTH"===t.ERROR_CODE)alert("message"===t.PARAM_NAME?zd_js_obj.label_message_size_exceed:zd_js_obj.label_sharing_failed_unexpected_server_error),ZDSHAREDIALOG.cancelShareDocument(),ZDSHAREDIALOG.resetShareDocument();else if("LESS_THAN_MIN_OCCURANCE"===t.ERROR_CODE)alert("permission"===t.PARAM_NAME?zd_js_obj.label_permission_selction:zd_js_obj.label_sharing_failed_unexpected_server_error),ZDSHAREDIALOG.cancelShareDocument(),ZDSHAREDIALOG.resetShareDocument();else if(s){if(alert(zd_js_obj.label_sharing_failed_unexpected_server_error),ZDSHAREDIALOG.resetShareDocument(),n.val(""),G_COMP_OBJ.isReqFromDocs&&G_COMP_OBJ.isMultiShare)return ZDSHAREDIALOG.resetShareDocument(),Dialog.feedStatusAlert(zd_js_obj.label_share_document_error,"error"),ZDDialog.closePopUp("sharedialogdiv"),!1;ZDSHAREDIALOG.cancelShareDocument(),ZDSHAREDIALOG.resetShareDocument()}}}),!1},ZDSHAREDIALOG.processSharedUserDetails=function(e,t,s,i){var a=[],o=[],n=[],d=[],r=[],l=[];if(void 0!=e&&""!=e){e=ZD.parseJSON(e);var c=e.extCoownerAllowed,_=e.external,p=e.invalid,u=e.inactive,m=e.no_accept_sharing,v=e.no_share_ext,D=e.nonzohovalidemail;if(void 0!=p&&""!=p){for(var h=0;h<p.length;h++){var f=p[h];o.push(f)}return ZDSHAREDIALOG.showConfirmDialogForExternalUser(o,t,s,"invalidList"),"false"}if(void 0!=u&&""!=u){for(var h=0;h<u.length;h++){var g=u[h];l.push(g)}return ZDSHAREDIALOG.showInactiveUserList(l),"false"}if(void 0!=D&&""!=D){for(var h=0;h<D.length;h++){var f=D[h];n.push(f)}return ZDSHAREDIALOG.showNonZohoVaildUserList(n),"false"}if(void 0!=m&&""!=m){for(var h=0;h<m.length;h++){var f=m[h];r.push(f)}if("undefined"==typeof t)var O=!0;return ZDSHAREDIALOG.showValidationMessage(r,"accept_fail",O),"false"}if(void 0!=v&&""!=v){for(var h=0;h<v.length;h++){var f=v[h];d.push(f)}if("undefined"==typeof t)var O=!0;return ZDSHAREDIALOG.showValidationMessage(d,"ext_fail",O),"false"}if(void 0!=_&&""!=_){for(var h=0;h<_.length;h++){var f=_[h];a.push(f)}if(a.length)return""!=i&&void 0!=i?3==i&&0==c?(alert(zd_js_obj.label_coowner_permission_cannot_set_your_organization),"false"):"allowChange":(ZDSHAREDIALOG.showConfirmDialogForExternalUser(a,t,s,"externalList",c),"false")}}},ZDSHAREDIALOG.sendInvitationToExternalUsers=function(e){var t=e.join(","),s="method=inviteSharedUsers&sharedemails="+t+"&docId="+G_OF_OBJ.docId+"&"+zdcsrfPair,i=serviceUrl+"/docs/docsrequest.do";ZD.ajax({url:i,data:s,type:"POST",success:function(){}})},ZDSHAREDIALOG.sendInvitationToNonZohoUser=function(e){var t,s=e.join(",");t="method=inviteNonZohoSharedUsers&nonzohoemails="+s+"&"+zdcsrfPair;var i=serviceUrl+"/docs/docsrequest.do";ZD.ajax({url:i,data:t,type:"POST",success:function(){}})},ZDSHAREDIALOG.showConfirmDialogForExternalUser=function(e,t,s,i,a){var o={};"invalidList"==i?(o[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()},ZDDialog.showExternalUsersList(zd_js_obj.trash_confirm,o,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02],G_OF_OBJ.G_zdc_permissionType,i,a)):3==G_OF_OBJ.G_zdc_permissionType&&"externalList"==i&&0==a?(o[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()},ZDDialog.showExternalUsersList(zd_js_obj.trash_confirm,o,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02],G_OF_OBJ.G_zdc_permissionType,i,a)):(o[zd_js_obj.label_yes]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.sendInvitationToExternalUsers(e),ZDSHAREDIALOG.shareDocAndProcessResponse(t,s,!0,!1)},o[zd_js_obj.no]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.removeUserList(e,t,s)},o[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()},ZDDialog.showExternalUsersList(zd_js_obj.trash_confirm,o,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02],G_OF_OBJ.G_zdc_permissionType,i,a));for(var n=ZD(".zdc-external-list"),d=0;d<e.length;d++)n.append("<p>"+e[d]+"</p>")},ZDSHAREDIALOG.showNonZohoVaildUserList=function(e){var t={};t[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.removeNonZohoUser(e)},ZDDialog.showNonZohoUserList(zd_js_obj.trash_confirm,t,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02]);for(var s=ZD(".zdc-external-list"),i=0;i<e.length;i++)s.append("<p>"+e[i]+"</p>")},ZDSHAREDIALOG.showInactiveUserList=function(e){var t={};t[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.insertShareButton()},ZDDialog.showInactiveUserList(zd_js_obj.trash_confirm,t,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02]);for(var s=ZD(".zdc-external-list"),i=0;i<e.length;i++)s.append("<p>"+e[i]+"</p>")},ZDSHAREDIALOG.showValidationMessage=function(e,t,s){var i={};i[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),"undefined"==typeof s&&(ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton())},ZDDialog.sharePolicyFailList(zd_js_obj.trash_confirm,i,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02],t,s);for(var a=ZD(".zdc-external-list"),o=0;o<e.length;o++)a.append("<p>"+e[o]+"</p>")},ZDSHAREDIALOG.removeNonZohoUser=function(e){for(var t=ZD("#zd_sharetextarea").val().trim(),s=0;s<e.length;s++)t=t.replace(e[s],""),ZD("#zd_sharetextarea").val(t);G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="";var i=G_OF_OBJ.defaultText;ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!0,i,"",!0)},ZDSHAREDIALOG.resetEmailIds=function(){G_OF_OBJ.trimmedEmails=""},ZDSHAREDIALOG.removeUserList=function(e){for(var t=ZD("#zd_sharetextarea").val().trim(),s=0;s<e.length;s++)t=t.replace(e[s],""),ZD("#zd_sharetextarea").val(t);G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="";var i=G_OF_OBJ.defaultText;ZDSHAREDIALOG.shareDocument(G_OF_OBJ.docId,!0,i,"",!0)},ZDSHAREDIALOG.getPositionOfItems=function(e){for(var t=0,s=ZD("#zd_sharetextarea"),i=s.val().trim(),a=i.split(","),o=0;o<a.length;o++)if(""!=a[o]&&void 0!=a[o]){if(ZD.trim(a[o])==ZD.trim(e[o])){var n=t+e[o].length;ZDSHAREDIALOG.selectGivenItem(s,t,n+2)}t+=a[o].length}},ZDSHAREDIALOG.selectGivenItem=function(e,t,s){var e=document.getElementById("zd_sharetextarea");if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveStart("character",t),i.moveEnd("character",s-t),i.select()}else e.setSelectionRange?e.setSelectionRange(t,s):e.selectionStart&&(e.selectionStart=t,e.selectionEnd=s);e.focus()},ZDSHAREDIALOG.resetShareDocument=function(){var e=ZD("#zd_sharetextarea");e.val(""),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.isInternalMailId=!0,G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.groupNameList=[],G_OF_OBJ.groupNameAndIdList=[],G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.G_fromAutoComplete=[]},ZDSHAREDIALOG.cancelShareDocument=function(){ZDSHAREDIALOG.constructDefaultShareView(),ZD("#zdshare_autocomplete").remove(),G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.G_fromAutoComplete=[]},ZDSHAREDIALOG.shareviaLink=function(e,t,s,i){G_COMP_OBJ.isMultiShare&&ZDUtils.insertDynamicButton(zd_js_obj.saving+"...",1,"zdc_visible_button_container",!0),G_OF_OBJ.updateShareStatus=!0;var a=ZD("#zd_user_details").attr("THIRD_PARTY");i="secureshare"==i?!0:!1;var o="",n=serviceUrl+"/docs/docsrequest.do?method=shareViaLink";"crm"===G_OF_OBJ.urlInvoker&&(n=serviceUrl+"/docs/docsrequest.do?method=shareWSDocViaLink"),o="password_protected="+i+"&docid="+e+"&sharetype="+s+"&updatepermission=false&"+zdcsrfPair,G_COMP_OBJ.isMultiShare||ZDUtils.LoadingMsg(zd_js_obj.loading);var d;return ZD.ajax({url:n,data:o,type:"POST",dataType:"text",success:function(e){if(ZDUtils.hideLoadingMsg(),-1!=e.indexOf("UNCONFIRMED_USER"))return ZDSHAREDIALOG.constructConfirmUserDialog(),!1;if(-1==e.indexOf("NOT_OWNER")&&-1==e.indexOf("Error While sharing"))if(d=ZD.parseJSON(e),G_COMP_OBJ.isMultiShare){ZD_G_CurrentVisibility="anyone_link";var t=zd_js_obj.label_everyone_org;if(orgnameofcurrentuser.length){var i=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var i=orgnameofcurrentuser.substring(0,40);t=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(i))}ZDSHAREDIALOG.constructMultiDocVisibilityDetails(d.respDetails,t,s),FOLDER.shareFolderSuccess(G_OF_OBJ.resIds,"ORG")}else{G_OF_OBJ.isDocLinkShared=!0,G_OF_OBJ.linkURL=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:d.respDetails[0].response.result.share_url,G_OF_OBJ.linkPermission=d.respDetails[0].response.result.share_type;var o=d.respDetails[0].response.result.documentName;G_OF_OBJ.docName=o,ZD("#top_share_org,#everyone_internet").remove();var n='<div class="share_via_link" id="top_share_via_link"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+G_OF_OBJ.linkURL+'" readonly="readonly"><div><a style="cursor:pointer;" class="flright textUnderline" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";if(ZD("#top_share_via_link").remove(),ZD("#members_private_info").before(n),ZD("#zd_perma_link_url").click(function(){ZDSHAREDIALOG.triggerSendMailDialog(this)}),"AP"==a){var r="mailto:?body=I have shared the following document with you: "+G_OF_OBJ.linkURL+"&subject="+o;ZD("#zd_perma_link_url").attr("href",r).removeAttr("onClick")}ZD("#zdc_visibility_text_top").attr("share_type","anyone_link").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyoneshare"),ZD("#top_share_via_link .share-spcbtm").select().focus(),ZDSHAREDIALOG.constructReadWriteIcon(s),ZD(".anyonefieldset").children("div").addClass("margbtm"),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus()}},error:function(e){if(ZDUtils.hideLoadingMsg(),"UNAUTHORIZED_USER"===e.responseText.trim())alert(zd_js_obj.label_coowner_cannot_share_externally);else{var t=ZD.parseJSON(e.responseText);alert("LESS_THAN_MIN_OCCURANCE"===t.ERROR_CODE?"docid"===t.PARAM_NAME?zd_js_obj.label_select_min_file_limit:"permission"===t.PARAM_NAME?zd_js_obj.label_permission_selction:zd_js_obj.label_unable_change_visibility_server_error:"INVALID_CSRF_TOKEN"===t.ERROR_CODE?zd_js_obj.label_logged_off_please_try_again:zd_js_obj.label_unable_change_visibility_server_error)}}}),!1},ZDSHAREDIALOG.restrictAccessForDocument=function(e,t){t="secureshare"==t?!0:!1,G_OF_OBJ.updateShareStatus=!0;var s="",i=serviceUrl+"/docs/docsrequest.do?method=restictAccessForDocument";return"crm"===G_OF_OBJ.urlInvoker&&(i=serviceUrl+"/docs/docsrequest.do?method=restictAccessForCRMDocument"),s="password_protected="+t+"&docid="+e+"&"+zdcsrfPair,ZDUtils.LoadingMsg(zd_js_obj.loading),ZD.ajax({url:i,data:s,type:"POST",success:function(){ZDUtils.hideLoadingMsg(),G_OF_OBJ.isDocLinkShared=!1,G_OF_OBJ.linkURL="",G_OF_OBJ.linkPermission="",ZD("#top_share_via_link,#everyone_internet").remove(),ZD("#zdc_visibility_text_top").attr("share_type","private").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-specific"),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus()},error:function(e){ZDUtils.hideLoadingMsg(),alert("UNAUTHORIZED_USER"===e.responseText.trim()?zd_js_obj.label_coowner_cannot_share_externally:zd_js_obj.label_unable_change_visibility_server_error)}}),!1},ZDSHAREDIALOG.shareToOrg=function(e,t,s,i){G_COMP_OBJ.isMultiShare&&ZDUtils.insertDynamicButton(zd_js_obj.saving+"...",1,"zdc_visible_button_container",!0),G_OF_OBJ.updateShareStatus=!0;var a=ZD("#zd_user_details").attr("THIRD_PARTY");i="secureshare"==i?!0:!1;var a=ZD("#zd_user_details").attr("THIRD_PARTY"),o="",n=serviceUrl+"/docs/docsrequest.do?method=makeOrgPublic";o="password_protected="+i+"&docId="+e+"&permission="+s+"&updateorgpermission=false",o+="&"+zdcsrfPair,G_COMP_OBJ.isMultiShare||ZDUtils.LoadingMsg(zd_js_obj.loading),ZD.ajax({url:n,data:o,type:"POST",success:function(e){if(ZDUtils.hideLoadingMsg(),-1!=e.indexOf("UNCONFIRMED_USER"))return ZDSHAREDIALOG.constructConfirmUserDialog(),!1;var t=jQuery.parseJSON(e);if(G_COMP_OBJ.isMultiShare){ZD_G_CurrentVisibility="org_share";var i=zd_js_obj.label_everyone_org;if(orgnameofcurrentuser.length){var o=orgnameofcurrentuser;if(orgnameofcurrentuser.length>40)var o=orgnameofcurrentuser.substring(0,40);i=ZDUtils.replaceParams(zd_js_obj.label_everyone_orgname,new Array(o))}ZDSHAREDIALOG.constructMultiDocVisibilityDetails(t.respDetails,i,s)}else{var n=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:t.respDetails[0].response.result.share_url,d=t.respDetails[0].response.result.documentName;G_OF_OBJ.docName=d,ZD("#top_share_via_link,#everyone_internet").remove();var r='<div class="top_share_org" id="top_share_org"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+'</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+n+'" readonly="readonly"><div><a style="cursor:pointer;" class="flright textUnderline" id="zd_perma_link_url">'+zd_js_obj.send_link_email+"</a></div></div></div>";if(ZD("#top_share_org").remove(),ZD("#members_private_info").before(r),ZD("#zd_perma_link_url").click(function(){ZDSHAREDIALOG.triggerSendMailDialog(this)}),"AP"==a){var l="mailto:?body=I have shared the following document with you: "+n+"&subject="+d;ZD("#zd_perma_link_url").attr("href",l).removeAttr("onClick")}ZD("#zdc_visibility_text_top").attr("share_type","org_share").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyoneshare"),ZD("#top_share_org .share-spcbtm").select().focus(),ZDSHAREDIALOG.constructReadWriteIcon(s),ZD(".anyonefieldset").children("div").addClass("margbtm"),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus()}},error:function(){ZDUtils.hideLoadingMsg(),alert(zd_js_obj.label_unable_change_visibility_server_error)}})},ZDSHAREDIALOG.showMuliSharePasswordDetails=function(e){var t=ZD(e),s=t.attr("pwd"),i=t.attr("asterisks");t.hasClass("showpwd")?(t.text(zd_js_obj.label_hide_password).prev("span").text(s),t.removeClass("showpwd").addClass("hidepwd")):(t.text(zd_js_obj.label_show_password).prev("span").text(i),t.removeClass("hidepwd").addClass("showpwd"))},ZDSHAREDIALOG.setStatusMessageForVisibilityActions=function(e,t){ZD(e).after('<div class="zdc-sucess"><img src="/docs/images/spacer.gif" class="zdc-tickmark pad-rt" style="vertical-align:middle;">'+t+"</div>"),setTimeout(function(){ZD(".zdc-sucess").remove()},5e3)},ZDSHAREDIALOG.constructMultiDocVisibilityDetails=function(e,t,s,i){"1"==s||1===s?s="Read Only":("2"==s||2===s)&&(s="Read/Write"),ZD("#radiooptions_container,.zd_visiblity_list_container").addClass("hidediv");var a=ZDSHAREDIALOG.showDialogForSendingMail;ZDUtils.insertDynamicButton(zd_js_obj.send_link_email,1,"zdc_visible_button_container",!1,a),ZD("#zdc_visible_button_container button:last").children("span.ui-button-text").text(zd_js_obj.label_close),ZD("#multidoc_visibility_details,#zd_linklists").removeClass("hidediv");var o='<ul class="zdmultisharevisiblitytable"><li><span class="lfttxt">'+zd_js_obj.label_visibility+"</span><span>"+t+'</span></li><li class="zd_permission_multi_ref"><span class="lfttxt">'+zd_js_obj.whoever_accesses_can+"</span><span>"+s+"</span></li></ul>";ZD("#multidoc_visibility_details").addClass("sharedetail").append(o);var n=zd_js_obj.label_document_link_does_not_expire;if(""!=public_PwdExpiryDate&&void 0!=public_PwdExpiryDate&&(n=public_PwdExpiryDate),""!=i&&void 0!=i){for(var d="",r=1;r<=i.length;r++)d+="*";ZD(".zd_permission_multi_ref").before('<li><span class="lfttxt">'+zd_js_obj.label_password+'</span><span class="margright10 litgreytxt pasdtxt" style="display:inline;">'+d+'</span><span class="graytxt docscursor textUnderline showpwd" pwd="'+i+'" asterisks="'+d+'" onClick="ZDSHAREDIALOG.showMuliSharePasswordDetails(this);">'+zd_js_obj.label_show_password+'</span></li><li><span class="lfttxt">Visibility Expiry Date</span><span>'+n+"</span></li> ")}else"everyone_internet"==ZD_G_CurrentVisibility&&ZD(".zdmultisharevisiblitytable").append('<li><span class="lfttxt">Visibility Expiry Date</span><span>'+n+"</span></li> ");ZD(".zdc-sharedetail").after("<div>"+zd_js_obj.links_to_share+":</div>");for(var l="",r=0;r<e.length;r++){var c=e[r].response.result.share_url,_=e[r].response.result.documentName;l+=_+"-"+c+"\n \n"}""!=l&&void 0!=l&&ZD("#zd_linklists").addClass("zdc-sharelink").text(l).focus(),ZDSHAREDIALOG.setStatusMessageForVisibilityActions(ZD(".zdc-sharelink"),zd_js_obj.visibility_changed_successfully)},ZDSHAREDIALOG.createPublicLink=function(e,t,s,i,a,o){G_COMP_OBJ.isMultiShare&&ZDUtils.insertDynamicButton(zd_js_obj.saving+"...",1,"zdc_visible_button_container",!0),G_OF_OBJ.updateShareStatus=!0,a="secureshare"==a?!0:!1;var n=(ZD("#zd_user_details").attr("THIRD_PARTY"),""),d=serviceUrl+"/docs/docsrequest.do?method=createLinkForPublic";n=""==i||void 0==i?"password_protected="+a+"&docid="+e+"&sharetype="+s+"&pwd=":"password_protected="+a+"&docid="+e+"&sharetype="+s+"&pwd="+encodeURIComponent(i),""!=o&&void 0!=o?(n+="&expiry_date="+o.trim(),public_PwdExpiryDate=o.trim()):public_PwdExpiryDate="",n+="&"+zdcsrfPair,G_COMP_OBJ.isMultiShare||ZDUtils.LoadingMsg(zd_js_obj.loading),ZD.ajax({url:d,data:n,type:"POST",dataType:"text",success:function(e){ZDUtils.hideLoadingMsg();var t=e;if(-1!==t.indexOf("passwordempty"))return alert(zd_js_obj.validation_empty_password),!1;if(-1!==t.indexOf("lessthanpasswordlimit"))return alert(zd_js_obj.validation_password_less_than_limit),!1;if(-1!==t.indexOf("passwordlengthexit"))return alert(zd_js_obj.validation_password_greater_than_limit),!1;if(-1!==t.indexOf("onlynumbersnotallowed"))return alert(zd_js_obj.validation_password_should_contain_atleast_one_alphabet),!1;if(-1!==t.indexOf("onlystringnotallowed"))return alert(zd_js_obj.validation_password_should_contain_atleast_one_number),!1;if(-1!==t.indexOf("Access denied"))return alert(zd_js_obj.label_error_occured_link_file),!1;if(-1!=t.indexOf("UNCONFIRMED_USER"))return ZDSHAREDIALOG.constructConfirmUserDialog(),!1;var s=ZD.parseJSON(e);if(G_COMP_OBJ.isMultiShare)""==i||void 0==i?(ZD_G_CurrentVisibility="everyone_internet",ZDSHAREDIALOG.constructMultiDocVisibilityDetails(s.respDetails,zd_js_obj.public_web,"Read Only",i),FOLDER.shareFolderSuccess(G_OF_OBJ.resIds,"ANYONE_WITHLINK")):(ZD_G_CurrentVisibility="secureshare",ZDSHAREDIALOG.constructMultiDocVisibilityDetails(s.respDetails,zd_js_obj.public_web_password_protect,"Read Only",i),FOLDER.shareFolderSuccess(G_OF_OBJ.resIds,"ANYONE_WITHLINK_PASSWORD"));else{var a=s.respDetails[0].response.result.documentName;G_OF_OBJ.docName=a;var o=G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:s.respDetails[0].response.result.share_url;ZD("#top_share_org,#top_share_via_link,#everyone_internet").remove(),""==i||void 0==i?ZD("#zdc_visibility_text_top").attr("share_type","everyone_internet").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyoneinternet"):ZD("#zdc_visibility_text_top").attr("share_type","secureshare").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-anyonepasswrd"),ZDSHAREDIALOG.showPublicLink(a,o),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus()}},error:function(e){if(ZDUtils.hideLoadingMsg(),"UNAUTHORIZED_USER"===e.responseText.trim())alert(zd_js_obj.label_coowner_cannot_share_externally);else{var t=ZD.parseJSON(e.responseText);alert("PATTERN_NOT_MATCHED"===t.ERROR_CODE?"expiry_date"===t.PARAM_NAME?zd_js_obj.label_date_format_improper:zd_js_obj.label_unable_change_visibility_server_error:"INVALID_CSRF_TOKEN"===t.ERROR_CODE?zd_js_obj.label_logged_off_please_try_again:"LESS_THAN_MIN_OCCURANCE"===t.ERROR_CODE?"docid"===t.PARAM_NAME?zd_js_obj.label_select_min_file_limit:"permission"===t.PARAM_NAME?zd_js_obj.label_permission_selction:zd_js_obj.label_unable_change_visibility_server_error:zd_js_obj.label_unable_change_visibility_server_error)}}})},ZDSHAREDIALOG.showPublicLink=function(e,t){var s=ZD("#zd_user_details").attr("THIRD_PARTY"),i=ZD("#zdc_visibility_text_top").attr("share_type"),a='<div class="everyone_internet" id="everyone_internet"><div class="anyonefieldset"><span>'+zd_js_obj.label_link_to_share+':</span><input type="text" style="width:99%; height:20px;margin-top:5px;" class="share-spcbtm linkURL" value="'+t+'" readonly="readonly" id="zd_perma_link_url"><div id="zd_public_link_container" style="overflow:hidden;"><a style="cursor:pointer;" class="flright textUnderline" id="secureshare_sendmail_link">'+zd_js_obj.send_link_email+"</a></div></div></div>";ZD("#members_private_info").before(a),ZD("#secureshare_sendmail_link").click(function(){ZDSHAREDIALOG.triggerSendMailDialog(this)}),ZD("#zd_perma_link_url").select().focus();var o=zd_js_obj.label_expires_on+" "+public_PwdExpiryDate;if("secureshare"==i){var n="";n+=""!=public_PwdExpiryDate&&void 0!=public_PwdExpiryDate?'<img src="/docs/images/spacer.gif" class="zdexpire flleft"  title= "'+o+'"/></span>':"</span>",ZD("#zd_public_link_container").prepend(n)}else if("everyone_internet"==i&&""!=public_PwdExpiryDate&&void 0!=public_PwdExpiryDate){var n='<span class="graytxt smallText"><img src="/docs/images/spacer.gif" class="zdexpire flleft" title= "'+o+'" /></span>';ZD("#zd_public_link_container").prepend(n)}if("AP"==s){var d="mailto:?body=I have shared the following document with you: "+t+"&subject="+e;ZD("#secureshare_sendmail_link").attr("href",d).removeAttr("onClick")}return!1},ZDSHAREDIALOG.triggerSendMailDialog=function(){var e="";e=G_OF_OBJ.docId?G_OF_OBJ.docId:G_OF_OBJ.folderIds;var t=(G_OF_OBJ.urlInvoker,ZD("#zd_perma_link_url").val().trim(),G_OF_OBJ.docName);return ZDSHAREDIALOG.showDialogForSendingMail(e,t),!1},ZDSHAREDIALOG.removeOrgPublic=function(e,t){t="secureshare"==t?!0:!1,G_OF_OBJ.updateShareStatus=!0;var s=serviceUrl+"/docs/docsrequest.do?method=removeOrgPublicDocs",i="password_protected="+t+"&docId="+e+"&"+zdcsrfPair;return ZD.ajax({url:s,type:"POST",data:i,success:function(){ZD("#top_share_org").remove(),ZD("#zdc_visibility_text_top").attr("share_type","private"),ZD("#zdc_visibility_text_top").attr("share_type","private").removeClass("zdc-specific zdc-anyoneshare zdc-anyonepasswrd zdc-anyoneinternet").addClass("zdc-specific"),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus()},error:function(){ZDSHAREDIALOG.statusmsg("failure_status","Error While removing the document")}}),!1},ZDSHAREDIALOG.cancelSharedDocumentToUser=function(e,t,s,i,a){var o={};o[zd_js_obj.ok]=function(){ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.confirmCancelSharingToUser(e,t,s)},o[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("frameDiv")};var n="";n=a?zd_js_obj.label_remove_sharing_group:zd_js_obj.label_are_you_sure_remove_sharing_user,ZDDialog.openAlert(zd_js_obj.confirmwsreq,n,!0,o,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02])},ZDSHAREDIALOG.confirmCancelSharingToUser=function(e,t,s){{var i=(ZD(s).closest("tr").attr("sharedType"),ZD(s).closest("tr").attr("groupId"));ZD(s).closest("tr").attr("email")}("null"==t||""==t||void 0==t)&&(t=G_OF_OBJ.folderIds);var a="";params="docId="+t+"&"+zdcsrfPair,void 0==i||""==i?(a=serviceUrl+"/docs/docsrequest.do?method=cancelSharingToUser",params+="&sharedUserName="+e):(a=serviceUrl+"/docs/docsrequest.do?method=cancelSharingToGroup",params+="&groupId="+i),ZD.ajax({url:a,data:params,type:"POST",dataType:"json",complete:function(e){var t=e.responseText;if(void 0!=t&&(t=ZD.trim(t+"")),"TASK_ASSIGNED_TO_DOCUMENT"==t){var i={};i[zd_js_obj.cancel]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert(zd_js_obj.alert,zd_js_obj.label_unable_to_remove_task_assigned,!0,i,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.8)/1.02])}else G_OF_OBJ.updateShareStatus=!0,ZD(s).closest("tr").remove(),ZDSHAREDIALOG.constructEmptyShareDetails(),"zohodocs"==G_OF_OBJ.urlInvoker&&G_OF_OBJ.updateShareStatus&&ZDSHAREDIALOG.updateFolderShareStatus()}})},ZDSHAREDIALOG.constructEmptyShareDetails=function(){if(!ZD("#autofilllist").find("tr").length){var e='<table cellspacing="0" id="zd_notmembershared" cellpadding="0" style="width:100%; height: 100%"> <tbody><tr> <td vertical-align="middle"> <div id="nosharedmembers_div" style="text-align:center;" class="graytxt">'+zd_js_obj.no_collaborators+"</div> </td> </tr></tbody></table>";ZD(".privateshare-list").prepend(e),"FB"!=zd_third_party&&ZD("#nosharedmembers_div").text(zd_js_obj.label_zero_members)}},ZDSHAREDIALOG.getShareDetailsForUploadDocs=function(e){G_COMP_OBJ.isMultiShare||showloadingmsg&&ZDUtils.LoadingMsg(zd_js_obj.loading);var t=serviceUrl+"/docs/docsrequest.do?method=getShareDetails",s="docId="+e;ZD.ajax({url:t,data:s,dataType:"json",type:"GET",success:function(t){ZDSHAREDIALOG.showShareDetails(t,e,G_OF_OBJ.urlInvoker),ZDUtils.hideLoadingMsg()}})},ZDSHAREDIALOG.showDialogForSendingMail=function(e,t){var s={};s[zd_js_obj.sendmail]=function(){ZDSHAREDIALOG.sendPublicLinkViaMail(e,t)},s[zd_js_obj.cancel]=function(){return ZDDialog.closePopUp("securesharedialogdiv"),!1},ZDDialog.showDialogForSendingMail(zd_js_obj.label_email_this_link,!0,s,[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],550);var i="",a="",o="";if(G_COMP_OBJ.isMultiShare){if("undefined"!=typeof FILECHOOSERDIALOG)var n=FILECHOOSERDIALOG.getChoosedDocuments();else var n=ZDUtils.getOwnedSelectedDocs();for(var d=0;d<n.length;d++)void 0!=n[d].file_name&&void 0!=n[d].docId&&(a+=n[d].isFolder?n[d].file_name+" - "+pcUrl+"/folder/"+n[d].docId+"\n \n":n[d].file_name+" - "+pcUrl+"/file/"+n[d].docId+"\n \n",0==d&&(o=ZDUtils.replaceParams(zd_js_obj.subject_send_documents_link_mail_notification,new Array(n[d].file_name,n.length-1))));i=ZDUtils.replaceParams(zd_js_obj.mailbody_multishare_send_doc_link_mail,new Array(userFullName,a))}else a=G_OF_OBJ.isFolderShare?t+" -  "+pcUrl+"/folder/"+e+"\n":t+" -  "+(G_COMP_OBJ.customUrl?G_COMP_OBJ.customUrl:pcUrl+"/file/"+e)+"\n",o=ZDUtils.replaceParams(zd_js_obj.subject_send_document_link_mail_notification,new Array(t)),i=ZDUtils.replaceParams(zd_js_obj.mailbody_share_send_doc_link_mail,new Array(userFullName,a));("everyone_internet"===ZD_G_CurrentVisibility||"secureshare"===ZD_G_CurrentVisibility)&&""!=public_PwdExpiryDate&&void 0!=public_PwdExpiryDate&&(i+="\n Valid till: "+public_PwdExpiryDate),i+="\n\n"+zd_js_obj.thanks_message;var r='<div><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td valign="top"><form onsubmit="return false;" method="POST" id="secureshare_mailform" name="secureshare_mailform"><table width="98%" cellspacing="0" cellpadding="3" border="0"><tbody><tr><td><table width="100%" cellspacing="0" cellpadding="0" border="0"><tbody><tr><td>'+zd_js_obj.label_email_add+'&nbsp;<span class="smallText">('+zd_js_obj.label_emailids_seperated_by_comma+')</span></td></tr><tr><td style="padding-bottom:10px;" class="pad-top"><input type="text" style="width:100%;" value="" class="inputtext graytxt" id="secureshare_emailaddress" name="secureshare_emailaddress"></td></tr><tr><td>Subject</td></tr><tr><td style="padding-bottom:10px;" class="pad-top"><input type="text" style="width:100%;" value="" class="inputtext graytxt" id="zdsubject_publicfield" name="subject_publicfield"></td></tr><tr><td>'+zd_js_obj.message+'</td></tr><tr><td class="pad-top"><textarea style="width:100%;padding:4px;" class="selectoption" cols="52" rows="5" name="linkshare_message" id="linkshare_message"></textarea></td></tr></tbody></table></td></tr></tbody></table></form></td></tr></tbody></table></div>';return ZD("#securesharedialogdiv").html(r),ZD("#linkshare_message").text(i),ZD("#zdsubject_publicfield").val(o),ZD("#secureshare_emailaddress").focus(),!1},ZDSHAREDIALOG.showAlertMessage=function(){alert(zd_js_obj.please_enter_valid_emailid),ZD("#secureshare_emailaddress").focus()},ZDSHAREDIALOG.sendPublicLinkViaMail=function(e,t){var s=ZD("#secureshare_emailaddress").val().trim(),i=s.split(","),a=!0;if(i.length){if(i.length>20)return alert(zd_js_obj.send_doc_link_via_mail_address_limit),ZD("#secureshare_emailaddress").focus(),!1;for(var o=0;o<i.length;o++){if(""!=i[o]&&void 0!=i[o])var n=ZDUtils.isEmailId(i[o]);if(n||(a=!1),!a)return ZDSHAREDIALOG.showAlertMessage(),!1}}else{if(""==s||void 0==s)return ZDSHAREDIALOG.showAlertMessage(),!1;var n=ZDUtils.isEmailId(s);if(!n)return ZDSHAREDIALOG.showAlertMessage(),!1}var d="",r="",l="";if(G_COMP_OBJ.isMultiShare){if("undefined"!=typeof FILECHOOSERDIALOG)var c=FILECHOOSERDIALOG.getChoosedDocuments();else var c=ZDUtils.getOwnedSelectedDocs();for(var o=0;o<c.length;o++)d+=c[o].docId+",",r+=c[o].file_name+",";l=ZD_G_CurrentVisibility}else d=e+",",r=t+",",ZD("#zdc_visibility_text_top").length>0&&(l=ZD("#zdc_visibility_text_top").attr("share_type").trim());var _=encodeURIComponent(ZD("#linkshare_message").val().trim()),p=encodeURIComponent(ZD("#zdsubject_publicfield").val().trim()),u=serviceUrl+"/docs/docsrequest.do?method=sendPublicLinkViaMail";s=s.replace(/\s/g,"");var m="docId="+d+"&docName="+r+"&mailaddress="+encodeURIComponent(s)+"&sharetype="+l+"&subj="+p+"&message="+_+"&"+zdcsrfPair;ZD.ajax({url:u,data:m,dataType:"text",type:"POST",success:function(e){var t=e;""==t||null==t||void 0==t?(ZDDialog.closePopUp("securesharedialogdiv"),G_COMP_OBJ.isMultiShare?ZDSHAREDIALOG.setStatusMessageForVisibilityActions(ZD(".zdc-sharelink"),zd_js_obj.success_msg_for_mail_sent):ZDSHAREDIALOG.setStatusMessageForVisibilityActions(ZD("#sharedialogdiv"),zd_js_obj.success_msg_for_mail_sent)):ZDSHAREDIALOG.processSharedUserDetails(e)},error:function(){ZDDialog.closePopUp("securesharedialogdiv"),alert(zd_js_obj.error_occured)}})},ZDSHAREDIALOG.cancelShareForSelectedUser=function(e,t,s,i){var a=ZD(i).closest("tr").attr("email"),o=serviceUrl+"/docs/docsrequest.do?method=cancelSharingToUser",n="docId="+e+"&sharedUserName="+a+"&"+zdcsrfPair;Dialog.closePopUp("alertDiv"),ZD.ajax({url:o,data:n,type:"POST",success:function(e){e=ZD.trim(e),ZD(i).closest("tr").remove(),ZDSHAREDIALOG.constructEmptyShareDetails(),""!=e&&-1!=e.indexOf("cannot_cancelshare_checkout_done")&&Dialog.feedStatusAlert(zd_js_obj.cannot_cancelshare_checkout_done,"error")}})},ZDSHAREDIALOG.validatePassword=function(e){return""==e?zd_js_obj.validation_empty_password:e.length<6?zd_js_obj.validation_password_less_than_limit:e.length>30?zd_js_obj.validation_password_greater_than_limit:"success"},ZDSHAREDIALOG.showUpgradePopup=function(e,t){var s="sharecollabupgradediv";if(!document.getElementById(s)||null==document.getElementById(s)){var i="<div id='sharecollabupgradediv' style='display:none;'></div>";ZD("body").append(i)}var a=location.protocol,o={};if(o[zd_js_obj.upgrade]=function(){"BAIHUI"==zd_third_party?window.open(a+"//www.baihui.com/docs/340.html","_blank"):window.open(pcUrl+"/showplan.do","_blank")},ZDDialog.showCommonDialog(e,!0,"sharecollabupgradediv",o,[G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.6,G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.6],"450",!0,250,!1),ZD("#zdc_visible_default_hidediv").is(":visible")){var n=parseInt(ZD("#zdc_visible_default_hidediv").css("z-index"));ZD("#sharecollabupgradediv").closest("div.ui-dialog").css({"z-index":n+5})}var d='<p style="line-height:1.5;">'+t+"</p>";ZD("#sharecollabupgradediv").html(d),ZD(".ui-dialog button:first").addClass("custom_button"),ZD("#manageCollabUsersLink").click(function(){ZDDialog.closePopUp("sharecollabupgradediv"),ZDSHAREDIALOG.showManageCollaborators("sharedialog")})},ZDSHAREDIALOG.cancelVisiblityAction=function(){G_COMP_OBJ.isMultiShare&&ZDDialog.closePopUp("sharedialogdiv")},ZDSHAREDIALOG.getMyCollaborators=function(){var e=serviceUrl+"/docs/docsrequest.do?method=getMyCollaborators";return ZD.ajax({url:e,dataType:"json",type:"GET",success:function(e){ZDUtils.hideLoading("mycollabusers_loading");ZD.parseJSON(e);ZDSHAREDIALOG.showMyCollaborators(e)},error:function(){ZDUtils.hideLoading("mycollabusers_loading"),ZDSHAREDIALOG.showMyCollaborators(null)}}),!1},ZDSHAREDIALOG.showManageCollaborators=function(e){var t=void 0!=e&&"sharedialog"==e?!0:!1,s="mycollaboratorslistdiv";if(!document.getElementById(s)||null==document.getElementById(s)){var i="<div id='"+s+"' style='display:none'><div id='mycollabusers_loading'></div></div>";ZD("body").append(i)}var a={};1==t?a[zd_js_obj.label_continue_sharing]=function(){var e=ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-mycollaboratorslistdiv"] button:first').hasClass("disabled");return 1==e?!1:void ZDDialog.closePopUp("mycollaboratorslistdiv")}:a[zd_js_obj.label_done]=function(){var e=ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-mycollaboratorslistdiv"] button:first').hasClass("disabled");return 1==e?!1:void ZDDialog.closePopUp("mycollaboratorslistdiv")},ZDDialog.showCommonDialog(zd_js_obj.manage_my_collaborators,!0,s,a,[G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.6,G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.6],"450",!0,240,!1),ZDUtils.showLoading("mycollabusers_loading",zd_js_obj.loading),ZDSHAREDIALOG.getMyCollaborators(),1==t&&ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-mycollaboratorslistdiv"] button:first').attr("referrer","sharedialog")},ZDSHAREDIALOG.showMyCollaborators=function(e){var t=0,s=[];null!=e&&(t=e.max_collaborators,s=e.collaborators);var i='<div id="mycollabusers_loading"></div>';if(void 0!=s&&null!=s&&s.length>0){i+='<div style="margin-top:10px;"><table width="100%" cellspacing="0" cellpadding="0" class="zd_collabList_rowborder" style="padding:2px 5px 5px 0px" border="0">';for(var a=0;a<s.length;a++){var o=s[a];i+='<tr class="selectedContactDivs already_shared" collaborator_type="'+o.shared_type+'" collaborator_id="'+o.zuid+'" collaborator_email="'+o.email_id+'"><td width="10"><div class="zdc-shareuser_icon" title="'+zd_js_obj.doc_user+'"></div></td><td><span title="'+o.email_id+'">'+o.full_name+'</span> <span class="graytxt" style="padding-left:3px;"></span></td><td width="23"><div class="deletegrey docscursor pad-lft" title="'+zd_js_obj.label_remove_collaborator+'" onclick="ZDSHAREDIALOG.removeMyCollaborator('+o.shared_type+","+o.zuid+",'"+o.email_id+"')\"></div></td></tr>"}i+="</table></div>"}else i+='<div style="margin-top:30px;text-align:center;">'+zd_js_obj.no_collaborators+"</div>";ZD("#mycollaboratorslistdiv").html(i);var n=ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-mycollaboratorslistdiv"] button:first').attr("referrer");void 0!=n&&"sharedialog"==n&&(t>0&&t<=s.length?ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-mycollaboratorslistdiv"] button:first').addClass("disabled"):ZD('div.ui-dialog[aria-labelledby="ui-dialog-title-mycollaboratorslistdiv"] button:first').removeClass("disabled"))},ZDSHAREDIALOG.removeMyCollaborator=function(e,t,s){var i=confirm(zd_js_obj.label_warning_for_remove_collaborator);if(1==i){ZDUtils.showLoading("mycollabusers_loading",zd_js_obj.deleting);var a=serviceUrl+"/docs/docsrequest.do?method=removeMyCollaborator",o="";if(512==e){var n=void 0!=s&&null!=s?encodeURIComponent(s):s;o="collaborator_type="+e+"&collaborator_email="+n+"&"+zdcsrfPair}else o="collaborator_type="+e+"&collaborator_zuid="+t+"&"+zdcsrfPair;ZD.ajax({url:a,data:o,dataType:"json",type:"POST",success:function(e){ZDUtils.hideLoading("mycollabusers_loading");ZD.parseJSON(e);if("success"==e.status){var t=ZD('tr.selectedContactDivs[email="'+s+'"]');void 0!=t&&null!=t&&void 0!=t.length&&t.length>0&&t.remove(),ZDSHAREDIALOG.getMyCollaborators()}else alert(zd_js_obj.label_remove_collaborator_failed)},error:function(){ZDUtils.hideLoading("mycollabusers_loading"),alert(zd_js_obj.label_remove_collaborator_failed)}})}},ZDSHAREDIALOG.grantAccessForDoc=function(e,t,s,i){if(e="zw")for(var a=window.location.search.slice(1).split("&"),o=0;o<a.length;o++){var n=a[o].split("="),d=n[0],r=n[1];("rid"==d||"rid"===d)&&(t=r)}""!=s&&void 0!=s&&("undefined"!=typeof userCanShareExternally?("undefined"!=typeof i?ZDSHAREDIALOG.showShareForm(e,"",!1,{},i,t):ZDSHAREDIALOG.showShareForm(e,t,!1,{ismultishare:!1,doccount:1}),ZD("#zd_initial_sharetextarea").trigger("focus"),ZD("#zd_sharetextarea").val(s+","),ZD("#zd_share_button").removeClass("disabled")):setTimeout(function(){ZDSHAREDIALOG.grantAccessForDoc(e,t,s,i)},1e3))},ZDSHAREDIALOG.getContactsForSearchQuery=function(e,t){var s=[],i=jQuery.grep(docs_myContacts,function(t){var s=ZDUtils.startsWithRegEx(t,e);return s});if(i.length>10)for(var a=0;10>a;a++)s.push(i[a]),t(s);else if(i.length>0)s=i,t(s);else{var o="/docs/docsrequest.do?method=getContactsViaSearch",n="_t="+ZD.now()+"&sqry="+e;ZD.ajax({url:o,data:n,dataType:"json",type:"GET",success:function(i){var a=i.contact_list;if(a.length){ZDSHAREDIALOG.makeUniqueList(a);var o=jQuery.grep(docs_myContacts,function(t){var s=ZDUtils.startsWithRegEx(t,e);return s});if(o.length>10)for(var n=0;10>n;n++)s.push(o[n]);else s=o}t(s)}})}},ZDSHAREDIALOG.shareUnsharedDocument=function(e,t,s,i){var a=serviceUrl+"/api/v2/files/share",o="type=private&resids="+e+"&permission="+t+"&emailids="+s+"&notify=true&ischangepermission=false&"+zdcsrfPair;ZD.ajax({url:a,data:o,dataType:"json",type:"POST",success:function(e){i(e)}})},ZDSHAREDIALOG.changeSharePermission=function(e,t,s,i){var a=serviceUrl+"/api/v2/files/share",o="type=private&resids="+e+"&permission="+t+"&emailids="+s+"&notify=false&ischangepermission=false&"+zdcsrfPair;ZD.ajax({url:a,data:o,dataType:"json",type:"POST",success:function(e){i(e)}})},ZDSHAREDIALOG.commentAndShare=function(e,t,s,i){var a=serviceUrl+"/api/v2/files/share",o="type=commentandshare&resids="+e+"&permission="+t+"&emailids="+s+"&"+zdcsrfPair;ZD.ajax({url:a,data:o,dataType:"json",type:"POST",success:function(e){i(e)}})},ZDSHAREDIALOG.getAllContacts=function(e,t,s){var i=serviceUrl+"/api/v2/files/contacts";if(""!==e){var a="resourceid="+e+"&query="+t+"&"+zdcsrfPair;ZD.ajax({url:i,data:a,dataType:"json",type:"GET",success:function(e){s(e)}})}},function(){ZD.widget("ui.comments",{defaults:{service:"",docId:"",url:"",params:"",docName:"",params:"",authorId:"",authorName:"",indexType:"",groupId:"",docOwner:!0,addReview:!0,isFromImageViewer:!1,isCurrentUserAuthorOfDocument:!0,isNote:!0,reviewId:""},_create:function(){this.options=ZD.extend({},this.defaults,this.options),ZD(this.element).addClass("docs-container docsdialog"),void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),this._getReviews(),this._initDelegate()},_getReviews:function(){var e=this.options.docOwner,t=this.options.isFromImageViewer;if(e===!0){var s=this.element,i=this.options.url,a=this.options.params,o=this;a=a+"&_t="+ZD.now(),ZD.ajax({url:i,data:a,dataType:"html",success:function(e){ZD(s).html(e),ZD(s).scrollTop(ZD(s)[0].scrollHeight),t&&(ZD("#showImageViewerFeedsHeader").show(),ZD(s).children("div:last").css({height:"565px","float":"left",width:"100%"}),ZD(s).find("textarea.showCommentTextArea:last").focus()),o.options.addReview||ZD("#addReviewsDiv").parent().hide()}})}else{var s=this.element,i=this.options.url,a=this.options.params;a=a+"&_t="+ZD.now();var n=this.options.groupId;void 0==n&&(n=""),ZD.ajax({url:i,data:a,type:"POST",success:function(e){ZD("divid").addClass("reviewsDetails").html(e).css({height:"385",overflow:"auto"})}})}},_initDelegate:function(){var e=this;ZD("#commentsdialogdiv").delegate("#comments_popupclose","click",function(){e.destroy(),ZD("#commentsdialogdiv").hide()}),ZD(this.element).delegate(".reviewerIdSpan","click",function(){e.confirmDeleteReviews(this)}),ZD(this.element).delegate(".comtattchIdSpan","click",function(){e.confirmDeleteCommentAttachments(this)}),ZD(this.element).delegate("#CancelCommentSpan","click",function(){e.cancelComment(this)}),ZD(this.element).delegate("#addReviewDiv1","click",function(){e.sharedUserAddReview()}),ZD(this.element).delegate("#reviewTextArea","click",function(t){e.showExpandableTextArea(this,t)}),ZD(this.element).delegate(".reviewedit","click",function(t){e.updateReview(this,t)}),ZD(this.element).delegate("#updateReviewAdd","click",function(t){e.addUpdateReview(this,t)}),ZD(this.element).delegate("#updateReviewCancel","click",function(t){e.hideUpdateReview(this,t)}),ZD(this.element).delegate("#comtimgattach","mouseover mouseout",function(e){"mouseover"===e.type?ZD(this).find(".rd-cls").css("visibility","visible"):"mouseout"===e.type&&ZD(this).find(".rd-cls").css("visibility","hidden")}),ZD(this.element).delegate('input[name="comtattach_file"]',"change",function(){var e=this.files,t=e.length,s=!1,i=ZD("textarea#reviewTextArea").val();i=$.trim(i.replace(/[\t\n]+/g," "));var a=new FormData;a.append("comment",i);for(var o=0;t>o;o++){var n=e[o];fileName=n.name;var d=n.size;if(isproceed=COMMENTS.validateFileSizeandTypeForAttach(s,fileName,d)){-1!=fileName.toLowerCase().indexOf(".zip")&&(fileName=fileName.substring(0,fileName.length-4)+".zip"),tempFileName=fileName;var r=tempFileName.replace(/[`~!@#$%^&*+\?;'",<>]/gi,"-");if($("div#commentattachmentdiv").html(r),$("#commentattachmentspanId").css("display","block"),""!=tempFileName&&void 0!=tempFileName&&"."!=tempFileName){var l=ZD("#zd_user_details").attr("csrfparamName"),c=ZD("#zd_user_details").attr("csrftoken");"undefined"==typeof c&&(c=zdcsrfPair.split("=")[1]),a.append("comtattach_file",n),a.append(l,c),G_FormDataArray[G_UploadIndexCounter]=a,G_FileDataArray[G_UploadIndexCounter]=n,G_UploadIndexCounter+=1}}}})},updateReview:function(e){if(0===$("textarea#editreview").length){var t=$(e).attr("review"),s=$(e).data("rating"),i=$(e).data("fav"),a="#"+t+"_reviewerLatestComment",o=$(a).html(),n='<div id="updateTextArea"><textarea cols="30" rows="1" wrap"hard" onkeyup="COMMENTS.do_resize(this);" maxlength="10000" style="width: 98%; padding-top: 5px; padding-bottom: 5px;" data-rating='+s+" reviewId="+t+" data-fav="+i+" tempReview="+a+' class="selectoption" id="editreview"></textarea><div id="updateButton" style="padding-top: 5px"><button id="updateReviewAdd" style="float:left;font-weight: normal; padding: 5px 7px;" class="ui-upgradebtn marglft smallText">'+zd_js_obj.update+'</button><button id="updateReviewCancel" style="float:left;margin-left:10px;font-weight: normal;padding: 5px 7px;" class="ui-upgradebtn marglft smallText">'+zd_js_obj.cancel+"</button></div></div>";$(a).parent().prepend(n),$("#editreview").focus().text(o).trigger("keyup"),$(a).hide()}},addUpdateReview:function(){var e=this,t=$("textarea#editreview").val(),t=$.trim(t.replace(/[\t\n]+/g," "));if(isValidReview=COMMENTS.validateComment("textarea#editreview")){var s=($("textarea#editreview").attr("tempReview"),$("textarea#editreview").attr("reviewId")),i=this.options.docId,a=ZD("div#"+i).data("shareType"),o=this.options.authorId,n=this.options.service,d="update",r='<button style="float:left;" id="comment_loading_button" class="ui-status-icon ui-button ui-widget ui-state-default ui-corner-all ui-button-disabled ui-state-disabled ui-button-text-icon-primary"><span class="ui-button-icon-primary ui-icon  ui-icon-loader1"></span><span class="ui-button-text">'+zd_js_obj.updating+"</span></button>&nbsp;&nbsp;&nbsp;";ZD("#updateReviewAdd").remove(),ZD("#updateButton").prepend(r);var l="/docs/comments.do",c="action=addComment&docId="+i+"&service="+n+"&authorId="+o+"&indexType=undefined&comment="+encodeURIComponent(t)+"&rating=0&favorite="+!1+"&sharedType="+a+"&commentType="+d+"&reviewId="+s+"&"+zdcsrfPair;ZD.ajax({url:l,type:"POST",data:c,complete:function(t){var s=t.statusText;"success"===s&&e._getReviews()}})}else $("textarea#editreview").focus()},hideUpdateReview:function(){var e=$("textarea#editreview").attr("tempReview");$(e).show(),$("#updateTextArea").remove()},confirmDeleteReviews:function(e){if(0===$("textarea#editreview").length){var t=(ZD(e).attr("reviewerid"),ZD(e).attr("reviewid")),s=this.element,i={};i[zd_js_obj.label_yes]=function(){ZD(s).comments("deleteReview",t)},i[zd_js_obj.label_no]=function(){ZDDialog.closePopUp("frameDiv")};var a=zd_js_obj.confirm_delete_comment;ZDDialog.openAlert(zd_js_obj.confirmwsreq,a,!0,i,"center")}},deleteReview:function(e){var t=this;ZDDialog.closePopUp("frameDiv");var s="/docs/comments.do",i=this.options.docId,a=ZD("div#"+i).data("shareType"),o="action=deleteReview&docId="+this.options.docId+"&service="+this.options.service+"&authorId="+this.options.authorId+"&reviewedBy="+e+"&sharedType="+a+"&"+zdcsrfPair;ZD.ajax({url:s,type:"POST",data:o,complete:function(e){var s=e.responseText;if(-1!=s.indexOf("success"))t._getReviews();else{var i={};i[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.problem_while_deleting_review,!0,i,"center")}}})},confirmDeleteCommentAttachments:function(e){var t=ZD(e).attr("commentattachid"),s=this.element,i={};i[zd_js_obj.label_yes]=function(){ZD(s).comments("deleteCommentAttachment",t)},i[zd_js_obj.label_no]=function(){ZDDialog.closePopUp("frameDiv")};var a=zd_js_obj.confirm_delete_comment_attachment;ZDDialog.openAlert(zd_js_obj.confirmwsreq,a,!0,i,"center")},deleteCommentAttachment:function(e){var t=this;ZDDialog.closePopUp("frameDiv");var s="/docs/comments.do",i=(this.options.docId,"action=deleteCommentAttachment&docId="+this.options.docId+"&service="+this.options.service+"&authorId="+this.options.authorId+"&commentAttachId="+e+"&"+zdcsrfPair);ZD.ajax({url:s,type:"POST",data:i,complete:function(e){var s=e.responseText;if(-1!=s.indexOf("success"))t._getReviews();else{var i={};i[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.problem_while_deleting_review,!0,i,"center")}}})},validateComment:function(e){var t=ZD(e).val();if(t.length>1e4){var s={};return s[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.validation_for_comment,!0,s,"center"),ZD(e).focus(),!1}return!0},cancelComment:function(e){var t=ZD(e).attr("commentId"),s=ZD(e).attr("commenterId"),i=(ZD(e).attr("reviewerId"),ZD(e).attr("reviewId")),a={},o=this.element;return a[zd_js_obj.label_yes]=function(){ZD(o).comments("deleteComment",i,t,s)},a[zd_js_obj.label_no]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.confirm_delete_comment,!0,a,"center"),!1},deleteComment:function(e,t,s){var i=this,a=ZD("#CancelCommentSpan").attr("groupid");ZDDialog.closePopUp("frameDiv");var a="",o=this.options.docId,n=ZD("div#"+o).data("shareType"),d="/reviews.do",r="action=deleteComment&commenterId="+s+"&docId="+this.options.docId+"&service="+this.options.service+"&authorId="+this.options.authorId+"&groupId="+a+"&reviewedBy="+e+"&commentId="+t+"&"+csrfNAME+"="+getCsrfTokenFromCookie(csrfCookieName)+"&sharedType="+n;ZD.ajax({url:d,type:"POST",data:r,complete:function(e){var s=e.responseText;if(-1!=s.indexOf("success")){var a="table2_"+t,o=ZD(i.element).attr("id");ZD("#"+a,"#"+o).remove()}else{var n={};n[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.problem_while_deleting_comment,!0,n,"center")}}})},sharedUserAddReview:function(e){void 0==e&&(e="");var t=this,s=COMMENTS.validateComment(ZD("textarea#reviewTextArea")),i=ZD("#reviewTextArea").attr("tempfavorite");if(s){var a=ZD("div#favoritespan").attr("class");"active-favIcon"==a?a=!0:"inactive-favIcon"==a&&(a=!1);var o=ZD("textarea#reviewTextArea").val();if(o=$.trim(o.replace(/[\t\n]+/g," ")),isIntegWS&&($("#reviewTextArea").mentionsInput("val",function(e){streamCont=e.trim()}),o=streamCont),""===o){var n=function(){ZD("textarea#reviewTextArea").focus(),ZD("textarea#reviewTextArea").addClass("graytxt")},d={};return d[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.validation_for_add_comment,!0,d,"center"),void Dialog.alert(js_obj.validation_for_add_comment,n)}var r='<button id="comment_loading_button" class="ui-status-icon ui-button ui-widget ui-state-default ui-corner-all ui-button-disabled ui-state-disabled ui-button-text-icon-primary"><span class="ui-button-icon-primary ui-icon  ui-icon-loader1"></span><span class="ui-button-text">'+zd_js_obj.label_adding_comment+"</span></button>&nbsp;&nbsp;&nbsp;";ZD("#addReviewDiv1").remove(),ZD("#commentButton").prepend(r);for(var l=ZD("#ratingtd").find("div"),c=0,_=0,p=l.length;p>_;_++)"active-starIcon flleft"==ZD(l[_]).attr("class")&&(c+=1);var u=this.options.docId,m=ZD("div#"+u).data("shareType"),v="add";url="/docs/comments.do?action=addComment&docId="+this.options.docId+"&service="+this.options.service+"&authorId="+e+"&indexType=undefined&rating="+c+"&favorite="+i+"&sharedType="+m+"&commentType="+v;var D=new XMLHttpRequest,h=D.upload;h.fileIndex=_,h.downloadStartTime=(new Date).getTime(),h.currentStart=h.downloadStartTime,h.currentProgress=0,h.startData=0;{_+"_new_"+$.now()}if(D.onreadystatechange=function(){4==this.readyState&&("undefined"!=typeof PC&&PC.hideLoading(),G_UploadIndexCounter=0,G_FormDataArray=[],G_FileDataArray=[],t._getReviews())},D.open("POST",url),"undefined"!=typeof FormData&&void 0!==G_FormDataArray[_])D.send(G_FormDataArray[_]);else{var f=new FormData,g=ZD("#zd_user_details").attr("csrfparamName"),O=ZD("#zd_user_details").attr("csrftoken");"undefined"==typeof O&&(O=zdcsrfPair.split("=")[1]),f.append(g,O),f.append("comment",o),D.send(f)}}},showExpandableTextArea:function(e,t){ZD("#addReviewButton").show();var s=t?t:window.event;ZD("textarea#reviewTextArea").removeClass("graytxt"),ZD(e).focus(),s.preventDefault(),s.stopPropagation()},destroy:function(){ZD.Widget.prototype.destroy.apply(this,arguments),this.element.unbind("."+this.widgetName),ZD(this.element).undelegate();var e=this.element,t=ZD(e).children();ZD(t).each(function(e,t){ZD(t).undelegate(),ZD(t).empty().remove()})}}),ZD.extend(ZD.ui.reviews,{version:"1.8"})}(jQuery),COMMENTS.showCommentsDialog=function(e){0==ZD("#commentsdialogdiv").length&&ZD("body").append('<div id="commentsdialogdiv" class="docsdialog" style="display:none">');var t='<div class="cmt-notesblock"><div class="ts-notic cmt-notifposition" style="left:200px;display:none;">&nbsp;</div><div class="cmt-topblock"><span class="ts-tittle">'+zd_js_obj.label_comments+'</span><span title="" id="comments_popupclose" style="cursor:pointer;" class="flright deletegrey cursor"></span></div><div id="commentscontainer" style="height:350px;overflow:auto;"><div style="margin-top:50px;" align="center" class="hidediv"><span style="bottom: 3px;margin-left: 10px;position: relative;">Loading</span></div></div><div class="ts-noticbtm cmt-notifpositionbtm" style="left:200px;display:none;">&nbsp;</div></div>';ZD("#commentsdialogdiv").html(""),ZD("#commentsdialogdiv").append(t);var s=e.positionObj[0],i=e.positionObj[1];ZD("#commentsdialogdiv").css({top:i,left:s,position:"absolute","z-index":"9999"}),ZD("#commentsdialogdiv").show();var a="/docs/comments.do",o=e.resid,n="",d=e.service,r="",l="action=getAllComments&docId="+o+"&service="+d;ZD("#commentscontainer").comments({docId:o,addReview:!1,service:d,url:a,docName:n,authorId:r,params:l})},COMMENTS.validateComment=function(e){var t=ZD(e).val();if(t=ZD.trim(t),""===t){var s={};return s[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.validation_for_add_comment,!0,s,"center"),!1}if(t.length>1e4){var s={};return s[zd_js_obj.label_ok]=function(){ZDDialog.closePopUp("frameDiv")},ZDDialog.openAlert("",zd_js_obj.validation_for_comment,!0,s,"center"),ZD(e).focus(),!1}return!0},COMMENTS.showReviewPopup=function(e){var t=actionsWidget.action("getSelectedDocs"),s=SCR_HT,i=s/2,a=ZD(e.target).closest("span.reviewsIcon_css"),o=a.offset(),n=o.left-200,d=o.top;if(d>i){var r=d-397;ZD("#pc_reviewsdiv").css({top:r,left:n}),ZD("#review_top_arrow").hide(),ZD("#review_bottom_arrow").show()}else{var l=d+27;ZD("#pc_reviewsdiv").css({top:l,left:n}),ZD("#review_bottom_arrow").hide(),ZD("#review_top_arrow").show()}ZD("#pc_reviewsdiv").show();var c="docs/comments.do",_=t[0].docId,p=t[0].encUrlFile_name,u=t[0].service,m=t[0].authorId,v="action=getAllComments&docId="+_+"&service="+u;ZD("#pc_reviewscontainer").comments({docId:_,addReview:!1,service:u,url:c,docName:p,authorId:m,params:v})},COMMENTS.getAllReviews=function(e,t,s,i,a){var o="docs/comments.do",n="action=getAllComments&docId="+i+"&service="+t;ZD("#"+e).reviews("destroy"),ZD("#"+e).comments({docId:i,service:t,url:o,docName:s,authorId:a,params:n,isFromImageViewer:!0})},COMMENTS.do_resize=function(e){for(;e.rows>1&&e.scrollHeight<e.offsetHeight;)e.rows--;for(;e.scrollHeight>e.offsetHeight;)e.rows++;e.rows++},COMMENTS.removeCommentAttachment=function(){G_FormDataArray=[],G_UploadIndexCounter=0,$("div#commentattachmentdiv").html(""),$("#commentattachmentspanId").css("display","none")},COMMENTS.openImagePreview=function(e,t,s){ZDDialog.showPreviewImg(e,t,s)},COMMENTS.downloadCommentAttachment=function(e){e=PC_URL+e,ZDDialog.closePopUp("dialogdiv"),ZDDialog.showStatusDialog(js_obj.download,!0,"center",550,150),$("#statusdialogdiv").html('<div style="display:block;z-index:1002;height:100%;"><table width="100%" height="100%" cellspacing="0" cellpadding="3"><tr><td nowrap="nowrap" align="center"><span class="lightbluetxt smallHeading boldText">'+js_obj.download_progress+"<blink>..</blink></span></td></tr></table></div>"),setTimeout(function(){ZDDialog.closePopUp("statusdialogdiv")},2e3),opera?location.href=e:$("iframe#docPropDownloadIframe").attr("src",e)},COMMENTS.validateFileSizeandTypeForAttach=function(e,t,s){var i=!0;if(s){if(s>52428800)return alert(ZDUtils.replaceParams(js_obj.file_size_exceeds_50_MB,new Array(t))),!1}else if(chrome7||safari5||ff4)return alert(ZDUtils.replaceParams(js_obj.msg_uploading_empty_file,[t])),!1;return i},COMMENTS.loadTextAreaAutoComplete=function(e){e.mentionsInput({onDataRequest:function(e,t,s){var i=_.filter(G_Project_Users,function(e){var s=ZDUtils.matchFullNameForCommentMentions(e,t);return""===s||void 0===s?!1:s});s.call(this,i.slice(0,5))}})},COMMENTS.openCommentAttachImagePreview=function(e,t,s,i,a){var o={res_id:t,res_type:s,service:"docs",previewUrl:i,imageName:a};ZD("#explorergrid").trigger("openFilePreviewCall",o),ZD("#fileviewer").is(":visible")&&ZD("#fileviewer").trigger("openFilePreviewCall",o)},function(e){e.widget("ui.DocsFileUploader",{defaults:{service:"zdocs",container_id:"",fileLimit:3,maxFileSize:100,fileSizeInByte:1024,docs_url:"",udserver_url:"",permaLink:"",doc_conversion:!1,ie_url:"",folderId:"-1",workSpaceId:"",libraryId:"",callback:"",ieParams:"",udserver_upload:!0,zsoid:"",progresscallbck:"",UploadStatusObj:{},uploadto:"",handback:"",fileType:"",params:{isUploadStatus:!1,totalFilesCount:1,sharedType:""}},_create:function(){this.options=e.extend({},this.defaults,this.options),this.options.permaLink=this.options.docs_url;var t="?";for(var s in this.options.params)t=t+s+"="+this.options.params[s]+"&";t=""!=this.options.workSpaceId&&"-1"!=this.options.folderId?t+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId+"&isWSsubFolder=true&workSpaceUpload=true&workSpaceId="+this.options.workSpaceId:""!=this.options.libraryId&&"zdocs"===this.options.service?t+"workSpaceId="+this.options.libraryId+"&isWSsubFolder=false&folderId=-1&workSpaceUpload=true&libraryId="+this.options.libraryId:""!=this.options.workSpaceId&&"-1"===this.options.folderId?t+"doc_conversion="+this.options.doc_conversion+"&workSpaceUpload=true&folderId="+this.options.workSpaceId:t+"doc_conversion="+this.options.doc_conversion+"&folderId="+this.options.folderId,this.options.ie_url=this.options.docs_url,"zdocs"===this.options.service||"zwriter"===this.options.service?this.options.docs_url=this.options.docs_url+"/dndupload.do"+t:"cms"===this.options.service?this.options.docs_url=this.options.docs_url+"/ws/wsdndupload.do?zsoid="+this.options.zsoid+"&updateDoc=false&workSpaceId="+this.options.workSpaceId+"&folderId=-1&zsoidservice="+this.options.service:"zcrm"===this.options.service&&(this.options.url=this.options.url+t),this.options.ieParams=t,this._buttonInit()},_buttonInit:function(){var t=this;if(void 0==zd_js_obj||""==zd_js_obj){var s=function(){t._buttonInit()};return t.getI18N(s,t.options.docs_url),!1}if(this.options.isComp)""===this.options.fileType||"all"===this.options.fileType?e("#linkdocsdialogdiv").append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"images"===this.options.fileType?e("#linkdocsdialogdiv").append('<input type="file" accept="image/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'):"videos"===this.options.fileType&&e("#linkdocsdialogdiv").append('<input type="file" accept="video/*" id="zd_UploadButton" name="multiupload_file" value="" style="visibility:hidden;" multiple>'),e(this.element).click(function(){e("#zd_UploadButton").click()});else{e(this.element).append('<input type="file" id="zd_UploadButton" name="multiupload_file" value="" style="opacity:0;position:absolute;left:-2000px;" multiple>');var i=e(this.element).width();e("#zd_UploadButton").css("width",i),e(this.element).hover(function(){e("#zd_UploadButton").css("left","0px")},function(){e("#zd_UploadButton").css("left","-2000px")})}var t=this;e("#zd_UploadButton").bind("change",function(){""===t.options.container_id&&""===t.options.callback&&e("body").append('<table id="zd_contain"></table>');var s=t.options.docs_url,i=navigator.appVersion.split(";"),a=i[1],o=10;if(void 0!==a&&(o=parseInt(a.replace("MSIE ",""))),"Microsoft Internet Explorer"===navigator.appName&&(t.options.udserver_upload=!1),"Microsoft Internet Explorer"===navigator.appName&&9>=o){{e("#zd_UploadButton").attr("value")}curFileElement=e("#zd_UploadButton");var n=(new Date).getTime(),d="target"+(new Date).getTime(),r=e("#zd_UploadButton").parent(),l=e("#zd_UploadButton").clone();r.append(l);var c=e("<div />").appendTo("body");c.attr("id","uploadfilediv"),c.attr("height","1%");var _=e("<form></form>");_.attr({id:"form-"+n,target:d,name:"form-"+n,method:"POST",encType:"multipart/form-data",encoding:"multipart/form-data"}),_.css({margin:0,display:"none"}),_.append(curFileElement);var p=e('<iframe name="'+d+'">').attr({height:"0",width:"0",id:d}).css("display","none");e("body").append(p),e(c).append(_);var u=e("#uploadfilediv"),m=u.children("form"),v={};v.uid="docsUploadWidget",v.callbck=t.options.callback;var D=t.options.ie_url+"/uploadsingle.do"+t.options.ieParams+"&refFileElementId=docsUploadWidget"+t.options.callback;e(m[0]).attr("action",D),m[0].submit()}else{var h=this.files,f=h.length;f>t.options.fileLimit&&(f=t.options.fileLimit),f>100&&(f=100);for(var g=0;f>g;g++)t.docUpload(h[g],h[g].size,h[g].name,s,g)}})},getI18N:function(t,s){var i="https://"+s+"/docs/zduserdetails.do";e.ajax({url:i,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(s){e("#zd_user_details").remove(),e("body").append(s),void 0!=t&&""!=t&&t()}})},updateProgress:function(e,t,s,i){var a=this;if(t.lengthComputable){var o=Math.round(100*t.loaded/t.total);if(e.currentProgress!=o){e.currentProgress=o,a.fileUploadProgressUpdated(i,e.fileName,e.fileSize,e.currentProgress,s);var n=(new Date).getTime(),d=n-e.currentStart;if(d>3e3){{t.loaded-e.startData}e.startData=t.loaded,e.currentStart=n,e.currentStart=n}}}},fileUploadProgressUpdated:function(e,t,s,i){var a=this,o=i/100*100;"function"==typeof a.options.progresscallbck&&a.options.progresscallbck(o,t,s,e)},cancelUpload:function(e){var t=this;t.options.UploadStatusObj[e].abort()},docUpload:function(t,s,i,a,o){var n=this;"cms"===n.options.service&&(a=n.options.permaLink+"/ws/corswsdndupload.do?zsoid="+n.options.zsoid+"&updateDoc=false&workSpaceId="+n.options.workSpaceId+"&folderId="+n.options.folderId+"&zsoidservice="+n.options.service);var d=s/(n.options.fileSizeInByte*n.options.fileSizeInByte);if(d>n.options.maxFileSize)return alert(ZDUtils.replaceParams(zd_js_obj.file_chooser_file_size_is_greater_than_limit,[i,n.options.maxFileSize,"MB"])),!1;var r=new XMLHttpRequest,l=r.upload;l.fileIndex=o,l.fileName=i,l.fileSize=d,l.downloadStartTime=(new Date).getTime(),l.currentStart=l.downloadStartTime,l.currentProgress=0,l.startData=0;var c=o+"_new_"+e.now();if(l.upload_id=c,l.addEventListener("progress",function(e){"zcrm"===n.options.service?n.updateProgress(l,e,"CR",c):"cms"===n.options.service&&n.updateProgress(l,e,"cms",c)},!1),r.fileName=i,r.withCredentials=!0,"withCredentials"in r){if(n.options.udserver_upload){r.open("POST",zd_udserverurl+"/webupload",!0),r.setRequestHeader("Connection","Keep-Alive"),r.setRequestHeader("Content-type",t.type),r.setRequestHeader("x-service",zd_udservicekey),"zcrm"===n.options.service?(r.setRequestHeader("invoker","CR"),r.setRequestHeader("x-uploadto",n.options.uploadto)):"cms"===n.options.service?(r.setRequestHeader("invoker","cms"),r.setRequestHeader("x-cli-service-name",G_LD_OBJ.iamServiceName)):(r.setRequestHeader("invoker","Upload"),r.setRequestHeader("x-uploadTo","myfolders")),r.setRequestHeader("x-streammode","1"),r.setRequestHeader("upload-id",o+"_new_"+e.now()),r.setRequestHeader("x-content_type",t.type),r.setRequestHeader("x-filename",encodeURIComponent(t.name)),r.setRequestHeader("x-doc_conversion",!1),r.setRequestHeader("x-folderId",n.options.folderId),""!==n.options.workSpaceId&&void 0!==n.options.workSpaceId&&r.setRequestHeader("x-wsId",n.options.workSpaceId),""!==n.options.zsoid&&void 0!==n.options.zsoid&&r.setRequestHeader("x-zsoid",n.options.zsoid),r.setRequestHeader("charset","utf-8"),r.setRequestHeader("Content-Length",t.size);var _="";"zwriter"===n.options.service?_="WR":"zsheet"===n.options.service?_="ST":"zshow"===n.options.service?_="SW":"zbooks"===n.options.service?_="ZB":"zmail"===n.options.service?_="VO":"zcrm"===n.options.service?_="CR":"zplanner"===n.options.service?_="PL":"cms"===n.options.service&&(_="ZS"),r.setRequestHeader("x-notifyto",_),r.send(t)}else{var p=new FormData;p.append("multiupload_file",t),p.append(docsCSRFParamNAME,getDocsCsrfTokenFromCookie(docsCSRFCookieName)),r.open("POST",a,!0),r.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var t=this.response;e("body").append(t);var s=n.options.permaLink+"/file/"+e("#successdndmessagediv").attr("docId");e(n.element).text(zd_js_obj.file_chooser_label_upload_to_docs);var i="<a href="+s+' name="filelink" id="filelink">'+this.fileName+"</a>";if(e("#theImg").remove(),e(n.element).unbind("click"),e(n.element).bind("click",function(){e("#zd_UploadButton").click()}),e("#result").css("display","block"),""!=n.options.container_id&&""===n.options.callback)e("#"+n.options.container_id).append(i);else if(""!=n.options.callback&&"function"==typeof n.options.callback){var a="";a=""!=n.options.handback?e("#successdndmessagediv").attr("docId")+n.options.handback:e("#successdndmessagediv").attr("docId"),n.options.callback(a)}else e("#zd_contain").append("<tr><td>"+i+"</td></tr>");e("#successdndmessagediv").remove()}},r.send(p)}e(n.element).unbind("click"),e(n.element).text(zd_js_obj.file_chooser_label_uploading),e("#theImg").remove()}},_destroy:function(){e.widget.prototype.destroy.call(this)}})}(jQuery),"undefined"!=typeof Collaboration&&(Collaboration.prototype.constructor.handleCrossProductMessage=function(e){return function(){if("UDSERVER_UPLOAD"===arguments[1].action){var t=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var e=$(this).data("DocsFileUploader");e.options.isComp&&($(e.element).unbind("click"),$(e.element).bind("click",function(){$("#zd_UploadButton").click()}));var s=e.options.callback;s(t.resourceId)})}else if("CREATE_THUMBNAIL"==arguments[1].action){var t=arguments[1];jQuery(":data(DocsFileUploader)").each(function(){var e=$(this).data("DocsFileUploader");if(e.options.isComp){var s=e.options.permaLink+"/api/v2/files/properties?action=jsonobject&crossdomain=true&resourceid="+t.resourceId+"&"+zdcsrfPair;void 0!==G_LD_OBJ&&(s+="&accessService="+G_LD_OBJ.urlInvoker+"&zsoid="+G_LD_OBJ.zsoid),ZD.ajax({url:s,datatype:"json",xhrFields:{withCredentials:!0},success:function(e){ZD("#"+e.res_id).html(""),ZD("#"+e.res_id).append('<div style="width:75px;height:75px;"><img src="'+e.preview_url+"&x-cli-service-name="+G_LD_OBJ.iamServiceName+'" style="height:75px;width:75px;" onerror="LINKDOCS.imgLoadingError(\''+e.no_preview_class+'\',this);"></div><div style="height:18px"><p style="font-size:small;margin-top:0px;height:18px;width:81px;overflow:hidden;margin-left:-3px;white-space: nowrap;" title="'+e.enc_res_name+'">'+e.enc_res_name+"</p></div>")}})}})}return e.apply(this,arguments)}}(Collaboration.prototype.constructor.handleCrossProductMessage)),TASKS.showTasksDialog=function(e){if("FREE_PLAN_TYPE"==zdcomp_userType)return void ZD(document).trigger("cannotaddtask.zdocs");void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth();var t="/api/v2/files/workflows?action=resourcetask&resid="+e,s=!1;ZDocs.ajax(t,{type:"POST"}).then(function(t){for(var i=0;i<t.documenttasks.length;++i)if("Approve"==t.documenttasks[i].tasktype){s=!0;break}1==s?TASKS.alreadyTaskAdded(e):TASKS.constructTasksDialog(e)},function(){})},TASKS.alreadyTaskAdded=function(){return ZD(document).trigger("approvalalreadyadded"),!1},TASKS.constructTasksDialog=function(e){G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),G_OF_OBJ.urlInvoker="",G_OF_OBJ.docId="",G_OF_OBJ.folderIds="",G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1;var t='<div id="addtask_dialog"><div id = "addtask_table"> <div id = "collaborators"><label class = "applabel">  Add Approvers </label><input type = "text" class = "zd-input zd-input-cf appinput" id="email_id" placeholder="Add users by name/email"  /></div><label class = "applabel">  Due Date </label><input name = "dp" placeholder = "Choose due date" id = "workflow_datepicker" type="text" style = "width:180px;" class = "appinput zd-input zd-input-cf" ><label class = "applabel"> Approval Message </label><textarea class = "apptextarea" style="width: 475px;" placeholder="Add your message to approver" id="taskcommentarea"></textarea></div> <div class="zd-dialog-buttonset" style = "margin-top:30px;"><button id="zd_cancel_task_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" style = "margin-left:10px;float:right">Cancel</button><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="zd_task_button" style="float:right;" >Initiate and Send</button></div> </div>';ZD("body").append(t),ZDDialog.showCommonDialog("Send for Approval",!0,"addtask_dialog","",[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],"auto",!0,"auto",!1,550,350),TASKS.callback(e)},TASKS.callback=function(e){G_OF_OBJ.autocomplete_selectValue="",CA.initializeAutoCompleteWithPhoto(docs_myContacts,!1,"email_id"),ZD("#addtask_dialog").delegate("#email_id","keydown",function(){""==ZD("#email_id").val()&&(G_OF_OBJ.autocomplete_selectValue="")}),ZD(".ui-dialog-titlebar-close").click(function(){G_OF_OBJ.autocomplete_selectValue="",ZD("#addtask_dialog").remove(),ZD("#task_info_dialog").remove()}),ZD("#workflow_datepicker").datepicker({minDate:0}),ZD("#ui-datepicker-div").addClass("zd-containerclass_datepicker"),ZD("#zd_task_button").click(function(){TASKS.addTaskConfirm(e)}),ZD("#zd_cancel_task_button").click(function(){G_OF_OBJ.autocomplete_selectValue="",ZD("#addtask_dialog").dialog("close"),ZD("#addtask_dialog").remove()}),ZD(".ui-dialog").delegate("","keydown",function(e){27==e.keyCode&&(ZD("#addtask_dialog").dialog("close"),ZD("#addtask_dialog").remove())})},TASKS.addTaskConfirm=function(e){var t,s=ZD("#workflow_datepicker").val(),i=ZD("#taskcommentarea").val(),a=1,o="Approval";if(0==a||1==a){for(var n=ZD("#email_id").val(),d=n.length,r=0;r<n.length;++r)if(","==n[r]){d=r;break}for(var l="",c=!1,_=-1,r=0;d>r;++r)if("<"==n[r]){c=!0,_=r+1;break}if(1==c)for(var r=_;d>r&&">"!=n[r];++r)l+=n[r];else l=n.substr(0,d);ZD("#email_id").val(""),t="/api/v2/files/workflows?action=createmanualwf&resid="+e+"&assignee="+l+"&wfduedate="+s+"&wfdesc="+i+"&wftype="+a+"&wfname="+o+"&"+zdcsrfPair}else t="/api/v2/files/workflows",params="action=createmanualwf&resid="+e+"&wfduedate="+s+"&wfdesc="+i+"&wftype="+a+"&wfname="+o+"&"+zdcsrfPair;ZD.ajax({url:t,dataType:"json",type:"POST",success:function(e){"TASK_ADDED_SUCCESSFULLY"===e.response.result.TaskDetails.MESSAGE?(ZD("#addtask_dialog").dialog("close"),ZD("#addtask_dialog").remove(),ZD(document).trigger("taskadded.zdocs",0),ZD(document).trigger("approvaladded",0)):(ZD("#addtask_dialog").dialog("close"),ZD("#addtask_dialog").remove(),ZD(document).trigger("taskadded.zdocs",1),ZD(document).trigger("approvaladded",1))},error:function(){ZD("#addtask_dialog").dialog("close"),ZD("#addtask_dialog").remove(),ZD(document).trigger("taskadded.zdocs",1),ZD(document).trigger("approvaladded",1)}})},TASKS.showViewTasks=function(e,t){zdcsrfPair=ZD("#zd_user_details").attr("csrfparamName")+"="+ZD("#zd_user_details").attr("csrftoken");var s,i,a,o,n,d,r,l,c,_,p,u,m="/api/v2/files/workflows?action=resourcetask&resid="+e+"&"+zdcsrfPair,v=!1;ZD.ajax({url:m,dataType:"json",type:"POST",success:function(m){for(var D=0;D<m.documenttasks.length;++D)if("Approve"==m.documenttasks[D].tasktype){u=m.documenttasks[D].authorname,_=m.documenttasks[D].assignmailid,s=m.documenttasks[D].assignusername,i=m.documenttasks[D].duedate,a=m.documenttasks[D].taskdesc,wfDocId=m.documenttasks[D].wfdocid,o=m.documenttasks[D].taskid,authorid=m.documenttasks[D].authorid,c=m.documenttasks[D].assignzuid,n=m.documenttasks[D].doctaskid,d=m.documenttasks[D].docname,r=m.documenttasks[D].ownertaskid,l=m.documenttasks[D].doctaskid,v=!0,p=m.documenttasks[D].taskstatus;break}if(0==v){var h='<div id = "owner_view_task" class = "approval-preview"><div id = "after_delete"><h3> Approval Details </h3> <p class = "no-approval"> There is no approval assigned to this file yet. </p> <p id = "send_for_approval_link" class = "cursor zd-link align-center"> Send for approval </p> </div></div>';ZD(".zd-preview-approval").empty(),ZD(".zd-preview-approval").append(h),ZD(".zd-preview-approval").show(),ZUID!=t&&ZD("#send_for_approval_link").empty(),TASKS.deleteTaskCallBack(e,o)}else{var f=(TASKS.getResClassName(d),s);if(s.length>7&&(f=s.substr(0,7)+"..."),ZUID==authorid){var h='<div id = "owner_view_task" class="approval-preview"><h3> Approval Details <a id="delete_approval_button" class="fright" style="height:30px;padding:4px 10px;"><svg class="trash-icon"><use  xlink:href="#svg-action-trash"></use></svg></a>  </h3><ul class="taskbase-preview"><li class="task-list"> <div id = "approval" class="tasktile"><div class="fleft img"><img src="'+TASKS.getPhotoUrl(authorid)+'"></div><div class="taskcntnt fleft" style="width:305px;"><p>You<span class="zd-tuah"> have sent the file to </span>'+s+'<span class="zd-tuah"> for approval due set on</span><span style = "display: inline"> <span id = "approval_date">'+i+'</span><span id = "to_edit_date" style = "display: none"> <input class = "appinput" id = "edited_date" value = "'+i+'"> </span><span id = "edit_approval_date" class = "cursor zd-link" style = "color:blue"> Edit </span> <span id = "save_edited_date" class = "cursor zd-link" style = "display:none">Save </span></span> </p></div> <div class="tskdesc"><span id = "approval_desc" stye = "display: inline">'+a+'</span><span id = "to_edit_desc" style="display:none"><textarea class = "apptextarea" id = "edited_desc">'+a+'</textarea></span><span id = "edit_approval_desc" class = "cursor zd-link" style="color:blue"> Edit </span><span id = "save_edited_desc" class = "cursor zd-link" style = "display:none">Save </span> </div></li></ul><div class="approval-response"><img src="'+TASKS.getPhotoUrl(c)+'" height = "25" width = "25"><p class="approval-info"> <b>'+f+' </b> - Pending Approval </p>  <button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary fright" id = "resend_approval" style = "display: none" >Resend</button>  </div> <div class = "approval_action_pane" style = "display: none"> <div class="check-wrap zd_sharelabelcontainer"><input id="zd_notify_checkbox" type="checkbox" name="check" value="" class="zd-checkbox" checked=""><label style="padding-left:20px;" for="zd_notify_checkbox" class="zd-checkbox-clone"> Notify Assignee</label> <span> - </span> <a class="zd-link cursor" onclick="ZDSHAREDIALOG.showHideShareMsg(this);" id="add_message_link">Add Message </a><textarea class = "apptextarea mb0 mt10" id = "add_message_input" style = "display: none"> </textarea></div><div class="approval_action_pane_btn zd-dialog-buttonset" style = "display:none"> <button id="cancel_resend_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary">Cancel</button><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="okay_resend_button" style="margin-left:10px;" >Okay</button></div> </div></div><div class="approval-timeline" style = "position: relative"><h3>Activities</h3><div id = "scroller_div" style="overflow-y: auto; overflow-x: hidden;"><div class = "zd-tline" style = "left:0px; top:30px;"> </div> <div class="zd-tf fleft"><div class="zd-tfu"><div class="zd-ta" style = "left:11px; top:0px;"><span class="zd-crimg zd-tle-img-cle"> <img alt="" src="'+TASKS.getPhotoUrl(authorid)+'"></span></div><div class="zd-tua" style = "margin: 20px 50px 0px"> <textarea class ="apptextarea smalltextarea" id = "approval_comments_text" placeholder = "Add your comment"></textarea><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority fright mt10" id = "add_comments_button" style = "display: none"> Comment </button></div></div></div> <div id = "approval_comments" class = "zd-tcon"></div></div></div>';ZD(".zd-preview-approval").empty(),ZD(".zd-preview-approval").append(h),ZD(".zd-preview-approval").show(),ZD("#approval_comments").css({"margin-top":"20px",height:"365px",clear:"both"})}else{var g='<div id = "owner_view_task" class="approval-preview"> <h3> Approval Details </h3><ul class="taskbase-preview"><li class="task-list"> <div id = "approval" class="tasktile"><div class="fleft img"><img src="'+TASKS.getPhotoUrl(authorid)+'"></div><div class="taskcntnt fleft" style="width:305px;"><p>'+u+'<span class="zd-tuah"> has requested </span>you<span class="zd-tuah"> for the approval of the file due is on</span>'+i+'</p></div><div class="tskdesc">'+a+'</div></div></li></ul><div class="approval-response"><img src="'+TASKS.getPhotoUrl(c)+'" height = "25" width = "25"><p class="approval-info"> Awaiting <b>your</b> action </p><div class = "listbox-wrap fleft" style = "margin-left:200px; width:146px; position:absolute"><div class = "selected-option"><span id="selected_action">Select Action</span> </div><div class="up-down-arrow" style = "margin-left:135px; margin-top:10px;"> </div> <div id = "actions_list" class = "zd-dpopup list-popup" style = "display:none"><ul><li class = "recent-folder-item" id = "option-1">Approve </li> <li id = "option-2" class = "recent-folder-item">Reject </li> <li id = "option-3" class = "recent-folder-item">Mark as Incomplete </li> </ul> </div></div> </div> <div class = "approval_action_pane" style = "display: none"> <div class="check-wrap zd_sharelabelcontainer"><input id="zd_notify_checkbox" type="checkbox" name="check" value="" class="zd-checkbox" checked=""><label style="padding-left:20px;" for="zd_notify_checkbox" class="zd-checkbox-clone"> Notify Assignee</label> <span> - </span> <a class="zd-link cursor" onclick="ZDSHAREDIALOG.showHideShareMsg(this);" id="add_message_link">Add Message </a><textarea class = "apptextarea mt10 mb0" id = "add_message_input" style = "display: none"> </textarea></div> <div class="zd-dialog-buttonset" style = "display:none"> <button id="cancel_action_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" >Cancel</button><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="okay_action_button" style="margin-left:10px;" >Okay</button></div></div></div></div> <div class="approval-timeline" style = "position:relative"><h3>Activities</h3><div id = "scroller_div" style="height:400px; overflow-y: auto; overflow-x: hidden;"><div class = "zd-tline" style = "left:0px; top:30px;"> </div> <div class="zd-tf fleft"><div class="zd-tfu"><div class="zd-ta" style = "left:11px; top:0px;"><span class="zd-crimg zd-tle-img-cle"> <img alt="" src="'+TASKS.getPhotoUrl(c)+'"></span></div><div class="zd-tua" style = "margin: 20px 50px 0px"> <textarea class ="apptextarea smalltextarea" id = "shared_approval_comments_text" placeholder = "Add your comment"></textarea><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority fright mt10" id = "add_comments_button" style = "display: none"> Comment </button></div></div></div> <div id = "shared_approval_comments" class = "zd-tcon"></div></div></div></div>';ZD(".zd-preview-approval").empty(),ZD(".zd-preview-approval").append(g),ZD(".zd-preview-approval").show(),ZD("#shared_approval_comments").css({"margin-top":"20px",height:"365px",clear:"both"})}var O=ZD(".zd-preview-approval").height()-ZD("#owner_view_task").height()-ZD(".approval-response").height()-ZD("#wmstoolbar").height()-ZD(".zd-preview-header").height();ZD("#scroller_div").css({height:O}),TASKS.showViewTasksCallBack(u,f,s,p,_,e,wfDocId,o,authorid,c,n,d,r,l)}},error:function(){}})},TASKS.showViewTasksCallBack=function(e,t,s,i,a,o,n,d,r,l,c,_,p){ZUID==r&&TASKS.getTaskComments(n,e,s,r),ZUID==l&&TASKS.getSharedTaskComments(d,o,r,e,s),ZD("#approval_comments_text").click(function(){ZD("#approval_comments_text").removeClass("smalltextarea"),ZD("#add_comments_button").css("display","block")}),ZD("#shared_approval_comments_text").click(function(){ZD("#shared_approval_comments_text").removeClass("smalltextarea"),ZD("#add_comments_button").css("display","block")}),ZD("#add_message_link").click(function(){ZD("#add_message_input").toggle()}),ZD("#edited_date").datepicker({minDate:0}),ZD("#ui-datepicker-div").addClass("zd-containerclass_datepicker"),ZD("#edit_approval_date").click(function(){ZD("#approval_date").css("display","none"),ZD("#to_edit_date").css("display","inline"),ZD("#save_edited_date").css("display","inline"),ZD("#edit_approval_date").css("display","none")}),ZD("#edit_approval_desc").click(function(){ZD("#approval_desc").css("display","none"),ZD("#to_edit_desc").css("display","inline"),ZD("#save_edited_desc").css("display","inline"),ZD("#edit_approval_desc").css("display","none")}),ZD("#add_comments_button").click(function(){TASKS.addTaskComment(o,n,d,r,l,c,_,p,e,s),ZD("#approval_comments_text").addClass("smalltextarea"),ZD("#shared_approval_comments_text").addClass("smalltextarea"),ZD("#add_comments_button").css("display","none")}),ZD("#delete_approval_button").click(function(){TASKS.confirmDeleteTask(l,o,d)}),ZD("#resend_approval").click(function(){ZD(".approval_action_pane").css("display","block"),ZD(".zd-dialog-buttonset").css("display","block")}),ZD("#approve_approval").click(function(){TASKS.closeTask(a,"approve",d,o,_,l,e,s)}),ZD("#reject_approval").click(function(){TASKS.closeTask(a,"reject",d,o,_,l,e,s)}),ZD(".listbox-wrap").click(function(){ZD("#actions_list").toggle()}),ZD("#option-1").click(function(){ZD("#selected_action").text("Approve"),ZD(".zd-dialog-buttonset").css("display","block"),ZD(".approval_action_pane").css("display","block")}),ZD("#option-2").click(function(){ZD("#selected_action").text("Reject"),ZD(".zd-dialog-buttonset").css("display","block"),ZD(".approval_action_pane").css("display","block")}),ZD("#option-3").click(function(){ZD("#selected_action").text("Mark as Incomplete"),ZD(".zd-dialog-buttonset").css("display","block"),ZD(".approval_action_pane").css("display","block")}),ZD("#okay_action_button").click(function(){TASKS.closeTask(a,ZD("#selected_action").text(),d,o,_,r,e,s)}),ZD("#cancel_action_button").click(function(){ZD(".zd-dialog-buttonset").css("display","none"),ZD(".approval_action_pane").css("display","none")}),ZD("#okay_resend_button").click(function(){TASKS.reopenTask(n,e,s,o,d,_),ZD(".zd-dialog-buttonset").css("display","none"),ZD(".approval_action_pane").css("display","none"),ZD(".approval-info").html("<b>"+t+" </b> - Pending Approval </p>")}),ZD("#cancel_resend_button").click(function(){ZD(".zd-dialog-buttonset").css("display","none"),ZD(".approval_action_pane").css("display","none")}),"Incomplete"==i&&(ZD("#resend_approval").css("display","block"),ZD(".approval-info").html(ZUID!=l?"<b>"+t+"</b> - marked it as incomplete":"<b>You</b> marked it as incomplete")),ZD("#save_edited_date").click(function(){ZD("#approval_date").css("display","inline"),ZD("#to_edit_date").css("display","none"),ZD("#edit_approval_date").css("display","inline"),ZD("#save_edited_date").css("display","none"),TASKS.editTask(!0,o,n,d,r,l,c,_,p,e,s),ZD("#approval_date").text(ZD("#edited_date").val())}),ZD("#save_edited_desc").click(function(){ZD("#approval_desc").css("display","inline"),ZD("#to_edit_desc").css("display","none"),ZD("#edit_approval_desc").css("display","inline"),ZD("#save_edited_desc").css("display","none"),TASKS.editTask(!1,o,n,d,r,l,c,_,p,e,s),ZD("#approval_desc").text(ZD("#edited_desc").val())}),"Pending"!=i&&ZUID==l?(ZD(".zd-dialog-buttonset").css("display","none"),ZD(".approval_action_pane").css("display","none"),ZD(".listbox-wrap").css({display:"none",position:"relative"})):"Pending"!=i&&(ZD("#resend_approval").css("display","block"),ZD(".zd-dialog-buttonset").css("display","block"))},TASKS.reopenTask=function(e,t,s,i,a,o){var n="/api/v2/files/workflows?action=reopenmanualwf&resid="+i+"&taskid="+a+"&docname="+o+"&wfstatus=-1&"+zdcsrfPair;ZD.ajax({url:n,dataType:"json",type:"POST",success:function(){TASKS.getTaskComments(e,t,s,authorid)},error:function(){}})},TASKS.confirmDeleteTask=function(e,t,s){void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth();var i='<div id = "confirm_delete_approval_dialog"><span class="ui-zalert-icon ui-zalert-warning">  </span><div class="ui-pop-2c-variable ui-margin-left-2"><span class="ui-zdialog-msg"><span>Are you sure you want to delete the file approval? <br></span></span></div>  </div>',a={};a["Delete Approval"]=function(){TASKS.deleteTask(e,t,s)};var o="Cancel";a[o]=function(){ZD("#confirm_delete_approval_dialog").dialog("destroy").remove()},ZD("body").append(i),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),G_OF_OBJ.urlInvoker="",G_OF_OBJ.docId="",G_OF_OBJ.folderIds="",G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1,ZDdialog=ZD("#confirm_delete_approval_dialog").dialog({autoOpen:!0,modal:!1,resizable:!1,closeText:"",buttons:a,position:[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],width:"auto",draggable:!0,height:"auto",open:function(e,t){ZD(".ui-dialog-titlebar-close",t.dialog|t).remove(),ZD(".ui-dialog-titlebar",t.dialog|t).remove(),ZD("#confirm_delete_approval_dialog").parent().addClass("ui-zdialog-img ui-dialog-alert-notitle bounceInDown animated"),ZD(".ui-dialog-buttonpane button:eq(0)").removeClass("ui-dialog-buttonset ui-button ui-state-default").addClass(" ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-zbutton-priority"),ZD(".ui-dialog-buttonpane button:eq(1)").removeClass("ui-dialog-buttonset ui-button ui-state-default").addClass(" ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-zbutton-secondary")}})},TASKS.deleteTask=function(e,t,s){var i="/api/v2/files/workflows?action=deletemanualwf&resid="+t+"&taskid="+s+"&"+zdcsrfPair;ZD.ajax({url:i,dataType:"json",type:"POST",success:function(i){if("TASK_DELETED_SUCCESSFULLY"===i.response.result.TaskDetails.MESSAGE){ZD("#owner_view_task").empty(),ZD(".approval-timeline").empty(),ZD("#confirm_delete_approval_dialog").dialog("destroy").remove();var a='<div id = "after_delete"><h3> Approval Details </h3> <p class = "no-approval"> There is no approval assigned to this file yet. </p> <p id = "send_for_approval_link" class = "cursor zd-link align-center"> Send for approval </p> </div>';ZD("#owner_view_task").append(a),ZUID==e&&ZD("#send_for_approval_link").empty(),ZD(document).trigger("approvaldeleted",0),TASKS.deleteTaskCallBack(t,s)}else ZD(document).trigger("approvaldeleted",1)},error:function(){ZD(document).trigger("approvaldeleted",1)}})},TASKS.deleteTaskCallBack=function(e){ZD("#send_for_approval_link").click(function(){TASKS.showTasksDialog(e)})},TASKS.closeTask=function(e,t,s,i,a,o,n,d){var r;r="Approve"==t?0:"Reject"==t?1:4;var l="/api/v2/files/workflows?action=closemanualwf&taskid="+s+"&resid="+i+"&wfowneremail="+e+"&wfstatus="+r+"&resname="+a+"&wftype=1&"+zdcsrfPair;ZD.ajax({url:l,dataType:"json",type:"POST",success:function(e){"TASK_STATUS_CHANGED_SUCCESSFULLY"===e.response.result.TaskDetails.MESSAGE&&("Approve"==t?(ZD(".approval-info").html("<b>You</b> approved the file"),ZD("#approve_approval").css("display","none"),ZD("#reject_approval").css("display","none"),r=0):"Reject"==t?(ZD(".approval-info").html("<b>You</b> rejected the file approval"),ZD("#approve_approval").css("display","none"),ZD("#reject_approval").css("display","none"),r=1):(ZD(".approval-info").html("<b>You</b> marked the file as incomplete"),r=4),ZD(".zd-dialog-buttonset").css("display","none"),ZD(".approval_action_pane").css("display","none"),ZD(".listbox-wrap").css({display:"none",position:"relative"}),TASKS.getSharedTaskComments(s,i,o,n,d))},error:function(){}})},TASKS.editTask=function(e,t,s,i,a,o,n,d,r,l,c){var _=ZD("#edited_date").val(),p=ZD("#edited_desc").val(),u="";u=1==e?"/api/v2/files/workflows?action=editmanualwf&taskid="+i+"&resid="+t+"&infoid="+s+"&wfduedate="+_+"&"+zdcsrfPair:"/api/v2/files/workflows?action=editmanualwf&taskid="+i+"&resid="+t+"&infoid="+s+"&wfdesc="+p+"&"+zdcsrfPair,ZD.ajax({url:u,dataType:"json",type:"POST",success:function(){TASKS.getTaskComments(s,l,c,authorid)},error:function(){}})},TASKS.addTaskComment=function(e,t,s,i,a,o,n,d,r,l){var c;ZUID==i?(c=ZD("#approval_comments_text").val(),ZD("#approval_comments_text").val("")):(c=ZD("#shared_approval_comments_text").val(),ZD("#shared_approval_comments_text").val(""));var _="/api/v2/files/workflows?action=addcomments&taskid="+s+"&assignzuid="+i+"&resid="+e+"&doctaskid="+o+"&resname="+n+"&ownertaskid="+d+"&wftype=1&comments="+c+"&"+zdcsrfPair;ZD.ajax({url:_,dataType:"json",type:"POST",success:function(){ZUID==a&&TASKS.getSharedTaskComments(s,e,i,r,l),ZUID==i&&TASKS.getTaskComments(t,r,l,i)},error:function(){}})},TASKS.getTaskComments=function(e,t,s,i){ZD("#approval_comments").empty();var a="/api/v2/files/workflows?action=wfcommentsowner&docinfoid="+e+"&"+zdcsrfPair;ZD.ajax({url:a,dataType:"json",type:"POST",success:function(e){for(var a=0;a<e.taskscomments.length;++a){var o=e.taskscomments[a].commentactivity;ZUID==i&&e.taskscomments[a].commentorname==t?e.taskscomments[a].commentorname="You":ZUID!=i&&e.taskscomments[a].commentorname==s&&(e.taskscomments[a].commentorname="You"),void 0===o&&(o=" added a comment"),ZD("#approval_comments").append('<div class="zd-tf fleft"><div class="zd-tfu"><div class="zd-ta"><span class="zd-cmd-cus zd-cmd-icon"> </span></div><div class="zd-tui fleft"><img src="'+TASKS.getPhotoUrl(e.taskscomments[a].commentorid)+'" alt="" class="zd-tle-img-sqe"><span class="zd-online zd-away"></span></div><div class="zd-tua"><div class="zd-tfun">'+e.taskscomments[a].commentorname+'<span class="zd-tuah">'+o+'</span></div><div class="zd-tfd">'+e.taskscomments[a].commentedtime+'</div></div></div><div id = "'+a+'comment"  class="zd-tuc">'+e.taskscomments[a].comments+"</div></div>"),a==e.taskscomments.length-1&&ZD("#"+a+"comment").append('<div class="zd-taskr  fleft"><div class="zd-tscom"> Just go through and do let me know for corrections.</div><div class="zd-ddate"><div class="zd-duedt"> Due on: Apr 25 </div></div><div class="zd-ddate"><div class="zd-duedt"> File Version: #4.1 </div></div></div>')}},error:function(){}})},TASKS.getSharedTaskComments=function(e,t,s,i,a){ZD("#shared_approval_comments").empty();var o="/api/v2/files/workflows?action=wfcommentssharer&taskid="+e+"&resid="+t+"&assignzuid="+s+"&"+zdcsrfPair;ZD.ajax({url:o,dataType:"json",type:"POST",success:function(e){for(var t=0;t<e.taskscomments.length;++t){var o=e.taskscomments[t].commentactivity;ZUID==s&&e.taskscomments[t].commentorname==i?e.taskscomments[t].commentorname="You":ZUID!=s&&e.taskscomments[t].commentorname==a&&(e.taskscomments[t].commentorname="You"),void 0===o&&(o=" added a comment"),ZD("#shared_approval_comments").append('<div class="zd-tf fleft"><div class="zd-tfu"><div class="zd-ta"><span class="zd-cmd-cus zd-cmd-icon"> </span></div><div class="zd-tui fleft"><img src="'+TASKS.getPhotoUrl(e.taskscomments[t].commentorid)+'" alt="" class="zd-tle-img-sqe"><span class="zd-online zd-away"></span></div><div class="zd-tua"><div class="zd-tfun">'+e.taskscomments[t].commentorname+' <span class="zd-tuah">'+o+'</span></div><div class="zd-tfd">'+e.taskscomments[t].commentedtime+'</div></div></div><div id = "'+t+'shared_comment" class="zd-tuc">'+e.taskscomments[t].comments+"</div></div>"),t==e.taskscomments.length-1&&ZD("#"+t+"shared_comment").append('<div class="zd-taskr  fleft"><div class="zd-tscom"> Just go through and do let me know for corrections.</div><div class="zd-ddate"><div class="zd-duedt"> Due on: Apr 25 </div></div><div class="zd-ddate"><div class="zd-duedt"> File Version: #4.1 </div></div></div>')}},error:function(){}})},TASKS.getResClassName=function(e){var t,s=["log","msg","odt","pages","rtf","tex","txt","wpd","wps"],i=["doc","docx"],a=["dat","gbr","ged","key","keychain","pps","sdf","tar","tax2012","vcf","xml"],o=["ppt","pptx"],n=["xlr","numbers","csv"],d=["xls","xlsx"],r=["pdf","pct","indd"],l=["bmp","dds","gif","jpg","png","jpeg","pspimage","tga","thm","psd","tiff","tif","yuv","ttf"],c=["ai","eps","ps","svg","psd"],_=["asp","aspx","cer","cfm","csr","css","htm","html","js","jsp","php","rss","xhtml"],p=["c","class","cpp","cs","dtd","fla","h","java","lua","m","pl","py","sh","sln","swift","vcxproj","xcodeproj"],u=["7z","cbr","deb","gz","pkg","rar","rpm","sitx","tar.gz","zip","zipx"],m=["aif","iff","mp3","wav","wma","m4a","ogg","oga","webma"],v=["3gp","avi","flv","mov","mp4","mpg","vob","wmv","mpeg","m4v","ogv","webm","webmv","mkv"],D=["log","msg","odt","pages","rtf","tex","txt","wpd","wps","doc","docx","dat","gbr","ged","key","keychain","pps","sdf","tar","tax2012","vcf","xml","ppt","pptx","xlr","numbers","csv","xls","xlsx","pdf","pct","indd","bmp","dds","gif","jpg","png","jpeg","pspimage","tga","thm","psd","tiff","tif","yuv","ttf","ai","eps","ps","svg","psd","asp","aspx","cer","cfm","csr","css","htm","html","js","jsp","php","rss","xhtml","c","class","cpp","cs","dtd","fla","h","java","lua","m","pl","py","sh","sln","swift","vcxproj","xcodeproj","7z","cbr","deb","gz","pkg","rar","rpm","sitx","tar.gz","zip","zipx","aif","iff","mp3","wav","wma","m4a","ogg","oga","webma","3gp","avi","flv","mov","mp4","mpg","vob","wmv","mpeg","m4v","ogv","webm","webmv","mkv","log","msg","odt","pages","rtf","tex","txt","wpd","wps"],h=e.split(".").pop().toLowerCase();return-1!=l.indexOf(h)?t="icon-pic":-1!=o.indexOf(h)?t="ms-icon-show":-1!=i.indexOf(h)?t="ms-icon-doc":-1!=d.indexOf(h)?t="ms-icon-sheet":-1!=u.indexOf(h)?t="icon-zip":-1!=s.indexOf(h)?t="icon-doc":-1!=a.indexOf(h)?t="icon-show":-1!=n.indexOf(h)?t="icon-sheet":-1!=r.indexOf(h)?t="icon-pdf":-1!=p.indexOf(h)?t="icon-dev":-1!=c.indexOf(h)?t="icon-vector":-1!=v.indexOf(h)?t="icon-video":-1!=m.indexOf(h)?t="icon-music":-1!=_.indexOf(h)?t="icon-html":0>$.inArray(h,D)&&(t="icon-other"),t},TASKS.getPhotoUrl=function(e){var t=zdc_ContactsURL+"/file?t=user&ID="+e+"&fs=thumb";return t},REMINDER.reminderDialog=function(e){var t="/api/v2/files/workflows?action=resourcetask&resid="+e+"&"+zdcsrfPair,s=!1;ZD.ajax({url:t,dataType:"json",type:"POST",success:function(t){for(var i=0;i<t.documenttasks.length;++i)if("Reminder"==t.documenttasks[i].tasktype){s=!0;break}0==s?REMINDER.showReminderDialog(e):REMINDER.showViewReminderDialog(e,t.documenttasks[i].docname,t.documenttasks[i].duedate,t.documenttasks[i].taskdesc,t.documenttasks[i].taskid,t.documenttasks[i].doctaskid)},error:function(){}})},REMINDER.showReminderDialog=function(e){void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),G_OF_OBJ.urlInvoker="",G_OF_OBJ.docId="",G_OF_OBJ.folderIds="",G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1;var t='<div id="addreminder_dialog"><div id="dummydiv" class="uploadstatus" style="display:none;"></div><div style = " border-collapse: separate;border-spacing: 2px;border-color: gray;"><div id = "addreminder_table"><label class = "mb10 applabel"> Reminder Date </label> <input class="zd-input zd-input-cf appinput" name = "dp" placeholder = "Choose Reminder date" id = "reminder_datepicker" type="text" style="width:180px;" > <label class = "mb10 applabel"> Reminder Message </label><textarea style="width: 100%; box-sizing:border-box; resize: none" placeholder="Add your task message/description here" id="remindercommentarea" class="apptextarea"></textarea></div> <div class="zd-dialog-buttonset" style = "margin-top:30px;"><button id="zd_cancel_reminder_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" style = "margin-left:10px;float:right">Cancel</button><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="zd_reminder_button" style="float:right;" >Remind me</button></div> </div>';ZD("body").append(t),ZDDialog.showCommonDialog("Add Reminder",!0,"addreminder_dialog","",[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],550,!0,"auto",!1,550,350),REMINDER.callback(e)},REMINDER.callback=function(e){ZD("#remindercommentarea").focus(),ZD(".ui-dialog-titlebar-close").click(function(){G_OF_OBJ.autocomplete_selectValue="",ZD("#addreminder_dialog").remove()}),ZD("#reminder_datepicker").datepicker({minDate:0}),ZD("#ui-datepicker-div").addClass("zd-containerclass_datepicker"),ZD("#zd_reminder_button").click(function(){REMINDER.addReminderConfirm(e)}),ZD("#zd_cancel_reminder_button").click(function(){G_OF_OBJ.autocomplete_selectValue="",ZD("#addreminder_dialog").dialog("close"),ZD("#addreminder_dialog").remove()}),ZD(".ui-dialog").delegate("","keydown",function(e){27==e.keyCode&&(ZD("#addreminder_dialog").dialog("close"),ZD("#addreminder_dialog").remove())})},REMINDER.addReminderConfirm=function(e){var t,s,i=ZD("#reminder_datepicker").val(),a=ZD("#remindercommentarea").val(),o=3;s="/api/v2/files/workflows?action=createmanualwf&resid="+e+"&wfduedate="+i+"&wfdesc="+a+"&wftype="+o+"&wfname="+t+"&"+zdcsrfPair,ZD.ajax({url:s,dataType:"json",type:"POST",success:function(e){"TASK_ADDED_SUCCESSFULLY"===e.response.result.TaskDetails.MESSAGE?(ZD("#addreminder_dialog").dialog("close"),ZD("#addreminder_dialog").remove(),ZD(document).trigger("reminderadded.zdocs",0)):(ZD("#addreminder_dialog").dialog("close"),ZD("#addreminder_dialog").remove(),ZD(document).trigger("reminderadded.zdocs",1))},error:function(){ZD("#reminder_dialog").dialog("close"),ZD("#reminder_dialog").remove(),ZD(document).trigger("reminderadded.zdocs",1)}})},REMINDER.showViewReminderDialog=function(e,t,s,i,a,o){void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),G_OF_OBJ.urlInvoker="",G_OF_OBJ.docId="",G_OF_OBJ.folderIds="",G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1;var n=REMINDER.getResClassName(t),d="Edit";(""==i||null==i)&&(d="Add Message");var r='<div id="viewreminder_dialog"><label class = "mb10 applabel"> Reminder Added To: </label> <div class = "appinput tskhead"> <span class = "'+n+' grid-icons m10 fleft" style = "margin-left:0px;"></span><span style = "padding-left:8px;">'+t+'</span> </div><div id = "view_reminder_date" > <label class = "mb10 applabel"> Reminder Date: </label> <div class = "appinput" id = "edit_reminder_date"> <span>'+s+'</span> <span id="reminder_editdatepicker" class="task_editdatepicker1"><span class = "cursor zd-link" style = "padding-left: 5px;"> Edit </span> </span></div><div class = "appinput" id = "checkbox_reminder_date" style = "display: none;"><span> <input id = "edit_reminder_text" class = "zd-input zd-input-cf appinput" style = "width:180px;" value = "'+s+'"></span></div></div><div id = "parent_view_reminder_desc"> <label class="mb10 applabel"> Reminder Message: </label><div class = "appinput" id = "view_reminder_desc"><span>'+i+'</span><span id="reminder_edit_desc" class="task_editdatepicker1"><span class = "cursor zd-link" id = "add_message">'+d+' </span> </span></div><div class = "appinput" id = "edit_reminder_desc" style = "display:none;"><span> <textarea class = "apptextarea" id = "edited_reminder_desc" style = "width:475px;">'+i+'</textarea></span></div></div><div class="zd-dialog-buttonset" style = "margin-top:30px;"><button id = "delete_reminder_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" style = "float: left"> Delete Reminder </button><button id="zd_cancel_view_reminder_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" style = "margin-left:10px;float:right">Close</button><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="zd_update_reminder_button" style="float:right; display: none" >Update Reminder</button></div> </div>';ZD("body").append(r),""!=i&&null!=i&&ZD("#add_message").css("padding-left","5px"),(""==i||null==i)&&ZD("#edited_reminder_desc").attr("placeholder","Add your task message/description here"),ZDDialog.showCommonDialog("Reminder Details",!0,"viewreminder_dialog","",[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],500,!0,"auto",!1,550,350),REMINDER.viewReminderCallBack(e,t,s,i,a,o)},REMINDER.viewReminderCallBack=function(e,t,s,i,a,o){ZD("#edit_reminder_text").datepicker({minDate:0}),ZD("#ui-datepicker-div").addClass("zd-containerclass_datepicker"),ZD(".ui-dialog-titlebar-close").click(function(){ZD("#viewreminder_dialog").dialog("close"),ZD("#viewreminder_dialog").remove()}),ZD("#reminder_editdatepicker").click(function(){ZD("#edit_reminder_date").css("display","none"),ZD("#checkbox_reminder_date").css("display","block"),ZD("#zd_update_reminder_button").css("display","block"),ZD("#edit_reminder_text").focus()}),ZD("#reminder_edit_desc").click(function(){ZD("#view_reminder_desc").css("display","none"),ZD("#edit_reminder_desc").css("display","block"),ZD("#zd_update_reminder_button").css("display","block"),ZD("#edited_reminder_desc").focus()}),ZD("#delete_reminder_button").click(function(){REMINDER.deleteReminder(e,a)}),ZD("#zd_cancel_view_reminder_button").click(function(){ZD("#viewreminder_dialog").dialog("close"),ZD("#viewreminder_dialog").remove()}),ZD("#zd_update_reminder_button").click(function(){REMINDER.updateReminder(e,a,o,"#viewreminder_dialog")}),$(".ui-dialog").delegate("","keydown",function(e){27==e.keyCode&&(ZD("#viewreminder_dialog").dialog("close"),ZD("#viewreminder_dialog").remove())})},REMINDER.deleteReminder=function(e,t){var s="/api/v2/files/workflows?action=deletemanualwf&resid="+e+"&taskid="+t+"&"+zdcsrfPair;ZD.ajax({url:s,dataType:"json",type:"POST",success:function(e){"TASK_DELETED_SUCCESSFULLY"===e.response.result.TaskDetails.MESSAGE&&(ZD(document).trigger("reminderdeleted.zdocs",0),ZD("#viewreminder_dialog").dialog("close"),ZD("#viewreminder_dialog").remove())},error:function(){ZD(document).trigger("reminderdeleted.zdocs",1),ZD("#viewreminder_dialog").dialog("close"),ZD("#viewreminder_dialog").remove()}})},REMINDER.updateReminder=function(e,t,s,i){var a=ZD("#edit_reminder_text").val(),o=ZD("#edited_reminder_desc").val(),n="/api/v2/files/workflows?action=editmanualwf&resid="+e+"&taskid="+t+"&wfduedate="+a+"&wfdesc="+o+"&infoid="+s+"&"+zdcsrfPair;ZD.ajax({url:n,dataType:"json",type:"POST",success:function(e){"TASK_EDITED_SUCCESSFULLY"===e.response.result.TaskDetails.MESSAGE&&(ZD(document).trigger("reminderupdated.zdocs",0),ZD(i).dialog("close"),ZD(i).remove())},error:function(){ZD(document).trigger("reminderupdated.zdocs",1),ZD(i).dialog("close"),ZD(i).remove()}})},REMINDER.completeReminder=function(e,t,s){var i="/api/v2/files/workflows?action=closemanualwf&taskid="+t+"&resid="+e+"&wfstatus=2&resname="+s+"&wftype=3&"+zdcsrfPair;ZD.ajax({url:i,dataType:"json",type:"POST",success:function(e){"TASK_STATUS_CHANGED_SUCCESSFULLY"===e.response.result.TaskDetails.MESSAGE&&(ZD(document).trigger("remindercompleted.zdocs",0),ZD("#notifyreminder_dialog").dialog("close"),ZD("#notifyreminder_dialog").remove())},error:function(){ZD(document).trigger("remindercompleted.zdocs",1),ZD("#notifyreminder_dialog").dialog("close"),ZD("#notifyreminder_dialog").remove()}})},REMINDER.notifyReminderDialog=function(e,t,s,i,a,o){void 0==G_OF_OBJ&&(G_OF_OBJ=new ZDConstants),G_OF_OBJ.SCR_WTH=ZDUtils.getWidth(),G_OF_OBJ.SCR_HT=ZDUtils.getHeight(),G_OF_OBJ.urlInvoker="",G_OF_OBJ.docId="",G_OF_OBJ.folderIds="",G_OF_OBJ.resIds="",G_OF_OBJ.isVisibility=!1;var n=REMINDER.getResClassName(t),d="Edit";(""==i||null==i)&&(d="Add Message");var r='<div id="notifyreminder_dialog"><label class = "mb10 applabel"> Reminder Added To: </label> <div class = "tskhead appinput" >  <span class = "'+n+' grid-icons m10 fleft" style = "margin-left:0px;"></span><span style = "padding-left:8px;">'+t+'</span>  </div><div id = "notify_reminder_date"> <label class="mb10 applabel"> Reminder Date: </label> <div class = "appinput" id = "notify_edit_reminder_date" > <span style="color:red;">'+s+'</span> <span id="notify_reminder_editdatepicker" class="task_editdatepicker1"> <span class = "cursor zd-link" style = "padding-left: 5px;"> Edit </span></span></div><div class = "appinput" id = "notify_checkbox_reminder_date" style = " display: none;"><span> <input class = "zd-input zd-input-cf appinput" style = "width:180px;" id = "notify_edit_reminder_text" value = "'+s+'"></span></div></div><div id = "parent_notify_reminder_desc"> <label class = "mb10 applabel"> Reminder Message: </label><div class = "appinput" id = "notify_reminder_desc" ><span>'+i+'</span><span id="notify_reminder_edit_desc" class="task_editdatepicker1"> <span style = "padding-left: 5px;" class = "cursor zd-link" id = "add_message">'+d+' </span> </span></div><div class = "appinput" id = "notify_edit_reminder_desc" style =  "display:none;"><span> <textarea class = "apptextarea" id = "notify_edited_reminder_desc">'+i+'</textarea></div></div><div class="zd-dialog-buttonset" style = "margin-top:30px;"><button id = "notify_delete_reminder_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" style = "float: left; display:none;"> Mark as Completed </button><button id="zd_cancel_notify_reminder_button" class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-secondary" style = "margin-left:10px;float:right">Cancel</button><button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="zd_notify_complete_button" style="float:right; display:block;" >Mark as Completed</button> <button class = "ui-widget ui-corner-all ui-button-text-only ui-button ui-state-default ui-zbutton-priority" id="zd_notify_update_reminder_button" style="float:right; display:none;" >Update Reminder</button></div> </div>';ZD("body").append(r),""!=i&&null!=i&&ZD("#add_message").css("padding-left","5px"),(""==i||null==i)&&ZD("#notify_edited_reminder_desc").attr("placeholder","Add your task message/description here"),ZDDialog.showCommonDialog("Reminder Details",!0,"notifyreminder_dialog","",[(G_OF_OBJ.SCR_WTH-G_OF_OBJ.SCR_WTH/1.47)/1.02,(G_OF_OBJ.SCR_HT-G_OF_OBJ.SCR_HT/1.327)/1.9],500,!0,"auto",!1,550,350),REMINDER.notifyReminderCallBack(e,t,s,i,a,o)},REMINDER.notifyReminderCallBack=function(e,t,s,i,a,o){ZD("#notify_edit_reminder_text").datepicker({minDate:0}),ZD("#ui-datepicker-div").addClass("zd-containerclass_datepicker"),ZD(".ui-dialog-titlebar-close").click(function(){ZD("#notifyreminder_dialog").dialog("close"),ZD("#notifyreminder_dialog").remove()}),ZD("#notify_reminder_editdatepicker").click(function(){ZD("#notify_edit_reminder_date").css("display","none"),ZD("#notify_checkbox_reminder_date").css("display","block"),ZD("#zd_notify_complete_button").css("display","none"),ZD("#zd_notify_update_reminder_button").css("display","block"),ZD("#notify_delete_reminder_button").css("display","block"),ZD("#notify_edit_reminder_text").focus()}),ZD("#notify_reminder_edit_desc").click(function(){ZD("#notify_reminder_desc").css("display","none"),ZD("#notify_edit_reminder_desc").css("display","block"),ZD("#zd_notify_complete_button").css("display","none"),ZD("#zd_notify_update_reminder_button").css("display","block"),ZD("#notify_delete_reminder_button").css("display","block"),ZD("#notify_edited_reminder_desc").focus()}),ZD("#notify_delete_reminder_button").click(function(){REMINDER.completeReminder(e,a,t)}),ZD("#zd_cancel_notify_reminder_button").click(function(){ZD("#notifyreminder_dialog").dialog("close"),ZD("#notifyreminder_dialog").remove()}),ZD("#zd_notify_update_reminder_button").click(function(){REMINDER.updateReminder(e,a,o,"#notifyreminder_dialog")}),ZD("#zd_notify_complete_button").click(function(){REMINDER.completeReminder(e,a,t)}),ZD(".ui-dialog").delegate("","keydown",function(e){27==e.keyCode&&(ZD("#notifyreminder_dialog").dialog("close"),ZD("#notifyreminder_dialog").remove())})},REMINDER.getResClassName=function(e){var t,s=["log","msg","odt","pages","rtf","tex","txt","wpd","wps"],i=["doc","docx"],a=["dat","gbr","ged","key","keychain","pps","sdf","tar","tax2012","vcf","xml"],o=["ppt","pptx"],n=["xlr","numbers","csv"],d=["xls","xlsx"],r=["pdf","pct","indd"],l=["bmp","dds","gif","jpg","png","jpeg","pspimage","tga","thm","psd","tiff","tif","yuv","ttf"],c=["ai","eps","ps","svg","psd"],_=["asp","aspx","cer","cfm","csr","css","htm","html","js","jsp","php","rss","xhtml"],p=["c","class","cpp","cs","dtd","fla","h","java","lua","m","pl","py","sh","sln","swift","vcxproj","xcodeproj"],u=["7z","cbr","deb","gz","pkg","rar","rpm","sitx","tar.gz","zip","zipx"],m=["aif","iff","mp3","wav","wma","m4a","ogg","oga","webma"],v=["3gp","avi","flv","mov","mp4","mpg","vob","wmv","mpeg","m4v","ogv","webm","webmv","mkv"],D=["log","msg","odt","pages","rtf","tex","txt","wpd","wps","doc","docx","dat","gbr","ged","key","keychain","pps","sdf","tar","tax2012","vcf","xml","ppt","pptx","xlr","numbers","csv","xls","xlsx","pdf","pct","indd","bmp","dds","gif","jpg","png","jpeg","pspimage","tga","thm","psd","tiff","tif","yuv","ttf","ai","eps","ps","svg","psd","asp","aspx","cer","cfm","csr","css","htm","html","js","jsp","php","rss","xhtml","c","class","cpp","cs","dtd","fla","h","java","lua","m","pl","py","sh","sln","swift","vcxproj","xcodeproj","7z","cbr","deb","gz","pkg","rar","rpm","sitx","tar.gz","zip","zipx","aif","iff","mp3","wav","wma","m4a","ogg","oga","webma","3gp","avi","flv","mov","mp4","mpg","vob","wmv","mpeg","m4v","ogv","webm","webmv","mkv","log","msg","odt","pages","rtf","tex","txt","wpd","wps"],h=e.split(".").pop().toLowerCase();return-1!=l.indexOf(h)?t="icon-pic":-1!=o.indexOf(h)?t="ms-icon-show":-1!=i.indexOf(h)?t="ms-icon-doc":-1!=d.indexOf(h)?t="ms-icon-sheet":-1!=u.indexOf(h)?t="icon-zip":-1!=s.indexOf(h)?t="icon-doc":-1!=d.indexOf(h)?t="ms-icon-sheet":-1!=u.indexOf(h)?t="icon-zip":-1!=s.indexOf(h)?t="icon-doc":-1!=a.indexOf(h)?t="icon-show":-1!=n.indexOf(h)?t="icon-sheet":-1!=r.indexOf(h)?t="icon-pdf":-1!=p.indexOf(h)?t="icon-dev":-1!=c.indexOf(h)?t="icon-vector":-1!=v.indexOf(h)?t="icon-video":-1!=m.indexOf(h)?t="icon-music":-1!=_.indexOf(h)?t="icon-html":0>$.inArray(h,D)&&(t="icon-other"),t};