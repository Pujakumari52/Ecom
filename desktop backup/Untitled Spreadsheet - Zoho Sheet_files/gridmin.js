!function(t,e){"object"==typeof module&&module.exports?module.exports=t.document?e(t):e:t.Highcharts=e(t)}("undefined"!=typeof window?window:this,function(t){var e=function(){var e="undefined"==typeof t?window:t,i=e.document,n="http://www.w3.org/2000/svg",o=e.navigator&&e.navigator.userAgent||"",r=i&&i.createElementNS&&!!i.createElementNS(n,"svg").createSVGRect,s=/(edge|msie|trident)/i.test(o)&&!e.opera,a=/Firefox/.test(o),l=a&&parseInt(o.split("Firefox/")[1],10)<4,h=e.Highcharts?e.Highcharts.error(16,!0):{product:"Highstock",version:"6.0.4",deg2rad:2*Math.PI/360,doc:i,hasBidiBug:l,hasTouch:i&&void 0!==i.documentElement.ontouchstart,isMS:s,isWebKit:/AppleWebKit/.test(o),isFirefox:a,isTouchDevice:/(Mobile|Android|Windows Phone)/.test(o),SVG_NS:n,chartCount:0,seriesTypes:{},symbolSizes:{},svg:r,win:e,marginNames:["plotTop","marginRight","marginBottom","plotLeft"],noop:function(){return void 0},charts:[]};return h}();!function(t){t.timers=[];var e=t.charts,i=t.doc,n=t.win;t.error=function(e,i){var o=t.isNumber(e)?"Highcharts error #"+e+": www.highcharts.com/errors/"+e:e;if(i)throw new Error(o);n.console},t.Fx=function(t,e,i){this.options=e,this.elem=t,this.prop=i},t.Fx.prototype={dSetter:function(){var t,e=this.paths[0],i=this.paths[1],n=[],o=this.now,r=e.length;if(1===o)n=this.toD;else if(r===i.length&&1>o)for(;r--;)t=parseFloat(e[r]),n[r]=isNaN(t)?i[r]:o*parseFloat(i[r]-t)+t;else n=i;this.elem.attr("d",n,null,!0)},update:function(){var t=this.elem,e=this.prop,i=this.now,n=this.options.step;this[e+"Setter"]?this[e+"Setter"]():t.attr?t.element&&t.attr(e,i,null,!0):t.style[e]=i+this.unit,n&&n.call(t,i,this)},run:function(e,i,o){var r=this,s=r.options,a=function(t){return a.stopped?!1:r.step(t)},l=n.requestAnimationFrame||function(t){setTimeout(t,13)},h=function(){for(var e=0;e<t.timers.length;e++)t.timers[e]()||t.timers.splice(e--,1);t.timers.length&&l(h)};e===i?(delete s.curAnim[this.prop],s.complete&&0===t.keys(s.curAnim).length&&s.complete.call(this.elem)):(this.startTime=+new Date,this.start=e,this.end=i,this.unit=o,this.now=this.start,this.pos=0,a.elem=this.elem,a.prop=this.prop,a()&&1===t.timers.push(a)&&l(h))},step:function(e){var i,n,o=+new Date,r=this.options,s=this.elem,a=r.complete,l=r.duration,h=r.curAnim;return s.attr&&!s.element?i=!1:e||o>=l+this.startTime?(this.now=this.end,this.pos=1,this.update(),h[this.prop]=!0,n=!0,t.objectEach(h,function(t){t!==!0&&(n=!1)}),n&&a&&a.call(s),i=!1):(this.pos=r.easing((o-this.startTime)/l),this.now=this.start+(this.end-this.start)*this.pos,this.update(),i=!0),i},initPath:function(e,i,n){function o(t){var e,i;for(d=t.length;d--;)e="M"===t[d]||"L"===t[d],i=/[a-zA-Z]/.test(t[d+3]),e&&i&&t.splice(d+1,0,t[d+1],t[d+2],t[d+1],t[d+2])}function r(t,e,i){[].splice.apply(t,[i,0].concat(e))}function s(t,e){for(;t.length<h;)t[0]=e[h-t.length],r(t,t.slice(0,m),0),y&&(r(t,t.slice(t.length-m),t.length),d--);t[0]="M"}function a(t,e){for(var i=(h-t.length)/m;i>0&&i--;)c=t.slice().splice(t.length/b-m,m*b),c[0]=e[h-m-i*m],f&&(c[m-6]=c[m-2],c[m-5]=c[m-1]),r(t,c,t.length/b),y&&i--}i=i||"";var l,h,c,d,p,u=e.startX,g=e.endX,f=i.indexOf("C")>-1,m=f?7:3,x=i.split(" "),v=n.slice(),y=e.isArea,b=y?2:1;if(f&&(o(x),o(v)),u&&g){for(d=0;d<u.length;d++){if(u[d]===g[0]){l=d;break}if(u[0]===g[g.length-u.length+d]){l=d,p=!0;break}}void 0===l&&(x=[])}return x.length&&t.isNumber(l)&&(h=v.length+l*b*m,p?(s(x,v),a(v,x)):(s(v,x),a(x,v))),[x,v]}},t.Fx.prototype.fillSetter=t.Fx.prototype.strokeSetter=function(){this.elem.attr(this.prop,t.color(this.start).tweenTo(t.color(this.end),this.pos),null,!0)},t.extend=function(t,e){var i;t||(t={});for(i in e)t[i]=e[i];return t},t.merge=function(){var e,i,n=arguments,o={},r=function(e,i){return"object"!=typeof e&&(e={}),t.objectEach(i,function(n,o){e[o]=!t.isObject(n,!0)||t.isClass(n)||t.isDOMElement(n)?i[o]:r(e[o]||{},n)}),e};for(n[0]===!0&&(o=n[1],n=Array.prototype.slice.call(n,2)),i=n.length,e=0;i>e;e++)o=r(o,n[e]);return o},t.pInt=function(t,e){return parseInt(t,e||10)},t.isString=function(t){return"string"==typeof t},t.isArray=function(t){var e=Object.prototype.toString.call(t);return"[object Array]"===e||"[object Array Iterator]"===e},t.isObject=function(e,i){return!(!e||"object"!=typeof e||i&&t.isArray(e))},t.isDOMElement=function(e){return t.isObject(e)&&"number"==typeof e.nodeType},t.isClass=function(e){var i=e&&e.constructor;return!(!t.isObject(e,!0)||t.isDOMElement(e)||!i||!i.name||"Object"===i.name)},t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)&&1/0>t&&t>-1/0},t.erase=function(t,e){for(var i=t.length;i--;)if(t[i]===e){t.splice(i,1);break}},t.defined=function(t){return void 0!==t&&null!==t},t.attr=function(e,i,n){var o;return t.isString(i)?t.defined(n)?e.setAttribute(i,n):e&&e.getAttribute&&(o=e.getAttribute(i)):t.defined(i)&&t.isObject(i)&&t.objectEach(i,function(t,i){e.setAttribute(i,t)}),o},t.splat=function(e){return t.isArray(e)?e:[e]},t.syncTimeout=function(t,e,i){return e?setTimeout(t,e,i):void t.call(0,i)},t.pick=function(){var t,e,i=arguments,n=i.length;for(t=0;n>t;t++)if(e=i[t],void 0!==e&&null!==e)return e},t.css=function(e,i){t.isMS&&!t.svg&&i&&void 0!==i.opacity&&(i.filter="alpha(opacity="+100*i.opacity+")"),t.extend(e.style,i)},t.createElement=function(e,n,o,r,s){var a=i.createElement(e),l=t.css;return n&&t.extend(a,n),s&&l(a,{padding:0,border:"none",margin:0}),o&&l(a,o),r&&r.appendChild(a),a},t.extendClass=function(e,i){var n=function(){};return n.prototype=new e,t.extend(n.prototype,i),n},t.pad=function(t,e,i){return new Array((e||2)+1-String(t).length).join(i||0)+t},t.relativeLength=function(t,e,i){return/%$/.test(t)?e*parseFloat(t)/100+(i||0):parseFloat(t)},t.wrap=function(t,e,i){var n=t[e];t[e]=function(){var t,e=Array.prototype.slice.call(arguments),o=arguments,r=this;return r.proceed=function(){n.apply(r,arguments.length?arguments:o)},e.unshift(n),t=i.apply(this,e),r.proceed=null,t}},t.getTZOffset=function(e){var i=t.Date;return 6e4*(i.hcGetTimezoneOffset&&i.hcGetTimezoneOffset(e)||i.hcTimezoneOffset||0)},t.dateFormat=function(e,i,n){if(!t.defined(i)||isNaN(i))return t.defaultOptions.lang.invalidDate||"";e=t.pick(e,"%Y-%m-%d %H:%M:%S");var o=t.Date,r=new o(i-t.getTZOffset(i)),s=r[o.hcGetHours](),a=r[o.hcGetDay](),l=r[o.hcGetDate](),h=r[o.hcGetMonth](),c=r[o.hcGetFullYear](),d=t.defaultOptions.lang,p=d.weekdays,u=d.shortWeekdays,g=t.pad,f=t.extend({a:u?u[a]:p[a].substr(0,3),A:p[a],d:g(l),e:g(l,2," "),w:a,b:d.shortMonths[h],B:d.months[h],m:g(h+1),y:c.toString().substr(2,2),Y:c,H:g(s),k:s,I:g(s%12||12),l:s%12||12,M:g(r[o.hcGetMinutes]()),p:12>s?"AM":"PM",P:12>s?"am":"pm",S:g(r.getSeconds()),L:g(Math.round(i%1e3),3)},t.dateFormats);return t.objectEach(f,function(t,n){for(;-1!==e.indexOf("%"+n);)e=e.replace("%"+n,"function"==typeof t?t(i):t)}),n?e.substr(0,1).toUpperCase()+e.substr(1):e},t.formatSingle=function(e,i){var n,o=/f$/,r=/\.([0-9])/,s=t.defaultOptions.lang;return o.test(e)?(n=e.match(r),n=n?n[1]:-1,null!==i&&(i=t.numberFormat(i,n,s.decimalPoint,e.indexOf(",")>-1?s.thousandsSep:""))):i=t.dateFormat(e,i),i},t.format=function(e,i){for(var n,o,r,s,a,l,h,c="{",d=!1,p=[];e&&(h=e.indexOf(c),-1!==h);){if(n=e.slice(0,h),d){for(o=n.split(":"),r=o.shift().split("."),a=r.length,l=i,s=0;a>s;s++)l&&(l=l[r[s]]);o.length&&(l=t.formatSingle(o.join(":"),l)),p.push(l)}else p.push(n);e=e.slice(h+1),d=!d,c=d?"}":"{"}return p.push(e),p.join("")},t.getMagnitude=function(t){return Math.pow(10,Math.floor(Math.log(t)/Math.LN10))},t.normalizeTickInterval=function(e,i,n,o,r){var s,a,l=e;for(n=t.pick(n,1),s=e/n,i||(i=r?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],o===!1&&(1===n?i=t.grep(i,function(t){return t%1===0}):.1>=n&&(i=[1/n]))),a=0;a<i.length&&(l=i[a],!(r&&l*n>=e||!r&&s<=(i[a]+(i[a+1]||i[a]))/2));a++);return l=t.correctFloat(l*n,-Math.round(Math.log(.001)/Math.LN10))},t.stableSort=function(t,e){var i,n,o=t.length;for(n=0;o>n;n++)t[n].safeI=n;for(t.sort(function(t,n){return i=e(t,n),0===i?t.safeI-n.safeI:i}),n=0;o>n;n++)delete t[n].safeI},t.arrayMin=function(t){for(var e=t.length,i=t[0];e--;)t[e]<i&&(i=t[e]);return i},t.arrayMax=function(t){for(var e=t.length,i=t[0];e--;)t[e]>i&&(i=t[e]);return i},t.destroyObjectProperties=function(e,i){t.objectEach(e,function(t,n){t&&t!==i&&t.destroy&&t.destroy(),delete e[n]})},t.discardElement=function(e){var i=t.garbageBin;i||(i=t.createElement("div")),e&&i.appendChild(e),i.innerHTML=""},t.correctFloat=function(t,e){return parseFloat(t.toPrecision(e||14))},t.setAnimation=function(e,i){i.renderer.globalAnimation=t.pick(e,i.options.chart.animation,!0)},t.animObject=function(e){return t.isObject(e)?t.merge(e):{duration:e?500:0}},t.timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},t.numberFormat=function(e,i,n,o){e=+e||0,i=+i;var r,s,a,l,h,c=t.defaultOptions.lang,d=(e.toString().split(".")[1]||"").split("e")[0].length,p=e.toString().split("e");-1===i?i=Math.min(d,2):t.isNumber(i)?i&&p[1]&&p[1]<0&&(h=i+ +p[1],h>=0?(p[0]=(+p[0]).toExponential(h).split("e")[0],i=h):(p[0]=p[0].split(".")[0]||0,e=20>i?(p[0]*Math.pow(10,p[1])).toFixed(i):0,p[1]=0)):i=2,l=(Math.abs(p[1]?p[0]:e)+Math.pow(10,-Math.max(i,d)-1)).toFixed(i),r=String(t.pInt(l)),s=r.length>3?r.length%3:0,n=t.pick(n,c.decimalPoint),o=t.pick(o,c.thousandsSep),a=0>e?"-":"",a+=s?r.substr(0,s)+o:"",a+=r.substr(s).replace(/(\d{3})(?=\d)/g,"$1"+o);var u=t.pInt(l.slice(-i));return i&&u&&(a+=n+l.slice(-i)),p[1]&&0!==+a&&(a+="e"+p[1]),a},Math.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},t.getStyle=function(e,i,o){var r;return"width"===i?Math.min(e.offsetWidth,e.scrollWidth)-t.getStyle(e,"padding-left")-t.getStyle(e,"padding-right"):"height"===i?Math.min(e.offsetHeight,e.scrollHeight)-t.getStyle(e,"padding-top")-t.getStyle(e,"padding-bottom"):(n.getComputedStyle||t.error(27,!0),r=n.getComputedStyle(e,void 0),r&&(r=r.getPropertyValue(i),t.pick(o,"opacity"!==i)&&(r=t.pInt(r))),r)},t.inArray=function(e,i){return(t.indexOfPolyfill||Array.prototype.indexOf).call(i,e)},t.grep=function(e,i){return(t.filterPolyfill||Array.prototype.filter).call(e,i)},t.find=Array.prototype.find?function(t,e){return t.find(e)}:function(t,e){var i,n=t.length;for(i=0;n>i;i++)if(e(t[i],i))return t[i]},t.map=function(t,e){for(var i=[],n=0,o=t.length;o>n;n++)i[n]=e.call(t[n],t[n],n,t);return i},t.keys=function(e){return(t.keysPolyfill||Object.keys).call(void 0,e)},t.reduce=function(e,i,n){return(t.reducePolyfill||Array.prototype.reduce).call(e,i,n)},t.offset=function(t){var e=i.documentElement,o=t.parentElement?t.getBoundingClientRect():{top:0,left:0};return{top:o.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:o.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}},t.stop=function(e,i){for(var n=t.timers.length;n--;)t.timers[n].elem!==e||i&&i!==t.timers[n].prop||(t.timers[n].stopped=!0)},t.each=function(e,i,n){return(t.forEachPolyfill||Array.prototype.forEach).call(e,i,n)},t.objectEach=function(t,e,i){for(var n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)},t.addEvent=function(e,i,n){var o,r,s=e.addEventListener||t.addEventListenerPolyfill;return e.hcEvents&&!Object.prototype.hasOwnProperty.call(e,"hcEvents")&&(r={},t.objectEach(e.hcEvents,function(t,e){r[e]=t.slice(0)}),e.hcEvents=r),o=e.hcEvents=e.hcEvents||{},s&&s.call(e,i,n,!1),o[i]||(o[i]=[]),o[i].push(n),function(){t.removeEvent(e,i,n)}},t.removeEvent=function(e,i,n){function o(i,n){var o=e.removeEventListener||t.removeEventListenerPolyfill;o&&o.call(e,i,n,!1)}function r(){var n,r;e.nodeName&&(i?(n={},n[i]=!0):n=l,t.objectEach(n,function(t,e){if(l[e])for(r=l[e].length;r--;)o(e,l[e][r])}))}var s,a,l=e.hcEvents;l&&(i?(s=l[i]||[],n?(a=t.inArray(n,s),a>-1&&(s.splice(a,1),l[i]=s),o(i,n)):(r(),l[i]=[])):(r(),e.hcEvents={}))},t.fireEvent=function(e,n,o,r){var s,a,l,h,c,d=e.hcEvents;if(o=o||{},i.createEvent&&(e.dispatchEvent||e.fireEvent))s=i.createEvent("Events"),s.initEvent(n,!0,!0),t.extend(s,o),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(n,s);else if(d)for(a=d[n]||[],l=a.length,o.target||t.extend(o,{preventDefault:function(){o.defaultPrevented=!0},target:e,type:n}),h=0;l>h;h++)c=a[h],c&&c.call(e,o)===!1&&o.preventDefault();r&&!o.defaultPrevented&&r(o)},t.animate=function(e,i,n){var o,r,s,a,l="";t.isObject(n)||(a=arguments,n={duration:a[2],easing:a[3],complete:a[4]}),t.isNumber(n.duration)||(n.duration=400),n.easing="function"==typeof n.easing?n.easing:Math[n.easing]||Math.easeInOutSine,n.curAnim=t.merge(i),t.objectEach(i,function(a,h){t.stop(e,h),s=new t.Fx(e,n,h),r=null,"d"===h?(s.paths=s.initPath(e,e.d,i.d),s.toD=i.d,o=0,r=1):e.attr?o=e.attr(h):(o=parseFloat(t.getStyle(e,h))||0,"opacity"!==h&&(l="px")),r||(r=a),r&&r.match&&r.match("px")&&(r=r.replace(/px/g,"")),s.run(o,r,l)})},t.seriesType=function(e,i,n,o,r){var s=t.getOptions(),a=t.seriesTypes;return s.plotOptions[e]=t.merge(s.plotOptions[i],n),a[e]=t.extendClass(a[i]||function(){},o),a[e].prototype.type=e,r&&(a[e].prototype.pointClass=t.extendClass(t.Point,r)),a[e]},t.uniqueKey=function(){var t=Math.random().toString(36).substring(2,9),e=0;return function(){return"highcharts-"+t+"-"+e++}}(),n.jQuery&&(n.jQuery.fn.highcharts=function(){var i=[].slice.call(arguments);return this[0]?i[0]?(new(t[t.isString(i[0])?i.shift():"Chart"])(this[0],i[0],i[1]),this):e[t.attr(this[0],"data-highcharts-chart")]:void 0})}(e),function(t){var e=t.each,i=t.isNumber,n=t.map,o=t.merge,r=t.pInt;t.Color=function(e){return this instanceof t.Color?void this.init(e):new t.Color(e)},t.Color.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),parseFloat(t[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[r(t[1]),r(t[2]),r(t[3]),1]}}],names:{none:"rgba(255,255,255,0)",white:"#ffffff",black:"#000000"},init:function(e){var i,o,r,s,a;if(this.input=e=this.names[e&&e.toLowerCase?e.toLowerCase():""]||e,e&&e.stops)this.stops=n(e.stops,function(e){return new t.Color(e[1])});else if(e&&e.charAt&&"#"===e.charAt()&&(a=e.length,e=parseInt(e.substr(1),16),7===a?o=[(16711680&e)>>16,(65280&e)>>8,255&e,1]:4===a&&(o=[(3840&e)>>4|(3840&e)>>8,(240&e)>>4|240&e,(15&e)<<4|15&e,1])),!o)for(r=this.parsers.length;r--&&!o;)s=this.parsers[r],i=s.regex.exec(e),i&&(o=s.parse(i));this.rgba=o||[]},get:function(t){var n,r=this.input,s=this.rgba;return this.stops?(n=o(r),n.stops=[].concat(n.stops),e(this.stops,function(e,i){n.stops[i]=[n.stops[i][0],e.get(t)]})):n=s&&i(s[0])?"rgb"===t||!t&&1===s[3]?"rgb("+s[0]+","+s[1]+","+s[2]+")":"a"===t?s[3]:"rgba("+s.join(",")+")":r,n},brighten:function(t){var n,o=this.rgba;if(this.stops)e(this.stops,function(e){e.brighten(t)});else if(i(t)&&0!==t)for(n=0;3>n;n++)o[n]+=r(255*t),o[n]<0&&(o[n]=0),o[n]>255&&(o[n]=255);return this},setOpacity:function(t){return this.rgba[3]=t,this},tweenTo:function(t,e){var i,n,o=this.rgba,r=t.rgba;return r.length&&o&&o.length?(i=1!==r[3]||1!==o[3],n=(i?"rgba(":"rgb(")+Math.round(r[0]+(o[0]-r[0])*(1-e))+","+Math.round(r[1]+(o[1]-r[1])*(1-e))+","+Math.round(r[2]+(o[2]-r[2])*(1-e))+(i?","+(r[3]+(o[3]-r[3])*(1-e)):"")+")"):n=t.input||"none",n}},t.color=function(e){return new t.Color(e)}}(e),function(t){var e,i,n=t.addEvent,o=t.animate,r=t.attr,s=t.charts,a=t.color,l=t.css,h=t.createElement,c=t.defined,d=t.deg2rad,p=t.destroyObjectProperties,u=t.doc,g=t.each,f=t.extend,m=t.erase,x=t.grep,v=t.hasTouch,y=t.inArray,b=t.isArray,k=t.isFirefox,M=t.isMS,w=t.isObject,S=t.isString,A=t.isWebKit,T=t.merge,P=t.noop,C=t.objectEach,L=t.pick,O=t.pInt,D=t.removeEvent,I=(t.splat,t.stop),B=t.svg,z=t.SVG_NS,E=t.symbolSizes,R=t.win;e=t.SVGElement=function(){return this},f(e.prototype,{opacity:1,SVG_NS:z,textProps:["direction","fontSize","fontWeight","fontFamily","fontStyle","color","lineHeight","width","textAlign","textDecoration","textOverflow","textOutline"],init:function(t,e){this.element="span"===e?h(e):u.createElementNS(this.SVG_NS,e),this.renderer=t},animate:function(e,i,n){var r=t.animObject(L(i,this.renderer.globalAnimation,!0));return 0!==r.duration?(n&&(r.complete=n),o(this,e,r)):(this.attr(e,null,n),r.step&&r.step.call(this)),this},colorGradient:function(e,i,n){var o,r,s,a,l,h,d,p,u,f,m,x,v=this.renderer,y=[];e.radialGradient?r="radialGradient":e.linearGradient&&(r="linearGradient"),r&&(s=e[r],l=v.gradients,d=e.stops,f=n.radialReference,b(s)&&(e[r]=s={x1:s[0],y1:s[1],x2:s[2],y2:s[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===r&&f&&!c(s.gradientUnits)&&(a=s,s=T(s,v.getRadialAttr(f,a),{gradientUnits:"userSpaceOnUse"})),C(s,function(t,e){"id"!==e&&y.push(e,t)}),C(d,function(t){y.push(t)}),y=y.join(","),l[y]?m=l[y].attr("id"):(s.id=m=t.uniqueKey(),l[y]=h=v.createElement(r).attr(s).add(v.defs),h.radAttr=a,h.stops=[],g(d,function(e){var i;0===e[1].indexOf("rgba")?(o=t.color(e[1]),p=o.get("rgb"),u=o.get("a")):(p=e[1],u=1),i=v.createElement("stop").attr({offset:e[0],"stop-color":p,"stop-opacity":u}).add(h),h.stops.push(i)})),x="url("+v.url+"#"+m+")",n.setAttribute(i,x),n.gradient=y,e.toString=function(){return x})},applyTextOutline:function(e){var i,n,o,s,a,l,h=this.element,c=-1!==e.indexOf("contrast"),d={};if(c&&(d.textOutline=e=e.replace(/contrast/g,this.renderer.getContrast(h.style.fill))),e=e.split(" "),o=e[e.length-1],s=e[0],s&&"none"!==s&&t.svg){for(this.fakeTS=!0,i=[].slice.call(h.getElementsByTagName("tspan")),this.ySetter=this.xSetter,s=s.replace(/(^[\d\.]+)(.*?)$/g,function(t,e,i){return 2*e+i}),l=i.length;l--;)n=i[l],"highcharts-text-outline"===n.getAttribute("class")&&m(i,h.removeChild(n));a=h.firstChild,g(i,function(t,e){var i;0===e&&(t.setAttribute("x",h.getAttribute("x")),e=h.getAttribute("y"),t.setAttribute("y",e||0),null===e&&h.setAttribute("y",0)),i=t.cloneNode(1),r(i,{class:"highcharts-text-outline",fill:o,stroke:o,"stroke-width":s,"stroke-linejoin":"round"}),h.insertBefore(i,a)})}},attr:function(t,e,i,n){var o,r,s,a,l=this.element,h=this;return"string"==typeof t&&void 0!==e&&(o=t,t={},t[o]=e),"string"==typeof t?h=(this[t+"Getter"]||this._defaultGetter).call(this,t,l):(C(t,function(e,i){s=!1,n||I(this,i),this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)$/.test(i)&&(r||(this.symbolAttr(t),r=!0),s=!0),!this.rotation||"x"!==i&&"y"!==i||(this.doTransform=!0),s||(a=this[i+"Setter"]||this._defaultSetter,a.call(this,e,i,l),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(i)&&this.updateShadows(i,e,a))},this),this.afterSetters()),i&&i(),h},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(t,e,i){for(var n=this.shadows,o=n.length;o--;)i.call(n[o],"height"===t?Math.max(e-(n[o].cutHeight||0),0):"d"===t?this.d:e,t,n[o])},addClass:function(t,e){var i=this.attr("class")||"";return-1===i.indexOf(t)&&(e||(t=(i+(i?" ":"")+t).replace("  "," ")),this.attr("class",t)),this},hasClass:function(t){return-1!==y(t,(this.attr("class")||"").split(" "))},removeClass:function(t){return this.attr("class",(this.attr("class")||"").replace(t,""))},symbolAttr:function(t){var e=this;g(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(i){e[i]=L(t[i],e[i])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},clip:function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":"none")},crisp:function(t,e){var i,n=this;return e=e||t.strokeWidth||0,i=Math.round(e)%2/2,t.x=Math.floor(t.x||n.x||0)+i,t.y=Math.floor(t.y||n.y||0)+i,t.width=Math.floor((t.width||n.width||0)-2*i),t.height=Math.floor((t.height||n.height||0)-2*i),c(t.strokeWidth)&&(t.strokeWidth=e),t},css:function(t){var e,i,n=this.styles,o={},s=this.element,a="",h=!n,c=["textOutline","textOverflow","width"];return t&&t.color&&(t.fill=t.color),n&&C(t,function(t,e){t!==n[e]&&(o[e]=t,h=!0)}),h&&(n&&(t=f(n,o)),e=this.textWidth=t&&t.width&&"auto"!==t.width&&"text"===s.nodeName.toLowerCase()&&O(t.width),this.styles=t,e&&!B&&this.renderer.forExport&&delete t.width,M&&!B?l(this.element,t):(i=function(t,e){return"-"+e.toLowerCase()},C(t,function(t,e){-1===y(e,c)&&(a+=e.replace(/([A-Z])/g,i)+":"+t+";")}),a&&r(s,"style",a)),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),t&&t.textOutline&&this.applyTextOutline(t.textOutline))),this},strokeWidth:function(){return this["stroke-width"]||0},on:function(t,e){var i=this,n=i.element;return v&&"click"===t?(n.ontouchstart=function(t){i.touchEventFired=Date.now(),t.preventDefault(),e.call(n,t)},n.onclick=function(t){(-1===R.navigator.userAgent.indexOf("Android")||Date.now()-(i.touchEventFired||0)>1100)&&e.call(n,t)}):n["on"+t]=e,this},setRadialReference:function(t){var e=this.renderer.gradients[this.element.gradient];return this.element.radialReference=t,e&&e.radAttr&&e.animate(this.renderer.getRadialAttr(t,e.radAttr)),this},translate:function(t,e){return this.attr({translateX:t,translateY:e})},invert:function(t){var e=this;return e.inverted=t,e.updateTransform(),e},updateTransform:function(){var t,e=this,i=e.translateX||0,n=e.translateY||0,o=e.scaleX,r=e.scaleY,s=e.inverted,a=e.rotation,l=e.matrix,h=e.element;s&&(i+=e.width,n+=e.height),t=["translate("+i+","+n+")"],c(l)&&t.push("matrix("+l.join(",")+")"),s?t.push("rotate(90) scale(-1,1)"):a&&t.push("rotate("+a+" "+L(this.rotationOriginX,h.getAttribute("x"),0)+" "+L(this.rotationOriginY,h.getAttribute("y")||0)+")"),(c(o)||c(r))&&t.push("scale("+L(o,1)+" "+L(r,1)+")"),t.length&&h.setAttribute("transform",t.join(" "))},toFront:function(){var t=this.element;return t.parentNode.appendChild(t),this},align:function(t,e,i){var n,o,r,s,a,l,h,c={},d=this.renderer,p=d.alignedObjects;return t?(this.alignOptions=t,this.alignByTranslate=e,(!i||S(i))&&(this.alignTo=a=i||"renderer",m(p,this),p.push(this),i=null)):(t=this.alignOptions,e=this.alignByTranslate,a=this.alignTo),i=L(i,d[a],d),n=t.align,o=t.verticalAlign,r=(i.x||0)+(t.x||0),s=(i.y||0)+(t.y||0),"right"===n?l=1:"center"===n&&(l=2),l&&(r+=(i.width-(t.width||0))/l),c[e?"translateX":"x"]=Math.round(r),"bottom"===o?h=1:"middle"===o&&(h=2),h&&(s+=(i.height-(t.height||0))/h),c[e?"translateY":"y"]=Math.round(s),this[this.placed?"animate":"attr"](c),this.placed=!0,this.alignAttr=c,this},getBBox:function(t,e){var i,n,o,r,s,a,l,h,p=this,u=p.renderer,m=p.element,x=p.styles,v=p.textStr,y=u.cache,b=u.cacheKeys;if(r=L(e,p.rotation),s=r*d,a=x&&x.fontSize,c(v)&&(h=v.toString(),-1===h.indexOf("<")&&(h=h.replace(/[0-9]/g,"0")),h+=["",r||0,a,x&&x.width,x&&x.textOverflow].join(",")),h&&!t&&(i=y[h]),!i){if(m.namespaceURI===p.SVG_NS||u.forExport){try{l=this.fakeTS&&function(t){g(m.querySelectorAll(".highcharts-text-outline"),function(e){e.style.display=t})},l&&l("none"),i=m.getBBox?f({},m.getBBox()):{width:m.offsetWidth,height:m.offsetHeight},l&&l("")}catch(t){}(!i||i.width<0)&&(i={width:0,height:0})}else i=p.htmlGetBBox();if(u.isSVG&&(n=i.width,o=i.height,x&&"11px"===x.fontSize&&17===Math.round(o)&&(i.height=o=14),r&&(i.width=Math.abs(o*Math.sin(s))+Math.abs(n*Math.cos(s)),i.height=Math.abs(o*Math.cos(s))+Math.abs(n*Math.sin(s)))),h&&i.height>0){for(;b.length>250;)delete y[b.shift()];y[h]||b.push(h),y[h]=i}}return i},show:function(t){return this.attr({visibility:t?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(t){var e=this;e.animate({opacity:0},{duration:t||150,complete:function(){e.attr({y:-9999})}})},add:function(t){var e,i=this.renderer,n=this.element;return t&&(this.parentGroup=t),this.parentInverted=t&&t.inverted,void 0!==this.textStr&&i.buildText(this),this.added=!0,(!t||t.handleZ||this.zIndex)&&(e=this.zIndexSetter()),e||(t?t.element:i.box).appendChild(n),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(t){var e=t.parentNode;e&&e.removeChild(t)},destroy:function(){var t,e,i=this,n=i.element||{},o=i.renderer.isSVG&&"SPAN"===n.nodeName&&i.parentGroup,r=n.ownerSVGElement;if(n.onclick=n.onmouseout=n.onmouseover=n.onmousemove=n.point=null,I(i),i.clipPath&&r&&(g(r.querySelectorAll("[clip-path],[CLIP-PATH]"),function(t){t.getAttribute("clip-path").match(RegExp('[("]#'+i.clipPath.element.id+'[)"]'))&&t.removeAttribute("clip-path")}),i.clipPath=i.clipPath.destroy()),i.stops){for(e=0;e<i.stops.length;e++)i.stops[e]=i.stops[e].destroy();i.stops=null}for(i.safeRemoveChild(n),i.destroyShadows();o&&o.div&&0===o.div.childNodes.length;)t=o.parentGroup,i.safeRemoveChild(o.div),delete o.div,o=t;return i.alignTo&&m(i.renderer.alignedObjects,i),C(i,function(t,e){delete i[e]}),null},shadow:function(t,e,i){var n,o,s,a,l,h,c=[],d=this.element;if(t){if(!this.shadows){for(a=L(t.width,3),l=(t.opacity||.15)/a,h=this.parentInverted?"(-1,-1)":"("+L(t.offsetX,1)+", "+L(t.offsetY,1)+")",n=1;a>=n;n++)o=d.cloneNode(0),s=2*a+1-2*n,r(o,{isShadow:"true",stroke:t.color||"#000000","stroke-opacity":l*n,"stroke-width":s,transform:"translate"+h,fill:"none"}),i&&(r(o,"height",Math.max(r(o,"height")-s,0)),o.cutHeight=s),e?e.element.appendChild(o):d.parentNode&&d.parentNode.insertBefore(o,d),c.push(o);this.shadows=c}}else this.destroyShadows();return this},destroyShadows:function(){g(this.shadows||[],function(t){this.safeRemoveChild(t)},this),this.shadows=void 0},xGetter:function(t){return"circle"===this.element.nodeName&&("x"===t?t="cx":"y"===t&&(t="cy")),this._defaultGetter(t)},_defaultGetter:function(t){var e=L(this[t+"Value"],this[t],this.element?this.element.getAttribute(t):null,0);return/^[\-0-9\.]+$/.test(e)&&(e=parseFloat(e)),e},dSetter:function(t,e,i){t&&t.join&&(t=t.join(" ")),/(NaN| {2}|^$)/.test(t)&&(t="M 0 0"),this[e]!==t&&(i.setAttribute(e,t),this[e]=t)},dashstyleSetter:function(t){var e,i=this["stroke-width"];if("inherit"===i&&(i=1),t=t&&t.toLowerCase()){for(t=t.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),e=t.length;e--;)t[e]=O(t[e])*i;t=t.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",t)}},alignSetter:function(t){var e={left:"start",center:"middle",right:"end"};this.alignValue=t,this.element.setAttribute("text-anchor",e[t])},opacitySetter:function(t,e,i){this[e]=t,i.setAttribute(e,t)},titleSetter:function(t){var e=this.element.getElementsByTagName("title")[0];e||(e=u.createElementNS(this.SVG_NS,"title"),this.element.appendChild(e)),e.firstChild&&e.removeChild(e.firstChild),e.appendChild(u.createTextNode(String(L(t),"").replace(/<[^>]*>/g,"")))},textSetter:function(t){t!==this.textStr&&(delete this.bBox,this.textStr=t,this.added&&this.renderer.buildText(this))},fillSetter:function(t,e,i){"string"==typeof t?i.setAttribute(e,t):t&&this.colorGradient(t,e,i)},visibilitySetter:function(t,e,i){"inherit"===t?i.removeAttribute(e):this[e]!==t&&i.setAttribute(e,t),this[e]=t},zIndexSetter:function(t,e){var i,n,o,r,s,a,l=this.renderer,h=this.parentGroup,d=h||l,p=d.element||l.box,u=this.element,g=p===l.box,f=this.added;if(c(t)&&(u.zIndex=t,t=+t,this[e]===t&&(f=!1),this[e]=t),f){for(t=this.zIndex,t&&h&&(h.handleZ=!0),i=p.childNodes,a=i.length-1;a>=0&&!r;a--)n=i[a],o=n.zIndex,s=!c(o),n!==u&&(0>t&&s&&!g&&!a?(p.insertBefore(u,i[a]),r=!0):(O(o)<=t||s&&(!c(t)||t>=0))&&(p.insertBefore(u,i[a+1]||null),r=!0));r||(p.insertBefore(u,i[g?3:0]||null),r=!0)}return r},_defaultSetter:function(t,e,i){i.setAttribute(e,t)}}),e.prototype.yGetter=e.prototype.xGetter,e.prototype.translateXSetter=e.prototype.translateYSetter=e.prototype.rotationSetter=e.prototype.verticalAlignSetter=e.prototype.rotationOriginXSetter=e.prototype.rotationOriginYSetter=e.prototype.scaleXSetter=e.prototype.scaleYSetter=e.prototype.matrixSetter=function(t,e){this[e]=t,this.doTransform=!0},e.prototype["stroke-widthSetter"]=e.prototype.strokeSetter=function(t,i,n){this[i]=t,this.stroke&&this["stroke-width"]?(e.prototype.fillSetter.call(this,this.stroke,"stroke",n),n.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===i&&0===t&&this.hasStroke&&(n.removeAttribute("stroke"),this.hasStroke=!1)},i=t.SVGRenderer=function(){this.init.apply(this,arguments)},f(i.prototype,{Element:e,SVG_NS:z,init:function(t,e,i,o,s,a){var h,c,d,p=this;h=p.createElement("svg").attr({version:"1.1",class:"highcharts-root"}).css(this.getStyle(o)),c=h.element,t.appendChild(c),r(t,"dir","ltr"),-1===t.innerHTML.indexOf("xmlns")&&r(c,"xmlns",this.SVG_NS),p.isSVG=!0,this.box=c,this.boxWrapper=h,p.alignedObjects=[],this.url=(k||A)&&u.getElementsByTagName("base").length?R.location.href.replace(/#.*?$/,"").replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",d=this.createElement("desc").add(),d.element.appendChild(u.createTextNode("Created with Highstock 6.0.4")),p.defs=this.createElement("defs").add(),p.allowHTML=a,p.forExport=s,p.gradients={},p.cache={},p.cacheKeys=[],p.imgCount=0,p.setSize(e,i,!1);var g,f;k&&t.getBoundingClientRect&&(g=function(){l(t,{left:0,top:0}),f=t.getBoundingClientRect(),l(t,{left:Math.ceil(f.left)-f.left+"px",top:Math.ceil(f.top)-f.top+"px"})},g(),p.unSubPixelFix=n(R,"resize",g))},getStyle:function(t){return this.style=f({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},t),this.style},setStyle:function(t){this.boxWrapper.css(this.getStyle(t))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this,e=t.defs;return t.box=null,t.boxWrapper=t.boxWrapper.destroy(),p(t.gradients||{}),t.gradients=null,e&&(t.defs=e.destroy()),t.unSubPixelFix&&t.unSubPixelFix(),t.alignedObjects=null,null},createElement:function(t){var e=new this.Element;return e.init(this,t),e},draw:P,getRadialAttr:function(t,e){return{cx:t[0]-t[2]/2+e.cx*t[2],cy:t[1]-t[2]/2+e.cy*t[2],r:e.r*t[2]}},getSpanWidth:function(t,e){var i=this,n=t.getBBox(!0),o=n.width;return!B&&i.forExport&&(o=i.measureSpanWidth(e.firstChild.data,t.styles)),o},applyEllipsis:function(t,e,i,n){var o,r,s,a=this,l=t.rotation,h=i,c=0,d=i.length,p=function(t){e.removeChild(e.firstChild),t&&e.appendChild(u.createTextNode(t))};if(t.rotation=0,r=a.getSpanWidth(t,e),s=r>n){for(;d>=c;)o=Math.ceil((c+d)/2),h=i.substring(0,o)+"…",p(h),r=a.getSpanWidth(t,e),c===d?c=d+1:r>n?d=o-1:c=o;0===d&&p("")}return t.rotation=l,s},escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},buildText:function(t){var e,i,n,o,s,a,h,c=t.element,d=this,p=d.forExport,f=L(t.textStr,"").toString(),m=-1!==f.indexOf("<"),v=c.childNodes,y=r(c,"x"),b=t.styles,k=t.textWidth,M=b&&b.lineHeight,w=b&&b.textOutline,S=b&&"ellipsis"===b.textOverflow,A=b&&"nowrap"===b.whiteSpace,T=b&&b.fontSize,P=v.length,D=k&&!t.added&&this.box,I=function(t){var e;return e=/(px|em)$/.test(t&&t.style.fontSize)?t.style.fontSize:T||d.style.fontSize||12,M?O(M):d.fontMetrics(e,t.getAttribute("style")?t:c).h},E=function(t){return C(d.escapes,function(e,i){t=t.replace(new RegExp(e,"g"),i)}),t};if(a=[f,S,A,M,w,T,k].join(","),a!==t.textCache){for(t.textCache=a;P--;)c.removeChild(v[P]);m||w||S||k||-1!==f.indexOf(" ")?(i=/<.*class="([^"]+)".*>/,n=/<.*style="([^"]+)".*>/,o=/<.*href="([^"]+)".*>/,D&&D.appendChild(c),e=m?f.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[f],e=x(e,function(t){return""!==t}),g(e,function(e,a){var f,m=0;e=e.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),f=e.split("|||"),g(f,function(e){if(""!==e||1===f.length){var g,x,v={},b=u.createElementNS(d.SVG_NS,"tspan");if(i.test(e)&&(g=e.match(i)[1],r(b,"class",g)),n.test(e)&&(x=e.match(n)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),r(b,"style",x)),o.test(e)&&!p&&(r(b,"onclick",'location.href="'+e.match(o)[1]+'"'),r(b,"class","highcharts-anchor"),l(b,{cursor:"pointer"})),e=E(e.replace(/<[a-zA-Z\/](.|\n)*?>/g,"")||" ")," "!==e){if(b.appendChild(u.createTextNode(e)),m?v.dx=0:a&&null!==y&&(v.x=y),r(b,v),c.appendChild(b),!m&&h&&(!B&&p&&l(b,{display:"block"}),r(b,"dy",I(b))),k){var M,w,T=e.replace(/([^\^])-/g,"$1- ").split(" "),P=f.length>1||a||T.length>1&&!A,C=[],L=I(b),O=t.rotation;for(S&&(s=d.applyEllipsis(t,b,e,k));!S&&P&&(T.length||C.length);)t.rotation=0,w=d.getSpanWidth(t,b),M=w>k,void 0===s&&(s=M),M&&1!==T.length?(b.removeChild(b.firstChild),C.unshift(T.pop())):(T=C,C=[],T.length&&!A&&(b=u.createElementNS(z,"tspan"),r(b,{dy:L,x:y}),x&&r(b,"style",x),c.appendChild(b)),w>k&&(k=w)),T.length&&b.appendChild(u.createTextNode(T.join(" ").replace(/- /g,"-")));t.rotation=O}m++}}}),h=h||c.childNodes.length}),s&&t.attr("title",t.textStr),D&&D.removeChild(c),w&&t.applyTextOutline&&t.applyTextOutline(w)):c.appendChild(u.createTextNode(E(f)))}},getContrast:function(t){return t=a(t).rgba,t[0]+t[1]+t[2]>510?"#000000":"#FFFFFF"},button:function(t,e,i,o,r,s,a,l,h){var c=this.label(t,e,i,h,null,null,null,null,"button"),d=0;c.attr(T({padding:8,r:2},r));var p,u,g,m;return r=T({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},r),p=r.style,delete r.style,s=T(r,{fill:"#e6e6e6"},s),u=s.style,delete s.style,a=T(r,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},a),g=a.style,delete a.style,l=T(r,{style:{color:"#cccccc"}},l),m=l.style,delete l.style,n(c.element,M?"mouseover":"mouseenter",function(){3!==d&&c.setState(1)}),n(c.element,M?"mouseout":"mouseleave",function(){3!==d&&c.setState(d)}),c.setState=function(t){1!==t&&(c.state=d=t),c.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][t||0]),c.attr([r,s,a,l][t||0]).css([p,u,g,m][t||0])},c.attr(r).css(f({cursor:"default"},p)),c.on("click",function(t){3!==d&&o.call(c,t)})},crispLine:function(t,e){return t[1]===t[4]&&(t[1]=t[4]=Math.round(t[1])-e%2/2),t[2]===t[5]&&(t[2]=t[5]=Math.round(t[2])+e%2/2),t},path:function(t){var e={fill:"none"};return b(t)?e.d=t:w(t)&&f(e,t),this.createElement("path").attr(e)},circle:function(t,e,i){var n=w(t)?t:{x:t,y:e,r:i},o=this.createElement("circle");return o.xSetter=o.ySetter=function(t,e,i){i.setAttribute("c"+e,t)},o.attr(n)},arc:function(t,e,i,n,o,r){var s,a;return w(t)?(a=t,e=a.y,i=a.r,n=a.innerR,o=a.start,r=a.end,t=a.x):a={innerR:n,start:o,end:r},s=this.symbol("arc",t,e,i,i,a),s.r=i,s},rect:function(t,e,i,n,o,s){o=w(t)?t.r:o;var a=this.createElement("rect"),l=w(t)?t:void 0===t?{}:{x:t,y:e,width:Math.max(i,0),height:Math.max(n,0)};return void 0!==s&&(l.strokeWidth=s,l=a.crisp(l)),l.fill="none",o&&(l.r=o),a.rSetter=function(t,e,i){r(i,{rx:t,ry:t})},a.attr(l)},setSize:function(t,e,i){var n=this,o=n.alignedObjects,r=o.length;for(n.width=t,n.height=e,n.boxWrapper.animate({width:t,height:e},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:L(i,!0)?void 0:0});r--;)o[r].align()},g:function(t){var e=this.createElement("g");return t?e.attr({class:"highcharts-"+t}):e},image:function(t,e,i,n,o){var r,s={preserveAspectRatio:"none"};return arguments.length>1&&f(s,{x:e,y:i,width:n,height:o}),r=this.createElement("image").attr(s),r.element.setAttributeNS?r.element.setAttributeNS("http://www.w3.org/1999/xlink","href",t):r.element.setAttribute("hc-svg-href",t),r},symbol:function(t,e,i,n,o,r){var a,d,p,m=this,x=/^url\((.*?)\)$/,v=x.test(t),y=!v&&(this.symbols[t]?t:"circle"),b=y&&this.symbols[y],k=c(e)&&b&&b.call(this.symbols,Math.round(e),Math.round(i),n,o,r);return b?(a=this.path(k),a.attr("fill","none"),f(a,{symbolName:y,x:e,y:i,width:n,height:o}),r&&f(a,r)):v&&(d=t.match(x)[1],a=this.image(d),a.imgwidth=L(E[d]&&E[d].width,r&&r.width),a.imgheight=L(E[d]&&E[d].height,r&&r.height),p=function(){a.attr({width:a.width,height:a.height})},g(["width","height"],function(t){a[t+"Setter"]=function(t,e){var i={},n=this["img"+e],o="width"===e?"translateX":"translateY";this[e]=t,c(n)&&(this.element&&this.element.setAttribute(e,n),this.alignByTranslate||(i[o]=((this[e]||0)-n)/2,this.attr(i)))}}),c(e)&&a.attr({x:e,y:i}),a.isImg=!0,c(a.imgwidth)&&c(a.imgheight)?p():(a.attr({width:0,height:0}),h("img",{onload:function(){var t=s[m.chartIndex];0===this.width&&(l(this,{position:"absolute",top:"-999em"}),u.body.appendChild(this)),E[d]={width:this.width,height:this.height},a.imgwidth=this.width,a.imgheight=this.height,a.element&&p(),this.parentNode&&this.parentNode.removeChild(this),m.imgCount--,!m.imgCount&&t&&t.onload&&t.onload()},src:d}),this.imgCount++)),a},symbols:{circle:function(t,e,i,n){return this.arc(t+i/2,e+n/2,i/2,n/2,{start:0,end:2*Math.PI,open:!1})},square:function(t,e,i,n){return["M",t,e,"L",t+i,e,t+i,e+n,t,e+n,"Z"]},triangle:function(t,e,i,n){return["M",t+i/2,e,"L",t+i,e+n,t,e+n,"Z"]},"triangle-down":function(t,e,i,n){return["M",t,e,"L",t+i,e,t+i/2,e+n,"Z"]},diamond:function(t,e,i,n){return["M",t+i/2,e,"L",t+i,e+n/2,t+i/2,e+n,t,e+n/2,"Z"]},arc:function(t,e,i,n,o){var r,s=o.start,a=o.r||i,l=o.r||n||i,h=.001,d=Math.abs(o.end-o.start-2*Math.PI)<h,p=o.end-h,u=o.innerR,g=L(o.open,d),f=Math.cos(s),m=Math.sin(s),x=Math.cos(p),v=Math.sin(p),y=o.end-s-Math.PI<h?0:1;return r=["M",t+a*f,e+l*m,"A",a,l,0,y,1,t+a*x,e+l*v],c(u)&&r.push(g?"M":"L",t+u*x,e+u*v,"A",u,u,0,y,0,t+u*f,e+u*m),r.push(g?"":"Z"),r},callout:function(t,e,i,n,o){var r,s=6,a=6,l=Math.min(o&&o.r||0,i,n),h=l+a,c=o&&o.anchorX,d=o&&o.anchorY;return r=["M",t+l,e,"L",t+i-l,e,"C",t+i,e,t+i,e,t+i,e+l,"L",t+i,e+n-l,"C",t+i,e+n,t+i,e+n,t+i-l,e+n,"L",t+l,e+n,"C",t,e+n,t,e+n,t,e+n-l,"L",t,e+l,"C",t,e,t,e,t+l,e],c&&c>i?d>e+h&&e+n-h>d?r.splice(13,3,"L",t+i,d-a,t+i+s,d,t+i,d+a,t+i,e+n-l):r.splice(13,3,"L",t+i,n/2,c,d,t+i,n/2,t+i,e+n-l):c&&0>c?d>e+h&&e+n-h>d?r.splice(33,3,"L",t,d+a,t-s,d,t,d-a,t,e+l):r.splice(33,3,"L",t,n/2,c,d,t,n/2,t,e+l):d&&d>n&&c>t+h&&t+i-h>c?r.splice(23,3,"L",c+a,e+n,c,e+n+s,c-a,e+n,t+l,e+n):d&&0>d&&c>t+h&&t+i-h>c&&r.splice(3,3,"L",c-a,e,c,e-s,c+a,e,i-l,e),r}},clipRect:function(e,i,n,o){var r,s=t.uniqueKey(),a=this.createElement("clipPath").attr({id:s}).add(this.defs);return r=this.rect(e,i,n,o,0).add(a),r.id=s,r.clipPath=a,r.count=0,r},text:function(t,e,i,n){var o,r=this,s={};return!n||!r.allowHTML&&r.forExport?(s.x=Math.round(e||0),i&&(s.y=Math.round(i)),(t||0===t)&&(s.text=t),o=r.createElement("text").attr(s),n||(o.xSetter=function(t,e,i){var n,o,r=i.getElementsByTagName("tspan"),s=i.getAttribute(e);for(o=0;o<r.length;o++)n=r[o],n.getAttribute(e)===s&&n.setAttribute(e,t);i.setAttribute(e,t)}),o):r.html(t,e,i)},fontMetrics:function(t,e){var i,n;return t=t||e&&e.style&&e.style.fontSize||this.style&&this.style.fontSize,t=/px/.test(t)?O(t):/em/.test(t)?parseFloat(t)*(e?this.fontMetrics(null,e.parentNode).f:16):12,i=24>t?t+3:Math.round(1.2*t),n=Math.round(.8*i),{h:i,b:n,f:t}},rotCorr:function(t,e,i){var n=t;return e&&i&&(n=Math.max(n*Math.cos(e*d),4)),{x:-t/3*Math.sin(e*d),y:n}},label:function(i,n,o,r,s,a,l,h,d){var p,u,m,x,v,y,b,k,M,w,S,A,P,C=this,L=C.g("button"!==d&&"label"),O=L.text=C.text("",0,0,l).attr({zIndex:1}),I=0,B=3,z=0,E={},R=/^url\((.*?)\)$/.test(r),G=R;d&&L.addClass("highcharts-"+d),G=R,w=function(){return(k||0)%2/2},S=function(){var t,e=O.element.style,i={};u=(void 0===m||void 0===x||b)&&c(O.textStr)&&O.getBBox(),L.width=(m||u.width||0)+2*B+z,L.height=(x||u.height||0)+2*B,M=B+C.fontMetrics(e&&e.fontSize,O).b,G&&(p||(L.box=p=C.symbols[r]||R?C.symbol(r):C.rect(),p.addClass(("button"===d?"":"highcharts-label-box")+(d?" highcharts-"+d+"-box":"")),p.add(L),t=w(),i.x=t,i.y=(h?-M:0)+t),i.width=Math.round(L.width),i.height=Math.round(L.height),p.attr(f(i,E)),E={})},A=function(){var t,e=z+B;t=h?0:M,c(m)&&u&&("center"===b||"right"===b)&&(e+={center:.5,right:1}[b]*(m-u.width)),(e!==O.x||t!==O.y)&&(O.attr("x",e),void 0!==t&&O.attr("y",t)),O.x=e,O.y=t},P=function(t,e){p?p.attr(t,e):E[t]=e},L.onAdd=function(){O.add(L),L.attr({text:i||0===i?i:"",x:n,y:o}),p&&c(s)&&L.attr({anchorX:s,anchorY:a})},L.widthSetter=function(e){m=t.isNumber(e)?e:null},L.heightSetter=function(t){x=t},L["text-alignSetter"]=function(t){b=t},L.paddingSetter=function(t){c(t)&&t!==B&&(B=L.padding=t,A())},L.paddingLeftSetter=function(t){c(t)&&t!==z&&(z=t,A())},L.alignSetter=function(t){t={left:0,center:.5,right:1}[t],t!==I&&(I=t,u&&L.attr({x:v}))},L.textSetter=function(t){void 0!==t&&O.textSetter(t),S(),A()},L["stroke-widthSetter"]=function(t,e){t&&(G=!0),k=this["stroke-width"]=t,P(e,t)},L.strokeSetter=L.fillSetter=L.rSetter=function(t,e){"r"!==e&&("fill"===e&&t&&(G=!0),L[e]=t),P(e,t)},L.anchorXSetter=function(t,e){s=L.anchorX=t,P(e,Math.round(t)-w()-v)},L.anchorYSetter=function(t,e){a=L.anchorY=t,P(e,t-y)},L.xSetter=function(t){L.x=t,I&&(t-=I*((m||u.width)+2*B)),v=Math.round(t),L.attr("translateX",v)},L.ySetter=function(t){y=L.y=Math.round(t),L.attr("translateY",y)};var X=L.css;return f(L,{css:function(t){if(t){var e={};t=T(t),g(L.textProps,function(i){void 0!==t[i]&&(e[i]=t[i],delete t[i])}),O.css(e)}return X.call(L,t)},getBBox:function(){return{width:u.width+2*B,height:u.height+2*B,x:u.x-B,y:u.y-B}},shadow:function(t){return t&&(S(),p&&p.shadow(t)),L},destroy:function(){D(L.element,"mouseenter"),D(L.element,"mouseleave"),O&&(O=O.destroy()),p&&(p=p.destroy()),e.prototype.destroy.call(L),L=C=S=A=P=null}})}}),t.Renderer=i}(e),function(t){var e=t.attr,i=t.createElement,n=t.css,o=t.defined,r=t.each,s=t.extend,a=t.isFirefox,l=t.isMS,h=t.isWebKit,c=t.pick,d=t.pInt,p=t.SVGElement,u=t.SVGRenderer,g=t.win,f=t.wrap;s(p.prototype,{htmlCss:function(t){var e=this,i=e.element,o=t&&"SPAN"===i.tagName&&t.width;return o&&(delete t.width,e.textWidth=o,e.updateTransform()),t&&"ellipsis"===t.textOverflow&&(t.whiteSpace="nowrap",t.overflow="hidden"),e.styles=s(e.styles,t),n(e.element,t),e},htmlGetBBox:function(){var t=this,e=t.element;return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}},htmlUpdateTransform:function(){if(!this.added)return void(this.alignOnAdd=!0);var t=this,e=t.renderer,i=t.element,s=t.translateX||0,a=t.translateY||0,l=t.x||0,c=t.y||0,p=t.textAlign||"left",u={left:0,center:.5,right:1}[p],g=t.styles;if(n(i,{marginLeft:s,marginTop:a}),t.shadows&&r(t.shadows,function(t){n(t,{marginLeft:s+1,marginTop:a+1})}),t.inverted&&r(i.childNodes,function(t){e.invertChild(t,i)}),"SPAN"===i.tagName){var f,m=t.rotation,x=d(t.textWidth),v=g&&g.whiteSpace,y=[m,p,i.innerHTML,t.textWidth,t.textAlign].join(",");y!==t.cTT&&(f=e.fontMetrics(i.style.fontSize).b,o(m)&&t.setSpanRotation(m,u,f),n(i,{width:"",whiteSpace:v||"nowrap"}),i.offsetWidth>x&&/[ \-]/.test(i.textContent||i.innerText)&&n(i,{width:x+"px",display:"block",whiteSpace:v||"normal"}),t.getSpanCorrection(i.offsetWidth,f,u,m,p)),n(i,{left:l+(t.xCorr||0)+"px",top:c+(t.yCorr||0)+"px"}),h&&(f=i.offsetHeight),t.cTT=y}},setSpanRotation:function(t,e,i){var o={},r=this.renderer.getTransformKey();o[r]=o.transform="rotate("+t+"deg)",o[r+(a?"Origin":"-origin")]=o.transformOrigin=100*e+"% "+i+"px",n(this.element,o)},getSpanCorrection:function(t,e,i){this.xCorr=-t*i,this.yCorr=-e}}),s(u.prototype,{getTransformKey:function(){return l&&!/Edge/.test(g.navigator.userAgent)?"-ms-transform":h?"-webkit-transform":a?"MozTransform":g.opera?"-o-transform":""},html:function(t,n,o){var a=this.createElement("span"),h=a.element,d=a.renderer,p=d.isSVG,u=function(t,e){r(["opacity","visibility"],function(i){f(t,i+"Setter",function(t,i,n,o){t.call(this,i,n,o),e[n]=i})})};return a.textSetter=function(t){t!==h.innerHTML&&delete this.bBox,this.textStr=t,h.innerHTML=c(t,""),a.htmlUpdateTransform()},p&&u(a,a.element.style),a.xSetter=a.ySetter=a.alignSetter=a.rotationSetter=function(t,e){"align"===e&&(e="textAlign"),a[e]=t,a.htmlUpdateTransform()},a.attr({text:t,x:Math.round(n),y:Math.round(o)}).css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize,position:"absolute"}),h.style.whiteSpace="nowrap",a.css=a.htmlCss,p&&(a.add=function(t){var n,o,c=d.box.parentNode,p=[];if(this.parentGroup=t,t){if(n=t.div,!n){for(o=t;o;)p.push(o),o=o.parentGroup;r(p.reverse(),function(t){function o(e,i){t[i]=e,l?r[d.getTransformKey()]="translate("+(t.x||t.translateX)+"px,"+(t.y||t.translateY)+"px)":"translateX"===i?r.left=e+"px":r.top=e+"px",t.doTransform=!0}var r,h=e(t.element,"class");h&&(h={className:h}),n=t.div=t.div||i("div",h,{position:"absolute",left:(t.translateX||0)+"px",top:(t.translateY||0)+"px",display:t.display,opacity:t.opacity,pointerEvents:t.styles&&t.styles.pointerEvents},n||c),r=n.style,s(t,{classSetter:function(t){return function(e){this.element.setAttribute("class",e),t.className=e}}(n),on:function(){return p[0].div&&a.on.apply({element:p[0].div},arguments),t},translateXSetter:o,translateYSetter:o}),u(t,r)})}}else n=c;return n.appendChild(h),a.added=!0,a.alignOnAdd&&a.htmlUpdateTransform(),a}),a}})}(e),function(t){function e(){var e=t.defaultOptions.global,i=h.moment;if(e.timezone){if(i)return function(t){return-i.tz(t,e.timezone).utcOffset()};t.error(25)}return e.useUTC&&e.getTimezoneOffset}function i(){var i,n,r=t.defaultOptions.global,s=r.useUTC,l=s?"getUTC":"get",c=s?"setUTC":"set",d=["Minutes","Hours","Day","Date","Month","FullYear"],p=d.concat(["Milliseconds","Seconds"]);for(t.Date=i=r.Date||h.Date,i.hcTimezoneOffset=s&&r.timezoneOffset,i.hcGetTimezoneOffset=e(),i.hcHasTimeZone=!(!i.hcTimezoneOffset&&!i.hcGetTimezoneOffset),i.hcMakeTime=function(t,e,n,r,l,h){var c;return s?(c=i.UTC.apply(0,arguments),c+=o(c)):c=new i(t,e,a(n,1),a(r,0),a(l,0),a(h,0)).getTime(),c},n=0;n<d.length;n++)i["hcGet"+d[n]]=l+d[n];for(n=0;n<p.length;n++)i["hcSet"+p[n]]=c+p[n]}var n=t.color,o=t.getTZOffset,r=t.isTouchDevice,s=t.merge,a=t.pick,l=t.svg,h=t.win;t.defaultOptions={colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" "),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0},chart:{borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:l,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",padding:8,snap:r?25:10,backgroundColor:n("#f7f7f7").setOpacity(.85).get(),borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}},t.setOptions=function(e){return t.defaultOptions=s(!0,t.defaultOptions,e),i(),t.defaultOptions},t.getOptions=function(){return t.defaultOptions},t.defaultPlotOptions=t.defaultOptions.plotOptions,i()}(e),function(t){var e=t.correctFloat,i=t.defined,n=t.destroyObjectProperties,o=t.isNumber,r=t.merge,s=t.pick,a=t.deg2rad;t.Tick=function(t,e,i,n){this.axis=t,this.pos=e,this.type=i||"",this.isNew=!0,this.isNewLabel=!0,i||n||this.addLabel()},t.Tick.prototype={addLabel:function(){var t,n,o=this,a=o.axis,l=a.options,h=a.chart,c=a.categories,d=a.names,p=o.pos,u=l.labels,g=a.tickPositions,f=p===g[0],m=p===g[g.length-1],x=c?s(c[p],d[p],p):p,v=o.label,y=g.info;a.isDatetimeAxis&&y&&(n=l.dateTimeLabelFormats[y.higherRanks[p]||y.unitName]),o.isFirst=f,o.isLast=m,t=a.labelFormatter.call({axis:a,chart:h,isFirst:f,isLast:m,dateTimeLabelFormat:n,value:a.isLog?e(a.lin2log(x)):x,pos:p}),i(v)?v&&v.attr({text:t}):(o.label=v=i(t)&&u.enabled?h.renderer.text(t,0,0,u.useHTML).css(r(u.style)).add(a.labelGroup):null,o.labelLength=v&&v.getBBox().width,o.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(t){var e,i,n,o=this.axis,r=o.options.labels,l=t.x,h=o.chart.chartWidth,c=o.chart.spacing,d=s(o.labelLeft,Math.min(o.pos,c[3])),p=s(o.labelRight,Math.max(o.isRadial?0:o.pos+o.len,h-c[1])),u=this.label,g=this.rotation,f={left:0,center:.5,right:1}[o.labelAlign||u.attr("align")],m=u.getBBox().width,x=o.getSlotWidth(),v=x,y=f,b=1,k={};g||r.overflow===!1?0>g&&d>l-f*m?n=Math.round(l/Math.cos(g*a)-d):g>0&&l+f*m>p&&(n=Math.round((h-l)/Math.cos(g*a))):(e=l-f*m,i=l+(1-f)*m,d>e?v=t.x+v*(1-f)-d:i>p&&(v=p-t.x+v*f,b=-1),v=Math.min(x,v),x>v&&"center"===o.labelAlign&&(t.x+=b*(x-v-y*(x-Math.min(m,v)))),(m>v||o.autoRotation&&(u.styles||{}).width)&&(n=v)),n&&(k.width=n,(r.style||{}).textOverflow||(k.textOverflow="ellipsis"),u.css(k))},getPosition:function(t,e,i,n){var o=this.axis,r=o.chart,s=n&&r.oldChartHeight||r.chartHeight;return{x:t?o.translate(e+i,null,null,n)+o.transB:o.left+o.offset+(o.opposite?(n&&r.oldChartWidth||r.chartWidth)-o.right-o.left:0),y:t?s-o.bottom+o.offset-(o.opposite?o.height:0):s-o.translate(e+i,null,null,n)-o.transB}},getLabelPosition:function(t,e,n,o,r,s,l,h){var c,d=this.axis,p=d.transA,u=d.reversed,g=d.staggerLines,f=d.tickRotCorr||{x:0,y:0},m=r.y,x=o||d.reserveSpaceDefault?0:-d.labelOffset*("center"===d.labelAlign?.5:1);return i(m)||(m=0===d.side?n.rotation?-8:-n.getBBox().height:2===d.side?f.y+8:Math.cos(n.rotation*a)*(f.y-n.getBBox(!1,0).height/2)),t=t+r.x+x+f.x-(s&&o?s*p*(u?-1:1):0),e=e+m-(s&&!o?s*p*(u?1:-1):0),g&&(c=l/(h||1)%g,d.opposite&&(c=g-c-1),e+=c*(d.labelOffset/g)),{x:t,y:Math.round(e)}},getMarkPath:function(t,e,i,n,o,r){return r.crispLine(["M",t,e,"L",t+(o?0:-i),e+(o?i:0)],n)},renderGridLine:function(t,e,i){var n,o=this,r=o.axis,s=r.options,a=o.gridLine,l={},h=o.pos,c=o.type,d=r.tickmarkOffset,p=r.chart.renderer,u=c?c+"Grid":"grid",g=s[u+"LineWidth"],f=s[u+"LineColor"],m=s[u+"LineDashStyle"];a||(l.stroke=f,l["stroke-width"]=g,m&&(l.dashstyle=m),c||(l.zIndex=1),t&&(l.opacity=0),o.gridLine=a=p.path().attr(l).addClass("highcharts-"+(c?c+"-":"")+"grid-line").add(r.gridGroup)),!t&&a&&(n=r.getPlotLinePath(h+d,a.strokeWidth()*i,t,!0),n&&a[o.isNew?"attr":"animate"]({d:n,opacity:e}))},renderMark:function(t,e,i){var n=this,o=n.axis,r=o.options,a=o.chart.renderer,l=n.type,h=l?l+"Tick":"tick",c=o.tickSize(h),d=n.mark,p=!d,u=t.x,g=t.y,f=s(r[h+"Width"],!l&&o.isXAxis?1:0),m=r[h+"Color"];c&&(o.opposite&&(c[0]=-c[0]),p&&(n.mark=d=a.path().addClass("highcharts-"+(l?l+"-":"")+"tick").add(o.axisGroup),d.attr({stroke:m,"stroke-width":f})),d[p?"attr":"animate"]({d:n.getMarkPath(u,g,c[0],d.strokeWidth()*i,o.horiz,a),opacity:e}))},renderLabel:function(t,e,i,n){var r=this,a=r.axis,l=a.horiz,h=a.options,c=r.label,d=h.labels,p=d.step,u=a.tickmarkOffset,g=!0,f=t.x,m=t.y;c&&o(f)&&(c.xy=t=r.getLabelPosition(f,m,c,l,d,u,n,p),r.isFirst&&!r.isLast&&!s(h.showFirstLabel,1)||r.isLast&&!r.isFirst&&!s(h.showLastLabel,1)?g=!1:!l||d.step||d.rotation||e||0===i||r.handleOverflow(t),p&&n%p&&(g=!1),g&&o(t.y)?(t.opacity=i,c[r.isNewLabel?"attr":"animate"](t),r.isNewLabel=!1):(c.attr("y",-9999),r.isNewLabel=!0))},render:function(t,e,i){var n=this,o=n.axis,r=o.horiz,a=n.pos,l=o.tickmarkOffset,h=n.getPosition(r,a,l,e),c=h.x,d=h.y,p=r&&c===o.pos+o.len||!r&&d===o.pos?-1:1;i=s(i,1),this.isActive=!0,this.renderGridLine(e,i,p),this.renderMark(h,i,p),this.renderLabel(h,e,i,t),n.isNew=!1},destroy:function(){n(this,this.axis)}}}(e);var i=function(t){var e=t.addEvent,i=t.animObject,n=t.arrayMax,o=t.arrayMin,r=t.color,s=t.correctFloat,a=t.defaultOptions,l=t.defined,h=t.deg2rad,c=t.destroyObjectProperties,d=t.each,p=t.extend,u=t.fireEvent,g=t.format,f=t.getMagnitude,m=t.grep,x=t.inArray,v=t.isArray,y=t.isNumber,b=t.isString,k=t.merge,M=t.normalizeTickInterval,w=t.objectEach,S=t.pick,A=t.removeEvent,T=t.splat,P=t.syncTimeout,C=t.Tick,L=function(){this.init.apply(this,arguments)};return t.extend(L.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,labels:{enabled:!0,style:{color:"#666666",cursor:"default",fontSize:"11px"},x:0},maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",minPadding:.01,startOfWeek:1,startOnTick:!1,tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{allowOverlap:!1,enabled:!1,formatter:function(){return t.numberFormat(this.total,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"#000000",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(t,i){var n=i.isX,o=this;o.chart=t,o.horiz=t.inverted&&!o.isZAxis?!n:n,o.isXAxis=n,o.coll=o.coll||(n?"xAxis":"yAxis"),o.opposite=i.opposite,o.side=i.side||(o.horiz?o.opposite?0:2:o.opposite?1:3),o.setOptions(i);var r=this.options,s=r.type,a="datetime"===s;o.labelFormatter=r.labels.formatter||o.defaultLabelFormatter,o.userOptions=i,o.minPixelPadding=0,o.reversed=r.reversed,o.visible=r.visible!==!1,o.zoomEnabled=r.zoomEnabled!==!1,o.hasNames="category"===s||r.categories===!0,o.categories=r.categories||o.hasNames,o.names=o.names||[],o.plotLinesAndBandsGroups={},o.isLog="logarithmic"===s,o.isDatetimeAxis=a,o.positiveValuesOnly=o.isLog&&!o.allowNegativeLog,o.isLinked=l(r.linkedTo),o.ticks={},o.labelEdge=[],o.minorTicks={},o.plotLinesAndBands=[],o.alternateBands={},o.len=0,o.minRange=o.userMinRange=r.minRange||r.maxZoom,o.range=r.range,o.offset=r.offset||0,o.stacks={},o.oldStacks={},o.stacksTouched=0,o.max=null,o.min=null,o.crosshair=S(r.crosshair,T(t.options.tooltip.crosshairs)[n?0:1],!1);var h=o.options.events;-1===x(o,t.axes)&&(n?t.axes.splice(t.xAxis.length,0,o):t.axes.push(o),t[o.coll].push(o)),o.series=o.series||[],t.inverted&&!o.isZAxis&&n&&void 0===o.reversed&&(o.reversed=!0),w(h,function(t,i){e(o,i,t)}),o.lin2log=r.linearToLogConverter||o.lin2log,o.isLog&&(o.val2lin=o.log2lin,o.lin2val=o.lin2log)},setOptions:function(t){this.options=k(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],k(a[this.coll],t))},defaultLabelFormatter:function(){var e,i,n=this.axis,o=this.value,r=n.categories,s=this.dateTimeLabelFormat,l=a.lang,h=l.numericSymbols,c=l.numericSymbolMagnitude||1e3,d=h&&h.length,p=n.options.labels.format,u=n.isLog?Math.abs(o):n.tickInterval;if(p)i=g(p,this);else if(r)i=o;else if(s)i=t.dateFormat(s,o);else if(d&&u>=1e3)for(;d--&&void 0===i;)e=Math.pow(c,d+1),u>=e&&10*o%e===0&&null!==h[d]&&0!==o&&(i=t.numberFormat(o/e,-1)+h[d]);return void 0===i&&(i=Math.abs(o)>=1e4?t.numberFormat(o,-1):t.numberFormat(o,-1,void 0,"")),i},getSeriesExtremes:function(){var t=this,e=t.chart;t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.threshold=null,t.softThreshold=!t.isXAxis,t.buildStacks&&t.buildStacks(),d(t.series,function(i){if(i.visible||!e.options.chart.ignoreHiddenSeries){var r,s,a,h=i.options,c=h.threshold;t.hasVisibleSeries=!0,t.positiveValuesOnly&&0>=c&&(c=null),t.isXAxis?(r=i.xData,r.length&&(s=o(r),a=n(r),y(s)||s instanceof Date||(r=m(r,y),s=o(r)),t.dataMin=Math.min(S(t.dataMin,r[0],s),s),t.dataMax=Math.max(S(t.dataMax,r[0],a),a))):(i.getExtremes(),a=i.dataMax,s=i.dataMin,l(s)&&l(a)&&(t.dataMin=Math.min(S(t.dataMin,s),s),t.dataMax=Math.max(S(t.dataMax,a),a)),l(c)&&(t.threshold=c),(!h.softThreshold||t.positiveValuesOnly)&&(t.softThreshold=!1))}})},translate:function(t,e,i,n,o,r){var s,a=this.linkedParent||this,l=1,h=0,c=n?a.oldTransA:a.transA,d=n?a.oldMin:a.min,p=a.minPixelPadding,u=(a.isOrdinal||a.isBroken||a.isLog&&o)&&a.lin2val;return c||(c=a.transA),i&&(l*=-1,h=a.len),a.reversed&&(l*=-1,h-=l*(a.sector||a.len)),e?(t=t*l+h,t-=p,s=t/c+d,u&&(s=a.lin2val(s))):(u&&(t=a.val2lin(t)),s=y(d)?l*(t-d)*c+h+l*p+(y(r)?c*r:0):void 0),s},toPixels:function(t,e){return this.translate(t,!1,!this.horiz,null,!0)+(e?0:this.pos)},toValue:function(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(t,e,i,n,o){var r,s,a,l,h,c=this,d=c.chart,p=c.left,u=c.top,g=i&&d.oldChartHeight||d.chartHeight,f=i&&d.oldChartWidth||d.chartWidth,m=c.transB,x=function(t,e,i){return(e>t||t>i)&&(n?t=Math.min(Math.max(e,t),i):h=!0),t};return o=S(o,c.translate(t,null,null,i)),r=a=Math.round(o+m),s=l=Math.round(g-o-m),y(o)?c.horiz?(s=u,l=g-c.bottom,r=a=x(r,p,p+c.width)):(r=p,a=f-c.right,s=l=x(s,u,u+c.height)):(h=!0,n=!1),h&&!n?null:d.renderer.crispLine(["M",r,s,"L",a,l],e||1)},getLinearTickPositions:function(t,e,i){var n,o,r,a=s(Math.floor(e/t)*t),l=s(Math.ceil(i/t)*t),h=[];if(s(a+t)===a&&(r=20),this.single)return[e];for(n=a;l>=n&&(h.push(n),n=s(n+t,r),n!==o);)o=n;return h},getMinorTickInterval:function(){var t=this.options;return t.minorTicks===!0?S(t.minorTickInterval,"auto"):t.minorTicks===!1?null:t.minorTickInterval},getMinorTickPositions:function(){var t,e=this,i=e.options,n=e.tickPositions,o=e.minorTickInterval,r=[],s=e.pointRangePadding||0,a=e.min-s,l=e.max+s,h=l-a;if(h&&h/o<e.len/3)if(e.isLog)d(this.paddedTicks,function(t,i,n){i&&r.push.apply(r,e.getLogTickPositions(o,n[i-1],n[i],!0))});else if(e.isDatetimeAxis&&"auto"===this.getMinorTickInterval())r=r.concat(e.getTimeTicks(e.normalizeTimeTickInterval(o),a,l,i.startOfWeek));else for(t=a+(n[0]-a)%o;l>=t&&t!==r[0];t+=o)r.push(t);return 0!==r.length&&e.trimTicks(r),r},adjustForMinRange:function(){var t,e,i,r,s,a,h,c,p,u,g=this,f=g.options,m=g.min,x=g.max;g.isXAxis&&void 0===g.minRange&&!g.isLog&&(l(f.min)||l(f.max)?g.minRange=null:(d(g.series,function(t){for(a=t.xData,h=t.xIncrement?1:a.length-1,r=h;r>0;r--)s=a[r]-a[r-1],(void 0===i||i>s)&&(i=s)}),g.minRange=Math.min(5*i,g.dataMax-g.dataMin))),x-m<g.minRange&&(e=g.dataMax-g.dataMin>=g.minRange,u=g.minRange,t=(u-x+m)/2,c=[m-t,S(f.min,m-t)],e&&(c[2]=g.isLog?g.log2lin(g.dataMin):g.dataMin),m=n(c),p=[m+u,S(f.max,m+u)],e&&(p[2]=g.isLog?g.log2lin(g.dataMax):g.dataMax),x=o(p),u>x-m&&(c[0]=x-u,c[1]=S(f.min,x-u),m=n(c))),g.min=m,g.max=x},getClosest:function(){var t;return this.categories?t=1:d(this.series,function(e){var i=e.closestPointRange,n=e.visible||!e.chart.options.chart.ignoreHiddenSeries;!e.noSharedTooltip&&l(i)&&n&&(t=l(t)?Math.min(t,i):i)}),t},nameToX:function(t){var e,i=v(this.categories),n=i?this.categories:this.names,o=t.options.x;return t.series.requireSorting=!1,l(o)||(o=this.options.uniqueNames===!1?t.series.autoIncrement():x(t.name,n)),-1===o?i||(e=n.length):e=o,void 0!==e&&(this.names[e]=t.name),e},updateNames:function(){var t=this;this.names.length>0&&(this.names.length=0,this.minRange=this.userMinRange,d(this.series||[],function(e){e.xIncrement=null,(!e.points||e.isDirtyData)&&(e.processData(),e.generatePoints()),d(e.points,function(i,n){var o;i.options&&(o=t.nameToX(i),void 0!==o&&o!==i.x&&(i.x=o,e.xData[n]=o))})}))},setAxisTranslation:function(t){var e,i,n=this,o=n.max-n.min,r=n.axisPointRange||0,s=0,a=0,l=n.linkedParent,h=!!n.categories,c=n.transA,p=n.isXAxis;(p||h||r)&&(e=n.getClosest(),l?(s=l.minPointOffset,a=l.pointRangePadding):d(n.series,function(t){var i=h?1:p?S(t.options.pointRange,e,0):n.axisPointRange||0,o=t.options.pointPlacement;r=Math.max(r,i),n.single||(s=Math.max(s,b(o)?0:i/2),a=Math.max(a,"on"===o?0:i))}),i=n.ordinalSlope&&e?n.ordinalSlope/e:1,n.minPointOffset=s*=i,n.pointRangePadding=a*=i,n.pointRange=Math.min(r,o),p&&(n.closestPointRange=e)),t&&(n.oldTransA=c),n.translationSlope=n.transA=c=n.options.staticScale||n.len/(o+a||1),n.transB=n.horiz?n.left:n.bottom,n.minPixelPadding=c*s},minFromRange:function(){return this.max-this.range},setTickInterval:function(e){var i,n,o,r,a,h,c,p=this,g=p.chart,m=p.options,x=p.isLog,v=p.log2lin,b=p.isDatetimeAxis,k=p.isXAxis,w=p.isLinked,A=m.maxPadding,T=m.minPadding,P=m.tickInterval,C=m.tickPixelInterval,L=p.categories,O=p.threshold,D=p.softThreshold;b||L||w||this.getTickAmount(),h=S(p.userMin,m.min),c=S(p.userMax,m.max),w?(p.linkedParent=g[p.coll][m.linkedTo],n=p.linkedParent.getExtremes(),p.min=S(n.min,n.dataMin),p.max=S(n.max,n.dataMax),m.type!==p.linkedParent.options.type&&t.error(11,1)):(!D&&l(O)&&(p.dataMin>=O?(r=O,T=0):p.dataMax<=O&&(a=O,A=0)),p.min=S(h,r,p.dataMin),p.max=S(c,a,p.dataMax)),x&&(p.positiveValuesOnly&&!e&&Math.min(p.min,S(p.dataMin,p.min))<=0&&t.error(10,1),p.min=s(v(p.min),15),p.max=s(v(p.max),15)),p.range&&l(p.max)&&(p.userMin=p.min=h=Math.max(p.dataMin,p.minFromRange()),p.userMax=c=p.max,p.range=null),u(p,"foundExtremes"),p.beforePadding&&p.beforePadding(),p.adjustForMinRange(),L||p.axisPointRange||p.usePercentage||w||!l(p.min)||!l(p.max)||(i=p.max-p.min,i&&(!l(h)&&T&&(p.min-=i*T),!l(c)&&A&&(p.max+=i*A))),y(m.softMin)&&!y(p.userMin)&&(p.min=Math.min(p.min,m.softMin)),y(m.softMax)&&!y(p.userMax)&&(p.max=Math.max(p.max,m.softMax)),y(m.floor)&&(p.min=Math.max(p.min,m.floor)),y(m.ceiling)&&(p.max=Math.min(p.max,m.ceiling)),D&&l(p.dataMin)&&(O=O||0,!l(h)&&p.min<O&&p.dataMin>=O?p.min=O:!l(c)&&p.max>O&&p.dataMax<=O&&(p.max=O)),p.tickInterval=p.min===p.max||void 0===p.min||void 0===p.max?1:w&&!P&&C===p.linkedParent.options.tickPixelInterval?P=p.linkedParent.tickInterval:S(P,this.tickAmount?(p.max-p.min)/Math.max(this.tickAmount-1,1):void 0,L?1:(p.max-p.min)*C/Math.max(p.len,C)),k&&!e&&d(p.series,function(t){t.processData(p.min!==p.oldMin||p.max!==p.oldMax)}),p.setAxisTranslation(!0),p.beforeSetTickPositions&&p.beforeSetTickPositions(),p.postProcessTickInterval&&(p.tickInterval=p.postProcessTickInterval(p.tickInterval)),p.pointRange&&!P&&(p.tickInterval=Math.max(p.pointRange,p.tickInterval)),o=S(m.minTickInterval,p.isDatetimeAxis&&p.closestPointRange),!P&&p.tickInterval<o&&(p.tickInterval=o),b||x||P||(p.tickInterval=M(p.tickInterval,null,f(p.tickInterval),S(m.allowDecimals,!(p.tickInterval>.5&&p.tickInterval<5&&p.max>1e3&&p.max<9999)),!!this.tickAmount)),this.tickAmount||(p.tickInterval=p.unsquish()),this.setTickPositions()},setTickPositions:function(){var t,e=this.options,i=e.tickPositions,n=this.getMinorTickInterval(),o=e.tickPositioner,r=e.startOnTick,s=e.endOnTick;this.tickmarkOffset=this.categories&&"between"===e.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===n&&this.tickInterval?this.tickInterval/5:n,this.single=this.min===this.max&&l(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||e.allowDecimals!==!1),this.tickPositions=t=i&&i.slice(),t||(t=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,e.units),this.min,this.max,e.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),t.length>this.len&&(t=[t[0],t.pop()],t[0]===t[1]&&(t.length=1)),this.tickPositions=t,o&&(o=o.apply(this,[this.min,this.max]),o&&(this.tickPositions=t=o))),this.paddedTicks=t.slice(0),this.trimTicks(t,r,s),this.isLinked||(this.single&&t.length<2&&(this.min-=.5,this.max+=.5),i||o||this.adjustTickAmount())},trimTicks:function(t,e,i){var n=t[0],o=t[t.length-1],r=this.minPointOffset||0;if(!this.isLinked){if(e&&n!==-1/0)this.min=n;else for(;this.min-r>t[0];)t.shift();if(i)this.max=o;else for(;this.max+r<t[t.length-1];)t.pop();0===t.length&&l(n)&&!this.options.tickPositions&&t.push((o+n)/2)}},alignToOthers:function(){var t,e={},i=this.options;return this.chart.options.chart.alignTicks===!1||i.alignTicks===!1||this.isLog||d(this.chart[this.coll],function(i){var n=i.options,o=i.horiz,r=[o?n.left:n.top,n.width,n.height,n.pane].join(",");i.series.length&&(e[r]?t=!0:e[r]=1)}),t},getTickAmount:function(){var t=this.options,e=t.tickAmount,i=t.tickPixelInterval;!l(t.tickInterval)&&this.len<i&&!this.isRadial&&!this.isLog&&t.startOnTick&&t.endOnTick&&(e=2),!e&&this.alignToOthers()&&(e=Math.ceil(this.len/i)+1),4>e&&(this.finalTickAmt=e,e=5),this.tickAmount=e},adjustTickAmount:function(){var t,e,i=this.tickInterval,n=this.tickPositions,o=this.tickAmount,r=this.finalTickAmt,a=n&&n.length,h=S(this.threshold,this.softThreshold?0:null);if(this.hasData()){if(o>a){for(;n.length<o;)n.length%2||this.min===h?n.push(s(n[n.length-1]+i)):n.unshift(s(n[0]-i));this.transA*=(a-1)/(o-1),this.min=n[0],this.max=n[n.length-1]}else a>o&&(this.tickInterval*=2,this.setTickPositions());if(l(r)){for(t=e=n.length;t--;)(3===r&&t%2===1||2>=r&&t>0&&e-1>t)&&n.splice(t,1);this.finalTickAmt=void 0}}},setScale:function(){var t,e,i=this;i.oldMin=i.min,i.oldMax=i.max,i.oldAxisLength=i.len,i.setAxisSize(),e=i.len!==i.oldAxisLength,d(i.series,function(e){(e.isDirtyData||e.isDirty||e.xAxis.isDirty)&&(t=!0)}),e||t||i.isLinked||i.forceRedraw||i.userMin!==i.oldUserMin||i.userMax!==i.oldUserMax||i.alignToOthers()?(i.resetStacks&&i.resetStacks(),i.forceRedraw=!1,i.getSeriesExtremes(),i.setTickInterval(),i.oldUserMin=i.userMin,i.oldUserMax=i.userMax,i.isDirty||(i.isDirty=e||i.min!==i.oldMin||i.max!==i.oldMax)):i.cleanStacks&&i.cleanStacks()},setExtremes:function(t,e,i,n,o){var r=this,s=r.chart;i=S(i,!0),d(r.series,function(t){delete t.kdTree}),o=p(o,{min:t,max:e}),u(r,"setExtremes",o,function(){r.userMin=t,r.userMax=e,r.eventArgs=o,i&&s.redraw(n)})},zoom:function(t,e){var i=this.dataMin,n=this.dataMax,o=this.options,r=Math.min(i,S(o.min,i)),s=Math.max(n,S(o.max,n));return(t!==this.min||e!==this.max)&&(this.allowZoomOutside||(l(i)&&(r>t&&(t=r),t>s&&(t=s)),l(n)&&(r>e&&(e=r),e>s&&(e=s))),this.displayBtn=void 0!==t||void 0!==e,this.setExtremes(t,e,!1,void 0,{trigger:"zoom"})),!0},setAxisSize:function(){var e=this.chart,i=this.options,n=i.offsets||[0,0,0,0],o=this.horiz,r=this.width=Math.round(t.relativeLength(S(i.width,e.plotWidth-n[3]+n[1]),e.plotWidth)),s=this.height=Math.round(t.relativeLength(S(i.height,e.plotHeight-n[0]+n[2]),e.plotHeight)),a=this.top=Math.round(t.relativeLength(S(i.top,e.plotTop+n[0]),e.plotHeight,e.plotTop)),l=this.left=Math.round(t.relativeLength(S(i.left,e.plotLeft+n[3]),e.plotWidth,e.plotLeft));this.bottom=e.chartHeight-s-a,this.right=e.chartWidth-r-l,this.len=Math.max(o?r:s,0),this.pos=o?l:a},getExtremes:function(){{var t=this,e=t.isLog;t.lin2log}return{min:e?s(t.lin2log(t.min)):t.min,max:e?s(t.lin2log(t.max)):t.max,dataMin:t.dataMin,dataMax:t.dataMax,userMin:t.userMin,userMax:t.userMax}},getThreshold:function(t){var e=this,i=e.isLog,n=(e.lin2log,i?e.lin2log(e.min):e.min),o=i?e.lin2log(e.max):e.max;return null===t?t=n:n>t?t=n:t>o&&(t=o),e.translate(t,0,1,0,1)},autoLabelAlign:function(t){var e,i=(S(t,0)-90*this.side+720)%360;return e=i>15&&165>i?"right":i>195&&345>i?"left":"center"},tickSize:function(t){var e=this.options,i=e[t+"Length"],n=S(e[t+"Width"],"tick"===t&&this.isXAxis?1:0);return n&&i?("inside"===e[t+"Position"]&&(i=-i),[i,n]):void 0},labelMetrics:function(){var t=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[t]&&this.ticks[t].label)},unsquish:function(){var t,e,i,n=this.options.labels,o=this.horiz,r=this.tickInterval,s=r,a=this.len/(((this.categories?1:0)+this.max-this.min)/r),c=n.rotation,p=this.labelMetrics(),u=Number.MAX_VALUE,g=function(t){var e=t/(a||1);return e=e>1?Math.ceil(e):1,e*r};return o?(i=!n.staggerLines&&!n.step&&(l(c)?[c]:a<S(n.autoRotationLimit,80)&&n.autoRotation),i&&d(i,function(i){var n;(i===c||i&&i>=-90&&90>=i)&&(e=g(Math.abs(p.h/Math.sin(h*i))),n=e+Math.abs(i/360),u>n&&(u=n,t=i,s=e))})):n.step||(s=g(p.h)),this.autoRotation=i,this.labelRotation=S(t,c),s},getSlotWidth:function(){var t=this.chart,e=this.horiz,i=this.options.labels,n=Math.max(this.tickPositions.length-(this.categories?0:1),1),o=t.margin[3];return e&&(i.step||0)<2&&!i.rotation&&(this.staggerLines||1)*this.len/n||!e&&(i.style&&parseInt(i.style.width,10)||o&&o-t.spacing[3]||.33*t.chartWidth)},renderUnsquish:function(){var t,e,i,n,o=this.chart,r=o.renderer,s=this.tickPositions,a=this.ticks,l=this.options.labels,h=this.horiz,c=this.getSlotWidth(),p=Math.max(1,Math.round(c-2*(l.padding||5))),u={},g=this.labelMetrics(),f=l.style&&l.style.textOverflow,m=0;if(b(l.rotation)||(u.rotation=l.rotation||0),d(s,function(t){t=a[t],t&&t.labelLength>m&&(m=t.labelLength)}),this.maxLabelLength=m,this.autoRotation)m>p&&m>g.h?u.rotation=this.labelRotation:this.labelRotation=0;else if(c&&(t={width:p+"px"},!f))for(t.textOverflow="clip",i=s.length;!h&&i--;)n=s[i],e=a[n].label,e&&(e.styles&&"ellipsis"===e.styles.textOverflow?e.css({textOverflow:"clip"}):a[n].labelLength>c&&e.css({width:c+"px"}),e.getBBox().height>this.len/s.length-(g.h-g.f)&&(e.specCss={textOverflow:"ellipsis"}));u.rotation&&(t={width:(m>.5*o.chartHeight?.33*o.chartHeight:o.chartHeight)+"px"},f||(t.textOverflow="ellipsis")),this.labelAlign=l.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(u.align=this.labelAlign),d(s,function(e){var i=a[e],n=i&&i.label;n&&(n.attr(u),t&&n.css(k(t,n.specCss)),delete n.specCss,i.rotation=u.rotation)}),this.tickRotCorr=r.rotCorr(g.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||l(this.min)&&l(this.max)&&this.tickPositions&&this.tickPositions.length>0},addTitle:function(t){var e,i=this,n=i.chart.renderer,o=i.horiz,r=i.opposite,s=i.options,a=s.title;i.axisTitle||(e=a.textAlign,e||(e=(o?{low:"left",middle:"center",high:"right"}:{low:r?"right":"left",middle:"center",high:r?"left":"right"})[a.align]),i.axisTitle=n.text(a.text,0,0,a.useHTML).attr({zIndex:7,rotation:a.rotation||0,align:e}).addClass("highcharts-axis-title").css(a.style).add(i.axisGroup),i.axisTitle.isNew=!0),a.style.width||i.isRadial||i.axisTitle.css({width:i.len}),i.axisTitle[t?"show":"hide"](!0)},generateTick:function(t){var e=this.ticks;e[t]?e[t].addLabel():e[t]=new C(this,t)},getOffset:function(){var t,e,i,n,o,r,s=this,a=s.chart,h=a.renderer,c=s.options,p=s.tickPositions,u=s.ticks,g=s.horiz,f=s.side,m=a.inverted&&!s.isZAxis?[1,0,3,2][f]:f,x=0,v=0,y=c.title,b=c.labels,k=0,M=a.axisOffset,A=a.clipOffset,T=[-1,1,1,-1][f],P=c.className,C=s.axisParent,L=this.tickSize("tick");t=s.hasData(),s.showAxis=e=t||S(c.showEmpty,!0),s.staggerLines=s.horiz&&b.staggerLines,s.axisGroup||(s.gridGroup=h.g("grid").attr({zIndex:c.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(P||"")).add(C),s.axisGroup=h.g("axis").attr({zIndex:c.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(P||"")).add(C),s.labelGroup=h.g("axis-labels").attr({zIndex:b.zIndex||7}).addClass("highcharts-"+s.coll.toLowerCase()+"-labels "+(P||"")).add(C)),t||s.isLinked?(d(p,function(t,e){s.generateTick(t,e)}),s.renderUnsquish(),s.reserveSpaceDefault=0===f||2===f||{1:"left",3:"right"}[f]===s.labelAlign,S(b.reserveSpace,"center"===s.labelAlign?!0:null,s.reserveSpaceDefault)&&d(p,function(t){k=Math.max(u[t].getLabelSize(),k)}),s.staggerLines&&(k*=s.staggerLines),s.labelOffset=k*(s.opposite?-1:1)):w(u,function(t,e){t.destroy(),delete u[e]}),y&&y.text&&y.enabled!==!1&&(s.addTitle(e),e&&y.reserveSpace!==!1&&(s.titleOffset=x=s.axisTitle.getBBox()[g?"height":"width"],i=y.offset,v=l(i)?0:S(y.margin,g?5:10))),s.renderLine(),s.offset=T*S(c.offset,M[f]),s.tickRotCorr=s.tickRotCorr||{x:0,y:0},r=0===f?-s.labelMetrics().h:2===f?s.tickRotCorr.y:0,n=Math.abs(k)+v,k&&(n-=r,n+=T*(g?S(b.y,s.tickRotCorr.y+8*T):b.x)),s.axisTitleMargin=S(i,n),M[f]=Math.max(M[f],s.axisTitleMargin+x+T*s.offset,n,t&&p.length&&L?L[0]+T*s.offset:0),o=c.offset?0:2*Math.floor(s.axisLine.strokeWidth()/2),A[m]=Math.max(A[m],o)},getLinePath:function(t){var e=this.chart,i=this.opposite,n=this.offset,o=this.horiz,r=this.left+(i?this.width:0)+n,s=e.chartHeight-this.bottom-(i?this.height:0)+n;return i&&(t*=-1),e.renderer.crispLine(["M",o?this.left:r,o?s:this.top,"L",o?e.chartWidth-this.right:r,o?s:e.chartHeight-this.bottom],t)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var t=this.horiz,e=this.left,i=this.top,n=this.len,o=this.options.title,r=t?e:i,s=this.opposite,a=this.offset,l=o.x||0,h=o.y||0,c=this.axisTitle,d=this.chart.renderer.fontMetrics(o.style&&o.style.fontSize,c),p=Math.max(c.getBBox(null,0).height-d.h-1,0),u={low:r+(t?0:n),middle:r+n/2,high:r+(t?n:0)}[o.align],g=(t?i+this.height:e)+(t?1:-1)*(s?-1:1)*this.axisTitleMargin+[-p,p,d.f,-p][this.side];return{x:t?u+l:g+(s?this.width:0)+a+l,y:t?g+h-(s?this.height:0)+a:u+h}},renderMinorTick:function(t){var e=this.chart.hasRendered&&y(this.oldMin),i=this.minorTicks;i[t]||(i[t]=new C(this,t,"minor")),e&&i[t].isNew&&i[t].render(null,!0),i[t].render(null,!1,1)},renderTick:function(t,e){var i=this.isLinked,n=this.ticks,o=this.chart.hasRendered&&y(this.oldMin);(!i||t>=this.min&&t<=this.max)&&(n[t]||(n[t]=new C(this,t)),o&&n[t].isNew&&n[t].render(e,!0,.1),n[t].render(e))},render:function(){var e,n,o=this,r=o.chart,s=r.renderer,a=o.options,l=o.isLog,h=(o.lin2log,o.isLinked),c=o.tickPositions,p=o.axisTitle,u=o.ticks,g=o.minorTicks,f=o.alternateBands,m=a.stackLabels,x=a.alternateGridColor,v=o.tickmarkOffset,b=o.axisLine,k=o.showAxis,M=i(s.globalAnimation);if(o.labelEdge.length=0,o.overlap=!1,d([u,g,f],function(t){w(t,function(t){t.isActive=!1})}),(o.hasData()||h)&&(o.minorTickInterval&&!o.categories&&d(o.getMinorTickPositions(),function(t){o.renderMinorTick(t)}),c.length&&(d(c,function(t,e){o.renderTick(t,e)}),v&&(0===o.min||o.single)&&(u[-1]||(u[-1]=new C(o,-1,null,!0)),u[-1].render(-1))),x&&d(c,function(i,s){n=void 0!==c[s+1]?c[s+1]+v:o.max-v,s%2===0&&i<o.max&&n<=o.max+(r.polar?-v:v)&&(f[i]||(f[i]=new t.PlotLineOrBand(o)),e=i+v,f[i].options={from:l?o.lin2log(e):e,to:l?o.lin2log(n):n,color:x},f[i].render(),f[i].isActive=!0)}),o._addedPlotLB||(d((a.plotLines||[]).concat(a.plotBands||[]),function(t){o.addPlotBandOrLine(t)}),o._addedPlotLB=!0)),d([u,g,f],function(t){var e,i=[],n=M.duration,o=function(){for(e=i.length;e--;)t[i[e]]&&!t[i[e]].isActive&&(t[i[e]].destroy(),delete t[i[e]])};w(t,function(t,e){t.isActive||(t.render(e,!1,0),t.isActive=!1,i.push(e))}),P(o,t!==f&&r.hasRendered&&n?n:0)}),b&&(b[b.isPlaced?"animate":"attr"]({d:this.getLinePath(b.strokeWidth())}),b.isPlaced=!0,b[k?"show":"hide"](!0)),p&&k){var S=o.getTitlePosition();y(S.y)?(p[p.isNew?"attr":"animate"](S),p.isNew=!1):(p.attr("y",-9999),p.isNew=!0)}m&&m.enabled&&o.renderStackTotals(),o.isDirty=!1},redraw:function(){this.visible&&(this.render(),d(this.plotLinesAndBands,function(t){t.render()})),d(this.series,function(t){t.isDirty=!0})},keepProps:["extKey","hcEvents","names","series","userMax","userMin"],destroy:function(t){var e,i,n=this,o=n.stacks,r=n.plotLinesAndBands;if(t||A(n),w(o,function(t,e){c(t),o[e]=null}),d([n.ticks,n.minorTicks,n.alternateBands],function(t){c(t)}),r)for(i=r.length;i--;)r[i].destroy();d(["stackTotalGroup","axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross"],function(t){n[t]&&(n[t]=n[t].destroy())});for(e in n.plotLinesAndBandsGroups)n.plotLinesAndBandsGroups[e]=n.plotLinesAndBandsGroups[e].destroy();w(n,function(t,e){-1===x(e,n.keepProps)&&delete n[e]})},drawCrosshair:function(t,e){var i,n,o,s=this.crosshair,a=S(s.snap,!0),h=this.cross;if(t||(t=this.cross&&this.cross.e),this.crosshair&&(l(e)||!a)!==!1){if(a?l(e)&&(n=this.isXAxis?e.plotX:this.len-e.plotY):n=t&&(this.horiz?t.chartX-this.pos:this.len-t.chartY+this.pos),l(n)&&(i=this.getPlotLinePath(e&&(this.isXAxis?e.x:S(e.stackY,e.y)),null,null,null,n)||null),!l(i))return void this.hideCrosshair();o=this.categories&&!this.isRadial,h||(this.cross=h=this.chart.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(o?"category ":"thin ")+s.className).attr({zIndex:S(s.zIndex,2)}).add(),h.attr({stroke:s.color||(o?r("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":S(s.width,1)}).css({"pointer-events":"none"}),s.dashStyle&&h.attr({dashstyle:s.dashStyle})),h.show().attr({d:i}),o&&!s.width&&h.attr({"stroke-width":this.transA}),this.cross.e=t}else this.hideCrosshair()},hideCrosshair:function(){this.cross&&this.cross.hide()}}),t.Axis=L,L}(e);!function(t){var e=t.Axis,i=t.Date,n=t.dateFormat,o=t.defaultOptions,r=t.defined,s=t.each,a=t.extend,l=t.getMagnitude,h=t.getTZOffset,c=t.normalizeTickInterval,d=t.pick,p=t.timeUnits;e.prototype.getTimeTicks=function(t,e,l,c){var u,g,f,m,x=[],v={},y=o.global.useUTC,b=new i(e-Math.max(h(e),h(l))),k=i.hcMakeTime,M=t.unitRange,w=t.count;if(r(e)){b[i.hcSetMilliseconds](M>=p.second?0:w*Math.floor(b.getMilliseconds()/w)),M>=p.second&&b[i.hcSetSeconds](M>=p.minute?0:w*Math.floor(b.getSeconds()/w)),M>=p.minute&&b[i.hcSetMinutes](M>=p.hour?0:w*Math.floor(b[i.hcGetMinutes]()/w)),M>=p.hour&&b[i.hcSetHours](M>=p.day?0:w*Math.floor(b[i.hcGetHours]()/w)),M>=p.day&&b[i.hcSetDate](M>=p.month?1:w*Math.floor(b[i.hcGetDate]()/w)),M>=p.month&&(b[i.hcSetMonth](M>=p.year?0:w*Math.floor(b[i.hcGetMonth]()/w)),g=b[i.hcGetFullYear]()),M>=p.year&&(g-=g%w,b[i.hcSetFullYear](g)),M===p.week&&b[i.hcSetDate](b[i.hcGetDate]()-b[i.hcGetDay]()+d(c,1)),g=b[i.hcGetFullYear]();var S=b[i.hcGetMonth](),A=b[i.hcGetDate](),T=b[i.hcGetHours]();e=b.getTime(),i.hcHasTimeZone&&(m=(!y||!!i.hcGetTimezoneOffset)&&(l-e>4*p.month||h(e)!==h(l)),f=h(b),b=new i(e+f));var P=b.getTime();for(u=1;l>P;)x.push(P),M===p.year?P=k(g+u*w,0):M===p.month?P=k(g,S+u*w):!m||M!==p.day&&M!==p.week?m&&M===p.hour?P=k(g,S,A,T+u*w,0,0,f)-f:P+=M*w:P=k(g,S,A+u*w*(M===p.day?1:7)),u++;x.push(P),M<=p.hour&&x.length<1e4&&s(x,function(t){t%18e5===0&&"000000000"===n("%H%M%S%L",t)&&(v[t]="day")})}return x.info=a(t,{higherRanks:v,totalRange:M*w}),x},e.prototype.normalizeTimeTickInterval=function(t,e){var i,n,o=e||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],r=o[o.length-1],s=p[r[0]],a=r[1];for(n=0;n<o.length;n++)if(r=o[n],s=p[r[0]],a=r[1],o[n+1]){var h=(s*a[a.length-1]+p[o[n+1][0]])/2;if(h>=t)break}return s===p.year&&5*s>t&&(a=[1,2,5]),i=c(t/s,a,"year"===r[0]?Math.max(l(t/s),1):1),{unitRange:s,count:i,unitName:r[0]}}}(e),function(t){var e=t.Axis,i=t.getMagnitude,n=t.map,o=t.normalizeTickInterval,r=t.pick;e.prototype.getLogTickPositions=function(t,e,s,a){var l=this,h=l.options,c=l.len,d=l.lin2log,p=l.log2lin,u=[];if(a||(l._minorAutoInterval=null),t>=.5)t=Math.round(t),u=l.getLinearTickPositions(t,e,s);else if(t>=.08){var g,f,m,x,v,y,b,k=Math.floor(e);for(g=t>.3?[1,2,4]:t>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],f=k;s+1>f&&!b;f++)for(x=g.length,m=0;x>m&&!b;m++)v=l.log2lin(l.lin2log(f)*g[m]),v>e&&(!a||s>=y)&&void 0!==y&&u.push(y),y>s&&(b=!0),y=v}else{var M=l.lin2log(e),w=d(s),S=a?this.getMinorTickInterval():h.tickInterval,A="auto"===S?null:S,T=h.tickPixelInterval/(a?5:1),P=a?c/l.tickPositions.length:c;t=r(A,l._minorAutoInterval,(w-M)*T/(P||1)),t=o(t,null,i(t)),u=n(l.getLinearTickPositions(t,M,w),p),a||(l._minorAutoInterval=t/5)}return a||(l.tickInterval=t),u},e.prototype.log2lin=function(t){return Math.log(t)/Math.LN10},e.prototype.lin2log=function(t){return Math.pow(10,t)}}(e),function(t,e){var i=t.arrayMax,n=t.arrayMin,o=t.defined,r=t.destroyObjectProperties,s=t.each,a=t.erase,l=t.merge,h=t.pick;t.PlotLineOrBand=function(t,e){this.axis=t,e&&(this.options=e,this.id=e.id)},t.PlotLineOrBand.prototype={render:function(){var e,i=this,n=i.axis,r=n.horiz,s=i.options,a=s.label,c=i.label,d=s.to,p=s.from,u=s.value,g=o(p)&&o(d),f=o(u),m=i.svgElem,x=!m,v=[],y=s.color,b=h(s.zIndex,0),k=s.events,M={class:"highcharts-plot-"+(g?"band ":"line ")+(s.className||"")},w={},S=n.chart.renderer,A=g?"bands":"lines",T=n.log2lin;if(n.isLog&&(p=T(p),d=T(d),u=T(u)),f?(M={stroke:y,"stroke-width":s.width},s.dashStyle&&(M.dashstyle=s.dashStyle)):g&&(y&&(M.fill=y),s.borderWidth&&(M.stroke=s.borderColor,M["stroke-width"]=s.borderWidth)),w.zIndex=b,A+="-"+b,e=n.plotLinesAndBandsGroups[A],e||(n.plotLinesAndBandsGroups[A]=e=S.g("plot-"+A).attr(w).add()),x&&(i.svgElem=m=S.path().attr(M).add(e)),f)v=n.getPlotLinePath(u,m.strokeWidth());else{if(!g)return;v=n.getPlotBandPath(p,d,s)}return x&&v&&v.length?(m.attr({d:v}),k&&t.objectEach(k,function(t,e){m.on(e,function(t){k[e].apply(i,[t])})})):m&&(v?(m.show(),m.animate({d:v})):(m.hide(),c&&(i.label=c=c.destroy()))),a&&o(a.text)&&v&&v.length&&n.width>0&&n.height>0&&!v.flat?(a=l({align:r&&g&&"center",x:r?!g&&4:10,verticalAlign:!r&&g&&"middle",y:r?g?16:10:g?6:-4,rotation:r&&!g&&90},a),this.renderLabel(a,v,g,b)):c&&c.hide(),i},renderLabel:function(t,e,o,r){var s,a,l,h,c,d=this,p=d.label,u=d.axis.chart.renderer;p||(s={align:t.textAlign||t.align,rotation:t.rotation,class:"highcharts-plot-"+(o?"band":"line")+"-label "+(t.className||"")},s.zIndex=r,d.label=p=u.text(t.text,0,0,t.useHTML).attr(s).add(),p.css(t.style)),a=e.xBounds||[e[1],e[4],o?e[6]:e[1]],l=e.yBounds||[e[2],e[5],o?e[7]:e[2]],h=n(a),c=n(l),p.align(t,!1,{x:h,y:c,width:i(a)-h,height:i(l)-c}),p.show()},destroy:function(){a(this.axis.plotLinesAndBands,this),delete this.axis,r(this)}},t.extend(e.prototype,{getPlotBandPath:function(t,e){var i,n,o=this.getPlotLinePath(e,null,null,!0),r=this.getPlotLinePath(t,null,null,!0),s=[],a=this.horiz,l=1,h=t<this.min&&e<this.min||t>this.max&&e>this.max;if(r&&o)for(h&&(n=r.toString()===o.toString(),l=0),i=0;i<r.length;i+=6)a&&o[i+1]===r[i+1]?(o[i+1]+=l,o[i+4]+=l):a||o[i+2]!==r[i+2]||(o[i+2]+=l,o[i+5]+=l),s.push("M",r[i+1],r[i+2],"L",r[i+4],r[i+5],o[i+4],o[i+5],o[i+1],o[i+2],"z"),s.flat=n;else r=null;return s},addPlotBand:function(t){return this.addPlotBandOrLine(t,"plotBands")},addPlotLine:function(t){return this.addPlotBandOrLine(t,"plotLines")},addPlotBandOrLine:function(e,i){var n=new t.PlotLineOrBand(this,e).render(),o=this.userOptions;return n&&(i&&(o[i]=o[i]||[],o[i].push(e)),this.plotLinesAndBands.push(n)),n},removePlotBandOrLine:function(t){for(var e=this.plotLinesAndBands,i=this.options,n=this.userOptions,o=e.length;o--;)e[o].id===t&&e[o].destroy();s([i.plotLines||[],n.plotLines||[],i.plotBands||[],n.plotBands||[]],function(e){for(o=e.length;o--;)e[o].id===t&&a(e,e[o])})},removePlotBand:function(t){this.removePlotBandOrLine(t)},removePlotLine:function(t){this.removePlotBandOrLine(t)}})}(e,i),function(t){var e=t.dateFormat,i=t.each,n=t.extend,o=t.format,r=t.isNumber,s=t.map,a=t.merge,l=t.pick,h=t.splat,c=t.syncTimeout,d=t.timeUnits;t.Tooltip=function(){this.init.apply(this,arguments)},t.Tooltip.prototype={init:function(t,e){this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=e.split&&!t.inverted,this.shared=e.shared||this.split},cleanSplit:function(t){i(this.chart.series,function(e){var i=e&&e.tt;i&&(!i.isActive||t?e.tt=i.destroy():i.isActive=!1)})},getLabel:function(){var t=this.chart.renderer,e=this.options;return this.label||(this.split?this.label=t.g("tooltip"):(this.label=t.label("",0,0,e.shape||"callout",null,null,e.useHTML,null,"tooltip").attr({padding:e.padding,r:e.borderRadius}),this.label.attr({fill:e.backgroundColor,"stroke-width":e.borderWidth}).css(e.style).shadow(e.shadow)),this.label.attr({zIndex:8}).add()),this.label},update:function(t){this.destroy(),a(!0,this.chart.options.tooltip.userOptions,t),this.init(this.chart,a(!0,this.options,t))},destroy:function(){this.label&&(this.label=this.label.destroy()),this.split&&this.tt&&(this.cleanSplit(this.chart,!0),this.tt=this.tt.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(t,e,i,o){var r=this,s=r.now,a=r.options.animation!==!1&&!r.isHidden&&(Math.abs(t-s.x)>1||Math.abs(e-s.y)>1),l=r.followPointer||r.len>1;n(s,{x:a?(2*s.x+t)/3:t,y:a?(s.y+e)/2:e,anchorX:l?void 0:a?(2*s.anchorX+i)/3:i,anchorY:l?void 0:a?(s.anchorY+o)/2:o}),r.getLabel().attr(s),a&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){r&&r.move(t,e,i,o)},32))},hide:function(t){var e=this;clearTimeout(this.hideTimer),t=l(t,this.options.hideDelay,500),this.isHidden||(this.hideTimer=c(function(){e.getLabel()[t?"fadeOut":"hide"](),e.isHidden=!0},t))},getAnchor:function(t,e){var n,o,r,a=this.chart,l=a.inverted,c=a.plotTop,d=a.plotLeft,p=0,u=0;return t=h(t),n=t[0].tooltipPos,this.followPointer&&e&&(void 0===e.chartX&&(e=a.pointer.normalize(e)),n=[e.chartX-a.plotLeft,e.chartY-c]),n||(i(t,function(t){o=t.series.yAxis,r=t.series.xAxis,p+=t.plotX+(!l&&r?r.left-d:0),u+=(t.plotLow?(t.plotLow+t.plotHigh)/2:t.plotY)+(!l&&o?o.top-c:0)}),p/=t.length,u/=t.length,n=[l?a.plotWidth-u:p,this.shared&&!l&&t.length>1&&e?e.chartY-c:l?a.plotHeight-p:u]),s(n,Math.round)},getPosition:function(t,e,i){var n,o=this.chart,r=this.distance,s={},a=o.inverted&&i.h||0,h=["y",o.chartHeight,e,i.plotY+o.plotTop,o.plotTop,o.plotTop+o.plotHeight],c=["x",o.chartWidth,t,i.plotX+o.plotLeft,o.plotLeft,o.plotLeft+o.plotWidth],d=!this.followPointer&&l(i.ttBelow,!o.inverted==!!i.negative),p=function(t,e,i,n,o,l){var h=n-r>i,c=e>n+r+i,p=n-r-i,u=n+r;if(d&&c)s[t]=u;else if(!d&&h)s[t]=p;else if(h)s[t]=Math.min(l-i,0>p-a?p:p-a);else{if(!c)return!1;s[t]=Math.max(o,u+a+i>e?u:u+a)}},u=function(t,e,i,n){var o;return r>n||n>e-r?o=!1:s[t]=i/2>n?1:n>e-i/2?e-i-2:n-i/2,o},g=function(t){var e=h;h=c,c=e,n=t},f=function(){p.apply(0,h)!==!1?u.apply(0,c)!==!1||n||(g(!0),f()):n?s.x=s.y=0:(g(!0),f())};return(o.inverted||this.len>1)&&g(),f(),s},defaultFormatter:function(t){var e,i=this.points||h(this);return e=[t.tooltipFooterHeaderFormatter(i[0])],e=e.concat(t.bodyFormatter(i)),e.push(t.tooltipFooterHeaderFormatter(i[0],!0)),e},refresh:function(t,e){var n,o,r,s,a,c,d=this,p=d.options,u=t,g={},f=[],m=p.formatter||d.defaultFormatter,x=d.shared;p.enabled&&(clearTimeout(this.hideTimer),d.followPointer=h(u)[0].series.tooltipOptions.followPointer,s=d.getAnchor(u,e),o=s[0],r=s[1],!x||u.series&&u.series.noSharedTooltip?g=u.getLabelConfig():(i(u,function(t){t.setState("hover"),f.push(t.getLabelConfig())}),g={x:u[0].category,y:u[0].y},g.points=f,u=u[0]),this.len=f.length,a=m.call(g,d),c=u.series,this.distance=l(c.tooltipOptions.distance,16),a===!1?this.hide():(n=d.getLabel(),d.isHidden&&n.attr({opacity:1}).show(),d.split?this.renderSplit(a,h(t)):(p.style.width||n.css({width:this.chart.spacingBox.width}),n.attr({text:a&&a.join?a.join(""):a}),n.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+l(u.colorIndex,c.colorIndex)),n.attr({stroke:p.borderColor||u.color||c.color||"#666666"}),d.updatePosition({plotX:o,plotY:r,negative:u.negative,ttBelow:u.ttBelow,h:s[2]||0})),this.isHidden=!1))},renderSplit:function(e,n){var o=this,r=[],s=this.chart,a=s.renderer,h=!0,c=this.options,d=0,p=this.getLabel();t.isString(e)&&(e=[!1,e]),i(e.slice(0,n.length+1),function(t,e){if(t!==!1){var i,u,g,f,m=n[e-1]||{isHeader:!0,plotX:n[0].plotX},x=m.series||o,v=x.tt,y=m.series||{},b="highcharts-color-"+l(m.colorIndex,y.colorIndex,"none");v||(x.tt=v=a.label(null,null,null,"callout",null,null,c.useHTML).addClass("highcharts-tooltip-box "+b).attr({padding:c.padding,r:c.borderRadius,fill:c.backgroundColor,stroke:c.borderColor||m.color||y.color||"#333333","stroke-width":c.borderWidth}).add(p)),v.isActive=!0,v.attr({text:t}),v.css(c.style).shadow(c.shadow),g=v.getBBox(),f=g.width+v.strokeWidth(),m.isHeader?(d=g.height,u=Math.max(0,Math.min(m.plotX+s.plotLeft-f/2,s.chartWidth-f))):u=m.plotX+s.plotLeft-l(c.distance,16)-f,0>u&&(h=!1),i=(m.series&&m.series.yAxis&&m.series.yAxis.pos)+(m.plotY||0),i-=s.plotTop,r.push({target:m.isHeader?s.plotHeight+d:i,rank:m.isHeader?1:0,size:x.tt.getBBox().height+1,point:m,x:u,tt:v})}}),this.cleanSplit(),t.distribute(r,s.plotHeight+d),i(r,function(t){var e=t.point,i=e.series;t.tt.attr({visibility:void 0===t.pos?"hidden":"inherit",x:h||e.isHeader?t.x:e.plotX+s.plotLeft+l(c.distance,16),y:t.pos+s.plotTop,anchorX:e.isHeader?e.plotX+s.plotLeft:e.plotX+i.xAxis.pos,anchorY:e.isHeader?t.pos+s.plotTop-15:e.plotY+i.yAxis.pos})})},updatePosition:function(t){var e=this.chart,i=this.getLabel(),n=(this.options.positioner||this.getPosition).call(this,i.width,i.height,t);this.move(Math.round(n.x),Math.round(n.y||0),t.plotX+e.plotLeft,t.plotY+e.plotTop)},getDateFormat:function(t,i,n,o){var r,s,a=e("%m-%d %H:%M:%S.%L",i),l="01-01 00:00:00.000",h={millisecond:15,second:12,minute:9,hour:6,day:3},c="millisecond";for(s in d){if(t===d.week&&+e("%w",i)===n&&a.substr(6)===l.substr(6)){s="week";break}if(d[s]>t){s=c;break}if(h[s]&&a.substr(h[s])!==l.substr(h[s]))break;"week"!==s&&(c=s)}return s&&(r=o[s]),r},getXDateFormat:function(t,e,i){var n,o=e.dateTimeLabelFormats,r=i&&i.closestPointRange;return n=r?this.getDateFormat(r,t.x,i.options.startOfWeek,o):o.day,n||o.year},tooltipFooterHeaderFormatter:function(t,e){var n=e?"footer":"header",s=t.series,a=s.tooltipOptions,l=a.xDateFormat,h=s.xAxis,c=h&&"datetime"===h.options.type&&r(t.key),d=a[n+"Format"];return c&&!l&&(l=this.getXDateFormat(t,a,h)),c&&l&&i(t.point&&t.point.tooltipDateKeys||["key"],function(t){d=d.replace("{point."+t+"}","{point."+t+":"+l+"}")}),o(d,{point:t,series:s})},bodyFormatter:function(t){return s(t,function(t){var e=t.series.tooltipOptions;return(e[(t.point.formatPrefix||"point")+"Formatter"]||t.point.tooltipFormatter).call(t.point,e[(t.point.formatPrefix||"point")+"Format"])})}}}(e),function(t){var e=t,i=e.addEvent,n=e.attr,o=e.charts,r=e.color,s=e.css,a=e.defined,l=e.each,h=e.extend,c=e.find,d=e.fireEvent,p=e.isObject,u=e.offset,g=e.pick,f=e.splat,m=e.Tooltip;t.Pointer=function(t,e){this.init(t,e)},t.Pointer.prototype={init:function(t,e){this.options=e,this.chart=t,this.runChartClick=e.chart.events&&!!e.chart.events.click,this.pinchDown=[],this.lastValidTouch={},m&&(t.tooltip=new m(t,e.tooltip),this.followTouchMove=g(e.tooltip.followTouchMove,!0)),this.setDOMEvents()},zoomOption:function(t){var e,i,n=this.chart,o=n.options.chart,r=o.zoomType||"",s=n.inverted;/touch/.test(t.type)&&(r=g(o.pinchType,r)),this.zoomX=e=/x/.test(r),this.zoomY=i=/y/.test(r),this.zoomHor=e&&!s||i&&s,this.zoomVert=i&&!s||e&&s,this.hasZoom=e||i},normalize:function(t,e){var i;return i=t.touches?t.touches.length?t.touches.item(0):t.changedTouches[0]:t,e||(this.chartPosition=e=u(this.chart.container)),h(t,{chartX:Math.round(i.pageX-e.left),chartY:Math.round(i.pageY-e.top)})},getCoordinates:function(t){var e={xAxis:[],yAxis:[]};return l(this.chart.axes,function(i){e[i.isXAxis?"xAxis":"yAxis"].push({axis:i,value:i.toValue(t[i.horiz?"chartX":"chartY"])})}),e},findNearestKDPoint:function(t,e,i){var n,o=function(t,i){var n,o=t.distX-i.distX,r=t.dist-i.dist,s=(i.series.group&&i.series.group.zIndex)-(t.series.group&&t.series.group.zIndex);return n=0!==o&&e?o:0!==r?r:0!==s?s:t.series.index>i.series.index?-1:1};return l(t,function(t){var r=t.noSharedTooltip&&e,s=!r&&t.options.findNearestPointBy.indexOf("y")<0,a=t.searchPoint(i,s);p(a,!0)&&(!p(n,!0)||o(n,a)>0)&&(n=a)}),n},getPointFromEvent:function(t){for(var e,i=t.target;i&&!e;)e=i.point,i=i.parentNode;return e},getChartCoordinatesFromPoint:function(t,e){var i=t.series,n=i.xAxis,o=i.yAxis,r=g(t.clientX,t.plotX);return n&&o?e?{chartX:n.len+n.pos-r,chartY:o.len+o.pos-t.plotY}:{chartX:r+n.pos,chartY:t.plotY+o.pos}:void 0},getHoverData:function(t,i,n,o,r,s,a){var h,d=[],u=i,f=a&&a.isBoosting,m=!(!o||!t),x=u&&!u.stickyTracking,v=function(t){return t.visible&&!(!r&&t.directTouch)&&g(t.options.enableMouseTracking,!0)},y=x?[u]:e.grep(n,function(t){return v(t)&&t.stickyTracking});return h=m?t:this.findNearestKDPoint(y,r,s),u=h&&h.series,h&&(r&&!u.noSharedTooltip?(y=e.grep(n,function(t){return v(t)&&!t.noSharedTooltip}),l(y,function(t){var e=c(t.points,function(t){return t.x===h.x&&!t.isNull});p(e)&&(f&&(e=t.getPoint(e)),d.push(e))})):d.push(h)),{hoverPoint:h,hoverSeries:u,hoverPoints:d}},runPointActions:function(t,n){var r,s,a,h,c=this,d=c.chart,p=d.series,u=d.tooltip&&d.tooltip.options.enabled?d.tooltip:void 0,f=u?u.shared:!1,m=n||d.hoverPoint,x=m&&m.series||d.hoverSeries,v=!!n||x&&x.directTouch&&c.isDirectTouch,y=this.getHoverData(m,x,p,v,f,t,{isBoosting:d.isBoosting});if(m=y.hoverPoint,h=y.hoverPoints,x=y.hoverSeries,s=x&&x.tooltipOptions.followPointer,r=f&&x&&!x.noSharedTooltip,m&&(m!==d.hoverPoint||u&&u.isHidden)){if(l(d.hoverPoints||[],function(t){-1===e.inArray(t,h)&&t.setState()}),l(h||[],function(t){t.setState("hover")}),d.hoverSeries!==x&&x.onMouseOver(),d.hoverPoint&&d.hoverPoint.firePointEvent("mouseOut"),!m.series)return;m.firePointEvent("mouseOver"),d.hoverPoints=h,d.hoverPoint=m,u&&u.refresh(r?h:m,t)}else s&&u&&!u.isHidden&&(a=u.getAnchor([{}],t),u.updatePosition({plotX:a[0],plotY:a[1]}));c.unDocMouseMove||(c.unDocMouseMove=i(d.container.ownerDocument,"mousemove",function(t){var i=o[e.hoverChartIndex];i&&i.pointer.onDocumentMouseMove(t)})),l(d.axes,function(i){var n=g(i.crosshair.snap,!0),o=n?e.find(h,function(t){return t.series[i.coll]===i}):void 0;o||!n?i.drawCrosshair(t,o):i.hideCrosshair()})},reset:function(t,e){var i=this,n=i.chart,o=n.hoverSeries,r=n.hoverPoint,s=n.hoverPoints,a=n.tooltip,h=a&&a.shared?s:r;t&&h&&l(f(h),function(e){e.series.isCartesian&&void 0===e.plotX&&(t=!1)}),t?a&&h&&(a.refresh(h),r&&(r.setState(r.state,!0),l(n.axes,function(t){t.crosshair&&t.drawCrosshair(null,r)}))):(r&&r.onMouseOut(),s&&l(s,function(t){t.setState()}),o&&o.onMouseOut(),a&&a.hide(e),i.unDocMouseMove&&(i.unDocMouseMove=i.unDocMouseMove()),l(n.axes,function(t){t.hideCrosshair()}),i.hoverX=n.hoverPoints=n.hoverPoint=null)},scaleGroups:function(t,e){var i,n=this.chart;l(n.series,function(o){i=t||o.getPlotBox(),o.xAxis&&o.xAxis.zoomEnabled&&o.group&&(o.group.attr(i),o.markerGroup&&(o.markerGroup.attr(i),o.markerGroup.clip(e?n.clipRect:null)),o.dataLabelsGroup&&o.dataLabelsGroup.attr(i))}),n.clipRect.attr(e||n.clipBox)},dragStart:function(t){var e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=this.mouseDownX=t.chartX,e.mouseDownY=this.mouseDownY=t.chartY},drag:function(t){var e,i,n=this.chart,o=n.options.chart,s=t.chartX,a=t.chartY,l=this.zoomHor,h=this.zoomVert,c=n.plotLeft,d=n.plotTop,p=n.plotWidth,u=n.plotHeight,g=this.selectionMarker,f=this.mouseDownX,m=this.mouseDownY,x=o.panKey&&t[o.panKey+"Key"];g&&g.touch||(c>s?s=c:s>c+p&&(s=c+p),d>a?a=d:a>d+u&&(a=d+u),this.hasDragged=Math.sqrt(Math.pow(f-s,2)+Math.pow(m-a,2)),this.hasDragged>10&&(e=n.isInsidePlot(f-c,m-d),n.hasCartesianSeries&&(this.zoomX||this.zoomY)&&e&&!x&&(g||(this.selectionMarker=g=n.renderer.rect(c,d,l?1:p,h?1:u,0).attr({fill:o.selectionMarkerFill||r("#335cad").setOpacity(.25).get(),class:"highcharts-selection-marker",zIndex:7}).add())),g&&l&&(i=s-f,g.attr({width:Math.abs(i),x:(i>0?0:i)+f})),g&&h&&(i=a-m,g.attr({height:Math.abs(i),y:(i>0?0:i)+m})),e&&!g&&o.panning&&n.pan(t,o.panning)))},drop:function(t){var e=this,i=this.chart,n=this.hasPinched;if(this.selectionMarker){var o,r={originalEvent:t,xAxis:[],yAxis:[]},c=this.selectionMarker,p=c.attr?c.attr("x"):c.x,u=c.attr?c.attr("y"):c.y,g=c.attr?c.attr("width"):c.width,f=c.attr?c.attr("height"):c.height;(this.hasDragged||n)&&(l(i.axes,function(i){if(i.zoomEnabled&&a(i.min)&&(n||e[{xAxis:"zoomX",yAxis:"zoomY"}[i.coll]])){var s=i.horiz,l="touchend"===t.type?i.minPixelPadding:0,h=i.toValue((s?p:u)+l),c=i.toValue((s?p+g:u+f)-l);r[i.coll].push({axis:i,min:Math.min(h,c),max:Math.max(h,c)}),o=!0}}),o&&d(i,"selection",r,function(t){i.zoom(h(t,n?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),n&&this.scaleGroups()}i&&(s(i.container,{cursor:i._cursor}),i.cancelClick=this.hasDragged>10,i.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(t){2!==t.button&&(t=this.normalize(t),this.zoomOption(t),t.preventDefault&&t.preventDefault(),this.dragStart(t))},onDocumentMouseUp:function(t){o[e.hoverChartIndex]&&o[e.hoverChartIndex].pointer.drop(t)},onDocumentMouseMove:function(t){var e=this.chart,i=this.chartPosition;t=this.normalize(t,i),!i||this.inClass(t.target,"highcharts-tracker")||e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)||this.reset()},onContainerMouseLeave:function(t){var i=o[e.hoverChartIndex];i&&(t.relatedTarget||t.toElement)&&(i.pointer.reset(),i.pointer.chartPosition=null)},onContainerMouseMove:function(t){var i=this.chart;a(e.hoverChartIndex)&&o[e.hoverChartIndex]&&o[e.hoverChartIndex].mouseIsDown||(e.hoverChartIndex=i.index),t=this.normalize(t),t.returnValue=!1,"mousedown"===i.mouseIsDown&&this.drag(t),!this.inClass(t.target,"highcharts-tracker")&&!i.isInsidePlot(t.chartX-i.plotLeft,t.chartY-i.plotTop)||i.openMenu||this.runPointActions(t)},inClass:function(t,e){for(var i;t;){if(i=n(t,"class")){if(-1!==i.indexOf(e))return!0;if(-1!==i.indexOf("highcharts-container"))return!1}t=t.parentNode}},onTrackerMouseOut:function(t){var e=this.chart.hoverSeries,i=t.relatedTarget||t.toElement;this.isDirectTouch=!1,!e||!i||e.stickyTracking||this.inClass(i,"highcharts-tooltip")||this.inClass(i,"highcharts-series-"+e.index)&&this.inClass(i,"highcharts-tracker")||e.onMouseOut()},onContainerClick:function(t){var e=this.chart,i=e.hoverPoint,n=e.plotLeft,o=e.plotTop;t=this.normalize(t),e.cancelClick||(i&&this.inClass(t.target,"highcharts-tracker")?(d(i.series,"click",h(t,{point:i})),e.hoverPoint&&i.firePointEvent("click",t)):(h(t,this.getCoordinates(t)),e.isInsidePlot(t.chartX-n,t.chartY-o)&&d(e,"click",t)))},setDOMEvents:function(){var t=this,n=t.chart.container,o=n.ownerDocument;n.onmousedown=function(e){t.onContainerMouseDown(e)},n.onmousemove=function(e){t.onContainerMouseMove(e)},n.onclick=function(e){t.onContainerClick(e)},this.unbindContainerMouseLeave=i(n,"mouseleave",t.onContainerMouseLeave),e.unbindDocumentMouseUp||(e.unbindDocumentMouseUp=i(o,"mouseup",t.onDocumentMouseUp)),e.hasTouch&&(n.ontouchstart=function(e){t.onContainerTouchStart(e)},n.ontouchmove=function(e){t.onContainerTouchMove(e)},e.unbindDocumentTouchEnd||(e.unbindDocumentTouchEnd=i(o,"touchend",t.onDocumentTouchEnd)))},destroy:function(){var t=this;t.unDocMouseMove&&t.unDocMouseMove(),this.unbindContainerMouseLeave(),e.chartCount||(e.unbindDocumentMouseUp&&(e.unbindDocumentMouseUp=e.unbindDocumentMouseUp()),e.unbindDocumentTouchEnd&&(e.unbindDocumentTouchEnd=e.unbindDocumentTouchEnd())),clearInterval(t.tooltipTimeout),e.objectEach(t,function(e,i){t[i]=null})}}}(e),function(t){var e=t.charts,i=t.each,n=t.extend,o=t.map,r=t.noop,s=t.pick,a=t.Pointer;n(a.prototype,{pinchTranslate:function(t,e,i,n,o,r){this.zoomHor&&this.pinchTranslateDirection(!0,t,e,i,n,o,r),this.zoomVert&&this.pinchTranslateDirection(!1,t,e,i,n,o,r)},pinchTranslateDirection:function(t,e,i,n,o,r,s,a){var l,h,c,d,p,u,g=this.chart,f=t?"x":"y",m=t?"X":"Y",x="chart"+m,v=t?"width":"height",y=g["plot"+(t?"Left":"Top")],b=a||1,k=g.inverted,M=g.bounds[t?"h":"v"],w=1===e.length,S=e[0][x],A=i[0][x],T=!w&&e[1][x],P=!w&&i[1][x],C=function(){!w&&Math.abs(S-T)>20&&(b=a||Math.abs(A-P)/Math.abs(S-T)),c=(y-A)/b+S,l=g["plot"+(t?"Width":"Height")]/b};C(),h=c,h<M.min?(h=M.min,d=!0):h+l>M.max&&(h=M.max-l,d=!0),d?(A-=.8*(A-s[f][0]),w||(P-=.8*(P-s[f][1])),C()):s[f]=[A,P],k||(r[f]=c-y,r[v]=l),u=k?t?"scaleY":"scaleX":"scale"+m,p=k?1/b:b,o[v]=l,o[f]=h,n[u]=b,n["translate"+m]=p*y+(A-p*S)},pinch:function(t){var e=this,a=e.chart,l=e.pinchDown,h=t.touches,c=h.length,d=e.lastValidTouch,p=e.hasZoom,u=e.selectionMarker,g={},f=1===c&&(e.inClass(t.target,"highcharts-tracker")&&a.runTrackerClick||e.runChartClick),m={};c>1&&(e.initiated=!0),p&&e.initiated&&!f&&t.preventDefault(),o(h,function(t){return e.normalize(t)}),"touchstart"===t.type?(i(h,function(t,e){l[e]={chartX:t.chartX,chartY:t.chartY}}),d.x=[l[0].chartX,l[1]&&l[1].chartX],d.y=[l[0].chartY,l[1]&&l[1].chartY],i(a.axes,function(t){if(t.zoomEnabled){var e=a.bounds[t.horiz?"h":"v"],i=t.minPixelPadding,n=t.toPixels(s(t.options.min,t.dataMin)),o=t.toPixels(s(t.options.max,t.dataMax)),r=Math.min(n,o),l=Math.max(n,o);e.min=Math.min(t.pos,r-i),e.max=Math.max(t.pos+t.len,l+i)}}),e.res=!0):e.followTouchMove&&1===c?this.runPointActions(e.normalize(t)):l.length&&(u||(e.selectionMarker=u=n({destroy:r,touch:!0},a.plotBox)),e.pinchTranslate(l,h,g,u,m,d),e.hasPinched=p,e.scaleGroups(g,m),e.res&&(e.res=!1,this.reset(!1,0)))},touch:function(e,i){var n,o,r,a=this.chart;a.index!==t.hoverChartIndex&&this.onContainerMouseLeave({relatedTarget:!0}),t.hoverChartIndex=a.index,1===e.touches.length?(e=this.normalize(e),r=a.isInsidePlot(e.chartX-a.plotLeft,e.chartY-a.plotTop),r&&!a.openMenu?(i&&this.runPointActions(e),"touchmove"===e.type&&(o=this.pinchDown,n=o[0]?Math.sqrt(Math.pow(o[0].chartX-e.chartX,2)+Math.pow(o[0].chartY-e.chartY,2))>=4:!1),s(n,!0)&&this.pinch(e)):i&&this.reset()):2===e.touches.length&&this.pinch(e)},onContainerTouchStart:function(t){this.zoomOption(t),this.touch(t,!0)},onContainerTouchMove:function(t){this.touch(t)},onDocumentTouchEnd:function(i){e[t.hoverChartIndex]&&e[t.hoverChartIndex].pointer.drop(i)}})}(e),function(t){var e=t.addEvent,i=t.charts,n=t.css,o=t.doc,r=t.extend,s=t.hasTouch,a=t.noop,l=t.Pointer,h=t.removeEvent,c=t.win,d=t.wrap;if(!s&&(c.PointerEvent||c.MSPointerEvent)){var p={},u=!!c.PointerEvent,g=function(){var e=[];return e.item=function(t){return this[t]},t.objectEach(p,function(t){e.push({pageX:t.pageX,pageY:t.pageY,target:t.target})}),e},f=function(e,n,o,r){var s;"touch"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH||!i[t.hoverChartIndex]||(r(e),s=i[t.hoverChartIndex].pointer,s[n]({type:o,target:e.currentTarget,preventDefault:a,touches:g()}))};r(l.prototype,{onContainerPointerDown:function(t){f(t,"onContainerTouchStart","touchstart",function(t){p[t.pointerId]={pageX:t.pageX,pageY:t.pageY,target:t.currentTarget}})},onContainerPointerMove:function(t){f(t,"onContainerTouchMove","touchmove",function(t){p[t.pointerId]={pageX:t.pageX,pageY:t.pageY},p[t.pointerId].target||(p[t.pointerId].target=t.currentTarget)})},onDocumentPointerUp:function(t){f(t,"onDocumentTouchEnd","touchend",function(t){delete p[t.pointerId]})},batchMSEvents:function(t){t(this.chart.container,u?"pointerdown":"MSPointerDown",this.onContainerPointerDown),t(this.chart.container,u?"pointermove":"MSPointerMove",this.onContainerPointerMove),t(o,u?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),d(l.prototype,"init",function(t,e,i){t.call(this,e,i),this.hasZoom&&n(e.container,{"-ms-touch-action":"none","touch-action":"none"})}),d(l.prototype,"setDOMEvents",function(t){t.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(e)}),d(l.prototype,"destroy",function(t){this.batchMSEvents(h),t.call(this)})}}(e),function(t){var e=t,i=e.addEvent,n=e.css,o=e.discardElement,r=e.defined,s=e.each,a=e.isFirefox,l=e.marginNames,h=e.merge,c=e.pick,d=e.setAnimation,p=e.stableSort,u=e.win,g=e.wrap;t.Legend=function(t,e){this.init(t,e)},t.Legend.prototype={init:function(t,e){this.chart=t,this.setOptions(e),e.enabled&&(this.render(),i(this.chart,"endResize",function(){this.legend.positionCheckboxes()}))},setOptions:function(t){var e=c(t.padding,8);this.options=t,this.itemStyle=t.itemStyle,this.itemHiddenStyle=h(this.itemStyle,t.itemHiddenStyle),this.itemMarginTop=t.itemMarginTop||0,this.padding=e,this.initialItemY=e-5,this.maxItemWidth=0,this.itemHeight=0,this.symbolWidth=c(t.symbolWidth,16),this.pages=[]},update:function(t,e){var i=this.chart;this.setOptions(h(!0,this.options,t)),this.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,c(e,!0)&&i.redraw()},colorizeItem:function(t,e){t.legendGroup[e?"removeClass":"addClass"]("highcharts-legend-item-hidden");var i=this,n=i.options,o=t.legendItem,r=t.legendLine,s=t.legendSymbol,a=i.itemHiddenStyle.color,l=e?n.itemStyle.color:a,h=e?t.color||a:a,c=t.options&&t.options.marker,d={fill:h};o&&o.css({fill:l,color:l}),r&&r.attr({stroke:h}),s&&(c&&s.isMarker&&(d=t.pointAttribs(),e||(d.stroke=d.fill=a)),s.attr(d))},positionItem:function(t){var e=this,i=e.options,n=i.symbolPadding,o=!i.rtl,r=t._legendItemPos,s=r[0],a=r[1],l=t.checkbox,h=t.legendGroup;h&&h.element&&h.translate(o?s:e.legendWidth-s-2*n-4,a),l&&(l.x=s,l.y=a)},destroyItem:function(t){var e=t.checkbox;s(["legendItem","legendLine","legendSymbol","legendGroup"],function(e){t[e]&&(t[e]=t[e].destroy())}),e&&o(t.checkbox)},destroy:function(){function t(t){this[t]&&(this[t]=this[t].destroy())}s(this.getAllItems(),function(e){s(["legendItem","legendGroup"],t,e)}),s(["clipRect","up","down","pager","nav","box","title","group"],t,this),this.display=null},positionCheckboxes:function(){var t,e=this.group&&this.group.alignAttr,i=this.clipHeight||this.legendHeight,o=this.titleHeight;e&&(t=e.translateY,s(this.allItems,function(r){var s,a=r.checkbox;a&&(s=t+o+a.y+(this.scrollOffset||0)+3,n(a,{left:e.translateX+r.checkboxOffset+a.x-20+"px",top:s+"px",display:s>t-6&&t+i-6>s?"":"none"}))},this))},renderTitle:function(){var t,e=this.options,i=this.padding,n=e.title,o=0;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,i-3,i-4,null,null,null,e.useHTML,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),t=this.title.getBBox(),o=t.height,this.offsetWidth=t.width,this.contentGroup.attr({translateY:o})),this.titleHeight=o},setText:function(t){var i=this.options;t.legendItem.attr({text:i.labelFormat?e.format(i.labelFormat,t):i.labelFormatter.call(t)})},renderItem:function(t){var e,i,n,o=this,r=o.chart,s=r.renderer,a=o.options,l="horizontal"===a.layout,d=o.symbolWidth,p=a.symbolPadding,u=o.itemStyle,g=o.itemHiddenStyle,f=o.padding,m=l?c(a.itemDistance,20):0,x=!a.rtl,v=a.width,y=a.itemMarginBottom||0,b=o.itemMarginTop,k=t.legendItem,M=!t.series,w=!M&&t.series.drawLegendSymbol?t.series:t,S=w.options,A=o.createCheckboxForItem&&S&&S.showCheckbox,T=d+p+m+(A?20:0),P=a.useHTML,C=12,L=t.options.className;k||(t.legendGroup=s.g("legend-item").addClass("highcharts-"+w.type+"-series highcharts-color-"+t.colorIndex+(L?" "+L:"")+(M?" highcharts-series-"+t.index:"")).attr({zIndex:1}).add(o.scrollGroup),t.legendItem=k=s.text("",x?d+p:-p,o.baseline||0,P).css(h(t.visible?u:g)).attr({align:x?"left":"right",zIndex:2}).add(t.legendGroup),o.baseline||(C=u.fontSize,o.fontMetrics=s.fontMetrics(C,k),o.baseline=o.fontMetrics.f+3+b,k.attr("y",o.baseline)),o.symbolHeight=a.symbolHeight||o.fontMetrics.f,w.drawLegendSymbol(o,t),o.setItemEvents&&o.setItemEvents(t,k,P),A&&o.createCheckboxForItem(t)),o.colorizeItem(t,t.visible),u.width||k.css({width:(a.itemWidth||a.width||r.spacingBox.width)-T}),o.setText(t),i=k.getBBox(),n=t.checkboxOffset=a.itemWidth||t.legendItemWidth||i.width+T,o.itemHeight=e=Math.round(t.legendItemHeight||i.height||o.symbolHeight),l&&o.itemX-f+n>(v||r.spacingBox.width-2*f-a.x)&&(o.itemX=f,o.itemY+=b+o.lastLineHeight+y,o.lastLineHeight=0),o.maxItemWidth=Math.max(o.maxItemWidth,n),o.lastItemY=b+o.itemY+y,o.lastLineHeight=Math.max(e,o.lastLineHeight),t._legendItemPos=[o.itemX,o.itemY],l?o.itemX+=n:(o.itemY+=b+e+y,o.lastLineHeight=e),o.offsetWidth=v||Math.max((l?o.itemX-f-(t.checkbox?0:m):n)+f,o.offsetWidth)},getAllItems:function(){var t=[];return s(this.chart.series,function(e){var i=e&&e.options;e&&c(i.showInLegend,r(i.linkedTo)?!1:void 0,!0)&&(t=t.concat(e.legendItems||("point"===i.legendType?e.data:e)))}),t},getAlignment:function(){var t=this.options;return t.floating?"":t.align.charAt(0)+t.verticalAlign.charAt(0)+t.layout.charAt(0)},adjustMargins:function(t,e){var i=this.chart,n=this.options,o=this.getAlignment();o&&s([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(s,a){s.test(o)&&!r(t[a])&&(i[l[a]]=Math.max(i[l[a]],i.legend[(a+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][a]*n[a%2?"x":"y"]+c(n.margin,12)+e[a]+(0===a?i.titleOffset+i.options.title.margin:0)))})},render:function(){var t,e,i,n,o,r=this,a=r.chart,l=a.renderer,c=r.group,d=r.box,u=r.options,g=r.padding;r.itemX=g,r.itemY=r.initialItemY,r.offsetWidth=0,r.lastItemY=0,c||(r.group=c=l.g("legend").attr({zIndex:7}).add(),r.contentGroup=l.g().attr({zIndex:1}).add(c),r.scrollGroup=l.g().add(r.contentGroup)),r.renderTitle(),t=r.getAllItems(),p(t,function(t,e){return(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)}),u.reversed&&t.reverse(),r.allItems=t,r.display=e=!!t.length,r.lastLineHeight=0,s(t,function(t){r.renderItem(t)}),i=(u.width||r.offsetWidth)+g,n=r.lastItemY+r.lastLineHeight+r.titleHeight,n=r.handleOverflow(n),n+=g,d||(r.box=d=l.rect().addClass("highcharts-legend-box").attr({r:u.borderRadius}).add(c),d.isNew=!0),d.attr({stroke:u.borderColor,"stroke-width":u.borderWidth||0,fill:u.backgroundColor||"none"}).shadow(u.shadow),i>0&&n>0&&(d[d.isNew?"attr":"animate"](d.crisp.call({},{x:0,y:0,width:i,height:n},d.strokeWidth())),d.isNew=!1),d[e?"show":"hide"](),r.legendWidth=i,r.legendHeight=n,s(t,function(t){r.positionItem(t)}),e&&(o=a.spacingBox,/(lth|ct|rth)/.test(r.getAlignment())&&(o=h(o,{y:o.y+a.titleOffset+a.options.title.margin})),c.align(h(u,{width:i,height:n}),!0,o)),a.isResizing||this.positionCheckboxes()},handleOverflow:function(t){var e,i,n=this,o=this.chart,r=o.renderer,a=this.options,l=a.y,h="top"===a.verticalAlign,d=this.padding,p=o.spacingBox.height+(h?-l:l)-d,u=a.maxHeight,g=this.clipRect,f=a.navigation,m=c(f.animation,!0),x=f.arrowSize||12,v=this.nav,y=this.pages,b=this.allItems,k=function(t){"number"==typeof t?g.attr({height:t}):g&&(n.clipRect=g.destroy(),n.contentGroup.clip()),n.contentGroup.div&&(n.contentGroup.div.style.clip=t?"rect("+d+"px,9999px,"+(d+t)+"px,0)":"auto")};return"horizontal"!==a.layout||"middle"===a.verticalAlign||a.floating||(p/=2),u&&(p=Math.min(p,u)),y.length=0,t>p&&f.enabled!==!1?(this.clipHeight=e=Math.max(p-20-this.titleHeight-d,0),this.currentPage=c(this.currentPage,1),this.fullHeight=t,s(b,function(t,n){var o=t._legendItemPos[1],r=Math.round(t.legendItem.getBBox().height),s=y.length;(!s||o-y[s-1]>e&&(i||o)!==y[s-1])&&(y.push(i||o),s++),t.pageIx=s-1,i&&(b[n-1].pageIx=s-1),n===b.length-1&&o+r-y[s-1]>e&&(y.push(o),t.pageIx=s),o!==i&&(i=o)}),g||(g=n.clipRect=r.clipRect(0,d,9999,0),n.contentGroup.clip(g)),k(e),v||(this.nav=v=r.g().attr({zIndex:1}).add(this.group),this.up=r.symbol("triangle",0,0,x,x).on("click",function(){n.scroll(-1,m)}).add(v),this.pager=r.text("",15,10).addClass("highcharts-legend-navigation").css(f.style).add(v),this.down=r.symbol("triangle-down",0,0,x,x).on("click",function(){n.scroll(1,m)}).add(v)),n.scroll(0),t=p):v&&(k(),this.nav=v.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t},scroll:function(t,e){var i=this.pages,n=i.length,o=this.currentPage+t,r=this.clipHeight,s=this.options.navigation,a=this.pager,l=this.padding;o>n&&(o=n),o>0&&(void 0!==e&&d(e,this.chart),this.nav.attr({translateX:l,translateY:r+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({class:1===o?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),a.attr({text:o+"/"+n}),this.down.attr({x:18+this.pager.getBBox().width,class:o===n?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),this.up.attr({fill:1===o?s.inactiveColor:s.activeColor}).css({cursor:1===o?"default":"pointer"}),this.down.attr({fill:o===n?s.inactiveColor:s.activeColor}).css({cursor:o===n?"default":"pointer"}),this.scrollOffset=-i[o-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=o,this.positionCheckboxes())}},e.LegendSymbolMixin={drawRectangle:function(t,e){var i=t.options,n=t.symbolHeight,o=i.squareSymbol,r=o?n:t.symbolWidth;e.legendSymbol=this.chart.renderer.rect(o?(t.symbolWidth-n)/2:0,t.baseline-n+1,r,n,c(t.options.symbolRadius,n/2)).addClass("highcharts-point").attr({zIndex:3}).add(e.legendGroup)},drawLineMarker:function(t){var e,i,n=this.options,o=n.marker,r=t.symbolWidth,s=t.symbolHeight,a=s/2,l=this.chart.renderer,d=this.legendGroup,p=t.baseline-Math.round(.3*t.fontMetrics.b),u={};u={"stroke-width":n.lineWidth||0},n.dashStyle&&(u.dashstyle=n.dashStyle),this.legendLine=l.path(["M",0,p,"L",r,p]).addClass("highcharts-graph").attr(u).add(d),o&&o.enabled!==!1&&(e=Math.min(c(o.radius,a),a),0===this.symbol.indexOf("url")&&(o=h(o,{width:s,height:s}),e=0),this.legendSymbol=i=l.symbol(this.symbol,r/2-e,p-e,2*e,2*e,o).addClass("highcharts-point").add(d),i.isMarker=!0)}},(/Trident\/7\.0/.test(u.navigator.userAgent)||a)&&g(t.Legend.prototype,"positionItem",function(t,e){var i=this,n=function(){e._legendItemPos&&t.call(i,e)};n(),setTimeout(n)})}(e),function(t){var e=t.addEvent,i=t.animate,n=t.animObject,o=t.attr,r=t.doc,s=t.Axis,a=t.createElement,l=t.defaultOptions,h=t.discardElement,c=t.charts,d=t.css,p=t.defined,u=t.each,g=t.extend,f=t.find,m=t.fireEvent,x=t.grep,v=t.isNumber,y=t.isObject,b=t.isString,k=t.Legend,M=t.marginNames,w=t.merge,S=t.objectEach,A=t.Pointer,T=t.pick,P=t.pInt,C=t.removeEvent,L=t.seriesTypes,O=t.splat,D=t.svg,I=t.syncTimeout,B=t.win,z=t.Chart=function(){this.getArgs.apply(this,arguments)};t.chart=function(t,e,i){return new z(t,e,i)},g(z.prototype,{callbacks:[],getArgs:function(){var t=[].slice.call(arguments);(b(t[0])||t[0].nodeName)&&(this.renderTo=t.shift()),this.init(t[0],t[1])},init:function(i,n){var o,r,s=i.series,a=i.plotOptions||{};i.series=null,o=w(l,i);for(r in o.plotOptions)o.plotOptions[r].tooltip=a[r]&&w(a[r].tooltip)||void 0;o.tooltip.userOptions=i.chart&&i.chart.forExport&&i.tooltip.userOptions||i.tooltip,o.series=i.series=s,this.userOptions=i;var h=o.chart,d=h.events;this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=n,this.isResizing=0,this.options=o,this.axes=[],this.series=[],this.hasCartesianSeries=h.showAxes;var p=this;p.index=c.length,c.push(p),t.chartCount++,d&&S(d,function(t,i){e(p,i,t)}),p.xAxis=[],p.yAxis=[],p.pointCount=p.colorCounter=p.symbolCounter=0,p.firstRender()},initSeries:function(e){var i,n=this,o=n.options.chart,r=e.type||o.type||o.defaultSeriesType,s=L[r];return s||t.error(17,!0),i=new s,i.init(this,e),i},orderSeries:function(t){for(var e=this.series,i=t||0;i<e.length;i++)e[i]&&(e[i].index=i,e[i].name=e[i].name||"Series "+(e[i].index+1))},isInsidePlot:function(t,e,i){var n=i?e:t,o=i?t:e;return n>=0&&n<=this.plotWidth&&o>=0&&o<=this.plotHeight},redraw:function(e){var i,n,o,r,s=this,a=s.axes,l=s.series,h=s.pointer,c=s.legend,d=s.isDirtyLegend,p=s.hasCartesianSeries,f=s.isDirtyBox,x=s.renderer,v=x.isHidden(),y=[];for(s.setResponsive&&s.setResponsive(!1),t.setAnimation(e,s),v&&s.temporaryDisplay(),s.layOutTitles(),o=l.length;o--;)if(r=l[o],r.options.stacking&&(i=!0,r.isDirty)){n=!0;break}if(n)for(o=l.length;o--;)r=l[o],r.options.stacking&&(r.isDirty=!0);u(l,function(t){t.isDirty&&"point"===t.options.legendType&&(t.updateTotals&&t.updateTotals(),d=!0),t.isDirtyData&&m(t,"updatedData")}),d&&c.options.enabled&&(c.render(),s.isDirtyLegend=!1),i&&s.getStacks(),p&&u(a,function(t){t.updateNames(),t.setScale()}),s.getMargins(),p&&(u(a,function(t){t.isDirty&&(f=!0)}),u(a,function(t){var e=t.min+","+t.max;t.extKey!==e&&(t.extKey=e,y.push(function(){m(t,"afterSetExtremes",g(t.eventArgs,t.getExtremes())),delete t.eventArgs})),(f||i)&&t.redraw()})),f&&s.drawChartBox(),m(s,"predraw"),u(l,function(t){(f||t.isDirty)&&t.visible&&t.redraw(),t.isDirtyData=!1}),h&&h.reset(!0),x.draw(),m(s,"redraw"),m(s,"render"),v&&s.temporaryDisplay(!0),u(y,function(t){t.call()})},get:function(t){function e(e){return e.id===t||e.options&&e.options.id===t}var i,n,o=this.series;for(i=f(this.axes,e)||f(this.series,e),n=0;!i&&n<o.length;n++)i=f(o[n].points||[],e);return i},getAxes:function(){var t,e=this,i=this.options,n=i.xAxis=O(i.xAxis||{}),o=i.yAxis=O(i.yAxis||{});u(n,function(t,e){t.index=e,t.isX=!0}),u(o,function(t,e){t.index=e}),t=n.concat(o),u(t,function(t){new s(e,t)})},getSelectedPoints:function(){var t=[];return u(this.series,function(e){t=t.concat(x(e.data||[],function(t){return t.selected}))}),t},getSelectedSeries:function(){return x(this.series,function(t){return t.selected})},setTitle:function(t,e,i){var n,o,r=this,s=r.options;n=s.title=w({style:{color:"#333333",fontSize:s.isStock?"16px":"18px"}},s.title,t),o=s.subtitle=w({style:{color:"#666666"}},s.subtitle,e),u([["title",t,n],["subtitle",e,o]],function(t,e){var i=t[0],n=r[i],o=t[1],s=t[2];n&&o&&(r[i]=n=n.destroy()),s&&!n&&(r[i]=r.renderer.text(s.text,0,0,s.useHTML).attr({align:s.align,class:"highcharts-"+i,zIndex:s.zIndex||4}).add(),r[i].update=function(t){r.setTitle(!e&&t,e&&t)},r[i].css(s.style))}),r.layOutTitles(i)},layOutTitles:function(t){var e,i=0,n=this.renderer,o=this.spacingBox;u(["title","subtitle"],function(t){var e,r=this[t],s=this.options[t],a="title"===t?-3:s.verticalAlign?0:i+2;r&&(e=s.style.fontSize,e=n.fontMetrics(e,r).b,r.css({width:(s.width||o.width+s.widthAdjust)+"px"}).align(g({y:a+e},s),!1,"spacingBox"),s.floating||s.verticalAlign||(i=Math.ceil(i+r.getBBox(s.useHTML).height)))},this),e=this.titleOffset!==i,this.titleOffset=i,!this.isDirtyBox&&e&&(this.isDirtyBox=e,this.hasRendered&&T(t,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var e=this,i=e.options.chart,n=i.width,o=i.height,r=e.renderTo;p(n)||(e.containerWidth=t.getStyle(r,"width")),p(o)||(e.containerHeight=t.getStyle(r,"height")),e.chartWidth=Math.max(0,n||e.containerWidth||600),e.chartHeight=Math.max(0,t.relativeLength(o,e.chartWidth)||(e.containerHeight>1?e.containerHeight:400))},temporaryDisplay:function(e){var i,n=this.renderTo;if(e)for(;n&&n.style;)n.hcOrigStyle&&(t.css(n,n.hcOrigStyle),delete n.hcOrigStyle),n.hcOrigDetached&&(r.body.removeChild(n),n.hcOrigDetached=!1),n=n.parentNode;else for(;n&&n.style&&(r.body.contains(n)||n.parentNode||(n.hcOrigDetached=!0,r.body.appendChild(n)),("none"===t.getStyle(n,"display",!1)||n.hcOricDetached)&&(n.hcOrigStyle={display:n.style.display,height:n.style.height,overflow:n.style.overflow},i={display:"block",overflow:"hidden"},n!==this.renderTo&&(i.height=0),t.css(n,i),n.offsetWidth||n.style.setProperty("display","block","important")),n=n.parentNode,n!==r.body););},setClassName:function(t){this.container.className="highcharts-container "+(t||"")},getContainer:function(){var e,i,n,s,l,h,d=this,p=d.options,u=p.chart,f=d.renderTo,m="data-highcharts-chart",x=t.uniqueKey();f||(d.renderTo=f=u.renderTo),b(f)&&(d.renderTo=f=r.getElementById(f)),f||t.error(13,!0),s=P(o(f,m)),v(s)&&c[s]&&c[s].hasRendered&&c[s].destroy(),o(f,m,d.index),f.innerHTML="",u.skipClone||f.offsetWidth||d.temporaryDisplay(),d.getChartSize(),i=d.chartWidth,n=d.chartHeight,h=g({position:"relative",overflow:"hidden",width:i+"px",height:n+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},u.style),e=a("div",{id:x},h,f),d.container=e,d._cursor=e.style.cursor,l=t[u.renderer]||t.Renderer,d.renderer=new l(e,i,n,null,u.forExport,p.exporting&&p.exporting.allowHTML),d.setClassName(u.className),d.renderer.setStyle(u.style),d.renderer.chartIndex=d.index},getMargins:function(t){var e=this,i=e.spacing,n=e.margin,o=e.titleOffset;e.resetMargins(),o&&!p(n[0])&&(e.plotTop=Math.max(e.plotTop,o+e.options.title.margin+i[0])),e.legend&&e.legend.display&&e.legend.adjustMargins(n,i),e.extraMargin&&(e[e.extraMargin.type]=(e[e.extraMargin.type]||0)+e.extraMargin.value),e.adjustPlotArea&&e.adjustPlotArea(),t||this.getAxisMargins()},getAxisMargins:function(){var t=this,e=t.axisOffset=[0,0,0,0],i=t.margin;t.hasCartesianSeries&&u(t.axes,function(t){t.visible&&t.getOffset()}),u(M,function(n,o){p(i[o])||(t[n]+=e[o])}),t.setChartSize()},reflow:function(e){var i=this,n=i.options.chart,o=i.renderTo,s=p(n.width)&&p(n.height),a=n.width||t.getStyle(o,"width"),l=n.height||t.getStyle(o,"height"),h=e?e.target:B;s||i.isPrinting||!a||!l||h!==B&&h!==r||((a!==i.containerWidth||l!==i.containerHeight)&&(clearTimeout(i.reflowTimeout),i.reflowTimeout=I(function(){i.container&&i.setSize(void 0,void 0,!1)},e?100:0)),i.containerWidth=a,i.containerHeight=l)},initReflow:function(){var t,i=this;t=e(B,"resize",function(t){i.reflow(t)}),e(i,"destroy",t)},setSize:function(e,o,r){var s,a=this,l=a.renderer;a.isResizing+=1,t.setAnimation(r,a),a.oldChartHeight=a.chartHeight,a.oldChartWidth=a.chartWidth,void 0!==e&&(a.options.chart.width=e),void 0!==o&&(a.options.chart.height=o),a.getChartSize(),s=l.globalAnimation,(s?i:d)(a.container,{width:a.chartWidth+"px",height:a.chartHeight+"px"},s),a.setChartSize(!0),l.setSize(a.chartWidth,a.chartHeight,r),u(a.axes,function(t){t.isDirty=!0,t.setScale()}),a.isDirtyLegend=!0,a.isDirtyBox=!0,a.layOutTitles(),a.getMargins(),a.redraw(r),a.oldChartHeight=null,m(a,"resize"),I(function(){a&&m(a,"endResize",null,function(){a.isResizing-=1})},n(s).duration)},setChartSize:function(t){var e,i,n,o,r,s,a,l=this,h=l.inverted,c=l.renderer,d=l.chartWidth,p=l.chartHeight,g=l.options.chart,f=l.spacing,m=l.clipOffset;l.plotLeft=n=Math.round(l.plotLeft),l.plotTop=o=Math.round(l.plotTop),l.plotWidth=r=Math.max(0,Math.round(d-n-l.marginRight)),l.plotHeight=s=Math.max(0,Math.round(p-o-l.marginBottom)),l.plotSizeX=h?s:r,l.plotSizeY=h?r:s,l.plotBorderWidth=g.plotBorderWidth||0,l.spacingBox=c.spacingBox={x:f[3],y:f[0],width:d-f[3]-f[1],height:p-f[0]-f[2]},l.plotBox=c.plotBox={x:n,y:o,width:r,height:s},a=2*Math.floor(l.plotBorderWidth/2),e=Math.ceil(Math.max(a,m[3])/2),i=Math.ceil(Math.max(a,m[0])/2),l.clipBox={x:e,y:i,width:Math.floor(l.plotSizeX-Math.max(a,m[1])/2-e),height:Math.max(0,Math.floor(l.plotSizeY-Math.max(a,m[2])/2-i))},t||u(l.axes,function(t){t.setAxisSize(),t.setAxisTranslation()})},resetMargins:function(){var t=this,e=t.options.chart;u(["margin","spacing"],function(i){var n=e[i],o=y(n)?n:[n,n,n,n];u(["Top","Right","Bottom","Left"],function(n,r){t[i][r]=T(e[i+n],o[r])})}),u(M,function(e,i){t[e]=T(t.margin[i],t.spacing[i])}),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]},drawChartBox:function(){var t,e,i,n=this,o=n.options.chart,r=n.renderer,s=n.chartWidth,a=n.chartHeight,l=n.chartBackground,h=n.plotBackground,c=n.plotBorder,d=n.plotBGImage,p=o.backgroundColor,u=o.plotBackgroundColor,g=o.plotBackgroundImage,f=n.plotLeft,m=n.plotTop,x=n.plotWidth,v=n.plotHeight,y=n.plotBox,b=n.clipRect,k=n.clipBox,M="animate";l||(n.chartBackground=l=r.rect().addClass("highcharts-background").add(),M="attr"),t=o.borderWidth||0,e=t+(o.shadow?8:0),i={fill:p||"none"},(t||l["stroke-width"])&&(i.stroke=o.borderColor,i["stroke-width"]=t),l.attr(i).shadow(o.shadow),l[M]({x:e/2,y:e/2,width:s-e-t%2,height:a-e-t%2,r:o.borderRadius}),M="animate",h||(M="attr",n.plotBackground=h=r.rect().addClass("highcharts-plot-background").add()),h[M](y),h.attr({fill:u||"none"}).shadow(o.plotShadow),g&&(d?d.animate(y):n.plotBGImage=r.image(g,f,m,x,v).add()),b?b.animate({width:k.width,height:k.height}):n.clipRect=r.clipRect(k),M="animate",c||(M="attr",n.plotBorder=c=r.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),c.attr({stroke:o.plotBorderColor,"stroke-width":o.plotBorderWidth||0,fill:"none"}),c[M](c.crisp({x:f,y:m,width:x,height:v},-c.strokeWidth())),n.isDirtyBox=!1},propFromSeries:function(){var t,e,i,n=this,o=n.options.chart,r=n.options.series;u(["inverted","angular","polar"],function(s){for(t=L[o.type||o.defaultSeriesType],i=o[s]||t&&t.prototype[s],e=r&&r.length;!i&&e--;)t=L[r[e].type],t&&t.prototype[s]&&(i=!0);n[s]=i})},linkSeries:function(){var t=this,e=t.series;u(e,function(t){t.linkedSeries.length=0}),u(e,function(e){var i=e.options.linkedTo;b(i)&&(i=":previous"===i?t.series[e.index-1]:t.get(i),i&&i.linkedParent!==e&&(i.linkedSeries.push(e),e.linkedParent=i,e.visible=T(e.options.visible,i.options.visible,e.visible)))})},renderSeries:function(){u(this.series,function(t){t.translate(),t.render()})},renderLabels:function(){var t=this,e=t.options.labels;e.items&&u(e.items,function(i){var n=g(e.style,i.style),o=P(n.left)+t.plotLeft,r=P(n.top)+t.plotTop+12;delete n.left,delete n.top,t.renderer.text(i.html,o,r).attr({zIndex:2}).css(n).add()})},render:function(){var t,e,i,n,o=this,r=o.axes,s=o.renderer,a=o.options;o.setTitle(),o.legend=new k(o,a.legend),o.getStacks&&o.getStacks(),o.getMargins(!0),o.setChartSize(),t=o.plotWidth,e=o.plotHeight=Math.max(o.plotHeight-21,0),u(r,function(t){t.setScale()}),o.getAxisMargins(),i=t/o.plotWidth>1.1,n=e/o.plotHeight>1.05,(i||n)&&(u(r,function(t){(t.horiz&&i||!t.horiz&&n)&&t.setTickInterval(!0)}),o.getMargins()),o.drawChartBox(),o.hasCartesianSeries&&u(r,function(t){t.visible&&t.render()}),o.seriesGroup||(o.seriesGroup=s.g("series-group").attr({zIndex:3}).add()),o.renderSeries(),o.renderLabels(),o.addCredits(),o.setResponsive&&o.setResponsive(),o.hasRendered=!0},addCredits:function(t){var e=this;t=w(!0,this.options.credits,t),t.enabled&&!this.credits&&(this.credits=this.renderer.text(t.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){t.href&&(B.location.href=t.href)}).attr({align:t.position.align,zIndex:8}).css(t.style).add().align(t.position),this.credits.update=function(t){e.credits=e.credits.destroy(),e.addCredits(t)})},destroy:function(){var e,i=this,n=i.axes,o=i.series,r=i.container,s=r&&r.parentNode;for(m(i,"destroy"),i.renderer.forExport?t.erase(c,i):c[i.index]=void 0,t.chartCount--,i.renderTo.removeAttribute("data-highcharts-chart"),C(i),e=n.length;e--;)n[e]=n[e].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),e=o.length;e--;)o[e]=o[e].destroy();u(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(t){var e=i[t];e&&e.destroy&&(i[t]=e.destroy())}),r&&(r.innerHTML="",C(r),s&&h(r)),S(i,function(t,e){delete i[e]})},isReadyToRender:function(){var t=this;return D||B!=B.top||"complete"===r.readyState?!0:(r.attachEvent("onreadystatechange",function(){r.detachEvent("onreadystatechange",t.firstRender),"complete"===r.readyState&&t.firstRender()}),!1)},firstRender:function(){var t=this,e=t.options;t.isReadyToRender()&&(t.getContainer(),m(t,"init"),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes(),u(e.series||[],function(e){t.initSeries(e)}),t.linkSeries(),m(t,"beforeRender"),A&&(t.pointer=new A(t,e)),t.render(),!t.renderer.imgCount&&t.onload&&t.onload(),t.temporaryDisplay(!0))},onload:function(){u([this.callback].concat(this.callbacks),function(t){t&&void 0!==this.index&&t.apply(this,[this])},this),m(this,"load"),m(this,"render"),p(this.index)&&this.options.chart.reflow!==!1&&this.initReflow(),this.onload=null}})}(e),function(t){var e,i=t,n=i.each,o=i.extend,r=i.erase,s=i.fireEvent,a=i.format,l=i.isArray,h=i.isNumber,c=i.pick,d=i.removeEvent;t.Point=e=function(){},t.Point.prototype={init:function(t,e,i){var n,o,r=this,s=t.chart.options.chart.colorCount;return r.series=t,r.color=t.color,r.applyOptions(e,i),t.options.colorByPoint?(n=t.options.colors||t.chart.options.colors,r.color=r.color||n[t.colorCounter],s=n.length,o=t.colorCounter,t.colorCounter++,t.colorCounter===s&&(t.colorCounter=0)):o=t.colorIndex,r.colorIndex=c(r.colorIndex,o),t.chart.pointCount++,r},applyOptions:function(t,i){var n=this,r=n.series,s=r.options.pointValKey||r.pointValKey;return t=e.prototype.optionsToObject.call(this,t),o(n,t),n.options=n.options?o(n.options,t):t,t.group&&delete n.group,s&&(n.y=n[s]),n.isNull=c(n.isValid&&!n.isValid(),null===n.x||!h(n.y,!0)),n.selected&&(n.state="select"),"name"in n&&void 0===i&&r.xAxis&&r.xAxis.hasNames&&(n.x=r.xAxis.nameToX(n)),void 0===n.x&&r&&(n.x=void 0===i?r.autoIncrement(n):i),n},optionsToObject:function(t){var e,i={},n=this.series,o=n.options.keys,r=o||n.pointArrayMap||["y"],s=r.length,a=0,c=0;if(h(t)||null===t)i[r[0]]=t;else if(l(t))for(!o&&t.length>s&&(e=typeof t[0],"string"===e?i.name=t[0]:"number"===e&&(i.x=t[0]),a++);s>c;)o&&void 0===t[a]||(i[r[c]]=t[a]),a++,c++;else"object"==typeof t&&(i=t,t.dataLabels&&(n._hasPointLabels=!0),t.marker&&(n._hasPointMarkers=!0));return i},getClassName:function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},getZone:function(){var t,e=this.series,i=e.zones,n=e.zoneAxis||"y",o=0;for(t=i[o];this[n]>=t.value;)t=i[++o];return t&&t.color&&!this.options.color&&(this.color=t.color),t},destroy:function(){var t,e=this,i=e.series,n=i.chart,o=n.hoverPoints;n.pointCount--,o&&(e.setState(),r(o,e),o.length||(n.hoverPoints=null)),e===n.hoverPoint&&e.onMouseOut(),(e.graphic||e.dataLabel)&&(d(e),e.destroyElements()),e.legendItem&&n.legend.destroyItem(e);for(t in e)e[t]=null},destroyElements:function(){for(var t,e=this,i=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],n=6;n--;)t=i[n],e[t]&&(e[t]=e[t].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(t){var e=this.series,i=e.tooltipOptions,o=c(i.valueDecimals,""),r=i.valuePrefix||"",s=i.valueSuffix||"";return n(e.pointArrayMap||["y"],function(e){e="{point."+e,(r||s)&&(t=t.replace(e+"}",r+e+"}"+s)),t=t.replace(e+"}",e+":,."+o+"f}")}),a(t,{point:this,series:this.series})},firePointEvent:function(t,e,i){var n=this,o=this.series,r=o.options;(r.point.events[t]||n.options&&n.options.events&&n.options.events[t])&&this.importEvents(),"click"===t&&r.allowPointSelect&&(i=function(t){n.select&&n.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),s(this,t,e,i)},visible:!0}}(e),function(t){var e=t.addEvent,i=t.animObject,n=t.arrayMax,o=t.arrayMin,r=t.correctFloat,s=t.Date,a=t.defaultOptions,l=t.defaultPlotOptions,h=t.defined,c=t.each,d=t.erase,p=t.extend,u=t.fireEvent,g=t.grep,f=t.isArray,m=t.isNumber,x=t.isString,v=t.LegendSymbolMixin,y=t.merge,b=t.objectEach,k=t.pick,M=t.Point,w=t.removeEvent,S=t.splat,A=t.SVGElement,T=t.syncTimeout,P=t.win;t.Series=t.seriesType("line",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{lineWidth:0,lineColor:"#ffffff",radius:4,states:{hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return null===this.y?"":t.numberFormat(this.y,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},{isCartesian:!0,pointClass:M,sorted:!0,requireSorting:!0,directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],coll:"series",init:function(t,i){var n,o,r=this,s=t.series;r.chart=t,r.options=i=r.setOptions(i),r.linkedSeries=[],r.bindAxes(),p(r,{name:i.name,state:"",visible:i.visible!==!1,selected:i.selected===!0}),n=i.events,b(n,function(t,i){e(r,i,t)}),(n&&n.click||i.point&&i.point.events&&i.point.events.click||i.allowPointSelect)&&(t.runTrackerClick=!0),r.getColor(),r.getSymbol(),c(r.parallelArrays,function(t){r[t+"Data"]=[]}),r.setData(i.data,!1),r.isCartesian&&(t.hasCartesianSeries=!0),s.length&&(o=s[s.length-1]),r._i=k(o&&o._i,-1)+1,t.orderSeries(this.insert(s))},insert:function(t){var e,i=this.options.index;if(m(i)){for(e=t.length;e--;)if(i>=k(t[e].options.index,t[e]._i)){t.splice(e+1,0,this);break}-1===e&&t.unshift(this),e+=1}else t.push(this);return k(e,t.length-1)},bindAxes:function(){var e,i=this,n=i.options,o=i.chart;c(i.axisTypes||[],function(r){c(o[r],function(t){e=t.options,(n[r]===e.index||void 0!==n[r]&&n[r]===e.id||void 0===n[r]&&0===e.index)&&(i.insert(t.series),i[r]=t,t.isDirty=!0)}),i[r]||i.optionalAxis===r||t.error(18,!0)})},updateParallelArrays:function(t,e){var i=t.series,n=arguments,o=m(e)?function(n){var o="y"===n&&i.toYData?i.toYData(t):t[n];i[n+"Data"][e]=o}:function(t){Array.prototype[e].apply(i[t+"Data"],Array.prototype.slice.call(n,2))};c(i.parallelArrays,o)},autoIncrement:function(){var e,i,n=this.options,o=this.xIncrement,r=n.pointIntervalUnit,a=0;return o=k(o,n.pointStart,0),this.pointInterval=i=k(this.pointInterval,n.pointInterval,1),r&&(e=new s(o),"day"===r?e=+e[s.hcSetDate](e[s.hcGetDate]()+i):"month"===r?e=+e[s.hcSetMonth](e[s.hcGetMonth]()+i):"year"===r&&(e=+e[s.hcSetFullYear](e[s.hcGetFullYear]()+i)),s.hcHasTimeZone&&(a=t.getTZOffset(e)-t.getTZOffset(o)),i=e-o+a),this.xIncrement=o+i,o},setOptions:function(t){var e,i,n=this.chart,o=n.options,r=o.plotOptions,s=n.userOptions||{},l=s.plotOptions||{},c=r[this.type];return this.userOptions=t,e=y(c,r.series,t),this.tooltipOptions=y(a.tooltip,a.plotOptions.series&&a.plotOptions.series.tooltip,a.plotOptions[this.type].tooltip,o.tooltip.userOptions,r.series&&r.series.tooltip,r[this.type].tooltip,t.tooltip),this.stickyTracking=k(t.stickyTracking,l[this.type]&&l[this.type].stickyTracking,l.series&&l.series.stickyTracking,this.tooltipOptions.shared&&!this.noSharedTooltip?!0:e.stickyTracking),null===c.marker&&delete e.marker,this.zoneAxis=e.zoneAxis,i=this.zones=(e.zones||[]).slice(),!e.negativeColor&&!e.negativeFillColor||e.zones||i.push({value:e[this.zoneAxis+"Threshold"]||e.threshold||0,className:"highcharts-negative",color:e.negativeColor,fillColor:e.negativeFillColor}),i.length&&h(i[i.length-1].value)&&i.push({color:this.color,fillColor:this.fillColor}),e},getCyclic:function(t,e,i){var n,o,r=this.chart,s=this.userOptions,a=t+"Index",l=t+"Counter",c=i?i.length:k(r.options.chart[t+"Count"],r[t+"Count"]);e||(o=k(s[a],s["_"+a]),h(o)?n=o:(r.series.length||(r[l]=0),s["_"+a]=n=r[l]%c,r[l]+=1),i&&(e=i[n])),void 0!==n&&(this[a]=n),this[t]=e},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||l[this.type].color,this.chart.options.colors)},getSymbol:function(){var t=this.options.marker;this.getCyclic("symbol",t.symbol,this.chart.options.symbols)},drawLegendSymbol:v.drawLineMarker,setData:function(e,i,n,o){var r,s,a,l=this,h=l.points,d=h&&h.length||0,p=l.options,u=l.chart,g=null,v=l.xAxis,y=p.turboThreshold,b=this.xData,M=this.yData,w=l.pointArrayMap,S=w&&w.length;if(e=e||[],r=e.length,i=k(i,!0),o!==!1&&r&&d===r&&!l.cropped&&!l.hasGroupedData&&l.visible)c(e,function(t,e){h[e].update&&t!==p.data[e]&&h[e].update(t,!1,null,!1)});else{if(l.xIncrement=null,l.colorCounter=0,c(this.parallelArrays,function(t){l[t+"Data"].length=0}),y&&r>y){for(s=0;null===g&&r>s;)g=e[s],s++;if(m(g))for(s=0;r>s;s++)b[s]=this.autoIncrement(),M[s]=e[s];else if(f(g))if(S)for(s=0;r>s;s++)a=e[s],b[s]=a[0],M[s]=a.slice(1,S+1);else for(s=0;r>s;s++)a=e[s],b[s]=a[0],M[s]=a[1];else t.error(12)}else for(s=0;r>s;s++)void 0!==e[s]&&(a={series:l},l.pointClass.prototype.applyOptions.apply(a,[e[s]]),l.updateParallelArrays(a,s));for(M&&x(M[0])&&t.error(14,!0),l.data=[],l.options.data=l.userOptions.data=e,s=d;s--;)h[s]&&h[s].destroy&&h[s].destroy();v&&(v.minRange=v.userMinRange),l.isDirty=u.isDirtyBox=!0,l.isDirtyData=!!h,n=!1}"point"===p.legendType&&(this.processData(),this.generatePoints()),i&&u.redraw(n)},processData:function(e){var i,n,o,r,s,a,l,h,c=this,d=c.xData,p=c.yData,u=d.length,g=0,f=c.xAxis,m=c.options,x=m.cropThreshold,v=c.getExtremesFromAll||m.getExtremesFromAll,y=c.isCartesian,b=f&&f.val2lin,k=f&&f.isLog,M=c.requireSorting;if(y&&!c.isDirty&&!f.isDirty&&!c.yAxis.isDirty&&!e)return!1;for(f&&(a=f.getExtremes(),l=a.min,h=a.max),y&&c.sorted&&!v&&(!x||u>x||c.forceCrop)&&(d[u-1]<l||d[0]>h?(d=[],p=[]):(d[0]<l||d[u-1]>h)&&(i=this.cropData(c.xData,c.yData,l,h),d=i.xData,p=i.yData,g=i.start,n=!0)),s=d.length||1;--s;)o=k?b(d[s])-b(d[s-1]):d[s]-d[s-1],o>0&&(void 0===r||r>o)?r=o:0>o&&M&&(t.error(15),M=!1);c.cropped=n,c.cropStart=g,c.processedXData=d,c.processedYData=p,c.closestPointRange=r},cropData:function(t,e,i,n){var o,r,s=t.length,a=0,l=s,h=k(this.cropShoulder,1);for(o=0;s>o;o++)if(t[o]>=i){a=Math.max(0,o-h);break}for(r=o;s>r;r++)if(t[r]>n){l=r+h;break}return{xData:t.slice(a,l),yData:e.slice(a,l),start:a,end:l}},generatePoints:function(){var t,e,i,n,o=this,r=o.options,s=r.data,a=o.data,l=o.processedXData,h=o.processedYData,c=o.pointClass,d=l.length,p=o.cropStart||0,u=o.hasGroupedData,g=r.keys,f=[];if(!a&&!u){var m=[];m.length=s.length,a=o.data=m}for(g&&u&&(o.options.keys=!1),n=0;d>n;n++)e=p+n,u?(i=(new c).init(o,[l[n]].concat(S(h[n]))),i.dataGroup=o.groupMap[n]):(i=a[e],i||void 0===s[e]||(a[e]=i=(new c).init(o,s[e],l[n]))),i&&(i.index=e,f[n]=i);if(o.options.keys=g,a&&(d!==(t=a.length)||u))for(n=0;t>n;n++)n!==p||u||(n+=d),a[n]&&(a[n].destroyElements(),a[n].plotX=void 0);o.data=a,o.points=f},getExtremes:function(t){var e,i,r,s,a,l,h,c=this.xAxis,d=this.yAxis,p=this.processedXData,u=[],g=0,x=c.getExtremes(),v=x.min,y=x.max;for(t=t||this.stackedYData||this.processedYData||[],e=t.length,l=0;e>l;l++)if(s=p[l],a=t[l],i=(m(a,!0)||f(a))&&(!d.positiveValuesOnly||a.length||a>0),r=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(p[l+1]||s)>=v&&(p[l-1]||s)<=y,i&&r)if(h=a.length)for(;h--;)"number"==typeof a[h]&&(u[g++]=a[h]);else u[g++]=a;this.dataMin=o(u),this.dataMax=n(u)},translate:function(){this.processedXData||this.processData(),this.generatePoints();var t,e,i,n,o,s=this,a=s.options,l=a.stacking,c=s.xAxis,d=c.categories,p=s.yAxis,u=s.points,g=u.length,f=!!s.modifyValue,x=a.pointPlacement,v="between"===x||m(x),y=a.threshold,b=a.startFromThreshold?y:0,M=Number.MAX_VALUE;for("between"===x&&(x=.5),m(x)&&(x*=k(a.pointRange||c.pointRange)),t=0;g>t;t++){var w,S,A=u[t],T=A.x,P=A.y,C=A.low,L=l&&p.stacks[(s.negStacks&&(b?0:y)>P?"-":"")+s.stackKey];p.positiveValuesOnly&&null!==P&&0>=P&&(A.isNull=!0),A.plotX=e=r(Math.min(Math.max(-1e5,c.translate(T,0,0,0,1,x,"flags"===this.type)),1e5)),l&&s.visible&&!A.isNull&&L&&L[T]&&(o=s.getStackIndicator(o,T,s.index),w=L[T],S=w.points[o.key],C=S[0],P=S[1],C===b&&o.key===L[T].base&&(C=k(y,p.min)),p.positiveValuesOnly&&0>=C&&(C=null),A.total=A.stackTotal=w.total,A.percentage=w.total&&A.y/w.total*100,A.stackY=P,w.setOffset(s.pointXOffset||0,s.barW||0)),A.yBottom=h(C)?p.translate(C,0,1,0,1):null,f&&(P=s.modifyValue(P,A)),A.plotY=i="number"==typeof P&&1/0!==P?Math.min(Math.max(-1e5,p.translate(P,0,1,0,1)),1e5):void 0,A.isInside=void 0!==i&&i>=0&&i<=p.len&&e>=0&&e<=c.len,A.clientX=v?r(c.translate(T,0,0,0,1,x)):e,A.negative=A.y<(y||0),A.category=d&&void 0!==d[A.x]?d[A.x]:A.x,A.isNull||(void 0!==n&&(M=Math.min(M,Math.abs(e-n))),n=e),A.zone=this.zones.length&&A.getZone()}s.closestPointRangePx=M},getValidPoints:function(t,e){var i=this.chart;return g(t||this.points||[],function(t){return e&&!i.isInsidePlot(t.plotX,t.plotY,i.inverted)?!1:!t.isNull})},setClip:function(t){var e=this.chart,i=this.options,n=e.renderer,o=e.inverted,r=this.clipBox,s=r||e.clipBox,a=this.sharedClipKey||["_sharedClip",t&&t.duration,t&&t.easing,s.height,i.xAxis,i.yAxis].join(","),l=e[a],h=e[a+"m"];l||(t&&(s.width=0,o&&(s.x=e.plotSizeX),e[a+"m"]=h=n.clipRect(o?e.plotSizeX+99:-99,o?-e.plotLeft:-e.plotTop,99,o?e.chartWidth:e.chartHeight)),e[a]=l=n.clipRect(s),l.count={length:0}),t&&(l.count[this.index]||(l.count[this.index]=!0,l.count.length+=1)),i.clip!==!1&&(this.group.clip(t||r?l:e.clipRect),this.markerGroup.clip(h),this.sharedClipKey=a),t||(l.count[this.index]&&(delete l.count[this.index],l.count.length-=1),0===l.count.length&&a&&e[a]&&(r||(e[a]=e[a].destroy()),e[a+"m"]&&(e[a+"m"]=e[a+"m"].destroy())))},animate:function(t){var e,n,o=this,r=o.chart,s=i(o.options.animation);t?o.setClip(s):(n=this.sharedClipKey,e=r[n],e&&e.animate({width:r.plotSizeX,x:0},s),r[n+"m"]&&r[n+"m"].animate({width:r.plotSizeX+99,x:0},s),o.animate=null)},afterAnimate:function(){this.setClip(),u(this,"afterAnimate"),this.finishedAnimating=!0},drawPoints:function(){var t,e,i,n,o,r,s,a,l,h=this,c=h.points,d=h.chart,p=h.options,u=p.marker,g=h[h.specialGroup]||h.markerGroup,f=h.xAxis,m=k(u.enabled,f.isRadial?!0:null,h.closestPointRangePx>=2*u.radius);if(u.enabled!==!1||h._hasPointMarkers)for(t=0;t<c.length;t++)e=c[t],n=e.graphic,o=e.marker||{},r=!!e.marker,s=m&&void 0===o.enabled||o.enabled,a=e.isInside,s&&!e.isNull?(i=k(o.symbol,h.symbol),e.hasImage=0===i.indexOf("url"),l=h.markerAttribs(e,e.selected&&"select"),n?n[a?"show":"hide"](!0).animate(l):a&&(l.width>0||e.hasImage)&&(e.graphic=n=d.renderer.symbol(i,l.x,l.y,l.width,l.height,r?o:u).add(g)),n&&n.attr(h.pointAttribs(e,e.selected&&"select")),n&&n.addClass(e.getClassName(),!0)):n&&(e.graphic=n.destroy())},markerAttribs:function(t,e){var i,n,o,r=this.options.marker,s=t.marker||{},a=k(s.radius,r.radius);return e&&(i=r.states[e],n=s.states&&s.states[e],a=k(n&&n.radius,i&&i.radius,a+(i&&i.radiusPlus||0))),t.hasImage&&(a=0),o={x:Math.floor(t.plotX)-a,y:t.plotY-a},a&&(o.width=o.height=2*a),o},pointAttribs:function(t,e){var i,n,o,r,s=this.options.marker,a=t&&t.options,l=a&&a.marker||{},h=this.color,c=a&&a.color,d=t&&t.color,p=k(l.lineWidth,s.lineWidth),u=t&&t.zone&&t.zone.color;return h=c||u||d||h,o=l.fillColor||s.fillColor||h,r=l.lineColor||s.lineColor||h,e&&(i=s.states[e],n=l.states&&l.states[e]||{},p=k(n.lineWidth,i.lineWidth,p+k(n.lineWidthPlus,i.lineWidthPlus,0)),o=n.fillColor||i.fillColor||o,r=n.lineColor||i.lineColor||r),{stroke:r,"stroke-width":p,fill:o}},destroy:function(){var t,e,i,n,o=this,r=o.chart,s=/AppleWebKit\/533/.test(P.navigator.userAgent),a=o.data||[];for(u(o,"destroy"),w(o),c(o.axisTypes||[],function(t){n=o[t],n&&n.series&&(d(n.series,o),n.isDirty=n.forceRedraw=!0)}),o.legendItem&&o.chart.legend.destroyItem(o),e=a.length;e--;)i=a[e],i&&i.destroy&&i.destroy();o.points=null,clearTimeout(o.animationTimeout),b(o,function(e,i){e instanceof A&&!e.survive&&(t=s&&"group"===i?"hide":"destroy",e[t]())}),r.hoverSeries===o&&(r.hoverSeries=null),d(r.series,o),r.orderSeries(),b(o,function(t,e){delete o[e]})},getGraphPath:function(t,e,i){var n,o,r=this,s=r.options,a=s.step,l=[],d=[];return t=t||r.points,n=t.reversed,n&&t.reverse(),a={right:1,center:2}[a]||a&&3,a&&n&&(a=4-a),!s.connectNulls||e||i||(t=this.getValidPoints(t)),c(t,function(n,c){var p,u=n.plotX,g=n.plotY,f=t[c-1];(n.leftCliff||f&&f.rightCliff)&&!i&&(o=!0),n.isNull&&!h(e)&&c>0?o=!s.connectNulls:n.isNull&&!e?o=!0:(0===c||o?p=["M",n.plotX,n.plotY]:r.getPointSpline?p=r.getPointSpline(t,n,c):a?(p=1===a?["L",f.plotX,g]:2===a?["L",(f.plotX+u)/2,f.plotY,"L",(f.plotX+u)/2,g]:["L",u,f.plotY],p.push("L",u,g)):p=["L",u,g],d.push(n.x),a&&d.push(n.x),l.push.apply(l,p),o=!1)}),l.xMap=d,r.graphPath=l,l},drawGraph:function(){var t=this,e=this.options,i=(this.gappedPath||this.getGraphPath).call(this),n=[["graph","highcharts-graph",e.lineColor||this.color,e.dashStyle]];c(this.zones,function(i,o){n.push(["zone-graph-"+o,"highcharts-graph highcharts-zone-graph-"+o+" "+(i.className||""),i.color||t.color,i.dashStyle||e.dashStyle])}),c(n,function(n,o){var r,s=n[0],a=t[s];a?(a.endX=t.preventGraphAnimation?null:i.xMap,a.animate({d:i})):i.length&&(t[s]=t.chart.renderer.path(i).addClass(n[1]).attr({zIndex:1}).add(t.group),r={stroke:n[2],"stroke-width":e.lineWidth,fill:t.fillGraph&&t.color||"none"},n[3]?r.dashstyle=n[3]:"square"!==e.linecap&&(r["stroke-linecap"]=r["stroke-linejoin"]="round"),a=t[s].attr(r).shadow(2>o&&e.shadow)),a&&(a.startX=i.xMap,a.isArea=i.isArea)})},applyZones:function(){var t,e,i,n,o,r,s,a,l,h=this,d=this.chart,p=d.renderer,u=this.zones,g=this.clips||[],f=this.graph,m=this.area,x=Math.max(d.chartWidth,d.chartHeight),v=this[(this.zoneAxis||"y")+"Axis"],y=d.inverted,b=!1;u.length&&(f||m)&&v&&void 0!==v.min&&(o=v.reversed,r=v.horiz,f&&f.hide(),m&&m.hide(),n=v.getExtremes(),c(u,function(c,u){t=o?r?d.plotWidth:0:r?0:v.toPixels(n.min),t=Math.min(Math.max(k(e,t),0),x),e=Math.min(Math.max(Math.round(v.toPixels(k(c.value,n.max),!0)),0),x),b&&(t=e=v.toPixels(n.max)),s=Math.abs(t-e),a=Math.min(t,e),l=Math.max(t,e),v.isXAxis?(i={x:y?l:a,y:0,width:s,height:x},r||(i.x=d.plotHeight-i.x)):(i={x:0,y:y?l:a,width:x,height:s},r&&(i.y=d.plotWidth-i.y)),y&&p.isVML&&(i=v.isXAxis?{x:0,y:o?a:l,height:i.width,width:d.chartWidth}:{x:i.y-d.plotLeft-d.spacingBox.x,y:0,width:i.height,height:d.chartHeight}),g[u]?g[u].animate(i):(g[u]=p.clipRect(i),f&&h["zone-graph-"+u].clip(g[u]),m&&h["zone-area-"+u].clip(g[u])),b=c.value>n.max}),this.clips=g)},invertGroups:function(t){function i(){c(["group","markerGroup"],function(e){o[e]&&(r.renderer.isVML&&o[e].attr({width:o.yAxis.len,height:o.xAxis.len}),o[e].width=o.yAxis.len,o[e].height=o.xAxis.len,o[e].invert(t))})}var n,o=this,r=o.chart;o.xAxis&&(n=e(r,"resize",i),e(o,"destroy",n),i(t),o.invertGroups=i)},plotGroup:function(t,e,i,n,o){var r=this[t],s=!r;return s&&(this[t]=r=this.chart.renderer.g().attr({zIndex:n||.1}).add(o)),r.addClass("highcharts-"+e+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(h(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(r.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),r.attr({visibility:i})[s?"attr":"animate"](this.getPlotBox()),r},getPlotBox:function(){var t=this.chart,e=this.xAxis,i=this.yAxis;return t.inverted&&(e=i,i=this.xAxis),{translateX:e?e.left:t.plotLeft,translateY:i?i.top:t.plotTop,scaleX:1,scaleY:1}},render:function(){var t,e=this,n=e.chart,o=e.options,r=!!e.animate&&n.renderer.isSVG&&i(o.animation).duration,s=e.visible?"inherit":"hidden",a=o.zIndex,l=e.hasRendered,h=n.seriesGroup,c=n.inverted;t=e.plotGroup("group","series",s,a,h),e.markerGroup=e.plotGroup("markerGroup","markers",s,a,h),r&&e.animate(!0),t.inverted=e.isCartesian?c:!1,e.drawGraph&&(e.drawGraph(),e.applyZones()),e.drawDataLabels&&e.drawDataLabels(),e.visible&&e.drawPoints(),e.drawTracker&&e.options.enableMouseTracking!==!1&&e.drawTracker(),e.invertGroups(c),o.clip===!1||e.sharedClipKey||l||t.clip(n.clipRect),r&&e.animate(),l||(e.animationTimeout=T(function(){e.afterAnimate()},r)),e.isDirty=!1,e.hasRendered=!0},redraw:function(){var t=this,e=t.chart,i=t.isDirty||t.isDirtyData,n=t.group,o=t.xAxis,r=t.yAxis;n&&(e.inverted&&n.attr({width:e.plotWidth,height:e.plotHeight}),n.animate({translateX:k(o&&o.left,e.plotLeft),translateY:k(r&&r.top,e.plotTop)})),t.translate(),t.render(),i&&delete this.kdTree},kdAxisArray:["clientX","plotY"],searchPoint:function(t,e){var i=this,n=i.xAxis,o=i.yAxis,r=i.chart.inverted;return this.searchKDTree({clientX:r?n.len-t.chartY+n.pos:t.chartX-n.pos,plotY:r?o.len-t.chartX+o.pos:t.chartY-o.pos},e)},buildKDTree:function(){function t(e,n,o){var r,s,a=e&&e.length;return a?(r=i.kdAxisArray[n%o],e.sort(function(t,e){return t[r]-e[r]}),s=Math.floor(a/2),{point:e[s],left:t(e.slice(0,s),n+1,o),right:t(e.slice(s+1),n+1,o)}):void 0}function e(){i.kdTree=t(i.getValidPoints(null,!i.directTouch),n,n),i.buildingKdTree=!1}this.buildingKdTree=!0;var i=this,n=i.options.findNearestPointBy.indexOf("y")>-1?2:1;delete i.kdTree,T(e,i.options.kdNow?0:1)},searchKDTree:function(t,e){function i(t,e){var i=h(t[r])&&h(e[r])?Math.pow(t[r]-e[r],2):null,n=h(t[s])&&h(e[s])?Math.pow(t[s]-e[s],2):null,o=(i||0)+(n||0);e.dist=h(o)?Math.sqrt(o):Number.MAX_VALUE,e.distX=h(i)?Math.sqrt(i):Number.MAX_VALUE}function n(t,e,r,s){var l,h,c,d,p,u=e.point,g=o.kdAxisArray[r%s],f=u;return i(t,u),l=t[g]-u[g],h=0>l?"left":"right",c=0>l?"right":"left",e[h]&&(d=n(t,e[h],r+1,s),f=d[a]<f[a]?d:u),e[c]&&Math.sqrt(l*l)<f[a]&&(p=n(t,e[c],r+1,s),f=p[a]<f[a]?p:f),f}var o=this,r=this.kdAxisArray[0],s=this.kdAxisArray[1],a=e?"distX":"dist",l=o.options.findNearestPointBy.indexOf("y")>-1?2:1;return this.kdTree||this.buildingKdTree||this.buildKDTree(),this.kdTree?n(t,this.kdTree,l,l):void 0}})}(e),function(t){var e=t.Axis,i=t.Chart,n=t.correctFloat,o=t.defined,r=t.destroyObjectProperties,s=t.each,a=t.format,l=t.objectEach,h=t.pick,c=t.Series;t.StackItem=function(t,e,i,n,o){var r=t.chart.inverted;this.axis=t,this.isNegative=i,this.options=e,this.x=n,this.total=null,this.points={},this.stack=o,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:e.align||(r?i?"left":"right":"center"),verticalAlign:e.verticalAlign||(r?"middle":i?"bottom":"top"),y:h(e.y,r?4:i?14:-6),x:h(e.x,r?i?-6:6:0)},this.textAlign=e.textAlign||(r?i?"right":"left":"center")},t.StackItem.prototype={destroy:function(){r(this,this.axis)},render:function(t){var e=this.options,i=e.format,n=i?a(i,this):e.formatter.call(this);this.label?this.label.attr({text:n,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(n,null,null,e.useHTML).css(e.style).attr({align:this.textAlign,rotation:e.rotation,visibility:"hidden"}).add(t)},setOffset:function(t,e){var i,n=this,o=n.axis,r=o.chart,s=o.translate(o.usePercentage?100:n.total,0,0,0,1),a=o.translate(0),l=Math.abs(s-a),h=r.xAxis[0].translate(n.x)+t,c=n.getStackBox(r,n,h,s,e,l),d=n.label;d&&(d.align(n.alignOptions,null,c),i=d.alignAttr,d[n.options.crop===!1||r.isInsidePlot(i.x,i.y)?"show":"hide"](!0))},getStackBox:function(t,e,i,n,o,r){var s=e.axis.reversed,a=t.inverted,l=t.plotHeight,h=e.isNegative&&!s||!e.isNegative&&s;return{x:a?h?n:n-r:i,y:a?l-i-o:h?l-n-r:l-n,width:a?r:o,height:a?o:r}}},i.prototype.getStacks=function(){var t=this;s(t.yAxis,function(t){t.stacks&&t.hasVisibleSeries&&(t.oldStacks=t.stacks)}),s(t.series,function(e){!e.options.stacking||e.visible!==!0&&t.options.chart.ignoreHiddenSeries!==!1||(e.stackKey=e.type+h(e.options.stack,""))})},e.prototype.buildStacks=function(){var t,e=this.series,i=h(this.options.reversedStacks,!0),n=e.length;if(!this.isXAxis){for(this.usePercentage=!1,t=n;t--;)e[i?t:n-t-1].setStackedPoints();for(t=0;n>t;t++)e[t].modifyStacks()}},e.prototype.renderStackTotals=function(){var t=this,e=t.chart,i=e.renderer,n=t.stacks,o=t.stackTotalGroup;o||(t.stackTotalGroup=o=i.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),o.translate(e.plotLeft,e.plotTop),l(n,function(t){l(t,function(t){t.render(o)})})},e.prototype.resetStacks=function(){var t=this,e=t.stacks;t.isXAxis||l(e,function(e){l(e,function(i,n){i.touched<t.stacksTouched?(i.destroy(),delete e[n]):(i.total=null,i.cumulative=null)})})},e.prototype.cleanStacks=function(){var t;this.isXAxis||(this.oldStacks&&(t=this.stacks=this.oldStacks),l(t,function(t){l(t,function(t){t.cumulative=t.total})}))},c.prototype.setStackedPoints=function(){if(this.options.stacking&&(this.visible===!0||this.chart.options.chart.ignoreHiddenSeries===!1)){var e,i,r,s,a,l,c,d,p,u=this,g=u.processedXData,f=u.processedYData,m=[],x=f.length,v=u.options,y=v.threshold,b=h(v.startFromThreshold&&y,0),k=v.stack,M=v.stacking,w=u.stackKey,S="-"+w,A=u.negStacks,T=u.yAxis,P=T.stacks,C=T.oldStacks;for(T.stacksTouched+=1,c=0;x>c;c++)d=g[c],p=f[c],e=u.getStackIndicator(e,d,u.index),l=e.key,i=A&&(b?0:y)>p,a=i?S:w,P[a]||(P[a]={}),P[a][d]||(C[a]&&C[a][d]?(P[a][d]=C[a][d],P[a][d].total=null):P[a][d]=new t.StackItem(T,T.options.stackLabels,i,d,k)),r=P[a][d],null!==p?(r.points[l]=r.points[u.index]=[h(r.cumulative,b)],o(r.cumulative)||(r.base=l),r.touched=T.stacksTouched,e.index>0&&u.singleStacks===!1&&(r.points[l][0]=r.points[u.index+","+d+",0"][0])):r.points[l]=r.points[u.index]=null,"percent"===M?(s=i?w:S,A&&P[s]&&P[s][d]?(s=P[s][d],r.total=s.total=Math.max(s.total,r.total)+Math.abs(p)||0):r.total=n(r.total+(Math.abs(p)||0))):r.total=n(r.total+(p||0)),r.cumulative=h(r.cumulative,b)+(p||0),null!==p&&(r.points[l].push(r.cumulative),m[c]=r.cumulative);"percent"===M&&(T.usePercentage=!0),this.stackedYData=m,T.oldStacks={}}},c.prototype.modifyStacks=function(){var t,e=this,i=e.stackKey,n=e.yAxis.stacks,o=e.processedXData,r=e.options.stacking;e[r+"Stacker"]&&s([i,"-"+i],function(i){for(var s,a,l,h=o.length;h--;)s=o[h],t=e.getStackIndicator(t,s,e.index,i),a=n[i]&&n[i][s],l=a&&a.points[t.key],l&&e[r+"Stacker"](l,a,h)})},c.prototype.percentStacker=function(t,e,i){var o=e.total?100/e.total:0;t[0]=n(t[0]*o),t[1]=n(t[1]*o),this.stackedYData[i]=t[1]},c.prototype.getStackIndicator=function(t,e,i,n){return!o(t)||t.x!==e||n&&t.key!==n?t={x:e,index:0,key:n}:t.index++,t.key=[i,e,t.index].join(","),t}}(e),function(t){var e=t.addEvent,i=t.animate,n=t.Axis,o=t.Chart,r=t.createElement,s=t.css,a=t.defined,l=t.each,h=t.erase,c=t.extend,d=t.fireEvent,p=t.inArray,u=t.isNumber,g=t.isObject,f=t.isArray,m=t.merge,x=t.objectEach,v=t.pick,y=t.Point,b=t.Series,k=t.seriesTypes,M=t.setAnimation,w=t.splat;c(o.prototype,{addSeries:function(t,e,i){var n,o=this;return t&&(e=v(e,!0),d(o,"addSeries",{options:t},function(){n=o.initSeries(t),o.isDirtyLegend=!0,o.linkSeries(),e&&o.redraw(i)})),n},addAxis:function(t,e,i,o){var r,s=e?"xAxis":"yAxis",a=this.options,l=m(t,{index:this[s].length,isX:e});return r=new n(this,l),a[s]=w(a[s]||{}),a[s].push(l),v(i,!0)&&this.redraw(o),r},showLoading:function(t){var n=this,o=n.options,a=n.loadingDiv,l=o.loading,h=function(){a&&s(a,{left:n.plotLeft+"px",top:n.plotTop+"px",width:n.plotWidth+"px",height:n.plotHeight+"px"})};a||(n.loadingDiv=a=r("div",{className:"highcharts-loading highcharts-loading-hidden"},null,n.container),n.loadingSpan=r("span",{className:"highcharts-loading-inner"},null,a),e(n,"redraw",h)),a.className="highcharts-loading",n.loadingSpan.innerHTML=t||o.lang.loading,s(a,c(l.style,{zIndex:10})),s(n.loadingSpan,l.labelStyle),n.loadingShown||(s(a,{opacity:0,display:""}),i(a,{opacity:l.style.opacity||.5},{duration:l.showDuration||0})),n.loadingShown=!0,h()},hideLoading:function(){var t=this.options,e=this.loadingDiv;e&&(e.className="highcharts-loading highcharts-loading-hidden",i(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){s(e,{display:"none"})}})),this.loadingShown=!1},propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","tooltip"],update:function(t,e,i){var n,o,r,s,h=this,c={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle"},d=t.chart,g=[];d&&(m(!0,h.options.chart,d),"className"in d&&h.setClassName(d.className),("inverted"in d||"polar"in d)&&(h.propFromSeries(),n=!0),"alignTicks"in d&&(n=!0),x(d,function(t,e){-1!==p("chart."+e,h.propsRequireUpdateSeries)&&(o=!0),-1!==p(e,h.propsRequireDirtyBox)&&(h.isDirtyBox=!0)}),"style"in d&&h.renderer.setStyle(d.style)),t.colors&&(this.options.colors=t.colors),t.plotOptions&&m(!0,this.options.plotOptions,t.plotOptions),x(t,function(t,e){h[e]&&"function"==typeof h[e].update?h[e].update(t,!1):"function"==typeof h[c[e]]&&h[c[e]](t),"chart"!==e&&-1!==p(e,h.propsRequireUpdateSeries)&&(o=!0)}),l(["xAxis","yAxis","zAxis","series","colorAxis","pane"],function(e){t[e]&&(l(w(t[e]),function(t,n){var o=a(t.id)&&h.get(t.id)||h[e][n];o&&o.coll===e&&(o.update(t,!1),i&&(o.touched=!0)),!o&&i&&("series"===e?h.addSeries(t,!1).touched=!0:("xAxis"===e||"yAxis"===e)&&(h.addAxis(t,"xAxis"===e,!1).touched=!0))}),i&&l(h[e],function(t){t.touched?delete t.touched:g.push(t)}))}),l(g,function(t){t.remove(!1)}),n&&l(h.axes,function(t){t.update({},!1)}),o&&l(h.series,function(t){t.update({},!1)}),t.loading&&m(!0,h.options.loading,t.loading),r=d&&d.width,s=d&&d.height,u(r)&&r!==h.chartWidth||u(s)&&s!==h.chartHeight?h.setSize(r,s):v(e,!0)&&h.redraw()},setSubtitle:function(t){this.setTitle(void 0,t)}}),c(y.prototype,{update:function(t,e,i,n){function o(){s.applyOptions(t),null===s.y&&l&&(s.graphic=l.destroy()),g(t,!0)&&(l&&l.element&&t&&t.marker&&void 0!==t.marker.symbol&&(s.graphic=l.destroy()),t&&t.dataLabels&&s.dataLabel&&(s.dataLabel=s.dataLabel.destroy()),s.connector&&(s.connector=s.connector.destroy())),r=s.index,a.updateParallelArrays(s,r),c.data[r]=g(c.data[r],!0)||g(t,!0)?s.options:t,a.isDirty=a.isDirtyData=!0,!a.fixedBox&&a.hasCartesianSeries&&(h.isDirtyBox=!0),"point"===c.legendType&&(h.isDirtyLegend=!0),e&&h.redraw(i)}var r,s=this,a=s.series,l=s.graphic,h=a.chart,c=a.options;e=v(e,!0),n===!1?o():s.firePointEvent("update",{options:t},o)},remove:function(t,e){this.series.removePoint(p(this,this.series.data),t,e)}}),c(b.prototype,{addPoint:function(t,e,i,n){var o,r,s,a,l=this,h=l.options,c=l.data,d=l.chart,p=l.xAxis,u=p&&p.hasNames&&p.names,g=h.data,f=l.xData;if(e=v(e,!0),o={series:l},l.pointClass.prototype.applyOptions.apply(o,[t]),a=o.x,s=f.length,l.requireSorting&&a<f[s-1])for(r=!0;s&&f[s-1]>a;)s--;l.updateParallelArrays(o,"splice",s,0,0),l.updateParallelArrays(o,s),u&&o.name&&(u[a]=o.name),g.splice(s,0,t),r&&(l.data.splice(s,0,null),l.processData()),"point"===h.legendType&&l.generatePoints(),i&&(c[0]&&c[0].remove?c[0].remove(!1):(c.shift(),l.updateParallelArrays(o,"shift"),g.shift())),l.isDirty=!0,l.isDirtyData=!0,e&&d.redraw(n)},removePoint:function(t,e,i){var n=this,o=n.data,r=o[t],s=n.points,a=n.chart,l=function(){s&&s.length===o.length&&s.splice(t,1),o.splice(t,1),n.options.data.splice(t,1),n.updateParallelArrays(r||{series:n},"splice",t,1),r&&r.destroy(),n.isDirty=!0,n.isDirtyData=!0,e&&a.redraw()};M(i,a),e=v(e,!0),r?r.firePointEvent("remove",null,l):l()},remove:function(t,e,i){function n(){o.destroy(),r.isDirtyLegend=r.isDirtyBox=!0,r.linkSeries(),v(t,!0)&&r.redraw(e)}var o=this,r=o.chart;i!==!1?d(o,"remove",null,n):n()},update:function(t,e){var i,n=this,o=n.chart,r=n.userOptions,s=n.oldType||n.type,a=t.type||r.type||o.options.chart.type,h=k[s].prototype,d=["group","markerGroup","dataLabelsGroup"],p=["navigatorSeries","baseSeries"],u=n.finishedAnimating&&{animation:!1};if(Object.keys&&"data"===Object.keys(t).toString())return this.setData(t.data,e);p=d.concat(p),l(p,function(t){p[t]=n[t],delete n[t]}),t=m(r,u,{index:n.index,pointStart:n.xData[0]},{data:n.options.data},t),n.remove(!1,null,!1);for(i in h)n[i]=void 0;c(n,k[a||s].prototype),l(p,function(t){n[t]=p[t]}),n.init(o,t),t.zIndex!==r.zIndex&&l(d,function(e){n[e]&&n[e].attr({zIndex:t.zIndex})}),n.oldType=s,o.linkSeries(),v(e,!0)&&o.redraw(!1)}}),c(n.prototype,{update:function(t,e){var i=this.chart;t=i.options[this.coll][this.options.index]=m(this.userOptions,t),this.destroy(!0),this.init(i,c(t,{events:void 0})),i.isDirtyBox=!0,v(e,!0)&&i.redraw()},remove:function(t){for(var e=this.chart,i=this.coll,n=this.series,o=n.length;o--;)n[o]&&n[o].remove(!1);h(e.axes,this),h(e[i],this),f(e.options[i])?e.options[i].splice(this.options.index,1):delete e.options[i],l(e[i],function(t,e){t.options.index=e}),this.destroy(),e.isDirtyBox=!0,v(t,!0)&&e.redraw()},setTitle:function(t,e){this.update({title:t},e)},setCategories:function(t,e){this.update({categories:t},e)}})}(e),function(t){var e=t.color,i=t.each,n=t.LegendSymbolMixin,o=t.map,r=t.pick,s=t.Series,a=t.seriesType;a("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(e){var n,s,a=this,l=[],h=[],c=this.xAxis,d=this.yAxis,p=d.stacks[this.stackKey],u={},g=a.index,f=d.series,m=f.length,x=r(d.options.reversedStacks,!0)?1:-1;if(e=e||this.points,this.options.stacking){for(s=0;s<e.length;s++)e[s].leftNull=e[s].rightNull=null,u[e[s].x]=e[s];t.objectEach(p,function(t,e){null!==t.total&&h.push(e)}),h.sort(function(t,e){return t-e}),n=o(f,function(){return this.visible}),i(h,function(t,e){var o,r,a=0;if(u[t]&&!u[t].isNull)l.push(u[t]),i([-1,1],function(i){var a=1===i?"rightNull":"leftNull",l=1===i?"rightCliff":"leftCliff",c=0,d=p[h[e+i]];if(d)for(s=g;s>=0&&m>s;)o=d.points[s],o||(s===g?u[t][a]=!0:n[s]&&(r=p[t].points[s],r&&(c-=r[1]-r[0]))),s+=x;u[t][l]=c});else{for(s=g;s>=0&&m>s;){if(o=p[t].points[s]){a=o[1];break}s+=x}a=d.translate(a,0,1,0,1),l.push({isNull:!0,plotX:c.translate(t,0,0,0,1),x:t,plotY:a,yBottom:a})}})}return l},getGraphPath:function(t){var e,i,n,o,a,l,h,c,d=s.prototype.getGraphPath,p=this.options,u=p.stacking,g=this.yAxis,f=[],m=[],x=this.index,v=g.stacks[this.stackKey],y=p.threshold,b=g.getThreshold(p.threshold),k=p.connectNulls||"percent"===u,M=function(e,i,n){var o,r,s=t[e],a=u&&v[s.x].points[x],h=s[n+"Null"]||0,c=s[n+"Cliff"]||0,d=!0;c||h?(o=(h?a[0]:a[1])+c,r=a[0]+c,d=!!h):!u&&t[i]&&t[i].isNull&&(o=r=y),void 0!==o&&(m.push({plotX:l,plotY:null===o?b:g.getThreshold(o),isNull:d,isCliff:!0}),f.push({plotX:l,plotY:null===r?b:g.getThreshold(r),doCurve:!1}))};for(t=t||this.points,u&&(t=this.getStackPoints(t)),o=0;o<t.length;o++)h=t[o].isNull,l=r(t[o].rectPlotX,t[o].plotX),c=r(t[o].yBottom,b),(!h||k)&&(k||M(o,o-1,"left"),h&&!u&&k||(m.push(t[o]),f.push({x:o,plotX:l,plotY:c})),k||M(o,o+1,"right"));return i=d.call(this,m,!0,!0),f.reversed=!0,n=d.call(this,f,!0,!0),n.length&&(n[0]="L"),a=i.concat(n),e=d.call(this,m,!1,k),a.xMap=i.xMap,this.areaPath=a,e},drawGraph:function(){this.areaPath=[],s.prototype.drawGraph.apply(this);var t=this,n=this.areaPath,o=this.options,a=this.zones,l=[["area","highcharts-area",this.color,o.fillColor]];i(a,function(e,i){l.push(["zone-area-"+i,"highcharts-area highcharts-zone-area-"+i+" "+e.className,e.color||t.color,e.fillColor||o.fillColor])}),i(l,function(i){var s=i[0],a=t[s];a?(a.endX=t.preventGraphAnimation?null:n.xMap,a.animate({d:n})):(a=t[s]=t.chart.renderer.path(n).addClass(i[1]).attr({fill:r(i[3],e(i[2]).setOpacity(r(o.fillOpacity,.75)).get()),zIndex:0}).add(t.group),a.isArea=!0),a.startX=n.xMap,a.shiftUnit=o.step?2:1})},drawLegendSymbol:n.drawRectangle})}(e),function(t){var e=t.pick,i=t.seriesType;i("spline","line",{},{getPointSpline:function(t,i,n){function o(t){return t&&!t.isNull&&t.doCurve!==!1&&!i.isCliff}var r,s,a,l,h,c=1.5,d=c+1,p=i.plotX,u=i.plotY,g=t[n-1],f=t[n+1];if(o(g)&&o(f)){var m=g.plotX,x=g.plotY,v=f.plotX,y=f.plotY,b=0;r=(c*p+m)/d,s=(c*u+x)/d,a=(c*p+v)/d,l=(c*u+y)/d,a!==r&&(b=(l-s)*(a-p)/(a-r)+u-l),s+=b,l+=b,s>x&&s>u?(s=Math.max(x,u),l=2*u-s):x>s&&u>s&&(s=Math.min(x,u),l=2*u-s),l>y&&l>u?(l=Math.max(y,u),s=2*u-l):y>l&&u>l&&(l=Math.min(y,u),s=2*u-l),i.rightContX=a,i.rightContY=l}return h=["C",e(g.rightContX,g.plotX),e(g.rightContY,g.plotY),e(r,p),e(s,u),p,u],g.rightContX=g.rightContY=null,h}})}(e),function(t){var e=t.seriesTypes.area.prototype,i=t.defaultPlotOptions,n=t.LegendSymbolMixin,o=t.seriesType;o("areaspline","spline",i.area,{getStackPoints:e.getStackPoints,getGraphPath:e.getGraphPath,drawGraph:e.drawGraph,drawLegendSymbol:n.drawRectangle})}(e),function(t){var e=t.animObject,i=t.color,n=t.each,o=t.extend,r=t.isNumber,s=t.LegendSymbolMixin,a=t.merge,l=t.noop,h=t.pick,c=t.Series,d=t.seriesType,p=t.svg;d("column","line",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){c.prototype.init.apply(this,arguments);var t=this,e=t.chart;e.hasRendered&&n(e.series,function(e){e.type===t.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var t,e=this,i=e.options,o=e.xAxis,r=e.yAxis,s=o.reversed,a={},l=0;i.grouping===!1?l=1:n(e.chart.series,function(i){var n,o=i.options,s=i.yAxis;i.type!==e.type||!i.visible&&e.chart.options.chart.ignoreHiddenSeries||r.len!==s.len||r.pos!==s.pos||(o.stacking?(t=i.stackKey,void 0===a[t]&&(a[t]=l++),n=a[t]):o.grouping!==!1&&(n=l++),i.columnIndex=n)});var c=Math.min(Math.abs(o.transA)*(o.ordinalSlope||i.pointRange||o.closestPointRange||o.tickInterval||1),o.len),d=c*i.groupPadding,p=c-2*d,u=p/(l||1),g=Math.min(i.maxPointWidth||o.len,h(i.pointWidth,u*(1-2*i.pointPadding))),f=(u-g)/2,m=(e.columnIndex||0)+(s?1:0),x=f+(d+m*u-c/2)*(s?-1:1);return e.columnMetrics={width:g,offset:x},e.columnMetrics},crispCol:function(t,e,i,n){var o,r,s,a=this.chart,l=this.borderWidth,h=-(l%2?.5:0),c=l%2?.5:1;return a.inverted&&a.renderer.isVML&&(c+=1),this.options.crisp&&(o=Math.round(t+i)+h,t=Math.round(t)+h,i=o-t),r=Math.round(e+n)+c,s=Math.abs(e)<=.5&&r>.5,e=Math.round(e)+c,n=r-e,s&&n&&(e-=1,n+=1),{x:t,y:e,width:i,height:n}},translate:function(){var t=this,e=t.chart,i=t.options,o=t.dense=t.closestPointRange*t.xAxis.transA<2,r=t.borderWidth=h(i.borderWidth,o?0:1),s=t.yAxis,a=i.threshold,l=t.translatedThreshold=s.getThreshold(a),d=h(i.minPointLength,5),p=t.getColumnMetrics(),u=p.width,g=t.barW=Math.max(u,1+2*r),f=t.pointXOffset=p.offset;e.inverted&&(l-=.5),i.pointPadding&&(g=Math.ceil(g)),c.prototype.translate.apply(t),n(t.points,function(i){var n,o=h(i.yBottom,l),r=999+Math.abs(o),c=Math.min(Math.max(-r,i.plotY),s.len+r),p=i.plotX+f,m=g,x=Math.min(c,o),v=Math.max(c,o)-x;d&&Math.abs(v)<d&&(v=d,n=!s.reversed&&!i.negative||s.reversed&&i.negative,i.y===a&&t.dataMax<=a&&s.min<a&&(n=!n),x=Math.abs(x-l)>d?o-d:l-(n?d:0)),i.barX=p,i.pointWidth=u,i.tooltipPos=e.inverted?[s.len+s.pos-e.plotLeft-c,t.xAxis.len-p-m/2,v]:[p+m/2,c+s.pos-e.plotTop,v],i.shapeType="rect",i.shapeArgs=t.crispCol.apply(t,i.isNull?[p,l,m,0]:[p,x,m,v])})},getSymbol:l,drawLegendSymbol:s.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(t,e){var n,o,r,s,l=this.options,h=this.pointAttrToOptions||{},c=h.stroke||"borderColor",d=h["stroke-width"]||"borderWidth",p=t&&t.color||this.color,u=t&&t[c]||l[c]||this.color||p,g=t&&t[d]||l[d]||this[d]||0,f=l.dashStyle;return t&&this.zones.length&&(r=t.getZone(),p=t.options.color||r&&r.color||this.color),e&&(n=a(l.states[e],t.options.states&&t.options.states[e]||{}),s=n.brightness,p=n.color||void 0!==s&&i(p).brighten(n.brightness).get()||p,u=n[c]||u,g=n[d]||g,f=n.dashStyle||f),o={fill:p,stroke:u,"stroke-width":g},f&&(o.dashstyle=f),o},drawPoints:function(){var t,e=this,i=this.chart,o=e.options,s=i.renderer,l=o.animationLimit||250;n(e.points,function(n){var h=n.plotY,c=n.graphic;r(h)&&null!==n.y?(t=n.shapeArgs,c?c[i.pointCount<l?"animate":"attr"](a(t)):n.graphic=c=s[n.shapeType](t).add(n.group||e.group),o.borderRadius&&c.attr({r:o.borderRadius}),c.attr(e.pointAttribs(n,n.selected&&"select")).shadow(o.shadow,null,o.stacking&&!o.borderRadius),c.addClass(n.getClassName(),!0)):c&&(n.graphic=c.destroy())})},animate:function(t){var i,n,r=this,s=this.yAxis,a=r.options,l=this.chart.inverted,h={},c=l?"translateX":"translateY";p&&(t?(h.scaleY=.001,n=Math.min(s.pos+s.len,Math.max(s.pos,s.toPixels(a.threshold))),l?h.translateX=n-s.len:h.translateY=n,r.group.attr(h)):(i=r.group.attr(c),r.group.animate({scaleY:1},o(e(r.options.animation),{step:function(t,e){h[c]=i+e.pos*(s.pos-i),r.group.attr(h)}})),r.animate=null))},remove:function(){var t=this,e=t.chart;e.hasRendered&&n(e.series,function(e){e.type===t.type&&(e.isDirty=!0)}),c.prototype.remove.apply(t,arguments)}})}(e),function(t){var e=t.seriesType;e("bar","column",null,{inverted:!0})}(e),function(t){var e=t.Series,i=t.seriesType;i("scatter","line",{lineWidth:0,findNearestPointBy:"xy",marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 0.85em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,drawGraph:function(){this.options.lineWidth&&e.prototype.drawGraph.call(this)}})}(e),function(t){var e=t.deg2rad,i=t.isNumber,n=t.pick,o=t.relativeLength;t.CenteredSeriesMixin={getCenter:function(){var t,e,i,r=this.options,s=this.chart,a=2*(r.slicedOffset||0),l=s.plotWidth-2*a,h=s.plotHeight-2*a,c=r.center,d=[n(c[0],"50%"),n(c[1],"50%"),r.size||"100%",r.innerSize||0],p=Math.min(l,h);for(e=0;4>e;++e)i=d[e],t=2>e||2===e&&/%$/.test(i),d[e]=o(i,[l,h,p,d[2]][e])+(t?a:0);return d[3]>d[2]&&(d[3]=d[2]),d},getStartAndEndRadians:function(t,n){var o=i(t)?t:0,r=i(n)&&n>o&&360>n-o?n:o+360,s=-90;return{start:e*(o+s),end:e*(r+s)}}}}(e),function(t){var e=t.addEvent,i=t.CenteredSeriesMixin,n=t.defined,o=t.each,r=t.extend,s=i.getStartAndEndRadians,a=t.inArray,l=t.LegendSymbolMixin,h=t.noop,c=t.pick,d=t.Point,p=t.Series,u=t.seriesType,g=t.seriesTypes,f=t.setAnimation;u("pie","line",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,states:{hover:{brightness:.1,shadow:!1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttribs:g.column.prototype.pointAttribs,animate:function(t){var e=this,i=e.points,n=e.startAngleRad;t||(o(i,function(t){var i=t.graphic,o=t.shapeArgs;i&&(i.attr({r:t.startR||e.center[3]/2,start:n,end:n}),i.animate({r:o.r,start:o.start,end:o.end},e.options.animation))}),e.animate=null)},updateTotals:function(){var t,e,i=0,n=this.points,o=n.length,r=this.options.ignoreHiddenPoint;for(t=0;o>t;t++)e=n[t],i+=r&&!e.visible?0:e.isNull?0:e.y;for(this.total=i,t=0;o>t;t++)e=n[t],e.percentage=i>0&&(e.visible||!r)?e.y/i*100:0,e.total=i},generatePoints:function(){p.prototype.generatePoints.call(this),this.updateTotals()},translate:function(t){this.generatePoints();var e,i,n,o,r,a,l,h,d=this,p=0,u=1e3,g=d.options,f=g.slicedOffset,m=f+(g.borderWidth||0),x=s(g.startAngle,g.endAngle),v=d.startAngleRad=x.start,y=d.endAngleRad=x.end,b=y-v,k=d.points,M=g.dataLabels.distance,w=g.ignoreHiddenPoint,S=k.length;for(t||(d.center=t=d.getCenter()),d.getX=function(e,i,n){return o=Math.asin(Math.min((e-t[1])/(t[2]/2+n.labelDistance),1)),t[0]+(i?-1:1)*Math.cos(o)*(t[2]/2+n.labelDistance)},l=0;S>l;l++)h=k[l],h.labelDistance=c(h.options.dataLabels&&h.options.dataLabels.distance,M),d.maxLabelDistance=Math.max(d.maxLabelDistance||0,h.labelDistance),i=v+p*b,(!w||h.visible)&&(p+=h.percentage/100),n=v+p*b,h.shapeType="arc",h.shapeArgs={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:Math.round(i*u)/u,end:Math.round(n*u)/u},o=(n+i)/2,o>1.5*Math.PI?o-=2*Math.PI:o<-Math.PI/2&&(o+=2*Math.PI),h.slicedTranslation={translateX:Math.round(Math.cos(o)*f),translateY:Math.round(Math.sin(o)*f)},r=Math.cos(o)*t[2]/2,a=Math.sin(o)*t[2]/2,h.tooltipPos=[t[0]+.7*r,t[1]+.7*a],h.half=o<-Math.PI/2||o>Math.PI/2?1:0,h.angle=o,e=Math.min(m,h.labelDistance/5),h.labelPos=[t[0]+r+Math.cos(o)*h.labelDistance,t[1]+a+Math.sin(o)*h.labelDistance,t[0]+r+Math.cos(o)*e,t[1]+a+Math.sin(o)*e,t[0]+r,t[1]+a,h.labelDistance<0?"center":h.half?"right":"left",o]},drawGraph:null,drawPoints:function(){var t,e,i,n,s=this,a=s.chart,l=a.renderer,h=s.options.shadow;h&&!s.shadowGroup&&(s.shadowGroup=l.g("shadow").add(s.group)),o(s.points,function(o){if(e=o.graphic,o.isNull)e&&(o.graphic=e.destroy());else{n=o.shapeArgs,t=o.getTranslate();var a=o.shadowGroup;h&&!a&&(a=o.shadowGroup=l.g("shadow").add(s.shadowGroup)),a&&a.attr(t),i=s.pointAttribs(o,o.selected&&"select"),e?e.setRadialReference(s.center).attr(i).animate(r(n,t)):(o.graphic=e=l[o.shapeType](n).setRadialReference(s.center).attr(t).add(s.group),o.visible||e.attr({visibility:"hidden"}),e.attr(i).attr({"stroke-linejoin":"round"}).shadow(h,a)),e.addClass(o.getClassName())}})},searchPoint:h,sortByAngle:function(t,e){t.sort(function(t,i){return void 0!==t.angle&&(i.angle-t.angle)*e})},drawLegendSymbol:l.drawRectangle,getCenter:i.getCenter,getSymbol:h},{init:function(){d.prototype.init.apply(this,arguments);var t,i=this;return i.name=c(i.name,"Slice"),t=function(t){i.slice("select"===t.type)},e(i,"select",t),e(i,"unselect",t),i},isValid:function(){return t.isNumber(this.y,!0)&&this.y>=0},setVisible:function(t,e){var i=this,n=i.series,r=n.chart,s=n.options.ignoreHiddenPoint;e=c(e,s),t!==i.visible&&(i.visible=i.options.visible=t=void 0===t?!i.visible:t,n.options.data[a(i,n.data)]=i.options,o(["graphic","dataLabel","connector","shadowGroup"],function(e){i[e]&&i[e][t?"show":"hide"](!0)}),i.legendItem&&r.legend.colorizeItem(i,t),t||"hover"!==i.state||i.setState(""),s&&(n.isDirty=!0),e&&r.redraw())},slice:function(t,e,i){var o=this,r=o.series,s=r.chart;f(i,s),e=c(e,!0),o.sliced=o.options.sliced=t=n(t)?t:!o.sliced,r.options.data[a(o,r.data)]=o.options,o.graphic.animate(this.getTranslate()),o.shadowGroup&&o.shadowGroup.animate(this.getTranslate())},getTranslate:function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},haloPath:function(t){var e=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(e.x,e.y,e.r+t,e.r+t,{innerR:this.shapeArgs.r-1,start:e.start,end:e.end})}})}(e),function(t){var e=t.addEvent,i=t.arrayMax,n=t.defined,o=t.each,r=t.extend,s=t.format,a=t.map,l=t.merge,h=t.noop,c=t.pick,d=t.relativeLength,p=t.Series,u=t.seriesTypes,g=t.stableSort;t.distribute=function(t,e){function i(t,e){return t.target-e.target}var n,r,s,l=!0,h=t,d=[],p=0;for(n=t.length;n--;)p+=t[n].size;if(p>e){for(g(t,function(t,e){return(e.rank||0)-(t.rank||0)}),n=0,p=0;e>=p;)p+=t[n].size,n++;d=t.splice(n-1,t.length)}for(g(t,i),t=a(t,function(t){return{size:t.size,targets:[t.target],align:c(t.align,.5)}});l;){for(n=t.length;n--;)r=t[n],s=(Math.min.apply(0,r.targets)+Math.max.apply(0,r.targets))/2,r.pos=Math.min(Math.max(0,s-r.size*r.align),e-r.size);for(n=t.length,l=!1;n--;)n>0&&t[n-1].pos+t[n-1].size>t[n].pos&&(t[n-1].size+=t[n].size,t[n-1].targets=t[n-1].targets.concat(t[n].targets),t[n-1].align=.5,t[n-1].pos+t[n-1].size>e&&(t[n-1].pos=e-t[n-1].size),t.splice(n,1),l=!0)}n=0,o(t,function(t){var e=0;o(t.targets,function(){h[n].pos=t.pos+e,e+=h[n].size,n++})}),h.push.apply(h,d),g(h,i)},p.prototype.drawDataLabels=function(){function i(t,e){var i,n,o,r=e.filter;return r?(i=r.operator,n=t[r.property],o=r.value,">"===i&&n>o||"<"===i&&o>n||">="===i&&n>=o||"<="===i&&o>=n||"=="===i&&n==o||"==="===i&&n===o?!0:!1):!0}var r,a,h,d,p=this,u=p.options,g=u.dataLabels,f=p.points,m=p.hasRendered||0,x=c(g.defer,!!u.animation),v=p.chart.renderer;(g.enabled||p._hasPointLabels)&&(p.dlProcessOptions&&p.dlProcessOptions(g),d=p.plotGroup("dataLabelsGroup","data-labels",x&&!m?"hidden":"visible",g.zIndex||6),x&&(d.attr({opacity:+m}),m||e(p,"afterAnimate",function(){p.visible&&d.show(!0),d[u.animation?"animate":"attr"]({opacity:1},{duration:200})})),a=g,o(f,function(e){var o,f,m,x,y,b,k=e.dataLabel,M=e.connector,w=!k;r=e.dlOptions||e.options&&e.options.dataLabels,o=c(r&&r.enabled,a.enabled)&&!e.isNull,o&&(o=i(e,r||g)===!0),o&&(g=l(a,r),f=e.getLabelConfig(),b=g[e.formatPrefix+"Format"]||g.format,h=n(b)?s(b,f):(g[e.formatPrefix+"Formatter"]||g.formatter).call(f,g),y=g.style,x=g.rotation,y.color=c(g.color,y.color,p.color,"#000000"),"contrast"===y.color&&(e.contrastColor=v.getContrast(e.color||p.color),y.color=g.inside||c(e.labelDistance,g.distance)<0||u.stacking?e.contrastColor:"#000000"),u.cursor&&(y.cursor=u.cursor),m={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":g.borderWidth,r:g.borderRadius||0,rotation:x,padding:g.padding,zIndex:1},t.objectEach(m,function(t,e){void 0===t&&delete m[e]})),!k||o&&n(h)?o&&n(h)&&(k?m.text=h:(k=e.dataLabel=x?v.text(h,0,-9999).addClass("highcharts-data-label"):v.label(h,0,-9999,g.shape,null,null,g.useHTML,null,"data-label"),k.addClass(" highcharts-data-label-color-"+e.colorIndex+" "+(g.className||"")+(g.useHTML?"highcharts-tracker":""))),k.attr(m),k.css(y).shadow(g.shadow),k.added||k.add(d),p.alignDataLabel(e,k,g,null,w)):(e.dataLabel=k=k.destroy(),M&&(e.connector=M.destroy()))}))},p.prototype.alignDataLabel=function(t,e,i,n,o){var s,a,l,h,d,p,u=this.chart,g=u.inverted,f=c(t.dlBox&&t.dlBox.centerX,t.plotX,-9999),m=c(t.plotY,-9999),x=e.getBBox(),v=i.rotation,y=i.align,b=this.visible&&(t.series.forceDL||u.isInsidePlot(f,Math.round(m),g)||n&&u.isInsidePlot(f,g?n.x+1:n.y+n.height-1,g)),k="justify"===c(i.overflow,"justify");b&&(s=i.style.fontSize,a=u.renderer.fontMetrics(s,e).b,n=r({x:g?this.yAxis.len-m:f,y:Math.round(g?this.xAxis.len-f:m),width:0,height:0},n),r(i,{width:x.width,height:x.height}),v?(k=!1,d=u.renderer.rotCorr(a,v),p={x:n.x+i.x+n.width/2+d.x,y:n.y+i.y+{top:0,middle:.5,bottom:1}[i.verticalAlign]*n.height},e[o?"attr":"animate"](p).attr({align:y}),l=(v+720)%360,h=l>180&&360>l,"left"===y?p.y-=h?x.height:0:"center"===y?(p.x-=x.width/2,p.y-=x.height/2):"right"===y&&(p.x-=x.width,p.y-=h?0:x.height)):(e.align(i,null,n),p=e.alignAttr),k?t.isLabelJustified=this.justifyDataLabel(e,i,p,x,n,o):c(i.crop,!0)&&(b=u.isInsidePlot(p.x,p.y)&&u.isInsidePlot(p.x+x.width,p.y+x.height)),i.shape&&!v&&e[o?"attr":"animate"]({anchorX:g?u.plotWidth-t.plotY:t.plotX,anchorY:g?u.plotHeight-t.plotX:t.plotY})),b||(e.attr({y:-9999}),e.placed=!1)},p.prototype.justifyDataLabel=function(t,e,i,n,o,r){var s,a,l=this.chart,h=e.align,c=e.verticalAlign,d=t.box?0:t.padding||0;return s=i.x+d,0>s&&("right"===h?e.align="left":e.x=-s,a=!0),s=i.x+n.width-d,s>l.plotWidth&&("left"===h?e.align="right":e.x=l.plotWidth-s,a=!0),s=i.y+d,0>s&&("bottom"===c?e.verticalAlign="top":e.y=-s,a=!0),s=i.y+n.height-d,s>l.plotHeight&&("top"===c?e.verticalAlign="bottom":e.y=l.plotHeight-s,a=!0),a&&(t.placed=!r,t.align(e,null,o)),a},u.pie&&(u.pie.prototype.drawDataLabels=function(){var e,r,s,a,l,h,d,u,g,f,m=this,x=m.data,v=m.chart,y=m.options.dataLabels,b=c(y.connectorPadding,10),k=c(y.connectorWidth,1),M=v.plotWidth,w=v.plotHeight,S=m.center,A=S[2]/2,T=S[1],P=[[],[]],C=[0,0,0,0];m.visible&&(y.enabled||m._hasPointLabels)&&(o(x,function(t){t.dataLabel&&t.visible&&t.dataLabel.shortened&&(t.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),t.dataLabel.shortened=!1)}),p.prototype.drawDataLabels.apply(m),o(x,function(t){t.dataLabel&&t.visible&&(P[t.half].push(t),t.dataLabel._pos=null)}),o(P,function(i,r){var p,x,k,P,L,O,D=i.length,I=[];if(D)for(m.sortByAngle(i,r-.5),m.maxLabelDistance>0&&(p=Math.max(0,T-A-m.maxLabelDistance),x=Math.min(T+A+m.maxLabelDistance,v.plotHeight),o(i,function(t){t.labelDistance>0&&t.dataLabel&&(t.top=Math.max(0,T-A-t.labelDistance),t.bottom=Math.min(T+A+t.labelDistance,v.plotHeight),O=t.dataLabel.getBBox().height||21,t.positionsIndex=I.push({target:t.labelPos[1]-t.top+O/2,size:O,rank:t.y})-1)}),t.distribute(I,x+O-p)),f=0;D>f;f++)e=i[f],L=e.positionsIndex,l=e.labelPos,s=e.dataLabel,g=e.visible===!1?"hidden":"inherit",k=l[1],u=k,I&&n(I[L])&&(void 0===I[L].pos?g="hidden":(h=I[L].size,u=e.top+I[L].pos)),delete e.positionIndex,d=y.justify?S[0]+(r?-1:1)*(A+e.labelDistance):m.getX(u<e.top+2||u>e.bottom-2?k:u,r,e),s._attr={visibility:g,align:l[6]},s._pos={x:d+y.x+({left:b,right:-b}[l[6]]||0),y:u+y.y-10},l.x=d,l.y=u,c(y.crop,!0)&&(a=s.getBBox().width,P=null,b>d-a?(P=Math.round(a-d+b),C[3]=Math.max(P,C[3])):d+a>M-b&&(P=Math.round(d+a-M+b),C[1]=Math.max(P,C[1])),0>u-h/2?C[0]=Math.max(Math.round(-u+h/2),C[0]):u+h/2>w&&(C[2]=Math.max(Math.round(u+h/2-w),C[2])),s.sideOverflow=P)}),(0===i(C)||this.verifyDataLabelOverflow(C))&&(this.placeDataLabels(),k&&o(this.points,function(t){var e;r=t.connector,s=t.dataLabel,s&&s._pos&&t.visible&&t.labelDistance>0?(g=s._attr.visibility,e=!r,e&&(t.connector=r=v.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+t.colorIndex).add(m.dataLabelsGroup),r.attr({"stroke-width":k,stroke:y.connectorColor||t.color||"#666666"})),r[e?"attr":"animate"]({d:m.connectorPath(t.labelPos)}),r.attr("visibility",g)):r&&(t.connector=r.destroy())})))},u.pie.prototype.connectorPath=function(t){var e=t.x,i=t.y;return c(this.options.dataLabels.softConnector,!0)?["M",e+("left"===t[6]?5:-5),i,"C",e,i,2*t[2]-t[4],2*t[3]-t[5],t[2],t[3],"L",t[4],t[5]]:["M",e+("left"===t[6]?5:-5),i,"L",t[2],t[3],"L",t[4],t[5]]},u.pie.prototype.placeDataLabels=function(){o(this.points,function(t){var e,i=t.dataLabel;i&&t.visible&&(e=i._pos,e?(i.sideOverflow&&(i._attr.width=i.getBBox().width-i.sideOverflow,i.css({width:i._attr.width+"px",textOverflow:"ellipsis"}),i.shortened=!0),i.attr(i._attr),i[i.moved?"animate":"attr"](e),i.moved=!0):i&&i.attr({y:-9999}))},this)},u.pie.prototype.alignDataLabel=h,u.pie.prototype.verifyDataLabelOverflow=function(t){var e=this.center,i=this.options,n=i.center,o=i.minSize||80,r=o,s=null!==i.size;return s||(null!==n[0]?r=Math.max(e[2]-Math.max(t[1],t[3]),o):(r=Math.max(e[2]-t[1]-t[3],o),e[0]+=(t[3]-t[1])/2),null!==n[1]?r=Math.max(Math.min(r,e[2]-Math.max(t[0],t[2])),o):(r=Math.max(Math.min(r,e[2]-t[0]-t[2]),o),e[1]+=(t[0]-t[2])/2),r<e[2]?(e[2]=r,e[3]=Math.min(d(i.innerSize||0,r),r),this.translate(e),this.drawDataLabels&&this.drawDataLabels()):s=!0),s}),u.column&&(u.column.prototype.alignDataLabel=function(t,e,i,n,o){var r,s=this.chart.inverted,a=t.series,h=t.dlBox||t.shapeArgs,d=c(t.below,t.plotY>c(this.translatedThreshold,a.yAxis.len)),u=c(i.inside,!!this.options.stacking);h&&(n=l(h),n.y<0&&(n.height+=n.y,n.y=0),r=n.y+n.height-a.yAxis.len,r>0&&(n.height-=r),s&&(n={x:a.yAxis.len-n.y-n.height,y:a.xAxis.len-n.x-n.width,width:n.height,height:n.width}),u||(s?(n.x+=d?0:n.width,n.width=0):(n.y+=d?n.height:0,n.height=0))),i.align=c(i.align,!s||u?"center":d?"right":"left"),i.verticalAlign=c(i.verticalAlign,s||u?"middle":d?"top":"bottom"),p.prototype.alignDataLabel.call(this,t,e,i,n,o),t.isLabelJustified&&t.contrastColor&&t.dataLabel.css({color:t.contrastColor})})}(e),function(t){var e=t.Chart,i=t.each,n=t.objectEach,o=t.pick,r=t.addEvent;r(e.prototype,"render",function(){var t=[];i(this.labelCollectors||[],function(e){t=t.concat(e())}),i(this.yAxis||[],function(e){e.options.stackLabels&&!e.options.stackLabels.allowOverlap&&n(e.stacks,function(e){n(e,function(e){t.push(e.label)})})}),i(this.series||[],function(e){var n=e.options.dataLabels,r=e.dataLabelCollections||["dataLabel"];(n.enabled||e._hasPointLabels)&&!n.allowOverlap&&e.visible&&i(r,function(n){i(e.points,function(e){e[n]&&(e[n].labelrank=o(e.labelrank,e.shapeArgs&&e.shapeArgs.height),t.push(e[n]))})})}),this.hideOverlappingLabels(t)}),e.prototype.hideOverlappingLabels=function(t){var e,n,o,r,s,a,l,h,c,d,p,u,g=t.length,f=function(t,e,i,n,o,r,s,a){return!(o>t+i||t>o+s||r>e+n||e>r+a)};for(n=0;g>n;n++)e=t[n],e&&(e.oldOpacity=e.opacity,e.newOpacity=1,e.width||(u=e.getBBox(),e.width=u.width,e.height=u.height));for(t.sort(function(t,e){return(e.labelrank||0)-(t.labelrank||0)}),n=0;g>n;n++)for(r=t[n],o=n+1;g>o;++o)s=t[o],r&&s&&r!==s&&r.placed&&s.placed&&0!==r.newOpacity&&0!==s.newOpacity&&(l=r.alignAttr,h=s.alignAttr,c=r.parentGroup,d=s.parentGroup,p=2*(r.box?0:r.padding||0),a=f(l.x+c.translateX,l.y+c.translateY,r.width-p,r.height-p,h.x+d.translateX,h.y+d.translateY,s.width-p,s.height-p),a&&((r.labelrank<s.labelrank?r:s).newOpacity=0));i(t,function(t){var e,i;t&&(i=t.newOpacity,t.oldOpacity!==i&&t.placed&&(i?t.show(!0):e=function(){t.hide()},t.alignAttr.opacity=i,t[t.isOld?"animate":"attr"](t.alignAttr,null,e)),t.isOld=!0)})}}(e),function(t){var e,i=t.addEvent,n=t.Chart,o=t.createElement,r=t.css,s=t.defaultOptions,a=t.defaultPlotOptions,l=t.each,h=t.extend,c=t.fireEvent,d=t.hasTouch,p=t.inArray,u=t.isObject,g=t.Legend,f=t.merge,m=t.pick,x=t.Point,v=t.Series,y=t.seriesTypes,b=t.svg;e=t.TrackerMixin={drawTrackerPoint:function(){var t=this,e=t.chart,i=e.pointer,n=function(t){var e=i.getPointFromEvent(t);void 0!==e&&(i.isDirectTouch=!0,e.onMouseOver(t))};l(t.points,function(t){t.graphic&&(t.graphic.element.point=t),t.dataLabel&&(t.dataLabel.div?t.dataLabel.div.point=t:t.dataLabel.element.point=t)}),t._hasTracking||(l(t.trackerGroups,function(e){t[e]&&(t[e].addClass("highcharts-tracker").on("mouseover",n).on("mouseout",function(t){i.onTrackerMouseOut(t)}),d&&t[e].on("touchstart",n),t.options.cursor&&t[e].css(r).css({cursor:t.options.cursor}))}),t._hasTracking=!0)},drawTrackerGraph:function(){var t,e=this,i=e.options,n=i.trackByArea,o=[].concat(n?e.areaPath:e.graphPath),r=o.length,s=e.chart,a=s.pointer,h=s.renderer,c=s.options.tooltip.snap,p=e.tracker,u=function(){s.hoverSeries!==e&&e.onMouseOver()},g="rgba(192,192,192,"+(b?1e-4:.002)+")";if(r&&!n)for(t=r+1;t--;)"M"===o[t]&&o.splice(t+1,0,o[t+1]-c,o[t+2],"L"),(t&&"M"===o[t]||t===r)&&o.splice(t,0,"L",o[t-2]+c,o[t-1]);p?p.attr({d:o}):e.graph&&(e.tracker=h.path(o).attr({"stroke-linejoin":"round",visibility:e.visible?"visible":"hidden",stroke:g,fill:n?g:"none","stroke-width":e.graph.strokeWidth()+(n?0:2*c),zIndex:2}).add(e.group),l([e.tracker,e.markerGroup],function(t){t.addClass("highcharts-tracker").on("mouseover",u).on("mouseout",function(t){a.onTrackerMouseOut(t)}),i.cursor&&t.css({cursor:i.cursor}),d&&t.on("touchstart",u)}))}},y.column&&(y.column.prototype.drawTracker=e.drawTrackerPoint),y.pie&&(y.pie.prototype.drawTracker=e.drawTrackerPoint),y.scatter&&(y.scatter.prototype.drawTracker=e.drawTrackerPoint),h(g.prototype,{setItemEvents:function(t,e,i){var n=this,o=n.chart.renderer.boxWrapper,r="highcharts-legend-"+(t instanceof x?"point":"series")+"-active";(i?e:t.legendGroup).on("mouseover",function(){t.setState("hover"),o.addClass(r),e.css(n.options.itemHoverStyle)}).on("mouseout",function(){e.css(f(t.visible?n.itemStyle:n.itemHiddenStyle)),o.removeClass(r),t.setState()}).on("click",function(e){var i="legendItemClick",n=function(){t.setVisible&&t.setVisible()};o.removeClass(r),e={browserEvent:e},t.firePointEvent?t.firePointEvent(i,e,n):c(t,i,e,n)})},createCheckboxForItem:function(t){var e=this;t.checkbox=o("input",{type:"checkbox",checked:t.selected,defaultChecked:t.selected},e.options.itemCheckboxStyle,e.chart.container),i(t.checkbox,"click",function(e){var i=e.target;c(t.series||t,"checkboxClick",{checked:i.checked,item:t},function(){t.select()})})}}),s.legend.itemStyle.cursor="pointer",h(n.prototype,{showResetZoom:function(){function t(){e.zoomOut()}var e=this,i=s.lang,n=e.options.chart.resetZoomButton,o=n.theme,r=o.states,a="chart"===n.relativeTo?null:"plotBox";this.resetZoomButton=e.renderer.button(i.resetZoom,null,null,t,o,r&&r.hover).attr({align:n.position.align,title:i.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(n.position,!1,a)},zoomOut:function(){var t=this;c(t,"selection",{resetSelection:!0},function(){t.zoom()})},zoom:function(t){var e,i,n=this,o=n.pointer,r=!1;!t||t.resetSelection?(l(n.axes,function(t){e=t.zoom()}),o.initiated=!1):l(t.xAxis.concat(t.yAxis),function(t){var i=t.axis,n=i.isXAxis;o[n?"zoomX":"zoomY"]&&(e=i.zoom(t.min,t.max),i.displayBtn&&(r=!0))}),i=n.resetZoomButton,r&&!i?n.showResetZoom():!r&&u(i)&&(n.resetZoomButton=i.destroy()),e&&n.redraw(m(n.options.chart.animation,t&&t.animation,n.pointCount<100))},pan:function(t,e){var i,n=this,o=n.hoverPoints;o&&l(o,function(t){t.setState()}),l("xy"===e?[1,0]:[1],function(e){var o,r=n[e?"xAxis":"yAxis"][0],s=r.horiz,a=t[s?"chartX":"chartY"],l=s?"mouseDownX":"mouseDownY",h=n[l],c=(r.pointRange||0)/2,d=r.getExtremes(),p=r.toValue(h-a,!0)+c,u=r.toValue(h+r.len-a,!0)-c,g=p>u,f=g?u:p,m=g?p:u,x=Math.min(d.dataMin,c?d.min:r.toValue(r.toPixels(d.min)-r.minPixelPadding)),v=Math.max(d.dataMax,c?d.max:r.toValue(r.toPixels(d.max)+r.minPixelPadding));o=x-f,o>0&&(m+=o,f=x),o=m-v,o>0&&(m=v,f-=o),r.series.length&&f!==d.min&&m!==d.max&&(r.setExtremes(f,m,!1,!1,{trigger:"pan"}),i=!0),n[l]=a}),i&&n.redraw(!1),r(n.container,{cursor:"move"})}}),h(x.prototype,{select:function(t,e){var i=this,n=i.series,o=n.chart;t=m(t,!i.selected),i.firePointEvent(t?"select":"unselect",{accumulate:e},function(){i.selected=i.options.selected=t,n.options.data[p(i,n.data)]=i.options,i.setState(t&&"select"),e||l(o.getSelectedPoints(),function(t){t.selected&&t!==i&&(t.selected=t.options.selected=!1,n.options.data[p(t,n.data)]=t.options,t.setState(""),t.firePointEvent("unselect"))})})},onMouseOver:function(t){var e=this,i=e.series,n=i.chart,o=n.pointer;t=t?o.normalize(t):o.getChartCoordinatesFromPoint(e,n.inverted),o.runPointActions(t,e)},onMouseOut:function(){var t=this,e=t.series.chart;t.firePointEvent("mouseOut"),l(e.hoverPoints||[],function(t){t.setState()}),e.hoverPoints=e.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var e=this,n=f(e.series.options.point,e.options),o=n.events;e.events=o,t.objectEach(o,function(t,n){i(e,n,t)}),this.hasImportedEvents=!0}},setState:function(t,e){var i,n,o,r=this,s=Math.floor(r.plotX),l=r.plotY,c=r.series,d=c.options.states[t]||{},p=a[c.type].marker&&c.options.marker,u=p&&p.enabled===!1,g=p&&p.states&&p.states[t]||{},f=g.enabled===!1,x=c.stateMarkerGraphic,v=r.marker||{},y=c.chart,b=c.halo,k=p&&c.markerAttribs;t=t||"",t===r.state&&!e||r.selected&&"select"!==t||d.enabled===!1||t&&(f||u&&g.enabled===!1)||t&&v.states&&v.states[t]&&v.states[t].enabled===!1||(k&&(n=c.markerAttribs(r,t)),r.graphic?(r.state&&r.graphic.removeClass("highcharts-point-"+r.state),t&&r.graphic.addClass("highcharts-point-"+t),r.graphic.animate(c.pointAttribs(r,t),m(y.options.chart.animation,d.animation)),n&&r.graphic.animate(n,m(y.options.chart.animation,g.animation,p.animation)),x&&x.hide()):(t&&g&&(o=v.symbol||c.symbol,x&&x.currentSymbol!==o&&(x=x.destroy()),x?x[e?"animate":"attr"]({x:n.x,y:n.y}):o&&(c.stateMarkerGraphic=x=y.renderer.symbol(o,n.x,n.y,n.width,n.height).add(c.markerGroup),x.currentSymbol=o),x&&x.attr(c.pointAttribs(r,t))),x&&(x[t&&y.isInsidePlot(s,l,y.inverted)?"show":"hide"](),x.element.point=r)),i=d.halo,i&&i.size?(b||(c.halo=b=y.renderer.path().add((r.graphic||x).parentGroup)),b[e?"animate":"attr"]({d:r.haloPath(i.size)}),b.attr({class:"highcharts-halo highcharts-color-"+m(r.colorIndex,c.colorIndex)}),b.point=r,b.attr(h({fill:r.color||c.color,"fill-opacity":i.opacity,zIndex:-1},i.attributes))):b&&b.point&&b.point.haloPath&&b.animate({d:b.point.haloPath(0)}),r.state=t)},haloPath:function(t){var e=this.series,i=e.chart;return i.renderer.symbols.circle(Math.floor(this.plotX)-t,this.plotY-t,2*t,2*t)}}),h(v.prototype,{onMouseOver:function(){var t=this,e=t.chart,i=e.hoverSeries;i&&i!==t&&i.onMouseOut(),t.options.events.mouseOver&&c(t,"mouseOver"),t.setState("hover"),e.hoverSeries=t},onMouseOut:function(){var t=this,e=t.options,i=t.chart,n=i.tooltip,o=i.hoverPoint;i.hoverSeries=null,o&&o.onMouseOut(),t&&e.events.mouseOut&&c(t,"mouseOut"),!n||t.stickyTracking||n.shared&&!t.noSharedTooltip||n.hide(),t.setState()},setState:function(t){var e,i=this,n=i.options,o=i.graph,r=n.states,s=n.lineWidth,a=0;if(t=t||"",i.state!==t){if(l([i.group,i.markerGroup,i.dataLabelsGroup],function(e){e&&(i.state&&e.removeClass("highcharts-series-"+i.state),t&&e.addClass("highcharts-series-"+t))}),i.state=t,r[t]&&r[t].enabled===!1)return;if(t&&(s=r[t].lineWidth||s+(r[t].lineWidthPlus||0)),o&&!o.dashstyle)for(e={"stroke-width":s},o.animate(e,m(i.chart.options.chart.animation,r[t]&&r[t].animation));i["zone-graph-"+a];)i["zone-graph-"+a].attr(e),a+=1}},setVisible:function(t,e){var i,n=this,o=n.chart,r=n.legendItem,s=o.options.chart.ignoreHiddenSeries,a=n.visible;n.visible=t=n.options.visible=n.userOptions.visible=void 0===t?!a:t,i=t?"show":"hide",l(["group","dataLabelsGroup","markerGroup","tracker","tt"],function(t){n[t]&&n[t][i]()}),(o.hoverSeries===n||(o.hoverPoint&&o.hoverPoint.series)===n)&&n.onMouseOut(),r&&o.legend.colorizeItem(n,t),n.isDirty=!0,n.options.stacking&&l(o.series,function(t){t.options.stacking&&t.visible&&(t.isDirty=!0)}),l(n.linkedSeries,function(e){e.setVisible(t,!1)}),s&&(o.isDirtyBox=!0),e!==!1&&o.redraw(),c(n,i)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){var e=this;e.selected=t=void 0===t?!e.selected:t,e.checkbox&&(e.checkbox.checked=t),c(e,t?"select":"unselect")},drawTracker:e.drawTrackerGraph})}(e),function(t){var e=t.Chart,i=t.each,n=t.inArray,o=t.isArray,r=t.isObject,s=t.pick,a=t.splat;e.prototype.setResponsive=function(e){var n,o=this.options.responsive,r=[],s=this.currentResponsive;o&&o.rules&&i(o.rules,function(i){void 0===i._id&&(i._id=t.uniqueKey()),this.matchResponsiveRule(i,r,e)},this);var a=t.merge.apply(0,t.map(r,function(e){return t.find(o.rules,function(t){return t._id===e}).chartOptions}));r=r.toString()||void 0,n=s&&s.ruleIds,r!==n&&(s&&this.update(s.undoOptions,e),r?(this.currentResponsive={ruleIds:r,mergedOptions:a,undoOptions:this.currentOptions(a)},this.update(a,e)):this.currentResponsive=void 0)},e.prototype.matchResponsiveRule=function(t,e){var i=t.condition,n=i.callback||function(){return this.chartWidth<=s(i.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=s(i.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=s(i.minWidth,0)&&this.chartHeight>=s(i.minHeight,0)};n.call(this)&&e.push(t._id)},e.prototype.currentOptions=function(e){function i(e,s,l,h){var c;t.objectEach(e,function(t,e){if(!h&&n(e,["series","xAxis","yAxis"])>-1)for(t=a(t),l[e]=[],c=0;c<t.length;c++)s[e][c]&&(l[e][c]={},i(t[c],s[e][c],l[e][c],h+1));else r(t)?(l[e]=o(t)?[]:{},i(t,s[e]||{},l[e],h+1)):l[e]=s[e]||null})}var s={};return i(e,this.options,s,0),s}}(e);var e=function(t){return t}(e);!function(t){var e=t.addEvent,i=t.Axis,n=t.Chart,o=t.css,r=t.dateFormat,s=t.defined,a=t.each,l=t.extend,h=t.noop,c=t.pick,d=t.Series,p=t.timeUnits,u=t.wrap;u(d.prototype,"init",function(t){var i,n=this;t.apply(this,Array.prototype.slice.call(arguments,1)),i=n.xAxis,i&&i.options.ordinal&&e(n,"updatedData",function(){delete i.ordinalIndex})}),u(i.prototype,"getTimeTicks",function(t,e,i,n,o,a,l,h){var c,d,u,g,f,m,x=0,v={},y=[],b=-Number.MAX_VALUE,k=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||!a||a.length<3||void 0===i)return t.call(this,e,i,n,o);for(f=a.length,c=0;f>c;c++){if(m=c&&a[c-1]>n,a[c]<i&&(x=c),c===f-1||a[c+1]-a[c]>5*l||m){if(a[c]>b){for(d=t.call(this,e,a[x],a[c],o);d.length&&d[0]<=b;)d.shift();d.length&&(b=d[d.length-1]),y=y.concat(d)}x=c+1}if(m)break}if(g=d.info,h&&g.unitRange<=p.hour){for(c=y.length-1,x=1;c>x;x++)r("%d",y[x])!==r("%d",y[x-1])&&(v[y[x]]="day",u=!0);u&&(v[y[0]]="day"),g.higherRanks=v}if(y.info=g,h&&s(k)){for(var M,w,S,A,T,P=y.length,C=P,L=[],O=[];C--;)w=this.translate(y[C]),S&&(O[C]=S-w),L[C]=S=w;for(O.sort(),A=O[Math.floor(O.length/2)],.6*k>A&&(A=null),C=y[P-1]>n?P-1:P,S=void 0;C--;)w=L[C],T=Math.abs(S-w),S&&.8*k>T&&(null===A||.8*A>T)?(v[y[C]]&&!v[y[C+1]]?(M=C+1,S=w):M=C,y.splice(M,1)):S=w}return y}),l(i.prototype,{beforeSetTickPositions:function(){var t,e,i,n,o,r,l=this,h=[],d=!1,p=l.getExtremes(),u=p.min,g=p.max,f=l.isXAxis&&!!l.options.breaks,m=l.options.ordinal,x=Number.MAX_VALUE,v=l.chart.options.chart.ignoreHiddenSeries,y="highcharts-navigator-xaxis"===l.options.className;if(!l.options.overscroll||l.max!==l.dataMax||l.chart.mouseIsDown&&!y||l.eventArgs&&(!l.eventArgs||"navigator"===l.eventArgs.trigger)||(l.max+=l.options.overscroll,!y&&s(l.userMin)&&(l.min+=l.options.overscroll)),m||f){if(a(l.series,function(e,i){if(!(v&&e.visible===!1||e.takeOrdinalPosition===!1&&!f)&&(h=h.concat(e.processedXData),t=h.length,h.sort(function(t,e){return t-e}),x=Math.min(x,c(e.closestPointRange,x)),t))for(i=t-1;i--;)h[i]===h[i+1]&&h.splice(i,1)}),t=h.length,t>2){for(e=h[1]-h[0],r=t-1;r--&&!d;)h[r+1]-h[r]!==e&&(d=!0);!l.options.keepOrdinalPadding&&(h[0]-u>e||g-h[h.length-1]>e)&&(d=!0)}else l.options.overscroll&&(2===t?x=h[1]-h[0]:1===t?(x=l.options.overscroll,h=[h[0],h[0]+x]):x=l.overscrollPointsRange);d?(l.options.overscroll&&(l.overscrollPointsRange=x,h=h.concat(l.getOverscrollPositions())),l.ordinalPositions=h,i=l.ordinal2lin(Math.max(u,h[0]),!0),n=Math.max(l.ordinal2lin(Math.min(g,h[h.length-1]),!0),1),l.ordinalSlope=o=(g-u)/(n-i),l.ordinalOffset=u-i*o):(l.overscrollPointsRange=c(l.closestPointRange,l.overscrollPointsRange),l.ordinalPositions=l.ordinalSlope=l.ordinalOffset=void 0)}l.isOrdinal=m&&d,l.groupIntervalFactor=null},val2lin:function(t,e){var i,n=this,o=n.ordinalPositions;if(o){var r,s,a,l=o.length;for(r=l;r--;)if(o[r]===t){a=r;break}for(r=l-1;r--;)if(t>o[r]||0===r){s=(t-o[r])/(o[r+1]-o[r]),a=r+s;break}i=e?a:n.ordinalSlope*(a||0)+n.ordinalOffset}else i=t;return i},lin2val:function(t,e){var i,n=this,o=n.ordinalPositions;if(o){var r,s,a,l=n.ordinalSlope,h=n.ordinalOffset,c=o.length-1;if(e)0>t?t=o[0]:t>c?t=o[c]:(c=Math.floor(t),a=t-c);else for(;c--;)if(r=l*c+h,t>=r){s=l*(c+1)+h,a=(t-r)/(s-r);break}return void 0!==a&&void 0!==o[c]?o[c]+(a?a*(o[c+1]-o[c]):0):t}return i=t},getExtendedPositions:function(){var t,e,n=this,o=n.chart,r=n.series[0].currentDataGrouping,s=n.ordinalIndex,l=r?r.count+r.unitName:"raw",c=n.options.overscroll,d=n.getExtremes();return s||(s=n.ordinalIndex={}),s[l]||(t={series:[],chart:o,getExtremes:function(){return{min:d.dataMin,max:d.dataMax+c}},options:{ordinal:!0},val2lin:i.prototype.val2lin,ordinal2lin:i.prototype.ordinal2lin},a(n.series,function(i){e={xAxis:t,xData:i.xData.slice(),chart:o,destroyGroupedData:h},e.xData=e.xData.concat(n.getOverscrollPositions()),e.options={dataGrouping:r?{enabled:!0,forced:!0,approximation:"open",units:[[r.unitName,[r.count]]]}:{enabled:!1}},i.processData.apply(e),t.series.push(e)}),n.beforeSetTickPositions.apply(t),s[l]=t.ordinalPositions),s[l]},getOverscrollPositions:function(){var e=this,i=e.options.overscroll,n=e.overscrollPointsRange,o=[],r=e.dataMax;if(t.defined(n))for(o.push(r);r<=e.dataMax+i;)r+=n,o.push(r);return o},getGroupIntervalFactor:function(t,e,i){var n,o,r=i.processedXData,s=r.length,a=[],l=this.groupIntervalFactor;if(!l){for(n=0;s-1>n;n++)a[n]=r[n+1]-r[n];a.sort(function(t,e){return t-e}),o=a[Math.floor(s/2)],t=Math.max(t,r[0]),e=Math.min(e,r[s-1]),this.groupIntervalFactor=l=s*o/(e-t)}return l},postProcessTickInterval:function(t){var e,i=this.ordinalSlope;return e=i?this.options.breaks?this.closestPointRange||t:t/(i/this.closestPointRange):t}}),i.prototype.ordinal2lin=i.prototype.val2lin,u(n.prototype,"pan",function(t,e){var i=this,n=i.xAxis[0],r=n.options.overscroll,s=e.chartX,l=!1;if(n.options.ordinal&&n.series.length){var h,c,d,p,u=i.mouseDownX,g=n.getExtremes(),f=g.dataMax,m=g.min,x=g.max,v=i.hoverPoints,y=n.closestPointRange||n.overscrollPointsRange,b=n.translationSlope*(n.ordinalSlope||y),k=(u-s)/b,M={ordinalPositions:n.getExtendedPositions()},w=n.lin2val,S=n.val2lin;M.ordinalPositions?Math.abs(k)>1&&(v&&a(v,function(t){t.setState()}),0>k?(d=M,p=n.ordinalPositions?n:M):(d=n.ordinalPositions?n:M,p=M),c=p.ordinalPositions,f>c[c.length-1]&&c.push(f),i.fixedRange=x-m,h=n.toFixedRange(null,null,w.apply(d,[S.apply(d,[m,!0])+k,!0]),w.apply(p,[S.apply(p,[x,!0])+k,!0])),h.min>=Math.min(g.dataMin,m)&&h.max<=Math.max(f,x)+r&&n.setExtremes(h.min,h.max,!0,!1,{trigger:"pan"}),i.mouseDownX=s,o(i.container,{cursor:"move"})):l=!0}else l=!0;l&&(r&&(n.max=n.dataMax+r),t.apply(this,Array.prototype.slice.call(arguments,1)))})}(e),function(t){function e(){return Array.prototype.slice.call(arguments,1)}function i(t){t.apply(this),this.drawBreaks(this.xAxis,["x"]),this.drawBreaks(this.yAxis,n(this.pointArrayMap,["y"]))}var n=t.pick,o=t.wrap,r=t.each,s=t.extend,a=t.isArray,l=t.fireEvent,h=t.Axis,c=t.Series;s(h.prototype,{isInBreak:function(t,e){var i,n=t.repeat||1/0,o=t.from,r=t.to-t.from,s=e>=o?(e-o)%n:n-(o-e)%n;return i=t.inclusive?r>=s:r>s&&0!==s},isInAnyBreak:function(t,e){var i,o,r,s=this.options.breaks,a=s&&s.length;if(a){for(;a--;)this.isInBreak(s[a],t)&&(i=!0,o||(o=n(s[a].showPoints,this.isXAxis?!1:!0)));r=i&&e?i&&!o:i}return r}}),o(h.prototype,"setTickPositions",function(t){if(t.apply(this,Array.prototype.slice.call(arguments,1)),this.options.breaks){var e,i=this,n=this.tickPositions,o=this.tickPositions.info,r=[];for(e=0;e<n.length;e++)i.isInAnyBreak(n[e])||r.push(n[e]);this.tickPositions=r,this.tickPositions.info=o}}),o(h.prototype,"init",function(t,e,i){var o,s=this;i.breaks&&i.breaks.length&&(i.ordinal=!1),t.call(this,e,i),o=this.options.breaks,s.isBroken=a(o)&&!!o.length,s.isBroken&&(s.val2lin=function(t){var e,i,n=t;for(i=0;i<s.breakArray.length;i++)if(e=s.breakArray[i],e.to<=t)n-=e.len;else{if(e.from>=t)break;if(s.isInBreak(e,t)){n-=t-e.from;break}}return n},s.lin2val=function(t){var e,i,n=t;for(i=0;i<s.breakArray.length&&(e=s.breakArray[i],!(e.from>=n));i++)e.to<n?n+=e.len:s.isInBreak(e,n)&&(n+=e.len);return n},s.setExtremes=function(t,e,i,n,o){for(;this.isInAnyBreak(t);)t-=this.closestPointRange;for(;this.isInAnyBreak(e);)e-=this.closestPointRange;h.prototype.setExtremes.call(this,t,e,i,n,o)},s.setAxisTranslation=function(t){h.prototype.setAxisTranslation.call(this,t);var e,i,o,a,c=s.options.breaks,d=[],p=[],u=0,g=s.userMin||s.min,f=s.userMax||s.max,m=n(s.pointRangePadding,0);r(c,function(t){i=t.repeat||1/0,s.isInBreak(t,g)&&(g+=t.to%i-g%i),s.isInBreak(t,f)&&(f-=f%i-t.from%i)}),r(c,function(t){for(o=t.from,i=t.repeat||1/0;o-i>g;)o-=i;for(;g>o;)o+=i;for(a=o;f>a;a+=i)d.push({value:a,move:"in"}),d.push({value:a+(t.to-t.from),move:"out",size:t.breakSize})}),d.sort(function(t,e){var i;return i=t.value===e.value?("in"===t.move?0:1)-("in"===e.move?0:1):t.value-e.value}),e=0,o=g,r(d,function(t){e+="in"===t.move?1:-1,1===e&&"in"===t.move&&(o=t.value),0===e&&(p.push({from:o,to:t.value,len:t.value-o-(t.size||0)}),u+=t.value-o-(t.size||0))}),s.breakArray=p,s.unitLength=f-g-u+m,l(s,"afterBreaks"),s.options.staticScale?s.transA=s.options.staticScale:s.unitLength&&(s.transA*=(f-s.min+m)/s.unitLength),m&&(s.minPixelPadding=s.transA*s.minPointOffset),s.min=g,s.max=f})}),o(c.prototype,"generatePoints",function(t){t.apply(this,e(arguments));var i,n,o=this,r=o.xAxis,s=o.yAxis,a=o.points,l=a.length,h=o.options.connectNulls;if(r&&s&&(r.options.breaks||s.options.breaks))for(;l--;)i=a[l],n=null===i.y&&h===!1,n||!r.isInAnyBreak(i.x,!0)&&!s.isInAnyBreak(i.y,!0)||(a.splice(l,1),this.data[l]&&this.data[l].destroyElements())}),t.Series.prototype.drawBreaks=function(t,e){var i,o,s,a,h=this,c=h.points;t&&r(e,function(e){i=t.breakArray||[],o=t.isXAxis?t.min:n(h.options.threshold,t.min),r(c,function(h){a=n(h["stack"+e.toUpperCase()],h[e]),r(i,function(e){s=!1,o<e.from&&a>e.to||o>e.from&&a<e.from?s="pointBreak":(o<e.from&&a>e.from&&a<e.to||o>e.from&&a>e.to&&a<e.from)&&(s="pointInBreak"),s&&l(t,s,{point:h,brk:e})})})})},t.Series.prototype.gappedPath=function(){var e,i,n=this.options.gapSize,o=this.points.slice(),r=o.length-1,s=this.yAxis;if(n&&r>0)for("value"!==this.options.gapUnit&&(n*=this.closestPointRange);r--;)o[r+1].x-o[r].x>n&&(e=(o[r].x+o[r+1].x)/2,o.splice(r+1,0,{isNull:!0,x:e}),this.options.stacking&&(i=s.stacks[this.stackKey][e]=new t.StackItem(s,s.options.stackLabels,!1,e,this.stack),i.total=0));return this.getGraphPath(o)},o(t.seriesTypes.column.prototype,"drawPoints",i),o(t.Series.prototype,"drawPoints",i)}(e),function(t){var e=t.arrayMax,i=t.arrayMin,n=t.Axis,o=t.defaultPlotOptions,r=t.defined,s=t.each,a=t.extend,l=t.format,h=t.isNumber,c=t.merge,d=t.pick,p=t.Point,u=t.Series,g=t.Tooltip,f=t.wrap,m=u.prototype,x=m.processData,v=m.generatePoints,y={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},b={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},k=t.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],M=t.approximations={sum:function(t){var e,i=t.length;if(!i&&t.hasNulls)e=null;else if(i)for(e=0;i--;)e+=t[i];return e},average:function(t){var e=t.length,i=M.sum(t);return h(i)&&e&&(i/=e),i},averages:function(){var t=[];return s(arguments,function(e){t.push(M.average(e))}),void 0===t[0]?void 0:t},open:function(t){return t.length?t[0]:t.hasNulls?null:void 0},high:function(t){return t.length?e(t):t.hasNulls?null:void 0},low:function(t){return t.length?i(t):t.hasNulls?null:void 0},close:function(t){return t.length?t[t.length-1]:t.hasNulls?null:void 0},ohlc:function(t,e,i,n){return t=M.open(t),e=M.high(e),i=M.low(i),n=M.close(n),h(t)||h(e)||h(i)||h(n)?[t,e,i,n]:void 0},range:function(t,e){return t=M.low(t),e=M.high(e),h(t)||h(e)?[t,e]:null===t&&null===e?null:void 0}};m.groupData=function(t,e,i,n){var o,r,a,l,c,d,p=this,u=p.data,g=p.options.data,f=[],m=[],x=[],v=t.length,k=!!e,w=[],S="function"==typeof n?n:M[n]||b[p.type]&&M[b[p.type].approximation]||M[y.approximation],A=p.pointArrayMap,T=A&&A.length,P=0,C=0;for(T?s(A,function(){w.push([])}):w.push([]),l=T||1,c=0;v>=c&&!(t[c]>=i[0]);c++);for(c;v>=c;c++){for(;void 0!==i[P+1]&&t[c]>=i[P+1]||c===v;){for(o=i[P],p.dataGroupInfo={start:C,length:w[0].length},a=S.apply(p,w),void 0!==a&&(f.push(o),m.push(a),x.push(p.dataGroupInfo)),C=c,d=0;l>d;d++)w[d].length=0,w[d].hasNulls=!1;if(P+=1,c===v)break}if(c===v)break;if(A){var L,O=p.cropStart+c,D=u&&u[O]||p.pointClass.prototype.applyOptions.apply({series:p},[g[O]]);for(d=0;T>d;d++)L=D[A[d]],h(L)?w[d].push(L):null===L&&(w[d].hasNulls=!0)}else r=k?e[c]:null,h(r)?w[0].push(r):null===r&&(w[0].hasNulls=!0)}return[f,m,x]},m.processData=function(){var t,e,i,n=this,o=n.chart,s=n.options,a=s.dataGrouping,l=n.allowDG!==!1&&a&&d(a.enabled,o.options.isStock),h=n.visible||!o.options.chart.ignoreHiddenSeries,c=this.currentDataGrouping;if(n.forceCrop=l,n.groupPixelWidth=null,n.hasProcessed=!0,e=x.apply(n,arguments)===!1||!l,!e){n.destroyGroupedData();var p,u=n.processedXData,g=n.processedYData,f=o.plotSizeX,v=n.xAxis,y=v.options.ordinal,b=n.groupPixelWidth=v.getGroupPixelWidth&&v.getGroupPixelWidth();if(b){t=!0,n.isDirty=!0,n.points=null;var M=v.getExtremes(),w=M.min,S=M.max,A=y&&v.getGroupIntervalFactor(w,S,n)||1,T=b*(S-w)/f*A,P=v.getTimeTicks(v.normalizeTimeTickInterval(T,a.units||k),Math.min(w,u[0]),Math.max(S,u[u.length-1]),v.options.startOfWeek,u,n.closestPointRange),C=m.groupData.apply(n,[u,g,P,a.approximation]),L=C[0],O=C[1];if(a.smoothed&&L.length){for(p=L.length-1,L[p]=Math.min(L[p],S);p--&&p>0;)L[p]+=T/2;L[0]=Math.max(L[0],w)}i=P.info,n.closestPointRange=P.info.totalRange,n.groupMap=C[2],r(L[0])&&L[0]<v.dataMin&&h&&(v.min===v.dataMin&&(v.min=L[0]),v.dataMin=L[0]),n.processedXData=L,n.processedYData=O}else n.groupMap=null;n.hasGroupedData=t,n.currentDataGrouping=i,n.preventGraphAnimation=(c&&c.totalRange)!==(i&&i.totalRange)}},m.destroyGroupedData=function(){var t=this.groupedData;s(t||[],function(e,i){e&&(t[i]=e.destroy?e.destroy():null)}),this.groupedData=null},m.generatePoints=function(){v.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},f(p.prototype,"update",function(e){this.dataGroup?t.error(24):e.apply(this,[].slice.call(arguments,1))}),f(g.prototype,"tooltipFooterHeaderFormatter",function(e,i,n){var o,r,s,c,d,p=this,u=i.series,g=u.options,f=u.tooltipOptions,m=g.dataGrouping,x=f.xDateFormat,v=u.xAxis,y=t.dateFormat;return v&&"datetime"===v.options.type&&m&&h(i.key)?(r=u.currentDataGrouping,s=m.dateTimeLabelFormats,r?(c=s[r.unitName],1===r.count?x=c[0]:(x=c[1],o=c[2])):!x&&s&&(x=p.getXDateFormat(i,f,v)),d=y(x,i.key),o&&(d+=y(o,i.key+r.totalRange-1)),l(f[(n?"footer":"header")+"Format"],{point:a(i.point,{key:d}),series:u})):e.call(p,i,n)}),f(m,"destroy",function(t){t.call(this),this.destroyGroupedData()}),f(m,"setOptions",function(t,e){var i=t.call(this,e),n=this.type,r=this.chart.options.plotOptions,s=o[n].dataGrouping;return b[n]&&(s||(s=c(y,b[n])),i.dataGrouping=c(s,r.series&&r.series.dataGrouping,r[n].dataGrouping,e.dataGrouping)),this.chart.options.isStock&&(this.requireSorting=!0),i}),f(n.prototype,"setScale",function(t){t.call(this),s(this.series,function(t){t.hasProcessed=!1})}),n.prototype.getGroupPixelWidth=function(){var t,e,i,n=this.series,o=n.length,r=0,s=!1;for(t=o;t--;)i=n[t].options.dataGrouping,i&&(r=Math.max(r,i.groupPixelWidth));for(t=o;t--;)i=n[t].options.dataGrouping,i&&n[t].hasProcessed&&(e=(n[t].processedXData||n[t].data).length,(n[t].groupPixelWidth||e>this.chart.plotSizeX/r||e&&i.forced)&&(s=!0));return s?r:0},n.prototype.setDataGrouping=function(t,e){var i;if(e=d(e,!0),t||(t={forced:!1,units:null}),this instanceof n)for(i=this.series.length;i--;)this.series[i].update({dataGrouping:t},!1);else s(this.chart.options.series,function(e){e.dataGrouping=t},!1);e&&this.chart.redraw()}}(e),function(t){var e=t.each,i=t.Point,n=t.seriesType,o=t.seriesTypes;n("ohlc","column",{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},threshold:null,states:{hover:{lineWidth:3}},stickyTracking:!0},{directTouch:!1,pointArrayMap:["open","high","low","close"],toYData:function(t){return[t.open,t.high,t.low,t.close]},pointValKey:"close",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},pointAttribs:function(t,e){var i=o.column.prototype.pointAttribs.call(this,t,e),n=this.options;return delete i.fill,!t.options.color&&n.upColor&&t.open<t.close&&(i.stroke=n.upColor),i},translate:function(){var t=this,i=t.yAxis,n=!!t.modifyValue,r=["plotOpen","plotHigh","plotLow","plotClose","yBottom"];o.column.prototype.translate.apply(t),e(t.points,function(o){e([o.open,o.high,o.low,o.close,o.low],function(e,s){null!==e&&(n&&(e=t.modifyValue(e)),o[r[s]]=i.toPixels(e,!0))}),o.tooltipPos[1]=o.plotHigh+i.pos-t.chart.plotTop})},drawPoints:function(){var t=this,i=t.points,n=t.chart;e(i,function(e){var i,o,r,s,a,l,h=e.graphic,c=!h;void 0!==e.plotY&&(h||(e.graphic=h=n.renderer.path().add(t.group)),h.attr(t.pointAttribs(e,e.selected&&"select")),r=h.strokeWidth()%2/2,l=Math.round(e.plotX)-r,s=Math.round(e.shapeArgs.width/2),a=["M",l,Math.round(e.yBottom),"L",l,Math.round(e.plotHigh)],null!==e.open&&(i=Math.round(e.plotOpen)+r,a.push("M",l,i,"L",l-s,i)),null!==e.close&&(o=Math.round(e.plotClose)+r,a.push("M",l,o,"L",l+s,o)),h[c?"attr":"animate"]({d:a}).addClass(e.getClassName(),!0))})},animate:null},{getClassName:function(){return i.prototype.getClassName.call(this)+(this.open<this.close?" highcharts-point-up":" highcharts-point-down")}})}(e),function(t){var e=t.defaultPlotOptions,i=t.each,n=t.merge,o=t.seriesType,r=t.seriesTypes,s={states:{hover:{lineWidth:2}},tooltip:e.ohlc.tooltip,threshold:null,lineColor:"#000000",lineWidth:1,upColor:"#ffffff",stickyTracking:!0};o("candlestick","ohlc",n(e.column,s),{pointAttribs:function(t,e){var i,n=r.column.prototype.pointAttribs.call(this,t,e),o=this.options,s=t.open<t.close,a=o.lineColor||this.color;return n["stroke-width"]=o.lineWidth,n.fill=t.options.color||(s?o.upColor||this.color:this.color),n.stroke=t.lineColor||(s?o.upLineColor||a:a),e&&(i=o.states[e],n.fill=i.color||n.fill,n.stroke=i.lineColor||n.stroke,n["stroke-width"]=i.lineWidth||n["stroke-width"]),n},drawPoints:function(){var t=this,e=t.points,n=t.chart;i(e,function(e){var i,o,r,s,a,l,h,c,d,p,u=e.graphic,g=!u;void 0!==e.plotY&&(u||(e.graphic=u=n.renderer.path().add(t.group)),u.attr(t.pointAttribs(e,e.selected&&"select")).shadow(t.options.shadow),h=u.strokeWidth()%2/2,c=Math.round(e.plotX)-h,i=e.plotOpen,o=e.plotClose,r=Math.min(i,o),s=Math.max(i,o),p=Math.round(e.shapeArgs.width/2),a=Math.round(r)!==Math.round(e.plotHigh),l=s!==e.yBottom,r=Math.round(r)+h,s=Math.round(s)+h,d=[],d.push("M",c-p,s,"L",c-p,r,"L",c+p,r,"L",c+p,s,"Z","M",c,r,"L",c,a?Math.round(e.plotHigh):r,"M",c,s,"L",c,l?Math.round(e.yBottom):s),u[g?"attr":"animate"]({d:d}).addClass(e.getClassName(),!0))})}})}(e);var n=function(t){var e=t.each,i=t.seriesTypes,n=t.stableSort,o={translate:function(){i.column.prototype.translate.apply(this);var t,o,r,s,a,l,h,c=this,d=c.options,p=c.chart,u=c.points,g=u.length-1,f=d.onSeries,m=f&&p.get(f),x=d.onKey||"y",v=m&&m.options.step,y=m&&m.points,b=y&&y.length,k=c.xAxis,M=c.yAxis,w=k.getExtremes(),S=0;if(m&&m.visible&&b)for(S=(m.pointXOffset||0)+(m.barW||0)/2,l=m.currentDataGrouping,s=y[b-1].x+(l?l.totalRange:0),n(u,function(t,e){return t.x-e.x}),x="plot"+x[0].toUpperCase()+x.substr(1);b--&&u[g]&&(r=y[b],t=u[g],t.y=r.y,!(r.x<=t.x&&void 0!==r[x]&&(t.x<=s&&(t.plotY=r[x],r.x<t.x&&!v&&(a=y[b+1],a&&void 0!==a[x]&&(h=(t.x-r.x)/(a.x-r.x),t.plotY+=h*(a[x]-r[x]),t.y+=h*(a.y-r.y)))),g--,b++,0>g))););e(u,function(t,e){var i;void 0===t.plotY&&(t.x>=w.min&&t.x<=w.max?t.plotY=p.chartHeight-k.bottom-(k.opposite?k.height:0)+k.offset-M.top:t.shapeArgs={}),t.plotX+=S,o=u[e-1],o&&o.plotX===t.plotX&&(void 0===o.stackIndex&&(o.stackIndex=0),i=o.stackIndex+1),t.stackIndex=i})}};return o}(e);return function(t,e){function i(t){u[t+"pin"]=function(e,i,n,o,r){var s,a,l=r&&r.anchorX,h=r&&r.anchorY;return"circle"===t&&o>n&&(e-=Math.round((o-n)/2),n=o),s=u[t](e,i,n,o),l&&h&&(a=i>h?i:i+o,s.push("M","circle"===t?s[1]-s[4]:s[1]+s[4]/2,a,"L",l,h),s=s.concat(u.circle(l-1,h-1,2,2))),s}}var n=t.addEvent,o=t.each,r=t.merge,s=t.noop,a=t.Renderer,l=t.Series,h=t.seriesType,c=t.SVGRenderer,d=t.TrackerMixin,p=t.VMLRenderer,u=c.prototype.symbols;h("flags","column",{pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd6eb"}},style:{fontSize:"11px",fontWeight:"bold"}},{sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:l.prototype.init,pointAttribs:function(t,e){var i=this.options,n=t&&t.color||this.color,o=i.lineColor,r=t&&t.lineWidth,s=t&&t.fillColor||i.fillColor;return e&&(s=i.states[e].fillColor,o=i.states[e].lineColor,r=i.states[e].lineWidth),{fill:s||n,stroke:o||n,"stroke-width":r||i.lineWidth||0}},translate:e.translate,drawPoints:function(){var e,i,n,s,a,l,h,c,d,p,u=this,g=u.points,f=u.chart,m=f.renderer,x=u.options,v=x.y,y=u.yAxis,b={},k=[];for(s=g.length;s--;)a=g[s],p=a.plotX>u.xAxis.len,e=a.plotX,h=a.stackIndex,n=a.options.shape||x.shape,i=a.plotY,void 0!==i&&(i=a.plotY+v-(void 0!==h&&h*x.stackDistance)),a.anchorX=h?void 0:a.plotX,c=h?void 0:a.plotY,l=a.graphic,void 0!==i&&e>=0&&!p?(l||(l=a.graphic=m.label("",null,null,n,null,null,x.useHTML).attr(u.pointAttribs(a)).css(r(x.style,a.style)).attr({align:"flag"===n?"left":"center",width:x.width,height:x.height,"text-align":x.textAlign}).addClass("highcharts-point").add(u.markerGroup),a.graphic.div&&(a.graphic.div.point=a),l.shadow(x.shadow),l.isNew=!0),e>0&&(e-=l.strokeWidth()%2),d={y:i,anchorY:c},x.allowOverlapX&&(d.x=e,d.anchorX=a.anchorX),l.attr({text:a.options.title||x.title||"A"})[l.isNew?"attr":"animate"](d),x.allowOverlapX||(b[a.plotX]?b[a.plotX].size=Math.max(b[a.plotX].size,l.width):b[a.plotX]={align:0,size:l.width,target:e,anchorX:e}),a.tooltipPos=f.inverted?[y.len+y.pos-f.plotLeft-i,u.xAxis.len-e]:[e,i+y.pos-f.plotTop]):l&&(a.graphic=l.destroy());x.allowOverlapX||(t.objectEach(b,function(t){t.plotX=t.anchorX,k.push(t)}),t.distribute(k,this.xAxis.len),o(g,function(t){var e=t.graphic&&b[t.plotX];e&&(t.graphic[t.graphic.isNew?"attr":"animate"]({x:e.pos,anchorX:t.anchorX}),t.graphic.isNew=!1)})),x.useHTML&&t.wrap(u.markerGroup,"on",function(e){return t.SVGElement.prototype.on.apply(e.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})},drawTracker:function(){var t=this,e=t.points;d.drawTrackerPoint.apply(this),o(e,function(t){var i=t.graphic;i&&n(i.element,"mouseover",function(){t.stackIndex>0&&!t.raised&&(t._y=i.y,i.attr({y:t._y-8}),t.raised=!0),o(e,function(e){e!==t&&e.raised&&e.graphic&&(e.graphic.attr({y:e._y}),e.raised=!1)})})})},animate:s,buildKDTree:s,setClip:s}),u.flag=function(t,e,i,n,o){var r=o&&o.anchorX||t,s=o&&o.anchorY||e;return u.circle(r-1,s-1,2,2).concat(["M",r,s,"L",t,e+n,t,e,t+i,e,t+i,e+n,t,e+n,"Z"])},i("circle"),i("square"),a===p&&o(["flag","circlepin","squarepin"],function(t){p.prototype.symbols[t]=u[t]})}(e,n),function(t){function e(t,e,i){this.init(t,e,i)}var i,n=t.addEvent,o=t.Axis,r=t.correctFloat,s=t.defaultOptions,a=t.defined,l=t.destroyObjectProperties,h=t.each,c=t.fireEvent,d=t.hasTouch,p=t.isTouchDevice,u=t.merge,g=t.pick,f=t.removeEvent,m=t.svg,x=t.wrap,v={height:p?20:14,barBorderRadius:0,buttonBorderRadius:0,liveRedraw:m&&!p,margin:10,minWidth:6,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:1,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"#333333",trackBackgroundColor:"#f2f2f2",trackBorderColor:"#f2f2f2",trackBorderWidth:1};s.scrollbar=u(!0,v,s.scrollbar),t.swapXY=i=function(t,e){var i,n,o=t.length;if(e)for(i=0;o>i;i+=3)n=t[i+1],t[i+1]=t[i+2],t[i+2]=n;return t},e.prototype={init:function(t,e,i){this.scrollbarButtons=[],this.renderer=t,this.userOptions=e,this.options=u(v,e),this.chart=i,this.size=g(this.options.size,this.options.height),e.enabled&&(this.render(),this.initEvents(),this.addEvents())},render:function(){var t,e=this,n=e.renderer,o=e.options,r=e.size;e.group=t=n.g("scrollbar").attr({zIndex:o.zIndex,translateY:-99999}).add(),e.track=n.rect().addClass("highcharts-scrollbar-track").attr({x:0,r:o.trackBorderRadius||0,height:r,width:r}).add(t),e.track.attr({fill:o.trackBackgroundColor,stroke:o.trackBorderColor,"stroke-width":o.trackBorderWidth}),this.trackBorderWidth=e.track.strokeWidth(),e.track.attr({y:-this.trackBorderWidth%2/2}),e.scrollbarGroup=n.g().add(t),e.scrollbar=n.rect().addClass("highcharts-scrollbar-thumb").attr({height:r,width:r,r:o.barBorderRadius||0}).add(e.scrollbarGroup),e.scrollbarRifles=n.path(i(["M",-3,r/4,"L",-3,2*r/3,"M",0,r/4,"L",0,2*r/3,"M",3,r/4,"L",3,2*r/3],o.vertical)).addClass("highcharts-scrollbar-rifles").add(e.scrollbarGroup),e.scrollbar.attr({fill:o.barBackgroundColor,stroke:o.barBorderColor,"stroke-width":o.barBorderWidth}),e.scrollbarRifles.attr({stroke:o.rifleColor,"stroke-width":1}),e.scrollbarStrokeWidth=e.scrollbar.strokeWidth(),e.scrollbarGroup.translate(-e.scrollbarStrokeWidth%2/2,-e.scrollbarStrokeWidth%2/2),e.drawScrollbarButton(0),e.drawScrollbarButton(1)},position:function(t,e,i,n){var o=this,r=o.options,s=r.vertical,a=n,l=0,h=o.rendered?"animate":"attr";o.x=t,o.y=e+this.trackBorderWidth,o.width=i,o.height=n,o.xOffset=a,o.yOffset=l,s?(o.width=o.yOffset=i=l=o.size,o.xOffset=a=0,o.barWidth=n-2*i,o.x=t+=o.options.margin):(o.height=o.xOffset=n=a=o.size,o.barWidth=i-2*n,o.y=o.y+o.options.margin),o.group[h]({translateX:t,translateY:o.y}),o.track[h]({width:i,height:n}),o.scrollbarButtons[1][h]({translateX:s?0:i-a,translateY:s?n-l:0})},drawScrollbarButton:function(t){var e,n,o=this,r=o.renderer,s=o.scrollbarButtons,a=o.options,l=o.size;e=r.g().add(o.group),s.push(e),n=r.rect().addClass("highcharts-scrollbar-button").add(e),n.attr({stroke:a.buttonBorderColor,"stroke-width":a.buttonBorderWidth,fill:a.buttonBackgroundColor}),n.attr(n.crisp({x:-.5,y:-.5,width:l+1,height:l+1,r:a.buttonBorderRadius},n.strokeWidth())),n=r.path(i(["M",l/2+(t?-1:1),l/2-3,"L",l/2+(t?-1:1),l/2+3,"L",l/2+(t?2:-2),l/2],a.vertical)).addClass("highcharts-scrollbar-arrow").add(s[t]),n.attr({fill:a.buttonArrowColor})},setRange:function(t,e){var i,n,o,s,l,h=this,c=h.options,d=c.vertical,p=c.minWidth,u=h.barWidth,g=this.rendered&&!this.hasDragged?"animate":"attr";a(u)&&(t=Math.max(t,0),i=Math.ceil(u*t),n=u*Math.min(e,1),h.calculatedWidth=s=r(n-i),p>s&&(i=(u-p+s)*t,s=p),o=Math.floor(i+h.xOffset+h.yOffset),l=s/2-.5,h.from=t,h.to=e,d?(h.scrollbarGroup[g]({translateY:o}),h.scrollbar[g]({height:s}),h.scrollbarRifles[g]({translateY:l}),h.scrollbarTop=o,h.scrollbarLeft=0):(h.scrollbarGroup[g]({translateX:o}),h.scrollbar[g]({width:s}),h.scrollbarRifles[g]({translateX:l}),h.scrollbarLeft=o,h.scrollbarTop=0),12>=s?h.scrollbarRifles.hide():h.scrollbarRifles.show(!0),c.showFull===!1&&(0>=t&&e>=1?h.group.hide():h.group.show()),h.rendered=!0)},initEvents:function(){var t=this;t.mouseMoveHandler=function(e){var i,n,o,r=t.chart.pointer.normalize(e),s=t.options,a=s.vertical?"chartY":"chartX",l=t.initPositions;!t.grabbedCenter||e.touches&&0===e.touches[0][a]||(n=t.cursorToScrollbarPosition(r)[a],i=t[a],o=n-i,t.hasDragged=!0,t.updatePosition(l[0]+o,l[1]+o),t.hasDragged&&c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}))},t.mouseUpHandler=function(e){t.hasDragged&&c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMType:e.type,DOMEvent:e}),t.grabbedCenter=t.hasDragged=t.chartX=t.chartY=null},t.mouseDownHandler=function(e){var i=t.chart.pointer.normalize(e),n=t.cursorToScrollbarPosition(i);t.chartX=n.chartX,t.chartY=n.chartY,t.initPositions=[t.from,t.to],t.grabbedCenter=!0},t.buttonToMinClick=function(e){var i=r(t.to-t.from)*t.options.step;t.updatePosition(r(t.from-i),r(t.to-i)),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})},t.buttonToMaxClick=function(e){var i=(t.to-t.from)*t.options.step;t.updatePosition(t.from+i,t.to+i),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})},t.trackClick=function(e){var i=t.chart.pointer.normalize(e),n=t.to-t.from,o=t.y+t.scrollbarTop,r=t.x+t.scrollbarLeft;t.options.vertical&&i.chartY>o||!t.options.vertical&&i.chartX>r?t.updatePosition(t.from+n,t.to+n):t.updatePosition(t.from-n,t.to-n),c(t,"changed",{from:t.from,to:t.to,trigger:"scrollbar",DOMEvent:e})}},cursorToScrollbarPosition:function(t){var e=this,i=e.options,n=i.minWidth>e.calculatedWidth?i.minWidth:0;return{chartX:(t.chartX-e.x-e.xOffset)/(e.barWidth-n),chartY:(t.chartY-e.y-e.yOffset)/(e.barWidth-n)}},updatePosition:function(t,e){e>1&&(t=r(1-r(e-t)),e=1),0>t&&(e=r(e-t),t=0),this.from=t,this.to=e},update:function(t){this.destroy(),this.init(this.chart.renderer,u(!0,this.options,t),this.chart)},addEvents:function(){var t,e=this.options.inverted?[1,0]:[0,1],i=this.scrollbarButtons,o=this.scrollbarGroup.element,r=this.track.element,s=this.mouseDownHandler,a=this.mouseMoveHandler,l=this.mouseUpHandler;t=[[i[e[0]].element,"click",this.buttonToMinClick],[i[e[1]].element,"click",this.buttonToMaxClick],[r,"click",this.trackClick],[o,"mousedown",s],[o.ownerDocument,"mousemove",a],[o.ownerDocument,"mouseup",l]],d&&t.push([o,"touchstart",s],[o.ownerDocument,"touchmove",a],[o.ownerDocument,"touchend",l]),h(t,function(t){n.apply(null,t)}),this._events=t},removeEvents:function(){h(this._events,function(t){f.apply(null,t)}),this._events.length=0},destroy:function(){var t=this.chart.scroller;this.removeEvents(),h(["track","scrollbarRifles","scrollbar","scrollbarGroup","group"],function(t){this[t]&&this[t].destroy&&(this[t]=this[t].destroy())},this),t&&this===t.scrollbar&&(t.scrollbar=null,l(t.scrollbarButtons))}},x(o.prototype,"init",function(t){var i=this;t.apply(i,Array.prototype.slice.call(arguments,1)),i.options.scrollbar&&i.options.scrollbar.enabled&&(i.options.scrollbar.vertical=!i.horiz,i.options.startOnTick=i.options.endOnTick=!1,i.scrollbar=new e(i.chart.renderer,i.options.scrollbar,i.chart),n(i.scrollbar,"changed",function(t){var e,n,o=Math.min(g(i.options.min,i.min),i.min,i.dataMin),r=Math.max(g(i.options.max,i.max),i.max,i.dataMax),s=r-o;i.horiz&&!i.reversed||!i.horiz&&i.reversed?(e=o+s*this.to,n=o+s*this.from):(e=o+s*(1-this.from),n=o+s*(1-this.to)),i.setExtremes(n,e,!0,!1,t)}))}),x(o.prototype,"render",function(t){var e,i,n,o=this,r=Math.min(g(o.options.min,o.min),o.min,g(o.dataMin,o.min)),s=Math.max(g(o.options.max,o.max),o.max,g(o.dataMax,o.max)),l=o.scrollbar,h=o.titleOffset||0;t.apply(o,Array.prototype.slice.call(arguments,1)),l&&(o.horiz?(l.position(o.left,o.top+o.height+2+o.chart.scrollbarsOffsets[1]+(o.opposite?0:h+o.axisTitleMargin+o.offset),o.width,o.height),e=1):(l.position(o.left+o.width+2+o.chart.scrollbarsOffsets[0]+(o.opposite?h+o.axisTitleMargin+o.offset:0),o.top,o.width,o.height),e=0),(!o.opposite&&!o.horiz||o.opposite&&o.horiz)&&(o.chart.scrollbarsOffsets[e]+=o.scrollbar.size+o.scrollbar.options.margin),isNaN(r)||isNaN(s)||!a(o.min)||!a(o.max)?l.setRange(0,0):(i=(o.min-r)/(s-r),n=(o.max-r)/(s-r),o.horiz&&!o.reversed||!o.horiz&&o.reversed?l.setRange(i,n):l.setRange(1-n,1-i)))}),x(o.prototype,"getOffset",function(t){var e=this,i=e.horiz?2:1,n=e.scrollbar;t.apply(e,Array.prototype.slice.call(arguments,1)),n&&(e.chart.scrollbarsOffsets=[0,0],e.chart.axisOffset[i]+=n.size+n.options.margin)}),x(o.prototype,"destroy",function(t){this.scrollbar&&(this.scrollbar=this.scrollbar.destroy()),t.apply(this,Array.prototype.slice.call(arguments,1))}),t.Scrollbar=e}(e),function(t){function e(t){this.init(t)}var i,n=t.addEvent,o=t.Axis,r=t.Chart,s=t.color,a=t.defaultDataGroupingUnits,l=t.defaultOptions,h=t.defined,c=t.destroyObjectProperties,d=t.each,p=t.erase,u=t.error,g=t.extend,f=t.grep,m=t.hasTouch,x=t.isArray,v=t.isNumber,y=t.isObject,b=t.merge,k=t.pick,M=t.removeEvent,w=t.Scrollbar,S=t.Series,A=t.seriesTypes,T=t.wrap,P=[].concat(a),C=function(t){var e=f(arguments,v);return e.length?Math[t].apply(0,e):void 0};P[4]=["day",[1,2,3,4]],P[5]=["week",[1,2,3]],i=void 0===A.areaspline?"line":"areaspline",g(l,{navigator:{height:40,margin:25,maskInside:!0,handles:{width:7,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:s("#6685c2").setOpacity(.3).get(),outlineColor:"#cccccc",outlineWidth:1,series:{type:i,fillOpacity:.05,lineWidth:1,compare:null,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:P},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},pointRange:0,threshold:null},xAxis:{overscroll:0,className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#999999"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}}),t.Renderer.prototype.symbols["navigator-handle"]=function(t,e,i,n,o){var r=o.width/2,s=Math.round(r/3)+.5,a=o.height;return["M",-r-1,.5,"L",r,.5,"L",r,a+.5,"L",-r-1,a+.5,"L",-r-1,.5,"M",-s,4,"L",-s,a-3,"M",s-1,4,"L",s-1,a-3]},e.prototype={drawHandle:function(t,e,i,n){var o=this,r=o.navigatorOptions.handles.height;o.handles[e][n](i?{translateX:Math.round(o.left+o.height/2),translateY:Math.round(o.top+parseInt(t,10)+.5-r)}:{translateX:Math.round(o.left+parseInt(t,10)),translateY:Math.round(o.top+o.height/2-r/2-1)})},drawOutline:function(t,e,i,n){var o,r,s=this,a=s.navigatorOptions.maskInside,l=s.outline.strokeWidth(),h=l/2,c=l%2/2,d=s.outlineHeight,p=s.scrollbarHeight,u=s.size,g=s.left-p,f=s.top;i?(g-=h,o=f+e+c,e=f+t+c,r=["M",g+d,f-p-c,"L",g+d,o,"L",g,o,"L",g,e,"L",g+d,e,"L",g+d,f+u+p].concat(a?["M",g+d,o-h,"L",g+d,e+h]:[])):(t+=g+p-c,e+=g+p-c,f+=h,r=["M",g,f,"L",t,f,"L",t,f+d,"L",e,f+d,"L",e,f,"L",g+u+2*p,f].concat(a?["M",t-h,f,"L",e+h,f]:[])),s.outline[n]({d:r})},drawMasks:function(t,e,i,n){var o,r,s,a,l=this,h=l.left,c=l.top,p=l.height;i?(s=[h,h,h],a=[c,c+t,c+e],r=[p,p,p],o=[t,e-t,l.size-e]):(s=[h,h+t,h+e],a=[c,c,c],r=[t,e-t,l.size-e],o=[p,p,p]),d(l.shades,function(t,e){t[n]({x:s[e],y:a[e],width:r[e],height:o[e]})})},renderElements:function(){var t,e=this,i=e.navigatorOptions,n=i.maskInside,o=e.chart,r=o.inverted,s=o.renderer;e.navigatorGroup=t=s.g("navigator").attr({zIndex:8,visibility:"hidden"}).add();var a={cursor:r?"ns-resize":"ew-resize"};d([!n,n,!n],function(n,o){e.shades[o]=s.rect().addClass("highcharts-navigator-mask"+(1===o?"-inside":"-outside")).attr({fill:n?i.maskFill:"rgba(0,0,0,0)"}).css(1===o&&a).add(t)}),e.outline=s.path().addClass("highcharts-navigator-outline").attr({"stroke-width":i.outlineWidth,stroke:i.outlineColor}).add(t),i.handles.enabled&&d([0,1],function(n){i.handles.inverted=o.inverted,e.handles[n]=s.symbol(i.handles.symbols[n],-i.handles.width/2-1,0,i.handles.width,i.handles.height,i.handles),e.handles[n].attr({zIndex:7-n}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][n]).add(t);var r=i.handles;e.handles[n].attr({fill:r.backgroundColor,stroke:r.borderColor,"stroke-width":r.lineWidth}).css(a)})},update:function(t){d(this.series||[],function(t){t.baseSeries&&delete t.baseSeries.navigatorSeries}),this.destroy();var e=this.chart.options;b(!0,e.navigator,this.options,t),this.init(this.chart)},render:function(e,i,n,o){var r,s,a,l,c,d,p,u,g,f,m=this,x=m.chart,y=m.scrollbarHeight,b=m.xAxis,M=b.fake?x.xAxis[0]:b,w=m.navigatorEnabled,S=m.rendered,A=x.inverted,T=x.xAxis[0].minRange,P=x.xAxis[0].options.maxRange;if(!this.hasDragged||h(n)){if(!v(e)||!v(i)){if(!S)return;n=0,o=k(b.width,M.width)}m.left=k(b.left,x.plotLeft+y+(A?x.plotWidth:0)),m.size=d=l=k(b.len,(A?x.plotHeight:x.plotWidth)-2*y),r=A?y:l+2*y,n=k(n,b.toPixels(e,!0)),o=k(o,b.toPixels(i,!0)),v(n)&&1/0!==Math.abs(n)||(n=0,o=r),u=b.toValue(n,!0),g=b.toValue(o,!0),f=Math.abs(t.correctFloat(g-u)),T>f?this.grabbedLeft?n=b.toPixels(g-T,!0):this.grabbedRight&&(o=b.toPixels(u+T,!0)):h(P)&&f>P&&(this.grabbedLeft?n=b.toPixels(g-P,!0):this.grabbedRight&&(o=b.toPixels(u+P,!0))),m.zoomedMax=Math.min(Math.max(n,o,0),d),m.zoomedMin=Math.min(Math.max(m.fixedWidth?m.zoomedMax-m.fixedWidth:Math.min(n,o),0),d),m.range=m.zoomedMax-m.zoomedMin,d=Math.round(m.zoomedMax),c=Math.round(m.zoomedMin),w&&(m.navigatorGroup.attr({visibility:"visible"}),p=S&&!m.hasDragged?"animate":"attr",m.drawMasks(c,d,A,p),m.drawOutline(c,d,A,p),m.navigatorOptions.handles.enabled&&(m.drawHandle(c,0,A,p),m.drawHandle(d,1,A,p))),m.scrollbar&&(A?(a=m.top-y,s=m.left-y+(w||!M.opposite?0:(M.titleOffset||0)+M.axisTitleMargin),y=l+2*y):(a=m.top+(w?m.height:-y),s=m.left-y),m.scrollbar.position(s,a,r,y),m.scrollbar.setRange(m.zoomedMin/l,m.zoomedMax/l)),m.rendered=!0}},addMouseEvents:function(){var t,e,i=this,o=i.chart,r=o.container,s=[];i.mouseMoveHandler=t=function(t){i.onMouseMove(t)},i.mouseUpHandler=e=function(t){i.onMouseUp(t)},s=i.getPartsEvents("mousedown"),s.push(n(r,"mousemove",t),n(r.ownerDocument,"mouseup",e)),m&&(s.push(n(r,"touchmove",t),n(r.ownerDocument,"touchend",e)),s.concat(i.getPartsEvents("touchstart"))),i.eventsToUnbind=s,i.series&&i.series[0]&&s.push(n(i.series[0].xAxis,"foundExtremes",function(){o.navigator.modifyNavigatorAxisExtremes()}))},getPartsEvents:function(t){var e=this,i=[];return d(["shades","handles"],function(o){d(e[o],function(r,s){i.push(n(r.element,t,function(t){e[o+"Mousedown"](t,s)}))})}),i},shadesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i,n,o,r=this,s=r.chart,a=r.xAxis,l=r.zoomedMin,c=r.left,d=r.size,p=r.range,u=t.chartX;s.inverted&&(u=t.chartY,c=r.top),1===e?(r.grabbedCenter=u,r.fixedWidth=p,r.dragOffset=u-l):(o=u-c-p/2,0===e?o=Math.max(0,o):2===e&&o+p>=d&&(o=d-p,i=r.getUnionExtremes().dataMax),o!==l&&(r.fixedWidth=p,n=a.toFixedRange(o,o+p,null,i),h(n.min)&&s.xAxis[0].setExtremes(Math.min(n.min,n.max),Math.max(n.min,n.max),!0,null,{trigger:"navigator"})))},handlesMousedown:function(t,e){t=this.chart.pointer.normalize(t);var i=this,n=i.chart,o=n.xAxis[0],r=n.inverted&&!o.reversed||!n.inverted&&o.reversed;0===e?(i.grabbedLeft=!0,i.otherHandlePos=i.zoomedMax,i.fixedExtreme=r?o.min:o.max):(i.grabbedRight=!0,i.otherHandlePos=i.zoomedMin,i.fixedExtreme=r?o.max:o.min),n.fixedRange=null},onMouseMove:function(t){var e,i=this,n=i.chart,o=i.left,r=i.navigatorSize,s=i.range,a=i.dragOffset,l=n.inverted;t.touches&&0===t.touches[0].pageX||(t=n.pointer.normalize(t),e=t.chartX,l&&(o=i.top,e=t.chartY),i.grabbedLeft?(i.hasDragged=!0,i.render(0,0,e-o,i.otherHandlePos)):i.grabbedRight?(i.hasDragged=!0,i.render(0,0,i.otherHandlePos,e-o)):i.grabbedCenter&&(i.hasDragged=!0,a>e?e=a:e>r+a-s&&(e=r+a-s),i.render(0,0,e-a,e-a+s)),i.hasDragged&&i.scrollbar&&i.scrollbar.options.liveRedraw&&(t.DOMType=t.type,setTimeout(function(){i.onMouseUp(t)},0)))},onMouseUp:function(t){var e,i,n,o=this,r=o.chart,s=o.xAxis,a=o.scrollbar,l=t.DOMEvent||t;(!o.hasDragged||a&&a.hasDragged)&&"scrollbar"!==t.trigger||(o.zoomedMin===o.otherHandlePos?e=o.fixedExtreme:o.zoomedMax===o.otherHandlePos&&(i=o.fixedExtreme),o.zoomedMax===o.size&&(i=o.getUnionExtremes().dataMax),n=s.toFixedRange(o.zoomedMin,o.zoomedMax,e,i),h(n.min)&&r.xAxis[0].setExtremes(Math.min(n.min,n.max),Math.max(n.min,n.max),!0,o.hasDragged?!1:null,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:l})),"mousemove"!==t.DOMType&&(o.grabbedLeft=o.grabbedRight=o.grabbedCenter=o.fixedWidth=o.fixedExtreme=o.otherHandlePos=o.hasDragged=o.dragOffset=null)},removeEvents:function(){this.eventsToUnbind&&(d(this.eventsToUnbind,function(t){t()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()},removeBaseSeriesEvents:function(){var t=this.baseSeries||[];this.navigatorEnabled&&t[0]&&(this.navigatorOptions.adaptToUpdatedData!==!1&&d(t,function(t){M(t,"updatedData",this.updatedDataHandler)},this),t[0].xAxis&&M(t[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))},init:function(t){var e=t.options,i=e.navigator,r=i.enabled,s=e.scrollbar,a=s.enabled,l=r?i.height:0,h=a?s.height:0;this.handles=[],this.shades=[],this.chart=t,this.setBaseSeries(),this.height=l,this.scrollbarHeight=h,this.scrollbarEnabled=a,this.navigatorEnabled=r,this.navigatorOptions=i,this.scrollbarOptions=s,this.outlineHeight=l+h,this.opposite=k(i.opposite,!r&&t.inverted);var c=this,d=c.baseSeries,p=t.xAxis.length,u=t.yAxis.length,g=d&&d[0]&&d[0].xAxis||t.xAxis[0];t.extraMargin={type:c.opposite?"plotTop":"marginBottom",value:(r||!t.inverted?c.outlineHeight:0)+i.margin},t.inverted&&(t.extraMargin.type=c.opposite?"marginRight":"plotLeft"),t.isDirtyBox=!0,c.navigatorEnabled?(c.xAxis=new o(t,b({breaks:g.options.breaks,ordinal:g.options.ordinal},i.xAxis,{id:"navigator-x-axis",yAxis:"navigator-y-axis",isX:!0,type:"datetime",index:p,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1},t.inverted?{offsets:[h,0,-h,0],width:l}:{offsets:[0,-h,0,h],height:l})),c.yAxis=new o(t,b(i.yAxis,{id:"navigator-y-axis",alignTicks:!1,offset:0,index:u,zoomEnabled:!1},t.inverted?{width:l}:{height:l})),d||i.series.data?c.updateNavigatorSeries():0===t.series.length&&T(t,"redraw",function(e,i){t.series.length>0&&!c.series&&(c.setBaseSeries(),t.redraw=e),e.call(t,i)}),c.renderElements(),c.addMouseEvents()):c.xAxis={translate:function(e,i){var n=t.xAxis[0],o=n.getExtremes(),r=n.len-2*h,s=C("min",n.options.min,o.dataMin),a=C("max",n.options.max,o.dataMax)-s;return i?e*a/r+s:r*(e-s)/a},toPixels:function(t){return this.translate(t)},toValue:function(t){return this.translate(t,!0)},toFixedRange:o.prototype.toFixedRange,fake:!0},t.options.scrollbar.enabled&&(t.scrollbar=c.scrollbar=new w(t.renderer,b(t.options.scrollbar,{margin:c.navigatorEnabled?0:10,vertical:t.inverted}),t),n(c.scrollbar,"changed",function(e){var i=c.size,n=i*this.to,o=i*this.from;c.hasDragged=c.scrollbar.hasDragged,c.render(0,0,o,n),(t.options.scrollbar.liveRedraw||"mousemove"!==e.DOMType)&&setTimeout(function(){c.onMouseUp(e)})})),c.addBaseSeriesEvents(),c.addChartEvents()},getUnionExtremes:function(t){var e,i=this.chart.xAxis[0],n=this.xAxis,o=n.options,r=i.options;return t&&null===i.dataMin||(e={dataMin:k(o&&o.min,C("min",r.min,i.dataMin,n.dataMin,n.min)),dataMax:k(o&&o.max,C("max",r.max,i.dataMax,n.dataMax,n.max))}),e},setBaseSeries:function(t,e){var i=this.chart,n=this.baseSeries=[];t=t||i.options&&i.options.navigator.baseSeries||0,d(i.series||[],function(e,i){e.options.isInternal||!e.options.showInNavigator&&(i!==t&&e.options.id!==t||e.options.showInNavigator===!1)||n.push(e)}),this.xAxis&&!this.xAxis.fake&&this.updateNavigatorSeries(e)},updateNavigatorSeries:function(e){var i,n,o,r=this,s=r.chart,a=r.baseSeries,h=r.navigatorOptions.series,c={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0},p=r.series=t.grep(r.series||[],function(e){var i=e.baseSeries;return t.inArray(i,a)<0?(i&&(M(i,"updatedData",r.updatedDataHandler),delete i.navigatorSeries),e.destroy(),!1):!0});a&&a.length&&d(a,function(t){var d=t.navigatorSeries,u=g({color:t.color},x(h)?l.navigator.series:h);if(!d||r.navigatorOptions.adaptToUpdatedData!==!1){c.name="Navigator "+a.length,i=t.options||{},o=i.navigatorOptions||{},n=b(i,c,u,o);var f=o.data||u.data;r.hasNavigatorData=r.hasNavigatorData||!!f,n.data=f||i.data&&i.data.slice(0),d&&d.options?d.update(n,e):(t.navigatorSeries=s.initSeries(n),t.navigatorSeries.baseSeries=t,p.push(t.navigatorSeries))}}),(h.data&&(!a||!a.length)||x(h))&&(r.hasNavigatorData=!1,h=t.splat(h),d(h,function(t,e){c.name="Navigator "+(p.length+1),n=b(l.navigator.series,{color:s.series[e]&&!s.series[e].options.isInternal&&s.series[e].color||s.options.colors[e]||s.options.colors[0]},c,t),n.data=t.data,n.data&&(r.hasNavigatorData=!0,p.push(s.initSeries(n)))})),this.addBaseSeriesEvents()},addBaseSeriesEvents:function(){var t=this,e=t.baseSeries||[];e[0]&&e[0].xAxis&&n(e[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes),d(e,function(e){n(e,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)}),n(e,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)}),this.navigatorOptions.adaptToUpdatedData!==!1&&e.xAxis&&n(e,"updatedData",this.updatedDataHandler),n(e,"remove",function(){this.navigatorSeries&&(p(t.series,this.navigatorSeries),this.navigatorSeries.remove(!1),delete this.navigatorSeries)})},this)},modifyNavigatorAxisExtremes:function(){var t,e=this.xAxis;e.getExtremes&&(t=this.getUnionExtremes(!0),!t||t.dataMin===e.min&&t.dataMax===e.max||(e.min=t.dataMin,e.max=t.dataMax))},modifyBaseAxisExtremes:function(){var t,e,i=this,n=i.chart.navigator,o=i.getExtremes(),r=o.min,s=o.max,a=o.dataMin,l=o.dataMax,h=s-r,c=n.stickToMin,d=n.stickToMax,p=i.options.overscroll,u=n.series&&n.series[0],g=!!i.setExtremes,f=i.eventArgs&&"rangeSelectorButton"===i.eventArgs.trigger;f||(c&&(e=a,t=e+h),d&&(t=l+p,c||(e=Math.max(t-h,u&&u.xData?u.xData[0]:-Number.MAX_VALUE))),g&&(c||d)&&v(e)&&(i.min=i.userMin=e,i.max=i.userMax=t)),n.stickToMin=n.stickToMax=null},updatedDataHandler:function(){var t=this.chart.navigator,e=this,i=this.navigatorSeries;t.stickToMax=Math.round(t.zoomedMax)>=Math.round(t.size),t.stickToMin=v(e.xAxis.min)&&e.xAxis.min<=e.xData[0]&&(!this.chart.fixedRange||!t.stickToMax),i&&!t.hasNavigatorData&&(i.options.pointStart=e.xData[0],i.setData(e.options.data,!1,null,!1))},addChartEvents:function(){n(this.chart,"redraw",function(){var t=this.navigator,e=t&&(t.baseSeries&&t.baseSeries[0]&&t.baseSeries[0].xAxis||t.scrollbar&&this.xAxis[0]);e&&t.render(e.min,e.max)})},destroy:function(){this.removeEvents(),this.xAxis&&(p(this.chart.xAxis,this.xAxis),p(this.chart.axes,this.xAxis)),this.yAxis&&(p(this.chart.yAxis,this.yAxis),p(this.chart.axes,this.yAxis)),d(this.series||[],function(t){t.destroy&&t.destroy()}),d(["series","xAxis","yAxis","shades","outline","scrollbarTrack","scrollbarRifles","scrollbarGroup","scrollbar","navigatorGroup","rendered"],function(t){this[t]&&this[t].destroy&&this[t].destroy(),this[t]=null},this),d([this.handles],function(t){c(t)},this)}},t.Navigator=e,T(o.prototype,"zoom",function(t,e,i){var n,o,r=this.chart,s=r.options,a=s.chart.zoomType,l=s.navigator,c=s.rangeSelector;return this.isXAxis&&(l&&l.enabled||c&&c.enabled)&&("x"===a?r.resetZoomButton="blocked":"y"===a?o=!1:"xy"===a&&this.options.range&&(n=this.previousZoom,h(e)?this.previousZoom=[this.min,this.max]:n&&(e=n[0],i=n[1],delete this.previousZoom))),void 0!==o?o:t.call(this,e,i)}),T(r.prototype,"init",function(t,i,o){n(this,"beforeRender",function(){var t=this.options;(t.navigator.enabled||t.scrollbar.enabled)&&(this.scroller=this.navigator=new e(this))}),t.call(this,i,o)}),T(r.prototype,"setChartSize",function(t){var e,i,n,o,r=this.legend,s=this.navigator;t.apply(this,[].slice.call(arguments,1)),s&&(i=r&&r.options,n=s.xAxis,o=s.yAxis,e=s.scrollbarHeight,this.inverted?(s.left=s.opposite?this.chartWidth-e-s.height:this.spacing[3]+e,s.top=this.plotTop+e):(s.left=this.plotLeft+e,s.top=s.navigatorOptions.top||this.chartHeight-s.height-e-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(i&&"bottom"===i.verticalAlign&&i.enabled&&!i.floating?r.legendHeight+k(i.margin,10):0)),n&&o&&(this.inverted?n.options.left=o.options.left=s.left:n.options.top=o.options.top=s.top,n.setAxisSize(),o.setAxisSize()))}),T(S.prototype,"addPoint",function(t,e,i,n,o){var r=this.options.turboThreshold;r&&this.xData.length>r&&y(e,!0)&&this.chart.navigator&&u(20,!0),t.call(this,e,i,n,o)}),T(r.prototype,"addSeries",function(t,e,i,n){var o=t.call(this,e,!1,n);return this.navigator&&this.navigator.setBaseSeries(null,!1),k(i,!0)&&this.redraw(),o}),T(S.prototype,"update",function(t,e,i){t.call(this,e,!1),this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1),k(i,!0)&&this.chart.redraw()}),r.prototype.callbacks.push(function(t){var e,i=t.navigator;i&&(e=t.xAxis[0].getExtremes(),i.render(e.min,e.max))})}(e),function(t){function e(t){this.init(t)}var i=t.addEvent,n=t.Axis,o=t.Chart,r=t.css,s=t.createElement,a=t.dateFormat,l=t.defaultOptions,h=l.global.useUTC,c=t.defined,d=t.destroyObjectProperties,p=t.discardElement,u=t.each,g=t.extend,f=t.fireEvent,m=t.Date,x=t.isNumber,v=t.merge,y=t.pick,b=t.pInt,k=t.splat,M=t.wrap;g(l,{rangeSelector:{verticalAlign:"top",buttonTheme:{"stroke-width":0,width:28,height:18,padding:2,zIndex:7},floating:!1,x:0,y:0,height:void 0,inputPosition:{align:"right",x:0,y:0},buttonPosition:{align:"left",x:0,y:0},labelStyle:{color:"#666666"}}}),l.lang=v(l.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"}),e.prototype={clickButton:function(t,e){var o,r,s,a,l,c,d,p=this,g=p.chart,f=p.buttonOptions[t],m=g.xAxis[0],v=g.scroller&&g.scroller.getUnionExtremes()||m||{},b=v.dataMin,M=v.dataMax,w=m&&Math.round(Math.min(m.max,y(M,m.max))),S=f.type,A=f._range,T=f.dataGrouping;if(null!==b&&null!==M){if(g.fixedRange=A,T&&(this.forcedDataGrouping=!0,n.prototype.setDataGrouping.call(m||{chart:this.chart},T,!1)),"month"===S||"year"===S)m?(c={range:f,max:w,dataMin:b,dataMax:M},o=m.minFromRange.call(c),x(c.newMax)&&(w=c.newMax)):A=f;else if(A)o=Math.max(w-A,b),w=Math.min(o+A,M);else if("ytd"===S){if(!m)return void i(g,"beforeRender",function(){p.clickButton(t)});void 0===M&&(b=Number.MAX_VALUE,M=Number.MIN_VALUE,u(g.series,function(t){var e=t.xData;b=Math.min(e[0],b),M=Math.max(e[e.length-1],M)}),e=!1),d=p.getYTDExtremes(M,b,h),o=s=d.min,w=d.max}else"all"===S&&m&&(o=b,w=M);o+=f._offsetMin,w+=f._offsetMax,p.setSelected(t),m?m.setExtremes(o,w,y(e,1),null,{trigger:"rangeSelectorButton",rangeSelectorButton:f}):(r=k(g.options.xAxis)[0],l=r.range,r.range=A,a=r.min,r.min=s,i(g,"load",function(){r.range=l,r.min=a}))}},setSelected:function(t){this.selected=this.options.selected=t},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(t){var e=this,n=t.options.rangeSelector,o=n.buttons||[].concat(e.defaultButtons),r=n.selected,s=function(){var t=e.minInput,i=e.maxInput;t&&t.blur&&f(t,"blur"),i&&i.blur&&f(i,"blur")};e.chart=t,e.options=n,e.buttons=[],t.extraTopMargin=n.height,e.buttonOptions=o,this.unMouseDown=i(t.container,"mousedown",s),this.unResize=i(t,"resize",s),u(o,e.computeButtonRange),void 0!==r&&o[r]&&this.clickButton(r,!1),i(t,"load",function(){t.xAxis&&t.xAxis[0]&&i(t.xAxis[0],"setExtremes",function(i){this.max-this.min!==t.fixedRange&&"rangeSelectorButton"!==i.trigger&&"updatedData"!==i.trigger&&e.forcedDataGrouping&&this.setDataGrouping(!1,!1)})})},updateButtonStates:function(){var t=this,e=this.chart,i=e.xAxis[0],n=Math.round(i.max-i.min),o=!i.hasVisibleSeries,r=864e5,s=e.scroller&&e.scroller.getUnionExtremes()||i,a=s.dataMin,l=s.dataMax,c=t.getYTDExtremes(l,a,h),d=c.min,p=c.max,g=t.selected,f=x(g),m=t.options.allButtonsEnabled,v=t.buttons;u(t.buttonOptions,function(t,e){var s,h,c=t._range,u=t.type,x=t.count||1,y=v[e],b=0,k=t._offsetMax-t._offsetMin,M=e===g,w=c>l-a,S=c<i.minRange,A=!1,T=!1,P=c===n;("month"===u||"year"===u)&&n+36e5>={month:28,year:365}[u]*r*x+k&&n-36e5<={month:31,year:366}[u]*r*x+k?P=!0:"ytd"===u?(P=p-d+k===n,A=!M):"all"===u&&(P=i.max-i.min>=l-a,T=!M&&f&&P),s=!m&&(w||S||T||o),h=M&&P||P&&!f&&!A,s?b=3:h&&(f=!0,b=2),y.state!==b&&y.setState(b)})},computeButtonRange:function(t){var e=t.type,i=t.count||1,n={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};n[e]?t._range=n[e]*i:("month"===e||"year"===e)&&(t._range=24*{month:30,year:365}[e]*36e5*i),t._offsetMin=y(t.offsetMin,0),t._offsetMax=y(t.offsetMax,0),t._range+=t._offsetMax-t._offsetMin},setInputValue:function(t,e){var i=this.chart.options.rangeSelector,n=this[t+"Input"];c(e)&&(n.previousValue=n.HCTime,n.HCTime=e),n.value=a(i.inputEditDateFormat||"%Y-%m-%d",n.HCTime),this[t+"DateBox"].attr({text:a(i.inputDateFormat||"%b %e, %Y",n.HCTime)})},showInput:function(t){var e=this.inputGroup,i=this[t+"DateBox"];r(this[t+"Input"],{left:e.translateX+i.x+"px",top:e.translateY+"px",width:i.width-2+"px",height:i.height-2+"px",border:"2px solid silver"})},hideInput:function(t){r(this[t+"Input"],{border:0,width:"1px",height:"1px"}),this.setInputValue(t)},drawInput:function(t){function e(){var t=i.value,e=(u.inputDateParser||Date.parse)(t),n=c.xAxis[0],o=c.scroller&&c.scroller.xAxis?c.scroller.xAxis:n,r=o.dataMin,s=o.dataMax;e!==i.previousValue&&(i.previousValue=e,x(e)||(e=t.split("-"),e=Date.UTC(b(e[0]),b(e[1])-1,b(e[2]))),x(e)&&(h||(e+=60*(new Date).getTimezoneOffset()*1e3),y?e>a.maxInput.HCTime?e=void 0:r>e&&(e=r):e<a.minInput.HCTime?e=void 0:e>s&&(e=s),void 0!==e&&n.setExtremes(y?e:n.min,y?n.max:e,void 0,void 0,{trigger:"rangeSelectorInput"})))}var i,n,o,a=this,c=a.chart,d=c.renderer.style||{},p=c.renderer,u=c.options.rangeSelector,f=l.lang,m=a.div,y="min"===t,k=this.inputGroup;this[t+"Label"]=n=p.label(f[y?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).addClass("highcharts-range-label").attr({padding:2}).add(k),k.offset+=n.width+5,this[t+"DateBox"]=o=p.label("",k.offset).addClass("highcharts-range-input").attr({padding:2,width:u.inputBoxWidth||90,height:u.inputBoxHeight||17,stroke:u.inputBoxBorderColor||"#cccccc","stroke-width":1,"text-align":"center"}).on("click",function(){a.showInput(t),a[t+"Input"].focus()}).add(k),k.offset+=o.width+(y?10:0),this[t+"Input"]=i=s("input",{name:t,className:"highcharts-range-selector",type:"text"},{top:c.plotTop+"px"},m),n.css(v(d,u.labelStyle)),o.css(v({color:"#333333"},d,u.inputStyle)),r(i,g({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:d.fontSize,fontFamily:d.fontFamily,top:"-9999em"},u.inputStyle)),i.onfocus=function(){a.showInput(t)},i.onblur=function(){a.hideInput(t)},i.onchange=e,i.onkeypress=function(t){13===t.keyCode&&e()}},getPosition:function(){var t=this.chart,e=t.options.rangeSelector,i="top"===e.verticalAlign?t.plotTop-t.axisOffset[0]:0;return{buttonTop:i+e.buttonPosition.y,inputTop:i+e.inputPosition.y-10}},getYTDExtremes:function(t,e,i){var n,o=new m(t),r=o[m.hcGetFullYear](),s=i?m.UTC(r,0,1):+new m(r,0,1);return n=Math.max(e||0,s),o=o.getTime(),{max:Math.min(t||o,o),min:n}},render:function(t,e){var i,n,o,r,a,h,c,d=this,p=d.chart,g=p.renderer,f=p.container,m=p.options,x=m.exporting&&m.exporting.enabled!==!1&&m.navigation&&m.navigation.buttonOptions,v=l.lang,b=d.div,k=m.rangeSelector,M=k.floating,w=d.buttons,S=d.inputGroup,A=k.buttonTheme,T=k.buttonPosition,P=k.inputPosition,C=k.inputEnabled,L=A&&A.states,O=p.plotLeft,D=d.buttonGroup,I=d.rendered,B=d.options.verticalAlign,z=p.legend,E=z&&z.options,R=T.y,G=P.y,X=I||!1,W=0,H=0;if(k.enabled!==!1){if(I||(d.group=n=g.g("range-selector-group").attr({zIndex:7}).add(),d.buttonGroup=D=g.g("range-selector-buttons").add(n),d.zoomText=g.text(v.rangeSelectorZoom,y(O+T.x,O),15).css(k.labelStyle).add(D),i=y(O+T.x,O)+d.zoomText.getBBox().width+5,u(d.buttonOptions,function(t,e){w[e]=g.button(t.text,i,0,function(){var i,n=t.events&&t.events.click;n&&(i=n.call(t)),i!==!1&&d.clickButton(e),d.isActive=!0},A,L&&L.hover,L&&L.select,L&&L.disabled).attr({"text-align":"center"}).add(D),i+=w[e].width+y(k.buttonSpacing,5)}),C!==!1&&(d.div=b=s("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(b,f),d.inputGroup=S=g.g("input-group").add(n),S.offset=0,d.drawInput("min"),d.drawInput("max"))),O=p.plotLeft-p.spacing[3],d.updateButtonStates(),x&&this.titleCollision(p)&&"top"===B&&"right"===T.align&&T.y+D.getBBox().height-12<(x.y||0)+x.height&&(W=-40),"left"===T.align?c=T.x-p.spacing[3]:"right"===T.align&&(c=T.x+W-p.spacing[1]),D.align({y:T.y,width:D.getBBox().width,align:T.align,x:c},!0,p.spacingBox),d.group.placed=X,d.buttonGroup.placed=X,C!==!1){var N,Y,F,j;W=x&&this.titleCollision(p)&&"top"===B&&"right"===P.align&&P.y-S.getBBox().height-12<(x.y||0)+x.height+p.spacing[0]?-40:0,"left"===P.align?c=O:"right"===P.align&&(c=-Math.max(p.axisOffset[1],-W)),S.align({y:P.y,width:S.getBBox().width,align:P.align,x:P.x+c-2},!0,p.spacingBox),N=S.alignAttr.translateX+S.alignOptions.x-W+S.getBBox().x+2,Y=S.alignOptions.width,F=D.alignAttr.translateX+D.getBBox().x,j=D.getBBox().width+20,(P.align===T.align||F+j>N&&N+Y>F&&R<G+S.getBBox().height)&&S.attr({translateX:S.alignAttr.translateX+(p.axisOffset[1]>=-W?0:-W),translateY:S.alignAttr.translateY+D.getBBox().height+10}),d.setInputValue("min",t),d.setInputValue("max",e),d.inputGroup.placed=X}d.group.align({verticalAlign:B},!0,p.spacingBox),o=d.group.getBBox().height+20,r=d.group.alignAttr.translateY,"bottom"===B&&(a=E&&"bottom"===E.verticalAlign&&E.enabled&&!E.floating?z.legendHeight+y(E.margin,10):0,o=o+a-20,H=r-o-(M?0:k.y)-10),"top"===B?(M&&(H=0),p.titleOffset&&(H=p.titleOffset+p.options.title.margin),H+=p.margin[0]-p.spacing[0]||0):"middle"===B&&(G===R?H=0>G?r+h:r:(G||R)&&(0>G||0>R?H-=Math.min(G,R):H=r-o+h)),d.group.translate(k.x,k.y+Math.floor(H)),C!==!1&&(d.minInput.style.marginTop=d.group.translateY+"px",d.maxInput.style.marginTop=d.group.translateY+"px"),d.rendered=!0}},getHeight:function(){var t,e=this,i=e.options,n=e.group,o=i.inputPosition,r=i.buttonPosition,s=i.y,a=r.y,l=o.y,h=0;return h=n?n.getBBox(!0).height+13+s:0,t=Math.min(l,a),(0>l&&0>a||l>0&&a>0)&&(h+=Math.abs(t)),h},titleCollision:function(t){return!(t.options.title.text||t.options.subtitle.text)},update:function(t){var e=this.chart;v(!0,e.options.rangeSelector,t),this.destroy(),this.init(e),e.rangeSelector.render()},destroy:function(){var i=this,n=i.minInput,o=i.maxInput;i.unMouseDown(),i.unResize(),d(i.buttons),n&&(n.onfocus=n.onblur=n.onchange=null),o&&(o.onfocus=o.onblur=o.onchange=null),t.objectEach(i,function(t,n){t&&"chart"!==n&&(t.destroy?t.destroy():t.nodeType&&p(this[n])),t!==e.prototype[n]&&(i[n]=null)},this)}},n.prototype.toFixedRange=function(t,e,i,n){var o=this.chart&&this.chart.fixedRange,r=y(i,this.translate(t,!0,!this.horiz)),s=y(n,this.translate(e,!0,!this.horiz)),a=o&&(s-r)/o;return a>.7&&1.3>a&&(n?r=s-o:s=r+o),x(r)&&x(s)||(r=s=void 0),{min:r,max:s}},n.prototype.minFromRange=function(){var t,e,i,n=this.range,o=n.type,r={month:"Month",year:"FullYear"}[o],s=this.max,a=function(t,e){var i=new Date(t),n=i["get"+r]();return i["set"+r](n+e),n===i["get"+r]()&&i.setDate(0),i.getTime()-t};return x(n)?(t=s-n,i=n):(t=s+a(s,-n.count),this.chart&&(this.chart.fixedRange=s-t)),e=y(this.dataMin,Number.MIN_VALUE),x(t)||(t=e),e>=t&&(t=e,void 0===i&&(i=a(t,n.count)),this.newMax=Math.min(t+i,this.dataMax)),x(s)||(t=void 0),t},M(o.prototype,"init",function(t,n,o){i(this,"init",function(){this.options.rangeSelector.enabled&&(this.rangeSelector=new e(this))}),t.call(this,n,o)}),M(o.prototype,"render",function(t,e,i){var n,o=this,r=o.axes,s=o.rangeSelector;s&&(u(r,function(t){t.updateNames(),t.setScale()}),o.getAxisMargins(),s.render(),n=s.options.verticalAlign,s.options.floating||("bottom"===n?this.extraBottomMargin=!0:"middle"!==n&&(this.extraTopMargin=!0))),t.call(this,e,i)}),M(o.prototype,"update",function(e,i,n,o){var r,s=this,a=s.rangeSelector;this.extraBottomMargin=!1,this.extraTopMargin=!1,a&&(a.render(),r=i.rangeSelector&&i.rangeSelector.verticalAlign||a.options&&a.options.verticalAlign,a.options.floating||("bottom"===r?this.extraBottomMargin=!0:"middle"!==r&&(this.extraTopMargin=!0))),e.call(this,t.merge(!0,i,{chart:{marginBottom:y(i.chart&&i.chart.marginBottom,s.margin.bottom),spacingBottom:y(i.chart&&i.chart.spacingBottom,s.spacing.bottom)}}),n,o)}),M(o.prototype,"redraw",function(t,e,i){var n,o=this,r=o.rangeSelector;r&&!r.options.floating&&(r.render(),n=r.options.verticalAlign,"bottom"===n?this.extraBottomMargin=!0:"middle"!==n&&(this.extraTopMargin=!0)),t.call(this,e,i)}),o.prototype.adjustPlotArea=function(){var t,e=this,i=e.rangeSelector;this.rangeSelector&&(t=i.getHeight(),this.extraTopMargin&&(this.plotTop+=t),this.extraBottomMargin&&(this.marginBottom+=t))},o.prototype.callbacks.push(function(t){function e(){n=t.xAxis[0].getExtremes(),x(n.min)&&s.render(n.min,n.max)}var n,o,r,s=t.rangeSelector;s&&(r=i(t.xAxis[0],"afterSetExtremes",function(t){s.render(t.min,t.max)}),o=i(t,"redraw",e),e()),i(t,"destroy",function(){s&&(o(),r())})}),t.RangeSelector=e}(e),function(t){var e=t.arrayMax,i=t.arrayMin,n=t.Axis,o=t.Chart,r=t.defined,s=t.each,a=t.extend,l=t.format,h=t.grep,c=t.inArray,d=t.isNumber,p=t.isString,u=t.map,g=t.merge,f=t.pick,m=t.Point,x=t.Renderer,v=t.Series,y=t.splat,b=t.SVGRenderer,k=t.VMLRenderer,M=t.wrap,w=v.prototype,S=w.init,A=w.processData,T=m.prototype.tooltipFormatter;t.StockChart=t.stockChart=function(e,i,n){var r,s=p(e)||e.nodeName,a=arguments[s?1:0],l=a.series,h=t.getOptions(),c=f(a.navigator&&a.navigator.enabled,h.navigator.enabled,!0),d=c?{startOnTick:!1,endOnTick:!1}:null,m={marker:{enabled:!1,radius:2}},x={shadow:!1,borderWidth:0};return a.xAxis=u(y(a.xAxis||{}),function(t){return g({minPadding:0,maxPadding:0,overscroll:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},h.xAxis,t,{type:"datetime",categories:null},d)}),a.yAxis=u(y(a.yAxis||{}),function(t){return r=f(t.opposite,!0),g({labels:{y:-2},opposite:r,showLastLabel:!1,title:{text:null}},h.yAxis,t)}),a.series=null,a=g({chart:{panning:!0,pinchType:"x"},navigator:{enabled:c},scrollbar:{enabled:f(h.scrollbar.enabled,!0)},rangeSelector:{enabled:f(h.rangeSelector.enabled,!0)},title:{text:null},tooltip:{split:f(h.tooltip.split,!0),crosshairs:!0},legend:{enabled:!1},plotOptions:{line:m,spline:m,area:m,areaspline:m,arearange:m,areasplinerange:m,column:x,columnrange:x,candlestick:x,ohlc:x}},a,{isStock:!0}),a.series=l,s?new o(e,a,n):new o(a,i)},M(n.prototype,"autoLabelAlign",function(t){var e,i=this.chart,n=this.options,o=i._labelPanes=i._labelPanes||{},r=this.options.labels;return this.chart.options.isStock&&"yAxis"===this.coll&&(e=n.top+","+n.height,!o[e]&&r.enabled)?(15===r.x&&(r.x=0),void 0===r.align&&(r.align="right"),o[e]=this,"right"):t.apply(this,[].slice.call(arguments,1))}),M(n.prototype,"destroy",function(t){var e=this.chart,i=this.options&&this.options.top+","+this.options.height;return i&&e._labelPanes&&e._labelPanes[i]===this&&delete e._labelPanes[i],t.apply(this,Array.prototype.slice.call(arguments,1))}),M(n.prototype,"getPlotLinePath",function(e,i,n,o,a,l){function h(t){var e="xAxis"===t?"yAxis":"xAxis",i=M.options[e];return d(i)?[S[e][i]]:p(i)?[S.get(i)]:u(w,function(t){return t[e]})}var g,m,x,v,y,b,k,M=this,w=this.isLinked&&!this.series?this.linkedParent.series:this.series,S=M.chart,A=S.renderer,T=M.left,P=M.top,C=[],L=[];return"xAxis"!==M.coll&&"yAxis"!==M.coll?e.apply(this,[].slice.call(arguments,1)):(L=h(M.coll),y=M.isXAxis?S.yAxis:S.xAxis,s(y,function(t){if(r(t.options.id)?-1===t.options.id.indexOf("navigator"):!0){var e=t.isXAxis?"yAxis":"xAxis",i=r(t.options[e])?S[e][t.options[e]]:S[e][0];M===i&&L.push(t)}}),b=L.length?[]:[M.isXAxis?S.yAxis[0]:S.xAxis[0]],s(L,function(e){-1!==c(e,b)||t.find(b,function(t){return t.pos===e.pos&&t.len&&e.len})||b.push(e)}),k=f(l,M.translate(i,null,null,o)),d(k)&&(M.horiz?s(b,function(t){var e;m=t.pos,v=m+t.len,g=x=Math.round(k+M.transB),(T>g||g>T+M.width)&&(a?g=x=Math.min(Math.max(T,g),T+M.width):e=!0),e||C.push("M",g,m,"L",x,v)}):s(b,function(t){var e;g=t.pos,x=g+t.len,m=v=Math.round(P+M.height-k),(P>m||m>P+M.height)&&(a?m=v=Math.min(Math.max(P,m),M.top+M.height):e=!0),e||C.push("M",g,m,"L",x,v)})),C.length>0?A.crispPolyLine(C,n||1):null)}),b.prototype.crispPolyLine=function(t,e){var i;for(i=0;i<t.length;i+=6)t[i+1]===t[i+4]&&(t[i+1]=t[i+4]=Math.round(t[i+1])-e%2/2),t[i+2]===t[i+5]&&(t[i+2]=t[i+5]=Math.round(t[i+2])+e%2/2);return t},x===k&&(k.prototype.crispPolyLine=b.prototype.crispPolyLine),M(n.prototype,"hideCrosshair",function(t,e){t.call(this,e),this.crossLabel&&(this.crossLabel=this.crossLabel.hide())}),M(n.prototype,"drawCrosshair",function(t,e,i){if(t.call(this,e,i),r(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){var n,o,s,h,c,d,p=this.chart,u=this.options.crosshair.label,g=this.horiz,m=this.opposite,x=this.left,v=this.top,y=this.crossLabel,b=u.format,k="",M="inside"===this.options.tickPosition,w=this.crosshair.snap!==!1,S=0;e||(e=this.cross&&this.cross.e),c=g?"center":m?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",y||(y=this.crossLabel=p.renderer.label(null,null,null,u.shape||"callout").addClass("highcharts-crosshair-label"+(this.series[0]&&" highcharts-color-"+this.series[0].colorIndex)).attr({align:u.align||c,padding:f(u.padding,8),r:f(u.borderRadius,3),zIndex:2}).add(this.labelGroup),y.attr({fill:u.backgroundColor||this.series[0]&&this.series[0].color||"#666666",stroke:u.borderColor||"","stroke-width":u.borderWidth||0}).css(a({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},u.style))),g?(n=w?i.plotX+x:e.chartX,o=v+(m?0:this.height)):(n=m?this.width+x:0,o=w?i.plotY+v:e.chartY),b||u.formatter||(this.isDatetimeAxis&&(k="%b %d, %Y"),b="{value"+(k?":"+k:"")+"}"),d=w?i[this.isXAxis?"x":"y"]:this.toValue(g?e.chartX:e.chartY),y.attr({text:b?l(b,{value:d}):u.formatter.call(this,d),x:n,y:o,visibility:"visible"}),s=y.getBBox(),g?(M&&!m||!M&&m)&&(o=y.y-s.height):o=y.y-s.height/2,h=g?{left:x-s.x,right:x+this.width-s.x}:{left:"left"===this.labelAlign?x:0,right:"right"===this.labelAlign?x+this.width:p.chartWidth},y.translateX<h.left&&(S=h.left-y.translateX),y.translateX+s.width>=h.right&&(S=-(y.translateX+s.width-h.right)),y.attr({x:n+S,y:o,anchorX:g?n:this.opposite?0:p.chartWidth,anchorY:g?this.opposite?p.chartHeight:0:o+s.height/2})}}),w.init=function(){S.apply(this,arguments),this.setCompare(this.options.compare)},w.setCompare=function(t){this.modifyValue="value"===t||"percent"===t?function(e,i){var n=this.compareValue;return void 0!==e&&void 0!==n?("value"===t?e-=n:e=100*(e/n)-(100===this.options.compareBase?0:100),i&&(i.change=e),e):void 0}:null,this.userOptions.compare=t,this.chart.hasRendered&&(this.isDirty=!0)},w.processData=function(){var t,e,i,n,o,r=this,s=-1,a=r.options.compareStart===!0?0:1;if(A.apply(this,arguments),r.xAxis&&r.processedYData)for(e=r.processedXData,i=r.processedYData,n=i.length,r.pointArrayMap&&(s=c("close",r.pointArrayMap),-1===s&&(s=c(r.pointValKey||"y",r.pointArrayMap))),t=0;n-a>t;t++)if(o=i[t]&&s>-1?i[t][s]:i[t],d(o)&&e[t+a]>=r.xAxis.min&&0!==o){r.compareValue=o;break}},M(w,"getExtremes",function(t){var n;t.apply(this,[].slice.call(arguments,1)),this.modifyValue&&(n=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=i(n),this.dataMax=e(n))}),n.prototype.setCompare=function(t,e){this.isXAxis||(s(this.series,function(e){e.setCompare(t)}),f(e,!0)&&this.chart.redraw())},m.prototype.tooltipFormatter=function(e){var i=this;return e=e.replace("{point.change}",(i.change>0?"+":"")+t.numberFormat(i.change,f(i.series.tooltipOptions.changeDecimals,2))),T.apply(this,[e])},M(v.prototype,"render",function(t){this.chart.is3d&&this.chart.is3d()||this.chart.polar||!this.xAxis||this.xAxis.isRadial||(!this.clipBox&&this.animate?(this.clipBox=g(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]?this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}):this.clipBox&&(this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len)),t.call(this)}),M(o.prototype,"getSelectedPoints",function(t){var e=t.call(this);return s(this.series,function(t){t.hasGroupedData&&(e=e.concat(h(t.points||[],function(t){return t.selected})))}),e}),M(o.prototype,"update",function(t,e){return"scrollbar"in e&&this.navigator&&(g(!0,this.options.scrollbar,e.scrollbar),this.navigator.update({},!1),delete e.scrollbar),t.apply(this,Array.prototype.slice.call(arguments,1))})}(e),e});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(t){function e(t,e,i,s){return{x:s.cosB*t-s.sinB*i,y:-s.sinA*s.sinB*t+s.cosA*e-s.cosB*s.sinA*i,z:s.cosA*s.sinB*t+s.sinA*e+s.cosA*s.cosB*i}}function i(t,e,i){var s=i>0&&i<Number.POSITIVE_INFINITY?i/(t.z+e.z+i):1;return{x:t.x*s,y:t.y*s}}var s=t.deg2rad,o=t.pick;t.perspective=function(r,a,n){var l=a.options.chart.options3d,h=n?a.inverted:!1,p={x:a.plotWidth/2,y:a.plotHeight/2,z:l.depth/2,vd:o(l.depth,1)*o(l.viewDistance,0)},c=a.scale3d||1,y=s*l.beta*(h?-1:1),x=s*l.alpha*(h?-1:1),d={cosA:Math.cos(x),cosB:Math.cos(-y),sinA:Math.sin(x),sinB:Math.sin(-y)};return n||(p.x+=a.plotLeft,p.y+=a.plotTop),t.map(r,function(t){var s=e((h?t.y:t.x)-p.x,(h?t.x:t.y)-p.y,(t.z||0)-p.z,d),o=i(s,p,p.vd);return o.x=o.x*c+p.x,o.y=o.y*c+p.y,o.z=s.z*c+p.z,{x:h?o.y:o.x,y:h?o.x:o.y,z:o.z}})},t.pointCameraDistance=function(t,e){var i=e.options.chart.options3d,s={x:e.plotWidth/2,y:e.plotHeight/2,z:o(i.depth,1)*o(i.viewDistance,0)+i.depth},r=Math.sqrt(Math.pow(s.x-t.plotX,2)+Math.pow(s.y-t.plotY,2)+Math.pow(s.z-t.plotZ,2));return r},t.shapeArea=function(t){var e,i,s=0;for(e=0;e<t.length;e++)i=(e+1)%t.length,s+=t[e].x*t[i].y-t[i].x*t[e].y;return s/2},t.shapeArea3d=function(e,i,s){return t.shapeArea(t.perspective(e,i,s))}}(t),function(t){function e(t,i,s,o,r,a,n,l){var h=[],p=a-r;return a>r&&a-r>Math.PI/2+1e-4?(h=h.concat(e(t,i,s,o,r,r+Math.PI/2,n,l)),h=h.concat(e(t,i,s,o,r+Math.PI/2,a,n,l))):r>a&&r-a>Math.PI/2+1e-4?(h=h.concat(e(t,i,s,o,r,r-Math.PI/2,n,l)),h=h.concat(e(t,i,s,o,r-Math.PI/2,a,n,l))):["C",t+s*Math.cos(r)-s*v*p*Math.sin(r)+n,i+o*Math.sin(r)+o*v*p*Math.cos(r)+l,t+s*Math.cos(a)+s*v*p*Math.sin(a)+n,i+o*Math.sin(a)-o*v*p*Math.cos(a)+l,t+s*Math.cos(a)+n,i+o*Math.sin(a)+l]}var i=Math.cos,s=Math.PI,o=Math.sin,r=t.animObject,a=t.charts,n=t.color,l=t.defined,h=t.deg2rad,p=t.each,c=t.extend,y=t.inArray,x=t.map,d=t.merge,f=t.perspective,u=t.pick,z=t.SVGElement,b=t.SVGRenderer,g=t.wrap,v=4*(Math.sqrt(2)-1)/3/(s/2);b.prototype.toLinePath=function(t,e){var i=[];return p(t,function(t){i.push("L",t.x,t.y)}),t.length&&(i[0]="M",e&&i.push("Z")),i},b.prototype.toLineSegments=function(t){var e=[],i=!0;return p(t,function(t){e.push(i?"M":"L",t.x,t.y),i=!i}),e},b.prototype.face3d=function(e){var i=this,s=this.createElement("path");return s.vertexes=[],s.insidePlotArea=!1,s.enabled=!0,g(s,"attr",function(e,s){if("object"==typeof s&&(l(s.enabled)||l(s.vertexes)||l(s.insidePlotArea))){this.enabled=u(s.enabled,this.enabled),this.vertexes=u(s.vertexes,this.vertexes),this.insidePlotArea=u(s.insidePlotArea,this.insidePlotArea),delete s.enabled,delete s.vertexes,delete s.insidePlotArea;var o=a[i.chartIndex],r=f(this.vertexes,o,this.insidePlotArea),n=i.toLinePath(r,!0),h=t.shapeArea(r),p=this.enabled&&h>0?"visible":"hidden";s.d=n,s.visibility=p}return e.apply(this,[].slice.call(arguments,1))}),g(s,"animate",function(e,s){if("object"==typeof s&&(l(s.enabled)||l(s.vertexes)||l(s.insidePlotArea))){this.enabled=u(s.enabled,this.enabled),this.vertexes=u(s.vertexes,this.vertexes),this.insidePlotArea=u(s.insidePlotArea,this.insidePlotArea),delete s.enabled,delete s.vertexes,delete s.insidePlotArea;var o=a[i.chartIndex],r=f(this.vertexes,o,this.insidePlotArea),n=i.toLinePath(r,!0),h=t.shapeArea(r),p=this.enabled&&h>0?"visible":"hidden";s.d=n,this.attr("visibility",p)}return e.apply(this,[].slice.call(arguments,1))}),s.attr(e)},b.prototype.polyhedron=function(t){var e=this,i=this.g(),s=i.destroy;return i.attr({"stroke-linejoin":"round"}),i.faces=[],i.destroy=function(){for(var t=0;t<i.faces.length;t++)i.faces[t].destroy();return s.call(this)},g(i,"attr",function(t,s,o,r,a){if("object"==typeof s&&l(s.faces)){for(;i.faces.length>s.faces.length;)i.faces.pop().destroy();for(;i.faces.length<s.faces.length;)i.faces.push(e.face3d().add(i));for(var n=0;n<s.faces.length;n++)i.faces[n].attr(s.faces[n],null,r,a);delete s.faces}return t.apply(this,[].slice.call(arguments,1))}),g(i,"animate",function(t,s,o,r){if(s&&s.faces){for(;i.faces.length>s.faces.length;)i.faces.pop().destroy();for(;i.faces.length<s.faces.length;)i.faces.push(e.face3d().add(i));for(var a=0;a<s.faces.length;a++)i.faces[a].animate(s.faces[a],o,r);delete s.faces}return t.apply(this,[].slice.call(arguments,1))}),i.attr(t)},b.prototype.cuboid=function(t){var e=this.g(),i=e.destroy,s=this.cuboidPath(t);return e.attr({"stroke-linejoin":"round"}),e.front=this.path(s[0]).attr({class:"highcharts-3d-front"}).add(e),e.top=this.path(s[1]).attr({class:"highcharts-3d-top"}).add(e),e.side=this.path(s[2]).attr({class:"highcharts-3d-side"}).add(e),e.fillSetter=function(t){return this.front.attr({fill:t}),this.top.attr({fill:n(t).brighten(.1).get()}),this.side.attr({fill:n(t).brighten(-.1).get()}),this.color=t,e.fill=t,this},e.opacitySetter=function(t){return this.front.attr({opacity:t}),this.top.attr({opacity:t}),this.side.attr({opacity:t}),this},e.attr=function(t,e,i,s){if("string"==typeof t&&"undefined"!=typeof e){var o=t;t={},t[o]=e}if(!t.shapeArgs&&!l(t.x))return z.prototype.attr.call(this,t,void 0,i,s);var r=t.shapeArgs||t,a=this.renderer.cuboidPath(r);return this.front.attr({d:a[0]}),this.top.attr({d:a[1]}),this.side.attr({d:a[2]}),this},e.animate=function(t,e,i){if(l(t.x)&&l(t.y)){var s=this.renderer.cuboidPath(t);this.front.animate({d:s[0]},e,i),this.top.animate({d:s[1]},e,i),this.side.animate({d:s[2]},e,i),this.attr({zIndex:-s[3]})}else t.opacity?(this.front.animate(t,e,i),this.top.animate(t,e,i),this.side.animate(t,e,i)):z.prototype.animate.call(this,t,e,i);return this},e.destroy=function(){return this.front.destroy(),this.top.destroy(),this.side.destroy(),i.call(this)},e.attr({zIndex:-s[3]}),e},t.SVGRenderer.prototype.cuboidPath=function(e){function i(t){return Y[t]}var s,o,r,n,l,h,p,c,y,d,u,z,b,g=e.x,v=e.y,m=e.z,M=e.height,A=e.width,P=e.depth,k=a[this.chartIndex],L=k.options.chart.options3d,S=L.alpha,I=1e4,w=10,D=100,F=0,Y=[{x:g,y:v,z:m},{x:g+A,y:v,z:m},{x:g+A,y:v+M,z:m},{x:g,y:v+M,z:m},{x:g,y:v+M,z:m+P},{x:g+A,y:v+M,z:m+P},{x:g+A,y:v,z:m+P},{x:g,y:v,z:m+P}];Y=f(Y,k,e.insidePlotArea);var X=function(e,s){var o=[[],-1];return e=x(e,i),s=x(s,i),t.shapeArea(e)<0?o=[e,0]:t.shapeArea(s)<0&&(o=[s,1]),o};return s=[3,2,1,0],o=[7,6,5,4],p=X(s,o),c=p[0],u=p[1],r=[1,6,7,0],n=[4,5,2,3],p=X(r,n),y=p[0],z=p[1],h=[1,2,5,6],l=[0,7,4,3],p=X(h,l),d=p[0],b=p[1],1===b?F+=I*(1e3-g):b||(F+=I*g),F+=w*(!z||S>=0&&180>=S||360>S&&S>357.5?k.plotHeight-v:10+v),1===u?F+=D*m:u||(F+=D*(1e3-m)),F=-Math.round(F),[this.toLinePath(c,!0),this.toLinePath(y,!0),this.toLinePath(d,!0),F]},t.SVGRenderer.prototype.arc3d=function(t){function e(t){var e=!1,i={};t=d(t);for(var s in t)-1!==y(s,o)&&(i[s]=t[s],delete t[s],e=!0);return e?i:!1}var i=this.g(),s=i.renderer,o=["x","y","r","innerR","start","end"];return t=d(t),t.alpha*=h,t.beta*=h,i.top=s.path(),i.side1=s.path(),i.side2=s.path(),i.inn=s.path(),i.out=s.path(),i.onAdd=function(){var t=i.parentGroup,e=i.attr("class");i.top.add(i),p(["out","inn","side1","side2"],function(s){i[s].attr({class:e+" highcharts-3d-side"}).add(t)})},p(["addClass","removeClass"],function(t){i[t]=function(){var e=arguments;p(["top","out","inn","side1","side2"],function(s){i[s][t].apply(i[s],e)})}}),i.setPaths=function(t){var e=i.renderer.arc3dPath(t),s=100*e.zTop;i.attribs=t,i.top.attr({d:e.top,zIndex:e.zTop}),i.inn.attr({d:e.inn,zIndex:e.zInn}),i.out.attr({d:e.out,zIndex:e.zOut}),i.side1.attr({d:e.side1,zIndex:e.zSide1}),i.side2.attr({d:e.side2,zIndex:e.zSide2}),i.zIndex=s,i.attr({zIndex:s}),t.center&&(i.top.setRadialReference(t.center),delete t.center)},i.setPaths(t),i.fillSetter=function(t){var e=n(t).brighten(-.1).get();return this.fill=t,this.side1.attr({fill:e}),this.side2.attr({fill:e}),this.inn.attr({fill:e}),this.out.attr({fill:e}),this.top.attr({fill:t}),this},p(["opacity","translateX","translateY","visibility"],function(t){i[t+"Setter"]=function(t,e){i[e]=t,p(["out","inn","side1","side2","top"],function(s){i[s].attr(e,t)})}}),g(i,"attr",function(t,s){var o;return"object"==typeof s&&(o=e(s),o&&(c(i.attribs,o),i.setPaths(i.attribs))),t.apply(this,[].slice.call(arguments,1))}),g(i,"animate",function(t,s,o,a){var n,l,h,p=this.attribs;return delete s.center,delete s.z,delete s.depth,delete s.alpha,delete s.beta,h=r(u(o,this.renderer.globalAnimation)),h.duration&&(n=e(s),s.dummy=i.dummy++,n&&(l=n,h.step=function(t,e){function i(t){return p[t]+(u(l[t],p[t])-p[t])*e.pos}"dummy"===e.prop&&e.elem.setPaths(d(p,{x:i("x"),y:i("y"),r:i("r"),innerR:i("innerR"),start:i("start"),end:i("end")}))}),o=h),t.call(this,s,o,a)}),i.dummy=0,i.destroy=function(){this.top.destroy(),this.out.destroy(),this.inn.destroy(),this.side1.destroy(),this.side2.destroy(),z.prototype.destroy.call(this)},i.hide=function(){this.top.hide(),this.out.hide(),this.inn.hide(),this.side1.hide(),this.side2.hide()},i.show=function(){this.top.show(),this.out.show(),this.inn.show(),this.side1.show(),this.side2.show()},i},b.prototype.arc3dPath=function(t){function r(t){return t%=2*Math.PI,t>Math.PI&&(t=2*Math.PI-t),t}var a=t.x,n=t.y,l=t.start,h=t.end-1e-5,p=t.r,c=t.innerR,y=t.depth,x=t.alpha,d=t.beta,f=Math.cos(l),u=Math.sin(l),z=Math.cos(h),b=Math.sin(h),g=p*Math.cos(d),v=p*Math.cos(x),m=c*Math.cos(d),M=c*Math.cos(x),A=y*Math.sin(d),P=y*Math.sin(x),k=["M",a+g*f,n+v*u];k=k.concat(e(a,n,g,v,l,h,0,0)),k=k.concat(["L",a+m*z,n+M*b]),k=k.concat(e(a,n,m,M,h,l,0,0)),k=k.concat(["Z"]);var L=d>0?Math.PI/2:0,S=x>0?0:Math.PI/2,I=l>-L?l:h>-L?-L:l,w=s-S>h?h:s-S>l?s-S:h,D=2*s-S,F=["M",a+g*i(I),n+v*o(I)];F=F.concat(e(a,n,g,v,I,w,0,0)),h>D&&D>l?(F=F.concat(["L",a+g*i(w)+A,n+v*o(w)+P]),F=F.concat(e(a,n,g,v,w,D,A,P)),F=F.concat(["L",a+g*i(D),n+v*o(D)]),F=F.concat(e(a,n,g,v,D,h,0,0)),F=F.concat(["L",a+g*i(h)+A,n+v*o(h)+P]),F=F.concat(e(a,n,g,v,h,D,A,P)),F=F.concat(["L",a+g*i(D),n+v*o(D)]),F=F.concat(e(a,n,g,v,D,w,0,0))):h>s-S&&s-S>l&&(F=F.concat(["L",a+g*Math.cos(w)+A,n+v*Math.sin(w)+P]),F=F.concat(e(a,n,g,v,w,h,A,P)),F=F.concat(["L",a+g*Math.cos(h),n+v*Math.sin(h)]),F=F.concat(e(a,n,g,v,h,w,0,0))),F=F.concat(["L",a+g*Math.cos(w)+A,n+v*Math.sin(w)+P]),F=F.concat(e(a,n,g,v,w,I,A,P)),F=F.concat(["Z"]);var Y=["M",a+m*f,n+M*u];Y=Y.concat(e(a,n,m,M,l,h,0,0)),Y=Y.concat(["L",a+m*Math.cos(h)+A,n+M*Math.sin(h)+P]),Y=Y.concat(e(a,n,m,M,h,l,A,P)),Y=Y.concat(["Z"]);var X=["M",a+g*f,n+v*u,"L",a+g*f+A,n+v*u+P,"L",a+m*f+A,n+M*u+P,"L",a+m*f,n+M*u,"Z"],Z=["M",a+g*z,n+v*b,"L",a+g*z+A,n+v*b+P,"L",a+m*z+A,n+M*b+P,"L",a+m*z,n+M*b,"Z"],T=Math.atan2(P,-A),V=Math.abs(h+T),W=Math.abs(l+T),C=Math.abs((l+h)/2+T);V=r(V),W=r(W),C=r(C);var G=1e5,O=C*G,R=W*G,B=V*G;return{top:k,zTop:Math.PI*G+1,out:F,zOut:Math.max(O,R,B),inn:Y,zInn:Math.max(O,R,B),side1:X,zSide1:.99*B,side2:Z,zSide2:.99*R}}}(t),function(t){function e(t,e){var i,o=t.plotLeft,a=t.plotWidth+o,n=t.plotTop,l=t.plotHeight+n,h=o+t.plotWidth/2,p=n+t.plotHeight/2,c={minX:Number.MAX_VALUE,maxX:-Number.MAX_VALUE,minY:Number.MAX_VALUE,maxY:-Number.MAX_VALUE},y=1;return i=[{x:o,y:n,z:0},{x:o,y:n,z:e}],s([0,1],function(t){i.push({x:a,y:i[t].y,z:i[t].z})}),s([0,1,2,3],function(t){i.push({x:i[t].x,y:l,z:i[t].z})}),i=r(i,t,!1),s(i,function(t){c.minX=Math.min(c.minX,t.x),c.maxX=Math.max(c.maxX,t.x),c.minY=Math.min(c.minY,t.y),c.maxY=Math.max(c.maxY,t.y)}),o>c.minX&&(y=Math.min(y,1-Math.abs((o+h)/(c.minX+h))%1)),a<c.maxX&&(y=Math.min(y,(a-h)/(c.maxX-h))),n>c.minY&&(y=c.minY<0?Math.min(y,(n+p)/(-c.minY+n+p)):Math.min(y,1-(n+p)/(c.minY+p)%1)),l<c.maxY&&(y=Math.min(y,Math.abs((l-p)/(c.maxY-p)))),y}var i=t.Chart,s=t.each,o=t.merge,r=t.perspective,a=t.pick,n=t.wrap;i.prototype.is3d=function(){return this.options.chart.options3d&&this.options.chart.options3d.enabled},i.prototype.propsRequireDirtyBox.push("chart.options3d"),i.prototype.propsRequireUpdateSeries.push("chart.options3d"),n(i.prototype,"initSeries",function(t,e){var i=e.type||this.options.chart.type||this.options.chart.defaultSeriesType;return this.is3d()&&"scatter"===i&&(e.type="scatter3d"),t.call(this,e)}),t.wrap(t.Chart.prototype,"isInsidePlot",function(t){return this.is3d()||t.apply(this,[].slice.call(arguments,1))});var l=t.getOptions(),h={chart:{options3d:{enabled:!1,alpha:0,beta:0,depth:100,fitToPlot:!0,viewDistance:25,axisLabelPosition:"default",frame:{visible:"default",size:1,bottom:{},top:{},left:{},right:{},back:{},front:{}}}}};o(!0,l,h),n(i.prototype,"setClassName",function(t){t.apply(this,[].slice.call(arguments,1)),this.is3d()&&(this.container.className+=" highcharts-3d-chart")}),t.wrap(t.Chart.prototype,"setChartSize",function(t){var i=this,s=i.options.chart.options3d;if(t.apply(i,[].slice.call(arguments,1)),i.is3d()){var o=i.inverted,r=i.clipBox,a=i.margin,n=o?"y":"x",l=o?"x":"y",h=o?"height":"width",p=o?"width":"height";r[n]=-(a[3]||0),r[l]=-(a[0]||0),r[h]=i.chartWidth+(a[3]||0)+(a[1]||0),r[p]=i.chartHeight+(a[0]||0)+(a[2]||0),i.scale3d=1,s.fitToPlot===!0&&(i.scale3d=e(i,s.depth))}}),n(i.prototype,"redraw",function(t){this.is3d()&&(this.isDirtyBox=!0,this.frame3d=this.get3dFrame()),t.apply(this,[].slice.call(arguments,1))}),n(i.prototype,"render",function(t){this.is3d()&&(this.frame3d=this.get3dFrame()),t.apply(this,[].slice.call(arguments,1))}),n(i.prototype,"renderSeries",function(t){var e,i=this.series.length;if(this.is3d())for(;i--;)e=this.series[i],e.translate(),e.render();else t.call(this)}),n(i.prototype,"drawChartBox",function(e){if(this.is3d()){var i=this,s=i.renderer,o=this.options.chart.options3d,r=i.get3dFrame(),a=this.plotLeft,n=this.plotLeft+this.plotWidth,l=this.plotTop,h=this.plotTop+this.plotHeight,p=0,c=o.depth,y=a-(r.left.visible?r.left.size:0),x=n+(r.right.visible?r.right.size:0),d=l-(r.top.visible?r.top.size:0),f=h+(r.bottom.visible?r.bottom.size:0),u=p-(r.front.visible?r.front.size:0),z=c+(r.back.visible?r.back.size:0),b=i.hasRendered?"animate":"attr";this.frame3d=r,this.frameShapes||(this.frameShapes={bottom:s.polyhedron().add(),top:s.polyhedron().add(),left:s.polyhedron().add(),right:s.polyhedron().add(),back:s.polyhedron().add(),front:s.polyhedron().add()}),this.frameShapes.bottom[b]({class:"highcharts-3d-frame highcharts-3d-frame-bottom",zIndex:r.bottom.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.bottom.color).brighten(.1).get(),vertexes:[{x:y,y:f,z:u},{x:x,y:f,z:u},{x:x,y:f,z:z},{x:y,y:f,z:z}],enabled:r.bottom.visible},{fill:t.color(r.bottom.color).brighten(.1).get(),vertexes:[{x:a,y:h,z:c},{x:n,y:h,z:c},{x:n,y:h,z:p},{x:a,y:h,z:p}],enabled:r.bottom.visible},{fill:t.color(r.bottom.color).brighten(-.1).get(),vertexes:[{x:y,y:f,z:u},{x:y,y:f,z:z},{x:a,y:h,z:c},{x:a,y:h,z:p}],enabled:r.bottom.visible&&!r.left.visible},{fill:t.color(r.bottom.color).brighten(-.1).get(),vertexes:[{x:x,y:f,z:z},{x:x,y:f,z:u},{x:n,y:h,z:p},{x:n,y:h,z:c}],enabled:r.bottom.visible&&!r.right.visible},{fill:t.color(r.bottom.color).get(),vertexes:[{x:x,y:f,z:u},{x:y,y:f,z:u},{x:a,y:h,z:p},{x:n,y:h,z:p}],enabled:r.bottom.visible&&!r.front.visible},{fill:t.color(r.bottom.color).get(),vertexes:[{x:y,y:f,z:z},{x:x,y:f,z:z},{x:n,y:h,z:c},{x:a,y:h,z:c}],enabled:r.bottom.visible&&!r.back.visible}]}),this.frameShapes.top[b]({class:"highcharts-3d-frame highcharts-3d-frame-top",zIndex:r.top.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.top.color).brighten(.1).get(),vertexes:[{x:y,y:d,z:z},{x:x,y:d,z:z},{x:x,y:d,z:u},{x:y,y:d,z:u}],enabled:r.top.visible},{fill:t.color(r.top.color).brighten(.1).get(),vertexes:[{x:a,y:l,z:p},{x:n,y:l,z:p},{x:n,y:l,z:c},{x:a,y:l,z:c}],enabled:r.top.visible},{fill:t.color(r.top.color).brighten(-.1).get(),vertexes:[{x:y,y:d,z:z},{x:y,y:d,z:u},{x:a,y:l,z:p},{x:a,y:l,z:c}],enabled:r.top.visible&&!r.left.visible},{fill:t.color(r.top.color).brighten(-.1).get(),vertexes:[{x:x,y:d,z:u},{x:x,y:d,z:z},{x:n,y:l,z:c},{x:n,y:l,z:p}],enabled:r.top.visible&&!r.right.visible},{fill:t.color(r.top.color).get(),vertexes:[{x:y,y:d,z:u},{x:x,y:d,z:u},{x:n,y:l,z:p},{x:a,y:l,z:p}],enabled:r.top.visible&&!r.front.visible},{fill:t.color(r.top.color).get(),vertexes:[{x:x,y:d,z:z},{x:y,y:d,z:z},{x:a,y:l,z:c},{x:n,y:l,z:c}],enabled:r.top.visible&&!r.back.visible}]}),this.frameShapes.left[b]({class:"highcharts-3d-frame highcharts-3d-frame-left",zIndex:r.left.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.left.color).brighten(.1).get(),vertexes:[{x:y,y:f,z:u},{x:a,y:h,z:p},{x:a,y:h,z:c},{x:y,y:f,z:z}],enabled:r.left.visible&&!r.bottom.visible},{fill:t.color(r.left.color).brighten(.1).get(),vertexes:[{x:y,y:d,z:z},{x:a,y:l,z:c},{x:a,y:l,z:p},{x:y,y:d,z:u}],enabled:r.left.visible&&!r.top.visible},{fill:t.color(r.left.color).brighten(-.1).get(),vertexes:[{x:y,y:f,z:z},{x:y,y:d,z:z},{x:y,y:d,z:u},{x:y,y:f,z:u}],enabled:r.left.visible},{fill:t.color(r.left.color).brighten(-.1).get(),vertexes:[{x:a,y:l,z:c},{x:a,y:h,z:c},{x:a,y:h,z:p},{x:a,y:l,z:p}],enabled:r.left.visible},{fill:t.color(r.left.color).get(),vertexes:[{x:y,y:f,z:u},{x:y,y:d,z:u},{x:a,y:l,z:p},{x:a,y:h,z:p}],enabled:r.left.visible&&!r.front.visible},{fill:t.color(r.left.color).get(),vertexes:[{x:y,y:d,z:z},{x:y,y:f,z:z},{x:a,y:h,z:c},{x:a,y:l,z:c}],enabled:r.left.visible&&!r.back.visible}]}),this.frameShapes.right[b]({class:"highcharts-3d-frame highcharts-3d-frame-right",zIndex:r.right.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.right.color).brighten(.1).get(),vertexes:[{x:x,y:f,z:z},{x:n,y:h,z:c},{x:n,y:h,z:p},{x:x,y:f,z:u}],enabled:r.right.visible&&!r.bottom.visible},{fill:t.color(r.right.color).brighten(.1).get(),vertexes:[{x:x,y:d,z:u},{x:n,y:l,z:p},{x:n,y:l,z:c},{x:x,y:d,z:z}],enabled:r.right.visible&&!r.top.visible},{fill:t.color(r.right.color).brighten(-.1).get(),vertexes:[{x:n,y:l,z:p},{x:n,y:h,z:p},{x:n,y:h,z:c},{x:n,y:l,z:c}],enabled:r.right.visible},{fill:t.color(r.right.color).brighten(-.1).get(),vertexes:[{x:x,y:f,z:u},{x:x,y:d,z:u},{x:x,y:d,z:z},{x:x,y:f,z:z}],enabled:r.right.visible},{fill:t.color(r.right.color).get(),vertexes:[{x:x,y:d,z:u},{x:x,y:f,z:u},{x:n,y:h,z:p},{x:n,y:l,z:p}],enabled:r.right.visible&&!r.front.visible},{fill:t.color(r.right.color).get(),vertexes:[{x:x,y:f,z:z},{x:x,y:d,z:z},{x:n,y:l,z:c},{x:n,y:h,z:c}],enabled:r.right.visible&&!r.back.visible}]}),this.frameShapes.back[b]({class:"highcharts-3d-frame highcharts-3d-frame-back",zIndex:r.back.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.back.color).brighten(.1).get(),vertexes:[{x:x,y:f,z:z},{x:y,y:f,z:z},{x:a,y:h,z:c},{x:n,y:h,z:c}],enabled:r.back.visible&&!r.bottom.visible},{fill:t.color(r.back.color).brighten(.1).get(),vertexes:[{x:y,y:d,z:z},{x:x,y:d,z:z},{x:n,y:l,z:c},{x:a,y:l,z:c}],enabled:r.back.visible&&!r.top.visible},{fill:t.color(r.back.color).brighten(-.1).get(),vertexes:[{x:y,y:f,z:z},{x:y,y:d,z:z},{x:a,y:l,z:c},{x:a,y:h,z:c}],enabled:r.back.visible&&!r.left.visible},{fill:t.color(r.back.color).brighten(-.1).get(),vertexes:[{x:x,y:d,z:z},{x:x,y:f,z:z},{x:n,y:h,z:c},{x:n,y:l,z:c}],enabled:r.back.visible&&!r.right.visible},{fill:t.color(r.back.color).get(),vertexes:[{x:a,y:l,z:c},{x:n,y:l,z:c},{x:n,y:h,z:c},{x:a,y:h,z:c}],enabled:r.back.visible},{fill:t.color(r.back.color).get(),vertexes:[{x:y,y:f,z:z},{x:x,y:f,z:z},{x:x,y:d,z:z},{x:y,y:d,z:z}],enabled:r.back.visible}]}),this.frameShapes.front[b]({class:"highcharts-3d-frame highcharts-3d-frame-front",zIndex:r.front.frontFacing?-1e3:1e3,faces:[{fill:t.color(r.front.color).brighten(.1).get(),vertexes:[{x:y,y:f,z:u},{x:x,y:f,z:u},{x:n,y:h,z:p},{x:a,y:h,z:p}],enabled:r.front.visible&&!r.bottom.visible},{fill:t.color(r.front.color).brighten(.1).get(),vertexes:[{x:x,y:d,z:u},{x:y,y:d,z:u},{x:a,y:l,z:p},{x:n,y:l,z:p}],enabled:r.front.visible&&!r.top.visible},{fill:t.color(r.front.color).brighten(-.1).get(),vertexes:[{x:y,y:d,z:u},{x:y,y:f,z:u},{x:a,y:h,z:p},{x:a,y:l,z:p}],enabled:r.front.visible&&!r.left.visible},{fill:t.color(r.front.color).brighten(-.1).get(),vertexes:[{x:x,y:f,z:u},{x:x,y:d,z:u},{x:n,y:l,z:p},{x:n,y:h,z:p}],enabled:r.front.visible&&!r.right.visible},{fill:t.color(r.front.color).get(),vertexes:[{x:n,y:l,z:p},{x:a,y:l,z:p},{x:a,y:h,z:p},{x:n,y:h,z:p}],enabled:r.front.visible},{fill:t.color(r.front.color).get(),vertexes:[{x:x,y:f,z:u},{x:y,y:f,z:u},{x:y,y:d,z:u},{x:x,y:d,z:u}],enabled:r.front.visible}]})}return e.apply(this,[].slice.call(arguments,1))}),i.prototype.retrieveStacks=function(t){var e,i=this.series,o={},r=1;return s(this.series,function(s){e=a(s.options.stack,t?0:i.length-1-s.index),o[e]?o[e].series.push(s):(o[e]={series:[s],position:r},r++)}),o.totalStacks=r+1,o},i.prototype.get3dFrame=function(){var e=this,i=e.options.chart.options3d,o=i.frame,n=e.plotLeft,l=e.plotLeft+e.plotWidth,h=e.plotTop,p=e.plotTop+e.plotHeight,c=0,y=i.depth,x=function(i){var s=t.shapeArea3d(i,e);return s>.5?1:-.5>s?-1:0},d=x([{x:n,y:p,z:y},{x:l,y:p,z:y},{x:l,y:p,z:c},{x:n,y:p,z:c}]),f=x([{x:n,y:h,z:c},{x:l,y:h,z:c},{x:l,y:h,z:y},{x:n,y:h,z:y}]),u=x([{x:n,y:h,z:c},{x:n,y:h,z:y},{x:n,y:p,z:y},{x:n,y:p,z:c}]),z=x([{x:l,y:h,z:y},{x:l,y:h,z:c},{x:l,y:p,z:c},{x:l,y:p,z:y}]),b=x([{x:n,y:p,z:c},{x:l,y:p,z:c},{x:l,y:h,z:c},{x:n,y:h,z:c}]),g=x([{x:n,y:h,z:y},{x:l,y:h,z:y},{x:l,y:p,z:y},{x:n,y:p,z:y}]),v=!1,m=!1,M=!1,A=!1,P=!1,k=!0;s([].concat(e.xAxis,e.yAxis,e.zAxis),function(t){t&&(t.horiz?t.opposite?m=!0:v=!0:t.opposite?A=!0:M=!0)});var L=function(t,e,i){for(var s=["size","color","visible"],o={},r=0;r<s.length;r++)for(var n=s[r],l=0;l<t.length;l++)if("object"==typeof t[l]){var h=t[l][n];if(void 0!==h&&null!==h){o[n]=h;break}}var p=i;return o.visible===!0||o.visible===!1?p=o.visible:"auto"===o.visible&&(p=e>0),{size:a(o.size,1),color:a(o.color,"none"),frontFacing:e>0,visible:p}},S={bottom:L([o.bottom,o.top,o],d,v),top:L([o.top,o.bottom,o],f,m),left:L([o.left,o.right,o.side,o],u,M),right:L([o.right,o.left,o.side,o],z,A),back:L([o.back,o.front,o],g,k),front:L([o.front,o.back,o],b,P)};if("auto"===i.axisLabelPosition){var I=function(t,e){return t.visible!==e.visible||t.visible&&e.visible&&t.frontFacing!==e.frontFacing},w=[];I(S.left,S.front)&&w.push({y:(h+p)/2,x:n,z:c,xDir:{x:1,y:0,z:0}}),I(S.left,S.back)&&w.push({y:(h+p)/2,x:n,z:y,xDir:{x:0,y:0,z:-1}}),I(S.right,S.front)&&w.push({y:(h+p)/2,x:l,z:c,xDir:{x:0,y:0,z:1}}),I(S.right,S.back)&&w.push({y:(h+p)/2,x:l,z:y,xDir:{x:-1,y:0,z:0}});var D=[];I(S.bottom,S.front)&&D.push({x:(n+l)/2,y:p,z:c,xDir:{x:1,y:0,z:0}}),I(S.bottom,S.back)&&D.push({x:(n+l)/2,y:p,z:y,xDir:{x:-1,y:0,z:0}});var F=[];I(S.top,S.front)&&F.push({x:(n+l)/2,y:h,z:c,xDir:{x:1,y:0,z:0}}),I(S.top,S.back)&&F.push({x:(n+l)/2,y:h,z:y,xDir:{x:-1,y:0,z:0}});var Y=[];I(S.bottom,S.left)&&Y.push({z:(c+y)/2,y:p,x:n,xDir:{x:0,y:0,z:-1}}),I(S.bottom,S.right)&&Y.push({z:(c+y)/2,y:p,x:l,xDir:{x:0,y:0,z:1}});var X=[];I(S.top,S.left)&&X.push({z:(c+y)/2,y:h,x:n,xDir:{x:0,y:0,z:-1}}),I(S.top,S.right)&&X.push({z:(c+y)/2,y:h,x:l,xDir:{x:0,y:0,z:1}});var Z=function(t,i,s){if(0===t.length)return null;if(1===t.length)return t[0];for(var o=0,a=r(t,e,!1),n=1;n<a.length;n++)s*a[n][i]>s*a[o][i]?o=n:s*a[n][i]===s*a[o][i]&&a[n].z<a[o].z&&(o=n);return t[o]};S.axes={y:{left:Z(w,"x",-1),right:Z(w,"x",1)},x:{top:Z(F,"y",-1),bottom:Z(D,"y",1)},z:{top:Z(X,"y",-1),bottom:Z(Y,"y",1)}}}else S.axes={y:{left:{x:n,z:c,xDir:{x:1,y:0,z:0}},right:{x:l,z:c,xDir:{x:0,y:0,z:1}}},x:{top:{y:h,z:c,xDir:{x:1,y:0,z:0}},bottom:{y:p,z:c,xDir:{x:1,y:0,z:0}}},z:{top:{x:M?l:n,y:h,xDir:M?{x:0,y:0,z:1}:{x:0,y:0,z:-1}},bottom:{x:M?l:n,y:p,xDir:M?{x:0,y:0,z:1}:{x:0,y:0,z:-1}}}};return S},t.Fx.prototype.matrixSetter=function(){var e;if(this.pos<1&&(t.isArray(this.start)||t.isArray(this.end))){var i=this.start||[1,0,0,1,0,0],s=this.end||[1,0,0,1,0,0];e=[];for(var o=0;6>o;o++)e.push(this.pos*s[o]+(1-this.pos)*i[o])}else e=this.end;this.elem.attr(this.prop,e,null,!0)}}(t),function(t){function e(t,e,i){if(!t.chart.is3d()||"colorAxis"===t.coll)return e;var s,o=t.chart,a=r*o.options.chart.options3d.alpha,n=r*o.options.chart.options3d.beta,l=p(i&&t.options.title.position3d,t.options.labels.position3d),y=p(i&&t.options.title.skew3d,t.options.labels.skew3d),x=o.frame3d,d=o.plotLeft,f=o.plotWidth+d,u=o.plotTop,z=o.plotHeight+u,b=!1,g=0,v=0,m={x:0,y:1,z:0};if(e=t.swapZ({x:e.x,y:e.y,z:0}),t.isZAxis)if(t.opposite){if(null===x.axes.z.top)return{};v=e.y-u,e.x=x.axes.z.top.x,e.y=x.axes.z.top.y,s=x.axes.z.top.xDir,b=!x.top.frontFacing}else{if(null===x.axes.z.bottom)return{};v=e.y-z,e.x=x.axes.z.bottom.x,e.y=x.axes.z.bottom.y,s=x.axes.z.bottom.xDir,b=!x.bottom.frontFacing}else if(t.horiz)if(t.opposite){if(null===x.axes.x.top)return{};v=e.y-u,e.y=x.axes.x.top.y,e.z=x.axes.x.top.z,s=x.axes.x.top.xDir,b=!x.top.frontFacing}else{if(null===x.axes.x.bottom)return{};v=e.y-z,e.y=x.axes.x.bottom.y,e.z=x.axes.x.bottom.z,s=x.axes.x.bottom.xDir,b=!x.bottom.frontFacing}else if(t.opposite){if(null===x.axes.y.right)return{};g=e.x-f,e.x=x.axes.y.right.x,e.z=x.axes.y.right.z,s=x.axes.y.right.xDir,s={x:s.z,y:s.y,z:-s.x}}else{if(null===x.axes.y.left)return{};g=e.x-d,e.x=x.axes.y.left.x,e.z=x.axes.y.left.z,s=x.axes.y.left.xDir}if("chart"===l);else if("flap"===l)if(t.horiz){var M=Math.sin(a),A=Math.cos(a);t.opposite&&(M=-M),b&&(M=-M),m={x:s.z*M,y:A,z:-s.x*M}}else s={x:Math.cos(n),y:0,z:Math.sin(n)};else if("ortho"===l)if(t.horiz){var P=Math.sin(a),k=Math.cos(a),L=Math.sin(n),S=Math.cos(n),I={x:L*k,y:-P,z:-k*S};m={x:s.y*I.z-s.z*I.y,y:s.z*I.x-s.x*I.z,z:s.x*I.y-s.y*I.x};var w=1/Math.sqrt(m.x*m.x+m.y*m.y+m.z*m.z);b&&(w=-w),m={x:w*m.x,y:w*m.y,z:w*m.z}}else s={x:Math.cos(n),y:0,z:Math.sin(n)};else t.horiz?m={x:Math.sin(n)*Math.sin(a),y:Math.cos(a),z:-Math.cos(n)*Math.sin(a)}:s={x:Math.cos(n),y:0,z:Math.sin(n)};e.x+=g*s.x+v*m.x,e.y+=g*s.y+v*m.y,e.z+=g*s.z+v*m.z;var D=h([e],t.chart)[0];if(y){var F=c(h([e,{x:e.x+s.x,y:e.y+s.y,z:e.z+s.z},{x:e.x+m.x,y:e.y+m.y,z:e.z+m.z}],t.chart))<0;F&&(s={x:-s.x,y:-s.y,z:-s.z});var Y=h([{x:e.x,y:e.y,z:e.z},{x:e.x+s.x,y:e.y+s.y,z:e.z+s.z},{x:e.x+m.x,y:e.y+m.y,z:e.z+m.z}],t.chart);D.matrix=[Y[1].x-Y[0].x,Y[1].y-Y[0].y,Y[2].x-Y[0].x,Y[2].y-Y[0].y,D.x,D.y],D.matrix[4]-=D.x*D.matrix[0]+D.y*D.matrix[2],D.matrix[5]-=D.x*D.matrix[1]+D.y*D.matrix[3]}else D.matrix=null;return D}var i,s=t.Axis,o=t.Chart,r=t.deg2rad,a=t.each,n=t.extend,l=t.merge,h=t.perspective,p=t.pick,c=t.shapeArea,y=t.splat,x=t.Tick,d=t.wrap,f={labels:{position3d:"offset",skew3d:!1},title:{position3d:null,skew3d:null}};l(!0,s.prototype.defaultOptions,f),d(s.prototype,"setOptions",function(t,e){var i;t.call(this,e),this.chart.is3d&&this.chart.is3d()&&"colorAxis"!==this.coll&&(i=this.options,i.tickWidth=p(i.tickWidth,0),i.gridLineWidth=p(i.gridLineWidth,1))}),d(s.prototype,"getPlotLinePath",function(t){var e=t.apply(this,[].slice.call(arguments,1));if(!this.chart.is3d()||"colorAxis"===this.coll)return e;if(null===e)return e;var i=this.chart,s=i.options.chart.options3d,o=this.isZAxis?i.plotWidth:s.depth,r=i.frame3d,a=[this.swapZ({x:e[1],y:e[2],z:0}),this.swapZ({x:e[1],y:e[2],z:o}),this.swapZ({x:e[4],y:e[5],z:0}),this.swapZ({x:e[4],y:e[5],z:o})],n=[];return this.horiz?this.isZAxis?(r.left.visible&&n.push(a[0],a[2]),r.right.visible&&n.push(a[1],a[3]),r.top.visible&&n.push(a[0],a[1]),r.bottom.visible&&n.push(a[2],a[3])):(r.front.visible&&n.push(a[0],a[2]),r.back.visible&&n.push(a[1],a[3]),r.top.visible&&n.push(a[0],a[1]),r.bottom.visible&&n.push(a[2],a[3])):(r.front.visible&&n.push(a[0],a[2]),r.back.visible&&n.push(a[1],a[3]),r.left.visible&&n.push(a[0],a[1]),r.right.visible&&n.push(a[2],a[3])),n=h(n,this.chart,!1),this.chart.renderer.toLineSegments(n)}),d(s.prototype,"getLinePath",function(t){return this.chart.is3d()&&"colorAxis"!==this.coll?[]:t.apply(this,[].slice.call(arguments,1))}),d(s.prototype,"getPlotBandPath",function(t){if(!this.chart.is3d()||"colorAxis"===this.coll)return t.apply(this,[].slice.call(arguments,1));var e=arguments,i=e[1],s=e[2],o=[],r=this.getPlotLinePath(i),a=this.getPlotLinePath(s);if(r&&a)for(var n=0;n<r.length;n+=6)o.push("M",r[n+1],r[n+2],"L",r[n+4],r[n+5],"L",a[n+4],a[n+5],"L",a[n+1],a[n+2],"Z");return o}),d(x.prototype,"getMarkPath",function(t){var i=t.apply(this,[].slice.call(arguments,1)),s=[e(this.axis,{x:i[1],y:i[2],z:0}),e(this.axis,{x:i[4],y:i[5],z:0})];return this.axis.chart.renderer.toLineSegments(s)}),d(x.prototype,"getLabelPosition",function(t){var i=t.apply(this,[].slice.call(arguments,1));return e(this.axis,i)}),d(s.prototype,"getTitlePosition",function(t){var i=t.apply(this,[].slice.call(arguments,1));return e(this,i,!0)}),d(s.prototype,"drawCrosshair",function(t){var e=arguments;this.chart.is3d()&&"colorAxis"!==this.coll&&e[2]&&(e[2]={plotX:e[2].plotXold||e[2].plotX,plotY:e[2].plotYold||e[2].plotY}),t.apply(this,[].slice.call(e,1))}),d(s.prototype,"destroy",function(t){a(["backFrame","bottomFrame","sideFrame"],function(t){this[t]&&(this[t]=this[t].destroy())},this),t.apply(this,[].slice.call(arguments,1))}),s.prototype.swapZ=function(t,e){if(this.isZAxis){var i=e?0:this.chart.plotLeft;return{x:i+t.z,y:t.y,z:t.x-i}}return t},i=t.ZAxis=function(){this.init.apply(this,arguments)},n(i.prototype,s.prototype),n(i.prototype,{isZAxis:!0,setOptions:function(t){t=l({offset:0,lineWidth:0},t),s.prototype.setOptions.call(this,t),this.coll="zAxis"},setAxisSize:function(){s.prototype.setAxisSize.call(this),this.width=this.len=this.chart.options.chart.options3d.depth,this.right=this.chart.chartWidth-this.width-this.left},getSeriesExtremes:function(){var t=this,e=t.chart;t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.ignoreMinPadding=t.ignoreMaxPadding=null,t.buildStacks&&t.buildStacks(),a(t.series,function(i){if(i.visible||!e.options.chart.ignoreHiddenSeries){var s,o=i.options,r=o.threshold;t.hasVisibleSeries=!0,t.positiveValuesOnly&&0>=r&&(r=null),s=i.zData,s.length&&(t.dataMin=Math.min(p(t.dataMin,s[0]),Math.min.apply(null,s)),t.dataMax=Math.max(p(t.dataMax,s[0]),Math.max.apply(null,s)))}})}}),d(o.prototype,"getAxes",function(t){var e=this,s=this.options,o=s.zAxis=y(s.zAxis||{});t.call(this),e.is3d()&&(this.zAxis=[],a(o,function(t,s){t.index=s,t.isX=!0;var o=new i(e,t);o.setScale()}))})}(t),function(t){var e=t.perspective,i=t.pick,s=t.wrap;s(t.Series.prototype,"translate",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.translate3dPoints()}),t.Series.prototype.translate3dPoints=function(){var t,s,o,r,a,n=this,l=n.chart,h=i(n.zAxis,l.options.zAxis[0]),p=[];for(a=0;a<n.data.length;a++)t=n.data[a],h&&h.translate?(r=h.isLog&&h.val2lin?h.val2lin(t.z):t.z,t.plotZ=h.translate(r),t.isInside=t.isInside?r>=h.min&&r<=h.max:!1):t.plotZ=0,p.push({x:i(t.plotXold,t.plotX),y:i(t.plotYold,t.plotY),z:i(t.plotZold,t.plotZ)});for(s=e(p,l,!0),a=0;a<n.data.length;a++)t=n.data[a],o=s[a],t.plotXold=t.plotX,t.plotYold=t.plotY,t.plotZold=t.plotZ,t.plotX=o.x,t.plotY=o.y,t.plotZ=o.z}}(t),function(t){function e(t){var e=t.apply(this,[].slice.call(arguments,1));return this.chart.is3d&&this.chart.is3d()&&(e.stroke=this.options.edgeColor||e.fill,e["stroke-width"]=o(this.options.edgeWidth,1)),e}var i=t.each,s=t.perspective,o=t.pick,r=t.Series,a=t.seriesTypes,n=t.inArray,l=t.svg,h=t.wrap;h(a.column.prototype,"translate",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.translate3dShapes()}),a.column.prototype.translate3dPoints=function(){},a.column.prototype.translate3dShapes=function(){var t=this,e=t.chart,o=t.options,r=o.depth||25,a=o.stacking?o.stack||0:t.index,n=a*(r+(o.groupZPadding||1)),l=t.borderWidth%2?.5:0;e.inverted&&!t.yAxis.reversed&&(l*=-1),o.grouping!==!1&&(n=0),n+=o.groupZPadding||1,i(t.data,function(o){if(null!==o.y){var a,h=o.shapeArgs,p=o.tooltipPos,c=[["x","width"],["y","height"]];i(c,function(e){if(a=h[e[0]]-l,0>a&&(h[e[1]]+=h[e[0]]+l,h[e[0]]=-l,a=0),a+h[e[1]]>t[e[0]+"Axis"].len&&0!==h[e[1]]&&(h[e[1]]=t[e[0]+"Axis"].len-h[e[0]]),0!==h[e[1]]&&(h[e[0]]>=t[e[0]+"Axis"].len||h[e[0]]+h[e[1]]<=l))for(var i in h)h[i]=0}),o.shapeType="cuboid",h.z=n,h.depth=r,h.insidePlotArea=!0,p=s([{x:p[0],y:p[1],z:n}],e,!0)[0],o.tooltipPos=[p.x,p.y]}}),t.z=n},h(a.column.prototype,"animate",function(t){if(this.chart.is3d()){var e=arguments,s=e[1],o=this.yAxis,r=this,a=this.yAxis.reversed;l&&(s?i(r.data,function(t){null!==t.y&&(t.height=t.shapeArgs.height,t.shapey=t.shapeArgs.y,t.shapeArgs.height=1,a||(t.shapeArgs.y=t.stackY?t.plotY+o.translate(t.stackY):t.plotY+(t.negative?-t.height:t.height)))}):(i(r.data,function(t){null!==t.y&&(t.shapeArgs.height=t.height,t.shapeArgs.y=t.shapey,t.graphic&&t.graphic.animate(t.shapeArgs,r.options.animation))}),this.drawDataLabels(),r.animate=null))}else t.apply(this,[].slice.call(arguments,1))}),h(a.column.prototype,"plotGroup",function(t,e,i,s,o,r){return this.chart.is3d()&&r&&!this[e]&&(this.chart.columnGroup||(this.chart.columnGroup=this.chart.renderer.g("columnGroup").add(r)),this[e]=this.chart.columnGroup,this.chart.columnGroup.attr(this.getPlotBox()),this[e].survive=!0),t.apply(this,Array.prototype.slice.call(arguments,1))}),h(a.column.prototype,"setVisible",function(t,e){var s,o=this;o.chart.is3d()&&i(o.data,function(t){t.visible=t.options.visible=e=void 0===e?!t.visible:e,s=e?"visible":"hidden",o.options.data[n(t,o.data)]=t.options,t.graphic&&t.graphic.attr({visibility:s})}),t.apply(this,Array.prototype.slice.call(arguments,1))}),h(a.column.prototype,"init",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var e=this.options,i=e.grouping,s=e.stacking,r=o(this.yAxis.options.reversedStacks,!0),a=0;if(void 0===i||i){var n,l=this.chart.retrieveStacks(s),h=e.stack||0;for(n=0;n<l[h].series.length&&l[h].series[n]!==this;n++);a=10*(l.totalStacks-l[h].position)+(r?n:-n),this.xAxis.reversed||(a=10*l.totalStacks-a)}e.zIndex=a}}),h(a.column.prototype,"pointAttribs",e),a.columnrange&&(h(a.columnrange.prototype,"pointAttribs",e),a.columnrange.prototype.plotGroup=a.column.prototype.plotGroup,a.columnrange.prototype.setVisible=a.column.prototype.setVisible),h(r.prototype,"alignDataLabel",function(t){if(this.chart.is3d()&&("column"===this.type||"columnrange"===this.type)){var e=this,i=e.chart,o=arguments,r=o[4],a={x:r.x,y:r.y,z:e.z};a=s([a],i,!0)[0],r.x=a.x,r.y=a.y}t.apply(this,[].slice.call(arguments,1))}),h(t.StackItem.prototype,"getStackBox",function(e,i){var s=e.apply(this,[].slice.call(arguments,1));if(i.is3d()){var o={x:s.x,y:s.y,z:0};o=t.perspective([o],i,!0)[0],s.x=o.x,s.y=o.y}return s})}(t),function(t){var e=t.deg2rad,i=t.each,s=t.pick,o=t.seriesTypes,r=t.svg,a=t.wrap;a(o.pie.prototype,"translate",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var s=this,o=s.options,r=o.depth||0,a=s.chart.options.chart.options3d,n=a.alpha,l=a.beta,h=o.stacking?(o.stack||0)*r:s._i*r;h+=r/2,o.grouping!==!1&&(h=0),i(s.data,function(t){var i,a=t.shapeArgs;t.shapeType="arc3d",a.z=h,a.depth=.75*r,a.alpha=n,a.beta=l,a.center=s.center,i=(a.end+a.start)/2,t.slicedTranslation={translateX:Math.round(Math.cos(i)*o.slicedOffset*Math.cos(n*e)),translateY:Math.round(Math.sin(i)*o.slicedOffset*Math.cos(n*e))}})}}),a(o.pie.prototype.pointClass.prototype,"haloPath",function(t){var e=arguments;return this.series.chart.is3d()?[]:t.call(this,e[1])}),a(o.pie.prototype,"pointAttribs",function(t,e,i){var o=t.call(this,e,i),r=this.options;return this.chart.is3d()&&(o.stroke=r.edgeColor||e.color||this.color,o["stroke-width"]=s(r.edgeWidth,1)),o}),a(o.pie.prototype,"drawPoints",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&i(this.points,function(t){var e=t.graphic;e&&e[t.y&&t.visible?"show":"hide"]()})}),a(o.pie.prototype,"drawDataLabels",function(t){if(this.chart.is3d()){var s=this,o=s.chart,r=o.options.chart.options3d;i(s.data,function(t){var s=t.shapeArgs,o=s.r,a=(s.alpha||r.alpha)*e,n=(s.beta||r.beta)*e,l=(s.start+s.end)/2,h=t.labelPos,p=[0,2,4],c=-o*(1-Math.cos(a))*Math.sin(l),y=o*(Math.cos(n)-1)*Math.cos(l);i(p,function(t){h[t]+=y,h[t+1]+=c})})}t.apply(this,[].slice.call(arguments,1))}),a(o.pie.prototype,"addPoint",function(t){t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()&&this.update(this.userOptions,!0)}),a(o.pie.prototype,"animate",function(t){if(this.chart.is3d()){var e,i=arguments,s=i[1],o=this.options.animation,a=this.center,n=this.group,l=this.markerGroup;r&&(o===!0&&(o={}),s?(n.oldtranslateX=n.translateX,n.oldtranslateY=n.translateY,e={translateX:a[0],translateY:a[1],scaleX:.001,scaleY:.001},n.attr(e),l&&(l.attrSetters=n.attrSetters,l.attr(e))):(e={translateX:n.oldtranslateX,translateY:n.oldtranslateY,scaleX:1,scaleY:1},n.animate(e,o),l&&l.animate(e,o),this.animate=null))}else t.apply(this,[].slice.call(arguments,1))})}(t),function(t){var e=t.Point,i=t.seriesType,s=t.seriesTypes;i("scatter3d","scatter",{tooltip:{pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>z: <b>{point.z}</b><br/>"}},{pointAttribs:function(e){var i=s.scatter.prototype.pointAttribs.apply(this,arguments);return this.chart.is3d()&&e&&(i.zIndex=t.pointCameraDistance(e,this.chart)),i},axisTypes:["xAxis","yAxis","zAxis"],pointArrayMap:["x","y","z"],parallelArrays:["x","y","z"],directTouch:!0},{applyOptions:function(){return e.prototype.applyOptions.apply(this,arguments),void 0===this.z&&(this.z=0),this}})}(t),function(t){var e=t.Axis,i=t.SVGRenderer,s=t.VMLRenderer;s&&(t.setOptions({animate:!1}),s.prototype.face3d=i.prototype.face3d,s.prototype.polyhedron=i.prototype.polyhedron,s.prototype.cuboid=i.prototype.cuboid,s.prototype.cuboidPath=i.prototype.cuboidPath,s.prototype.toLinePath=i.prototype.toLinePath,s.prototype.toLineSegments=i.prototype.toLineSegments,s.prototype.createElement3D=i.prototype.createElement3D,s.prototype.arc3d=function(t){var e=i.prototype.arc3d.call(this,t);return e.css({zIndex:e.zIndex}),e},t.VMLRenderer.prototype.arc3dPath=t.SVGRenderer.prototype.arc3dPath,t.wrap(e.prototype,"render",function(t){t.apply(this,[].slice.call(arguments,1)),this.sideFrame&&(this.sideFrame.css({zIndex:0}),this.sideFrame.front.attr({fill:this.sideFrame.color})),this.bottomFrame&&(this.bottomFrame.css({zIndex:1}),this.bottomFrame.front.attr({fill:this.bottomFrame.color})),this.backFrame&&(this.backFrame.css({zIndex:0}),this.backFrame.front.attr({fill:this.backFrame.color}))}))}(t)});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){!function(t){var i=t.deg2rad,a=t.isNumber,e=t.pick,o=t.relativeLength;t.CenteredSeriesMixin={getCenter:function(){var t,i,a,r=this.options,s=this.chart,n=2*(r.slicedOffset||0),l=s.plotWidth-2*n,h=s.plotHeight-2*n,p=r.center,c=[e(p[0],"50%"),e(p[1],"50%"),r.size||"100%",r.innerSize||0],d=Math.min(l,h);for(i=0;4>i;++i)a=c[i],t=2>i||2===i&&/%$/.test(a),c[i]=o(a,[l,h,d,c[2]][i])+(t?n:0);return c[3]>c[2]&&(c[3]=c[2]),c},getStartAndEndRadians:function(t,e){var o=a(t)?t:0,r=a(e)&&e>o&&360>e-o?e:o+360,s=-90;return{start:i*(o+s),end:i*(r+s)}}}}(t),function(t){function i(t,i){this.init(t,i)}var a=t.CenteredSeriesMixin,e=t.each,o=t.extend,r=t.merge,s=t.splat;o(i.prototype,{coll:"pane",init:function(t,i){this.chart=i,this.background=[],i.pane.push(this),this.setOptions(t)},setOptions:function(t){this.options=t=r(this.defaultOptions,this.chart.angular?{background:{}}:void 0,t)},render:function(){var t,i,a=this.options,e=this.options.background,o=this.chart.renderer;if(this.group||(this.group=o.g("pane-group").attr({zIndex:a.zIndex||0}).add()),this.updateCenter(),e)for(e=s(e),t=Math.max(e.length,this.background.length||0),i=0;t>i;i++)e[i]&&this.axis?this.renderBackground(r(this.defaultBackgroundOptions,e[i]),i):this.background[i]&&(this.background[i]=this.background[i].destroy(),this.background.splice(i,1))},renderBackground:function(t,i){var a="animate";this.background[i]||(this.background[i]=this.chart.renderer.path().add(this.group),a="attr"),this.background[i][a]({d:this.axis.getPlotBandPath(t.from,t.to,t)}).attr({fill:t.backgroundColor,stroke:t.borderColor,"stroke-width":t.borderWidth,class:"highcharts-pane "+(t.className||"")})},defaultOptions:{center:["50%","50%"],size:"85%",startAngle:0},defaultBackgroundOptions:{shape:"circle",borderWidth:1,borderColor:"#cccccc",backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#ffffff"],[1,"#e6e6e6"]]},from:-Number.MAX_VALUE,innerRadius:0,to:Number.MAX_VALUE,outerRadius:"105%"},updateCenter:function(t){this.center=(t||this.axis||{}).center=a.getCenter.call(this)},update:function(t,i){r(!0,this.options,t),this.setOptions(this.options),this.render(),e(this.chart.axes,function(t){t.pane===this&&(t.pane=null,t.update({},i))},this)}}),t.Pane=i}(t),function(t){var i,a,e=t.Axis,o=t.each,r=t.extend,s=t.map,n=t.merge,l=t.noop,h=t.pick,p=t.pInt,c=t.Tick,d=t.wrap,u=e.prototype,g=c.prototype;i={getOffset:l,redraw:function(){this.isDirty=!1},render:function(){this.isDirty=!1},setScale:l,setCategories:l,setTitle:l},a={defaultRadialGaugeOptions:{labels:{align:"center",x:0,y:null},minorGridLineWidth:0,minorTickInterval:"auto",minorTickLength:10,minorTickPosition:"inside",minorTickWidth:1,tickLength:10,tickPosition:"inside",tickWidth:2,title:{rotation:0},zIndex:2},defaultRadialXOptions:{gridLineWidth:1,labels:{align:null,distance:15,x:0,y:null,style:{textOverflow:"none"}},maxPadding:0,minPadding:0,showLastLabel:!1,tickLength:0},defaultRadialYOptions:{gridLineInterpolation:"circle",labels:{align:"right",x:-3,y:-2},showLastLabel:!1,title:{x:4,text:null,rotation:90}},setOptions:function(t){var i=this.options=n(this.defaultOptions,this.defaultRadialOptions,t);i.plotBands||(i.plotBands=[])},getOffset:function(){u.getOffset.call(this),this.chart.axisOffset[this.side]=0},getLinePath:function(t,i){var a,e,o=this.center,r=this.chart,s=h(i,o[2]/2-this.offset);return this.isCircular||void 0!==i?(e=this.chart.renderer.symbols.arc(this.left+o[0],this.top+o[1],s,s,{start:this.startAngleRad,end:this.endAngleRad,open:!0,innerR:0}),e.xBounds=[this.left+o[0]],e.yBounds=[this.top+o[1]-s]):(a=this.postTranslate(this.angleRad,s),e=["M",o[0]+r.plotLeft,o[1]+r.plotTop,"L",a.x,a.y]),e},setAxisTranslation:function(){u.setAxisTranslation.call(this),this.center&&(this.transA=this.isCircular?(this.endAngleRad-this.startAngleRad)/(this.max-this.min||1):this.center[2]/2/(this.max-this.min||1),this.minPixelPadding=this.isXAxis?this.transA*this.minPointOffset:0)},beforeSetTickPositions:function(){this.autoConnect=this.isCircular&&void 0===h(this.userMax,this.options.max)&&this.endAngleRad-this.startAngleRad===2*Math.PI,this.autoConnect&&(this.max+=this.categories&&1||this.pointRange||this.closestPointRange||0)},setAxisSize:function(){u.setAxisSize.call(this),this.isRadial&&(this.pane.updateCenter(this),this.isCircular&&(this.sector=this.endAngleRad-this.startAngleRad),this.len=this.width=this.height=this.center[2]*h(this.sector,1)/2)},getPosition:function(t,i){return this.postTranslate(this.isCircular?this.translate(t):this.angleRad,h(this.isCircular?i:this.translate(t),this.center[2]/2)-this.offset)},postTranslate:function(t,i){var a=this.chart,e=this.center;return t=this.startAngleRad+t,{x:a.plotLeft+e[0]+Math.cos(t)*i,y:a.plotTop+e[1]+Math.sin(t)*i}},getPlotBandPath:function(t,i,a){var e,o,r,n,l=this.center,c=this.startAngleRad,d=l[2]/2,u=[h(a.outerRadius,"100%"),a.innerRadius,h(a.thickness,10)],g=Math.min(this.offset,0),f=/%$/,m=this.isCircular;return"polygon"===this.options.gridLineInterpolation?n=this.getPlotLinePath(t).concat(this.getPlotLinePath(i,!0)):(t=Math.max(t,this.min),i=Math.min(i,this.max),m||(u[0]=this.translate(t),u[1]=this.translate(i)),u=s(u,function(t){return f.test(t)&&(t=p(t,10)*d/100),t}),"circle"!==a.shape&&m?(e=c+this.translate(t),o=c+this.translate(i)):(e=-Math.PI/2,o=1.5*Math.PI,r=!0),u[0]-=g,u[2]-=g,n=this.chart.renderer.symbols.arc(this.left+l[0],this.top+l[1],u[0],u[0],{start:Math.min(e,o),end:Math.max(e,o),innerR:h(u[1],u[0]-u[2]),open:r})),n},getPlotLinePath:function(t,i){var a,e,r,s,n=this,l=n.center,h=n.chart,p=n.getPosition(t);return n.isCircular?s=["M",l[0]+h.plotLeft,l[1]+h.plotTop,"L",p.x,p.y]:"circle"===n.options.gridLineInterpolation?(t=n.translate(t),t&&(s=n.getLinePath(0,t))):(o(h.xAxis,function(t){t.pane===n.pane&&(a=t)}),s=[],t=n.translate(t),r=a.tickPositions,a.autoConnect&&(r=r.concat([r[0]])),i&&(r=[].concat(r).reverse()),o(r,function(i,o){e=a.getPosition(i,t),s.push(o?"L":"M",e.x,e.y)})),s},getTitlePosition:function(){var t=this.center,i=this.chart,a=this.options.title;return{x:i.plotLeft+t[0]+(a.x||0),y:i.plotTop+t[1]-{high:.5,middle:.25,low:0}[a.align]*t[2]+(a.y||0)}}},d(u,"init",function(t,e,o){var s,l,p=e.angular,c=e.polar,d=o.isX,u=p&&d,g=e.options,f=o.pane||0,m=this.pane=e.pane&&e.pane[f],y=m&&m.options;p?(r(this,u?i:a),s=!d,s&&(this.defaultRadialOptions=this.defaultRadialGaugeOptions)):c&&(r(this,a),s=d,this.defaultRadialOptions=d?this.defaultRadialXOptions:n(this.defaultYAxisOptions,this.defaultRadialYOptions)),p||c?(this.isRadial=!0,e.inverted=!1,g.chart.zoomType=null):this.isRadial=!1,m&&s&&(m.axis=this),t.call(this,e,o),!u&&m&&(p||c)&&(l=this.options,this.angleRad=(l.angle||0)*Math.PI/180,this.startAngleRad=(y.startAngle-90)*Math.PI/180,this.endAngleRad=(h(y.endAngle,y.startAngle+360)-90)*Math.PI/180,this.offset=l.offset||0,this.isCircular=s)}),d(u,"autoLabelAlign",function(t){return this.isRadial?void 0:t.apply(this,[].slice.call(arguments,1))}),d(g,"getPosition",function(t,i,a,e,o){var r=this.axis;return r.getPosition?r.getPosition(a):t.call(this,i,a,e,o)}),d(g,"getLabelPosition",function(t,i,a,e,o,r,s,n,l){var p,c=this.axis,d=r.y,u=20,g=r.align,f=(c.translate(this.pos)+c.startAngleRad+Math.PI/2)/Math.PI*180%360;return c.isRadial?(p=c.getPosition(this.pos,c.center[2]/2+h(r.distance,-25)),"auto"===r.rotation?e.attr({rotation:f}):null===d&&(d=c.chart.renderer.fontMetrics(e.styles.fontSize).b-e.getBBox().height/2),null===g&&(c.isCircular?(this.label.getBBox().width>c.len*c.tickInterval/(c.max-c.min)&&(u=0),g=f>u&&180-u>f?"left":f>180+u&&360-u>f?"right":"center"):g="center",e.attr({align:g})),p.x+=r.x,p.y+=d):p=t.call(this,i,a,e,o,r,s,n,l),p}),d(g,"getMarkPath",function(t,i,a,e,o,r,s){var n,l,h=this.axis;return h.isRadial?(n=h.getPosition(this.pos,h.center[2]/2+e),l=["M",i,a,"L",n.x,n.y]):l=t.call(this,i,a,e,o,r,s),l})}(t),function(t){var i=t.each,a=t.noop,e=t.pick,o=t.defined,r=t.Series,s=t.seriesType,n=t.seriesTypes,l=r.prototype,h=t.Point.prototype;s("arearange","area",{lineWidth:1,threshold:null,tooltip:{pointFormat:'<span style="color:{series.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},trackByArea:!0,dataLabels:{align:null,verticalAlign:null,xLow:0,xHigh:0,yLow:0,yHigh:0}},{pointArrayMap:["low","high"],dataLabelCollections:["dataLabel","dataLabelUpper"],toYData:function(t){return[t.low,t.high]},pointValKey:"low",deferTranslatePolar:!0,highToXY:function(t){var i=this.chart,a=this.xAxis.postTranslate(t.rectPlotX,this.yAxis.len-t.plotHigh);t.plotHighX=a.x-i.plotLeft,t.plotHigh=a.y-i.plotTop,t.plotLowX=t.plotX},translate:function(){var t=this,a=t.yAxis,e=!!t.modifyValue;n.area.prototype.translate.apply(t),i(t.points,function(i){var o=i.low,r=i.high,s=i.plotY;null===r||null===o?(i.isNull=!0,i.plotY=null):(i.plotLow=s,i.plotHigh=a.translate(e?t.modifyValue(r,i):r,0,1,0,1),e&&(i.yBottom=i.plotHigh))}),this.chart.polar&&i(this.points,function(i){t.highToXY(i),i.tooltipPos=[(i.plotHighX+i.plotLowX)/2,(i.plotHigh+i.plotLow)/2]})},getGraphPath:function(t){var i,a,o,r,s,l,h,p=[],c=[],d=n.area.prototype.getGraphPath,u=this.options,g=this.chart.polar&&u.connectEnds!==!1,f=u.connectNulls,m=u.step;for(t=t||this.points,i=t.length,i=t.length;i--;)a=t[i],a.isNull||g||f||t[i+1]&&!t[i+1].isNull||c.push({plotX:a.plotX,plotY:a.plotY,doCurve:!1}),o={polarPlotY:a.polarPlotY,rectPlotX:a.rectPlotX,yBottom:a.yBottom,plotX:e(a.plotHighX,a.plotX),plotY:a.plotHigh,isNull:a.isNull},c.push(o),p.push(o),a.isNull||g||f||t[i-1]&&!t[i-1].isNull||c.push({plotX:a.plotX,plotY:a.plotY,doCurve:!1});return s=d.call(this,t),m&&(m===!0&&(m="left"),u.step={left:"right",center:"center",right:"left"}[m]),l=d.call(this,p),h=d.call(this,c),u.step=m,r=[].concat(s,l),this.chart.polar||"M"!==h[0]||(h[0]="L"),this.graphPath=r,this.areaPath=s.concat(h),r.isArea=!0,r.xMap=s.xMap,this.areaPath.xMap=s.xMap,r},drawDataLabels:function(){var t,i,a,e=this.data,o=e.length,r=[],s=this.options.dataLabels,n=s.align,h=s.verticalAlign,p=s.inside,c=this.chart.inverted;if(s.enabled||this._hasPointLabels){for(t=o;t--;)i=e[t],i&&(a=p?i.plotHigh<i.plotLow:i.plotHigh>i.plotLow,i.y=i.high,i._plotY=i.plotY,i.plotY=i.plotHigh,r[t]=i.dataLabel,i.dataLabel=i.dataLabelUpper,i.below=a,c?n||(s.align=a?"right":"left"):h||(s.verticalAlign=a?"top":"bottom"),s.x=s.xHigh,s.y=s.yHigh);for(l.drawDataLabels&&l.drawDataLabels.apply(this,arguments),t=o;t--;)i=e[t],i&&(a=p?i.plotHigh<i.plotLow:i.plotHigh>i.plotLow,i.dataLabelUpper=i.dataLabel,i.dataLabel=r[t],i.y=i.low,i.plotY=i._plotY,i.below=!a,c?n||(s.align=a?"left":"right"):h||(s.verticalAlign=a?"bottom":"top"),s.x=s.xLow,s.y=s.yLow);l.drawDataLabels&&l.drawDataLabels.apply(this,arguments)}s.align=n,s.verticalAlign=h},alignDataLabel:function(){n.column.prototype.alignDataLabel.apply(this,arguments)},drawPoints:function(){var t,i,a=this,e=a.points.length;for(l.drawPoints.apply(a,arguments),i=0;e>i;)t=a.points[i],t.lowerGraphic=t.graphic,t.graphic=t.upperGraphic,t._plotY=t.plotY,t._plotX=t.plotX,t.plotY=t.plotHigh,o(t.plotHighX)&&(t.plotX=t.plotHighX),i++;for(l.drawPoints.apply(a,arguments),i=0;e>i;)t=a.points[i],t.upperGraphic=t.graphic,t.graphic=t.lowerGraphic,t.plotY=t._plotY,t.plotX=t._plotX,i++},setStackedPoints:a},{setState:function(){var t=this.state,i=this.series,a=i.chart.polar;o(this.plotHigh)||(this.plotHigh=i.yAxis.toPixels(this.high,!0)),o(this.plotLow)||(this.plotLow=this.plotY=i.yAxis.toPixels(this.low,!0)),h.setState.apply(this,arguments),this.graphic=this.upperGraphic,this.plotY=this.plotHigh,a&&(this.plotX=this.plotHighX),this.state=t,i.stateMarkerGraphic&&(i.lowerStateMarkerGraphic=i.stateMarkerGraphic,i.stateMarkerGraphic=i.upperStateMarkerGraphic),h.setState.apply(this,arguments),this.plotY=this.plotLow,this.graphic=this.lowerGraphic,a&&(this.plotX=this.plotLowX),i.stateMarkerGraphic&&(i.upperStateMarkerGraphic=i.stateMarkerGraphic,i.stateMarkerGraphic=i.lowerStateMarkerGraphic,i.lowerStateMarkerGraphic=void 0)},haloPath:function(){var t=this.series.chart.polar,i=[];return this.plotY=this.plotLow,t&&(this.plotX=this.plotLowX),i=h.haloPath.apply(this,arguments),this.plotY=this.plotHigh,t&&(this.plotX=this.plotHighX),i=i.concat(h.haloPath.apply(this,arguments))},destroy:function(){return this.upperGraphic&&(this.upperGraphic=this.upperGraphic.destroy()),h.destroy.apply(this,arguments)}})}(t),function(t){var i=t.seriesType,a=t.seriesTypes;i("areasplinerange","arearange",null,{getPointSpline:a.spline.prototype.getPointSpline})}(t),function(t){var i=t.defaultPlotOptions,a=t.each,e=t.merge,o=t.noop,r=t.pick,s=t.seriesType,n=t.seriesTypes,l=n.column.prototype,h={pointRange:null,marker:null,states:{hover:{halo:!1}}};s("columnrange","arearange",e(i.column,i.arearange,h),{translate:function(){function t(t){return Math.min(Math.max(-d,t),d)}var i,e,o=this,s=o.yAxis,n=o.xAxis,h=n.startAngleRad,p=o.chart,c=o.xAxis.isRadial,d=Math.max(p.chartWidth,p.chartHeight)+999;l.translate.apply(o),a(o.points,function(a){var l,d,u,g=a.shapeArgs,f=o.options.minPointLength;a.plotHigh=e=t(s.translate(a.high,0,1,0,1)),a.plotLow=t(a.plotY),u=e,d=r(a.rectPlotY,a.plotY)-e,Math.abs(d)<f?(l=f-d,d+=l,u-=l/2):0>d&&(d*=-1,u-=d),c?(i=a.barX+h,a.shapeType="path",a.shapeArgs={d:o.polarArc(u+d,u,i,i+a.pointWidth)}):(g.height=d,g.y=u,a.tooltipPos=p.inverted?[s.len+s.pos-p.plotLeft-u-d/2,n.len+n.pos-p.plotTop-g.x-g.width/2,d]:[n.left-p.plotLeft+g.x+g.width/2,s.pos-p.plotTop+u+d/2,d])})},directTouch:!0,trackerGroups:["group","dataLabelsGroup"],drawGraph:o,getSymbol:o,crispCol:l.crispCol,drawPoints:l.drawPoints,drawTracker:l.drawTracker,getColumnMetrics:l.getColumnMetrics,pointAttribs:l.pointAttribs,animate:function(){return l.animate.apply(this,arguments)},polarArc:function(){return l.polarArc.apply(this,arguments)},translate3dPoints:function(){return l.translate3dPoints.apply(this,arguments)},translate3dShapes:function(){return l.translate3dShapes.apply(this,arguments)}},{setState:l.pointClass.prototype.setState})}(t),function(t){var i=t.each,a=t.isNumber,e=t.merge,o=t.noop,r=t.pick,s=t.pInt,n=t.Series,l=t.seriesType,h=t.TrackerMixin;l("gauge","line",{dataLabels:{enabled:!0,defer:!1,y:15,borderRadius:3,crop:!1,verticalAlign:"top",zIndex:2,borderWidth:1,borderColor:"#cccccc"},dial:{},pivot:{},tooltip:{headerFormat:""},showInLegend:!1},{angular:!0,directTouch:!0,drawGraph:o,fixedBox:!0,forceDL:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],translate:function(){var t=this,o=t.yAxis,n=t.options,l=o.center;t.generatePoints(),i(t.points,function(t){var i=e(n.dial,t.dial),h=s(r(i.radius,80))*l[2]/200,p=s(r(i.baseLength,70))*h/100,c=s(r(i.rearLength,10))*h/100,d=i.baseWidth||3,u=i.topWidth||1,g=n.overshoot,f=o.startAngleRad+o.translate(t.y,null,null,null,!0);a(g)?(g=g/180*Math.PI,f=Math.max(o.startAngleRad-g,Math.min(o.endAngleRad+g,f))):n.wrap===!1&&(f=Math.max(o.startAngleRad,Math.min(o.endAngleRad,f))),f=180*f/Math.PI,t.shapeType="path",t.shapeArgs={d:i.path||["M",-c,-d/2,"L",p,-d/2,h,-u/2,h,u/2,p,d/2,-c,d/2,"z"],translateX:l[0],translateY:l[1],rotation:f},t.plotX=l[0],t.plotY=l[1]})},drawPoints:function(){var t=this,a=t.yAxis.center,o=t.pivot,s=t.options,n=s.pivot,l=t.chart.renderer;i(t.points,function(i){var a=i.graphic,o=i.shapeArgs,r=o.d,n=e(s.dial,i.dial);a?(a.animate(o),o.d=r):(i.graphic=l[i.shapeType](o).attr({rotation:o.rotation,zIndex:1}).addClass("highcharts-dial").add(t.group),i.graphic.attr({stroke:n.borderColor||"none","stroke-width":n.borderWidth||0,fill:n.backgroundColor||"#000000"}))}),o?o.animate({translateX:a[0],translateY:a[1]}):(t.pivot=l.circle(0,0,r(n.radius,5)).attr({zIndex:2}).addClass("highcharts-pivot").translate(a[0],a[1]).add(t.group),t.pivot.attr({"stroke-width":n.borderWidth||0,stroke:n.borderColor||"#cccccc",fill:n.backgroundColor||"#000000"}))},animate:function(t){var a=this;t||(i(a.points,function(t){var i=t.graphic;i&&(i.attr({rotation:180*a.yAxis.startAngleRad/Math.PI}),i.animate({rotation:t.shapeArgs.rotation},a.options.animation))}),a.animate=null)},render:function(){this.group=this.plotGroup("group","series",this.visible?"visible":"hidden",this.options.zIndex,this.chart.seriesGroup),n.prototype.render.call(this),this.group.clip(this.chart.clipRect)},setData:function(t,i){n.prototype.setData.call(this,t,!1),this.processData(),this.generatePoints(),r(i,!0)&&this.chart.redraw()},drawTracker:h&&h.drawTrackerPoint},{setState:function(t){this.state=t}})}(t),function(t){var i=t.each,a=t.noop,e=t.pick,o=t.seriesType,r=t.seriesTypes;o("boxplot","column",{threshold:null,tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>Maximum: {point.high}<br/>Upper quartile: {point.q3}<br/>Median: {point.median}<br/>Lower quartile: {point.q1}<br/>Minimum: {point.low}<br/>'},whiskerLength:"50%",fillColor:"#ffffff",lineWidth:1,medianWidth:2,states:{hover:{brightness:-.3}},whiskerWidth:2},{pointArrayMap:["low","q1","median","q3","high"],toYData:function(t){return[t.low,t.q1,t.median,t.q3,t.high]},pointValKey:"high",pointAttribs:function(t){var i=this.options,a=t&&t.color||this.color;return{fill:t.fillColor||i.fillColor||a,stroke:i.lineColor||a,"stroke-width":i.lineWidth||0}},drawDataLabels:a,translate:function(){var t=this,a=t.yAxis,e=t.pointArrayMap;r.column.prototype.translate.apply(t),i(t.points,function(t){i(e,function(i){null!==t[i]&&(t[i+"Plot"]=a.translate(t[i],0,1,0,1))})})},drawPoints:function(){var t,a,o,r,s,n,l,h,p,c,d,u,g,f=this,m=f.points,y=f.options,x=f.chart,b=x.renderer,P=0,M=f.doQuartiles!==!1,v=f.options.whiskerLength;i(m,function(i){var m,x=i.graphic,k=x?"animate":"attr",w=i.shapeArgs,A={},L={},C={},S=i.color||f.color;void 0!==i.plotY&&(p=w.width,c=Math.floor(w.x),d=c+p,u=Math.round(p/2),t=Math.floor(M?i.q1Plot:i.lowPlot),a=Math.floor(M?i.q3Plot:i.lowPlot),o=Math.floor(i.highPlot),r=Math.floor(i.lowPlot),x||(i.graphic=x=b.g("point").add(f.group),i.stem=b.path().addClass("highcharts-boxplot-stem").add(x),v&&(i.whiskers=b.path().addClass("highcharts-boxplot-whisker").add(x)),M&&(i.box=b.path(h).addClass("highcharts-boxplot-box").add(x)),i.medianShape=b.path(n).addClass("highcharts-boxplot-median").add(x)),A.stroke=i.stemColor||y.stemColor||S,A["stroke-width"]=e(i.stemWidth,y.stemWidth,y.lineWidth),A.dashstyle=i.stemDashStyle||y.stemDashStyle,i.stem.attr(A),v&&(L.stroke=i.whiskerColor||y.whiskerColor||S,L["stroke-width"]=e(i.whiskerWidth,y.whiskerWidth,y.lineWidth),i.whiskers.attr(L)),M&&(m=f.pointAttribs(i),i.box.attr(m)),C.stroke=i.medianColor||y.medianColor||S,C["stroke-width"]=e(i.medianWidth,y.medianWidth,y.lineWidth),i.medianShape.attr(C),l=i.stem.strokeWidth()%2/2,P=c+u+l,i.stem[k]({d:["M",P,a,"L",P,o,"M",P,t,"L",P,r]}),M&&(l=i.box.strokeWidth()%2/2,t=Math.floor(t)+l,a=Math.floor(a)+l,c+=l,d+=l,i.box[k]({d:["M",c,a,"L",c,t,"L",d,t,"L",d,a,"L",c,a,"z"]})),v&&(l=i.whiskers.strokeWidth()%2/2,o+=l,r+=l,g=/%$/.test(v)?u*parseFloat(v)/100:v/2,i.whiskers[k]({d:["M",P-g,o,"L",P+g,o,"M",P-g,r,"L",P+g,r]})),s=Math.round(i.medianPlot),l=i.medianShape.strokeWidth()%2/2,s+=l,i.medianShape[k]({d:["M",c,s,"L",d,s]}))})},setStackedPoints:a})}(t),function(t){var i=t.each,a=t.noop,e=t.seriesType,o=t.seriesTypes;e("errorbar","boxplot",{color:"#000000",grouping:!1,linkedTo:":previous",tooltip:{pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.low}</b> - <b>{point.high}</b><br/>'},whiskerWidth:null},{type:"errorbar",pointArrayMap:["low","high"],toYData:function(t){return[t.low,t.high]},pointValKey:"high",doQuartiles:!1,drawDataLabels:o.arearange?function(){var t=this.pointValKey;o.arearange.prototype.drawDataLabels.call(this),i(this.data,function(i){i.y=i[t]})}:a,getColumnMetrics:function(){return this.linkedParent&&this.linkedParent.columnMetrics||o.column.prototype.getColumnMetrics.call(this)}})}(t),function(t){var i=t.correctFloat,a=t.isNumber,e=t.pick,o=t.Point,r=t.Series,s=t.seriesType,n=t.seriesTypes;s("waterfall","column",{dataLabels:{inside:!0},lineWidth:1,lineColor:"#333333",dashStyle:"dot",borderColor:"#333333",states:{hover:{lineWidthPlus:0}}},{pointValKey:"y",translate:function(){var t,a,o,r,s,l,h,p,c,d,u,g,f,m=this,y=m.options,x=m.yAxis,b=e(y.minPointLength,5),P=b/2,M=y.threshold,v=y.stacking;for(n.column.prototype.translate.apply(m),c=d=M,o=m.points,a=0,t=o.length;t>a;a++)r=o[a],p=m.processedYData[a],s=r.shapeArgs,l=v&&x.stacks[(m.negStacks&&M>p?"-":"")+m.stackKey],g=m.getStackIndicator(g,r.x,m.index),u=l?l[r.x].points[g.key]:[0,p],r.isSum?r.y=i(p):r.isIntermediateSum&&(r.y=i(p-d)),h=Math.max(c,c+r.y)+u[0],s.y=x.translate(h,0,1,0,1),r.isSum?(s.y=x.translate(u[1],0,1,0,1),s.height=Math.min(x.translate(u[0],0,1,0,1),x.len)-s.y):r.isIntermediateSum?(s.y=x.translate(u[1],0,1,0,1),s.height=Math.min(x.translate(d,0,1,0,1),x.len)-s.y,d=u[1]):(s.height=p>0?x.translate(c,0,1,0,1)-s.y:x.translate(c,0,1,0,1)-x.translate(c-p,0,1,0,1),c+=l&&l[r.x]?l[r.x].total:p),s.height<0&&(s.y+=s.height,s.height*=-1),r.plotY=s.y=Math.round(s.y)-m.borderWidth%2/2,s.height=Math.max(Math.round(s.height),.001),r.yBottom=s.y+s.height,s.height<=b&&!r.isNull?(s.height=b,s.y-=P,r.plotY=s.y,r.minPointLengthOffset=r.y<0?-P:P):r.minPointLengthOffset=0,f=r.plotY+(r.negative?s.height:0),m.chart.inverted?r.tooltipPos[0]=x.len-f:r.tooltipPos[1]=f},processData:function(t){var a,e,o,s,n,l,h,p=this,c=p.options,d=p.yData,u=p.options.data,g=d.length,f=c.threshold||0;for(o=e=s=n=f,h=0;g>h;h++)l=d[h],a=u&&u[h]?u[h]:{},"sum"===l||a.isSum?d[h]=i(o):"intermediateSum"===l||a.isIntermediateSum?d[h]=i(e):(o+=l,e+=l),s=Math.min(o,s),n=Math.max(o,n);r.prototype.processData.call(this,t),p.options.stacking||(p.dataMin=s,p.dataMax=n)},toYData:function(t){return t.isSum?0===t.x?null:"sum":t.isIntermediateSum?0===t.x?null:"intermediateSum":t.y},pointAttribs:function(t,i){var a,e=this.options.upColor;return e&&!t.options.color&&(t.color=t.y>0?e:null),a=n.column.prototype.pointAttribs.call(this,t,i),delete a.dashstyle,a},getGraphPath:function(){return["M",0,0]},getCrispPath:function(){var t,i,a,e,o=this.data,r=o.length,s=this.graph.strokeWidth()+this.borderWidth,n=Math.round(s)%2/2,l=this.yAxis.reversed,h=[];for(a=1;r>a;a++)i=o[a].shapeArgs,t=o[a-1].shapeArgs,e=["M",t.x+t.width,t.y+o[a-1].minPointLengthOffset+n,"L",i.x,t.y+o[a-1].minPointLengthOffset+n],(o[a-1].y<0&&!l||o[a-1].y>0&&l)&&(e[2]+=t.height,e[5]+=t.height),h=h.concat(e);return h},drawGraph:function(){r.prototype.drawGraph.call(this),this.graph.attr({d:this.getCrispPath()})},setStackedPoints:function(){var t,i,a=this,e=a.options;for(r.prototype.setStackedPoints.apply(a,arguments),t=a.stackedYData?a.stackedYData.length:0,i=1;t>i;i++)e.data[i].isSum||e.data[i].isIntermediateSum||(a.stackedYData[i]+=a.stackedYData[i-1])},getExtremes:function(){return this.options.stacking?r.prototype.getExtremes.apply(this,arguments):void 0}},{getClassName:function(){var t=o.prototype.getClassName.call(this);return this.isSum?t+=" highcharts-sum":this.isIntermediateSum&&(t+=" highcharts-intermediate-sum"),t},isValid:function(){return a(this.y,!0)||this.isSum||this.isIntermediateSum}})}(t),function(t){var i=t.LegendSymbolMixin,a=t.noop,e=t.Series,o=t.seriesType,r=t.seriesTypes;o("polygon","scatter",{marker:{enabled:!1,states:{hover:{enabled:!1}}},stickyTracking:!1,tooltip:{followPointer:!0,pointFormat:""},trackByArea:!0},{type:"polygon",getGraphPath:function(){for(var t=e.prototype.getGraphPath.call(this),i=t.length+1;i--;)(i===t.length||"M"===t[i])&&i>0&&t.splice(i,0,"z");return this.areaPath=t,t},drawGraph:function(){this.options.fillColor=this.color,r.area.prototype.drawGraph.call(this)},drawLegendSymbol:i.drawRectangle,drawTracker:e.prototype.drawTracker,setStackedPoints:a})}(t),function(t){var i=t.arrayMax,a=t.arrayMin,e=t.Axis,o=t.color,r=t.each,s=t.isNumber,n=t.noop,l=t.pick,h=t.pInt,p=t.Point,c=t.Series,d=t.seriesType,u=t.seriesTypes;d("bubble","scatter",{dataLabels:{formatter:function(){return this.point.z},inside:!0,verticalAlign:"middle"},marker:{lineColor:null,lineWidth:1,radius:null,states:{hover:{radiusPlus:0}},symbol:"circle"},minSize:8,maxSize:"20%",softThreshold:!1,states:{hover:{halo:{size:5}}},tooltip:{pointFormat:"({point.x}, {point.y}), Size: {point.z}"},turboThreshold:0,zThreshold:0,zoneAxis:"z"},{pointArrayMap:["y","z"],parallelArrays:["x","y","z"],trackerGroups:["group","dataLabelsGroup"],specialGroup:"group",bubblePadding:!0,zoneAxis:"z",directTouch:!0,pointAttribs:function(t,i){var a=this.options.marker,e=l(a.fillOpacity,.5),r=c.prototype.pointAttribs.call(this,t,i);return 1!==e&&(r.fill=o(r.fill).setOpacity(e).get("rgba")),r},getRadii:function(t,i,a,e){var o,r,s,n,l,h=this.zData,p=[],c=this.options,d="width"!==c.sizeBy,u=c.zThreshold,g=i-t;for(r=0,o=h.length;o>r;r++)n=h[r],c.sizeByAbsoluteValue&&null!==n&&(n=Math.abs(n-u),i=Math.max(i-u,Math.abs(t-u)),t=0),null===n?l=null:t>n?l=a/2-1:(s=g>0?(n-t)/g:.5,d&&s>=0&&(s=Math.sqrt(s)),l=Math.ceil(a+s*(e-a))/2),p.push(l);this.radii=p},animate:function(t){var i=this.options.animation;t||(r(this.points,function(t){var a,e=t.graphic;e&&e.width&&(a={x:e.x,y:e.y,width:e.width,height:e.height},e.attr({x:t.plotX,y:t.plotY,width:1,height:1}),e.animate(a,i))}),this.animate=null)},translate:function(){var i,a,e,o=this.data,r=this.radii;for(u.scatter.prototype.translate.call(this),i=o.length;i--;)a=o[i],e=r?r[i]:0,s(e)&&e>=this.minPxSize/2?(a.marker=t.extend(a.marker,{radius:e,width:2*e,height:2*e}),a.dlBox={x:a.plotX-e,y:a.plotY-e,width:2*e,height:2*e}):a.shapeArgs=a.plotY=a.dlBox=void 0},alignDataLabel:u.column.prototype.alignDataLabel,buildKDTree:n,applyZones:n},{haloPath:function(t){return p.prototype.haloPath.call(this,0===t?0:(this.marker?this.marker.radius||0:0)+t)},ttBelow:!1}),e.prototype.beforePadding=function(){var t=this,e=this.len,o=this.chart,n=0,p=e,c=this.isXAxis,d=c?"xData":"yData",u=this.min,g={},f=Math.min(o.plotWidth,o.plotHeight),m=Number.MAX_VALUE,y=-Number.MAX_VALUE,x=this.max-u,b=e/x,P=[];r(this.series,function(e){var s,n=e.options;!e.bubblePadding||!e.visible&&o.options.chart.ignoreHiddenSeries||(t.allowZoomOutside=!0,P.push(e),c&&(r(["minSize","maxSize"],function(t){var i=n[t],a=/%$/.test(i);i=h(i),g[t]=a?f*i/100:i}),e.minPxSize=g.minSize,e.maxPxSize=Math.max(g.maxSize,g.minSize),s=e.zData,s.length&&(m=l(n.zMin,Math.min(m,Math.max(a(s),n.displayNegative===!1?n.zThreshold:-Number.MAX_VALUE))),y=l(n.zMax,Math.max(y,i(s))))))}),r(P,function(i){var a,e=i[d],o=e.length;if(c&&i.getRadii(m,y,i.minPxSize,i.maxPxSize),x>0)for(;o--;)s(e[o])&&t.dataMin<=e[o]&&e[o]<=t.dataMax&&(a=i.radii[o],n=Math.min((e[o]-u)*b-a,n),p=Math.max((e[o]-u)*b+a,p))}),P.length&&x>0&&!this.isLog&&(p-=e,b*=(e+n-p)/e,r([["min","userMin",n],["max","userMax",p]],function(i){void 0===l(t.options[i[0]],t[i[1]])&&(t[i[0]]+=i[2]/b)}))}}(t),function(t){function i(t,i){var a,e=this.chart,o=this.options.animation,r=this.group,s=this.markerGroup,n=this.xAxis.center,l=e.plotLeft,h=e.plotTop;e.polar?e.renderer.isSVG&&(o===!0&&(o={}),i?(a={translateX:n[0]+l,translateY:n[1]+h,scaleX:.001,scaleY:.001},r.attr(a),s&&s.attr(a)):(a={translateX:l,translateY:h,scaleX:1,scaleY:1},r.animate(a,o),s&&s.animate(a,o),this.animate=null)):t.call(this,i)}var a,e=t.each,o=t.pick,r=t.Pointer,s=t.Series,n=t.seriesTypes,l=t.wrap,h=s.prototype,p=r.prototype;h.searchPointByAngle=function(t){var i=this,a=i.chart,e=i.xAxis,o=e.pane.center,r=t.chartX-o[0]-a.plotLeft,s=t.chartY-o[1]-a.plotTop;return this.searchKDTree({clientX:180+Math.atan2(r,s)*(-180/Math.PI)})},h.getConnectors=function(t,i,a,e){var o,r,s,n,l,h,p,c,d,u,g,f,m,y,x,b,P,M,v,k,w,A=1.5,L=A+1,C=e?1:0;return o=i>=0&&i<=t.length-1?i:0>i?t.length-1+i:0,r=0>o-1?t.length-(1+C):o-1,s=o+1>t.length-1?C:o+1,n=t[r],l=t[s],h=n.plotX,p=n.plotY,c=l.plotX,d=l.plotY,u=t[o].plotX,g=t[o].plotY,m=(A*u+h)/L,y=(A*g+p)/L,x=(A*u+c)/L,b=(A*g+d)/L,P=Math.sqrt(Math.pow(m-u,2)+Math.pow(y-g,2)),M=Math.sqrt(Math.pow(x-u,2)+Math.pow(b-g,2)),v=Math.atan2(y-g,m-u),k=Math.atan2(b-g,x-u),w=Math.PI/2+(v+k)/2,Math.abs(v-w)>Math.PI/2&&(w-=Math.PI),m=u+Math.cos(w)*P,y=g+Math.sin(w)*P,x=u+Math.cos(Math.PI+w)*M,b=g+Math.sin(Math.PI+w)*M,f={rightContX:x,rightContY:b,leftContX:m,leftContY:y,plotX:u,plotY:g},a&&(f.prevPointCont=this.getConnectors(t,r,!1,e)),f},l(h,"buildKDTree",function(t){this.chart.polar&&(this.kdByAngle?this.searchPoint=this.searchPointByAngle:this.options.findNearestPointBy="xy"),t.apply(this)}),h.toXY=function(t){var i,a,e=this.chart,o=t.plotX,r=t.plotY;t.rectPlotX=o,t.rectPlotY=r,i=this.xAxis.postTranslate(t.plotX,this.yAxis.len-r),t.plotX=t.polarPlotX=i.x-e.plotLeft,t.plotY=t.polarPlotY=i.y-e.plotTop,this.kdByAngle?(a=(o/Math.PI*180+this.xAxis.pane.options.startAngle)%360,0>a&&(a+=360),t.clientX=a):t.clientX=t.plotX},n.spline&&(l(n.spline.prototype,"getPointSpline",function(t,i,a,e){var o,r;return this.chart.polar?e?(r=this.getConnectors(i,e,!0,this.connectEnds),o=["C",r.prevPointCont.rightContX,r.prevPointCont.rightContY,r.leftContX,r.leftContY,r.plotX,r.plotY]):o=["M",a.plotX,a.plotY]:o=t.call(this,i,a,e),o}),n.areasplinerange&&(n.areasplinerange.prototype.getPointSpline=n.spline.prototype.getPointSpline)),l(h,"translate",function(t){var i,a,e=this.chart;if(t.call(this),e.polar&&(this.kdByAngle=e.tooltip&&e.tooltip.shared,!this.preventPostTranslate))for(i=this.points,a=i.length;a--;)this.toXY(i[a])}),l(h,"getGraphPath",function(t,i){var a,o,r,s=this;if(this.chart.polar){for(i=i||this.points,a=0;a<i.length;a++)if(!i[a].isNull){o=a;break}this.options.connectEnds!==!1&&void 0!==o&&(this.connectEnds=!0,i.splice(i.length,0,i[o]),r=!0),e(i,function(t){void 0===t.polarPlotY&&s.toXY(t)})}var n=t.apply(this,[].slice.call(arguments,1));return r&&i.pop(),n}),l(h,"animate",i),n.column&&(a=n.column.prototype,a.polarArc=function(t,i,a,e){var r=this.xAxis.center,s=this.yAxis.len;return this.chart.renderer.symbols.arc(r[0],r[1],s-i,null,{start:a,end:e,innerR:s-o(t,s)})},l(a,"animate",i),l(a,"translate",function(t){var i,a,e,o,r=this.xAxis,s=r.startAngleRad;if(this.preventPostTranslate=!0,t.call(this),r.isRadial)for(a=this.points,o=a.length;o--;)e=a[o],i=e.barX+s,e.shapeType="path",e.shapeArgs={d:this.polarArc(e.yBottom,e.plotY,i,i+e.pointWidth)},this.toXY(e),e.tooltipPos=[e.plotX,e.plotY],e.ttBelow=e.plotY>r.center[1]}),l(a,"alignDataLabel",function(t,i,a,e,o,r){if(this.chart.polar){var s,n,l=i.rectPlotX/Math.PI*180;null===e.align&&(s=l>20&&160>l?"left":l>200&&340>l?"right":"center",e.align=s),null===e.verticalAlign&&(n=45>l||l>315?"bottom":l>135&&225>l?"top":"middle",e.verticalAlign=n),h.alignDataLabel.call(this,i,a,e,o,r)}else t.call(this,i,a,e,o,r)})),l(p,"getCoordinates",function(t,i){var a=this.chart,o={xAxis:[],yAxis:[]};return a.polar?e(a.axes,function(t){var e=t.isXAxis,r=t.center,s=i.chartX-r[0]-a.plotLeft,n=i.chartY-r[1]-a.plotTop;o[e?"xAxis":"yAxis"].push({axis:t,value:t.translate(e?Math.PI-Math.atan2(s,n):Math.sqrt(Math.pow(s,2)+Math.pow(n,2)),!0)})}):o=t.call(this,i),o}),l(t.Chart.prototype,"getAxes",function(i){this.pane||(this.pane=[]),e(t.splat(this.options.pane),function(i){new t.Pane(i,this)},this),i.call(this)}),l(t.Chart.prototype,"drawChartBox",function(t){t.call(this),e(this.pane,function(t){t.render()})}),l(t.Chart.prototype,"get",function(i,a){return t.find(this.pane,function(t){return t.options.id===a})||i.call(this,a)})}(t)});
!function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){!function(e){var t=e.seriesType,n=e.seriesTypes,a=e.noop,i=e.pick,o=e.each;t("funnel","pie",{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,size:!0,dataLabels:{connectorWidth:1},states:{select:{color:"#cccccc",borderColor:"#000000",shadow:!1}}},{animate:a,translate:function(){var e,t,n,i,s,l,c,r,p,h,d,u=function(e,t){return/%$/.test(e)?t*parseInt(e,10)/100:parseInt(e,10)},f=0,b=this,g=b.chart,L=b.options,m=L.reversed,v=L.ignoreHiddenPoint,y=g.plotWidth,D=g.plotHeight,k=0,H=L.center,W=u(H[0],y),w=u(H[1],D),x=u(L.width,y),Y=u(L.height,D),X=u(L.neckWidth,y),A=u(L.neckHeight,D),P=w-Y/2+Y-A,T=b.data,I="left"===L.dataLabels.position?1:0;b.getWidthAt=t=function(e){var t=w-Y/2;return e>P||Y===A?X:X+(x-X)*(1-(e-t)/(Y-A))},b.getX=function(e,n,a){return W+(n?-1:1)*(t(m?2*w-e:e)/2+a.labelDistance)},b.center=[W,w,Y],b.centerX=W,o(T,function(e){v&&e.visible===!1||(f+=e.y)}),o(T,function(o){d=null,i=f?o.y/f:0,l=w-Y/2+k*Y,p=l+i*Y,e=t(l),s=W-e/2,c=s+e,e=t(p),r=W-e/2,h=r+e,l>P?(s=r=W-X/2,c=h=W+X/2):p>P&&(d=p,e=t(P),r=W-e/2,h=r+e,p=P),m&&(l=2*w-l,p=2*w-p,d=d?2*w-d:null),n=["M",s,l,"L",c,l,h,p],d&&n.push(h,d,r,d),n.push(r,p,"Z"),o.shapeType="path",o.shapeArgs={d:n},o.percentage=100*i,o.plotX=W,o.plotY=(l+(d||p))/2,o.tooltipPos=[W,o.plotY],o.slice=a,o.half=I,v&&o.visible===!1||(k+=i)})},sortByAngle:function(e){e.sort(function(e,t){return e.plotY-t.plotY})},drawDataLabels:function(){var e,t,a,o,s,l=this,c=l.data,r=l.options.dataLabels.distance,p=c.length;for(l.center[2]-=2*r;p--;)a=c[p],e=a.half,t=e?1:-1,s=a.plotY,a.labelDistance=i(a.options.dataLabels&&a.options.dataLabels.distance,r),l.maxLabelDistance=Math.max(a.labelDistance,l.maxLabelDistance||0),o=l.getX(s,e,a),a.labelPos=[0,s,o+(a.labelDistance-5)*t,s,o+a.labelDistance*t,s,e?"right":"left",0];n.pie.prototype.drawDataLabels.call(this)}}),t("pyramid","funnel",{neckWidth:"0%",neckHeight:"0%",reversed:!0})}(e)});
!function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){var t=function(e){var t=e.each,s=e.Series,i=e.addEvent,n=e.fireEvent,a=e.wrap,r=e.noop,o={init:function(){s.prototype.init.apply(this,arguments),this.initialised=!1,this.baseSeries=null,this.eventRemovers=[],this.addEvents()},setDerivedData:r,setBaseSeries:function(){var e=this.chart,t=this.options.baseSeries,s=t&&(e.series[t]||e.get(t));this.baseSeries=s||null},addEvents:function(){var e,t=this;e=i(this.chart,"seriesLinked",function(){t.setBaseSeries(),t.baseSeries&&!t.initialised&&(t.setDerivedData(),t.addBaseSeriesEvents(),t.initialised=!0)}),this.eventRemovers.push(e)},addBaseSeriesEvents:function(){var e,t,s=this;e=i(s.baseSeries,"updatedData",function(){s.setDerivedData()}),t=i(s.baseSeries,"destroy",function(){s.baseSeries=null,s.initialised=!1}),s.eventRemovers.push(e,t)},destroy:function(){t(this.eventRemovers,function(e){e()}),s.prototype.destroy.apply(this,arguments)}};return a(e.Chart.prototype,"linkSeries",function(e){e.call(this),n(this,"seriesLinked")}),o}(e);!function(e,t){var s=e.each,i=e.correctFloat,n=e.seriesType,a=e.merge;n("pareto","line",{zIndex:3},a(t,{setDerivedData:function(){if(this.baseSeries.yData.length>1){var e=this.baseSeries.xData,t=this.baseSeries.yData,s=this.sumPointsPercents(t,e,null,!0);this.setData(this.sumPointsPercents(t,e,s,!1),!1)}},sumPointsPercents:function(e,t,n,a){var r,o=0,u=0,h=[];return s(e,function(e,s){null!==e&&(a?o+=e:(r=e/n*100,h.push([t[s],i(u+r)]),u+=r))}),a?o:h}}))}(e,t)});
!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){var e=function(){var t=function(t){return"function"==typeof t},e=function(e){var i=this,o=i.graphic,n=e.animate,r=e.attr,a=e.onComplete,l=e.css,s=e.group,h=e.renderer,c=e.shapeArgs,d=e.shapeType;i.shouldDraw()?(o||(i.graphic=o=h[d](c).add(s)),o.css(l).attr(r).animate(n,void 0,a)):o&&o.animate(n,void 0,function(){i.graphic=o=o.destroy(),t(a)&&a()}),o&&o.addClass(i.getClassName(),!0)};return e}();!function(t,e){var i=t.each,o=t.extend,n=t.isArray,r=t.isNumber,a=t.isObject,l=t.Series,s=function(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)},h=function(e,i){var o,n=!1,r=e.rect;return e.lastCollidedWith&&(o=e.lastCollidedWith.rect,n=s(r,o),n||delete e.lastCollidedWith),n||(n=!!t.find(i,function(t){var i;return o=t.rect,i=s(r,o),i&&(e.lastCollidedWith=t),i})),n},c=function(t,e){var i=e.field,o=!1,n=i.width*i.width+i.height*i.height,r=.2*t;return 1e4>=t&&(o={x:r*Math.cos(r),y:r*Math.sin(r)},Math.min(Math.abs(o.x),Math.abs(o.y))<n||(o=!1)),o},d=function(t){var e=Math.ceil((Math.sqrt(t)-1)/2),i=2*e+1,o=Math.pow(i,2),n=function(t){return"boolean"==typeof t},r=!1;return i-=1,1e4>=t&&(n(r)&&t>=o-i&&(r={x:e-(o-t),y:-e}),o-=i,n(r)&&t>=o-i&&(r={x:-e,y:-e+(o-t)}),o-=i,n(r)&&(r=t>=o-i?{x:-e+(o-t),y:e}:{x:e,y:e-(o-t-i)}),r.x*=5,r.y*=5),r},u=function(t,e){var i=d(t,e),o=e.field;return i&&(i.x*=o.ratio),i},p=function(t){return Math.round(t*(Math.random()+.5)/2)},f=function(t,e,i){var o=2*Math.max(Math.abs(i.top),Math.abs(i.bottom)),n=2*Math.max(Math.abs(i.left),Math.abs(i.right)),r=1/n*t,a=1/o*e;return Math.min(r,a)},g=function(t,e){var i=t/e;return{width:256*i,height:256,ratio:i}},m=function(t,e,i){var o=i-e,n=o/(t-1),r=Math.floor(Math.random()*t);return e+r*n},x=function(t,e){var i=t.getBBox(),o={left:-(e.width/2),right:e.width/2,top:-(e.height/2),bottom:e.height/2};return!(o.left<i.x&&o.right>i.x+i.width&&o.top<i.y&&o.bottom>i.y+i.height)},y=function(t,e){for(var i=e.placed,n=e.element,r=e.field,l=e.clientRect,s=e.spiral,c=1,d={x:0,y:0},u=t.rect=o({},l);(h(t,i)||x(n,r))&&d!==!1;)d=s(c,{field:r}),a(d)&&(u.left=l.left+d.x,u.right=u.left+u.width,u.top=l.top+d.y,u.bottom=u.top+u.height),c++;return d},v=function(t,e){return(!r(t.left)||t.left>e.left)&&(t.left=e.left),(!r(t.right)||t.right<e.right)&&(t.right=e.right),(!r(t.top)||t.top>e.top)&&(t.top=e.top),(!r(t.bottom)||t.bottom<e.bottom)&&(t.bottom=e.bottom),t},b={animation:{duration:500},borderWidth:0,clip:!1,colorByPoint:!0,placementStrategy:"center",rotation:{from:0,orientations:2,to:90},showInLegend:!1,spiral:"rectangular",style:{fontFamily:"sans-serif",fontWeight:"900"},tooltip:{followPointer:!0,pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.weight}</b><br/>'}},w={animate:l.prototype.animate,bindAxes:function(){var t={endOnTick:!1,gridLineWidth:0,lineWidth:0,maxPadding:0,startOnTick:!1,title:null,tickPositions:[]};l.prototype.bindAxes.call(this),o(this.yAxis.options,t),o(this.xAxis.options,t)},deriveFontSize:function(t){var e=25;return Math.floor(e*t)},drawPoints:function(){var t,e=this,n=e.hasRendered,r=e.xAxis,l=e.yAxis,s=e.chart,h=e.group,c=e.options,d=c.animation,u=s.renderer,p=u.text().add(h),m=[],x=e.placementStrategy[c.placementStrategy],b=e.spirals[c.spiral],w=c.rotation,M=e.points.map(function(t){return t.weight}),A=Math.max.apply(null,M),W=g(r.len,l.len),C=e.points.sort(function(t,e){return e.weight-t.weight});i(C,function(t){var i,r,l,s=1/A*t.weight,f=o({fontSize:e.deriveFontSize(s)+"px",fill:t.color},c.style),g=x(t,{data:C,field:W,placed:m,rotation:w}),M={align:"center",x:g.x,y:g.y,text:t.name,rotation:g.rotation};p.css(f).attr(M),t.clientRect=l=o({},p.element.getBoundingClientRect()),r=y(t,{clientRect:l,element:p,field:W,placed:m,spiral:b}),a(r)?(M.x+=r.x,M.y+=r.y,o(g,{left:M.x-l.width/2,right:M.x+l.width/2,top:M.y-l.height/2,bottom:M.y+l.height/2}),W=v(W,g),m.push(t),t.isNull=!1):t.isNull=!0,d&&(i={x:M.x,y:M.y},n?(delete M.x,delete M.y):(M.x=0,M.y=0)),t.draw({animate:i,attr:M,css:f,group:h,renderer:u,shapeArgs:void 0,shapeType:"text"})}),p=p.destroy(),t=f(r.len,l.len,W),e.group.attr({scaleX:t,scaleY:t})},hasData:function(){var t=this;return a(t)&&t.visible===!0&&n(t.points)&&t.points.length>0},placementStrategy:{random:function(t,e){var i=e.field,o=e.rotation;return{x:p(i.width)-i.width/2,y:p(i.height)-i.height/2,rotation:m(o.orientations,o.from,o.to)}},center:function(t,e){var i=e.rotation;return{x:0,y:0,rotation:m(i.orientations,i.from,i.to)}}},pointArrayMap:["weight"],spirals:{archimedean:c,rectangular:u,square:d},getPlotBox:function(){var t=this,e=t.chart,i=e.inverted,o=t[i?"yAxis":"xAxis"],n=t[i?"xAxis":"yAxis"],r=o?o.len:e.plotWidth,a=n?n.len:e.plotHeight,l=o?o.left:e.plotLeft,s=n?n.top:e.plotTop;return{translateX:l+r/2,translateY:s+a/2,scaleX:1,scaleY:1}}},M={draw:e,shouldDraw:function(){var t=this;return!t.isNull}};t.seriesType("wordcloud","column",b,w,M)}(t,e)});
!function(r){function t(r,t){for(var e,n,o,a=[],s="y",i=0,n=r.length-(t-1);n>i;i++){e=0;for(var g=0;t>g;g++)e+=r[i+g][s];o=e/t,a.push([r[i].x+(t-1),o])}var h="y = Ai + Ai+1";return{equation:[1,1],points:a,string:h}}function e(r){var t=[0,0,0,0,0,0],e=0,n=[];for(g=r.length;g>e;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][0]*r[e][0]*r[e][1],t[3]+=r[e][1]*Math.log(r[e][1]),t[4]+=r[e][0]*r[e][1]*Math.log(r[e][1]),t[5]+=r[e][0]*r[e][1]);for(var o=t[1]*t[2]-t[5]*t[5],a=Math.pow(Math.E,(t[2]*t[3]-t[5]*t[4])/o),s=(t[1]*t[4]-t[5]*t[3])/o,i=0,g=r.length;g>i;i++){var h=[r[i][0],a*Math.pow(Math.E,s*r[i][0])];n.push(h)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var u="y = "+Math.round(100*a)/100+"e^("+Math.round(100*s)/100+"x)";return{equation:[a,s],points:n,string:u}}function n(r){var t=[0,0,0,0,0],e=0,n=[];for(r.length;e<r.length;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=r[e][0],t[1]+=r[e][1],t[2]+=r[e][0]*r[e][0],t[3]+=r[e][0]*r[e][1],t[4]+=r[e][1]*r[e][1]);for(var o=(e*t[3]-t[0]*t[1])/(e*t[2]-t[0]*t[0]),a=t[1]/e-o*t[0]/e,s=0,i=r.length;i>s;s++){var g=[r[s][0],r[s][0]*o+a];n.push(g)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var h="y = "+Math.round(100*o)/100+"x + "+Math.round(100*a)/100;return{equation:[o,a],points:n,string:h}}function o(r){var t=[0,0,0,0],e=0,n=[];for(i=r.length;i>e;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=Math.log(r[e][0]),t[1]+=r[e][1]*Math.log(r[e][0]),t[2]+=r[e][1],t[3]+=Math.pow(Math.log(r[e][0]),2));for(var o=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]),a=(t[2]-o*t[0])/e,s=0,i=r.length;i>s;s++){var g=[r[s][0],a+o*Math.log(r[s][0])];n.push(g)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var h="y = "+Math.round(100*a)/100+" + "+Math.round(100*o)/100+" ln(x)";return{equation:[a,o],points:n,string:h}}function a(r){var t=[0,0,0,0],e=0,n=[];for(i=r.length;i>e;e++)r[e].x&&(r[e][0]=r[e].x,r[e][1]=r[e].y),r[e][1]&&(t[0]+=Math.log(r[e][0]),t[1]+=Math.log(r[e][1])*Math.log(r[e][0]),t[2]+=Math.log(r[e][1]),t[3]+=Math.pow(Math.log(r[e][0]),2));for(var o=(e*t[1]-t[2]*t[0])/(e*t[3]-t[0]*t[0]),a=Math.pow(Math.E,(t[2]-o*t[0])/e),s=0,i=r.length;i>s;s++){var g=[r[s][0],a*Math.pow(r[s][0],o)];n.push(g)}n.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});var h="y = "+Math.round(100*a)/100+"x^"+Math.round(100*o)/100;return{equation:[a,o],points:n,string:h}}function s(r,t){"undefined"==typeof t&&(t=2);for(var e=[],n=[],o=[],a=0,s=0,i=0,h=t+1;h>i;i++){for(var u=0,l=r.length;l>u;u++)r[u].x&&(r[u][0]=r[u].x,r[u][1]=r[u].y),r[u][1]&&(a+=Math.pow(r[u][0],i)*r[u][1]);e.push(a),a=0;for(var f=[],p=0;h>p;p++){for(var u=0,l=r.length;l>u;u++)r[u][1]&&(s+=Math.pow(r[u][0],i+p));f.push(s),s=0}n.push(f)}n.push(e);for(var v=g(n,h),i=0,l=r.length;l>i;i++){for(var d=0,M=0;M<v.length;M++)d+=v[M]*Math.pow(r[i][0],M);o.push([r[i][0],d])}o.sort(function(r,t){return r[0]>t[0]?1:r[0]<t[0]?-1:0});for(var c="y = ",i=v.length-1;i>=0;i--)c+=i>1?Math.round(100*v[i])/100+"x^"+i+" + ":1==i?Math.round(100*v[i])/100+"x + ":Math.round(100*v[i])/100;return{equation:v,points:o,string:c}}function i(r,t){function e(r){var t,e={},n=r.length,o=[];for(t=0;n>t;t+=1)e[r[t]]=r[t];for(t in e)o.push(e[t]);return o}function n(r){var t=1-r*r*r;return t*t*t}var t=t||.25,o=r.map(function(r){return r[0]}),a=e(o);2/a.length>t&&(t=Math.min(2/a.length,1));var s=r.map(function(r){return r[1]}),i=[],g=0,h=Math.floor(t*o.length)-1;for(var u in o){var l=o[u];u>0&&h<o.length-1&&o[h+1]-o[u]<o[u]-o[g]&&(g++,h++);var f;f=o[u]-o[g]>o[h]-o[u]?g:h;for(var p=Math.abs(1/(o[f]-l)),v=0,d=0,M=0,c=0,y=0,S=g;h>=S;){var x,m=o[S],w=s[S];x=u>S?l-m:m-l;var q=n(x*p),b=m*q;v+=q,d+=b,M+=m*b,c+=w*q,y+=w*b,S++}var A,L=d/v,E=c/v,I=y/v,k=M/v;A=k==L*L?0:(I-L*E)/(k-L*L);var F=E-A*L;i[u]=A*l+F}return{equation:"",points:o.map(function(r,t){return[r,i[t]]}),string:""}}function g(r,t){var e=0,n=0,o=0,a=0,s=0,i=r.length-1,g=new Array(t);for(e=0;i>e;e++){for(a=e,n=e+1;i>n;n++)Math.abs(r[e][n])>Math.abs(r[e][a])&&(a=n);for(o=e;i+1>o;o++)s=r[o][e],r[o][e]=r[o][a],r[o][a]=s;for(n=e+1;i>n;n++)for(o=i;o>=e;o--)r[o][n]-=r[o][e]*r[e][n]/r[e][e]}for(n=i-1;n>=0;n--){for(s=0,o=n+1;i>o;o++)s+=r[o][n]*g[o];g[n]=(r[i][n]-s)/r[n][n]}return g}function h(r,t){var e,n,o,a;for(e=n=o=a=0,e=0;e<r.length;e++)a+=r[e][1]/r.length;for(e=0;e<r.length;e++)o+=Math.pow(r[e][1]-t[e][1],2),n+=Math.pow(r[e][1]-a,2);return 1-o/n}r.wrap(r.Chart.prototype,"init",function(r){var g=arguments[1].series,u=arguments[1].legend,l=arguments[1].colors||[],f=[],p=0;for(p=0;p<g.length;p++){var v=g[p];if(v.regression&&!v.rendered){v.regressionSettings=v.regressionSettings||{},v.regressionSettings.tooltip=v.regressionSettings.tooltip||{},v.regressionSettings.dashStyle=v.regressionSettings.dashStyle||"solid",v.regressionSettings.showInLegend=v.regressionSettings.showInLegend||u.enabled;var d,M=v.regressionSettings.type||"linear",c={data:[],color:v.color,yAxis:v.yAxis,lineWidth:2,marker:{enabled:!1},isRegressionLine:!0,type:v.regressionSettings.linetype||"spline",name:v.regressionSettings.name||"Equation: %eq",color:v.regressionSettings.color||l[p]||"",dashStyle:v.regressionSettings.dashStyle||"solid",showInLegend:v.regressionSettings.showInLegend,tooltip:{valueSuffix:v.regressionSettings.tooltip.valueSuffix||" "}};if("linear"==M)d=n(v.data),c.type="line";else if("exponential"==M)d=e(v.data);else if("polynomial"==M){var y=v.regressionSettings.order||2;d=s(v.data,y)}else if("logarithmic"==M)d=o(v.data);else if("loess"==M){var S=v.regressionSettings.loessSmooth||25;d=i(v.data,S/100)}else if("power"==M)d=a(v.data);else{if("average"!=M)break;var x=v.regressionSettings.period||v.regressionSettings.order||2;d=t(v.data,x)}"average"!==M&&(d.rSquared=h(v.data,d.points).toFixed(2),d.rValue=Math.sqrt(d.rSquared,2).toFixed(2),c.name=c.name.replace("%r2",d.rSquared),c.name=c.name.replace("%r",d.rValue),c.name=c.name.replace("%eq",d.string)),c.data=d.points,c.regressionOutputs=d,f.push(c),arguments[1].series[p].rendered=!0}}arguments[1].series=g.concat(f),r.apply(this,Array.prototype.slice.call(arguments,1))})}(Highcharts);
!function(t){function i(t,i){return this.userOptions=h(t),this.name=t.name||t,this.parent=i,this}function e(t){for(var i=t.length,e=0;i--;)e+=t[i];return e}function s(t,i,e,a,o){var n,h=t.length;for(o||(o=0),e.depth||(e.depth=0);h--;)n=t[h],a&&"object"==typeof n&&(n.parent=a),n.categories?s(n.categories,i,e,n,o+1):r(i,n,a);e.depth=d(e.depth,o)}function r(t,e,s){for(t.unshift(new i(e,s));s;)s.leaves++||(s.leaves=1),s=s.parent}function a(t,i,e){i[0]===i[2]&&(i[0]=i[2]=c(i[0])-e%2/2),i[1]===i[3]&&(i[1]=i[3]=c(i[1])+e%2/2),t.push("M",i[0],i[1],"L",i[2],i[3])}function o(t,i){return t.getPosition(t.axis.horiz,i,t.axis.tickmarkOffset)}function n(t,i,e){for(var s,r=t.length;r--;)s=t[r][i],s&&n(s,i,e),e(t[r])}function h(t){return JSON.parse(JSON.stringify(t))}var l=void 0,c=Math.round,p=Math.min,d=Math.max,u=t.merge,g=t.pick,f=window.HighchartsAdapter&&window.HighchartsAdapter.inArray||t.inArray,x=t.Axis.prototype,b=t.Tick.prototype,y=x.init,v=x.render,k=x.setCategories,G=b.getLabelSize,z=b.addLabel,S=b.destroy,m=b.render;i.prototype.toString=function(){for(var t=[],i=this;i;)t.push(i.name),i=i.parent;return t.join(" ")},x.init=function(t,i){y.call(this,t,i),"object"==typeof i&&i.categories&&this.setupGroups(i)},x.setupGroups=function(t){var i,e=[],r={};i=h(t.categories),s(i,e,r),this.categoriesTree=i,this.categories=e,this.isGrouped=0!==r.depth,this.labelsDepth=r.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=t.tickLength||this.tickLength||null,this.tickWidth=g(t.tickWidth,this.isXAxis?1:0),this.directionFactor=[-1,1,1,-1][this.side],this.options.lineWidth=g(t.lineWidth,1)},x.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===l&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,v.call(this),!this.isGrouped)return void(this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}));var t,i=this,e=i.options,s=i.top,r=i.left,a=r+i.width,o=s+i.height,h=i.hasVisibleSeries||("function"==typeof i.hasData?i.hasData():i.hasData),c=i.labelsDepth,p=i.labelsGrid,d=i.horiz,u=i.labelsGridPath,g=e.drawHorizontalBorders===!1?c+1:0,f=i.opposite?d?s:a:d?o:r,x=i.tickWidth;for(i.userTickLength&&(c-=1),p||(p=i.labelsGrid=i.chart.renderer.path().attr({strokeWidth:x,"stroke-width":x,stroke:e.tickColor}).add(i.axisGroup));c>=g;)f+=i.groupSize(g),t=d?[r,f,a,f]:[f,s,f,o],g++;p.attr({d:u,visibility:h?"visible":"hidden"}),i.labelGroup.attr({visibility:h?"visible":"hidden"}),n(i.categoriesTree,"categories",function(t){var e=t.tick;e&&(e.startAt+e.leaves-1<i.min||e.startAt>i.max?(e.label.hide(),e.destroyed=0):e.label.attr({visibility:h?"visible":"hidden"}))})},x.setCategories=function(t,i){this.categories&&this.cleanGroups(),this.setupGroups({categories:t}),this.categories=this.userOptions.categories=t,k.call(this,this.categories,i)},x.cleanGroups=function(){var t,i=this.ticks;for(t in i)i[t].parent&&delete i[t].parent;n(this.categoriesTree,"categories",function(t){var i,e=t.tick;if(e){e.label.destroy();for(i in e)delete e[i];delete t.tick}}),this.labelsGrid=null},x.groupSize=function(t,i){var s=this.labelsSizes,r=this.directionFactor,a=this.options.labels.groupedOptions?this.options.labels.groupedOptions[t-1]:!1,o=0;return a&&(o=-1==r?a.x?a.x:0:a.y?a.y:0),i!==l&&(s[t]=d(s[t]||0,i+10+Math.abs(o))),t===!0?e(s)*r:s[t]?s[t]*r:0},b.addLabel=function(){var t;z.call(this),this.axis.categories&&(t=this.axis.categories[this.pos])&&(this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:t.name})),this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(t))},b.addGroupedLabels=function(t){for(var i,e,s,r,a=this,o=this.axis,n=o.chart,h=o.options.labels,l=h.useHTML,c=h.style,p=h.groupedOptions,d={align:"center",rotation:h.rotation,x:0,y:0},g=o.horiz?"height":"width",f=0;a;){if(f>0&&!t.tick){this.value=t.name;var x=h.formatter?h.formatter.call(this,t):t.name,b=p&&p[f-1],y=b?u(d,p[f-1]):d,v=b&&p[f-1].style?u(c,p[f-1].style):c;delete y.style,e=this.axis.width/this.axis.categories.length*t.leaves-20,s=parseInt(v.fontSize)*x.length,s=s>e?s-e:0,s=0==s?0:s/parseInt(v.fontSize),r=x=x.trim(),x=x.substring(0,x.length-s),x=x.split("...")[0],x+=r!=x&&-1===x.indexOf("...")?"...":"",i=n.renderer.text(x,0,0,l|!0).attr(y).css(v).add(o.labelGroup),a.startAt=this.pos,a.childCount=t.categories.length,a.leaves=t.leaves,a.visible=this.childCount,a.label=i,a.labelOffsets=-1!==n.options.chart.type.indexOf("bar")?{x:y.x-5,y:y.y}:{x:y.x,y:y.y+10},t.tick=a}o.groupSize(f,a.label.getBBox()[g]),t=t.parent,a=t?a.parent=t.tick||{}:null,f++}},b.render=function(t,i,e){function s(t,i){var e=0;return k?(e=f(i.name,i.parent.categories),e=0>e?0:e):e}m.call(this,t,i,e);var r=this.axis.categories[this.pos];if(this.axis.isGrouped&&r&&!(this.pos>this.axis.max)){var n,h,l,c,u,g,x=this,b=x,y=x.axis,v=x.pos,k=x.isFirst,G=y.max,z=y.min,S=y.horiz,L=(y.categories[v],y.labelsGridPath),O=y.groupSize(0),A=(y.tickLength||O,y.tickWidth),w=(y.directionFactor,o(x,v)),T=S?w.y:w.x,F=y.chart.renderer.fontMetrics(y.options.labels.style.fontSize).b,M=1,W=S&&w.x===y.pos+y.len||!S&&w.y===y.pos?-1:0;for(k&&(n=S?[y.left,w.y,y.left,w.y+y.groupSize(!0)]:y.isXAxis?[w.x,y.top,w.x+y.groupSize(!0),y.top]:[w.x,y.top+y.len,w.x+y.groupSize(!0),y.top+y.len],a(L,n,A)),S&&y.left<w.x?a(L,[w.x-W,w.y,w.x-W,w.y+O],A):!S&&y.top<=w.y&&a(L,[w.x,w.y+W,w.x+O,w.y+W],A),O=T+O;b=b.parent;){var N=s(b,r,x),B=b.labelOffsets.x,C=b.labelOffsets.y;l=o(x,d(b.startAt-1,z-1)),c=o(x,p(b.startAt+b.leaves-1-N,G)),g=b.label.getBBox(0),h=y.groupSize(M),W=S&&c.x===y.pos+y.len||!S&&c.y===y.pos?-1:0,u=S?{x:(l.x+c.x)/2+B,y:O+h/2+F-g.height/2-4+C/2}:{x:O+h/2+B,y:(l.y+c.y-g.height)/2+F+C},isNaN(u.x)||isNaN(u.y)||(b.label.attr(u),L&&(S&&y.left<c.x?a(L,[c.x-W,O,c.x-W,O+h],A):!S&&y.top<=c.y&&a(L,[O,c.y+W,O+h,c.y+W],A))),O+=h,M++}}},b.destroy=function(){for(var t=this;t=t.parent;)t.destroyed++||(t.destroyed=1);S.call(this)},b.getLabelSize=function(){if(this.axis.isGrouped===!0){var t=G.call(this)+10,i=this.axis.labelsSizes[0];return t>i&&(this.axis.labelsSizes[0]=t),e(this.axis.labelsSizes)}return G.call(this)}}(Highcharts);
function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var f={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var a in f)e==a&&(e=f[a]);for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],t=0;t<r.length;t++){var d=r[t].re,l=r[t].process,i=d.exec(e);if(i){var n=l(i);this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),f=this.g.toString(16),a=this.b.toString(16);return 1==e.length&&(e="0"+e),1==f.length&&(f="0"+f),1==a.length&&(a="0"+a),"#"+e+f+a},this.getHelpXML=function(){for(var e=new Array,a=0;a<r.length;a++)for(var t=r[a].example,d=0;d<t.length;d++)e[e.length]=t[d];for(var l in f)e[e.length]=l;var i=document.createElement("ul");i.setAttribute("id","rgbcolor-examples");for(var a=0;a<e.length;a++)try{var n=document.createElement("li"),o=new RGBColor(e[a]),s=document.createElement("div");s.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),s.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[a]+" -> "+o.toRGB()+" -> "+o.toHex());n.appendChild(s),n.appendChild(c),i.appendChild(n)}catch(e){}return i}}
!function(t,e){"undefined"!=typeof define&&define.amd?define("canvgModule",["rgbcolor","stackblur"],e):"undefined"!=typeof module&&module.exports&&(module.exports=e(require("rgbcolor"),require("stackblur"))),t.canvg=e(t.RGBColor,t.stackBlur)}("undefined"!=typeof window?window:this,function(t,e){function i(t){var e=[0,0,0],i=function(i,n){var s=t.match(i);null!=s&&(e[n]+=s.length,t=t.replace(i," "))};return t=t.replace(/:not\(([^\)]*)\)/g,"     $1 "),t=t.replace(/{[\s\S]*/gm," "),i(r,1),i(o,0),i(h,1),i(l,2),i(u,1),i(c,1),t=t.replace(/[\*\s\+>~]/g," "),t=t.replace(/[#\.]/g," "),i(f,2),e.join("")}function n(n){var a={opts:n};a.FRAMERATE=30,a.MAX_VIRTUAL_PIXELS=3e4,a.log=function(){},1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(t){}),a.init=function(t){var e=0;a.UniqueId=function(){return e++,"canvg"+e},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=t,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var t=0;t<a.Images.length;t++)if(!a.Images[t].loaded)return!1;return!0},a.trim=function(t){return t=t||"",t.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},a.ajax=function(t){var e;return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e?(e.open("GET",t,!1),e.send(null),e.responseText):null},a.parseXml=function(t){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,e.loadXml(t,i),e}if(!window.DOMParser){t=t.replace(/<!DOCTYPE svg[^>]*>/,"");var e=new ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}try{var n=new DOMParser;return n.parseFromString(t,"image/svg+xml")}catch(e){return n=new DOMParser,n.parseFromString(t,"text/xml")}},a.Property=function(t,e){this.name=t,this.value=e},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},a.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},a.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},a.Property.prototype.addOpacity=function(e){var i=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var n=new t(this.value);n.ok&&(i="rgba("+n.r+", "+n.g+", "+n.b+", "+e.numValue()+")")}return new a.Property(this.name,i)},a.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),a.Definitions[t]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(t,e){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(a.ctx,t,e);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var n=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),n.hasValue()&&(i.attribute("patternTransform",!0).value=n.value)}return i.createPattern(a.ctx,t)}return null},a.Property.prototype.getDPI=function(){return 96},a.Property.prototype.getEM=function(t){var e=12,i=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);return i.hasValue()&&(e=i.toPixels(t)),e},a.Property.prototype.getUnits=function(){var t=this.value+"";return t.replace(/[0-9\.\-]/g,"")},a.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/em$/))return this.numValue()*this.getEM(t);if(i.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(t);if(i.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(t);var n=this.numValue();return e&&1>n?n*a.ViewPort.ComputeSize(t):n},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var r={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?r[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,i,n,s,r){var o=null!=r?this.Parse(r):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:s||o.fontFamily,fontSize:n||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:i||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var i={},n=a.trim(a.compressSpaces(e||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},r="",o=0;o<n.length;o++)s.fontStyle||-1==t.Styles.indexOf(n[o])?s.fontVariant||-1==t.Variants.indexOf(n[o])?s.fontWeight||-1==t.Weights.indexOf(n[o])?s.fontSize?"inherit"!=n[o]&&(r+=n[o]):("inherit"!=n[o]&&(i.fontSize=n[o].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0):("inherit"!=n[o]&&(i.fontWeight=n[o]),s.fontStyle=s.fontVariant=s.fontWeight=!0):("inherit"!=n[o]&&(i.fontVariant=n[o]),s.fontStyle=s.fontVariant=!0):("inherit"!=n[o]&&(i.fontStyle=n[o]),s.fontStyle=!0);return""!=r&&(i.fontFamily=r),i}},a.ToNumberArray=function(t){for(var e=a.trim(a.compressSpaces((t||"").replace(/,/g," "))).split(" "),i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return e},a.Point=function(t,e){this.x=t,this.y=e},a.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},a.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],i=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=i},a.CreatePoint=function(t){var e=a.ToNumberArray(t);return new a.Point(e[0],e[1])},a.CreatePath=function(t){for(var e=a.ToNumberArray(t),i=[],n=0;n<e.length;n+=2)i.push(new a.Point(e[n],e[n+1]));return i},a.BoundingBox=function(t,e,i,n){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,i,n,s,a){var r=t+2/3*(i-t),o=e+2/3*(n-e),h=r+1/3*(s-t),l=o+1/3*(a-e);this.addBezierCurve(t,e,r,h,o,l,s,a)},this.addBezierCurve=function(t,e,i,n,s,a,r,o){var h=[t,e],l=[i,n],u=[s,a],c=[r,o];this.addPoint(h[0],h[1]),this.addPoint(c[0],c[1]);for(var f=0;1>=f;f++){var p=function(t){return Math.pow(1-t,3)*h[f]+3*Math.pow(1-t,2)*t*l[f]+3*(1-t)*Math.pow(t,2)*u[f]+Math.pow(t,3)*c[f]},d=6*h[f]-12*l[f]+6*u[f],m=-3*h[f]+9*l[f]-9*u[f]+3*c[f],y=3*l[f]-3*h[f];if(0!=m){var v=Math.pow(d,2)-4*y*m;if(!(0>v)){var g=(-d+Math.sqrt(v))/(2*m);g>0&&1>g&&(0==f&&this.addX(p(g)),1==f&&this.addY(p(g)));var x=(-d-Math.sqrt(v))/(2*m);x>0&&1>x&&(0==f&&this.addX(p(x)),1==f&&this.addY(p(x)))}}else{if(0==d)continue;var b=-y/d;b>0&&1>b&&(0==f&&this.addX(p(b)),1==f&&this.addY(p(b)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(i,n)},a.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=a.ToNumberArray(t);this.angle=new a.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=a.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],i=this.m[2],n=this.m[4],s=this.m[1],a=this.m[3],r=this.m[5],o=0,h=0,l=1,u=1/(e*(a*l-r*h)-i*(s*l-r*o)+n*(s*h-a*o));t.transform(u*(a*l-r*h),u*(r*o-s*l),u*(n*h-i*l),u*(e*l-n*o),u*(i*r-n*a),u*(n*s-e*r))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new a.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;e>=0;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var i=a.trim(a.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),n=0;n<i.length;n++){var s=a.trim(i[n].split("(")[0]),r=i[n].split("(")[1].replace(")",""),o=this.Type[s];if("undefined"!=typeof o){var h=new o(r);h.type=s,this.transforms.push(h)}}},a.AspectRatio=function(t,e,i,n,s,r,o,h,l,u){e=a.compressSpaces(e),e=e.replace(/^defer\s/,"");var c=e.split(" ")[0]||"xMidYMid",f=e.split(" ")[1]||"meet",p=i/n,d=s/r,m=Math.min(p,d),y=Math.max(p,d);"meet"==f&&(n*=m,r*=m),"slice"==f&&(n*=y,r*=y),l=new a.Property("refX",l),u=new a.Property("refY",u),l.hasValue()&&u.hasValue()?t.translate(-m*l.toPixels("x"),-m*u.toPixels("y")):(c.match(/^xMid/)&&("meet"==f&&m==d||"slice"==f&&y==d)&&t.translate(i/2-n/2,0),c.match(/YMid$/)&&("meet"==f&&m==p||"slice"==f&&y==p)&&t.translate(0,s/2-r/2),c.match(/^xMax/)&&("meet"==f&&m==d||"slice"==f&&y==d)&&t.translate(i-n,0),c.match(/YMax$/)&&("meet"==f&&m==p||"slice"==f&&y==p)&&t.translate(0,s-r)),"none"==c?t.scale(p,d):"meet"==f?t.scale(m,m):"slice"==f&&t.scale(y,y),t.translate(null==o?0:-o,null==h?0:-h)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var i=this.attributes[t];return null!=i?i:(1==e&&(i=new a.Property(t,""),this.attributes[t]=i),i||a.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return a.EmptyProperty},this.style=function(t,e,i){var n=this.styles[t];if(null!=n)return n;var s=this.attribute(t);if(null!=s&&s.hasValue())return this.styles[t]=s,s;if(1!=i){var r=this.parent;if(null!=r){var o=r.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(n=new a.Property(t,""),this.styles[t]=n),n||a.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var i=this.style("filter").getDefinition();null!=i&&i.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var i=t;e&&(i=a.CreateElement(t)),i.parent=this,"title"!=i.type&&this.children.push(i)},this.addStylesFromStyleDefinition=function(){for(var e in a.Styles)if("@"!=e[0]&&s(t,e)){var i=a.Styles[e],n=a.StylesSpecificity[e];if(null!=i)for(var r in i){var o=this.stylesSpecificity[r];"undefined"==typeof o&&(o="000"),n>o&&(this.styles[r]=i[r],this.stylesSpecificity[r]=n)}}};var e=new RegExp("^[A-Z-]+$"),i=function(t){return e.test(t)?t.toLowerCase():t};if(null!=t&&1==t.nodeType){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n],o=i(r.nodeName);this.attributes[o]=new a.Property(o,r.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var h=this.attribute("style").value.split(";"),n=0;n<h.length;n++)if(""!=a.trim(h[n])){var l=h[n].split(":"),u=a.trim(l[0]),c=a.trim(l[1]);this.styles[u]=new a.Property(u,c)}this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this);for(var n=0;n<t.childNodes.length;n++){var f=t.childNodes[n];if(1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&(3==f.nodeType||4==f.nodeType)){var p=f.value||f.text||f.textContent||"";""!=a.compressSpaces(p)&&this.addChild(new a.Element.tspan(f),!1)}}}},a.Element.RenderedElementBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.setContext=function(t){if(this.style("fill").isUrlDefinition()){var e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=e&&(t.fillStyle=e)}else if(this.style("fill").hasValue()){var i=this.style("fill");"currentColor"==i.value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("fill-opacity").hasValue()){var i=new a.Property("fill",t.fillStyle);i=i.addOpacity(this.style("fill-opacity")),t.fillStyle=i.value}if(this.style("stroke").isUrlDefinition()){var e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=e&&(t.strokeStyle=e)}else if(this.style("stroke").hasValue()){var n=this.style("stroke");"currentColor"==n.value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.strokeStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("stroke-opacity").hasValue()){var n=new a.Property("stroke",t.strokeStyle);n=n.addOpacity(this.style("stroke-opacity")),t.strokeStyle=n.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var r=a.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof t.setLineDash?t.setLineDash(r):"undefined"!=typeof t.webkitLineDash?t.webkitLineDash=r:"undefined"==typeof t.mozDash||1==r.length&&0==r[0]||(t.mozDash=r);var o=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof t.lineDashOffset?t.lineDashOffset=o:"undefined"!=typeof t.webkitLineDashOffset?t.webkitLineDashOffset=o:"undefined"!=typeof t.mozDashOffset&&(t.mozDashOffset=o)}if("undefined"!=typeof t.font&&(t.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()){var h=new a.Transform(this.style("transform",!1,!0).value);h.apply(t)}if(this.style("clip-path",!1,!0).hasValue()){var l=this.style("clip-path",!1,!0).getDefinition();null!=l&&l.apply(t)}this.style("opacity").hasValue()&&(t.globalAlpha=this.style("opacity").numValue())}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new a.BoundingBox},this.renderChildren=function(t){this.path(t),a.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()){var i=this.style("marker-start").getDefinition();i.render(t,e[0][0],e[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var i=this.style("marker-mid").getDefinition(),n=1;n<e.length-1;n++)i.render(t,e[n][0],e[n][1]);if(this.style("marker-end").isUrlDefinition()){var i=this.style("marker-end").getDefinition();i.render(t,e[e.length-1][0],e[e.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,"undefined"!=typeof t.font&&"undefined"!=typeof window.getComputedStyle&&(t.font=window.getComputedStyle(t.canvas).getPropertyValue("font")),this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var e=a.ViewPort.width(),i=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){e=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var n=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(n=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(n,s),t.lineTo(e,s),t.lineTo(e,i),t.lineTo(n,i),t.closePath(),t.clip())}if(a.ViewPort.SetCurrent(e,i),this.attribute("viewBox").hasValue()){var r=a.ToNumberArray(this.attribute("viewBox").value),o=r[0],h=r[1];e=r[2],i=r[3],a.AspectRatio(t,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),e,a.ViewPort.height(),i,o,h,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(r[2],r[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),r=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=r),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(r=o),r=Math.min(r,n/2),o=Math.min(o,s/2),null!=t&&(t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.quadraticCurveTo(e+n,i,e+n,i+o),t.lineTo(e+n,i+s-o),t.quadraticCurveTo(e+n,i+s,e+n-r,i+s),t.lineTo(e+r,i+s),t.quadraticCurveTo(e,i+s,e,i+s-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+r,i),t.closePath()),new a.BoundingBox(e,i,e+n,i+s)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),n=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!0),t.closePath()),new a.BoundingBox(e-n,i-n,e+n,i+n)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=4*((Math.sqrt(2)-1)/3),i=this.attribute("rx").toPixels("x"),n=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(s,r-n),t.bezierCurveTo(s+e*i,r-n,s+i,r-e*n,s+i,r),t.bezierCurveTo(s+i,r+e*n,s+e*i,r+n,s,r+n),t.bezierCurveTo(s-e*i,r+n,s-i,r+e*n,s-i,r),t.bezierCurveTo(s-i,r-e*n,s-e*i,r-n,s,r-n),t.closePath()),new a.BoundingBox(s-i,r-n,s+i,r+n)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(t){this.base=a.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new a.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(t){this.base=a.Element.PathElementBase,this.base(t),this.points=a.CreatePath(this.attribute("points").value),this.path=function(t){var e=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)e.addPoint(this.points[i].x,this.points[i].y),null!=t&&t.lineTo(this.points[i].x,this.points[i].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return t.length>0&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(t){this.base=a.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(t){this.base=a.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var i=0;2>i;i++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),e=e.replace(/([0-9])([+\-])/gm,"$1 $2");for(var i=0;2>i;i++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=a.compressSpaces(e),e=a.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t,t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t,t},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var t=new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,i){null!=i&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var i=new a.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var n=e.getAsCurrentPoint();for(e.addMarker(n),i.addPoint(n.x,n.y),null!=t&&t.moveTo(n.x,n.y),e.start=e.current;!e.isCommandOrEnd();){var n=e.getAsCurrentPoint();e.addMarker(n,e.start),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"L":case"l":for(;!e.isCommandOrEnd();){var s=e.current,n=e.getAsCurrentPoint();e.addMarker(n,s),i.addPoint(n.x,n.y),null!=t&&t.lineTo(n.x,n.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var r=new a.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();){var r=new a.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar());e.addMarker(r,e.current),e.current=r,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,h=e.getPoint(),l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,h),i.addBezierCurve(o.x,o.y,h.x,h.y,l.x,l.y,u.x,u.y),null!=t&&t.bezierCurveTo(h.x,h.y,l.x,l.y,u.x,u.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();){var o=e.current,h=e.getReflectedControlPoint(),l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,h),i.addBezierCurve(o.x,o.y,h.x,h.y,l.x,l.y,u.x,u.y),null!=t&&t.bezierCurveTo(h.x,h.y,l.x,l.y,u.x,u.y)}break;case"Q":case"q":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y),null!=t&&t.quadraticCurveTo(l.x,l.y,u.x,u.y)}break;case"T":case"t":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getReflectedControlPoint();e.control=l;var u=e.getAsCurrentPoint();e.addMarker(u,l,l),i.addQuadraticCurve(o.x,o.y,l.x,l.y,u.x,u.y),null!=t&&t.quadraticCurveTo(l.x,l.y,u.x,u.y)}break;case"A":case"a":for(;!e.isCommandOrEnd();){var o=e.current,c=e.getScalar(),f=e.getScalar(),p=e.getScalar()*(Math.PI/180),d=e.getScalar(),m=e.getScalar(),u=e.getAsCurrentPoint(),y=new a.Point(Math.cos(p)*(o.x-u.x)/2+Math.sin(p)*(o.y-u.y)/2,-Math.sin(p)*(o.x-u.x)/2+Math.cos(p)*(o.y-u.y)/2),v=Math.pow(y.x,2)/Math.pow(c,2)+Math.pow(y.y,2)/Math.pow(f,2);v>1&&(c*=Math.sqrt(v),f*=Math.sqrt(v));var g=(d==m?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(y.y,2)-Math.pow(f,2)*Math.pow(y.x,2))/(Math.pow(c,2)*Math.pow(y.y,2)+Math.pow(f,2)*Math.pow(y.x,2)));isNaN(g)&&(g=0);var x=new a.Point(g*c*y.y/f,g*-f*y.x/c),b=new a.Point((o.x+u.x)/2+Math.cos(p)*x.x-Math.sin(p)*x.y,(o.y+u.y)/2+Math.sin(p)*x.x+Math.cos(p)*x.y),P=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(P(t)*P(e))},w=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},C=w([1,0],[(y.x-x.x)/c,(y.y-x.y)/f]),B=[(y.x-x.x)/c,(y.y-x.y)/f],M=[(-y.x-x.x)/c,(-y.y-x.y)/f],T=w(B,M);E(B,M)<=-1&&(T=Math.PI),E(B,M)>=1&&(T=0);var V=1-m?1:-1,S=C+V*(T/2),k=new a.Point(b.x+c*Math.cos(S),b.y+f*Math.sin(S));if(e.addMarkerAngle(k,S-V*Math.PI/2),e.addMarkerAngle(u,S-V*Math.PI),i.addPoint(u.x,u.y),null!=t){var E=c>f?c:f,A=c>f?1:c/f,D=c>f?f/c:1;t.translate(b.x,b.y),t.rotate(p),t.scale(A,D),t.arc(0,0,E,C,C+T,1-m),t.scale(1/A,1/D),t.rotate(-p),t.translate(-b.x,-b.y)}}break;case"Z":case"z":null!=t&&t.closePath(),e.current=e.start}return i},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),i=[],n=0;n<t.length;n++)i.push([t[n],e[n]]);return i}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(t){this.base=a.Element.ElementBase,this.base(t),this.createPattern=function(t){var e=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),n=new a.Element.svg;n.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),n.attributes.width=new a.Property("width",e+"px"),n.attributes.height=new a.Property("height",i+"px"),n.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),n.children=this.children;var s=document.createElement("canvas");s.width=e,s.height=i;var r=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&r.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var o=-1;1>=o;o++)for(var h=-1;1>=h;h++)r.save(),n.attributes.x=new a.Property("x",o*s.width),n.attributes.y=new a.Property("y",h*s.height),n.render(r),r.restore();var l=t.createPattern(s,"repeat");return l}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(t){this.base=a.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,i){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var n=new a.Element.svg;n.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),n.attributes.refX=new a.Property("refX",this.attribute("refX").value),n.attributes.refY=new a.Property("refY",this.attribute("refY").value),n.attributes.width=new a.Property("width",this.attribute("markerWidth").value),n.attributes.height=new a.Property("height",this.attribute("markerHeight").value),n.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),n.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),n.children=this.children,n.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-i),t.translate(-e.x,-e.y)}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(t){this.base=a.Element.ElementBase,this.base(t),this.render=function(){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var i=this.attributesToInherit[e];!this.attribute(i).hasValue()&&t.attribute(i).hasValue()&&(this.attribute(i,!0).value=t.attribute(i).value)}},this.createGradient=function(t,e,i){var n=this;this.getHrefAttribute().hasValue()&&(n=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(n));var s=function(t){if(i.hasValue()){var e=new a.Property("color",t);return e.addOpacity(i).value}return t},r=this.getGradient(t,e);if(null==r)return s(n.stops[n.stops.length-1].color);for(var o=0;o<n.stops.length;o++)r.addColorStop(n.stops[o].offset,s(n.stops[o].color));if(this.attribute("gradientTransform").hasValue()){var h=a.ViewPort.viewPorts[0],l=new a.Element.rect;l.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),l.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),l.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),l.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var u=new a.Element.g;u.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),u.children=[l];var c=new a.Element.svg;c.attributes.x=new a.Property("x",0),c.attributes.y=new a.Property("y",0),c.attributes.width=new a.Property("width",h.width),c.attributes.height=new a.Property("height",h.height),c.children=[u];var f=document.createElement("canvas");f.width=h.width,f.height=h.height;var p=f.getContext("2d");return p.fillStyle=r,c.render(p),p.createPattern(f,"no-repeat")}return r}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var i="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),a="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return n==a&&s==r?null:t.createLinearGradient(n,s,a,r)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var i=e.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),s="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),a=n,r=s;this.attribute("fx").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"==this.gradientUnits()?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(a,r,0,n,s,o)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(t){this.base=a.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(t){this.base=a.Element.ElementBase,this.base(t),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var i=this.calcValue();if(this.attribute("type").hasValue()){var n=this.attribute("type").value;i=n+"("+i+")"}this.getProperty().value=i,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),i=Math.floor(e),n=Math.ceil(e);t.from=new a.Property("from",parseFloat(this.values.value[i])),t.to=new a.Property("to",parseFloat(this.values.value[n])),t.progress=(e-i)/(n-i)}else t.from=this.from,t.to=this.to;return t}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress(),e=t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress;return e+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),i=new t(e.from.value),n=new t(e.to.value);if(i.ok&&n.ok){var s=i.r+(n.r-i.r)*e.progress,a=i.g+(n.g-i.g)*e.progress,r=i.b+(n.b-i.b)*e.progress;return"rgb("+parseInt(s,10)+","+parseInt(a,10)+","+parseInt(r,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=a.ToNumberArray(t.from.value),i=a.ToNumberArray(t.to.value),n="",s=0;s<e.length;s++)n+=e[s]+(i[s]-e[s])*t.progress+" ";return n}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(t){this.base=a.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"font-face"==i.type?(this.fontFace=i,i.style("font-family").hasValue()&&(a.Definitions[i.style("font-family").value]=this)):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(t){this.base=a.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(t){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(t,e-i,t+Math.floor(2*i/3)*this.children[0].getText().length,e)},this.renderChildren=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,i){var n=this.style("text-anchor").valueOrDefault("start");if("start"!=n){for(var s=0,a=i;a<e.children.length;a++){var r=e.children[a];if(a>i&&r.attribute("x").hasValue())break;r.measureTextRecursive&&(s+=r.measureTextRecursive(t))}return-1*("end"==n?s:s/2)}return 0},this.renderChild=function(t,e,i,n){var s=i.children[n];s.attribute("x").hasValue()?(s.x=s.attribute("x").toPixels("x")+e.getAnchorDelta(t,i,n),s.attribute("dx").hasValue()&&(s.x+=s.attribute("dx").toPixels("x"))):(s.attribute("dx").hasValue()&&(e.x+=s.attribute("dx").toPixels("x")),s.x=e.x),e.x=s.x+s.measureText(t),s.attribute("y").hasValue()?(s.y=s.attribute("y").toPixels("y"),s.attribute("dy").hasValue()&&(s.y+=s.attribute("dy").toPixels("y"))):(s.attribute("dy").hasValue()&&(e.y+=s.attribute("dy").toPixels("y")),s.y=e.y),e.y=s.y,s.render(t);for(var n=0;n<s.children.length;n++)e.renderChild(t,e,s,n)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,i){var n=e[i],s=null;if(t.isArabic){var a="isolated";(0==i||" "==e[i-1])&&i<e.length-2&&" "!=e[i+1]&&(a="terminal"),i>0&&" "!=e[i-1]&&i<e.length-2&&" "!=e[i+1]&&(a="medial"),i>0&&" "!=e[i-1]&&(i==e.length-1||" "==e[i+1])&&(a="initial"),"undefined"!=typeof t.glyphs[n]&&(s=t.glyphs[n][a],null==s&&"glyph"==t.glyphs[n].type&&(s=t.glyphs[n]))}else s=t.glyphs[n];return null==s&&(s=t.missingGlyph),s},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y);else{var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),n=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),s=this.getText();e.isRTL&&(s=s.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<s.length;o++){var h=this.getGlyph(e,s,o),l=i/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(l,-l);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/i,"italic"==n&&t.transform(1,0,.4,1,0,0),h.render(t),"italic"==n&&t.transform(1,0,-.4,1,0,0),t.lineWidth=u,t.scale(1/l,-1/l),t.translate(-this.x,-this.y),this.x+=i*(h.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,"undefined"==typeof r[o]||isNaN(r[o])||(this.x+=r[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),i=0;i<this.children.length;i++)e+=this.children[i].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),n=0,s=this.getText();e.isRTL&&(s=s.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<s.length;o++){var h=this.getGlyph(e,s,o);n+=(h.horizAdvX||e.horizAdvX)*i/e.fontFace.unitsPerEm,"undefined"==typeof r[o]||isNaN(r[o])||(n+=r[o])}return n}var l=a.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t);var u=t.measureText(l).width;return t.restore(),u}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(t){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(t),this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(t){this.base=a.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();return null!=t?t.children[0].getText():void 0}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(t){this.base=a.Element.TextElementBase,this.base(t),this.hasText=t.childNodes.length>0;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(this.children.length>0){var i=new a.Element.g;i.children=this.children,i.parent=this,i.render(t)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.textPath=function(t){this.base=a.Element.TextElementBase,this.base(t);var e=this.getHrefAttribute().getDefinition();this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.renderChildren=function(t){this.setTextData(t),t.save();var e=this.parent.style("text-decoration").value,i=this.fontSize(),n=this.glyphInfo,s=t.fillStyle;"underline"===e&&t.beginPath();for(var r=0;r<n.length;r++){var o=n[r].p0,h=n[r].p1,l=n[r].text;t.save(),t.translate(o.x,o.y),t.rotate(n[r].rotation),""!=t.fillStyle&&t.fillText(a.compressSpaces(l),0,0),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(l),0,0),t.restore(),"underline"===e&&(0===r&&t.moveTo(o.x,o.y+i/8),t.lineTo(h.x,h.y+i/5))}"underline"===e&&(t.lineWidth=i/20,t.strokeStyle=s,t.stroke(),t.closePath()),t.restore()},this.path=function(t){var e=this.dataArray;null!=t&&t.beginPath();for(var i=0;i<e.length;i++){var n=e[i].command,s=e[i].points;switch(n){case"L":null!=t&&t.lineTo(s[0],s[1]);break;case"M":null!=t&&t.moveTo(s[0],s[1]);break;case"C":null!=t&&t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":null!=t&&t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":var a=s[0],r=s[1],o=s[2],h=s[3],l=s[4],u=s[5],c=s[6],f=s[7],p=o>h?o:h,d=o>h?1:o/h,m=o>h?h/o:1;null!=t&&(t.translate(a,r),t.rotate(c),t.scale(d,m),t.arc(0,0,p,l,l+u,1-f),t.scale(1/d,1/m),t.rotate(-c),t.translate(-a,-r));break;case"z":null!=t&&t.closePath()}}},this.getText=function(){return this.text},this.fontSize=function(){return this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize)},this.measureText=function(t,e){var i=this.parent.style("font-family").getDefinition();if(e=e||this.getText(),null!=i){var n=this.fontSize(),s=0;i.isRTL&&(e=e.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<e.length;o++){var h=this.getGlyph(i,e,o);s+=(h.horizAdvX||i.horizAdvX)*n/i.fontFace.unitsPerEm,"undefined"==typeof r[o]||isNaN(r[o])||(s+=r[o])}return s}var l=a.compressSpaces(e);if(!t.measureText)return 10*l.length;t.save(),this.setContext(t);var u=t.measureText(l).width;return t.restore(),u},this.setTextData=function(t){if(!this.hasOwnProperty("glyphInfo")){var e=this,i=this.getText().split(""),n=this.getText().split(" ").length-1,s=a.ToNumberArray(this.parent.attribute("dx").valueOrDefault("0")),r=this.parent.style("letter-spacing").numValueOrDefault(0),o=this.parent.style("text-anchor").valueOrDefault("start");this.letterSpacingCache=[];for(var h=0;h<this.getText().length;h++)this.letterSpacingCache.push(void 0!==s[h]?s[h]:r);var l=this.letterSpacingCache.reduce(function(t,e){return t+e||0},0);this.textWidth=this.measureText(t),this.textHeight=this.fontSize();var u=Math.max(this.textWidth+l,0);this.glyphInfo=[];var c=this.getPathLength(),f=this.style("startOffset").numValueOrDefault(0)*c,p=0;("middle"===o||"center"===o)&&(p=-u/2),("end"===o||"right"===o)&&(p=-u),p+=f;for(var d=function(t){return t=t||0,e.letterSpacingCache[t]||0},m=function(i,s){var a=e.measureText(t,i);" "===i&&"justify"===o&&c>u&&(a+=(c-u)/n),s>-1&&(p+=d(s));var r=e.textHeight/20,h={p0:e.getEquidistantPointOnPath(p,r),p1:e.getEquidistantPointOnPath(p+a,r)};return p+=a,h},h=0;h<i.length;h++){var y=m(i[h],h);if(void 0!==y.p0&&void 0!==y.p1){var v=e.getLineLength(y.p0.x,y.p0.y,y.p1.x,y.p1.y),g=0,x=e.getPointOnLine(g+v/2,y.p0.x,y.p0.y,y.p1.x,y.p1.y),b=Math.atan2(y.p1.y-y.p0.y,y.p1.x-y.p0.x);this.glyphInfo.push({transposeX:x.x,transposeY:x.y,text:i[h],rotation:b,p0:y.p0,p1:y.p1})}}}},this.parsePathData=function(t){if(this.pathLength=void 0,!t)return[];var e=[],i=t.PathParser;for(i.reset();!i.isEnd();){var n=[],s=null,r=i.current?i.current.x:0,o=i.current?i.current.y:0;i.nextCommand();var h=i.command.toUpperCase();switch(i.command){case"M":case"m":var l=i.getAsCurrentPoint();for(n.push(l.x,l.y),i.start=i.current;!i.isCommandOrEnd();){var l=i.getAsCurrentPoint();n.push(l.x,l.y),s="L"}break;case"L":case"l":for(;!i.isCommandOrEnd();){var l=i.getAsCurrentPoint();n.push(l.x,l.y)}s="L";break;case"H":case"h":for(;!i.isCommandOrEnd();){var u=new a.Point((i.isRelativeCommand()?i.current.x:0)+i.getScalar(),i.current.y);n.push(u.x,u.y),i.current=u}s="L";break;case"V":case"v":for(;!i.isCommandOrEnd();){var u=new a.Point(i.current.x,(i.isRelativeCommand()?i.current.y:0)+i.getScalar());n.push(u.x,u.y),i.current=u}s="L";break;case"C":case"c":for(;!i.isCommandOrEnd();){var c=i.getPoint(),f=i.getAsControlPoint(),p=i.getAsCurrentPoint();n.push(c.x,c.y,f.x,f.y,p.x,p.y)}break;case"S":case"s":for(;!i.isCommandOrEnd();){var c=i.getReflectedControlPoint(),f=i.getAsControlPoint(),p=i.getAsCurrentPoint();n.push(c.x,c.y,f.x,f.y,p.x,p.y)}s="C";break;case"Q":case"q":for(;!i.isCommandOrEnd();){var f=i.getAsControlPoint(),p=i.getAsCurrentPoint();n.push(f.x,f.y,p.x,p.y)}break;case"T":case"t":for(;!i.isCommandOrEnd();){var f=i.getReflectedControlPoint();i.control=f;var p=i.getAsCurrentPoint();n.push(f.x,f.y,p.x,p.y)}s="Q";break;case"A":case"a":for(;!i.isCommandOrEnd();){var d=i.current,m=i.getScalar(),y=i.getScalar(),v=i.getScalar()*(Math.PI/180),g=i.getScalar(),x=i.getScalar(),p=i.getAsCurrentPoint(),b=new a.Point(Math.cos(v)*(d.x-p.x)/2+Math.sin(v)*(d.y-p.y)/2,-Math.sin(v)*(d.x-p.x)/2+Math.cos(v)*(d.y-p.y)/2),P=Math.pow(b.x,2)/Math.pow(m,2)+Math.pow(b.y,2)/Math.pow(y,2);P>1&&(m*=Math.sqrt(P),y*=Math.sqrt(P));var E=(g==x?-1:1)*Math.sqrt((Math.pow(m,2)*Math.pow(y,2)-Math.pow(m,2)*Math.pow(b.y,2)-Math.pow(y,2)*Math.pow(b.x,2))/(Math.pow(m,2)*Math.pow(b.y,2)+Math.pow(y,2)*Math.pow(b.x,2)));isNaN(E)&&(E=0);var w=new a.Point(E*m*b.y/y,E*-y*b.x/m),C=new a.Point((d.x+p.x)/2+Math.cos(v)*w.x-Math.sin(v)*w.y,(d.y+p.y)/2+Math.sin(v)*w.x+Math.cos(v)*w.y),B=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},M=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(B(t)*B(e))},T=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(M(t,e))},V=T([1,0],[(b.x-w.x)/m,(b.y-w.y)/y]),S=[(b.x-w.x)/m,(b.y-w.y)/y],k=[(-b.x-w.x)/m,(-b.y-w.y)/y],A=T(S,k);M(S,k)<=-1&&(A=Math.PI),M(S,k)>=1&&(A=0),0===x&&A>0&&(A-=2*Math.PI),1===x&&0>A&&(A+=2*Math.PI),n=[C.x,C.y,m,y,V,A,v,x]}break;case"Z":case"z":i.current=i.start}e.push("Z"!==h?{command:s||h,points:n,start:{x:r,y:o},pathLength:this.calcLength(r,o,s||h,n)}:{command:"z",points:[],start:void 0,pathLength:0})}return e},this.getPathLength=function(){if(void 0===this.pathLength||null===this.pathLength||isNaN(this.pathLength)){this.pathLength=0;for(var t=0;t<this.dataArray.length;t++)this.dataArray[t].pathLength>0&&(this.pathLength+=this.dataArray[t].pathLength)}return this.pathLength},this.getPointOnPath=function(t){var e=0,i=this.getPathLength(),n=void 0;if(-5e-5>t||t-5e-5>i)return void 0;for(var s=0;s<this.dataArray.length;s++){var a=this.dataArray[s];{if(!a||!(a.pathLength<5e-5||e+a.pathLength+5e-5<t)){var r=t-e,o=void 0;switch(a.command){case"L":n=this.getPointOnLine(r,a.start.x,a.start.y,a.points[0],a.points[1],a.start.x,a.start.y);break;case"A":var h=a.points[4],l=a.points[5],u=a.points[4]+l;if(o=h+r/a.pathLength*l,0>l&&u>o||l>=0&&o>u)break;n=this.getPointOnEllipticalArc(a.points[0],a.points[1],a.points[2],a.points[3],o,a.points[6]);break;case"C":o=r/a.pathLength,o>1&&(o=1),n=this.getPointOnCubicBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3],a.points[4],a.points[5]);break;case"Q":o=r/a.pathLength,o>1&&(o=1),n=this.getPointOnQuadraticBezier(o,a.start.x,a.start.y,a.points[0],a.points[1],a.points[2],a.points[3])}if(void 0!==n&&n!=={})return n;break}e+=a.pathLength}}},this.buildEquidistantCache=function(t,e){var i=this.getPathLength();if(e=e||.25,t=t||i/100,this.equidistantCache=this.equidistantCache||{},!this.equidistantCache.hasOwnProperty("points")||this.equidistantCache.step!=t||this.equidistantCache.precision!=e){this.equidistantCache={step:t,precision:e,points:[]};for(var n=0,s=0;i>=s;s+=e){var a=this.getPointOnPath(s),r=this.getPointOnPath(s+e);void 0!==a&&void 0!==r&&(n+=this.getLineLength(a.x,a.y,r.x,r.y),n>=t&&(this.equidistantCache.points.push({x:a.x,y:a.y,distance:s}),n-=t))}}},this.getEquidistantPointOnPath=function(t,e,i){if(this.buildEquidistantCache(e,i),0>t||t-this.getPathLength()>5e-5)return void 0;var n=Math.round(t/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[n]||void 0},this.getLineLength=function(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))},this.getPointOnLine=function(t,e,i,n,s,a,r){void 0===a&&(a=e),void 0===r&&(r=i);var o=(s-i)/(n-e+1e-8),h=Math.sqrt(t*t/(1+o*o));e>n&&(h*=-1);var l,u=o*h;if(n===e)l={x:a,y:r+u};else if((r-i)/(a-e+1e-8)===o)l={x:a+h,y:r+u};else{var c,f,p=this.getLineLength(e,i,n,s);if(1e-8>p)return void 0;var d=(a-e)*(n-e)+(r-i)*(s-i);d/=p*p,c=e+d*(n-e),f=i+d*(s-i);var m=this.getLineLength(a,r,c,f),y=Math.sqrt(t*t-m*m);h=Math.sqrt(y*y/(1+o*o)),e>n&&(h*=-1),u=o*h,l={x:c+h,y:f+u}}return l},this.getPointOnCubicBezier=function(t,e,i,n,s,a,r,o,h){function l(t){return t*t*t}function u(t){return 3*t*t*(1-t)}function c(t){return 3*t*(1-t)*(1-t)}function f(t){return(1-t)*(1-t)*(1-t)}var p=o*l(t)+a*u(t)+n*c(t)+e*f(t),d=h*l(t)+r*u(t)+s*c(t)+i*f(t);return{x:p,y:d}},this.getPointOnQuadraticBezier=function(t,e,i,n,s,a,r){function o(t){return t*t}function h(t){return 2*t*(1-t)}function l(t){return(1-t)*(1-t)}var u=a*o(t)+n*h(t)+e*l(t),c=r*o(t)+s*h(t)+i*l(t);return{x:u,y:c}},this.getPointOnEllipticalArc=function(t,e,i,n,s,a){var r=Math.cos(a),o=Math.sin(a),h={x:i*Math.cos(s),y:n*Math.sin(s)};return{x:t+(h.x*r-h.y*o),y:e+(h.x*o+h.y*r)}},this.calcLength=function(t,e,i,n){var s,a,r,o;switch(i){case"L":return this.getLineLength(t,e,n[0],n[1]);case"C":for(s=0,a=this.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),o=.01;1>=o;o+=.01)r=this.getPointOnCubicBezier(o,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return s;case"Q":for(s=0,a=this.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),o=.01;1>=o;o+=.01)r=this.getPointOnQuadraticBezier(o,t,e,n[0],n[1],n[2],n[3]),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return s;case"A":s=0;var h=n[4],l=n[5],u=n[4]+l,c=Math.PI/180;if(Math.abs(h-u)<c&&(c=Math.abs(h-u)),a=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),0>l)for(o=h-c;o>u;o-=c)r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;else for(o=h+c;u>o;o+=c)r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],o,0),s+=this.getLineLength(a.x,a.y,r.x,r.y),a=r;return r=this.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],u,0),s+=this.getLineLength(a.x,a.y,r.x,r.y)}return 0},this.dataArray=this.parsePathData(e)},a.Element.textPath.prototype=new a.Element.TextElementBase,a.Element.image=function(t){this.base=a.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var i=e.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,i)this.img=a.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var n=this;this.img.onload=function(){n.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+e+'" not found'),n.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");0!=s&&0!=r&&(t.save(),i?t.drawSvg(this.img,e,n,s,r):(t.translate(e,n),a.AspectRatio(t,this.attribute("preserveAspectRatio").value,s,this.img.width,r,this.img.height,0,0),t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");return new a.BoundingBox(t,e,t+i,e+n)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(){for(var t=new a.BoundingBox,e=0;e<this.children.length;e++)t.addBoundingBox(this.children[e].getBoundingBox());return t}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.render=function(){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var e="",n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),e=a.compressSpaces(e);for(var s=e.split("}"),n=0;n<s.length;n++)if(""!=a.trim(s[n]))for(var r=s[n].split("{"),o=r[0].split(","),h=r[1].split(";"),l=0;l<o.length;l++){var u=a.trim(o[l]);if(""!=u){for(var c=a.Styles[u]||{},f=0;f<h.length;f++){var p=h[f].indexOf(":"),d=h[f].substr(0,p),m=h[f].substr(p+1,h[f].length-p);null!=d&&null!=m&&(c[a.trim(d)]=new a.Property(a.trim(d),a.trim(m)))}if(a.Styles[u]=c,a.StylesSpecificity[u]=i(u),"@font-face"==u)for(var y=c["font-family"].value.replace(/"/g,""),v=c.src.value.split(","),g=0;g<v.length;g++)if(v[g].indexOf('format("svg")')>0)for(var x=v[g].indexOf("url"),b=v[g].indexOf(")",x),P=v[g].substr(x+5,b-x-6),E=a.parseXml(a.ajax(P)),w=E.getElementsByTagName("font"),C=0;C<w.length;C++){var B=a.CreateElement(w[C]);a.Definitions[y]=B}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.getBoundingBox=function(){return null!=e?e.getBoundingBox():void 0},this.renderChildren=function(t){if(null!=e){var i=e;"symbol"==e.type&&(i=new a.Element.svg,i.type="svg",i.attributes.viewBox=new a.Property("viewBox",e.attribute("viewBox").value),i.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),i.attributes.overflow=new a.Property("overflow",e.attribute("overflow").value),i.children=e.children),"svg"==i.type&&(this.attribute("width").hasValue()&&(i.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(i.attributes.height=new a.Property("height",this.attribute("height").value)));var n=i.parent;i.parent=null,i.render(t),i.parent=n}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");if(0==s&&0==r){for(var o=new a.BoundingBox,h=0;h<this.children.length;h++)o.addBoundingBox(this.children[h].getBoundingBox());var i=Math.floor(o.x1),n=Math.floor(o.y1),s=Math.floor(o.width()),r=Math.floor(o.height())}var l=e.attribute("mask").value;e.attribute("mask").value="";var u=document.createElement("canvas");u.width=i+s,u.height=n+r;var c=u.getContext("2d");this.renderChildren(c);var f=document.createElement("canvas");f.width=i+s,f.height=n+r;var p=f.getContext("2d");e.render(p),p.globalCompositeOperation="destination-in",p.fillStyle=c.createPattern(u,"no-repeat"),p.fillRect(0,0,i+s,n+r),t.fillStyle=p.createPattern(f,"no-repeat"),t.fillRect(0,0,i+s,n+r),e.attribute("mask").value=l},this.render=function(){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t){var e=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var i=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},e.call(t);for(var n=0;n<this.children.length;n++){var s=this.children[n];if("undefined"!=typeof s.path){var r=null;s.style("transform",!1,!0).hasValue()&&(r=new a.Transform(s.style("transform",!1,!0).value),r.apply(t)),s.path(t),CanvasRenderingContext2D.prototype.closePath=i,r&&r.unapply(t)}}i.call(t),t.clip(),CanvasRenderingContext2D.prototype.beginPath=e,CanvasRenderingContext2D.prototype.closePath=i},this.render=function(){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=e.getBoundingBox(),n=Math.floor(i.x1),s=Math.floor(i.y1),a=Math.floor(i.width()),r=Math.floor(i.height()),o=e.style("filter").value;e.style("filter").value="";for(var h=0,l=0,u=0;u<this.children.length;u++){var c=this.children[u].extraFilterDistance||0;h=Math.max(h,c),l=Math.max(l,c)}var f=document.createElement("canvas");f.width=a+2*h,f.height=r+2*l;var p=f.getContext("2d");p.translate(-n+h,-s+l),e.render(p);for(var u=0;u<this.children.length;u++)"function"==typeof this.children[u].apply&&this.children[u].apply(p,0,0,a+2*h,r+2*l);t.drawImage(f,0,0,a+2*h,r+2*l,n-h,s-l,a+2*h,r+2*l),e.style("filter",!0).value=o},this.render=function(){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(t){function e(t,e,i,n,s,a){return t[i*n*4+4*e+a]}function i(t,e,i,n,s,a,r){t[i*n*4+4*e+a]=r}function n(t,e){var i=s[t];return i*(0>i?e-255:e)}this.base=a.Element.ElementBase,this.base(t);var s=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var r=s[0];s=[.213+.787*r,.715-.715*r,.072-.072*r,0,0,.213-.213*r,.715+.285*r,.072-.072*r,0,0,.213-.213*r,.715-.715*r,.072+.928*r,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var o=s[0]*Math.PI/180,h=function(t,e,i){return t+Math.cos(o)*e+Math.sin(o)*i};s=[h(.213,.787,-.213),h(.715,-.715,-.715),h(.072,-.072,.928),0,0,h(.213,-.213,.143),h(.715,.285,.14),h(.072,-.072,-.283),0,0,h(.213,-.213,-.787),h(.715,-.715,.715),h(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(t,s,a,r,o){for(var h=t.getImageData(0,0,r,o),a=0;o>a;a++)for(var s=0;r>s;s++){var l=e(h.data,s,a,r,o,0),u=e(h.data,s,a,r,o,1),c=e(h.data,s,a,r,o,2),f=e(h.data,s,a,r,o,3);i(h.data,s,a,r,o,0,n(0,l)+n(1,u)+n(2,c)+n(3,f)+n(4,1)),i(h.data,s,a,r,o,1,n(5,l)+n(6,u)+n(7,c)+n(8,f)+n(9,1)),i(h.data,s,a,r,o,2,n(10,l)+n(11,u)+n(12,c)+n(13,f)+n(14,1)),i(h.data,s,a,r,o,3,n(15,l)+n(16,u)+n(17,c)+n(18,f)+n(19,1))}t.clearRect(0,0,r,o),t.putImageData(h,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(t){this.base=a.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,i,n,s,r){return"undefined"==typeof e.canvasRGBA?void a.log("ERROR: StackBlur.js must be included for blur to work"):(t.canvas.id=a.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas.id,i,n,s,r,this.blurRadius),void document.body.removeChild(t.canvas))}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(t){a.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var i=null;return i="undefined"!=typeof a.Element[e]?new a.Element[e](t):new a.Element.MISSING(t),i.type=t.nodeName,i},a.load=function(t,e){a.loadXml(t,a.ajax(e))},a.loadXml=function(t,e){a.loadXmlDoc(t,a.parseXml(e))},a.loadXmlDoc=function(t,e){a.init(t);var i=function(e){for(var i=t.canvas;i;)e.x-=i.offsetLeft,e.y-=i.offsetTop,i=i.offsetParent;return window.scrollX&&(e.x+=window.scrollX),window.scrollY&&(e.y+=window.scrollY),e};1!=a.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=i(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=i(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onmousemove(e.x,e.y)});var n=a.CreateElement(e.documentElement);n.root=!0,n.addStylesFromStyleDefinition();var s=!0,r=function(){a.ViewPort.Clear(),t.canvas.parentNode&&a.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight),1!=a.opts.ignoreDimensions&&(n.style("width").hasValue()&&(t.canvas.width=n.style("width").toPixels("x"),t.canvas.style.width=t.canvas.width+"px"),n.style("height").hasValue()&&(t.canvas.height=n.style("height").toPixels("y"),t.canvas.style.height=t.canvas.height+"px"));var i=t.canvas.clientWidth||t.canvas.width,r=t.canvas.clientHeight||t.canvas.height;if(1==a.opts.ignoreDimensions&&n.style("width").hasValue()&&n.style("height").hasValue()&&(i=n.style("width").toPixels("x"),r=n.style("height").toPixels("y")),a.ViewPort.SetCurrent(i,r),null!=a.opts.offsetX&&(n.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(n.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var o=null,h=null,l=a.ToNumberArray(n.attribute("viewBox").value);null!=a.opts.scaleWidth&&(n.attribute("width").hasValue()?o=n.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(l[2])||(o=l[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(n.attribute("height").hasValue()?h=n.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(l[3])||(h=l[3]/a.opts.scaleHeight)),null==o&&(o=h),null==h&&(h=o),n.attribute("width",!0).value=a.opts.scaleWidth,n.attribute("height",!0).value=a.opts.scaleHeight,n.style("transform",!0,!0).value+=" scale("+1/o+","+1/h+")"}1!=a.opts.ignoreClear&&t.clearRect(0,0,i,r),n.render(t),s&&(s=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(e))},o=!0;a.ImagesLoaded()&&(o=!1,r()),a.intervalID=setInterval(function(){var t=!1;if(o&&a.ImagesLoaded()&&(o=!1,t=!0),1!=a.opts.ignoreMouse&&(t|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var e=0;e<a.Animations.length;e++)t|=a.Animations[e].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(t=!0),t&&(r(),a.Mouse.runEvents())},1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInPath&&e.isPointInPath(n.x,n.y)&&(this.eventElements[i]=t)}},this.checkBoundingBox=function(t,e){for(var i=0;i<this.events.length;i++){var n=this.events[i];e.isPointInBox(n.x,n.y)&&(this.eventElements[i]=t)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],i=this.eventElements[t];i;)e.run(i),i=i.parent;this.events=[],this.eventElements=[]}},a}var s,a=function(t,e,i){if(null!=t||null!=e||null!=i){"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var s=n(i||{});(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=s);var r=t.getContext("2d");"undefined"!=typeof e.documentElement?s.loadXmlDoc(r,e):"<"==e.substr(0,1)?s.loadXml(r,e):s.load(r,e)}else for(var o=document.querySelectorAll("svg"),h=0;h<o.length;h++){var l=o[h],u=document.createElement("canvas");u.width=l.clientWidth,u.height=l.clientHeight,l.parentNode.insertBefore(u,l),l.parentNode.removeChild(l);var c=document.createElement("div");c.appendChild(l),a(u,c.innerHTML)}};"undefined"!=typeof Element.prototype.matches?s=function(t,e){return t.matches(e)}:"undefined"!=typeof Element.prototype.webkitMatchesSelector?s=function(t,e){return t.webkitMatchesSelector(e)}:"undefined"!=typeof Element.prototype.mozMatchesSelector?s=function(t,e){return t.mozMatchesSelector(e)}:"undefined"!=typeof Element.prototype.msMatchesSelector?s=function(t,e){return t.msMatchesSelector(e)}:"undefined"!=typeof Element.prototype.oMatchesSelector?s=function(t,e){return t.oMatchesSelector(e)}:(("function"==typeof jQuery||"function"==typeof Zepto)&&(s=function(t,e){return $(t).is(e)}),"undefined"==typeof s&&(s=Sizzle.matchesSelector));var r=/(\[[^\]]+\])/g,o=/(#[^\s\+>~\.\[:]+)/g,h=/(\.[^\s\+>~\.\[:]+)/g,l=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,u=/(:[\w-]+\([^\)]*\))/gi,c=/(:[^\s\+>~\.\[:]+)/g,f=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,i,n,s,r){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:i,scaleWidth:n,scaleHeight:s};for(var h in r)r.hasOwnProperty(h)&&(o[h]=r[h]);a(this.canvas,t,o)}),a});
!function(a){var i=a.ZSConstants;i.LocaleConstants={LANGUAGE:["Albanian_sq","Arabic_ar","Belarusian_be","Bulgarian_bg","Catalan_ca","Chinese_zh","Croatian_hr","Czech_cs","Danish_da","Dutch_nl","English_en","Estonian_et","Finnish_fi","French_fr","German_de","Greek_el","Hebrew_iw","Hindi_hi","Hungarian_hu","Icelandic_is","Indonesian_in","Irish_ga","Italian_it","Japanese_ja","Korean_ko","Latvian_lv","Lithuanian_lt","Macedonian_mk","Malay_ms","Maltese_mt","Norwegian_no","Polish_pl","Portuguese_pt","Romanian_ro","Russian_ru","Serbian_sr","Slovak_sk","Slovenian_sl","Spanish_es","Swedish_sv","Thai_th","Turkish_tr","Ukrainian_uk","Vietnamese_vi"],COUNTRY:["Albania_AL","Algeria_DZ","Argentina_AR","Australia_AU","Austria_AT","Bahrain_BH","Belarus_BY","Belgium_BE","Bolivia_BO","Bosnia and Herzegovina_BA","Brazil_BR","Bulgaria_BG","Canada_CA","Chile_CL","China_CN","Colombia_CO","Costa Rica_CR","Croatia_HR","Cuba_CU","Cyprus_CY","Czech Republic_CZ","Denmark_DK","Dominican Republic_DO","Ecuador_EC","Egypt_EG","El Salvador_SV","Estonia_EE","Finland_FI","France_FR","Germany_DE","Greece_GR","Guatemala_GT","Honduras_HN","Hong Kong_HK","Hungary_HU","Iceland_IS","India_IN","Indonesia_ID","Iraq_IQ","Ireland_IE","Israel_IL","Italy_IT","Japan_JP","Jordan_JO","Kuwait_KW","Latvia_LV","Lebanon_LB","Libya_LY","Lithuania_LT","Luxembourg_LU","Macedonia_MK","Malaysia_MY","Malta_MT","Mexico_MX","Montenegro_ME","Morocco_MA","Netherlands_NL","New Zealand_NZ","Nicaragua_NI","Norway_NO","Oman_OM","Panama_PA","Paraguay_PY","Peru_PE","Philippines_PH","Poland_PL","Portugal_PT","Puerto Rico_PR","Qatar_QA","Romania_RO","Russia_RU","Saudi Arabia_SA","Serbia and Montenegro_CS","Serbia_RS","Singapore_SG","Slovakia_SK","Slovenia_SI","South Africa_ZA","South Korea_KR","Spain_ES","Sudan_SD","Sweden_SE","Switzerland_CH","Syria_SY","Taiwan_TW","Thailand_TH","Tunisia_TN","Turkey_TR","Ukraine_UA","United Arab Emirates_AE","United Kingdom_GB","United States_US","Uruguay_UY","Venezuela_VE","Vietnam_VN","Yemen_YE"],TIMEZONE:["Etc/GMT+12[( GMT -12:00 ) GMT-12:00 ( Etc/GMT+12 )","Etc/GMT+11[( GMT -11:00 ) GMT-11:00 ( Etc/GMT+11 )","Pacific/Midway[( GMT -11:00 ) Samoa Standard Time ( Pacific/Midway )","Pacific/Niue[( GMT -11:00 ) Niue Time ( Pacific/Niue )","Pacific/Pago_Pago[( GMT -11:00 ) Samoa Standard Time ( Pacific/Pago_Pago )","Pacific/Samoa[( GMT -11:00 ) Samoa Standard Time ( Pacific/Samoa )","US/Samoa[( GMT -11:00 ) Samoa Standard Time ( US/Samoa )","America/Adak[( GMT -10:00 ) Hawaii Standard Time ( America/Adak )","America/Atka[( GMT -10:00 ) Hawaii Standard Time ( America/Atka )","Etc/GMT+10[( GMT -10:00 ) GMT-10:00 ( Etc/GMT+10 )","Pacific/Honolulu[( GMT -10:00 ) Hawaii Standard Time ( Pacific/Honolulu )","Pacific/Johnston[( GMT -10:00 ) Hawaii Standard Time ( Pacific/Johnston )","Pacific/Rarotonga[( GMT -10:00 ) Cook Is. Time ( Pacific/Rarotonga )","Pacific/Tahiti[( GMT -10:00 ) Tahiti Time ( Pacific/Tahiti )","SystemV/HST10[( GMT -10:00 ) Hawaii Standard Time ( SystemV/HST10 )","US/Aleutian[( GMT -10:00 ) Hawaii Standard Time ( US/Aleutian )","US/Hawaii[( GMT -10:00 ) Hawaii Standard Time ( US/Hawaii )","HST[( GMT -10:00 ) Hawaii Standard Time ( HST )","Pacific/Marquesas[( GMT -9:30 ) Marquesas Time ( Pacific/Marquesas )","America/Anchorage[( GMT -9:00 ) Alaska Standard Time ( America/Anchorage )","America/Juneau[( GMT -9:00 ) Alaska Standard Time ( America/Juneau )","America/Metlakatla[( GMT -9:00 ) Alaska Standard Time ( America/Metlakatla )","America/Nome[( GMT -9:00 ) Alaska Standard Time ( America/Nome )","America/Sitka[( GMT -9:00 ) Alaska Standard Time ( America/Sitka )","America/Yakutat[( GMT -9:00 ) Alaska Standard Time ( America/Yakutat )","Etc/GMT+9[( GMT -9:00 ) GMT-09:00 ( Etc/GMT+9 )","Pacific/Gambier[( GMT -9:00 ) Gambier Time ( Pacific/Gambier )","SystemV/YST9[( GMT -9:00 ) Alaska Standard Time ( SystemV/YST9 )","SystemV/YST9YDT[( GMT -9:00 ) Alaska Standard Time ( SystemV/YST9YDT )","US/Alaska[( GMT -9:00 ) Alaska Standard Time ( US/Alaska )","AST[( GMT -9:00 ) Alaska Standard Time ( AST )","America/Dawson[( GMT -8:00 ) Pacific Standard Time ( America/Dawson )","America/Ensenada[( GMT -8:00 ) Pacific Standard Time ( America/Ensenada )","America/Los_Angeles[( GMT -8:00 ) Pacific Standard Time ( America/Los_Angeles )","America/Santa_Isabel[( GMT -8:00 ) Pacific Standard Time ( America/Santa_Isabel )","America/Tijuana[( GMT -8:00 ) Pacific Standard Time ( America/Tijuana )","America/Vancouver[( GMT -8:00 ) Pacific Standard Time ( America/Vancouver )","America/Whitehorse[( GMT -8:00 ) Pacific Standard Time ( America/Whitehorse )","Canada/Pacific[( GMT -8:00 ) Pacific Standard Time ( Canada/Pacific )","Canada/Yukon[( GMT -8:00 ) Pacific Standard Time ( Canada/Yukon )","Etc/GMT+8[( GMT -8:00 ) GMT-08:00 ( Etc/GMT+8 )","Mexico/BajaNorte[( GMT -8:00 ) Pacific Standard Time ( Mexico/BajaNorte )","PST8PDT[( GMT -8:00 ) Pacific Standard Time ( PST8PDT )","Pacific/Pitcairn[( GMT -8:00 ) Pitcairn Standard Time ( Pacific/Pitcairn )","SystemV/PST8[( GMT -8:00 ) Pacific Standard Time ( SystemV/PST8 )","SystemV/PST8PDT[( GMT -8:00 ) Pacific Standard Time ( SystemV/PST8PDT )","US/Pacific[( GMT -8:00 ) Pacific Standard Time ( US/Pacific )","US/Pacific-New[( GMT -8:00 ) Pacific Standard Time ( US/Pacific-New )","PST[( GMT -8:00 ) Pacific Standard Time ( PST )","America/Boise[( GMT -7:00 ) Mountain Standard Time ( America/Boise )","America/Cambridge_Bay[( GMT -7:00 ) Mountain Standard Time ( America/Cambridge_Bay )","America/Chihuahua[( GMT -7:00 ) Mountain Standard Time ( America/Chihuahua )","America/Creston[( GMT -7:00 ) Mountain Standard Time ( America/Creston )","America/Dawson_Creek[( GMT -7:00 ) Mountain Standard Time ( America/Dawson_Creek )","America/Denver[( GMT -7:00 ) Mountain Standard Time ( America/Denver )","America/Edmonton[( GMT -7:00 ) Mountain Standard Time ( America/Edmonton )","America/Fort_Nelson[( GMT -7:00 ) Mountain Standard Time ( America/Fort_Nelson )","America/Hermosillo[( GMT -7:00 ) Mountain Standard Time ( America/Hermosillo )","America/Inuvik[( GMT -7:00 ) Mountain Standard Time ( America/Inuvik )","America/Mazatlan[( GMT -7:00 ) Mountain Standard Time ( America/Mazatlan )","America/Ojinaga[( GMT -7:00 ) Mountain Standard Time ( America/Ojinaga )","America/Phoenix[( GMT -7:00 ) Mountain Standard Time ( America/Phoenix )","America/Shiprock[( GMT -7:00 ) Mountain Standard Time ( America/Shiprock )","America/Yellowknife[( GMT -7:00 ) Mountain Standard Time ( America/Yellowknife )","Canada/Mountain[( GMT -7:00 ) Mountain Standard Time ( Canada/Mountain )","Etc/GMT+7[( GMT -7:00 ) GMT-07:00 ( Etc/GMT+7 )","MST7MDT[( GMT -7:00 ) Mountain Standard Time ( MST7MDT )","Mexico/BajaSur[( GMT -7:00 ) Mountain Standard Time ( Mexico/BajaSur )","Navajo[( GMT -7:00 ) Mountain Standard Time ( Navajo )","SystemV/MST7[( GMT -7:00 ) Mountain Standard Time ( SystemV/MST7 )","SystemV/MST7MDT[( GMT -7:00 ) Mountain Standard Time ( SystemV/MST7MDT )","US/Arizona[( GMT -7:00 ) Mountain Standard Time ( US/Arizona )","US/Mountain[( GMT -7:00 ) Mountain Standard Time ( US/Mountain )","MST[( GMT -7:00 ) Mountain Standard Time ( MST )","PNT[( GMT -7:00 ) Mountain Standard Time ( PNT )","America/Bahia_Banderas[( GMT -6:00 ) Central Standard Time ( America/Bahia_Banderas )","America/Belize[( GMT -6:00 ) Central Standard Time ( America/Belize )","America/Chicago[( GMT -6:00 ) Central Standard Time ( America/Chicago )","America/Costa_Rica[( GMT -6:00 ) Central Standard Time ( America/Costa_Rica )","America/El_Salvador[( GMT -6:00 ) Central Standard Time ( America/El_Salvador )","America/Guatemala[( GMT -6:00 ) Central Standard Time ( America/Guatemala )","America/Indiana/Knox[( GMT -6:00 ) Central Standard Time ( America/Indiana/Knox )","America/Indiana/Tell_City[( GMT -6:00 ) Central Standard Time ( America/Indiana/Tell_City )","America/Knox_IN[( GMT -6:00 ) Central Standard Time ( America/Knox_IN )","America/Managua[( GMT -6:00 ) Central Standard Time ( America/Managua )","America/Matamoros[( GMT -6:00 ) Central Standard Time ( America/Matamoros )","America/Menominee[( GMT -6:00 ) Central Standard Time ( America/Menominee )","America/Merida[( GMT -6:00 ) Central Standard Time ( America/Merida )","America/Mexico_City[( GMT -6:00 ) Central Standard Time ( America/Mexico_City )","America/Monterrey[( GMT -6:00 ) Central Standard Time ( America/Monterrey )","America/North_Dakota/Beulah[( GMT -6:00 ) Central Standard Time ( America/North_Dakota/Beulah )","America/North_Dakota/Center[( GMT -6:00 ) Central Standard Time ( America/North_Dakota/Center )","America/North_Dakota/New_Salem[( GMT -6:00 ) Central Standard Time ( America/North_Dakota/New_Salem )","America/Rainy_River[( GMT -6:00 ) Central Standard Time ( America/Rainy_River )","America/Rankin_Inlet[( GMT -6:00 ) Central Standard Time ( America/Rankin_Inlet )","America/Regina[( GMT -6:00 ) Central Standard Time ( America/Regina )","America/Resolute[( GMT -6:00 ) Central Standard Time ( America/Resolute )","America/Swift_Current[( GMT -6:00 ) Central Standard Time ( America/Swift_Current )","America/Tegucigalpa[( GMT -6:00 ) Central Standard Time ( America/Tegucigalpa )","America/Winnipeg[( GMT -6:00 ) Central Standard Time ( America/Winnipeg )","CST6CDT[( GMT -6:00 ) Central Standard Time ( CST6CDT )","Canada/Central[( GMT -6:00 ) Central Standard Time ( Canada/Central )","Canada/East-Saskatchewan[( GMT -6:00 ) Central Standard Time ( Canada/East-Saskatchewan )","Canada/Saskatchewan[( GMT -6:00 ) Central Standard Time ( Canada/Saskatchewan )","Etc/GMT+6[( GMT -6:00 ) GMT-06:00 ( Etc/GMT+6 )","Mexico/General[( GMT -6:00 ) Central Standard Time ( Mexico/General )","Pacific/Galapagos[( GMT -6:00 ) Galapagos Time ( Pacific/Galapagos )","SystemV/CST6[( GMT -6:00 ) Central Standard Time ( SystemV/CST6 )","SystemV/CST6CDT[( GMT -6:00 ) Central Standard Time ( SystemV/CST6CDT )","US/Central[( GMT -6:00 ) Central Standard Time ( US/Central )","US/Indiana-Starke[( GMT -6:00 ) Central Standard Time ( US/Indiana-Starke )","CST[( GMT -6:00 ) Central Standard Time ( CST )","America/Atikokan[( GMT -5:00 ) Eastern Standard Time ( America/Atikokan )","America/Bogota[( GMT -5:00 ) Colombia Time ( America/Bogota )","America/Cancun[( GMT -5:00 ) Eastern Standard Time ( America/Cancun )","America/Cayman[( GMT -5:00 ) Eastern Standard Time ( America/Cayman )","America/Coral_Harbour[( GMT -5:00 ) Eastern Standard Time ( America/Coral_Harbour )","America/Detroit[( GMT -5:00 ) Eastern Standard Time ( America/Detroit )","America/Eirunepe[( GMT -5:00 ) Acre Time ( America/Eirunepe )","America/Fort_Wayne[( GMT -5:00 ) Eastern Standard Time ( America/Fort_Wayne )","America/Guayaquil[( GMT -5:00 ) Ecuador Time ( America/Guayaquil )","America/Havana[( GMT -5:00 ) Cuba Standard Time ( America/Havana )","America/Indiana/Indianapolis[( GMT -5:00 ) Eastern Standard Time ( America/Indiana/Indianapolis )","America/Indiana/Marengo[( GMT -5:00 ) Eastern Standard Time ( America/Indiana/Marengo )","America/Indiana/Petersburg[( GMT -5:00 ) Eastern Standard Time ( America/Indiana/Petersburg )","America/Indiana/Vevay[( GMT -5:00 ) Eastern Standard Time ( America/Indiana/Vevay )","America/Indiana/Vincennes[( GMT -5:00 ) Eastern Standard Time ( America/Indiana/Vincennes )","America/Indiana/Winamac[( GMT -5:00 ) Eastern Standard Time ( America/Indiana/Winamac )","America/Indianapolis[( GMT -5:00 ) Eastern Standard Time ( America/Indianapolis )","America/Iqaluit[( GMT -5:00 ) Eastern Standard Time ( America/Iqaluit )","America/Jamaica[( GMT -5:00 ) Eastern Standard Time ( America/Jamaica )","America/Kentucky/Louisville[( GMT -5:00 ) Eastern Standard Time ( America/Kentucky/Louisville )","America/Kentucky/Monticello[( GMT -5:00 ) Eastern Standard Time ( America/Kentucky/Monticello )","America/Lima[( GMT -5:00 ) Peru Time ( America/Lima )","America/Louisville[( GMT -5:00 ) Eastern Standard Time ( America/Louisville )","America/Montreal[( GMT -5:00 ) Eastern Standard Time ( America/Montreal )","America/Nassau[( GMT -5:00 ) Eastern Standard Time ( America/Nassau )","America/New_York[( GMT -5:00 ) Eastern Standard Time ( America/New_York )","America/Nipigon[( GMT -5:00 ) Eastern Standard Time ( America/Nipigon )","America/Panama[( GMT -5:00 ) Eastern Standard Time ( America/Panama )","America/Pangnirtung[( GMT -5:00 ) Eastern Standard Time ( America/Pangnirtung )","America/Port-au-Prince[( GMT -5:00 ) Eastern Standard Time ( America/Port-au-Prince )","America/Porto_Acre[( GMT -5:00 ) Acre Time ( America/Porto_Acre )","America/Rio_Branco[( GMT -5:00 ) Acre Time ( America/Rio_Branco )","America/Thunder_Bay[( GMT -5:00 ) Eastern Standard Time ( America/Thunder_Bay )","America/Toronto[( GMT -5:00 ) Eastern Standard Time ( America/Toronto )","Brazil/Acre[( GMT -5:00 ) Acre Time ( Brazil/Acre )","Canada/Eastern[( GMT -5:00 ) Eastern Standard Time ( Canada/Eastern )","Chile/EasterIsland[( GMT -5:00 ) Easter Is. Time ( Chile/EasterIsland )","Cuba[( GMT -5:00 ) Cuba Standard Time ( Cuba )","EST5EDT[( GMT -5:00 ) Eastern Standard Time ( EST5EDT )","Etc/GMT+5[( GMT -5:00 ) GMT-05:00 ( Etc/GMT+5 )","Jamaica[( GMT -5:00 ) Eastern Standard Time ( Jamaica )","Pacific/Easter[( GMT -5:00 ) Easter Is. Time ( Pacific/Easter )","SystemV/EST5[( GMT -5:00 ) Eastern Standard Time ( SystemV/EST5 )","SystemV/EST5EDT[( GMT -5:00 ) Eastern Standard Time ( SystemV/EST5EDT )","US/East-Indiana[( GMT -5:00 ) Eastern Standard Time ( US/East-Indiana )","US/Eastern[( GMT -5:00 ) Eastern Standard Time ( US/Eastern )","US/Michigan[( GMT -5:00 ) Eastern Standard Time ( US/Michigan )","EST[( GMT -5:00 ) Eastern Standard Time ( EST )","IET[( GMT -5:00 ) Eastern Standard Time ( IET )","America/Caracas[( GMT -4:30 ) Venezuela Time ( America/Caracas )","America/Anguilla[( GMT -4:00 ) Atlantic Standard Time ( America/Anguilla )","America/Antigua[( GMT -4:00 ) Atlantic Standard Time ( America/Antigua )","America/Aruba[( GMT -4:00 ) Atlantic Standard Time ( America/Aruba )","America/Asuncion[( GMT -4:00 ) Paraguay Summer Time ( America/Asuncion )","America/Barbados[( GMT -4:00 ) Atlantic Standard Time ( America/Barbados )","America/Blanc-Sablon[( GMT -4:00 ) Atlantic Standard Time ( America/Blanc-Sablon )","America/Boa_Vista[( GMT -4:00 ) Amazon Time ( America/Boa_Vista )","America/Campo_Grande[( GMT -4:00 ) Amazon Summer Time ( America/Campo_Grande )","America/Cuiaba[( GMT -4:00 ) Amazon Summer Time ( America/Cuiaba )","America/Curacao[( GMT -4:00 ) Atlantic Standard Time ( America/Curacao )","America/Dominica[( GMT -4:00 ) Atlantic Standard Time ( America/Dominica )","America/Glace_Bay[( GMT -4:00 ) Atlantic Standard Time ( America/Glace_Bay )","America/Goose_Bay[( GMT -4:00 ) Atlantic Standard Time ( America/Goose_Bay )","America/Grand_Turk[( GMT -4:00 ) Atlantic Standard Time ( America/Grand_Turk )","America/Grenada[( GMT -4:00 ) Atlantic Standard Time ( America/Grenada )","America/Guadeloupe[( GMT -4:00 ) Atlantic Standard Time ( America/Guadeloupe )","America/Guyana[( GMT -4:00 ) Guyana Time ( America/Guyana )","America/Halifax[( GMT -4:00 ) Atlantic Standard Time ( America/Halifax )","America/Kralendijk[( GMT -4:00 ) Atlantic Standard Time ( America/Kralendijk )","America/La_Paz[( GMT -4:00 ) Bolivia Time ( America/La_Paz )","America/Lower_Princes[( GMT -4:00 ) Atlantic Standard Time ( America/Lower_Princes )","America/Manaus[( GMT -4:00 ) Amazon Time ( America/Manaus )","America/Marigot[( GMT -4:00 ) Atlantic Standard Time ( America/Marigot )","America/Martinique[( GMT -4:00 ) Atlantic Standard Time ( America/Martinique )","America/Moncton[( GMT -4:00 ) Atlantic Standard Time ( America/Moncton )","America/Montserrat[( GMT -4:00 ) Atlantic Standard Time ( America/Montserrat )","America/Port_of_Spain[( GMT -4:00 ) Atlantic Standard Time ( America/Port_of_Spain )","America/Porto_Velho[( GMT -4:00 ) Amazon Time ( America/Porto_Velho )","America/Puerto_Rico[( GMT -4:00 ) Atlantic Standard Time ( America/Puerto_Rico )","America/Santo_Domingo[( GMT -4:00 ) Atlantic Standard Time ( America/Santo_Domingo )","America/St_Barthelemy[( GMT -4:00 ) Atlantic Standard Time ( America/St_Barthelemy )","America/St_Kitts[( GMT -4:00 ) Atlantic Standard Time ( America/St_Kitts )","America/St_Lucia[( GMT -4:00 ) Atlantic Standard Time ( America/St_Lucia )","America/St_Thomas[( GMT -4:00 ) Atlantic Standard Time ( America/St_Thomas )","America/St_Vincent[( GMT -4:00 ) Atlantic Standard Time ( America/St_Vincent )","America/Thule[( GMT -4:00 ) Atlantic Standard Time ( America/Thule )","America/Tortola[( GMT -4:00 ) Atlantic Standard Time ( America/Tortola )","America/Virgin[( GMT -4:00 ) Atlantic Standard Time ( America/Virgin )","Atlantic/Bermuda[( GMT -4:00 ) Atlantic Standard Time ( Atlantic/Bermuda )","Brazil/West[( GMT -4:00 ) Amazon Time ( Brazil/West )","Canada/Atlantic[( GMT -4:00 ) Atlantic Standard Time ( Canada/Atlantic )","Etc/GMT+4[( GMT -4:00 ) GMT-04:00 ( Etc/GMT+4 )","SystemV/AST4[( GMT -4:00 ) Atlantic Standard Time ( SystemV/AST4 )","SystemV/AST4ADT[( GMT -4:00 ) Atlantic Standard Time ( SystemV/AST4ADT )","PRT[( GMT -4:00 ) Atlantic Standard Time ( PRT )","America/St_Johns[( GMT -3:30 ) Newfoundland Standard Time ( America/St_Johns )","Canada/Newfoundland[( GMT -3:30 ) Newfoundland Standard Time ( Canada/Newfoundland )","CNT[( GMT -3:30 ) Newfoundland Standard Time ( CNT )","America/Araguaina[( GMT -3:00 ) Brasilia Time ( America/Araguaina )","America/Argentina/Buenos_Aires[( GMT -3:00 ) Argentine Time ( America/Argentina/Buenos_Aires )","America/Argentina/Catamarca[( GMT -3:00 ) Argentine Time ( America/Argentina/Catamarca )","America/Argentina/ComodRivadavia[( GMT -3:00 ) Argentine Time ( America/Argentina/ComodRivadavia )","America/Argentina/Cordoba[( GMT -3:00 ) Argentine Time ( America/Argentina/Cordoba )","America/Argentina/Jujuy[( GMT -3:00 ) Argentine Time ( America/Argentina/Jujuy )","America/Argentina/La_Rioja[( GMT -3:00 ) Argentine Time ( America/Argentina/La_Rioja )","America/Argentina/Mendoza[( GMT -3:00 ) Argentine Time ( America/Argentina/Mendoza )","America/Argentina/Rio_Gallegos[( GMT -3:00 ) Argentine Time ( America/Argentina/Rio_Gallegos )","America/Argentina/Salta[( GMT -3:00 ) Argentine Time ( America/Argentina/Salta )","America/Argentina/San_Juan[( GMT -3:00 ) Argentine Time ( America/Argentina/San_Juan )","America/Argentina/San_Luis[( GMT -3:00 ) Argentine Time ( America/Argentina/San_Luis )","America/Argentina/Tucuman[( GMT -3:00 ) Argentine Time ( America/Argentina/Tucuman )","America/Argentina/Ushuaia[( GMT -3:00 ) Argentine Time ( America/Argentina/Ushuaia )","America/Bahia[( GMT -3:00 ) Brasilia Time ( America/Bahia )","America/Belem[( GMT -3:00 ) Brasilia Time ( America/Belem )","America/Buenos_Aires[( GMT -3:00 ) Argentine Time ( America/Buenos_Aires )","America/Catamarca[( GMT -3:00 ) Argentine Time ( America/Catamarca )","America/Cayenne[( GMT -3:00 ) French Guiana Time ( America/Cayenne )","America/Cordoba[( GMT -3:00 ) Argentine Time ( America/Cordoba )","America/Fortaleza[( GMT -3:00 ) Brasilia Time ( America/Fortaleza )","America/Godthab[( GMT -3:00 ) Western Greenland Time ( America/Godthab )","America/Jujuy[( GMT -3:00 ) Argentine Time ( America/Jujuy )","America/Maceio[( GMT -3:00 ) Brasilia Time ( America/Maceio )","America/Mendoza[( GMT -3:00 ) Argentine Time ( America/Mendoza )","America/Miquelon[( GMT -3:00 ) Pierre & Miquelon Standard Time ( America/Miquelon )","America/Montevideo[( GMT -3:00 ) Uruguay Time ( America/Montevideo )","America/Paramaribo[( GMT -3:00 ) Suriname Time ( America/Paramaribo )","America/Recife[( GMT -3:00 ) Brasilia Time ( America/Recife )","America/Rosario[( GMT -3:00 ) Argentine Time ( America/Rosario )","America/Santarem[( GMT -3:00 ) Brasilia Time ( America/Santarem )","America/Santiago[( GMT -3:00 ) Chile Time ( America/Santiago )","America/Sao_Paulo[( GMT -3:00 ) Brasilia Summer Time ( America/Sao_Paulo )","Antarctica/Palmer[( GMT -3:00 ) Chile Time ( Antarctica/Palmer )","Antarctica/Rothera[( GMT -3:00 ) Rothera Time ( Antarctica/Rothera )","Atlantic/Stanley[( GMT -3:00 ) Falkland Is. Time ( Atlantic/Stanley )","Brazil/East[( GMT -3:00 ) Brasilia Summer Time ( Brazil/East )","Chile/Continental[( GMT -3:00 ) Chile Time ( Chile/Continental )","Etc/GMT+3[( GMT -3:00 ) GMT-03:00 ( Etc/GMT+3 )","AGT[( GMT -3:00 ) Argentine Time ( AGT )","BET[( GMT -3:00 ) Brasilia Summer Time ( BET )","America/Noronha[( GMT -2:00 ) Fernando de Noronha Time ( America/Noronha )","Atlantic/South_Georgia[( GMT -2:00 ) South Georgia Standard Time ( Atlantic/South_Georgia )","Brazil/DeNoronha[( GMT -2:00 ) Fernando de Noronha Time ( Brazil/DeNoronha )","Etc/GMT+2[( GMT -2:00 ) GMT-02:00 ( Etc/GMT+2 )","America/Scoresbysund[( GMT -1:00 ) Eastern Greenland Time ( America/Scoresbysund )","Atlantic/Azores[( GMT -1:00 ) Azores Time ( Atlantic/Azores )","Atlantic/Cape_Verde[( GMT -1:00 ) Cape Verde Time ( Atlantic/Cape_Verde )","Etc/GMT+1[( GMT -1:00 ) GMT-01:00 ( Etc/GMT+1 )","Africa/Abidjan[( GMT +0:00 ) Greenwich Mean Time ( Africa/Abidjan )","Africa/Accra[( GMT +0:00 ) Ghana Mean Time ( Africa/Accra )","Africa/Bamako[( GMT +0:00 ) Greenwich Mean Time ( Africa/Bamako )","Africa/Banjul[( GMT +0:00 ) Greenwich Mean Time ( Africa/Banjul )","Africa/Bissau[( GMT +0:00 ) Greenwich Mean Time ( Africa/Bissau )","Africa/Casablanca[( GMT +0:00 ) Western European Time ( Africa/Casablanca )","Africa/Conakry[( GMT +0:00 ) Greenwich Mean Time ( Africa/Conakry )","Africa/Dakar[( GMT +0:00 ) Greenwich Mean Time ( Africa/Dakar )","Africa/El_Aaiun[( GMT +0:00 ) Western European Time ( Africa/El_Aaiun )","Africa/Freetown[( GMT +0:00 ) Greenwich Mean Time ( Africa/Freetown )","Africa/Lome[( GMT +0:00 ) Greenwich Mean Time ( Africa/Lome )","Africa/Monrovia[( GMT +0:00 ) Greenwich Mean Time ( Africa/Monrovia )","Africa/Nouakchott[( GMT +0:00 ) Greenwich Mean Time ( Africa/Nouakchott )","Africa/Ouagadougou[( GMT +0:00 ) Greenwich Mean Time ( Africa/Ouagadougou )","Africa/Sao_Tome[( GMT +0:00 ) Greenwich Mean Time ( Africa/Sao_Tome )","Africa/Timbuktu[( GMT +0:00 ) Greenwich Mean Time ( Africa/Timbuktu )","America/Danmarkshavn[( GMT +0:00 ) Greenwich Mean Time ( America/Danmarkshavn )","Antarctica/Troll[( GMT +0:00 ) Coordinated Universal Time ( Antarctica/Troll )","Atlantic/Canary[( GMT +0:00 ) Western European Time ( Atlantic/Canary )","Atlantic/Faeroe[( GMT +0:00 ) Western European Time ( Atlantic/Faeroe )","Atlantic/Faroe[( GMT +0:00 ) Western European Time ( Atlantic/Faroe )","Atlantic/Madeira[( GMT +0:00 ) Western European Time ( Atlantic/Madeira )","Atlantic/Reykjavik[( GMT +0:00 ) Greenwich Mean Time ( Atlantic/Reykjavik )","Atlantic/St_Helena[( GMT +0:00 ) Greenwich Mean Time ( Atlantic/St_Helena )","Eire[( GMT +0:00 ) Greenwich Mean Time ( Eire )","Etc/GMT[( GMT +0:00 ) Greenwich Mean Time ( Etc/GMT )","Etc/GMT+0[( GMT +0:00 ) Greenwich Mean Time ( Etc/GMT+0 )","Etc/GMT-0[( GMT +0:00 ) Greenwich Mean Time ( Etc/GMT-0 )","Etc/GMT0[( GMT +0:00 ) Greenwich Mean Time ( Etc/GMT0 )","Etc/Greenwich[( GMT +0:00 ) Greenwich Mean Time ( Etc/Greenwich )","Etc/UCT[( GMT +0:00 ) Coordinated Universal Time ( Etc/UCT )","Etc/UTC[( GMT +0:00 ) Coordinated Universal Time ( Etc/UTC )","Etc/Universal[( GMT +0:00 ) Coordinated Universal Time ( Etc/Universal )","Etc/Zulu[( GMT +0:00 ) Coordinated Universal Time ( Etc/Zulu )","Europe/Belfast[( GMT +0:00 ) Greenwich Mean Time ( Europe/Belfast )","Europe/Dublin[( GMT +0:00 ) Greenwich Mean Time ( Europe/Dublin )","Europe/Guernsey[( GMT +0:00 ) Greenwich Mean Time ( Europe/Guernsey )","Europe/Isle_of_Man[( GMT +0:00 ) Greenwich Mean Time ( Europe/Isle_of_Man )","Europe/Jersey[( GMT +0:00 ) Greenwich Mean Time ( Europe/Jersey )","Europe/Lisbon[( GMT +0:00 ) Western European Time ( Europe/Lisbon )","Europe/London[( GMT +0:00 ) Greenwich Mean Time ( Europe/London )","GB[( GMT +0:00 ) Greenwich Mean Time ( GB )","GB-Eire[( GMT +0:00 ) Greenwich Mean Time ( GB-Eire )","GMT[( GMT +0:00 ) Greenwich Mean Time ( GMT )","GMT0[( GMT +0:00 ) Greenwich Mean Time ( GMT0 )","Greenwich[( GMT +0:00 ) Greenwich Mean Time ( Greenwich )","Iceland[( GMT +0:00 ) Greenwich Mean Time ( Iceland )","Portugal[( GMT +0:00 ) Western European Time ( Portugal )","UCT[( GMT +0:00 ) Coordinated Universal Time ( UCT )","UTC[( GMT +0:00 ) Coordinated Universal Time ( UTC )","Universal[( GMT +0:00 ) Coordinated Universal Time ( Universal )","WET[( GMT +0:00 ) Western European Time ( WET )","Zulu[( GMT +0:00 ) Coordinated Universal Time ( Zulu )","Africa/Algiers[( GMT +1:00 ) Central European Time ( Africa/Algiers )","Africa/Bangui[( GMT +1:00 ) Western African Time ( Africa/Bangui )","Africa/Brazzaville[( GMT +1:00 ) Western African Time ( Africa/Brazzaville )","Africa/Ceuta[( GMT +1:00 ) Central European Time ( Africa/Ceuta )","Africa/Douala[( GMT +1:00 ) Western African Time ( Africa/Douala )","Africa/Kinshasa[( GMT +1:00 ) Western African Time ( Africa/Kinshasa )","Africa/Lagos[( GMT +1:00 ) Western African Time ( Africa/Lagos )","Africa/Libreville[( GMT +1:00 ) Western African Time ( Africa/Libreville )","Africa/Luanda[( GMT +1:00 ) Western African Time ( Africa/Luanda )","Africa/Malabo[( GMT +1:00 ) Western African Time ( Africa/Malabo )","Africa/Ndjamena[( GMT +1:00 ) Western African Time ( Africa/Ndjamena )","Africa/Niamey[( GMT +1:00 ) Western African Time ( Africa/Niamey )","Africa/Porto-Novo[( GMT +1:00 ) Western African Time ( Africa/Porto-Novo )","Africa/Tunis[( GMT +1:00 ) Central European Time ( Africa/Tunis )","Africa/Windhoek[( GMT +1:00 ) Western African Summer Time ( Africa/Windhoek )","Arctic/Longyearbyen[( GMT +1:00 ) Central European Time ( Arctic/Longyearbyen )","Atlantic/Jan_Mayen[( GMT +1:00 ) Central European Time ( Atlantic/Jan_Mayen )","CET[( GMT +1:00 ) Central European Time ( CET )","Etc/GMT-1[( GMT +1:00 ) GMT+01:00 ( Etc/GMT-1 )","Europe/Amsterdam[( GMT +1:00 ) Central European Time ( Europe/Amsterdam )","Europe/Andorra[( GMT +1:00 ) Central European Time ( Europe/Andorra )","Europe/Belgrade[( GMT +1:00 ) Central European Time ( Europe/Belgrade )","Europe/Berlin[( GMT +1:00 ) Central European Time ( Europe/Berlin )","Europe/Bratislava[( GMT +1:00 ) Central European Time ( Europe/Bratislava )","Europe/Brussels[( GMT +1:00 ) Central European Time ( Europe/Brussels )","Europe/Budapest[( GMT +1:00 ) Central European Time ( Europe/Budapest )","Europe/Busingen[( GMT +1:00 ) Central European Time ( Europe/Busingen )","Europe/Copenhagen[( GMT +1:00 ) Central European Time ( Europe/Copenhagen )","Europe/Gibraltar[( GMT +1:00 ) Central European Time ( Europe/Gibraltar )","Europe/Ljubljana[( GMT +1:00 ) Central European Time ( Europe/Ljubljana )","Europe/Luxembourg[( GMT +1:00 ) Central European Time ( Europe/Luxembourg )","Europe/Madrid[( GMT +1:00 ) Central European Time ( Europe/Madrid )","Europe/Malta[( GMT +1:00 ) Central European Time ( Europe/Malta )","Europe/Monaco[( GMT +1:00 ) Central European Time ( Europe/Monaco )","Europe/Oslo[( GMT +1:00 ) Central European Time ( Europe/Oslo )","Europe/Paris[( GMT +1:00 ) Central European Time ( Europe/Paris )","Europe/Podgorica[( GMT +1:00 ) Central European Time ( Europe/Podgorica )","Europe/Prague[( GMT +1:00 ) Central European Time ( Europe/Prague )","Europe/Rome[( GMT +1:00 ) Central European Time ( Europe/Rome )","Europe/San_Marino[( GMT +1:00 ) Central European Time ( Europe/San_Marino )","Europe/Sarajevo[( GMT +1:00 ) Central European Time ( Europe/Sarajevo )","Europe/Skopje[( GMT +1:00 ) Central European Time ( Europe/Skopje )","Europe/Stockholm[( GMT +1:00 ) Central European Time ( Europe/Stockholm )","Europe/Tirane[( GMT +1:00 ) Central European Time ( Europe/Tirane )","Europe/Vaduz[( GMT +1:00 ) Central European Time ( Europe/Vaduz )","Europe/Vatican[( GMT +1:00 ) Central European Time ( Europe/Vatican )","Europe/Vienna[( GMT +1:00 ) Central European Time ( Europe/Vienna )","Europe/Warsaw[( GMT +1:00 ) Central European Time ( Europe/Warsaw )","Europe/Zagreb[( GMT +1:00 ) Central European Time ( Europe/Zagreb )","Europe/Zurich[( GMT +1:00 ) Central European Time ( Europe/Zurich )","MET[( GMT +1:00 ) Middle Europe Time ( MET )","Poland[( GMT +1:00 ) Central European Time ( Poland )","ECT[( GMT +1:00 ) Central European Time ( ECT )","Africa/Blantyre[( GMT +2:00 ) Central African Time ( Africa/Blantyre )","Africa/Bujumbura[( GMT +2:00 ) Central African Time ( Africa/Bujumbura )","Africa/Cairo[( GMT +2:00 ) Eastern European Time ( Africa/Cairo )","Africa/Gaborone[( GMT +2:00 ) Central African Time ( Africa/Gaborone )","Africa/Harare[( GMT +2:00 ) Central African Time ( Africa/Harare )","Africa/Johannesburg[( GMT +2:00 ) South Africa Standard Time ( Africa/Johannesburg )","Africa/Kigali[( GMT +2:00 ) Central African Time ( Africa/Kigali )","Africa/Lubumbashi[( GMT +2:00 ) Central African Time ( Africa/Lubumbashi )","Africa/Lusaka[( GMT +2:00 ) Central African Time ( Africa/Lusaka )","Africa/Maputo[( GMT +2:00 ) Central African Time ( Africa/Maputo )","Africa/Maseru[( GMT +2:00 ) South Africa Standard Time ( Africa/Maseru )","Africa/Mbabane[( GMT +2:00 ) South Africa Standard Time ( Africa/Mbabane )","Africa/Tripoli[( GMT +2:00 ) Eastern European Time ( Africa/Tripoli )","Asia/Amman[( GMT +2:00 ) Eastern European Time ( Asia/Amman )","Asia/Beirut[( GMT +2:00 ) Eastern European Time ( Asia/Beirut )","Asia/Damascus[( GMT +2:00 ) Eastern European Time ( Asia/Damascus )","Asia/Gaza[( GMT +2:00 ) Eastern European Time ( Asia/Gaza )","Asia/Hebron[( GMT +2:00 ) Eastern European Time ( Asia/Hebron )","Asia/Istanbul[( GMT +2:00 ) Eastern European Time ( Asia/Istanbul )","Asia/Jerusalem[( GMT +2:00 ) Israel Standard Time ( Asia/Jerusalem )","Asia/Nicosia[( GMT +2:00 ) Eastern European Time ( Asia/Nicosia )","Asia/Tel_Aviv[( GMT +2:00 ) Israel Standard Time ( Asia/Tel_Aviv )","EET[( GMT +2:00 ) Eastern European Time ( EET )","Egypt[( GMT +2:00 ) Eastern European Time ( Egypt )","Etc/GMT-2[( GMT +2:00 ) GMT+02:00 ( Etc/GMT-2 )","Europe/Athens[( GMT +2:00 ) Eastern European Time ( Europe/Athens )","Europe/Bucharest[( GMT +2:00 ) Eastern European Time ( Europe/Bucharest )","Europe/Chisinau[( GMT +2:00 ) Eastern European Time ( Europe/Chisinau )","Europe/Helsinki[( GMT +2:00 ) Eastern European Time ( Europe/Helsinki )","Europe/Istanbul[( GMT +2:00 ) Eastern European Time ( Europe/Istanbul )","Europe/Kaliningrad[( GMT +2:00 ) Eastern European Time ( Europe/Kaliningrad )","Europe/Kiev[( GMT +2:00 ) Eastern European Time ( Europe/Kiev )","Europe/Mariehamn[( GMT +2:00 ) Eastern European Time ( Europe/Mariehamn )","Europe/Nicosia[( GMT +2:00 ) Eastern European Time ( Europe/Nicosia )","Europe/Riga[( GMT +2:00 ) Eastern European Time ( Europe/Riga )","Europe/Sofia[( GMT +2:00 ) Eastern European Time ( Europe/Sofia )","Europe/Tallinn[( GMT +2:00 ) Eastern European Time ( Europe/Tallinn )","Europe/Tiraspol[( GMT +2:00 ) Eastern European Time ( Europe/Tiraspol )","Europe/Uzhgorod[( GMT +2:00 ) Eastern European Time ( Europe/Uzhgorod )","Europe/Vilnius[( GMT +2:00 ) Eastern European Time ( Europe/Vilnius )","Europe/Zaporozhye[( GMT +2:00 ) Eastern European Time ( Europe/Zaporozhye )","Israel[( GMT +2:00 ) Israel Standard Time ( Israel )","Libya[( GMT +2:00 ) Eastern European Time ( Libya )","Turkey[( GMT +2:00 ) Eastern European Time ( Turkey )","ART[( GMT +2:00 ) Eastern European Time ( ART )","CAT[( GMT +2:00 ) Central African Time ( CAT )","Africa/Addis_Ababa[( GMT +3:00 ) Eastern African Time ( Africa/Addis_Ababa )","Africa/Asmara[( GMT +3:00 ) Eastern African Time ( Africa/Asmara )","Africa/Asmera[( GMT +3:00 ) Eastern African Time ( Africa/Asmera )","Africa/Dar_es_Salaam[( GMT +3:00 ) Eastern African Time ( Africa/Dar_es_Salaam )","Africa/Djibouti[( GMT +3:00 ) Eastern African Time ( Africa/Djibouti )","Africa/Juba[( GMT +3:00 ) Eastern African Time ( Africa/Juba )","Africa/Kampala[( GMT +3:00 ) Eastern African Time ( Africa/Kampala )","Africa/Khartoum[( GMT +3:00 ) Eastern African Time ( Africa/Khartoum )","Africa/Mogadishu[( GMT +3:00 ) Eastern African Time ( Africa/Mogadishu )","Africa/Nairobi[( GMT +3:00 ) Eastern African Time ( Africa/Nairobi )","Antarctica/Syowa[( GMT +3:00 ) Syowa Time ( Antarctica/Syowa )","Asia/Aden[( GMT +3:00 ) Arabia Standard Time ( Asia/Aden )","Asia/Baghdad[( GMT +3:00 ) Arabia Standard Time ( Asia/Baghdad )","Asia/Bahrain[( GMT +3:00 ) Arabia Standard Time ( Asia/Bahrain )","Asia/Kuwait[( GMT +3:00 ) Arabia Standard Time ( Asia/Kuwait )","Asia/Qatar[( GMT +3:00 ) Arabia Standard Time ( Asia/Qatar )","Asia/Riyadh[( GMT +3:00 ) Arabia Standard Time ( Asia/Riyadh )","Etc/GMT-3[( GMT +3:00 ) GMT+03:00 ( Etc/GMT-3 )","Europe/Minsk[( GMT +3:00 ) Moscow Standard Time ( Europe/Minsk )","Europe/Moscow[( GMT +3:00 ) Moscow Standard Time ( Europe/Moscow )","Europe/Simferopol[( GMT +3:00 ) Moscow Standard Time ( Europe/Simferopol )","Europe/Volgograd[( GMT +3:00 ) Moscow Standard Time ( Europe/Volgograd )","Indian/Antananarivo[( GMT +3:00 ) Eastern African Time ( Indian/Antananarivo )","Indian/Comoro[( GMT +3:00 ) Eastern African Time ( Indian/Comoro )","Indian/Mayotte[( GMT +3:00 ) Eastern African Time ( Indian/Mayotte )","W-SU[( GMT +3:00 ) Moscow Standard Time ( W-SU )","EAT[( GMT +3:00 ) Eastern African Time ( EAT )","Asia/Tehran[( GMT +3:30 ) Iran Standard Time ( Asia/Tehran )","Iran[( GMT +3:30 ) Iran Standard Time ( Iran )","Asia/Baku[( GMT +4:00 ) Azerbaijan Time ( Asia/Baku )","Asia/Dubai[( GMT +4:00 ) Gulf Standard Time ( Asia/Dubai )","Asia/Muscat[( GMT +4:00 ) Gulf Standard Time ( Asia/Muscat )","Asia/Tbilisi[( GMT +4:00 ) Georgia Time ( Asia/Tbilisi )","Asia/Yerevan[( GMT +4:00 ) Armenia Time ( Asia/Yerevan )","Etc/GMT-4[( GMT +4:00 ) GMT+04:00 ( Etc/GMT-4 )","Europe/Samara[( GMT +4:00 ) Samara Time ( Europe/Samara )","Indian/Mahe[( GMT +4:00 ) Seychelles Time ( Indian/Mahe )","Indian/Mauritius[( GMT +4:00 ) Mauritius Time ( Indian/Mauritius )","Indian/Reunion[( GMT +4:00 ) Reunion Time ( Indian/Reunion )","NET[( GMT +4:00 ) Armenia Time ( NET )","Asia/Kabul[( GMT +4:30 ) Afghanistan Time ( Asia/Kabul )","Antarctica/Mawson[( GMT +5:00 ) Mawson Time ( Antarctica/Mawson )","Asia/Aqtau[( GMT +5:00 ) Aqtau Time ( Asia/Aqtau )","Asia/Aqtobe[( GMT +5:00 ) Aqtobe Time ( Asia/Aqtobe )","Asia/Ashgabat[( GMT +5:00 ) Turkmenistan Time ( Asia/Ashgabat )","Asia/Ashkhabad[( GMT +5:00 ) Turkmenistan Time ( Asia/Ashkhabad )","Asia/Dushanbe[( GMT +5:00 ) Tajikistan Time ( Asia/Dushanbe )","Asia/Karachi[( GMT +5:00 ) Pakistan Time ( Asia/Karachi )","Asia/Oral[( GMT +5:00 ) Oral Time ( Asia/Oral )","Asia/Samarkand[( GMT +5:00 ) Uzbekistan Time ( Asia/Samarkand )","Asia/Tashkent[( GMT +5:00 ) Uzbekistan Time ( Asia/Tashkent )","Asia/Yekaterinburg[( GMT +5:00 ) Yekaterinburg Time ( Asia/Yekaterinburg )","Etc/GMT-5[( GMT +5:00 ) GMT+05:00 ( Etc/GMT-5 )","Indian/Kerguelen[( GMT +5:00 ) French Southern & Antarctic Lands Time ( Indian/Kerguelen )","Indian/Maldives[( GMT +5:00 ) Maldives Time ( Indian/Maldives )","PLT[( GMT +5:00 ) Pakistan Time ( PLT )","Asia/Calcutta[( GMT +5:30 ) India Standard Time ( Asia/Calcutta )","Asia/Colombo[( GMT +5:30 ) India Standard Time ( Asia/Colombo )","Asia/Kolkata[( GMT +5:30 ) India Standard Time ( Asia/Kolkata )","IST[( GMT +5:30 ) India Standard Time ( IST )","Asia/Kathmandu[( GMT +5:45 ) Nepal Time ( Asia/Kathmandu )","Asia/Katmandu[( GMT +5:45 ) Nepal Time ( Asia/Katmandu )","Antarctica/Vostok[( GMT +6:00 ) Vostok Time ( Antarctica/Vostok )","Asia/Almaty[( GMT +6:00 ) Alma-Ata Time ( Asia/Almaty )","Asia/Bishkek[( GMT +6:00 ) Kirgizstan Time ( Asia/Bishkek )","Asia/Dacca[( GMT +6:00 ) Bangladesh Time ( Asia/Dacca )","Asia/Dhaka[( GMT +6:00 ) Bangladesh Time ( Asia/Dhaka )","Asia/Kashgar[( GMT +6:00 ) Xinjiang Standard Time ( Asia/Kashgar )","Asia/Novosibirsk[( GMT +6:00 ) Novosibirsk Time ( Asia/Novosibirsk )","Asia/Omsk[( GMT +6:00 ) Omsk Time ( Asia/Omsk )","Asia/Qyzylorda[( GMT +6:00 ) Qyzylorda Time ( Asia/Qyzylorda )","Asia/Thimbu[( GMT +6:00 ) Bhutan Time ( Asia/Thimbu )","Asia/Thimphu[( GMT +6:00 ) Bhutan Time ( Asia/Thimphu )","Asia/Urumqi[( GMT +6:00 ) Xinjiang Standard Time ( Asia/Urumqi )","Etc/GMT-6[( GMT +6:00 ) GMT+06:00 ( Etc/GMT-6 )","Indian/Chagos[( GMT +6:00 ) Indian Ocean Territory Time ( Indian/Chagos )","BST[( GMT +6:00 ) Bangladesh Time ( BST )","Asia/Rangoon[( GMT +6:30 ) Myanmar Time ( Asia/Rangoon )","Indian/Cocos[( GMT +6:30 ) Cocos Islands Time ( Indian/Cocos )","Antarctica/Davis[( GMT +7:00 ) Davis Time ( Antarctica/Davis )","Asia/Bangkok[( GMT +7:00 ) Indochina Time ( Asia/Bangkok )","Asia/Ho_Chi_Minh[( GMT +7:00 ) Indochina Time ( Asia/Ho_Chi_Minh )","Asia/Hovd[( GMT +7:00 ) Hovd Time ( Asia/Hovd )","Asia/Jakarta[( GMT +7:00 ) West Indonesia Time ( Asia/Jakarta )","Asia/Krasnoyarsk[( GMT +7:00 ) Krasnoyarsk Time ( Asia/Krasnoyarsk )","Asia/Novokuznetsk[( GMT +7:00 ) Krasnoyarsk Time ( Asia/Novokuznetsk )","Asia/Phnom_Penh[( GMT +7:00 ) Indochina Time ( Asia/Phnom_Penh )","Asia/Pontianak[( GMT +7:00 ) West Indonesia Time ( Asia/Pontianak )","Asia/Saigon[( GMT +7:00 ) Indochina Time ( Asia/Saigon )","Asia/Vientiane[( GMT +7:00 ) Indochina Time ( Asia/Vientiane )","Etc/GMT-7[( GMT +7:00 ) GMT+07:00 ( Etc/GMT-7 )","Indian/Christmas[( GMT +7:00 ) Christmas Island Time ( Indian/Christmas )","VST[( GMT +7:00 ) Indochina Time ( VST )","Antarctica/Casey[( GMT +8:00 ) Australian Western Standard Time ( Antarctica/Casey )","Asia/Brunei[( GMT +8:00 ) Brunei Time ( Asia/Brunei )","Asia/Choibalsan[( GMT +8:00 ) Choibalsan Time ( Asia/Choibalsan )","Asia/Chongqing[( GMT +8:00 ) China Standard Time ( Asia/Chongqing )","Asia/Chungking[( GMT +8:00 ) China Standard Time ( Asia/Chungking )","Asia/Harbin[( GMT +8:00 ) China Standard Time ( Asia/Harbin )","Asia/Hong_Kong[( GMT +8:00 ) Hong Kong Time ( Asia/Hong_Kong )","Asia/Irkutsk[( GMT +8:00 ) Irkutsk Time ( Asia/Irkutsk )","Asia/Kuala_Lumpur[( GMT +8:00 ) Malaysia Time ( Asia/Kuala_Lumpur )","Asia/Kuching[( GMT +8:00 ) Malaysia Time ( Asia/Kuching )","Asia/Macao[( GMT +8:00 ) China Standard Time ( Asia/Macao )","Asia/Macau[( GMT +8:00 ) China Standard Time ( Asia/Macau )","Asia/Makassar[( GMT +8:00 ) Central Indonesia Time ( Asia/Makassar )","Asia/Manila[( GMT +8:00 ) Philippines Time ( Asia/Manila )","Asia/Shanghai[( GMT +8:00 ) China Standard Time ( Asia/Shanghai )","Asia/Singapore[( GMT +8:00 ) Singapore Time ( Asia/Singapore )","Asia/Taipei[( GMT +8:00 ) China Standard Time ( Asia/Taipei )","Asia/Ujung_Pandang[( GMT +8:00 ) Central Indonesia Time ( Asia/Ujung_Pandang )","Asia/Ulaanbaatar[( GMT +8:00 ) Ulaanbaatar Time ( Asia/Ulaanbaatar )","Asia/Ulan_Bator[( GMT +8:00 ) Ulaanbaatar Time ( Asia/Ulan_Bator )","Australia/Perth[( GMT +8:00 ) Australian Western Standard Time ( Australia/Perth )","Australia/West[( GMT +8:00 ) Australian Western Standard Time ( Australia/West )","Etc/GMT-8[( GMT +8:00 ) GMT+08:00 ( Etc/GMT-8 )","Hongkong[( GMT +8:00 ) Hong Kong Time ( Hongkong )","PRC[( GMT +8:00 ) China Standard Time ( PRC )","Singapore[( GMT +8:00 ) Singapore Time ( Singapore )","CTT[( GMT +8:00 ) China Standard Time ( CTT )","Asia/Pyongyang[( GMT +8:30 ) Korea Standard Time ( Asia/Pyongyang )","Australia/Eucla[( GMT +8:45 ) Australian Central Western Standard Time ( Australia/Eucla )","Asia/Chita[( GMT +9:00 ) Yakutsk Time ( Asia/Chita )","Asia/Dili[( GMT +9:00 ) Timor-Leste Time ( Asia/Dili )","Asia/Jayapura[( GMT +9:00 ) East Indonesia Time ( Asia/Jayapura )","Asia/Khandyga[( GMT +9:00 ) Yakutsk Time ( Asia/Khandyga )","Asia/Seoul[( GMT +9:00 ) Korea Standard Time ( Asia/Seoul )","Asia/Tokyo[( GMT +9:00 ) Japan Standard Time ( Asia/Tokyo )","Asia/Yakutsk[( GMT +9:00 ) Yakutsk Time ( Asia/Yakutsk )","Etc/GMT-9[( GMT +9:00 ) GMT+09:00 ( Etc/GMT-9 )","Japan[( GMT +9:00 ) Japan Standard Time ( Japan )","Pacific/Palau[( GMT +9:00 ) Palau Time ( Pacific/Palau )","ROK[( GMT +9:00 ) Korea Standard Time ( ROK )","JST[( GMT +9:00 ) Japan Standard Time ( JST )","Australia/Adelaide[( GMT +9:30 ) Australian Central Daylight Time (South Australia) ( Australia/Adelaide )","Australia/Broken_Hill[( GMT +9:30 ) Australian Central Daylight Time (South Australia/New South Wales) ( Australia/Broken_Hill )","Australia/Darwin[( GMT +9:30 ) Australian Central Standard Time (Northern Territory) ( Australia/Darwin )","Australia/North[( GMT +9:30 ) Australian Central Standard Time (Northern Territory) ( Australia/North )","Australia/South[( GMT +9:30 ) Australian Central Daylight Time (South Australia) ( Australia/South )","Australia/Yancowinna[( GMT +9:30 ) Australian Central Daylight Time (South Australia/New South Wales) ( Australia/Yancowinna )","ACT[( GMT +9:30 ) Australian Central Standard Time (Northern Territory) ( ACT )","Antarctica/DumontDUrville[( GMT +10:00 ) Dumont-d'Urville Time ( Antarctica/DumontDUrville )","Asia/Magadan[( GMT +10:00 ) Magadan Time ( Asia/Magadan )","Asia/Sakhalin[( GMT +10:00 ) Sakhalin Time ( Asia/Sakhalin )","Asia/Ust-Nera[( GMT +10:00 ) Ust-Nera Time ( Asia/Ust-Nera )","Asia/Vladivostok[( GMT +10:00 ) Vladivostok Time ( Asia/Vladivostok )","Australia/ACT[( GMT +10:00 ) Australian Eastern Daylight Time (New South Wales) ( Australia/ACT )","Australia/Brisbane[( GMT +10:00 ) Australian Eastern Standard Time (Queensland) ( Australia/Brisbane )","Australia/Canberra[( GMT +10:00 ) Australian Eastern Daylight Time (New South Wales) ( Australia/Canberra )","Australia/Currie[( GMT +10:00 ) Australian Eastern Daylight Time (New South Wales) ( Australia/Currie )","Australia/Hobart[( GMT +10:00 ) Australian Eastern Daylight Time (Tasmania) ( Australia/Hobart )","Australia/Lindeman[( GMT +10:00 ) Australian Eastern Standard Time (Queensland) ( Australia/Lindeman )","Australia/Melbourne[( GMT +10:00 ) Australian Eastern Daylight Time (Victoria) ( Australia/Melbourne )","Australia/NSW[( GMT +10:00 ) Australian Eastern Daylight Time (New South Wales) ( Australia/NSW )","Australia/Queensland[( GMT +10:00 ) Australian Eastern Standard Time (Queensland) ( Australia/Queensland )","Australia/Sydney[( GMT +10:00 ) Australian Eastern Daylight Time (New South Wales) ( Australia/Sydney )","Australia/Tasmania[( GMT +10:00 ) Australian Eastern Daylight Time (Tasmania) ( Australia/Tasmania )","Australia/Victoria[( GMT +10:00 ) Australian Eastern Daylight Time (Victoria) ( Australia/Victoria )","Etc/GMT-10[( GMT +10:00 ) GMT+10:00 ( Etc/GMT-10 )","Pacific/Chuuk[( GMT +10:00 ) Chuuk Time ( Pacific/Chuuk )","Pacific/Guam[( GMT +10:00 ) Chamorro Standard Time ( Pacific/Guam )","Pacific/Port_Moresby[( GMT +10:00 ) Papua New Guinea Time ( Pacific/Port_Moresby )","Pacific/Saipan[( GMT +10:00 ) Chamorro Standard Time ( Pacific/Saipan )","Pacific/Truk[( GMT +10:00 ) Chuuk Time ( Pacific/Truk )","Pacific/Yap[( GMT +10:00 ) Chuuk Time ( Pacific/Yap )","AET[( GMT +10:00 ) Australian Eastern Daylight Time (New South Wales) ( AET )","Australia/LHI[( GMT +10:30 ) Lord Howe Daylight Time ( Australia/LHI )","Australia/Lord_Howe[( GMT +10:30 ) Lord Howe Daylight Time ( Australia/Lord_Howe )","Antarctica/Macquarie[( GMT +11:00 ) Macquarie Island Standard Time ( Antarctica/Macquarie )","Asia/Srednekolymsk[( GMT +11:00 ) Srednekolymsk Time ( Asia/Srednekolymsk )","Etc/GMT-11[( GMT +11:00 ) GMT+11:00 ( Etc/GMT-11 )","Pacific/Bougainville[( GMT +11:00 ) Bougainville Standard Time ( Pacific/Bougainville )","Pacific/Efate[( GMT +11:00 ) Vanuatu Time ( Pacific/Efate )","Pacific/Guadalcanal[( GMT +11:00 ) Solomon Is. Time ( Pacific/Guadalcanal )","Pacific/Kosrae[( GMT +11:00 ) Kosrae Time ( Pacific/Kosrae )","Pacific/Norfolk[( GMT +11:00 ) Norfolk Time ( Pacific/Norfolk )","Pacific/Noumea[( GMT +11:00 ) New Caledonia Time ( Pacific/Noumea )","Pacific/Pohnpei[( GMT +11:00 ) Pohnpei Time ( Pacific/Pohnpei )","Pacific/Ponape[( GMT +11:00 ) Pohnpei Time ( Pacific/Ponape )","SST[( GMT +11:00 ) Solomon Is. Time ( SST )","Antarctica/McMurdo[( GMT +12:00 ) New Zealand Daylight Time ( Antarctica/McMurdo )","Antarctica/South_Pole[( GMT +12:00 ) New Zealand Daylight Time ( Antarctica/South_Pole )","Asia/Anadyr[( GMT +12:00 ) Anadyr Time ( Asia/Anadyr )","Asia/Kamchatka[( GMT +12:00 ) Petropavlovsk-Kamchatski Time ( Asia/Kamchatka )","Etc/GMT-12[( GMT +12:00 ) GMT+12:00 ( Etc/GMT-12 )","Kwajalein[( GMT +12:00 ) Marshall Islands Time ( Kwajalein )","NZ[( GMT +12:00 ) New Zealand Daylight Time ( NZ )","Pacific/Auckland[( GMT +12:00 ) New Zealand Daylight Time ( Pacific/Auckland )","Pacific/Fiji[( GMT +12:00 ) Fiji Summer Time ( Pacific/Fiji )","Pacific/Funafuti[( GMT +12:00 ) Tuvalu Time ( Pacific/Funafuti )","Pacific/Kwajalein[( GMT +12:00 ) Marshall Islands Time ( Pacific/Kwajalein )","Pacific/Majuro[( GMT +12:00 ) Marshall Islands Time ( Pacific/Majuro )","Pacific/Nauru[( GMT +12:00 ) Nauru Time ( Pacific/Nauru )","Pacific/Tarawa[( GMT +12:00 ) Gilbert Is. Time ( Pacific/Tarawa )","Pacific/Wake[( GMT +12:00 ) Wake Time ( Pacific/Wake )","Pacific/Wallis[( GMT +12:00 ) Wallis & Futuna Time ( Pacific/Wallis )","NST[( GMT +12:00 ) New Zealand Daylight Time ( NST )","NZ-CHAT[( GMT +12:45 ) Chatham Daylight Time ( NZ-CHAT )","Pacific/Chatham[( GMT +12:45 ) Chatham Daylight Time ( Pacific/Chatham )","Etc/GMT-13[( GMT +13:00 ) GMT+13:00 ( Etc/GMT-13 )","Pacific/Apia[( GMT +13:00 ) West Samoa Daylight Time ( Pacific/Apia )","Pacific/Enderbury[( GMT +13:00 ) Phoenix Is. Time ( Pacific/Enderbury )","Pacific/Fakaofo[( GMT +13:00 ) Tokelau Time ( Pacific/Fakaofo )","Pacific/Tongatapu[( GMT +13:00 ) Tonga Time ( Pacific/Tongatapu )","MIT[( GMT +13:00 ) West Samoa Daylight Time ( MIT )","Etc/GMT-14[( GMT +14:00 ) GMT+14:00 ( Etc/GMT-14 )","Pacific/Kiritimati[( GMT +14:00 ) Line Is. Time ( Pacific/Kiritimati )"]}}(this);
!function(e){function n(e){D[e]=function(){var n=u[e];return function(){s.push(n.bind(u,arguments))}}()}function t(){o=e.ZSEvents,r=o.topic,a=o.Groups,c=o.Names;for(var n=0,t=s.length;t>n;n++){var E=s.shift();E()}e.Collaboration=u,D=null,delete i.clearTransientQueue}for(var i=e.sPlusPlus,s=(i.SML.Client,[]),o=e.ZSEvents,r=o.topic,a=o.Groups,c=o.Names,E=e.ZSDevTools.Logger,l=e.ZSConstants.ShareConstants,u={handleUserList:function(){var e=i.view.getActiveGridID(),n=i.view.getResourceID(e),t=i.view.getVersionID(e);UserAction.SyncCollabUser(n,t,"init"),r.publish(a.Listener,c.CollabAction.JOIN_SUCCESS,{state:!0})},handleMessage:function(e,n,t,s,o){setTimeout(function(){var E=i.view.getActiveGridID(),l=i.view.getResourceID(E);i.data.DocRegistry[l]&&e===i.data.DocRegistry[l].COLLAB_ID&&r.publish(a.WMS,c.WMS.processMessage,{CHID:e,UNAME:n,USERZUID:t,SENDER:s,MSG:o})},2)},handlePresence:function(e,n,t,i,s){var o={chid:e,uname:n,zuid:t,dname:i,status:s};(0===s||"0"===s)&&r.publish(a.Listener,c.DocAction.USER_INFO.REMOVE,{chid:e,list:[o]})},join:function(e){WebMessanger.joinCollab(e)},quit:function(){setTimeout(function(){var e=i.view.getActiveGridID(),n=i.view.getResourceID(e),t=i.view.getVersionID(e);UserAction.SyncCollabUser(n,t,"refresh")},10)},onConnect:function(){},serverup:function(){r.publish(a.WMS,c.WMS.handleServerUp)},serverdown:function(){r.publish(a.WMS,c.WMS.handleJoinError),E.alert("info","COLLABIMPL : func called..","serverdown")},handleZohoMessage:function(){},handleCustomMessage:function(e){setTimeout(function(){r.publish(a.WMS,c.WMS.processCustomMessage,{MSG:e})},2)},handleCrossProductMessage:function(n,t){var s=t.RESOURCE_ID?t.RESOURCE_ID:t.resourceId,o=i.view.getActiveGridID(),E=i.view.getResourceID(o),u=i.view.getVersionID(o),S=i.data.getWorkBook(E,u);if(S&&s===E){void 0!==t.newDocumentName&&"RENAME_DOCUMENT"==t.action?r.publish(a.Listener,c.DocAction.DOCUMENT.RENAME,{NEW_NAME:t.newDocumentName,RESOURCE_ID:s,VERSION:u}):void 0!==t.NAME&&t.ACTION_BY!=i.data.UserInfo.zuid&&"RESOURCE_RENAMED"==t.ACTION&&r.publish(a.Listener,c.DocAction.DOCUMENT.RENAME,{NEW_NAME:t.NAME,RESOURCE_ID:s,VERSION:u});var D=i.SML.Client.Utility.WorkerRequest,A=new D,I=e.ZSConstants.URI;if("RESOURCE_SHARED"==t.ACTION){var R,C=JSON.parse(t.ACTION_INFO);switch(C.SHARED_TYPE){case l.SHAREDTYPE_PERSONAL:R="personal";break;case l.SHAREDTYPE_GROUP:R="group";break;case l.SHAREDTYPE_ORG:R="org";break;default:return}var O=i.data.getSharePublishMeta(E).getShareMeta();O.setType(R),r.publish(a.Listener,c.WMSAction.ON_SHARE,{ISSHARED:!0}),r.publish(a.Listener,c.DocAction.Collaborators.UPDATE,{MSG:t})}else if("RESOURCE_PERMISSION_CHANGED"==t.ACTION){var d={RID:s,VERSION:u,LoginName:i.data.PageRegistry.wmsOptions.loginName};A.open(I.SHARE_PERMISSION_CHANGE),A.send(d)}else if("RESOURCE_LOCKED"==t.ACTION||"RESOURCE_UNLOCKED"==t.ACTION){var h="RESOURCE_LOCKED"==t.ACTION;r.publish(a.Listener,c.DocMeta.LOCKED_INFO,{isLocked:h,lockedByZuid:t.ACTION_BY,lockedBy:t.ACTION_BY_USERNAME})}else if("RESOURCE_TRASHED"==t.ACTION)r.publish(a.Listener,c.DocMeta.TRIGGER_DOCUMENT_EXIT,{EXCEPTIONKEY:"Trash.dialog.dlgMsg",UPDATEDOCLIST:1});else if("RESOURCE_UNSHARED"==t.ACTION){r.publish(a.Listener,c.DocAction.Collaborators.UPDATE,{MSG:t}),i.data.UserInfo.zuid!==t.OWNER&&r.publish(a.Listener,c.DocMeta.TRIGGER_DOCUMENT_EXIT,{EXCEPTIONKEY:"Share.dialog.removeShareMsg",UPDATEDOCLIST:1});var g=i.data.getSharePublishMeta(E),N=g.getShareMeta(),C=JSON.parse(t.ACTION_INFO),v=!1;switch(C.SHARED_TYPE){case l.SHAREDTYPE_PERSONAL:case l.SHAREDTYPE_GROUP:case l.SHAREDTYPE_ORG:v=!0}N.getSharedUserInfo().isEmpty()&&v&&(N.setType(),r.publish(a.Listener,c.WMSAction.ON_SHARE,{ISSHARED:!1}))}}},openURL:function(e,n,t,i){return"ST"===i&&null!==t.DOCID?(loadDocument(t.DOCID,n),!1):!0},handleUserAdd:function(e,n){var t=i.view.getActiveGridID(),s=i.view.getResourceID(t),o=i.view.getVersionID(t);UserAction.SyncCollabUser(s,o,"refresh"),r.publish(a.Listener,c.UserAction.COLLAB_LIST.STATUS,{MSG:n,ACTION:"ADD"})},handleUserDeleted:function(e,n){var t=i.view.getActiveGridID(),s=i.view.getResourceID(t),o=i.view.getVersionID(t);UserAction.SyncCollabUser(s,o,"refresh"),r.publish(a.Listener,c.UserAction.COLLAB_LIST.STATUS,{MSG:n,ACTION:"DELETE"})},handleCollabAdd:function(){},handleCollabDelete:function(){},handleIsOnline:function(){},handleLogout:function(){},goOffline:function(){},wmsOffline:function(){try{r.publish(a.WMS,c.WMS.handleOffline)}catch(e){E.alert("info","in catch....")}},handleChatNotifyMessage:function(){},getPageTitle:function(){var e=i.view.getActiveGridID(),n=i.view.getResourceID(e),t=i.view.getVersionID(e),s=i.data.getWorkBook(n,t);return i.data&&s&&s?s.Name:void 0},handleWmsDisable:function(){},handleServiceMessage:function(){},handleComposeMail:function(){return!1},handleLanguageChange:function(n){var t=i.view.getActiveGridID(),s=i.view.getResourceID(t),o=i.view.getVersionID(t);e.UserAction.ChangeI18NSession(s,o,n)}},S=Object.keys(u),D=Object.create(u),A=0;A<S.length;A++)n(S[A]);i.clearTransientQueue=t,e.Collaboration=D}(this);
!function(C){C.ZSConstants.ResponseCode={CONNECT:100,ACKNOWLEDGE:101,SUCCESS:200,REDIRECT:300,INVALID:400,TIMEOUT:408,EXCEPTION:500}}(this);
!function(t){var e=(t.ZSDevTools.Logger,t.Array.prototype),i=(e.forEach,t.String.prototype);i.contains||(i.contains=function(t){return-1!==this.indexOf(t)}),i.startsWith||(i.startsWith=function(t){return 0===this.indexOf(t)}),i.endsWith||(i.endsWith=function(t){return this.slice(this.length-t.length)===t}),i.decodeXSSSymbls||(i.decodeXSSSymbls=function(){return this.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),e.fill||Object.defineProperty(e,"fill",{enumerable:!1,value:function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=this.length-1);for(var n=e;i>=n;n++)this[n]=t;return this}})}(this);
!function(e){function t(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function r(e){return e=s(e),!1}function i(e){var t=/^[A-z]/,r=e.length;if(r>=2&&isNaN(e.charAt(0))&&t.test(e)){if(2==r&&!isNaN(e.charAt(1))&&parseInt(e.charAt(1))>0)return!0;if(isNaN(e.charAt(1))){if(!isNaN(e.substring(2,r))){var i=e.toUpperCase().charCodeAt(0),s=parseInt(e.substring(2,r));if(f>=s&&s>0&&73>=i)return 73==i&&e.toUpperCase().charCodeAt(1)>86?!1:!0}}else if(!isNaN(e.substring(1,r))){var s=parseInt(e.substring(1,r));if(f>=s&&s>0)return!0}}return!1}function s(e){for(;-1!=e.indexOf("'");)e=e.replace("'","");return e}var n=e.ZSDevTools.Logger,a='style="text-decoration: underline; cursor: pointer;"',l={},o=e.sPlusPlus.data.Defaults,f=o.MAX_ROW,m=(o.MAX_COL,e.JSUtil);l._urlConverter=function(e){var t="HTTP://",r="HTTPS://",i="WWW.",s=!1,n=e.toUpperCase();if(0===n.indexOf(t)||0===n.indexOf(r)||0===n.indexOf(i))if(s=!0,0===n.indexOf(i)){var l="http://";e='<a href="'+l+e+'" title="'+e+'" target="_blank" rel="noreferrer" '+a+" >"+e+"</a>"}else e='<a href="'+e+'" title="'+e+'" target="_blank" rel="noreferrer" '+a+" >"+e+"</a>";return{hasUrl:s,msg:e}},l._emailIdConverter=function(e){var r=!1;return t(e)&&(r=!0,e='<a href="mailto:'+e+'" title="mailto:'+e+'" '+a+" >"+e+"</a>"),{hasEmailId:r,msg:e}},l._sheetRefConverter=function(e,t,s){var n=!1;if(e&&0==e.indexOf("#")){e=e.substr(1);var l=e;if(e.indexOf(".")>=0&&2==e.split(".").length&&r(e.split(".")[0])){var o=e.split(".")[1];o.indexOf(":")>=2?i(o.split(":")[0])&&i(o.split(":")[1])&&(n=!0):i(o)&&(n=!0)}else if(r(e))n=!0;else if(e.indexOf(":")>=2){if(i(e.split(":")[0])&&i(e.split(":")[1])&&(n=!0,t&&r(t)))var l=t+"."+e}else if(i(e)&&(n=!0,t&&r(t)))var l=t+"."+e;e=n?s?"<a onclick=\"Discussion.disableCmtHgltOnFocus=true;Goto.gotoCellInit('"+l+'\');" title="#'+e+'" '+a+" >"+e+"</a>":"<a onclick=\"Goto.gotoCellInit('"+l+'\')" title="#'+e+'" '+a+" >"+e+"</a>":"#"+e}return{hasSheetRef:n,msg:e}},l._smileyConverter=function(e){var t=!1,r=l.wmsSmiley[m.fn.revertJsonSplChrs(e).toUpperCase()];return r&&(t=!0,e='<span class="wmssmils wmssmil-'+r+'" symbol="'+e+'" title="'+r+'"></span>'),{hasSmiley:t,msg:e}},l._commentRefConverter=function(e){var t=!1;return{hasCommentRef:t,msg:e}},l.convert=function(e,t,r){for(var i=!1,s=!1,n=!1,a=!1,o=!1,f=!1,m=e.split("<br>"),u=0;u<m.length;u++){for(var c=m[u],p=c.split(" "),v=0;v<p.length;v++){var h=!1;p[v]=p[v].replace(/[\u200B-\u200D\uFEFF]/g,"");var g=l._urlConverter(p[v]);h=s=g.hasUrl,p[v]=g.msg,h||(g=l._emailIdConverter(p[v]),h=n=g.hasEmailId,p[v]=g.msg),h||(g=l._sheetRefConverter(p[v],t,r),h=a=g.hasSheetRef,p[v]=g.msg),h||(g=l._commentRefConverter(p[v]),h=f=g.hasCommentRef,p[v]=g.msg),h||(g=l._smileyConverter(p[v]),h=o=g.hasSmiley,p[v]=g.msg),c=p.join(" "),i=i||h}m[u]=c.trim(),e=m.length>1?m.join("<br>"):m[0].toString()}return{hasLinkMsg:i,msg:e}},l.isCellLabel=i,l.wmsSmiley={},l.loadSmiley=function(){try{Smiley.init();for(var e in Smiley.defaultsmiley_lookup)l.wmsSmiley[e.toUpperCase()]=Smiley.defaultsmiley_lookup[e];for(var e in Smiley.extrasmiley_lookup)l.wmsSmiley[e.toUpperCase()]=Smiley.extrasmiley_lookup[e]}catch(e){n.forcePrint("Exception in loadSmiley : ",e)}}(),e.JSUtil.LinkMaker=l}(this);
!function(e){function t(e,t,a){var i=[],r=0,l=[],s="";t=t.replace(/\u200B/gm,"").replace(/&nbsp;/g," ").replace(/\s/g," ");for(var o,p=new RegExp("^"+n(t),"i"),g=new RegExp(n(t),"i"),u=0;u<e.length;u++){if(o=e[u],a===r)return!1;if("G"===o.type&&2!=o.status&&-1===l.indexOf(o.id)&&g.test(o.name)){l.push(o.id);var d={};d.value={value:o.id,content:"<span type="+o.type+' spellcheck="false" contenteditable="false">'+o.name+"</span> "},d.label="<img src='"+s+"'> <span class='nameCont'>"+o.name+"</span>",i.push(d),r++}else if("C"===o.type&&-1===l.indexOf(o.id)&&(p.test(o.name)||p.test(o.email)||p.test(o.fullname))){s=c+"/file?fs=thumb&ID="+o.id,l.push(o.id);var d={};e[u].name=e[u].fullname,d.data=e[u],d.value={value:o.id,content:"<span type="+o.type+' spellcheck="false" contenteditable="false">'+o.name+"</span> "};var f=document.createElement("IMG");f.setAttribute("src",s),d.label="<img src='"+s+"' class='sI'> <span class='nameCont sN'>"+o.name+"</span>",d.photoURL=s,i.push(d),r++}}return i}function n(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function a(e,n){o.richTextArea(e,{triggers:[{trigger:"@",callback:function(e,a){a(t(n,e,10))}}],sheet:{handlePasteInRichContent:function(e,t){p.handlePasteInRichContent(e,t)}}})}function i(e){for(var t=e.length,n="",a=0;t>a;a++){var r=e[a];if(8!==r.nodeType)if(3===r.nodeType||4===r.nodeType)n+=r.textContent;else if(r.getAttribute("type")&&!isNaN(r.getAttribute("data-value")&&r.textContent.length)){var l=r.getAttribute("type");if("G"===l||"C"===l){var s=("G"===l?"group":"user")+":mention";n+="<"+s+">"+r.getAttribute("data-value")+":"+r.textContent+"</"+s+">"}}else if("BR"===r.tagName)n+="\n";else if("P"===r.tagName)n+="\n"+i(r.childNodes);else if("DIV"===r.tagName){var o=r.childNodes;n+=1===o.length&&"BR"===o[0].tagName?"\n":"\n"+i(o)}else n+=r.textContent}return n}function r(e,t,n){if(n){var a=UserAction.getTemplate(["SP_NOTIFY_ELLIPSE"]).SP_NOTIFY_ELLIPSE;e.appendChild(a)}else{var a=UserAction.getTemplate(["SP_COMMENTS_SEE_MORE"]).SP_COMMENTS_SEE_MORE;e.appendChild(a);var i=e.querySelector("#sPSeeMore");i.addEventListener("click",function(){return e.innerHTML=t,this.remove(),!1})}}{var l=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,o=(l.view.Toolbar.Feature[s.COMMENTS],e.UIUtil.Component),c=l.data.AppRegistry.USER_PHOTO_SERVER_URL,p={};e.JSUtil}p.getRichTextContent=function(e){e.innerHTML=e.innerHTML.replace(/&nbsp;/gi," ");var t=i(e.childNodes);return t=t.replace(/\u200B/gm,"").replace(/&nbsp;/g," "),t.trim()},p.getActualContent=function(e){var t=i(e.childNodes);return t=t.replace(/\u200B/gm,"").replace(/&nbsp;/g," "),t.trim()},p.handlePasteInRichContent=function(e,t){if(window.clipboardData){e.preventDefault();var n=void 0!=t?t.height():0;return document.selection.createRange().pasteHTML(window.clipboardData.getData("Text")),$("#discussionTray").scrollTop($("#discussionTray").scrollTop()+((void 0!=t?t.height():0)-n)),!0}if(document.queryCommandEnabled("insertHTML")&&(e.originalEvent||e).clipboardData){e.preventDefault();var n=void 0!=t?t.height():0,a=(e.originalEvent||e).clipboardData.getData("text/plain"),i=window.getSelection();return i.rangeCount>0&&document.execCommand("insertHTML",!1,a.replace(/</gm,"&lt;").replace(/>/g,"&gt;").replace(/\u200B/gm,"").replace(/\n/gm,"<br>")),!0}return!1},p.convertRichTextContent=function(e){if(void 0==e)return"";e=e.replace(/<\/?a.*?>/,"");var t=/((<user:mention>[0-9]+:.+?<\/user:mention>)|(<group:mention>[0-9]+:.+?<\/group:mention>))/g,n=e.match(t);if(n)for(var a=l.view.getActiveGridID(),i=l.view.getResourceID(a),r=l.data.getSharePublishMeta(i).getShareMeta(),s=r.getSharedUserInfo(),o=n.length,c=0;o>c;c++){var p=n[c];if(0===p.indexOf("<user:mention>")){var g=p.replace(/<\/?user:mention>/g,"").split(":"),u=s.getNameByID(g[0]),d=void 0==u?g[1]:u;e=e.replace(p,'​<span type="C" spellcheck="false" class="highlight" contenteditable="false" data-value='+g[0]+">"+d+"</span>&#8203;​")}else if(0===p.indexOf("<group:mention>")){var f=p.replace(/<\/?group:mention>/g,"").split(":");e=e.replace(p,'​<span type="G" spellcheck="false" class="highlight" contenteditable="false" data-value='+f[0]+">"+f[1]+"</span>​")}}return e=e.replace("<br>","<br>​")},p.checkEllipse=function(e,t,n,a,i){var l=e.scrollHeight,s=e.clientHeight;if(s>=l)return void e.classList.remove(a);var c=0,p=1,g=18,u=0,d=0,f=o.contents(e),h=f.length;for(e.innerHTML="",e.classList.remove(a),d=0;h>d;d++)if(p=g/18,e.appendChild(f[d]),g=e.clientHeight,"BR"===f[d].tagName&&(g+=18),g>n){u=g/18-p,e.innerHTML="";for(var v=0;d>v;v++)e.appendChild(f[v]);break}if(g=e.clientHeight,0>g-n&&(c=n/18-p,void 0!=f[d]&&3==f[d].nodeType)){for(var v=0;d>v;v++)e.appendChild(f[v]);var m=f[d].textContent;m=m.substr(0,m.length*c/u),e.innerHTML=e.innerHTML+m}r(e,t,i)},p.convertRichTextContentOnUpdate=function(e){if(void 0==e)return"";e=e.replace(/<\/?a.*?>/,"");var t=/((&lt;user&#x3a;mention&gt;[0-9]+&#x3a;.+?&lt;&#x2f;user&#x3a;mention&gt;)|(<group:mention>[0-9]+:.+?<\/group:mention>))/g,n=e.match(t);if(n)for(var a=n.length,i=0;a>i;i++){var r=n[i];if(0===r.indexOf("&lt;user&#x3a;mention&gt;")){var l=r.replace(/&lt;(&#x2f;)?user&#x3a;mention&gt;/g,"").split("&#x3a;");e=e.replace(r,'​<span type="C" spellcheck="false" class="highlight" contenteditable="false" data-value='+l[0]+">"+l[1]+"</span>&#8203;​")}else if(0===r.indexOf("<group:mention>")){var s=r.replace(/<\/?group:mention>/g,"").split(":");e=e.replace(r,'​<span type="G" spellcheck="false" class="highlight" contenteditable="false" data-value='+s[0]+">"+s[1]+"</span>​")}}return e=e.replace("<br>","<br>​")},p.connectProcessMention=function(e,t){if(t){var n=t.getAttribute("streamType");if("3"===n||"6"===n||"13"===n)return void t.find(".mention").unbind("paste").bind("paste",function(e){p.handlePasteInRichContent(e)})}var i=p.getMentionsData(),r=e.getAttribute("participantsMentionData");if(r){var l=JSON.stringify(p.getMentionsData());l=l.substring(1),l="["+r+","+l,i=$.parseJSON(l)}a(e,i)},p.getMentionsData=function(){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),n=l.data.getSharePublishMeta(t).getShareMeta(),a=n.getSharedUserInfo();return a.get()},p.getName=function(e){var t=l.view.getActiveGridID(),n=l.view.getResourceID(t),a=l.data.getSharePublishMeta(n).getShareMeta(),i=a.getSharedUserInfo();return i.getNameByID(e)},e.JSUtil.RCMentionDataShim=p}(this);
!function(e){function s(s){{var i=e.WebMessanger;e.WmsContactImpl,e.WMSSessionConfig}i.theme=s.theme?s.theme:"grey",i.setNoDomainChange(),s.langCode&&s.countryCode&&i.setLocale(s.langCode,s.countryCode),s.wmsctxpath&&i.setWmsContext(s.wmsctxpath),s.rebrandName&&i.setRebrand(s.rebrandName),s.meetingURL&&i.setMeetingUrl(s.meetingURL),s.disableMeeting&&i.disableMeeting(),s.disableContacts&&i.disableContacts(),s.disableGroups&&i.disableGroups(),s.disableActiveChat&&i.disableActiveChat(),s.disableProfile&&i.disableProfile();var t=i.getNickName();t&&(s.loginName=t)}function i(e){g=e?e:g,s(g);var i=g.loginName?g.loginName:"",t=g.zuid?g.zuid:-1,n={};if(n.ISRMVIEW=g.isRemoteView,g.isAnonUser){var a=g.rmUser,o=!0;WebMessanger.registerAnnon("ST",a,i,o)}else{var o=!0,S=WMSSessionConfig.CHAT|WMSSessionConfig.CHAT_PRESENCE|WMSSessionConfig.PRESENCE_ORG|WMSSessionConfig.PRESENCE_PERSONAL|WMSSessionConfig.CROSS_PRD;WebMessanger.setConfig(S),WebMessanger.registerZuid("ST",t,i,o),WebMessanger.register("ST",t,o,r.data.UserInfo.authtoken,r.data.UserInfo.authscope)}}var t=e.ZSEvents,n=t.topic,a=t.Groups,o=t.Names,r=e.sPlusPlus,g=r.data.PageRegistry.wmsOptions||{};r.data.PageRegistry.wmsOptions&&i(),n.register(a.WMS,o.WMS.register,i,"OPTIONS")}(this);
!function(t){function i(){this.id=0}var s=2e4;i.prototype={get:function(){return this.id>s&&this.flush(),this.id++},flush:function(){this.id=0}},t.ZSClass.IDGenerator=i}(this);
!function(t){function n(){this.map={}}t.sPlusPlus;n.prototype={set:function(t,n){this.map[t]=n},remove:function(t){delete this.map[t]},get:function(t){return this.map[t]},getMap:function(){return this.map},clear:function(){this.map={}},isEmpty:function(){return 0==this.length()},length:function(){return Object.keys(this.map).length},getKeys:function(){return Object.keys(this.map)}},t.ZSClass.Map=n}(this);
!function(t){function i(t){this.value=t,this.children=[]}function n(){}function r(t){for(var i=0,n=this.children.length;n>i;i++){var e=this.children[i];r.call(e,t)}t(this)}function e(t,i){if(i.push(this.value),t===this.value)return!0;for(var n=0,r=this.children.length;r>n;n++){var h=this.children[n],o=e.call(h,t,i);if(o)return!0}i.pop()}var h=t.ZSClass;i.prototype={addChild:function(t){this.children.push(t)},addChildNode:function(t){this.addChild(new i(t))},removeChild:function(t){var i=this.children.indexOf(t);-1!==i&&this.children.splice(i,1)}},n.prototype={traverseDFS:function(t){r.call(this.root,t)},createNode:function(t){var n=new i(t);return n},setRoot:function(t){this.root=t},getPath:function(t){var i=[];return e.call(this.root,t,i),i}},h.Tree=n}(this);
!function(t){function e(t,e,i,o){this.Name=t,this.Id=e,this.Style=i,this.isHidden=o}function i(){for(var t=[],e=0;e<this.length;e++)t.push(this[e].toString());return"["+t.join()+"]"}function o(){this.toString=i}var n=t.ZSClass,s=t.ZSDevTools.Logger;e.prototype={rename:function(t){this.Name=t},clone:function(){return new e(this.Name,this.Id,this.Style,this.isHidden)},getName:function(){return this.Name},getID:function(){return this.Id},getStyle:function(){return this.Style},setStyle:function(t){this.Style=t},setHidden:function(t){this.isHidden=t},getHidden:function(){return this.isHidden},toString:function(){return JSON.stringify(this)}},o.prototype=new t.Array,o.prototype.getCount=function(){return this.length},o.prototype.getAllSheetNames=function(t){t=t?t:!1;for(var e=[],i=0,o=this.length;o>i;i++)t?e.push(this[i].Name):!this[i].isHidden&&e.push(this[i].Name);return e},o.prototype.getSheets=function(t){t=t?t:!1;for(var e=[],i=0,o=this.length;o>i;i++)t?e.push(this[i]):!this[i].isHidden&&e.push(this[i]);return e},o.prototype.getIdByName=function(t){for(var t=t.replace(/[']+/g,""),e=0,i=this.length;i>e;e++)if(this[e].Name.toUpperCase()===t.toUpperCase())return this[e].Id;return s.isEnabled?s.alert("error"," SHEETNAME not found ",t):void 0},o.prototype.isNameExists=function(t){for(var e=0,i=this.length;i>e;e++)if(this[e].getName().toUpperCase()==t.toUpperCase())return!0;return!1},o.prototype.getPosById=function(t,e){var i=this.getSheets(e);for(var o in i)if(i[o].Id===t)return o},o.prototype.getById=function(t){return this[this.getPosById(t,!0)]},o.prototype.getByPos=function(t,e){var i=this.getSheets(e);return i[t]},o.prototype.getNextAvalable=function(t){var e=this.getPosById(t),i=this.getSheets().length-1;return e>=i?e--:e++,this.getByPos(e).Id},o.prototype.clone=function(){for(var t=new o,e=0;e<this.length;e++)t.splice(e,0,this[e].clone());return t},o.prototype.create=function(t,i,o,n,r){o||0===o||(s.log("SHEET DON't have position",t),o=this.getCount()),i||(s.log("SHEET DON't have sheetId",t),i=o+"#");var h=this.getHiddenSheetsCount(o);o+=h;var p=new e(t,i,n,r);return this.splice(o,0,p),p},o.prototype.getHiddenSheetsCount=function(t){for(var e=0,i=0;t>i;i++)1==this[i].isHidden&&e++;return e},o.prototype.renameById=function(t,e){this.getByPos(this.getPosById(t)).rename(e)},o.prototype.renameByPos=function(t,e){this.getByPos(t).rename(e)},o.prototype.removeById=function(t){this.splice(this.getPosById(t),1)},o.prototype.removeByPos=function(t){this.splice(t,1)},o.prototype.removeAll=function(){for(var t=this.length-1;t>=0;t--)this.removeByPos(t)},o.prototype.setStyleById=function(t,e){this.getByPos(this.getPosById(t)).setStyle(e)},o.prototype.moveById=function(t,e){var i=this.splice(this.getPosById(t,!0),1);this.splice(e,0,i[0])},o.prototype.setHidden=function(t,e){this.getByPos(this.getPosById(t,!0),!0).setHidden(e)},o.prototype.getHiddenSheets=function(){for(var t=[],e=0,i=this.length;i>e;e++)this[e].getHidden()&&t.push(this[e]);return t},o.prototype.copyById=function(){},o.prototype.copyByPos=function(){},n.SheetList=o}(this);
!function(t){var i=(t.sPlusPlus,function(){this.active=[],this.objArray={},this.indexArray=[]});i.prototype={addObject:function(t,i,r){this.objArray[t]=r,this.indexArray[i]=t},getObject:function(t){return this.isExist(t)?this.objArray[t]:void 0},modifyObject:function(t,i){var r=this.objArray[t];for(var e in i)void 0!=r[e]&&(r[e]=i[e])},getAllObjects:function(){return this.objArray},deleteObject:function(t){this.isExist(t)&&delete this.objArray[t]},setActive:function(t){var i=this.active;for(var r in i)if(i[r]===t)return;this.active.push(t)},getIndexOfId:function(t){return this.objArray[t]?this.indexArray.indexOf(t):void 0},getIdFromIndex:function(t){return this.indexArray.length>0?this.indexArray[t]:void 0},getActive:function(){return this.active},resetActive:function(){this.active=[]},isExist:function(t){var i=this.objArray;for(var r in i)if(r===t)return!0;return!1}},t.ZSClass.OleInfo=i}(this);
!function(t){function i(t,i,e,n,s){this.label=t,this.x=i,this.y=e,this.width=n,this.height=s}function e(t,i){this.module=t,this.macroName=i}var n=t.ZSClass;i.prototype={setPosition:function(t,i){this.x=t,this.y=i},setDimension:function(t,i){this.width=t,this.height=i},setLabel:function(t){this.label=t},setScript:function(t,i){this.script=new e(t,i)},getLabel:function(){return this.label},getX:function(){return this.x},getY:function(){return this.y},getWidth:function(){return this.width},getHeight:function(){return this.height},getScript:function(){return this.script},clone:function(){var t=new i(this.label,this.x,this.y,this.width,this.height);return this.script&&t.setScript(this.script.module,this.script.macroName),t}},e.prototype={getModule:function(){return this.module},getMacroName:function(){return this.macroName},toString:function(){return this.getModule()+"."+this.getMacroName()}},n.Button=i}(this);
!function(t){function i(t,i,n,h,e,s,o,f,u,r,a){this.Name=t,this.Row=i,this.Col=n,this.RowDiff=h,this.ColDiff=e,this.Width=s,this.Height=o,this.URL=f,this.zIndex=u,this.naturalHeight=a,this.naturalWidth=r}var n=t.ZSClass;i.prototype={getName:function(){return this.Name},setName:function(t){this.Name=t},getRow:function(){return this.Row},setRow:function(t){this.Row=t},getRowDiff:function(){return this.RowDiff},setRowDiff:function(t){this.RowDiff=t},getCol:function(){return this.Col},setCol:function(t){this.Col=t},getColDiff:function(){return this.ColDiff},setColDiff:function(t){this.ColDiff=t},getWidth:function(){return this.Width},setWidth:function(t){this.Width=t},getHeight:function(){return this.Height},setHeight:function(t){this.Height=t},getURL:function(){return this.URL},setURL:function(t){this.URL=t},getZIndex:function(){return this.zIndex},setZIndex:function(t){this.zIndex=t},getNaturalWidth:function(){return this.naturalWidth},setNaturalWidth:function(t){this.naturalWidth=t},getNaturalHeight:function(){return this.naturalHeight},setNaturalHeight:function(t){this.naturalHeight=t},clone:function(){var t=new i(this.Name,this.Row,this.Col,this.RowDiff,this.ColDiff,this.Width,this.Height,this.URL,this.zIndex);return t}},n.Image=i}(this);
!function(t){function e(t,e,i,r,h){this.sheets=[],this.ranges=[],this.sheetList=t,this.rID=e,this.gridID=s.view&&s.view.getActiveGridID(),this.version=i,this.isMultiRangeSupport=r?r:!1,this.isMultiSheetSupport=h?h:!1,this.dRngsinDifSheet=!1}{var s=t.sPlusPlus;s.SML.Client}e.prototype={getSheets:function(){var t=this.sheetList;if(this.dRngsinDifSheet)for(var e=0;e<t.length;e++){var s=t[e];this.sheets.push(this.array(s))}else this.sheets.push(this.isMultiSheetSupport?t:this.array(t[0]));return this.sheets},getRanges:function(){var t=(s.data.getWorkBook(this.rID,this.version),this.sheetList);this.ranges=[];for(var e=this.dRngsinDifSheet?t:[t[0]],i=0;i<e.length;i++){var r=e[i],h=s.view.getSheetState(this.gridID,r),a=this.isMultiRangeSupport?h.getRanges():this.array(h.getActiveRange());this.ranges.push(a)}return this.ranges},getActiveCell:function(){var t=(s.data.getWorkBook(this.rID,this.version),s.view.getSheetID(this.gridID)),e=s.view.getSheetState(this.gridID,t),i=e.getActiveCellRange();if(void 0!=i){var r={s:t,r:i.startRow,c:i.startCol};return r}},getCustomRanges:function(t,e){var i=(s.data.getWorkBook(this.rID,this.version),this.sheetList);this.ranges=[];for(var r=this.isMultiRangeSupport&&this.dRngsinDifSheet?i:[i[0]],h=0;h<r.length;h++){{r[h]}this.ranges.push(e?t:this.array(t))}return this.ranges},getParmsFromDataString:function(t){var e=[],s=this.rID,i=this.version;t.split(";").forEach(function(t){var r=JSUtil.Range.parseRange(s,i,t);void 0!=r&&e.push(r)});for(var r=[],h=[],a=0;a<e.length;a++){var n=e[a].sheetID,g=e[a].range;if(r.length<1){var u=this.array(n),o=this.array(g);r.push(u),h.push(o)}else{var v=JSUtil.fn.getIndexOf(n,r);if(-1!=v)h[v].push(g);else if(this.dRngsinDifSheet){var u=this.array(n),o=this.array(g);r.push(u),h.push(o)}else r[0].push(n),h[0].push(g)}}var f={sheets:r,ranges:h};return f},getActiveSheet:function(){return this.sheetList[0]},array:function(t){var e=[];return e.push(t),e}},t.ZSClass.ParamGenerator=e}(this);
!function(t){function s(t){return 1<<t}function i(t){return{q:t>>this._xRoot,r:t&this.type-1}}function e(t){for(var s=0;t;)t&=t-1,s++;return s}function r(t,i){t&&(this.type=t,this._2pow=s(this.type),this._xRoot=~~(p(t)/p(2))),this.missed=h.getTypedArray(this.type,i),this.temp=h.getTypedArray(this.type,2)}var h=t.JSUtil,n=t.ZSDevTools.Logger,p=Math.log,m=Math.LN2,o=function(t){return~~(p(t)/m)};r.prototype={type:8,_2pow:256,_xRoot:3,missed:null,temp:null,and:function(t){return this.missed[t]&=~this.temp[0],this},or:function(t){return this.missed[t]|=this.temp[0],this},sign:function(t,s){var e=i.call(this,t,this.type);return this.temp[0]=1<<this.type-e.r-1,s?this.or(e.q):this.and(e.q),this},signRange:function(t,e,r){var h=i.call(this,t,this.type);if(h.r+e>this.type){this.temp[0]=s(this.type)-1>>h.r,r?this.or(h.q):this.and(h.q),e-=this.type-h.r,h.q++;for(var n=r?s(this.type)-1:0;e>this.type;)this.missed[h.q]=n,e-=this.type,h.q++;e>0&&(this.temp[0]=s(this.type)-1<<this.type-e)}else{var p=this.type-(h.r+e);this.temp[0]=s(this.type)-1>>p,this.temp[0]=this.temp[0]<<p+h.r,this.temp[0]=this.temp[0]>>h.r}return r?this.or(h.q):this.and(h.q),this},next:function(t,e,r){if((0>t||t>this.missed.length*this.type)&&n.isEnabled)return n.alert("error","1.WRONG INPUT VALUES : ",t,e,r);if(t==this.missed.length*this.type)return this.missed.length*this.type;if(0===r){if(this.get(t)===e)return t;r=1}r||(r=1);var h=i.call(this,t,this.type);this.temp[0]=e?this.missed[h.q]:~this.missed[h.q];var p=this._2pow-1>>h.r+1;for(this.temp[0]=this.temp[0]&p;h.q<this.missed.length;){for(var p=s(this.type-1);0!==p;){if(0!=(this.temp[0]&p)&&r--,0===r)return this.type*h.q+(this.type-o(p)-1);p>>=1}h.q++,this.temp[0]=e?this.missed[h.q]:~this.missed[h.q]}return this.missed.length*this.type},prev:function(t,e,r){if((0>t||t>=this.missed.length*this.type)&&n.isEnabled)return n.alert("error","2.WRONG INPUT VALUES : ",t,e,r);if(0===r){if(this.get(t)===e)return t;r=1}r||(r=1);var h=i.call(this,t,this.type);for(this.temp[0]=e?this.missed[h.q]:~this.missed[h.q],this.temp[0]=this.temp[0]>>this.type-h.r,this.temp[0]=this.temp[0]<<this.type-h.r;h.q>=0;){for(var p=1,m=s(this.type);p!==m;){if(0!=(this.temp[0]&p)&&r--,0===r)return this.type*h.q+(this.type-o(p)-1);p<<=1}h.q--,this.temp[0]=e?this.missed[h.q]:~this.missed[h.q]}return-1},clearBlock:function(t,s){return this.missed.set(h.getTypedArray(this.type,s),t),this},setBlock:function(t,i){for(var e=t,r=t+i,h=s(this.type)-1;r>e;e++)this.missed[e]=h;return this},clear:function(t,s){return(0===s||0>t)&&n.isEnabled?n.alert("error","3.WRONG INPUT VALUES : ",t,s):s?this.signRange(t,s,!1):this.sign(t,!1)},set:function(t,s){return(0===s||0>t)&&n.isEnabled?n.alert("error","4.WRONG INPUT VALUES : ",t,s):s?this.signRange(t,s,!0):this.sign(t,!0)},shiftRight:function(t,s){if((0===s||0>t)&&n.isEnabled)return n.alert("error","5.WRONG INPUT VALUES : ",t,s);s||(s=1);var e=i.call(this,t,this.type),r=i.call(this,s-(this.type-e.r),this.type),h=i.call(this,t+s,this.type);r.r<0?r.r=s:r.r-e.r>0?(r.q+=1,r.r=r.r-e.r):r.r-e.r<0?r.r=this.type-(e.r-r.r):(r.r=0,r.q+=1);var p=this.missed.length;if(0===r.r)for(var m=p-1;m>h.q;m--)this.missed[m]=this.missed[m-r.q];else for(var m=p-1;m>h.q;m--)this.missed[m]=this.missed[m-r.q]>>r.r|this.missed[m-r.q-1]<<this.type-r.r;return this.type-e.r>s?(this.temp[0]=this.missed[h.q]<<e.r,this.missed[h.q]=this.missed[h.q]>>this.type-e.r<<this.type-e.r|this.temp[0]>>e.r+s):e.r===h.r?this.missed[h.q]=this.missed[h.q-r.q]:e.r<h.r?this.missed[h.q]=this.missed[e.q]>>h.r-e.r:(this.temp[0]=this.missed[e.q]<<e.r,this.missed[h.q]=this.missed[h.q-r.q]>>r.r|this.temp[0]>>h.r),this.clear(t,s),this.missed},shiftLeft:function(t,s){if((0===s||0>t)&&n.isEnabled)return n.alert("error","6.WRONG INPUT VALUES : ",t,s);s||(s=1);var e=i.call(this,t,this.type),r=i.call(this,s-(this.type-e.r),this.type);r.r<0?(this.temp[0]=this.missed[e.q]<<this.type+r.r,this.temp[0]=this.temp[0]>>e.r|this.missed[e.q+1]>>this.type-s,r.r=s):(this.temp[0]=this.missed[e.q+r.q+1]<<r.r,this.temp[0]=this.temp[0]>>e.r,r.r-e.r>0?(this.temp[0]|=this.missed[e.q+r.q+2]>>this.type-(r.r-e.r),r.q+=1,r.r=r.r-e.r):r.r-e.r<0?r.r=this.type-(e.r-r.r):(r.r=0,r.q+=1)),this.missed[e.q]=this.missed[e.q]>>this.type-e.r<<this.type-e.r|this.temp[0];var h=this.missed.length-r.q;if(0===r.r)for(var p=e.q+1;h>p;p++)this.missed[p]=this.missed[p+r.q];else for(var p=e.q+1;h>p;p++)this.missed[p]=this.missed[p+r.q]<<r.r|this.missed[p+r.q+1]>>this.type-r.r;return this.clearBlock(h,r.q),this.missed},get:function(t){return 0>t&&n.isEnabled?n.alert("error","7.WRONG INPUT VALUES : ",t):this.missed[~~(t/this.type)]>>this.type-t%this.type-1&1},nextClearBit:function(t,s){return 0>t&&n.isEnabled?n.alert("error","8.WRONG INPUT VALUES : ",t,s):0>s?this.prev(t,!1,-s):this.next(t,!1,s)},nextSetBit:function(t,s){return 0>t&&n.isEnabled?n.alert("error","9.WRONG INPUT VALUES : ",t,s):0>s?this.prev(t,!0,-s):this.next(t,!0,s)},previousClearBit:function(t,s){return 0>t&&n.isEnabled?n.alert("error","10.WRONG INPUT VALUES : ",t,s):0>s?this.next(t,!1,-s):this.prev(t,!1,s)},previousSetBit:function(t,s){return 0>t&&n.isEnabled?n.alert("error","11.WRONG INPUT VALUES : ",t,s):0>s?this.next(t,!0,-s):this.prev(t,!0,s)},cardinality:function(t,s){var r=0;if(t>s)return r;if(t=i.call(this,t),s=i.call(this,s),this.temp[0]=this.missed[t.q]<<t.r,t.q===s.q)return e(this.temp[0]>>this.type-s.r-1+t.r);r+=e(this.temp[0]);for(var h=t.q+1;h<s.q;h++)r+=e(this.missed[h]);return r+=e(this.missed[s.q]>>this.type-s.r-1)},toStringArray:function(t,s){var i=~~(t/this.type),e=~~(s/this.type),r=[];for(i;e>=i;i++)r.push(this.missed[i]);return"["+r.join()+"]"},toString:function(){for(var t=[],s=(this.type,0),i=this.missed.length;i>s;s++){var e=this.missed[s].toString(2);if(e.length<this.type){for(var r=[],h=0,n=this.type-e.length;n>h;h++)r[h]="0";t.push(r.join(""))}t.push(e)}return t.join("")}},t.ZSClass.BitSet=r}(this);
!function(t){var i=(t.sPlusPlus,t.Math.ceil),n=t.ZSClass,e=8,r=4,s=function(t,s){this.size=t,this.F=new n.BitSet(8,i(t/8)),"ROW"===s&&(this.type=e),"COLUMN"===s&&(this.type=r)};s.prototype={type:null,isHidden:function(t){return this.F.get(t)},nextHidden:function(t){return this.F.nextSetBit(t,1)},nextNthHidden:function(t,i){return this.F.nextSetBit(t,i)},nextNonHidden:function(t){return this.F.nextClearBit(t,1)},nextNthNonHidden:function(t,i){return this.F.nextClearBit(t,i)},prevHidden:function(t){return this.F.previousSetBit(t,1)},prevNthHidden:function(t,i){return this.F.previousSetBit(t,i)},prevNonHidden:function(t){return this.F.previousClearBit(t,1)},prevNthNonHidden:function(t,i){return this.F.previousClearBit(t,i)},onInsert:function(t,i){return this.F.shiftRight(t,i)},onDelete:function(t,i){return this.F.shiftLeft(t,i)},onHide:function(t,i){this.F.set(t,i)},onShow:function(t,i){this.F.clear(t,i)},getOnCount:function(t,i){return this.F.cardinality(t,i)},toStringArray:function(t,i){return this.F.toStringArray(t,i)},getFloor:function(t){if(this.isHidden(t)&&(t=this.prevNonHidden(t),-1===t))return{floor:0,d:0};for(var i=t-this.F.cardinality(0,t),n=i%this.type,e=0;n>e;e++)if(t=this.prevNonHidden(t),-1===t)return{floor:0,d:t};return{floor:t,d:e}},getCeil:function(t){this.isHidden(t)&&(t=this.prevNonHidden(t),-1===t&&(t=0));for(var i=t-this.F.cardinality(0,t),n=this.type-i%this.type,e=0;n>e;e++)if(t=this.nextNonHidden(t),-1===t)return{ceil:this.size,d:t-this.size};return{ceil:t,d:-e}},toString:function(){return this.F.toString()}},n.Hidden=s}(this);
!function(t){function o(t){return isNaN(t)?void 0:t+1}function s(t){var o=d.Object;return o.getCharForNum(t)}function n(t,o){for(var s=[],n=0;n<t.length;n++){var e=t[n],i=new l(e.startRow,e.startCol,e.endRow,e.endCol);if(i.intersects(o)){for(var h=i.startRow,d=i.startCol,C=i.endRow,R=i.endCol,w=0;4>w;w++)if(0===w){if(h<o.startRow){var u=new l(h,d,o.startRow-1,R);u.endRow=Math.min(u.endRow,r-1),u.endCol=Math.min(u.endCol,a-1),s.push(u),h=o.startRow}}else if(1===w){if(d<o.startCol){var u=new l(h,d,C,o.startCol-1);u.endRow=Math.min(u.endRow,r-1),u.endCol=Math.min(u.endCol,a-1),s.push(u),d=o.startCol}}else if(2===w){if(C>o.endRow){var u=new l(o.endRow+1,d,C,R);u.endRow=Math.min(u.endRow,r-1),u.endCol=Math.min(u.endCol,a-1),s.push(u),C=o.endRow}}else if(R>o.endCol){var u=new l(h,o.endCol+1,C,R);u.endRow=Math.min(u.endRow,r-1),u.endCol=Math.min(u.endCol,a-1),s.push(u)}}else s.push(i)}return s}var e=t.sPlusPlus,i=e.data.Defaults,r=i.MAX_ROW,a=i.MAX_COL,h=t.ZSClass,d=t.JSUtil,l=function(t,o,s,n){this.startRow=t,this.startCol=o,this.endRow=s,this.endCol=n};l.prototype={getColSpan:function(){return this.endCol-this.startCol+1},getRowSpan:function(){return this.endRow-this.startRow+1},isSingle:function(){return!(this.endRow-this.startRow|this.endCol-this.startCol)},isRowRange:function(){return this.startRow===this.endRow},isColRange:function(){return this.startCol===this.endCol},clone:function(){return new l(this.startRow,this.startCol,this.endRow,this.endCol)},isRow:function(){return 0===this.startCol&&this.endCol===a-1},isCol:function(){return 0===this.startRow&&this.endRow===r-1},isWhole:function(){return this.isRow()&&this.isCol()},isValid:function(){return void 0!=this.startRow&&void 0!=this.startCol&&void 0!=this.endRow&&void 0!=this.endCol},equals:function(t){var o=this.startRow-t.startRow,s=this.startCol-t.startCol,n=this.endRow-t.endRow,e=this.endCol-t.endCol;return!(o|s|n|e)},intersects:function(t){return void 0!=t&&void 0!=t.startRow&&void 0!=t.startCol&&void 0!=t.endRow&&void 0!=t.endCol?!(t.startRow>this.endRow||t.startCol>this.endCol||t.endRow<this.startRow||t.endCol<this.startCol):void 0},subset:function(t){return t.startRow>=this.startRow&&t.endRow<=this.endRow&&t.startCol>=this.startCol&&t.endCol<=this.endCol},isSuperSet:function(t){return this.equals(t)?!1:this.subset(t)},union:function(t){return this.startRow=this.startRow>t.startRow?t.startRow:this.startRow,this.startCol=this.startCol>t.startCol?t.startCol:this.startCol,this.endRow=this.endRow<t.endRow?t.endRow:this.endRow,this.endCol=this.endCol<t.endCol?t.endCol:this.endCol,this},getIntersectingRange:function(t){var o=new h.Range;return o.startRow=t.startRow<=this.startRow?this.startRow:t.startRow,o.startCol=t.startCol<=this.startCol?this.startCol:t.startCol,o.endRow=t.endRow>=this.endRow?this.endRow:t.endRow,o.endCol=t.endCol>=this.endCol?this.endCol:t.endCol,o},getOrderedRange:function(){var t={};return this.startRow<=this.endRow?(t.sR=this.startRow,t.eR=this.endRow):(t.sR=this.endRow,t.eR=this.startRow),this.startCol<=this.endCol?(t.sC=this.startCol,t.eC=this.endCol):(t.sC=this.endCol,t.eC=this.startCol),t},splitByPage:function(t){if(!this.equals(t)){var o=[],s=this.subset(t)?this:t,n=this.subset(t)?t:this,e=[s.startRow,n.startRow,n.endRow,s.endRow],i=[s.startCol,n.startCol,n.endCol,s.endCol],r=[],a=[];e[0]===e[1]&&(e=[s.startRow,n.endRow,s.endRow]),e[2]===e[3]&&(e=[s.startRow,n.startRow,n.endRow]),i[0]===i[1]&&(i=[s.startCol,n.endCol,s.endCol]),i[2]===i[3]&&(i=[s.startCol,n.startCol,n.endCol]);for(var h in e)-1===r.indexOf(e[h])&&r.push(e[h]);for(var h in i)-1===a.indexOf(i[h])&&a.push(i[h]);for(var h=0;h<r.length-1;h++)for(var d=r[h],C=r[h+1],R=0;R<a.length-1;R++){var w=a[R],u=a[R+1];if(void 0!=d&&void 0!=w&&void 0!=C&&void 0!=u){var f=new l(d,w,C,u);this.equals(f)||o.push(new l(d,w,C,u))}}return o}},getLabel:function(t){var s="",n="",e="";switch(t){case 1:n=e="$";break;case 2:n="$";break;case 3:e="$"}var i=d.Object;if(!this.endRow&&!this.endCol||this.startRow===this.endRow&&this.startCol===this.endCol)s=e+i.getCharForNum(this.startCol+1)+n+o(this.startRow);else{var r,a,h,l,C=this.isRow(),R=this.isCol();C&&R?(h=i.getCharForNum(this.startCol+1),l=i.getCharForNum(this.endCol+1),r=a=n=""):C?(r=o(this.startRow),a=o(this.endRow),h=l=e=""):R?(h=i.getCharForNum(this.startCol+1),l=i.getCharForNum(this.endCol+1),r=a=n=""):(r=o(this.startRow),a=o(this.endRow),h=i.getCharForNum(this.startCol+1),l=i.getCharForNum(this.endCol+1)),s=e+h+n+r,s+=":"+e+l+n+a}return s}},h.Range=l,h.Range.colHeader=s,h.Range.rowHeader=o,h.Range.splitRanges=n}(this);
!function(e){var s=(e.sPlusPlus,e.ZSClass),t=s.Range,n=e.ZSDevTools.Logger,i={dontAdd:function(){},simpleAdd:function(){return this.ADD.apply(this,arguments)},checkAdd:function(e,s,i,r){var a=new t(e,s,i,r);return this.isIntersecting(a)?(n.log("3.some Range(s) intersecting and so you can not add in the range.",e,s,i,r),!1):this.ADD.apply(this,arguments)},splitOldAndAdd:function(e,s,n,i){var r=new t(e,s,n,i);this.SPLIT(r);var a=this.ADD.apply(this,arguments);return a},removeOldAndAdd:function(e,s,n,i){var r=new t(e,s,n,i),a=this.getIntersectedRanges(r);for(var g in a){var o=a[g];this.isRangeAcross(o)&&!r.subset(o)&&(o=this.splitRangeAcross(o,r)),this.REMOVE(o)}var h=this.ADD.apply(this,arguments);return h},splitOldAndAddAcross:function(e,s,n,i){var r=new t(e,s,n,i),a=this.getIntersectedRanges(r);for(var g in a){var o=a[g];this.isRangeAcross(o)&&!r.subset(o)&&(o=this.splitRangeAcross(o,r)),this.REMOVE(o)}var h=this.ADDACROSS.apply(this,arguments);return h}},r={dontRemove:function(){},removeEntireRange:function(e,s,n,i){var r=new t(e,s,n,i);for(var a in this.RangeList.masterList){var g=this.RangeList.masterList[a];r.intersects(g)&&this.REMOVE(g)}},splitRemoveRange:function(e){this.SPLIT(e)},RemoveExactRange:function(e,s,n,i){var r=new t(e,s,n,i);for(var a in this.RangeList.masterList){var g=this.RangeList.masterList[a];r.equals(g)&&this.REMOVE(g)}},checkRemoveExactRange:function(e,s,n,i){var r=new t(e,s,n,i),a=this.getIntersectedRanges(r),a=this.getIntersectedRanges(r);if(a.length){for(var g in a){var o=a[g];this.isRangeAcross(o)&&!r.subset(o)&&(o=this.splitRangeAcross(o,r)),this.REMOVE(o)}return a}}};s.RangeManagerHelper={},s.RangeManagerHelper.Adder=i,s.RangeManagerHelper.Remover=r}(this);
!function(t){var s=t.sPlusPlus,e=t.ZSClass,n=e.Range,i=s.data.Defaults,a=i.MAX_ROW,r=i.MAX_COL,o=e.RangeManagerHelper,R=o.Adder,g=o.Remover,l=t.JSUtil.Math,h=function(t,s,e,i){this.RangeClass=t?t:n,this.add=R[s]?R[s]:R.dontAdd,this.addAcross=R[i]?R[i]:R.dontAdd,this.remove=g[e]?g[e]:g.dontRemove,this.RangeList={},this.reset()};h.prototype={ADD:function(){var t=this.createRange.apply(this,arguments);return this.addRange(t),t},ADDACROSS:function(){var t=this.createRange.apply(this,arguments);return this.addRangeAcross(t),t},REMOVE:function(t){this.removeRange(t)},SPLIT:function(t){this.splitRange(t)},_addToList:function(t){var s=l.hash(t.startRow,t.startCol,r);this.RangeList.masterList[s]=t},_removeFromList:function(t,s){delete this.RangeList.masterList[l.hash(t,s,r)]},reset:function(){this.RangeList.masterList={}},createRange:function(){var t=new this.RangeClass;return this.RangeClass.apply(t,arguments),t},addRange:function(t){this._addToList(t)},removeRange:function(t){this._removeFromList(t.startRow,t.startCol)},splitRange:function(t){if(0===t.startRow&&0===t.startCol&&t.endRow===a-1&&t.endCol===r-1)return void(this.RangeList.masterList={});var s={};for(var e in this.RangeList.masterList){var n=this.RangeList.masterList[e];if(t.intersects(n)){for(var i=n.startRow,o=n.startCol,R=n.endRow,g=n.endCol,h=0;4>h;h++)if(0===h){if(i<t.startRow){var d=new this.RangeClass(i,o,t.startRow-1,g);s[l.hash(i,o,r)]=d,i=t.startRow}}else if(1===h){if(o<t.startCol){var d=new this.RangeClass(i,o,R,t.startCol-1);s[l.hash(i,o,r)]=d,o=t.startCol}}else if(2===h){if(R>t.endRow){var d=new this.RangeClass(t.endRow+1,o,R,g);s[l.hash(t.endRow+1,o,r)]=d,R=t.endRow}}else if(g>t.endCol){var d=new this.RangeClass(i,t.endCol+1,R,g);s[l.hash(i,t.endCol+1,r)]=d}}else s[e]=n}this.RangeList.masterList=s},getInfo:function(t,s){var e=new this.RangeClass(t,s,t,s);for(var n in this.RangeList.masterList){var i=this.RangeList.masterList[n];if(e.intersects(i))return i}},getRootCellInfo:function(t,s){var e=l.hash(t,s,r);return this.RangeList.masterList[e]},isXists:function(t,s){var e=this.getInfo(t,s);return e?{root:e,isRoot:e&&t===e.startRow&&s===e.startCol}:!1},isNonRootXists:function(){},isEntireRowXists:function(){},isEntireColXists:function(){},isEntireSheetXists:function(){},extendRange:function(t){var s=this.RangeList.masterList;for(var n in s){var i=s[n];if(t.intersects(i)&&!t.subset(i)){if(this.RangeList.cellRangeAcross[n]&&(i=new e.Range(t.startRow,i.startCol,t.endRow,i.endCol),t.subset(i)))continue;t.union(i),this.extendRange(t);break}}return t},extendCol:function(t){if(t.isCol()){var s=this.RangeList.masterList;for(var e in s){var n=s[e];if(this.RangeList.colRange[l.hash(n.startRow,n.startCol,r)]&&t.intersects(n)&&!t.subset(n)){t.union(n),this.extendRange(t);break}}}},extendRow:function(t){if(t.isRow()){var s=this.RangeList.masterList;for(var e in s){var n=s[e];if(n.isRow()&&t.intersects(n)&&!t.subset(n)){t.union(n),this.extendRange(t);break}}}},getWhole:function(){return this.createRange(0,0,a-1,r-1)},isIntersecting:function(t){for(var s in this.RangeList.masterList){var e=this.RangeList.masterList[s];if(t.intersects(e))return!0}return!1},isIntersectingNotSubset:function(t){for(var s in this.RangeList.masterList){var e=this.RangeList.masterList[s];if(this.RangeList.cellRangeAcross&&this.RangeList.cellRangeAcross[s]&&(e=new n(t.startRow>e.startRow?t.startRow:e.startRow,e.startCol,t.endRow<e.endRow?t.endRow:e.endRow,e.endCol)),t.intersects(e)&&!t.subset(e))return!0}return!1},getIntersectedRanges:function(t){var s=[],e=0;for(var n in this.RangeList.masterList){var i=this.RangeList.masterList[n];t.intersects(i)&&(s[e]=i,e++)}return s},getIntersectedRangesNotSubset:function(t){var s=[],e=0;for(var n in this.RangeList.masterList){var i=this.RangeList.masterList[n];t.intersects(i)&&!t.subset(i)&&(s[e]=i,e++)}return s},getSubsets:function(t){var s=[],e=0;for(var n in this.RangeList.masterList){var i=this.RangeList.masterList[n];t.subset(i)&&(s[e]=i,e++)}return s},getSupersets:function(t){var s=[],e=0;for(var n in this.RangeList.masterList){var i=this.RangeList.masterList[n];t.isSuperSet(i)&&(s[e]=i,e++)}return s},_insertRow:function(t,s){for(var e in this.RangeList.masterList){var n=this.RangeList.masterList[e];n.startRow>=t?n.startRow+s>=a?this.removeRange(n):(n.startRow+=s,n.endRow=n.endRow+s>=a?a:n.endRow+s):n.startRow<t&&n.endRow>=t&&(n.endRow=n.endRow+s>=a?a:n.endRow+s)}},_deleteRow:function(t,s){for(var e in this.RangeList.masterList){var n=this.RangeList.masterList[e];n.startRow>t?n.endRow-s<0?this.removeRange(n):(n.startRow=n.startRow-s<0?0:n.startRow-s,n.endRow-=s):n.startRow<=t&&n.endRow>=t&&(n.startRow!==n.endRow&&(n.endRow=n.endRow-s<0?0:n.endRow-s),n.startRow===n.endRow&&this.removeRange(n))}},_insertCol:function(t,s){for(var e in this.RangeList.masterList){var n=this.RangeList.masterList[e];n.startCol>=t?n.startCol+s>=r?this.removeRange(n):(n.startCol+=s,n.endCol=n.endCol+s>=r?r:n.endCol+s):n.startCol<t&&n.endCol>=t&&(n.endCol=n.endCol+s>=r?r:n.endCol+s)}},_deleteCol:function(t,s){for(var e in this.RangeList.masterList){var n=this.RangeList.masterList[e];n.startCol>t?n.endCol-s<0?this.removeRange(n):(n.endCol-=s,n.startCol=n.startCol-s<0?0:n.startCol-s):n.startCol<=t&&n.endCol>=t&&(n.startCol!==n.endCol&&(n.endCol=n.endCol-s<0?0:n.endCol-s),n.startCol===n.endCol&&this.removeRange(n))}},getAllRanges:function(){return this.RangeList.masterList},isRangesAvailable:function(){return Object.keys(this.getAllRanges()).length>0},toString:function(){return JSON.stringify(this.RangeList.masterList)}},h.splitIntesectingRanges=function(t){for(var s=new e.RangeManager(e.Range,"splitOldAndAdd"),n=0;n<t.length;n++)s.add(t[n].startRow,t[n].startCol,t[n].endRow,t[n].endCol);return s.RangeList.masterList},e.RangeManager=h}(this);
!function(t){var s=t.sPlusPlus,e=t.ZSClass,o=t.ZSDevTools.Logger,a=s.data.Defaults,i=a.MAX_ROW,r=a.MAX_COL,n=t.JSUtil.Math,l=function(){e.RangeManager.apply(this,arguments)};l.prototype=new e.RangeManager,l.prototype._addToSubList=function(t){t.isWhole()?this._addAll():t.isCol()?this._addCol(t,t.startCol,t.endCol):t.isRow()?this._addRow(t,t.startRow,t.endRow):this._addCell(t,t.startRow,t.startCol,t.endRow,t.endCol)},l.prototype._removeFromSubList=function(t){t.isWhole()?this._removeAll():this.isRangeAcross(t)?this._removeRangeAcrossSublist(t.startRow,t.startCol):t.isRow()?this._removeRow(t.startRow,t.endRow):t.isCol()?this._removeCol(t.startCol,t.endCol):this._removeCell(t.startRow,t.startCol,t.endRow,t.endCol)},l.prototype._splitRangeRemove=function(t,s){var o=(t.getIntersectingRange(s),{});if(t.startRow<s.startRow){var a=new e.Range(t.startRow,t.startCol,s.startRow-1,t.endCol);this._addToList(a),o[n.hash(a.startRow,a.startCol,r)]=a}if(t.endRow>s.endRow){var a=new e.Range(s.endRow+1,t.startCol,t.endRow,t.endCol);this._addToList(a),o[n.hash(a.startRow,a.startCol,r)]=a}return o},l.prototype._splitRangeAcrossRemove=function(t,s){t.getIntersectingRange(s);if(t.startRow<s.startRow){var o=new e.Range(t.startRow,t.startCol,s.startRow-1,t.endCol);this.addRangeAcross(o)}if(t.endRow>s.endRow){var o=new e.Range(s.endRow+1,t.startCol,t.endRow,t.endCol);this.addRangeAcross(o)}},l.prototype._addCell=function(t,s,e,a,i){"undefined"===s&&o.log("check here");for(var l=s;a>=l;l++)for(var R=e;i>=R;R++)this.RangeList.cellRange[n.hash(l,R,r)]=t},l.prototype._removeCell=function(t,s,o,a,i){var l=o-t,R=a-s;do{var h=o-l,g=R;if(this.RangeList.rowRange[h]){if(delete this.RangeList.rowRange[h],s-1>=0){var d=new e.Range(h,0,h,s-1);this._addToSubList(d)}if(r-1>=a+1){var d=new e.Range(h,a+1,h,r-1);this._addToSubList(d)}}do{var w=a-g,c=new e.Range(t,s,o,a);i&&c.intersects(i)&&(w=w>=i.startCol&&w<=i.endCol&&h>=i.startRow&&h<=i.endRow?a+1:w),a>=w&&delete this.RangeList.cellRange[n.hash(h,w,r)],g--}while(g>=0);l--}while(l>=0)},l.prototype._addCol=function(t,s,e){"undefined"===s&&o.log("check here");for(var a=s;e>=a;a++)this.RangeList.colRange[a]=t},l.prototype._removeCol=function(t,s){var e=s-t;do{var o=s-e;this.RangeList.colRange[o]?delete this.RangeList.colRange[o]:this._removeCell(0,t,i,s),--e}while(e>=0)},l.prototype._addRow=function(t,s,e){"undefined"===s&&o.log("check here");for(var a=s;e>=a;a++)this.RangeList.rowRange[a]=t},l.prototype._removeRow=function(t,s){var e=s-t;do{var o=s-e;this.RangeList.rowRange[o]?delete this.RangeList.rowRange[o]:this._removeCell(t,0,s,r),--e}while(e>=0)},l.prototype._addAll=function(){this.RangeList._rangeAll=!0},l.prototype._removeAll=function(){this.RangeList._rangeAll=!1},l.prototype.getWhole=function(){return this._rangeAll||(this._rangeAll=new this.RangeClass(0,0,i-1,r-1)),this._rangeAll},l.prototype.reset=function(){this.RangeList._rangeAll=!1,this.RangeList.rowRange={},this.RangeList.colRange={},this.RangeList.cellRange={},this.RangeList.cellRangeAcross={},this.RangeList.masterList={}},l.prototype.addRange=function(t){this._addToList(t),this._addToSubList(t)},l.prototype.addRangeAcross=function(t){this._addToList(t),this._addRangeAcrossSublist(t)},l.prototype.removeRange=function(t){this._removeFromList(t.startRow,t.startCol),this._removeFromSubList(t)},l.prototype._addRangeAcrossSublist=function(t){this.RangeList.cellRangeAcross[n.hash(t.startRow,t.startCol,r)]=t},l.prototype._removeRangeAcrossSublist=function(t,s){delete this.RangeList.cellRangeAcross[n.hash(t,s,r)]},l.prototype.isRangeAcross=function(t){return this.RangeList.cellRangeAcross[n.hash(t.startRow,t.startCol,r)]},l.prototype.splitRange=function(t){if(0===t.startRow&&0===t.startCol&&t.endRow===i-1&&t.endCol===r-1)return void this.reset();var s={};for(var o in this.RangeList.masterList){var a;this.RangeList.masterList&&(a=this.RangeList.masterList[o]);var l=new e.Range(a.startRow,a.startCol,a.endRow,a.endCol);if(t.intersects(l)){for(var R=l.startRow,h=l.startCol,g=l.endRow,d=l.endCol,w=0;4>w;w++)if(0===w){if(R<t.startRow){var c=a.clone();c.startRow=R,c.startCol=h,c.endRow=t.startRow-1,c.endCol=d,s[n.hash(R,h,r)]=c,this._addToSubList(c),R=t.startRow}}else if(1===w){if(h<t.startCol){var c=a.clone();c.startRow=R,c.startCol=h,c.endRow=t.startRow-1,c.endCol=d,s[n.hash(R,h,r)]=c,this._addToSubList(c),h=t.startCol}}else if(2===w){if(g>t.endRow){var c=a.clone();c.startRow=R,c.startCol=h,c.endRow=t.startRow-1,c.endCol=d,s[n.hash(t.endRow+1,h,r)]=c,this._addToSubList(c),g=t.endRow}}else if(d>t.endCol){var c=a.clone();c.startRow=R,c.startCol=h,c.endRow=t.startRow-1,c.endCol=d,s[n.hash(R,t.endCol+1,r)]=c,this._addToSubList(c)}}else s[o]=a}this._removeFromSubList(t),this.RangeList.masterList=s},l.prototype.splitRangeAcross=function(t,s){var o=t.getIntersectingRange(s);if(this.addRangeAcross(o),t.startRow<s.startRow){var a=new e.Range(t.startRow,t.startCol,s.startRow-1,t.endCol);this.addRangeAcross(a)}if(t.endRow>s.endRow){var a=new e.Range(s.endRow+1,t.startCol,t.endRow,t.endCol);this.addRangeAcross(a)}return o},l.prototype.getInfo=function(t,s){var a=new e.Range(t,s,t,s);for(var i in this.RangeList.cellRangeAcross){var l=this.RangeList.cellRangeAcross[i];if(l.subset(a)){var R=new e.Range(t,l.startCol,t,l.endCol);return R}}return this.RangeList._rangeAll?(o.alert("error","you are in wrong place.."),this.getWhole()):this.RangeList.colRange&&this.RangeList.colRange[s]?this.RangeList.colRange[s]:this.RangeList.rowRange&&this.RangeList.rowRange[t]?this.RangeList.rowRange[t]:this.RangeList.cellRange?this.RangeList.cellRange[n.hash(t,s,r)]:void 0},l.prototype.isXists=function(t,s){var e=this.getInfo(t,s);return e?{root:e,isRoot:e&&t===e.startRow&&s===e.startCol}:!1},l.prototype.isNonRootXists=function(t,s){var e=this.isXists(t,s);return e&&!e.isRoot},l.prototype.isEntireRowXists=function(){var t=!1;if(this.RangeList._rangeAll)t=!0;else{var s=this.RangeList.rowRange;for(var e in s){t=!0;break}}return t},l.prototype.isEntireColXists=function(){var t=!1;if(this.RangeList._rangeAll)t=!0;else{var s=this.RangeList.colRange;for(var e in s){t=!0;break}}return t},l.prototype.isEntireSheetXists=function(){return this.isEntireRowXists()&&this.isEntireColXists()},l.prototype._insertRow=function(t,s){var o={};for(var a in this.RangeList.masterList){var i=this.RangeList.masterList[a],l=i.startRow,R=i.startCol,h=i.endCol,g=i.endRow,d=i.getRowSpan();if(l>=t){i.startRow+=s,i.endRow+=s,o[n.hash(i.startRow,i.startCol,r)]=i;var w=s>d?d:s,c=w,C=s-d,v=C>0?g+1+C:g+1;if(i.isRow())this._removeRow(l,l+w-1),this._addRow(i,v,v+c-1);else if(this.RangeList.cellRangeAcross[a])this._removeRangeAcrossSublist(l,R),this._addRangeAcrossSublist(i);else{var f=this.getInfo(l,R);this._removeCell(l,R,l+w-1,h,f),this._addCell(i,v,R,v+c-1,h)}}else if(!(t>=l+d)&&t>l&&l+d>=t)if(i.endRow+=s,i.isRow())o[n.hash(i.startRow,i.startCol,r)]=i,this._addRow(i,g+1,g+s-1);else if(this.RangeList.cellRangeAcross[a]){var _=new e.Range(t,R,t+s-1,h);o=this._splitRangeRemove(this.RangeList.masterList[a],_),this._splitRangeAcrossRemove(this.RangeList.cellRangeAcross[a],_)}else{o[n.hash(i.startRow,i.startCol,r)]=i;var L=g+1,u=L+s-1;this._addCell(i,L,R,u,h)}else o[n.hash(i.startRow,i.startCol,r)]=i}this.RangeList.masterList=o},l.prototype._deleteRow=function(t,s){var e=this.RangeList.masterList,o=this.RangeList.cellRange,a={};for(var i in e){var l=e[i],R=l.startRow,h=l.startCol,g=l.endRow,d=l.endCol,w=l.getRowSpan();if(R>=t&&t+s>R)if(t+s-1>=g)if(l.isRow())this._removeRow(R,g);else if(l.isCol())this._removeCol(h,d);else if(this.RangeList.cellRangeAcross[i])this._removeRangeAcrossSublist(R,h);else for(var c=R;g>=c;c++)for(var C=h;d>=C;C++)o[n.hash(c,C,r)]===l&&delete o[n.hash(c,C,r)];else{l.startRow=t,l.endRow-=s,a[n.hash(l.startRow,l.startCol,r)]=l;var v=s,f=g-s+1;if(l.isRow())this._removeRow(f,g),this._addRow(l,R-s,f-1);else if(this.RangeList.cellRangeAcross[i])this._removeRangeAcrossSublist(R,h),this._addRangeAcrossSublist(l);else{var _=this.getInfo(f,h);this._removeCell(f,h,f+v-1,d,_),this._addCell(l,t,h,f-1,d)}}else if(!(t>=R+w)&&t>R&&R+w>=t&&!l.isCol()){var L=w+R>t+s?s:g-t+1;if(L>=1)if(l.endRow-=L,a[n.hash(l.startRow,l.startCol,r)]=l,l.isRow())this._removeRow(g-L+1,g);else if(this.RangeList.cellRangeAcross[i])this.RangeList.cellRangeAcross[i]=l;else{var _=this.getInfo(g-L+1,h);this._removeCell(g-L+1,h,g,d,_)}}else if(R>=t+s){l.startRow-=s,l.endRow-=s,a[n.hash(l.startRow,l.startCol,r)]=l;var f=g-s+1;f=R>f?R:f;var u=s>w?R-(s-w):R;if(l.isRow())this._removeRow(f,g),this._addRow(l,R-s,u-1);else if(this.RangeList.cellRangeAcross[i])this._removeRangeAcrossSublist(R,h),this._addRangeAcrossSublist(l);else{var _=this.getInfo(f,h);this._removeCell(f,h,g,d,_),this._addCell(l,R-s,h,u-1,d)}}else a[n.hash(l.startRow,l.startCol,r)]=l}this.RangeList.masterList=a},l.prototype._insertCol=function(t,s){var e={};for(var o in this.RangeList.masterList){var a=this.RangeList.masterList[o],i=a.startRow,l=a.startCol,R=a.endCol,h=a.endRow,g=a.getColSpan();if(l>=t){a.startCol+=s,a.endCol+=s,e[n.hash(a.startRow,a.startCol,r)]=a;var d=s>g?g:s,w=d,c=s-g,C=c>0?R+1+c:R+1;if(a.isCol())this._removeCol(l,l+d-1),this._addCol(a,C,C+w-1);else if(this.RangeList.cellRangeAcross[o])this._removeRangeAcrossSublist(i,l),this._addRangeAcrossSublist(a);else{var v=this.getInfo(i,l);this._removeCell(i,l,h,l+d-1,v),this._addCell(a,i,C,h,C+w-1)}}else!(t>=l+g)&&t>l&&l+g>=t?(a.endCol+=s,e[n.hash(a.startRow,a.startCol,r)]=a,a.isCol()?this._addCol(a,R+1,R+s):this.RangeList.cellRangeAcross[o]?this.RangeList.cellRangeAcross[o]=a:this._addCell(a,i,R+1,h,R+s)):e[n.hash(a.startRow,a.startCol,r)]=a}this.RangeList.masterList=e},l.prototype._deleteCol=function(t,s){var e=this.RangeList.masterList,o=this.RangeList.cellRange,a={};for(var i in e){var l=this.RangeList.masterList[i],R=l.startRow,h=l.startCol,g=l.endRow,d=l.endCol,w=l.getColSpan();if(h>=t&&t+s>h)if(t+s-1>=d)if(l.isCol())this._removeCol(h,d);else if(l.isRow())this._removeRow(R,g);else if(this.RangeList.cellRangeAcross[i])this._removeRangeAcrossSublist(R,h);else for(var c=R;g>=c;c++)for(var C=h;d>=C;C++)o[n.hash(c,C,r)]===l&&delete o[n.hash(c,C,r)];else{l.startCol=t,l.endCol-=s,a[n.hash(l.startRow,l.startCol,r)]=l;var v=s,f=d-s+1;if(l.isCol())this._removeCol(f,d),this._addCol(l,h-s,f-1);else if(this.RangeList.cellRangeAcross[i])this._removeRangeAcrossSublist(R,h),this._addRangeAcrossSublist(l);else{var _=this.getInfo(R,f);this._removeCell(R,f,g,f+v-1,_),this._addCell(l,R,t,g,f-1)}}else if(!(t>=h+w)&&t>h&&h+w>=t&&!l.isRow()){var L=w+h>t+s?s:d-t+1;if(L>=1)if(l.endCol-=L,a[n.hash(l.startRow,l.startCol,r)]=l,l.isCol())this._removeCol(d-L+1,d);else if(this.RangeList.cellRangeAcross[i])this.RangeList.cellRangeAcross[i]=l;else{var _=this.getInfo(R,d-L+1);this._removeCell(R,d-L+1,g,d,_)}}else if(h>=t+s){l.startCol-=s,l.endCol-=s,a[n.hash(l.startRow,l.startCol,r)]=l;var f=d-s+1;f=h>f?h:f;var u=s>w?h-(s-w):h;if(l.isCol())this._removeCol(f,d),this._addCol(l,h-s,u-1);else if(this.RangeList.cellRangeAcross[i])this._removeRangeAcrossSublist(R,h),this._addRangeAcrossSublist(l);else{var _=this.getInfo(R,f);this._removeCell(R,f,g,d,_),this._addCell(l,R,h-s,g,u-1)}}else a[n.hash(l.startRow,l.startCol,r)]=l}this.RangeList.masterList=a},e.RangeManagerExtended=l}(this);
ZSClass.HeadStyleDefinition=function(t){function e(t,e,n){for(var i in t)e[i]&&r.alert("warning","method overwriting.",i),e[i]=t[i].bind(n);return e}var n=t.sPlusPlus,r=t.ZSDevTools.Logger,i={appendStyleNames:function(t){var e=this.styleDef;for(var n in t)e[n]=t[n]},resetAndAdd:function(t){this.styleDef=t},syncStyleNames:function(t){var e=this.styleDef;for(var n in t)e[n]&&(e[t[n]]=e[n],delete e[n])},getStyleDef:function(t){var e=this.styleDef,i=e[t];return i||0==i||(n.data.syncStyleRequired=!0,i=e.default||e.default_co||e.default_ro,r.alert("warning","style name not found",t)),i},getStyleName:function(t){var e=this.styleDef;for(var n in e)if(e[n]==t)return n},toString:function(){return JSON.stringify(this.styleDef)}};return function(t,n){t||(t={});var r=n?{}:t;return r.styleDef={},e(i,t,r)}}(this);
!function(t){function e(e){var r=new t.Array(e+2);r[0]=r[1]=0,this.splice.apply(this,r)}var r=t.sPlusPlus,s=r.data.Defaults,i=s.MAX_COL;e.prototype=new t.Array,e.prototype.setStyle=function(t,e,r){for(var s=0;e>s;s++)this[t+s]=r},e.prototype.getStyle=function(t){return this[t]},e.prototype.Insert=function(e,r){var s=new t.Array(r+2);s[0]=e,s[1]=0,this.splice.apply(this,s),this.splice(i-1,this.length-(i-1)-1)},e.prototype.Delete=function(t,e){this.splice(t,e)},e.prototype.toString=function(){for(var t=[],e=0;e<this.length;e++)t.push('"'+this[e]+'"');return"["+t.join()+"]"},t.ZSClass.StyleNameArray=e}(this);
!function(t){function e(){this.styleCount=0,this.styles={},this.mappedStyles={}}e.prototype={addItem:function(t,e){if(this.styles[t])return this.styles[t]=e,this.getMappedKey(t);this.styleCount+=1;var s="m"+this.styleCount;return this.styles[t]=e,this.mappedStyles[s]=t,s},addJson:function(t){t.Default&&(this.styles.Default=t.Default,this.mappedStyles.Default="Default",delete t.Default);for(var e in t)this.addItem(e,t[e]);this.styles.Default&&(t.Default=this.styles.Default)},replaceKey:function(t,e){for(var s in this.mappedStyles)if(this.mappedStyles[s]===t){this.mappedStyles[s]=e;var i=this.styles[t];this.styles[e]||(this.styles[e]=i),delete this.styles[t]}},getStyleDef:function(t){var e=this.styles[this.mappedStyles[t]];return e?e:this.styles.Default},getMappedKey:function(t){for(var e in this.mappedStyles)if(this.mappedStyles[e]===t)return e},getMappedKeyAry:function(t){var e=[];for(var s in t)e[s]=this.getMappedKey(t[s]);return e},toString:function(){return JSON.stringify(this.styles)}},t.ZSClass.CellStyle=e}(this);
!function(t){function i(){}i.prototype={set:function(t,i){this[t]=i},isAssociated:function(t){return!!this[t]},remove:function(t){delete this[t]},toString:function(){return JSON.stringify(this)}},t.ZSClass.FormSheets=i}(this);
!function(t){function i(t,i){t.rows=i}function n(t,i){t.appliedColumns=i}function s(t){t.data=[]}function o(t,i){t.isApplied=i}function r(t,i,n,s){e.Range.call(this,t,i,n,s),this.isApplied=!1}var e=(t.ZSEvents,t.sPlusPlus,t.ZSClass);r.prototype=new e.Range,r.prototype.setCriteria=function(t,r){n(this,r),i(this,t),s(this,t),o(this,t.length>0)},r.prototype.equals=function(t,i){return this.appliedColumns.toString()!==i.toString()||this.rows.toString()!==t.toString()},r.prototype.toString=function(){return JSON.stringify(this)},e.DataFilter=r}(this);
!function(t){function i(){this.cell=null,this.cellMode,this.row,this.col}var l=(t.sPlusPlus,t.ZSClass);i.prototype={ADD:function(t,i,l,o){this.cell=i,this.cell.id=t,this.row=l,this.col=o},GET:function(){return this.cell},getRow:function(){return this.row},getCol:function(){return this.col},editMode:function(t){this.cellMode=t},getMode:function(){return this.cellMode}},l.CellInfo=i}(this);
!function(t){function i(){this.cell=null,this.row,this.col}i.prototype={set:function(t,i,n){this.cell=t,this.row=i,this.col=n},get:function(){return this.cell},getRow:function(){return this.row},getCol:function(){return this.col}},t.ZSClass.CellMeta=i}(this);
!function(t){function n(){this.Range}n.prototype={set:function(t){this.Range=t},get:function(){return this.Range}},t.ZSClass.FillRange=n}(this);
!function(e){function t(){this.isRender=!1}t.prototype={isRendered:function(){return this.isRender},setRendered:function(e){this.isRender=e}},e.ZSClass.StateChart=t}(this);
!function(t){function i(t){this.id=t}var n=(t.sPlusPlus,t.ZSClass);i.prototype={get:function(){return this.id},getNiceUrl:function(){return"/comments/"+this.id}},n.CommentState=i}(this);
!function(t){function n(){this.entries={}}n.prototype={contains:function(t){return this.entries[t]},put:function(t,n){this.contains(t)||(this.entries[t]=[]),this.entries[t].push(n)},get:function(t){return this.entries[t]},getMap:function(){return this.entries},removeALL:function(t){delete this.entries[t]},clear:function(){this.entries={}},isEmpty:function(){return 0==this.length()},length:function(){return Object.keys(this.entries).length}},t.ZSClass.MultiMap=n}(this);
!function(t){function i(){e.MultiMap.apply(this,arguments)}var e=(t.sPlusPlus,t.ZSClass);i.prototype=new e.MultiMap,i.prototype.put=function(t,i,s){this.contains(t)||(this.entries[t]=new e.Map),this.has(t,i)||this.entries[t].set(i,s)},i.prototype.has=function(t,i){return this.get(t)&&this.get(t).get(i)?!0:!1},i.prototype.handleUserList=function(t,i){this.clear();var e=i.tabid?i.tabid:i.rsid;this.put(i.zuid,e,i)},i.prototype.updateUserObj=function(t){var i=t.tabid?t.tabid:t.rsid;this.has(t.zuid,i)&&this.entries[t.zuid].set(i,t)},i.prototype.handleUserRemove=function(t,i){for(var e in this.getMap())this.get(e)&&this.get(e).get(i)&&this.get(e).remove(i)},i.prototype.handleUserAdd=function(t,i){var e=i.tabid?i.tabid:i.rsid;this.put(i.zuid,e,i)},i.prototype.getUserId=function(t){for(var i in this.getMap())if(this.has(i,t))return i},i.prototype.getObject=function(t,i){return this.has(i,t)?this.get(i).get(t):void 0},i.prototype.getRangeList=function(t,i){var e;return this.has(t,i)?(e=this.get(t).get(i),e.ranges):void 0},i.prototype.getList=function(){var t=[];for(var i in this.getMap()){var e;for(var s in this.get(i).getMap())e=this.get(i).get(s),t.push(e)}return t},e.UserList=i}(this);
!function(t){function e(){this.Cell=new ZSClass.CellMeta,this.Ranges=new ZSClass.RangeList,this.sTops=[0,0],this.sLefts=[0,0],this.sHeights=[0,0],this.sWidths=[0,0],this.Zoom=1,this.fillRange=new ZSClass.FillRange,this.charts=new ZSClass.Map;var t=new ZSClass.Range(0,0,0,0);this.addSelection(t,0)}var n=t.sPlusPlus;e.prototype={setActiveCellRange:function(t,e,n,s){this.Cell.set(e,n,s)},getActiveCellRange:function(){return this.Cell.get()},getActiveRow:function(){return this.Cell.getRow()},getActiveCol:function(){return this.Cell.getCol()},addSelection:function(t,e,n){this.Ranges.ADD(t,e,n)},clearRanges:function(){this.Ranges.CLEAR()},clearSelection:function(t){this.Ranges.clearSpecific(t)},getIndex:function(t){return this.Ranges.getIndex(t)},getRanges:function(){return this.Ranges.getRangeList()},getActiveRangeCount:function(){return this.Ranges.getSize()},getActiveRange:function(){return this.Ranges.getLastModifiedRange()},getActiveID:function(){return this.Ranges.getLastModifiedID()},getRange:function(t){return this.Ranges.getRange(t)},setChartState:function(t,e){this.charts.set(t,e)},getChartState:function(t){return this.charts.get(t)},removeChartState:function(t){this.charts.remove(t)},isChartRendered:function(t){var e=this.getChartState(t);return e&&e.isRendered()},setChartRendered:function(t,e){var n=this.getChartState(t);return n.setRendered(e)},addFill:function(t){this.fillRange.set(t)},removeFill:function(){this.fillRange.set(null)},getFillRange:function(){return this.fillRange.get()},setScrollPosition0:function(t,e){this.sTops[0]=t,this.sLefts[0]=e},setScrollPosition1:function(t,e){this.sTops[1]=t,this.sLefts[1]=e},setScreenHeights:function(t,e){this.sHeights[0]=t,this.sHeights[1]=e},setScreenWidths:function(t,e){this.sWidths[0]=t,this.sWidths[1]=e},getScrollTops:function(){return this.sTops},getScrollLefts:function(){return this.sLefts},getScreenHeights:function(){return this.sHeights},getScreenWidths:function(){return this.sWidths},getZoom:function(){return this.Zoom},setZoom:function(t){this.Zoom=t},toString:function(){return JSON.stringify(this)},getNiceUrl:function(t,e,s){var i=n.data.getWorkBook(t,s),r=i.SheetList.getById(e),o=r.getName();return"/sheets/"+o+this.Ranges.getNiceUrl()},isMultiRangeSelected:function(){return this.Ranges.getRangeList().length>1?!0:!1}},t.ZSClass.ActiveInfo=e}(this);
!function(s){function t(s,t,i,e,n,a,o){this.Sheets=t,this.Ranges=e,this.isServerClip=n,this.isCopy=a,this.isSingleTap=o}t.prototype=Object.assign({},ZSClass.Range.prototype),s.ZSClass.FormatPainterRange=t}(this);
!function(t){function e(){this.active,this.sheets=new ZSClass.Map,this.FormatPainterRange={},this.UserPresenceList=new ZSClass.UserList,this.TabMap=new ZSClass.Map,this.commentsMap=new ZSClass.Map,this.zoomMap=new ZSClass.Map}var n=t.sPlusPlus;e.prototype={addFormulaSelection:function(){},clearFormulaRanges:function(){},clearFormulaRange:function(){},getFormulaRanges:function(){},getFormulaRange:function(){},setFormulaState:function(){},getFormulaState:function(){},addFormatPainterRange:function(t,e,n,a,s,i,r){this.FormatPainterRange=new ZSClass.FormatPainterRange(t,e,n,a,s,i,r)},getFormatPainterRange:function(){return this.FormatPainterRange},clearFormatPainter:function(){this.FormatPainterRange={}},getFormatPainterState:function(){return this.FormatPainterRange.Ranges?!0:!1},getUserPresenceList:function(){return this.UserPresenceList},getTabMap:function(){return this.TabMap},getZoomMap:function(){return this.zoomMap},setActive:function(t){this.active=t},setSheetState:function(t,e){this.sheets.set(t,e)},getSheetState:function(t){return this.sheets.get(t)},removeSheetState:function(t){this.sheets.remove(t)},setCommentState:function(t,e){this.commentsMap.set(t,e)},getCommentState:function(t){return this.commentsMap.get(t)},getNiceUrl:function(t,e,a){return n.data.AppRegistry.ctxpath+n.data.AppRegistry.ClientURI+this.rID+this.active.getNiceUrl(this.rID,e,a)}},t.ZSClass.State=e}(this);
!function(i){function t(){this.versionNumber,this.versionActionList,this.activeVersionLog,this.HighlightVersionChanges=!0,this.versionLogMap={},this.gotoRange,this.isClose=!0,this.isDialogOpen=!1,this.changeLogDialog}var n=i.sPlusPlus,e=ZSConstants.ActionConstants;t.prototype={setVersionNumber:function(i){this.versionNumber=i},getVersionNumber:function(){return this.versionNumber},setVersionActionList:function(i){var t,e=n.view.getActiveGridID(),s=n.view.getResourceID(e),o=(n.view.getSheetID(e),n.view.getVersionID(e));this.versionActionList={};for(var r in i)if(this.isEditAction(i[r].a)){var g=i[r].lp.length;t=i[r].lp[g-1];var h=JSUtil.Range.parseRange(s,o,t);if(h&&h.sheetID){var a=h.sheetID;!this.versionActionList[a]&&(this.versionActionList[a]=[]),this.versionActionList[a].push(i[r])}}},getVersionActionList:function(){return this.versionActionList},isEditAction:function(i){return i===e.SUBMIT||i===e.SORT||i===e.COMPUTE_SUM||i===e.COMPUTE_SUM_C||i===e.REPLACE||i===e.REPLACE_ALL||i===e.CLEARCONTENTS||i===e.INSERT_COPY_COLUMN||i===e.INSERT_COPY_ROW||i===e.INSERT_CUT_COLUMN||i===e.INSERT_CUT_ROW||i===e.FILLSERIES||i===e.MERGE_ACROSS||i===e.MERGE_AND_CENTER||i===e.MERGE_DOWN||i===e.MERGE_RANGE||i===e.HYPERLINK||i===e.COPY_PASTE||i===e.SYSTEMCLIP_PASTE||i===e.CLEARALL||i===e.CUT_PASTE},getHighlightVersionChanges:function(){return this.HighlightVersionChanges},setHighlightVersionChanges:function(i){this.HighlightVersionChanges=i},getActiveVersionLog:function(){return this.activeVersionLog},setActiveVersionLog:function(i){this.activeVersionLog=i},addVersionLog:function(i){var t=i.getVersionNumber();this.versionLogMap[t]=i},clearVersionLogMap:function(){this.versionLogMap={}},getVersionLogMap:function(){return this.versionLogMap},getGoToRange:function(){return this.gotoRange},setGoToRange:function(i){this.gotoRange=i},isCloseButton:function(){return this.isClose},setIsCloseButton:function(i){this.isClose=i},getIsDialogOpen:function(){return this.isDialogOpen},setIsDialogOpen:function(i){this.isDialogOpen=i},getChangeLogDialog:function(){return this.changeLogDialog},setChangeLogDialog:function(i){this.changeLogDialog=i}},i.ZSClass.VersionState=t}(this);
!function(r){function e(){this.rangeArray=[],this.rangeIndex=-1,this.fillMode}var n=(r.sPlusPlus,r.ZSClass);e.prototype={ADD:function(r,e,n){var t=this.getIndex(e);-1!==t?(this._modifyRange(r,e,n,t),this.rangeIndex=t):this._setRange(r,e,n)},_setRange:function(r,e,n){r.id=e,r.type=n,this.rangeArray.push(r),this.rangeIndex=this.rangeArray.length-1},CLEAR:function(){this.rangeArray=[],this.rangeIndex=-1},clearSpecific:function(r){-1!==this.getIndex(r)&&(this.rangeArray.splice(this.getIndex(r),1),this.rangeIndex--)},getIndex:function(r){for(var e=this.rangeArray.length,n=0;e>n;n++)if(this.rangeArray[n].id===r)return n;return-1},_modifyRange:function(r,e,n,t){this.rangeArray[t]=r,this.rangeArray[t].id=e,this.rangeArray[t].type=n},getRangeList:function(){for(var r=[],e=this.rangeArray.length,t=0;e>t;t++){var a=new n.Range(this.rangeArray[t].startRow,this.rangeArray[t].startCol,this.rangeArray[t].endRow,this.rangeArray[t].endCol);a.id=this.rangeArray[t].id,a.type=this.rangeArray[t].type,r.push(a)}return r},getSize:function(){return this.rangeArray.length},getLastModifiedRange:function(){var r=new n.Range(this.rangeArray[this.rangeIndex].startRow,this.rangeArray[this.rangeIndex].startCol,this.rangeArray[this.rangeIndex].endRow,this.rangeArray[this.rangeIndex].endCol);return r.id=this.rangeArray[this.rangeIndex].id,r.type=this.rangeArray[this.rangeIndex].type,r},getLastModifiedID:function(){return this.rangeArray[this.rangeIndex].id},getRange:function(r){var e=this.getIndex(r),t=new n.Range(this.rangeArray[e].startRow,this.rangeArray[e].startCol,this.rangeArray[e].endRow,this.rangeArray[e].endCol);return t.id=this.rangeArray[e].id,t.type=this.rangeArray[e].type,t},setFillMode:function(r){this.fillMode=r},getMode:function(){return this.fillMode},getNiceUrl:function(){return"/ranges/"+this.rangeArray[0].getLabel()}},n.RangeList=e}(this);
!function(t){function s(t,s,e,i,o){this.set(t,s,e,i,o)}s.prototype=new ZSClass.Range,s.prototype.set=function(t,s,e,i,o){this.sheetId=t,this.startRow=s,this.startCol=e,this.endRow=i,this.endCol=o},s.prototype.getSheetID=function(){return this.sheetId},t.ZSClass.View=s}(this);
!function(t){function e(){this.Collection=new Map,this.PivotNameList=new Set,this.TargetSheets=new Set}var i=t.ZSClass,o=(i.Pivot||(i.Pivot={}),i.View,t.ZSConstants.CommandConstants);e.prototype={add:function(t,e){this.Collection.set(t,e),this.PivotNameList.add(t)},modify:function(){},setSheets:function(t,e){{var i=e[0];t[0]}this.TargetSheets.has(i)||this.TargetSheets.add(i)},get:function(t){return this.Collection.get(t)},getTargetSheets:function(){return this.TargetSheets},isSheetContainsPivot:function(t){return this.TargetSheets.has(t)?!0:!1},getPivotList:function(t){var e=[];if(!this.isSheetContainsPivot(t))return e;for(var i=this.PivotNameList.keys(),s=Array.from(i),n=0;n<s.length;n++){var r=s[n],h=this.Collection.get(r),a=h[o.TARGET][0];a===t&&e.push(r)}return e},remove:function(t){this.Collection.has(t)&&this.Collection.delete(t),this.PivotNameList.has(t)&&this.PivotNameList.delete(t)},isPivotCell:function(t,e,i,s){for(var n=this.PivotNameList.keys(),r=Array.from(n),h=0;h<r.length;h++){var a=r[h],l=this.Collection.get(a),u=l[o.TARGET];if((s!==a||void 0===s)&&t==u[0]&&e>=u[1]&&i>=u[2]&&e<=u[3]&&i<=u[4])return!0}return!1},isPivotSourceCell:function(t,e,i){for(var s=this.PivotNameList.keys(),n=Array.from(s),r=0;r<n.length;r++){var h=n[r],a=this.Collection.get(h),l=a[o.SOURCE];if(t===l[0]&&e>=l[1]&&i>=l[2]&&e<=l[3]&&i<=l[4])return!0}return!1},toString:function(){return JSON.stringify(this)}},i.Pivot.Collection=e}(this);
!function(o){var t=o.ZSClass,n=function(){this.WorkBook=null};n.prototype={addWorkBook:function(o){this.WorkBook=o},removeWorkBook:function(){this.WorkBook=null},getWorkBook:function(){return this.WorkBook}},t.DocContainer=n}(this);
!function(t){function s(){}var o=(t.sPlusPlus,t.ZSClass),i=t.ZSConstants,n=i.CommandConstants,u=t.ZSEvents,e=u.topic,r=u.Groups,l=u.Names;s.prototype={update:function(t){this.type=t[n.PUBLISH_TYPE],this.allowExport=t[n.ALLOW_EXPORT],this.showFormulas=t[n.SHOW_FORMULAS],e.publish(r.Listener,l.ShareMeta.PUBLISH_UPDATE,{ISSHARED:!!this.type})},isPublished:function(){return!!this.type},setAllowExport:function(t){this.allowExport=t},isAllowExport:function(){return this.allowExport},setShowFormula:function(t){this.showFormulas=t},isShowFormula:function(){return this.showFormulas},setType:function(t){this.type=t},getType:function(){return this.type}},o.PublicMeta=s}(this);
!function(t){function e(){this.type="",this.UserInfo={}}var s=(t.sPlusPlus,t.ZSClass),n=t.ZSConstants,i=n.CommandConstants,r=t.ZSEvents,o=r.topic,h=r.Groups,u=r.Names;e.prototype={update:function(t){this.setSharedUserInfo(t[i.SHARE_USER_INFO]),this.type=t[i.SHARE_TYPE],this.OWNER=t[i.OWNER],this.OWNER_ID=t[i.OWNER_ID],o.publish(h.Listener,u.ShareMeta.SHARE_UPDATE,{ISSHARED:!!this.type})},getType:function(){return this.type},setType:function(t){this.type=t},isShared:function(){return!!this.type},setSharedUserInfo:function(t){this.UserInfo=new s.SharedUserInfo(t)},getSharedUserInfo:function(){return this.UserInfo}},s.ShareMeta=e}(this);
!function(t){function e(){this.ShareMeta=new s.ShareMeta,this.PublishMeta=new s.PublicMeta}var s=(t.sPlusPlus,t.ZSClass),a=t.ZSConstants,i=a.CommandConstants;e.prototype={update:function(t){var e=t[i.SHARE_INFO],s=t[i.PUBLISH];this.ShareMeta.update(e),this.PublishMeta.update(s)},getPublishMeta:function(){return this.PublishMeta},getShareMeta:function(){return this.ShareMeta},isShared:function(){return this.ShareMeta.isShared()},isPublished:function(){return this.PublishMeta.isPublished()}},s.SharePublishMeta=e}(this);
!function(e){var n=(e.sPlusPlus,e.ZSClass),t=function(e){this.userInfo=e?e:[]};t.prototype={set:function(e){this.userInfo=e},get:function(){return this.userInfo},isEmpty:function(){return!(this.userInfo.length>1)},getNameByID:function(e){for(var n=this.userInfo,t=0;t<n.length;t++){var i=n[t];if(i.id===e)return i.name}},remove:function(e){var n=this.userInfo,t=0;for(var i in n){if(n[i].id===e){this.userList.splice(t,1);break}t+=1}},add:function(e){var n={email:e.email,fullname:e.fullname,id:""+e.id,name:e.name,role:"role",photo:!1,type:"C"};this.userInfo[this.userInfo.length]=n}},n.SharedUserInfo=t}(this);
!function(r){function t(r,a,R,n){if(r)switch(r.t){case i.OPERATOR:var s=r.ch,c="";for(var o in s)c+=t(s[o])+r.v.sym;return c.substring(0,c.length-1);case i.FUNCTION:var s=r.ch,c="";for(var o in s)c+=t(s[o])+";";return r.v.n+"("+c.substring(0,c.length-1)+")";case i.REF:var s=r.ch,u="",d=e(r.v,a,R,n);return d?(u=d+":",u.substring(0,u.length-1)):void 0;case i.CONSTANT:return r.v.v;case i.ERROR:return r.v.n||r.v.v;case i.NAMED_EXPRESSION:return r.v.n;case i.ARRAY:return r.v.v;case i.RANGE:var O=r.ch,l=r.v.asn?r.v.asn:"",A=v.view.getActiveGridID(),E=v.view.getResourceID(A),M=v.view.getVersionID(A),N=l?v.data.getWorkBook(E,M).getSheetObj(l).Prop.Name.trim():"";N=N?-1!==N.indexOf(" ")?"'"+N+"'.":N+".":"";var u="";for(var o in O){var f=t(O[o],a,R,n);if(void 0==f)return void 0;u+=f+":"}return N+u.substring(0,u.length-1)}}function e(r,t,e,R){var t,e,n,i,s;if(void 0==t&&void 0==e?(n=a(),i=n.r,s=n.c):(i=t,s=e),r.r&&!r.c){t="R"==r.r.rMod?i+r.r.v:r.r.v;var c="R"==r.r.rMod?"":"$";return void 0==R||1==R?c+t+1:0>t?void 0:c+t+1}if(!r.r&&r.c){e="R"==r.c.rMod?s+r.c.v:r.c.v;var c="R"==r.c.rMod?"":"$";return void 0==R||1==R?c+JSUtil.Object.getCharForNum(e+1):0>e?void 0:c+JSUtil.Object.getCharForNum(e+1)}if(void 0==R||1==R?(t="R"==r.r.rMod?(parseInt(i+r.r.v)+v.data.Defaults.MAX_ROW)%v.data.Defaults.MAX_ROW+1:(v.data.Defaults.MAX_ROW+parseInt(r.r.v))%v.data.Defaults.MAX_ROW+1,e="R"==r.c.rMod?(parseInt(s+r.c.v)+v.data.Defaults.MAX_COL)%v.data.Defaults.MAX_COL+1:(parseInt(r.c.v)+v.data.Defaults.MAX_COL)%v.data.Defaults.MAX_COL+1):(t="R"==r.r.rMod?parseInt(i+r.r.v)+1:parseInt(r.r.v)+1,e="R"==r.c.rMod?parseInt(s+r.c.v)+1:parseInt(r.c.v)+1),t>=0&&e>=0){var o="R"==r.r.rMod?t:"$"+t,u="R"==r.c.rMod?JSUtil.Object.getCharForNum(e):"$"+JSUtil.Object.getCharForNum(e);return u+o}return void 0}function a(){var r=v.view.getActiveGridID(),t=v.view.getSheetID(r),e=v.view.getSheetState(r,t);return{r:e.Cell.row,c:e.Cell.col}}var v=r.sPlusPlus,R=v.data.Defaults,n=(R.MAX_ROW,R.MAX_COL,r.ZSClass,r.JSUtil),i={OPERATOR:"OPR",FUNCTION:"FUN",ERROR:"ERR",CONSTANT:"CON",ARRAY:"ARR",RANGE:"RNG",REF:"REF",ROW_REF:"ROW_REF",COL_REF:"COL_REF",NAMED_EXPRESSION:"NME",CELL_REF:"CELL_REF"};n.FormRange=t}(this);
!function(e){function n(){this.namedRangeMap=new a,this.namedRangeKeys=new Set,this.allNames=new Set,this.rankMap=new a,this.namedExpressionKeys=new Set}var s=e.ZSClass,a=s.Map;n.prototype={add:function(e){this.namedRangeMap.set(e[0],e[2]),this.allNames.add(e[0]),"RNG"==e[2].t?this.namedRangeKeys.add(e[0]):this.namedExpressionKeys.add(e[0])},modify:function(e){this.namedRangeMap.set(e[0],e[2]),"RNG"==e[2].t?(this.namedRangeKeys.add(e[0]),this.namedExpressionKeys.has(e[0])&&this.namedExpressionKeys.delete(e[0])):(this.namedExpressionKeys.add(e[0]),this.namedRangeKeys.has(e[0])&&this.namedRangeKeys.delete(e[0]))},get:function(e){return this.namedRangeMap.get(e)},remove:function(e){this.namedRangeMap.remove(e[0]),this.allNames.has(e[0])&&(this.allNames.delete(e[0]),this.rankMap.remove(e[0])),this.namedRangeKeys.has(e[0])&&this.namedRangeKeys.delete(e[0]),this.namedExpressionKeys.has(e[0])&&this.namedExpressionKeys.delete(e[0])},getKeys:function(){return this.namedRangeKeys},getExpressions:function(){return this.namedExpressionKeys},getAllKeys:function(){return this.allNames},has:function(e){return this.allNames.has(e)},incrementRankValue:function(e){var n=this.rankMap.get(e);this.rankMap.set(e,n+1)},removeRankKey:function(e){this.rankMap.remove(e)},toString:function(){return JSON.stringify(this)}},s.NamedRange=n}(this);
!function(E){function S(S){var n="",R="";if(S[O.DOCUMENT_META]){for(var s in S[O.DOCUMENT_META])var i=S[O.DOCUMENT_META][s][O.ACTION_IDENTIFIER];i&&(n=i[O.LAST_EXECUTED_ACTION_ID]||i[O.EXECUTED_ACTION_ID],R=i[O.IS_SERVER_ACTION]?" :SERVER :":" :USER :")}r.isEnabled&&r.print("log",(E.window?"MAIN":"WORKER")+":: LSERVER & CLIENT : "+n+R,t.Response.Decode(S))}function n(E){for(var S in E)UNPROCESSED[S]||("function"==typeof E[S]&&r.log("warning","functions coming here fix this.. this is not going to transfered to main window anyhow.",S),UNPROCESSED_ELEMENTS.push(S));r.isEnabled&&r.print("warning","Process CmdConsts:: "+UNPROCESSED_ELEMENTS)}function R(R){S(R),UNPROCESSED={},UNPROCESSED_ELEMENTS=[],i.publish(o.Listener,e.Parser.RESPONSE.ONBEFORE,{RESPONSE:R}),N[O.ERRORMSG](R[O.ERRORMSG]),R[O.DOCUMENT_META]&&E.ZSResponseParser.ParseDocMeta(R[O.DOCUMENT_META]),i.publish(o.Listener,e.Parser.RESPONSE.ONAFTER,{RESPONSE:R}),n(R)}var s=(E.sPlusPlus,E.ZSEvents),i=s.topic,o=s.Groups,e=s.Names,O=E.ZSConstants.CommandConstants,r=E.ZSDevTools.Logger,N={},t=E.ZSDevTools;E.UNPROCESSED={},E.UNPROCESSED_ELEMENTS=[],N[O.ERRORMSG]=function(E){if(E){UNPROCESSED[O.ERRORMSG]=!0;for(var S in E)"mk"===S&&i.publish(o.Listener,e.ERROR.SHOW,{ERRORMSG:E[S]})}},i.register(o.Listener,e.ServerAction.PROCESSRESPONSE,R,"RESPONSE")}(this);
!function(r){function a(r,a,t){for(var o=[],s=r[n.DOCUMENT_META][a][n.SHEET_META][t][n.CELL_META][n.META],E=s[n.ROW_DATA],e=s[n.COLUMN_DATA],f=E.length-1;f>=0;f--)for(var A=E[f],T=A[0]+A[1]-1,v=A[0],C=T;C>=v;C--)for(var l=e[A[2]],M=l.length-1;M>=0;M--){var i=l[M];if(i)for(var u=i[0]+i[1]-1,_=i[0],c=u;c>=_;c--){var h=i[2][1];o.push({r:C,c:c,displayValue:h})}}return o}var n=r.ZSConstants.CommandConstants;r.ZSResponseParser.ExtractCellInfo=a}(this);
!function(t){function e(t){var e=o.view.getActiveGridID(),n=o.view.State[e],s=t[v.DOCUMENT_META];for(var S in s){var i=s[S],r=i[v.VERSION]?""===i[v.VERSION]?o.data.Defaults.version:i[v.VERSION]:o.data.Defaults.version;!n[S]&&(n[S]={},n[S].VersionState=new ZSClass.VersionState),!n[S][r]&&(n[S][r]=new ZSClass.State),a(S,r,i)}}function a(t,e,a){var s=a[v.SHEET_META],S=o.view.getActiveGridID();for(var i in s){var r=o.view.State[S][t][e];r.rID=t,!r.getSheetState(i)&&r.setSheetState(i,new ZSClass.ActiveInfo);var E=s[i][v.ACTIVE_INFO];E&&n(S,t,i,e,E)}}function n(t,e,a,n,r){var E=o.view.State[t][e][n],I=E.getSheetState(a);r[v.ACTIVE_CELL]&&s(I,r[v.ACTIVE_CELL]),r[v.ACTIVE_RANGES]&&S(I,r[v.ACTIVE_RANGES]),r[v.PERSISTED_POSITIONS]&&i(I,r[v.PERSISTED_POSITIONS])}function s(e,a){var n=new t.ZSClass.Range(a[0],a[1],a[0],a[1]);e.setActiveCellRange(0,n,n.startRow,n.startCol)}function S(e,a){for(var n=0;n<a.length;n++){var s=a[n],S=new t.ZSClass.Range(s[0],s[1],s[2],s[3]);e.addSelection(S,n)}}function i(t,e){t.setScrollPosition0(e[0][0],e[0][1]),e[1]&&t.setScrollPosition1(e[1][0],e[1][1])}var o=t.sPlusPlus,r=t.ZSEvents,v=(r.topic,r.Groups,r.Names,t.ZSDevTools.Logger,t.ZSConstants.CommandConstants);o.view.State={},o.view.State[o.view.getActiveGridID()]={},e(o.transientResponse.RESPONSE)}(this);
!function(t){var s=(t.sPlusPlus,t.ZSClass),i=function(){this.userList=[]};i.prototype={set:function(t){this.userList=t},get:function(){return this.userList},isAvailable:function(){return this.userList.length>1},getName:function(t){for(var s=this.userList,i=0;i<s.length;i++){var r=s[i];if(r.id==t)return r.name}},remove:function(t){var s=this.userList,i=0;for(var r in s){if(s[r].id===t){this.userList.splice(i,1);break}i+=1}}},s.Collaborators=i}(this);
!function(t){function e(t,e,i,a,n,s,o){this.range=a,this.need=n,this.allowToSort=void 0!=o.allowToSort?o.allowToSort:!1,this.showHiddenData=void 0!=o.showHiddenData?o.showHiddenData:!1,this.showFilteredData=void 0!=o.showFilteredData?o.showFilteredData:!1,this.needHiddenDataIndex=void 0!=o.needHiddenDataIndex?o.needHiddenDataIndex:!1,this.skipNumbers=void 0!=o.skipNumbers?o.skipNumbers:!1,this.skipActiveCellData=void 0!=o.skipActiveCellData?o.skipActiveCellData:!1,this.enableMaxLimit=void 0!=o.maxLimit?o.maxLimit:!1,this.activeCell=o.activeCell,this.rID=t,this.sheetID=e,this.version=i,this.callback=s,this.init(t,e,i)}function i(t){this.data=t;var e=this.getData();this.callback(e)}function a(t){var e=t.startRow,i=t.startCol,a=t.endRow,n=t.endCol,s=a-e,o=n-i;a=s>=h?h:a,n=o>=h?h:n;var r=new d.Range(t.startRow,t.startCol,a,n);return r}function n(t){for(var e="",i=0;i<t.length;i++){var a=t.charCodeAt(i).toString(16).toUpperCase();e+=a}return e}function s(t,e){return n(t)<n(e)?-1:1}function o(t){var e,i=[];for(e in t)t.hasOwnProperty(e)&&i.push({key:e,value:t[e]});i.sort(s)}var r=t.sPlusPlus,d=t.ZSClass,h=(r.data.api,1e3),l=t.ZSConstants.CommandConstants,v={0:"bgColor",1:"color",2:"hideText"},D={0:"bgColor",1:"color",2:"fontSize",3:"fontName",4:"fontWeight",5:"fontStyle",6:"Textlinethroughtstyle",7:"Textunderlinestyle",8:"wrap",9:"hAlign",10:"vAlign",11:"border",12:"hideText",13:"iconSet"};e.prototype={init:function(){var t=this.enableMaxLimit?a(this.range):this.range,e=i.bind(this),n=r.view.getActiveGridID();this.skipHiddenCells=!this.showHiddenData&&!this.showFilteredData,r.view.fetchRangeData(this.rID,this.sheetID,this.version,t,this.need,this.skipHiddenCells,n,e)},getData:function(){var t=this.data,e={},i=r.data.getWorkBook(this.rID,this.version),a=i.getSheetObj(this.sheetID),n={},s={};for(var d in t)for(var h in t[d]){var l=a.Row.Visibility.isHidden(d),v=a.Column.hidden.isHidden(h),D=a.Row.Filter.isHidden(d);if(!((l||v)&&D&&!this.showFilteredData&&!this.showHiddenData||this.skipNumbers&&"STRING"!=t[d][h].CellType))for(var f in t[d][h]){var u=t[d][h][f];if("unavailable"!=f&&-1!=this.need.indexOf(f))if("Format"==f||"ConditionalFormat"==f)"Format"==f&&this.getStyle(e,t[d][h],f,s,D);else{if(n[u])continue;if(!e[f]&&(e[f]=this.needHiddenDataIndex?{}:[]),this.skipActiveCellData&&this.activeCell.row==d&&this.activeCell.col==h)continue;n[u]=1,this.needHiddenDataIndex?e[f][u]=this.showFilteredData?D?0:1:0:e[f].push(u)}}}return this.allowToSort&&e.DisplayValue&&o(e.DisplayValue),e},getStyle:function(t,e,i,a,n){var s=r.data.getWorkBook(this.rID,this.version),o=e.Format||"Default",h=(e.ConditionalFormat,s.CellStyle.getStyleDef(o)),l=new d.CellDecorator.getStyle(h,e);!t[i]&&(t[i]={});for(var v in l){var f=D[v],u=l[v];!t[i][f]&&(t[i][f]=this.needHiddenDataIndex?{}:[]),a[f+u]||(a[f+u]=1,this.needHiddenDataIndex?t[i][f][u]=this.showFilteredData?n?0:1:0:t[i][f].push(u))}},getFormat:function(t,e,i,a,n){var s=r.data.getWorkBook(this.rID,this.version),o={};if("ConditionalFormat"==i){if(!a)return;i="Format",!t[i]&&(t[i]={});for(var d=a.length-1;d>=0;d--){var h=a[d];for(var f in h)if(f==l.COLORSCALE)for(var u in v){var c=v[u];!t[i][c]&&(t[i][c]=this.needHiddenDataIndex?{}:[]),e[c+h[f][u]]?o[c]=!0:(e[c+h[f][u]]=1,this.needHiddenDataIndex?!o[c]&&(t[i][c][h[f][u]]=this.showFilteredData?n?0:1:0):!o[c]&&t[i][c].push(h[f][u]),""!=h[f][u]&&(o[c]=!0))}else if(f==l.CONDITIONALFORMAT){var C=h[f],w=s.CellStyle.getStyleDef(C);for(var g in w){var c=D[g];!t[i][c]&&(t[i][c]=this.needHiddenDataIndex?{}:[]),e[c+w[g]]?o[c]=!0:(e[c+w[g]]=1,this.needHiddenDataIndex?!o[c]&&(t[i][c][w[g]]=this.showFilteredData?n?0:1:0):!o[c]&&t[i][c].push(w[f][u]),""!=w[g]&&(o[c]=!0))}}}}if("Format"==i){!t[i]&&(t[i]={});var w=s.CellStyle.getStyleDef(a);for(var g in w){var c=D[g];!t[i][c]&&(t[i][c]=this.needHiddenDataIndex?{}:[]),e[c+w[g]]||(e[c+w[g]]=1,this.needHiddenDataIndex?!o[c]&&(t[i][c][w[g]]=this.showFilteredData?n?0:1:0):!o[c]&&t[i][c].push(w[g]))}}}},d.UniqueData=e}(this);
!function(E){function I(I){L[N.DOCUMENT_META]=!0;for(var D in I){var A,_=I[D],t=_[N.VERSION],M=t&&t[N.VERSION_NUMBER]?""===t[N.VERSION_NUMBER]?S.data.Defaults.version:t[N.VERSION_NUMBER]:S.data.Defaults.version;R.publish(O.Listener,T.Parser.DOC.ONBEFORE,{RID:D,VERSION:M,data:_}),e[N.ERRORMSG](D,M,_[N.ERRORMSG]),e[N.META](D,M,_[N.META]),_[N.ACTION_IDENTIFIER]&&(A=_[N.ACTION_IDENTIFIER][N.EXECUTED_ACTION_ID]),e[N.ERROR](D,M,_[N.ERROR],A),e[N.ACTION_IDENTIFIER](D,M,_[N.ACTION_IDENTIFIER]),e[N.WEB_USERMETA_INFO](D,M,_[N.WEB_USERMETA_INFO]),e[N.WORKSHEETS](D,M,_[N.WORKSHEETS]),e[N.PROTECTED_SHEETS](D,M,_[N.PROTECTED_SHEETS]),e[N.DOC_SETTINGS](D,M,_[N.DOC_SETTINGS]),e[N.CELLSTYLES_DEFINITION](D,M,_[N.CELLSTYLES_DEFINITION]),e[N.ROW_HEADERS_DEFINITION](D,M,_[N.ROW_HEADERS_DEFINITION]),e[N.COLUMN_HEADERS_DEFINITION](D,M,_[N.COLUMN_HEADERS_DEFINITION]),e[N.FORM_SHEETS](D,M,_[N.FORM_SHEETS]),e[N.PIVOT](D,M,_[N.PIVOT]),e[N.NAMED_RANGE](D,M,_[N.NAMED_RANGE]),e[N.IMPORT](D,M,_[N.IMPORT]),e[N.REPLACE_ALL_COUNT](_[N.REPLACE_ALL_COUNT]),e[N.DELUGE_FUNCTIONS](D,M,_[N.DELUGE_FUNCTIONS]),e[N.FORCED_REFRESH_TILE](D,M,_[N.FORCED_REFRESH_TILE]),_[N.DISCUSSION]&&e[N.DISCUSSION](D,M,_[N.DISCUSSION]),e[N.IS_REVERT_VERSION](D,M,_[N.IS_REVERT_VERSION]),e[N.ACTIVE_INFO](D,M,_[N.ACTIVE_INFO]);var s=_[N.ACTION_IDENTIFIER]&&_[N.ACTION_IDENTIFIER][N.RSID]?_[N.ACTION_IDENTIFIER][N.RSID]==S.data.PageRegistry.RS_ID:!1;_[N.SHEET_META]&&E.ZSResponseParser.ParseSheetMeta(D,M,A,_[N.SHEET_META],s),e[N.FAULTY](D,M,_[N.FAULTY]),e[N.USER_NOTIFICATION](D,M,_[N.USER_NOTIFICATION]),R.publish(O.Listener,T.Parser.DOC.ONAFTER,{RID:D,VERSION:M,data:_});for(var C in _)L[C]||i.push(C)}}var S=E.sPlusPlus,D=E.ZSEvents,R=D.topic,O=D.Groups,T=D.Names,N=E.ZSConstants.CommandConstants,A=S.data.UserInfo,e={},L=E.UNPROCESSED,i=E.UNPROCESSED_ELEMENTS;e[N.ERRORMSG]=function(E,I,S){if(S){L[N.ERRORMSG]=!0;for(var D in S)"mk"===D&&R.publish(O.Listener,T.ERROR.SHOW,{RID:E,VERSION:I,ERRORMSG:S[D]})}},e[N.ERROR]=function(E,I,S,D){if(S){L[N.ERROR]=!0;var A=S[N.DATAVALIDATION];R.publish(O.Listener,T.SheetAction.DATAVALIDATION.UPDATEDOM,{RESOURCE_ID:E,VERSION:I,STATE:A,xaid:D})}},e[N.ACTION_IDENTIFIER]=function(E,I,S){S&&(L[N.ACTION_IDENTIFIER]=!0,S[N.EXECUTED_ACTION_ID]&&R.publish(O.Listener,T.DocMeta.ACTION_IDENTIFIER,{RESOURCE_ID:E,xaid:S[N.EXECUTED_ACTION_ID],VERSION:I}),S[N.DOCUMENT_SERVED_STATE]&&R.publish(O.Listener,T.GridAction.LAST_SAVED_ID,{RESOURCE_ID:E,LAST_SAVED_ID:S[N.DOCUMENT_SERVED_STATE],LAST_EXECUTED_ACTION_ID:S[N.LAST_EXECUTED_ACTION_ID],VERSION:I}))},e[N.WEB_USERMETA_INFO]=function(E,I,S){S&&(L[N.WEB_USERMETA_INFO]=!0,R.publish(O.Listener,T.UserMeta.USERS_METAINFO,{ZUID:S[N.ZUID]}))},e[N.META]=function(E,I,D){if(D){L[N.META]=!0,D[N.UNIQUE_TAB_ID]&&R.publish(O.Listener,T.DocMeta.UNIQUE_TAB_ID,{UNIQUE_TAB_ID:D[N.UNIQUE_TAB_ID]}),A.Permission.isEditable=D[N.ISEDITABLE]?1:0,A.Permission.isSharable=D[N.ISSHARABLE]?1:0,A.Permission.isCoOwner=D[N.ISSHARABLE]&&!D[N.ISDOCOWNER]?1:0;var e=D[N.ISEDITABLE]?0:1;if(R.publish(O.Listener,T.DocMeta.DOCUMENT_MODE,{isEditable:D[N.ISEDITABLE],isSharable:D[N.ISSHARABLE],Persistent:e,VERSION:I,isTemplate:D[N.IS_TEMPLATE]}),R.publish(O.Listener,T.DocMeta.DOCUMENT_MODE_temp,{isEditable:D[N.ISEDITABLE],isSharable:D[N.ISSHARABLE],Persistent:1,VERSION:I}),R.publish(O.Listener,T.DocMeta.DOCUMENT_NAME,{RESOURCE_ID:E,VERSION:I,DOCUMENT_NAME:decodeURIComponent(D[N.DOCUMENT_NAME]),IS_FAVORITE:D[N.IS_FAVORITE]}),I===S.data.Defaults.version&&R.publish(O.Listener,T.DocMeta.DOCUMENT_SET_EDITABLE,{RID:E,VERSION:I,ISEDITABLE:D[N.ISEDITABLE]}),R.publish(O.Listener,T.DocMeta.DOCUMENT_SET_PERMISSION,{RID:E,VERSION:I,showFormula:D[N.SHOW_FORMULAS],allowExport:D[N.ALLOW_EXPORT]}),D[N.ISSCRATCH]){var i=S.data.getWorkBook(E,I);i.isSavable=!D[N.ISSCRATCH],A.isIncognito=!!D[N.ISSCRATCH],i.CollaborationMode=D[N.ISSCRATCH]?0:1,R.publish(O.Listener,T.DocAction.DOCUMENT.RENAME,{NEW_NAME:"Untitled Spreadsheet",RESOURCE_ID:E,VERSION:I})}R.publish(O.Listener,T.DocMeta.DOCUMENT_LOCALE,{RID:E,VERSION:I,LANGUAGE:D[N.LANGUAGE],COUNTRY:D[N.COUNTRY],THOUSAND_SEPARATOR:D[N.THOUSAND_SEPARATOR],DECIMAL_SEPARATOR:D[N.DECIMAL_SEPARATOR],DATE_SEPARATOR:D[N.DATE_SEPARATOR],LOCALE_DATEFORMAT:D[N.LOCALE_DATEFORMAT_TYPE],FORMATCELLS_REGIONAL:D[N.FORMATCELLS_REGIONAL],FORMATCELLS_CUSTOM:D[N.FORMATCELLS_CUSTOM]}),D[N.LOCKED_BY]&&R.publish(O.Listener,T.DocMeta.LOCKED_INFO,{isLocked:!0,lockedBy:D[N.LOCKED_BY],lockedByZuid:D[N.LOCKED_BY_ZUID],isInitialFetch:!0}),D[N.SHARE_META]&&R.publish(O.Listener,T.ShareMeta.UPDATE,{RID:E,META:D[N.SHARE_META]}),!S.isLServer&&D[N.LAST_SAVED_TIME]&&R.publish(O.Listener,T.DocAction.SAVE_MSG.UPDATE,{RID:E,VERSION:I,STATE:"disable",LASTMODIFIED:D[N.LAST_SAVED_TIME]})}},e[N.ACTIVE_INFO]=function(E,I,S){S&&(L[N.ACTIVE_INFO]=!0,R.publish(O.Listener,T.DocMeta.ACTIVE_INFO,{RID:E,VERSION:I,DATA:S}))},e[N.PROTECTED_SHEETS]=function(E,I,S){S&&(L[N.PROTECTED_SHEETS]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.PROTECTED_SHEETS,{RID:E,VERSION:I,PROTECTED_SHEETS:S[N.META]}),S[N.MODIFY]&&R.publish(O.Listener,T.DocAction.PROTECTED_SHEETS.MODIFY,{RID:E,VERSION:I,MODIFY:S[N.MODIFY]}),S[N.REMOVE]&&R.publish(O.Listener,T.DocAction.PROTECTED_SHEETS.REMOVE,{RID:E,VERSION:I,REMOVE:S[N.REMOVE]}))},e[N.WORKSHEETS]=function(E,I,D){if(D){if(L[N.WORKSHEETS]=!0,D[N.META]&&R.publish(O.Listener,T.DocMeta.WORKSHEETS,{RID:E,VERSION:I,SHEET_NAME_LISTS:D[N.META]}),D[N.MOVE]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.MOVE,{RID:E,VERSION:I,MOVE:D[N.MOVE]}),D[N.RENAME]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.RENAME,{RID:E,VERSION:I,RENAME:D[N.RENAME]}),D[N.TABCOLOR]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.TABCOLOR,{RID:E,VERSION:I,TABCOLOR:D[N.TABCOLOR]}),D[N.HIDE_GRID]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.HIDE_GRID,{RID:E,VERSION:I,HIDE_GRID:D[N.HIDE_GRID]}),D[N.UNHIDDEN_SHEETS]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.UNHIDE_SHEETS,{RID:E,VERSION:I,meta:D[N.UNHIDDEN_SHEETS]}),D[N.UNHIDDEN_SHEETS]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.AFTER_UNHIDE_SHEETS,{RID:E,VERSION:I}),D[N.HIDDEN_SHEETS]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.ONBEFORE_HIDE_SHEETS,{RID:E,VERSION:I,meta:D[N.HIDDEN_SHEETS]}),D[N.HIDDEN_SHEETS]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.HIDE_SHEETS,{RID:E,VERSION:I,meta:D[N.HIDDEN_SHEETS]}),D[N.HIDDEN_SHEETS]&&R.publish(O.Listener,T.DocAction.WORKSHEETS.AFTER_HIDE_SHEETS,{RID:E,VERSION:I}),D[N.INSERT_SHEETS])for(var e=D[N.INSERT_SHEETS],i=e.length,_=0;i>_;_++)R.publish(O.Listener,T.DocAction.WORKSHEETS.INSERT,{RID:E,VERSION:I,INSERT:e[_]});if(D[N.DELETE]){var e=D[N.DELETE],t=S.data.getWorkBook(E,I),i=e.length;if(S.view&&i){for(var M=S.view.getActiveGridID(),s=0;i>s;s++){var C=e[s][0],n=t.getSheetObj(C),o=S.view.getSheetState(M,C);if(o){var U=S.view.CellEditor.getEditStatus(),r=o.getFillRange(),c=A.activeInfo.getCopyDetails(),V=S.view.getActiveState(M),l=V.getFormulaRanges(C),P=o.getActiveRange(),u=n.DataFilters,F=u.getAllRanges();for(var a in F){var H=F[a],h=new ZSClass.Range(H.startRow,H.startCol,H.endRow,H.endCol);R.publish(O.UserAction,T.SheetAction.DATAFILTER.HIDE,{RID:E,SHEETID:C,VERSION:I,FRANGE:h})}U&&R.publish(O.Selector.BoundUpdate.CellEdit,T.Selection.BOUND_UPDATE.REMOVE,{RID:E,SHEETID:C,VERSION:I}),U&&R.publish(O.UserAction,T.KeyBoard.ForceQuit,{RID:E,SHEETID:C,VERSION:I}),r&&R.publish(O.Selector.BoundUpdate.Copy,T.Selection.BOUND_UPDATE.REMOVE,{RID:E,SHEETID:C,VERSION:I}),c&&R.publish(O.Selector.BoundUpdate.FillSeries,T.Selection.BOUND_UPDATE.REMOVE,{RID:E,SHEETID:C,VERSION:I,RANGEID:o.getActiveID()});for(var s=0;P&&s<P.length;s++)R.publish(O.Selector.BoundUpdate.Range,T.Selection.BOUND_UPDATE.REMOVE,{RID:E,SHEETID:C,VERSION:I,RANGEID:P[s].id});for(var s=0;l&&s<l.length;s++)R.publish(O.Selector.BoundUpdate.Formula,T.Selection.BOUND_UPDATE.REMOVE,{RID:E,SHEETID:C,VERSION:I,RANGEID:l[s].id})}}R.publish(O.Listener,T.DocAction.WORKSHEETS.ON_BEFORE_DELETE,{RID:E,VERSION:I,DELETE:D[N.DELETE]})}R.publish(O.Listener,T.DocAction.WORKSHEETS.DELETE,{RID:E,VERSION:I,DELETE:D[N.DELETE]})}}},e[N.CELLSTYLES_DEFINITION]=function(E,I,S){S&&(L[N.CELLSTYLES_DEFINITION]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.CELL_STYLENAMES,{RID:E,VERSION:I,STYLES:S[N.META]}),S[N.SYNC]&&R.publish(O.Listener,T.DocAction.CELL_STYLENAMES.SYNC,{RID:E,VERSION:I,STYLES:S[N.SYNC]}),S[N.APPEND]&&R.publish(O.Listener,T.DocAction.CELL_STYLENAMES.APPEND,{RID:E,VERSION:I,STYLES:S[N.APPEND]}))},e[N.ROW_HEADERS_DEFINITION]=function(E,I,S){S&&(L[N.ROW_HEADERS_DEFINITION]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.ROW_HEADERS_DEFINITION,{RID:E,VERSION:I,STYLES:S[N.META]}),S[N.SYNC]&&R.publish(O.Listener,T.DocAction.ROW_HEADERS_DEFINITION.SYNC,{RID:E,VERSION:I,STYLES:S[N.SYNC]}),S[N.APPEND]&&R.publish(O.Listener,T.DocAction.ROW_HEADERS_DEFINITION.APPEND,{RID:E,VERSION:I,STYLES:S[N.APPEND]}))},e[N.COLUMN_HEADERS_DEFINITION]=function(E,I,S){S&&(L[N.COLUMN_HEADERS_DEFINITION]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.COLUMN_HEADERS_DEFINITION,{RID:E,STYLES:S[N.META],VERSION:I}),S[N.SYNC]&&R.publish(O.Listener,T.DocAction.COLUMN_HEADERS_DEFINITION.SYNC,{RID:E,STYLES:S[N.SYNC],VERSION:I}),S[N.APPEND]&&R.publish(O.Listener,T.DocAction.COLUMN_HEADERS_DEFINITION.APPEND,{RID:E,STYLES:S[N.APPEND],VERSION:I}))},e[N.FAULTY]=function(E,I,S){S&&(L[N.FAULTY]=!0,R.publish(O.Listener,T.DocMeta.INVALIDATE,{RID:E,VERSION:I,SHEETS:S[N.WORKSHEETS]}))},e[N.FORM_SHEETS]=function(E,I,S){S&&(L[N.FORM_SHEETS]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.FORM_SHEETS,{RID:E,VERSION:I,FORMSHEETS:S[N.META]}),S[N.ADD]&&R.publish(O.Listener,T.DocAction.FORM_SHEETS.ADD,{RID:E,VERSION:I,FORMSHEETS:S[N.ADD]}),S[N.DELETE]&&R.publish(O.Listener,T.DocAction.FORM_SHEETS.DELETE,{RID:E,VERSION:I,FORMSHEETS:S[N.DELETE]}),S[N.MODIFY]&&R.publish(O.Listener,T.DocAction.FORM_SHEETS.MODIFY,{RID:E,VERSION:I,FORMSHEETS:S[N.MODIFY]}))},e[N.PIVOT]=function(E,I,S){S&&(L[N.PIVOT]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.PIVOT,{RID:E,VERSION:I,PIVOT:S[N.META]}),S[N.ADD]&&R.publish(O.Listener,T.DocAction.PIVOT.ADD,{RID:E,VERSION:I,PIVOT:S[N.ADD]}),S[N.MODIFY]&&R.publish(O.Listener,T.DocAction.PIVOT.OnBeforeModify,{RID:E,VERSION:I,PIVOT:S[N.MODIFY]}),S[N.MODIFY]&&R.publish(O.Listener,T.DocAction.PIVOT.MODIFY,{RID:E,VERSION:I,PIVOT:S[N.MODIFY]}),S[N.MOVE]&&R.publish(O.Listener,T.DocMeta.PIVOT,{RID:E,VERSION:I,PIVOT:S[N.MOVE]}),S[N.DELETE]&&R.publish(O.Listener,T.DocAction.PIVOT.DELETE,{RID:E,VERSION:I,PIVOT:S[N.DELETE]}))},e[N.IS_REVERT_VERSION]=function(E,I,S){S&&(L[N.IS_REVERT_VERSION]=!0,R.publish(O.Listener,T.DocMeta.TRIGGER_DOCUMENT_EXIT,{EXCEPTIONKEY:"Document.Revert.Reopen",UPDATEDOCLIST:1,VERSION:I}))},e[N.NAMED_RANGE]=function(E,I,S){S&&(L[N.NAMED_RANGE]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.NAMED_RANGE,{RID:E,VERSION:I,NAMEDRANGE:S[N.META]}),S[N.ADD]&&R.publish(O.Listener,T.DocAction.NAMED_RANGE.ADD,{RID:E,VERSION:I,NAMEDRANGE:S[N.ADD]}),S[N.MODIFY]&&R.publish(O.Listener,T.DocAction.NAMED_RANGE.MODIFY,{RID:E,VERSION:I,NAMEDRANGE:S[N.MODIFY]}),S[N.DELETE]&&R.publish(O.Listener,T.DocAction.NAMED_RANGE.REMOVE,{RID:E,VERSION:I,NAMEDRANGE:S[N.DELETE]}))},e[N.USER_NOTIFICATION]=function(E,I,S){S&&(L[N.USER_NOTIFICATION]=!0,S&&R.publish(O.Listener,T.UserAction.UserNotification,{RID:E,VERSION:I,META:S}))},e[N.IMPORT]=function(E,I,S){S&&(L[N.IMPORT]=!0,S[N.REPLACE_SPREADSHEET]&&R.publish(O.Listener,T.DocAction.IMPORT.REPLACE_SPREADSHEET,{RID:E,VERSION:I,IMPORT:S[N.REPLACE_SPREADSHEET]}),S[N.REPLACE_CURRENTSHEET]&&R.publish(O.Listener,T.DocAction.IMPORT.REPLACE_CURRENTSHEET,{RID:E,VERSION:I,IMPORT:S[N.REPLACE_CURRENTSHEET]}))},e[N.DOC_SETTINGS]=function(E,I,S){if(S){L[N.DOC_SETTINGS]=!0;var D=S[N.DOCUMENT_LOCALE];R.publish(O.Listener,T.DocMeta.DOC_SETTINGS,{RID:E,VERSION:I,DOC_SETTINGS:S}),R.publish(O.Listener,T.DocMeta.DOCUMENT_LOCALE,{RID:E,LANGUAGE:D[N.LANGUAGE],COUNTRY:D[N.COUNTRY],THOUSAND_SEPARATOR:D[N.THOUSAND_SEPARATOR],DECIMAL_SEPARATOR:D[N.DECIMAL_SEPARATOR],DATE_SEPARATOR:D[N.DATE_SEPARATOR],LOCALE_DATEFORMAT:D[N.LOCALE_DATEFORMAT_TYPE],FORMATCELLS_REGIONAL:S[N.FORMATCELLS_REGIONAL],FORMATCELLS_CUSTOM:S[N.FORMATCELLS_CUSTOM]}),R.publish(O.Listener,T.SheetAction.CHARTS.UPDATE_LOCALE,{RID:E,VERSION:I,THOUSAND_SEPERATOR:D[N.THOUSAND_SEPARATOR],DECIMAL_SEPERATOR:D[N.DECIMAL_SEPARATOR]})}},e[N.REPLACE_ALL_COUNT]=function(E){void 0!=E&&(L[N.REPLACE_ALL_COUNT]=!0,R.publish(O.Listener,T.CellAction.VALUE.FIND.WRAP,{isEOS:2,replaceCount:E}))},e[N.DISCUSSION]=function(E,I,S){S[N.META]&&R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.GET,{RID:E,VERSION:I,COMMENTLIST:S[N.META]}),S[N.META]&&R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.GET_SUCCESS),S[N.ADD]&&R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.ADD,{RID:E,VERSION:I,COMMENTOBJ:S[N.ADD]}),S[N.ADD]&&(S[N.ADD][N.REPLY]?R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.ADD_REPLY_SUCCESS,{RID:E,R_ID:S[N.ADD][N.REPLY][N.R_ID],VERSION:I,ACTION:N.ADD_REPLY,COMMENTID:S[N.ADD][N.REPLY][N.ID],PARENTID:S[N.ADD][N.ID],OWNERID:S[N.ADD][N.REPLY][N.OWNER_ID],STATE:S[N.ADD][N.REPLY][N.ACTION_TYPE]}):R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.ADD_SUCCESS,{RID:E,VERSION:I,ACTION:N.ADD,COMMENTID:S[N.ADD][N.ID],PARENTID:S[N.ADD][N.ID],OWNERID:S[N.ADD][N.OWNER_ID]})),S[N.DELETE]&&(R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.DELETE,{RID:E,VERSION:I,COMMENTID:S[N.DELETE][N.ALL]?"all":S[N.DELETE][N.ID]}),R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.DELETE_SUCCESS,{RID:E,VERSION:I,ACTION:N.DELETE,COMMENTID:S[N.DELETE][N.ALL]?"all":S[N.DELETE][N.ID]})),S[N.DELETE_REPLY]&&(R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.DELETE,{RID:E,VERSION:I,COMMENTID:S[N.DELETE_REPLY][N.REPLY][N.ID]}),R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.DELETE_REPLY_SUCCESS,{RID:E,VERSION:I,ACTION:N.DELETE_REPLY,COMMENTID:S[N.DELETE_REPLY][N.REPLY][N.ID],PARENTID:S[N.DELETE_REPLY][N.ID]})),S[N.MODIFY]&&R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.UPDATE,{RID:E,VERSION:I,COMMENTOBJ:S[N.MODIFY]}),S[N.MODIFY]&&R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.UPDATE_SUCCESS,{RID:E,VERSION:I,ACTION:N.MODIFY,COMMENTID:S[N.MODIFY][N.REPLY]?S[N.MODIFY][N.REPLY][N.ID]:S[N.MODIFY][N.ID]}),S[N.DISCUSSION_LIKE]&&(S[N.DISCUSSION_LIKE][N.LIKES][N.STATE]?(R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.LIKE,{RID:E,VERSION:I,COMMENTOBJ:S[N.DISCUSSION_LIKE]}),R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.LIKE_SUCCESS,{RID:E,VERSION:I,ACTION:N.DISCUSSION_LIKE,PARENTID:S[N.DISCUSSION_LIKE][N.ID],COMMENTID:S[N.DISCUSSION_LIKE][N.ID],LIKES:S[N.DISCUSSION_LIKE][N.LIKES]})):(R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.UNLIKE,{RID:E,VERSION:I,COMMENTOBJ:S[N.DISCUSSION_LIKE]}),R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.UNLIKE_SUCCESS,{RID:E,VERSION:I,ACTION:N.MODIFY,ACTION:N.DISCUSSION_UNLIKE,PARENTID:S[N.DISCUSSION_LIKE][N.ID],COMMENTID:S[N.DISCUSSION_LIKE][N.ID],LIKES:S[N.DISCUSSION_LIKE][N.LIKES]}))),S[N.DISCUSSION_LIKE_REPLY]&&(S[N.DISCUSSION_LIKE_REPLY][N.REPLY][N.LIKES][N.STATE]?(R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.LIKE,{RID:E,VERSION:I,COMMENTOBJ:S[N.DISCUSSION_LIKE_REPLY]}),R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.LIKE_REPLY_SUCCESS,{RID:E,VERSION:I,ACTION:N.DISCUSSION_LIKE_REPLY,PARENTID:S[N.DISCUSSION_LIKE_REPLY][N.ID],COMMENTID:S[N.DISCUSSION_LIKE_REPLY][N.REPLY][N.ID],LIKES:S[N.DISCUSSION_LIKE_REPLY][N.REPLY][N.LIKES]})):(R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.UNLIKE,{RID:E,VERSION:I,COMMENTOBJ:S[N.DISCUSSION_LIKE_REPLY]}),R.publish(O.Listener,T.UserAction.REVIEW_COMMENTS.UNLIKE_REPLY_SUCCESS,{RID:E,VERSION:I,ACTION:N.DISCUSSION_UNLIKE_REPLY,PARENTID:S[N.DISCUSSION_LIKE_REPLY][N.ID],COMMENTID:S[N.DISCUSSION_LIKE_REPLY][N.REPLY][N.ID],LIKES:S[N.DISCUSSION_LIKE_REPLY][N.REPLY][N.LIKES]})))},e[N.DELUGE_FUNCTIONS]=function(E,I,S){S&&(L[N.DELUGE_FUNCTIONS]=!0,S[N.META]&&R.publish(O.Listener,T.DocMeta.DELUGE_FUNCTIONS,{RID:E,VERSION:I,DELUGE:S[N.META]}),S[N.INSERT]&&R.publish(O.Listener,T.DocAction.DELUGE_FUNCTIONS.INSERT,{RID:E,VERSION:I,DELUGE:S[N.INSERT]}),S[N.MODIFY]&&R.publish(O.Listener,T.DocAction.DELUGE_FUNCTIONS.MODIFY,{RID:E,VERSION:I,DELUGE:S[N.MODIFY]}),S[N.DELETE]&&R.publish(O.Listener,T.DocAction.DELUGE_FUNCTIONS.REMOVE,{RID:E,VERSION:I,DELUGE:S[N.DELETE]}))},e[N.FORCED_REFRESH_TILE]=function(E,I,S){S&&R.publish(O.Listener,T.DocMeta.FORCED_REFRESH_TILE,{RID:E,VERSION:I})},E.ZSResponseParser.ParseDocMeta=I}(this);
!function(E){function e(E){for(var e in E)UNPROCESSED[e]||UNPROCESSED_ELEMENTS.push(e)}function S(E,e,S,R){A.publish(O.Listener,i.Browser.UIRefresh,{RID:E,SHEETID:e,VERSION:S,data:R})}function R(R,I,D,T,n){UNPROCESSED[L.SHEET_META]=!0;for(var s in T){var r=T[s];A.publish(O.Listener,i.Parser.SHEET.ONBEFORE,{RID:R,SHEETID:s,VERSION:I,data:r}),!t.isLServer&&N[L.ZOOM](R,s,I,D,r[L.ZOOM],n),N[L.ROW_HEADERS](R,s,I,D,r[L.ROW_HEADERS]),N[L.COLUMN_HEADERS](R,s,I,D,r[L.COLUMN_HEADERS]),N[L.COLUMN_LEVEL_CELLSTYLES](R,s,I,r[L.COLUMN_LEVEL_CELLSTYLES]),N[L.FREEZE_PANES](R,s,I,r[L.FREEZE_PANES]),N[L.HIDDEN_ROWS](R,s,I,r[L.HIDDEN_ROWS]),N[L.HIDDEN_COLS](R,s,I,r[L.HIDDEN_COLS]),N[L.MERGE_CELLS](R,s,I,r[L.MERGE_CELLS]),N[L.MERGE_ACROSS](R,s,I,r[L.MERGE_ACROSS]),N[L.ARRAY_FORMULAS](R,s,I,r[L.ARRAY_FORMULAS]),N[L.DATAVALIDATION](R,s,I,r[L.DATAVALIDATION]),N[L.CONDITIONALFORMAT](R,s,I,r[L.CONDITIONALFORMAT]),N[L.PROTECTED_RANGES](R,s,I,r[L.PROTECTED_RANGES]),N[L.CHECK_BOX](R,s,I,r[L.CHECK_BOX]),N[L.FORM_RANGE](R,s,I,r[L.FORM_RANGE]),N[L.HIDE_GRID](R,s,I,r[L.HIDE_GRID]),N[L.IMAGE](R,s,I,r[L.IMAGE],D),N[L.FILTER_DETAILS](R,s,I,r[L.FILTER_DETAILS]),N[L.CHART](R,s,I,r[L.CHART],n),N[L.RANGE_HIGHLIGHT](R,s,I,r[L.RANGE_HIGHLIGHT]),N[L.BUTTON](R,s,I,r[L.BUTTON]),N[L.SPARKLINE](R,s,I,r[L.SPARKLINE],D),N[L.ZIA](R,s,I,r[L.ZIA],D),N[L.DATACLEANSING](R,s,I,r[L.DATACLEANSING],D),!t.isLServer&&S(R,s,I,r),!t.isLServer&&N[L.ACTIVE_INFO](R,s,I,r[L.ACTIVE_INFO]),r[L.CELL_META]&&E.ZSResponseParser.ParseCellMeta&&E.ZSResponseParser.ParseCellMeta(R,s,I,D,r[L.CELL_META]),A.publish(O.Listener,i.Parser.SHEET.ONAFTER,{RID:R,SHEETID:s,VERSION:I,data:r}),e(r),N[L.MAX_USED_CELLFORMAT](R,s,I,r[L.MAX_USED_CELLFORMAT]),N[L.MAX_USED_CELL](R,s,I,r[L.MAX_USED_CELL])}}var t=E.sPlusPlus,I=E.ZSClass,D=E.ZSEvents,A=D.topic,O=D.Groups,i=D.Names,T=t.data.Defaults,n=T.MAX_ROW,s=(T.MAX_COL,E.ZSDevTools.Logger),L=E.ZSConstants.CommandConstants,N={};N[L.ZOOM]=function(e,S,R,I,D,T){if(D){var n=t.view.getActiveGridID(),s=t.view.getActiveState(n),L=s.getZoomMap(),N=L.getKeys();if(-1==N.indexOf(S)){var r=t.view.getSheetState(n,S);if(r){var o=r.getZoom(),M=D/100;L.set(S,M);var H=r.sTops[0]/o*M,h=r.sLefts[0]/o*M,C=r.sTops[1]/o*M,a=r.sLefts[1]/o*M;A.publish(O.Listener,i.SheetAction.ZOOM.OnBefore,{RID:e,SHEETID:S,VERSION:R}),A.publish(O.Listener,i.SheetAction.ZOOM.On,{RID:e,SHEETID:S,VERSION:R,ZOOM:M,sTop:H,sLeft:h,fsTop:C,fsLeft:a}),I&&E.UserAction.ScrollTo(e,S,R,h,H,a,C)}}else if(T){var u=D/100;L.set(S,u)}}},N[L.ACTIVE_INFO]=function(E,e,S,R){{var I=t.data.getWorkBook(E,S);I.getSheetObj(e)}R&&(UNPROCESSED[L.ACTIVE_INFO]=!0,A.publish(O.Listener,i.SheetMeta.ACTIVE_INFO,{RID:E,SHEETID:e,VERSION:S,data:R}))},N[L.FREEZE_PANES]=function(E,e,S,R){if(R){UNPROCESSED[L.FREEZE_PANES]=!0;var t;R[L.META]?t=R[L.META]:R[L.MODIFY]&&(t=R[L.MODIFY]);var I=t[0]>T.MAX_ROW_FREEZE?T.MAX_ROW_FREEZE:t[0],D=t[1]>T.MAX_COL_FREEZE?T.MAX_COL_FREEZE:t[1];A.publish(O.Listener,i.SheetMeta.FREEZE,{RID:E,SHEETID:e,VERSION:S,FreezedRow:I,FreezedCol:D})}},N[L.COLUMN_LEVEL_CELLSTYLES]=function(E,e,S,R){R&&(UNPROCESSED[L.COLUMN_LEVEL_CELLSTYLES]=!0,t.data.columnLevelStyleArrived=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.COLUMN_LEVEL_CELLSTYLES,{RID:E,SHEETID:e,VERSION:S,STYLENAMES:R[L.META]}),R[L.MODIFY]&&A.publish(O.Listener,i.SheetMeta.COLUMN_LEVEL_CELLSTYLES,{RID:E,SHEETID:e,VERSION:S,STYLENAMES:R[L.MODIFY]}))},N[L.ROW_HEADERS]=function(E,e,S,R,D){var T=t.data.getWorkBook(E,S);if(D){if(UNPROCESSED[L.ROW_HEADERS]=!0,D[L.META]&&A.publish(O.Listener,i.SheetMeta.ROW_HEADERS,{RID:E,SHEETID:e,VERSION:S,ROW_HEADERS:D[L.META]}),D[L.RESIZE]){var s,N,r,o=D[L.RESIZE],T=t.data.getWorkBook(E,S),M=T.getSheetObj(e);o&&(s=o[0][0],N=o[0][2]),(!T.RowStyle.getStyleDef(N)||M.Row.Visibility.getOnCount(s))&&A.publish(O.Listener,i.SheetAction.HIDEROWS.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,start:s});for(var H in o){var s=o[H][0],h=o[H][1],N=o[H][2],C=T.RowStyle.getStyleDef(N,!0);T.RowStyle.getStyleDef(N)?M.Row.Visibility.getOnCount(s,s+h-1)?A.publish(O.Listener,i.SheetAction.HIDEROWS.REMOVE,{RID:E,SHEETID:e,VERSION:S,start:s,count:h,DIMENSION:C}):A.publish(O.Listener,i.SheetAction.ROW_HEADERS.RESIZE.ENUMERATE,{RID:E,SHEETID:e,VERSION:S,xaid:R,START:s,COUNT:h,STYLENAME:N}):A.publish(O.Listener,i.SheetAction.HIDEROWS.ADD,{RID:E,SHEETID:e,VERSION:S,start:s,count:h}),r+=r}(!T.RowStyle.getStyleDef(N)||M.Row.Visibility.getOnCount(s))&&A.publish(O.Listener,i.SheetAction.HIDEROWS.ON_AFTER_ADD,{RID:E,SHEETID:e,VERSION:S,start:s,count:r})}if(D[L.INSERT]){var a=D[L.INSERT];for(var H in a){var s=a[H][0];!t.isLServer&&A.publish(O.Listener,i.SheetAction.ROW_HEADERS.ONBEFOREINSERT,{RID:E,SHEETID:e,VERSION:S,type:"ROW",start:s,count:a[H][1]}),A.publish(O.Listener,i.SheetAction.ROW_HEADERS.INSERT,{RID:E,SHEETID:e,VERSION:S,xaid:R,start:s,count:a[H][1],STYLENAME:a[H][2]})}}if(D[L.DELETE]){var u=D[L.DELETE];for(var H in u){var s=u[H][0],l=s,V=s+h-1,T=t.data.getWorkBook(E,S),_=T.getSheetObj(e),c=new I.Range(l,0,V,n),p=_.DataFilters.getIntersectedRanges(c);for(var F in p){var U=p[F].rows;for(var b in U){var P=U[b],G=P[0],f=P[1],N=P[2],g=T.RowStyle.getStyleDef(N,!0);A.publish(O.Listener,i.SheetAction.HIDEROWS.REMOVE,{RID:E,SHEETID:e,VERSION:S,start:parseInt(G),count:parseInt(f),DIMENSION:g}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.REMOVE,{RID:E,SHEETID:e,VERSION:S,RANGE:p[F],TYPE:"remove"})}}!t.isLServer&&A.publish(O.Listener,i.SheetAction.ROW_HEADERS.ONBEFOREDELETE,{RID:E,SHEETID:e,VERSION:S,type:"ROW",start:s,count:u[H][1]}),A.publish(O.Listener,i.SheetAction.ROW_HEADERS.DELETE,{RID:E,SHEETID:e,VERSION:S,xaid:R,start:s,count:u[H][1]})}}}},N[L.COLUMN_HEADERS]=function(E,e,S,R,D){if(D){if(UNPROCESSED[L.COLUMN_HEADERS]=!0,D[L.META]&&A.publish(O.Listener,i.SheetMeta.COLUMN_HEADERS,{RID:E,SHEETID:e,VERSION:S,COL_HEADERS:D[L.META]}),D[L.RESIZE]){var T,s,N,r=D[L.RESIZE],o=t.data.getWorkBook(E,S),M=o.getSheetObj(e);r&&(T=r[0][0],s=r[0][2]),(!o.ColStyle.getStyleDef(s)||M.Column.hidden.getOnCount(T))&&A.publish(O.Listener,i.SheetAction.HIDECOLS.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,start:T});for(var H in r){var T=r[H][0],h=r[H][1],s=r[H][2];if(o.ColStyle.getStyleDef(s))if(M.Column.hidden.getOnCount(T,T+h-1)){var C=o.ColStyle.getStyleDef(s);A.publish(O.Listener,i.SheetAction.HIDECOLS.REMOVE,{RID:E,SHEETID:e,VERSION:S,start:T,count:h,dimension:C})}else A.publish(O.Listener,i.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,{RID:E,SHEETID:e,VERSION:S,xaid:R,START:T,COUNT:h,STYLENAME:s});else A.publish(O.Listener,i.SheetAction.HIDECOLS.ADD,{RID:E,SHEETID:e,VERSION:S,start:T,count:h});N+=N}(!o.ColStyle.getStyleDef(s)||M.Column.hidden.getOnCount(T))&&A.publish(O.Listener,i.SheetAction.HIDECOLS.ON_AFTER_ADD,{RID:E,SHEETID:e,VERSION:S,start:T,count:N})}if(D[L.INSERT]){var a=D[L.INSERT];for(var H in a){var T=a[H][0];!t.isLServer&&A.publish(O.Listener,i.SheetAction.COLUMN_HEADERS.ONBEFOREINSERT,{RID:E,SHEETID:e,VERSION:S,type:"COLUMN",start:T,count:a[H][1]}),A.publish(O.Listener,i.SheetAction.COLUMN_HEADERS.INSERT,{RID:E,SHEETID:e,VERSION:S,xaid:R,start:T,count:a[H][1],STYLENAME:a[H][2]})}}if(D[L.DELETE]){var u=D[L.DELETE];for(var H in u){var T=u[H][0],l=T,V=T+h-1,o=t.data.getWorkBook(E,S),_=o.getSheetObj(e),c=new I.Range(0,l,n,V),p=_.DataFilters.getIntersectedRanges(c);for(var F in p){var U=p[F].rows;for(var b in U){var P=U[b],G=P[0],f=P[1],s=P[2],g=o.RowStyle.getStyleDef(s,!0);A.publish(O.Listener,i.SheetAction.HIDEROWS.REMOVE,{RID:E,SHEETID:e,VERSION:S,start:parseInt(G),count:parseInt(f),DIMENSION:g}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.REMOVE,{RID:E,SHEETID:e,VERSION:S,RANGE:p[F],TYPE:"remove"})}}!t.isLServer&&A.publish(O.Listener,i.SheetAction.COLUMN_HEADERS.ONBEFOREDELETE,{RID:E,SHEETID:e,VERSION:S,type:"COLUMN",start:T,count:u[H][1]}),A.publish(O.Listener,i.SheetAction.COLUMN_HEADERS.DELETE,{RID:E,SHEETID:e,VERSION:S,xaid:R,start:T,count:u[H][1]})}}}},N[L.HIDDEN_ROWS]=function(E,e,S,R){if(R){if(UNPROCESSED[L.HIDDEN_ROWS]=!0,R[L.META]&&s.log("Work for META"),R[L.REMOVE]){var I,D=R[L.REMOVE],T=t.data.getWorkBook(E,S);D&&(I=D[0][0]),A.publish(O.Listener,i.SheetAction.HIDEROWS.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,start:I});for(var n in D){var N=D[n][2],r=T.RowStyle.getStyleDef(N,!0);A.publish(O.Listener,i.SheetAction.HIDEROWS.REMOVE,{RID:E,SHEETID:e,VERSION:S,start:D[n][0],count:D[n][1],DIMENSION:r})}A.publish(O.Listener,i.SheetAction.HIDEROWS.ON_AFTER_REMOVE,{RID:E,SHEETID:e,VERSION:S,start:I})}if(R[L.ADD]||R[L.META]){var I,D=(t.data.getWorkBook(E,S).getSheetObj(e),R[L.ADD]?R[L.ADD]:R[L.META]),o=0;D&&(I=D[0][0]),A.publish(O.Listener,i.SheetAction.HIDEROWS.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,start:I});for(var n in D)A.publish(O.Listener,i.SheetAction.HIDEROWS.ADD,{RID:E,SHEETID:e,VERSION:S,start:D[n][0],count:D[n][1]}),o+=D[n][1];A.publish(O.Listener,i.SheetAction.HIDEROWS.ON_AFTER_ADD,{RID:E,SHEETID:e,VERSION:S,start:I,count:o})}}},N[L.HIDDEN_COLS]=function(E,e,S,R){if(R){if(UNPROCESSED[L.HIDDEN_COLS]=!0,R[L.META]&&s.log("Work for META"),R[L.REMOVE]){var I,D=t.data.getWorkBook(E,S),T=R[L.REMOVE];T&&(I=T[0][0]),A.publish(O.Listener,i.SheetAction.HIDECOLS.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,start:I});for(var n in T){var N=D.ColStyle.getStyleDef(T[n][2]);A.publish(O.Listener,i.SheetAction.HIDECOLS.REMOVE,{RID:E,SHEETID:e,VERSION:S,start:T[n][0],count:T[n][1],dimension:N})}A.publish(O.Listener,i.SheetAction.HIDECOLS.ON_AFTER_REMOVE,{RID:E,SHEETID:e,VERSION:S,start:I})}if(R[L.ADD]||R[L.META]){var I,T=R[L.ADD]?R[L.ADD]:R[L.META],r=0;T&&(I=T[0][0]),A.publish(O.Listener,i.SheetAction.HIDECOLS.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,start:I});for(var n in T)A.publish(O.Listener,i.SheetAction.HIDECOLS.ADD,{RID:E,SHEETID:e,VERSION:S,start:T[n][0],count:T[n][1]}),r+=T[n][1];A.publish(O.Listener,i.SheetAction.HIDECOLS.ON_AFTER_ADD,{RID:E,SHEETID:e,VERSION:S,start:I,count:r})}}},N[L.MERGE_CELLS]=function(E,e,S,R){R&&(UNPROCESSED[L.MERGE_CELLS]=!0,R[L.META]&&(s.log("Handle this MERGE_CELLS"),A.publish(O.Listener,i.SheetAction.MERGE_CELLS.onBeforeMerge,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.META]}),A.publish(O.Listener,i.SheetAction.MERGE_CELLS.ADD,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.META]})),R[L.REMOVE]&&(A.publish(O.Listener,i.SheetAction.MERGE_CELLS.onBeforeSplitRange,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.REMOVE]}),A.publish(O.Listener,i.SheetAction.MERGE_CELLS.REMOVE,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.REMOVE]})),R[L.ADD]&&(A.publish(O.Listener,i.SheetAction.MERGE_CELLS.onBeforeMerge,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.ADD]}),A.publish(O.Listener,i.SheetAction.MERGE_CELLS.ADD,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.ADD]})))},N[L.MERGE_ACROSS]=function(E,e,S,R){R&&(UNPROCESSED[L.MERGE_ACROSS]=!0,R[L.META]&&(A.publish(O.Listener,i.SheetAction.MERGE_ACROSS.onBeforeMergeAcross,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.META]}),A.publish(O.Listener,i.SheetAction.MERGE_ACROSS.ADD,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.META]})),R[L.ADD]&&(A.publish(O.Listener,i.SheetAction.MERGE_ACROSS.onBeforeMergeAcross,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.ADD]}),A.publish(O.Listener,i.SheetAction.MERGE_ACROSS.ADD,{RID:E,SHEETID:e,VERSION:S,MergeList:R[L.ADD]})))},N[L.ARRAY_FORMULAS]=function(E,e,S,R){R&&(UNPROCESSED[L.ARRAY_FORMULAS]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.ARRAY_FORMULAS,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.META]}),R[L.REMOVE]&&A.publish(O.Listener,i.SheetAction.ARRAY_FORMULAS.REMOVE,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.REMOVE]}),R[L.ADD]&&A.publish(O.Listener,i.SheetAction.ARRAY_FORMULAS.ADD,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.ADD]}))},N[L.DATAVALIDATION]=function(E,e,S,R){R&&(UNPROCESSED[L.DATAVALIDATION]=!0,R[L.REMOVE]&&A.publish(O.Listener,i.SheetAction.DATAVALIDATION.REMOVE,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.REMOVE]}),R[L.META]&&A.publish(O.Listener,i.SheetMeta.DATAVALIDATION,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.META]}),R[L.ADD]&&A.publish(O.Listener,i.SheetAction.DATAVALIDATION.ADD,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.ADD]}))},N[L.CONDITIONALFORMAT]=function(E,e,S,R){R&&(UNPROCESSED[L.CONDITIONALFORMAT]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.CONDITIONALFORMAT,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.META]}),R[L.REMOVE]&&A.publish(O.Listener,i.SheetAction.CONDITIONALFORMAT.REMOVE,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.REMOVE]}),R[L.ADD]&&A.publish(O.Listener,i.SheetAction.CONDITIONALFORMAT.ADD,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.ADD]}))},N[L.PROTECTED_RANGES]=function(E,e,S,R){R&&(UNPROCESSED[L.PROTECTED_RANGES]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.PROTECTED_RANGES,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.META]}),R[L.REMOVE]&&A.publish(O.Listener,i.SheetAction.PROTECTED_RANGES.REMOVE,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.REMOVE]}),R[L.MODIFY]&&A.publish(O.Listener,i.SheetAction.PROTECTED_RANGES.MODIFY,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.MODIFY]}))},N[L.CHECK_BOX]=function(E,e,S,R){R&&(UNPROCESSED[L.CHECK_BOX]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.CHECK_BOX,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.META]}),R[L.REMOVE]&&A.publish(O.Listener,i.SheetAction.CHECK_BOX.REMOVE,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.REMOVE]}),R[L.ADD]&&A.publish(O.Listener,i.SheetAction.CHECK_BOX.ADD,{RID:E,SHEETID:e,VERSION:S,RangeList:R[L.ADD]}))},N[L.FILTER_DETAILS]=function(E,e,S,R){if(R){R=R[0];var D,T=t.data.getWorkBook(E,S).getSheetObj(e),s=T.Row.Filter,N=T.Row.Filter.nextHidden(0),r=T.DataFilters,o=r.getAllRanges();for(var M in o){var H=o[M];D=new I.Range(H.startRow,H.startCol,H.endRow,H.endCol)}var h=R[L.FILTER_RANGE],C=h;if(!R[L.TOGGLE_FILTER]||(D&&(N!==n&&A.publish(O.UserAction,i.SheetAction.DATAFILTER.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,FROWS:[],FACOLS:[],FRANGE:D}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.ONBEFOREAPPLY,{RID:E,SHEETID:e,VERSION:S,FROWS:[],FACOLS:[],FRANGE:D}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.SETCRITERIA,{RID:E,SHEETID:e,VERSION:S,FROWS:[],FACOLS:[],FRANGE:D}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.REMOVE,{RID:E,SHEETID:e,VERSION:S,RANGE:D,TYPE:"remove"})),h)){if(!h){if(!C)return;return void A.publish(O.UserAction,i.SheetAction.DATAFILTER.REMOVE,{RID:E,SHEETID:e,VERSION:S,RANGE:C,TYPE:"remove"})}var a=R[L.FILTERED_ROWS],u=R[L.FILTER_CRITERIA_APPLIED_COLS];h=new I.Range(h[0],h[1],h[2],h[3]);var o=r.getSubsets(h);if(a&&u){var l=new I.Hidden(n,"ROW");for(var V in a){var _=a[V][0],c=a[V][1];l.onHide(_,c)}for(var M=s.nextHidden(0),p=l.nextHidden(0);(n>M||n>p)&&M==p;)M=s.nextHidden(M),p=l.nextHidden(p);var _=Math.min(M,p);_!=n&&(N!=n||a.length>0)&&A.publish(O.UserAction,i.SheetAction.DATAFILTER.ONBEFORE,{RID:E,SHEETID:e,VERSION:S,FROWS:a,FACOLS:u,FRANGE:h}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.ONBEFOREAPPLY,{RID:E,SHEETID:e,VERSION:S,FROWS:a,FACOLS:u,FRANGE:h}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.SETCRITERIA,{RID:E,SHEETID:e,VERSION:S,FROWS:a,FACOLS:u,FRANGE:h}),A.publish(O.UserAction,i.SheetAction.DATAFILTER.ONAPPLY,{RID:E,SHEETID:e,VERSION:S,FROWS:a,FACOLS:u,FRANGE:h,START:_,TYPE:"add"})}}}},N[L.FORM_RANGE]=function(E,e,S,R){R&&(UNPROCESSED[L.FORM_RANGE]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.FORM_RANGE,{RID:E,SHEETID:e,VERSION:S,FORM_RANGE:R[L.META]}))},N[L.MAX_USED_CELL]=function(E,e,S,R){R&&(UNPROCESSED[L.MAX_USED_CELL]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.MAX_USED_CELL,{RID:E,SHEETID:e,VERSION:S,USEDROW:R[L.META][0],USEDCOL:R[L.META][1]}))},N[L.MAX_USED_CELLFORMAT]=function(E,e,S,R){R&&(UNPROCESSED[L.MAX_USED_CELLFORMAT]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.MAX_USED_FORMAT,{RID:E,SHEETID:e,VERSION:S,USEDFORMATROW:R[L.META][0],USEDFORMATCOL:R[L.META][1]}))},N[L.HIDE_GRID]=function(E,e,S,R){R&&(UNPROCESSED[L.HIDE_GRID]=!0,R[L.META]?A.publish(O.Listener,i.SheetAction.GRID_LINES.META,{RID:E,SHEETID:e,VERSION:S,SHOW_GRID:R[L.META]}):R[L.MODIFY]&&A.publish(O.Listener,i.SheetAction.GRID_LINES.MODIFY,{RID:E,SHEETID:e,VERSION:S,SHOW_GRID:R[L.MODIFY]}))},N[L.IMAGE]=function(E,e,S,R,t){R&&(UNPROCESSED[L.IMAGE]=!0,R[L.META]&&A.publish(O.Listener,i.SheetMeta.IMAGES,{RID:E,SHEETID:e,VERSION:S,IMAGES:R[L.META]}),R[L.DELETE]&&A.publish(O.Listener,i.SheetAction.IMAGES.DELETE,{RID:E,SHEETID:e,IMAGES:R[L.DELETE],VERSION:S,XAID:t}),R[L.INSERT]&&A.publish(O.Listener,i.SheetAction.IMAGES.INSERT,{RID:E,SHEETID:e,IMAGES:R[L.INSERT],VERSION:S,XAID:t}),R[L.MOVE]&&A.publish(O.Listener,i.SheetAction.IMAGES.MOVE,{RID:E,SHEETID:e,VERSION:S,IMAGES:R[L.MOVE],XAID:t}),R[L.RESIZE]&&A.publish(O.Listener,i.SheetAction.IMAGES.RESIZE,{RID:E,SHEETID:e,VERSION:S,IMAGES:R[L.RESIZE],XAID:t}),R[L.EDIT]&&A.publish(O.Listener,i.SheetAction.IMAGES.EDIT,{RID:E,SHEETID:e,IMAGES:R[L.EDIT],VERSION:S,XAID:t}))},N[L.CHART]=function(E,e,S,R,t){R&&(UNPROCESSED[L.CHART]=!0,R[L.META]?A.publish(O.Listener,i.SheetMeta.CHARTS,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.META][L.CHART_DETAILS],TSEP:R[L.META][L.THOUSAND_SEPARATOR],DSEP:R[L.META][L.DECIMAL_SEPARATOR],AOWNER:t}):R[L.INSERT]?A.publish(O.Listener,i.SheetAction.CHARTS.INSERT,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.INSERT],AOWNER:t}):R[L.MOVE]?A.publish(O.Listener,i.SheetAction.CHARTS.MOVE,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.MOVE],AOWNER:t}):R[L.RESIZE]?A.publish(O.Listener,i.SheetAction.CHARTS.RESIZE,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.RESIZE],AOWNER:t}):R[L.MODIFY]?A.publish(O.Listener,i.SheetAction.CHARTS.MODIFY,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.MODIFY],AOWNER:t}):R[L.UPDATE]?A.publish(O.Listener,i.SheetAction.CHARTS.UPDATE,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.UPDATE],AOWNER:t}):R[L.EDIT]?A.publish(O.Listener,i.SheetAction.CHARTS.EDIT,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.EDIT],AOWNER:t}):R[L.DELETE]?A.publish(O.Listener,i.SheetAction.CHARTS.DELETE,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.DELETE],AOWNER:t}):R[L.PUBLISH]?A.publish(O.Listener,i.SheetAction.CHARTS.PUBLISH,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.PUBLISH],AOWNER:t}):R[L.UNPUBLISH]?A.publish(O.Listener,i.SheetAction.CHARTS.UNPUBLISH,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.UNPUBLISH],AOWNER:t}):R[L.RENAME]&&A.publish(O.Listener,i.SheetAction.CHARTS.RENAME,{RID:E,SHEETID:e,VERSION:S,CHARTS:R[L.RENAME],AOWNER:t}))},N[L.RANGE_HIGHLIGHT]=function(E,e,S,R){R&&(UNPROCESSED[L.RANGE_HIGHLIGHT]=!0,R&&A.publish(O.UserAction,i.UserAction.RANGE_HIGHLIGHT,{RID:E,SHEETID:e,VERSION:S,DATA:R}))},N[L.SPARKLINE]=function(E,e,S,R){R&&(UNPROCESSED[L.SPARKLINE]=!0,R[L.META]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.GROUP,{RID:E,SHEETID:e,VERSION:S,GROUP:R[L.META]}),R[L.ADD]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.INSERT,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.ADD][0]}),R[L.EDIT_GROUP]&&(A.publish(O.Listener,i.SheetAction.SPARKLINES.EDIT_GROUP,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.EDIT_GROUP][0]}),A.publish(O.Listener,i.SheetAction.SPARKLINES.GROUP,{RID:E,SHEETID:e,VERSION:S,GROUP:R[L.EDIT_GROUP][0]}),A.publish(O.Listener,i.SheetAction.SPARKLINES.INSERT,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.EDIT_GROUP][1]})),R[L.REMOVE]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.REMOVE,{RID:E,SHEETID:e,VERSION:S,REMOVE:R[L.REMOVE]}),R[L.EDIT]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.DATA,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.DATA]}),R[L.MODIFY]&&(A.publish(O.Listener,i.SheetAction.SPARKLINES.PROPERTIES,{RID:E,SHEETID:e,VERSION:S,PROPS:R[L.MODIFY]}),A.publish(O.Listener,i.SheetAction.SPARKLINES.MODIFY,{RID:E,SHEETID:e,VERSION:S,PROPS:R[L.MODIFY]})),R[L.GROUP]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.MODIFY,{RID:E,SHEETID:e,VERSION:S,PROPS:R[L.GROUP][0]}),R[L.DATA]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.DATA,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.DATA]}),R[L.EXTREMES]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.EXTREMES,{RID:E,SHEETID:e,VERSION:S,EXTREMES:R[245]}),R[L.UNDO]&&A.publish(O.Listener,i.SheetAction.SPARKLINES.UNDO,{RID:E,SHEETID:e,VERSION:S,META:R[L.UNDO]}))},N[L.BUTTON]=function(E,e,S,R,t){R&&(UNPROCESSED[L.BUTTON]=!0,R&&(R[L.META]&&A.publish(O.Listener,i.SheetMeta.BUTTONS,{RID:E,SHEETID:e,VERSION:S,BUTTONS:R[L.META]}),R[L.DELETE]&&A.publish(O.Listener,i.SheetAction.BUTTONS.DELETE,{RID:E,SHEETID:e,VERSION:S,BUTTONS:R[L.DELETE],XAID:t}),R[L.INSERT]&&A.publish(O.Listener,i.SheetAction.BUTTONS.INSERT,{RID:E,SHEETID:e,VERSION:S,BUTTONS:R[L.INSERT],XAID:t}),R[L.MOVE]&&A.publish(O.Listener,i.SheetAction.BUTTONS.MOVE,{RID:E,SHEETID:e,VERSION:S,BUTTONS:R[L.MOVE],XAID:t}),R[L.RESIZE]&&A.publish(O.Listener,i.SheetAction.BUTTONS.RESIZE,{RID:E,SHEETID:e,VERSION:S,BUTTONS:R[L.RESIZE],XAID:t}),R[L.MODIFY]&&A.publish(O.Listener,i.SheetAction.BUTTONS.MODIFY,{RID:E,SHEETID:e,VERSION:S,BUTTONS:R[L.MODIFY],XAID:t})))},N[L.ZIA]=function(E,e,S,R){R&&R[L.ZIA_AFFECTED_HOLDERS]&&A.publish(O.UI,i.SidePanel.ZIA.SYNC_AFFECTED,{RID:E,SHEETID:e,VERSION:S,HOLDERS:R[L.ZIA_AFFECTED_HOLDERS]})},N[L.DATACLEANSING]=function(E,e,S,R){R&&(UNPROCESSED[L.DATACLEANSING]=!0,R[L.DC_AFFECTED_COLS]?A.publish(O.Listener,i.UserAction.DATACLEANING.REFRESH,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.DC_AFFECTED_COLS]}):R[L.DC_HIGHLIGHT]&&A.publish(O.Listener,i.UserAction.DATACLEANING.HIGHLIGHT,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.DC_HIGHLIGHT]}),R[L.REPLACE_ALL_COUNT]&&A.publish(O.Listener,i.UserAction.DATACLEANING.COUNT,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.REPLACE_ALL_COUNT]}),R[L.DATA_DUPLICATES]&&A.publish(O.Listener,i.UserAction.DATA_DUPLICATE.COUNT,{RID:E,SHEETID:e,VERSION:S,DATA:R[L.DATA_DUPLICATES]}))},E.ZSResponseParser.ParseSheetMeta=R}(this);
!function(e){function t(e,t,E){S.view.getActiveGridID(),E[A.ACTIVESHEET_NAME];s.publish(n.Listener,I.DocMeta.ACTIVE_SHEET,{RID:e,VERSION:t,ACTIVE_SHEET:E[A.ACTIVESHEET_NAME]})}function E(t,E,a,i){var D=i[A.ACTIVE_CELL],R=i[A.ACTIVE_RANGES]?i[A.ACTIVE_RANGES]:[[D[0],D[1],D[0],D[1]]],T=new o.Range(D[0],D[1],D[0],D[1]),l=new o.Range(R[0][0],R[0][1],R[0][2],R[0][3]),r=S.data.getWorkBook(t,a),N=r.getSheetObj(E),c=N.Row.auxiliaryAxis.getPos(R[0][0]),C=N.Column.axis.getPos(R[0][1]);s.publish(n.Selector.BoundUpdate.Range,I.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:E,VERSION:a,RANGE:l}),s.publish(n.Selector.BoundUpdate.Range,I.Selection.BOUND_UPDATE.ADDRANGES,{RID:t,SHEETID:E,VERSION:a,RANGES:R}),s.publish(n.Selector.BoundUpdate.Cell,I.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:E,VERSION:a,ActiveCellRange:T,ROW:T.startRow,COL:T.startCol});var u=i[A.PERSISTED_POSITIONS];u?(u[1]||(u[1]=[0,0]),e.UserAction.ScrollTo(t,E,a,u[0][1],u[0][0],u[1][1],u[1][0])):e.UserAction.ScrollTo(t,E,a,Math.max(0,C-100),Math.max(0,c-100),0,0)}var S=e.sPlusPlus,o=e.ZSClass,a=e.ZSEvents,s=a.topic,n=a.Groups,I=a.Names,A=e.ZSConstants.CommandConstants;s.register(n.Listener,I.DocMeta.ACTIVE_INFO,t,"RID","VERSION","DATA"),s.register(n.Listener,I.SheetMeta.ACTIVE_INFO,E,"RID","SHEETID","VERSION","data")}(this);
!function(E){var _=1e4;E.ZSConstants.URI={ARRAY_FORMULAS_ADD:_++,ARRAY_FORMULAS_REMOVE:_++,FETCHDATAAPI:_++,CellRangeStatus:_++,COLUMN_HEADERS_RESIZE:_++,COLUMN_HEADERS_INSERT:_++,COLUMN_HEADERS_DELETE:_++,COLUMN_HEADERS_INSERT_CUT:_++,COLUMN_HEADERS_INSERT_COPY:_++,COPY:_++,CUT:_++,COPY_PASTE:_++,CUT_PASTE:_++,COPY_PASTE_CONTENT:_++,DATAVALIDATION_ADD:_++,DATA_VALIDATION_CLEAR:_++,DATA_VALIDATION_READRANGE:_++,DOCUMENT_RENAME:_++,DOCUMENT_FAVORATE:_++,FILL_SERIES:_++,FILL_SERIES_AUTO:_++,FILTER_REMOVE:_++,FILTER_REAPPLY:_++,FORMAT_MODIFY:_++,FREEZE_MODIFY:_++,HIDEROWS_ADD:_++,HIDEROWS_REMOVE:_++,HIDECOLS_ADD:_++,HIDECOLS_REMOVE:_++,INIT_I18N_SESSION:_++,MERGE_CELLS_ADD:_++,MERGE_CELLS_REMOVE:_++,ROW_HEADERS_RESIZE:_++,ROW_HEADERS_INSERT:_++,ROW_HEADERS_DELETE:_++,ROW_HEADERS_INSERT_CUT:_++,ROW_HEADERS_INSERT_COPY:_++,FIND:_++,REPLACE:_++,NAMED_RANGE_ADD:_++,NAMED_RANGE_DELETE:_++,NAMED_RANGE_MODIFY:_++,GET_NAMED_RANGES:_++,REPLACE_ALL:_++,WORKSHEETS_INSERT:_++,WORKSHEETS_DELETE:_++,WORKSHEETS_MOVE:_++,WORKSHEETS_RENAME:_++,WORKSHEETS_TABCOLOR:_++,WORKSHEETS_COPYSHEET:_++,WORKSHEETS_PASTESHEET:_++,WORKSHEETS_SERVERCOPYSHEET:_++,WORKSHEETS_COPY_TO_NEW_SPREADSHEET:_++,HIDE_GRID:_++,SUBMIT:_++,ACTIVE_SHEET_SWITCH:_++,UNDO:_++,REDO:_++,TILE:_++,MERGETILE:_++,VIEWPORT:_++,REREGISTER_VIEWPORT:_++,ViewPort:_++,CachedViewPort:_++,COLLAB_INFO:_++,COLLAB_JOIN:_++,COLLAB_USER_EDIT:_++,responseManager:_++,HANDLE_ERROR_RESPONSE:_++,SYNC_CHECK:_++,LOADINGVAR:_++,PROCESSRESPONSE:_++,SYNCCOLLABUSER:_++,RELOADPAGE:_++,POST_DOC_LOAD:_++,SHARE_PERMISSION_CHANGE:_++,CHECKIN_CHECKOUT:_++,DEFERRED_FETCH_DATA:_++,VERSION_FETCH_DATA:_++,RECALCULATE:_++,SORT_RANGE:_++,HYPERLINK:_++,PICK_LIST:_++,CELL_COMMENT:_++,NUMBER_FORMAT_MODIFY:_++,CELL_INSERT:_++,CELL_DELETE:_++,EXPIRECLIP:_++,DELETE_GRID:_++,GET_DATA_INFO:_++,IMAGE_MOVE:_++,IMAGE_RESIZE:_++,IMAGE_REMOVE:_++,IMAGE_SAVE:_++,IMAGE_ROTATE:_++,IMAGE_REPLACE:_++,IMAGE_CLONE:_++,IMAGE_DRAG_DROP:_++,IMAGE_NEW:_++,GOALSEEK:_++,SOLVER:_++,LOCK_RANGE_ADD:_++,UNLOCK_RANGE:_++,LOCK_SHEET:_++,UNLOCK_SHEET:_++,LOCK_MULTIPLE:_++,READ_PROTECTED_RANGES:_++,READ_PROTECTED_SHEETS:_++,PROTECT_RANGE_DIALOG:_++,CREATE_FILTER:_++,APPLYFILTER:_++,FILTERBYVALUE:_++,GETFILTERDATA:_++,GETFILTERINFO:_++,USER_PRESENCE:_++,COLAB_USER_EDIT:_++,DYNAMIC_REQUEST:_++,DATA_HIGHLIGHT_INVALID:_++,TEXTTOCOLUMNS_APPLY:_++,VALIDATE_INPUT:_++,CTRL_NAVIGATION:_++,DRAG_DROP:_++,AUTO_SUM:_++,GET_ACTION_LIST:_++,CLEAR_ACTION_LIST:_++,GET_VERSION_ACTION_LIST:_++,GET_VERSION_DETAILS:_++,RENAME_VERSION:_++,REVERT_VERSION:_++,DELETE_VERSION:_++,AUDIT_FILTER_BY_SHEET:_++,AUDIT_FILTER_BY_RANGE:_++,AUDIT_FILTER_BY_DATE:_++,FORM_CREATE:_++,FORM_DELETE:_++,FORM_PUBLISH:_++,SORT_DETAILS:_++,SAVEAS:_++,DOCUMENT_SETTING:_++,SPREADSHEET_PROPERTIES:_++,CREATE_VERSION:_++,GET_TEMPLATES:_++,USE_TEMPLATE:_++,SAVE_AS_TEMPLATE:_++,RENAME_TEMPLATE:_++,DELETE_TEMPLATE:_++,DUPLICATE_SHEET:_++,VALIDATE_INPUT_CF:_++,COLOR_SCALES_APPLY:_++,CONDITIONAL_FORMAT_CLEAR_RULE:_++,CONDITIONAL_FORMAT_READ_DATATYPE:_++,CONDITIONAL_FORMAT_APPLY:_++,CONDITIONAL_FORMAT_READ_RANGE:_++,CONDITIONAL_FORMAT_READ_SHEET:_++,CONDITIONAL_FORMAT_READ_WORKBOOK:_++,CONDITIONAL_STYLE_REORDER:_++,CONDITIONAL_FORMAT_EDIT:_++,CONDITIONAL_FORMAT_DELETE:_++,IMPORT:_++,IMPORT_CREATE_NEW:_++,IMPORT_REPLACE_SPREADSHEET:_++,IMPORT_INSERT_AS_NEW_SHEETS:_++,IMPORT_REPLACE_CURRENTSHEET:_++,IMPORT_APPEND_ROWS_TO_CURRENTSHEET:_++,IMPORT_REPLACE_DATA_STARTING_AT_CELL:_++,GET_FILE_CONTENT_FROM_URL:_++,DEFERRED_LOCLAE_INFO:_++,DETECT_PIVOT_RANGE:_++,READ_PIVOT_FIELDS:_++,READ_PIVOT_FILTER_DATA:_++,CREATE_PIVOT:_++,EDIT_PIVOT:_++,CHANGE_PIVOT_SOURCE:_++,MOVE_PIVOT:_++,COPY_PIVOT:_++,REFRESH_PIVOT:_++,REFRESH_ALL_PIVOT:_++,CHANGE_PIVOT_THEME:_++,CHANGE_PIVOT_SUBTOTALOPTION:_++,CHANGE_PIVOT_GRANDTOTALROWOPTION:_++,CHANGE_PIVOT_GRANDTOTALCOLOPTION:_++,DELETE_PIVOT:_++,APPLYFILTER_PIVOT:_++,CHANGE_DISPLAYINFO_PIVOT:_++,SORT_PIVOT:_++,CHART_RESIZE:_++,CHART_MOVE:_++,CHART_DETAILS:_++,CHART_PREVIEW:_++,CHART_NEW:_++,CHART_EDIT:_++,CHART_DELETE:_++,CHART_QUICK_EDIT:_++,CHART_QUICK_STYLE:_++,CHART_MOVE_TO_NEW_SHEET:_++,CHART_COPY_STYLE:_++,CHART_PASTE_STYLE:_++,CHART_PUBLISH:_++,CHART_UNPUBLISH:_++,CHART_REFRESH:_++,ADD_CHART_TO_IMAGE_LIBRARY:_++,MOVE_CELL_COMMENT:_++,GET_CHART_RECOMMENDATION:_++,SPREADSHEET_PUBLISH:_++,SPREADSHEET_PUBLISH_OPTION_CHANGE:_++,SPREADSHEET_PUBLISH_TYPE_CHANGE:_++,ICON_SET_APPLY:_++,DATA_VALIDATION_READWORKBOOK:_++,DATA_VALIDATION_READSHEET:_++,DATA_VALIDATION_READLIST:_++,COLLAB_USERS_INFO:_++,FETCH_DOCUMENTSETTINGS:_++,SYSTEMCLIP_PASTE:_++,PRINT_PREVIEW:_++,WEB_DATA:_++,GET_HTML_WEBDATA:_++,CREATE_MACRO:_++,RECORD_MACRO:_++,CANCEL_RECORDING_MACRO:_++,STOP_RECORDING_MACRO:_++,GET_MACRO_LIST:_++,RUN_MACRO:_++,DELETE_MACRO:_++,MACRO_EDITOR_INFO:_++,TEXTTOCOLUMNS_DELIMITERS:_++,WEBDATA_LIST:_++,UPDATE_WEB_DATA:_++,SAVE_MACRO:_++,SAVE_AND_RUN_MACRO:_++,RUN_MACRO_BY_LINE_NUMBER:_++,PULL_MACRO_CONTENT:_++,RANGE_PUBLISH:_++,UPDATE_RANGE_PUBLISH:_++,GET_PUBLISHED_RANGES:_++,CHANGE_RANGEPUBLISH_TYPE:_++,COLLAB_CHAT:_++,COLLAB_GETCHAT:_++,BUTTON_ADD:_++,BUTTON_CLONE:_++,BUTTON_DELETE:_++,BUTTON_MOVE:_++,BUTTON_RESIZE:_++,BUTTON_SETCAPTION:_++,BUTTON_ASSIGNMACRO:_++,PICK_LIST_RANGE:_++,REDIRECT_ROPEN:_++,HIDE_SHEET:_++,DELUGE_CREATE:_++,DELUGE_UPDATE:_++,DELUGE_EXECUTE:_++,DELUGE_GETALL:_++,DELUGE_GETDETAIL:_++,DELUGE_DELETE:_++,DELUGE_CREATEANDEXECUTE:_++,DELUGE_UPDATEANDEXECUTE:_++,DELUGE_GETNAME:_++,SPARKLINE_CREATE:_++,SPARKLINE_REMOVE:_++,SPARKLINE_GROUP_REMOVE:_++,SPARKLINE_PROPERTIES:_++,SPARKLINE_DATA:_++,CHANGE_SPARKLINE_ORIENTATION:_++,EDIT_SPARKLINE_DATA:_++,SPARKLINE_GROUP:_++,SPARKLINE_UNGROUP:_++,EDIT_SPARKLINE_GROUP_DATA:_++,ZIA_OPEN:_++,ZIA_CLOSE:_++,ZIA_SAVE:_++,ZIA_SYNC:_++,ZIA_REFRESH:_++,NL_QUERY:_++,ZIA_RECONNECT:_++,ZIA_PRIORITY_HEADER:_++,ZIA_FILTER_HEADER:_++,ZIA_RESET:_++,SAVE_TO_MY_ACCOUNT:_++,CHECKIN_CHECKOUT_SPREADSHEET:_++,FETCH_REVIEW_COMMENTS:_++,FETCH_DECLARATIVE_TABLE:_++,DETECT_TABLE:_++,ZIA_RECOMMEND_QUERIES:_++,ADD_REVIEW_COMMENT:_++,FETCH_DECLARATIVE_TABLE:_++,DELETE_REVIEW_COMMENT:_++,UPDATE_REVIEW_COMMENT:_++,ADD_REVIEW_COMMENT_REPLY:_++,DELETE_REVIEW_COMMENT_REPLY:_++,UPDATE_REVIEW_COMMENT_REPLY:_++,RESOLVE_REVIEW_COMMENT:_++,REOPEN_REVIEW_COMMENT:_++,LIKE_REVIEW_COMMENT:_++,UNLIKE_REVIEW_COMMENT:_++,LIKE_REVIEW_COMMENT_REPLY:_++,UNLIKE_REVIEW_COMMENT_REPLY:_++,DELETE_ALL_REVIEW_COMMENT:_++,REVIEW_COMMENT_UPDATE_DOC_CLOSEDTIME:_++,REVIEW_COMMENT_NOTIFICATION_SETTINGS:_++,UNHIDE_SHEET:_++,RECAST:_++,EXPORT_TO_CLOUD_DRIVES:_++,REQUEST_BANNER:_++,SERVERCLIP_GET_REFSHEETS:_++,ZOOM:_++,EXPORT_DOCUMENT:_++,GRID_VIEW:_++,DC_CLUSTER:_++,DC_CLUSTER_REPLACE_ALL:_++,DC_EMPTY_CELLS_COUNT:_++,DC_FILL_EMPTY_CELLS:_++,USER_ANNOUNCEMENT:_++,READ_DATA_DUPLICATES:_++,GET_DATA_DUPLICATES:_++,DATA_DUPLICATES_INFO:_++,CHANGE_DOC_STATUS:_++,GET_NEWLY_ADDED_USER:_++,SYNC_STYLE:_++}}(this);
!function(e){function t(e){var t=v.querySelector("#"+e);return t&&t.classList.contains("ui-zmenu")}function n(e){e.callback()}function i(e,i){t(e)?n(i):r(e,i)}function o(e){var t=f[e];if(t){var i=Object.keys(t);for(var o in i){var r=i[o],c=t[r];for(var a in c){var u=c[a];n(u),delete c[a]}delete i[o]}delete f[e]}}function r(e,t){var n=t.item,i=t.action;f[e]||(f[e]={}),f[e][n]||(f[e][n]={}),f[e][n][i]=t}var c=(e.sPlusPlus,e.UIUtil.Component),a=e.ZSEvents,u=a.topic,s=a.Groups,l=a.Names,v=document.getElementById("TB_LEFT_CONTAINER"),f={};u.register(s.UI,l.Toolbar.INIT_MENU,o,"DOM"),c.doMenuAction=i}(this);
!function(t){function n(t,n){return!1}{var o=(t.sPlusPlus,t.document,t.UIUtil.Component),e=t.ZSEvents;e.topic,e.Groups,e.Names,document.getElementById("TB_COMPONENTS")}o.doToolbarAction=n}(this);
!function(a){var e=a.sPlusPlus,t=a.ZSEvents,r=t.topic,s=t.Groups,o=t.Names,i=a.ZSClass,n=e.data.api,I=a.JSUtil;n.LoadingVar=function(t){t.csrfParamName&&(e.data.PageRegistry.csrfParamName=t.csrfParamName),t.csrfToken&&(e.data.PageRegistry.csrfToken=t.csrfToken),t.ctxpath&&(e.data.AppRegistry.ctxpath=t.ctxpath),t.docCtxPath&&(e.data.PageRegistry.docCtxPath=t.docCtxPath),t.authtoken&&(e.data.UserInfo.authtoken=t.authtoken),t.ZUID&&(e.data.UserInfo.zuid=t.ZUID),t.loginName&&(e.data.UserInfo.loginName=t.loginName),e.data.UserInfo.isLoggedIn=t.isLoggedIn,t.loginEmailId&&(e.data.UserInfo.loginEmailId=t.loginEmailId),t.locale&&(e.data.UserInfo.locale=t.locale),t.buildVersion&&(e.data.AppRegistry.buildVersion=t.buildVersion),t.ZOID&&(e.data.UserInfo.zoid=t.ZOID),t.ORG_NAME&&(e.data.UserInfo.orgName=t.ORG_NAME),t.gadgetUrl&&(e.data.AppRegistry.gadgetUrl=t.gadgetUrl),t.rebrandProp&&I.Object.concat(e.data.AppRegistry,t.rebrandProp),t.signInUpUrl&&(e.data.AppRegistry.signInUpUrl=t.signInUpUrl),t.sheetServerURL&&(e.data.AppRegistry.sheetServerURL=t.sheetServerURL),t.ReportAbuseURL&&(e.data.AppRegistry.ReportAbuseURL=t.ReportAbuseURL),t.RMUSER&&(e.data.UserInfo.RMUSER=t.RMUSER),t.ZFSNG_PRODUCT_TYPE&&(e.data.AppRegistry.ZFSNG_PRODUCT_TYPE=t.ZFSNG_PRODUCT_TYPE),t.OWNER_ID&&(e.data.AppRegistry.OWNER_ZUID=t.OWNER_ID),!e.data.DocRegistry[t.rID]&&(e.data.DocRegistry[t.rID]={}),e.data.DocRegistry[t.rID].isNewDoc=t.isNewDoc,t.isLogsEnabled&&a.ZSDevTools&&a.ZSDevTools.Logger.enable(),t.DOCUMENT_INFO&&(!e.data.DocRegistry[t.rID]&&(e.data.DocRegistry[t.rID]={}),e.data.DocRegistry[t.rID].DOCUMENT_POINTER=t.DOCUMENT_INFO.DOCUMENT_POINTER),t.viewCount&&(!e.data.DocRegistry[t.rID]&&(e.data.DocRegistry[t.rID]={}),e.data.DocRegistry[t.rID].viewCount=t.viewCount)},n.PageInfo={UniqueTabID:function(a){e.data.PageRegistry.UT_ID=a},Collab:function(a){e.data.PageRegistry.RS_ID=a},Session:function(a){void 0!=a?(!e.data.SESSION_INFO&&(e.data.SESSION_INFO={}),e.data.SESSION_INFO.ID=a):e.data.SESSION_INFO=void 0},User:function(a){e.data.UserInfo.zuid=a,i.USRActiveInfo&&(e.data.UserInfo.activeInfo||(e.data.UserInfo.activeInfo=new i.USRActiveInfo))},Document:function(a,t){a&&(!e.data.DocRegistry[t]&&(e.data.DocRegistry[t]={}),e.data.DocRegistry[t].DOCUMENT_POINTER=a.DOCUMENT_POINTER)}},r.register(s.Listener,o.ServerAction.LOADINGVAR,n.LoadingVar,"loadingVar"),r.register(s.Listener,o.DocMeta.UNIQUE_TAB_ID,n.PageInfo.UniqueTabID,"UNIQUE_TAB_ID"),r.register(s.Listener,o.CollabAction.SESSION_INFO,n.PageInfo.Session,"SessionID"),r.register(s.Listener,o.UserMeta.USERS_METAINFO,n.PageInfo.User,"ZUID"),r.register(s.Listener,o.DocMeta.INFO,n.PageInfo.Document,"DOCUMENT_INFO","rID")}(this),function(a){function e(a){n&&(t.data.TEMP_CONTAINER_IDENTITY=a,n=!1)}var t=a.sPlusPlus,r=a.ZSEvents,s=r.topic,o=r.Groups,i=r.Names,n=(a.ZSClass,!0);s.register(o.Listener,i.PublicSheet.IDENDITY,e,"TEMP_CONTAINER_IDENTITY")}(this);
!function(e){var t=(e.ZSDevTools.Logger,e.sPlusPlus),r=(e.ZSChart,e.ZSEvents),a=r.topic,o=r.Groups,n=r.Names,i=t.data.Defaults,s=i.MAX_COL,E=e.JSUtil.Math,S=(e.JSUtil,e.ZSConstants),R=S.CommandConstants,g=(S.ActionConstants,{Freeze:function(e,r,a,o,n){var i=t.data.getWorkBook(e,n).getSheetObj(r);i.onFreeze(a,o)},RowHeadersInsert:function(e,r,a,o,n,i){var s=t.data.getWorkBook(e,i),E=s.getSheetObj(r);E.onInsertRow(a,o,s.RowStyle.getStyleDef(n,!0))},RowHeadersDelete:function(e,r,a,o,n){var i=t.data.getWorkBook(e,n).getSheetObj(r);i.onDeleteRow(a,o)},ColumnHeadersInsert:function(e,r,a,o,n,i){var s=t.data.getWorkBook(e,i),E=s.getSheetObj(r);E.onInsertCol(a,o,s.ColStyle.getStyleDef(n)),E.ColStyleNames.Insert(a,o)},ColumnHeadersDelete:function(e,r,a,o,n){var i=t.data.getWorkBook(e,n).getSheetObj(r);i.onDeleteCol(a,o),i.ColStyleNames.Delete(a,o)},HideRowsAdd:function(e,r,a,o,n){var i=t.data.getWorkBook(e,n).getSheetObj(r);i.onHideRow(a,o)},HideColsAdd:function(e,r,a,o,n){var i=t.data.getWorkBook(e,n).getSheetObj(r);i.onHideCol(a,o)},HideRowsRemove:function(e,r,a,o,n,i){var s=t.data.getWorkBook(e,i),E=s.getSheetObj(r);E.onShowRow(a,o,n)},HideColsRemove:function(e,r,a,o,n,i){var s=t.data.getWorkBook(e,i),E=s.getSheetObj(r);E.onShowCol(a,o,n)},MergeCells:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.onMergeCell(a[i][0],a[i][1],a[i][2],a[i][3])},MergeAcross:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.onMergeAcross(a[i][0],a[i][1],a[i][2],a[i][3])},SplitCells:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.onSplitCell(a[i][0],a[i][1],a[i][2],a[i][3])},replaceArrayFormulas:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);n.ArrayFormula.reset();for(var i in a)n.ArrayFormula.add(a[i][0],a[i][1],a[i][2],a[i][3])},addArrayFormulas:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.ArrayFormula.add(a[i][0],a[i][1],a[i][2],a[i][3])},removeArrayFormulas:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.ArrayFormula.remove(a[i][0],a[i][1],a[i][2],a[i][3])},replaceDataValidation:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);n.DataValidation.reset();for(var i in a){var s=a[i];n.DataValidation.add(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11])}},addDataValidation:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a){var s=a[i];n.DataValidation.add(s[0],s[1],s[2],s[3],s[4],s[5])}},removeDataValidation:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r),i=new ZSClass.Range(a[0],a[1],a[2],a[3]);n.DataValidation.remove(i)},replaceCondFormatting:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);n.ConditionalFormat.Range.reset();for(var i in a)n.ConditionalFormat.Range.add(a[i][0],a[i][1],a[i][2],a[i][3])},addCondFormatting:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.ConditionalFormat.Range.add(a[i][0],a[i][1],a[i][2],a[i][3])},removeCondFormatting:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.ConditionalFormat.Range.remove(a[i][0],a[i][1],a[i][2],a[i][3])},replacePRanges:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);n.ProtectedRanges.reset();for(var i in a)a[i][4]&&n.ProtectedRanges.add(a[i][0],a[i][1],a[i][2],a[i][3],a[i][4])},modifyPRanges:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)a[i][4]?n.ProtectedRanges.add(a[i][0],a[i][1],a[i][2],a[i][3],a[i][4]):g.removePRanges(e,r,a,o)},removePRanges:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a){var s=new ZSClass.Range(a[i][0],a[i][1],a[i][2],a[i][3],a[i][4]);n.ProtectedRanges.remove(s)}},addCRanges:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);n.CheckBoxRanges.reset();for(var i in a)n.CheckBoxRanges.add(a[i][0],a[i][1],a[i][2],a[i][3])},modifyCRanges:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.CheckBoxRanges.add(a[i][0],a[i][1],a[i][2],a[i][3])},removeCRanges:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a){var s=new ZSClass.Range(a[i][0],a[i][1],a[i][2],a[i][3],a[i][4]);n.CheckBoxRanges.remove(s)}},FormRange:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r);for(var i in a)n.Form.add(a[i][0],a[i][1],a[i][2],a[i][3])},addImageInfo:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r),i=n.Ole.Image;for(var s in a){var E=a[s],S=E[R.IMAGE_ZINDEX],g=E[R.IMAGE_ID];i.addObject("img_"+g,S,E)}},modifyImageInfo:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r),i=n.Ole.Image;for(var s in a){var E=a[s],S=(E[R.IMAGE_ZINDEX],E[R.IMAGE_ID]);i.modifyObject("img_"+S,E)}},deleteImageInfo:function(e,r,a,o){var n=t.data.getWorkBook(e,o).getSheetObj(r),i=n.Ole.Image;for(var s in a){var E=a[s],S=(E[R.IMAGE_ZINDEX],E[R.IMAGE_ID]);i.deleteObject("img_"+S)}},setFilterCriteria:function(e,r,a,o,n,i){var s=t.data.getWorkBook(e,i).getSheetObj(r);s.DataFilters.add(n.startRow,n.startCol,n.endRow,n.endCol);var E=s.DataFilters.getIntersectedRanges(n);for(var S in E){E[S].setCriteria(a,o);var R=E[S].startRow,g=E[S].endRow;s.clearFilter(R,g-R+1);for(var I in a){var d=a[I][0],D=a[I][1];s.onFilterRow(d,D)}}},removeFilterData:function(e,r,a){var o=t.data.getWorkBook(e,a).getSheetObj(r),n=o.DataFilters.getAllRanges();for(var i in n){var s=n[i];o.clearFilter(s.startRow,s.endRow-s.startRow)}o.DataFilters.reset()},setFilterData:function(e,r,a,o,n,i){var s=t.data.getWorkBook(e,a).getSheetObj(r),E=s.DataFilters;if(!o){var S=E.getAllRanges();for(var R in S){var g=S[R];o=new ZSClass.Range(g.startRow,g.startCol,g.endRow,g.endCol)}}var I=E.getIntersectedRanges(o),g=I[0];void 0==i.cD&&(g.data[n]=i)},updateMaxUsedFormatCells:function(e,r,a,o,n){var i=t.data.getWorkBook(e,a).getSheetObj(r);i.MaxUsedFormatRow=o,i.MaxUsedFormatCol=n},modifySparklinesGroup:function(e,r,a,o){var n=t.data.getWorkBook(e,a).getSheetObj(r),i=JSON.parse(JSON.stringify(n.sparklines.groupranges));n.sparklines.groupranges.reset(),n.sparklines.cellRange={};for(var S=0;S<o.length;S++){var R=o[S],g=R[0],I=R[1],d=R[2],D=R[3],l=R[4],O=R[5];for(var A in d){{var c=d[A];i.RangeList.cellRange[E.hash(c[0],c[1],s)]}n.sparklines.groupranges.add(c[0],c[1],c[2],c[3],g,I,d,D,l,O)}}},modifySparklineProperties:function(e,r,a,o){for(var n=t.data.getWorkBook(e,a).getSheetObj(r),i=n.sparklines.groupranges.RangeList.masterList,s=0;s<o.length;s++){var E=o[s],S=E[1],R=E[0],g=i[R].id;for(var I in i){var d=i[I];d.id==g&&(d.properties=S)}}},setSparklineExtremes:function(e,r,a,o){for(var n=t.data.getWorkBook(e,a).getSheetObj(r),i=n.sparklines.groupranges.RangeList.masterList,s=0;s<o.length;s++){var E=o[s],S=E[0],R=i[S].id,g=E[1],I=E[2];for(var s in i){var d=i[s];d.id==R&&(d.properties.minValue!=g||d.properties.maxValue!=I,d.properties.minValue=g,d.properties.maxValue=I)}}}});a.register(o.Listener,n.SheetMeta.FREEZE,g.Freeze,"RID","SHEETID","FreezedRow","FreezedCol","VERSION"),a.register(o.Listener,n.SheetMeta.ARRAY_FORMULAS,g.replaceArrayFormulas,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.ARRAY_FORMULAS.ADD,g.addArrayFormulas,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.ARRAY_FORMULAS.REMOVE,g.removeArrayFormulas,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetMeta.DATAVALIDATION,g.replaceDataValidation,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.DATAVALIDATION.ADD,g.addDataValidation,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.DATAVALIDATION.REMOVE,g.removeDataValidation,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetMeta.CONDITIONALFORMAT,g.replaceCondFormatting,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.CONDITIONALFORMAT.ADD,g.addCondFormatting,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.CONDITIONALFORMAT.REMOVE,g.removeCondFormatting,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetMeta.PROTECTED_RANGES,g.replacePRanges,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.PROTECTED_RANGES.MODIFY,g.modifyPRanges,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.PROTECTED_RANGES.REMOVE,g.removePRanges,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetMeta.CHECK_BOX,g.addCRanges,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.CHECK_BOX.ADD,g.modifyCRanges,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetAction.CHECK_BOX.REMOVE,g.removeCRanges,"RID","SHEETID","RangeList","VERSION"),a.register(o.Listener,n.SheetMeta.FORM_RANGE,g.FormRange,"RID","SHEETID","FORM_RANGE","VERSION"),a.register(o.Listener,n.SheetMeta.IMAGES,g.addImageInfo,"RID","SHEETID","IMAGES","VERSION"),a.register(o.Listener,n.SheetAction.IMAGES.MOVE,g.addImageInfo,"RID","SHEETID","IMAGES","VERSION"),a.register(o.Listener,n.SheetAction.IMAGES.RESIZE,g.modifyImageInfo,"RID","SHEETID","IMAGES","VERSION"),a.register(o.Listener,n.SheetAction.IMAGES.INSERT,g.addImageInfo,"RID","SHEETID","IMAGES","VERSION"),a.register(o.Listener,n.SheetAction.IMAGES.DELETE,g.deleteImageInfo,"RID","SHEETID","IMAGES","VERSION"),a.register(o.Listener,n.SheetAction.ROW_HEADERS.INSERT,g.RowHeadersInsert,"RID","SHEETID","start","count","STYLENAME","VERSION"),a.register(o.Listener,n.SheetAction.ROW_HEADERS.DELETE,g.RowHeadersDelete,"RID","SHEETID","start","count","VERSION"),a.register(o.Listener,n.SheetAction.COLUMN_HEADERS.INSERT,g.ColumnHeadersInsert,"RID","SHEETID","start","count","STYLENAME","VERSION"),a.register(o.Listener,n.SheetAction.COLUMN_HEADERS.DELETE,g.ColumnHeadersDelete,"RID","SHEETID","start","count","VERSION"),a.register(o.Listener,n.SheetAction.HIDEROWS.ADD,g.HideRowsAdd,"RID","SHEETID","start","count","VERSION"),a.register(o.Listener,n.SheetAction.HIDECOLS.ADD,g.HideColsAdd,"RID","SHEETID","start","count","VERSION"),a.register(o.Listener,n.SheetAction.HIDEROWS.REMOVE,g.HideRowsRemove,"RID","SHEETID","start","count","DIMENSION","VERSION"),a.register(o.Listener,n.SheetAction.HIDECOLS.REMOVE,g.HideColsRemove,"RID","SHEETID","start","count","dimension","VERSION"),a.register(o.Listener,n.SheetAction.MERGE_CELLS.ADD,g.MergeCells,"RID","SHEETID","MergeList","VERSION"),a.register(o.Listener,n.SheetAction.MERGE_CELLS.REMOVE,g.SplitCells,"RID","SHEETID","MergeList","VERSION"),a.register(o.Listener,n.SheetAction.MERGE_ACROSS.ADD,g.MergeAcross,"RID","SHEETID","MergeList","VERSION"),a.register(o.UserAction,n.SheetAction.DATAFILTER.RESET,g.HideFilteredRowsRemove,"RID","SHEETID","start","count","DIMENSION","VERSION","CLIENT_ID"),a.register(o.UserAction,n.SheetAction.DATAFILTER.SETCRITERIA,g.setFilterCriteria,"RID","SHEETID","FROWS","FACOLS","FRANGE","VERSION"),a.register(o.UserAction,n.SheetAction.DATAFILTER.REMOVE,g.removeFilterData,"RID","SHEETID","VERSION"),a.register(o.Listener,n.SheetMeta.MAX_USED_FORMAT,g.updateMaxUsedFormatCells,"RID","SHEETID","VERSION","USEDFORMATROW","USEDFORMATCOL"),a.register(o.UserAction,n.SheetAction.DATAFILTER.FILTER_INFO,g.setFilterData,"RID","SHEETID","VERSION","RANGE","INDEX","data"),a.register(o.Listener,n.SheetAction.SPARKLINES.GROUP,g.modifySparklinesGroup,"RID","SHEETID","VERSION","GROUP"),a.register(o.Listener,n.SheetAction.SPARKLINES.PROPERTIES,g.modifySparklineProperties,"RID","SHEETID","VERSION","PROPS"),a.register(o.Listener,n.SheetAction.SPARKLINES.EXTREMES,g.setSparklineExtremes,"RID","SHEETID","VERSION","EXTREMES")}(this);
!function(t){var e=t.sPlusPlus,n=(t.ZSDevTools.Logger,t.ZSEvents),o=n.topic,i=n.Groups,S=n.Names,s=t.ZSClass.Button,r={ID:0,Label:1,X:2,Y:3,Width:4,Height:5,ScriptListener:6},a={MODULE:0,MACRO:1},T={onMeta:function(t,e,n,o){for(var i in o)I.addButton(t,e,n,o[i])},onInsertMeta:function(t,e,n,o){I.addButton(t,e,n,o)},onDeleteMeta:function(t,e,n,o){I.deleteButton(t,e,n,o)},onMoveMeta:function(t,e,n,o){I.updateButton(t,e,n,o)},onResizeMeta:function(t,e,n,o){I.updateButton(t,e,n,o)},onModifyMeta:function(t,e,n,o){I.updateButton(t,e,n,o)}},I={addButton:function(t,n,o,i){var S=e.data.getWorkBook(t,o),T=S.getSheetObj(n),I=T.Buttons,u=i[r.ID],D=i[r.Label],E=i[r.X],O=i[r.Y],B=i[r.Width],M=i[r.Height],c=i[r.ScriptListener],d=new s(D,E,O,B,M);I.set(u,d),c&&d.setScript(c[a.MODULE],c[a.MACRO])},updateButton:function(t,n,o,i){var S=e.data.getWorkBook(t,o),s=S.getSheetObj(n),T=s.Buttons,I=i[r.ID],u=i[r.Label],D=i[r.X],E=i[r.Y],O=i[r.Width],B=i[r.Height],M=i[r.ScriptListener],c=T.get(I);c.setPosition(D,E),c.setDimension(O,B),c.setLabel(u),M&&c.setScript(M[a.MODULE],M[a.MACRO])},deleteButton:function(t,n,o,i){var S=e.data.getWorkBook(t,o),s=S.getSheetObj(n),a=s.Buttons,T=i[r.ID];a.remove(T)}};o.register(i.Listener,S.SheetMeta.BUTTONS,T.onMeta,"RID","SHEETID","VERSION","BUTTONS"),o.register(i.Listener,S.SheetAction.BUTTONS.INSERT,T.onInsertMeta,"RID","SHEETID","VERSION","BUTTONS","XAID"),o.register(i.Listener,S.SheetAction.BUTTONS.DELETE,T.onDeleteMeta,"RID","SHEETID","VERSION","BUTTONS","XAID"),o.register(i.Listener,S.SheetAction.BUTTONS.MOVE,T.onMoveMeta,"RID","SHEETID","VERSION","BUTTONS","XAID"),o.register(i.Listener,S.SheetAction.BUTTONS.RESIZE,T.onResizeMeta,"RID","SHEETID","VERSION","BUTTONS","XAID"),o.register(i.Listener,S.SheetAction.BUTTONS.MODIFY,T.onModifyMeta,"RID","SHEETID","VERSION","BUTTONS","XAID")}(this);
!function(e){function t(e,t,I,E){for(var o in E)S.addImage(e,t,I,E[o])}function I(e,t,I,E){for(var o in E)S.deleteImage(e,t,I,E[o])}function E(e,t,I,E){for(var o in E)S.updateImage(e,t,I,E[o])}function o(e,t,I,E){for(var o in E)S.updateImage(e,t,I,E[o])}function a(e,t,I,E){for(var o in E)S.replaceImage(e,t,I,E[o])}var n=e.sPlusPlus,s=(e.ZSDevTools.Logger,e.ZSEvents),A=s.topic,i=s.Groups,r=s.Names,M=ZSClass.Image,G=e.ZSConstants.CommandConstants,S={addImage:function(e,t,I,E){var o=n.data.getWorkBook(e,I),a=o.getSheetObj(t),s=a.Images,A=E[G.IMAGE_ID],i=E[G.IMAGE_NAME],r=E[G.IMAGE_ROW],S=E[G.IMAGE_COLUMN],g=E[G.IMAGE_ROW_DIFF],_=E[G.IMAGE_COL_DIFF],D=E[G.IMAGE_WIDTH],R=E[G.IMAGE_HEIGHT],d=E[G.IMAGE_ZINDEX],f=decodeURIComponent(E[G.IMAGE_URL]);"-1"!=f.indexOf("u_n=")&&(f=n.data.AppRegistry.ctxpath+f);var O=new M(i,r,S,g,_,D,R,f,d);s.set(A,O)},deleteImage:function(e,t,I,E){var o=n.data.getWorkBook(e,I),a=o.getSheetObj(t),s=a.Images,A=E[G.IMAGE_ID];s.remove(A)},updateImage:function(e,t,I,E){var o=n.data.getWorkBook(e,I),a=o.getSheetObj(t),s=a.Images,A=E[G.IMAGE_ID],i=E[G.IMAGE_ROW],r=E[G.IMAGE_COLUMN],M=E[G.IMAGE_ROW_DIFF],S=E[G.IMAGE_COL_DIFF],g=E[G.IMAGE_WIDTH],_=E[G.IMAGE_HEIGHT],D=s.get(A);D.setRow(i),D.setRowDiff(M),D.setCol(r),D.setColDiff(S),D.setWidth(g),D.setHeight(_)},replaceImage:function(e,t,I,E){var o=n.data.getWorkBook(e,I),a=o.getSheetObj(t),s=a.Images,A=E[G.IMAGE_ID],i=E[G.IMAGE_NAME],r=E[G.IMAGE_ROW],M=E[G.IMAGE_COLUMN],S=E[G.IMAGE_ROW_DIFF],g=E[G.IMAGE_COL_DIFF],_=E[G.IMAGE_WIDTH],D=E[G.IMAGE_HEIGHT],R=E[G.IMAGE_ZINDEX],d=decodeURIComponent(E[G.IMAGE_URL]);"-1"!=d.indexOf("u_n=")&&(d=n.data.AppRegistry.ctxpath+d);var f=s.get(A);f.setName(i),f.setRow(r),f.setRowDiff(S),f.setCol(M),f.setColDiff(g),f.setWidth(_),f.setHeight(D),f.setZIndex(R),f.setURL(d)}};A.register(i.Listener,r.SheetMeta.IMAGES,t,"RID","SHEETID","VERSION","IMAGES"),A.register(i.Listener,r.SheetAction.IMAGES.INSERT,t,"RID","SHEETID","VERSION","IMAGES"),A.register(i.Listener,r.SheetAction.IMAGES.DELETE,I,"RID","SHEETID","VERSION","IMAGES"),A.register(i.Listener,r.SheetAction.IMAGES.MOVE,E,"RID","SHEETID","VERSION","IMAGES"),A.register(i.Listener,r.SheetAction.IMAGES.RESIZE,o,"RID","SHEETID","VERSION","IMAGES"),A.register(i.Listener,r.SheetAction.IMAGES.EDIT,a,"RID","SHEETID","VERSION","IMAGES")}(this);
!function(t){function e(){this.chartOptions={},this.chartMeta={},this.chartInstance=[],this.isDirty=!1,this.isEditable=!1,this.selectionMeta={},this.isClone=!1,this.associatedSheetId=void 0,this.timestamp=-1,this.ttl=900,this.ttlTimer=null,this.isLoaded=!1,this.isClientActionDone=!1,this.actionOwner=!1}var o=(t.sPlusPlus,t.ZSClass,t.ZSChart);e.prototype.updateTimeStamp=function(){this.timestamp=Math.floor(Date.now()),clearTimeout(this.ttlTimer),this.ttl>0&&(this.ttlTimer=setTimeout(function(){this.markForCleaner()}.bind(this),1e3*this.ttl))},e.prototype.setMarkerState=function(t){this.chartOptions.plotOptions.series.marker.enabled=t},e.prototype.isClientUpdated=function(){return this.isClientActionDone},e.prototype.setClientUpdated=function(t){return this.isClientActionDone=t},e.prototype.getID=function(){return this.chartMeta.id},e.prototype.resetSelection=function(){this.selectionMeta={}},e.prototype.addSelectionState=function(t){this.selectionMeta[t]?(this.resetSelection(),this.selectionMeta[t]={isSeries:!1}):(this.resetSelection(),this.selectionMeta[t]={isSeries:!0})},e.prototype.getSelectionState=function(t){return this.selectionMeta[t]&&this.selectionMeta[t].isSeries},e.prototype.getXReverse=function(){return this.chartOptions.xAxis.reversed},e.prototype.getColors=function(){return this.chartOptions.colors||this.chartInstance[0].options.colors},e.prototype.markForCleaner=function(){clearTimeout(this.ttlTimer),this.timestamp=-1},e.prototype.getBinning=function(){return this.chartOptions.binning},e.prototype.setActionOwner=function(t){this.actionOwner=t},e.prototype.isActionOwner=function(){return this.actionOwner},e.prototype.getBackgroundColor=function(){return this.chartOptions.chart.backgroundColor||"#FFFFFF"},e.prototype.getTimestamp=function(){return this.timestamp},e.prototype.getAggregation=function(){return this.chartOptions.aggregation},e.prototype.getFilter=function(){return this.chartOptions.filter},e.prototype.getInstance=function(){return this.chartInstance},e.prototype.setInstanceAtIndex=function(t,e){this.chartInstance[t]=e},e.prototype.setInstance=function(t,e){var o=this.chartInstance.indexOf(t);~o?this.chartInstance[o]=t:this.chartInstance.push(t),e&&this.frameOptionsFromInstance(this.Instance)},e.prototype.flushInstance=function(){this.chartInstance=[]},e.prototype.markDirty=function(t){this.isDirty=t},e.prototype.isDirty=function(){return this.isDirty},e.prototype.isEditable=function(){return this.isEditable},e.prototype.setEditPermission=function(t){this.isEditable=t},e.prototype.setAssociatedSheetId=function(t){this.associatedSheetId=t},e.prototype.getSheetAssociatedId=function(){return this.associatedSheetId},e.prototype.setSelection=function(t){return this.selectionMeta=t},e.prototype.getSelection=function(){return this.selectionMeta},e.prototype.getOptions=function(){return this.chartOptions},e.prototype.frameOptionsFromInstance=function(){var t=this.chartInstance&&this.chartInstance.co&&this.chartInstance.co.options?this.chartInstance.co.options:null;this.setOptions(t)},e.prototype.setOptions=function(t){this.chartOptions=t,this.removeUnwantedProeprties()},e.prototype.removeUnwantedProeprties=function(){this.chartOptions.chart.plotBackgroundColor=null},e.prototype.setDetails=function(t){this.chartMeta=t},e.prototype.getDetails=function(){return this.chartMeta},e.prototype.cloneOf=function(t,e){var o=t instanceof Array?[]:{};for(var i in t)o[i]=e&&t[i]&&"object"==typeof t[i]?this.cloneOf(t[i],e):t[i];return o},e.prototype.merge=function(t,e,o){return Object.keys(e).forEach(function(o){t[o]=e[o]}),Object.keys(o).forEach(function(e){t[e]=o[e]}),t},e.prototype.getRange=function(){return this.chartMeta.dataRange},e.prototype.getSeriesIn=function(){return this.chartMeta.seriesIn},e.prototype.getCombinedWay=function(){return this.chartMeta.cR},e.prototype.getType=function(){return this.chartMeta.type},e.prototype.getCType=function(){return this.chartOptions.chart.type},e.prototype.isSingleYaxis=function(){return this.chartMeta.isSingleYaxis},e.prototype.getSecYAxisSymbol=function(){return this.chartMeta.secYAxisSymbl},e.prototype.getCurrency=function(){return this.chartMeta.currency},e.prototype.getPrecisions=function(){return this.chartMeta.precision},e.prototype.getStyleOptions=function(){return this.chartOptions.colorOptions},e.prototype.isPublishChart=function(){return"undefined"!=typeof this.chartMeta.pcn&&-1!=this.chartMeta.pcn},e.prototype.getTitle=function(){return this.chartOptions.title.text},e.prototype.getPubChartName=function(){return this.chartMeta.pcn},e.prototype.getHeight=function(){return this.chartMeta.ht},e.prototype.getWidth=function(){return this.chartMeta.wd},e.prototype.getComputedChartMeta=function(){var t=this.cloneOf(this.chartMeta,!0);return t.co=this.cloneOf(this.chartOptions,!0),t},e.prototype.toggleVisited=function(){!this.isLoaded&&(this.isLoaded=!0)},e.prototype.setForClone=function(t){this.isClone=!!t},e.prototype.isForClone=function(){return this.isClone},e.prototype.getActiveSheet=function(){return this.getSheetAssociatedId()},e.prototype.getChartID=function(){return this.getID()},e.prototype.getFirstRowAsLabel=function(){return this.chartMeta.frl},e.prototype.getFirstColAsLabel=function(){return this.chartMeta.fcl},e.prototype.getLegendPosition=function(){return this.chartMeta.legendPos},e.prototype.getLPos=function(){return this.getLegendPosition()},e.prototype.setLegendPosition=function(t){this.chartMeta.legendPos=t},e.prototype.getStartRowIndex=function(){function t(){var t=new o.Utility.ChartAgent,e=this.chartMeta.sr;return 0>e&&(this.chartMeta.sr=t.getRowPosbyTop(this.getTop())),this.chartMeta.sr}return this.isCloned()?this.getStartRowForClone():t.call(this)},e.prototype.getStartColIndex=function(){function t(){var t=new o.Utility.ChartAgent,e=this.chartMeta.sc;return 0>e&&(this.chartMeta.sc=t.getColPosbyLeft(this.getLeft())),this.chartMeta.sc}return this.isCloned()?this.getStartColForClone():t.call(this)},e.prototype.getStartRowForClone=function(){var t=new o.Utility.ChartAgent,e=this.getTopPositionForCloning();return t.getRowPosbyTop(e)},e.prototype.getStartColForClone=function(){var t=new o.Utility.ChartAgent,e=this.getLeftPositionForCloning();return t.getColPosbyLeft(e)},e.prototype.getStartRowDiff=function(){return this.chartMeta.srd<0?0:this.chartMeta.srd},e.prototype.getStartColDiff=function(){return this.chartMeta.scd<0?0:this.chartMeta.scd},e.prototype.getLeftPositionForCloning=function(){var e=50,o=this.chartMeta.left,i=this.chartMeta.wd;return parseInt(o)+e+i>t.innerWidth&&(e=-50),parseInt(o)+e},e.prototype.getTopPositionForCloning=function(){var e=50,o=this.chartMeta.top,i=this.chartMeta.ht;return parseInt(o)+e+i>t.innerHeight&&(e=-50),parseInt(o)+e},e.prototype.getLeft=function(){return this.isCloned()?this.getLeftPositionForCloning():this.chartMeta.left},e.prototype.getTop=function(){return this.isCloned()?this.getTopPositionForCloning():this.chartMeta.top},e.prototype.getWidth=function(){return this.chartMeta.wd},e.prototype.getHeight=function(){return this.chartMeta.ht},e.prototype.getSubTitle=function(){return this.chartOptions.subtitle.text},e.prototype.getXTitle=function(){return this.chartOptions.xAxis.title.text},e.prototype.getToolTip=function(){return this.chartOptions.tooltip.enabled},e.prototype.getZoomType=function(){return this.chartOptions.chart.zoomType?this.chartOptions.chart.zoomType:""},e.prototype.getAnimation=function(){return this.chartOptions.plotOptions.series.animation?this.chartOptions.plotOptions.series.animation:!0},e.prototype.getTrendline=function(){return this.chartMeta.tl},e.prototype.getFloating=function(){return!1},e.prototype.getMajorGridWidth=function(t){return this.chartOptions.yAxis[t||0].gridLineWidth?this.chartOptions.yAxis[t||0].gridLineWidth:null},e.prototype.getMinorTickInterval=function(t){return this.chartOptions.yAxis[t||0].minorTickInterval?this.chartOptions.yAxis[t||0].minorTickInterval:""},e.prototype.getXLabel=function(){return this.chartOptions.xAxis.labels.enabled},e.prototype.getYLabel=function(t){return this.chartOptions.yAxis[t||0].labels.enabled},e.prototype.getHiddenCellState=function(){return this.chartMeta.ihc},e.prototype.getYAxisState=function(){return this.isSingleYaxis()},e.prototype.getXSlant=function(){return this.chartOptions.xAxis.labels.rotation?this.chartOptions.xAxis.labels.rotation:null},e.prototype.getLabelFormat=function(){return this.chartMeta.lf},e.prototype.getMarkerState=function(){return this.chartOptions.plotOptions.series.marker.enabled},e.prototype.getTrendlineTypes=function(){return this.chartMeta.tlType},e.prototype.getThreshold=function(){return this.chartOptions.plotOptions.series.threshold},e.prototype.getDegreeOrElse=function(){return this.chartMeta.order},e.prototype.getAutoExpandState=function(){return this.chartMeta.autoExpand},e.prototype.getCustomStyle=function(){var t=new o.Utility.ChartAgent,e=t.constructStyleProperty(this.chartOptions);return e},e.prototype.getPivotState=function(){return this.chartMeta.isPivotChart},e.prototype.isCloned=function(){return this.isClone},e.prototype.getComboTypes=function(){return this.chartOptions.comboChartTypes?Object.values(this.chartOptions.comboChartTypes):[]},e.prototype.getNoOfAxies=function(){return 1},e.prototype.getYAxis=function(){var t=o.Utility.removeCursorPointer(this.chartOptions.yAxis);return t},e.prototype.getXAxis=function(){return this.chartOptions.xAxis},e.prototype.getLegend=function(){return this.chartOptions.legend},e.prototype.getLineStyles=function(){return this.chartMeta.lineStyles?this.chartMeta.lineStyles:[]},e.prototype.getPivotId=function(){return this.chartMeta.pivotId},e.prototype.getStaggerState=function(){return this.chartOptions.xAxis.labels.staggerLines?this.chartOptions.xAxis.labels.staggerLines:null},e.prototype.getDecimalSeprator=function(){return this.chartMeta.ds},e.prototype.getThousandSeprator=function(){return this.chartMeta.ts},e.prototype.setLocale=function(t,e){this.chartMeta.ds=t,this.chartMeta.ts=e},e.prototype.setPosition=function(t,e){var i=new o.Utility.ChartAgent;this.chartMeta.left=t,this.chartMeta.top=e,this.chartMeta.sr=i.getRowPosbyTop(e),this.chartMeta.sc=i.getColPosbyLeft(t),this.chartMeta.srd=Math.abs(e-i.getTopByRowPos(this.chartMeta.sr)),this.chartMeta.scd=Math.abs(t-i.getleftByColPos(this.chartMeta.sc))},e.prototype.getComputedLeft=function(t){var e=new o.Utility.ChartAgent;return parseInt(e.getleftByColPos(t))+parseInt(this.chartMeta.scd)},e.prototype.getComputedTop=function(t){var e=new o.Utility.ChartAgent;return parseInt(e.getTopByRowPos(t))+parseInt(this.chartMeta.srd)},e.prototype.setDimension=function(t,e){this.chartMeta.wd=t,this.chartMeta.ht=e},e.prototype.getUpdateLegendStyle=function(t){var e={};return this.merge(e,this.getOptions().legend.itemStyle,t),e},e.prototype.getLegendPositionByName=function(e){var o=new t.ZSChart.Utility.CommanAgent;return o.getLegendPosition(e)},e.prototype.getCustomChartColor=function(){var t=this.getOptions(),e=t.colorOptions,o=e.colorTheme;return"SHEET-OFFICE-CUSTOM-THEME"==o.name?o.basecolor:"rgb(128,128,128)"},e.prototype.getSVG=function(){var t=this.getInstance()[0],e=this.getOptions();return t.getSVG(e)},e.prototype.updateScaleFactor=function(t,e,o,i){var n=this.getYAxis();n[o].scaleFactor=t,n[o].unitFactor=e,n[o].conversionType=i},e.prototype.setNumberFormat=function(t,e,o,i){var n=this.getYAxis();n[i].nfCode=t,n[i].prefix=e,n[i].suffix=o},e.prototype.isInsertFromZiaPanel=function(){return this.chartMeta.isFromZia},e.prototype.isGrouping=function(){return this.chartMeta.grouping},e.prototype.updateXLabelStyle=function(t){var e=this.getXAxis();return e.labels.style||(e.labels.style={}),e.labels.style[t.key]=t.value,e.labels.style},e.prototype.updateYLabelStyle=function(t,e){var o=this.getYAxis()[e];return o.labels.style||(o.labels.style={}),o.labels.style[t.key]=t.value,o.labels.style},e.prototype.updateTrendtype=function(t){this.chartMeta.tlType=t.value;var e=t.prevVal;return this.chartMeta.tl="None"!==this.chartMeta.tlType,this.chartMeta.order=2,"None"==e&&this.chartMeta.tl},e.prototype.updateTrendDegree=function(t){this.chartMeta.order=t.value},e.prototype.updateFontFamily=function(t){this.chartOptions.chart.style=t},e.prototype.updateTitleStyle=function(t,e,o){"CHART_TITLE"==t?this.chartOptions.title.style=e:"CHART_SUB_TITLE"==t?this.chartOptions.subtitle.style=e:"XAXIS_TITLE"==t?this.chartOptions.xAxis.title.style=e:"YAXIS_TITLE"==t&&(this.chartOptions.yAxis[o].title.style=e)},e.prototype.updateChartColor=function(t){this.chartOptions.chart.backgroundColor=t,this.chartOptions.chart.plotBackgroundColor=null},e.prototype.updateGCColor=function(t){for(var e=0;e<this.chartOptions.yAxis.length;e++){this.chartOptions.yAxis[e].gridLineColor=t;var i=(new o.Model.ChartModel).getRGBA(t,"0.5");this.chartOptions.yAxis[e].minorGridLineColor=i}},e.prototype.updateXLabel=function(t){this.chartOptions.xAxis.labels.enabled=t},e.prototype.updateXSlant=function(t){this.chartOptions.xAxis.labels.rotation="Auto"===t.value?null:parseInt(t.value)},e.prototype.updateXStagger=function(t){this.chartOptions.xAxis.labels.staggerLines="auto"==t.value?1:parseInt(t.value)},e.prototype.updateYLabel=function(t,e){this.chartOptions.yAxis[e||0].labels.enabled=t},e.prototype.updateYMin=function(t,e){this.chartOptions.yAxis[e||0].min=""==t?null:parseInt(t)},e.prototype.updateYMax=function(t,e){this.chartOptions.yAxis[e||0].max=""==t?null:parseInt(t)},e.prototype.updateYInterval=function(t,e){this.chartOptions.yAxis[e||0].tickInterval=""==t?null:parseInt(t)},e.prototype.updateYMajor=function(t){for(var e=0;e<this.chartOptions.yAxis.length;e++)this.chartOptions.yAxis[e].gridLineWidth=t?1:0},e.prototype.updateYMinor=function(t){for(var e=0;e<this.chartOptions.yAxis.length;e++)this.chartOptions.yAxis[e].minorTickInterval=t?"auto":null},e.prototype.updateYReverse=function(t,e){this.chartOptions.yAxis[e||0].reversed=t},e.prototype.updateYOpposite=function(t,e){this.chartOptions.yAxis[e||0].opposite=t},e.prototype.updateXReverse=function(t){this.chartOptions.xAxis.reversed=t},e.prototype.updateYLogarithmic=function(t,e){this.chartOptions.yAxis[e||0].type=t?"logarithmic":"linear",t?(this.chartOptions.yAxis[e||0].min=1,this.chartOptions.yAxis[e||0].tickInterval=1):(this.chartOptions.yAxis[e||0].min=this.chartOptions.yAxis[e||0].prevMin,this.chartOptions.yAxis[e||0].tickInterval=this.chartOptions.yAxis[e||0].prevInterval)},e.prototype.updateYBaseValue=function(t,e){this.chartOptions.yAxis[e||0].baseValue=t},e.prototype.addNewPlotline=function(t){var e=new o.Utility.ChartAgent;this.chartOptions=e.addNewPlotline(this.chartOptions,t)},e.prototype.removePlotlineByIndex=function(t){var e=new o.Utility.ChartAgent;this.chartOptions=e.removePlotlineByIndex(this.chartOptions,t)},e.prototype.updatePlotLineName=function(t){var e=new o.Utility.ChartAgent;this.chartOptions=e.updatePlotLineName(this.chartOptions,t)},e.prototype.updateLegendStyle=function(t){this.chartOptions.legend.itemStyle=t},e.prototype.updateColorScheme=function(t){this.chartOptions.colorOptions.colorTheme.basecolor=t.basecolor,this.chartOptions.colorOptions.colorTheme.name=t.name,this.chartOptions.colorOptions.colorTheme.isReversed=t.isReversed},e.prototype.setGradient=function(t){this.chartMeta.gradient=t},e.prototype.getGradient=function(){return this.chartMeta.gradient},e.prototype.getDataLabelStyle=function(){return this.chartOptions.colorOptions.dataLabels},e.prototype.setDataLabelStyle=function(t){this.chartOptions.colorOptions.dataLabels=t},e.prototype.removeAllPlotLine=function(t){var e=this.getYAxis();delete e[t].plotLines},e.prototype.getConversionCode=function(){var t=o.Constants.ConversionType,e=this.getYAxis()[0],i=e.conversionType||t.UNITS;return i},!o.Model&&(o.Model={}),o.Model.ChartGridMeta=e}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSDevTools.Logger,s=e.ZSEvents,i=s.topic,r=s.Groups,c=s.Names,o=e.ZSChart.Model.ChartGridMeta,n={addMeta:function(e,t,a,s,i){for(var r in s)d.addChart(e,t,a,s[r],i)},addChartMeta:function(e,t,a,s,i){for(var r in s)d.addChart(e,t,a,s[r],i)},modifyChartMeta:function(e,t,a,s,i){for(var r in s){var c=s[r];d.updateChart(e,t,a,c,i)}},modifyPubishChartMeta:function(e,t,a,s,i){for(var r in s){var c=s[r];d.updatePublishChart(e,t,a,c,i)}},deleteChartMeta:function(e,t,a,s,i){for(var r in s){var c=s[r];d.deleteChart(e,t,a,c,i)}},modifyQuickChartMeta:function(e,t,a,s,i){var r={};for(var c in s){var o=s[c],d=[],h=o.subAction||0,S=o.chartId||o.id,A=o.value,R=o.cellRef;if(h>0&&"undefined"==typeof A)return;switch(h){case 107:case 137:case 138:case 148:case 151:case 152:case 153:case 154:d.push(A);break;case 101:r.legendPos=A,r.id=S,d.push(r);break;case 102:r.lf=A,r.id=S,d.push(r);break;case 103:r.co={},r.co.yAxis=A,r.id=S,d.push(r);break;case 104:r.co={},r.co.yAxis=A,r.id=S,d.push(r);break;case 105:r.co={},r.co.plotOptions=A,r.id=S,d.push(r);break;case 106:r.co={},r.co.tooltip=A,r.id=S,d.push(r);break;case 145:r.ae=A,r.id=S,d.push(r);break;case 147:r.co={},r.co.plotOptions=A,r.id=S,d.push(r);break;case 108:r.co={},r.id=S,r.co.chart=A,d.push(r);break;case 109:r.co={},r.id=S,r.co.chart=A,d.push(r);break;case 124:case 116:case 118:case 126:case 130:case 131:case 132:case 134:case 136:case 135:case 140:case 149:case 150:r.co={},r.id=S,r.co.yAxis=A,d.push(r);break;case 141:case 142:case 143:case 144:case 146:if(o.isYAxis)r.id=S,r.co={},r.co.yAxis=A;else{r.id=S,r.co={};var C=n.getXAxisCatgeories(e,a,t,r.id);r.co.xAxis=A,r.co.xAxis.categories=C}d.push(r);break;case 114:r.co={},r.id=S,r.co.chart=A,d.push(r);break;case 115:case 117:case 127:case 129:case 139:r.co={},r.id=S;var C=n.getXAxisCatgeories(e,a,t,r.id);r.co.xAxis=A,R&&(r.co.cellRef={}),R&&(r.co.cellRef=R),r.co.xAxis.categories=C,d.push(r);break;case 122:case 119:r.co={},r.id=S,r.co.title=A,R&&(r.co.cellRef={}),R&&(r.co.cellRef=R),d.push(r);break;case 123:case 120:r.co={},r.id=S,r.co.subtitle=A,R&&(r.co.cellRef={}),R&&(r.co.cellRef=R),d.push(r);break;case 125:r.co={},r.id=S,r.co.legend=A,d.push(r);break;case 192:r.co={},r.id=S,r.co.yAxis=A,d.push(r);break;default:o.value&&d.push(o.value),!o.value&&d.push(o)}d.length>0&&n.modifyChartMeta(e,t,a,d,i)}},getXAxisCatgeories:function(e,a,s,i){var r=t.data.getWorkBook(e,a),c=r.getSheetObj(s),o=c.Charts,n=o.get(i),d=n.getOptions(),h=d.xAxis.length?d.xAxis[0]:d.xAxis;return h.categories}},d={addChart:function(e,a,s,i,r){var c=t.data.getWorkBook(e,s),n=c.getSheetObj(a),d=n.Charts,h=new o,S=i.id,A=h.cloneOf(i,!0);delete A.co,h.setOptions(i.co),h.setDetails(A),h.setAssociatedSheetId(a),h.setActionOwner(r),d.set(S,h)},updateChart:function(e,s,i,r,c){var o=t.data.getWorkBook(e,i),n=o.getSheetObj(s),d=n.Charts,h=r.id,S=d.get(h);if(!S)return void a.log("[Chart] Missed Old Chart Tiffin");var A=S.cloneOf(r,!0),R=S.getDetails(),C=S.getOptions(),u={},l={};delete A.co,S.merge(u,R,A),S.merge(l,C,r.co||{}),S.setDetails(u),S.setOptions(l),S.setActionOwner(c),d.set(h,S)},updatePublishChart:function(e,s,i,r,c){var o=t.data.getWorkBook(e,i),n=o.getSheetObj(s),d=n.Charts,h=r.id,S=d.get(h);if(!S)return void a.log("[Chart] Missed Old Chart Tiffin");var A=S.cloneOf(r,!0),R=S.getDetails(),C=S.getOptions(),u={},l={};delete A.co,S.merge(u,R,A),S.merge(l,C,r.co||{}),u.pcn&&!A.pcn&&(u.pcn=-1),S.setDetails(u),S.setOptions(l),S.setActionOwner(c),d.set(h,S)},deleteChart:function(e,s,i,r,c){var o=t.data.getWorkBook(e,i),n=o.getSheetObj(s),d=n.Charts,h=r.id,S=r.asn,A=d.get(h);return A?(A&&A.setActionOwner(c),void(A&&A.getSheetAssociatedId()==S&&d.remove(h))):void a.log("[Chart] Missed Old Chart Tiffin")}};i.register(r.Listener,c.SheetMeta.CHARTS,n.addMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.INSERT,n.addChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.MOVE,n.modifyChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.RESIZE,n.modifyChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.DELETE,n.deleteChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.EDIT,n.modifyQuickChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.MODIFY,n.modifyQuickChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.UPDATE,n.modifyQuickChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.PUBLISH,n.modifyChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.UNPUBLISH,n.modifyPubishChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER"),i.register(r.Listener,c.SheetAction.CHARTS.RENAME,n.modifyChartMeta,"RID","SHEETID","VERSION","CHARTS","AOWNER")}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,o=a.topic,r=a.Groups,i=a.Names,s=t.data.Defaults,n=(e.JSUtil,e.JSUtil.Math),S=s.MAX_COL,l=e.ZSDevTools.Logger;t.data.syncStyleRequired=!1;var E={columnLevelStyleNames:function(e,a,o,r){for(var i=t.data.getWorkBook(e,r),s=i.getSheetObj(a),n=0,S=o.length;S>n;n++)i.CellStyle.getMappedKey(o[n][2])||(l.log("syncstyle required for columnLevelStyleNames : ",o[n][2]),t.data.syncStyleRequired=!0),s.ColStyleNames.setStyle(o[n][0],o[n][1],i.CellStyle.getMappedKey(o[n][2]))},rowHeaders:function(e,a,o,r){for(var i=t.data.getWorkBook(e,o),s=i.getSheetObj(a),n=0,S=r.length;S>n;n++){var l=i.RowStyle.getStyleDef(r[n][2],!0);s.Row.axis._fillDim(r[n][0],r[n][1],l),s.Row.auxiliaryAxis._fillDim(r[n][0],r[n][1],l+t.data.Defaults.PADDING)}},colHeaders:function(e,a,o,r){for(var i=t.data.getWorkBook(e,o),s=i.getSheetObj(a),n=0,S=r.length;S>n;n++){var l=i.ColStyle.getStyleDef(r[n][2]);s.Column.axis._fillDim(r[n][0],r[n][1],l)}},resizeRow:function(e,a,o,r,i,s){var n=t.data.getWorkBook(e,o),S=n.getSheetObj(a);s=n.RowStyle.getStyleDef(s,!0),S.Row.axis.setDim(r,i,s),S.Row.auxiliaryAxis.setDim(r,i,s+t.data.Defaults.PADDING)},resizeCol:function(e,a,o,r,i,s){var n=t.data.getWorkBook(e,o),S=n.getSheetObj(a);s=n.ColStyle.getStyleDef(s),S.Column.axis.setDim(r,i,s)},HideGrid:function(e,a,o){var r=o[0],i=t.data.getWorkBook(e,a).getSheetObj(r);i.HideGrid(o[1])},OnZoom:function(e,a,o,r){var i=t.data.getWorkBook(e,o).getSheetObj(a),s=t.view.getActiveGridID(),n=t.view.getSheetState(s,a);n.setZoom(r),i.setBorderZise(r)},ClientFirstActions:function(e,t,a,o,r,i,s){for(var n=0;n<r.length;n++){var S=r[n];E.doClientFirstActions(e,t,o,S.startRow,S.startCol,S.endRow,S.endCol,i,a,s)}},doClientFirstActions:function(e,a,o,r,i,s,n,S,l){var E=t.data.getWorkBook(e,l),R=E.getSheetObj(a);switch(o){case"RESIZEROW":for(var D=r;s>=D;D=R.Row.Visibility.nextNonHidden(D))R.Row.axis.setDim(D,1,S),R.Row.auxiliaryAxis.setDim(D,1,S+t.data.Defaults.PADDING);break;case"RESIZECOL":for(var D=i;n>=D;D=R.Column.hidden.nextNonHidden(D))R.Column.axis.setDim(D,1,S)}},DVErrorAlert:function(e,a,o){E.dataValidationDOMUpdate=function(e,a,r,i,s){var n=t.data.getWorkBook(e,r).getSheetObj(a);for(var S in i){var l=i[S][0],R=i[S][2];for(var D in s[R]){var d=s[R][D][0],O=(s[R][D][2],n.DataValidation),g=new ZSClass.Range(l,d,l,d),I=n.DVErrorInfo;o?E.addDVWarn(l,d,g,O,I):n&&E.removeDVWarn(l,d,g,O,I)}}E.dataValidationDOMUpdate=void 0}},addDVWarn:function(e,t,a,o,r){var i=o.getIntersectedRanges(a);for(k in i)if("WARN"==i[k].messageType){var s={range:new ZSClass.Range(i[k].startRow,i[k].startCol,i[k].endRow,i[k].endCol),row:e,col:t,messageType:i[k].messageType,messageContent:i[k].messageContent},l=r.get(n.hash(a.startRow,a.startCol,S));if(l&&l.row==s.row&&l.col==s.col)return;r.set(n.hash(a.startRow,a.startCol,S),s)}},removeDVWarn:function(e,t,a,o,r){r&&(r&&r.get(n.hash(a.startRow,a.startCol,S))&&r.remove(n.hash(a.startRow,a.startCol,S)),r.isEmpty()&&r.clear())},updateMaxCells:function(e,a,o,r,i){var s=t.data.getWorkBook(e,o),n=s.getSheetObj(a);n.MaxUsedRow=r,n.MaxUsedCol=i},updateMaxUsedFormatCells:function(e,a,o,r,i){var s=t.data.getWorkBook(e,o),n=s.getSheetObj(a);n.MaxUsedFormatRow=r,n.MaxUsedFormatCol=i}};o.register(r.Listener,i.SheetMeta.ROW_HEADERS,E.rowHeaders,"RID","SHEETID","VERSION","ROW_HEADERS"),o.register(r.Listener,i.SheetMeta.COLUMN_HEADERS,E.colHeaders,"RID","SHEETID","VERSION","COL_HEADERS"),o.register(r.Listener,i.SheetAction.ROW_HEADERS.RESIZE.ENUMERATE,E.resizeRow,"RID","SHEETID","VERSION","START","COUNT","STYLENAME"),o.register(r.Listener,i.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,E.resizeCol,"RID","SHEETID","VERSION","START","COUNT","STYLENAME"),o.register(r.Listener,i.SheetAction.ZOOM.On,E.OnZoom,"RID","SHEETID","VERSION","ZOOM"),o.register(r.Listener,i.ServerAction.PROCESSTRIMCELLRESPONSE,function(e,t,a,o,r,i){E.dataValidationDOMUpdate&&E.dataValidationDOMUpdate(e,t,a,o,r,i)},"DOCID","SHEETID","VERSION","ROW_DATA","COLUMN_DATA","XAID","CONDITIONAL_FORMAT"),o.register(r.Listener,i.GridAction.CLIENTFIRSTACTIONS,E.ClientFirstActions,"RID","SHEETID","VERSION","ACTION","RANGELIST","VALUE"),o.register(r.Listener,i.SheetAction.GRID_LINES.MODIFY,E.HideGrid,"RID","VERSION","SHOW_GRID"),o.register(r.Listener,i.SheetAction.GRID_LINES.META,E.HideGrid,"RID","VERSION","SHOW_GRID"),o.register(r.Listener,i.SheetMeta.MAX_USED_CELL,E.updateMaxCells,"RID","SHEETID","VERSION","USEDROW","USEDCOL"),o.register(r.Listener,i.SheetMeta.MAX_USED_FORMAT,E.updateMaxUsedFormatCells,"RID","SHEETID","VERSION","USEDFORMATROW","USEDFORMATCOL"),o.register(r.Listener,i.SheetMeta.COLUMN_LEVEL_CELLSTYLES,E.columnLevelStyleNames,"RID","SHEETID","STYLENAMES","VERSION")}(this);
!function(e){function t(e,t,i){var n=r.view.getActiveGridID(),s=r.view.State[n];!s[e]&&(s[e]={},s[e].VersionState=new ZSClass.VersionState);var S=s[e][i];!S&&(S=new ZSClass.State,s[e][i]=S),!S.getSheetState(t)&&S.setSheetState(t,new ZSClass.ActiveInfo),S.rID=e,S.setActive(S.getSheetState(t))}function i(e,t,i){for(var n=r.view.getActiveGridID(),s=r.view.State[n][e][i],S=0,a=t.length;a>S;S++){var v=t[S][0];s.removeSheetState(v)}}{var r=e.sPlusPlus,n=e.ZSEvents,s=n.topic,S=n.Groups,a=n.Names;e.ZSDevTools.Logger,e.ZSConstants.CommandConstants}r.view.getSheetState=function(e,t){var i=r.view.State[e],n=r.view.getResourceID(e),s=r.view.getVersionID(e);return i[n][s].getSheetState(t)},r.view.getActiveState=function(e){var t=r.view.State[e],i=r.view.getResourceID(e),n=r.view.getVersionID(e);return t[i][n]},r.view.getVersionState=function(e){var t=r.view.State[e],i=r.view.getResourceID(e);return t[i].VersionState},s.register(S.Listener,a.DocAction.WORKSHEETS.DELETE,i,"RID","DELETE","VERSION"),s.register(S.Listener,a.DocMeta.ACTIVE_SHEET,t,"RID","ACTIVE_SHEET","VERSION")}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSEvents,r=o.topic,n=o.Groups,a=o.Names,s=(e.JSUtil,e.ZSConstants.CommandConstants),i=t.data.api;i.UpdateUserInfo=function(e){ZSClass.UndoRedo&&(t.data.UserInfo.Transients.UndoRedo||(t.data.UserInfo.Transients.UndoRedo={},t.data.UserInfo.Transients.UndoRedo.getObj=function(e){return t.data.UserInfo.Transients.UndoRedo[e]}),t.data.UserInfo.Transients.UndoRedo[e]||(t.data.UserInfo.Transients.UndoRedo[e]=new ZSClass.UndoRedo)),ZSClass.USERINFO&&(t.data.UserInfo.CollaboratorList||(t.data.UserInfo.CollaboratorList={},t.data.UserInfo.CollaboratorList.getObj=function(e){return t.data.UserInfo.CollaboratorList[e]}),t.data.UserInfo.CollaboratorList[e]||(t.data.UserInfo.CollaboratorList[e]=new ZSClass.USERINFO)),ZSClass.Queue&&(t.data.UserInfo.Transients.InsertSheetXAIdQ||(t.data.UserInfo.Transients.InsertSheetXAIdQ={},t.data.UserInfo.Transients.InsertSheetXAIdQ.getObj=function(e){return t.data.UserInfo.Transients.InsertSheetXAIdQ[e]}),t.data.UserInfo.Transients.InsertSheetXAIdQ[e]||(t.data.UserInfo.Transients.InsertSheetXAIdQ[e]=new ZSClass.Queue),t.data.UserInfo.Transients.SheetMetaXAIdQ||(t.data.UserInfo.Transients.SheetMetaXAIdQ={},t.data.UserInfo.Transients.SheetMetaXAIdQ.getObj=function(e){return t.data.UserInfo.Transients.SheetMetaXAIdQ[e]}),t.data.UserInfo.Transients.SheetMetaXAIdQ[e]||(t.data.UserInfo.Transients.SheetMetaXAIdQ[e]=new ZSClass.Queue),t.data.UserInfo.Transients.InsertPivotSheetXAIdQ||(t.data.UserInfo.Transients.InsertPivotSheetXAIdQ={},t.data.UserInfo.Transients.InsertPivotSheetXAIdQ.getObj=function(e){return t.data.UserInfo.Transients.InsertPivotSheetXAIdQ[e]}),t.data.UserInfo.Transients.InsertPivotSheetXAIdQ[e]||(t.data.UserInfo.Transients.InsertPivotSheetXAIdQ[e]=new ZSClass.Queue)),t.data.UserInfo.isIncognito=!1},i.Document={Rename:function(e,o,r){t.data.getWorkBook(o,r).Name=e},FlushData:function(){t.data.DocRegistry={}},setEditable:function(e,o,r){var n=t.data.getWorkBook(e,o);n.setIsEditable(r)},setPublicPermission:function(e,o,r,n){var a=t.data.getWorkBook(e,o);"undefined"!=typeof r&&a.setShowFormula(r),"undefined"!=typeof n&&a.setAllowExport(n)},Create:function(e,o){var r=t.data.DocRegistry;!r[e]&&(r[e]={}),!r[e][o]&&(r[e][o]=new ZSClass.DocContainer(e,o)),!r[e][o].getWorkBook()&&r[e][o].addWorkBook(new ZSClass.WorkBook("",e,o))}},i.Sheet={setVisited:function(e,o,r){var n=r[s.ACTIVESHEET_NAME];if(!n)return void Logger.log("ActiveSheet is undefind");var a=t.data.getWorkBook(e,o),i=a.getSheetObj(n);i||(Logger.log("SHEET NOT AVAILABLE"),i=a.getSheetObj(a.SheetList[0].Id)),i.Visited=!0},Meta:function(e,o,r){var n=t.data.getWorkBook(e,r);n.removeAllSheets(),i.Sheet.Insert(e,o,r)},Insert:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.newSheet(o[a][0],o[a][1],o[a][2],o[a][3],o[a][4])},Remove:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.removeSheet(o[a][0])},Move:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.moveSheet(o[a][0],o[a][2])},Rename:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.renameSheet(o[a][0],o[a][1])},TabColor:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.tabColorSheet(o[a][0],o[a][3])},HideSheet:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.hideSheet(o[a][0],o[a][1],o[a][2],o[a][3])},UnHiddenSheets:function(e,o,r){for(var n=t.data.getWorkBook(e,r),a=0,s=o.length;s>a;a++)n.unHideSheet(o[a][0],o[a][1],o[a][2],o[a][3])}},i.ProtectedSheet={Modify:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.ProtectedSheets.modify(o[a][0],o[a][1])},Remove:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.ProtectedSheets.remove(o[a][0])}},i.Style={Cell:{Sync:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.CellStyle.replaceKey(a,o[a])},Append:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.CellStyle.addItem(a,o[a])},Meta:function(e,o,r){var n=t.data.getWorkBook(e,r);n.CellStyle.addJson(o)}},Row:{Sync:function(e,o,r){t.data.getWorkBook(e,r).RowStyle.syncStyleNames(o)},Append:function(e,o,r){t.data.getWorkBook(e,r).RowStyle.appendStyleNames(o)}},Col:{Sync:function(e,o,r){t.data.getWorkBook(e,r).ColStyle.syncStyleNames(o)},Append:function(e,o,r){t.data.getWorkBook(e,r).ColStyle.appendStyleNames(o)}}},i.Header={RowDef:function(e,o,r){o&&t.data.getWorkBook(e,r).RowStyle.resetAndAdd(o)},ColDef:function(e,o,r){o&&t.data.getWorkBook(e,r).ColStyle.resetAndAdd(o)}},i.FormSheets={Meta:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.FormSheets.set(o[a][0],o[a][1])},Add:function(e,o,r){var n=t.data.getWorkBook(e,r);n.FormSheets.set(o[0],o[1])},Delete:function(e,o,r){var n=t.data.getWorkBook(e,r);n.FormSheets.remove(o);var a=n.getSheetObj(o);a.Form.reset()},Modify:function(e,o,r){var n=t.data.getWorkBook(e,r);n.FormSheets.set(o[0],o[1])}},i.NamedRanges={Meta:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.NamedRange.add(o[a])},Modify:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.NamedRange.modify(o[a])},Delete:function(e,o,r){var n=t.data.getWorkBook(e,r);for(var a in o)n.NamedRange.remove(o[a])}},i.Pivot={Meta:function(o,s,i,S){var E=t.data.getWorkBook(o,i),I=e.ZSConstants.CommandConstants,d=t.data.getWorkBook(o,i).PivotCollection;for(var R in s){d.add(R,s[R]);var D=s[R][I.TARGET],c=E.getSheetObj(D[0]);c.Pivot.add(D[1],D[2],D[3],D[4],D[5]);var O=s[R][I.SOURCE],c=E.getSheetObj(O[0]);c.PivotSource.add(O[1],O[2],O[3],O[4],O[5]),r.publish(n.Listener,a.UserAction.PIVOT.RESUSCITATE_PIVOTMODEL,{pivotId:R,version:i}),d.setSheets(s[R][I.SOURCE],s[R][I.TARGET])}if("add"===S)for(var R in s)r.publish(n.Listener,a.UserAction.PIVOT.MOVE_ACTIVECELL,{pivotId:R})},Add:function(e,o,s){var S=(t.data.getWorkBook(e,s),t.data.getWorkBook(e,s).PivotCollection);S.remove("temp"),r.publish(n.Listener,a.UserAction.PIVOT.CHANGE_CREATEPIVOT_BUTTON,{setToGenerate:!0,isDisable:!0}),i.Pivot.Meta(e,o,s,"add")},Modify:function(e,t,o){r.publish(n.Listener,a.UserAction.PIVOT.CHANGE_CREATEPIVOT_BUTTON,{setToGenerate:!0,isDisable:!0}),i.Pivot.Remove(e,t,o),i.Pivot.Meta(e,t,o)},Remove:function(o,s,i){var S=t.data.getWorkBook(o,i),E=e.ZSConstants.CommandConstants,I=t.data.getWorkBook(o,i).PivotCollection;for(var d in s){var R=I.get(d)[E.TARGET],D=S.getSheetObj(R[0]);D.Pivot.remove(R[1],R[2],R[3],R[4]);var c=I.get(d)[E.SOURCE],D=S.getSheetObj(c[0]);D.Pivot.remove(c[1],c[2],c[3],c[4],c[5]),I.remove(d),r.publish(n.Listener,a.SheetAction.PIVOT.FILTER_REMOVE,{RID:o,SHEETID:R[0],VERSION:i,PIVOT_ID:d})}}},r.register(n.Listener,a.Parser.DOC.ONBEFORE,i.Document.Create,"RID","VERSION"),r.register(n.Listener,a.Parser.DOC.ONBEFORE,i.UpdateUserInfo,"RID","VERSION"),r.register(n.Listener,a.DocMeta.DOCUMENT_SET_EDITABLE,i.Document.setEditable,"RID","VERSION","ISEDITABLE"),r.register(n.Listener,a.DocMeta.DOCUMENT_SET_PERMISSION,i.Document.setPublicPermission,"RID","VERSION","showFormula","allowExport"),r.register(n.Listener,a.DocAction.DOCUMENT.CLOSE,i.Document.FlushData,"RID"),r.register(n.Listener,a.DocAction.DOCUMENT.RENAME,i.Document.Rename,"NEW_NAME","RESOURCE_ID","VERSION"),r.register(n.Listener,a.DocMeta.WORKSHEETS,i.Sheet.Meta,"RID","SHEET_NAME_LISTS","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.INSERT,i.Sheet.Insert,"RID","INSERT","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.DELETE,i.Sheet.Remove,"RID","DELETE","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.MOVE,i.Sheet.Move,"RID","MOVE","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.RENAME,i.Sheet.Rename,"RID","RENAME","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.TABCOLOR,i.Sheet.TabColor,"RID","TABCOLOR","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.HIDE_SHEETS,i.Sheet.HideSheet,"RID","meta","VERSION"),r.register(n.Listener,a.DocAction.WORKSHEETS.UNHIDE_SHEETS,i.Sheet.UnHiddenSheets,"RID","meta","VERSION"),r.register(n.Listener,a.DocMeta.PROTECTED_SHEETS,i.ProtectedSheet.Modify,"RID","PROTECTED_SHEETS","VERSION"),r.register(n.Listener,a.DocAction.PROTECTED_SHEETS.MODIFY,i.ProtectedSheet.Modify,"RID","MODIFY","VERSION"),r.register(n.Listener,a.DocAction.PROTECTED_SHEETS.REMOVE,i.ProtectedSheet.Remove,"RID","REMOVE","VERSION"),r.register(n.Listener,a.DocAction.CELL_STYLENAMES.SYNC,i.Style.Cell.Sync,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocAction.CELL_STYLENAMES.APPEND,i.Style.Cell.Append,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocMeta.CELL_STYLENAMES,i.Style.Cell.Meta,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocAction.ROW_HEADERS_DEFINITION.SYNC,i.Style.Row.Sync,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocAction.ROW_HEADERS_DEFINITION.APPEND,i.Style.Row.Append,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocMeta.ROW_HEADERS_DEFINITION,i.Header.RowDef,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocMeta.COLUMN_HEADERS_DEFINITION,i.Header.ColDef,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocAction.COLUMN_HEADERS_DEFINITION.SYNC,i.Style.Col.Sync,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocAction.COLUMN_HEADERS_DEFINITION.APPEND,i.Style.Col.Append,"RID","STYLES","VERSION"),r.register(n.Listener,a.DocMeta.FORM_SHEETS,i.FormSheets.Meta,"RID","FORMSHEETS","VERSION"),r.register(n.Listener,a.DocAction.FORM_SHEETS.ADD,i.FormSheets.Add,"RID","FORMSHEETS","VERSION"),r.register(n.Listener,a.DocAction.FORM_SHEETS.DELETE,i.FormSheets.Delete,"RID","FORMSHEETS","VERSION"),r.register(n.Listener,a.DocAction.FORM_SHEETS.MODIFY,i.FormSheets.Modify,"RID","FORMSHEETS","VERSION"),r.register(n.Listener,a.DocMeta.PIVOT,i.Pivot.Meta,"RID","PIVOT","VERSION"),r.register(n.Listener,a.DocAction.PIVOT.ADD,i.Pivot.Add,"RID","PIVOT","VERSION"),r.register(n.Listener,a.DocAction.PIVOT.DELETE,i.Pivot.Remove,"RID","PIVOT","VERSION"),r.register(n.Listener,a.DocAction.PIVOT.MODIFY,i.Pivot.Modify,"RID","PIVOT","VERSION"),r.register(n.Listener,a.DocMeta.NAMED_RANGE,i.NamedRanges.Meta,"RID","NAMEDRANGE","VERSION"),r.register(n.Listener,a.DocAction.NAMED_RANGE.ADD,i.NamedRanges.Meta,"RID","NAMEDRANGE","VERSION"),r.register(n.Listener,a.DocAction.NAMED_RANGE.MODIFY,i.NamedRanges.Modify,"RID","NAMEDRANGE","VERSION"),r.register(n.Listener,a.DocAction.NAMED_RANGE.REMOVE,i.NamedRanges.Delete,"RID","NAMEDRANGE","VERSION"),r.register(n.Listener,a.DocMeta.ACTIVE_INFO,i.Sheet.setVisited,"RID","VERSION","DATA")}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSEvents,i=t.topic,o=t.Groups,s=t.Names,E={NAME:0,ID:1,DESC:2,ARGS:3,RETURNTYPE:4,SCRIPT:5},c={Meta:function(e,t,i){var o=n.data.DocRegistry;!o[e]&&(o[e]={}),o[e].delugeFunctions=new ZSClass.Map;for(var s in i){var E=i[s];r.addFunction(e,t,E)}},Modify:function(e,n,t){r.addFunction(e,n,t)},Insert:function(e,n,t){r.addFunction(e,n,t)},Delete:function(e,n,t){r.deleteFunction(e,n,t)}},r={addFunction:function(e,t,i){var o=n.data.DocRegistry,s=i[E.NAME],c=i[E.ID],r=i[E.DESC],u=i[E.ARGS],D=i[E.RETURNTYPE],a=i[E.SCRIPT],R=new ZSClass.DelugeFunction(c,r,u,D,a);o[e].delugeFunctions||(o[e].delugeFunctions=new ZSClass.Map),o[e].delugeFunctions.set(s,R)},deleteFunction:function(e,t,i){var o=n.data.DocRegistry;for(var s in i)o[e].delugeFunctions.remove(i[s])}};i.register(o.Listener,s.DocMeta.DELUGE_FUNCTIONS,c.Meta,"RID","VERSION","DELUGE"),i.register(o.Listener,s.DocAction.DELUGE_FUNCTIONS.MODIFY,c.Modify,"RID","VERSION","DELUGE"),i.register(o.Listener,s.DocAction.DELUGE_FUNCTIONS.REMOVE,c.Delete,"RID","VERSION","DELUGE"),i.register(o.Listener,s.DocAction.DELUGE_FUNCTIONS.INSERT,c.Insert,"RID","VERSION","DELUGE")}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,i=a.topic,o=a.Groups,s=a.Names,r=(ZSConstants.CommandConstants,e.JSUtil,e.ZSDevTools.Logger,t.data.api),n={FlushView:function(){t.view.State={},t.view.State[t.view.getActiveGridID()]=new ZSClass.State,t.view.selectedSheets={},t.view.selectedSheets[t.view.getActiveGridID()]=[]},DocumentMeta:function(e,a,i){var o=t.data.DocRegistry,s=o[a][i].getWorkBook();s.Name=e}};r.Document.SharePublishMeta=function(e,a){var i=t.data.DocRegistry;!i[e]&&(i[e]={}),!i[e].SharePublishMeta&&(i[e].SharePublishMeta=new ZSClass.SharePublishMeta),i[e].SharePublishMeta.update(a)},r.Document.setPublicPermission=function(e,a,i,o){var s=t.data.DocRegistry,r=s[e][a].getWorkBook();"undefined"!=typeof i&&r.setShowFormula(i),"undefined"!=typeof o&&r.setAllowExport(o)},t.data.getWorkBook=function(e,a){var i=t.data.DocRegistry;if(i[e]&&i[e][a])return i[e][a].getWorkBook()},t.data.getSharePublishMeta=function(e){var a=t.data.DocRegistry;return a[e]?a[e].SharePublishMeta:void 0},i.register(o.Listener,s.DocAction.DOCUMENT.CLOSE,n.FlushView,"RID"),i.register(o.Listener,s.DocMeta.DOCUMENT_NAME,n.DocumentMeta,"DOCUMENT_NAME","RESOURCE_ID","VERSION"),i.register(o.Listener,s.ShareMeta.UPDATE,r.Document.SharePublishMeta,"RID","META"),i.register(o.Listener,s.DocMeta.DOCUMENT_SET_PERMISSION,r.Document.setPublicPermission,"RID","VERSION","showFormula","allowExport")}(this);
!function(e){for(var n=0,t=["ms","moz","webkit","o"],a=t.length;--a>-1&&!e.requestAnimationFrame;)e.requestAnimationFrame=e[t[a]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[t[a]+"CancelAnimationFrame"]||e[t[a]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(t){var a=(new e.Date).getTime(),i=e.Math.max(0,16-(a-n)),m=e.setTimeout(function(){t(a+i)},i);return n=a+i,m}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(n){e.clearTimeout(n)})}(this);
!function(e){function s(e,s){a.lastExecActionId=e,a.maxReceivedActionId=s}function t(){var e={};e.status="InQueue",a.Requests.push(e)}function r(e){a.currRequest=void 0==a.currRequest?0:a.currRequest+1;var s=a.Requests[a.currRequest];s.status="ReqSend",s.req=e}function u(e){var s=a.Requests[a.currRequest];s.status="QaidReceived",s.qaid=e}function i(e,s){a.maxReceivedActionId<e&&(a.maxReceivedActionId=e);var t={};t.status="InQueue/NotReceived",t.resp=s,a.Responses[e]=t}function n(e){a.lastExecActionId=e;var s=a.Responses[e];s&&(s.status="Processed")}var R=e.ZSEvents,c=R.topic,o=R.Groups,d=R.Names,g=e.ZSDevTools.Logger;g.ReqResp={};var a=g.ReqResp;a.lastExecActionId,a.maxReceivedActionId,a.Requests=[],a.currRequest,a.Responses={},c.register(o.Listener,d.ZSDebugger.logReqRespInit,s,"EXCUTED","RECEIVED"),c.register(o.Listener,d.ZSDebugger.logRequestAddedInQueue,t,"REQUEST"),c.register(o.Listener,d.ZSDebugger.logRequestSend,r,"REQUEST"),c.register(o.Listener,d.ZSDebugger.logQaidReceived,u,"QAID","REQUEST"),c.register(o.Listener,d.ZSDebugger.logResponseReceived,i,"XAID","RESPONSE"),c.register(o.Listener,d.ZSDebugger.logResponseProcessed,n,"XAID")}(this);
!function(e){function S(e){var S=e.data;switch(S.type){case"LSERVER_ACK":R.Interface.lServerAck(S.STATUS),!i.data.DocRegistry&&(i.data.DocRegistry={});break;case"ZSDebugger":I.publish(s.Listener,S.action,S.actionObj);break;case"Worker.Error":n.print.apply(n,e.data.error);break;case o.ServerAction.REQ_QSTATUS:I.publish(s.Listener,o.ServerAction.REQ_QSTATUS,{IsReqPending:S.IsReqPending,VERSION:S.version});break;case o.ServerAction.PROCESSTRIMCELLRESPONSE:var E={DOCID:S.DOCID,SHEETID:S.SHEETID,ROW_DATA:S.ROW_DATA,COLUMN_DATA:S.COLUMN_DATA,XAID:S.XAID,CONDITIONAL_FORMAT:S.CONDITIONAL_FORMAT&&S.CONDITIONAL_FORMAT[a.META],VERSION:S.VERSION};I.publish(s.Listener,o.ServerAction.PROCESSTRIMCELLRESPONSE,E);break;case o.ServerAction.PROCESSRESPONSE:r(S);break;case o.ServerAction.PROCESSTRIMFAULTYRESPONSE:var E={DOCID:S.DOCID,SHEETID:S.SHEETID,RANGES:S.RANGES,CELLS:S.CELLS,XAID:S.XAID};I.publish(s.Listener,o.ServerAction.PROCESSTRIMFAULTYRESPONSE,E);break;case o.ServerAction.PROCESSCFRESPONSE:var E={DOCID:S.DOCID,SHEETID:S.SHEETID,VERSION:S.VERSION,META:S.META,FAULTY_RANGES:S.FAULTY_RANGES,FAULTY_CELLS:S.FAULTY_CELLS,XAID:S.XAID};I.publish(s.Listener,o.ServerAction.PROCESSCFRESPONSE,E);break;case 100:delete S.type,R.Interface.receive(S);break;case o.GridAction.RELOAD:t(S);break;case o.GridAction.REFRESH:I.publish(s.Listener,o.GridAction.REFRESH,{RID:S.RID,SHEETID:S.SHEETID,VERSION:S.VERSION});break;case o.DocAction.SAVE_MSG.UPDATE:I.publish(s.Listener,o.DocAction.SAVE_MSG.UPDATE,{RID:S.RID,STATE:S.STATE,VERSION:S.version});break;case o.ERROR.SHOW:I.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:S.errorMsg});break;case o.WMSAction.ReJoin:I.publish(s.WMS,o.WMS.register);break;case o.PublicSheet.IDENDITY:I.publish(s.WMS,o.WMS.handleServerUp),i.data.TEMP_CONTAINER_IDENTITY=S.TEMP_CONTAINER_IDENTITY,I.publish(s.UI,o.Layout.PUBLISH_INFO_EDITOR.SHOW);break;case o.DocAction.BANNER.ADD:I.publish(s.Listener,o.DocAction.BANNER.ADD,{RESPONSE:S.RESPONSE});break;default:n.log("Unhandled Resp from worker : "+S.type),n.log(e.data)}}function E(e){n.log("worker onerror : ",e)}function r(e){var S=i.view.getActiveGridID(),E=i.view.getResourceID(S),r=i.view.getVersionID(S);I.publish(s.Listener,o.ServerAction.PROCESSRESPONSE,{RESPONSE:e.RESP,RID:E,VERSION:r})}function t(e){function S(){r=b}var E=i.view.getActiveGridID(),t=e.RID,R=i.view.getVersionID(E),A=i.data.getWorkBook(t,R),n=i.view.getSheetID(E),D=(A.getSheetObj(n),i.view.getSheetState(E,n)),c=D.getActiveRow(),T=D.getActiveCol(),O=D.getActiveRange(),N=i.view.CellEditor.getEditStatus(),C=D.getScrollTops()[0],L=D.getScrollLefts()[0],l=D.getScrollTops()[1],v=D.getScrollLefts()[1],b=r;r=function(e){var E=e.RESP,r=E[a.DOCUMENT_META][t][a.SHEET_META]&&E[a.DOCUMENT_META][t][a.SHEET_META][n],i=r&&r[a.ACTIVE_INFO];!N&&i?(i[a.ACTIVE_CELL]=[c,T],i[a.ACTIVE_RANGES]=[[O.startRow,O.startCol,O.endRow,O.endCol]],i[a.PERSISTED_POSITIONS]=[[C,L],[l,v]]):r&&delete r[a.ACTIVE_INFO],b(e),S()},I.publish(s.Listener,o.GridAction.RELOAD,{RID:e.RID,XAID:e.XAID,VERSION:e.VERSION})}var i=e.sPlusPlus,R=i.SML.Client,A=(e.ZSClass,e.ZSEvents),I=A.topic,s=A.Groups,o=A.Names,n=e.ZSDevTools.Logger,a=e.ZSConstants.CommandConstants;R.Listener={onSuccess:S,onErr:E}}(this);
!function(e){function t(e){for(var t=0,s=e.transientQueue.length;s>t;t++){var n=e.transientQueue[t];e.conn.post(n)}e.transientQueue=[]}function s(e,t,s){this.conn=e,this.holder=new n,this.transientQueue=[],this.conn.listen(t),this.conn.onErrorHandler(s),this.isLserverReady=0}function n(){this.reqId=0,this.holder=new r.Map}var i=e.sPlusPlus,r=e.ZSClass,o=i.SML.Client,h=e.ZSConstants.ResponseCode;s.prototype={lServerAck:function(e){this.isLserverReady=e,t(this)},send:function(e,t){var s=this.holder.hold(t,e);this.isLserverReady?this.conn.post(s):this.transientQueue.push(s)},receive:function(e){this.holder.process(e)}},n.prototype={hold:function(e,t){this.reqId>1e4?this.reqId=0:this.reqId;var s={};return s.KEY=this.reqId,s.VALUE=e,this.holder.set(this.reqId++,t),s},process:function(e){var t=this.holder.get(e.KEY);t(e.VALUE),e.VALUE.status!==h.ACKNOWLEDGE&&this.holder.remove(e.KEY)}},o.Utility.Manager=s}(this);
!function(e){function s(e,s){l.Interface.send(e.onreadystatechange.bind(e),s)}function t(){this.eventHandler={},this.state=0,n.data.SESSION_INFO&&(this.sessionID=n.data.SESSION_INFO.ID)}var n=e.sPlusPlus,r=e.ZSDevTools.Logger,a=e.ZSEvents,o=a.topic,i=a.Groups,c=a.Names,h=(e.ZSConstants.ActionConstants,e.ZSConstants.ResponseCode),l=n.SML.Client;t.prototype={open:function(e){this.URL=e},send:function(e){this.param=e;var t={url:this.URL,state:this.state,param:this.param};this.trigger("onBeforeSend",t),s(this,t),this.trigger("onAfterSend",t)},resend:function(){this.send(this.param)},abort:function(){},getResponseHeader:function(){},getAllResponseHeaders:function(){},addEventListeners:function(s,t){switch(s){case"onComplete":case"onBeforeSend":case"askConfirm":case"onAfterSend":case"onError":case"onTimeOut":case"onConnect":case"onAcknowledge":break;default:alert("invalid event for SMLWorkerRequest")}var n=e.Array.prototype.slice.call(arguments,2);this.eventHandler[s]||(this.eventHandler[s]=[]);var r={handler:t,params:n};this.eventHandler[s].push(r)},onreadystatechange:function(e){var s=e.status,t=n.data.SESSION_INFO;if(!t||!t.ID||void 0==this.sessionID||t.ID===this.sessionID)switch(s){case h.EXCEPTION:if(this.eventHandler.onError)this.trigger("onError",e.response);else{if(!e.response.mk)return void r.log("Error Key not came proper for URL"+this.URL);o.publish(i.Listener,c.ERROR.SHOW,{ERRORMSG:e.response.mk})}break;case h.SUCCESS:this.trigger("onComplete",e.response);break;case h.REDIRECT:this.state=e.response.state?e.response.state:this.state,this.trigger("askConfirm",e.response);break;case h.ACKNOWLEDGE:this.trigger("onAcknowledge",e.response);break;case h.INVALID:r.alert("warning","invalid request ",e);break;case h.TIMEOUT:this.trigger("onTimeOut",e.response),r.alert("warning","request timeout",e," URL : ",this.URL," Params : ",this.param);break;case h.CONNECT:this.trigger("onConnect",e.response);break;default:r.log("unhandled response ",e)}},trigger:function(e,s){var t=this.eventHandler[e];for(var n in t){var r=t[n];r.params.unshift(s),r.handler.apply(null,r.params)}}},l.Utility.WorkerRequest=t}(this);
!function(t){function e(){this.FormulaInfo=new i.Map,this.fmode=0,this.FormatPainter=null,this.isFormatPainterApplied=0}var i=(t.sPlusPlus,t.ZSClass);e.prototype={addSelection:function(t,e,n,r){if(this.FormulaInfo.get(t)){var a=this.FormulaInfo.get(t);a.ADD(e,n,r)}else{var o=new i.RangeList;o.ADD(e,n,r),this.FormulaInfo.set(t,o)}},clearRanges:function(t){if(this.FormulaInfo.get(t)){var e=this.FormulaInfo.get(t);e.CLEAR(),this.FormulaInfo.clear()}},clearSelection:function(t,e){if(this.FormulaInfo.get(t)){var i=this.FormulaInfo.get(t);i.clearSpecific(e),i&&0==i.getSize()&&this.FormulaInfo.clear()}},getRanges:function(t){var e=this.FormulaInfo.get(t);return e?e.getRangeList():void 0},getRange:function(t,e){var i=this.FormulaInfo.get(t);return i.getRange(e)},setMode:function(t){this.fmode=t},getMode:function(){return this.fmode},addFormatPainterRange:function(t,e,i,n,r,a,o,s,u){n.rId=t,n.sheetID=e,n.version=i,n.type=r,n.id=o,n.isServerClip=a,n.isCopy=s,n.isSingleTap=u,this.FormatPainter=n},getFormatPainterRange:function(){return this.FormatPainter},clearFormatPainter:function(){this.FormatPainter=null},setFormatPainterState:function(){this.isFormatPainterApplied=1},getFormatPainterState:function(){return this.isFormatPainterApplied},clearFormatPainterState:function(){this.isFormatPainterApplied=0},toString:function(){return JSON.stringify(this)}}}(this);
!function(t){var e=t.Array.prototype,n=function(){};n.prototype.enQueue=e.unshift,n.prototype._indexOf=e.indexOf,n.prototype.has=function(t){return-1!=this._indexOf(t)},n.prototype.getSize=function(){return this.length},n.prototype.deQueue=e.shift,t.ZSClass.Queue=n}(this);
!function(t){var e=function(){this.init()};e.prototype={init:function(){this.head={},this.head.length=0,this.head.next=this.head,this.head.prev=this.head,this.last=this.head},moveBackward:function(){if(0===this.head.length)return null;this.last=this.last.prev;var t=this.last.data;return this.display(),t},moveForward:function(){if(0===this.head.length)return null;this.last=this.last.next;var t=this.last.data;return this.display(),t},get:function(){return 0!==this.head.length?this.head.prev.data:null},getSize:function(){return this.head.length},isEmpty:function(){return 0===this.head.length},remove:function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev,this.head.length--},insertLast:function(t){var e={data:t,next:null,prev:null};e.prev=this.head.prev,e.next=this.head,this.head.prev.next=e,this.head.prev=e,this.last=e,this.head.length++},removeAll:function(t){if(t!==this.head){var e=t.next,h=this.head.prev;this.head.prev=t,t.next=this.head,delete e.prev,delete h.next}},display:function(){for(var t=this.head.next,e="%cHEAD%c -> ";t!==this.head;)e+=t!==this.last?t.data+" -> ":"%c"+t.data+" %c-> ",t=t.next;return e},iterate:function(t){var e=Array.prototype.slice.call(arguments,1),h=this.head.length,i=this.head.prev;for(e.unshift(i.data);h>0;)t.apply(void 0,e),i=i.prev,h--}},t.ZSClass.UndoRedoQueue=e}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSClass,o=s.UndoRedoQueue,i=function(){o.apply(this,arguments),this.lastAction=null,this.MAX=e.data.Defaults.MAX_UNDOREDO_COUNT,this.counter=new s.UndoRedoCounter,this.UndoTransientAO={},this.RedoTransientAO={}};i.prototype=o.prototype,i.prototype.add=function(t){this.head.length>=this.MAX&&this.remove(this.head.next),this.last.next===this.head?this.insertLast(t):(this.removeAll(this.last),this.insertLast(t)),this.counter.add()},i.prototype.undo=function(){this.last!==this.head&&(this.moveBackward(),this.counter.undo())},i.prototype.redo=function(){this.last.next!==this.head?(this.moveForward(),this.counter.redo()):this.head.next!==this.head.prev&&(this.add(this.last.data),this.counter.redo())},i.prototype.getNextNthData=function(t){for(var e=this.last,s=0;t>s;s++)e=e.next;return e.data},i.prototype.getPrevNthData=function(t){for(var e=this.last.next,s=0;t>s;s++)e=e.prev;return e.data},i.prototype.deQueue=function(t){for(var e=this.last,s=0;t>s;s++)e=e.next;this.remove(e)},i.prototype.isUndoPossible=function(){return this.counter.isUndoPossible()},i.prototype.isRedoPossible=function(){return this.counter.isRedoPossible()},i.prototype.getLastAction=function(){return this.lastAction},i.prototype.setLastAction=function(t){this.lastAction=t},s.UndoRedo=i}(this);
!function(o){var t=o.ZSDevTools.Logger,n=function(){this.redo_counter=0,this.undo_counter=0,this.MAX=o.sPlusPlus.data.Defaults.MAX_UNDOREDO_COUNT};n.prototype={isUndoPossible:function(){return!!this.undo_counter},isRedoPossible:function(){return!!this.redo_counter},add:function(){this.undo_counter<this.MAX&&this.undo_counter++,this.redo_counter=0},undo:function(){return this.undo_counter?(this.undo_counter--,this.redo_counter++,!0):(t.log("No more Undo actions!!!"),!1)},redo:function(){return this.undo_counter<this.MAX&&this.undo_counter++,this.redo_counter?(this.redo_counter--,!0):!1}},o.ZSClass.UndoRedoCounter=n}(this);
!function(t){function i(t,i,n){this.action=t,this.params=i,this.value=n}i.prototype={getAction:function(){return this.action},getValue:function(){return this.value},getParams:function(){return this.params}},t.ZSClass.ActionObject=i}(this);
!function(t){function o(){}var p=t.Array.prototype;o.prototype.push=p.push,o.prototype.pop=p.pop,o.prototype.empty=function(){return!this.length},o.prototype.getSize=function(){return this.length},o.prototype.getList=function(){return this},t.ZSClass.Stack=o}(this);
!function(t){function i(){this.copyRanges={},this.isCopy=void 0,this.visualCueStatus=0,this.isServerClip=!1}t.sPlusPlus;i.prototype={addCopyDetails:function(t,i,s,e,u,n){this.copyRanges.Sheets=i,this.copyRanges.Ranges=e,this.visualCueStatus=1,this.isServerClip=u,void 0!=n&&(this.isCopy=n)},clearCopyRange:function(){this.copyRanges={},this.isCopy=void 0,this.visualCueStatus=0,this.isServerClip=!1},isClipped:function(){return this.isServerClip},getCopyDetails:function(){return this.copyRanges},setCopyState:function(t){this.isCopy=t},getCopyState:function(){return this.isCopy},setVisualCueStatus:function(t){this.visualCueStatus=t},getVisualCueStatus:function(){return this.visualCueStatus},toString:function(){return JSON.stringify(this)}},t.ZSClass.USRActiveInfo=i}(this);
!function(e){function t(e,t,i,n){s.Range.call(this,e,t,i,n)}function i(e,t,i,n,o,a,h,r,l,d,g){s.Range.call(this,e,t,i,n),this.messageType=o,this.messageContent=a,this.helpMsg=h,this.type=r,this.isListRange=l,this.range=d,this.sort_asc=g}function n(e,t,i,n,o,a,h,r,l,d){s.Range.call(this,e,t,i,n),this.id=o,this.inputRange=a,this.outputRange=h,this.properties=r,this.orientationArray=l,this.orientationChangeable=d}{var o=e.sPlusPlus,s=e.ZSClass,a=o.data.Defaults,h=a.MAX_ROW,r=a.MAX_COL;e.Math}t.prototype=new s.Range,i.prototype=new s.Range,i.prototype.clone=function(){return new i(this.startRow,this.startCol,this.endRow,this.endCol,this.messageType,this.messageContent,this.helpMsg,this.type,this.isListRange,this.range)},n.prototype=new s.Range,n.prototype.clone=function(e,t,i,o){return new n(e,t,i,o,this.id,this.inputRange,this.outputRange,this.properties,this.orientationChangeable)};var l=function(e,o,a,l,d,g,R,u,c,w,C,m,p,F,A,M){M||(this.Merge=new s.RangeManagerExtended(s.Range,"removeOldAndAdd","checkRemoveExactRange","splitOldAndAddAcross")),this.Visited=!1,this.Prop=o,this.MaxUsedRow=0,this.MaxUsedCol=0,this.MaxUsedFormatRow=0,this.MaxUsedFormatCol=0,this.Row={},this.Column={},this.Row.FreezedCount=0,this.Column.FreezedCount=0,this.Ole={},this.ConditionalFormat={},this.Ole.Image=new s.OleInfo,this.Ole.Chart=new s.OleInfo,this.NamedRange=new s.RangeManager(s.Range,"simpleAdd","RemoveExactRange"),this.ProtectedRanges=new s.RangeManager(t,"splitOldAndAdd","splitRemoveRange"),this.CheckBoxRanges=new s.RangeManagerExtended(s.Range,"splitOldAndAdd","splitRemoveRange"),this.ConditionalFormat.Range=new s.RangeManager(s.Range,"splitOldAndAdd","checkRemoveExactRange"),this.ArrayFormula=new s.RangeManagerExtended(s.Range,"removeOldAndAdd","checkRemoveExactRange"),this.DataValidation=new s.RangeManagerExtended(i,"splitOldAndAdd","splitRemoveRange"),this.Pivot=new s.RangeManagerExtended(s.Range,"simpleAdd","RemoveExactRange"),this.PivotSource=new s.RangeManagerExtended(s.Range,"simpleAdd","RemoveExactRange"),this.Form=new s.RangeManager(s.Range,"simpleAdd","RemoveExactRange"),this.Row.Visibility=new s.Hidden(h,"ROW"),this.Row.Filter=new s.Hidden(h,"ROW"),this.Column.hidden=new s.Hidden(r,"COLUMN"),this.DataFilters=new s.RangeManager(s.DataFilter,"splitOldAndAdd","checkRemoveExactRange"),this.Notes=new s.Map,this.Buttons=new s.Map,this.Charts=new s.Map,this.Images=new s.Map,this.sparklines={},this.sparklines.cellRange={},this.sparklines.groupranges=new s.RangeManagerExtended(n,"splitOldAndAdd","splitRemoveRange"),this.ColStyleNames=new s.StyleNameArray(r)};l.prototype={onFreeze:function(e,t){this.Row.FreezedCount=e,this.Column.FreezedCount=t},onInsertRow:function(e,t){this.Merge._insertRow(e,t),this.CheckBoxRanges._insertRow(e,t),this.ProtectedRanges._insertRow(e,t),this.ArrayFormula._insertRow(e,t),this.DataValidation._insertRow(e,t),this.Pivot._insertRow(e,t),this.PivotSource._insertRow(e,t),this.DataFilters._insertRow(e,t),this.Row.Visibility.onInsert(e,t)},onDeleteRow:function(e,t){this.Merge._deleteRow(e,t),this.CheckBoxRanges._deleteRow(e,t),this.ProtectedRanges._deleteRow(e,t),this.Row.Visibility.onDelete(e,t),this.ArrayFormula._deleteRow(e,t),this.Pivot._deleteRow(e,t),this.PivotSource._deleteRow(e,t),this.DataFilters._deleteRow(e,t),this.DataValidation._deleteRow(e,t)},onInsertCol:function(e,t){this.Merge._insertCol(e,t),this.CheckBoxRanges._insertCol(e,t),this.ProtectedRanges._insertCol(e,t),this.ArrayFormula._insertCol(e,t),this.DataValidation._insertCol(e,t),this.Pivot._insertCol(e,t),this.PivotSource._insertCol(e,t),this.Column.hidden.onInsert(e,t),this.DataFilters._insertCol(e,t)},onDeleteCol:function(e,t){this.Merge._deleteCol(e,t),this.CheckBoxRanges._deleteCol(e,t),this.ProtectedRanges._deleteCol(e,t),this.DataValidation._deleteCol(e,t),this.ArrayFormula._deleteCol(e,t),this.Pivot._deleteCol(e,t),this.PivotSource._deleteCol(e,t),this.Column.hidden.onDelete(e,t),this.DataFilters._deleteCol(e,t)},onHideRow:function(e,t){this.Row.Visibility.onHide(e,t)},onShowRow:function(e,t){this.Row.Visibility.onShow(e,t)},onHideCol:function(e,t){this.Column.hidden.onHide(e,t)},onShowCol:function(e,t){this.Column.hidden.onShow(e,t)},clearFilter:function(e,t){this.Row.Filter.onShow(e,t)},onFilterRow:function(e,t){this.Row.Filter.onHide(e,t)},onMergeCell:function(e,t,i,n){this.Merge.add(e,t,i,n)},onMergeAcross:function(e,t,i,n){this.Merge.addAcross(e,t,i,n)},onSplitCell:function(e,t,i,n){this.Merge.remove(e,t,i,n)},onCreateArrayFormula:function(e,t,i,n){this.ArrayFormula.add(e,i,t,n)},onRemoveArrayFormula:function(e,t,i,n){this.ArrayFormula.remove(e,t,i,n)},toString:function(){var e=[];return e.push('"Visited":"'+this.Visited+'"'),this.Visited&&(this.Merge&&e.push('"Merge":'+this.Merge.toString()),this.NamedRange&&e.push('"NamedRange":'+this.NamedRange.toString()),this.ProtectedRanges&&e.push('"ProtectedRange":'+this.ProtectedRanges.toString()),this.CheckBoxRanges&&e.push('"CheckBox":'+this.CheckBoxRanges.toString()),this.ConditionalFormatting&&e.push('"ConditionalFormatting":'+this.ConditionalFormatting.toString()),this.ArrayFormula&&e.push('"ArrayFormula":'+this.ArrayFormula.toString()),this.DataValidation&&e.push('"DataValidation":'+this.DataValidation.toString()),this.Pivot&&e.push('"Pivot":'+this.Pivot.toString()),this.PivotSource&&e.push('"PivotSource":'+this.PivotSource.toString()),this.Form&&e.push('"Form":'+this.Form.toString()),this.Row&&e.push('"Row" : {"axis":'+this.Row.axis.toString()+',"Visibility":"'+this.Row.Visibility.toString()+'","FreezedCount":'+this.Row.FreezedCount+"}"),this.Column&&e.push('"Column" : {"axis":'+this.Column.axis.toString()+',"hidden":"'+this.Column.hidden.toString()+'","FreezedCount":'+this.Row.FreezedCount+"}"),this.DataFilters&&e.push('"DataFilters":'+this.DataFilters.toString()),this.ColStyleNames&&e.push('"ColStyleNames":'+this.ColStyleNames.toString())),"{"+e.join()+"}"}},s.Sheet=l}(this);
!function(t){function e(){}function i(t,i,h){this.Name=t,this.SheetList=new o.SheetList,this.ProtectedSheets=new e,this.RowStyle=o.HeadStyleDefinition(),this.ColStyle=o.HeadStyleDefinition(),this.CellStyle=new o.CellStyle,this.FormSheets=new o.FormSheets,this.PivotCollection=new o.Pivot.Collection,o.CommentController&&(this.CommentController=new o.CommentController),this.NamedRange=new o.NamedRange,this.isEdit=h===s.data.Defaults.version?!0:!1,this.isReady=0,this.CollaborationMode=1,this.isSavable=!0,this.highlightComments=!1,this.highlightLocks=!1,this.allowExport=!0,this.showFormulas=!0}var s=t.sPlusPlus,o=t.ZSClass;e.prototype={reset:function(){},remove:function(t){delete this[t]},modify:function(t,e){this[t]=e},isSheetLocked:function(t){return!!this[t]},toString:function(){return JSON.stringify(this)}},i.prototype={newSheet:function(t,e,i,s,h){var n=this.SheetList.create(e,t,i,s,h);return this[t]=new o.Sheet(e,n)},removeSheet:function(t){delete this[t],this.SheetList.removeById(t)},removeAllSheets:function(){this.SheetList.removeAll()},renameSheet:function(t,e){this.SheetList.renameById(t,e)},moveSheet:function(t,e){this.SheetList.moveById(t,e)},tabColorSheet:function(t,e){this.SheetList.setStyleById(t,e)},hideSheet:function(t){this.SheetList.setHidden(t,!0)},unHideSheet:function(t){this.SheetList.setHidden(t,!1)},getSheetObj:function(t){return this[t]},setIsEditable:function(t){this.isEdit=t},setAllowExport:function(t){this.allowExport=t},setShowFormula:function(t){this.showFormulas=t},isEditable:function(){return this.isEdit},toString:function(){var t=[];t.push('"DOCUMENT_NAME":"'+this.DOCUMENT_NAME+'"'),t.push('"SheetList":'+this.SheetList.toString()),t.push('"ProtectedSheets":'+this.ProtectedSheets.toString()),t.push('"RowStyle":'+this.RowStyle.toString()),t.push('"ColStyle":'+this.ColStyle.toString()),t.push('"CellStyle":'+this.CellStyle.toString()),t.push('"FormSheets":'+this.FormSheets.toString()),t.push('"Pivot":'+this.Pivot.toString()),t.push('"NamedRange":'+this.NamedRange.toString()),this.activeInfo&&t.push('"activeInfo":'+this.activeInfo.toString());for(var e=0;e<this.SheetList.length;e++){var i=this.SheetList[e].Id;t.push('"'+i+'":'+this[i].toString())}return"{"+t.join()+"}"}},o.WorkBook=i}(this);
!function(t){var o=t.sPlusPlus,i=t.ZSClass,e=o.data.Defaults,s=e.MAX_ROW,n=e.MAX_COL,p=e.ROW_PACK_SIZE,r=e.COL_PACK_SIZE,a=(t.Math,i.Sheet),l=function(t,o){a.apply(this,arguments),this.Prop=o,this.MaxScrolledRow=0,this.MaxScrolledCol=0,this.DVErrorInfo=new i.Map,this.Row.axis=new i.Axis(128,s,p),this.Row.auxiliaryAxis=new i.Axis(128,s,p),this.Column.axis=new i.Axis(16,n,r),this.setBorderZise(1)};l.prototype=new a,l.prototype.setBorderZise=function(t){this.Border_Size=(1-(t/5-.2)).toFixed(1)},l.prototype.HideGrid=function(t){this.IsShowGrid=t},l.prototype.onInsertRow=function(t,i,e){a.prototype.onInsertRow.apply(this,arguments),this.Row.axis.insert(t,i,e),this.Row.auxiliaryAxis.insert(t,i,e+o.data.Defaults.PADDING)},l.prototype.onDeleteRow=function(t,o){a.prototype.onDeleteRow.apply(this,arguments),this.Row.axis.del(t,o),this.Row.auxiliaryAxis.del(t,o)},l.prototype.onInsertCol=function(t,o,i){a.prototype.onInsertCol.apply(this,arguments),this.Column.axis.insert(t,o,i)},l.prototype.onDeleteCol=function(t,o){a.prototype.onDeleteCol.apply(this,arguments),this.Column.axis.del(t,o)},l.prototype.onHideRow=function(t,o){a.prototype.onHideRow.apply(this,arguments),this.Row.axis.setDim(t,o,0),this.Row.auxiliaryAxis.setDim(t,o,0)},l.prototype.onShowRow=function(t,i,e){a.prototype.onShowRow.apply(this,arguments),this.Row.axis.setDim(t,i,e),this.Row.auxiliaryAxis.setDim(t,i,e+o.data.Defaults.PADDING)},l.prototype.onHideCol=function(t,o){a.prototype.onHideCol.apply(this,arguments),this.Column.axis.setDim(t,o,0)},l.prototype.onShowCol=function(t,o,i){a.prototype.onShowCol.apply(this,arguments),this.Column.axis.setDim(t,o,i)},l.prototype.getId=function(){return this.Prop.Id},i.Sheet=l}(this);
!function(o){function r(r){this.worker=new o.Worker(r)}var t=o.sPlusPlus,n=t.SML.Client;r.prototype={post:function(o){this.worker.postMessage(o)},listen:function(o){this.worker.onmessage=o},onErrorHandler:function(o){this.worker.onerror=o}},n.Utility.Connector=r}(this);
!function(s){{var t=s.sPlusPlus||(s.sPlusPlus={});t.data.AppRegistry||(t.data.AppRegistry={})}}(this);
!function(t,s,e){var n=new s.Utility.Connector(e);s.Interface=new s.Utility.Manager(n,s.Listener.onSuccess,s.Listener.onErr)}(this.ZSEvents,this.sPlusPlus.SML.Client,this.sPlusPlus.data.AppRegistry.WorkerURI);
!function(t){function e(){this.cell,this.rID,this.sheetID,this.version,this.row,this.col,this.mode}e.prototype={add:function(t,e,i,n,s,o){this.cell=n,this.rID=t,this.sheetID=e,this.version=i,this.row=s,this.col=o},getCell:function(){return this.cell},setMode:function(t){this.mode=t},getMode:function(){return this.mode},getRID:function(){return this.rID},getSheetID:function(){return this.sheetID},getVersion:function(){return this.version},getRow:function(){return this.row},getCol:function(){return this.col}},t.ZSClass.UIEditCellInfo=e}(this);
!function(t){var e=t.sPlusPlus,n=new ZSClass.UIEditCellInfo,l="",u={};u.setValue=function(t){l=t},u.getValue=function(){return l},u.addEditCell=function(t,e,l,u,i,d){n.add(t,e,l,u,i,d),n.setMode(1)},u.clearEditCell=function(){n.setMode(0)},u.getEditCell=function(){return u.getEditStatus()?n:null},u.getEditStatus=function(){return n.getMode()},e.view.CellEditor=u}(this);
!function(e){function i(){this.inActiveBuffer=[],this.ActiveBuffer={}}var t=e.ZSClass;i.prototype={getTile:function(){if(this.inActiveBuffer.length){var e=this.inActiveBuffer.pop();return e.hide(),e}var e=new t.Tile(this);return e},removeTile:function(e){e.isAvailable()&&(e.clear(),this.inActiveBuffer.push(e))},clearBuffer:function(){for(var e in this.ActiveBuffer)this.removeTile(this.ActiveBuffer[e]);this.ActiveBuffer={}},getTileObject:function(e){return this.ActiveBuffer[e]},setTileObject:function(e,i){return this.ActiveBuffer[e]=i}},t.TileManager=i}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSClass,n=t.data.Defaults,i=(n.MAX_COL,e.ZSEvents),o=i.topic,r=i.Groups,s=i.Names,l=e.ZSDevTools.Logger,d=(e.JSUtil.Math,e.ZSChart,e.JSUtil),c=e.ZSEC.Encoder,C=e.ZSConstants.CommandConstants,p=t.view.Defaults.fontMap,u={BACKGROUNDCOLOR:0,COLOR:1,FONTSIZE:2,FONTNAME:3,FONTWEIGHT:4,FONTSTYLE:5,TEXTLINETHROUGHTSTYLE:6,TEXTUNDERLINESTYLE:7,TEXTWRAP:8,HALLIGN:9,VALLIGN:10,BORDER:11,HIDETEXT:12,ICONSET:13},v={BACKGROUNDCOLOR:0,FONTCOLOR:1,ISHIDETEXT:2},E={ICONID:0,ICONSET:1,DEFAULTICONSIZE:2,HIDETEXT:3},h={getStyle:function(e,a){var n=a.ConditionalFormat;if(void 0==n||0==n.length){var i=JSUtil.Object.clone(e,!0);return i[u.COLOR]=a.patternColor||e[u.COLOR]||"",i}for(var i=JSUtil.Object.clone(e,!0),o=!1,r=t.view.getActiveGridID(),s=t.view.getResourceID(r),l=t.view.getVersionID(r),d=t.data.getWorkBook(s,l),c=0;c<n.length;++c){var p;if(n[c][C.CONDITIONALFORMAT]){p=d.CellStyle.getStyleDef(n[c][C.CONDITIONALFORMAT]),p[u.COLOR]&&(o=!0);for(var h=0;10>=h;h++)switch(h){case u.BACKGROUNDCOLOR:case u.COLOR:case u.FONTWEIGHT:case u.FONTSTYLE:case u.TEXTLINETHROUGHTSTYLE:case u.TEXTUNDERLINESTYLE:i[h]=p[h]?p[h]:i[h]}var g=u.BORDER;i[g]||(i[g]=[]),1==i[g].length&&(i[g][1]=i[g][0],i[g][2]=i[g][0],i[g][3]=i[g][0]);for(var h=0;4>h;h++)i[g][h]||(i[g][h]=p[g][h]?p[g][h]:e[g][h])}else if(n[c][C.COLORSCALE])for(var T=n[c][C.COLORSCALE],I=0;3>I;I++)switch(I){case v.BACKGROUNDCOLOR:case v.FONTCOLOR:i[I]=T[I]?T[I]:i[I];break;case v.ISHIDETEXT:i[u.HIDETEXT]=!!T[I]}else if(n[c][C.ICONSET]){var O=n[c][C.ICONSET];i[u.ICONSET]=O,i[u.HIDETEXT]=O[E.HIDETEXT]}}return o||(i[u.COLOR]=a.patternColor||e[u.COLOR]||""),i},getCellStyleDef:function(a,n,i,o,r){var s=t.data.getWorkBook(a,i),l=s.getSheetObj(n),d=o.Format?o.Format:l.ColStyleNames.getStyle(r)?l.ColStyleNames.getStyle(r):"Default",c=e.JSUtil.Object.clone(s.CellStyle.getStyleDef(d),!0);("Default"===d||"Heading"===d||"Heading1"===d||"Result"===d||"Result1"===d)&&(c[0]=c[0]||"");var C=c[11];return 1==C.length&&(C[1]=C[0],C[2]=C[0],C[3]=C[0]),c},setCellStyleandData:function(e,a,n,i,o,r,s,d,c,C,p){var e=e.getDOM();c||l.log("404 : style Definition not found.",c);var v=t.view.getActiveGridID(),E=t.view.getResourceID(v),g=t.view.getVersionID(v),T=t.data.getWorkBook(E,g),I=T.getSheetObj(p),O=a.hasLink,S=("solid "+I.Border_Size+"px #DCDCDC",e.classList);this.flush(e,E,p,g,s,d),S.add("cell");var D=I.DataValidation.isXists(s,d);D&&"WARN"==D.root.messageType&&(0==a.IsContentValid?e.classList.add("dvInfo"):e.classList.remove("dvInfo")),(a.CellComment&&a.CellComment.length||D&&D)&&this.addCellHoverAction(e,a.CellComment,s,d,p,E,g,D,c[10]);var m=a.patternColor||c[1]||"",f=c[u.HIDETEXT]===!0,N=c[u.ICONSET],L=e;N&&(L=this.setIconSet(e,N)),f||(a.Hyperlink||1==O?this.addHyperlink(L,a.DisplayValue,a.Hyperlink,m,O):this.setNumberFormatValue(L,o?o:e.style.width,a,c[u.FONTSIZE]+"pt",c[u.FONTNAME],!0)||this.setCellValue(L,a.DisplayValue)),0==a.IsContentValid?e.classList.add("highlightInvalid"):e.classList.remove("highlightInvalid");var R=I.CheckBoxRanges;R.isXists(s,d)&&!a.Hyperlink&&1!=O&&this.drawCheckBox(E,p,g,s,d,e,a.DisplayValue,a);var y=I.sparklines.groupranges;e&&(h.setTop(e,i),h.setLeft(e,n),h.setHeight(e,r),h.setWidth(e,o),y.isXists(s,d)&&h.drawSparkline(p,e,s,d),h.setBGColor(e,c[u.BACKGROUNDCOLOR]||""),h.setForeColor(e,c[u.COLOR]||""),h.setFontSize(e,c[u.FONTSIZE]?c[u.FONTSIZE]+"pt":"10pt"),h.setFontFamily(e,c[u.FONTNAME]||""),R.isXists(s,d)||(h.setFontWeight(e,c[u.FONTWEIGHT]),h.setFontStyle(e,c[u.FONTSTYLE]),h.setTextDecoration(e,c[u.TEXTLINETHROUGHTSTYLE],c[u.TEXTUNDERLINESTYLE]),h.setWrap(e,c[u.TEXTWRAP]),h.setHAlign(e,c[u.HALLIGN],a,f),h.setVAlign(e,c[u.VALLIGN])),c[u.BORDER]&&h.setCellBorder(s,d,e,c[u.BORDER],p))},setNumberFormatValue:function(e,t,a,n,i,o){t=t?t:e.style.width;var r,s=a.DisplayValue;if(a.Pattern&&void 0!=a.Pattern[C.REPEATINDEX]&&void 0!=a.Pattern[C.REPEATCHAR]){var l=a.Pattern[C.REPEATINDEX];r=a.Pattern[C.REPEATCHAR];var d,c;s.length>0?(d=s.substring(0,l),c="  "+s.substring(l,s.length)):(d="",c=" ");var p=0,u=document.createElement("canvas"),v=u.getContext("2d");v.font=n+" "+i;var E=v.measureText(r),h=E.width;E=v.measureText(d),p+=E.width,E=v.measureText(c),p+=E.width;var g=(parseInt(t)-p)/h;s=g>1?d+r.repeat(Math.floor(g)):d;var T=e,I=parseInt(n);T.className.contains("gIS")?T.classList.add("rptOt"):(T=document.createElement("SPAN"),T.className="gIS",e.appendChild(T),I=0);var O=document.createElement("SPAN");return O.className="hasCnt rptChr",O.innerHTML=s,O.style.left=I+"pt",T.appendChild(O),o&&this.setCellValue(T,c),!0}return!1},resizeNumberFormatDiv:function(e){var t=e.DOM,a=t.style.fontSize,n=t.style.fontFamily,i=t.querySelector(".rptChr"),o=!1;i&&(t=t.querySelector(".gIS"),t.className.contains("rptOt")?t.removeChild(i):(e.DOM.removeChild(t),t=e.DOM,o=!0)),this.setNumberFormatValue(t,t.style.width,e.data,a,n,o)},flush:function(e,t,a,n,i,o){this.removeCellComment(e,t,a,n,i,o),e.className="",e.onmouseover="",e.onmouseout="",e.innerHTML=""},setTop:function(e,t){e.style.top=t+"px"},setLeft:function(e,t){e.style.left=t+"px"},setHeight:function(e,t){e.style.height=t+"px",0==t&&(e.style.padding="0px")},setWidth:function(e,t){e.style.width=t+"px",0==t&&(e.style.padding="0px")},onNonWrap:function(e){e.style.whiteSpace="pre"},onWrap:function(e){e.style.whiteSpace="normal"},hideGridLine:function(e,a,n,i){var o=t.view.getActiveGridID(),r=t.view.getResourceID(o),s=t.view.getVersionID(o),l=t.data.getWorkBook(r,s),d=l.getSheetObj(i),c=d.Row,C=d.Column,p=d.Border_Size+"px solid #DCDCDC",u=e.style.borderRight,v=e.style.borderBottom,E=e.style.borderRightColor,g=e.style.borderBottomColor,T="rgb(220, 220, 220)",I="#DCDCDC";u=n===C.FreezedCount-1?p:d.IsShowGrid?""===u?p:u:E===T||E===I?"":u,h.setBorderRight(e,u,i),v=a===c.FreezedCount-1?p:d.IsShowGrid?""===v?p:v:g===T||g===I?"":v,h.setBorderBottom(e,v,i)},setBorderRight:function(e,a,n){var i=t.view.getActiveGridID(),o=t.view.getResourceID(i),r=t.view.getVersionID(i),s=t.data.getWorkBook(o,r),l=s.getSheetObj(n),d="solid "+l.Border_Size+"px #DCDCDC",c="solid "+l.Border_Size+"px transparent",C=t.view.getSheetState(i,n),p=C.getZoom(),u=void 0!=l.IsShowGrid?!l.IsShowGrid:!1;if(a=h.replaceBorderStyle(a,d),a&&(a.contains("in")||a.contains("pt"))){var v=a.split(" ");for(var E in v)if(v[E].contains("in")||v[E].contains("pt"))var g=v[E];var T=parseFloat(g),I=(T/p).toFixed(3)+(a.contains("in")?"in":"pt");a=a.replace(g,I)}e.style.borderRight=""!==a&&"none"!==a?"transparent"===a?c:a:u?"":d},setBorderBottom:function(e,a,n){var i=t.view.getActiveGridID(),o=t.view.getResourceID(i),r=t.view.getVersionID(i),s=t.data.getWorkBook(o,r),l=s.getSheetObj(n),d="solid "+l.Border_Size+"px #DCDCDC",c="solid "+l.Border_Size+"px transparent",C=t.view.getSheetState(i,n),p=C.getZoom(),u=void 0!=l.IsShowGrid?!l.IsShowGrid:!1;if(a=h.replaceBorderStyle(a,d),a&&(a.contains("in")||a.contains("pt"))){var v=a.split(" ");for(var E in v)if(v[E].contains("in")||v[E].contains("pt"))var g=v[E];var T=parseFloat(g),I=(T/p).toFixed(3)+(a.contains("in")?"in":"pt");a=a.replace(g,I)}e.style.borderBottom=""!==a&&"none"!==a?"transparent"===a?c:a:u?"":d},setCellBorder:function(e,a,n,i,o){{var r=t.view.getActiveGridID(),s=t.view.getResourceID(r),l=t.view.getVersionID(r),d=t.data.getWorkBook(s,l),c=d.getSheetObj(o);"solid "+c.Border_Size+"px #DCDCDC"}h.setBorderRight(n,i[1],o),h.setBorderBottom(n,i[3],o)},replaceBorderStyle:function(e,t){return e&&e.contains("double-thin")?e=e.replace("double-thin","double"):e&&(e.contains("dash-dot-dot")||e.contains("dash-dot")||e.contains("fine-dashed"))&&(e=t),e},setBorderLeft:function(e){e.style.borderLeft=""},setBorderTop:function(e){e.style.borderTop=""},setBGColor:function(e,t){e.style.backgroundColor=t},setForeColor:function(e,t){e.style.color=t},setFontSize:function(e,t){e.style.fontSize=t},setFontFamily:function(e,t){p&&p[t]&&(t=p[t]),e.style.fontFamily=t},setFontWeight:function(e,t){t&&"normal"!==t&&e.classList.add("fwb")},setFontStyle:function(e,t){t&&"normal"!==t&&e.classList.add("fsi")},setTextDecoration:function(e,t,a){var n="";t&&(n="tds"),a&&(n=n?"tdsu":"tdu"),n&&e.classList.add(n)},setWrap:function(e,t){t&&e.classList.add("wrap"),(t||"wrap"===t)&&h.onWrap(e),(!t||"no-wrap"===t)&&h.onNonWrap(e)},setHAlign:function(e,t,a,n){var i=e.classList,o=a.CellType;if(a.Pattern&&void 0!=a.Pattern[C.REPEATINDEX]&&-1!=a.Pattern[C.REPEATINDEX])i.add("tar");else switch(t){case"start":break;case"center":i.add("tac");break;case"end":i.add("tar");break;default:("FLOAT"===o||"NUMBER"===o||"PERCENTAGE"===o||"CURRENCY"===o||"ACCOUNTING"===o||"DATE"===o||"TIME"===o||"DATETIME"===o||"FRACTION"===o||"SCIENTIFIC"===o||"BOOLEAN"===o||"SSN"===o||"ZIPCODE"===o||"ZIPCODE4"===o||"PHONENUMBER"===o)&&!n&&i.add("tar")}},setVAlign:function(e,t){var a=e.classList;switch(t){case"vtop":case"top":break;case"vcenter":case"middle":a.add("vam");break;case"vbottom":case"bottom":a.add("vab")}},addCellHoverAction:function(e,t,a,n,i,l,d){t&&t.length&&o.publish(r.Listener,s.CellAction.COMMENT.ADD,{RID:l,SHEETID:i,VERSION:d,ROW:a,COL:n,COMMENT:t});var c=e.classList;!c.contains("cellComment")&&t&&t.length&&c.add("cellComment"),e.onmouseover=function(){t&&t.length&&o.publish(r.Listener,s.CellAction.COMMENT.SHOW,{RID:l,SHEETID:i,VERSION:d,ROW:a,COL:n,COMMENT:t})},e.onmouseout=function(){c.contains("cellComment")&&o.publish(r.Listener,s.CellAction.COMMENT.HIDE)}},removeCellComment:function(e,t,a,n,i,l){o.publish(r.Listener,s.CellAction.COMMENT.DELETE,{RID:t,SHEETID:a,VERSION:n,ROW:i,COL:l})},dataValidation:function(e,t){var a=document.createElement("div");a.className="datavalid",e.textContent=t,e.appendChild(a)},addHyperlink:function(e,t,a,n,i){if(1!=i||a){var a=d.Cell.constructHyperLink(e,t,a,n,i,!1,UserAction.Goto);e.appendChild(a)}else for(var o=d.Cell.splitDisplayValue(t),r=0;r<o.length;r++)if(""!==o[r])if("\n"==o[r])e.innerHTML+="\n";else if(d.Cell.isWhiteListed(o[r])||o[r].startsWith("www.")||d.Cell.validateEmail(o[r])){var a=d.Cell.constructHyperLink(e,t,o[r],n,i,!0,UserAction.Goto);e.appendChild(a)}else e.innerHTML+=c.encodeForHTML(o[r])},setCellValue:function(e,t){var a=t.split("\n");e.appendChild(document.createTextNode(a[0]));for(var n=1;n<a.length;n++){var i=a[n];e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode(i))}},setIconSet:function(e,t){var a=t[E.ICONID],n=t[E.ICONSET],i=t[E.DEFAULTICONSIZE],o=t[E.HIDETEXT],r=document.createElement("span");r.className="gIS";var s=document.createElement("span");if(r.appendChild(s),("3Stars"===n||"3HeartRating"==n)&&1==a||-1!==n.indexOf("3Symbols")||-1!==n.indexOf("Smil")||"3Flags"===n||"5Quarters"===n||"2Love"==n&&1==a||"3TrafficLights2"==n||"5Weather"==n){var l=document.createElement("span");s.appendChild(l)}return s.className=h.getIconSet(n,a),i&&s.classList.add("dIS"),!o&&s.classList.add("hasCnt"),e.appendChild(r),r},clearCellStyles:function(e,a){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),o=t.view.getVersionID(n),r=t.data.getWorkBook(i,o),s=r.getSheetObj(a);e.style.backgroundColor="",e.style.color="",e.style.fontSize="10pt",e.style.fontFamily="",e.className="cell";var l="solid "+s.Border_Size+"px #DCDCDC";h.setBorderRight(e,l,a),h.setBorderBottom(e,l,a)},drawCheckBox:function(e,a,n,i,o,r,s,l){var d=r.classList;d.remove("tac","vam","tar","vab"),r.style.whiteSpace="",d.add("tac","vam");var c=document.createElement("label"),C=document.createElement("input"),p=document.createElement("span");switch(r.textContent=" ",c.className="cBC",C.className="checkk",p.className="sp",C.type="checkbox",c.align="center",r.appendChild(c).appendChild(C),r.appendChild(c).appendChild(p),"FLOAT"==l.CellType&&(s=0!=l.DisplayValue?"TRUE":"FALSE"),s){case"TRUE":C.checked=!0;break;case"FALSE":C.checked=!1}C.addEventListener("click",function(r){var s=t.data.getWorkBook(e,n),l=s.getSheetObj(a),d=l.ProtectedRanges.isXists(i,o),c=s.ProtectedSheets.isSheetLocked(a);return d||c||!s.isEditable()?(r.preventDefault(),!1):void UserAction.CHECKBOX_EDIT(e,[a],n,~~C.checked)})},drawSparkline:function(e,n,i,o){n.setAttribute("sparkline",!0);var r=t.view.getActiveGridID(),s=t.view.getResourceID(r),l=t.view.getVersionID(r),c=t.data.getWorkBook(s,l),C=c.getSheetObj(e),p=C.sparklines.groupranges.getInfo(i,o),u=C.sparklines.groupranges.getInfo(i,o);if(void 0!=u){var v=p.properties,E=d.SparklinePool.getDataRange(s,l,C,i,o);if(void 0!=E){var e=(p.id,E.sheetID),h=function(e){if(0==n.getElementsByClassName("sparkline").length){var t=(n.innerHTML,new a.Sparkline(i,o,n.style.height,n.style.width,v,E,e));n.hasAttribute("sparkline")&&void 0==t.undefined&&(n.prepend(t),n.removeAttribute("sparkline"))}};setTimeout(function(){n&&t.view.fetchRangeDataFromWorker(s,e,l,E.range,["ActualValue"],!v.hidden,r,h,function(){})},0)}}},resizeSparkline:function(e,t,a,n,i){var o=t.sparklines.groupranges.getInfo(n,i),r=t.Merge.getInfo(n,i);if(void 0!=a&&void 0!=o){var s=a.getElementsByClassName("sparkline")[0];void 0==s||parseInt(s.style.width)==parseInt(a.style.width)&&parseInt(s.style.height)==parseInt(a.style.height)-2||(a.removeChild(s),r?this.drawSparkline(e,a,r.startRow,r.startCol):this.drawSparkline(e,a,n,i))}}};a.CellDecorator=h}(this);
!function(I){function R(I,R){return-1==R?"iS-None":S[I+R]?S[I+R]:"iS-"+I+R}var S={},_=I.ZSConstants.IconSetConstants;S[_.IN_3ARROWS0]=S[_.IN_4ARROWS0]=S[_.IN_5ARROWS0]=S[_.IN_4RATING0]=_.IS_5ARROWS0,S[_.IN_3ARROWS1]=S[_.IN_5ARROWS2]=_.IS_5ARROWS2,S[_.IN_3ARROWS2]=S[_.IN_4ARROWS3]=S[_.IN_5ARROWS4]=S[_.IN_4RATING3]=_.IS_5ARROWS4,S[_.IN_3ARROWS3]=S[_.IN_4ARROWS1]=S[_.IN_5ARROWS1]=S[_.IN_4RATING1]=_.IS_5ARROWS1,S[_.IN_3ARROWS4]=S[_.IN_4ARROWS2]=S[_.IN_5ARROWS3]=S[_.IN_4RATING2]=_.IS_5ARROWS3,S[_.IN_3ARROWSGRAY0]=S[_.IN_4ARROWSGRAY0]=S[_.IN_5ARROWSGRAY0]=_.IS_5ARROWSGRAY0,S[_.IN_3ARROWSGRAY1]=S[_.IN_5ARROWSGRAY2]=_.IS_5ARROWSGRAY2,S[_.IN_3ARROWSGRAY2]=S[_.IN_4ARROWSGRAY3]=S[_.IN_5ARROWSGRAY4]=_.IS_5ARROWSGRAY4,S[_.IN_4ARROWSGRAY1]=S[_.IN_5ARROWSGRAY1]=_.IS_5ARROWSGRAY1,S[_.IN_4ARROWSGRAY2]=S[_.IN_5ARROWSGRAY3]=_.IS_5ARROWSGRAY3,S[_.IN_4REDTOBLACK3]=S[_.IN_3TRAFFICLIGHTS10]=S[_.IN_3TRAFFICLIGHTS0]=S[_.IN_4TRAFFICLIGHTS1]=S[_.IN_5TRAFFICLIGHTS2]=_.IS_5TRIFFICLIGHTS2,S[_.IN_3TRAFFICLIGHTS11]=S[_.IN_3TRAFFICLIGHTS1]=S[_.IN_4TRAFFICLIGHTS2]=S[_.IN_5TRAFFICLIGHTS3]=_.IS_5TRIFFICLIGHTS3,S[_.IN_3TRAFFICLIGHTS12]=S[_.IN_3TRAFFICLIGHTS2]=S[_.IN_4TRAFFICLIGHTS3]=S[_.IN_5TRAFFICLIGHTS4]=S[_.IN_3SIGNS2]=_.IS_5TRIFFICLIGHTS4,S[_.IN_4REDTOBLACK0]=S[_.IN_4TRAFFICLIGHTS0]=S[_.IN_5TRAFFICLIGHTS0]=S[_.IN_5RATINGS4]=S[_.IN_5QUARTERS4]=S[_.IN_5BOXES4]=_.IS_5TRIFFICLIGHTS0,S[_.IN_4REDTOBLACK1]=S[_.IN_5TRAFFICLIGHTS1]=_.IS_5TRIFFICLIGHTS1,S[_.IN_3SYMBOLS10]=S[_.IN_3SYMBOLS20]=_.IS_3SYMBOLS0,S[_.IN_3SYMBOLS11]=S[_.IN_3SYMBOLS21]=_.IS_3SYMBOLS1,S[_.IN_3SYMBOLS12]=S[_.IN_3SYMBOLS22]=_.IS_3SYMBOLS2,S[_.IN_3SMILEYS0]=S[_.IN_3COLORSMILIES0]=_.IS_5SMILEYS0,S[_.IN_3SMILEYS1]=S[_.IN_3COLORSMILIES1]=_.IS_5SMILEYS2,S[_.IN_3SMILEYS2]=S[_.IN_3COLORSMILIES2]=_.IS_5SMILEYS4,S[_.IN_5RATINGS0]=S[_.IN_5QUARTERS0]=S[_.IN_5BOXES0]=_.IS_5QUARTERS0,S[_.IN_5RATINGS1]=S[_.IN_5QUARTERS1]=S[_.IN_5BOXES1]=_.IS_5QUARTERS1,S[_.IN_5RATINGS2]=S[_.IN_5QUARTERS2]=S[_.IN_5BOXES2]=_.IS_5QUARTERS2,S[_.IN_5RATINGS3]=S[_.IN_5QUARTERS3]=S[_.IN_5BOXES3]=_.IS_5QUARTERS3,S[_.IN_3HEARTRATING2]=S[_.IN_2LOVE0]=_.IS_3HEART0,I.ZSClass.CellDecorator.getIconSet=R}(this);
!function(t){function i(t){this.DOM=t,this.data}var s=(t.sPlusPlus,t.ZSClass);i.prototype={append:function(t){return t.appendChild(this.DOM),this},getDOM:function(){return this.DOM},hide:function(t){this.DOM.style.display="none",t.hasChildNodes()&&t.removeChild(this.DOM)},clean:function(t){this.DOM.style.display="",t.appendChild(this.DOM)},setData:function(t){this.data=t},getData:function(){return this.data}},s.Cell=i}(this);
!function(t){function e(t){var e=t.createNewDocElement?t.createNewDocElement():document.createElement("div");return e.className="tileDOM",this.tileDOM=t.sheetTable.appendChild(e),this.inActiveAry=[],this.activeAry=[],this}var i=(t.sPlusPlus,t.ZSClass),n=i.Cell;e.prototype={hide:function(){this.tileDOM.style.display=""},clear:function(){this.hide();var t=this.activeAry,e=this.inActiveAry,i=this.tileDOM;t.forEach(function(t){t.forEach(function(t){t.hide(i),e.push(t)})}),this.tileDOM.innerHTML="",this.activeAry=[]},isAvailable:function(){return!!this.tileDOM},getCell:function(t){if(!this.inActiveAry||!this.inActiveAry.length){var e=new n(t.createNewDocElement?t.createNewDocElement():document.createElement("div"));return e.append(this.tileDOM)}var e=this.inActiveAry.pop();return e.clean(this.tileDOM),e},removeCell:function(t,e,i){var n=t.activeAry[e]?t.activeAry[e][i]:void 0;return n?(n.hide(this.tileDOM),delete t.activeAry[e][i],t.inActiveAry||(t.inActiveAry=[]),t.inActiveAry.push(n),n):!1},setTop:function(t){this.tileDOM.style.top=t+"px"},setLeft:function(t){this.tileDOM.style.left=t+"px"},getCellObject:function(t,e){return this.activeAry[t]?this.activeAry[t][e]:void 0},setCellObject:function(t,e,i){return this.activeAry[t]||(this.activeAry[t]=[]),this.activeAry[t][e]=i}},i.Tile=e}(this);
!function(e){function i(e,i,t){var o=e.startRow<i?i:e.startRow>t?t:e.startRow,s=e.endRow<i?i:e.endRow>t?t:e.endRow,a=new n.Range(o,e.startCol,s,e.endCol);return a}function t(e,i,t){var o=e.startCol<i?i:e.startCol>t?t:e.startCol,s=e.endCol<i?i:e.endCol>t?t:e.endCol,a=new n.Range(e.startRow,o,e.endRow,s);return a}function o(e,i,t,o){this.MyNaMe=i,this.sheetTable=t,this.mergeHolder=o,n.TileManager.call(this),s(this,n.TileManager),this.CELLUtil=n.CellDecorator,this.init()}function s(e,i){for(var t in i.prototype)e[t]=i.prototype[t]}var n=(e.ZSConstants.URI,e.ZSClass),a=e.ZSDevTools.Logger,r=e.sPlusPlus,l=r.data.Defaults,d=l.MAX_ROW,h=l.MAX_COL,v=e.ZSClass.Range,g=e.JSUtil.Math,C=8,H=4;o.prototype={init:function(){this.inActiveBuffer=[],this.ActiveBuffer={},this.iHave={startRow:-1,startCol:-1,endRow:-1,endCol:-1}},reset:function(e,i,t){this.iHave&&this.del(e,i,t,this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol,[-1,-1,-1,-1]);for(var o in this.mergeHolder.DOMList)this.mergeHolder.remove(e,i,t,o);this.init()},reload:function(e,i,t){this.loadBlockedCells(e,i,t,this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol)},load:function(e,i,t,o,s,n,r,l){if(o!==n&&s!==r){{new Date}if(o!==this.iHave.startRow||n!==this.iHave.endRow||s!==this.iHave.startCol||r!==this.iHave.endCol){if(o>this.iHave.endRow||n<this.iHave.startRow||s>this.iHave.endCol||r<this.iHave.startCol){this.clearBuffer();var d=this.sheetTable.childElementCount;this.inActiveBuffer.length!==d&&a.log("DOM TILE COUNT NOT MATCHES TO THE inActiveBuffer."),this.insert(e,i,t,o,s,n,r,l)}else o<this.iHave.startRow?this.insert(e,i,t,o,s,this.iHave.startRow,r,l):this.del(e,i,t,this.iHave.startRow,this.iHave.startCol,o,this.iHave.endCol,l,arguments),n>this.iHave.endRow?this.insert(e,i,t,this.iHave.endRow,s,n,r,l):this.del(e,i,t,n,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol,l,arguments),s<this.iHave.startCol?this.insert(e,i,t,o,s,n,this.iHave.startCol,l):this.del(e,i,t,this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,s,l,arguments),r>this.iHave.endCol?this.insert(e,i,t,o,this.iHave.endCol,n,r,l):this.del(e,i,t,this.iHave.startRow,r,this.iHave.endRow,this.iHave.endCol,l,arguments);{new Date}this.iHave.startRow=o,this.iHave.endRow=n,this.iHave.startCol=s,this.iHave.endCol=r,this.mergeHolder.deleteOnScroll(e,i,t,this.iHave)}}},insert:function(e,i,t,o,s,n,a,l){var d,v,f=r.data.getWorkBook(e,t).getSheetObj(i),R=f.Row,w=f.Column;o=R.Visibility.isHidden(o)?R.Visibility.nextNonHidden(o):o,s=w.hidden.isHidden(s)?w.hidden.nextNonHidden(s):s;for(var c=o;n>c;c=d){d=R.Visibility.nextNthNonHidden(c,C);for(var u=s;a>u;u=v)v=w.hidden.nextNthNonHidden(u,H),this.getTileObject(g.hash(c,u,h))||this.createTile(e,i,t,c,u,d,v,!1,l)}},del:function(e,i,t,o,s,n,a){var l=r.data.getWorkBook(e,t);if(o!==n&&s!==a&&l)for(var d=l.getSheetObj(i),v=d.Row,f=d.Column,R=o;n>R;R=v.Visibility.nextNthNonHidden(R,C))for(var w=s;a>w;w=f.hidden.nextNthNonHidden(w,H)){var c=this.getTileObject(g.hash(R,w,h));c&&(this.removeTile(c),delete this.ActiveBuffer[g.hash(R,w,h)])}},createTile:function(e,i,t,o,s,l,v,C,H){var f=["ActualValue","DisplayValue","Format","Formula","ConditionalFormat","CellComment","Hyperlink","CellType","patternColor","Pattern","IsContentValid","hasLink"],R=r.view.Defaults.activeGrid,t=r.view.getVersionID(R),w=r.data.getWorkBook(e,t).getSheetObj(i),c=w.Row,u=w.Column,b=this.getTile();b.endRow=l,b.endCol=v,!C&&this.setTileObject(g.hash(o,s,h),b);var y,O=[],m=[];for(l>=d-1&&l--,y=o;l>=y;y=c.Visibility.nextNonHidden(y))O.push(y);for(v>=h-1&&v--,y=s;v>=y;y=u.hidden.nextNonHidden(y))m.push(y);var x=function(o){this.loadCells(e,i,t,o,O,m),H&&-1!=O.indexOf(this.iHave.endRow)&&-1!=m.indexOf(this.iHave.endCol)&&H(!0)}.bind(this),B=function(e){a.log("info","------------> Req Failed : ",e);var i=new n.Range(o,s,l,v);i.intersects(this.iHave)&&this.removeTile(b),delete this.ActiveBuffer[g.hash(o,s,h)]}.bind(this);r.view.fetchData(e,i,t,O,m,f,R,x,B)},loadBlockedCells:function(e,i,t,o,s,n,a){for(var l,d,v=r.data.getWorkBook(e,t).getSheetObj(i),f=v.Row,R=v.Column,w=f.Visibility.isHidden(o)?f.Visibility.nextNonHidden(o):o,c=R.hidden.isHidden(s)?R.hidden.nextNonHidden(s):s,u=w;n>=u;u=l){l=f.Visibility.nextNthNonHidden(u,C);for(var b=c;a>=b;b=d)d=R.hidden.nextNthNonHidden(b,H),this.getTileObject(g.hash(u,b,h))&&this.createTile(e,i,t,u,b,l,d,!0)}},loadCells:function(e,i,t,o,s,l){if(!o||o.unavailable)return void a.alert("warning","plz dont send invalid data...Handle it onError",o);var d=s[0],v=l[0],f=s[C-1],R=l[H-1],w=r.data.getWorkBook(e,t).getSheetObj(i),c=w.Row,u=w.Column,b=c.auxiliaryAxis.getPos(d),y=u.axis.getPos(v),O=this.getTileObject(g.hash(d,v,h)),m={},x={},B={};if(O){{new n.Range(d,v,f,R)}O.setTop(b),O.setLeft(y),this.preFetchCellBorder(e,i,t,s,l,o,x,m);for(var V=C>s.length?s.length-1:C-1;V>=0;--V)for(var N=s[V],L=H>l.length?l.length-1:H-1;L>=0;--L){var D=l[L],k=w.Merge.isXists(N,D);if(k){var M=k.root.startRow,T=k.root.startCol;if(!B[g.hash(M,T,h)]){var F=new n.Range(k.root.startRow,k.root.startCol,k.root.endRow,k.root.endCol);this.mergeHolder.insert(e,i,t,F,o[N][D],x,m,this),B[g.hash(M,T,h)]=!0}}else{var j=O.getCellObject(V,L);j=j||O.getCell(this);var p=o[N][D],W=c.auxiliaryAxis.getPos(N),S=u.axis.getPos(D),A=c.auxiliaryAxis.getPos(N+1)-W,I=u.axis.getPos(D+1)-S;O.setCellObject(V,L,j),j.setData(p);var E=this.loadCellsUtility(e,i,t,N,D,p,x,m);this.CELLUtil.setCellStyleandData(j,p,S-y,W-b,I,A,N,D,E,void 0,i)}}this.setBorderCache(e,i,t,x,m)}},updateCells:function(e,i,t,o,s,n,l,d){var h=["DisplayValue","ActualValue","Format","Formula","ConditionalFormat","CellComment","Hyperlink","CellType","patternColor","Pattern","IsContentValid","hasLink"],v=r.view.Defaults.activeGrid,t=r.view.getVersionID(v),g=r.data.getWorkBook(e,t).getSheetObj(i),C=g.Row,H=g.Column;s=C.Visibility.isHidden(s)?C.Visibility.nextNonHidden(s):s,n=H.hidden.isHidden(n)?H.hidden.nextNonHidden(n):n;for(var f=[],R=[],w=s;l>=w;w=C.Visibility.nextNonHidden(w))f.push(w);for(w=n;d>=w;w=H.hidden.nextNonHidden(w))R.push(w);var c=function(o){this.iterateRangeAry(e,i,t,f,R,o,C,H)}.bind(this),u=function(e){a.log("info","------------> Req Failed1 : ",e)}.bind(this);r.view.fetchData(e,i,t,f,R,h,v,c,u)},iterateRangeAry:function(e,i,t,o,s,a,l,d){for(var v=r.data.getWorkBook(e,t).getSheetObj(i),C=v.Merge,H=new n.Range(o[0],s[0],o[o.length-1],s[s.length-1]),l=v.Row,d=v.Column,i=v.getId(),f={},R={},w=o.length-1;w>=0;--w){var c=o[w];if(!l.Visibility.isHidden(c))for(var u=s.length-1;u>=0;--u){var b=s[u];if(!d.hidden.isHidden(b)){{var y=C.isXists(c,b);r.data.getWorkBook(e,t)}if(y){var O=new n.Range(y.root.startRow,y.root.startCol,y.root.endRow,y.root.endCol);this.mergeHolder.insert(e,i,t,O,a[c][b],f,R,this)}else{var m=this.getCellRef(e,i,t,c,b);if(!m){var x=l.Visibility.getFloor(c).floor,B=d.hidden.getFloor(b).floor,V=this.getTileObject(g.hash(x,B,h)),N=new n.Range(this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol),L=new n.Range(x,B,x+1,B+1);if(!V){if(N.intersects(L)){var D=N.getIntersectingRange(L);this.insert(e,i,t,D.startRow,D.startCol,D.endRow,D.endCol)}continue}var m=this.createCellRef(c,b,V,l,d)}var k=a[c][b],M=d.axis.getPos(b)-d.axis.getPos(d.hidden.getFloor(b).floor),T=l.auxiliaryAxis.getPos(c)-l.auxiliaryAxis.getPos(l.Visibility.getFloor(c).floor),F=d.axis.getDim(b),j=l.auxiliaryAxis.getDim(c);m.setData(k);var p=this.pushDomUtility(e,i,t,c,b,k,f,R,H);this.CELLUtil.setCellStyleandData(m,k,M,T,F,j,c,b,p,void 0,i)}}}}this.setBorderCache(e,i,t,f,R)},createCellRef:function(e,i,t,o,s){var n=o.Visibility.getFloor(e).floor,a=s.hidden.getFloor(i).floor,r=o.Visibility.F.cardinality(n,e),l=s.hidden.F.cardinality(a,i),d=t.getCellObject(e-n-r,i-a-l),h=d||t.getCell(this);return!d&&t.setCellObject(e-n-r,i-a-l,h),h},onHideBefore:function(e,i,t,o,s){var n=r.data.getWorkBook(e,t).getSheetObj(i),a=n.Row,l=n.Column;if(-1!==this.iHave.startRow){var d="ROW"===o?a.Visibility:l.hidden,h=d.getFloor(s).floor,v=h===s?s:d.getCeil(s).ceil;"ROW"===o?v<this.iHave.endRow&&(this.del(e,i,t,v,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol,[this.iHave.startRow,this.iHave.startCol,v,this.iHave.endCol]),this.iHave.endRow=v):v<this.iHave.endCol&&(this.del(e,i,t,this.iHave.startRow,v,this.iHave.endRow,this.iHave.endCol,[this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,v]),this.iHave.endCol=v),(this.iHave.startRow===this.iHave.endRow||this.iHave.startCol===this.iHave.endCol)&&(this.iHave.startRow=-1,this.iHave.endRow=-1,this.iHave.startCol=-1,this.iHave.endCol=-1)}},refill:function(e,i,t,o,s){var n=r.data.getWorkBook(e,t).getSheetObj(i),a=n.Row,l=n.Column;if(-1!==this.iHave.startRow){var d="ROW"===o?a.Visibility:l.hidden;"ROW"===o&&d.isHidden(this.iHave.endRow)&&(this.iHave.endRow=d.getCeil(this.iHave.endRow).ceil),"ROW"!==o&&d.isHidden(this.iHave.endCol)&&(this.iHave.endCol=d.getCeil(this.iHave.endCol).ceil);var h=d.getFloor(s).floor,v=h===s?s:d.getCeil(s).ceil-1;"ROW"===o?s<this.iHave.endRow&&(this.updateCells(e,i,t,o,s,this.iHave.startCol,v,0===this.iHave.endCol?0:this.iHave.endCol-1),this.iHave.endRow=v>=0?a.Visibility.getCeil(v).ceil:-1,this.iHave.endCol=this.iHave.endCol-1>=0?l.hidden.getCeil(this.iHave.endCol-1).ceil:-1):s<this.iHave.endCol&&(this.updateCells(e,i,t,o,this.iHave.startRow,s,0===this.iHave.endRow?0:this.iHave.endRow-1,v),this.iHave.endCol=v>=0?l.hidden.getCeil(v).ceil:-1,this.iHave.endRow=this.iHave.endRow-1>=0?a.Visibility.getCeil(this.iHave.endRow-1).ceil:-1)}},onBeforeHideShowColumn:function(e,i,t,o,s){this.onColDeleteBefore(e,i,t,"COLUMN",o,s)},onBeforeHideShowRow:function(e,i,t,o,s){this.onRowDeleteBefore(e,i,t,"ROW",o,s)},onBeforeDataFilter:function(e,i,t,o,s,n){var a=r.data.getWorkBook(e,t).getSheetObj(i),l=a.Row;s=l.Visibility.getFloor(s).floor;var d=n.endRow-s;this.onRowDeleteBefore(e,i,t,"ROW",s,d)},onBeforeMerge:function(e,i,t,o,s){function n(e,i,t,o){o.removeCell(o,t,i)}function a(o,s,n){this.mergeHolder.remove(e,i,t,g.hash(s,n,h))}for(var l=new v(this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol),d=r.data.getWorkBook(e,t).getSheetObj(i),C=0;C<o.length;C++){var H=new v(o[C][0],o[C][1],o[C][2],o[C][3]);if(l.intersects(H)){var f=d.Merge,R=f.getIntersectedRanges(H);for(var w in R){var c=s?H:l,u=c.getIntersectingRange(R[w]);this.updateCells(e,i,t,"ROW",u.startRow,u.startCol,u.endRow,u.endCol)}this.iterateRange(e,i,t,o[C][0],o[C][1],o[C][2],o[C][3],null,n.bind(this),a.bind(this))}}},onRowInsertBefore:function(e,t,o,s,n,a){var l=r.data.getWorkBook(e,o).getSheetObj(t),g=l,C=g.Row.Visibility,H=C.getFloor(n).floor,f=C.getCeil(n).ceil-1;f=f+a>=d?d-1:C.getCeil(f+a).ceil-1;var R=0,w=l.Merge,c=w.getIntersectedRanges(new v(n,R,n+a-1,h-1));for(var u in c){var b=i(c[u],H,f),y=C.nextNonHidden(b.endRow);y=y>f?f:y;var O=y+a-1>f?f:y+a-1;this.onBeforeMerge(e,t,o,[[y,b.startCol,O,b.endCol]])}this.onHideBefore(e,t,o,s,n,a)},onRowDeleteBefore:function(e,t,o,s,n,a){var l=new v(this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol),g=new v(n,0,n+a-1,h-1);if(!l.intersects(g))return void this.onHideBefore(e,t,o,s,n,a);g=l.getIntersectingRange(g),n=g.startRow,a=g.endRow-g.startRow+1;var C=r.data.getWorkBook(e,o).getSheetObj(t),H=C,f=H.Row.Visibility,R=f.getFloor(n).floor,w=f.getCeil(n).ceil-1;w=w+a>=d?d-1:f.getCeil(w+a).ceil-1;var c=0,u=C.Merge,b=u.getIntersectedRanges(new v(R,c,w,h-1));for(var y in b){var O=b[y],g=i(O,R,w);if(n<O.startRow&&n+a-1>=O.endRow)var m=O.startRow,x=O.endRow;else if(O.intersects(new v(n,c,n+a-1,h-1)))var m=O.startRow,x=n;else{if(!(n<O.startCol))continue;var m=g.startRow-a<R?R:g.startRow-a,x=f.prevNonHidden(g.startRow);x=R>x?R:x}this.onBeforeMerge(e,t,o,[[m,g.startCol,x,g.endCol]],!0)}this.onHideBefore(e,t,o,s,n,a)},onColInsertBefore:function(e,i,o,s,n,a){var l=r.data.getWorkBook(e,o).getSheetObj(i),g=l,C=g.Column.hidden,H=C.getFloor(n).floor,f=C.getCeil(n).ceil-1;f=f+a>=h?h-1:C.getCeil(f+a).ceil-1;var R=0,w=l.Merge,c=w.getIntersectedRanges(new v(R,n,d-1,n+a-1));for(var u in c){var b=t(c[u],H,f),y=C.nextNonHidden(b.endCol);y=y>f?f:y;var O=y+a-1>f?f:y+a-1;this.onBeforeMerge(e,i,o,[[b.startRow,y,b.endRow,O]])}this.onHideBefore(e,i,o,s,n,a)},onColDeleteBefore:function(e,i,o,s,n,a){var l=r.data.getWorkBook(e,o).getSheetObj(i),g=new v(this.iHave.startRow,this.iHave.startCol,this.iHave.endRow,this.iHave.endCol),C=new v(0,n,d-1,n+a-1);if(!g.intersects(C))return void this.onHideBefore(e,i,o,s,n,a);C=g.getIntersectingRange(C),n=C.startCol,a=C.endCol-C.startCol+1;var H=l,f=H.Column.hidden,R=f.getFloor(n).floor,w=f.getCeil(n).ceil-1;w=w+a>=h?h-1:f.getCeil(w+a).ceil-1;var c=0,u=l.Merge,b=u.getIntersectedRanges(new v(c,R,d-1,w));for(var y in b){var O=b[y],C=t(O,R,w);if(n<O.startCol&&n+a-1>=O.endCol)var m=O.startCol,x=O.endCol;else if(O.intersects(new v(c,n,d-1,n+a-1)))var m=O.startCol,x=n;else{if(!(n<O.startCol))continue;var m=C.startCol-a<R?R:C.startCol-a,x=f.prevNonHidden(C.startCol);x=R>x?R:x}this.onBeforeMerge(e,i,o,[[C.startRow,m,C.endRow,x]],!0)}this.onHideBefore(e,i,o,s,n,a)},onRowInsert:function(e,i,t,o,s){this.mergeHolder.onRowHeaderAction(e,i,t,o,s),this.refill(e,i,t,"ROW",o,s)},onColInsert:function(e,i,t,o,s){this.mergeHolder.onColHeaderAction(e,i,t,o,s),this.refill(e,i,t,"COLUMN",o,s)},onRowDelete:function(e,i,t,o,s){this.mergeHolder.onRowHeaderAction(e,i,t,o,s),this.refill(e,i,t,"ROW",o,s)},onColDelete:function(e,i,t,o,s){this.mergeHolder.onColHeaderAction(e,i,t,o,s),this.refill(e,i,t,"COLUMN",o,s)},getBorderMergeTop:function(e,i,t,o,s,n,a,r,l){this.mergeHolder.getBorderTop(e,i,t,o,s,n,a,r,l)},getBorderMergeLeft:function(e,i,t,o,s,n,a,r,l){this.mergeHolder.getBorderLeft(e,i,t,o,s,n,a,r,l)},hideGridLine:function(e,i,t){var o=t[0],s=r.view.getActiveGridID(),n=r.view.getSheetID(s),a=this.iHave;if(o===n)for(var l=a.startRow;l<a.endRow;l++)for(var d=a.startCol;d<a.endCol;d++){var h=this.getCellRef(e,o,i,l,d);if(h){var v=h.getDOM();this.CELLUtil.hideGridLine(v,l,d,o)}}},getCellRef:function(e,i,t,o,s){var n=r.data.getWorkBook(e,t).getSheetObj(i),a=n.Row,l=n.Column;if(!a.Visibility.isHidden(o)&&!l.hidden.isHidden(s)){var d=n.Merge.isXists(o,s);if(d)return this.mergeHolder.DOMList[g.hash(d.root.startRow,d.root.startCol,h)];var v=a.Visibility.getFloor(o).floor,C=l.hidden.getFloor(s).floor,H=this.getTileObject(g.hash(v,C,h));if(H){var f=o-v,R=s-C,w=a.Visibility.F.cardinality(v,o),c=l.hidden.F.cardinality(C,s),u=H.getCellObject(f-w,R-c);return u}}},resizeRow:function(e,i,t,o,s){var n=r.data.getWorkBook(e,t).getSheetObj(i),a=n.Row,l=n.Column,d=o,v=o+s,C=a.Visibility.isHidden(d)?a.Visibility.nextNonHidden(d):d,H=a.Visibility.isHidden(v)?a.Visibility.prevNonHidden(v):v;if(!(C>this.iHave.endRow)){C=C<this.iHave.startRow?this.iHave.startRow:C,H=H>this.iHave.endRow?this.iHave.endRow:H;for(var f=a.Visibility.getFloor(C).floor,R=a.Visibility.getCeil(H).ceil,w=f;R>w;w=u){for(var c=a.auxiliaryAxis.getPos(w),u=a.Visibility.getCeil(w).ceil,b=this.iHave.startCol;b<this.iHave.endCol;b=l.hidden.getCeil(b).ceil){var y=this.getTileObject(g.hash(w,b,h));y&&y.setTop(c)}for(var O=w===f?C:w;u>O;O=a.Visibility.nextNonHidden(O))for(var m=a.auxiliaryAxis.getPos(O),x=m-c,B=a.auxiliaryAxis.getDim(O),V=this.iHave.startCol;V<this.iHave.endCol;V=l.hidden.nextNonHidden(V)){var N=this.getCellRef(e,i,t,O,V);N&&(this.CELLUtil.setTop(N.getDOM(),x),this.CELLUtil.setHeight(N.getDOM(),B),this.CELLUtil.resizeSparkline(i,n,N.DOM,O,V),this.CELLUtil.resizeNumberFormatDiv(N))}}for(var w=R;w<this.iHave.endRow;w=u)for(var c=a.auxiliaryAxis.getPos(w),u=a.Visibility.getCeil(w).ceil,b=this.iHave.startCol;b<this.iHave.endCol;b=l.hidden.getCeil(b).ceil){var y=this.getTileObject(g.hash(w,b,h));y&&y.setTop(c)}this.mergeHolder.onResizeRow(e,i,t,o,s,this.iHave)}},resizeCol:function(e,i,t,o,s){var n=r.data.getWorkBook(e,t).getSheetObj(i),a=n.Row,l=n.Column,d=o,v=o+s,C=l.hidden.isHidden(d)?l.hidden.nextNonHidden(d):d,H=l.hidden.isHidden(v)?l.hidden.prevNonHidden(v):v;if(!(C>this.iHave.endCol)){C=C<this.iHave.startCol?this.iHave.startCol:C,H=H>this.iHave.endCol?this.iHave.endCol:H;for(var f=l.hidden.getFloor(C).floor,R=l.hidden.getCeil(H).ceil,w=f;R>w;w=u){for(var c=l.axis.getPos(w),u=l.hidden.getCeil(w).ceil,b=this.iHave.startRow;b<this.iHave.endRow;b=a.Visibility.getCeil(b).ceil){var y=this.getTileObject(g.hash(b,w,h));y&&y.setLeft(c)}for(var O=w===f?C:w;u>O;O=l.hidden.nextNonHidden(O))for(var m=l.axis.getPos(O),x=m-c,B=l.axis.getDim(O),V=this.iHave.startRow;V<this.iHave.endRow;V=a.Visibility.nextNonHidden(V)){var N=this.getCellRef(e,i,t,V,O);N&&(this.CELLUtil.setLeft(N.getDOM(),x),this.CELLUtil.setWidth(N.getDOM(),B),this.CELLUtil.resizeSparkline(i,n,N.DOM,V,O),this.CELLUtil.resizeNumberFormatDiv(N))}}for(var w=R;w<this.iHave.endCol;w=u)for(var c=l.axis.getPos(w),u=l.hidden.getCeil(w).ceil,b=this.iHave.startRow;b<this.iHave.endRow;b=a.Visibility.getCeil(b).ceil){var y=this.getTileObject(g.hash(b,w,h));y&&y.setLeft(c)}this.mergeHolder.onResizeCol(e,i,t,o,s,this.iHave)}},isInsideGridView:function(e,i){return e<this.iHave.endRow&&e>=this.iHave.startRow&&i<this.iHave.endCol&&i>=this.iHave.startCol},onZoom:function(e,i,t,o,s,n,a){grid.load(e,i,t,o,n,s,a)},getMergeHolder:function(){return this.mergeHolder},iterateRange:function(e,i,t,o,s,l,d,v,C,H){if(!(0>o||0>s||0>l||0>d)){var f=r.data.getWorkBook(e,t).getSheetObj(i),R=new n.Range(o,s,l,d),w=R.getIntersectingRange(this.iHave);o=w.startRow,s=w.startCol,l=w.endRow,d=w.endCol;var c=f.Row,u=f.Column,b=f.Merge;a.isEnabled&&(this.window&&a.log("# CALLED FROM WINDOW CONTEXT INSTEAD GRID.",this.MyNaMe),v&&C&&H||(!v&&a.log("TILEFN missing"),!C&&a.log("CELLFN missing"),!H&&a.log("MCELLFN missing"))),o=c.Visibility.isHidden(o)?c.Visibility.nextNonHidden(o):o,s=u.hidden.isHidden(s)?u.hidden.nextNonHidden(s):s;for(var y=c.Visibility.getFloor(o),O=u.hidden.getFloor(s),m=c.Visibility.getCeil(l),x=u.hidden.getCeil(d),B=o,V=s,N=y.floor;N<m.ceil;N=c.Visibility.getCeil(N).ceil,B=N,V=s)for(var L=c.Visibility.getCeil(N).ceil,D=O.floor;D<x.ceil;D=u.hidden.getCeil(D).ceil,B=M,V=D){var k=u.hidden.getCeil(D).ceil,M=B,T=this.getTileObject(g.hash(N,D,h));if(v&&v(T,N,D,this.ActiveBuffer,N,D),T){var F;for(F=B>N?y.d:0;L>B&&l>=B;F++,B=c.Visibility.nextNonHidden(B),V=p){var j;j=V>D?O.d:0;for(var p=V;k>V&&d>=V;j++,V=u.hidden.nextNonHidden(V)){var W=b.isXists(B,V);if(W){if(!(B!==W.root.startRow&&B!==o||V!==W.root.startCol&&V!==s)){var S=g.hash(W.root.startRow,W.root.startCol,h);H&&H(this.mergeHolder.DOMList[S],W.root.startRow,W.root.startCol,this.mergeHolder.DOMList,B,V)}}else C&&C(T.getCellObject(F,j),j,F,T,B,V)}}}}}}},n.Pane=o}(this);
!function(t){function o(){var o=t.document.createElement("DIV");return o.style.position="absolute",o.style.top="0px",o.style.left="0px",o}function e(){var t=document.createElement("svg");return t}function s(t,o,s,n,a){var h=r.data.getWorkBook(t,s),d=h.getSheetObj(o),R=d.Row.auxiliaryAxis.getPos(n.startRow),w=d.Column.axis.getPos(n.startCol),D=d.Row.auxiliaryAxis.getPos(n.endRow+1),C=d.Column.axis.getPos(n.endCol+1),c=D-R,f=C-w,M=e();this.DOMList[a]=new l.UIProtectRangeCue(M,n),this.DOMList[a].paint(R,w,c,f),h.highlightLocks&&i(this.DOMList[a]),this.DOM.appendChild(M)}function i(t){t.addHighlight(c)}function n(t,o,e){e.removeHighlight()}function a(){this.DOM=o("lockedrange"),this.DOMList={}}var r=t.sPlusPlus,l=t.ZSClass,h=JSUtil.Math,d=l.Range,R=r.data.Defaults.MAX_COL,w=r.data.Defaults.MAX_ROW,D=t.ZSConstants,C=D.FeatureConstants,c=r.view.Toolbar.Feature[C.LOCK_CELLS],f=""===document.createElement("detect").style.zoom;a.prototype={init:function(t){t.appendChild(this.DOM)},setZoom:function(t){f?this.DOM.style.zoom=t:(this.DOM.style.transform="scale("+t+")",this.DOM.style.transformOrigin="0 0")},placeDom:function(t,o,e,i,n,a,r){var l=h.hash(i,n,R),w=new d(i,n,a,r);s.call(this,t,o,e,w,l)},splitRanges:function(t,o,e,s){for(var i in this.DOMList){var n=this.DOMList[i].range;if(s.intersects(n)){var a=n.startRow,r=n.startCol,l=n.endRow,h=n.endCol;this.DOMList[i]&&(this.DOMList[i].hide(),this.DOMList[i].remove(),delete this.DOMList[i]),a<s.startRow&&(this.placeDom(t,o,e,a,r,s.startRow-1,h),a=s.startRow),r<s.startCol&&(this.placeDom(t,o,e,a,r,l,s.startCol-1),r=s.startCol),l>s.endRow&&(this.placeDom(t,o,e,s.endRow+1,r,l,h),l=s.endRow),h>s.endCol&&this.placeDom(t,o,e,a,s.endCol+1,l,h)}}},modify:function(t,o,e,s){for(var i=(r.data.getWorkBook(t,e).getSheetObj(o),0);i<s.length;i++){var n=new d(s[i][0],s[i][1],s[i][2],s[i][3],s[i][4]);s[i][4]?(this.splitRanges(t,o,e,n),this.placeDom(t,o,e,s[i][0],s[i][1],s[i][2],s[i][3])):this.remove(t,o,e,[s[i]])}},add:function(t,o,e,s){{var i=r.data.getWorkBook(t,e);i.getSheetObj(o)}this.remove(t,o,e,s);for(var n=0;n<s.length;n++){{new d(s[n][0],s[n][1],s[n][2],s[n][3],s[n][4])}i.ProtectedSheets.isSheetLocked(o)||s[n][4]&&this.placeDom(t,o,e,s[n][0],s[n][1],s[n][2],s[n][3])}},remove:function(t,o,e,s){for(var i in s){var n=new d(s[i][0],s[i][1],s[i][2],s[i][3],s[i][4]);this.splitRanges(t,o,e,n)}},hide:function(){for(var t in this.DOMList)this.DOMList[t].remove(),delete this.DOMList[t]},show:function(t,o,e,s){for(var i in s)this.placeDom(t,o,e,s[i].startRow,s[i].startCol,s[i].endRow,s[i].endCol)},onRowInsert:function(t,o,e,s,i){for(var n in this.DOMList){var a=this.DOMList[n].range,r=a.startRow;if(r>=s){if(this.DOMList[n].remove(),delete this.DOMList[n],a.startRow===w-1&&a.startRow+i>=w)return;a.endRow=Math.min(a.endRow+i,w-1),a.startRow=Math.min(a.startRow+i,w-1),this.placeDom(t,o,e,a.startRow,a.startCol,a.endRow,a.endCol,n)}}},onColInsert:function(t,o,e,s,i){for(var n in this.DOMList){var a=this.DOMList[n].range,r=a.startCol;if(r>=s){if(this.DOMList[n].remove(),delete this.DOMList[n],a.startCol+i>=R)return;a.endCol=Math.min(a.endCol+i,R-1),a.startCol=Math.min(a.startCol+i,R-1),this.placeDom(t,o,e,a.startRow,a.startCol,a.endRow,a.endCol,n)}}},onRowDelete:function(t,o,e,s,i){for(var n in this.DOMList){var a=this.DOMList[n].range,r=a.startRow;if(r>=s){if(this.DOMList[n].remove(),delete this.DOMList[n],a.startRow-i<0)return;a.endRow=Math.max(a.endRow-i,0),a.startRow=Math.max(a.startRow-i,0),this.placeDom(t,o,e,a.startRow,a.startCol,a.endRow,a.endCol,n)}}},onColDelete:function(t,o,e,s,i){for(var n in this.DOMList){var a=this.DOMList[n].range,r=a.startCol;if(r>=s){if(this.DOMList[n].remove(),delete this.DOMList[n],a.startCol-i<0)return;a.endCol=Math.max(0,a.endCol-i),a.startCol=Math.max(0,a.startCol-i),this.placeDom(t,o,e,a.startRow,a.startCol,a.endRow,a.endCol,n)}}},onHideRow:function(t,o,e,s){for(var i in this.DOMList){var n=this.DOMList[i].range,a=n.startRow,r=n.endRow;(a>=s||r>=s)&&(this.splitRanges(t,o,e,new d(n.startRow,n.startCol,n.endRow,n.endCol)),this.placeDom(t,o,e,n.startRow,n.startCol,n.endRow,n.endCol))}},onShowRow:function(t,o,e,s,i){this.onHideRow(t,o,e,s,i)},onHideCol:function(t,o,e,s){for(var i in this.DOMList){var n=this.DOMList[i].range,a=n.startCol,r=n.endCol;(a>=s||r>=s)&&(this.splitRanges(t,o,e,new d(n.startRow,n.startCol,n.endRow,n.endCol)),this.placeDom(t,o,e,n.startRow,n.startCol,n.endRow,n.endCol))}},onShowCol:function(t,o,e,s,i){this.onHideCol(t,o,e,s,i)},onResize:function(t,o,e,s,i){for(var n in this.DOMList){var a=this.DOMList[n].range,r="ROW"===s?a.endRow:a.endCol;r>=i&&(this.splitRanges(t,o,e,a),this.placeDom(t,o,e,a.startRow,a.startCol,a.endRow,a.endCol))}},addHighlight:function(t,o,e){var s=r.data.getWorkBook(t,e);if(s.highlightLocks)for(var n in this.DOMList){var a=this.DOMList[n];i(a)}},removeHighlight:function(t,o,e){for(var s in this.DOMList){var i=this.DOMList[s];n(t,e,i)}},repaint:function(t,o,e){var s=r.data.getWorkBook(t,e),i=s.getSheetObj(o),n=i.ProtectedRanges.RangeList.masterList,a=[];for(var l in n){var h=n[l];a.push([h.startRow,h.startCol,h.endRow,h.endCol,!0])}this.add(t,o,e,a)}},t.ZSClass.ProtectHolder=a}(this);
!function(){function t(t){var e=document.createElement("div");return e.className="sheetMask",t.appendChild(e),e}function e(e){this.Dom=t(e),this.hide()}e.prototype={show:function(){this.Dom.style.display=""},hide:function(){this.Dom.style.display="none"}},ZSClass.ProtectSheetCue=e}(this);
!function(t){function e(){var e=t.document.createElement("DIV");return e.style.position="absolute",e.style.top="0px",e.style.left="0px",e}function s(){this.DOM=e()}var i=t.sPlusPlus,o=t.ZSClass,n=i.data.Defaults,l=(n.MAX_ROW,n.MAX_COL,t.JSUtil.Math,""===document.createElement("detect").style.zoom);!o.Filter&&(o.Filter={}),s.prototype={init:function(t){t.appendChild(this.DOM)},setZoom:function(t){l?this.DOM.style.zoom=t:(this.DOM.style.transform="scale("+t+")",this.DOM.style.transformOrigin="0 0")},remove:function(t){t.removeChild(this.DOM)}},o.Filter.IconHolder=s}(this);
!function(e){function t(){var t=e.document.createElement("DIV");return t.className="fP",t}function i(){}{var n=(e.sPlusPlus,e.ZSClass),s=e.ZSEvents;s.topic,s.Groups,s.Names}i.prototype={place:function(i,n,s,l,c,o,h){this.elem=t();var p=e.document.createElement("img");p.className="filterIcon",p.src=o,p.style.height=l+"px",p.style.width=c+"px",this.elem.style.top=n+"px",this.elem.style.left=s+"px",p.addEventListener("mousedown",function(e){h&&h(this),e.stopPropagation()}),p.addEventListener("dblclick",function(e){e.stopPropagation()}),this.elem.appendChild(p),i.appendChild(this.elem)},changeIcon:function(e){this.elem.children[0].src=e},rePosition:function(e,t){e&&(this.elem.style.top=e+"px"),t&&(this.elem.style.left=t+"px")},changeIconSize:function(e,t){e&&(this.elem.children[0].style.width=e+"px"),t&&(this.elem.children[0].style.height=t+"px")}},n.Filter.Icon=i}(this);
!function(t){function e(){var e=t.document.createElement("DIV");return e.style.position="absolute",e.style.top="0px",e.style.left="0px",e}function o(){return document.createElement("div")}function r(){this.DOM=e("mergeDOM"),this.DOMList={},this.DOMBuffer=[],this.CELLUtil=i.CellDecorator}var s=t.sPlusPlus,i=t.ZSClass,a=t.ZSDevTools.Logger,n=JSUtil.Math,l=i.Range,h=i.Cell,g=s.data.Defaults.MAX_COL,d=s.data.Defaults.MAX_ROW,C="transparent",R=""===document.createElement("detect").style.zoom;r.prototype={init:function(t){t.appendChild(this.DOM)},setZoom:function(t){R?this.DOM.style.zoom=t:(this.DOM.style.transform="scale("+t+")",this.DOM.style.transformOrigin="0 0")},create:function(t,e,o,r,s,i,a,n){var h=new l(r,s,i,a);this.insert(t,e,o,h,null,{},{},n)},removeDom:function(t,e,o,r,i,a,h,d){var C=s.data.getWorkBook(t,o),R=C.getSheetObj(e),f=new l(r,i,a,h),v=R.Merge,w=v.getIntersectedRanges(f),u=new l(d.startRow,d.startCol,d.endRow-1,d.endCol-1),D=u.getIntersectingRange(f);for(var L in w)if(v.isRangeAcross(w[L])){w[L]=D.getIntersectingRange(w[L]);for(var M=w[L].startRow;M<=w[L].endRow;M++)this.remove(t,e,o,n.hash(M,w[L].startCol,g))}else this.remove(t,e,o,n.hash(w[L].startRow,w[L].startCol,g))},insert:function(t,e,o,r,i,l,h,d){i=null;var C=["DisplayValue","Format","Formula","ConditionalFormat","CellComment","Hyperlink","CellType","patternColor","Pattern","IsContentValid","hasLink"],R=s.view.Defaults.activeGrid,o=s.view.getVersionID(R),f=s.data.getWorkBook(t,o),v=f.getSheetObj(e),w=r.startRow,u=r.startCol,e=v.getId(),D=v.Row,L=v.Column,M=v.Merge.getInfo(w,u);if(!M)return void a.log("%c there is no merge Obj ","background:#F00","   : ",w,u);{var O=this.DOMList[n.hash(M.startRow,M.startCol,g)],c=v.Row.auxiliaryAxis.getPos(M.startRow),m=v.Column.axis.getPos(M.startCol),p=v.Row.auxiliaryAxis.getPos(M.endRow+1)-c,E=v.Column.axis.getPos(M.endCol+1)-m;D.Visibility.prevNonHidden(w),L.hidden.prevNonHidden(u)}if(O){var y=O.getDOM(),S=v.sparklines.groupranges;if(S.isXists(r.startRow,r.startCol)){var b=v.Merge.getInfo(r.startRow,r.startCol);b.startRow==r.startRow&&b.startCol==r.startCol&&this.CELLUtil.drawSparkline(e,y,r.startRow,r.startCol)}this.CELLUtil.setTop(y,c),this.CELLUtil.setLeft(y,m),this.CELLUtil.setHeight(y,p),this.CELLUtil.setWidth(y,E)}if(i){var k=this.getDOM(t,e,o,M.startRow,M.startCol);this.DOMList[n.hash(M.startRow,M.startCol,g)]=k,k.setData(i);var B=this.insertUtility(t,e,o,M.startCol,r,i,l,h);this.CELLUtil.setCellStyleandData(k,i,m,c,E,p,M.startRow,M.startCol,B,void 0,e),k.append(this.DOM)}else{var x=v.Column.hidden.prevNonHidden(r.endCol+1),U=v.Row.Visibility.prevNonHidden(r.endRow+1),A=function(s){var i=this.getDOM(t,e,o,M.startRow,M.startCol);this.DOMList[n.hash(M.startRow,M.startCol,g)]=i;var a=s[w][u];a.bottomBorder={Format:s[U][u].Format},a.rightBorder={Format:s[w][x].Format},i.setData(a);var C=this.insertUtility(t,e,o,M.startCol,r,a,l,h);this.CELLUtil.setCellStyleandData(i,a,m,c,E,p,M.startRow,M.startCol,C,void 0,e),i.append(this.DOM),d.setBorderCache(t,e,o,l,h)}.bind(this),H=function(t){a.log("info","------------> Req Failed2 : ",t)}.bind(this);s.view.fetchData(t,e,o,[w,U],[u,x],C,R,A,H)}},insertUtility:function(t,e,o,r,a,n,l,h){var g=s.data.getWorkBook(t,o),d=a.endRow,R=a.endCol,f=a.startRow,v=a.startCol,w=i.CellDecorator.getCellStyleDef(t,e,o,n,r);w=i.CellDecorator.getStyle(w,n);var u=JSUtil.Object.clone(w,!0),D=u[11];if(n.rightBorder){var L=g.CellStyle.getStyleDef(n.rightBorder.Format);D[1]=1==L[11].length?D[0]:L[11][1]}if(n.bottomBorder){var M=g.CellStyle.getStyleDef(n.bottomBorder.Format);D[3]=1==M[11].length?D[0]:M[11][3]}return""!==u[0]&&((""===D[0]||"none"===D[0])&&(D[0]=C),(""===D[2]||"none"===D[2])&&(D[2]=C),(""===D[1]||"none"===D[1])&&(D[1]=C),(""===D[3]||"none"===D[3])&&(D[3]=C)),h=this.getBorderLeft(t,e,o,d,R,D[0],f,v,h),l=this.getBorderTop(t,e,o,d,R,D[2],f,v,l),u},getBorderLeft:function(t,e,o,r,i,a,l,h,d){var C=s.data.getWorkBook(t,o),R=C.getSheetObj(e),f=R.Row,v=R.Column,w=v.hidden.prevNonHidden(h);if(w>=0)for(var u=l;r>=u;u=f.Visibility.nextNonHidden(u))!R.Merge.isXists(u,w)&&(d[n.hash(u,w,g)]=a)},getBorderTop:function(t,e,o,r,i,a,l,h,d){var C=s.data.getWorkBook(t,o),R=C.getSheetObj(e),f=R.Row,v=R.Column,w=f.Visibility.prevNonHidden(l);if(w>=0)for(var u=h;i>=u;u=v.hidden.nextNonHidden(u))!R.Merge.isXists(w,u)&&(d[n.hash(w,u,g)]=a)},deleteOnScroll:function(t,e,o,r){var i=s.data.getWorkBook(t,o),a=i.getSheetObj(e),n=new l(r.startRow,r.startCol,r.endRow-1,r.endCol-1);for(var h in this.DOMList)a.Merge.RangeList.masterList[h]&&!n.intersects(a.Merge.RangeList.masterList[h])&&this.remove(t,e,o,h)},remove:function(t,e,o,r){var s=this.DOMList[r];return delete this.DOMList[r],s?(s.hide(this.DOM),void this.DOMBuffer.push(s)):void a.log("DOMList obj is undefined..",r)},onRowHeaderAction:function(t,e,o,r,i){var a=(s.data.Defaults.CELL_PADDING,s.data.getWorkBook(t,o)),h=a.getSheetObj(e);for(var d in this.DOMList){var C=n.quotient(d,g);C>=r&&this.remove(t,e,o,d)}var R=r+i-1,f=h.Merge.getIntersectedRanges(new l(r,0,R,g));for(var d in f){var v=f[d];if(!h.Merge.isRangeAcross(v)){var w=this.DOMList[n.hash(v.startRow,v.startCol,g)],u=h.Row.auxiliaryAxis.getPos(v.startRow),D=h.Row.auxiliaryAxis.getPos(v.endRow+1)-u;if(w){var L=w.getDOM();this.CELLUtil.setHeight(L,D)}}}},onColHeaderAction:function(t,e,o,r,i){var a=s.data.getWorkBook(t,o),h=a.getSheetObj(e);for(var C in this.DOMList){var R=n.remainder(C,g);R>=r&&this.remove(t,e,o,C)}var f=r+i-1,v=h.Merge.getIntersectedRanges(new l(0,r,d,f));for(var C in v){var w=v[C],u=this.DOMList[n.hash(w.startRow,w.startCol,g)],D=h.Column.axis.getPos(w.startCol),L=h.Column.axis.getPos(w.endCol+1)-D;if(u){var M=u.getDOM();this.CELLUtil.setWidth(M,L)}}},onResizeRow:function(t,e,o,r,a,h){var d=s.data.getWorkBook(t,o),C=d.getSheetObj(e),R=C.Merge.getIntersectedRanges(new l(r,h.startCol,h.endRow-1,h.endCol-1)),f=[],v=0;for(var w in R)if(C.Merge.RangeList.cellRangeAcross[n.hash(R[w].startRow,R[w].startCol,g)])for(var u=R[w].startRow;u<=R[w].endRow;u++)f[v++]=new i.Range(u,R[w].startCol,u,R[w].endCol);else f[v++]=R[w];R=f;for(var w in R){var D=R[w],L=this.DOMList[n.hash(D.startRow,D.startCol,g)],M=C.Row.auxiliaryAxis.getPos(D.startRow),O=C.Row.auxiliaryAxis.getPos(D.endRow+1)-M;L&&this.CELLUtil.setTop(L.getDOM(),M),L&&this.CELLUtil.setHeight(L.getDOM(),O),L&&this.CELLUtil.resizeSparkline(e,d.getSheetObj(e),L.DOM,D.startRow,D.startCol)}},onResizeCol:function(t,e,o,r,a,h){var d=s.data.getWorkBook(t,o),C=d.getSheetObj(e),R=C.Merge.getIntersectedRanges(new l(h.startRow,r,h.endRow-1,h.endCol-1)),f=[],v=0;for(var w in R)if(C.Merge.RangeList.cellRangeAcross[n.hash(R[w].startRow,R[w].startCol,g)])for(var u=R[w].startRow;u<=R[w].endRow;u++)f[v++]=new i.Range(u,R[w].startCol,u,R[w].endCol);else f[v++]=R[w];R=f;for(var w in R){var D=R[w],L=this.DOMList[n.hash(D.startRow,D.startCol,g)],M=C.Column.axis.getPos(D.startCol),O=C.Column.axis.getPos(D.endCol+1)-M;L&&this.CELLUtil.setLeft(L.getDOM(),M),L&&this.CELLUtil.setWidth(L.getDOM(),O),L&&this.CELLUtil.resizeSparkline(e,d.getSheetObj(e),L.DOM,D.startRow,D.startCol)}},getDOM:function(t,e,r,s,i){if(this.DOMList[n.hash(s,i,g)])return a.isEnabled&&a.log("CHECK HERE : MERGE CELL ALREADY THERE AND TRYING TO GET A NEW ONE.",s,i),this.DOMList[n.hash(s,i,g)];if(!this.DOMBuffer.length){var l=new h(o()),d=l.getDOM();return d.setAttribute("class","mC"),d.className="mC",l}var l=this.DOMBuffer.pop();return l.clean(this.DOM),l}},t.ZSClass.MergeComponent=r}(this);
!function(e){var t=e.sPlusPlus,i=(e.ZSDevTools.Logger,e.ZSClass),n=i.Pane.prototype,a=t.data.Defaults,l=a.MAX_ROW,o=a.MAX_COL,r=8,s=4,h="transparent",d=e.JSUtil.Math,f=i.CellDecorator;n.pushDomUtility=function(e,i,n,a,r,s,v,g,C,u){var y=t.data.getWorkBook(e,n).getSheetObj(i),S=y.Row,D=y.Column;if(a===C.endRow){var M=S.Visibility.nextNonHidden(a);if(l>M){var R=this.getCellRef(e,i,n,M,r),p=y.Merge.isXists(M,r);if(R&&!p){var H=f.getCellStyleDef(e,i,n,R.data,r),N=H[11];""!==N[2]&&"none"!==N[2]?v[d.hash(a,r,o)]=N[2]:""!==H[0]&&(v[d.hash(a,r,o)]=h)}}}if(r===C.endCol){var b=D.hidden.nextNonHidden(r);if(o>b){var c=this.getCellRef(e,i,n,a,b),p=y.Merge.isXists(a,b);if(c&&!p){var B=f.getCellStyleDef(e,i,n,c.data,b),k=B[11];""!==k[0]&&"none"!==k[0]?g[d.hash(a,r,o)]=k[0]:""!==B[0]&&(g[d.hash(a,r,o)]=h)}}}var m=this.loadCellsUtility(e,i,n,a,r,s,v,g,u),w=m[11];if(a===C.startRow&&(""===w[2]||"none"===w[2])){var O=S.Visibility.prevNonHidden(a);if(O>=0){var X=this.getCellRef(e,i,n,O,r),p=y.Merge.isXists(O,r),V=null,L=null;X&&!p&&(V=f.getCellStyleDef(e,i,n,X.data,r)),!p&&X&&(V=f.getStyle(V,X.data)),V&&(L=V[11]),!L||""!==L[3]&&"none"!==L[3]||(""!==m[0]||""!==V[0]?v[d.hash(O,r,o)]=h:!v[d.hash(O,r,o)]&&(v[d.hash(O,r,o)]=L[3]))}}if(r===C.startCol&&(""===w[0]||"none"===w[0])){var U=D.hidden.prevNonHidden(r);if(U>=0){var W=this.getCellRef(e,i,n,a,U),p=y.Merge.isXists(a,U),j=null,F=null;W&&!p&&(j=f.getCellStyleDef(e,i,n,W.data,U)),!p&&W&&(j=f.getStyle(j,W.data)),j&&(F=j[11]),!F||""!==F[1]&&"none"!==F[1]||(""!==m[0]||""!==j[0]?g[d.hash(a,U,o)]=h:!g[d.hash(a,U,o)]&&(g[d.hash(a,U,o)]=F[1]))}}return m},n.setBorderCache=function(e,i,n,a,l){var r=t.data.getWorkBook(e,n).getSheetObj(i),s=r.Row,h=r.Column,i=r.getId();for(var v in a){var g=Math.floor(d.quotient(v,o)),C=Math.floor(d.remainder(v,o)),u=r.Merge.isXists(g,C);if(this.isInsideGridView(g,C)){var y=this.getCellRef(e,i,n,g,C);if(y&&!u){var S=f.getCellStyleDef(e,i,n,y.data,C)[11];(""===S[3]||"none"===S[3])&&(S[3]=a[v]),g!==s.FreezedCount-1&&this.CELLUtil.setBorderBottom(y.DOM,S[3],i)}}}a={};for(var v in l){var g=Math.floor(d.quotient(v,o)),C=Math.floor(d.remainder(v,o)),u=r.Merge.isXists(g,C);if(this.isInsideGridView(g,C)){var y=this.getCellRef(e,i,n,g,C);if(y&&!u){var S=f.getCellStyleDef(e,i,n,y.data,C)[11];(""===S[1]||"none"===S[1])&&(S[1]=l[v]),C!==h.FreezedCount-1&&this.CELLUtil.setBorderRight(y.DOM,S[1],i)}}}l={}},n.loadCellsUtility=function(e,i,n,a,l,r,s,v,g){var C=t.data.getWorkBook(e,n).getSheetObj(i),u=C.Row,y=C.Column,S=g||f.getCellStyleDef(e,i,n,r,l);g||(S=f.getStyle(S,r));var D=S[11],M=d.hash(a,l,o),R=S[0];if(""!==D[0]&&"none"!==D[0]){var p=y.hidden.prevNonHidden(l);p>=0&&(v[d.hash(a,p,o)]=D[0])}else if(""!==R){var p=y.hidden.prevNonHidden(l);p>=0&&(v[d.hash(a,p,o)]=h)}if(""!==D[2]&&"none"!==D[2]){var H=u.Visibility.prevNonHidden(a);H>=0&&(s[d.hash(H,l,o)]=D[2])}else if(""!==R){var H=u.Visibility.prevNonHidden(a);H>=0&&(s[d.hash(H,l,o)]=h)}return v[M]?((""===D[1]||"none"===D[1])&&(D[1]=v[M]),delete v[M]):""===R||""!==D[1]&&"none"!==D[1]||(D[1]=h),s[M]?((""===D[3]||"none"===D[3])&&(D[3]=s[M]),delete s[M]):""===R||""!==D[3]&&"none"!==D[3]||(D[3]=h),S},n.preFetchCellBorder=function(e,i,n,a,l,v,g,C){var u=t.data.getWorkBook(e,n).getSheetObj(i),y=u.Row,S=u.Column,D=a[a.length-1],M=l[l.length-1],R=a.length===r+1,p=l.length===s+1,H=y.Visibility.prevNonHidden(D),N=S.hidden.prevNonHidden(M);if(R)for(var b=0,c=s;c>b&&void 0!=l[b];++b){var B=l[b],k=v[D][B],m=f.getCellStyleDef(e,i,n,k,B),w=m[11];""!==w[2]&&"none"!==w[2]?g[d.hash(H,B,o)]=w[2]:""!==m[0]&&(g[d.hash(H,B,o)]=h)}if(p)for(var b=0,c=r;c>b&&void 0!=a[b];++b){var O=a[b],k=v[O][M],m=f.getCellStyleDef(e,i,n,k,M),w=m[11];""!==w[0]&&"none"!==w[0]?C[d.hash(O,N,o)]=w[0]:""!==m[0]&&(C[d.hash(O,N,o)]=h)}}}(this);
!function(t){function e(t){this.Cue=t}e.prototype={setTop:function(t){this.Cue.style.top=t?t-1+"px":""},setLeft:function(t){this.Cue.style.left=t?t-1+"px":""}},t.ZSClass.UIFreezeCue=e}(this);
!function(e){function t(e,t){this.Cue=e,i.call(this,e,t)}function o(e){C.style.left=e+"px",C.style.display=""}function s(){C.style.display="none"}function i(e,t){var o=this;e.addEventListener("mousedown",function(e){n.call(o,e,t)}),e.addEventListener("mouseover",function(e){r.call(o,e,t)})}function r(e,t){h=t;var o=v.view.getResourceID(h),s=v.view.getVersionID(h),i=v.data.getWorkBook(o,s);!l(o,s,t)&&i.isEditable()?this.Cue.classList.add("grabCursor"):this.Cue.style.cursor=""}function n(t,o){t.preventDefault(),t.stopPropagation(),h=o;var s=v.view.getResourceID(h),i=v.view.getVersionID(h),r=v.data.getWorkBook(s,i);if(!l(s,i,o)&&r.isEditable()){w=this;{var n=v.view.getGridComponent(h),d=n.getRects(),c=n.colHeader0?n.colHeader0.getRects().height:0,g=n.hScroll?n.hScroll.getRects().height:0;d.height-(c+g)}w.Cue.classList.add("frMove"),e.addEventListener("mousemove",a),e.addEventListener("mouseup",u)}}function a(e){var t=v.view.getResourceID(h),i=v.view.getSheetID(h),r=v.view.getVersionID(h),n=v.data.getWorkBook(t,r),a=n.getSheetObj(i),u=v.view.getGridComponent(h),l=u.getRelativeCoordinates(e),g=u.getRects(),C=u.rowHeader0?u.rowHeader0.getRects().width:0,m=a.Column.FreezedCount,f=v.view.getSheetState(h,i),p=f.getZoom();d=e.pageX-(g.left+C);var S=a.Column.axis.getPos(c.MAX_COL_FREEZE);if(d>=S*p)return w.setLeft(S*p+C-5),void o(S*p+C-5);if(0>d)return w.setLeft(C-5),void s();w.setLeft(d+C);var L=a.Column.axis.getPos(m)*p;d!=L&&UserAction.ScrollTo(t,i,r,0,f.sTops[0],f.sLefts[1],f.sTops[1]);var E=a.Column.axis.findAbs(l.x),x=a.Column.axis.getPos(E),R=a.Column.axis.getDim(E)/2,y=d-x*p>=R*p?E+1:E;if(y>0){var D=(d-x*p>=R*p?x+2*R:x)*p+C-5;o(D)}else s()}function u(t){var o=v.view.getResourceID(h),i=v.view.getSheetID(h),r=v.view.getVersionID(h),n=v.view.getSelectedSheets(h),l=v.view.getGridComponent(h),g=l.getRelativeCoordinates(t),C=v.data.getWorkBook(o,r),m=C.getSheetObj(i),p=m.Row.FreezedCount,S=m.Column.FreezedCount,L=m.Column.axis.findAbs(g.x),E=m.Column.axis.getPos(L),x=m.Column.axis.getDim(L)/2,R=l.rowHeader0?l.rowHeader0.getRects().width:0,y=v.view.getSheetState(h,i),D=y.getZoom(),I=d-E*D>=x*D?L+1:L;I=I>c.MAX_COL_FREEZE?c.MAX_COL_FREEZE:I,w.Cue.classList.remove("frMove"),s(),e.removeEventListener("mousemove",a),e.removeEventListener("mouseup",u),S!=I?(w.setLeft(m.Column.axis.getPos(I)*D+R-5),f.style.left=m.Column.axis.getPos(I)*D-1+"px",e.UserAction.Freeze(o,n,r,p,I)):w.setLeft(m.Column.axis.getPos(S)*D+R-5)}function l(e,t,o){var s=(v.view.getSheetState(o,s),v.view.getSheetID(o)),i=v.data.getWorkBook(e,t);return i.ProtectedSheets.isSheetLocked(s)}var d,v=e.sPlusPlus,c=v.data.Defaults,g=(v.view.measures,document.body,e.ZSEvents),C=(g.topic,g.Groups,g.Names,document.createElement("span"));C.classList.add("vCueHandler"),C.id="colFreezeCuePreview",C.style.display="none",C.style.borderColor="#c9c9c9";var m=document.querySelector(".gridTopBand");m.appendChild(C);var f=document.querySelector(".vFreezeCue");t.prototype={setLeft:function(e){this.Cue.style.left=e?e+"px":""}};var h,w;e.ZSClass.UIColHeaderFreezeCue=t}(this);
!function(e){function t(e,t){this.Cue=e,s.call(this,e,t)}function o(e){c.style.top=e+"px",c.style.display=""}function i(){c.style.display="none"}function s(e,t){var o=this;e.addEventListener("mousedown",function(e){r.call(o,e,t)}),e.addEventListener("mouseover",function(e){a.call(o,e,t)})}function a(e,t){R=t;var o=l.view.getResourceID(R),i=l.view.getVersionID(R),s=l.data.getWorkBook(o,i);!d(o,i,t)&&s.isEditable()?this.Cue.classList.add("grabCursor"):this.Cue.style.cursor=""}function r(t,o){t.preventDefault(),t.stopPropagation(),R=o,p=this;var i=l.view.getGridComponent(R),s=i.getRects(),a=i.rowHeader0?i.rowHeader0.getRects().width:0,r=i.vScroll?i.vScroll.getRects().width:0,v=(s.width-(a+r),l.view.getResourceID(R)),c=l.view.getVersionID(R),g=l.data.getWorkBook(v,c);!d(v,c,o)&&g.isEditable()&&(p.Cue.classList.add("frMove"),e.addEventListener("mousemove",n),e.addEventListener("mouseup",u))}function n(e){var t=l.view.getResourceID(R),s=l.view.getSheetID(R),a=l.view.getVersionID(R),r=l.data.getWorkBook(t,a),n=r.getSheetObj(s),u=l.view.getGridComponent(R),d=u.getRelativeCoordinates(e),c=u.getRects(),g=u.colHeader0?u.colHeader0.getRects().height:0,w=n.Row.FreezedCount,y=l.view.getSheetState(R,s),x=y.getZoom(),f=l.data.Defaults.VIEW==l.data.View.COMFORT?7:5;h=e.pageY-(c.top+g);var m=n.Row.auxiliaryAxis.getPos(v.MAX_ROW_FREEZE);if(h>=m*x)return p.setTop(m*x+g-f),void o(m*x+g-f);if(0>h)return p.setTop(g-f),void i();p.setTop(h+g);var C=n.Row.auxiliaryAxis.getPos(w);h!=C&&UserAction.ScrollTo(t,s,a,y.sLefts[0],0,y.sLefts[1],y.sTops[1]);var S=n.Row.auxiliaryAxis.findAbs(d.y),E=n.Row.auxiliaryAxis.getPos(S),A=n.Row.auxiliaryAxis.getDim(S)/2,D=h-E*x>=A*x?S+1:S;if(D>0){var I=(n.Row.auxiliaryAxis.getPos(D),(h-E*x>=A*x?E+2*A:E)*x+g-f);o(I)}else i()}function u(t){var o=l.view.getResourceID(R),s=l.view.getSheetID(R),a=l.view.getVersionID(R),r=l.view.getSelectedSheets(R),d=l.view.getGridComponent(R),c=d.getRelativeCoordinates(t),g=l.data.getWorkBook(o,a),y=g.getSheetObj(s),x=y.Column.FreezedCount,f=y.Row.FreezedCount,m=y.Row.auxiliaryAxis.findAbs(c.y),C=y.Row.auxiliaryAxis.getPos(m),S=y.Row.auxiliaryAxis.getDim(m)/2,E=d.colHeader0?d.colHeader0.getRects().height:0,A=l.view.getSheetState(R,s),D=A.getZoom();p.Cue.classList.remove("frMove"),i(),e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",u);var I=l.data.Defaults.VIEW==l.data.View.COMFORT?7:5,L=h-C*D>=S*D?m+1:m;L=L>v.MAX_ROW_FREEZE?v.MAX_ROW_FREEZE:L,f!=L?(p.setTop(y.Row.auxiliaryAxis.getPos(L)*D+E-I),w.style.top=y.Row.auxiliaryAxis.getPos(L)*D-1+"px",e.UserAction.Freeze(o,r,a,L,x)):p.setTop(y.Row.auxiliaryAxis.getPos(f)*D+E-I)}function d(e,t,o){var i=(l.view.getSheetState(o,i),l.view.getSheetID(o)),s=l.data.getWorkBook(e,t);return s.ProtectedSheets.isSheetLocked(i)}var l=e.sPlusPlus,v=l.data.Defaults,c=(l.view.measures,document.body,document.createElement("span"));c.classList.add("hCueHandler"),c.id="rowFreezeCuePreview",c.style.display="none",c.style.borderColor="#c9c9c9";var g=document.querySelector(".gridTopBand");g.appendChild(c);var w=document.querySelector(".hFreezeCue");t.prototype={setTop:function(e){this.Cue.style.top=e?e+"px":""}};var R,p,h;e.ZSClass.UIRowHeaderFreezeCue=t}(this);
!function(t){function e(){i.parent.onscroll=void 0,t.removeEventListener("mouseup",e)}function n(){var n=this;this.parent.addEventListener("mousedown",function(){i=n,n.onScroll&&(n.parent.onscroll=n.onScroll),t.addEventListener("mouseup",e)}),this.onScroll&&this.parent.addEventListener("mousewheel",this.onScroll,!1),this.onScroll&&this.parent.addEventListener("DOMMouseScroll",this.onScroll,!1)}function s(t,e){var s=document.createElement("div");s.className="hST",t.appendChild(s),!!e&&(this.onScroll=e),this.parent=t,this.scroll=s,r.Grid.HScrollBar=15,this.rects={height:15},n.call(this)}var i,o=t.sPlusPlus,r=o.view.measures;s.prototype={getRects:function(){return this.rects},setWidth:function(t){this.scroll.style.width=t+"px"},setScroll:function(e){var n=this.parent;t.cancelAnimationFrame(this.timerId),this.timerId=t.requestAnimationFrame(function(){n.scrollLeft=e})},setContentWidth:function(t){this.setWidth(t)},maxUsedCol:function(){}},t.ZSClass.UIHScrollBar=s}(this);
!function(t){function e(){i.parent.onscroll=void 0,t.removeEventListener("mouseup",e)}function n(){var n=this;this.parent.addEventListener("mousedown",function(){i=n,n.onScroll&&(n.parent.onscroll=n.onScroll),t.addEventListener("mouseup",e)}),this.onScroll&&this.parent.addEventListener("mousewheel",this.onScroll,!1),this.onScroll&&this.parent.addEventListener("DOMMouseScroll",this.onScroll,!1)}function s(t,e){var s=document.createElement("div");s.className="vST",t.appendChild(s),!!e&&(this.onScroll=e),this.parent=t,this.scroll=s,r.Grid.VScrollBar=15,this.rects={width:15},n.call(this)}var i,o=t.sPlusPlus,r=o.view.measures;s.prototype={getRects:function(){return this.rects},setHeight:function(t){this.scroll.style.height=t+"px"},setScroll:function(e){var n=this.parent;t.cancelAnimationFrame(this.timerId),this.timerId=t.requestAnimationFrame(function(){n.scrollTop=e})},setContentHeight:function(t){this.setHeight(t)},maxUsedRow:function(){}},t.ZSClass.UIVScrollBar=s}(this);
!function(e){function t(){var t=e.document.createElement("div");return t.style.position="absolute",t.style.overflow="hidden",t.setAttribute("context","MI_GRID_CONTEXT"),t}function o(t){var o=e.document.createElement("DIV");return o.className=t,o}function i(e,t,o,i){var n=h.call(this,e,t,o),r=d.call(this,e,t,o);return i>r&&(i=r),n>i&&(i=n),i}function n(e,t,o,i){var n=s.call(this,e,t,o),r=l.call(this,e,t,o);return i>r&&(i=r),n>i&&(i=n),i}function r(e,t,o,i){return i>e&&t>o}function a(t,o,i,n,a,s,l){var h=this.props,d=h.sLeft,c=h.sTop,C=h.sWidth,f=h.sHeight,g=d+C,w=c+f,u=n,v=a,R=s,D=l,H=u+R,m=v+D,S=p.data.getWorkBook(t,i),F=S.getSheetObj(o),P=h.bound,O=F.Column.axis.getPos(P.startCol),M=F.Column.axis.getPos(P.endCol+1),B=F.Row.auxiliaryAxis.getPos(P.startRow),I=F.Row.auxiliaryAxis.getPos(P.endRow+1),y=d,Z=c;if(r(O,M,u,H)){var b=u>d,L=g>H;b?L||(y=H-C):y=u}if(r(B,I,v,m)){var k=v>c,W=w>m;k?W||(Z=m-f):Z=v}this.props.sLeft=y,this.props.sTop=Z,this.paneDOM.scrollLeft=e.Math.round(y),this.paneDOM.scrollTop=e.Math.round(Z)}function s(e,t,o){var i=this.props,n=p.data.getWorkBook(e,o).getSheetObj(t),r=n,a=p.view.getActiveGridID(),s=p.view.getSheetState(a,t),l=s.getZoom();return r.Row.auxiliaryAxis.getPos(i.bound.startRow)*l}function l(e,t,o){var i=this.props,n=p.data.getWorkBook(e,o).getSheetObj(t),r=n,a=p.view.getActiveGridID(),s=p.view.getSheetState(a,t),l=s.getZoom(),h=0,d=r.Row.auxiliaryAxis.getPos(i.bound.endRow+1),c=d*l;return i.sHeight<c&&(h=c>i.sHeight?c-i.sHeight:i.sHeight-c),h}function h(e,t,o){var i=this.props,n=p.data.getWorkBook(e,o).getSheetObj(t),r=n,a=p.view.getActiveGridID(),s=p.view.getSheetState(a,t),l=s.getZoom();return r.Column.axis.getPos(i.bound.startCol)*l}function d(e,t,o){var i=this.props,n=p.data.getWorkBook(e,o).getSheetObj(t),r=n,a=p.view.getActiveGridID(),s=p.view.getSheetState(a,t),l=s.getZoom(),h=0,d=r.Column.axis.getPos(i.bound.endCol+1);return i.sWidth<d*l&&(h=d*l-i.sWidth),h}function c(e){var t=document.createElement("div");return e.appendChild(t),t}function C(e,t,o,i,n,r){this.zoomTimer,this.name=o,this.pane=this.initPane(e,t,o),this.props=new ZSClass.Props(!0,!0),this.props.iHave=new ZSClass.Range(-1,-1,-1,-1),this.ClientCache=new ZSClass.Map,this.zoomCache,this.gridID=t,this.init(e,t,i,n,r)}var p=sPlusPlus,f=(e.ZSDevTools.Logger,p.data.Defaults.MAX_COL),g=p.data.Defaults.MAX_ROW,w=e.JSUtil.Math,u=e.ZSClass.Range,v=e.ZSEvents,R=(v.topic,v.Groups,v.Names,2),D=8*R,H=4*R,m=""===document.createElement("detect").style.zoom;C.prototype={init:function(e,t,o,i,n){var r=this,a=p.view.getResourceID(t),s=p.view.getVersionID(t),l=p.data.getWorkBook(a,s);this.addSelectionListeners&&this.addSelectionListeners(this.paneDOM,t),this.addEditListeners&&l.isEditable()&&this.addEditListeners(this.paneDOM,t),this.addMouseWheelListener&&this.addMouseWheelListener(this.paneDOM,t);var h=ZSClass.Selector.Design,d=ZSClass.UIDataValidationController;if(d){var C=c(r.paneDOM);r.DataValidation=new d(C,h.DataValidationList)}ZSClass.Filter&&ZSClass.Filter.IconHolder&&(this.filterPane=new ZSClass.Filter.IconHolder),this.filterPane&&this.filterPane.init(this.paneDOM),ZSClass.UIPivotFilterController&&(r.PivotFilter=new ZSClass.UIPivotFilterController(this.filterPane.DOM)),ZSClass.UIDataFilterController&&(r.DataFilter=new ZSClass.UIDataFilterController(this.filterPane.DOM));var f=ZSClass.UIRecalculateFlashController,g=ZSClass.UIPreviewController,w=ZSClass.UISelectionController,u=(ZSClass.UIOleController,ZSClass.UICellNoteController),v=ZSClass.UIDataValidationHintController,R=ZSClass.UIUserPresenceController,D=ZSClass.UICommentsHighlightController,H=ZSClass.UIPrecedanceController,m=ZSClass.UIPasteWidgetController,S=ZSClass.UIHighlightLocksController,F=ZSClass.UIHighlightController;if(g){var P=c(r.paneDOM);r.Preview=new g(P)}if(f){var O=c(r.paneDOM);r.RecalculateFlash=new f(O)}if(R){var M=c(r.paneDOM);r.UserPresence=new R(M,h.UserPresence)}if(D){var B=c(r.paneDOM);r.CommentsHighlight=new D(B,h.CommentsHighlight)}if(F){var I=c(r.paneDOM);r.HighlightVersion=new F(I,h.VersionCue)}if(S){var y=c(r.paneDOM);r.HighlightLocks=new S(y,h.HighlightLocks)}if(w){var Z=c(r.paneDOM),b=c(r.paneDOM),L=c(r.paneDOM),k=c(r.paneDOM),W=c(r.paneDOM),U=c(r.paneDOM),x=c(r.paneDOM),A=c(r.paneDOM),T=c(r.paneDOM),I=c(r.paneDOM),V=l.isEditable();r.RangePicker=new w(Z,h.RangePicker),r.CellSelection=new w(L,h.Cell);var z=V?h.Range:h.RangeReadOnly;r.RangeSelection=new w(b,z),V&&(r.FillSeriesCue=new w(k,h.FillSeriesCue)),V&&(r.FillSeries=new w(W,h.FillSeries)),r.CutSelection=new w(U,h.CutCopy),r.CopySelection=new w(x,h.CutCopy),V&&(r.DragSelection=new w(A,h.Drag)),V&&(r.HeaderDragSelection=new w(T,h.HeaderDrag)),r.Highlight=new w(I,h.Highlight)}if(m){var E=c(r.paneDOM);r.PasteWidget=new m(E,h.PasteWidget)}if(ZSClass.Layer){var j=c(r.paneDOM),N=ZSClass.Layer.Button.Router;r.Button=new N(j,o),o.addView(r.Button);var G=ZSClass.Layer.Chart.Router;r.Chart=new G(j,i),i.addView(r.Chart);var _=ZSClass.Layer.Image.Router;r.Image=new _(j,n),n.addView(r.Image)}if(u){var J=c(r.paneDOM);r.Notes=new u(J)}if(v){var X=c(r.paneDOM);r.DataValidationHint=new v(X)}if(H){var q=c(r.paneDOM);r.Precedance=new H(q)}},initPane:function(e,i,n){var r=t(i,n),a=o("sheetTable"),s=new ZSClass.MergeComponent;this.protectHolder=new ZSClass.ProtectHolder,e.appendChild(r),r.appendChild(a),s.init(r),this.protectHolder.init(r);var l=new ZSClass.Props(!0,!0);return this.paneDOM=r,this.sheetTable=a,new ZSClass.Pane(l,n,a,s)},onBeforeFill:function(e,t,o){var i=p.data.getWorkBook(e,o).getSheetObj(t),n=this.props,r=p.view.getActiveGridID(),a=p.view.getSheetState(r,t),s=a.getZoom();n.startRow=i.Row.Visibility.getFloor(i.Row.auxiliaryAxis.find(Math.round(n.sTop/s)).idx).floor,n.startCol=i.Column.hidden.getFloor(i.Column.axis.find(n.sLeft/s).idx).floor,n.endRow=i.Row.Visibility.getCeil(i.Row.auxiliaryAxis.find(Math.round((n.sTop+n.sHeight)/s)).idx).ceil,n.endCol=i.Column.hidden.getCeil(i.Column.axis.find((n.sLeft+n.sWidth)/s).idx).ceil;var l=n.startRow-D<0?0:i.Row.Visibility.getFloor(n.startRow-D).floor,h=n.startCol-H<0?0:i.Column.hidden.getFloor(n.startCol-H).floor,d=n.endRow+D>=g?g-1:i.Row.Visibility.getCeil(n.endRow+D).ceil,c=n.endCol+H>=f?f-1:i.Column.hidden.getCeil(n.endCol+H).ceil,C=Math.max(0,i.Row.Visibility.getFloor(n.bound.startRow).floor,l),w=Math.max(0,i.Column.hidden.getFloor(n.bound.startCol).floor,h),u=Math.min(g-1,i.Row.Visibility.getCeil(n.bound.endRow).ceil,d),v=Math.min(f-1,i.Column.hidden.getCeil(n.bound.endCol).ceil,c);n.iHave=new ZSClass.Range(C,w,u,v)},fill:function(e,t,o,i){var n=this.props.iHave;this.pane.load(e,t,o,n.startRow,n.startCol,n.endRow,n.endCol,i)},setLeft:function(e){this.paneDOM.style.left=e+"px"},setTop:function(e){this.paneDOM.style.top=e+"px"},setHeight:function(e){this.props.sHeight=e,this.paneDOM.style.height=e+"px"},setWidth:function(e){this.props.sWidth=e,this.paneDOM.style.width=e+"px"},setContentHeight:function(e){this.props.cHeight=e,this.sheetTable.style.height=e+"px"},setContentWidth:function(e){this.props.cWidth=e,this.sheetTable.style.width=e+"px"},isInViewPort:function(e){var t=this.props.iHave;return t.subset(e)},setScroll:function(t,o,r,a,s){var l=this.props;l.sLeft=i.call(this,t,o,r,a),l.sTop=n.call(this,t,o,r,s),this.paneDOM.scrollLeft=e.Math.round(l.sLeft),this.paneDOM.scrollTop=e.Math.round(l.sTop)},setScrollLeft:function(e,t,o,i){this.setScroll(e,t,o,i,this.props.sTop)},setScrollTop:function(e,t,o,i){this.setScroll(e,t,o,this.props.sLeft,i)},scrollIntoView:function(e,t,o,i,n,r,s){a.call(this,e,t,o,i,n,r,s)},getCellRef:function(e,t,o,i,n){return this.pane.getCellRef(e,t,o,i,n)},updateBoundary:function(e,t,o,i,n,r,a){var s=this.props;s.bound.startRow=i,s.bound.startCol=n,s.bound.endRow=r,s.bound.endCol=a,this.Chart.updateBoundaryProps(s)},onRowInsertBefore:function(e,t,o,i,n,r){this.pane.onRowInsertBefore(e,t,o,i,n,r)},onColInsertBefore:function(e,t,o,i,n,r){this.pane.onColInsertBefore(e,t,o,i,n,r)},onRowDeleteBefore:function(e,t,o,i,n,r){this.pane.onRowDeleteBefore(e,t,o,i,n,r)},onColDeleteBefore:function(e,t,o,i,n,r){this.pane.onColDeleteBefore(e,t,o,i,n,r)},onHideBefore:function(e,t,o,i,n,r){this.pane.onHideBefore(e,t,o,i,n,r)},onShowBefore:function(e,t,o,i,n,r){this.onHideBefore(e,t,o,i,n,r)},insertRow:function(e,t,o,i,n){this.pane.onRowInsert(e,t,o,i,n),this.protectHolder.onRowInsert(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onRowInsert(e,t,o,i,n),this.DataFilter&&this.DataFilter.onRowInsert(e,t,o,i,n)},insertCol:function(e,t,o,i,n){this.pane.onColInsert(e,t,o,i,n),this.protectHolder.onColInsert(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onColInsert(e,t,o,i,n),this.DataFilter&&this.DataFilter.onColInsert(e,t,o,i,n)},deleteRow:function(e,t,o,i,n){this.pane.onRowDelete(e,t,o,i,n),this.protectHolder.onRowDelete(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onRowDelete(e,t,o,i,n),this.DataFilter&&this.DataFilter.onRowDelete(e,t,o,i,n)},deleteCol:function(e,t,o,i,n){this.pane.onColDelete(e,t,o,i,n),this.protectHolder.onColDelete(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onColDelete(e,t,o,i,n),this.DataFilter&&this.DataFilter.onColDelete(e,t,o,i,n)},hideRow:function(e,t,o,i,n){this.pane.mergeHolder.onRowHeaderAction(e,t,o,i,n),this.pane.refill(e,t,o,"ROW",i,n),this.protectHolder.onHideRow(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onHideRow(e,t,o,i,n),this.DataFilter&&this.DataFilter.onHideRow(e,t,o,i,n)},showRow:function(e,t,o,i,n,r){this.pane.mergeHolder.onRowHeaderAction(e,t,o,i,n),this.pane.refill(e,t,o,"ROW",i,n),this.protectHolder.onShowRow(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onShowRow(e,t,o,i,n,r),this.DataFilter&&this.DataFilter.onShowRow(e,t,o,i,n,r)},hideCol:function(e,t,o,i,n){this.pane.mergeHolder.onColHeaderAction(e,t,o,i,n),this.pane.refill(e,t,o,"COLUMN",i,n),this.protectHolder.onHideCol(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onHideCol(e,t,o,i,n),this.DataFilter&&this.DataFilter.onHideCol(e,t,o,i,n)},showCol:function(e,t,o,i,n,r){this.pane.mergeHolder.onColHeaderAction(e,t,o,i,n),this.pane.refill(e,t,o,"COLUMN",i,n),this.protectHolder.onShowCol(e,t,o,i,n),this.PivotFilter&&this.PivotFilter.onShowCol(e,t,o,i,n,r),this.DataFilter&&this.DataFilter.onShowCol(e,t,o,i,n,r)},resizeRow:function(e,t,o,i,n,r){var a=p.data.getWorkBook(e,o);r=a.RowStyle.getStyleDef(r,!0),this.pane.resizeRow(e,t,o,i,n,r),this.protectHolder.onResize(e,t,o,"ROW",i,n),this.PivotFilter&&this.PivotFilter.onResizeRow(e,t,o,r,i),this.DataFilter&&this.DataFilter.onResizeRow(e,t,o,r,i)},resizeCol:function(e,t,o,i,n,r){var a=p.data.getWorkBook(e,o);r=a.ColStyle.getStyleDef(r),this.pane.resizeCol(e,t,o,i,n,r),this.protectHolder.onResize(e,t,o,"COLUMN",i,n),this.PivotFilter&&this.PivotFilter.onResizeCol(e,t,o,r,i),this.DataFilter&&this.DataFilter.onResizeCol(e,t,o,r,i)},onBeforeMerge:function(e,t,o,i,n){this.pane.onBeforeMerge(e,t,o,i,n)},onBeforeSplit:function(e,t,o,i){for(var n=this.pane,r=new u(n.iHave.startRow,n.iHave.startCol,n.iHave.endRow,n.iHave.endCol),a=p.data.getWorkBook(e,o).getSheetObj(t),s=0;s<i.length;s++){var l=new u(i[s][0],i[s][1],i[s][2],i[s][3]);if(r.intersects(l)){var h=a.Merge,d=h.getIntersectedRanges(l),c=n.mergeHolder;c.removeDom(e,t,o,i[s][0],i[s][1],i[s][2],i[s][3],n.iHave);for(var C in d){var f=r.getIntersectingRange(d[C]);n.updateCells(e,t,o,"ROW",f.startRow,f.startCol,f.endRow,f.endCol)}}}},merge:function(e,t,o,i){for(var n=this.pane,r=new u(n.iHave.startRow,n.iHave.startCol,n.iHave.endRow,n.iHave.endCol),a=p.data.getWorkBook(e,o).getSheetObj(t),s=a.Merge,l=0;l<i.length;l++){var h=new u(i[l][0],i[l][1],i[l][2],i[l][3]);if(r.intersects(h)){var d=n.mergeHolder;if(s.isRangeAcross(h))for(var c=n.iHave.startRow<i[l][0]?i[l][0]:n.iHave.startRow,C=n.iHave.endRow>i[l][2]?i[l][2]:n.iHave.endRow,f=c;C>=f;f++)d.create(e,t,o,f,i[l][1],f,i[l][3],this.pane);else d.create(e,t,o,i[l][0],i[l][1],i[l][2],i[l][3],this.pane)}}},split:function(e,t,o,i){for(var n=this.pane,r=new u(n.iHave.startRow,n.iHave.startCol,n.iHave.endRow,n.iHave.endCol),a=0;a<i.length;a++){var s=new u(i[a][0],i[a][1],i[a][2],i[a][3]);r.intersects(s)&&(s=r.getIntersectingRange(s),n.updateCells(e,t,o,"ROW",s.startRow,s.startCol,s.endRow,s.endCol))}},onZoomBefore:function(){},zoom:function(e,t,o,i){function n(i,n,r,a,d,c){if(i){var C=JSUtil.Object.clone(i.data,!0),p=s.loadCellsUtility(e,t,o,d,c,C,l,h),f=p[11];1==f.length&&(f[1]=f[0],f[2]=f[0],f[3]=f[0]);var g=f[1],w=f[3];s.CELLUtil.setBorderRight(i.getDOM(),g,t),s.CELLUtil.setBorderBottom(i.getDOM(),w,t)}}function r(e,o,i,r,l,h){if(e){n(e,o,i,r,l,h);var d=JSUtil.Object.clone(e.data,!0);if(d.rightBorder){var c=a.CellStyle.getStyleDef(d.rightBorder.Format),C=c[11];1==C.length&&(C[1]=C[0],C[2]=C[0],C[3]=C[0]),s.CELLUtil.setBorderRight(e.getDOM(),C[1],t)}if(d.bottomBorder){var p=a.CellStyle.getStyleDef(d.bottomBorder.Format),C=p[11];1==C.length&&(C[1]=C[0],C[2]=C[0],C[3]=C[0]),s.CELLUtil.setBorderBottom(e.getDOM(),C[3],t)}}}var a=p.data.getWorkBook(e,o),s=(a.getSheetObj(t),this.pane),l={},h={};s.iterateRange(e,t,o,s.iHave.startRow,s.iHave.startCol,s.iHave.endRow,s.iHave.endCol,null,n,r),this.zoomGrid(i),s.setBorderCache(e,t,o,l,h)},zoomGrid:function(e){var t=this;cancelAnimationFrame(this.zoomTimer),this.zoomTimer=requestAnimationFrame(function(){var o=t.pane;m?o.sheetTable.style.zoom=e:(o.sheetTable.style.transform="scale("+e+")",o.sheetTable.style.transformOrigin="0 0"),t.filterPane&&t.filterPane.setZoom(e),t.protectHolder.setZoom(e),t.pane.mergeHolder.setZoom(e)})},addPivotFilter:function(e,t,o,i){this.PivotFilter&&this.PivotFilter.place(e,t,o,i)},hidePivotFilter:function(e,t,o,i){this.PivotFilter&&this.PivotFilter.hide(e,t,o,i)},onBeforeDataFilter:function(e,t,o,i,n){this.pane.onBeforeDataFilter(e,t,o,"ROW",i,n)},addDataFilter:function(e,t,o,i,n,r,a){this.DataFilter&&this.DataFilter.place(e,t,o,i,n,r),this.pane.mergeHolder.onRowHeaderAction(e,t,o,a),this.pane.refill(e,t,o,"ROW",a),this.protectHolder.onHideRow(e,t,o,a),this.PivotFilter&&this.PivotFilter.onHideRow(e,t,o,a)},refillCols:function(e,t,o,i,n){this.pane.refill(e,t,o,"COLUMN",i,n)},refillRows:function(e,t,o,i,n){this.pane.refill(e,t,o,"ROW",i,n)},onBeforeHideShowRow:function(e,t,o,i){this.pane.onBeforeHideShowRow(e,t,o,i,this.props.iHave.endRow)},onAfterHideRow:function(e,t,o,i,n){this.protectHolder.onHideRow(e,t,o,i),this.PivotFilter&&this.PivotFilter.onHideRow(e,t,o,i,n),this.DataFilter&&this.DataFilter.onHideRow(e,t,o,i,n)},onAfterShowRow:function(e,t,o,i){this.protectHolder.onShowRow(e,t,o,i),this.PivotFilter&&this.PivotFilter.onShowRow(e,t,o,i),this.DataFilter&&this.DataFilter.onShowRow(e,t,o,i)},onBeforeHideShowColumn:function(e,t,o,i){this.pane.onBeforeHideShowColumn(e,t,o,i,this.props.iHave.endCol)},onAfterHideColumn:function(e,t,o,i,n){this.protectHolder.onHideCol(e,t,o,i),this.PivotFilter&&this.PivotFilter.onHideCol(e,t,o,i,n),this.DataFilter&&this.DataFilter.onHideCol(e,t,o,i,n)},onAfterShowColumn:function(e,t,o,i){this.protectHolder.onShowCol(e,t,o,i),this.PivotFilter&&this.PivotFilter.onShowCol(e,t,o,i),this.DataFilter&&this.DataFilter.onShowCol(e,t,o,i)},onGridViewChange:function(e,t,o){this.PivotFilter&&this.PivotFilter.refreshIcons(e,t,o),this.DataFilter&&this.DataFilter.refreshIcons(e,t,o)},hideDataFilter:function(e,t,o,i){this.DataFilter&&this.DataFilter.hide(e,t,o),this.pane.refill(e,t,o,"ROW",i.startRow)},showDataFilter:function(e,t,o){var i=p.data.getWorkBook(e,o),n=i.getSheetObj(t),r=n.DataFilters.getAllRanges();this.DataFilter&&this.DataFilter.showAll(e,t,o,r)},addCellProtect:function(e,t,o,i){this.protectHolder.add(e,t,o,i)},modifyCellProtect:function(e,t,o,i){this.protectHolder.modify(e,t,o,i)},hideCellProtect:function(e,t,o){this.protectHolder.hide(e,t,o)},showCellProtect:function(e,t,o){var i=p.data.getWorkBook(e,o),n=i.getSheetObj(t),r=n.ProtectedRanges.getAllRanges();this.protectHolder.show(e,t,o,r)},removeCellProtect:function(e,t,o,i){this.protectHolder.remove(e,t,o,i)},PlaceHighlightLocks:function(e,t,o,i){this.protectHolder.addHighlight(e,t,o,i)},RemoveHighlightLocks:function(e,t,o,i){this.protectHolder.removeHighlight(e,t,o,i)},hideGridLine:function(e,t,o,i){this.pane.hideGridLine(e,o,i)},onReload:function(e,t,o){this.pane.reload(e,t,o),this.hideCellProtect(e,t,o)},removeDVInterrupt:function(e,t,o,i){for(var n=p.data.getWorkBook(e,o),r=n.getSheetObj(t),a=r.DVErrorInfo,s=i,l=new ZSClass.Range(s[0],s[1],s[2],s[3]),h=l.startRow;h<=l.endRow;h++)for(var d=l.startCol;d<=l.endCol;d++){var c=a.get(w.hash(h,d,f));if(a&&c&&!c.isEmpty){var C=document.getElementsByClassName("datavalid");C[0].style.display="none",C[0].parentNode.removeChild(C[0]),a.remove(w.hash(h,d,f))}}},reset:function(e,t,o){this.props.iHave=new ZSClass.Range(-1,-1,-1,-1),this.ClientCache=new ZSClass.Map,this.zoomCache=void 0,this.zoomTimer=void 0,this.pane.reset(e,t,o),this.protectHolder.remove()},RemoveTileDom:function(){function e(e){for(var t=e.length-1;e&&t>=0;){var o=e[t];o&&o.parentElement&&o.parentElement.removeChild(o),t=e.length-1}}var t=this.pane.sheetTable.getElementsByClassName("tileDOM");e(t);var o=document.getElementsByClassName("sheetMask");e(o),this.filterPane&&this.filterPane.hide(this.paneDOM),this.protectHolder.hide(),this.pane.clearBuffer(),this.ClientCache=new ZSClass.Map}},e.ZSClass.UIPaneComponent=C}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass.UIPaneComponent,l=o.prototype;l.PlaceCellSelection=function(e,o,l,i,s){var n=t.data.getWorkBook(e,l),a=n.getSheetObj(o),c=a.Row.auxiliaryAxis.getPos(s.startRow),C=a.Column.axis.getPos(s.startCol),r=a.Row.auxiliaryAxis.getPos(s.endRow+1),u=a.Column.axis.getPos(s.endCol+1),S=t.view.getSheetState(this.gridID,o),g=S.getZoom();this.CellSelection&&this.CellSelection.place(i,c*g,C*g,(r-c)*g,(u-C)*g)},l.RemoveCellSelection=function(e,t,o,l){this.CellSelection&&this.CellSelection.hide(l)}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass.UIPaneComponent,i=o.prototype;i.PlaceDragSelection=function(e,o,i,a,s){var r=t.data.getWorkBook(e,i),n=r.getSheetObj(o),l=n.Row.auxiliaryAxis.getPos(s.startRow),g=n.Column.axis.getPos(s.startCol),c=n.Row.auxiliaryAxis.getPos(s.endRow+1),S=n.Column.axis.getPos(s.endCol+1),h=t.view.getSheetState(this.gridID,o),d=h.getZoom();this.DragSelection&&this.DragSelection.place(a,l*d,g*d,(c-l)*d,(S-g)*d)},i.RemoveDragSelection=function(e,t,o,i){this.DragSelection&&this.DragSelection.hide(i)},i.PlaceHeaderDragSelection=function(e,o,i,a,s){var r=t.data.getWorkBook(e,i),n=r.getSheetObj(o),l=n.Row.auxiliaryAxis.getPos(s.startRow),g=n.Column.axis.getPos(s.startCol),c=n.Row.auxiliaryAxis.getPos(s.endRow),S=n.Column.axis.getPos(s.endCol),h=t.view.getSheetState(this.gridID,o),d=h.getZoom();this.HeaderDragSelection&&this.HeaderDragSelection.place(a,l*d,g*d,(c-l)*d,(S-g)*d)},i.RemoveHeaderDragSelection=function(e,t,o,i){this.HeaderDragSelection&&this.HeaderDragSelection.hide(i)}}(this);
!function(e){var t=sPlusPlus,a=t.data.Defaults,l=a.MAX_COL,i=e.ZSConstants.ActionConstants,n=e.ZSConstants.CommandConstants,r=e.JSUtil.Math,s=(e.ZSClass.Range,ZSClass.CellDecorator),o=e.UserAction,c=e.ZSClass.UIPaneComponent.prototype,d={BACKGROUNDCOLOR:0,COLOR:1,FONTSIZE:2,FONTNAME:3,FONTWEIGHT:4,FONTSTYLE:5,TEXTLINETHROUGHTSTYLE:6,TEXTUNDERLINESTYLE:7,TEXTWRAP:8,HALLIGN:9,VALLIGN:10,BORDER:11,HIDETEXT:12,ICONSET:13};c.modifyPivot=function(e,a,l,i){var r=t.data.getWorkBook(e,l),s=r.PivotCollection,o=t.view.getActiveGridID(),a=t.view.getSheetID(o);for(var c in i){var d=s.get(c)[n.TARGET];d[0]===a&&this.ClientFirstActions(e,a,l,61,d[1],d[2],d[3],d[4],1)}},c.ClientFirstActions=function(a,o,c,C,L,g,v,O,E){function u(e,t,a,l,i,n){t===i&&a===n&&S.call(m,e,null,null,null,i,n);var r=JSUtil.Object.clone(e.data,!0);if(r.rightBorder){var s=M.CellStyle.getStyleDef(r.rightBorder.Format),c=s[11];1==c.length&&(c[1]=c[0],c[2]=c[0],c[3]=c[0]),m.CELLUtil.setBorderRight(e.getDOM(),c[1],o)}if(r.bottomBorder){var d=M.CellStyle.getStyleDef(r.bottomBorder.Format),c=d[11];1==c.length&&(c[1]=c[0],c[2]=c[0],c[3]=c[0]),m.CELLUtil.setBorderBottom(e.getDOM(),c[3],o)}}function D(e){m.CELLUtil.setBorderBottom(e.getDOM(),U,o)}function R(e){m.CELLUtil.setBorderRight(e.getDOM(),U,o)}function f(e,t,a,l,i,n){(24!=E||i!=v)&&m.CELLUtil.setBorderBottom(e.getDOM(),U,o),(24!=E||n!=O)&&m.CELLUtil.setBorderRight(e.getDOM(),U,o)}var S,b=t.data.getWorkBook(a,c).getSheetObj(o),T=this,m=this.pane,h=t.view.getActiveGridID(),k=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","IsContentValid","hasLink"],M=t.data.getWorkBook(a,c),N=M.getSheetObj(o),I=C.action?C.action:C;switch(I){case"SUBMIT":S=function(l,i,r,d,C,L){var g,v="",O=new ZSClass.Range(C,L,C,L);if(b.ArrayFormula&&(g=b.ArrayFormula.getIntersectedRanges(O)),!g.length){var u=function(e){v=e[C][L]},D=function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)};if(t.view.fetchCellData(a,o,c,C,L,k,h,u,D),v){v&&(v.DisplayValue=E,v.ActualValue=E,v.Formula=E);var R=v.Format?v.Format:"Default",f=M.CellStyle.getStyleDef(R),S=l.getDOM();S.innerHTML="";var T,N=l.data.ConditionalFormat;if(N)for(var I=0;N.length&&I<N.length;I++){var U=N[I];U[n.ICONSET]&&(S=m.CELLUtil.setIconSet(S,U[n.ICONSET])),U[n.ICONSET]&&(T=U[n.ICONSET][3]),U[n.COLORSCALE]&&(T=U[n.COLORSCALE][2])}if(!T){m.CELLUtil.setCellValue(S,E);var y=l.getDOM().classList;isNaN(E)||(y.add("tar"),("STRING"==v.CellType||"start"==f[9])&&y.remove("tar"))}b.sparklines.groupranges.isXists(C,L)&&s.drawSparkline(o,S,C,L)}}};break;case i.COLOR:S=function(i,n,C,L,g,v){var O=new ZSClass.Range(g,v,g,v),u="",D=function(e){u=e[g][v];var t=u.Format||N.ColStyleNames.getStyle(v)||"Default",a=JSUtil.Object.clone(M.CellStyle.getStyleDef(t),!0);a[d.BACKGROUNDCOLOR]=E,a=ZSClass.CellDecorator.getStyle(a,u),m.CELLUtil.setBGColor(i.getDOM(),a[d.BACKGROUNDCOLOR])},R=function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)};t.view.fetchCellData(a,o,c,g,v,k,h,D,R);var f=s.getCellStyleDef(a,o,c,u,v);E="transparent"===E?"":E,f[0]=E,f=s.getStyle(f,u);var S={},T={},I=m.pushDomUtility(a,o,c,g,v,u,S,T,O,f),U=m.getCellRef(a,o,c,g,v),y=I[11];if(y&&m.CELLUtil.setCellBorder(g,v,U.getDOM(),I[11],o),b.Merge.isXists(g,v)){var A=b.Row,B=b.Column,F=A.Visibility.prevNonHidden(g),p=B.hidden.prevNonHidden(v),w=r.hash(F,v,l),H=r.hash(g,p,l);m.getBorderMergeLeft(a,o,c,O.endRow,O.endCol,T[H],g,v,T),m.getBorderMergeTop(a,o,c,O.endRow,O.endCol,S[w],g,v,S)}m.setBorderCache(a,o,c,S,T)};break;case i.TEXTCOLOR:S=function(l,i,n,r,s,C){var L="",g=function(e){L=e[s][C];var t=L.Format||N.ColStyleNames.getStyle(C)||"Default",a=JSUtil.Object.clone(M.CellStyle.getStyleDef(t),!0);a[d.COLOR]=E,a=ZSClass.CellDecorator.getStyle(a,L),m.CELLUtil.setForeColor(l.getDOM(),a[d.COLOR])},v=function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)};t.view.fetchCellData(a,o,c,s,C,k,h,g,v)};break;case i.FONTFAMILY:S=function(e){m.CELLUtil.setFontFamily(e.getDOM(),E)};break;case i.BOLD:S=function(e){var t=e.getDOM().classList;0==E?t.remove("fwb"):t.add("fwb"),e.getDOM().classList=t};break;case i.ITALIC:S=function(e){var t=e.getDOM().classList;0==E?t.remove("fsi"):t.add("fsi"),e.getDOM().classList=t};break;case i.STRIKETHROUGH:S=function(e){var t=e.getDOM().classList;0==E?t.contains("tdsu")?(t.remove("tdsu"),t.add("tdu")):t.remove("tds"):t.add(t.contains("tdu")?"tdsu":"tds"),e.getDOM().classList=t};break;case i.UNDERLINE:S=function(e){var t=e.getDOM().classList;0==E?t.contains("tdsu")?(t.remove("tdsu"),t.add("tds")):t.remove("tdu"):t.add(t.contains("tds")?"tdsu":"tdu"),e.getDOM().classList=t};break;case i.FONTSIZE:S=function(e){m.CELLUtil.setFontSize(e.getDOM(),E)};break;case i.HALIGN:S=function(e,t,a,l,i,r){var s=!1;e.data.Pattern&&(s=void 0==e.data.Pattern[n.REPEATINDEX]||-1==e.data.Pattern[n.REPEATINDEX]?!1:!0);var o=b.CheckBoxRanges,c=e.getDOM().classList;if(c.remove("tac","tar"),o.isXists(i,r))c.add("tac");else if(s)c.add("tar");else switch(E){case"center":c.add("tac");break;case"right":c.add("tar")}};break;case i.VALIGN:S=function(e,t,a,l,i,n){var r=b.CheckBoxRanges,s=e.getDOM().classList;if(s.remove("vab","vam"),r.isXists(i,n))s.add("vam");else switch(E){case"middle":case"vcenter":s.add("vam");break;case"bottom":case"vbottom":s.add("vab")}};break;case i.ALIGN:S=function(e,t,a,l,i,n){var r=b.CheckBoxRanges,s=e.getDOM().classList;if(s.remove("tac","tar","vam","vab"),r.isXists(i,n))s.add("tac","vam");else switch(parseInt(E)){case 6:s.add("tac");break;case 7:s.add("tar");break;case 9:s.add("vam");break;case 10:s.add("tac","vam");break;case 11:s.add("tar","vam");break;case 13:s.add("vab");break;case 14:s.add("tac","vab");break;case 15:s.add("tar","vab")}};break;case i.CELL_COMMENT:S=function(e){switch(E){case"add":e.getDOM().classList.add("cellComment");break;case"remove":e.getDOM().classList.remove("cellComment")}};break;case i.WRAP:S=function(e){var t=e.getDOM().classList;0==E?t.remove("wrap"):t.add("wrap"),e.getDOM().classList=t};break;case i.CLEARALL:S=function(e){e.getDOM().innerHTML="",m.CELLUtil.clearCellStyles(e.getDOM(),o)};break;case i.CLEARCONTENTS:S=function(e){e.getDOM().innerHTML=""};break;case i.CLEARSTYLES:S=function(l,i,n,r,d,C){var L=new ZSClass.Range(d,C,d,C);m.CELLUtil.clearCellStyles(l.getDOM(),o);var g="",v=function(e){g=e[d][C]},O=function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)};t.view.fetchCellData(a,o,c,d,C,k,h,v,O);var E=s.getCellStyleDef(a,o,c,g,C);E=s.getStyle(E,g.ConditionalFormat),E[0]="",E[11]=["","","",""],T.CFAStyleUtil(a,o,c,d,C,g,L,E)};break;case i.HYPERLINK:S=function(e){var t=e.getDOM().childNodes[0];t&&m.CELLUtil.setCellValue(e.getDOM(),t.textContent)};break;case i.CHECKBOX_ADD:S=function(e,t,l,i,n,r){"STRING"!=e.getData().CellType&&m.CELLUtil.drawCheckBox(a,o,c,n,r,e.getDOM(),e.getData().DisplayValue,e.getData())};break;case i.CHECKBOX_EDIT:S=function(e,l,i,n,r,s){t.data.getWorkBook(a,c).getSheetObj(o).CheckBoxRanges.isXists(r,s)&&m.CELLUtil.drawCheckBox(a,o,c,r,s,e.getDOM(),0==E?"FALSE":"TRUE",e.getData())};break;case i.CHECKBOX_CLEAR:S=function(l,i,n,r,C,L){var g=b.CheckBoxRanges;if(g.isXists(C,L)){var v=l.getDOM(),O=function(e){var t=e[C][L],l=s.getCellStyleDef(a,o,c,t,L);l=s.getStyle(l,t.ConditionalFormat),v.innerHTML="";var i=v.classList;i.remove("tac","tar","vam","vab");var n=l[d.HIDETEXT]===!0,r=l[d.ICONSET],g=v;r&&(g=m.CELLUtil.setIconSet(v,r)),m.CELLUtil.setCellValue(g,t.DisplayValue),m.CELLUtil.setFontWeight(v,l[d.FONTWEIGHT]),m.CELLUtil.setFontStyle(v,l[d.FONTSTYLE]),m.CELLUtil.setTextDecoration(v,l[d.TEXTLINETHROUGHTSTYLE],l[d.TEXTUNDERLINESTYLE]),m.CELLUtil.setWrap(v,l[d.TEXTWRAP]),m.CELLUtil.setHAlign(v,l[d.HALLIGN],t,n),m.CELLUtil.setVAlign(v,l[d.VALLIGN])},E=function(t){e.ZSClass.Logger.log("Cell Content couldnt be retrieved",t)};t.view.fetchCellData(a,o,c,C,L,k,h,O,E)}};break;case"RESIZEROW":m.resizeRow(a,o,c,L,v+1-L,E),T.protectHolder.onResize(a,o,c,"ROW",L,v+1-L);break;case"RESIZECOL":m.resizeCol(a,o,c,g,O+1-g,E),T.protectHolder.onResize(a,o,c,"COLUMN",g,O+1-g)}if(S&&m.iterateRange(a,o,c,L,g,v,O,function(){},S.bind(m),u),"RESIZEROW"==I&&(T.PivotFilter&&T.PivotFilter.onResizeRow(a,o,c,E,L),T.DataFilter&&T.DataFilter.onResizeRow(a,o,c,E,L)),"RESIZECOL"==I&&(T.PivotFilter&&T.PivotFilter.onResizeCol(a,o,c,E,g),T.DataFilter&&T.DataFilter.onResizeCol(a,o,c,E,g)),I==i.BORDERS){var U=C.borderStyle;(12==E||25==E||24==E)&&(12==E&&(U="none"),m.iterateRange(a,o,c,L,g,v,O,null,f.bind(m),f.bind(m)),24!=E&&m.iterateRange(a,o,c,L-1,g,L-1,O,null,D.bind(m),D.bind(m)),24!=E&&m.iterateRange(a,o,c,L,g-1,v,g-1,null,R.bind(m),R.bind(m))),(13==E||19==E||20==E||23==E)&&m.iterateRange(a,o,c,L,g-1,v,g-1,null,R.bind(m),R.bind(m)),(14==E||19==E||23==E)&&m.iterateRange(a,o,c,L,O,v,O,null,R.bind(m),R.bind(m)),(16==E||18==E||19==E||22==E||23==E||27==E||28==E)&&m.iterateRange(a,o,c,L-1,g,L-1,O,null,D.bind(m),D.bind(m)),(17==E||18==E||19==E||26==E||27==E||28==E||29==E)&&((26==E||27==E)&&(U="double 3px #000"),(28==E||29==E)&&(U="solid 2px #000"),m.iterateRange(a,o,c,v,g,v,O,null,D.bind(m),D.bind(m))),20==E&&m.iterateRange(a,o,c,L,g,v,O,null,R.bind(m),R.bind(m)),(22==E||23==E)&&m.iterateRange(a,o,c,L,g,v,O,null,D.bind(m),D.bind(m))}},c.CFAStyleUtil=function(e,a,i,n,s,o,c,d){var C=t.data.getWorkBook(e,i).getSheetObj(a),L=this.pane,g={},v={},O=L.pushDomUtility(e,a,i,n,s,o,g,v,c,d),E=L.getCellRef(e,a,i,n,s),u=O[11];if(u&&L.CELLUtil.setCellBorder(n,s,E.getDOM(),O[11],a),C.Merge.isXists(n,s)){var D=C.Row,R=C.Column,f=D.Visibility.prevNonHidden(n),S=R.hidden.prevNonHidden(s),b=r.hash(f,s,l),T=r.hash(n,S,l);L.getBorderMergeLeft(e,a,i,c.endRow,c.endCol,v[T],n,s,v),L.getBorderMergeTop(e,a,i,c.endRow,c.endCol,g[b],n,s,g)}L.setBorderCache(e,a,i,g,v)},c.DVInterrupt=function(e,t,a,l){l&&(this.revokeLastAction=function(e,t,a,l,i){for(k in i)"INTERRUPT"==i[k].messageType&&(o.revokeLastAction(e,t,a,l),this.revokeLastAction=void 0)})}}(this);
!function(t){var e,s=t.sPlusPlus,a=t.ZSEvents,i=t.ZSClass.UIPaneComponent,o=(t.ZSConstants.CommandConstants,i.prototype),n=t.ZSConstants,g=(s.data.UserInfo,a.topic),r=a.Groups,c=a.Names,P=n.ActionConstants,u={253:P.SYSTEMCLIP_PASTE,252:P.FILLSERIES,249:P.SERVERCLIP_PASTE_RANGE};o.showWidgetBtn=function(t,a,i,o){var n=o[1][0][1][0][0],g=o[0],r=u[g],c=o[1][0][0],P=o[1][0][3],d=n.sr,l=n.sc,S=n.er,I=n.ec,h=o[2],m=s.data.getWorkBook(t,i),x=m.getSheetObj(a),R=x.Row.auxiliaryAxis.getPos(d),f=x.Column.axis.getPos(l),C=x.Row.auxiliaryAxis.getPos(S+1),E=x.Column.axis.getPos(I+1),v=s.view.getSheetState(this.gridID,a),p=v.getZoom();e=a,s.data.UserInfo.RecastInfo=[],this.PasteWidget.place(0,R*p,f*p,(C-R)*p,(E-f)*p),this.updateRecastInfo(r,c,d,l,S,I,h,P);var w=this.getViewPort(n),A=!1,W=!1;1===w&&(A=!0),2===w&&(W=!0),3===w&&(A=!0,W=!0),s.data.UserInfo.RecastInfo=[];var v=s.view.getSheetState(this.gridID,a),p=v.getZoom();this.PasteWidget.setDirection(0,W,A)},o.repaintPasteWidget=function(t,a,i){var o=a==e;if(!o&&(e=""),o&&s.data.RecastInfo){var n=s.data.RecastInfo.aparams.rangeList[0][0],g=s.view.getSheetState(this.gridID,a),r=g.getZoom(),c=n.sr,P=n.sc,u=n.er,d=n.ec,l=s.data.getWorkBook(t,i),S=l.getSheetObj(a),I=S.Row.auxiliaryAxis.getPos(c),h=S.Column.axis.getPos(P),m=S.Row.auxiliaryAxis.getPos(u+1),x=S.Column.axis.getPos(d+1),R=this.getViewPort(n);if(0===R)var m=S.Row.auxiliaryAxis.getPos(u+1),x=S.Column.axis.getPos(d+1);if(1===R)var m=S.Row.auxiliaryAxis.getPos(c),x=S.Column.axis.getPos(d+1);if(2===R)var m=S.Row.auxiliaryAxis.getPos(u+1),x=S.Column.axis.getPos(P-1);if(3===R)var m=S.Row.auxiliaryAxis.getPos(c+1),x=S.Column.axis.getPos(P-1);var f=m-I,C=x-h;0>C&&(C=0),this.PasteWidget.place(0,I*r,h*r,f*r,C*r)}},o.hidePasteWidget=function(t,s,a){g.publish(r.Selector.BoundUpdate.Copy,c.Selection.BOUND_UPDATE.HIDE,{RID:t,SHEETID:s,VERSION:a,VisualCueStatus:0}),e="",this.PasteWidget&&this.PasteWidget.hide(t,s,a,1)},o.updateRecastInfo=function(t,e,a,i,o,n,g,r){if(!s.data.isRecastAction){switch(t){case P.SYSTEMCLIP_PASTE:document.getElementsByClassName("shIcon cpWidget")[0].classList.remove("fsWidget");break;case P.SERVERCLIP_PASTE_RANGE:case P.COPY_PASTE:document.getElementsByClassName("shIcon cpWidget")[0].classList.remove("fsWidget");break;case P.FILLSERIES:document.getElementsByClassName("shIcon cpWidget")[0].classList.add("fsWidget")}var c=[[{sr:a,sc:i,er:o,ec:n}]],u=[[g]],d={rangeList:c,sheetList:u};s.data.RecastInfo={aparams:d,action:t,actionId:e},s.data.RecastInfo.popUpOptionType=r}},o.getViewPort=function(t){var e=sPlusPlus,s=e.view.getActiveGridID(),a=e.view.getResourceID(s),i=e.view.getSheetID(s),o=e.view.getVersionID(s),n=e.data.getWorkBook(a,o),g=(n.getSheetObj(i),sPlusPlus.view.getSheetState(s,i)),r=g.sTops[0],c=g.sLefts[0],P=g.sHeights[0],u=g.sWidths[0],d=t[0],l=t[1],S=t[2],I=t[3],n=(t[4],e.data.getWorkBook(a,o)),h=n.getSheetObj(i),m=(h.Row.auxiliaryAxis.getPos(d),h.Column.axis.getPos(l),h.Row.auxiliaryAxis.getPos(S+1)),x=h.Column.axis.getPos(I+1),R=g.getZoom(),f=r+P,C=c+u,E=m*R,v=x*R,p=!1,w=!1;return C>v||(p=!0),f>E||(w=!0),p&&w?3:p?2:w?1:0}}(this);
!function(e){var t,o=e.sPlusPlus,i=e.ZSClass.UIPaneComponent,n=i.prototype,a=o.data.UserInfo,s=e.ZSEvents,l=s.topic,r=s.Groups,c=s.Names;n.PlaceCopySelection=function(e,i,n,a,s){var l=o.data.getWorkBook(e,n),r=l.getSheetObj(i),c=r.Row.auxiliaryAxis.getPos(s.startRow),p=r.Column.axis.getPos(s.startCol),S=r.Row.auxiliaryAxis.getPos(s.endRow+1),g=r.Column.axis.getPos(s.endCol+1),u=o.view.getSheetState(this.gridID,i);t=i;var C=u.getZoom();this.CopySelection&&this.CopySelection.place(a,c*C,p*C,(S-c)*C,(g-p)*C)},n.RemoveCopySelection=function(e,t,o,i){this.CopySelection&&this.CopySelection.hide(i)},n.RepaintCopySelection=function(e,o,i){var n=o==t;if(n){var s={};s.ranges=function(){return a.activeInfo.getCopyDetails().Ranges};for(var p=s.ranges(),S=0;p&&S<p.length;S++){var g=p[S],u={RID:e,SHEETID:o,VERSION:i,ActiveRange:g,RANGEID:g.id};l.publish(r.Selector.DomUpdate.Copy,c.Selection.BOUND_UPDATE.ADD,u)}}}}(this);
!function(e){var i=e.sPlusPlus,t=e.ZSClass.UIPaneComponent,s=t.prototype;s.PlaceFillSelection=function(e,t,s,l,o){var a=i.data.getWorkBook(e,s),n=a.getSheetObj(t),r=n.Row.auxiliaryAxis.getPos(o.startRow),u=n.Column.axis.getPos(o.startCol),S=n.Row.auxiliaryAxis.getPos(o.endRow+1),h=n.Column.axis.getPos(o.endCol+1),c=i.view.getSheetState(this.gridID,t),g=c.getZoom();this.FillSeries&&this.FillSeries.place(l,r*g,u*g,(S-r)*g,(h-u)*g)},s.RemoveFillSelection=function(e,i,t,s){this.FillSeries&&this.FillSeries.hide(s)},s.RemoveFillSeriesCue=function(e,i,t,s){this.FillSeriesCue&&this.FillSeriesCue.hide(s)}}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSClass.UIPaneComponent,s=a.prototype;s.PlaceRecalculateFlash=function(e,a,s,l,o){var i=t.data.getWorkBook(e,s),c=i.getSheetObj(a);c.Merge.extendRange(o);var h=c.Row.auxiliaryAxis.getPos(o.startRow),u=c.Column.axis.getPos(o.startCol),n=c.Row.auxiliaryAxis.getPos(o.endRow+1),r=c.Column.axis.getPos(o.endCol+1),g=t.view.getSheetState(this.gridID,a),R=g.getZoom();this.RecalculateFlash&&this.RecalculateFlash.place(l,h*R,u*R,(n-h)*R,(r-u)*R),this.RecalculateFlash&&this.RecalculateFlash.show(l)}}(this);
!function(e){function t(e,t,a,n,T,g){var E=new l.Range(n,T,n,T),O=r.data.getWorkBook(e,a),h=O.getSheetObj(t);h.Merge.extendRange(E);var v=l.Range.prototype.intersects.call(this.props.bound,E)&&l.Range.prototype.intersects.call(this.props,E);if(v){var C=h.Row.auxiliaryAxis.getPos(E.startRow),N=h.Column.axis.getPos(E.startCol),c=h.Row.auxiliaryAxis.getPos(E.endRow+1),d=h.Column.axis.getPos(E.endCol+1),S=d-N,p=c-C,u=h.CheckBoxRanges.isXists(n,T),w=h.sparklines.groupranges.isXists(n,T)?{row:n,col:T}:void 0,L=i.Math.hash(n,T,s),y=this.getCellRef(e,t,a,n,T);if(!y)return;var D=i.Object.clone(y.data,!0),I=D.Format||h.ColStyleNames.getStyle(T)||"Default",P=i.Object.clone(O.CellStyle.getStyleDef(I),!0),F=P[R.BORDER];if(1==F.length&&(F[1]=F[0],F[2]=F[0],F[3]=F[0]),D.rightBorder){var f=O.CellStyle.getStyleDef(D.rightBorder.Format),m=f[11];1==m.length&&(m[1]=m[0],m[2]=m[0],m[3]=m[0]),F[1]=m[1]}if(D.bottomBorder){var A=O.CellStyle.getStyleDef(D.bottomBorder.Format),B=A[11];1==B.length&&(B[1]=B[0],B[2]=B[0],B[3]=B[0]),F[3]=B[3]}var H=this.Preview.getDom(L);this.Preview.flush(L),this.Preview&&this.Preview.place(L,C,N,p,S),g&&(P=g.call(this,n,T,H,D,P)),o(e,t,a,n,T,H,D,P,u,w)}}function o(e,t,o,r,i,l,s,a,T,g){var E=l.classList;E.add("cell"),n.setBGColor(l,a[R.BACKGROUNDCOLOR]||""),n.setForeColor(l,a[R.COLOR]||""),n.setFontSize(l,a[R.FONTSIZE]?a[R.FONTSIZE]+"pt":"10pt"),n.setFontFamily(l,a[R.FONTNAME]||"");var O=!!a[R.HIDETEXT],h=a[R.ICONSET],v=a[R.COLOR]||"",C=l;h&&(C=n.setIconSet(l,h)),s.Hyperlink?n.addHyperlink(C,s.DisplayValue,s.Hyperlink,v):n.setNumberFormatValue(C,void 0,s,a[R.FONTSIZE],a[R.FONTNAME],!0)?"":n.setCellValue(C,s.DisplayValue),T?n.drawCheckBox(e,t,o,r,i,l,s.DisplayValue,s):(n.setFontWeight(l,a[R.FONTWEIGHT]),n.setFontStyle(l,a[R.FONTSTYLE]),n.setTextDecoration(l,a[R.TEXTLINETHROUGHTSTYLE],a[R.TEXTUNDERLINESTYLE]),n.setWrap(l,a[R.TEXTWRAP]),n.setHAlign(l,a[R.HALLIGN],s,O),n.setVAlign(l,a[R.VALLIGN])),g&&n.drawSparkline(t,l,g.row,g.col),a[R.BORDER]&&(n.setBorderRight(l,a[R.BORDER][1],t),n.setBorderBottom(l,a[R.BORDER][3],t))}var r=e.sPlusPlus,i=e.JSUtil,l=e.ZSClass,s=r.data.Defaults.MAX_COL,a=l.UIPaneComponent,n=l.CellDecorator,T=a.prototype,R={BACKGROUNDCOLOR:0,COLOR:1,FONTSIZE:2,FONTNAME:3,FONTWEIGHT:4,FONTSTYLE:5,TEXTLINETHROUGHTSTYLE:6,TEXTUNDERLINESTYLE:7,TEXTWRAP:8,HALLIGN:9,VALLIGN:10,BORDER:11,HIDETEXT:12,ICONSET:13};T.PlacePreview=function(e,o,i,s,a){var n=r.data.getWorkBook(e,i),T=n.getSheetObj(o),R=T.Row,g=T.Column;s=l.Range.prototype.getIntersectingRange.call(this.props,s);var E=r.view.getActiveGridID(),O=r.view.getSheetState(E,o),h=O.getZoom();this.Preview.setZoom(h);for(var v=s.startRow;v<=s.endRow;v=R.Visibility.nextNonHidden(v))for(var C=s.startCol;C<=s.endCol;C=g.hidden.nextNonHidden(C)){var N=T.Merge.isXists(v,C);(!N||N.isRoot)&&t.call(this,e,o,i,v,C,a)}},T.ClearPreview=function(e,t,o,r,l){var a=i.Math.hash(r,l,s);this.Preview&&this.Preview.remove(a)},T.ClearAllPreview=function(){this.Preview&&this.Preview.removeAll()}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass.UIPaneComponent,s=o.prototype;s.PlaceCellNote=function(e,o,s,i,l,n,h,a,c,u,N,m){var C=t.view.getSheetState(this.gridID,o),r=C.getZoom();this.Notes.place(e,o,s,i,l,h*r,a*r,c*r,u*r,N,m),this.Notes.setComment(e,o,s,i,l,n)},s.RemoveCellNote=function(e,t,o,s,i){this.Notes.hide(s,i)},s.RemoveAllCellNotes=function(){this.Notes.hideAll()}}(this);
!function(e){var o=e.sPlusPlus,t=e.ZSClass.UIPaneComponent,s=t.prototype;s.PlacePrecedance=function(e,t,s,a,i,l){var n=o.data.getWorkBook(e,s),r=n.getSheetObj(t),P=r.Row.auxiliaryAxis.getPos(i.startRow),c=r.Column.axis.getPos(i.startCol),u=r.Row.auxiliaryAxis.getPos(i.endRow+1),g=r.Column.axis.getPos(i.endCol+1),x=o.view.getSheetState(this.gridID,t),d=x.getZoom(),C=(r.Column.axis.getPos(l.startCol)+r.Column.axis.getPos(l.endCol+1))/2,w=(r.Row.auxiliaryAxis.getPos(l.startRow)+r.Row.auxiliaryAxis.getPos(l.endRow+1))/2;this.Precedance.place(a,c*d,P*d,(g-c)*d,(u-P)*d,C*d,w*d)},s.RemoveAllPrecedances=function(){this.Precedance.hideAll()}}(this);
!function(e){var a=sPlusPlus,t=a.data.Defaults,o=t.MAX_COL,n=e.ZSConstants.ActionConstants,r=(e.JSUtil.Math,e.ZSClass.Range),s=(ZSClass.CellDecorator,e.ZSEvents),i=s.topic,l=s.Groups,v=s.Names,C=e.ZSClass.UIPaneComponent.prototype;C.setConditionalStyle=function(e,t,o,n,r,s,i,l){var v=this.pane,C=a.data.getWorkBook(e,t),g=C.getSheetObj(n),R=new ZSClass.Range(v.iHave.startRow,v.iHave.startCol,v.iHave.endRow,v.iHave.endCol);for(var d in r){var w=[];for(var p in r[d])w.push(r[d][p]);for(var h=R.getIntersectingRange(new ZSClass.Range(w[0],w[1],w[2],w[3])),u=h.startRow,f=h.startCol,S=h.endRow,H=h.endCol,c=w[4],p=u;S>=p;p++){l&&!l[p]&&(l[p]=[]);for(var k=f;H>=k;k++){var m=v.getCellRef(e,n,t,p,k);if(m){var D=g.Merge.isXists(p,k);if(D)D.isRoot&&this.pane.mergeHolder.insert(e,n,t,D.root,null,s,i,this.pane);else{var O=m.getData();if(l&&(O.ConditionalFormat=c,l[p][k]=c),O.ConditionalFormat){l||(O.ConditionalFormat=[]);var Z=new ZSClass.Range(u,f,S,H),I=v.pushDomUtility(e,n,t,p,k,O,s,i,Z);m&&v.CELLUtil.setCellStyleandData(m,O,null,null,null,null,p,k,I,o,n)}}}}}}return l},C.pushDOMChanges=function(e,t,o,r,s,i){if(!r||!s)return void Logger.log("EMPTY DATA RESPONSE",r,s);for(var l=this.pane,v=a.data.getWorkBook(e,o),C=v.getSheetObj(t),g=C.ConditionalFormat.Range,R=new ZSClass.Range(l.iHave.startRow,l.iHave.startCol,l.iHave.endRow,l.iHave.endCol),d=(g.getIntersectedRanges(R),{}),w={},p=(C.Row,C.Column,this.pushDOMRange(r,s)),h=r.length-1;h>=0;h--){var u=r[h],f=u[0]+u[1]-1,S=u[0];if(!(f<l.iHave.startRow||S>l.iHave.endRow)){S=Math.max(S,l.iHave.startRow),f=Math.min(f,l.iHave.endRow);for(var H=f;H>=S;H--)for(var c=s[u[2]],k=c.length-1;k>=0;k--){var m=c[k];if(m){var D=m[0]+m[1]-1,O=m[0];if(!(D<l.iHave.startCol||O>l.iHave.endCol)){O=O<l.iHave.startCol?l.iHave.startCol:O,D=D>=l.iHave.endCol?l.iHave.endCol-1:D;for(var Z=D;Z>=O;Z--){var I=m[2],L=l.getCellRef(e,t,o,H,Z),W=new ZSClass.Range(H,Z,H,Z),A=C.DataValidation.getIntersectedRanges(W);if(this.revokeLastAction&&this.revokeLastAction(e,t,o,i,A),L){var M=C.Merge.isXists(H,Z);if(M)M.isRoot&&this.pane.mergeHolder.insert(e,t,o,M.root,null,w,d,this.pane);else{var U=L.data.ConditionalFormat;C.MaxUsedRow=H>C.MaxUsedRow?H:C.MaxUsedRow,C.MaxUsedCol=Z>C.MaxUsedCol?Z:C.MaxUsedCol;var y={ActualValue:I[0],DisplayValue:I[1],Formula:I[2],Format:v.CellStyle.getMappedKey(I[3]),ConditionalFormat:U,CellComment:I[5],Hyperlink:I[6],CellType:I[7],patternColor:I[8],Pattern:I[9],IsContentValid:I[10],hasLink:I[11]};L.setData(y);var B=this.ClientCache.get(i);if(B){var E=B.ACTION;if(this.ClientCache.remove(i),E!==n.CLEARALL&&E!==n.CLEARSTYLES&&E!==n.CLEARCONTENTS&&"SUBMIT"!==E)continue}var G=l.pushDomUtility(e,t,o,H,Z,y,w,d,p);L&&l.CELLUtil.setCellStyleandData(L,y,null,null,null,null,H,Z,G,i,t)}}}}}}}}l.setBorderCache(e,t,o,w,d)},C.pushDOMRange=function(e,a){var t=e[e.length-1],o=t[0]+t[1]-1,n=a[t[2]],r=n[n.length-1][0]+n[n.length-1][1]-1,s=e[0][0],i=a[e[0][2]][0][0],l=new ZSClass.Range(s,i,o,r);return l},C.pushFaultyChanges=function(e,t,n,r,s){var i=this.pane,l=(a.data.getWorkBook(e,n),new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol));for(var v in r){var C=new ZSClass.Range(r[v][0],r[v][1],r[v][2],r[v][3]);C.intersects(l)&&i.updateCells(e,t,n,"ROW",C.startRow,C.startCol,C.endRow,C.endCol)}for(var v in s){var g=parseInt(s[v]/o),R=s[v]%o,C=new ZSClass.Range(g,R,g,R);C.intersects(l)&&i.updateCells(e,t,n,"ROW",C.startRow,C.startCol,C.endRow,C.endCol)}},C.pushCfChanges=function(e,t,n,r,s,i,l){var v=this.pane,C={},g={},R={};r&&this.setConditionalStyle(e,n,l,t,r,g,C,R),v.setBorderCache(e,t,n,g,C);var d=(a.data.getWorkBook(e,n),new ZSClass.Range(v.iHave.startRow,v.iHave.startCol,v.iHave.endRow,v.iHave.endCol));for(var w in s){var p=new ZSClass.Range(s[w][0],s[w][1],s[w][2],s[w][3]);p.intersects(d)&&v.updateCells(e,t,n,"ROW",p.startRow,p.startCol,p.endRow,p.endCol)}for(var w in i){var h=parseInt(i[w]/o),u=i[w]%o,p=new ZSClass.Range(h,u,h,u);p.intersects(d)&&v.updateCells(e,t,n,"ROW",p.startRow,p.startCol,p.endRow,p.endCol)}},C.insertSparklines=function(e,t,o,n){for(var s=a.data.getWorkBook(e,o).getSheetObj(t),C=a.view.getActiveGridID(),g=(a.view.getGridComponent(C),a.view.getSheetState(C,t),this.pane),R=(s.sparklines.cellRange,s.sparklines.groupranges.RangeList.masterList),d=[],w=0;w<n.length;w++){var p=n[w];for(var h in R){var u=R[h];if(u.id==p)for(var f=u.outputRange,S=new ZSClass.Range(g.iHave.startRow,g.iHave.startCol,g.iHave.endRow,g.iHave.endCol),H=0;H<f.length;H++){var c=f[H];d.push(new r(c[0],c[1],c[2],c[3]));for(var k=c[0];k<=c[2];k++)for(var m=c[1];m<=c[3];m++)k>=S.startRow&&m>=S.startCol&&k<S.endRow&&m<S.endCol&&g.updateCells(e,t,o,"ROW",k,m,k,m)}}}i.publish(l.UI,v.SidePanel.Sparklines.CREATE)},C.changeSparklineData=function(e,t,o,n){for(var r=a.view.getActiveGridID(),s=a.view.getGridComponent(r),i=this.pane,l=new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol),v=0;v<n.length;v++){{var C=n[v],g=C[0][0],R=C[0][1],d=C[0][2],w=a.data.getWorkBook(e,o).getSheetObj(d);w.sparklines.cellRange}if(g>=l.startRow&&R>=l.startCol&&g<l.endRow&&R<l.endCol){{s.getCellRef(e,t,o,g,R)}i.updateCells(e,d,o,"ROW",g,R,g,R)}}},C.applySparklineProperties=function(t,o,n,r){for(var s=a.data.getWorkBook(t,n).getSheetObj(o),i=a.view.getActiveGridID(),l=(a.view.getGridComponent(i),this.pane),v=s.sparklines.groupranges.RangeList.masterList,C=(s.sparklines.cellRange,new ZSClass.Range(l.iHave.startRow,l.iHave.startCol,l.iHave.endRow,l.iHave.endCol)),g=0;g<r.length;g++)for(var R=r[g],d=R[0],w=v[d].outputRange,p=0;p<w.length;p++)for(var h=w[p],u=h[0];u<=h[2];u++)for(var f=h[1];f<=h[3];f++)u>=C.startRow&&f>=C.startCol&&u<C.endRow&&f<C.endCol&&this.pane.updateCells(t,o,n,"ROW",u,f,u,f);e.JSUtil.SparklinePool.highlightRanges(t,o,n)},C.editSparklinesGroup=function(e,t,o,n){for(var r=a.data.getWorkBook(e,o).getSheetObj(t),s=a.view.getActiveGridID(),i=a.view.getGridComponent(s),l=this.pane,v=new ZSClass.Range(l.iHave.startRow,l.iHave.startCol,l.iHave.endRow,l.iHave.endCol),C=r.sparklines.groupranges.RangeList.masterList,g={},R=0;R<n.length;R++){var d=n[R],w=d[0];g[w]=!0}for(var p in C){var d=C[p],w=d[R];if(1!=g[w])for(var h=d.outputRange,u=0;u<h.length;u++)for(var f=h[u],S=f[0];S<=f[2];S++)for(var H=f[1];H<=f[3];H++)if(S>=v.startRow&&H>=v.startCol&&S<v.endRow&&H<v.endCol){{i.getCellRef(e,t,o,S,H)}l.updateCells(e,t,o,"ROW",S,H,S,H)}}},C.removeSparklines=function(t,o,n,r){for(var s=a.view.getActiveGridID(),t=a.view.getResourceID(s),n=a.view.getVersionID(s),i=(a.data.getWorkBook(t,n).getSheetObj(o),this.pane),l=new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol),v=0;v<r.length;v++)for(var C=r[v],g=C[0];g<=C[2];g++)for(var R=C[1];R<=C[3];R++)g>=l.startRow&&R>=l.startCol&&g<l.endRow&&R<l.endCol&&i.updateCells(t,o,n,"ROW",g,R,g,R);e.JSUtil.SparklinePool.highlightRanges(t,o,n)},C.sparklineUndo=function(e,t,o,n){for(var r=a.view.getActiveGridID(),e=a.view.getResourceID(r),o=a.view.getVersionID(r),s=(a.data.getWorkBook(e,o).getSheetObj(t),this.pane),i=new ZSClass.Range(s.iHave.startRow,s.iHave.startCol,s.iHave.endRow,s.iHave.endCol),l=0;l<n.length;l++)for(var v=n[l],C=v[0];C<=v[2];C++)for(var g=v[1];g<=v[3];g++)C>=i.startRow&&g>=i.startCol&&C<i.endRow&&g<i.endCol&&s.updateCells(e,t,o,"ROW",C,g,C,g)},C.setSparklineExtremes=function(e,t,o,n){var r=a.view.getActiveGridID(),e=a.view.getResourceID(r),o=a.view.getVersionID(r),s=a.data.getWorkBook(e,o).getSheetObj(t),i=this.pane,l=new ZSClass.Range(i.iHave.startRow,i.iHave.startCol,i.iHave.endRow,i.iHave.endCol),v=s.sparklines.groupranges.RangeList.masterList;for(var C in n)for(var g=n[C][0],R=v[g].outputRange,C=0;C<R.length;C++)for(var d=R[C],w=d[0];w<=d[2];w++)for(var p=d[1];p<=d[3];p++)w>=l.startRow&&p>=l.startCol&&w<l.endRow&&p<l.endCol&&this.pane.updateCells(e,t,o,"ROW",w,p,w,p)}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass.UIPaneComponent,i=o.prototype;i.PlaceRangePickerSelection=function(e,o,i,a,n,s,r,c){var g=t.data.getWorkBook(e,i),l=g.getSheetObj(o),P=l.Row.auxiliaryAxis.getPos(n.startRow),R=l.Column.axis.getPos(n.startCol),h=l.Row.auxiliaryAxis.getPos(n.endRow+1),u=l.Column.axis.getPos(n.endCol+1),k=t.view.getSheetState(this.gridID,o),C=k.getZoom();this.RangePicker.place(a,P*C,R*C,(h-P)*C,(u-R)*C,s,!r),this.RangePicker.setData(a,n.startRow,n.startCol,n.endRow,n.endCol),this.RangePicker.setColor(a,c)},i.RemoveRangePickerSelection=function(e,t,o,i){this.RangePicker.hide(i)},i.RemoveRangePickerSelectionFrom=function(e,t,o,i){this.RangePicker.hideFrom(i)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass.UIPaneComponent,o=i.prototype;o.PlaceRangeSelection=function(e,i,o,s,l,n){var a=t.data.getWorkBook(e,o),g=a.getSheetObj(i),h=g.Row.auxiliaryAxis.getPos(l.startRow),r=g.Column.axis.getPos(l.startCol),u=g.Row.auxiliaryAxis.getPos(l.endRow+1),S=g.Column.axis.getPos(l.endCol+1),c=t.view.getSheetState(this.gridID,i),R=c.getZoom();this.RangeSelection&&this.RangeSelection.place(s,h*R,r*R,(u-h)*R,(S-r)*R,!1,n),this.FillSeriesCue&&this.FillSeriesCue.place(0,h*R,r*R,(u-h)*R,(S-r)*R)},o.RemoveRangeSelection=function(e,t,i,o){this.RangeSelection&&this.RangeSelection.hide(o),this.FillSeriesCue&&this.FillSeriesCue.hide(0)}}(this);
!function(t){function i(t,i,o,s,n,a,l){var r=e.data.getWorkBook(t,o),g=r.getSheetObj(i),d=g.Row.auxiliaryAxis.getPos(s),u=g.Column.axis.getPos(n),H=g.Row.auxiliaryAxis.getPos(s+1),v=g.Column.axis.getPos(n+1),C=JSUtil.Math.hash(s,n,h),V=e.view.getSheetState(this.gridID,i),R=V.getZoom();this.HighlightVersion&&(this.HighlightVersion.place(C,d*R,u*R,(H-d)*R,(v-u)*R),this.HighlightVersion.setColor(C,"#"+a),this.HighlightVersion.setName(C,l))}var e=t.sPlusPlus,o=t.ZSClass.UIPaneComponent,s=o.prototype,n=e.data.Defaults,h=n.MAX_COL;s.PlaceHighlightVersion=function(t,o,s,n,h,a){for(var l=e.data.getWorkBook(t,s),r=l.getSheetObj(o),g=r.Row,d=r.Column,u=n.startRow;u<=n.endRow;u=g.Visibility.nextNonHidden(u))for(var H=n.startCol;H<=n.endCol;H=d.hidden.nextNonHidden(H))i.call(this,t,o,s,u,H,h,a)},s.RemoveHighlightVersion=function(t,i,o,s){var n=e.data.getWorkBook(t,o),a=n.getSheetObj(i),l=a.Row,r=a.Column;s=ZSClass.Range.prototype.getIntersectingRange.call(this.props,s);for(var g=s.startRow;g<=s.endRow;g=l.Visibility.nextNonHidden(g))for(var d=s.startCol;d<=s.endCol;d=r.hidden.nextNonHidden(d)){var u=JSUtil.Math.hash(g,d,h);this.HighlightVersion&&this.HighlightVersion.remove(u)}},s.RemoveAllHighlightVersion=function(){this.HighlightVersion&&this.HighlightVersion.removeAll()}}(this);
!function(e){var s=e.sPlusPlus,t=e.ZSClass.UIPaneComponent,r=t.prototype;r.PlaceUserPresence=function(e,t,r,i,n,o,P){var c=s.data.getWorkBook(e,r),a=c.getSheetObj(t),h=a.Row.auxiliaryAxis.getPos(n.startRow),U=a.Column.axis.getPos(n.startCol),u=a.Row.auxiliaryAxis.getPos(n.endRow+1),l=a.Column.axis.getPos(n.endCol+1),g=s.view.getSheetState(this.gridID,t),d=g.getZoom();this.UserPresence&&this.UserPresence.place(i,h*d,U*d,(u-h)*d,(l-U)*d),this.UserPresence&&this.UserPresence.setColor(i,"#"+o),this.UserPresence&&this.UserPresence.setName(i,P),this.UserPresence&&this.UserPresence.setEditStatus(i,!1)},r.RemoveUserPresence=function(e,s,t,r){this.UserPresence&&this.UserPresence.hide(r)},r.EditUserPresence=function(e,s,t,r){this.UserPresence&&this.UserPresence.setEditStatus(r,!0)}}(this);
!function(t){var i=t.sPlusPlus,e=t.ZSClass.UIPaneComponent,s=e.prototype;s.PlaceCommentsHighlight=function(t,e,s,o,h){var g=i.data.getWorkBook(t,s),m=g.getSheetObj(e),n=m.Row.auxiliaryAxis.getPos(o.startRow),a=m.Column.axis.getPos(o.startCol),l=m.Row.auxiliaryAxis.getPos(o.endRow+1),C=m.Column.axis.getPos(o.endCol+1),r=i.view.getActiveGridID(),H=i.view.getSheetState(r,e),u=H.getZoom();this.CommentsHighlight.ranges[h]=o,this.CommentsHighlight&&this.CommentsHighlight.hightLightComments(h),this.CommentsHighlight&&this.CommentsHighlight.place(h,n*u,a*u,(l-n)*u,(C-a)*u)},s.RepaintCommentsHighlight=function(t,e,s){for(var o in this.CommentsHighlight.ranges){var h=this.CommentsHighlight.ranges[o],g=i.data.getWorkBook(t,s),m=g.getSheetObj(e),n=m.Row.auxiliaryAxis.getPos(h.startRow),a=m.Column.axis.getPos(h.startCol),l=m.Row.auxiliaryAxis.getPos(h.endRow+1),C=m.Column.axis.getPos(h.endCol+1),r=i.view.getSheetState(this.gridID,e),H=r.getZoom();this.CommentsHighlight&&this.CommentsHighlight.hightLightComments(o),this.CommentsHighlight&&this.CommentsHighlight.place(o,n*H,a*H,(l-n)*H,(C-a)*H)}},s.RemoveCommentsHighlight=function(t,i,e,s,o){this.CommentsHighlight&&this.CommentsHighlight.hide(o)}}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSClass.UIPaneComponent,o=i.prototype,g={};o.HighlightRange=function(t,i,o,h,s,r){var a=e.data.getWorkBook(t,o),l=a.getSheetObj(i),n=l.Row.auxiliaryAxis.getPos(s.startRow),d=l.Column.axis.getPos(s.startCol),u=l.Row.auxiliaryAxis.getPos(s.endRow+1),v=l.Column.axis.getPos(s.endCol+1),R=e.view.getSheetState(this.gridID,i),H=R.getZoom();g[h]={rID:t,sheetID:i,version:o,rangeID:h,range:s,color:r};this.Highlight.place(h,n*H,d*H,(u-n)*H,(v-d)*H),this.Highlight.setData(h,s.startRow,s.startCol,s.endRow,s.endCol),this.Highlight.setColor(h,r)},o.RemoveHighlightRanges=function(t,e,i,o){if(void 0==o)return this.Highlight.hideFrom(0),void(g={});for(var h=0;h<o.length;h++){var s=o[h];this.Highlight.hide(s),delete g[s]}},o.ResizeHighlightLayer=function(){this.Highlight.hideFrom(1);for(var t in g){var e=g[t];delete g[t],o.HighlightRange.call(this,e.rID,e.sheetID,e.version,e.rangeID,e.range,e.color)}}}(this);
!function(t){var i=(t.sPlusPlus,t.ZSClass.UIPaneComponent),a=i.prototype;a.PlaceDVBtn=function(t,i,a,n,o,D){this.DataValidation&&this.DataValidation.placeDVBtn(t,i,a,1,n,o,D)},a.HideDVBtn=function(t,i,a){this.DataValidation&&this.DataValidation.hideDVBtn(t,i,a,1)},a.ShowDVBtn=function(t,i,a){this.DataValidation&&this.DataValidation.showDVBtn(t,i,a,1)},a.PlaceDVHint=function(t,i,a,n,o,D){this.DataValidationHint&&this.DataValidationHint.placeDVHint(t,i,a,n,o,D)},a.HideDVHint=function(t,i,a){this.DataValidationHint&&this.DataValidationHint.hideDVHint(t,i,a)},a.ShowDVHint=function(t,i,a){this.DataValidationHint&&this.DataValidationHint.showDVHint(t,i,a)}}(this);
!function(e){function i(e){d&&(l.publish(o.Listener,p.Browser.UITileLoad,{}),e&&(d=void 0))}function t(){var e=this.grid.getBoundingClientRect();this.rects.left=e.left,this.rects.top=e.top,this.rects.height=e.height,this.rects.width=e.width}function n(e,i,t,n,h,l,o,p,r,c,v,d,A,S){function u(){var e=a.data.getWorkBook(i,n),s=e.getSheetObj(t),h=s.Column.axis.getPos(y.pane0.props.bound.startCol);y.pane0&&y.setRelativeScroll0(i,t,n,this.scrollLeft-(y.pane0.props.sLeft-h),0,!0)}function g(){var e=a.data.getWorkBook(i,n),s=e.getSheetObj(t),h=s.Row.auxiliaryAxis.getPos(y.pane0.props.bound.startRow);y.pane0&&y.setRelativeScroll0(i,t,n,0,this.scrollTop-(y.pane0.props.sTop-h),!0)}var R=h.querySelector(".hSP"),f=h.querySelector(".vSP"),H=h.querySelector(".colHeadHolder"),w=h.querySelector(".rowHeadHolder"),C=h.querySelector(".vFreezeCue"),P=h.querySelector(".hFreezeCue"),m=h.querySelector(".vCueHandler"),D=h.querySelector(".hCueHandler"),B=h.querySelector(".gridholder"),y=this;this.gridID=e,this.rID=i,this.sheetID=t,this.version=n,this.grid=h||B,this.allowToScroll=!0,H&&(this.colHeader0=new s.UIColHeader(H,e)),H&&(this.colHeader1=new s.UIColHeader(H,e)),w&&(this.rowHeader0=new s.UIRowHeader(w,e)),w&&(this.rowHeader1=new s.UIRowHeader(w,e)),R&&(this.hScroll=new s.UIHScrollBar(R,u)),f&&(this.vScroll=new s.UIVScrollBar(f,g)),C&&(this.vCue=new s.UIFreezeCue(C)),P&&(this.hCue=new s.UIFreezeCue(P)),m&&(this.vFHCue=new s.UIColHeaderFreezeCue(m,e)),D&&(this.hFHCue=new s.UIRowHeaderFreezeCue(D,e)),s.Layer&&(this.Ole=new s.Layer.Ole.MasterController,this.Button=new s.Layer.Button.Controller(e,i,t,n,B.parentElement,this.Ole),this.Chart=new s.Layer.Chart.Controller(e,i,t,n,B.parentElement,this.Ole),this.Image=new s.Layer.Image.Controller(e,i,t,n,B.parentElement,this.Ole)),this.pane0=new s.UIPaneComponent(B,e,"pane0",this.Button,this.Chart,this.Image),this.pane1=new s.UIPaneComponent(B,e,"pane1",this.Button,this.Chart,this.Image),this.pane2=new s.UIPaneComponent(B,e,"pane2",this.Button,this.Chart,this.Image),this.pane3=new s.UIPaneComponent(B,e,"pane3",this.Button,this.Chart,this.Image),this.lockSheetCue=new s.ProtectSheetCue(B),this.scrollToForAllGridsTimeOutId,this.MaxScrolledRow=0,this.MaxScrolledCol=0,this.pane0.props.sLeft=A[0],this.pane1.props.sLeft=A[1],this.pane0.props.sTop=S[0],this.pane1.props.sTop=S[1],this.flush=function(){B.innerHTML="",H&&(H.innerHTML=""),w&&(w.innerHTML=""),R&&(R.innerHTML=""),f&&(f.innerHTML="")},this.Alive={pane0:!1,pane1:!1,pane2:!1,pane3:!1},this.rects={},this.boundary=l,this.setTop(c),this.setLeft(r),this.setHeight(d),this.setWidth(v),this.updateBoundary(i,t,n,o,p),this.setDimensions(i,t,n,d,v),this.setContentDimensions(i,t,n),this.addDropDownListeners&&this.addDropDownListeners(this.grid,this.gridID)}var s=e.ZSClass,a=e.sPlusPlus,h=e.ZSEvents,l=h.topic,o=h.Groups,p=h.Names,r=(e.ZSDevTools.Logger,e.document,a.view.measures),c=e.Math.abs,v=a.view.Defaults,d=i;l.register(o.Listener,p.DocAction.DOCUMENT.CLOSE,function(){d=i}),n.prototype={getDom:function(){return this.grid},setLeft:function(e){this.grid.style.left=e+"px",t.call(this)},setTop:function(e){this.grid.style.top=e+"px",t.call(this)},setHeight:function(e){this.grid.style.height=e+"px",t.call(this)},setWidth:function(e){this.grid.style.width=e+"px",t.call(this)},isInViewPort:function(e){return this.Alive.pane0&&this.pane0.isInViewPort(e)||this.Alive.pane1&&this.pane1.isInViewPort(e)||this.Alive.pane2&&this.pane2.isInViewPort(e)||this.Alive.pane3&&this.pane3.isInViewPort(e)},getRelativeCoordinates:function(e){var i=e.pageX-this.rects.left,t=e.pageY-this.rects.top;i-=this.rowHeader0?this.rowHeader0.getRects().width:0,t-=this.colHeader0?this.colHeader0.getRects().height:0;var n=a.view.getSheetState(this.gridID,this.sheetID),s=n.getZoom();return i=i<n.getScreenWidths()[1]?i+n.getScrollLefts()[1]:n.getScrollLefts()[0]-n.getScreenWidths()[1]+i,t=t<n.getScreenHeights()[1]?t+n.getScrollTops()[1]:n.getScrollTops()[0]-n.getScreenHeights()[1]+t,{x:i/s,y:t/s}},onLockSheet:function(e,i,t,n){if(n){var s=a.data.getWorkBook(e,t),h=s.getSheetObj(i),l=h.ProtectedRanges;this.removeCellProtect(e,i,t,l),this.lockSheetCue.show()}else this.lockSheetCue.hide()},HighlightInvalidData:function(){a.data.UserInfo.HighlightInvalidData?this.grid.classList.add("invldData"):this.grid.classList.remove("invldData")},getRects:function(){return this.rects},getCenterPoint:function(){var e=this.pane0.props.sLeft+this.pane0.props.sWidth+15-this.rects.width/2,i=this.pane0.props.sTop+this.pane0.props.sHeight+15-this.rects.height/2;return{x:e,y:i}},setDimensions:function(e,i,n,s,h){this.setWidth(h),this.setHeight(s),s-=r.Grid.ColHeader+r.Grid.HScrollBar,h-=r.Grid.RowHeader+r.Grid.VScrollBar;var l=a.view.getActiveGridID(),o=a.data.getWorkBook(e,n).getSheetObj(i),p=a.view.getSheetState(l,i),c=p.getZoom(),v=o.Row.auxiliaryAxis.getPos(o.Row.FreezedCount)*c,d=o.Column.axis.getPos(o.Column.FreezedCount)*c,A=v,S=d,u=Math.max(s-A,0),g=Math.max(h-S,0),R=A,f=S,H=1,w=0;this.pane0&&this.pane0.setTop(R),this.pane0&&this.pane0.setLeft(f),this.pane0&&this.pane0.setHeight(u),this.pane0&&this.pane0.setWidth(g),this.pane1&&this.pane1.setHeight(R),this.pane1&&this.pane1.setWidth(f),this.pane2&&this.pane2.setLeft(f),this.pane2&&this.pane2.setWidth(g),this.pane2&&this.pane2.setHeight(R),this.pane3&&this.pane3.setTop(R),this.pane3&&this.pane3.setHeight(u),this.pane3&&this.pane3.setWidth(f),this.colHeader0&&this.colHeader0.setLeft(e,i,n,f),this.colHeader0&&this.colHeader0.setWidth(e,i,n,g),this.colHeader1&&this.colHeader1.setWidth(e,i,n,f),this.rowHeader0&&this.rowHeader0.setTop(e,i,n,R),this.rowHeader0&&this.rowHeader0.setHeight(e,i,n,u),this.rowHeader1&&this.rowHeader1.setHeight(e,i,n,R),this.hCue&&this.hCue.setTop(R),this.vCue&&this.vCue.setLeft(f),this.hFHCue&&this.hFHCue.setTop(R+r.Grid.ColHeader-r.Grid.RowFreezeCue+H),this.vFHCue&&this.vFHCue.setLeft(f+r.Grid.RowHeader-r.Grid.ColFreezeCue+w);var C=p.getScreenWidths()[1],P=p.getScreenHeights()[1],m=Math.min(f-C,0),D=Math.min(R-P,0);(m||D)&&this.setScroll0(e,i,n,this.pane0.props.sLeft+m,this.pane0.props.sTop+D);var p=a.view.getSheetState(this.gridID,i);p.setScrollPosition0(this.pane0.props.sTop,this.pane0.props.sLeft),p.setScrollPosition1(this.pane1.props.sTop,this.pane1.props.sLeft),p.setScreenWidths(g,f),p.setScreenHeights(u,R),t.call(this)},setContentDimensions:function(e,i,t){var n=a.view.getActiveGridID(),s=a.data.getWorkBook(e,t).getSheetObj(i),h=a.view.getSheetState(n,i),l=h.getZoom(),o=this.pane1.props.bound,p=this.pane0.props.bound,r=s.Row.auxiliaryAxis.getPos(p.endRow+1)*l,c=s.Row.auxiliaryAxis.getPos(o.endRow+1)*l,v=s.Column.axis.getPos(p.endCol+1)*l,d=s.Column.axis.getPos(o.endCol+1)*l;this.setContentHeight(e,i,t,r,c),this.setContentWidth(e,i,t,v,d)},setContentHeight:function(e,i,t,n,s){this.pane0&&this.pane0.setContentHeight(n),this.pane1&&this.pane1.setContentHeight(s),this.pane2&&this.pane2.setContentHeight(s),this.pane3&&this.pane3.setContentHeight(n),this.rowHeader0&&this.rowHeader0.setContentHeight(n),this.rowHeader1&&this.rowHeader1.setContentHeight(s),this.updateVScrollBar(e,i,t)},setContentWidth:function(e,i,t,n,s){this.pane0&&this.pane0.setContentWidth(n),this.pane1&&this.pane1.setContentWidth(s),this.pane2&&this.pane2.setContentWidth(n),this.pane3&&this.pane3.setContentWidth(s),this.colHeader0&&this.colHeader0.setContentWidth(n),this.colHeader1&&this.colHeader1.setContentWidth(s),this.updateHScrollBar(e,i,t)},DummyScroll:function(e,i,t){this.setScroll0(e,i,t,this.pane0.props.sLeft,this.pane0.props.sTop),this.setScroll1(e,i,t,this.pane1.props.sLeft,this.pane1.props.sTop),this.Alive.pane2&&this.setScroll2(e,i,t,this.pane2.props.sLeft,this.pane2.props.sTop),this.Alive.pane3&&this.setScroll3(e,i,t,this.pane3.props.sLeft,this.pane3.props.sTop),this.onScroll(e,i,t,0,0,d)},onScroll:function(e,i,t,n,s,h){var l=this,o=a.view.getActiveGridID(),p=a.view.getSheetState(o,i),r=p.getZoom(),d=(a.data.getWorkBook(e,t).getSheetObj(i),this.onBeforeScroll.bind(this)),A=this.fill.bind(this),o=this.gridID;return c(n)<=v.scrollStableX*r&&c(s)<=v.scrollStableY*r?(d(e,i,t),l.fetchData(e,i,t),A(e,i,t,h),void l.updateState(e,i,t)):(clearTimeout(this.scrollToForAllGridsTimeOutId),void(this.scrollToForAllGridsTimeOutId=setTimeout(function(){d(e,i,t),l.fetchData(e,i,t),A(e,i,t,h),l.updateState(e,i,t)},v.TileLoadTimeOut)))},updateState:function(e,i){var t=a.view.getSheetState(this.gridID,i);t.setScrollPosition0(this.pane0.props.sTop,this.pane0.props.sLeft),t.setScrollPosition1(this.pane1.props.sTop,this.pane1.props.sLeft)},setRelativeScroll0:function(e,i,t,n,s){this.setScroll0(e,i,t,this.pane0.props.sLeft+n,this.pane0.props.sTop+s),this.onScroll(e,i,t,n,s,d)},setRelativeScroll1:function(e,i,t,n,s){this.setScroll1(e,i,t,this.pane1.props.sLeft+n,this.pane1.props.sTop+s),this.onScroll(e,i,t,n,s,d)},setRelativeScroll2:function(e,i,t,n,s){this.setScroll2(e,i,t,this.pane2.props.sLeft+n,this.pane2.props.sTop+s),this.onScroll(e,i,t,n,s,d)},setRelativeScroll3:function(e,i,t,n,s){this.setScroll3(e,i,t,this.pane3.props.sLeft+n,this.pane3.props.sTop+s),this.onScroll(e,i,t,n,s,d)},setRelativeScrollRow0:function(e,i,t,n){this.setScrollRow0(e,i,t,this.rowHeader0.Props.sTop+n),this.onScroll(e,i,t,n,d)},setRelativeScrollRow1:function(e,i,t,n){this.setScrollRow1(e,i,t,this.rowHeader0.Props.sTop+n),this.onScroll(e,i,t,n,d)},setRelativeScrollCol0:function(e,i,t,n){this.setScrollCol0(e,i,t,this.colHeader0.Props.sLeft+n),this.onScroll(e,i,t,n,d)},setRelativeScrollCol1:function(e,i,t,n){this.setScrollCol1(e,i,t,this.colHeader1.Props.sLeft+n),this.onScroll(e,i,t,n,d)},setRelativeScroll:function(e,i,t,n,s,h,l,o){if(this.allowToScroll){var p=a.view.getActiveGridID(),r=a.view.getSheetState(p,i),c=this.getRects(),v=c.left,d=c.top;this.rowHeader0&&(v+=this.rowHeader0.getRects().width),this.colHeader0&&(d+=this.colHeader0.getRects().height),h-=v,l-=d;var A=r.getScreenHeights()[1],S=r.getScreenWidths()[1];l>A?h>S?this.setRelativeScroll0(e,i,t,n,s,!!o):h>=0?this.setRelativeScroll3(e,i,t,n,s,!!o):this.setRelativeScrollRow0(e,i,t,s):l>=0?h>S?this.setRelativeScroll2(e,i,t,n,s,!!o):h>=0?this.setRelativeScroll1(e,i,t,n,s,!!o):this.setRelativeScrollRow1(e,i,t,s):h>S?this.setRelativeScrollCol0(e,i,t,n):h>=0&&this.setRelativeScrollCol1(e,i,t,n)}},setScroll0:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.setScroll(e,i,t,n,s),this.Alive.pane2&&this.pane2.setScrollLeft(e,i,t,n),this.Alive.pane3&&this.pane3.setScrollTop(e,i,t,s),this.colHeader0&&this.colHeader0.setScroll(e,i,t,n),this.rowHeader0&&this.rowHeader0.setScroll(e,i,t,s),this.updateState(e,i,t)},setScroll1:function(e,i,t,n,s){this.Alive.pane1&&this.pane1.setScroll(e,i,t,n,s),this.Alive.pane3&&this.pane3.setScrollLeft(e,i,t,n),this.Alive.pane2&&this.pane2.setScrollTop(e,i,t,s),this.colHeader1&&this.colHeader1.setScroll(e,i,t,n),this.rowHeader1&&this.rowHeader1.setScroll(e,i,t,s),this.updateState(e,i,t)},setScroll2:function(e,i,t,n,s){this.Alive.pane2&&this.pane2.setScroll(e,i,t,n,s),this.Alive.pane1&&this.pane1.setScrollTop(e,i,t,s),this.Alive.pane0&&this.pane0.setScrollLeft(e,i,t,n),this.colHeader0&&this.colHeader0.setScroll(e,i,t,n),this.rowHeader1&&this.rowHeader1.setScroll(e,i,t,s),this.updateState(e,i,t)},setScroll3:function(e,i,t,n,s){this.Alive.pane3&&this.pane3.setScroll(e,i,t,n,s),this.Alive.pane0&&this.pane0.setScrollTop(e,i,t,s),this.Alive.pane1&&this.pane1.setScrollLeft(e,i,t,n),this.colHeader1&&this.colHeader1.setScroll(e,i,t,n),this.rowHeader0&&this.rowHeader0.setScroll(e,i,t,s),this.updateState(e,i,t)},setScrollRow0:function(e,i,t,n){this.Alive.pane0&&this.pane0.setScrollTop(e,i,t,n),this.Alive.pane3&&this.pane3.setScrollTop(e,i,t,n),this.rowHeader0&&this.rowHeader0.setScroll(e,i,t,n),this.updateState(e,i,t)},setScrollRow1:function(e,i,t,n){this.Alive.pane1&&this.pane1.setScrollTop(e,i,t,n),this.Alive.pane2&&this.pane2.setScrollTop(e,i,t,n),this.rowHeader1&&this.rowHeader1.setScroll(e,i,t,n),this.updateState(e,i,t)},setScrollCol0:function(e,i,t,n){this.Alive.pane0&&this.pane0.setScrollLeft(e,i,t,n),this.Alive.pane2&&this.pane2.setScrollLeft(e,i,t,n),this.colHeader0&&this.colHeader0.setScroll(e,i,t,n),this.updateState(e,i,t)},setScrollCol1:function(e,i,t,n){this.Alive.pane1&&this.pane1.setScrollLeft(e,i,t,n),this.Alive.pane3&&this.pane3.setScrollLeft(e,i,t,n),this.colHeader1&&this.colHeader1.setScroll(e,i,t,n),this.updateState(e,i,t)},updateMaxUsedCell:function(e,i,t,n,s){{var h=a.data.getWorkBook(e,t);h.getSheetObj(i)}!n&&(n=this.pane0?this.pane0.pane.iHave.endRow:0),!s&&(s=this.pane0?this.pane0.pane.iHave.endCol:0),n>this.MaxScrolledRow&&(this.MaxScrolledRow=n,this.updateVScrollBar(e,i,t)),s>this.MaxScrolledCol&&(this.MaxScrolledCol=s,this.updateHScrollBar(e,i,t))},updateHScrollBar:function(e,i,t){var n=this.MaxScrolledCol,s=a.data.getWorkBook(e,t),h=s.getSheetObj(i),l=h.Column.axis.getPos(this.pane0.props.bound.startCol),o=h.Column.axis.getPos(n+1)-l;this.hScroll&&this.hScroll.setContentWidth(o),this.hScroll&&this.Alive.pane0&&this.hScroll.setScroll(this.pane0.props.sLeft-l)},updateVScrollBar:function(e,i,t){var n=this.MaxScrolledRow,s=a.data.getWorkBook(e,t),h=s.getSheetObj(i),l=h.Row.auxiliaryAxis.getPos(this.pane0.props.bound.startRow),o=h.Row.auxiliaryAxis.getPos(n+1)-l;this.vScroll&&this.vScroll.setContentHeight(o),this.vScroll&&this.Alive.pane0&&this.vScroll.setScroll(this.pane0.props.sTop-l)},onBeforeScroll:function(e,i,t){this.Alive.pane0&&this.pane0.onBeforeFill(e,i,t),this.Alive.pane1&&this.pane1.onBeforeFill(e,i,t),this.Alive.pane2&&this.pane2.onBeforeFill(e,i,t),this.Alive.pane3&&this.pane3.onBeforeFill(e,i,t);var n=a.data.getWorkBook(e,t),s=n.getSheetObj(i),h=s.Row.auxiliaryAxis.getPos(this.pane0.props.bound.startRow),l=s.Column.axis.getPos(this.pane0.props.bound.startCol);this.hScroll&&this.Alive.pane0&&this.hScroll.setScroll(this.pane0.props.sLeft-l),this.vScroll&&this.Alive.pane0&&this.vScroll.setScroll(this.pane0.props.sTop-h)},fill:function(e,i,t,n){this.Alive.pane0&&this.pane0.fill(e,i,t,n),this.Alive.pane1&&this.pane1.fill(e,i,t,n),this.Alive.pane2&&this.pane2.fill(e,i,t,n),this.Alive.pane3&&this.pane3.fill(e,i,t,n)},onPlaceDim:function(){this.grid.classList.add("dimLayers")},onRemoveDim:function(){this.grid.classList.remove("dimLayers")},updateStoryStatus:function(e,i,t,n){this.isStoryAvailable=n},fetchData:function(i,t,n,h,l){var o=o||a.view.getActiveGridID(),p=[];this.Alive.pane0&&p.push(new s.Range(this.pane0.props.iHave.startRow,this.pane0.props.iHave.startCol,this.pane0.props.iHave.endRow,this.pane0.props.iHave.endCol)),this.Alive.pane1&&p.push(new s.Range(this.pane1.props.iHave.startRow,this.pane1.props.iHave.startCol,this.pane1.props.iHave.endRow,this.pane1.props.iHave.endCol)),this.Alive.pane2&&p.push(new s.Range(this.pane2.props.iHave.startRow,this.pane2.props.iHave.startCol,this.pane2.props.iHave.endRow,this.pane2.props.iHave.endCol)),this.Alive.pane3&&p.push(new s.Range(this.pane3.props.iHave.startRow,this.pane3.props.iHave.startCol,this.pane3.props.iHave.endRow,this.pane3.props.iHave.endCol)),e.UserAction.prefetchData(i,t,n,p,h,l,o),this.updateMaxUsedCell(i,t,n)},fetchCacheData:function(i,t,n,h){var h=h||a.view.getActiveGridID(),l=[];this.Alive.pane0&&l.push(new s.Range(this.pane0.props.iHave.startRow,this.pane0.props.iHave.startCol,this.pane0.props.iHave.endRow,this.pane0.props.iHave.endCol)),e.UserAction.prefetchCacheData(i,t,n,l,h)},getCellRef:function(e,i,t,n,s){var h=a.data.getWorkBook(e,t),l=h.getSheetObj(i),o=l.Row.FreezedCount,p=l.Column.FreezedCount,r=l.Merge.isXists(n,s);r&&r.isRoot&&(n=r.root.startRow,s=r.root.startCol);var c;return o>n?p>s?this.Alive.pane1&&(c=this.pane1.getCellRef(e,i,t,n,s)):this.Alive.pane2&&(c=this.pane2.getCellRef(e,i,t,n,s)):p>s?this.Alive.pane3&&(c=this.pane3.getCellRef(e,i,t,n,s)):this.Alive.pane0&&(c=this.pane0.getCellRef(e,i,t,n,s)),c},updateBoundary:function(e,i,t,n,s){var a=this.boundary.startRow,h=this.boundary.startCol,l=this.boundary.endRow,o=this.boundary.endCol,p=Math.max(0,n-1),r=Math.max(0,s-1);this.Alive.pane0=!0,this.Alive.pane1=!!s&&!!n,this.Alive.pane2=!!n,this.Alive.pane3=!!s,!this.Alive.pane0&&this.pane0.reset(e,i,t),!this.Alive.pane1&&this.pane1.reset(e,i,t),!this.Alive.pane2&&this.pane2.reset(e,i,t),!this.Alive.pane3&&this.pane3.reset(e,i,t),this.pane0&&this.pane0.updateBoundary(e,i,t,n,s,l,o),this.pane1&&this.pane1.updateBoundary(e,i,t,a,h,p,r),this.pane2&&this.pane2.updateBoundary(e,i,t,a,s,p,o),this.pane3&&this.pane3.updateBoundary(e,i,t,n,h,l,r),this.colHeader0&&this.colHeader0.updateBoundary(e,i,t,s,o),this.colHeader1&&this.colHeader1.updateBoundary(e,i,t,h,r),this.rowHeader0&&this.rowHeader0.updateBoundary(e,i,t,n,l),this.rowHeader1&&this.rowHeader1.updateBoundary(e,i,t,a,p),this.RePaintSelections&&this.RePaintSelections(e,i,t),this.Ole&&this.Ole.updateBoundary(e,i,t),this.showDataFilter(e,i,t)},scrollIntoView:function(e,i,t,n,s,a,h){this.Alive.pane0&&this.pane0.scrollIntoView(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.scrollIntoView(e,i,t,n,s,a,h),this.DummyScroll(e,i,t)},onRowInsertBefore:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.onRowInsertBefore(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.onRowInsertBefore(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.onRowInsertBefore(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.onRowInsertBefore(e,i,t,n,s,a)},onColInsertBefore:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.onColInsertBefore(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.onColInsertBefore(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.onColInsertBefore(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.onColInsertBefore(e,i,t,n,s,a)},onRowDeleteBefore:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.onRowDeleteBefore(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.onRowDeleteBefore(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.onRowDeleteBefore(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.onRowDeleteBefore(e,i,t,n,s,a)},onColDeleteBefore:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.onColDeleteBefore(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.onColDeleteBefore(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.onColDeleteBefore(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.onColDeleteBefore(e,i,t,n,s,a)},onHideBefore:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.onHideBefore(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.onHideBefore(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.onHideBefore(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.onHideBefore(e,i,t,n,s,a)},onShowBefore:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.onShowBefore(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.onShowBefore(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.onShowBefore(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.onShowBefore(e,i,t,n,s,a)},insertRow:function(e,i,t,n,s){this.rowHeader0&&this.rowHeader0.insertRow(n,s),this.rowHeader1&&this.rowHeader1.insertRow(n,s),this.Alive.pane0&&this.pane0.insertRow(e,i,t,n,s),this.Alive.pane1&&this.pane1.insertRow(e,i,t,n,s),this.Alive.pane2&&this.pane2.insertRow(e,i,t,n,s),this.Alive.pane3&&this.pane3.insertRow(e,i,t,n,s),this.RePaintSelections&&this.RePaintSelections(e,i,t,"INSERTROW",n,s)},insertCol:function(e,i,t,n,s){this.colHeader0&&this.colHeader0.insertCol(n,s),this.colHeader1&&this.colHeader1.insertCol(n,s),this.Alive.pane0&&this.pane0.insertCol(e,i,t,n,s),this.Alive.pane1&&this.pane1.insertCol(e,i,t,n,s),this.Alive.pane2&&this.pane2.insertCol(e,i,t,n,s),this.Alive.pane3&&this.pane3.insertCol(e,i,t,n,s),this.RePaintSelections&&this.RePaintSelections(e,i,t,"INSERTCOL",n,s)},deleteRow:function(e,i,t,n,s){this.rowHeader0&&this.rowHeader0.deleteRow(n,s),this.rowHeader1&&this.rowHeader1.deleteRow(n,s),this.Alive.pane0&&this.pane0.deleteRow(e,i,t,n,s),this.Alive.pane1&&this.pane1.deleteRow(e,i,t,n,s),this.Alive.pane2&&this.pane2.deleteRow(e,i,t,n,s),this.Alive.pane3&&this.pane3.deleteRow(e,i,t,n,s),this.RePaintSelections&&this.RePaintSelections(e,i,t,"DELETEROW",n,s)},deleteCol:function(e,i,t,n,s){this.colHeader0&&this.colHeader0.deleteCol(n,s),this.colHeader1&&this.colHeader1.deleteCol(n,s),this.Alive.pane0&&this.pane0.deleteCol(e,i,t,n,s),this.Alive.pane1&&this.pane1.deleteCol(e,i,t,n,s),this.Alive.pane2&&this.pane2.deleteCol(e,i,t,n,s),this.Alive.pane3&&this.pane3.deleteCol(e,i,t,n,s),this.RePaintSelections&&this.RePaintSelections(e,i,t,"DELETECOL",n,s)},onBeforeHideShowColumn:function(e,i,t,n){this.Alive.pane0&&this.pane0.onBeforeHideShowColumn(e,i,t,n),this.Alive.pane1&&this.pane1.onBeforeHideShowColumn(e,i,t,n),this.Alive.pane2&&this.pane2.onBeforeHideShowColumn(e,i,t,n),this.Alive.pane3&&this.pane3.onBeforeHideShowColumn(e,i,t,n)},onAfterHideColumn:function(e,i,t,n,s){this.refillCols(e,i,t,n),this.Alive.pane0&&this.pane0.onAfterHideColumn(e,i,t,n,s),this.Alive.pane1&&this.pane1.onAfterHideColumn(e,i,t,n,s),this.Alive.pane2&&this.pane2.onAfterHideColumn(e,i,t,n,s),this.Alive.pane3&&this.pane3.onAfterHideColumn(e,i,t,n,s),this.RePaintSelections&&this.RePaintSelections(e,i,t,"HIDECOL")},onAfterShowColumn:function(e,i,t,n){this.refillCols(e,i,t,n),this.Alive.pane0&&this.pane0.onAfterShowColumn(e,i,t,n),this.Alive.pane1&&this.pane1.onAfterShowColumn(e,i,t,n),this.Alive.pane2&&this.pane2.onAfterShowColumn(e,i,t,n),this.Alive.pane3&&this.pane3.onAfterShowColumn(e,i,t,n),this.RePaintSelections&&this.RePaintSelections(e,i,t,"SHOWCOL")},refillCols:function(e,i,t,n){var s=n?n-1:n;this.colHeader0&&this.colHeader0.refill(e,i,t,s),this.colHeader1&&this.colHeader1.refill(e,i,t,s),this.Alive.pane0&&this.pane0.refillCols(e,i,t,n),this.Alive.pane1&&this.pane1.refillCols(e,i,t,n),this.Alive.pane2&&this.pane2.refillCols(e,i,t,n),this.Alive.pane3&&this.pane3.refillCols(e,i,t,n)},onBeforeHideShowRow:function(e,i,t,n){this.Alive.pane0&&this.pane0.onBeforeHideShowRow(e,i,t,n),this.Alive.pane1&&this.pane1.onBeforeHideShowRow(e,i,t,n),this.Alive.pane2&&this.pane2.onBeforeHideShowRow(e,i,t,n),this.Alive.pane3&&this.pane3.onBeforeHideShowRow(e,i,t,n)},onAfterShowRow:function(e,i,t,n){this.refillRows(e,i,t,n),this.Alive.pane0&&this.pane0.onAfterShowRow(e,i,t,n),this.Alive.pane1&&this.pane1.onAfterShowRow(e,i,t,n),this.Alive.pane2&&this.pane2.onAfterShowRow(e,i,t,n),this.Alive.pane3&&this.pane3.onAfterShowRow(e,i,t,n),this.RePaintSelections&&this.RePaintSelections(e,i,t,"SHOWROW")},onAfterHideRow:function(e,i,t,n,s){this.refillRows(e,i,t,n),this.Alive.pane0&&this.pane0.onAfterHideRow(e,i,t,n,s),this.Alive.pane1&&this.pane1.onAfterHideRow(e,i,t,n,s),this.Alive.pane2&&this.pane2.onAfterHideRow(e,i,t,n,s),this.Alive.pane3&&this.pane3.onAfterHideRow(e,i,t,n,s),this.RePaintSelections&&this.RePaintSelections(e,i,t,"HIDEROW")},refillRows:function(e,i,t,n){var s=n?n-1:n;this.rowHeader0&&this.rowHeader0.refill(e,i,t,s),this.rowHeader1&&this.rowHeader1.refill(e,i,t,s),this.Alive.pane0&&this.pane0.refillRows(e,i,t,n),this.Alive.pane1&&this.pane1.refillRows(e,i,t,n),this.Alive.pane2&&this.pane2.refillRows(e,i,t,n),this.Alive.pane3&&this.pane3.refillRows(e,i,t,n)},hideRow:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.hideRow(e,i,t,n,s),this.Alive.pane1&&this.pane1.hideRow(e,i,t,n,s),this.Alive.pane2&&this.pane2.hideRow(e,i,t,n,s),this.Alive.pane3&&this.pane3.hideRow(e,i,t,n,s)},showRow:function(e,i,t,n,s,a){this.rowHeader0&&this.rowHeader0.showRow(n,s),this.rowHeader1&&this.rowHeader1.showRow(n,s),this.Alive.pane0&&this.pane0.showRow(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.showRow(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.showRow(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.showRow(e,i,t,n,s,a),this.RePaintSelections&&this.RePaintSelections(e,i,t,"SHOWROW")},hideCol:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.hideCol(e,i,t,n,s),this.Alive.pane1&&this.pane1.hideCol(e,i,t,n,s),this.Alive.pane2&&this.pane2.hideCol(e,i,t,n,s),this.Alive.pane3&&this.pane3.hideCol(e,i,t,n,s)},showCol:function(e,i,t,n,s,a){this.colHeader0&&this.colHeader0.showCol(n,s),this.colHeader1&&this.colHeader1.showCol(n,s),this.Alive.pane0&&this.pane0.showCol(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.showCol(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.showCol(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.showCol(e,i,t,n,s,a),this.RePaintSelections&&this.RePaintSelections(e,i,t,"SHOWCOL")},resizeRow:function(e,i,t,n,s,a,h){this.rowHeader0&&this.rowHeader0.resizeRow(n,s),this.rowHeader1&&this.rowHeader1.resizeRow(n,s),this.Alive.pane0&&this.pane0.resizeRow(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.resizeRow(e,i,t,n,s,a,h),this.Alive.pane2&&this.pane2.resizeRow(e,i,t,n,s,a,h),this.Alive.pane3&&this.pane3.resizeRow(e,i,t,n,s,a,h),this.RePaintSelections&&this.RePaintSelections(e,i,t,"RESIZEROW"),this.Alive.pane0&&this.pane0.ResizeHighlightLayer(),this.Alive.pane1&&this.pane1.ResizeHighlightLayer(),this.Alive.pane2&&this.pane2.ResizeHighlightLayer(),this.Alive.pane3&&this.pane3.ResizeHighlightLayer()},resizeCol:function(e,i,t,n,s,a,h){this.colHeader0&&this.colHeader0.resizeCol(n,s),this.colHeader1&&this.colHeader1.resizeCol(n,s),this.Alive.pane0&&this.pane0.resizeCol(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.resizeCol(e,i,t,n,s,a,h),this.Alive.pane2&&this.pane2.resizeCol(e,i,t,n,s,a,h),this.Alive.pane3&&this.pane3.resizeCol(e,i,t,n,s,a,h),this.RePaintSelections&&this.RePaintSelections(e,i,t,"RESIZECOL"),this.Alive.pane0&&this.pane0.ResizeHighlightLayer(),this.Alive.pane1&&this.pane1.ResizeHighlightLayer(),this.Alive.pane2&&this.pane2.ResizeHighlightLayer(),this.Alive.pane3&&this.pane3.ResizeHighlightLayer()},onBeforeMerge:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.onBeforeMerge(e,i,t,n,s),this.Alive.pane1&&this.pane1.onBeforeMerge(e,i,t,n,s),this.Alive.pane2&&this.pane2.onBeforeMerge(e,i,t,n,s),this.Alive.pane3&&this.pane3.onBeforeMerge(e,i,t,n,s)},onBeforeSplit:function(e,i,t,n){this.Alive.pane0&&this.pane0.onBeforeSplit(e,i,t,n),this.Alive.pane1&&this.pane1.onBeforeSplit(e,i,t,n),this.Alive.pane2&&this.pane2.onBeforeSplit(e,i,t,n),this.Alive.pane3&&this.pane3.onBeforeSplit(e,i,t,n)},merge:function(e,i,t,n){this.Alive.pane0&&this.pane0.merge(e,i,t,n),this.Alive.pane1&&this.pane1.merge(e,i,t,n),this.Alive.pane2&&this.pane2.merge(e,i,t,n),this.Alive.pane3&&this.pane3.merge(e,i,t,n),this.RePaintSelections&&this.RePaintSelections(e,i,t),this.DummyScroll(e,i,t)},split:function(e,i,t,n){this.Alive.pane0&&this.pane0.split(e,i,t,n),this.Alive.pane1&&this.pane1.split(e,i,t,n),this.Alive.pane2&&this.pane2.split(e,i,t,n),this.Alive.pane3&&this.pane3.split(e,i,t,n),this.RePaintSelections&&this.RePaintSelections(e,i,t),this.DummyScroll(e,i,t)},onZoomBefore:function(e,i,t){this.Alive.pane0&&this.pane0.onZoomBefore(e,i,t),this.Alive.pane1&&this.pane1.onZoomBefore(e,i,t),this.Alive.pane2&&this.pane2.onZoomBefore(e,i,t),this.Alive.pane3&&this.pane3.onZoomBefore(e,i,t)},setZoom:function(e,i,t,n){var s=a.view.getSheetState(this.gridID,i);n=n?n:s.getZoom(),this.colHeader0&&this.colHeader0.onZoom(),this.colHeader1&&this.colHeader1.onZoom(),this.rowHeader0&&this.rowHeader0.onZoom(),this.rowHeader1&&this.rowHeader1.onZoom(),this.Alive.pane0&&this.pane0.zoom(e,i,t,n),this.Alive.pane1&&this.pane1.zoom(e,i,t,n),this.Alive.pane2&&this.pane2.zoom(e,i,t,n),this.Alive.pane3&&this.pane3.zoom(e,i,t,n),this.RePaintSelections&&this.RePaintSelections(e,i,t,"ZOOM"),this.Alive.pane0&&this.pane0.ResizeHighlightLayer(),this.Alive.pane1&&this.pane1.ResizeHighlightLayer(),this.Alive.pane2&&this.pane2.ResizeHighlightLayer(),this.Alive.pane3&&this.pane3.ResizeHighlightLayer()},setGridView:function(e,i,t){this.Alive.pane0&&this.pane0.onGridViewChange(e,i,t),this.Alive.pane1&&this.pane1.onGridViewChange(e,i,t),this.Alive.pane2&&this.pane2.onGridViewChange(e,i,t),this.Alive.pane3&&this.pane3.onGridViewChange(e,i,t),this.Alive.pane0&&this.pane0.ResizeHighlightLayer(),this.Alive.pane1&&this.pane1.ResizeHighlightLayer(),this.Alive.pane2&&this.pane2.ResizeHighlightLayer(),this.Alive.pane3&&this.pane3.ResizeHighlightLayer(),this.RePaintSelections&&this.RePaintSelections(e,i,t),this.Ole&&this.Ole.updateBoundary(e,i,t)},addPivotFilter:function(e,i,t,n){this.Alive.pane0&&this.pane0.addPivotFilter(e,i,t,n),this.Alive.pane1&&this.pane1.addPivotFilter(e,i,t,n),this.Alive.pane2&&this.pane2.addPivotFilter(e,i,t,n),this.Alive.pane3&&this.pane3.addPivotFilter(e,i,t,n)},removePivotFilter:function(e,i,t,n){this.Alive.pane0&&this.pane0.hidePivotFilter(e,i,t,n),this.Alive.pane1&&this.pane1.hidePivotFilter(e,i,t,n),this.Alive.pane2&&this.pane2.hidePivotFilter(e,i,t,n),this.Alive.pane3&&this.pane3.hidePivotFilter(e,i,t,n)},onBeforeDataFilter:function(e,i,t,n,s,a){var h;h=a&&a.length?a[0][0]:n.startRow,this.Alive.pane0&&this.pane0.onBeforeDataFilter(e,i,t,h,n),this.Alive.pane1&&this.pane1.onBeforeDataFilter(e,i,t,h,n),this.Alive.pane2&&this.pane2.onBeforeDataFilter(e,i,t,h,n),this.Alive.pane3&&this.pane3.onBeforeDataFilter(e,i,t,h,n)},addDataFilter:function(e,i,t,n,s,a,h){this.Alive.pane0&&this.pane0.onBeforeFill(e,i,t),this.Alive.pane1&&this.pane1.onBeforeFill(e,i,t),this.Alive.pane2&&this.pane2.onBeforeFill(e,i,t),this.Alive.pane3&&this.pane3.onBeforeFill(e,i,t),this.rowHeader0&&this.rowHeader0.onFilter(n,a),this.rowHeader1&&this.rowHeader1.onFilter(n,a),this.rowHeader0&&this.rowHeader0.refill(e,i,t,h),this.rowHeader1&&this.rowHeader1.refill(e,i,t,h),this.Alive.pane0&&this.pane0.addDataFilter(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.addDataFilter(e,i,t,n,s,a,h),this.Alive.pane2&&this.pane2.addDataFilter(e,i,t,n,s,a,h),this.Alive.pane3&&this.pane3.addDataFilter(e,i,t,n,s,a,h),this.RePaintSelections&&this.RePaintSelections(e,i,t),this.DummyScroll(e,i,t)},hideDataFilter:function(e,i,t,n){this.Alive.pane0&&this.pane0.hideDataFilter(e,i,t,n),this.Alive.pane1&&this.pane1.hideDataFilter(e,i,t,n),this.Alive.pane2&&this.pane2.hideDataFilter(e,i,t,n),this.Alive.pane3&&this.pane3.hideDataFilter(e,i,t,n)},showDataFilter:function(e,i,t){this.Alive.pane0&&this.pane0.showDataFilter(e,i,t),this.Alive.pane1&&this.pane1.showDataFilter(e,i,t),this.Alive.pane2&&this.pane2.showDataFilter(e,i,t),this.Alive.pane3&&this.pane3.showDataFilter(e,i,t)},removeDataFilter:function(e,i,t,n){this.rowHeader0&&n&&this.rowHeader0.onFilter(n),this.rowHeader1&&n&&this.rowHeader1.onFilter(n),this.rowHeader0&&n&&this.rowHeader0.refill(e,i,t,n.startRow),this.rowHeader1&&n&&this.rowHeader1.refill(e,i,t,n.startRow),this.hideDataFilter(e,i,t,n),this.RePaintSelections&&this.RePaintSelections(e,i,t),this.DummyScroll(e,i,t)},addCellProtect:function(e,i,t,n){this.Alive.pane0&&this.pane0.addCellProtect(e,i,t,n),this.Alive.pane1&&this.pane1.addCellProtect(e,i,t,n),this.Alive.pane2&&this.pane2.addCellProtect(e,i,t,n),this.Alive.pane3&&this.pane3.addCellProtect(e,i,t,n)},modifyCellProtect:function(e,i,t,n){this.Alive.pane0&&this.pane0.modifyCellProtect(e,i,t,n),this.Alive.pane1&&this.pane1.modifyCellProtect(e,i,t,n),this.Alive.pane2&&this.pane2.modifyCellProtect(e,i,t,n),this.Alive.pane3&&this.pane3.modifyCellProtect(e,i,t,n)},hideCellProtect:function(e,i,t){this.Alive.pane0&&this.pane0.hideCellProtect(e,i,t),this.Alive.pane1&&this.pane1.hideCellProtect(e,i,t),this.Alive.pane2&&this.pane2.hideCellProtect(e,i,t),this.Alive.pane3&&this.pane3.hideCellProtect(e,i,t)},showCellProtect:function(e,i,t){this.Alive.pane0&&this.pane0.showCellProtect(e,i,t),this.Alive.pane1&&this.pane1.showCellProtect(e,i,t),this.Alive.pane2&&this.pane2.showCellProtect(e,i,t),this.Alive.pane3&&this.pane3.showCellProtect(e,i,t)},removeCellProtect:function(e,i,t,n){this.Alive.pane0&&this.pane0.removeCellProtect(e,i,t,n),this.Alive.pane1&&this.pane1.removeCellProtect(e,i,t,n),this.Alive.pane2&&this.pane2.removeCellProtect(e,i,t,n),this.Alive.pane3&&this.pane3.removeCellProtect(e,i,t,n)},hideGridLine:function(e,i,t,n){this.Alive.pane0&&this.pane0.hideGridLine(e,i,t,n),this.Alive.pane1&&this.pane1.hideGridLine(e,i,t,n),this.Alive.pane2&&this.pane2.hideGridLine(e,i,t,n),this.Alive.pane3&&this.pane3.hideGridLine(e,i,t,n)},onReload:function(e,i,t){this.Alive.pane0&&this.pane0.onReload(e,i,t),this.Alive.pane1&&this.pane1.onReload(e,i,t),this.Alive.pane2&&this.pane2.onReload(e,i,t),this.Alive.pane3&&this.pane3.onReload(e,i,t),this.colHeader0&&this.colHeader0.onReload(e,i,t),this.colHeader1&&this.colHeader1.onReload(e,i,t),this.rowHeader0&&this.rowHeader0.onReload(e,i,t),this.rowHeader1&&this.rowHeader1.onReload(e,i,t)},RemoveTileDom:function(){this.Alive.pane0&&this.pane0.RemoveTileDom(),this.Alive.pane1&&this.pane1.RemoveTileDom(),this.Alive.pane2&&this.pane2.RemoveTileDom(),this.Alive.pane3&&this.pane3.RemoveTileDom()},DVInterrupt:function(e,i,t,n){this.pane0.DVInterrupt(e,i,t,n),this.pane1.DVInterrupt(e,i,t,n),this.pane2.DVInterrupt(e,i,t,n),this.pane3.DVInterrupt(e,i,t,n)},removeDVInterrupt:function(e,i,t,n){this.pane0.removeDVInterrupt(e,i,t,n),this.pane1.removeDVInterrupt(e,i,t,n),this.pane2.removeDVInterrupt(e,i,t,n),this.pane3.removeDVInterrupt(e,i,t,n)},ClientFirstActions:function(e,i,t,n,s,a){for(var h=0;h<s.length;h++){var l=s[h];this.Alive.pane0&&this.pane0.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.Alive.pane1&&this.pane1.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.Alive.pane2&&this.pane2.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.Alive.pane3&&this.pane3.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.colHeader0&&this.colHeader0.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.colHeader1&&this.colHeader1.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.rowHeader0&&this.rowHeader0.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a),this.rowHeader1&&this.rowHeader1.ClientFirstActions(e,i,t,n,l.startRow,l.startCol,l.endRow,l.endCol,a)}("RESIZECOL"===n||"RESIZEROW"===n)&&this.RePaintSelections&&this.RePaintSelections(e,i,t,n)},reset:function(e,i,t){this.Alive.pane0&&this.pane0.reset(e,i,t),this.Alive.pane1&&this.pane1.reset(e,i,t),this.Alive.pane2&&this.pane2.reset(e,i,t),this.Alive.pane3&&this.pane3.reset(e,i,t),this.Alive={pane0:!1,pane1:!1,pane2:!1,pane3:!1},this.rects={}},resetPane:function(e,i,t){!this.Alive.pane0&&this.pane0.reset(e,i,t),!this.Alive.pane1&&this.pane1.reset(e,i,t),!this.Alive.pane2&&this.pane2.reset(e,i,t),!this.Alive.pane3&&this.pane3.reset(e,i,t)},modifyPivot:function(e,i,t,n){this.Alive.pane0&&this.pane0.modifyPivot(e,i,t,n),this.Alive.pane1&&this.pane1.modifyPivot(e,i,t,n),this.Alive.pane2&&this.pane2.modifyPivot(e,i,t,n),this.Alive.pane3&&this.pane3.modifyPivot(e,i,t,n)},PlaceUserPresence:function(e,i,t,n,s,a,h){this.Alive.pane0&&this.pane0.PlaceUserPresence(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.PlaceUserPresence(e,i,t,n,s,a,h),this.Alive.pane2&&this.pane2.PlaceUserPresence(e,i,t,n,s,a,h),this.Alive.pane3&&this.pane3.PlaceUserPresence(e,i,t,n,s,a,h)},RemoveUserPresence:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveUserPresence(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveUserPresence(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveUserPresence(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveUserPresence(e,i,t,n)},EditUserPresence:function(e,i,t,n,s,a,h){this.Alive.pane0&&this.pane0.EditUserPresence(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.EditUserPresence(e,i,t,n,s,a,h),this.Alive.pane2&&this.pane2.EditUserPresence(e,i,t,n,s,a,h),this.Alive.pane3&&this.pane3.EditUserPresence(e,i,t,n,s,a,h)},PlaceCommentsHighlight:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceCommentsHighlight(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceCommentsHighlight(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceCommentsHighlight(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceCommentsHighlight(e,i,t,n,s)},RemoveCommentsHighlight:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.RemoveCommentsHighlight(e,i,t,n,s),this.Alive.pane1&&this.pane1.RemoveCommentsHighlight(e,i,t,n,s),this.Alive.pane2&&this.pane2.RemoveCommentsHighlight(e,i,t,n,s),this.Alive.pane3&&this.pane3.RemoveCommentsHighlight(e,i,t,n,s)},RepaintCommentsHighlight:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.RepaintCommentsHighlight(e,i,t,n,s),this.Alive.pane1&&this.pane1.RepaintCommentsHighlight(e,i,t,n,s),this.Alive.pane2&&this.pane2.RepaintCommentsHighlight(e,i,t,n,s),this.Alive.pane3&&this.pane3.RepaintCommentsHighlight(e,i,t,n,s)},PlaceHighlightLocks:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceHighlightLocks(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceHighlightLocks(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceHighlightLocks(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceHighlightLocks(e,i,t,n,s)},RemoveHighlightLocks:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.RemoveHighlightLocks(e,i,t,n,s),this.Alive.pane1&&this.pane1.RemoveHighlightLocks(e,i,t,n,s),this.Alive.pane2&&this.pane2.RemoveHighlightLocks(e,i,t,n,s),this.Alive.pane3&&this.pane3.RemoveHighlightLocks(e,i,t,n,s)},PlaceDVBtn:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.PlaceDVBtn(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.PlaceDVBtn(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.PlaceDVBtn(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.PlaceDVBtn(e,i,t,n,s,a)},HideDVBtn:function(e,i,t){this.Alive.pane0&&this.pane0.HideDVBtn(e,i,t),this.Alive.pane1&&this.pane1.HideDVBtn(e,i,t),this.Alive.pane2&&this.pane2.HideDVBtn(e,i,t),this.Alive.pane3&&this.pane3.HideDVBtn(e,i,t)},showPasteWidget:function(e,i,t,n){this.Alive.pane0&&this.pane0.showWidgetBtn(e,i,t,n),this.Alive.pane1&&this.pane1.showWidgetBtn(e,i,t,n),this.Alive.pane2&&this.pane2.showWidgetBtn(e,i,t,n),this.Alive.pane3&&this.pane3.showWidgetBtn(e,i,t,n)},hidePasteWidget:function(e,i,t){this.Alive.pane0&&this.pane0.hidePasteWidget(e,i,t),this.Alive.pane1&&this.pane1.hidePasteWidget(e,i,t),this.Alive.pane2&&this.pane2.hidePasteWidget(e,i,t),this.Alive.pane3&&this.pane3.hidePasteWidget(e,i,t)},repaintPasteWidget:function(e,i,t){this.Alive.pane0&&this.pane0.repaintPasteWidget(e,i,t),this.Alive.pane1&&this.pane1.repaintPasteWidget(e,i,t),this.Alive.pane2&&this.pane2.repaintPasteWidget(e,i,t),this.Alive.pane3&&this.pane3.repaintPasteWidget(e,i,t)},ShowDVBtn:function(e,i,t){this.Alive.pane0&&this.pane0.ShowDVBtn(e,i,t),this.Alive.pane1&&this.pane1.ShowDVBtn(e,i,t),this.Alive.pane2&&this.pane2.ShowDVBtn(e,i,t),this.Alive.pane3&&this.pane3.ShowDVBtn(e,i,t)},PlaceDVHint:function(e,i,t,n,s,a,h,l){this.Alive.pane0&&this.pane0.PlaceDVHint(e,i,t,n,s,a,h,l),this.Alive.pane1&&this.pane1.PlaceDVHint(e,i,t,n,s,a,h,l),this.Alive.pane2&&this.pane2.PlaceDVHint(e,i,t,n,s,a,h,l),this.Alive.pane3&&this.pane3.PlaceDVHint(e,i,t,n,s,a,h,l)},HideDVHint:function(e,i,t){this.Alive.pane0&&this.pane0.HideDVHint(e,i,t),this.Alive.pane1&&this.pane1.HideDVHint(e,i,t),this.Alive.pane2&&this.pane2.HideDVHint(e,i,t),this.Alive.pane3&&this.pane3.HideDVHint(e,i,t)},PlaceCellSelection:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceCellSelection(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceCellSelection(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceCellSelection(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceCellSelection(e,i,t,n,s)},PlaceDragSelection:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceDragSelection(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceDragSelection(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceDragSelection(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceDragSelection(e,i,t,n,s)},RemoveDragSelection:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveDragSelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveDragSelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveDragSelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveDragSelection(e,i,t,n)},PlaceHeaderDragSelection:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceHeaderDragSelection(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceHeaderDragSelection(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceHeaderDragSelection(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceHeaderDragSelection(e,i,t,n,s)},RemoveHeaderDragSelection:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveHeaderDragSelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveHeaderDragSelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveHeaderDragSelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveHeaderDragSelection(e,i,t,n)},PlaceHighlightVersion:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.PlaceHighlightVersion(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.PlaceHighlightVersion(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.PlaceHighlightVersion(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.PlaceHighlightVersion(e,i,t,n,s,a)},RemoveHighlightVersion:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveHighlightVersion(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveHighlightVersion(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveHighlightVersion(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveHighlightVersion(e,i,t,n)},RemoveAllHighlightVersion:function(e,i,t){this.Alive.pane0&&this.pane0.RemoveAllHighlightVersion(e,i,t),this.Alive.pane1&&this.pane1.RemoveAllHighlightVersion(e,i,t),this.Alive.pane2&&this.pane2.RemoveAllHighlightVersion(e,i,t),this.Alive.pane3&&this.pane3.RemoveAllHighlightVersion(e,i,t)},PlaceRecalculateFlash:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceRecalculateFlash(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceRecalculateFlash(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceRecalculateFlash(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceRecalculateFlash(e,i,t,n,s)},PlacePreview:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlacePreview(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlacePreview(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlacePreview(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlacePreview(e,i,t,n,s)},ClearPreview:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.ClearPreview(e,i,t,n,s),this.Alive.pane1&&this.pane1.ClearPreview(e,i,t,n,s),this.Alive.pane2&&this.pane2.ClearPreview(e,i,t,n,s),this.Alive.pane3&&this.pane3.ClearPreview(e,i,t,n,s)},ClearAllPreview:function(e,i,t){this.Alive.pane0&&this.pane0.ClearAllPreview(e,i,t),this.Alive.pane1&&this.pane1.ClearAllPreview(e,i,t),this.Alive.pane2&&this.pane2.ClearAllPreview(e,i,t),this.Alive.pane3&&this.pane3.ClearAllPreview(e,i,t)},RemoveCellSelection:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveCellSelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveCellSelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveCellSelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveCellSelection(e,i,t,n)},PlaceCopySelection:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceCopySelection(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceCopySelection(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceCopySelection(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceCopySelection(e,i,t,n,s)},RemoveCopySelection:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveCopySelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveCopySelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveCopySelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveCopySelection(e,i,t,n)},RepaintCopySelection:function(e,i,t){this.Alive.pane0&&this.pane0.RepaintCopySelection(e,i,t),this.Alive.pane1&&this.pane1.RepaintCopySelection(e,i,t),this.Alive.pane2&&this.pane2.RepaintCopySelection(e,i,t),this.Alive.pane3&&this.pane3.RepaintCopySelection(e,i,t)},PlaceFillSelection:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.PlaceFillSelection(e,i,t,n,s),this.Alive.pane1&&this.pane1.PlaceFillSelection(e,i,t,n,s),this.Alive.pane2&&this.pane2.PlaceFillSelection(e,i,t,n,s),this.Alive.pane3&&this.pane3.PlaceFillSelection(e,i,t,n,s)},RemoveFillSelection:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveFillSelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveFillSelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveFillSelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveFillSelection(e,i,t,n)},RemoveFillSeriesCue:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveFillSeriesCue(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveFillSeriesCue(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveFillSeriesCue(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveFillSeriesCue(e,i,t,n)},PlaceRangeSelection:function(e,i,t,n,s,a){this.colHeader0&&this.colHeader0.highlight(e,i,t,s),this.colHeader1&&this.colHeader1.highlight(e,i,t,s),this.rowHeader0&&this.rowHeader0.highlight(e,i,t,s),this.rowHeader1&&this.rowHeader1.highlight(e,i,t,s),this.Alive.pane0&&this.pane0.PlaceRangeSelection(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.PlaceRangeSelection(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.PlaceRangeSelection(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.PlaceRangeSelection(e,i,t,n,s,a)},RemoveRangeSelection:function(e,i,t,n){this.colHeader0&&this.colHeader0.diminish(),this.colHeader1&&this.colHeader1.diminish(),this.rowHeader0&&this.rowHeader0.diminish(),this.rowHeader1&&this.rowHeader1.diminish(),this.Alive.pane0&&this.pane0.RemoveRangeSelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveRangeSelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveRangeSelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveRangeSelection(e,i,t,n)},PlaceRangePickerSelection:function(e,i,t,n,s,a,h,l){return this.sheetID!==i?this.RemoveRangePickerSelection(e,i,t,n):(this.Alive.pane0&&this.pane0.PlaceRangePickerSelection(e,i,t,n,s,a,h,l),this.Alive.pane1&&this.pane1.PlaceRangePickerSelection(e,i,t,n,s,a,h,l),this.Alive.pane2&&this.pane2.PlaceRangePickerSelection(e,i,t,n,s,a,h,l),void(this.Alive.pane3&&this.pane3.PlaceRangePickerSelection(e,i,t,n,s,a,h,l)))},RemoveRangePickerSelection:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveRangePickerSelection(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveRangePickerSelection(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveRangePickerSelection(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveRangePickerSelection(e,i,t,n)},RemoveRangePickerSelectionFrom:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveRangePickerSelectionFrom(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveRangePickerSelectionFrom(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveRangePickerSelectionFrom(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveRangePickerSelectionFrom(e,i,t,n)},BlurOle:function(){this.Ole&&this.Ole.blurAll()},DeleteOle:function(){this.Ole&&this.Ole.delete()},SelectNextOle:function(){this.Ole&&this.Ole.focusNext()},SelectPrevOle:function(){this.Ole&&this.Ole.focusPrev()},MoveOle:function(e,i,t,n){this.Ole&&this.Ole.move(n)},MoveEndOle:function(e,i,t,n){this.Ole&&this.Ole.moveEnd(n)},PlaceCellNote:function(e,i,t,n,s,a,h,l,o,p){this.Alive.pane0&&this.pane0.PlaceCellNote(e,i,t,n,s,a,h,l,o,p),this.Alive.pane1&&this.pane1.PlaceCellNote(e,i,t,n,s,a,h,l,o,p),this.Alive.pane2&&this.pane2.PlaceCellNote(e,i,t,n,s,a,h,l,o,p),this.Alive.pane3&&this.pane3.PlaceCellNote(e,i,t,n,s,a,h,l,o,p)},RemoveCellNote:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.RemoveCellNote(e,i,t,n,s),this.Alive.pane1&&this.pane1.RemoveCellNote(e,i,t,n,s),this.Alive.pane2&&this.pane2.RemoveCellNote(e,i,t,n,s),this.Alive.pane3&&this.pane3.RemoveCellNote(e,i,t,n,s)},RemoveAllCellNotes:function(e,i,t){this.Alive.pane0&&this.pane0.RemoveAllCellNotes(e,i,t),this.Alive.pane1&&this.pane1.RemoveAllCellNotes(e,i,t),this.Alive.pane2&&this.pane2.RemoveAllCellNotes(e,i,t),this.Alive.pane3&&this.pane3.RemoveAllCellNotes(e,i,t)},PlacePrecedance:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.PlacePrecedance(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.PlacePrecedance(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.PlacePrecedance(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.PlacePrecedance(e,i,t,n,s,a)},RemoveAllPrecedances:function(e,i,t){this.Alive.pane0&&this.pane0.RemoveAllPrecedances(e,i,t),this.Alive.pane1&&this.pane1.RemoveAllPrecedances(e,i,t),this.Alive.pane2&&this.pane2.RemoveAllPrecedances(e,i,t),this.Alive.pane3&&this.pane3.RemoveAllPrecedances(e,i,t)},pushDOMChanges:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.pushDOMChanges(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.pushDOMChanges(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.pushDOMChanges(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.pushDOMChanges(e,i,t,n,s,a)},pushFaultyChanges:function(e,i,t,n,s){this.Alive.pane0&&this.pane0.pushFaultyChanges(e,i,t,n,s),this.Alive.pane1&&this.pane1.pushFaultyChanges(e,i,t,n,s),this.Alive.pane2&&this.pane2.pushFaultyChanges(e,i,t,n,s),this.Alive.pane3&&this.pane3.pushFaultyChanges(e,i,t,n,s)},insertSparklines:function(e,i,t,n){this.Alive.pane0&&this.pane0.insertSparklines(e,i,t,n),this.Alive.pane1&&this.pane1.insertSparklines(e,i,t,n),this.Alive.pane2&&this.pane2.insertSparklines(e,i,t,n),this.Alive.pane3&&this.pane3.insertSparklines(e,i,t,n)},changeSparklineData:function(e,i,t,n){this.Alive.pane0&&this.pane0.changeSparklineData(e,i,t,n),this.Alive.pane1&&this.pane1.changeSparklineData(e,i,t,n),this.Alive.pane2&&this.pane2.changeSparklineData(e,i,t,n),this.Alive.pane3&&this.pane3.changeSparklineData(e,i,t,n)},highlightRange:function(e,i,t,n,s,a){this.Alive.pane0&&this.pane0.HighlightRange(e,i,t,n,s,a),this.Alive.pane1&&this.pane1.HighlightRange(e,i,t,n,s,a),this.Alive.pane2&&this.pane2.HighlightRange(e,i,t,n,s,a),this.Alive.pane3&&this.pane3.HighlightRange(e,i,t,n,s,a)},removeHighlightRanges:function(e,i,t,n){this.Alive.pane0&&this.pane0.RemoveHighlightRanges(e,i,t,n),this.Alive.pane1&&this.pane1.RemoveHighlightRanges(e,i,t,n),this.Alive.pane2&&this.pane2.RemoveHighlightRanges(e,i,t,n),this.Alive.pane3&&this.pane3.RemoveHighlightRanges(e,i,t,n)},applySparklineProperties:function(e,i,t,n){this.Alive.pane0&&this.pane0.applySparklineProperties(e,i,t,n),this.Alive.pane1&&this.pane1.applySparklineProperties(e,i,t,n),this.Alive.pane2&&this.pane2.applySparklineProperties(e,i,t,n),this.Alive.pane3&&this.pane3.applySparklineProperties(e,i,t,n)},editSparklinesGroup:function(e,i,t,n){this.Alive.pane0&&this.pane0.editSparklinesGroup(e,i,t,n),this.Alive.pane1&&this.pane1.editSparklinesGroup(e,i,t,n),this.Alive.pane2&&this.pane2.editSparklinesGroup(e,i,t,n),this.Alive.pane3&&this.pane3.editSparklinesGroup(e,i,t,n)},removeSparklines:function(e,i,t,n){this.Alive.pane0&&this.pane0.removeSparklines(e,i,t,n),this.Alive.pane1&&this.pane1.removeSparklines(e,i,t,n),this.Alive.pane2&&this.pane2.removeSparklines(e,i,t,n),this.Alive.pane3&&this.pane3.removeSparklines(e,i,t,n)},sparklineUndo:function(e,i,t,n){this.Alive.pane0&&this.pane0.sparklineUndo(e,i,t,n),this.Alive.pane1&&this.pane1.sparklineUndo(e,i,t,n),this.Alive.pane2&&this.pane2.sparklineUndo(e,i,t,n),this.Alive.pane3&&this.pane3.sparklineUndo(e,i,t,n)},setSparklineExtremes:function(e,i,t,n){this.Alive.pane0&&this.pane0.setSparklineExtremes(e,i,t,n),this.Alive.pane1&&this.pane1.setSparklineExtremes(e,i,t,n),this.Alive.pane2&&this.pane2.setSparklineExtremes(e,i,t,n),this.Alive.pane3&&this.pane3.setSparklineExtremes(e,i,t,n)},pushCfChanges:function(e,i,t,n,s,a,h){this.Alive.pane0&&this.pane0.pushCfChanges(e,i,t,n,s,a,h),this.Alive.pane1&&this.pane1.pushCfChanges(e,i,t,n,s,a,h),this.Alive.pane2&&this.pane2.pushCfChanges(e,i,t,n,s,a,h),this.Alive.pane3&&this.pane3.pushCfChanges(e,i,t,n,s,a,h)},CloneButton:function(){},DeleteButton:function(){},onButtonRepaint:function(){},onButtonMeta:function(){},onButtonInsert:function(){},onButtonDelete:function(){},onButtonMove:function(){},onButtonResize:function(){},onButtonModify:function(){}},e.ZSClass.UIGridComponent=n}(this);
!function(e){function t(e,t,a){e.endCol>=t&&(e.endCol+=a),e.startCol>=t&&(e.startCol+=a),e.startCol>e.endCol&&(e.endCol=e.startCol)}function a(e,t,a){e.endRow>=t&&(e.endRow+=a),e.startRow>=t&&(e.startRow+=a),e.startRow>e.endRow&&(e.endRow=e.startRow)}function s(e,t,a){var s=e.startCol,i=e.endCol;s>t&&(s-=a,s=t>s?t:s,e.startCol=s),i>=t&&(i-=a,i=i>=t?i:t-1,s>i&&(i=s),e.endCol=i)}function i(e,t,a){var s=e.startRow,i=e.endRow;s>t&&(s-=a,s=t>s?t:s,e.startRow=s),i>=t&&(i-=a,i=i>=t?i:t-1,s>i&&(i=s),e.endRow=i)}var o=e.sPlusPlus,n=e.ZSClass,r=o.data.UserInfo,c=n.UIGridComponent.prototype,R=e.ZSConstants.FeatureConstants,l=o.view.Toolbar.Feature[R.USER_PRESENCE];c.RePaintSelections=function(e,c,R,d,C,v){var g;switch(d){case"INSERTCOL":g=t;break;case"INSERTROW":g=a;break;case"DELETECOL":g=s;break;case"DELETEROW":g=i;break;default:g=function(){}}var E,S=o.view.getSheetState(this.gridID,c),O=o.data.getWorkBook(e,R),w=O.getSheetObj(c),h=w.Merge;switch(d){case"INSERTCOL":case"INSERTROW":case"DELETECOL":case"DELETEROW":case"HIDEROW":case"SHOWROW":case"HIDECOL":case"SHOWCOL":case"RESIZEROW":case"RESIZECOL":E=function(){};break;default:E=h.extendRange.bind(h)}var u=S.getActiveCellRange();if(u){var f=S.getActiveRow(),I=S.getActiveCol(),u=new n.Range(f,I,f,I);h.extendRange(u),g(u,C,v),this.PlaceCellSelection(e,c,R,void 0,u),S.setActiveCellRange(void 0,u,u.startRow,u.startCol)}var L=S.getRanges();for(var W in L){var p=L[W];g(p,C,v),E(p);var P=p.isSingle()||h.isXists(p.startRow,p.startCol);this.PlaceRangeSelection(e,c,R,p.id,p,P),S.addSelection(p,p.id,p.type)}switch(d){case"ZOOM":this.repaintPasteWidget(e,c,R);break;case"HIDEROW":case"SHOWROW":case"HIDECOL":case"SHOWCOL":case"RESIZEROW":case"RESIZECOL":!!r.activeInfo.visualCueStatus&&this.RepaintCopySelection(e,c,R);break;default:var b=r.activeInfo.getCopyDetails().Ranges;for(var W in b){var m=b[W];this.RemoveCopySelection(e,c,R,m.id)}}var D=o.view.getActiveGridID(),k=o.view.getActiveState(D),H=k.getUserPresenceList(),T=H.getList();if(l&&l.showUserPresence){var A=w.Prop.Name;for(var W in T){var N=T[W],Z=N.tabid?N.tabid:N.rsid;if(N.sheetName==A){var y=H.getRangeList(N.zuid,Z);if(!y)return;var p=y.rangeArray[0];g(p,C,v),this.PlaceUserPresence(e,c,R,p.id,p,N.colorCode,N.dname)}}}var U=w.ProtectedRanges.RangeList.masterList,x=[];for(var B in U){var p=U[B];x.push([p.startRow,p.startCol,p.endRow,p.endCol,!0])}this.addCellProtect(e,c,R,x),O.highlightComments&&this.RepaintCommentsHighlight(e,c,R),this.onButtonRepaint(e,c,R),this.onRepaintImage(e,c,R)}}(this);
!function(t){function n(t,n,i){var a=c.data.getWorkBook(t,i),u=a.getSheetObj(n),r=u.Buttons,s=r.getMap();for(var l in s)o.call(this,t,n,i,l),e.call(this,t,n,i,l)}function o(t,n,o,i){var e=c.data.getWorkBook(t,o),a=e.getSheetObj(n),u=a.Buttons,r=u.get(i),s=r.getX(),l=r.getY(),h=r.getWidth(),B=r.getHeight();r&&this.Button.place(i,s,l,h,B)}function i(t,n,o,i){this.Button.remove(i)}function e(t,n,o,i){var e=c.data.getWorkBook(t,o),a=e.getSheetObj(n),u=a.Buttons,r=u.get(i);this.Button.setLabel(i,r.getLabel())}function a(t,n,o,i){var e=new l.Layer.Modules.Clone.Helper(100,100);this.Button.clone(i,e)}function u(t,n,o,i,e){var i=i||s.call(this);this.Button.assignMacro(i,e)}function r(t,n,o,i){this.Button.delete(i)}function s(){var t=this.Button.getActive();for(var n in t)return n}var c=t.sPlusPlus,l=t.ZSClass,h=(c.data.UserInfo,l.UIGridComponent.prototype),B={ID:0,Label:1,X:2,Y:3,Width:4,Height:5,ScriptListener:6};h.EditButton=function(t,n,o,i){var i=i||s.call(this);this.Button.placeEdit(i)},h.CancelEditButton=function(t,n,o,i){var e=l.Layer.Button;if(e.EditLayer.isActive()){var a=e.EditLayer.getInteracter(),i=a.getID();this.Button.removeEdit(i)}},h.SubmitEditButton=function(t,n,o,i){var e=l.Layer.Button;if(e.EditLayer.isActive()){var a=e.EditLayer.getInteracter(),i=a.getID();this.Button.submitEdit(i)}},h.AssignMacroButton=function(t,n,o,i,e){u.call(this,t,n,o,i,e)},h.CloneButton=function(t,n,o,i){a.call(this,t,n,o,i)},h.DeleteButton=function(t,n,o,i){r.call(this,t,n,o,i)},h.onButtonRepaint=function(t,o,i){n.call(this,t,o,i)},h.onButtonMeta=function(t,n,o,i){this.Button.removeAll();for(var e in i)this.onButtonInsert(t,n,o,i[e])},h.onButtonInsert=function(t,n,i,a){var u=a[B.ID];o.call(this,t,n,i,u),e.call(this,t,n,i,u)},h.onButtonDelete=function(t,n,o,e){var a=e[B.ID];i.call(this,t,n,o,a)},h.onButtonMove=function(t,n,i,e){var a=e[B.ID];o.call(this,t,n,i,a)},h.onButtonResize=function(t,n,i,e){var a=e[B.ID];o.call(this,t,n,i,a)},h.onButtonModify=function(t,n,i,a){var u=a[B.ID];o.call(this,t,n,i,u),e.call(this,t,n,i,u)}}(this);
!function(t){function n(t,n,i,a){var h=d.data.getWorkBook(t,i),r=h.getSheetObj(n),e=r.Charts,o=e.get(a),s=o.getLeft(),c=o.getTop(),u=o.getHeight(),f=o.getWidth();o&&this.Chart.place(a,s,c,f,u)}function i(t){t&&this.Chart.remove(t)}function a(t){t&&this.Chart.delete(t)}function h(t,n,i,a){var h=d.data.getWorkBook(t,i),r=h.getSheetObj(n),e=r.Charts,o=e.get(a);o.flushInstance()}function r(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onRender(t,n)}function e(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onLoad(t,n)}function o(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onZoom(t,n)}function s(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onRefresh(t,n)}function c(t){var n=this.Chart.getInteracter(t);n&&this.Chart.onCachedViewAttach(t,n)}function u(t,n){var i=this.Chart.getInteracter(t);i&&this.Chart.updatePanelStatus(t,n)}function f(t,i,a,r,e){return new Promise(function(o){h.call(this,t,i,a,r),n.call(this,t,i,a,r),s.call(this,r),!e&&this.Chart.focus(r),setTimeout(function(){o()},100)}.bind(this))}function l(t,a,r,o){return new Promise(function(s){i.call(this,o),n.call(this,t,a,r,o),h.call(this,t,a,r,o),e.call(this,o),setTimeout(function(){s()},100)}.bind(this))}function C(t,i,a,h){return new Promise(function(r){n.call(this,t,i,a,h),o.call(this,h),setTimeout(function(){r()},100)}.bind(this))}{var d=t.sPlusPlus,v=t.ZSClass,g=(d.data.UserInfo,t.ZSChart,v.UIGridComponent.prototype),m=t.ZSEvents;m.topic,m.Groups,m.Names}g.onChartMeta=function(t,n,i,a){this.Chart.removeAll(),this.onChartMetaAsync(t,n,i,a)},g.onChartMetaAsync=function(t,n,i,a){if(a){var h=a.shift();h&&l.call(this,t,n,i,h.id).then(function(){this.onChartMetaAsync(t,n,i,a)}.bind(this))}},g.onChartUpdateBoundary=function(t,n,i,a){this.Chart.removeAll(),this.attachChartAsync(t,n,i,a)},g.onChartInsert=function(t,i,a,h,e){return new Promise(function(o){for(var s in h){var c=h[s],u=c.id;n.call(this,t,i,a,u),r.call(this,u),!e&&this.Chart.focus(u)}setTimeout(function(){o()},100)}.bind(this))},g.onUpdatePanelStatus=function(t,n,i,a,h){u.call(this,a,h)},g.onChartDelete=function(t,n,i,h){for(var r in h){var e=h[r];e&&a.call(this,e)}},g.onRemoveChart=function(t,n,a,h){for(var r in h){var e=h[r];e&&i.call(this,e)}},g.onChartUpdate=function(t,n,i,a,h){if(a){var r=a.shift();r&&f.call(this,t,n,i,r.id,h).then(function(){this.onChartUpdate(t,n,i,a,h)}.bind(this))}},g.onSheetSwitchChartUpdate=function(t,n,i,a,h){var r=a.length,e=h.length;r>0&&this.onChartMetaAsync(t,n,i,a),e>0&&this.attachChartAsync(t,n,i,h)},g.onChartZoom=function(t,n,i,a){if(a){var h=a.shift();h&&C.call(this,t,n,i,h.id).then(function(){this.onChartZoom(t,n,i,a,!0)}.bind(this))}},g.attachChartAsync=function(t,n,i,a){var h=a.shift();h&&this.attachChart(t,n,i,h).then(function(){this.attachChartAsync(t,n,i,a)}.bind(this))},g.onChartPlace=function(t,i,a,h){n.call(this,t,i,a,h)},g.onChartBlur=function(t,n,i,a){for(var h=0;h<a.length;h++){var r=a[h];this.Chart.blur(r)}},g.onChartFocus=function(t,n,i,a){for(var h=0;h<a.length;h++){var r=a[h];this.Chart.focus(r)}},g.attachChart=function(t,i,a,h){return new Promise(function(r){n.call(this,t,i,a,h),c.call(this,h),setTimeout(function(){r()},100)}.bind(this))}}(this);
!function(e){function t(e,t,a,n){var o=g.data.getWorkBook(e,a),i=o.getSheetObj(t),l=i.Images,r=l.get(n);r&&this.Image.place(n)}function a(e,t,a,n){{var o=g.data.getWorkBook(e,a),i=o.getSheetObj(t),l=i.Images;l.get(n)}this.Image.setImageSrc(n)}function n(e,t,a,n){{var o=g.data.getWorkBook(e,a),i=o.getSheetObj(t),l=i.Images;l.get(n)}this.Image.resizeToOriginal(n)}function o(e,t,a,n){this.Image.delete(n)}function i(e,t,a,n){this.Image.remove(n)}function l(e,t,a,n){var o=new c.Layer.Modules.Clone.Helper(100,100);this.Image.clone(n,o)}function r(e,n,o){var i=g.data.getWorkBook(e,o),l=i.getSheetObj(n),r=l.Images,s=r.getMap();for(var c in s)t.call(this,e,n,o,c),a.call(this,e,n,o,c)}function s(){var e=this.Image.getActive();for(var t in e)return t}var g=e.sPlusPlus,c=e.ZSClass,I=c.UIGridComponent.prototype,h=e.ZSConstants.CommandConstants;I.onImageMeta=function(e,t,a,n){for(var o=0,i=n.length;i>o;o++)this.onInsertImage(e,t,a,n[o])},I.onInsertImage=function(e,n,o,i){var l=i[h.IMAGE_ID];t.call(this,e,n,o,l),a.call(this,e,n,o,l)},I.DeleteImage=function(e,t,a,n){o.call(this,e,t,a,n)},I.onDeleteImage=function(e,t,a,n){for(var o=0,l=n.length;l>o;o++){var r=n[o][h.IMAGE_ID];i.call(this,e,t,a,r)}},I.onMoveImage=function(e,t,a,n){for(var o=0,i=n.length;i>o;o++)this.moveImage(e,t,a,n[o])},I.moveImage=function(e,a,n,o){var i=o[h.IMAGE_ID];t.call(this,e,a,n,i)},I.onResizeImage=function(e,t,a,n){for(var o=0,i=n.length;i>o;o++)this.resizeImage(e,t,a,n[o])},I.resizeImage=function(e,a,n,o){var i=o[h.IMAGE_ID];t.call(this,e,a,n,i)},I.CloneImage=function(e,t,a,n){l.call(this,e,t,a,n)},I.onRepaintImage=function(e,t,a){r.call(this,e,t,a)},I.onReplaceImage=function(e,t,a,n){for(var o=0,i=n.length;i>o;o++)this.replace(e,t,a,n[o])},I.replace=function(e,n,o,i){var l=i[h.IMAGE_ID];t.call(this,e,n,o,l),a.call(this,e,n,o,l)},I.ResizeToOriginal=function(e,t,a,o,i,l){var o=o||s.call(this);n.call(this,e,t,a,o,i,l)},I.replaceImage=function(e,t,a,n){var n=n||s.call(this);this.Image.replaceImage(n)}}(this);
!function(t){function e(t,e,r){var s=o.data.getWorkBook(t,r),i=s.getSheetObj(e),a=i.DataFilters.getAllRanges();for(var I in a){var R=a[I].rows;for(var A in R){var D=R[A],O=D[0],c=D[1],u=D[2],N=s.RowStyle.getStyleDef(u,!0);E.publish(S.Listener,n.SheetAction.HIDEROWS.REMOVE,{RID:t,SHEETID:e,VERSION:r,start:parseInt(O),count:parseInt(c),DIMENSION:N})}}}function r(t,e,r,s,i,a){for(var I=o.data.getWorkBook(t,r),R=(I.getSheetObj(e),a&&a.length),A=0;R>A;A++){{var D=(a[A],a[A][0]),O=a[A][1];a[A][2]}E.publish(S.Listener,n.SheetAction.HIDEROWS.ADD,{RID:t,SHEETID:e,VERSION:r,start:D,count:O})}}var o=t.sPlusPlus,s=t.ZSEvents,E=s.topic,S=s.Groups,n=s.Names;E.register(S.UserAction,n.SheetAction.DATAFILTER.ONBEFOREAPPLY,e,"RID","SHEETID","VERSION","FRANGE","FACOLS","FROWS"),E.register(S.UserAction,n.SheetAction.DATAFILTER.ONAPPLY,r,"RID","SHEETID","VERSION","FRANGE","FACOLS","FROWS")}(this);
!function(e){function t(e){{var t=e.properties;e.org}for(var r in U)U[r].rID===t.rID&&U[r].sheetID===t.sheetID&&U[r].component[t.method].apply(U[r].component,e.arg)}function r(e){var t=e.arg,r=e.properties.method,i=t[0],E=t[1],I=t[2],o=n(i,E,I);o||m.log("Check this rID, sheetID, version is must....",i,E,I,r,t);var S=U[o].component;S[e.properties.method].apply(S,e.arg)}function i(e){var t=e.arg,r=e.properties.method,i=t[0],E=t[1],I=t[2],o=n(i,E,I);o||m.log("Check this rID, sheetID, version is must....",i,E,I,r,t);var S=U[o].component;U[o].isEditable&&S[e.properties.method].apply(S,e.arg)}function E(e){var t=e.arg,r=(e.properties.method,t[0]),i=t[1],E=t[2];for(var I in U)if(U[I].rID===r&&U[I].sheetID===i&&U[I].version===E){var n=U[I].component;n[e.properties.method].apply(n,e.arg)}}function I(e){var t=e.arg,r=(e.properties.method,t[0]),i=(t[1],t[2]);for(var E in U)if(U[E].rID===r&&U[E].version===i){var I=U[E].component;I[e.properties.method].apply(I,e.arg)}}function n(e,t,r){for(var i in U)if(U[i].rID===e&&U[i].sheetID===t&&U[i].version===r)return i}function o(e,t){var r={};return r.arg=e,r.properties={method:t,rID:e[0],sheetID:e[1]},r}function S(e,t,r,i){this.rID=e,this.sheetID=t,this.version=r,this.gridID=i,this.setEditable(!0)}function R(e,t){var r=V.view.getActiveGridID(),i=V.view.getSheetID(r);U[r]&&(U[r].rID=void 0),_.RemoveTileDom(e,i,t),_.reset(e,i,t),G(e,i,t,!1)}function D(e){var t=V.view.getActiveGridID(),r=V.view.getResourceID(t),i=V.view.getSheetID(t),E=V.view.getVersionID(t);G(r,i,E,e)}function s(e,t){var r=V.view.getActiveGridID(),i=V.view.getResourceID(r),E=V.view.getVersionID(r),I=V.view.getSheetID(r);p(i,I,E,e,t)}function a(e,t,r){var i=V.view.getActiveGridID();M(e,t,r,i)}function T(e,t){var r=V.view.getActiveGridID(),i=V.view.getSheetID(r);_.onReload(e,i,t)}function c(e,t,r){var i=V.view.getActiveGridID(),E=V.view.getSheetID(i);_.DVInterrupt(e,E,t,r)}function l(e,t,r){var i=V.view.getActiveGridID(),E=V.view.getSheetID(i);_.modifyPivot(e,E,t,r)}function A(e,t,r){var i=V.view.getActiveGridID(),E=U[i];E&&e===E.rID&&r===E.version&&t===E.sheetID||(E&&U[i].component.flush(E.rID,E.sheetID),g(e,t,r))}function O(e,t,r){var i=V.view.getActiveGridID(),E=U[i];E&&E.component.flush(E.rID,E.sheetID),g(e,t,r)}function g(e,t,r){var i=V.view.getActiveGridID();U[i]=new S(e,t,r,i),U[i].createComponent();var E=V.data.getWorkBook(e,r),I=E.ProtectedSheets.isSheetLocked(t);U[i].component.onLockSheet(e,t,r,I);var n=E.isEditable()&&!I;U[i].setEditable(n)}function N(e,t,r){{var i=n(e,t,r);V.view.getSheetState(i,t)}}function L(e,t,r){for(var i in r){var E=r[i],I=E[0];_.onLockSheet(e,I,t,!!E[1]);var o=n(e,I,t);if(o){var S=V.data.getWorkBook(e,t),R=S.ProtectedSheets.isSheetLocked(I),D=S.isEditable()&&!R;U[o].setEditable(D)}}}function H(e,t,r){_.HighlightInvalidData(e,t,r)}var h=e.ZSClass,V=e.sPlusPlus,C=e.ZSEvents,v=C.topic,d=C.Groups,P=C.Names,m=e.ZSDevTools.Logger,u=V.view.measures,U=V.view.grid={};V.view.getActiveGridID=function(){return V.view.Defaults.defaultGrid},V.view.getResourceID=function(e){return U[e]&&U[e].rID},V.view.getSheetID=function(e){return U[e]&&U[e].sheetID},V.view.getVersionID=function(e){return U[e]&&U[e].version},V.view.getGridComponent=function(e){return U[e]&&U[e].component},V.view.getGridDom=function(e){return U[e]&&U[e].component.getDom()},S.prototype={createComponent:function(t){var t=e.document.querySelector("#"+this.gridID)||e.document.querySelector(".sheetPaneContainer"),r=new h.Range(0,0,65535,255),i=0,E=0,I=0,n=0,o=e.innerHeight-(u.Top.Height+u.Bottom.Height),S=e.innerWidth-(u.Left.Width+u.Right.Width),R=V.view.getSheetState(this.gridID,this.sheetID),D=R&&R.sLefts||[0,0],s=R&&R.sTops||[0,0];this.component=new h.UIGridComponent(this.gridID,this.rID,this.sheetID,this.version,t,r,i,E,I,n,S,o,D,s)},setEditable:function(e){this.isEditable=e}};var p=function(){t(o(arguments,"fetchData"))},M=function(){t(o(arguments,"fetchCacheData"))},G=function(){t(o(arguments,"updateStoryStatus"))},_={},B=["DummyScroll","scrollIntoView","onPlaceDim","onRemoveDim","setRelativeScroll0","setRelativeScroll1","setRelativeScroll2","setRelativeScroll3","PlaceCellSelection","RemoveCellSelection","PlaceRangeSelection","RemoveRangeSelection","BlurOle","SelectNextOle","SelectPrevOle","PlaceCellNote","RemoveCellNote","RemoveAllCellNotes","PlacePrecedance","RemoveAllPrecedances","PlaceFillSelection","RemoveFillSelection","RemoveFillSeriesCue","PlaceCopySelection","RemoveCopySelection","RepaintCopySelection","onZoomBefore","setZoom","setGridView","ClientFirstActions","setDimensions","setContentDimensions","setRelativeScroll","setScroll0","setScroll1","PlaceDVBtn","HideDVBtn","ShowDVBtn","PlaceDVHint","HideDVHint","ShowDVHint","PlaceDragSelection","RemoveDragSelection","PlaceHeaderDragSelection","RemoveHeaderDragSelection","PlaceHighlightVersion","RemoveHighlightVersion","RemoveAllHighlightVersion","insertSparklines","changeSparklineData","applySparklineProperties","editSparklinesGroup","removeSparklines","setSparklineExtremes","showPasteWidget","hidePasteWidget","repaintPasteWidget"];for(var f in B)_[B[f]]=function(e){return function(){r(o(arguments,B[e]))}}(f);var w=["reset","modifyPivot","onRowInsertBefore","onRowDeleteBefore","onColInsertBefore","onColDeleteBefore","onHideBefore","onShowBefore","insertRow","deleteRow","insertCol","deleteCol","hideRow","showRow","hideCol","showCol","resizeRow","resizeCol","merge","onBeforeMerge","split","onBeforeSplit","addCellProtect","modifyCellProtect","removeCellProtect","hideCellProtect","showCellProtect","onBeforeDataFilter","addDataFilter","hideDataFilter","showDataFilter","removeDataFilter","hideGridLine","pushDOMChanges","pushFaultyChanges","pushCfChanges","updateMaxUsedCell","onReload","RemoveTileDom","removeDVInterrupt","DVInterrupt","updateBoundary","PlaceRecalculateFlash","PlacePreview","ClearPreview","ClearAllPreview","onLockSheet","onButtonMeta","onButtonInsert","onButtonDelete","onButtonMove","onButtonResize","onButtonModify","onButtonRepaint","resetPane","onChartInsert","onChartMeta","onChartDelete","onChartUpdate","onChartUpdateBoundary","onRemoveChart","onChartZoom","onImageMeta","DeleteImage","onDeleteImage","onMoveImage","onResizeImage","CloneImage","onReplaceImage","ResizeToOriginal","replaceImage","onRepaintImage","onSheetSwitchChartUpdate","onChartPlace","onChartBlur","onChartFocus","onUpdatePanelStatus","addPivotFilter","removePivotFilter","onBeforeHideShowColumn","onAfterHideColumn","onAfterShowColumn","onBeforeHideShowRow","onAfterShowRow","onAfterHideRow","sparklineUndo"];for(var f in w)_[w[f]]=function(e){return function(){E(o(arguments,w[e]))}}(f);var F=["PlaceRangePickerSelection","RemoveRangePickerSelection","RemoveRangePickerSelectionFrom","PlaceUserPresence","RemoveUserPresence","EditUserPresence","PlaceCommentsHighlight","RemoveCommentsHighlight","RepaintCommentsHighlight","PlaceHighlightLocks","RemoveHighlightLocks","HighlightInvalidData","highlightRange","removeHighlightRanges"];for(var f in F)_[F[f]]=function(e){return function(){I(o(arguments,F[e]))}}(f);var y=["EditButton","CancelEditButton","SubmitEditButton","CloneButton","DeleteButton","AssignMacroButton","MoveOle","MoveEndOle","DeleteOle"];for(var f in y)_[y[f]]=function(e){return function(){i(o(arguments,y[e]))}}(f);v.register(d.UserAction,P.SheetAction.SCROLL_POSITION.Relativepane0,_.setRelativeScroll0,"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),v.register(d.UserAction,P.SheetAction.SCROLL_POSITION.Relativepane1,_.setRelativeScroll1,"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),v.register(d.UserAction,P.SheetAction.SCROLL_POSITION.Relativepane2,_.setRelativeScroll2,"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),v.register(d.UserAction,P.SheetAction.SCROLL_POSITION.Relativepane3,_.setRelativeScroll3,"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),v.register(d.UserAction,P.SheetAction.SCROLL_POSITION.ScrollIntoView,_.scrollIntoView,"RID","SHEETID","VERSION","X","Y","WIDTH","HEIGHT"),v.register(d.UserAction,P.SheetAction.SCROLL_POSITION.DummyScroll,_.DummyScroll,"RID","SHEETID","VERSION"),v.register(d.Selector.DomUpdate.Cell,P.Selection.BOUND_UPDATE.ADD,_.PlaceCellSelection,"RID","SHEETID","VERSION","RANGEID","ActiveCellRange"),v.register(d.Selector.DomUpdate.Cell,P.Selection.BOUND_UPDATE.REPAINT,_.PlaceCellSelection,"RID","SHEETID","VERSION","RANGEID","ActiveCellRange"),v.register(d.Selector.DomUpdate.Cell,P.Selection.BOUND_UPDATE.REMOVE,_.RemoveCellSelection,"RID","SHEETID","VERSION","RANGEID"),v.register(d.Selector.DomUpdate.Range,P.Selection.BOUND_UPDATE.ADD,_.PlaceRangeSelection,"RID","SHEETID","VERSION","RANGEID","ActiveRange","isSingleCell"),v.register(d.Selector.DomUpdate.Range,P.Selection.BOUND_UPDATE.REMOVE,_.RemoveRangeSelection,"RID","SHEETID","VERSION","RANGEID"),v.register(d.Listener,P.Layers.Ole.Blur,_.BlurOle,"RID","SHEETID","VERSION"),v.register(d.Listener,P.Layers.Ole.Move,_.MoveOle,"RID","SHEETID","VERSION","HELPER"),v.register(d.Listener,P.Layers.Ole.MoveEnd,_.MoveEndOle,"RID","SHEETID","VERSION","HELPER"),v.register(d.Listener,P.Layers.Ole.Delete,_.DeleteOle,"RID","SHEETID","VERSION","HELPER"),v.register(d.Listener,P.Layers.Ole.SelectNext,_.SelectNextOle,"RID","SHEETID","VERSION","HELPER"),v.register(d.Listener,P.Layers.Ole.SelectPrev,_.SelectPrevOle,"RID","SHEETID","VERSION","HELPER"),v.register(d.Listener,P.Layers.Recalculate.Place,_.PlaceRecalculateFlash,"RID","SHEETID","VERSION","ID","RANGE"),v.register(d.Listener,P.Layers.Drag.Place,_.PlaceDragSelection,"RID","SHEETID","VERSION","ID","RANGE"),v.register(d.Listener,P.Layers.Drag.Remove,_.RemoveDragSelection,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.Layers.HeaderDrag.Place,_.PlaceHeaderDragSelection,"RID","SHEETID","VERSION","ID","RANGE"),v.register(d.Listener,P.Layers.HeaderDrag.Remove,_.RemoveHeaderDragSelection,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.Layers.HighlightVersion.Place,_.PlaceHighlightVersion,"RID","SHEETID","VERSION","RANGE","COLORCODE","USER_NAME"),v.register(d.Listener,P.Layers.HighlightVersion.Remove,_.RemoveHighlightVersion,"RID","SHEETID","VERSION","RANGE"),v.register(d.Listener,P.Layers.HighlightVersion.RemoveAll,_.RemoveAllHighlightVersion,"RID","SHEETID","VERSION"),v.register(d.Listener,P.Layers.Preview.Place,_.PlacePreview,"RID","SHEETID","VERSION","RANGE","CALLBACK"),v.register(d.Listener,P.Layers.Preview.Remove,_.ClearPreview,"RID","SHEETID","VERSION","ROW","COL"),v.register(d.Listener,P.Layers.Preview.RemoveAll,_.ClearAllPreview,"RID","SHEETID","VERSION"),v.register(d.Listener,P.Layers.Note.Place,_.PlaceCellNote,"RID","SHEETID","VERSION","ROW","COL","COMMENT","X","Y","ROWX","COLY","FIXRIGHT","FIXBOTTOM"),v.register(d.Listener,P.Layers.Note.Remove,_.RemoveCellNote,"RID","SHEETID","VERSION","ROW","COL"),v.register(d.Listener,P.Layers.Note.RemoveAll,_.RemoveAllCellNotes,"RID","SHEETID","VERSION"),v.register(d.Listener,P.Layers.Precedance.Place,_.PlacePrecedance,"RID","SHEETID","VERSION","ID","RANGE","CELL"),v.register(d.Listener,P.Layers.Precedance.RemoveAll,_.RemoveAllPrecedances,"RID","SHEETID","VERSION"),v.register(d.Selector.DomUpdate.FillSeries,P.Selection.BOUND_UPDATE.ADD,_.PlaceFillSelection,"RID","SHEETID","VERSION","RANGEID","ActiveRange"),v.register(d.Selector.DomUpdate.FillSeries,P.Selection.BOUND_UPDATE.REMOVE,_.RemoveFillSelection,"RID","SHEETID","VERSION","RANGEID"),v.register(d.Selector.DomUpdate.FillSeries,P.Selection.BOUND_UPDATE.MODIFY,_.RemoveFillSeriesCue,"RID","SHEETID","VERSION","RANGEID"),v.register(d.Selector.DomUpdate.Copy,P.Selection.BOUND_UPDATE.ADD,_.PlaceCopySelection,"RID","SHEETID","VERSION","RANGEID","ActiveRange"),v.register(d.Selector.DomUpdate.Copy,P.Selection.BOUND_UPDATE.REMOVE,_.RemoveCopySelection,"RID","SHEETID","VERSION","RANGEID"),v.register(d.Selector.DomUpdate.Copy,P.Selection.BOUND_UPDATE.REPAINT,_.RepaintCopySelection,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetAction.ZOOM.OnBefore,_.onZoomBefore,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetAction.ZOOM.On,_.setZoom,"RID","SHEETID","VERSION","ZOOM"),v.register(d.Listener,P.GridAction.CLIENTFIRSTACTIONS,_.ClientFirstActions,"RID","SHEETID","VERSION","ACTION","RANGELIST","VALUE"),v.register(d.Listener,P.Browser.ScreenViewport,_.setDimensions,"RID","SHEETID","VERSION","Height","Width"),v.register(d.Listener,P.Browser.ContentViewport,_.setContentDimensions,"RID","SHEETID","VERSION"),v.register(d.Listener,P.GridAction.WheelXYPaneContainerScroll,_.setRelativeScroll,"RID","SHEETID","VERSION","DistanceX","DistanceY","X","Y","Forced"),v.register(d.Listener,P.SheetMeta.SCROLL_POSITION0,_.setScroll0,"RID","SHEETID","VERSION","SCROLLLEFT","SCROLLTOP"),v.register(d.Listener,P.SheetMeta.SCROLL_POSITION1,_.setScroll1,"RID","SHEETID","VERSION","SCROLLLEFT","SCROLLTOP"),v.register(d.Listener,P.SheetAction.SPARKLINES.INSERT,_.insertSparklines,"RID","SHEETID","VERSION","DATA"),v.register(d.Listener,P.SheetAction.SPARKLINES.DATA,_.changeSparklineData,"RID","SHEETID","VERSION","DATA"),v.register(d.Listener,P.SheetAction.SPARKLINES.MODIFY,_.applySparklineProperties,"RID","SHEETID","VERSION","PROPS"),v.register(d.Listener,P.SheetAction.SPARKLINES.EDIT_GROUP,_.editSparklinesGroup,"RID","SHEETID","VERSION","DATA"),v.register(d.Listener,P.SheetAction.SPARKLINES.REMOVE,_.removeSparklines,"RID","SHEETID","VERSION","REMOVE"),v.register(d.Listener,P.SheetAction.SPARKLINES.UNDO,_.sparklineUndo,"RID","SHEETID","VERSION","META"),v.register(d.Listener,P.SheetAction.SPARKLINES.EXTREMES,_.setSparklineExtremes,"RID","SHEETID","VERSION","EXTREMES"),v.register(d.Listener,P.SheetAction.ROW_HEADERS.ONBEFOREINSERT,_.onRowInsertBefore,"RID","SHEETID","VERSION","type","start","count"),v.register(d.Listener,P.SheetAction.ROW_HEADERS.ONBEFOREDELETE,_.onRowDeleteBefore,"RID","SHEETID","VERSION","type","start","count"),v.register(d.Listener,P.SheetAction.COLUMN_HEADERS.ONBEFOREINSERT,_.onColInsertBefore,"RID","SHEETID","VERSION","type","start","count"),v.register(d.Listener,P.SheetAction.COLUMN_HEADERS.ONBEFOREDELETE,_.onColDeleteBefore,"RID","SHEETID","VERSION","type","start","count"),v.register(d.Listener,P.SheetAction.HIDEROWS.onBeforeHide,_.onHideBefore,"RID","SHEETID","VERSION","type","start","count"),v.register(d.Listener,P.SheetAction.HIDEROWS.onBeforeShow,_.onShowBefore,"RID","SHEETID","VERSION","type","start","count"),v.register(d.Listener,P.SheetAction.ROW_HEADERS.INSERT,_.insertRow,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.ROW_HEADERS.DELETE,_.deleteRow,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.COLUMN_HEADERS.INSERT,_.insertCol,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.COLUMN_HEADERS.DELETE,_.deleteCol,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.HIDECOLS.ONBEFORE,_.onBeforeHideShowColumn,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.HIDECOLS.ON_AFTER_ADD,_.onAfterHideColumn,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.HIDECOLS.ON_AFTER_REMOVE,_.onAfterShowColumn,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.HIDEROWS.ONBEFORE,_.onBeforeHideShowRow,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.HIDEROWS.ON_AFTER_ADD,_.onAfterHideRow,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.HIDEROWS.ON_AFTER_REMOVE,_.onAfterShowRow,"RID","SHEETID","VERSION","start","count"),v.register(d.Listener,P.SheetAction.ROW_HEADERS.RESIZE.ENUMERATE,_.resizeRow,"RID","SHEETID","VERSION","START","COUNT","STYLENAME","xaid"),v.register(d.Listener,P.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,_.resizeCol,"RID","SHEETID","VERSION","START","COUNT","STYLENAME","xaid"),v.register(d.Listener,P.SheetAction.MERGE_CELLS.ADD,_.merge,"RID","SHEETID","VERSION","MergeList"),v.register(d.Listener,P.SheetAction.MERGE_CELLS.onBeforeMerge,_.onBeforeMerge,"RID","SHEETID","VERSION","MergeList"),v.register(d.Listener,P.SheetAction.MERGE_CELLS.REMOVE,_.split,"RID","SHEETID","VERSION","MergeList"),v.register(d.Listener,P.SheetAction.MERGE_CELLS.onBeforeSplitRange,_.onBeforeSplit,"RID","SHEETID","VERSION","MergeList"),v.register(d.Listener,P.SheetAction.MERGE_ACROSS.ADD,_.merge,"RID","SHEETID","VERSION","MergeList"),v.register(d.Listener,P.SheetAction.MERGE_ACROSS.onBeforeMergeAcross,_.onBeforeMerge,"RID","SHEETID","VERSION","MergeList"),v.register(d.Listener,P.SheetMeta.FREEZE,_.updateBoundary,"RID","SHEETID","VERSION","FreezedRow","FreezedCol"),v.register(d.Listener,P.SheetMeta.FREEZE,_.setZoom,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetMeta.GRIDVIEW,_.setGridView,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetMeta.PROTECTED_RANGES,_.addCellProtect,"RID","SHEETID","VERSION","RangeList"),v.register(d.Listener,P.SheetAction.PROTECTED_RANGES.MODIFY,_.modifyCellProtect,"RID","SHEETID","VERSION","RangeList"),v.register(d.Listener,P.SheetAction.PROTECTED_RANGES.REMOVE,_.removeCellProtect,"RID","SHEETID","VERSION","RangeList"),v.register(d.Listener,P.SheetAction.PROTECTED_RANGES.HIDE,_.hideCellProtect,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetAction.PROTECTED_RANGES.SHOW,_.showCellProtect,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetMeta.PROTECTED_RANGES,_.PlaceHighlightLocks,"RID","SHEETID","VERSION","RangeList","SHEETLIST"),v.register(d.Listener,P.SheetAction.PROTECTED_RANGES.MODIFY,_.PlaceHighlightLocks,"RID","SHEETID","VERSION","RangeList","SHEETLIST"),v.register(d.Listener,P.SheetAction.PROTECTED_RANGES.REMOVE,_.RemoveHighlightLocks,"RID","SHEETID","VERSION","RangeList","SHEETLIST"),v.register(d.Listener,P.DocAction.DATAVALIDATION.HIGHLIGHT_INVALID_DATA,H,"RID","SHEETID","VERSION"),v.register(d.Listener,P.DocMeta.PROTECTED_SHEETS,L,"RID","VERSION","PROTECTED_SHEETS"),v.register(d.Listener,P.DocAction.PROTECTED_SHEETS.MODIFY,L,"RID","VERSION","MODIFY"),v.register(d.Listener,P.DocAction.PROTECTED_SHEETS.REMOVE,L,"RID","VERSION","REMOVE"),v.register(d.Listener,P.UserAction.PIVOT.FILTER_ADD,_.addPivotFilter,"RID","SHEETID","VERSION","F_CEllS"),v.register(d.Listener,P.SheetAction.PIVOT.FILTER_REMOVE,_.removePivotFilter,"RID","SHEETID","VERSION","PIVOT_ID"),v.register(d.UserAction,P.SheetAction.DATAFILTER.ONBEFORE,_.onBeforeDataFilter,"RID","SHEETID","VERSION","FRANGE","FACOLS","FROWS"),v.register(d.UserAction,P.SheetAction.DATAFILTER.ONAPPLY,_.addDataFilter,"RID","SHEETID","VERSION","FRANGE","FACOLS","FROWS","START"),v.register(d.UserAction,P.SheetAction.DATAFILTER.HIDE,_.hideDataFilter,"RID","SHEETID","VERSION","FRANGE"),v.register(d.UserAction,P.SheetAction.DATAFILTER.SHOW,_.showDataFilter,"RID","SHEETID","VERSION"),v.register(d.UserAction,P.SheetAction.DATAFILTER.REMOVE,_.removeDataFilter,"RID","SHEETID","VERSION","RANGE"),v.register(d.Listener,P.SheetAction.GRID_LINES.MODIFY,_.hideGridLine,"RID","SHEETID","VERSION","SHOW_GRID"),v.register(d.Listener,P.ServerAction.PROCESSTRIMCELLRESPONSE,_.pushDOMChanges,"DOCID","SHEETID","VERSION","ROW_DATA","COLUMN_DATA","XAID","CONDITIONAL_FORMAT"),v.register(d.Listener,P.ServerAction.PROCESSTRIMFAULTYRESPONSE,_.pushFaultyChanges,"DOCID","SHEETID","VERSION","RANGES","CELLS","XAID"),v.register(d.Listener,P.ServerAction.PROCESSCFRESPONSE,_.pushCfChanges,"DOCID","SHEETID","VERSION","META","FAULTY_RANGES","FAULTY_CELLS","XAID"),v.register(d.Listener,P.SheetMeta.MAX_USED_CELL,_.updateMaxUsedCell,"RID","SHEETID","VERSION","USEDROW","USEDCOL"),v.register(d.Listener,P.DocMeta.ACTIVE_SHEET,A,"RID","ACTIVE_SHEET","VERSION"),v.register(d.Listener,P.SheetMeta.FREEZE,N,"RID","SHEETID","VERSION","FreezedRow","FreezedCol"),v.register(d.Listener,P.SheetAction.VERSION_HISTORY.BACK_TO_EDITOR,O,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetMeta.FREEZE,_.resetPane,"RID","SHEETID","VERSION","FreezedRow","FreezedCol"),v.register(d.Listener,P.GridAction.RELOAD,T,"RID","VERSION"),v.register(d.Listener,P.DocAction.DOCUMENT.CLOSE,R,"RID","VERSION"),v.register(d.Listener,P.UserAction.HIGHLIGHT_RANGE.ADD,_.highlightRange,"RID","SHEETID","VERSION","RANGEID","RANGE","COLOR"),v.register(d.Listener,P.UserAction.HIGHLIGHT_RANGE.REMOVE,_.removeHighlightRanges,"RID","SHEETID","VERSION","RANGEIDS"),v.register(d.Listener,P.RangePicker.Add,_.PlaceRangePickerSelection,"RID","SHEETID","VERSION","RANGEID","Range","bringForward","isCurrentRange","color"),v.register(d.Listener,P.RangePicker.Hide,_.RemoveRangePickerSelection,"RID","SHEETID","VERSION","index"),v.register(d.Listener,P.RangePicker.HideFrom,_.RemoveRangePickerSelectionFrom,"RID","SHEETID","VERSION","fromIndex"),v.register(d.Listener,P.DocAction.USER_LIST.ADDINFO,_.PlaceUserPresence,"RID","SHEETID","VERSION","RANGEID","RANGE","COLOR","UNAME","EDITSTATUS"),v.register(d.Listener,P.DocAction.USER_LIST.REMOVE,_.RemoveUserPresence,"RID","SHEETID","VERSION","RANGEID"),v.register(d.Listener,P.DocAction.USER_LIST.EDITINFO,_.EditUserPresence,"RID","SHEETID","VERSION","RANGEID","RANGE","COLOR","UNAME"),v.register(d.Listener,P.UserAction.REVIEW_COMMENTS.PLACE_HIGHLIGHT,_.PlaceCommentsHighlight,"RID","SHEETID","VERSION","RANGE","RANGEID"),v.register(d.Listener,P.UserAction.REVIEW_COMMENTS.REMOVE_HIGHLIGHT,_.RemoveCommentsHighlight,"RID","SHEETID","VERSION","RANGE","RANGEID"),v.register(d.Listener,P.UserAction.HIGHLIGHT_LOCKS,_.PlaceHighlightLocks,"RID","SHEETID","VERSION","RANGELIST","SHEETLIST"),v.register(d.Listener,P.UserAction.REMOVE_HIGHLIGHT_LOCKS,_.RemoveHighlightLocks,"RID","SHEETID","VERSION","RANGELIST","SHEETLIST"),v.register(d.Listener,P.UserAction.DATA_VALIDATION.PLACE_DV_BTN,_.PlaceDVBtn,"RID","SHEETID","VERSION","ROW","COL","ALIGN"),v.register(d.Listener,P.UserAction.DATA_VALIDATION.HIDE_DV_BTN,_.HideDVBtn,"RID","SHEETID","VERSION"),v.register(d.Listener,P.UserAction.DATA_VALIDATION.SHOW_DV_BTN,_.ShowDVBtn,"RID","SHEETID","VERSION"),v.register(d.Listener,P.UserAction.DATA_VALIDATION.PLACE_DV_HINT,_.PlaceDVHint,"RID","SHEETID","VERSION","ROW","COL","TEXT","TYPE","MESSAGE"),v.register(d.Listener,P.UserAction.DATA_VALIDATION.HIDE_DV_HINT,_.HideDVHint,"RID","SHEETID","VERSION"),v.register(d.Listener,P.UserAction.DATA_VALIDATION.SHOW_DV_HINT,_.ShowDVHint,"RID","SHEETID","VERSION"),v.register(d.Listener,P.CollabAction.JOIN_SUCCESS,D,"state"),v.register(d.Listener,P.GridAction.VIEWPORT.REREGISTER,s,"isTruncateViewPort","isDataNeeded"),v.register(d.Listener,P.SheetAction.DATAVALIDATION.UPDATEDOM,c,"RESOURCE_ID","VERSION","STATE"),v.register(d.Listener,P.SheetAction.DATAVALIDATION.REMOVE,_.removeDVInterrupt,"RID","SHEETID","VERSION","RangeList"),v.register(d.Listener,P.DocAction.PIVOT.OnBeforeModify,l,"RID","VERSION","PIVOT"),v.register(d.Listener,P.SheetMeta.CACHEDVIEWPORT_EXT,a,"RID","SHEETID","VERSION","USEDROW","USEDCOL","ITERATION"),v.register(d.Listener,P.SheetMeta.BUTTONS,_.onButtonMeta,"RID","SHEETID","VERSION","BUTTONS"),v.register(d.Listener,P.SheetAction.BUTTONS.INSERT,_.onButtonInsert,"RID","SHEETID","VERSION","BUTTONS","XAID"),v.register(d.Listener,P.SheetAction.BUTTONS.DELETE,_.onButtonDelete,"RID","SHEETID","VERSION","BUTTONS","XAID"),v.register(d.Listener,P.SheetAction.BUTTONS.MOVE,_.onButtonMove,"RID","SHEETID","VERSION","BUTTONS","XAID"),v.register(d.Listener,P.SheetAction.BUTTONS.RESIZE,_.onButtonResize,"RID","SHEETID","VERSION","BUTTONS","XAID"),v.register(d.Listener,P.SheetAction.BUTTONS.MODIFY,_.onButtonModify,"RID","SHEETID","VERSION","BUTTONS","XAID"),v.register(d.Listener,P.SheetAction.BUTTONS.REPAINT,_.onButtonRepaint,"RID","SHEETID","VERSION"),v.register(d.Listener,P.UserAction.BUTTONS.EDIT,_.EditButton,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.BUTTONS.CANCELEDIT,_.CancelEditButton,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.BUTTONS.SUBMITEDIT,_.SubmitEditButton,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.BUTTONS.CLONE,_.CloneButton,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.BUTTONS.DELETE,_.DeleteButton,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.BUTTONS.ASSIGNMACRO,_.AssignMacroButton,"RID","SHEETID","VERSION","ID","CONTEXT"),v.register(d.Listener,P.UserAction.CHARTS.DELETE,_.onChartDelete,"RID","SHEETID","VERSION","ACTIVE_CHART_ID"),v.register(d.Listener,P.SheetAction.CHARTS.INSERT,_.onChartInsert,"RID","SHEETID","VERSION","CHARTS"),v.register(d.Listener,P.SheetMeta.CHARTS,_.onChartMeta,"RID","SHEETID","VERSION","CHARTS"),v.register(d.Listener,P.UserAction.CHARTS.UPDATE,_.onChartUpdate,"RID","SHEETID","VERSION","CHARTS","doNotSetFocus"),v.register(d.Listener,P.SheetAction.CHARTS.ATTACH,_.onSheetSwitchChartUpdate,"RID","SHEETID","VERSION","CHARTS","CACHED"),v.register(d.Listener,P.SheetAction.CHARTS.PLACE,_.onChartPlace,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.SheetAction.CHARTS.BLUR,_.onChartBlur,"RID","SHEETID","VERSION","CHARTID"),v.register(d.Listener,P.SheetAction.CHARTS.FOCUS,_.onChartFocus,"RID","SHEETID","VERSION","CHARTID"),v.register(d.Listener,P.SheetAction.CHARTS.DELETE_LAYER,_.onRemoveChart,"RID","SHEETID","VERSION","ACTIVE_CHART_ID"),v.register(d.Listener,P.UserAction.CHARTS.ZOOM,_.onChartZoom,"RID","SHEETID","VERSION","CHARTS"),v.register(d.Listener,P.SheetAction.CHARTS.UPDTATE_BOUNDARY,_.onChartUpdateBoundary,"RID","SHEETID","VERSION","CHARTS"),v.register(d.Listener,P.SheetAction.CHARTS.UPDATE_PANEL_STATUS,_.onUpdatePanelStatus,"RID","SHEETID","VERSION","CHART_ID","STATUS"),v.register(d.Listener,P.CellAction.WidgetAction.RECAST_WIDEGT,_.showPasteWidget,"RID","SHEETID","VERSION","META"),v.register(d.Listener,P.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,_.hidePasteWidget,"RID","SHEETID","VERSION"),v.register(d.Listener,P.CellAction.WidgetAction.RECAST_WIDEGT_REPAINT,_.repaintPasteWidget,"RID","SHEETID","VERSION"),v.register(d.Listener,P.SheetMeta.IMAGES,_.onImageMeta,"RID","SHEETID","VERSION","IMAGES"),v.register(d.Listener,P.SheetAction.IMAGES.INSERT,_.onImageMeta,"RID","SHEETID","VERSION","IMAGES"),v.register(d.Listener,P.SheetAction.IMAGES.DELETE,_.onDeleteImage,"RID","SHEETID","VERSION","IMAGES"),v.register(d.Listener,P.SheetAction.IMAGES.MOVE,_.onMoveImage,"RID","SHEETID","VERSION","IMAGES"),v.register(d.Listener,P.SheetAction.IMAGES.RESIZE,_.onResizeImage,"RID","SHEETID","VERSION","IMAGES"),v.register(d.Listener,P.SheetAction.IMAGES.EDIT,_.onReplaceImage,"RID","SHEETID","VERSION","IMAGES"),v.register(d.Listener,P.SheetAction.IMAGES.REPAINT,_.onRepaintImage,"RID","SHEETID","VERSION"),v.register(d.Listener,P.UserAction.IMAGES.DELETE,_.DeleteImage,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.IMAGES.CLONE,_.CloneImage,"RID","SHEETID","VERSION","ID"),v.register(d.Listener,P.UserAction.IMAGES.RESIZE_TO_ORIGINAL,_.ResizeToOriginal,"RID","SHEETID","VERSION","ID","WIDTH","HEIGHT"),v.register(d.Listener,P.UserAction.IMAGES.REPLACE,_.replaceImage,"RID","SHEETID","VERSION","ID")}(this);
!function(s){{var a=s.sPlusPlus,t=s.ZSEvents,u=(s.ZSClass,t.topic,t.Groups,t.Names,a.data.Defaults);u.MAX_ROW,u.MAX_COL}}(this);
!function(t){function e(t){return t.className="pR",t}function i(t,i){this.domRef=e(t),this.range=i}var o=0,s=0;i.prototype={paint:function(t,e,i,n){var h=this.domRef.style;h.top=t-o+"px",h.left=e-o+"px",h.height=i+s+"px",h.width=n+s+"px"},addHighlight:function(t){this.domRef.classList.add("highlightLocks");var e=document.createElement("span"),i=this.range;e.className="curPtr",this.domRef.appendChild(e),e.addEventListener("mousedown",function(t){t.stopPropagation()}),e.addEventListener("click",function(e){t.showDialog(!1,i),e.stopPropagation()})},removeHighlight:function(){this.domRef.classList.remove("highlightLocks"),this.domRef&&this.domRef.firstChild&&this.domRef.removeChild(this.domRef.firstChild)},remove:function(){this.domRef.style.display="none",this.domRef.parentNode.removeChild(this.domRef)},hide:function(){this.domRef.style.display="none"},revoke:function(){this.domRef.style.display=""}},t.ZSClass.UIProtectRangeCue=i}(this);
!function(T){var I=(T.sPlusPlus,T.ZSClass);I.SelectorHelper={},I.SelectorHelper.Constants={};var E=I.SelectorHelper.Constants,O={FILLSERIES:0,FORMULA:1,CELLRANGE:2,COPY:3,CELLEDITOR:4},C={RANGE:0,ROW:1,COLUMN:2,SHEET:3},L={LEFT_TOP:0,LEFT_MID:1,LEFT_BOTTOM:2,MID_TOP:3,MID_BOTTOM:4,RIGHT_TOP:5,RIGHT_MID:6,RIGHT_BOTTOM:7},R={MULTI_DIRECTION:0,BI_DIRECTION:1,UNI_DIRECTION:2},e={HIDDEN:0,VISIBLE:1},s={API:0,USERACTION:1};E.ACTION=O,E.DIRECTION_TYPE=R,E.TYPE=C,E.POINT=L,E.CUESTATUS=e,E.CALLER=s}(this);
!function(t){function e(t){var e=n.view.getActiveGridID(),o=n.view.getSheetState(e,t.Prop.Id),i=o.getScrollLefts()[0],r=o.getZoom();return t.Column.axis.findAbs(i/r)}function o(t){var e=n.view.getActiveGridID(),o=n.view.getSheetState(e,t.Prop.Id),i=o.getScrollTops()[0],r=o.getZoom();return t.Row.axis.findAbs(i/r)}function i(t,o,i,r,a,s){var g=n.view.getActiveGridID(),d=n.view.getResourceID(g),w=n.view.getVersionID(g),R=(n.data.getWorkBook(d,w),n.view.getActiveState(g)),v=R.getFormulaState(),x=n.view.getSheetState(g,t.Prop.Id),c=t.Column.axis.findAbs(s),f=v?x.getActiveCellRange():x.getActiveRange();o=0>o?t.Column.axis.getPos(e(t)):o;{var I=t.Column.axis.findAbs(o);t.Column.hidden}if(r&u.ROW)return t.Column.axis.getPos(C-1);if(a===l.MID_TOP||a===l.MID_BOTTOM){var A=c===f.endCol?f.startCol:f.endCol;return t.Column.axis.getPos(A)}if(a===l.LEFT_MID){if(I=I>=f.startCol?f.startCol:I,t.Merge.isIntersecting(f)&&I<f.startCol){var P=(f.startCol-I-1)/f.getColSpan();I=f.startCol-(parseInt(P)+1)*f.getColSpan(),I=0>I?0:I>C?C:I}return t.Column.axis.getPos(I)}if(a===l.RIGHT_MID){if(I=I<=f.endCol?f.endCol:I,t.Merge.isIntersecting(f)&&I>f.endCol){var P=(I-f.endCol-1)/f.getColSpan();I=f.endCol+(parseInt(P)+1)*f.getColSpan(),I=0>I?0:I>C?C:I}return t.Column.axis.getPos(I)}return t.Column.axis.getPos(I)}function r(t,e,i,r,a,s){var g=n.view.getActiveGridID(),C=n.view.getResourceID(g),w=n.view.getVersionID(g),R=(n.data.getWorkBook(C,w),n.view.getActiveState(g)),v=R.getFormulaState(),x=n.view.getSheetState(g,t.Prop.Id),c=t.Row.auxiliaryAxis.findAbs(s),f=v?x.getActiveCellRange():x.getActiveRange();e=0>e?t.Row.auxiliaryAxis.getPos(o(t)):e;{var I=t.Row.auxiliaryAxis.findAbs(e);t.Row.Visibility}if(r&u.COLUMN)return t.Row.auxiliaryAxis.getPos(d-1);if(a===l.LEFT_MID||a===l.RIGHT_MID){var A=c===f.endRow?f.startRow:f.endRow;return t.Row.auxiliaryAxis.getPos(A)}if(a===l.MID_TOP){if(I=I>=f.startRow?f.startRow:I,t.Merge.isIntersecting(f)&&I<f.startRow){var P=(f.startRow-I-1)/f.getRowSpan();I=f.startRow-(parseInt(P)+1)*f.getRowSpan(),I=0>I?0:I>d?d:I}return t.Row.auxiliaryAxis.getPos(I)}if(a===l.MID_BOTTOM){if(I=I<=f.endRow?f.endRow:I,t.Merge.isIntersecting(f)&&I>f.endRow){var P=(I-f.endRow-1)/f.getRowSpan();I=f.endRow+(parseInt(P)+1)*f.getRowSpan(),I=0>I?0:I>d?d:I}return t.Row.auxiliaryAxis.getPos(I)}return t.Row.auxiliaryAxis.getPos(I)}var n=t.sPlusPlus,a=t.ZSClass,s=a.SelectorHelper,l=s.Constants.POINT,u=s.Constants.TYPE,g=n.data.Defaults,d=g.MAX_ROW,C=g.MAX_COL;s.aPredictCoordX=function(t,o,i,r,n){var a=r&u.ROW?e(t):n?i===l.LEFT_TOP||i===l.LEFT_MID?n.endCol:n.startCol:t.Column.axis.findAbs(o);return t.Column.axis.getPos(a)},s.aPredictCoordY=function(t,e,i,r,n){var a=r&u.COLUMN?o(t):n?i===l.LEFT_TOP||i===l.MID_TOP?n.endRow:n.startRow:t.Row.auxiliaryAxis.findAbs(e);return t.Row.auxiliaryAxis.getPos(a)},s.predictCoordX0=function(t,e,o,i,r){var n=i&u.ROW?0:r?o===l.LEFT_TOP||o===l.LEFT_MID?r.endCol:r.startCol:t.Column.axis.findAbs(e);return t.Column.axis.getPos(n,e,o,i,r)},s.predictCoordY0=function(t,e,o,i,r){var n=i&u.COLUMN?0:r?o===l.LEFT_TOP||o===l.MID_TOP?r.endRow:r.startRow:t.Row.auxiliaryAxis.findAbs(e);return t.Row.auxiliaryAxis.getPos(n)},s.predictCoordX=function(t,e,o,r,n,a){return i(t,e,a,o,r,n)},s.predictCoordY=function(t,e,o,i,n,a){return r(t,e,a,o,i,n)}}(this);
!function(e){function n(e,n,t){var i=o.SelectorHelper.Constants.TYPE;t===i.ROW?e.Merge.extendRow(n):t===i.COLUMN?e.Merge.extendCol(n):e.Merge.extendRange(n)}var t=e.sPlusPlus,o=e.ZSClass,i=o.SelectorHelper,d=!0;i.processRangeWithEntities=function(e,i,s,r,a){var l=t.data.getWorkBook(e,s),R=l.getSheetObj(i),r=new o.Range(r.startRow,r.startCol,r.endRow,r.endCol);return d&&n(R,r,a),r},i.predictRange=function(e,n,t,i,s,r){var a=e.Row.auxiliaryAxis.findAbs(s),l=e.Column.axis.findAbs(i),R=e.Row.auxiliaryAxis.findAbs(t),C=e.Column.axis.findAbs(n);d=r;var w=new o.Range;return w.startRow=R>a?a:R,w.endRow=a>=R?a:R,w.startCol=C>l?l:C,w.endCol=l>=C?l:C,e.Row.Visibility.isHidden(w.startRow)&&(w.startRow=e.Row.Visibility.nextNonHidden(w.startRow)),e.Row.Visibility.isHidden(w.endRow)&&(w.endRow=e.Row.Visibility.nextNonHidden(w.endRow)),e.Column.hidden.isHidden(w.startCol)&&(w.startCol=e.Column.hidden.nextNonHidden(w.startCol)),e.Column.hidden.isHidden(w.endCol)&&(w.endCol=e.Column.hidden.nextNonHidden(w.endCol)),w.endRow<w.startRow&&(w.endRow=w.startRow),w.endCol<w.startCol&&(w.endCol=w.startCol),w}}(this);
!function(o){var t=o.sPlusPlus,e=o.ZSClass;e.SheetMetaHelper={};var n=e.SheetMetaHelper,i=t.data.Defaults,r=i.MAX_ROW,a=i.MAX_COL;n.withinRange=function(o,t,n){if(void 0!=t.Row){var i=new e.Range(t.Row,0,t.Row+n-1,a);return o.intersects(i)}if(void 0!=t.Col){var i=new e.Range(0,t.Col,r,t.Col+n-1);return o.intersects(i)}},n.beforeRange=function(o,t){return void 0!=t.Row?o.startRow>t.Row:void 0!=t.Col?o.startCol>t.Col:void 0},n.shift=function(o,t,e){void 0!=t.Row&&(o.startRow+=e,o.endRow+=e),void 0!=t.Col&&(o.startCol+=e,o.endCol+=e)}}(this);
!function(t){function i(t,i,r,o){t>r&&(t=t+r-(r=t)),i>o&&(i=i+o-(o=i)),(t>e||e>r)&&(e=t),(i>s||s>o)&&(s=i)}var e,s,r=(t.sPlusPlus,t.ZSClass),o=r.SelectorHelper;r.Selector={};var h=function(t,i,e){this.type=t,this.considerMerge=i,this.dirType=e,this.fixedRange={}};h.prototype={persistFixedRange:function(t,i){this.fixedRange=i},ADD:function(t,r,h,n,p){r=o.lubricateX(t,r),h=o.lubricateY(t,h),!p&&(e=o.aPredictCoordX(t,r,n,this.type,p)),!p&&(s=o.aPredictCoordY(t,h,n,this.type,p));var c=o.predictCoordX0(t,r,n,this.type,p),d=o.predictCoordY0(t,h,n,this.type,p);return this._persistCoords(c,d),this.point=n,i(this.x0,this.y0,r,h,this.type),r=o.predictCoordX(t,r,this.type,n,this.x0,p),h=o.predictCoordY(t,h,this.type,n,this.y0,p),o.predictRange(t,c,d,r,h,this.considerMerge,this.type)},MODIFY:function(t,e,s,r){return e=o.lubricateX(t,e),s=o.lubricateY(t,s),e=o.predictCoordX(t,e,this.type,this.point,this.x0,r),s=o.predictCoordY(t,s,this.type,this.point,this.y0,r),i(this.x0,this.y0,e,s,this.type),o.predictRange(t,this.x0,this.y0,e,s,this.considerMerge,this.type)},getFixedCellRange:function(t){return o.predictRange(t,e,s,e,s,this.considerMerge,this.type)},getFixedRange:function(){return this.fixedRange},_persistCoords:function(t,i){this.x0=t,this.y0=i}},r.Selector.Assistor=h}(this);
!function(e){function t(e){return e.startRow>=c||e.startCol>=I||e.endRow>=c||e.endCol>=I}function E(e,t,E,o,D,n,a){var s=i.data.getWorkBook(e,E),O=s.getSheetObj(t),A=i.view.getActiveGridID(),I=i.view.getSheetState(A,t),c=I.getActiveRange();o=c.id;{var N=g.MODIFY(O,D,n,c);g.getFixedCellRange(O)}r.publish(R.Selector.BoundUpdate.Range,S.Selection.BOUND_UPDATE.MODIFY,{RID:e,SHEETID:t,VERSION:E,RANGEID:o,RANGE:N,TYPE:a,CALLER:l.CALLER.USERACTION})}function o(e,t,E,o){var D=i.data.getWorkBook(e,E),n=D.getSheetObj(t),r=n.Column.axis.getPos(o.startCol),R=n.Row.axis.getPos(o.startRow);g=new O(0,!0,s);g.ADD(n,r,R)}function D(e,t,E,n){o(e,t,E,n),r.unregister(R.Selector.BoundUpdate.Cell,S.Selection.BOUND_UPDATE.ADD,D)}var n=e.ZSEvents,r=n.topic,R=n.Groups,S=n.Names,i=e.sPlusPlus,a=(e.UserAction,e.ZSClass),l=a.SelectorHelper.Constants,s=l.MULTI_DIRECTION,O=a.Selector.Assistor,A=i.data.Defaults,I=A.MAX_COL,c=A.MAX_ROW,g=null,N={DOWN:function(e,E,o,D,n,a,A){var I=i.data.getWorkBook(e,o),c=I.getSheetObj(E);g=new O(a,!0,s);var N=g.ADD(c,D,n);if(!t(N)){{var T=i.view.getActiveGridID();i.view.getSheetState(T,E),g.getFixedCellRange(c)}r.publish(R.Selector.BoundUpdate.Range,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:E,VERSION:o,RANGE:N,accumulate:A,TYPE:a,CALLER:l.CALLER.USERACTION})}},MOVE:function(e,t,o,D,n,r,R){E(e,t,o,D,n,r,R)},END:function(e,t,o,D,n,r,R){E(e,t,o,D,n,r,R)}};r.register(R.Selector.BoundUpdate.Cell,S.Selection.BOUND_UPDATE.ADD,D,"RID","SHEETID","VERSION","ActiveCellRange"),r.register(R.Listener,S.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,o,"RID","SHEETID","VERSION","ActiveCellRange"),r.register(R.Gesture.Selector.Range,S.GESTURE.ACTION.DOWN,N.DOWN,"RID","SHEETID","VERSION","COLX","ROWY","TYPE","ACCUMULATE"),r.register(R.Gesture.Selector.Range,S.GESTURE.ACTION.MOVE,N.MOVE,"RID","SHEETID","VERSION","RANGEID","COLX","ROWY","TYPE"),r.register(R.Gesture.Selector.Range,S.GESTURE.ACTION.END,N.END,"RID","SHEETID","VERSION","RANGEID","COLX","ROWY","TYPE")}(this);
!function(e){var t=e.ZSEvents,E=t.topic,S=t.Groups,r=t.Names,i=e.sPlusPlus,T={ACTUATE:function(e,t,T,o){var s=i.view.getActiveGridID(),I=i.view.getSheetState(s,t),R=i.view.getSelectedSheets(s),a=I.getRanges();E.publish(S.Selector.BoundUpdate.FormatPainter,r.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:T,RANGES:a,SHEETS:R,IS_SERVER_CLIP:!1,IS_COPY:!0,Category:o})},ENUMERATE:function(e,t,i){E.publish(S.Selector.BoundUpdate.FormatPainter,r.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i})}};E.register(S.Gesture.Selector.FormatPainter,r.GESTURE.ACTION.ACTUATE,T.ACTUATE,"RID","SHEETID","VERSION","isSingleTap"),E.register(S.Gesture.Selector.FormatPainter,r.GESTURE.ACTION.ENUMERATE,T.ENUMERATE,"RID","SHEETID","VERSION")}(this);
!function(t){function e(t,e){var a=180*Math.atan2(E-t,g-e)/Math.PI;return a=(360-Math.round(a))%360}function a(t,a){var o=e(t,a);return c>o||o>180-c&&180+c>o||o>360-c}function o(t,a,o,r){var i=D.data.getWorkBook(t,o),n=i.getSheetObj(a),S=n.Column.axis.getPos(r.startCol),s=n.Column.axis.getPos(r.endCol+1),l=n.Row.auxiliaryAxis.getPos(r.startRow),R=n.Row.auxiliaryAxis.getPos(r.endRow+1);E=(S+s)/2,g=(l+R)/2,u=r.clone(),c=e(s,l)}function r(t,e,a,o,r,i){{var n=D.data.getWorkBook(t,a);n.getSheetObj(e)}if(r=Math.min(r,o.startRow),i&&r<o.startRow){var S=~~((o.startRow-r-1)/o.getRowSpan());r=o.startRow-(S+1)*o.getRowSpan(),r=Math.max(0,r),r=Math.min(r,M)}return r}function i(t,e,a,o,r,i){{var n=D.data.getWorkBook(t,a);n.getSheetObj(e)}if(r=Math.min(r,o.startCol),i&&r<o.startCol){var S=~~((o.startCol-r-1)/o.getColSpan());r=o.startCol-(S+1)*o.getColSpan(),r=Math.max(0,r),r=Math.min(r,C)}return r}function n(t,e,a,o,r,i){if(r=Math.max(r,o.endRow),i&&r>o.endRow){var n=~~((r-o.endRow-1)/o.getRowSpan());r=o.endRow+(n+1)*o.getRowSpan(),r=Math.max(0,r),r=Math.min(r,M)}return r}function S(t,e,a,o,r,i){if(r=Math.max(r,o.endCol),i&&r>o.endCol){var n=~~((r-o.endCol-1)/o.getColSpan());r=o.endCol+(n+1)*o.getColSpan(),r=Math.max(0,r),r=Math.min(r,C)}return r}function s(t,e,a,o,s,l,R){var E=D.data.getWorkBook(t,a),g=E.getSheetObj(e),c=g.Row.auxiliaryAxis.findAbs(s),I=g.Column.axis.findAbs(o),A=g.Row.auxiliaryAxis.findAbs(R),d=g.Column.axis.findAbs(l),h=g.Merge.isIntersecting(u);c=r(t,e,a,u,c,h),I=i(t,e,a,u,I,h),A=n(t,e,a,u,A,h),d=S(t,e,a,u,d,h);var O=new v.Range(c,I,A,d);return O}function l(t,e,o,r,i){a(r,i)?r=E:i=g;var n=Math.min(r,E),S=Math.max(r,E),l=Math.min(i,g),R=Math.max(i,g);return s(t,e,o,n,l,S,R)}var R,E,g,u,c,D=t.sPlusPlus,I=t.ZSEvents,A=I.topic,d=I.Groups,h=I.Names,v=t.ZSClass,O=v.SelectorHelper.Constants,T=(O.MULTI_DIRECTION,v.Selector.Assistor,D.data.Defaults),M=T.MAX_ROW,C=T.MAX_COL,w={START:function(t,e,a,r,i,n,S,s,l){var E=D.view.getActiveGridID(),g=D.data.getWorkBook(t,a),u=(g.getSheetObj(e),D.view.getSheetState(E,e)),c=u.getActiveRange(),I=0;R=!!l;var v=c.clone();o(t,e,a,c),A.register(d.Selector.BoundUpdate.FillSeries,h.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:e,VERSION:a,RANGE:v,RANGEID:I,TYPE:s})},MOVE:function(t,e,a,o,r,i,n){var S=D.data.getWorkBook(t,a),s=(S.getSheetObj(e),D.view.getActiveGridID()),S=D.data.getWorkBook(t,a),R=(S.getSheetObj(e),D.view.getSheetState(s,e)),E=(R.getActiveRange(),l(t,e,a,r,i));A.publish(d.Selector.BoundUpdate.FillSeries,h.Selection.BOUND_UPDATE.MODIFY,{RID:t,SHEETID:e,VERSION:a,RANGEID:o,RANGE:E,TYPE:n})},END:function(e,a,o,r,i,n){var S=D.data.getWorkBook(e,o),s=(S.getSheetObj(a),D.view.getActiveGridID()),S=D.data.getWorkBook(e,o),E=(S.getSheetObj(a),D.view.getSheetState(s,a)),g=E.getActiveRange(),u=l(e,a,o,i,n);t.UserAction.CalcFillDetails(e,[a],o,u,g,R),A.publish(d.Selector.BoundUpdate.FillSeries,h.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:a,VERSION:o,RANGEID:r})}};A.register(d.Gesture.Selector.FillSeries,h.GESTURE.ACTION.START,w.START,"RID","SHEETID","VERSION","RANGEID","x","y","point","TYPE","ISCTRLPRESSED"),A.register(d.Gesture.Selector.FillSeries,h.GESTURE.ACTION.MOVE,w.MOVE,"RID","SHEETID","VERSION","RANGEID","x","y","TYPE"),A.register(d.Gesture.Selector.FillSeries,h.GESTURE.ACTION.END,w.END,"RID","SHEETID","VERSION","RANGEID","x","y","TYPE")}(this);
!function(e){function t(e,t,i,E){var S=s.data.getWorkBook(e,i),a=S.getSheetObj(t),n=a.ProtectedRanges.isXists(E.startRow,E.startCol),R=a.CheckBoxRanges.isXists(E.startRow,E.startCol),c=a.Pivot.isXists(E.startRow,E.startCol),d=S.ProtectedSheets.isSheetLocked(t);if(n||c||d||R){var D=n||d?"ProtectedRange.alert.ProtectRangeMessage":c?"Error.Pivot.Table.Part.Change":"checkbox";return"checkbox"!=D&&r.publish(l.Listener,o.ERROR.SHOW,{ERRORMSG:D}),!1}return!0}var i=e.ZSEvents,r=i.topic,l=i.Groups,o=i.Names,s=e.sPlusPlus,E=(e.UserAction,e.ZSClass),S=E.SelectorHelper.Constants.MULTI_DIRECTION,a=(E.SelectorHelper.Constants,E.Selector.Assistor),n={ExprField:function(e,i,E){{var S=s.view.getActiveGridID(),a=s.view.getSheetState(S,i),n=a.getActiveCellRange();s.view.CellEditor.getEditStatus()}t(e,i,E,n)&&r.publish(l.Selector.BoundUpdate.CellEdit,o.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:i,VERSION:E,RANGE:n})},CellField:function(e,i,E,n,R){{var c=s.data.getWorkBook(e,E),d=c.getSheetObj(i),D=new a(void 0,!0,S),C=(D.ADD(d,n,R),D.getFixedCellRange(d));s.view.CellEditor.getEditStatus()}t(e,i,E,C)&&r.publish(l.Selector.BoundUpdate.CellEdit,o.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:i,VERSION:E,RANGE:C})},OnKeyBoardDown:function(e,t,i,s,E){r.publish(l.Selector.BoundUpdate.CellEdit,o.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i,isSubmittable:s,ISCSE:E})}};r.register(l.Gesture.Selector.CellEdit,o.GESTURE.ACTION.ACTUATE,n.ExprField,"RID","SHEETID","VERSION"),r.register(l.Gesture.Selector.CellEdit,o.GESTURE.ACTION.DOWN,n.CellField,"RID","SHEETID","VERSION","x","y"),r.register(l.Gesture.Selector.CellEdit,o.GESTURE.ACTION.ENUMERATE,n.OnKeyBoardDown,"RID","SHEETID","VERSION","isSubmittable","ISCSE")}(this);
!function(e){function t(e,t,D,o){var S=l.data.getWorkBook(e,D),a=S.getSheetObj(t);return a.Merge.extendRange(o),o}var l=e.sPlusPlus,D=e.ZSEvents,o=D.topic,S=D.Groups,a=D.Names,i=ZSClass.Selector.Assistor,n=ZSClass.SelectorHelper.Constants,r=n.MULTI_DIRECTION,E={add:function(e,D,i,n,r,E){var c=l.view.getActiveGridID(),s=l.view.getSheetState(c,D);n=t(e,D,i,n),s.setActiveCellRange(0,n,r,E),o.publish(S.Selector.DomUpdate.Cell,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:D,VERSION:i,ActiveCellRange:n})},show:function(e,t,D){var i=l.view.getActiveGridID(),n=l.view.getSheetState(i,t),r=n.getActiveCellRange();o.publish(S.Selector.DomUpdate.Cell,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:D,ActiveCellRange:r})}},c={DOWN:function(e,t,D,E,c,s,R){var C=l.data.getWorkBook(e,D),O=C.getSheetObj(t),A=new i(s,!0,r),I=A.getFixedCellRange(O),g=A.ADD(O,E,c);o.publish(S.Selector.BoundUpdate.Cell,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:D,ActiveCellRange:I,ROW:g.startRow,COL:g.startCol,TYPE:s,accumulate:R,CALLER:n.CALLER.USERACTION})}};o.register(S.Gesture.Selector.Range,a.GESTURE.ACTION.DOWN,c.DOWN,"RID","SHEETID","VERSION","COLX","ROWY","TYPE","ACCUMULATE"),o.register(S.Selector.BoundUpdate.Cell,a.Selection.BOUND_UPDATE.ADD,E.add,"RID","SHEETID","VERSION","ActiveCellRange","ROW","COL"),o.register(S.Selector.BoundUpdate.Cell,a.Selection.BOUND_UPDATE.SHOW,E.show,"RID","SHEETID","VERSION")}(this);
!function(e){function t(e,t,o,i){var n=a.data.getWorkBook(e,o),r=n.getSheetObj(t);return i.isCol()||i.isRow()?i:(r.Merge.extendRange(i),i)}var a=e.sPlusPlus,o=e.ZSClass,i=e.ZSEvents,n=i.topic,r=i.Groups,D=i.Names,S=new o.IDGenerator,g={add:function(e,t,a,o,i,n,r){g.addDATA(e,t,a,o,i,n,r),g.addDOM(e,t,a,o,n,i,r)},addDATA:function(e,o,i,n,r,D){var d=a.view.getActiveGridID(),E=a.view.getSheetState(d,o);n=t(e,o,i,n),r||(g.hide(e,o,i),S.flush(),E.clearRanges());var R=S.get();E.addSelection(n,R,D)},addDOM:function(e,t,o,i){var S=a.data.getWorkBook(e,o),g=S.getSheetObj(t),d=a.view.getActiveGridID(),E=a.view.getSheetState(d,t),i=E.getActiveRange(),R=E.getRanges(),l=g.Merge.getInfo(i.startRow,i.startCol),c=i.isSingle()||l&&i.equals(l),s={RID:e,SHEETID:t,VERSION:o,ActiveRange:i,RANGES:R,RANGEID:i.id,TYPE:i.type,isSingleCell:!!c};n.publish(r.Selector.DomUpdate.Range,D.Selection.BOUND_UPDATE.ADD,s)},addRanges:function(e,t,i,n,r,D,d){var E=a.view.getActiveGridID(),R=a.view.getSheetState(E,t);g.hide(e,t,i),S.flush(),R.clearRanges();for(var l,c=n.length,s=0;c>s;s++)l=void 0!=n[s].startRow?new o.Range(n[s].startRow,n[s].startCol,n[s].endRow,n[s].endCol):new o.Range(n[s][0],n[s][1],n[s][2],n[s][3]),g.add(e,t,i,l,r,D,d)},modify:function(e,o,i,S,g,d,E){var R=a.data.getWorkBook(e,i).getSheetObj(o),l=a.view.getActiveGridID(),c=a.view.getSheetState(l,o);g=d?g:t(e,o,i,g),c.addSelection(g,S,d);var s=c.getRanges(),I=R.Merge.getInfo(g.startRow,g.startCol),v=g.isSingle()||I&&g.equals(I),A={RID:e,SHEETID:o,VERSION:i,RANGES:s,ActiveRange:g,RANGEID:S,TYPE:d,isSingleCell:!!v};!E&&n.publish(r.Selector.DomUpdate.Range,D.Selection.BOUND_UPDATE.ADD,A)},removeDOM:function(e,t,a,o){n.publish(r.Selector.DomUpdate.Range,D.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:a,RANGEID:o})},remove:function(e,t,o,i){var n=a.data.getWorkBook(e,o),r=(n.getSheetObj(t),a.view.getActiveGridID()),D=a.view.getSheetState(r,t);D.clearSelection(i),g.removeDOM(e,t,o,i)},removeAll:function(e,t,o){S.flush(),g.hide(e,t,o);var i=a.data.getWorkBook(e,o),n=(i.getSheetObj(t),a.view.getActiveGridID()),r=a.view.getSheetState(n,t);r.clearRanges()},hide:function(e,t,o){for(var i=a.view.getActiveGridID(),n=a.view.getSheetState(i,t),r=n.getRanges(),D=r.length,S=0;D>S;S++)g.removeDOM(e,t,o,r[S].id)},show:function(e,t,a){g.addDOM(e,t,a)}};n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.ADD,g.add,"RID","SHEETID","VERSION","RANGE","accumulate","TYPE"),n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.MODIFY,g.modify,"RID","SHEETID","VERSION","RANGEID","RANGE","TYPE","MODE"),n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.SHOW,g.show,"RID","SHEETID","VERSION"),n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.HIDE,g.hide,"RID","SHEETID","VERSION"),n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.REMOVE,g.remove,"RID","SHEETID","VERSION","RANGEID"),n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.FLUSH,g.removeAll,"RID","SHEETID","VERSION"),n.register(r.Selector.BoundUpdate.Range,D.Selection.BOUND_UPDATE.ADDRANGES,g.addRanges,"RID","SHEETID","VERSION","RANGES","accumulate","TYPE","CALLER")}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass,a=e.ZSEvents,D=a.topic,r=a.Groups,n=a.Names,i=new o.IDGenerator,E=t.data.UserInfo,S={add:function(e,o,a,D,r,n,i,E){var s=t.data.getWorkBook(e,a),I=s.getSheetObj(o),c=I.Pivot;for(var d in D){var l=D[d];if(c.isIntersecting(l)&&!i)return}S.addData(e,r,a,D,n,i,E),S.addDOM(e,o,a,n)},addData:function(e,t,a,D,r,n,E){i.flush();var S=[];for(var I in D){var c=D[I];if(void 0!=c.sr){var d=new o.Range(c.sr,c.sc,c.er,c.ec),l=i.get();d.id=l,S.push(d)}else S.push(c)}s.addDetails(e,t,a,S,r,n,E)},addDOM:function(e,t,o){for(var a={RID:e,SHEETID:t,VERSION:o},i=s.ranges(),E=0;E<i.length;E++){var S=i[E];a.ActiveRange=S,a.RANGEID=S.id,D.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.ADD,a)}},remove:function(e,t,o){S.removeDOM(e,t,o),S.removeData(e,t,o)},removeData:function(){i.flush(),s.clearDetails()},removeDOM:function(e,t,o,a,i){if(a)D.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:o,RANGEID:a});else for(var E=s.ranges(),S=0;E&&S<E.length;S++){var i=E[S];a=i.id,D.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:o,RANGEID:a})}},hide:function(e,t,o,a){E.activeInfo.setVisualCueStatus(a),S.removeDOM(e,t,o)},show:function(e,t,o){var a,i=s.ranges(),E=s.sheets();if(-1!=E.indexOf(t))for(var S=0;i&&S<i.length;S++){var I=i[S];a={RID:e,SHEETID:t,VERSION:o,ActiveRange:I,RANGEID:I.id},D.publish(r.Selector.DomUpdate.Copy,n.Selection.BOUND_UPDATE.ADD,a)}}},s={};s.ranges=function(){var e=E.activeInfo.getCopyDetails().Ranges;return e},s.sheets=function(){var e=E.activeInfo.getCopyDetails().Sheets;return e},s.addDetails=function(e,t,o,a,D,r){E.activeInfo.addCopyDetails(e,t,o,a,D,r)},s.clearDetails=function(){E.activeInfo.clearCopyRange()},D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.ADD,S.add,"RID","SHEETID","VERSION","RANGES","SHEETS","IS_SERVER_CLIP","IS_COPY","Category"),D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.ADDDATA,S.addData,"RID","SHEETS","VERSION","RANGES","IS_SERVER_CLIP"),D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVE,S.remove,"RID","SHEETID","VERSION"),D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVEDOM,S.removeDOM,"RID","SHEETID","VERSION","RANGEID","RANGE"),D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.REMOVEDATA,S.removeData,"RID","SHEETID","VERSION"),D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.HIDE,S.hide,"RID","SHEETID","VERSION","VisualCueStatus"),D.register(r.Selector.BoundUpdate.Copy,n.Selection.BOUND_UPDATE.SHOW,S.show,"RID","SHEETID","VERSION")}(this);
!function(e){function t(e,t,l,i){var o=r.data.getWorkBook(e,l),E=o.getSheetObj(t);return E.Merge.extendRange(i),i}var l,i,o,r=e.sPlusPlus,E=e.ZSEvents,S=E.topic,D=E.Groups,a=E.Names,s=ZSClass.SelectorHelper,n=(s.Constants,e.UserAction),d={add:function(e,E,s,d,c){l=e,i=E,o=s;var g=0,I=r.view.CellEditor;d=t(e,E,s,d),n.ScrollCellIntoView(e,E,s,d.startRow,d.startCol),I.addEditCell(e,E,s,d,d.startRow,d.startCol),S.publish(D.Selector.DomUpdate.CellEdit,a.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:E,VERSION:s,ActiveRange:d,RANGEID:g,TYPE:c})},remove:function(t,l,i,o,E){{var s=0,n=r.view.getActiveGridID(),d=(r.view.getSheetState(n,l),r.view.CellEditor),c=d.getEditCell();r.view.getSelectedSheets(n)}d.clearEditCell(),c&&(o&&(e.UserAction.SwitchSheet(t,l,i,c.getSheetID()),E?e.UserAction.SubmitArrayFormula(c.getRID(),[c.getSheetID()],c.getVersion(),r.view.CellEditor.getValue(),c.getRow(),c.getCol()):e.UserAction.SubmitCell(c.getRID(),[c.getSheetID()],c.getVersion(),r.view.CellEditor.getValue(),c.getRow(),c.getCol())),S.publish(D.Selector.DomUpdate.CellEdit,a.Selection.BOUND_UPDATE.REMOVE,{RID:t,SHEETID:l,VERSION:i,RANGEID:s}))}};S.register(D.Selector.BoundUpdate.CellEdit,a.Selection.BOUND_UPDATE.ADD,d.add,"RID","SHEETID","VERSION","RANGE","RANGEID","TYPE"),S.register(D.Selector.BoundUpdate.CellEdit,a.Selection.BOUND_UPDATE.REMOVE,d.remove,"RID","SHEETID","VERSION","isSubmittable","ISCSE")}(this);
!function(e){function t(e,t,D,E){var S=i.data.getWorkBook(e,D),l=S.getSheetObj(t);return l.Merge.extendRange(E),E}var i=e.sPlusPlus,D=(e.ZSClass,e.ZSEvents),E=D.topic,S=D.Groups,l=D.Names,o={add:function(e,D,o,r,I,n){r=t(e,D,o,r);var R=i.view.getActiveGridID(),c=i.view.getSheetState(R,D),I=0;c.addFill(r,I,n),E.publish(S.Selector.DomUpdate.FillSeries,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:D,VERSION:o,ActiveRange:r,RANGEID:I,TYPE:n})},modify:function(e,t,i,D,o,r){E.publish(S.Selector.DomUpdate.FillSeries,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveRange:o,RANGEID:D,TYPE:r})},remove:function(e,t,D,o){var r=i.view.getActiveGridID(),I=i.view.getSheetState(r,t);I.removeFill(),E.publish(S.Selector.DomUpdate.FillSeries,l.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:D,RANGEID:o})}};E.register(S.Selector.BoundUpdate.FillSeries,l.Selection.BOUND_UPDATE.ADD,o.add,"RID","SHEETID","VERSION","RANGE","RANGEID","TYPE"),E.register(S.Selector.BoundUpdate.FillSeries,l.Selection.BOUND_UPDATE.MODIFY,o.modify,"RID","SHEETID","VERSION","RANGEID","RANGE","TYPE"),E.register(S.Selector.BoundUpdate.FillSeries,l.Selection.BOUND_UPDATE.REMOVE,o.remove,"RID","SHEETID","VERSION","RANGEID")}(this);
!function(e){function t(e){return 0===e.startCol&&e.endCol===p-1}function i(e){return 0===e.startRow&&e.endRow===l-1}function E(e,t){if(e=e.cC?e.cC:e,e.hasOwnProperty("cC")&&!e.cC&&C.activeInfo.clearCopyRange(),e.a)switch(parseInt(e.a)){case u.SERVERCLIP_COPY_RANGE:A.COPY_RANGE(e,t);break;case u.SERVERCLIP_COPY_SHEET:A.COPY_SHEET(e,t);break;case u.SERVERCLIP_CUT_RANGE:A.CUT_RANGE(e,t)}e.pasteAction&&A.PASTE_RANGE(e,t)}var r,s=e.ZSEvents,n=s.topic,o=s.Groups,S=s.Names,D=e.sPlusPlus,c=e.ZSClass,a=(e.JSUtil,c.SelectorHelper.Constants),I=a.TYPE,R=D.data.Defaults,l=R.MAX_ROW,p=R.MAX_COL,C=D.data.UserInfo,a=c.SelectorHelper.Constants,u=e.ZSConstants.ActionConstants,A={COPY_SHEET:function(t){var i=D.view.getActiveGridID(),E=D.view.getResourceID(i),s=D.view.getSheetID(i),c=D.view.getVersionID(i),a=D.data.getWorkBook(E,c),I=(a.SheetList,t.stc[0]),R=t.fl,l=t.ccttl,p=t.sn,C=t.rid;r&&r(),r=function(){n.publish(o.Listener,S.ServerClip.SHEET.REMOVE,{RID:E,SHEETID:s,VERSION:c,SRC_SHEETID:I,SRC_SHEETNAME:p}),r=void 0},e.setTimeout(A._expireClip,1e3*l),n.publish(o.Listener,S.ServerClip.SHEET.ADD,{RID:E,SHEETID:s,VERSION:c,SRC_SHEETID:I,SRC_SHEETNAME:p,LANG:R,SRC_RID:C})},PASTE_RANGE:function(){var e=D.view.getActiveGridID(),t=D.view.getResourceID(e),i=D.view.getSheetID(e),E=D.view.getVersionID(e),s=(D.data.getWorkBook(t,E),C.activeInfo.getCopyState()),c=C.activeInfo.getCopyDetails();s||(c&&n.publish(o.Selector.BoundUpdate.Copy,S.Selection.BOUND_UPDATE.REMOVEDOM,{RID:t,SHEETID:i,VERSION:E}),r&&r())},COPY_RANGE:function(e,t){A._serverClipAction(e,r,"COPY",t)},CUT_RANGE:function(e,t){A._serverClipAction(e,r,"CUT",t)},_serverClipAction:function(t,i,E,s){var R,l=D.view.getActiveGridID(),p=D.view.getResourceID(l),u=D.view.getSheetID(l),v=D.view.getVersionID(l),T=(D.data.getWorkBook(p,v),C.activeInfo.getVisualCueStatus()),O=(C.activeInfo.isClipped(),"COPY"===E?1:0),_=t.inop,N=t.fl,d=t.ccttl,f=null!=t.sheetList?t.sheetList:[[asn]];if(null!=t.rangeList)R=t.rangeList;else{var g=t.rtc;g=new c.Range(g.sr,g.sc,g.er,g.ec),R=[[g]]}var U=I.RANGE,V=R[0],P=f[0];A._publishData(p,u,v,_,P,V),r&&r(),r=function(){n.publish(o.Selector.BoundUpdate.Copy,S.Selection.BOUND_UPDATE.REMOVEDATA,{RID:p,SHEETID:u,VERSION:v}),n.publish(o.Listener,S.ServerClip[E].REMOVE,{RID:p,SHEETID:u,VERSION:v,TYPE:U}),r=void 0},e.setTimeout(A._expireClip,1e3*d),A._publishData(p,u,v,_,P,V),t.rsid&&s!=t.rsid&&n.publish(o.Selector.BoundUpdate.Copy,S.Selection.BOUND_UPDATE.REMOVEDOM,{RID:p,SHEETID:u,VERSION:v}),T=s==t.rsid?T:a.CUESTATUS.HIDDEN,C.activeInfo.setVisualCueStatus(T),C.activeInfo.setCopyState(O),n.publish(o.Listener,S.ServerClip[E].ADD,{RID:p,SHEETID:u,VERSION:v,TYPE:U,LANG:N})},_predictInsertType:function(e,E){return t(E)?I.ROW:i(E)?I.COLUMN:t(E)&&i(E)?I.SHEET:I.RANGE},_publishData:function(e,t,i,E,r,s){n.publish(o.Selector.BoundUpdate.Copy,S.Selection.BOUND_UPDATE.REMOVEDATA,{RID:e,SHEETID:t,VERSION:i,IS_SERVER_CLIP:!0}),n.publish(o.Selector.BoundUpdate.Copy,S.Selection.BOUND_UPDATE.ADDDATA,{RID:e,SHEETID:t,VERSION:i,RANGES:s,SHEETS:r,IS_SERVER_CLIP:!0})},_expireClip:function(){var t=D.view.getActiveGridID(),i=D.view.getResourceID(t),E=D.view.getVersionID(t);if(r){var s=D.view.getSheetID(t);n.publish(o.Selector.BoundUpdate.Copy,S.Selection.BOUND_UPDATE.REMOVEDOM,{RID:i,SHEETID:s,VERSION:E}),r()}e.UserAction.expireClip(i,E,"expire")}};n.register(o.Listener,S.WMSAction.Response,E,"respObj","RSID"),n.register(o.Listener,S.ServerClip.META,E,"respObj")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,r=e.ZSEvents,a=r.topic,s=r.Groups,o=r.Names,d=new i.IDGenerator,n={add:function(e,r){if(r){var a=t.view.getActiveGridID(),s=t.view.getResourceID(a),o=t.view.getSheetID(a),g=t.view.getVersionID(a),D=t.data.getWorkBook(s,g),v=(D.getSheetObj(o),t.view.getActiveState(a)),I=v.getUserPresenceList(),c=v.getTabMap();if(r&&r.zuid&&r.rsid){var L=r.tabid?r.tabid:r.rsid;c.get(r.rsid)||c.set(r.rsid,L);var A=I.getRangeList(r.zuid,L),E=new i.Range(r.row,r.col,r.erow,r.ecol);if(A&&A.rangeArray&&A.rangeArray[0].isValid()&&A.rangeArray[0].equals(E))return;var S,R;if(void 0!=r.sheetName){if(A){var O=D.SheetList.getIdByName(r.sheetName);if(R=A&&A.rangeArray[0].id,S=new i.RangeList,S.ADD(E,R),O!=o)return n.removeranges(r),void n.updateData(r,S);n.updateData(r,S)}else R=d.get(),S=new i.RangeList,S.ADD(E,R),n.addData(s,g,e,r,S);n.addDOM(s,g,R,E,r)}}}},updateData:function(e,i){if(e){var r=t.view.getActiveGridID(),a=t.view.getActiveState(r),s=a.getUserPresenceList();i&&(e.ranges=i),s.updateUserObj(e)}},edit:function(e,r){if(r){var d=t.data.UserInfo.Permission.isEditable,g=t.view.getActiveGridID(),D=t.view.getResourceID(g),v=t.view.getSheetID(g),I=t.view.getVersionID(g),c=t.view.getActiveState(g),L=c.getUserPresenceList(),A=r.tabid?r.tabid:r.rsid,E=L.getObject(A,r.zuid),S=L.getRangeList(r.zuid,A),R=r.editstatus,O=new i.Range(r.row,r.col,r.erow,r.ecol),u=S&&S.rangeArray[0].id;if(R){if(d){var N=new i.RangeList;N.ADD(O,u),n.updateData(r,N),a.publish(s.Listener,o.DocAction.USER_LIST.EDITINFO,{RID:D,SHEETID:v,VERSION:I,SHEETNAME:r.sheetName,RANGEID:u,RANGE:O,COLOR:r.colorCode,UNAME:r.dname})}}else if(E&&E.editstatus){var N=new i.RangeList;N.ADD(O,u),n.updateData(r,N);var f;n.removeDOM(D,v,I,f,r,u),n.addDOM(D,I,u,O,r)}}},addData:function(e,i,r,a,s){if(a){var o={rsid:a.rsid,tabid:a.tabid,dname:a.dname,zuid:a.zuid},d=(t.data.getWorkBook(e,i),t.view.getActiveGridID()),n=t.view.getActiveState(d),g=n.getUserPresenceList();a.sheetName&&(o.sheetName=a.sheetName),s&&(o.ranges=s),a.colorCode&&(o.colorCode=a.colorCode),a.editstatus&&(o.editstatus=a.editstatus),g.handleUserAdd(r,o)}},addDOM:function(e,i,r,d,g){var D=t.data.UserInfo.Permission.isEditable,v=t.view.getActiveGridID(),I=t.view.getSheetID(v),c=t.data.getWorkBook(e,i),L=c.getSheetObj(I);g.zuid==t.data.UserInfo.zuid&&g.rsid!==WebMessanger.getRawSid()&&void 0!=g.sheetName&&D&&a.publish(s.Listener,o.DocAction.USER_LIST.ADDINFO,{RID:e,SHEETID:I,VERSION:i,SHEETNAME:g.sheetName,RANGEID:r,RANGE:d,COLOR:g.colorCode,UNAME:g.dname}),g.zuid!=t.data.UserInfo.zuid&&void 0!=g.sheetName&&(g.sheetName===L.Prop.Name&&D&&a.publish(s.Listener,o.DocAction.USER_LIST.ADDINFO,{RID:e,SHEETID:I,VERSION:i,SHEETNAME:g.sheetName,RANGEID:r,RANGE:d,COLOR:g.colorCode,UNAME:g.dname}),D&&n.addULDOM(e,i,g,d))},addULDOM:function(e,i,r,d,n){var g=t.data.getWorkBook(e,i),D=t.view.getActiveGridID(),v=t.view.getSheetID(D),I=g.getSheetObj(v),c=r.sheetName?r.sheetName:I.Prop.Name,L=d.id;a.publish(s.Listener,o.DocAction.USER_LIST.ADD,{RID:e,SHEETID:v,VERSION:i,SHEETNAME:c,RANGEID:L,rsid:r.rsid,RANGE:d,UNAME:r.dname,USERID:r.zuid,COLOR:n?n:r.colorCode})},removeDOM:function(e,i,r,d,n,g){if(n){for(var D,v=n.rsid?n.rsid:n.rsid,I=(t.data.getWorkBook(e,r),t.view.getActiveGridID()),c=t.view.getActiveState(I),L=c.getUserPresenceList(),A=L.getList(),E=0;A&&E<A.length;E++)(A[E].rsid==v||A[E].rsid==v)&&(D=A[E].zuid);D&&a.publish(s.Listener,o.DocAction.USER_LIST.REMOVE,{RID:e,VERSION:r,USERID:D,rsid:v,RANGEID:g,SHEETID:i})}},removeranges:function(e){if(e){var i,r,d=t.view.getActiveGridID(),g=t.view.getResourceID(d),D=t.view.getVersionID(d),v=t.data.getWorkBook(g,D),I=t.view.getActiveState(d),c=I.getUserPresenceList(),L=c.getList(),A=e.tabid?e.tabid:e.rsid;if(e.rsid){var E=c.getUserId(A),L=c.getObject(A,E);L&&L.sheetName&&L.rsid==e.rsid&&(i=L.sheetName),r=e.rsid;var S=c.getRangeList(E,A)}else{var E=e.zuid,S=c.getRangeList(E,A);i=e.sheetName,r=e.rsid}if(i){for(var v=t.data.getWorkBook(g,D),R=v.SheetList.getIdByName(i),O=0;S&&O<S.rangeArray.length;O++){var u=S.rangeArray[O].id;a.publish(s.Listener,o.DocAction.USER_LIST.REMOVEINFO,{RID:g,SHEETID:R,SHEETNAME:R,VERSION:D,RANGEID:u})}n.removeDOM(g,R,D,t.data.DocRegistry[g].COLLAB_ID,e,u)}}},remove:function(e,i){if(i){{var r=t.view.getActiveGridID(),a=t.view.getResourceID(r),s=t.view.getVersionID(r);t.data.getWorkBook(a,s)}e=e?e:t.data.DocRegistry[a].COLLAB_ID,n.removeranges(i),n.removeData(e,i)}},removeData:function(e,i){if(i){var r=t.view.getActiveGridID(),a=t.view.getResourceID(r),s=t.view.getVersionID(r),o=(t.data.getWorkBook(a,s),t.view.getActiveState(r)),d=o.getUserPresenceList(),n=i.tabid?i.tabid:i.rsid;d.handleUserRemove(e,n)}},hide:function(e,i,r){for(var a=t.data.getWorkBook(e,r),s=a.getSheetObj(i).Prop.Name,o=t.view.getActiveGridID(),d=t.view.getActiveState(o),g=d.getUserPresenceList(),D=g.getList(),v=0;D&&v<D.length;v++)D[v].sheetName==s&&n.removeranges(D[v])},show:function(e,i,r){for(var a=t.data.getWorkBook(e,r),s=a.getSheetObj(i).Prop.Name,o=t.view.getActiveGridID(),d=t.view.getActiveState(o),g=d.getUserPresenceList(),D=g.getList(),v=0;D&&v<D.length;v++)if(D[v].sheetName==s){var I=D[v].tabid?D[v].tabid:D[v].rsid,c=g.getRangeList(D[v].zuid,I),L=c.rangeArray[0];n.addDOM(e,r,L.id,L,D[v])}},refreshUserInfo:function(i,r){var a=t.view.getActiveGridID(),s=t.view.getSheetID(a);n.hide(i,s,r),e.UserAction.SyncCollabUser(i,r,"refresh")},updateUserInfo:function(e){{var i=t.view.getActiveGridID(),r=t.view.getActiveState(i),d=r.getUserPresenceList(),n=r.getTabMap();t.data.PageRegistry.RS_ID}if(n.getKeys().length){var g=[];for(var D in e){var v=n.get(e[D].rsid);v&&(g=g.concat(v))}for(var D in d.entries){var I=d.entries[D].getKeys();for(var c in I)-1==g.indexOf(I[c])&&a.publish(s.Listener,o.DocAction.COLLAB_LIST.REMOVEDATA,{LIST:d.getObject(I[c],D)})}}},removeUserInfo:function(e){var i=t.view.getActiveGridID(),r=t.view.getActiveState(i),d=r.getUserPresenceList(),n=(r.getTabMap(),e.tabid?e.tabid:e.rsid),g=d.getObject(n,e.zuid);a.publish(s.Listener,o.DocAction.COLLAB_LIST.REMOVEDATA,{LIST:g})}};a.register(s.Listener,o.GridAction.RELOAD,n.refreshUserInfo,"RID","VERSION"),a.register(s.Listener,o.DocAction.COLLAB_LIST.ADD,n.add,"CHID","LIST"),a.register(s.Listener,o.DocAction.COLLAB_LIST.EDIT,n.edit,"CHID","LIST"),a.register(s.Listener,o.DocAction.COLLAB_LIST.ADDULDOM,n.addULDOM,"RID","VERSION","LIST","RANGE","COLOR"),a.register(s.Listener,o.DocAction.COLLAB_LIST.REMOVERANGE,n.removeranges,"LIST"),a.register(s.Listener,o.DocAction.COLLAB_LIST.HIDE,n.hide,"RID","SHEETID","VERSION"),a.register(s.Listener,o.DocAction.COLLAB_LIST.SHOW,n.show,"RID","SHEETID","VERSION"),a.register(s.Listener,o.DocAction.COLLAB_LIST.REMOVEDATA,n.remove,"CHID","LIST","VERSION"),a.register(s.Listener,o.DocAction.COLLAB_LIST.ONLOAD,n.updateUserInfo,"LIST","RID"),a.register(s.Listener,o.DocAction.COLLAB_LIST.REMOVEUSERINFO,n.removeUserInfo,"meta")}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,r=a.topic,i=a.Groups,o=a.Names,n=new ZSClass.IDGenerator,D={add:function(e,a,r,i,o,n,E,v){var S=t.data.getWorkBook(e,r),d=S.getSheetObj(a),c=d.Pivot;for(var I in i){var s=i[I];if(c.isIntersecting(s)&&!E)return}D.addData(e,o,r,i,n,E,v),D.addDOM(e,a,r)},addData:function(e,t,a,r,i,o,D){n.flush();var v=[];for(var S in r){var d=r[S],c=n.get();d.id=c,v.push(d)}E.addDetails(e,t,a,v,i,o,D)},addDOM:function(e,t,a){var n={RID:e,SHEETID:t,VERSION:a},D=E.ranges();for(var v in D){var S=D[v];n.ActiveRange=S,n.RANGEID=S.id,r.publish(i.Selector.DomUpdate.Copy,o.Selection.BOUND_UPDATE.ADD,n)}},remove:function(e,t,a){D.removeDOM(e,t,a),D.removeData(e,t,a)},removeData:function(){E.clearDetails()},removeDOM:function(e,t,a){var n=E.ranges();for(var D in n){var v=n[D];r.publish(i.Selector.DomUpdate.Copy,o.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:a,RANGEID:v.id})}}},E={};E.ranges=function(){var e=t.view.getActiveGridID(),a=t.view.getActiveState(e),r=a.getFormatPainterRange();return r.Ranges},E.addDetails=function(e,a,r,i,o,n,D){var E=t.view.getActiveGridID(),v=t.view.getActiveState(E);v.addFormatPainterRange(e,a,r,i,o,n,D)},E.clearDetails=function(){var e=t.view.getActiveGridID(),a=t.view.getActiveState(e);a.clearFormatPainter()},r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.ADD,D.add,"RID","SHEETID","VERSION","RANGES","SHEETS","IS_SERVER_CLIP","IS_COPY","Category"),r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.REMOVE,D.remove,"RID","SHEETID","VERSION"),r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.REMOVEDOM,D.removeDOM,"RID","SHEETID","VERSION"),r.register(i.Selector.BoundUpdate.FormatPainter,o.Selection.BOUND_UPDATE.ADDDOM,D.addDOM,"RID","SHEETID","VERSION","TYPE","IS_SERVER_CLIP","RANGE")}(this);
!function(e){function t(e,t,s){r.publish(E.Listener,S.GridAction.RELOAD,{RID:e,SHEETID:t,VERSION:s}),UserAction.UpdateViewport(e,t,s),r.publish(E.Listener,S.SheetMeta.GRIDVIEW,{RID:e,SHEETID:t,VERSION:s}),i.data.syncCellRequestSent=!1}function s(t,s,i){e.UserAction.syncCellStyle(t,s,i)}var i=e.sPlusPlus,n=(e.ZSConstants.URI,i.SML.Client.Utility.WorkerRequest,e.ZSEvents),r=(e.ZSClass,n.topic),E=n.Groups,S=n.Names;r.register(E.Listener,S.Parser.SHEET.ONAFTER,s,"RID","SHEETID","VERSION"),r.register(E.Listener,S.GridAction.REFRESH,t,"RID","SHEETID","VERSION")}(this);
!function(e){function t(e,t,s){var S={RID:e,SHEETID:t,VERSION:s};n.data.syncCellRequestSent=!0;var u=new l;u.open(a.SYNC_STYLE),u.send(S)}function s(e,s,a){n.data.syncStyleRequired&&(!n.data.syncCellRequestSent&&t(e,s,a),n.data.syncStyleRequired=!1)}{var n=e.sPlusPlus,a=e.ZSConstants.URI,l=n.SML.Client.Utility.WorkerRequest,S=e.ZSEvents;e.ZSClass,S.topic,S.Groups,S.Names}n.data.syncCellRequestSent=!1,e.UserAction.syncCellStyle=s}(this);
!function(t){function e(t,e){this.parent=t,this.inputToSelect=e.inputToSelect,this.cssClass=e.cssClass}function s(){this.inputToSelect&&JSUtil.fn.selectDivText(this.inputToSelect),document.execCommand("copy"),this.copy.classList.add("sucState"),this.copy.innerText="Copied";var t=this.copy;setTimeout(function(){t.classList.remove("sucState"),t.innerText="Copy",window.getSelection().removeAllRanges()},1e3)}var i,n=t.ZSClass;e.prototype={createElement:function(){i=document.createElement("span"),i.innerText="Copy",i.setAttribute("id","copyURL"),i.addEventListener("click",s.bind(this)),i.classList.add(this.cssClass),this.copy=i,this.parent.appendChild(i)}},n.CopyToClipboard=e}(this);
!function(e){function t(e){var t=r.view.getActiveGridID(),i=r.view.getVersionID(t);n.publish(E.Listener,S.ServerAction.PROCESSRESPONSE,{RESPONSE:e,VERSION:i})}function i(e){var i=r.view.getActiveGridID(),s=r.view.getResourceID(i),R=r.view.getVersionID(i),u=new r.SML.Client.Utility.WorkerRequest;return u.open(o.PROCESSRESPONSE),u.addEventListeners("onComplete",function(e){t(e)}),e.RESPONSE?void u.send({VERSION:R,RESPONSE:e.RESPONSE,RID:s}):void n.publish(E.Listener,S.DocMeta.TRIGGER_DOCUMENT_EXIT,{EXCEPTIONKEY:Error.Internal.Server,UPDATEDOCLIST:1,TITLE:"Alert.Title.DeleteSuccessful"})}{var r=e.sPlusPlus,s=e.ZSEvents,n=s.topic,E=s.Groups,S=s.Names,o=e.ZSConstants.URI,R=r.SML.Client;R.Utility.WorkerRequest}e.UserAction.processResponse=i}(this);
!function(e){function n(e,n,t){var E=new d,o={RID:e,SHEET_ID:n,VERSION:t,DEFERRED_KEYS:"DEFERRED_KEYS"};E.addEventListeners("onComplete",function(){}),E.addEventListeners("onError",function(e){r.publish(R.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(a.DEFERRED_FETCH_DATA),E.send(o)}function t(e,n,t){var E=new d,s=(o.data.getWorkBook(e,t),{RID:e,SHEET_ID:n,VERSION:t});E.addEventListeners("onComplete",function(){}),E.addEventListeners("onError",function(e){r.publish(R.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(a.DEFERRED_MENUTAB_DATA),E.send(s)}function E(e,n,t){var E=new d,s=(o.data.getWorkBook(e,t),{RID:e,SHEET_ID:n,VERSION:t});E.addEventListeners("onComplete",function(e){if(e){var n=e.response.result;o.data.AppRegistry.localeInfo=n}}),E.addEventListeners("onError",function(e){r.publish(R.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(a.DEFERRED_LOCLAE_INFO),E.send(s)}var o=e.sPlusPlus,s=e.ZSEvents,r=s.topic,R=s.Groups,i=s.Names,a=e.ZSConstants.URI,D=o.SML.Client,d=D.Utility.WorkerRequest;e.UserAction.DeferredFetchData=n,e.UserAction.DeferredMenutabData=t,e.UserAction.getDocLocaleInfo=E}(this);
!function(t){function n(t,n,e){var a=o.data.getWorkBook(t,n);if(a&&a.CollaborationMode){var S={RID:t,VERSION:n,subAction:e},E=new c;E.addEventListeners("onComplete",function(t){if(t){{var n=t[C.GET_WMS_USERS];t[C.UPDATE_COLLABORATOR_COLORS]}s.publish(i.Listener,r.CollabAction.SYNCCOLLABUSER,{META:n}),s.publish(i.Listener,r.DocAction.USER_INFO.STATE,{state:!0})}}),E.addEventListeners("onError",function(){}),E.open(l.SYNCCOLLABUSER),E.send(S)}}var o=t.sPlusPlus,e=t.ZSEvents,s=e.topic,i=e.Groups,r=e.Names,a=t.ZSConstants,S=o.SML.Client,c=S.Utility.WorkerRequest,l=a.URI,C=a.ActionConstants;UserAction.SyncCollabUser=n}(this);
!function(e){function n(e){var n=new l;t.data.UserInfo.ENC_LoginName=e.LoginName,n.addEventListeners("onBeforeSend",function(){s.publish(o.Listener,a.ServerAction.LOADINGVAR,{loadingVar:e})}),n.open(r.LOADINGVAR),n.send(e)}var t=e.sPlusPlus,i=e.ZSEvents,s=i.topic,o=i.Groups,a=i.Names,r=e.ZSConstants.URI,l=t.SML.Client.Utility.WorkerRequest;e.UserAction.loadInitialVariable=n}(this);
!function(e){function t(e,t,i){var o=l.data.getWorkBook(e,i),a=o.getSheetObj(t),n=l.view.getActiveGridID(),s=l.view.getSheetState(n,t),g=s.getActiveRow(),R=s.getActiveCol(),S=a.Merge.isXists(g,R);R=S?S.root.startCol:R,R=a.Column.hidden.prevNonHidden(R),0>R&&(R=0),r(e,t,i,g,R)}function i(e,t,i){var o=l.data.getWorkBook(e,i),a=o.getSheetObj(t),n=l.view.getActiveGridID(),s=l.view.getSheetState(n,t),g=s.getActiveRow(),R=s.getActiveCol(),S=a.Merge.isXists(g,R);g=S?S.root.startRow:g,g=a.Row.Visibility.prevNonHidden(g),0>g&&(g=0),r(e,t,i,g,R)}function o(e,t,i){var o=l.data.getWorkBook(e,i),a=o.getSheetObj(t),n=l.view.getActiveGridID(),s=l.view.getSheetState(n,t),g=s.getActiveRow(),R=s.getActiveCol(),S=a.Merge.isXists(g,R);R=S?S.root.endCol:R,R=a.Column.hidden.nextNonHidden(R),R>=c.MAX_COL&&(R=c.MAX_COL-1),r(e,t,i,g,R)}function a(e,t,i){var o=l.data.getWorkBook(e,i),a=o.getSheetObj(t),n=l.view.getActiveGridID(),s=l.view.getSheetState(n,t),g=s.getActiveRow(),R=s.getActiveCol(),S=a.Merge.isXists(g,R);return g=S?S.root.endRow:g,g=a.Row.Visibility.nextNonHidden(g),g>=c.MAX_ROW?void(g=c.MAX_ROW-1):void r(e,t,i,g,R)}function n(e,t,i,o){"checkbox"!=o&&g.publish(R.Listener,S.ERROR.SHOW,{ERRORMSG:o}),g.publish(R.Selector.BoundUpdate.CellEdit,S.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i}),g.publish(R.UserAction,S.KeyBoard.ForceQuit,{RID:e,SHEETID:t,VERSION:i})}function r(e,t,i,o,a){for(var r=new E(o,a,o,a),s=l.view.getActiveGridID(),c=l.view.getActiveState(s),v=c.getFormulaRanges(t),D=(l.view.getSheetState(s,t),l.view.CellEditor.getEditStatus()),A=l.data.getWorkBook(e,i),u=A.getSheetObj(t),O=u.ProtectedRanges.isXists(r.startRow,r.startCol),I=u.Pivot.isXists(r.startRow,r.startCol),h=u.CheckBoxRanges.isXists(r.startRow,r.startCol),w=0;v&&w<v.length;w++)g.publish(R.Selector.BoundUpdate.Formula,S.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i,RANGEID:v[w].id});if(d.ScrollCellIntoView(e,t,i,o,a),g.publish(R.Selector.BoundUpdate.Range,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:r}),g.publish(R.Selector.BoundUpdate.Cell,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:r,ROW:o,COL:a}),g.publish(R.Listener,S.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:r}),D&&(O||I||h)){var C=O?"ProtectedRange.alert.ProtectRangeMessage":I?"Error.Pivot.Table.Part.Change":"checkbox";n(e,t,i,C),D=!1}D&&g.publish(R.Selector.BoundUpdate.CellEdit,S.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:r})}var l=e.sPlusPlus,s=e.ZSEvents,g=s.topic,R=s.Groups,S=s.Names,c=l.data.Defaults,d=e.UserAction,v=e.ZSClass,E=v.Range,D=d.CellNavigation||(d.CellNavigation={});D.Left=t,D.Up=i,D.Right=o,D.Down=a,D.Move=r}(this);
!function(e){function t(e,t,i){var o=d.data.getWorkBook(e,i),n=o.getSheetObj(t),r=d.view.getActiveGridID(),a=d.view.getSheetState(r,t),R=a.getActiveRange(),g=a.getActiveRangeCount(),v=n.Merge.getInfo(R.startRow,R.startCol),w=v&&v.equals(R);if(1===g&&(w||R.startRow===R.endRow&&R.startCol===R.endCol))h(e,t,i);else{var C=s(n);l(e,t,i,C.ROW,C.COL,C.RANGE,"COL")}}function i(e,t,i){var o=d.data.getWorkBook(e,i),n=o.getSheetObj(t),r=d.view.getActiveGridID(),s=d.view.getSheetState(r,t),R=s.getActiveRange(),g=s.getActiveRangeCount(),v=n.Merge.getInfo(R.startRow,R.startCol),w=v&&v.equals(R);if(1===g&&(w||R.startRow===R.endRow&&R.startCol===R.endCol))u(e,t,i);else{var C=a(n);l(e,t,i,C.ROW,C.COL,C.RANGE,"ROW")}}function o(e,t,i){var o=d.data.getWorkBook(e,i),n=o.getSheetObj(t),r=d.view.getActiveGridID(),a=d.view.getSheetState(r,t),s=a.getActiveRange(),g=a.getActiveRangeCount(),v=n.Merge.getInfo(s.startRow,s.startCol),w=v&&v.equals(s);if(1===g&&(w||s.startRow===s.endRow&&s.startCol===s.endCol))I(e,t,i);else{var C=R(n);l(e,t,i,C.ROW,C.COL,C.RANGE,"COL")}}function n(e,t,i,o,n,a){var s=d.data.getWorkBook(e,i),R=s.getSheetObj(t),g=d.view.getActiveGridID(),v=d.view.getSheetState(g,t),w=v.getActiveRange(),C=v.getActiveRangeCount(),c=R.Merge.getInfo(w.startRow,w.startCol),S=c&&c.equals(w);if(1===C&&(S||w.startRow===w.endRow&&w.startCol===w.endCol))if(void 0!=o&&void 0!=n&&void 0!=a){var c=R.Merge.isXists(n,a);if(n=c?c.root.endRow:n,n=R.Row.Visibility.nextNonHidden(n),n>=A.MAX_ROW)return void(n=A.MAX_ROW-1);f(e,t,i,n,a,"ROW")}else N(e,t,i);else{var D=r(R);l(e,t,i,D.ROW,D.COL,D.RANGE,"ROW")}}function r(e){var t=d.view.getActiveGridID(),i=d.view.getSheetID(t),o=d.view.getSheetState(t,i),n=o.getActiveRow(),r=o.getActiveCol(),a=e.Merge.isXists(n,r);a&&(n=a.root.endRow),n=e.Row.Visibility.nextNonHidden(n);var s=o.getRanges(),R=o.getActiveRange(),g=R.id,l=0;for(var v in s){var w=s[v];R.intersects(w)&&(l=parseInt(v))}n>R.endRow&&(r=e.Column.hidden.nextNonHidden(r),n=s[l].startRow,r>R.endCol&&(s.length>1&&(l=l+1>=s.length?0:l+1),n=s[l].startRow,r=s[l].startCol,R=new E(n,r,s[l].endRow,s[l].endCol),g=s[l].id));var w=new E(R.startRow,R.startCol,R.endRow,R.endCol);return w.id=g,{ROW:n,COL:r,RANGE:w}}function a(e){var t=d.view.getActiveGridID(),i=d.view.getSheetID(t),o=d.view.getSheetState(t,i),n=o.getActiveRow(),r=o.getActiveCol(),a=e.Merge.isXists(n,r);a&&(n=a.root.startRow),n=e.Row.Visibility.prevNonHidden(n);var s=o.getRanges(),R=o.getActiveRange(),g=R.id,l=0;for(var v in s){var w=s[v];R.intersects(w)&&(l=parseInt(v))}n<R.startRow&&(r=e.Column.hidden.prevNonHidden(r),n=s[l].endRow,r<R.startCol&&(s.length>1&&(l=0>l-1?s.length-1:l-1),n=s[l].endRow,r=s[l].endCol,R=new E(s[l].startRow,s[l].startCol,n,r),g=s[l].id));var w=new E(R.startRow,R.startCol,R.endRow,R.endCol);return w.id=g,{ROW:n,COL:r,RANGE:w}}function s(e){var t=d.view.getActiveGridID(),i=d.view.getSheetID(t),o=d.view.getSheetState(t,i),n=o.getActiveRow(),r=o.getActiveCol(),a=e.Merge.isXists(n,r);a&&(r=a.root.startCol),r=e.Column.hidden.prevNonHidden(r);var s=o.getRanges(),R=o.getActiveRange(),g=R.id,l=0;for(var v in s){var w=s[v];R.intersects(w)&&(l=parseInt(v))}r<R.startCol&&(n=e.Row.Visibility.prevNonHidden(n),r=s[l].endCol,n<R.startRow&&(s.length>1&&(l=0>l-1?s.length-1:l-1),n=s[l].endRow,r=s[l].endCol,R=new E(s[l].startRow,s[l].startCol,n,r),g=s[l].id));var w=new E(R.startRow,R.startCol,R.endRow,R.endCol);return w.id=g,{ROW:n,COL:r,RANGE:w}}function R(e){var t=d.view.getActiveGridID(),i=d.view.getSheetID(t),o=d.view.getSheetState(t,i),n=o.getActiveRow(),r=o.getActiveCol(),a=e.Merge.isXists(n,r);a&&(r=a.root.endCol),r=e.Column.hidden.nextNonHidden(r);var s=o.getRanges(),R=o.getActiveRange(),g=R.id,l=0;for(var v in s){var w=s[v];R.intersects(w)&&(l=parseInt(v))}r>R.endCol&&(n=e.Row.Visibility.nextNonHidden(n),r=s[l].startCol,n>R.endRow&&(s.length>1&&(l=l+1>=s.length?0:l+1),n=s[l].startRow,r=s[l].startCol,R=new E(n,r,s[l].endRow,s[l].endCol),g=s[l].id));var w=new E(R.startRow,R.startCol,R.endRow,R.endCol);return w.id=g,{ROW:n,COL:r,RANGE:w}}function g(e,t,i,o){"checkbox"!=o&&w.publish(C.Listener,c.ERROR.SHOW,{ERRORMSG:o}),w.publish(C.Selector.BoundUpdate.CellEdit,c.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i}),w.publish(C.UserAction,c.KeyBoard.ForceQuit,{RID:e,SHEETID:t,VERSION:i})}function l(e,t,i,o,n,r,a){var s=new E(o,n,o,n),R=d.data.getWorkBook(e,i),l=R.getSheetObj(t),v=d.view.getActiveGridID(),t=d.view.getSheetID(v),A=(d.view.getSheetState(v,t),d.view.CellEditor.getEditStatus()),D=l.ProtectedRanges.isXists(r.startRow,r.startCol),O=l.CheckBoxRanges.isXists(r.startRow,r.startCol),h=l.Pivot.isXists(r.startRow,r.startCol);A&&(D||h||O)&&(msg=D?"ProtectedRange.alert.ProtectRangeMessage":"Error.Pivot.Table.Part.Change",g(e,t,i,msg),A=!1),w.publish(C.Listener,c.SheetAction.ADD_TILES.EXCEED_BOUNDARY,{RID:e,SHEET_ID:t,VERSION:i,ROW:o,COL:n,MODE:a}),S.ScrollCellIntoView(e,t,i,o,n),w.publish(C.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.MODIFY,{RID:e,SHEETID:t,VERSION:i,RANGE:r,RANGEID:r.id,MODE:!0}),w.publish(C.Selector.BoundUpdate.Cell,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:s,ROW:o,COL:n}),w.publish(C.Listener,c.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:s}),A&&w.publish(C.Selector.BoundUpdate.CellEdit,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:s})}var d=e.sPlusPlus,v=e.ZSEvents,w=v.topic,C=v.Groups,c=v.Names,S=e.UserAction,A=d.data.Defaults,D=e.ZSClass,E=D.Range,O=S.CellNavigation||(S.CellNavigation={}),h=O.Left,I=O.Right,u=O.Up,N=O.Down,f=O.Move;O.LeftWithinRange=t,O.UpWithinRange=i,O.RightWithinRange=o,O.DownWithinRange=n,O.MoveRangeTo=l}(this);
!function(t){function e(t){var e;for(var o in t){var n=t[o];e=e<n.endRow?e:n.endRow}return e}function o(t){var e;for(var o in t){var n=t[o];e=e>n.startRow?e:n.startRow}return e}function n(t){var e;for(var o in t){var n=t[o];e=e>n.endCol?e:n.endCol}return e}function r(t){var e;for(var o in t){var n=t[o];e=e<n.startCol?e:n.startCol}return e}function i(t,e){e.startCol=t.Column.hidden.prevNonHidden(e.startCol),-1===e.startCol&&(e.startCol=0)}function a(t,e){e.startRow=t.Row.Visibility.prevNonHidden(e.startRow),-1===e.startRow&&(e.startRow=0)}function d(t,e){e.endCol=t.Column.hidden.nextNonHidden(e.endCol),e.endCol===p.MAX_COL&&(e.endCol=p.MAX_COL-1)}function l(t,e){e.endRow=t.Row.Visibility.nextNonHidden(e.endRow),e.endRow===p.MAX_ROW&&(e.endRow=p.MAX_ROW-1)}function s(t,e){e.startCol=t.Column.hidden.nextNonHidden(e.startCol);var o=t.Merge.getIntersectedRangesNotSubset(e);o.length&&(e.startCol=t.Column.hidden.nextNonHidden(n(o)))}function w(t,o){o.startRow=t.Row.Visibility.nextNonHidden(o.startRow);var n=t.Merge.getIntersectedRangesNotSubset(o);n.length&&(o.startRow=t.Row.Visibility.nextNonHidden(e(n)))}function R(t,e){e.endCol=t.Column.hidden.prevNonHidden(e.endCol);var o=t.Merge.getIntersectedRangesNotSubset(e);o.length&&(e.endCol=t.Column.hidden.prevNonHidden(r(o)))}function C(t,e){e.endRow=t.Row.Visibility.prevNonHidden(e.endRow);var n=t.Merge.getIntersectedRangesNotSubset(e);n.length&&(e.endRow=t.Row.Visibility.prevNonHidden(o(n)))}function v(t,e,o,n,r){N.publish(h.Selector.BoundUpdate.Range,b.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:e,VERSION:o,RANGE:r})}function g(t,e,o){var n=f.data.getWorkBook(t,o),r=n.getSheetObj(e),a=f.view.getActiveGridID(),d=f.view.getSheetState(a,e),l=d.getActiveRange(),s=d.getActiveRow(),w=d.getActiveCol(),C=new D(l.startRow,l.startCol,l.endRow,l.endCol),g=l.startCol<w||l.endCol===w;g?i(r,C):R(r,C),(w<C.startCol||w>C.endCol)&&(C=new D(l.startRow,l.startCol,l.endRow,l.endCol),i(r,C)),v(t,e,o,r,C,s,w),I.ScrollColIntoView(t,e,o,g?C.startCol:C.endCol)}function c(t,e,o){var n=f.data.getWorkBook(t,o),r=n.getSheetObj(e),i=f.view.getActiveGridID(),d=f.view.getSheetState(i,e),l=d.getActiveRange(),s=d.getActiveRow(),w=d.getActiveCol(),R=new D(l.startRow,l.startCol,l.endRow,l.endCol),g=l.startRow<s||l.endRow===s;g?a(r,R):C(r,R),(s<R.startRow||s>R.endRow)&&(R=new D(l.startRow,l.startCol,l.endRow,l.endCol),a(r,R)),v(t,e,o,r,R,s,w),I.ScrollRowIntoView(t,e,o,g?R.startRow:R.endRow)}function u(t,e,o){var n=f.data.getWorkBook(t,o),r=n.getSheetObj(e),i=f.view.getActiveGridID(),a=f.view.getSheetState(i,e),l=a.getActiveRange(),w=a.getActiveRow(),R=a.getActiveCol(),C=new D(l.startRow,l.startCol,l.endRow,l.endCol),g=r.Merge.isXists(w,R);g&&(R=g.root.startCol);var c=l.startCol<R||l.startCol!==R;c?s(r,C):d(r,C),(R<C.startCol||R>C.endCol)&&(C=new D(l.startRow,l.startCol,l.endRow,l.endCol),d(r,C)),v(t,e,o,r,C,w,R),I.ScrollColIntoView(t,e,o,c?C.startCol:C.endCol)}function S(t,e,o){var n=f.data.getWorkBook(t,o),r=n.getSheetObj(e),i=f.view.getActiveGridID(),a=f.view.getSheetState(i,e),d=a.getActiveRange(),s=a.getActiveRow(),R=a.getActiveCol(),C=new D(d.startRow,d.startCol,d.endRow,d.endCol),g=r.Merge.isXists(s,R);g&&(s=g.root.startRow);var c=d.startRow<s||d.startRow!==s;c?w(r,C):l(r,C),(s<C.startRow||s>C.endRow)&&(C=new D(d.startRow,d.startCol,d.endRow,d.endCol),l(r,C)),v(t,e,o,r,C,s,R),I.ScrollRowIntoView(t,e,o,c?C.startRow:C.endRow)}var f=t.sPlusPlus,A=t.ZSEvents,N=A.topic,h=A.Groups,b=A.Names,I=t.UserAction,H=t.ZSClass,D=H.Range,p=f.data.Defaults,V=I.CellNavigation||(I.CellNavigation={});V.SelectionLeft=g,V.SelectionUp=c,V.SelectionRight=u,V.SelectionDown=S}(this);
!function(e){function t(e,t,i,o,s){var a=e.Row.axis.findAbs(t),l=e.Column.axis.findAbs(i),n=e.Row.axis.findAbs(t+o),r=e.Column.axis.findAbs(t+s);return new R(a,l,n,r)}function i(e,i,o){var l=a.data.getWorkBook(e,o),n=l.getSheetObj(i),r=a.view.getActiveGridID(),g=a.view.getSheetState(r,i),c=g.getScrollTops()[0],w=g.getActiveCellRange(),v=n.Row.auxiliaryAxis.getPos(w.startRow),A=c-v;S.ScrollPage(e,i,o,!0);var d=a.view.getSheetState(r,i),D=d.getScrollTops()[0]-A,u=n.Row.axis.findAbs(D),E=w.startCol,h=new R(u,E,u,E),p=t(n,d.getScrollTops()[0],d.getScrollLefts()[0],g.getScreenHeights()[0],g.getScreenWidths()[0]+g.getScreenWidths()[1]);p.intersects(h)||(h.endRow=h.startRow=p.startRow),s(e,i,o,h)}function o(e,i,o){var l=a.data.getWorkBook(e,o),n=l.getSheetObj(i),r=a.view.getActiveGridID(),g=a.view.getSheetState(r,i),c=g.getScrollTops()[0],w=g.getActiveCellRange(),v=n.Row.auxiliaryAxis.getPos(w.startRow),A=v-c;S.ScrollPage(e,i,o,!1);var d=a.view.getSheetState(r,i),D=d.getScrollTops()[0]+A,u=n.Row.axis.findAbs(D),E=w.startCol,h=new R(u,E,u,E),p=t(n,d.getScrollTops()[0],d.getScrollLefts()[0],g.getScreenHeights()[0],g.getScreenWidths()[0]+g.getScreenWidths()[1]);p.intersects(h)||(h.endRow=h.startRow=p.startRow+1),s(e,i,o,h)}function s(e,t,i,o){n.publish(r.Selector.BoundUpdate.Range,g.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:o,TYPE:0}),n.publish(r.Selector.BoundUpdate.Cell,g.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:o,ROW:o.startRow,COL:o.startCol,TYPE:0}),n.publish(r.Listener,g.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:o})}var a=e.sPlusPlus,l=e.ZSEvents,n=l.topic,r=l.Groups,g=l.Names,S=e.UserAction,c=e.ZSClass,R=c.Range,w=S.CellNavigation||(S.CellNavigation={});w.pageNavigateSelectionDown=o,w.pageNavigateSelectionUp=i}(this);
!function(e){function t(e,t,n,o,v){var l=new V(o,v,o,v);G.ScrollCellIntoView(e,t,n,o,v),I.publish(N.Selector.BoundUpdate.Cell,E.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:n,ActiveCellRange:l,ROW:o,COL:v}),i(e,t,n,l),I.publish(N.Listener,E.Selection.BOUND_UPDATE.UPDATE_ASSISTOR,{RID:e,SHEETID:t,VERSION:n,ActiveCellRange:l})}function i(e,t,i,n){I.publish(N.Selector.BoundUpdate.Range,E.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:n})}function n(e,i,n,o){var v=h.view.getActiveGridID(),l=h.view.getSheetState(v,i),c=l.getActiveRow(),g=l.getActiveCol(),a=h.view.getSelectedSheets(v);G.CtrlNavigate(e,a,n,c,g,o,function(e,i,n,o,v){t(e,i,n,o,v,"COL")})}function o(e,t,i){n(e,t,i,1)}function v(e,t,i){n(e,t,i,2)}function l(e,t,i){n(e,t,i,3)}function c(e,t,i){n(e,t,i,4)}function g(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveRow(),g=h.view.getSelectedSheets(o);G.CtrlNavigate(e,g,n,c,l.startCol,4,function(e,t,n,o,v){l=new V(l.startRow,v,l.endRow,l.endCol),i(e,t,n,l),G.ScrollColIntoView(e,t,n,v)})}function a(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveRow(),g=h.view.getSelectedSheets(o);G.CtrlNavigate(e,g,n,c,l.endCol,3,function(e,t,n,o,v){l=new V(l.startRow,l.startCol,l.endRow,v),i(e,t,n,l),G.ScrollColIntoView(e,t,n,v)})}function w(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveCol(),g=h.view.getSelectedSheets(o);G.CtrlNavigate(e,g,n,l.startRow,c,2,function(e,t,n,o){l=new V(o,l.startCol,l.endRow,l.endCol),i(e,t,n,l),G.ScrollRowIntoView(e,t,n,o)})}function r(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveCol(),g=h.view.getSelectedSheets(o);G.CtrlNavigate(e,g,n,l.endRow,c,1,function(e,t,n,o){l=new V(l.startRow,l.startCol,o,l.endCol),i(e,t,n,l),G.ScrollRowIntoView(e,t,n,o)})}function S(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveRow(),g=v.getActiveCol(),a=h.view.getSelectedSheets(o);G.CtrlNavigate(e,a,n,c,l.startCol,3,function(e,t,n,o,v){v=v>g?g:v,l=new V(l.startRow,v,l.endRow,l.endCol),i(e,t,n,l),G.ScrollColIntoView(e,t,n,v)})}function R(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveRow(),g=v.getActiveCol(),a=h.view.getSelectedSheets(o);G.CtrlNavigate(e,a,n,c,l.endCol,4,function(e,t,n,o,v){v=g>v?g:v,l=new V(l.startRow,l.startCol,l.endRow,v),i(e,t,n,l),G.ScrollColIntoView(e,t,n,v)})}function C(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveRow(),g=v.getActiveCol(),a=h.view.getSelectedSheets(o);G.CtrlNavigate(e,a,n,l.startRow,g,1,function(e,t,n,o){o=o>c?c:o,l=new V(o,l.startCol,l.endRow,l.endCol),i(e,t,n,l),G.ScrollRowIntoView(e,t,n,o)})}function A(e,t,n){var o=h.view.getActiveGridID(),v=h.view.getSheetState(o,t),l=v.getActiveRange(),c=v.getActiveRow(),g=v.getActiveCol(),a=h.view.getSelectedSheets(o);G.CtrlNavigate(e,a,n,l.endRow,g,2,function(e,t,n,o){o=c>o?c:o,l=new V(l.startRow,l.startCol,o,l.endCol),i(e,t,n,l),G.ScrollRowIntoView(e,t,n,o)})}function d(e,t,i){var n=h.view.getActiveGridID(),o=h.view.getSheetState(n,t),v=o.getActiveRange(),l=o.getActiveCellRange();v.endCol===l.endCol?g(e,t,i):R(e,t,i)}function s(e,t,i){var n=h.view.getActiveGridID(),o=h.view.getSheetState(n,t),v=o.getActiveRange(),l=o.getActiveCellRange();v.startCol===l.startCol?a(e,t,i):S(e,t,i)}function u(e,t,i){var n=h.view.getActiveGridID(),o=h.view.getSheetState(n,t),v=o.getActiveRange(),l=o.getActiveCellRange();v.endRow===l.endRow?w(e,t,i):A(e,t,i)}function f(e,t,i){var n=h.view.getActiveGridID(),o=h.view.getSheetState(n,t),v=o.getActiveRange(),l=o.getActiveCellRange();v.startRow===l.startRow?r(e,t,i):C(e,t,i)}var h=e.sPlusPlus,D=e.ZSEvents,I=D.topic,N=D.Groups,E=D.Names,G=e.UserAction,U=e.ZSClass,V=U.Range,O=G.CellNavigation||(G.CellNavigation={});O.CtrlLeft=c,O.CtrlRight=l,O.CtrlDown=o,O.CtrlUp=v,O.CtrlShiftLeft=d,O.CtrlShiftRight=s,O.CtrlShiftUp=u,O.CtrlShiftDown=f}(this);
!function(e){function t(e,t,i,o){var n=o.startRow,s=o.startCol,c=a.view.getActiveGridID(),v=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","hasLink"],S=function(a){l(e,t,i,n,s,o,a[n][s])},g=function(e){r.log("Couldn't retrieve content of cell<<<<",e)};a.view.fetchCellData(e,t,i,n,s,v,c,S,g)}function l(e,t,l,i,o,r,n){var S=a.data.getWorkBook(e,l),g=S.getSheetObj(t),C=g.ProtectedRanges,A=a.view.getActiveGridID(),D=a.view.getSheetState(A,t),u=D.getActiveRange(),E=C&&C.isIntersecting(u);n.isProtected=C&&!!C.isXists(i,o)||S.ProtectedSheets.isSheetLocked(t)||E;var R=g.Pivot;n.pivot=!!R.isXists(i,o);var I=n.Format||g.ColStyleNames.getStyle(r.startCol)||"Default";n.Format=I;var f=JSUtil.Object.clone(S.CellStyle.getStyleDef(I),!0);f=ZSClass.CellDecorator.getStyle(f,n),n.styleName=f,n.row=i,n.col=o,n.id=t,s.publish(c.Listener,v.SheetAction.ACTIVE_CELL.INFO,{RID:e,SHEETID:t,VERSION:l,ROW:i,COLUMN:o,VALUE:n})}function i(e,t,i,o,n){if(!o||!n)return void r.log("EMPTY DATA RESPONSE",o,n);for(var s=a.data.getWorkBook(e,i),c=(s.getSheetObj(t),a.view.getActiveGridID()),v=a.view.getSheetState(c,t),S=v.getActiveCellRange(),g=a.view.getActiveState(c),C=g.getFormulaState(),A=0;A<o.length;A++){var D=o[A],u=v.getActiveRow();if(u>=D[0]&&u<=D[0]+D[1]-1){for(var E=D[2],R=n[E],I=0;I<R.length;I++){var f=R[I];if(f){var O=v.getActiveCol();if(O>=f[0]&&O<=f[0]+f[1]-1){var T=f[2],p={ActualValue:T[0],DisplayValue:T[1],Formula:T[2],Format:s.CellStyle.getMappedKey(T[3]),CellComment:T[5],Hyperlink:T[6],CellType:T[7],Pattern:T[9]};!C&&l(e,t,i,u,O,S,p);break}}}break}}}function o(e,t,l,i,o,n){var S=a.view.getActiveGridID(),g=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],C=[],A=function(a){for(var r=i.startRow;r<=i.endRow;r++)for(var S=i.startCol;S<=i.endCol;S++)if(C.push(a[r][S]),C.length==i.getRowSpan()*i.getColSpan()){s.publish(c.Listener,v.CellAction.VALUE.COPY,{RID:e,SHEETID:t,VERSION:l,ROW:r,COLUMN:S,RANGE:i,VALUE:C,DATA:o,TYPE:n});break}},D=function(e){r.log("Couldn't retrieve content of cell<<<",e)};a.view.fetchRangeData(e,t,l,i,g,!0,S,A,D)}{var a=e.sPlusPlus,r=e.ZSDevTools.Logger,n=e.ZSEvents,s=n.topic,c=n.Groups,v=n.Names;e.ZSConstants.URI}s.register(c.Listener,v.CellAction.ADDCOPYINFO,o,"RID","SHEETID","VERSION","ActiveCellRange","DATA","DATATYPE"),s.register(c.Selector.DomUpdate.Cell,v.Selection.BOUND_UPDATE.ADD,t,"RID","SHEETID","VERSION","ActiveCellRange"),s.register(c.Listener,v.ServerAction.PROCESSTRIMCELLRESPONSE,i,"DOCID","SHEETID","VERSION","ROW_DATA","COLUMN_DATA")}(this);
!function(e){function i(e){return!!e.irc}function t(e){return"undefined"!=typeof e.cid}function n(e){if(!i(e)&&t(e)){var n=d.view.getActiveGridID(),s=d.view.getResourceID(n);d.data.DocRegistry[s].COLLAB_ID=e.cid}}function s(e,i,t,s){var o=new C;o.addEventListeners("onComplete",function(e){O.publish(l.Listener,D.CollabAction.JOIN_POST_SUCCESS,{state:!0,isTruncateViewPort:!0,isDataNeeded:!1}),e&&(e.IS_LOCKED&&O.publish(l.Listener,D.DocMeta.DOCUMENT_MODE,{isEditable:0,isSharable:0,Persistent:1}),e.IS_LOCKED&&O.publish(l.Listener,D.DocMeta.DOCUMENT_MODE_temp,{isEditable:0,isSharable:0,Persistent:1}),!e.IS_LOCKED&&n(e))}),o.addEventListeners("onError",function(e){O.publish(l.Listener,D.ERROR.SHOW,{ERRORMSG:e.mk})}),s.version=t,o.open(L.COLLAB_JOIN),o.send(s)}function o(e,i){r=void 0,a=void 0,i=void 0,c=void 0,u=void 0}var r,a,c,u,d=e.sPlusPlus,E=e.ZSEvents,O=E.topic,l=E.Groups,D=E.Names,C=d.SML.Client.Utility.WorkerRequest,L=e.ZSConstants.URI;O.register(l.Listener,D.DocAction.DOCUMENT.CLOSE,o,"RID","VERSION"),e.UserAction.JoinCollab=s}(this);
!function(e){function t(t,a,i,o,s,R,w){var c=(d.data.getWorkBook(t,i),o),o=n(t,a,i,o),w=w,g={RID:t,SHEETID:a,exactRange:c,RANGES:o,isPersist:!0,isTruncateViewPort:s,isDataNeeded:R?R:!0,VERSION:i,NetworkStatus:d.data.PageRegistry.NwkStatus,GRID_ID:w},h=new l;h.open(u.ViewPort),r=d.data.PageRegistry.NwkStatus?d.data.PageRegistry.NwkStatus:0,h.addEventListeners("onComplete",function(){!r&&d.data.PageRegistry.NwkStatus&&e.UserAction.DummyScroll(t,a,i),r=d.data.PageRegistry.NwkStatus}),h.send(g)}function n(e,t,n,o){return o=a(e,t,n,o),o=i(e,t,n,o)}function a(e,t,n,a){for(var i=[],o=d.data.getWorkBook(e,n),s=o.getSheetObj(t),r=s.Row.Visibility,u=0;u<a.length;u++){var w=a[u],l=w.startCol,c=w.endCol,h=r.nextHidden(w.startRow);if(h>=w.endRow)i.push(w);else{var S,f=w.startRow;do h=r.nextHidden(f),S=Math.min(h-1,w.endRow),i.push(new R.Range(f,l,S,c)),f=Math.min(r.nextNonHidden(S),w.endRow);while(S<w.endRow&&g>f)}}return i}function i(e,t,n,a){for(var i=[],o=d.data.getWorkBook(e,n),s=o.getSheetObj(t),r=s.Column.hidden,u=0;u<a.length;u++){var w=a[u],l=w.startRow,c=w.endRow,g=r.nextHidden(w.startCol);if(g>=w.endCol)i.push(w);else{var S,f=w.startCol;do g=r.nextHidden(f),S=Math.min(g-1,w.endCol),i.push(new R.Range(l,f,c,S)),f=r.nextNonHidden(S);while(S<w.endCol&&h>f)}}return i}function o(e,t,n,a,i){var n=d.view.getVersionID(i),o={RID:e,SHEETID:t,RANGES:a,isPersist:!1,isTruncateViewPort:!1,isDataNeeded:!0,GRID_ID:i,isCachedViewPort:!0,VERSION:n},s=new l;s.open(u.CachedViewPort),s.addEventListeners("onComplete",function(){}),s.addEventListeners("onTimeOut",function(){}),s.send(o)}function s(){var e=new l;e.open(u.REREGISTER_VIEWPORT),e.send({})}{var r,d=e.sPlusPlus,u=e.ZSConstants.URI,R=e.ZSClass,w=d.SML.Client,l=w.Utility.WorkerRequest,c=d.data.Defaults,g=c.MAX_ROW,h=c.MAX_COL;e.JSUtil}e.UserAction.reregisterViewPort=s,e.UserAction.prefetchData=t,e.UserAction.prefetchCacheData=o}(this);
!function(t){function e(e,r,o){i(e,r,o),n(e,r,o),t.UserAction.DummyScroll(e,r,o)}function i(t,e,i){var n=Math.max(u.innerHeight)-(o.Top.Height+o.Bottom.Height),r=Math.max(800,u.innerWidth)-(o.Left.Width+o.Right.Width);a.publish(h.Listener,c.Browser.ScreenViewport,{RID:t,SHEETID:e,VERSION:i,Height:n,Width:r})}function n(t,e,i){a.publish(h.Listener,c.Browser.ContentViewport,{RID:t,SHEETID:e,VERSION:i})}var r=t.sPlusPlus,o=r.view.measures,s=(r.data.Defaults,t.ZSEvents),a=s.topic,h=s.Groups,c=s.Names,u=t.window;t.UserAction.UpdateScreenViewPort=i,t.UserAction.UpdateContentViewport=n,t.UserAction.UpdateViewport=e}(this);
!function(e){function t(e,t,i){R.publish(g.UserAction,A.SheetAction.SCROLL_POSITION.DummyScroll,{RID:e,SHEETID:t,VERSION:i})}function i(t,i,o,n,S,r,c){R.publish(g.Listener,A.SheetMeta.SCROLL_POSITION1,{RID:t,SHEETID:i,VERSION:o,SCROLLLEFT:r,SCROLLTOP:c}),R.publish(g.Listener,A.SheetMeta.SCROLL_POSITION0,{RID:t,SHEETID:i,VERSION:o,SCROLLLEFT:n,SCROLLTOP:S}),e.UserAction.DummyScroll(t,i,o)}function o(e,t,i,o,n){var S=v.data.getWorkBook(e,i).getSheetObj(t),r=S.Row.FreezedCount,c=S.Column.FreezedCount;return r>o?c>n?"pane1":"pane2":c>n?"pane3":"pane0"}function n(e,t,i,o,n,S){R.publish(g.UserAction,A.SheetAction.SCROLL_POSITION["Relative"+o],{RID:e,SHEETID:t,VERSION:i,DistanceX:n,DistanceY:S})}function S(e,t,i,S,r){var c=l(e,t,i,r),a=s(e,t,i,S),I=o(e,t,i,S,r);n(e,t,i,I,c,a)}function r(e,t,i,S){var r=v.view.getActiveGridID(),c=v.view.getSheetState(r,t),s=c.getActiveRow(),a=l(e,t,i,S),I=o(e,t,i,s,S);n(e,t,i,I,a,0)}function c(e,t,i,S){var r=v.view.getActiveGridID(),c=v.view.getSheetState(r,t),l=c.getActiveCol(),a=s(e,t,i,S),I=o(e,t,i,S,l);n(e,t,i,I,0,a)}function l(e,t,i,o){var n=v.data.getWorkBook(e,i),S=n.getSheetObj(t),r=S.Column.FreezedCount,c=v.view.getActiveGridID(),l=v.view.getSheetState(c,t),s=l.getZoom(),a=l.getScrollLefts(),I=l.getScreenWidths(),u=(r>o?a[1]:a[0])/s,O=(r>o?I[1]:I[0])/s,R=0,g=S.Column.axis.findAbs(u),A=S.Column.axis.findAbs(u+O);return g>=o?R=(S.Column.axis.getPos(o)-u)*s:o>=A&&(R=(S.Column.axis.getPos(o+1)-u-O)*s),R}function s(e,t,i,o){var n=v.data.getWorkBook(e,i),S=n.getSheetObj(t),r=S.Row.FreezedCount,c=v.view.getActiveGridID(),l=v.view.getSheetState(c,t),s=l.getZoom(),a=l.getScrollTops(),I=l.getScreenHeights(),u=r>o?a[1]:a[0]/s,O=r>o?I[1]:I[0]/s,R=0,g=S.Row.auxiliaryAxis.findAbs(u),A=S.Row.auxiliaryAxis.findAbs(u+O);return g>=o?R=(S.Row.auxiliaryAxis.getPos(o)-u)*s:o>=A&&(R=(S.Row.auxiliaryAxis.getPos(o+1)-u-O)*s),R}function a(e,t,i,o,n,S,r){R.publish(g.UserAction,A.SheetAction.SCROLL_POSITION.ScrollIntoView,{RID:e,SHEETID:t,VERSION:i,X:o,Y:n,WIDTH:S,HEIGHT:r})}function I(e,t,i,o,n,S,r){null!=S&&null!=r&&R.publish(g.UserAction,A.SheetAction.SCROLL_POSITION.Relativepane1,{RID:e,SHEETID:t,VERSION:i,DistanceX:S,DistanceY:r}),R.publish(g.UserAction,A.SheetAction.SCROLL_POSITION.Relativepane0,{RID:e,SHEETID:t,VERSION:i,DistanceX:o,DistanceY:n})}function u(e,t,o,n){var S=v.view.getActiveGridID(),r=v.view.getSheetState(S,t),c=r.getScrollTops(),l=r.getScrollLefts(),s=c[0],a=r.getScreenHeights()[0],I=n?s-a:s+a;i(e,t,o,l[0],I,l[1],c[1])}{var O=e.ZSEvents,R=O.topic,g=O.Groups,A=O.Names,v=e.sPlusPlus;e.ZSDevTools.Logger,v.SML.Client}e.UserAction.DummyScroll=t,e.UserAction.ScrollTo=i,e.UserAction.ScrollCellIntoView=S,e.UserAction.ScrollColIntoView=r,e.UserAction.ScrollRowIntoView=c,e.UserAction.ScrollRelativeTo=I,e.UserAction.ScrollAreaIntoView=a,e.UserAction.ScrollPage=u}(this);
!function(e){function t(e,t,n){var a=r.data.getWorkBook(e,n),L=a.getSheetObj(t),u=L.Prop.getName(),R=new ZSClass.ParamGenerator([t],e,n),P=R.getSheets(),h={RID:e,sheetList:P,currentSheet:u,isCurrentVersion:void 0,isCloseVersionHistory:void 0,readCharts:!0,VERSION:n,affectedCharts:void 0},l=new E;l.addEventListeners("onComplete",function(r){for(var a in r[S.DOCUMENT_META]){var E=r[S.DOCUMENT_META][a];s(e,t,n),E[S.SERVERCLIP]&&i.publish(o.Listener,C.ServerClip.META,{respObj:E[S.SERVERCLIP]}),E[S.CHART_COPY_STYLE]&&i.publish(o.Listener,C.ServerClip.CHART.STYLE_CLIP,{STYLE_CLIP:E[S.CHART_COPY_STYLE]})}}),l.open(T.POST_DOC_LOAD),l.send(h)}function s(e,t,s){i.publish(o.Listener,C.SheetMeta.CACHEDVIEWPORT_EXT,{RID:e,SHEETID:t,VERSION:s})}var r=e.sPlusPlus,n=e.ZSEvents,i=n.topic,o=n.Groups,C=n.Names,a=r.SML.Client,E=a.Utility.WorkerRequest,S=e.ZSConstants.CommandConstants,T=e.ZSConstants.URI;e.UserAction.PostDataFetcher=t}(this);
!function(e){function t(e,s,r){var S,T=n.data.UserInfo.Transients.InsertSheetXAIdQ.getObj(e),d=n.data.UserInfo.Transients.InsertPivotSheetXAIdQ.getObj(e);r[E.ACTION_IDENTIFIER]&&(S=r[E.ACTION_IDENTIFIER][E.EXECUTED_ACTION_ID]),r[E.WORKSHEETS]&&(r=r[E.WORKSHEETS][E.INSERT_SHEETS]);var r=r[0];if(r){var u=(n.data.getWorkBook(e,s),n.view.getActiveGridID()),O=n.view.getSheetID(u),v=!1,h=0;d.has(S)&&(v=!0,d.deQueue(),h=d.length),T.has(S)&&(T.deQueue(),h=T.length),o.SwitchSheet(e,O,s,r[0][0],void 0,v),!h&&a.unregister(I.Listener,i.Parser.DOC.ONAFTER,t)}}function s(e,s,r,E){if(E){var o=n.data.UserInfo.Transients.InsertPivotSheetXAIdQ.getObj(e);o.enQueue(r)}else{var S=n.data.UserInfo.Transients.InsertSheetXAIdQ.getObj(e);S.enQueue(r)}a.register(I.Listener,i.Parser.DOC.ONAFTER,t,"RID","VERSION","data")}var n=e.sPlusPlus,r=e.ZSEvents,a=r.topic,I=r.Groups,i=r.Names,E=e.ZSConstants.CommandConstants,o=e.UserAction;a.register(I.Listener,i.DocMeta.SHEET_ACTION_LISTENER,s,"RID","VERSION","qaid","isPivotSheet")}(this);
!function(e){function r(r,t,i){var s=n.data.UserInfo.Transients.UndoRedo.getObj(r),o=s.UndoTransientAO,l=s.RedoTransientAO,S=o.hasOwnProperty(i),c=l.hasOwnProperty(i);if(S||c){if(S)for(var R in o)if(i<parseInt(R)&&delete o[R],i===parseInt(R)){var d=o[R];delete o[R];break}if(c)for(var R in l)if(i<parseInt(R)&&delete l[R],i===parseInt(R)){var d=l[R];delete l[R];break}var O=(new e.ZSClass.ParamGenerator,d.params.rangeList),E=d.params.sheetList,v=d.params.undoRedoOptions,D=v&&!!v.FOCUS_SOURCE;D&&d.params.srcRangeList&&(O=d.params.srcRangeList);var f=v&&!!v.STOPSELECTION;if(!f){var p=v&&v.allowRowScroll,A=v&&v.allowColScroll,U=d.params.activeCell,u=U.s,w=I.fn.getIndexOf(u,E),C=O[w];a(r,u,t,C,U,p,A)}}}function a(e,r,a,t,i,I,R){var d=i.r,O=i.c,E=n.view.getActiveGridID(),v=n.view.getSheetID(E);if(v!=r)c.SwitchSheet(e,v,a,r,D);else{s.publish(o.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADDRANGES,{RID:e,SHEETID:r,VERSION:a,RANGES:t,accumulate:1});var D=new S.Range(d,O,d,O);s.publish(o.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:r,VERSION:a,ActiveCellRange:D,ROW:d,COL:O}),I?c.ScrollRowIntoView(e,r,a,d):R?c.ScrollColIntoView(e,r,a,O):c.ScrollCellIntoView(e,r,a,d,O)}}function t(e){var r=n.data.UserInfo.Transients.UndoRedo.getObj(e),a=r.UndoTransientAO,t=r.RedoTransientAO;for(var i in a)delete a[i];for(var i in t)delete t[i]}var n=e.sPlusPlus,i=e.ZSEvents,s=i.topic,o=i.Groups,l=i.Names,S=e.ZSClass,I=e.JSUtil,c=e.UserAction;s.register(o.Listener,l.DocMeta.ACTION_IDENTIFIER,r,"RESOURCE_ID","VERSION","xaid"),s.register(o.Listener,l.GridAction.RELOAD,t,"RID","VERSION","XAID")}(this);
!function(E){function s(E){var s=E.getAction(),e=a.data.UserInfo.Transients.UndoRedo.getObj(E.getParams().RID);switch(s){case A.BOLD:case A.ITALIC:case A.UNDERLINE:case A.STRIKETHROUGH:case A.FONTFAMILY:case A.FONTSIZE:case A.ALIGN:case A.COLOR:case A.TEXTCOLOR:case A.WRAP:case A.HALIGN:case A.VALIGN:case A.FORMAT_DATE:case A.FORMAT_CURRENCY:case A.FORMAT_ACCOUNTING:case A.CLEARFORMATS:case A.FORMAT_COMMA:case A.FORMAT_PERCENT:case A.FORMAT_TEXT:case A.FORMAT_INCREMENT_DECIMAL:case A.FORMAT_DECREMENT_DECIMAL:case A.BORDERS:case A.CLEARCONTENTS:case A.CLEARSTYLES:case A.CLEARALL:case A.HYPERLINK:case A.HEIGHT:case A.WIDTH:case A.MERGE_SPLIT:case A.MERGE_RANGE:case A.MERGE_ACROSS:case A.MERGE_DOWN:case A.MERGE_AND_CENTER:case A.CHECKBOX_ADD:case A.CHECKBOX_EDIT:case A.CHECKBOX_CLEAR:e.setLastAction(E);case A.SUBMIT:case A.COPY_PASTE_CONTENT:case A.SYSTEMCLIP_PASTE:case A.CUT_PASTE:case A.COPY_PASTE:case A.COMPUTE_SUM:case A.COMPUTE_SUM_C:case A.PASTESPECIAL_FORMATS:case A.REPLACE:case A.REPLACE_ALL:case A.REPEAT_ACTION:case A.CREATE_FILTER:case A.REMOVE_FILTER:case A.APPLY_FILTER:case A.FILTER_BY_VALUE:case A.FILTER_BY_CELL_COLOR:case A.FILTER_BY_FONT_COLOR:case A.CONDITIONAL_FORMAT_APPLY:case A.CONDITIONAL_FORMAT_EDIT:case A.CONDITIONAL_FORMAT_DELETE:case A.COLOR_SCALES_APPLY:case A.CONDITIONAL_STYLE_REORDER:case A.CONDITIONAL_FORMAT_CLEAR_RULE:case A.ICON_SET_APPLY:case A.FORMATCELLS_GRID:case A.DATA_VALIDATION_APPLY:case A.DATA_VALIDATION_CLEAR:case A.CELL_COMMENT:case A.SORT:case A.INSERT_COPY_ROW:case A.INSERT_COPY_COLUMN:case A.INSERT_CUT_ROW:case A.INSERT_CUT_COLUMN:case A.INSERT_ROW:case A.INSERT_COL:case A.DELETE_ROW:case A.DELETE_COL:case A.FILLSERIES:case A.FILLSERIES_AUTO:case A.HIDE_GRID:case A.IMAGE_NEW:case A.IMAGE_MOVE:case A.IMAGE_CLONE:case A.IMAGE_RESIZE:case A.IMAGE_REMOVE:case A.IMAGE_CUT_PASTE:case A.IMAGE_REPLACE:case A.IMAGE_COPY_PASTE:case A.INSERT_CELL_LEFT:case A.INSERT_CELL_TOP:case A.DELETE_CELL_RIGHT:case A.DELETE_CELL_BOTTOM:case A.CHART_MOVE:case A.CHART_EDIT:case A.CHART_DELETE:case A.CHART_RESIZE:case A.CHART_QUICK_EDIT:case A.CHART_QUICK_STYLE:case A.CHART_PASTE_STYLE:case A.CHART_PUBLISH:case A.CHART_UNPUBLISH:case A.CHART_NEW:case A.CHART_MOVE_TO_NEW_SHEET:case A.DRAG_DROP:case A.SPARKLINE_CREATE:case A.SPARKLINE_UNGROUP:case A.SPARKLINE_GROUP:case A.SPARKLINE_REMOVE:case A.SPARKLINE_GROUP_REMOVE:case A.EDIT_SPARKLINE_DATA:case A.EDIT_SPARKLINE_GROUP_DATA:case A.CHANGE_SPARKLINE_ORIENTATION:case A.SPARKLINE_PROPERTIES:case A.HIDE_COLUMNS:case A.HIDE_ROWS:case A.UNHIDE_COLUMNS:case A.UNHIDE_ROWS:case A.CREATE_PIVOT:case A.EDIT_PIVOT:case A.APPLYFILTER_PIVOT:case A.MOVE_PIVOT:case A.COPY_PIVOT:case A.SORT_PIVOT:case A.CHANGE_PIVOT_SOURCE:case A.CHANGE_PIVOT_SUBTOTALOPTION:case A.CHANGE_PIVOT_GRANDTOTALROWOPTION:case A.CHANGE_PIVOT_GRANDTOTALCOLOPTION:case A.DELETE_PIVOT:case A.COUNT_EMPTY_CELLS:case A.GET_DATA_DUPLICATES:case A.DATA_CLEANSING_REPLACE_ALL:e.add(E),T.publish(_.Listener,c.DocAction.UNDO_REDO.ACTION),T.publish(_.Listener,c.DocAction.UNDO_REDO.COUNTS,{UNDO:e.isUndoPossible(),REDO:e.isRedoPossible(),REPEAT_ACTION:!!e.getLastAction()});break;case A.UNDO:e.undo(),T.publish(_.Listener,c.DocAction.UNDO_REDO.COUNTS,{UNDO:e.isUndoPossible(),REDO:e.isRedoPossible(),REPEAT_ACTION:!!e.getLastAction()});break;case A.REDO:e.redo(),T.publish(_.Listener,c.DocAction.UNDO_REDO.COUNTS,{UNDO:e.isUndoPossible(),REDO:e.isRedoPossible(),REPEAT_ACTION:!!e.getLastAction()});break;default:O.log("Not Registered UNDO REDO : ",E)}}{var e=E.ZSEvents,T=e.topic,_=e.Groups,c=e.Names,a=E.sPlusPlus,O=E.ZSDevTools.Logger,A=E.ZSConstants.ActionConstants;E.ZSClass.ActionObject}a.data.UserInfo.ActionRecorder=function(){return{record:s}}()}(this);
!function(e){function i(){var e=t.data.UserInfo.Permission,i=e.isEditable,s=e.isSharable,a=i?0:1;r.publish(n.Listener,l.DocMeta.DOCUMENT_MODE,{isEditable:i?1:0,isSharable:s?1:0,Persistent:a})}function s(){var e=t.data.UserInfo.Permission,i=e.isEditable?0:1;r.publish(n.Listener,l.DocMeta.DOCUMENT_MODE,{isEditable:0,isSharable:0,Persistent:i})}{var t=e.sPlusPlus,a=e.ZSEvents,r=a.topic,n=a.Groups,l=a.Names;t.SML.Client}e.UserAction.setDefaultPrivilege=s,e.UserAction.setDocPrivilege=i}(this);
!function(e){function t(t,i,a,s,o,v){var S=!0;if(void 0!=g&&s.length==g.length){S=!1;for(var f=0;f<g.length;f++){var l=g[f];if(!l.equals(s[f])){S=!0;break}}}e.clearTimeout(E),E=e.setTimeout(function(){var e=n(t,i,a,s);S&&(r(t,i,a,s,v,e),g=s)},200)}function r(e,t,r,n,i,a,s){var o=[t],v=new L.ParamGenerator(o,e,r,!0),g=v.getSheets(),n=n?v.getCustomRanges(n,!0):v.getRanges(),E=v.getActiveCell(),a=a?a:!1;if(E){var S={RID:e,sheetList:g,activeCell:E,isSingle:a,version:r,rangeList:n,Type:i},f=new c;f.addEventListeners("onComplete",function(e){s&&s(e.RESP),l.publish(u.Listener,A.SheetAction.ACTIVE_CELL_RANGE.STATUS,{STATUS:e.RESP})}),f.addEventListeners("onError",function(e){l.publish(u.Listener,A.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(D.CellRangeStatus),f.send(S)}}function n(e,t,r,n){var i=!1;if(1==n.length){var a=n[0],s=S.data.getWorkBook(e,r),o=s.getSheetObj(t),v=o.Merge.getInfo(a.startRow,a.startCol);(a.isSingle()||v&&v.equals(a))&&(i=!0)}return i}function i(e){var t=S.view.getActiveGridID();if(e[C.DOCUMENT_META])for(var i in e[C.DOCUMENT_META]){var s=e[C.DOCUMENT_META][i];if(s[C.SHEET_META])for(var v in s[C.SHEET_META])if(v===S.view.getSheetID(t)){var g=S.view.getSheetState(t,v),E=g.getRanges(),f=s[C.SHEET_META][v];if(f[C.CELL_META]){var l=f[C.CELL_META][C.META],u=f[C.CELL_META][C.FAULTY],A=S.view.getVersionID(t);if(l){var T=l[C.ROW_DATA],R=l[C.COLUMN_DATA];if(a(i,v,A,T,R)){var E=g.getRanges(),c=n(i,v,A,E);r(i,v,A,E,E.type,c);break}}else if(u){var D=u[C.RANGES];for(var L in D){var h=D[L];if(o(i,v,A,h)){r(i,v,A,E,E.type);break}}}}}}}function a(e,t,r,n,i){var a=S.view.getActiveGridID(),o=S.view.getSheetState(a,t),v=o.getRanges();if(!n||!i)return void T.log("2.EMPTY DATA RESPONSE",n,i);for(var g=0;g<v.length;g++){var E=v[g];if(s(e,t,r,n,i,E))return 1}return 0}function s(e,t,r,n,i,a){for(var s=n.length-1;s>=0;s--)for(var o=n[s],v=o[0]+o[1]-1,g=o[0],E=v;E>=g;E--)for(var S=i[o[2]],f=S.length-1;f>=0;f--){var l=S[f];if(l)for(var u=l[0]+l[1]-1,A=l[0],T=u;T>=A;T--){var R=new L.Range(E,T,E,T);if(a.intersects(R))return!0}}}function o(e,t,r,n){for(var i=new L.Range(n[0],n[1],n[2],n[3]),a=S.view.getActiveGridID(),s=S.view.getSheetState(a,t),o=s.getRanges(),v=0;v<o.length;v++){var n=o[v];if(n.intersects(i))return 1}return 0}function v(){g=null}var g,E,S=e.sPlusPlus,f=e.ZSEvents,l=f.topic,u=f.Groups,A=f.Names,T=e.ZSDevTools.Logger,R=S.SML.Client,c=R.Utility.WorkerRequest,C=e.ZSConstants.CommandConstants,D=e.ZSConstants.URI,L=e.ZSClass;l.register(u.Listener,A.DocAction.DOCUMENT.CLOSE,v),l.register(u.Selector.DomUpdate.Range,A.Selection.BOUND_UPDATE.ADD,t,"RID","SHEETID","VERSION","RANGES","RANGEID","TYPE"),e.UserAction.reEvaluateRangeStatus=i,e.UserAction.CellRangeStatus=r}(this);
!function(e){function s(){var e=new R;e.addEventListeners("onBeforeSend",function(){c.PageInfo.Collab(WebMessanger.getRawSid())}),e.open(d.COLLAB_INFO),e.send({RS_ID:WebMessanger.getRawSid()})}function i(i){s();var t=o.view.getActiveGridID(),a=o.view.getResourceID(t),r=o.view.getVersionID(t),n=o.view.getSheetID(t),S={SID:WebMessanger.getSid(),RS_ID:i,RID:a,SHEETID:n,VERSION:r};e.UserAction.JoinCollab(a,n,r,S)}var t=e.ZSEvents,a=t.topic,r=t.Groups,n=t.Names,o=e.sPlusPlus,S=e.ZSChart,l=e.ZSDevTools.Logger,E=o.SML.Client,R=E.Utility.WorkerRequest,d=e.ZSConstants.URI,c=o.data.api,D=(e.ZSConstants.I18N,e.ZSConstants.ActionConstants),h=(e.JSUtil,{processMessage:function(s,i,t,E,c){try{var b,O=e.ZSConstants.CommandConstants;try{b=JSON.parse(c)}catch(e){b=JSON.parse(c.decodeXSSSymbls())}if(b[O.IS_NEW_CLIENT_RESPONSE]){var I=new R;I.open(d.responseManager),I.send({method:"updateResponse",response:b}),e.UserAction.reEvaluateRangeStatus(b)}else if(b.a===e.ZSConstants.ActionConstants.REFRESH_COLLAB_DETAILS)if("init"===b.subaction){if(b.rsid==o.data.PageRegistry.UT_ID||b.rsid==o.data.PageRegistry.RS_ID)return void a.publish(r.Listener,n.DocAction.USER_INFO.ADD,{list:b.msg,RID:g})}else if("delete"===b.subaction)return void a.publish(r.Listener,n.DocAction.COLLAB_LIST.REMOVEUSERINFO,{meta:b.user});if(b[O.USER_ACTION_RESPONSE]){var g=o.view.getResourceID(_);a.publish(r.Listener,n.ServerAction.PROCESSRESPONSE,{RESPONSE:b[O.USER_ACTION_RESPONSE],RID:g,VERSION:A})}if(b.a==D.CHART_COPY_STYLE){var C=new S.Manager.ZSCCManager;C.processMessage(b)}if(b[O.BUILD_VERSION]&&b[O.BUILD_VERSION][O.VERSION_NUMBER]!=o.data.AppRegistry.buildVersion){var c="Server has been upgraded. Click 'Ok' to refresh.";a.publish(r.Listener,n.ServerAction.BUILD_UPDATE,{ERRORMSG:c})}if(b.DU)switch(b.a){case D.SHARE_PERMISSION_CHANGE:if(o.data.PageRegistry.wmsOptions.loginName===b.rec){var M=b.pmTo,L=b.pmFr,p={};if(2!=L&&1!=L||0!=M)if(2==L&&1==M)u="Share.dialog.COtoRW",p.isEditable=!0,p.isSharable=!1,a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE,{isEditable:1,isSharable:0,Persistent:0}),a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE_temp,{isEditable:1,isSharable:0,Persistent:1});else if(1==L&&2==M)u="Share.dialog.RWtoCO",p.isEditable=!0,p.isSharable=!0,a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE,{isEditable:1,isSharable:1,Persistent:0}),a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE_temp,{isEditable:1,isSharable:1,Persistent:1});else if(0==L&&2==M)u="Share.dialog.ROtoCO",p.isEditable=!0,p.isSharable=!0,a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE,{isEditable:1,isSharable:1,Persistent:0}),a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE_temp,{isEditable:1,isSharable:1,Persistent:1});else if(0==L&&1==M)u="Share.dialog.ROtoRW",p.isEditable=!0,p.isSharable=!1,a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE,{isEditable:1,isSharable:0,Persistent:0}),a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE_temp,{isEditable:1,isSharable:0,Persistent:1});else if(3==L&&0==M)u="Share.dialog.RCtoRO",p.isEditable=!1,p.isSharable=!1;else if(0==L&&3==M)u="Share.dialog.ROtoRC",p.isEditable=!1,p.isSharable=!1;else if(1!=L&&2!=L||3!=M)if(3==L&&1==M)u="Share.dialog.ROtoRW",p.isEditable=!0,p.isSharable=!1;else if(3==L&&2==M)u="Share.dialog.ROtoCO",p.isEditable=!0,p.isSharable=!0;else{var u="Share.dialog.PermissionChanged";p.isEditable=!0,p.isSharable=!1,a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE,{isEditable:1,isSharable:0,Persistent:0}),a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE_temp,{isEditable:1,isSharable:0,Persistent:1})}else u="Share.dialog.RW_COtoRC",p.isSharable=!1,p.isSharable=!1;else u="Share.dialog.CO_RWtoRO",p.isEditable=!1,p.isSharable=!1,a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE,{isEditable:0,isSharable:0,Persistent:1}),a.publish(r.Listener,n.DocMeta.DOCUMENT_MODE_temp,{isEditable:0,isSharable:0,Persistent:1});{var _=o.view.getActiveGridID(),g=o.view.getResourceID(_),A=o.view.getVersionID(_);o.data.getWorkBook(g,A)}o.data.UserInfo.Permission=p,a.publish(r.Listener,n.ERROR.SHOW,{ERRORMSG:u})}break;case D.SHOW_ERROR_MESSAGE:a.publish(r.Listener,n.ERROR.SHOW,{ERRORMSG:b.mk});break;case D.WAKE_UP_CALL:h.handleJoin(),a.publish(r.Listener,n.GridAction.VIEWPORT.REREGISTER,{isTruncateViewPort:!0,isDataNeeded:!1});break;case D.USER_PRESENCE_REMOVE:a.publish(r.Listener,n.DocAction.COLLAB_LIST.REMOVEDATA,{LIST:b});break;case D.REFRESH_COLLAB_DETAILS:a.publish(r.Listener,n.DocAction.COLLAB_LIST.ONLOAD,{LIST:b.msg,RID:g});break;case D.CHECKIN_CHECKOUT:break;case D.MACRO_CONTENT_CHANGED:b.utid!=sPlusPlus.data.PageRegistry.UT_ID&&b.utid!=sPlusPlus.data.PageRegistry.RS_ID&&a.publish(r.UserAction,n.UserAction.MACRO.MACRO_CONTENT_CHANGED,{moduleNames:b.mnA,actionOwner:b.ao});break;case D.CHAT_MSG:a.publish(r.Listener,n.DocAction.COLLAB_CHAT.ADD,{response:b,zuid:t})}else if(b.a&&b.a[D.USER_PRESENCE]){var v=String(b.a[D.USER_PRESENCE]).split(",");if(v[0]!=WebMessanger.getRawSid()){var N=v[9],T=parseInt(v[4]),U=parseInt(v[5]);"true"===N?(T=parseInt(v[2]),U=parseInt(v[3]),N=!0):N=!1;var P={rsid:v[0],sheetName:v[1],row:parseInt(v[2]),col:parseInt(v[3]),erow:T,ecol:U,dname:v[6],zuid:v[7],colorCode:v[8],editstatus:N,tabid:v[10]};a.publish(r.Listener,n.DocAction.COLLAB_LIST.ADD,{CHID:s,LIST:P}),a.publish(r.Listener,n.DocAction.COLLAB_LIST.EDIT,{CHID:s,LIST:P})}}else if(b.a&&b.a[D.COLLAB_USER_EDIT]){var v=String(b.a[D.COLLAB_USER_EDIT]).split(",");if(v[0]!=WebMessanger.getRawSid()){var N=v[9],T=parseInt(v[4]),U=parseInt(v[5]);"true"===N&&(T=parseInt(v[2]),U=parseInt(v[3]));var P={rsid:v[0],sheetName:v[1],row:parseInt(v[2]),col:parseInt(v[3]),erow:T,ecol:U,dname:v[6],zuid:v[7],colorCode:v[8],editstatus:!0,tabid:v[9]};a.publish(r.Listener,n.DocAction.COLLAB_LIST.EDIT,{CHID:s,LIST:P})}}a.publish(r.Listener,n.WMSAction.Response,{respObj:b,RSID:WebMessanger.getRawSid()})}catch(e){throw l.alert("warning",e),e}},processCustomMessage:function(e){h.processMessage(void 0,void 0,void 0,void 0,e)},handleServerUp:function(){function e(){a.register(r.Listener,n.Browser.UIPageLoad,i,"RSID"),e=void 0}try{var s=o.data.PageRegistry.RS_ID,t=o.view.getActiveGridID(),S=o.view.getResourceID(t),E=o.view.getVersionID(t),R=o.data.getWorkBook(S,E);if(e&&e(),!R||!R.isReady)return void l.alert("warning","JOIN Collab called before Workbook Ready with SheetID ");h.handleJoin(),i(s)}catch(e){throw l.alert("warning","catched error : ",e),e}},handleJoin:function(){e.UserAction.setDocPrivilege(),a.publish(r.Listener,n.ERROR.HIDE,{KEY:"Error.WMS.Connection.Lost"}),a.publish(r.Listener,n.ERROR.HIDE,{KEY:"ErrorPanel.ConnectionLost"})},handleJoinError:function(){try{e.UserAction.setDefaultPrivilege(),a.publish(r.Listener,n.ERROR.SHOW,{ERRORMSG:"Error.WMS.Connection.Lost"})}catch(e){throw l.alert("warning","error in cahtch L ",e),e}},handleServerDown:function(){try{e.UserAction.setDefaultPrivilege()}catch(e){throw l.alert("warning","error in catch : ",e),e}}});a.register(r.WMS,n.WMS.processMessage,h.processMessage,"CHID","UNAME","USERZUID","SENDER","MSG"),a.register(r.WMS,n.WMS.processCustomMessage,h.processCustomMessage,"MSG"),a.register(r.WMS,n.WMS.handleServerUp,h.handleServerUp),a.register(r.WMS,n.WMS.handleJoin,h.handleJoin),a.register(r.WMS,n.WMS.handleJoinError,h.handleJoinError),a.register(r.WMS,n.WMS.handleServerDown,h.handleServerDown)}(this);
!function(e){function r(e,r,t,n,i,a){return{TYPE:e,KIND:r,TITLE:l[t],REFRESH:n,DISABLE_EDIT:i,REPORTERROR:!!a}}function t(r,t,n){var i=r.split("#"),a=i.splice(0,1),o=i,a=l[a]?a:"Error.Internal.Server",A=e.JSUtil.fn.replaceParams(l[a],o),g=c[a];if(g){var d=g.TYPE,R=g.KIND,W=g.REFRESH,m=g.REPORTERROR,S=g.DISABLE_EDIT,C=g.TITLE;A.contains("#RL")&&(A=A.replace("#RL","<a href=''>"),A=A.replace("#CRL","</a>"));var h=document.createElement("div");h.innerHTML=A;var u=h.getElementsByTagName("a");if(u){var v=u[0];!!v&&v.addEventListener("click",function(){document.location.reload(!0)})}if(d==E.Banner)if(T.hasOwnProperty(a))T[a].isShown||T[a].show();else{var P={type:d,mode:"STD",showCloseBtn:!0,isHtml:!0,disableEdit:S},I=new s.TBNotification(h,P);T[a]=I,I.show()}if(d==E.Alert){var L=[{}];if(L[0].text=n?n:l.OK,L[0].primary=!0,L[0].click=function(){t&&t()},m){var D={text:l.ReportTheError};L=L.concat(D)}var P={type:R,title:C,buttons:L,isHtml:!0};W&&(P.countDown=15,L[0].click=function(){t&&t(),document.location.reload(!0)}),s.ZSAlert(h,P)}}}function n(e){T.hasOwnProperty(e)&&(T[e].remove(),delete T[e])}function i(){var e="Error.Connection.Lost";n(e)}var l=(e.sPlusPlus,e.ZSConstants.I18N),a=e.ZSEvents,o=a.topic,A=a.Groups,g=a.Names,s=e.ZSClass,d={Error:"error",Stop:"warning",Warning:"warning",Information:"info"},E={Banner:1,Alert:2},c={"Error.WMS.Join.Failed":r(E.Banner,d.Error,!1,!0),"Error.Internal.Server":r(E.Banner,d.Warning),"Document.Not.Ready":r(E.Banner,d.Warning),"error.internal":r(E.Banner,d.Warning),"Error.Connection.Lost":r(E.Banner,d.Error,!1,!0),"Error.Add.Action.To.Queue":r(E.Banner,d.Error,!1,!0),"Error.Document.Parse":r(E.Banner,d.Error,!1,!0),"Error.Action.Id.Mismatch":r(E.Banner,d.Error,!1,!0),"Public.Collaborators.Limit.Exceeded":r(E.Banner,d.Error,!1,!0),"Error.Document.Parse.ReadOnly":r(E.Banner,d.Error,!1,!0),"Error.Document.Parse.SharedUser":r(E.Banner,d.Error,!1,!0),"Error.Document.Load":r(E.Banner,d.Error,!1,!0),"Error.Remote.Document.Not.Available":r(E.Banner,d.Error,!1,!0),"Spreadsheet.IsContainsChartImageButton":r(E.Banner,d.Warning),"Error.Action.Reevaluate":r(E.Banner,d.Warning),"ErrorPanel.ConnectionLost":r(E.Banner,d.Warning),"Error.SizeExceed.Document.Save":r(E.Alert,d.Error,"Alert.Title.LimitExceeded"),"Error.Action.Execution":r(E.Alert,d.Error,"Alert.Title.ServerError",!1),YouCannotChangeOnlyPartOfAnArray:r(E.Alert,d.Warning,"Alert.Title.ArrayDetected"),"DataVal.ExtendSelection":r(E.Alert,d.Warning,"Alert.Title.ValidationDetected"),MergingIntoOneCell_AreYouSureToMerge:r(E.Alert,d.Warning,"Alert.Title.RangeMerge"),AreYouSureToMerge:r(E.Alert,d.Warning,"Alert.Title.RangeMerge"),CannotChangePartOfMergedCell:r(E.Alert,d.Warning,"Alert.Title.MergedRange"),ArrayFormulasAreNotValidInMergedCells:r(E.Alert,d.Warning,"Alert.Title.MergedRange"),CannotPasteIntoMergedCell:r(E.Alert,d.Warning,"Alert.Title.MergedRange"),CannotPerformDragDrop:r(E.Alert,d.Warning),"FillSeries.YourCannotChangePartOfMergedCell":r(E.Alert,d.Warning,"Alert.Title.MergedRange"),"Error.Pivot.Table.Part.Change":r(E.Alert,d.Warning,"Alert.Title.PivotTable"),"Error.Pivot.Source.Selection":r(E.Alert,d.Information,"Alert.Title.InvalidSourceRange"),"Error.Pivot.Invalid.Source":r(E.Alert,d.Information,"Alert.Title.InvalidSourceRange"),"Error.Pivot.Invalid.Source.Empty":r(E.Alert,d.Information,"Alert.Title.InvalidSourceData"),"ProtectedRange.alert.ProtectRangeMessage":r(E.Alert,d.Warning,"Alert.Title.LockedCells"),"FreezePanes.LastRowColNotAllowed":r(E.Alert,d.Warning,"Alert.Title.FreezePaneLimit"),SearchReachedEndOfSheet:r(E.Alert,d.Warning),SearchReachedStartOfSheet:r(E.Alert,d.Warning),"Error.Cell.Limit.Exceed":r(E.Alert,d.Warning,"Alert.Title.LimitExceeded"),"Error.Fillseries.Limit.Exceed":r(E.Alert,d.Warning,"Alert.Title.LimitExceeded"),"Error.Row.Limit.Exceed":r(E.Alert,d.Warning,"Alert.Title.RowLimitExceeded"),"Error.Column.Limit.Exceed":r(E.Alert,d.Warning,"Alert.Title.ColumnLimitExceeded"),"Error.Starts.From.Row.Limit.Exceed":r(E.Alert,d.Warning,"Alert.Title.InvalidCellRange"),"Error.Sheet.Name.Exists":r(E.Alert,d.Warning,"Alert.Title.SheetNameExists"),"Error.Pivot.Table.Overlaps":r(E.Alert,d.Warning,"Alert.Title.InvalidDestination"),"Error.Pivot.Limit.Exceed":r(E.Alert,d.Warning,"Alert.Title.LimitExceeded"),"Error.Pivot.Filter.Exists":r(E.Alert,d.Warning,"Alert.Title.InvalidDestination"),"Error.Filter.Pivot.Exists":r(E.Alert,d.Warning,"Alert.Title.PivotTableDetected"),"Error.Pivot.Field.Changed":r(E.Alert,d.Warning,"Alert.Title.ImproperSourceData"),"Error.Pivot.Table.Overlaps.With.Source":r(E.Alert,d.Warning,"Alert.Title.InvalidDestination"),"Error.Pivot.ProtectedRange":r(E.Alert,d.Warning,"Alert.Title.LockedCells"),"Error.ProtectedRange.PermissionDenied":r(E.Alert,d.Warning),"Error.Sort.Not.Allowed.Checkbox":r(E.Alert,d.Warning,"Alert.Title.InvalidCellRange"),"Error.Too.Many.Actions":r(E.Alert,d.Warning,"Alert.Title.LimitExceeded"),"Error.Sheet.Limit.Exceed":r(E.Alert,d.Error,"Alert.Title.LimitExceeded"),"ProtectedSheet.alert.DeleteSheet":r(E.Alert,d.Error,"Alert.Title.LockedSheet"),"Error.Locked.Version.Delete":r(E.Alert,d.Error,"Alert.Title.LockedVersion"),"Form.CreateErrorMessage":r(E.Alert,d.Error,"Alert.Title.ServerError"),"Form.DeleteErrorMessage":r(E.Alert,d.Error),"Error.Operation.Not.Permissable":r(E.Alert,d.Warning,"Alert.Title.AccessDenied"),"Error.Version.Operation.Not.Permissible":r(E.Alert,d.Warning),"Chart.Cells.Exceeded":r(E.Alert,d.Error,"Alert.Title.LimitExceeded"),"Chart.Not.Allowed":r(E.Alert,d.Error,"Alert.Title.InvalidCellRange"),InvalidCellReference:r(E.Alert,d.Warning,"Alert.Title.InvalidCellRange"),"DataVal.StopMsg":r(E.Alert,d.Error,"Alert.Title.InvalidData"),"DataVal.SheetSwitchResponseOnError":r(E.Alert,d.Warning,"Alert.Title.ValidationDetected"),"Spreadsheet.Revert.Reopen":r(E.Alert,d.Warning),"Trash.dialog.dlgMsg":r(E.Alert,d.Warning,"Alert.Title.DeleteSuccessful"),"Share.dialog.removeShareMsg":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged"),"Share.dialog.CO_RWtoRO":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.COtoRW":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.RWtoCO":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.ROtoCO":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.ROtoRW":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.RCtoRO":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.ROtoRC":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.RW_COtoRC":r(E.Alert,d.Warning,"Alert.Title.PermissionChanged",!0),"Share.dialog.PermissionChanged":r(E.Alert,d.Warning),WaitMoreRequestInqueue:r(E.Alert,d.Warning,"Alert.Title.ServerError"),"Error.Revert.Block":r(E.Alert,d.Warning,"Alert.Title.RangeNotFound"),SortingNotPossibleInMergedCellrange:r(E.Alert,d.Warning,"Alert.Title.MergeCells"),"Insert.CannotInsertOnMergedCells":r(E.Alert,d.Warning,"Alert.Title.MergeCells"),"Insert.CannotInsertOnFilterRange":r(E.Alert,d.Warning,"Alert.Title.FilteredRangeDetected"),"Error.Sheet.Modified.Or.Deleted":r(E.Alert,d.Warning,"Alert.Title.SheetNotFound"),"ErrorMsg.Spreadsheet.PreviewNotAvailable":r(E.Alert,d.Warning,"Alert.Title.LoadingFailed"),"ErrorMsg.Spreadsheet.ErrorWhileProcessingRequest":r(E.Alert,d.Warning),"ErrorMsg.UnAuth.Redirect":r(E.Alert,d.Warning),"ErrorMsg.YetToImplement":r(E.Alert,d.Information),NotFoundMatchingURI:r(E.Alert,d.Warning,"Alert.Title.URINotFound"),"OverLapping.not.support":r(E.Alert,d.Warning,"Alert.Title.InvalidCellRange"),"action.not.support.multiselection":r(E.Alert,d.Warning,"Alert.Title.InvalidCellRange"),"action.not.support.multisheet":r(E.Alert,d.Warning,"Alert.Title.InvalidSelection"),"action.not.support.mixedRangeType":r(E.Alert,d.Warning,"Alert.Title.InvalidCellRange"),"Error.Sheet.Hide":r(E.Alert,d.Error,"Alert.Title.ActionDenied")},T={};o.register(A.Listener,g.DocAction.AlertMsg.HIDE,n,"KEY"),o.register(A.Listener,g.DocAction.BannerMsg.HIDE,n,"KEY"),o.register(A.Listener,g.DocAction.BannerMsg.SHOW,t,"KEY"),o.register(A.Listener,g.ERROR.SHOW,t,"ERRORMSG","CALLBACK","BUTTON_TEXT"),o.register(A.Listener,g.ERROR.HIDE,n,"KEY"),o.register(A.Listener,g.Browser.UIPageLoad,i)}(this);
!function(e){function t(){d=!0,i()}function i(){if(I){var t=E.view.getActiveGridID(),i=E.view.getResourceID(t),r=E.view.getSheetID(t),s=E.view.getVersionID(t);e.UserAction.DeferredFetchData(i,r,s),g.publish(u.Listener,v.Browser.UIPageLoad),g.publish(u.Listener,v.Browser.SheetUpdateViewport),g.publish(u.Listener,v.Browser.UISheetLoad),e.UserAction.UpdateViewport(i,r,s),e.UserAction.getDocLocaleInfo(i,r,s)}}function r(){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),i=E.view.getSheetID(e),r=E.view.getVersionID(e);E.view.CellEditor.getEditStatus()||(g.publish(u.Selector.BoundUpdate.Range,v.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:i,VERSION:r}),g.publish(u.Selector.BoundUpdate.Cell,v.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:i,VERSION:r}))}function s(){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),r=(E.view.getSheetID(e),E.view.getVersionID(e)),o=E.data.getWorkBook(t,r);return o.isReady=1,g.unregister(u.Listener,v.Parser.RESPONSE.ONAFTER,s),D?void(D=!1):(S=!0,I=!0,void i())}function o(){D=!0,g.register(u.Listener,v.Parser.RESPONSE.ONAFTER,s)}function n(){S&&g.register(u.Listener,v.Parser.RESPONSE.ONAFTER,s)}function c(){D=void 0,I=!1}var D,S,E=e.sPlusPlus,a=e.ZSEvents,g=a.topic,u=a.Groups,v=a.Names,I=!1,d=!1;g.register(u.Listener,v.Browser.UISheetLoad,r),g.register(u.Listener,v.Browser.DOMContentLoaded,t),g.register(u.Listener,v.DocAction.DOCUMENT.CLOSE,c,"RID","VERSION"),g.register(u.Listener,v.DocAction.DOCUMENT.LOADSUCCESS,n),g.register(u.Listener,v.GridAction.RELOAD,o),g.register(u.Listener,v.Parser.RESPONSE.ONAFTER,s)}(this);
!function(e){function t(){C||(c&&e.clearInterval(c),c=e.setTimeout(function(){S.publish(l.WMS,a.WMS.handleJoinError)},I))}function i(){"undefined"!=typeof c&&(S.publish(l.WMS,a.WMS.handleJoin),e.clearInterval(c),c=void 0)}function n(){v=!0,t(),r(),S.unregister(l.Listener,a.CollabAction.JOIN_POST_SUCCESS,n)}function o(){C=!0,i(),r()}function r(){if(v&&C){var t=f.view.getActiveGridID(),i=f.view.getResourceID(t),n=f.view.getSheetID(t),o=f.view.getVersionID(t);e.UserAction.PostDataFetcher(i,n,o)}}function s(){v=!1,C=!1,i()}var c,u=e.ZSEvents,S=u.topic,l=u.Groups,a=u.Names,f=e.sPlusPlus,v=!1,C=!1,I=6e4;S.register(l.Listener,a.DocAction.DOCUMENT.CLOSE,s),S.register(l.Listener,a.CollabAction.JOIN_POST_SUCCESS,n),S.register(l.Listener,a.CollabAction.JOIN_SUCCESS,o)}(this);
!function(e){function i(e,i){var t="";if("disable"==e){if(-1==i||n){if(!a&&"Saved"==n){var s=v.Date.fmtTime();t=T["Topband.Save.Message.SavedAt"].replace(/{[0-9]}/,s.time)}}else{var s=v.Date.fmtTime(i);t=v.Date.isCurDay(i)?"Last modified at "+s.time:"Last modified on "+s.time}n="Saved"}else"enable"==e&&(t=T["Topband.Save.Message.Saving"]+"...");r.publish(o.Listener,c.DocAction.SAVE_MSG.SHOW,{STATE:e,msg:t})}function t(e){a=e}function s(){n=null}var n,a,S=(e.sPlusPlus,e.ZSEvents),r=S.topic,o=S.Groups,c=S.Names,T=e.ZSConstants.I18N,v=e.JSUtil;r.register(o.Listener,c.DocAction.DOCUMENT.CLOSE,s),r.register(o.Listener,c.ServerAction.REQ_QSTATUS,t,"IsReqPending"),r.register(o.Listener,c.DocAction.SAVE_MSG.UPDATE,i,"STATE","LASTMODIFIED")}(this);
!function(e){function t(e,t,r){var i=n.view.getActiveGridID();return e!==n.view.getResourceID(i)||t!==n.view.getSheetID(i)||r!==n.view.getVersionID(i)}function r(e,r,n,i){t(e,r,n)||((i[E.HIDDEN_ROWS]||i[E.HIDDEN_COLS]||i[E.ROW_HEADERS]||i[E.COLUMN_HEADERS])&&(S.UpdateContentViewport(e,r,n),S.UpdateScreenViewPort(e,r,n),S.DummyScroll(e,r,n)),i[E.FREEZE_PANES]&&(S.UpdateContentViewport(e,r,n),S.UpdateScreenViewPort(e,r,n),S.DummyScroll(e,r,n)))}var n=e.sPlusPlus,i=e.ZSEvents,o=i.topic,s=i.Groups,D=i.Names,E=e.ZSConstants.CommandConstants,S=e.UserAction;o.register(s.Listener,D.Browser.UIRefresh,r,"RID","SHEETID","VERSION","data")}(this);
!function(e){function t(e,t,o,i,s,d,u,v,E){var l,D=R.data.getWorkBook(e,o),f=D.getSheetObj(t),c=(f.Row,f.Column,{});c[i]={};var l;if(n(e,t,o,u)&&(l=a(e,t,o,u,i,s)),l)c[i][s]=l,v(c);else{var I=[i],w=[s];r(e,t,o,I,w,d,u,v,E)}}function n(e,t,n,o){var i=R.view.getResourceID(o),r=R.view.getSheetID(o),a=R.view.getVersionID(o);return i===e&&r===t&&a===n}function o(e,t,o,i,a,d,u,v,E){var l;if(n(e,t,o,u)&&(l=s(e,t,o,u,i,d)),l)v(l);else{for(var D=R.data.getWorkBook(e,o),f=D.getSheetObj(t),c=f.Row,I=f.Column,w=[],C=[],h=i.startRow;h<=i.endRow;h++){var A=c.Visibility.isHidden(h);d&&A||w.push(h)}for(var L=i.startCol;L<=i.endCol;L++){var g=I.hidden.isHidden(L);d&&g||C.push(L)}r(e,t,o,w,C,a,u,v,E,d)}}function i(e,t,n,o,i,a,s,d,u){for(var v=R.data.getWorkBook(e,n),E=v.getSheetObj(t),l=E.Row,D=E.Column,f=[],c=[],I=o.startRow;I<=o.endRow;I++){var w=l.Visibility.isHidden(I);a&&w||f.push(I)}for(var C=o.startCol;C<=o.endCol;C++){var h=D.hidden.isHidden(C);a&&h||c.push(C)}r(e,t,n,f,c,i,s,d,u,a)}function r(e,t,n,o,i,r,a,s,d,u){var R={SHEETID:t,RID:e,VERSION:n,ROWARRAY:o,COLARRAY:i,NEED:r,GRID_ID:a,SKIPHIDDEN:u,isCachedViewPort:!1},E=new v.Utility.WorkerRequest;E.addEventListeners("onComplete",function(e){l.publish(D.UI,f.Layout.DATA_LOADER.HIDE),s(e.BlockData)}),E.addEventListeners("onError",function(e){d(e)}),E.open(c.FETCHDATAAPI),E.send(R)}function a(e,t,n,o,i,r){var a,s=R.view.getGridComponent(o);return s&&(a=s.getCellRef(e,t,n,i,r)),a?a.getData():a}function s(e,t,n,o,i,r){for(var s={},d=R.data.getWorkBook(e,n),u=d.getSheetObj(t),v=u.Row,E=u.Column,l=i.startRow;l<=i.endRow;l++){s[l]={};for(var D=v.Visibility.isHidden(l),f=i.startCol;f<=i.endCol;f++){var c=E.hidden.isHidden(f),I=a(e,t,n,o,l,f);if(!(I||(D||c)&&r))return;(D||c)&&r||(s[l][f]=I)}}return s}function d(e,t,n,o,i,r,a,s,d){var u={RID:e,SHEETID:t,VERSION:n,ROWARRAY:o,COLARRAY:i,NEED:r},R=new v.Utility.WorkerRequest;R.addEventListeners("onComplete",function(e){s(e.BlockData),l.publish(D.UI,f.Layout.DATA_LOADER.HIDE)}),R.addEventListeners("onError",function(e){d(e)}),R.open(c.TILE),R.send(u)}function u(e,t,n,o,i,r,a,s){var d={RID:e,SHEETID:t,VERSION:n,ROW:o,COL:i,NEED:r},u=new v.Utility.WorkerRequest;u.addEventListeners("onComplete",function(e){a(e.BlockData),l.publish(D.UI,f.Layout.DATA_LOADER.HIDE)}),u.addEventListeners("onError",function(e){s(e)}),u.open(c.MERGETILE),u.send(d)}var R=e.sPlusPlus,v=R.SML.Client,E=e.ZSEvents,l=E.topic,D=E.Groups,f=E.Names,c=e.ZSConstants.URI;R.view.fetchCellData=t,R.view.fetchRangeData=o,R.view.fetchRangeDataFromWorker=i,R.view.fetchData=r,R.view.tileSubscribe=d,R.view.mergeTileSubscribe=u}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSClass,i=e.ZSEvents,r=i.topic,n=i.Groups,s=i.Names,d={userid:[],colorlist:new o.Map,USERPRESENCE_COLORS:["ae3800","f8a657","4b10ac","e93862","005eff","620f6d","9b8c2b","056493","668ed0","0d6856","646464","3dc34b","a47d7c","9258f1","c52119","d91997","7b9191","d87d34","547724","1dadba","ce990a","3fd3b6","e43e29","1692cf","347c85","866817","d27960","5a64cc","504367","852630","93d21c","9f5e4d","730451","dcb907","0dcb7d","f76605","a05ea8","166dbf","576d77","3c0479","479b8c","9d6d88","65765a","f61111","417663","c0504d","f5cf0e","9bbb59","4a452a","ff8500"],_addColor:function(e){for(var t=d.userid,o=d.colorlist,i=d.USERPRESENCE_COLORS,r=0;t&&r<t.length;r++)if(-1!=t.indexOf(e)){var n=t.indexOf(e);return o&&o.get(e)?o.get(e):i[n%i.length]}},addInfo:function(e){var o=t.view.getActiveGridID(),i=t.view.getResourceID(o),a=t.view.getSheetID(o),c=t.view.getVersionID(o),S=t.data.getWorkBook(i,c),u=(S.getSheetObj(a),t.view.getActiveState(o)),l=u.getUserPresenceList();d.userid=[],d.colorlist.clear();for(var v=0;v<e.length;v++)-1==d.userid.indexOf(e[v].zuid)&&(d.userid.push(e[v].zuid),e[v].color&&d.colorlist.set(e[v].zuid,e[v].color));for(var f=l.getList(),D=0;D<f.length;D++){var g=t.data.UserInfo.Permission.isEditable;g||f[D].zuid==t.data.UserInfo.zuid||r.publish(n.Listener,s.DocAction.COLLAB_LIST.ADDULDOM,{RID:i,VERSION:c,LIST:f[D],RANGE:void 0,COLOR:f[D].color?f[D].color:d._addColor(f[D].zuid)})}},refresh:function(){d.userid=[],d.colorlist.clear()},pushtoWMS:{}};d.pushtoWMS={holdontime:void 0,onJoinStatus:{isServerUp:!1,isDelayedJoin:!1},onEdit:function(o,i,r,n,s,a){var c=t.view.getActiveGridID(),S=t.view.getSelectedSheets(c),u=d.pushtoWMS;e.clearTimeout(u.holdontime),u.holdontime=e.setTimeout(function(){var e=t.data.UserInfo.Permission.isEditable;e&&(UserAction.onSelection(o,S,r,n,s,a,d._addColor(t.data.UserInfo.zuid)),UserAction.onEdit(o,S,r,n,s,a,d._addColor(t.data.UserInfo.zuid)))},200)},onSelection:function(o,i,r,n,s,a){var c=d.pushtoWMS,S=d.userid,u=t.view.getActiveGridID(),l=t.view.getSelectedSheets(u);return c.onJoinStatus.isServerUp?(e.clearTimeout(c.holdontime),void(c.holdontime=e.setTimeout(function(){var e=t.data.UserInfo.Permission.isEditable;S&&S.length>0&&c.onJoinStatus.isServerUp&&e&&UserAction.onSelection(o,l,r,n,s,a,d._addColor(t.data.UserInfo.zuid))},200))):void(c.onJoinStatus.isDelayedJoin=!0)},onJoin:function(e){function o(){var e=t.view.getSheetID(a),o=t.view.getSheetState(a,e),r=o.getActiveRange(),n=t.data.UserInfo.Permission.isEditable;n&&i.onSelection(c,e,S,r,r.id,r.type,d._addColor(t.data.UserInfo.zuid))}var i=d.pushtoWMS;i.onJoinStatus.isServerUp=e;var a=t.view.getActiveGridID(),c=t.view.getResourceID(a),S=t.view.getVersionID(a),u=t.data.getWorkBook(c,S);return u&&u.isReady?void o():void(i.onJoinStatus.isDelayedJoin&&r.register(n.Listener,s.Browser.UIPageLoad,o))},refresh:function(){d.pushtoWMS.holdontime=void 0,d.pushtoWMS.onJoinStatus.isServerUp=!1,d.pushtoWMS.onJoinStatus.isDelayedJoin=!1}},r.register(n.Selector.DomUpdate.CellEdit,s.Selection.BOUND_UPDATE.ADD,d.pushtoWMS.onEdit,"RID","SHEETID","VERSION","ActiveRange","RANGEID","TYPE"),r.register(n.Selector.DomUpdate.Range,s.Selection.BOUND_UPDATE.ADD,d.pushtoWMS.onSelection,"RID","SHEETID","VERSION","ActiveRange","RANGEID","TYPE"),r.register(n.Listener,s.DocAction.USER_INFO.STATE,d.pushtoWMS.onJoin,"state"),r.register(n.UserAction,s.DocAction.DOCUMENT.CLOSE,d.pushtoWMS.refresh,"DOC_ID"),r.register(n.Listener,s.DocAction.USER_INFO.ADD,d.addInfo,"list"),r.register(n.UserAction,s.DocAction.DOCUMENT.CLOSE,d.refresh,"DOC_ID")}(this);
!function(e){function t(e){e&&(i.data.DocRegistry[e].ActiveUserList=new r.ActiveShareUsers)}function s(e){var t=i.view.getActiveGridID(),s=i.view.getResourceID(t),r=i.data.DocRegistry[s].ActiveUserList;r.reset();for(var c in e){var a=e[c].zuid,n=e[c].rsid;r.set(a,n)}}var i=e.sPlusPlus,r=e.ZSClass,c=e.ZSEvents,a=c.topic,n=c.Groups,o=c.Names;a.register(n.Listener,o.DocMeta.DOCUMENT_NAME,t,"RESOURCE_ID"),a.register(n.Listener,o.CollabAction.SYNCCOLLABUSER,s,"META")}(this);
!function(s){var t=(s.sPlusPlus,s.ZSClass),i=function(){this.list=[]};i.prototype={reset:function(){this.list=[]},set:function(s,t){WebMessanger.getRawSid()!=t&&this.list.push(s)},isListAvailable:function(){return this.list.length>0}},t.ActiveShareUsers=i}(this);
!function(e){function t(e,t){this.eventHandler={},this.resourceID=e,this.version=t,r.data.SESSION_INFO&&(this.sessionID=r.data.SESSION_INFO.ID)}function s(e,t,s){n.publish(i.Listener,a.ERROR.SHOW,{RID:t,VERSION:s,ERRORMSG:e})}var r=e.sPlusPlus,o=e.ZSEvents,n=o.topic,i=o.Groups,a=o.Names,h=e.ZSClass,c=e.XMLHttpRequest,l=e.ZSConstants,u=l.I18N,p=(l.CommandConstants,e.ZSDevTools.Logger),m=3,d=0;t.Method={POST:"POST",GET:"GET"},t.responseType={TEXT:"text",BLOB:"blob",JSON:"json",ARRAYBUFFER:"arraybuffer",DOCUMENT:"document"},t.prototype={init:function(s,o){if(o&&o.method&&o.method!==t.Method.GET&&o.method!==t.Method.POST&&p.alert("Please Give the valid method Type for AjaxRequest, only GET | POST is allowed"),o&&o.formObj){if(this.formData=new FormData,o.action&&this.formData.append("a",o.action),o.files)for(var n,i=0;n=o.files[i];++i)this.formData.append("file",n);o.csrf&&this.formData.append(r.data.PageRegistry.csrfParamName,r.data.PageRegistry.csrfToken)}if(this.method=o&&o.method?o.method:t.Method.POST,s){var a=new e.ZSClass.RequestParameters(s);this.URL=s.isCrossDomainRequest?s.URL:a.getURL(this.resourceID),this.parameters=encodeURI(a.getParametersAsString(this.resourceID,this.version,!0)).replace(/\+/g,"%2B")}else o&&(o.URL&&(this.URL=o.URL),o.params&&(this.parameters=encodeURI(o.params).replace(/\+/g,"%2B")));return this.asynchronous=o&&void 0!=o.async?o.async:!0,o&&o.timeOutVal&&(this.timeout=o.timeOutVal),this.responseType=o&&o.respType?o.respType:t.responseType.JSON,this.retryCount=0,this.xmlHttpRequest=null,this},appendParams:function(e){e=encodeURI(e).replace(/\+/g,"%2B"),this.parameters=this.parameters?this.parameters+"&"+e:e},addEventListener:function(e,t){switch(e){case"onBeforeSend":case"onProcess":case"onProgress":case"onComplete":case"onSyncResponse":case"onBeforeComplete1":case"onBeforeComplete2":case"onAfterComplete":case"onTimeOut":case"onServerError":case"onDisconnect":case"onError":break;default:return void p.alert("Please Give the valid Events for addEventListener")}var s=Array.prototype.slice.call(arguments,2);this.eventHandler[e]={},this.eventHandler[e].handler=t,this.eventHandler[e].params=s},_triggerListener:function(e){var t=this.eventHandler[e];if(t)switch(e){case"onBeforeSend":case"onProcess":case"onProgress":case"onComplete":case"onSyncResponse":case"onBeforeComplete2":case"onAfterComplete":case"onTimeOut":case"onDisconnect":case"onServerError":case"onError":t.params.unshift(this.xmlHttpRequest),t.handler.apply(null,t.params);break;case"onBeforeComplete1":return t.params.unshift(this.xmlHttpRequest),t.handler.apply(null,t.params)}},_getXmlHttpRequest:function(){return c?(t.prototype._getXmlHttpRequest=function(){return new c},this._getXmlHttpRequest()):void p.alert("Zoho Sheet is not supported in this browser, Please update the latest browser")},sendRequest:function(){this._triggerListener("onBeforeSend"),null==this.xmlHttpRequest&&(this.xmlHttpRequest=this._getXmlHttpRequest()),this.xmlHttpRequest.onreadystatechange=this._onreadyStateChange.bind(this),this.timeout&&(this.xmlHttpRequest.timeout=this.timeout,this.xmlHttpRequest.ontimeout=this._ontimeout.bind(this)),this.xmlHttpRequest.onerror=this._handleError.bind(this),"GET"===this.method?this.xmlHttpRequest.open(this.method,this.URL+"?"+this.parameters,this.asynchronous):this.formData?this.xmlHttpRequest.open(this.method,this.URL+"?"+this.parameters,this.asynchronous):this.xmlHttpRequest.open(this.method,this.URL,this.asynchronous),this.asynchronous&&(this.xmlHttpRequest.responseType=this.responseType),this.formData||this.xmlHttpRequest.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8"),this.xmlHttpRequest.upload.onProgress=this.onProgress.bind(this),this.xmlHttpRequest.onProgress=this.onProgress.bind(this),this.xmlHttpRequest.send(this.formData?this.formData:"POST"===this.method?this.parameters:null)},onProgress:function(){this._triggerListener("onProgress")},_onreadyStateChange:function(){var e=r.data.SESSION_INFO;if(!e||!e.ID||void 0==this.sessionID||this.sessionID===e.ID)switch(this.xmlHttpRequest.readyState){case 0:case 1:this._triggerListener("onBeforeSend");break;case 2:case 3:this._triggerListener("onProcess");break;case 4:if(200===this.xmlHttpRequest.status){if(this.formData&&this._handleFileDownload(this.xmlHttpRequest),this._triggerListener("onBeforeComplete1")===!1)break;this._triggerListener("onBeforeComplete2"),this._triggerListener("onComplete"),this._triggerListener("onSyncResponse"),this._triggerListener("onAfterComplete"),d=0}else 999===this.xmlHttpRequest.status?this._handleError():(this._triggerListener("onError"),this._handleError())}},_resendRequest:function(){this.retryCount<m&&this.sendRequest(),this.retryCount++},_ontimeout:function(){p.log("Request Timed out for"+this.URL),this.eventHandler.onTimeOut?this._triggerListener("onTimeOut"):this._resendRequest()},_handleFileDownload:function(t){var s="",r=t.getResponseHeader("Content-Disposition");if(r&&-1!==r.indexOf("attachment")){var o=r.indexOf("=");s=r.substring(o+2,r.length-1)}var n=t.getResponseHeader("Content-Type"),i=new Blob([t.response],{type:n}),a=e.URL||e.webkitURL,h=a.createObjectURL(i);if(s){var c=e.document.createElement("a");"undefined"==typeof c.download?e.location=h:(c.href=h,c.download=s,e.document.body.appendChild(c),c.click(),e.document.body.removeChild(c))}},_handleError:function(){switch(this.xmlHttpRequest.status){case 999:this._resendRequest();break;case 400:p.log("Bad Request send to server");break;case 401:this.eventHandler.onError||p.alert(u["h.Error.OperationNotPermissible"]);break;case 402:case 403:case 404:p.log("exception in server "+this.URL),s("Error.Internal.Server",this.resourceID,this.version);break;case 405:case 406:case 407:break;case 408:s("Error.Internal.Server",this.resourceID,this.version),p.log("request timeout "+this.URL);break;case 409:case 410:break;case 411:break;case 412:break;case 413:s("Error.Internal.Server",this.resourceID,this.version),p.log("request status : "+this.xmlHttpRequest.status);break;case 414:case 415:case 416:case 417:break;case 500:case 501:case 505:this.eventHandler.onError?this._triggerListener("onError"):(s("Error.Internal.Server",this.resourceID,this.version),p.log("request status : "+this.xmlHttpRequest.status));break;case 0:case 502:case 503:case 504:case 12007:case 12029:case 12031:d>=1?this.eventHandler.onDisconnect?this._triggerListener("onDisconnect"):(s("ErrorPanel.ConnectionLost#<a href=''>#</a>",this.resourceID,this.version),p.log("ERROR","ConnectionLost",!0,!0)):(this._resendRequest(),d++)}}},h.AjaxRequest=t}(this);
!function(a){function t(a){this.action=a.action,this.actionParams=a,this.keyAry=this.actionParams.params,this.valueAry=this.actionParams.paramVal,this.isDocSpecificURL=null,this.isDocSpecificURL=void 0===this.actionParams.isDocSpecificURL?!0:!1}{var i=a.sPlusPlus,e=a.JSUtil.StringBuffer;i.SML.Server}t.prototype={getParametersAsString:function(a,t,s){var r=new e,n=this.keyAry,o=this.valueAry,c=i.data.UserInfo.isIncognito;if(n)for(var d=0,p=n.length;p>d;d++){var R=o[d];c&&"rid"===n[d]&&(R=null),null!==R&&void 0!==R&&r.append(n[d]+"="+R)}return c&&(r.append("doc="+i.data.DocRegistry[a].DOCUMENT_POINTER),r.append("RMNAME="+i.data.UserInfo.RMUSER)),this.isDocSpecificURL&&this._bufferDocParams(r),s&&r.append(i.data.PageRegistry.csrfParamName+"="+i.data.PageRegistry.csrfToken),i.data.UserInfo.authtoken&&r.append("authtoken="+i.data.UserInfo.authtoken),i.data.PageRegistry.RS_ID&&r.append("rsid="+i.data.PageRegistry.RS_ID),i.data.PageRegistry.UT_ID&&r.append("utid="+i.data.PageRegistry.UT_ID),i.data.TEMP_CONTAINER_IDENTITY&&(i.data.UserInfo.RMUSER&&r.append("RMNAME="+i.data.UserInfo.RMUSER),r.append("temp_container_identity="+i.data.TEMP_CONTAINER_IDENTITY),i.data.DocRegistry[a].COLLAB_ID&&r.append("cid="+i.data.DocRegistry[a].COLLAB_ID)),r.append("tabType=cached"),r.toString("&")},getURL:function(a){return this.isDocSpecificURL?i.data.AppRegistry.ctxpath+i.data.PageRegistry.docCtxPath+i.data.DocRegistry[a].DOCUMENT_POINTER:i.data.AppRegistry.ctxpath+this.actionParams.URL},_bufferDocParams:function(a){a.append("proxyURL="+this.actionParams.URL),a.append("action="+this.action)}},a.ZSClass.RequestParameters=t}(this);
!function(e){function t(t,s){u=s;var r=v.view.getGridComponent(u),a=r.getRelativeCoordinates(t),l=v.view.getResourceID(u),I=v.view.getSheetID(u),d=v.view.getVersionID(u),S=v.view.getSheetState(u,I);if(3===t.which||2===t.button)for(var p=S.getRanges(),w=v.data.getWorkBook(l,d),L=w.getSheetObj(I),m=new c(void 0,!0,g),h=m.ADD(L,a.x,a.y),O=p.length,f=O-1;f>=0;f--)if(p[f].subset(h))return;t.preventDefault();var A=v.view.CellEditor.getEditStatus();if(A&&!R.RangePicker.isSelection()&&E.publish(D.Gesture.Selector.CellEdit,C.GESTURE.ACTION.ENUMERATE,{RID:l,SHEETID:I,VERSION:d,isSubmittable:1}),t.shiftKey)return n(t);var G=0;(t.metaKey||t.ctrlKey&&-1==e.navigator.platform.toUpperCase().indexOf("MAC"))&&(G=1);var T={RID:l,SHEETID:I,VERSION:d,ROWY:a.y,COLX:a.x,ACTIVEX:a.x,ACTIVEY:a.y,metaKey:t.metaKey,ACCUMULATE:G,GRID_ID:u};E.publish(D.Listener,C.Mouse.RangeDown,T),E.publish(D.Listener,C.Mouse.ScrollOut,{GRIDID:u,CALLBACK:i}),e.addEventListener("mousemove",o),e.addEventListener("mouseup",n)}function o(e){var t=v.view.getResourceID(u),o=v.view.getSheetID(u),n=v.view.getVersionID(u),s=v.view.getGridComponent(u),r=s.getRelativeCoordinates(e);i(t,o,n,r.x,r.y)}function i(e,t,o,i,n){E.publish(D.Listener,C.Mouse.RangeMove,{RID:e,SHEETID:t,VERSION:o,RANGEID:0,ROWY:n,COLX:i,GRID_ID:u})}function n(t){var i=v.view.getResourceID(u),s=v.view.getSheetID(u),r=v.view.getVersionID(u),a=v.view.getGridComponent(u),l=a.getRelativeCoordinates(t),R={RID:i,SHEETID:s,VERSION:r,RANGEID:0,ROWY:l.y,COLX:l.x,GRID_ID:u};E.publish(D.Listener,C.Mouse.RangeEnd,R),e.removeEventListener("mousemove",o),e.removeEventListener("mouseup",n)}function s(t,o){var i=v.view.getResourceID(o),n=v.view.getSheetID(o),s=v.view.getVersionID(o),r=v.view.getGridComponent(u),a=r.getRelativeCoordinates(t),l=v.view.getSheetState(o,n),R=l.getActiveRange(),I=v.data.getWorkBook(i,s),c=I.getSheetObj(n),g=c.ProtectedRanges.isXists(R.startRow,R.startCol),d=c.CheckBoxRanges.isXists(R.startRow,R.startCol),S=c.Pivot.isXists(R.startRow,R.startCol),p=I.ProtectedSheets.isSheetLocked(n),w=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"];if(E.publish(D.Gesture.Selector.CellEdit,C.GESTURE.ACTION.DOWN,{RID:i,SHEETID:n,VERSION:s,x:a.x,y:a.y}),!(g||S||p||d)){var L=function(e){E.publish(D.Listener,C.CellAction.VALUE.SET,{RID:i,SHEETID:n,VERSION:s,ROW:R.startRow,COL:R.startCol,VALUE:e[R.startRow][R.startCol],FOCUS:!0})},m=function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)};v.view.fetchCellData(i,n,s,R.startRow,R.startCol,w,o,L,m)}}function r(e,o){e.addEventListener("mousedown",function(e){t(e,o)})}function a(e,t){e.addEventListener("dblclick",function(e){s(e,t)})}function l(e,t){e.addEventListener("dragover",function(e){E.publish(D.Listener,C.UserAction.DRAG_DROP.DRAGOVER,{EVENT:e,DOM:this,GRID_ID:t})})}var u,v=e.sPlusPlus,R=(v.view.measures,e.ZSClass),I=e.ZSEvents,E=I.topic,D=I.Groups,C=I.Names,c=R.Selector.Assistor,g=R.SelectorHelper.Constants.MULTI_DIRECTION;R.UIPaneComponent.prototype.addSelectionListeners=r,R.UIPaneComponent.prototype.addEditListeners=a,R.UIGridComponent.prototype.addDropDownListeners=l}(this);
!function(e,i){function t(e,i){e.addEventListener(D,function(e){o(e,i)},!1)}function o(e,i){{var t=n.view.getResourceID(i),o=n.view.getSheetID(i),s=n.view.getVersionID(i);n.view.getSheetState(i,o)}if(e.preventDefault(),e.stopPropagation(),n.data.UserInfo.Permission.isScrollable){var d=m.config;d.timeDiff&&(d.timeDiff=(new Date).getTime()-d.timeDiff,d.timeDiff>d.timeThreshold?(d.eventCount=0,d.isVigorousMode=!1):(d.eventCount>d.eventThreshold&&(d.isVigorousMode=!0),d.eventCount++)),e||(e=event);var c,D=e.wheelDelta,g=e.wheelDeltaX,w=e.wheelDeltaY,M=e.detail,p=g||1===e.axis,I=w||2===e.axis||v&&D;if(I){var S=u?w/M:w||-M||D,E=u?M>0:0>S;S=Math.abs(S),c=S/d.divisor,c=Math.ceil(d.isVigorousMode&&h?c/d.vigorousModeDivisor:c);var x=d.isVigorousMode?d.maxRowsPerEventInVigorousMode:d.maxRowsPerEvent;if(c=Math.min(x,c),E)var C=18*c;else var C=18*-c;r.publish(a.Listener,l.GridAction.WheelXYPaneContainerScroll,{RID:t,SHEETID:o,VERSION:s,DistanceX:0,DistanceY:C,X:e.clientX,Y:e.clientY})}if(p){var P=40,R=h?-1*M:g/P,V=P*(R/3),X=Math.round(-1*V);r.publish(a.Listener,l.GridAction.WheelXYPaneContainerScroll,{RID:t,SHEETID:o,VERSION:s,DistanceX:X,DistanceY:0,X:e.clientX,Y:e.clientY})}return d.timeDiff=(new Date).getTime(),f||h?!1:void 0}}var n=e.sPlusPlus,s=e.ZSEvents,r=s.topic,a=s.Groups,l=s.Names,d=e.navigator.userAgent,v=(e.document,-1!==d.indexOf("msie")),u=-1!==d.indexOf("opera"),f=-1!==d.indexOf("webkit"),h=-1!==d.indexOf("Firefox"),c=!0,D=h?"DOMMouseScroll":"onwheel"in document.createElement("div")?"wheel":"mousewheel";ZSClass.UIPaneComponent.prototype.addMouseWheelListener=t,ZSClass.UIRowHeader.prototype.addMouseWheelListener=t,ZSClass.UIColHeader.prototype.addMouseWheelListener=t;var m={};m.config={divisor:u?40:h&&c?1:h?3:120,eventThreshold:7,timeThreshold:100,isVigorousMode:!1,maxRowsPerEvent:5,maxRowsPerEventInVigorousMode:3,vigorousModeDivisor:10,timeDiff:i,eventCount:0}}(this);
!function(e){function t(e,t,E){t.x-=n,t.y-=n,r=e;var v=I.view.getResourceID(r),u=I.view.getSheetID(r),g=I.view.getVersionID(r),a=I.view.getSheetState(r,u),c=a.getActiveRange();D.publish(o.Gesture.Selector.FillSeries,R.GESTURE.ACTION.START,{RID:v,SHEETID:u,VERSION:g,RANGEID:0,x:t.x,y:t.y,TYPE:c.type,ISCTRLPRESSED:E}),D.publish(o.Listener,R.Mouse.ScrollOut,{GRIDID:r,CALLBACK:S}),l(i,s)}function i(e){var t=I.view.getResourceID(r),i=I.view.getSheetID(r),s=I.view.getVersionID(r),E=I.view.getGridComponent(r),D=E.getRelativeCoordinates(e);D.x-=n,D.y-=n,S(t,i,s,D.x,D.y)}function S(e,t,i,S,s){var E=I.view.getSheetState(r,t),l=E.getActiveRange();D.publish(o.Gesture.Selector.FillSeries,R.GESTURE.ACTION.MOVE,{RID:e,SHEETID:t,VERSION:i,RANGEID:0,x:S,y:s,TYPE:l.type}),D.publish(o.Selector.DomUpdate.FillSeries,R.Selection.BOUND_UPDATE.MODIFY,{RID:e,SHEETID:t,VERSION:i,RANGEID:0})}function s(e){var t=I.view.getResourceID(r),i=I.view.getVersionID(r),S=I.view.getSheetID(r),s=I.view.getGridComponent(r),E=s.getRelativeCoordinates(e);E.x-=n,E.y-=n;var l=I.view.getSheetState(r,S),v=l.getActiveRange();D.publish(o.Gesture.Selector.FillSeries,R.GESTURE.ACTION.END,{RID:t,SHEETID:S,VERSION:i,RANGEID:0,x:E.x,y:E.y,TYPE:v.type})}var r,I=e.sPlusPlus,E=(I.view.measures,e.ZSClass,e.ZSEvents),D=E.topic,o=E.Groups,R=E.Names,l=e.JSUtil.Mouse.BindEvents,n=2;D.register(o.Listener,R.Mouse.FillStart,t,"GRIDID","COORDINATES","ISCTRLPRESSED")}(this);
!function(e){function t(e,t){var o=t.getRects(),i=t.colHeader0?t.colHeader0.getRects().height:0,n=t.hScroll?t.hScroll.getRects().height:0,r=o.top+i,s=o.top+o.height-n,v=e.pageY<r||e.pageY>s;return v}function o(e,t){var o=t.getRects(),i=t.rowHeader0?t.rowHeader0.getRects().width:0,n=t.vScroll?t.vScroll.getRects().width:0,r=o.left+i,s=o.left+o.width-n,v=e.pageX<r||e.pageX>s;return v}function i(t,o){d=t,f=o,e.addEventListener("mousemove",n),e.addEventListener("mouseup",r)}function n(e){h=e;var t=R.view.getGridComponent(d),i=o(e,t);if(i){var n=R.view.getSheetID(d),r=R.view.getSheetState(d,n),s=t.getRelativeCoordinates(e),v=s.x<r.getScreenWidths()[1]?s.x:s.x-r.getScrollLefts()[0],u=0>v?-15:15;g(u,0)}else m()}function r(){m(),e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",r)}function s(t,o){d=t,f=o,e.addEventListener("mousemove",v),e.addEventListener("mouseup",u)}function v(e){h=e;var o=R.view.getGridComponent(d),i=t(e,o);if(i){var n=o.getRelativeCoordinates(e),r=R.view.getSheetID(d),s=R.view.getSheetState(d,r),v=n.y<s.getScreenHeights()[1]?n.y:n.y-s.getScrollTops()[0],u=0>v?-10:10;g(0,u)}else m()}function u(){m(),e.removeEventListener("mousemove",v),e.removeEventListener("mouseup",u)}function c(t,o){d=t,f=o,e.addEventListener("mousemove",l),e.addEventListener("mouseup",a)}function a(){m(),e.removeEventListener("mousemove",l),e.removeEventListener("mouseup",a)}function l(e){h=e;var i=R.view.getGridComponent(d),n=o(e,i),r=t(e,i);if(n||r){var s=i.getRelativeCoordinates(e),v=R.view.getSheetID(d),u=R.view.getSheetState(d,v),c=s.x<u.getScreenWidths()[1]?s.x:s.x-u.getScrollLefts()[0],a=s.y<u.getScreenHeights()[1]?s.y:s.y-u.getScrollTops()[0],l=n?0>c?-10:10:0,S=r?0>a?-10:10:0;g(l,S)}else m()}function g(e,t){m(),S(e,t);var o=e,i=t;p=setTimeout(function(){e=1.5*o,t=1.5*i},1500),w=setTimeout(function(){e=2*o,t=2*i},3e3),I=setTimeout(function(){e=4*o,t=4*i},5e3),L=setInterval(function(){S(e,t)},G)}function m(){clearInterval(L),clearTimeout(p),clearTimeout(w),clearTimeout(I)}function S(e,t){var o=R.view.getResourceID(d),i=R.view.getSheetID(d),n=R.view.getVersionID(d),r=R.view.getGridComponent(d),s=r.getRelativeCoordinates(h);f(o,i,n,s.x,s.y),D.publish(E.UserAction,T.SheetAction.SCROLL_POSITION.Relativepane0,{RID:o,SHEETID:i,VERSION:n,DistanceX:e,DistanceY:t})}var d,f,h,L,p,w,I,R=e.sPlusPlus,C=(R.view.measures,e.ZSEvents),D=C.topic,E=C.Groups,T=C.Names,A=1e3/60,G=A;D.register(E.Listener,T.Mouse.ScrollOut,c,"GRIDID","CALLBACK"),D.register(E.Listener,T.Mouse.ScrollOutRowY,s,"GRIDID","CALLBACK"),D.register(E.Listener,T.Mouse.ScrollOutColX,i,"GRIDID","CALLBACK")}(this);
!function(e){function t(t,R,L){a=d.view.getActiveGridID(),u=n=L;var E=d.view.getResourceID(a),c=d.view.getSheetID(a),C=d.view.getVersionID(a),A=d.data.getWorkBook(E,C),S=A.getSheetObj(c);D=S.Row.auxiliaryAxis.getPos(n.startRow),l=S.Column.axis.getPos(n.startCol);var b=S.Column.axis.findAbs(t),f=S.Row.auxiliaryAxis.findAbs(R);v=S.Column.axis.getPos(b),g=S.Row.auxiliaryAxis.getPos(f),document.body.classList.add("grabbingCursor"),I.publish(w.Listener,m.Layers.Drag.Place,{RID:E,SHEETID:c,VERSION:C,ID:0,RANGE:n}),I.publish(w.Listener,m.Mouse.ScrollOut,{GRIDID:a,CALLBACK:i}),e.addEventListener("mousemove",o),e.addEventListener("mouseup",r),e.addEventListener("keydown",s)}function s(t){if(27==t.keyCode){var i=d.view.getResourceID(a),n=d.view.getSheetID(a),u=d.view.getVersionID(a);I.publish(w.Listener,m.Layers.Drag.Remove,{RID:i,SHEETID:n,VERSION:u,ID:0}),e.removeEventListener("mouseup",r),e.removeEventListener("mousemove",o),e.removeEventListener("keydown",s)}}function o(e){var t=d.view.getResourceID(a),s=d.view.getSheetID(a),o=d.view.getVersionID(a),r=d.view.getGridComponent(a),n=r.getRelativeCoordinates(e);i(t,s,o,n.x,n.y)}function i(e,t,s,o,i){var r=d.data.getWorkBook(e,s),a=r.getSheetObj(t),R=o-v,L=i-g,E=l+R,c=D+L,C=a.Row.auxiliaryAxis.findAbs(c),A=a.Column.axis.findAbs(E),S=C+(n.endRow-n.startRow),b=A+(n.endCol-n.startCol);S>=d.data.Defaults.MAX_ROW-1&&(S=d.data.Defaults.MAX_ROW-1,C=S-(n.endRow-n.startRow)),b>=d.data.Defaults.MAX_COL-1&&(b=d.data.Defaults.MAX_COL-1,A=b-(n.endCol-n.startCol));var f=new ZSClass.Range(C,A,S,b);f.equals(u)||(I.publish(w.Listener,m.Layers.Drag.Place,{RID:e,SHEETID:t,VERSION:s,ID:0,RANGE:f}),u=f)}function r(){var t=d.view.getResourceID(a),i=d.view.getSheetID(a),v=d.view.getVersionID(a),g=d.view.getSheetState(a,i),l=g.getActiveCellRange(),D=l.startRow,R=l.startCol;document.body.classList.remove("grabbingCursor"),!n.equals(u)&&UserAction.dragAndDropRange(t,i,v,n,u,l,D,R),I.publish(w.Listener,m.Layers.Drag.Remove,{RID:t,SHEETID:i,VERSION:v,ID:0}),e.removeEventListener("mouseup",r),e.removeEventListener("mousemove",o),e.removeEventListener("keydown",s)}{var a,n,u,v,g,l,D,d=e.sPlusPlus,R=e.ZSEvents,I=R.topic,w=R.Groups,m=R.Names;d.data.Defaults}I.register(w.Listener,m.Mouse.DragStart,t,"COLX","ROWY","RANGE")}(this);
!function(e){function t(t,w,I,m,S){g=!0,d=S,v=m,n=R.view.getActiveGridID(),l=i=I,u=i.clone(),"row"==m?u.startRow=u.endRow+1:"column"==m&&(u.startCol=u.endCol+1);{var L=R.view.getResourceID(n),O=R.view.getSheetID(n),c=R.view.getVersionID(n),A=R.data.getWorkBook(L,c);A.getSheetObj(O)}C.publish(D.Listener,E.Layers.HeaderDrag.Place,{RID:L,SHEETID:O,VERSION:c,ID:0,RANGE:u}),C.publish(D.Listener,E.Mouse.ScrollOut,{GRIDID:n,CALLBACK:r}),e.addEventListener("mousemove",s),e.addEventListener("mouseup",a),e.addEventListener("keydown",o),d&&d.MOUSEDOWN&&d.MOUSEDOWN(l)}function o(t){if(27==t.keyCode){g=!1;var r=R.view.getResourceID(n),i=R.view.getSheetID(n),u=R.view.getVersionID(n);C.publish(D.Listener,E.Layers.HeaderDrag.Remove,{RID:r,SHEETID:i,VERSION:u,ID:0}),d&&d.CANCEL&&d.CANCEL(l),e.removeEventListener("mouseup",a),e.removeEventListener("mousemove",s),e.removeEventListener("keydown",o)}}function s(e){var t=R.view.getResourceID(n),o=R.view.getSheetID(n),s=R.view.getVersionID(n),a=R.view.getGridComponent(n),i=a.getRelativeCoordinates(e);r(t,o,s,i.x,i.y)}function r(e,t,o,s,r){if(g){var a=R.data.getWorkBook(e,o),w=a.getSheetObj(t),I=R.view.getGridComponent(n),m=w.Row.auxiliaryAxis.findAbs(r),S=w.Column.axis.findAbs(s),L=m+(u.endRow-u.startRow),O=S+(u.endCol-u.startCol);L>=R.data.Defaults.MAX_ROW-1&&(L=R.data.Defaults.MAX_ROW-1,m=L-(u.endRow-u.startRow)),O>=R.data.Defaults.MAX_COL-1&&(O=R.data.Defaults.MAX_COL-1,S=O-(u.endCol-u.startCol));var c,A,M=new ZSClass.Range(m,S,L,O),f=R.view.getSheetState(n,t),h=(f.getZoom(),I.getRects(),!1);if("column"==v){var x=w.Column.axis.findAbs(s),y=w.Column.axis.getPos(x),N=w.Column.axis.getDim(x)/2,c=s-y>=N?x+1:x;h=!(M.startCol>=i.startCol&&M.endCol+1<=i.endCol)}else{var p=w.Row.auxiliaryAxis.findAbs(r),V=Math.round(w.Row.auxiliaryAxis.getPos(p)),b=Math.round(w.Row.auxiliaryAxis.getDim(p)/2);A=r-V>=b?p+1:p,h=!(M.startRow>=i.startRow&&M.endRow+1<=i.endRow)}h&&("column"==v?(M.startCol=c,M.endCol=-1!=M.endCol?M.endCol:0,c>=i.startCol&&c-1<=i.endCol?d.MOUSEMOVE(l,!1):d.MOUSEMOVE(l,!0)):(M.startRow=A,M.endRow=-1!=M.endRow?M.endRow:0,A>=i.startRow&&A-1<=i.endRow?d.MOUSEMOVE(l,!1):d.MOUSEMOVE(l,!0)),C.publish(D.Listener,E.Layers.HeaderDrag.Place,{RID:e,SHEETID:t,VERSION:o,ID:0,RANGE:M}),l=M)}}function a(){{var t=R.view.getResourceID(n),r=R.view.getSheetID(n),i=R.view.getVersionID(n),u=R.view.getSheetState(n,r),w=u.getActiveCellRange();w.startRow,w.startCol}"column"==v?l.endCol=l.startCol:l.endRow=l.startRow,d&&d.MOUSEUP&&d.MOUSEUP(l),C.publish(D.Listener,E.Layers.HeaderDrag.Remove,{RID:t,SHEETID:r,VERSION:i,ID:0}),e.removeEventListener("mouseup",a),e.removeEventListener("mousemove",s),e.removeEventListener("keydown",o)}var n,i,l,d,u,v,R=e.sPlusPlus,w=e.ZSEvents,C=w.topic,D=w.Groups,E=w.Names,g=(R.data.Defaults,!1);C.register(D.Listener,E.Mouse.HeaderDragStart,t,"COLX","ROWY","RANGE","SELECTION","CALLBACK")}(this);
!function(e){function n(e,n){return n||(n=document),n.getElementById(e)}function r(){var e=document.createElement("DIV");e.className="dbug_body",e.draggable=!0,e.style.display="none";var n=document.createElement("DIV");n.className="dbug_holder";var r=document.createDocumentFragment(),s=0;do{var o=document.createElement("DIV");o.className="dbug_markup dbug_lable",t(o,s);var d=document.createElement("DIV");d.className="dbug_markup dbug_content",s++,d.id=s,r.appendChild(o),r.appendChild(d)}while(3>s);var d=document.createElement("DIV");d.className="dbug_markup dbug_textscreen",d.id=s+1,r.appendChild(d),n.appendChild(r),e.appendChild(n),document.body.appendChild(e)}function t(e,n){switch(n){case 0:e.innerHTML="Req Q:";break;case 1:e.innerHTML="Ur Qid:";break;case 2:e.innerHTML="Last Xid"}}function s(){var e=g.ReqResp.Requests.length-1-g.ReqResp.currRequest;n("1").innerHTML=e}function o(e){n("2").innerHTML=e}function d(e){n("3").innerHTML=e}function i(e,r,t){""!=e?"WAITING_TIMER"===r?n("4").style.background="orange":"UN_ORDERED_TIMER"===r?n("4").style.background="green":"DELAY_TIMER"===r?n("4").style.background="red":"SYNC_CHECK_TIMER"===r&&(n("4").style.background="blue"):n("4").style.background="yellow",n("4").innerHTML=""!=e&&t?"refrsh for --"+t:""}var u=e.ZSEvents,a=u.topic,l=u.Groups,c=u.Names,g=e.ZSDevTools.Logger;g.FixedConsole=!1,g.openFixedConsole=function(){if(!this.FixedConsole){var e=document.querySelector(".dbug_body");e.style.display="",this.FixedConsole=!0}},g.closeFixedConsole=function(){if(g.FixedConsole){var e=document.querySelector(".dbug_body");e.style.display="none",this.FixedConsole=!1}},a.register(l.Listener,c.ZSDebugger.logReqRespInit,o,"RECEIVED"),a.register(l.Listener,c.ZSDebugger.logReqRespInit,d,"EXCUTED"),a.register(l.Listener,c.ZSDebugger.logRequestAddedInQueue,s,"REQUEST"),a.register(l.Listener,c.ZSDebugger.logRequestSend,s),a.register(l.Listener,c.ZSDebugger.logQaidReceived,o,"QAID","REQUEST"),a.register(l.Listener,c.ZSDebugger.logResponseProcessed,d,"XAID"),a.register(l.Listener,c.ZSDebugger.logRefreshTileIndicator,i,"MSG","BY","LASTXAID"),r()}(this,ZSEvents);
!function(e){function t(e){et=!0,v(!0);var t=G.view.getActiveGridID(),r=G.view.getResourceID(t),a=G.view.getSheetID(t),l=G.view.getVersionID(t),d=G.view.getGridComponent(t),g=d.getRelativeCoordinates(e),u=G.view.getSelectedSheets(t),c=G.view.getSheetState(t,a),C=c.getActiveRange();X.publish(V.Listener,P.Mouse.HeaderDragStart,{COLX:g.x,ROWY:g.y,RANGE:C,SELECTION:"column",CALLBACK:{MOUSEDOWN:i,MOUSEMOVE:n,MOUSEUP:s.bind(null,r,u,l,C),CANCEL:o}})}function i(){$.style.display="none"}function o(){ut=!1,et=!1,Y.classList.remove("grabbingCursor"),$.style.display="none"}function n(e,t){if(t){ut=!1;var i=0,o=G.view.getActiveGridID(),n=G.view.getResourceID(o),s=G.view.getSheetID(o),r=G.view.getVersionID(o),a=G.data.getWorkBook(n,r),l=a.getSheetObj(s),d=G.view.getSheetState(o,s),v=d.Zoom;i=l.Column.axis.getPos(e.startCol),$.style.left=i*v+"px",$.style.display=""}else $.style.display="none"}function s(e,t,i,o,n){var s=G.view.getActiveGridID(),e=G.view.getResourceID(s),a=G.view.getSheetID(s),i=G.view.getVersionID(s),l=G.data.getWorkBook(e,i),d=l.getSheetObj(a);return et=!1,v(!1),$.style.display="none",ut=!1,r(d,o.endCol-o.startCol+1)?void j.ZSAlert(W["InsertCol.Alert.InsertingNotPossibleBeyondMaxCol"],{title:W["Alert.Title.LimitExceeded"]}):void(o.endCol!==n.endCol&&o.startCol!==n.startCol&&UserAction.InsertCutCol(e,t,i,new Array(n),!0,new Array(o)))}function r(e,t){var i=G.data.Defaults.MAX_COL,o=e.MaxUsedCol;return o+t>=i?!0:!1}function a(e,t,i,o,n){var s=G.data.getWorkBook(t,o);if(!s.isEditable()||k(t,i,o,n))return!1;var r=s.getSheetObj(i),a=G.view.getGridComponent(n),l=a.getRelativeCoordinates(e),d=G.view.getSheetState(n,i),v=(d.getZoom(),r.Column.axis.findAbs(l.x)),g=r.Column.axis.getDim(v),u=r.Column.axis.getPos(v);return r.Column.hidden.prevNonHidden(v)<0?l.x-u>=g-K:l.x-u>=g-K||l.x-u<=K}function l(e,t,i,o,n){var s=G.data.getWorkBook(t,o),r=G.view.getGridComponent(n),a=r.getRelativeCoordinates(e),i=G.view.getSheetID(n),l=G.view.getSheetState(n,i),v=s.getSheetObj(i),g=v.Column.axis.findAbs(a.x),u=l.getActiveRange();return!s.isEditable()||k(t,i,o,n)||d(u)?!1:u.isCol()&&b(g,u)}function d(e){return 0==e.startCol&&e.endCol==B.MAX_COL-1}function v(e){e?Y.classList.add("grabbingCursor"):Y.classList.remove("grabbingCursor")}function g(e,i){ot=i;{var o=G.view.getGridComponent(ot),n=o.getRelativeCoordinates(e),s=G.view.getResourceID(ot),r=G.view.getSheetID(ot),d=G.view.getVersionID(ot),v=G.view.getSheetState(ot,r),g=G.data.getWorkBook(s,d),u=g.getSheetObj(r),v=G.view.getSheetState(ot,r);u.Column.axis.findAbs(n.x),v.getActiveRange(),G.data.UserInfo.Permission.isEditable}if(e.which&&3===e.which||e.button&&2===e.button){var c=v.getRanges(),C=new z(void 0,!0,Z),h=C.ADD(u,n.x,n.y);X.publish(V.Listener,P.ContextMenu.SHOW,{RID:s,SHEETID:r,VERSION:d,CONTEXT:"CH"});for(var m=c.length,w=m-1;w>=0;w--)if(c[w].subset(h))return}e.preventDefault();var D=G.view.CellEditor.getEditStatus();D&&!j.RangePicker.isSelection()&&X.publish(V.Gesture.Selector.CellEdit,P.GESTURE.ACTION.ENUMERATE,{RID:s,SHEETID:r,VERSION:d,isSubmittable:1}),ut=!0,N||(N=j.RangePicker.isSelection),a(e,s,r,d,i)?p(e):!N()&&l(e,s,r,d,i)?t(e):S(e)}function u(e,t,i,o,n){var s=document.createElement("div"),r=s.style;return r.position="absolute",r.top=t+"px",r.left=e+"px",r.width=o+"px",r.height=i+"px",r.backgroundColor=n,Y.appendChild(s),s}function c(e,t,i){var o=document.createElement("div");o.className="rrzeHlpTxt";var n=o.style;return n.position="absolute",n.top=t+2+"px",n.left=e+2+"px",o.setAttribute("data-check","Width : "+i+"px"),Y.appendChild(o),o}function C(e,t){var i=e.Column.axis.findAbs(t),o=e.Column.axis.getPos(i);return o+K>t&&(i=e.Column.hidden.prevNonHidden(i),0>i&&(i=0)),i}function p(e){if(ct)return void(ct=!1);ct=!0,setTimeout(function(){ct=!1},350);var t=G.view.getResourceID(ot),i=G.view.getSheetID(ot),o=G.view.getVersionID(ot),n=G.data.getWorkBook(t,o),s=n.getSheetObj(i),r=G.view.getGridComponent(ot),a=r.getRelativeCoordinates(e),l=r.getRects(),d=r.rowHeader0?r.rowHeader0.getRects().width:0,v=r.vScroll?r.vScroll.getRects().width:0,g=r.colHeader0?r.colHeader0.getRects().height:0,p=r.hScroll?r.hScroll.getRects().height:0,w=C(s,a.x),S=l.left+d,D=l.top+g,R=l.height-(g+p),I=l.width-(d+v);st=u(e.pageX,D,R,1,"#999"),rt=u(S,D,R,I,""),lt=e.pageX,vt=w,dt=s.Column.axis.getDim(vt),gt=dt,at=c(e.pageX,T.gridTop,dt);var f=G.view.getSheetState(ot,i);nt=f.getZoom(),Y.addEventListener("mousemove",h),Y.addEventListener("mouseup",m)}function h(e){var t=e.pageX-lt;t/=nt,gt=dt+t,0>=gt?(st.style.left=e.pageX-gt+"px",at.style.left=e.pageX-gt+2+"px",gt=0,at.setAttribute("data-check","Hide")):(st.style.left=e.pageX+"px",at.style.left=e.pageX+2+"px",gt=Math.round(gt),at.setAttribute("data-check","Width:"+gt+"px"))}function m(e){ut=!1;{var t=G.view.getGridComponent(ot);t.getRelativeCoordinates(e)}Y.removeChild(st),Y.removeChild(at),Y.removeChild(rt),Y.removeEventListener("mousemove",h),Y.removeEventListener("mouseup",m);var i=gt,o=G.view.getResourceID(ot),n=G.view.getSheetID(ot),s=G.view.getVersionID(ot),r=G.view.getSelectedSheets(ot),a=G.view.getSheetState(ot,n),l=a.getActiveRange(),d=new j.Range(0,vt,B.MAX_ROW-1,vt);if(i){var v=G.data.getWorkBook(o,s),g=v.getSheetObj(n),u=g.Column.axis.getDim(d.startCol);u!==i&&(l.subset(d)?UserAction.ResizeCol(o,r,s,i,l.startCol,l.getColSpan(),!1,!0):UserAction.ResizeCol(o,r,s,i,vt,1,!1,!1))}else l.subset(d)?UserAction.HideCol(o,r,s,"HIDE",l):UserAction.HideCol(o,r,s,"HIDE",d)}function w(e){if(!N()){var t=e.target.classList;t.add("grabCursor"),Q.classList.add("cDropDownSelection")}}function S(t){var i=G.view.getResourceID(ot),o=G.view.getSheetID(ot),n=G.view.getVersionID(ot);if(t.shiftKey)return void I(t);var s=0;(t.metaKey||t.ctrlKey&&-1==e.navigator.platform.toUpperCase().indexOf("MAC"))&&(s=1);var r=G.view.getGridComponent(ot),a=r.getRelativeCoordinates(t),l={RID:i,SHEETID:o,VERSION:n,ROWY:a.y,COLX:a.x,ACTIVEX:a.x,ACTIVEY:a.y,ACCUMULATE:s,metaKey:t.metaKey,TYPE:_.COLUMN,GRID_ID:G.view.Defaults.activeGrid};X.publish(V.Listener,P.Mouse.RangeDown,l),X.publish(V.Listener,P.Mouse.ScrollOutColX,{GRIDID:ot,CALLBACK:R}),et||(Y.addEventListener("mousemove",D),Y.addEventListener("mouseup",I)),w(t)}function D(e){var t=G.view.getGridComponent(ot),i=t.getRelativeCoordinates(e),o=G.view.getResourceID(ot),n=G.view.getSheetID(ot),s=G.view.getVersionID(ot),r={RID:o,SHEETID:n,VERSION:s,RANGEID:0,ROWY:i.y,COLX:i.x,TYPE:_.COLUMN};X.publish(V.Listener,P.Mouse.RangeMove,r),w(e)}function R(e,t,i,o,n,s){var r={RID:e,SHEETID:t,VERSION:i,RANGEID:0,ROWY:n,COLX:o,TYPE:s};X.publish(V.Listener,P.Mouse.RangeEnd,r)}function I(e){var t=G.view.getGridComponent(ot),i=t.getRelativeCoordinates(e),o=G.view.getResourceID(ot),n=G.view.getSheetID(ot),s=G.view.getVersionID(ot);ut=!1;var r={RID:o,SHEETID:n,VERSION:s,RANGEID:0,ROWY:i.y,COLX:i.x,TYPE:_.COLUMN};X.publish(V.Listener,P.Mouse.RangeEnd,r),Y.removeEventListener("mouseup",I),Y.removeEventListener("mousemove",D)}function f(e,t,i,o){var n=!1;return e>=i-(K+q)&&(tt.style.display="block",tt.style.left=(t+i)*o-(K+q+3)+"px",it.style.display="block",it.style.left=(t+i)*o-2+"px",n=!0),n}function E(e,t,i){var o=!1;return K+q>=e&&(tt.style.display="block",tt.style.left=t*i-(K+q+3)+"px",it.style.display="block",it.style.left=t*i-2+"px",o=!0),o}function y(e,t,i){J.style.display="",J.style.left=e*i+"px",J.style.width=t*i+"px"}function A(e,t){if(!ut){var i=e.target.classList,o=G.view.getResourceID(t),n=G.view.getSheetID(t),s=G.view.getVersionID(t),r=G.data.getWorkBook(o,s),d=r.getSheetObj(n),v=G.view.getGridComponent(t),g=v.getRelativeCoordinates(e),u=d.Column.axis.findAbs(g.x),c=d.Column.axis.getDim(u),C=d.Column.axis.getPos(u),p=G.view.getSheetState(t,n),h=(p.getActiveRange(),p.getZoom()),m=G.data.UserInfo.Permission.isEditable;M!==this.header&&(this.cueHolder.appendChild(J),m&&(this.cueHolder.appendChild(tt),this.cueHolder.appendChild(it)),this.cueHolder.appendChild($),M=this.header);var w=d.Column.hidden,S=!1;if(o){var D=g.x-C*h;w.prevNonHidden(u)+1!==u&&u>0?S=w.nextNonHidden(u)-1!==u&&u<B.MAX_COL?E(D,C,h)||f(D,C,c,h):E(D,C,h):w.nextNonHidden(u)-1!==u&&u<B.MAX_COL?S=f(D,C,c,h):(tt.style.display="none",it.style.display="none")}i.remove("grabCursor"),i.remove("ssHScrollResizeCue"),i.remove("ssHScrollResizeCue"),Q.classList.remove("cDropDownSelection"),N||(N=j.RangePicker.isSelection),o&&a(e,o,n,s,t)?(i.add("ssHScrollResizeCue"),this.cueHolder.style.cursor="col-resize",J.style.display="none"):!N()&&l(e,o,n,s,t)?(i.add("grabCursor"),Q.classList.add("cDropDownSelection"),this.cueHolder.style.cursor="",!S&&c>F&&y(C,c,h)):(this.cueHolder.style.cursor="",!S&&c>F&&y(C,c,h))}}function b(e,t){var i=new j.Range(0,e,B.MAX_ROW-1,e);return t.intersects(i)}function x(e,t){e.stopPropagation();var i=G.view.getResourceID(t),o=G.view.getSheetID(t),n=G.view.getVersionID(t),s=G.view.getSelectedSheets(t),r=G.data.getWorkBook(i,n),a=r.getSheetObj(o),l=G.view.getGridComponent(t),d=l.getRelativeCoordinates(e),v=a.Column.axis.findAbs(d.x),g=(a.Column.axis.getDim(v),a.Column.hidden),u=g.nextNonHidden(v);256===u&&(u=255);var c=new j.Range(0,v,65536,u);UserAction.HideCol(i,s,n,"SHOW",c),tt.style.display="none",it.style.display="none"}function L(e,t){e.stopPropagation();var i=G.view.getResourceID(t),o=G.view.getSheetID(t),n=G.view.getVersionID(t),s=G.view.getSelectedSheets(t),r=G.data.getWorkBook(i,n),a=r.getSheetObj(o),l=G.view.getGridComponent(t),d=l.getRelativeCoordinates(e),v=a.Column.axis.findAbs(d.x),g=(a.Column.axis.getDim(v),a.Column.hidden),u=g.prevNonHidden(v);-1===u&&(u=0);var c=new j.Range(0,u,65536,v);UserAction.HideCol(i,s,n,"SHOW",c),tt.style.display="none",it.style.display="none"}function O(e,t){var i=G.view.getResourceID(t),o=G.view.getSheetID(t),n=G.view.getVersionID(t);if(i&&o&&a(e,i,o,n,t)){var s=G.data.getWorkBook(i,n),r=G.view.getGridComponent(t),l=r.getRelativeCoordinates(e),d=s.getSheetObj(o),v=C(d,l.x);lt=e.pageX,vt=v,Y.removeEventListener("mousemove",h),Y.removeEventListener("mouseup",m);var g=d.Column.axis.getDim(v),u=G.view.getSelectedSheets(ot),c=G.view.getSheetState(ot,o),p=c.getActiveRange(),w=new j.Range(0,vt,B.MAX_ROW-1,vt);p.subset(w)?UserAction.ResizeCol(i,u,n,g,p.startCol,p.getColSpan(),!0,!0):UserAction.ResizeCol(i,u,n,g,vt,1,!0,!1),ut=!1,this.cueHolder.style.cursor=""}}function H(e,t){var i=this;e.addEventListener("dblclick",function(e){O.call(i,e,t)}),e.addEventListener("mousedown",function(e){g(e,t)}),e.addEventListener("mousemove",function(e){A.call(i,e,t)}),e.addEventListener("mouseleave",function(){J.style.display="none",tt.style.display="none",it.style.display="none",et||($.style.display="none")})}function k(e,t,i,o){var n=G.view.getSheetState(o,t),s=(n.getActiveRange(),G.data.getWorkBook(e,i));return s.ProtectedSheets.isSheetLocked(t)}var N,M,G=e.sPlusPlus,T=G.view.measures,W=e.ZSConstants.I18N,U=e.ZSEvents,X=U.topic,V=U.Groups,P=U.Names,B=G.data.Defaults,j=e.ZSClass,_=j.SelectorHelper.Constants.TYPE,Y=document.body,z=j.Selector.Assistor,Z=j.SelectorHelper.Constants.MULTI_DIRECTION,K=5,q=5,F=40,J=document.createElement("div");J.className="cDropDownContainer";var Q=document.createElement("section");Q.className="cDropDown";var $=document.createElement("div");$.classList.add("dragAndDropCueColHandler"),$.style.display="none",Q.setAttribute("data-menu-id","MI_COLHEAD_CONTEXT"),J.appendChild(Q);var et=!1;Q.addEventListener("mousedown",function(e){var t=G.view.getActiveGridID(),i=G.view.getResourceID(t),o=G.view.getSheetID(t),n=G.view.getVersionID(t),s=G.view.getSheetState(t,o),r=s.getActiveRange(),a=G.view.getGridComponent(t),l=a.getRelativeCoordinates(e),d=G.data.getWorkBook(i,n),v=d.getSheetObj(o),g=v.Column.axis.findAbs(l.x),u=new j.Range(0,g,B.MAX_ROW-1,g);r.subset(u)&&e.stopPropagation()});var tt=document.createElement("span");tt.title=W["Show.Cols"],tt.className="leftHSContainer hiddenLeftCue";var it=document.createElement("span");it.title=W["Show.Cols"],it.className="rightHSContainer hiddenRightCue",tt.addEventListener("mousedown",function(e){if(3!=e.which&&2!=e.button){var t=G.view.getActiveGridID();x(e,t)}}),it.addEventListener("mousedown",function(e){if(3!=e.which&&2!=e.button){var t=G.view.getActiveGridID();L(e,t)}});var ot,nt,st,rt,at,lt,dt,vt,gt,ut=!1,ct=!1;j.UIColHeader.prototype.addMouseListener=H}(this);
!function(e){function t(e){gt=!0,l(!0);var t=T.view.getActiveGridID(),s=T.view.getResourceID(t),r=T.view.getSheetID(t),a=T.view.getVersionID(t),d=T.view.getGridComponent(t),v=d.getRelativeCoordinates(e),u=T.data.getWorkBook(s,a),c=u.getSheetObj(r),w=T.view.getSelectedSheets(t),R=T.view.getSheetState(t,r),p=R.getActiveRange(),h=c.Row.auxiliaryAxis.findAbs(v.y),y=new j.Range(h,0,h,X.MAX_COL-1);p.subset(y)||g(e,t),U.publish(Y.Listener,B.Mouse.HeaderDragStart,{COLX:v.x,ROWY:v.y,RANGE:p,SELECTION:"row",CALLBACK:{MOUSEMOVE:o,MOUSEUP:n.bind(null,s,w,a,p),CANCEL:i}})}function i(){Q=!1,gt=!1,z.classList.remove("grabbingCursor"),ot.style.display="none"}function o(e,t){if(t){Q=!1;var i=0,o=T.view.getActiveGridID(),n=T.view.getResourceID(o),s=T.view.getSheetID(o),r=T.view.getVersionID(o),a=T.data.getWorkBook(n,r),d=a.getSheetObj(s),l=T.view.getSheetState(o,s),v=l.Zoom;i=d.Row.auxiliaryAxis.getPos(e.startRow),ot.style.top=i*v+"px",ot.style.display=""}else ot.style.display="none"}function n(e,t,i,o,n){var r=T.view.getActiveGridID(),e=T.view.getResourceID(r),a=T.view.getSheetID(r),i=T.view.getVersionID(r),d=T.data.getWorkBook(e,i),v=d.getSheetObj(a);return gt=!1,l(!1),ot.style.display="none",Q=!1,s(v,o.endRow-o.startRow+1)?void j.ZSAlert(W["InsertRow.Alert.InsertingNotPossibleBeyondMaxRow"],{title:W["Alert.Title.LimitExceeded"]}):void(o.endRow!==n.endRow&&o.startRow!==n.startRow&&UserAction.InsertCutRow(e,t,i,new Array(n),!0,new Array(o)))}function s(e,t){var i=T.data.Defaults.MAX_ROW,o=e.MaxUsedRow;return o+t>=i?!0:!1}function r(e,t,i,o,n){var s=T.data.getWorkBook(t,o);if(!s.isEditable()||O(t,i,o,n))return!1;var r=s.getSheetObj(i),a=T.view.getGridComponent(n),d=a.getRelativeCoordinates(e),l=r.Row.auxiliaryAxis.findAbs(d.y),v=r.Row.auxiliaryAxis.getDim(l),g=r.Row.auxiliaryAxis.getPos(l);return r.Row.Visibility.prevNonHidden(l)<0?d.y-g>=v-F:d.y-g>=v-F||d.y-g<=F}function a(e,t,i,o,n){var s=T.data.getWorkBook(t,o),r=T.view.getGridComponent(n),a=r.getRelativeCoordinates(e),i=T.view.getSheetID(n),l=T.view.getSheetState(n,i),v=s.getSheetObj(i),g=v.Row.auxiliaryAxis.findAbs(a.y),u=l.getActiveRange();return!s.isEditable()||O(t,i,o,n)||d(u)?!1:u.isRow()&&L(g,u)}function d(e){return 0==e.startRow&&e.endRow==X.MAX_ROW-1}function l(e){e?z.classList.add("grabbingCursor"):z.classList.remove("grabbingCursor")}function v(e,t){var i=e.Row.auxiliaryAxis.findAbs(t),o=e.Row.auxiliaryAxis.getPos(i);return o+F>t&&(i=e.Row.Visibility.prevNonHidden(i),0>i&&(i=0)),i}function g(e,i){N=i;{var o=T.view.getGridComponent(N),n=o.getRelativeCoordinates(e),s=T.view.getResourceID(N),d=T.view.getSheetID(N),l=T.view.getVersionID(N),v=T.view.getSheetState(N,d),g=T.data.getWorkBook(s,l),u=g.getSheetObj(d),v=T.view.getSheetState(N,d);u.Row.auxiliaryAxis.findAbs(n.y),v.getActiveRange()}if(e.which&&3===e.which||e.button&&2===e.button){var c=v.getRanges(),R=new K(void 0,!0,Z),p=R.ADD(u,n.x,n.y);U.publish(Y.Listener,B.ContextMenu.SHOW,{RID:s,SHEETID:d,VERSION:l,CONTEXT:"RH"});for(var y=c.length,S=y-1;S>=0;S--)if(c[S].subset(p))return}e.preventDefault();var D=T.view.CellEditor.getEditStatus();D&&!j.RangePicker.isSelection()&&U.publish(Y.Gesture.Selector.CellEdit,B.GESTURE.ACTION.ENUMERATE,{RID:s,SHEETID:d,VERSION:l,isSubmittable:1}),Q=!0,k||(k=j.RangePicker.isSelection),r(e,s,d,l,i)?w(e):!k()&&a(e,s,d,l,i)?t(e):h(e)}function u(e,t,i,o,n){var s=document.createElement("div"),r=s.style;return r.position="absolute",r.top=t+"px",r.left=e+"px",r.width=o+"px",r.height=i+"px",r.backgroundColor=n,z.appendChild(s),s}function c(e,t,i){var o=document.createElement("div");o.className="rrzeHlpTxt";var n=o.style;return n.position="absolute",n.top=t+2+"px",n.left=e+2+"px",o.setAttribute("data-check","Height : "+i+"px"),z.appendChild(o),o}function w(e){if(ut)return void(ut=!1);ut=!0,setTimeout(function(){ut=!1},350);var t=T.view.getResourceID(N),i=T.view.getSheetID(N),o=T.view.getVersionID(N),n=T.data.getWorkBook(t,o),s=n.getSheetObj(i),r=T.view.getSheetState(N,i);G=r.getZoom();var a=T.view.getGridComponent(N),d=a.getRelativeCoordinates(e),l=a.getRects(),g=a.rowHeader0?a.rowHeader0.getRects().width:0,w=a.vScroll?a.vScroll.getRects().width:0,h=a.colHeader0?a.colHeader0.getRects().height:0,y=a.hScroll?a.hScroll.getRects().height:0,S=v(s,d.y),D=l.left+g,m=l.top+h,I=l.height-(h+y),A=l.width-(g+w);nt=u(D,e.pageY,1,A,"#999"),st=u(D,m,I,A,""),at=e.pageY,lt=S,dt=s.Row.axis.getDim(lt),vt=dt,rt=c(V.gridLeft,e.pageY,dt),z.addEventListener("mousemove",R),z.addEventListener("mouseup",p)}function R(e){var t=e.pageY-at;t/=G,vt=dt+t,0>vt?(nt.style.top=e.pageY-vt+"px",rt.style.top=e.pageY-vt+2+"px",vt=0,rt.setAttribute("data-check","Hide")):(nt.style.top=e.pageY+"px",rt.style.top=e.pageY+2+"px",vt=Math.round(vt),rt.setAttribute("data-check","Height : "+vt+"px"))}function p(e){Q=!1;{var t=T.view.getGridComponent(N);t.getRelativeCoordinates(e)}z.removeChild(nt),z.removeChild(st),z.removeChild(rt),z.removeEventListener("mousemove",R),z.removeEventListener("mouseup",p);var i=vt,o=T.view.getResourceID(N),n=T.view.getSheetID(N),s=T.view.getVersionID(N),r=T.view.getSelectedSheets(N),a=T.view.getSheetState(N,n),d=a.getActiveRange(),l=new j.Range(lt,0,lt,X.MAX_COL-1);i?d.subset(l)?UserAction.ResizeRow(o,r,s,i,d.startRow,d.getRowSpan(),!1,!0):UserAction.ResizeRow(o,r,s,i,lt,1,!1,!1):d.subset(l)?UserAction.HideRow(o,r,s,"HIDE",d):UserAction.HideRow(o,r,s,"HIDE",l)}function h(t){{var i=T.view.getResourceID(N),o=T.view.getVersionID(N),n=T.view.getSheetID(N),s=T.data.getWorkBook(i,o);s.getSheetObj(n)}if(t.shiftKey)return void m(t);var r=0;(t.metaKey||t.ctrlKey&&-1==e.navigator.platform.toUpperCase().indexOf("MAC"))&&(r=1);var a=T.view.getGridComponent(N),d=a.getRelativeCoordinates(t),l={RID:i,SHEETID:n,VERSION:o,ROWY:d.y,COLX:d.x,ACTIVEX:d.x,ACTIVEY:d.y,metaKey:t.metaKey,TYPE:_,ACCUMULATE:r,GRID_ID:T.view.Defaults.activeGrid};U.publish(Y.Listener,B.Mouse.RangeDown,l),U.publish(Y.Listener,B.Mouse.ScrollOutRowY,{GRIDID:N,CALLBACK:D}),gt||(z.addEventListener("mousemove",S),z.addEventListener("mouseup",m)),y(t)}function y(e){if(!k()){var t=e.target.classList;t.add("grabCursor")}}function S(e){var t=T.view.getGridComponent(N),i=t.getRelativeCoordinates(e),o=T.view.getResourceID(N),n=T.view.getSheetID(N),s=T.view.getVersionID(N),r={RID:o,SHEETID:n,VERSION:s,RANGEID:0,ROWY:i.y,COLX:i.x,TYPE:_};U.publish(Y.Listener,B.Mouse.RangeMove,r),y(e)}function D(e,t,i,o,n,s){var r={RID:e,SHEETID:t,VERSION:i,RANGEID:0,ROWY:n,COLX:o,TYPE:s};U.publish(Y.Listener,B.Mouse.RangeEnd,r)}function m(e){var t=T.view.getGridComponent(N),i=t.getRelativeCoordinates(e),o=T.view.getResourceID(N),n=T.view.getSheetID(N),s=T.view.getVersionID(N);Q=!1;var r={RID:o,SHEETID:n,VERSION:s,RANGEID:0,ROWY:i.y,COLX:i.x,TYPE:_};U.publish(Y.Listener,B.Mouse.RangeEnd,r),z.removeEventListener("mouseup",m),z.removeEventListener("mousemove",S)}function I(e,t,i,o){var n=!1;return e>=i-(F+q)&&(tt.style.display="block",tt.style.top=(t+i)*o-(F+q+4)+"px",it.style.display="block",it.style.top=(t+i)*o+"px",n=!0),n}function A(e,t,i){var o=!1;return F+q>=e&&(tt.style.display="block",tt.style.top=t*i-(F+q+4)+"px",it.style.display="block",it.style.top=t*i+"px",o=!0),o}function C(e,t){e.stopPropagation();var i=T.view.getResourceID(t),o=T.view.getSheetID(t),n=T.view.getVersionID(t),s=T.view.getSelectedSheets(t),r=T.data.getWorkBook(i,n),a=r.getSheetObj(o),d=T.view.getGridComponent(t),l=d.getRelativeCoordinates(e),v=a.Row.auxiliaryAxis.findAbs(l.y),g=(a.Row.auxiliaryAxis.getDim(v),a.Row.Visibility),u=g.nextNonHidden(v);65536===u&&(u=65535);var c=new j.Range(v,0,u,255);UserAction.HideRow(i,s,n,"SHOW",c),tt.style.display="none",it.style.display="none"}function E(e,t){e.stopPropagation();var i=T.view.getResourceID(t),o=T.view.getSheetID(t),n=T.view.getVersionID(t),s=T.view.getSelectedSheets(t),r=T.data.getWorkBook(i,n),a=r.getSheetObj(o),d=T.view.getGridComponent(t),l=d.getRelativeCoordinates(e),v=a.Row.auxiliaryAxis.findAbs(l.y+2),g=(a.Row.auxiliaryAxis.getDim(v),a.Row.Visibility),u=g.prevNonHidden(v);-1===u&&(u=0);var c=new j.Range(u,0,v,255);UserAction.HideRow(i,s,n,"SHOW",c),tt.style.display="none",it.style.display="none"}function b(e,t,i){$.style.display="",$.style.top=e*i+"px",$.style.height=t*i+"px"}function x(e,t){if(!Q){var i=T.view.getResourceID(t),o=T.view.getSheetID(t),n=T.view.getVersionID(t),s=e.target.classList,d=T.data.getWorkBook(i,n),l=d.getSheetObj(o),v=T.view.getGridComponent(t),g=v.getRelativeCoordinates(e),u=l.Row.auxiliaryAxis.findAbs(g.y),c=l.Row.auxiliaryAxis.getDim(u),w=l.Row.auxiliaryAxis.getPos(u),R=T.view.getSheetState(t,o),p=(R.getActiveRange(),R.getZoom()),h=T.data.UserInfo.Permission.isEditable;M!==this.header&&(this.cueHolder.appendChild($),h&&(this.cueHolder.appendChild(tt),this.cueHolder.appendChild(it)),this.cueHolder.appendChild(ot),M=this.header);var y=l.Row.Visibility,S=!1;if(i){var D=g.y-w*p,m=l.Row.Filter;y.prevNonHidden(u)+1!==u&&m.prevNonHidden(u)+1===u&&u>0?S=y.nextNonHidden(u)-1!==u&&m.nextNonHidden(u)-1===u&&u<X.MAX_ROW?A(D,w,p)||I(D,w,c,p):A(D,w,p):y.nextNonHidden(u)-1!==u&&m.nextNonHidden(u)-1===u&&u<X.MAX_ROW?S=I(D,w,c,p):(tt.style.display="none",it.style.display="none")}s.remove("grabCursor"),s.remove("ssHScrollResizeCue"),s.remove("ssHScrollResizeCue"),et.classList.remove("rDropDownSelection"),k||(k=j.RangePicker.isSelection),i&&o&&r(e,i,o,n,t)?(s.add("ssHScrollResizeCue"),this.cueHolder.style.cursor="row-resize",$.style.display="none"):!k()&&a(e,i,o,n,t)?(s.add("grabCursor"),et.classList.add("rDropDownSelection"),this.cueHolder.style.cursor="",!S&&c>J&&b(w,c,p)):(this.cueHolder.style.cursor="",!S&&c>J&&b(w,c,p))}}function f(e,t){var i=T.view.getResourceID(t),o=T.view.getSheetID(t),n=T.view.getVersionID(t);if(r(e,i,o,n,t)){var s=T.data.getWorkBook(i,n),a=s.getSheetObj(o),d=T.view.getGridComponent(t),l=d.getRelativeCoordinates(e),g=v(a,l.y);at=e.pageY,lt=g,dt=a.Row.auxiliaryAxis.getDim(lt),z.addEventListener("mousemove",R),z.addEventListener("mouseup",p);var u=a.Row.auxiliaryAxis.getDim(g),c=T.view.getSelectedSheets(N),w=T.view.getSheetState(N,o),h=w.getActiveRange(),y=new j.Range(lt,0,lt,X.MAX_COL-1);h.subset(y)?UserAction.ResizeRow(i,c,n,u,h.startRow,h.getRowSpan(),!0,!0):UserAction.ResizeRow(i,c,n,u,lt,1,!0,!1),Q=!1,this.cueHolder.style.cursor=""}}function L(e,t){var i=new j.Range(e,0,e,X.MAX_COL-1);return t.intersects(i)}function H(e,t){var i=this;e.addEventListener("dblclick",function(e){f.call(i,e,t)}),e.addEventListener("mousedown",function(e){g(e,t)}),e.addEventListener("mousemove",function(e){x.call(i,e,t)}),e.addEventListener("mouseleave",function(){$.style.display="none",tt.style.display="none",it.style.display="none",gt||(ot.style.display="none")})}function O(e,t,i,o){var n=T.view.getSheetState(o,t),s=(n.getActiveRange(),T.data.getWorkBook(e,i));return s.ProtectedSheets.isSheetLocked(t)}var k,N,G,M,T=e.sPlusPlus,V=T.view.measures,W=e.ZSConstants.I18N,P=e.ZSEvents,U=P.topic,Y=P.Groups,B=P.Names,X=T.data.Defaults,j=e.ZSClass,_=j.SelectorHelper.Constants.TYPE.ROW,z=document.body,K=j.Selector.Assistor,Z=j.SelectorHelper.Constants.MULTI_DIRECTION,F=5,q=3,J=15,Q=!1,$=document.createElement("div");$.className="rDropDownContainer";var et=document.createElement("section");et.className="rDropDown",et.setAttribute("data-menu-id","MI_ROWHEAD_CONTEXT"),et.addEventListener("mousedown",function(e){var t=T.view.getActiveGridID(),i=T.view.getResourceID(t),o=T.view.getSheetID(t),n=T.view.getVersionID(t),s=T.view.getSheetState(t,o),r=s.getActiveRange(),a=T.view.getGridComponent(t),d=a.getRelativeCoordinates(e),l=T.data.getWorkBook(i,n),v=l.getSheetObj(o),g=v.Row.auxiliaryAxis.findAbs(d.y),u=new j.Range(g,0,g,X.MAX_COL-1);r.subset(u)&&e.stopPropagation()});var tt=document.createElement("span");tt.title=W["Show.Rows"],tt.className="topHSContainer hiddenTopCue";var it=document.createElement("span");it.title=W["Show.Rows"],it.className="bottomHSContainer hiddenBottomCue",tt.addEventListener("mousedown",function(e){if(3!=e.which&&2!=e.button){var t=T.view.getActiveGridID();C(e,t)}}),it.addEventListener("mousedown",function(e){if(3!=e.which&&2!=e.button){var t=T.view.getActiveGridID();E(e,t)}}),$.appendChild(et);var ot=document.createElement("div");ot.classList.add("dragAndDropCueRowHandler"),ot.style.display="none";var nt,st,rt,at,dt,lt,vt,gt=!1,ut=!1;j.UIRowHeader.prototype.addMouseListener=H}(this);
!function(e){function t(e){var t=E.equals(e);t?(!v&&l.classList.add(D),v=!0):(v&&l.classList.remove(D),v=!1)}var a=e.sPlusPlus,s=a.view.measures,r=e.ZSEvents,i=r.topic,n=r.Groups,o=r.Names,g=e.ZSClass,c=a.data.Defaults,l=e.document.getElementsByClassName("wholeSheetSelector rowHeadWSpacer colHeadHSpacer headerColor")[0],u=g.SelectorHelper.Constants.TYPE;l.onmousedown=function(e){var t=e.target?e.target:e.srcElement;if(t==l){e.preventDefault();var r=a.view.getActiveGridID(),g=a.view.getResourceID(r),c=a.view.getSheetID(r),v=a.view.getVersionID(r),E={RID:g,SHEETID:c,VERSION:v,ROWY:e.pageY,COLX:e.pageX-s.gridLeft,ACTIVEX:e.pageX,ACTIVEY:e.pageY,metaKey:e.metaKey,TYPE:u.SHEET};i.publish(n.Listener,o.Mouse.RangeDown,E)}},l.onmouseup=function(e){var t=e.target?e.target:e.srcElement;if(t==l){var r=a.view.getActiveGridID(),g=a.view.getResourceID(r),c=a.view.getSheetID(r),v=a.view.getVersionID(r),E={RID:g,SHEETID:c,VERSION:v,RANGEID:0,ROWY:e.pageY,COLX:e.pageX-s.gridLeft,TYPE:u.SHEET};i.publish(n.Listener,o.Mouse.RangeEnd,E)}};var v,E=new g.Range(0,0,c.MAX_ROW-1,c.MAX_COL-1),D="whSlct";i.register(n.Selector.DomUpdate.Range,o.Selection.BOUND_UPDATE.ADD,t,"ActiveRange")}(this);
!function(e){function t(){l=this}function i(e){e.addListeners({focus:t.bind(e)})}function n(e,t){var i=l.value,n="",s="=";if(t=t||"","="===i.charAt(0)){var r=l.selectionStart,c=l.selectionEnd;s=i.substring(0,r),!/.*[;(;,=+\-\/*<>&^]$/g.test(s)&&(s+=","),n=i.substring(c,i.length)}var a=s+e+"("+t+")"+n,o=(s+e+"("+t).length;l.value=a,l.valueChanged(),l.setSelectionRange(o,o),l.selectionChanged()}function s(e,t,i,s,l){var c=r.view.getActiveGridID(),a=r.view.getSheetState(c,t),S=r.view.CellEditor.getEditStatus();S||(o.publish(u.Selector.BoundUpdate.CellEdit,E.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:a.getActiveCellRange(),RANGEID:0,TYPE:void 0}),o.publish(u.Listener,E.CellAction.VALUE.SET,{RID:e,SHEETID:t,VERSION:i,ROW:a.getActiveRow(),COL:a.getActiveCol(),VALUE:{DisplayValue:"="},FOCUS:!0})),n(s,l)}var l,r=e.sPlusPlus,c=e.ZSClass,a=e.ZSEvents,o=a.topic,u=a.Groups,E=a.Names;o.create(u.Listener,"InsertFunction"),o.register(u.Listener,"InsertFunction",s,"RID","SHEETID","VERSION","FUNCTION","ARGS"),c.InsertFunction={register:i}}(this);
!function(e){function t(e,t,E,I){for(var T in I){var c=I[T],o=c[r.TYPE],R=c[r.META];switch(o){case S.MACRO:s.publish(n.UserAction,A.UserAction.MACRO.UPDATE_MACROACTION_RESULTS,{meta:R});break;case S.CUT_PASTE:var a=i.view.getActiveGridID(),C=i.view.getSheetID(a);s.publish(n.Listener,A.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:E});break;case S.SYSTEMCLIP_PASTE:case S.FILLSERIES:case S.SERVERCLIP_PASTE_RANGE:var D=i.view.getActiveGridID(),t=i.view.getSheetID(D);if(c[1][0][1][0].length>1)return void s.publish(n.Listener,A.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:t,VERSION:E});("undefined"==typeof c[1][0][2]||c[1][0][2])&&(c.push(I[T][1][0][4][0][0]),s.publish(n.Listener,A.CellAction.WidgetAction.RECAST_WIDEGT,{RID:e,SHEETID:t,VERSION:E,META:c}))}}}var i=e.sPlusPlus,E=e.ZSEvents,s=E.topic,n=E.Groups,A=E.Names,S=e.ZSConstants.CommandConstants,r={TYPE:0,META:1};s.register(n.Listener,A.UserAction.UserNotification,t,"RID","SHEETID","VERSION","META")}(this);
!function(e){var t=e.sPlusPlus,s=(e.ZSClass,e.ZSEvents),i=s.topic,c=s.Groups,n=s.Names;t.view.getSelectedSheets=function(e){return r.get(e)},t.view.addSelectedSheet=function(e,t,s){r.add(e,t,s)},t.view.selectedSheets={};var r={add:function(e,s,i){s=s?s:t.view.getActiveGridID(),i?(!t.view.selectedSheets[s]&&(t.view.selectedSheets[s]=[]),!this.isExist(e,this.get(s))&&t.view.selectedSheets[s].push(e)):t.view.selectedSheets[s]=[e]},get:function(e){var s=t.view.selectedSheets[e];return s},isExist:function(e,t){for(var s=!1,i=0;i<t.length;i++)if(t[i]===e){s=!0;break}return s}};i.register(c.Listener,n.DocMeta.ACTIVE_SHEET,r.add,"ACTIVE_SHEET")}(this);
!function(e){function n(e,n){return!e&&(e=""),new RegExp(e,n)}function i(e){var n="";return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),new RegExp("^"+e.source+"$",n)}function t(e){return e+"*"}function r(e){return a(e)+"?"}function a(e){return"(?:"+e+")"}function u(e){return"("+e+")"}function l(e){return e=e.replace(/-/g,"\\-"),"["+e+"]"}function o(e){return l("^"+e)+"+"}var g=e.JSUtil,c={},s=o("'\\n"),f="'"+s+"'",R="[.!]",w=f+"|"+s,p="6553[0-6]|655[0-2][0-9]|65[0-4][0-9]{2}|6[0-4][0-9]{3}|[1-5][0-9]{4}|[1-9][0-9]{0,3}",A="[I][A-V]|[A-H]?[A-Z]",m=r("\\$"),v=a(A),d=t("0")+a(p),$=m+v+m+d,h=$+t(a(":"+$)),x=r(u(w)+R)+h,E=i(n(x,"i")),F=m+v+r(m+d),Z=t(a(F+":"))+m+v+t(a(":"+F))+":"+m+v+t(a(":"+F)),z=r(m+v)+m+d,C=t(a(z+":"))+m+d+t(a(":"+z))+":"+m+d+t(a(":"+z)),$=a(a($)+"|"+a(m+v)+"|"+a(m+d)),h=u(a(a(C)+"|"+a(Z)+"|"+a(h))),x=r(u(w)+R)+h,E=i(n(x,"i")),I=u(m)+u(r(v))+u(m)+u(r(d)),N=$+"|"+m+v+"|"+m+d,S="();,=+-/*<>&^\\s\\n",T='"'+r(o('"'))+'"?',U=n(a(T)+"|"+a(a(l(S))+"|"+a(r(f+R)+o('"'+S))),"gi"),_=x+t(a(l(";,")+x));c.rangeTest=i(n(_,"i")),c.matchRegex=U,c.rangeRegex=E,c.enclosedByQuotes=i(n(T)),c.seperatorRegex=i(n(l(S))),c.validCell=i(n($,"i")),c.cellRangeForReferenceToggling=i(n(I,"i")),c.splitCellReferencesInRange=n(N,"gi");var b="^((ht|f)tp(s?)://|www)[-.\\w]*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_@]*)?$",y="^(mailto:)?[\\w]([\\w-.+'/]*)@([\\w-.]*)(.[a-zA-Z]{2,22}(.[a-zA-Z]{2}){0,2})$",B="^(tel:)?[+]?[\\d-\\s]{1,21}$",G="[a-zA-Z0-9_ \\u00A1-\\uFFFF\\-]+";c.validURL=i(n(b,"i")),c.validEmail=i(n(y)),c.phoneNo=i(n(B)),c.validSheetName=i(n(G)),g.REGEXP=c}(this);
!function(e){function t(e){return e?parseInt((parseInt(e,36)-parseInt(Math.pow(10,e.length)-1,36)-1).toString(36),26)+1:0}function r(e,t,r){var n=r.match(s.rangeRegex);if(n){var l,c,g=i.data.getWorkBook(e,t);if(n[1]){if(l=n[1].replace(/^'(.+)'$/g,"$1"),l=l.replace(/^\$/,""),!g.SheetList.isNameExists(l))return;c=g.SheetList.getIdByName(l)}else{var f=i.view.CellEditor.getEditCell();if(f)c=f.getSheetID();else{var h=i.view.getActiveGridID();c=i.view.getSheetID(h)}var p=g.getSheetObj(c);l=p.Prop.Name}var u=n[2].match(s.splitCellReferencesInRange),v=65536,R=256,S=1,m=1;return u.forEach(function(e){var t=a(e);v=t.row?Math.min(t.row,v):1,S=t.row?Math.max(t.row,S):65536,R=t.col?Math.min(t.col,R):1,m=t.col?Math.max(t.col,m):256}),{sheetID:c,range:new o.Range(v-1,R-1,S-1,m-1),sheetName:l}}}function a(e){var r=s.cellRangeForReferenceToggling.exec(e);if(r){var a=t(r[2]),n=~~r[4];return{row:n,col:a}}}function n(e){if(-1!==e.indexOf(".")){var t=e.split(".")[0];if(-1!==t.indexOf(" ")){var r=t.replace("$",""),a=-1!==t.indexOf("$")?"$'"+r+"'."+e.split(".")[1]:"'"+r+"'."+e.split(".")[1];return a}return e}return e}{var i=e.sPlusPlus,l=e.ZSEvents,o=(l.topic,l.Groups,l.Names,e.ZSClass),s=e.JSUtil.REGEXP;s.rangeRegex}JSUtil.Range.parseRange=r,JSUtil.Range.cellData=a,JSUtil.Range.addApostrophe=n}(this);
!function(e){function t(e,t,l,o){var D=n.view.getActiveGridID(),c=n.view.getSheetID(D);t!=c?s.SwitchSheet(e,c,l,t,void 0,void 0,i.bind(null,e,t,l,o)):i(e,t,l,o)}function i(t,i,l,s){var r=n.view.getActiveGridID(),i=n.view.getSheetID(r);o.publish(D.Selector.BoundUpdate.Cell,c.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:i,VERSION:l,ActiveCellRange:new S.Range(s[0][0],s[0][1],s[0][0],s[0][1]),ROW:s[0][0],COL:s[0][1]}),o.publish(D.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:i,VERSION:l,RANGE:new S.Range(s[0][0],s[0][1],s[0][2],s[0][3])}),e.UserAction.ScrollCellIntoView(t,i,l,s[0][0],s[0][1])}var n=e.sPlusPlus,l=e.ZSEvents,o=l.topic,D=l.Groups,c=l.Names,s=e.UserAction,S=e.ZSClass;o.register(D.UserAction,c.UserAction.RANGE_HIGHLIGHT,t,"RID","SHEETID","VERSION","DATA")}(this);
!function(t){function s(t){this.list=t||[],this.chosen={},this.index=0}var i=(t.sPlusPlus,t.ZSClass);s.prototype={getIndex:function(){return this.index},get:function(t){return t=this.getKey(t),this.chosen[t]?this.chosen[t]:this.assign(t)},reset:function(){this.index=0,this.chosen={}},getKey:function(t){return t},assign:function(t){return t?(this.chosen[t]=this.getColor(this.index++),this.chosen[t]):void 0},getColor:function(t){return t%=this.list.length,this.list[t]}},i.UniqueChoser=s}(this);
!function(e){function t(e){n.call(this,e)}var s=e.sPlusPlus,i=e.ZSEvents,o=(i.topic,i.Groups,e.ZSClass),n=(e.JSUtil.REGEXP,o.UniqueChoser);t.prototype=new n,t.prototype.get=function(e){return e=this.getKey(e),e?this.chosen[e]?this.chosen[e]:this.assign(e):void 0},t.prototype.getKey=function(e){var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),o=s.view.getVersionID(t),n=JSUtil.Range.parseRange(i,o,e);if(n){var r=n.sheetID+"!"+n.range.getLabel();return r.toUpperCase()}},o.RangeColorChoser=t}(this);
!function(e){function t(e,t,n){var i=t+"_"+n,u=s.data.UserInfo.locale,p=t==u,d=s.data.AppRegistry.FUNCTION_URL,l=d&&d.endsWith(".js");if(p&&l){var h=document.createElement("script");return h.type="text/javascript",h.src=d,document.body.appendChild(h),!1}var f=p?"GET":"POST",N=p?d:"/sheet/fetchfunction.do",C=new XMLHttpRequest;C.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);c.Function=e,a.publish(o.Listener,r.DocAction.FUNCTIONS.FETCH,{JSON:e})}},C.open(f,N,!0),C.setRequestHeader("Content-type","application/x-www-form-urlencoded");var v="userlocale="+u+"&doclocale="+i;C.send(v)}var s=e.sPlusPlus,n=e.ZSEvents,a=n.topic,o=n.Groups,r=n.Names,c=e.ZSConstants;a.register(o.Listener,r.DocMeta.DOCUMENT_LOCALE,t,"RID","LANGUAGE","COUNTRY"),e.UserAction.fetchFunction=t}(this);
!function(t){function n(t){var n=new RegExp("[()*+-/.]","gi");return n.test(t)?"\\"+t:t}function e(t,n,e){var i=document.createElement("div");for(var s in n){var a=n[s];i.setAttribute(a,t[a])}if(!e){var r=document.createElement("span");i.appendChild(r),this.span=r}this.dom=i}function i(t,n,i,s,a,r,o){e.call(this,n,i,o),this.text=t,this.select=function(){s(this)}.bind(this),!!a&&(this.insert=function(){a(this)}.bind(this)),r&&r(this,n)}function s(t,n){t.appendChild(document.createTextNode(n))}function a(t,n){var e=document.createElement("span");s(e,n),t.appendChild(e)}var r=(t.sPlusPlus,t.ZSClass),o=r.AutoSuggest||(r.AutoSuggest={});i.prototype={decorate:function(t){var e=this.text,i=this.span;i.innerHTML="",t.split("").forEach(function(t){var r=new RegExp(n(t),"i"),o=e.search(r);s(i,e.substring(0,o)),a(i,e[o]),e=e.substring(o+1,e.length)}),s(i,e)},appendTo:function(t){t.appendChild(this.dom)}},o.Entry=i}(this);
!function(t){function i(t){t.appendTo(this.container)}function s(t){var i=this.container.scrollTop,s=t*this.height.inActive-i,e=s+this.height.active,n=this.height.container;0>s?this.container.scrollTop+=s:e>n&&(this.container.scrollTop+=e-n)}function e(t){t=~~t,this.list[t]&&(this.active&&this.active.dom.classList.remove("active"),this.index=t,this.active=this.list[t],this.active.dom.classList.add("active"),this.height&&s.call(this,t))}function n(t,i){this.container=t,this.height=i,this.list=[],this.index=0}var c=(t.sPlusPlus,t.ZSClass),h=c.AutoSuggest||(c.AutoSuggest={});n.prototype={add:function(t){this.list.push(t),i.call(this,t)},flush:function(){this.container.innerHTML="",this.list=[],this.index=0,this.removeActive()},increment:function(){e.call(this,this.index+1)},decrement:function(){e.call(this,this.index-1)},reset:function(){e.call(this,0)},removeActive:function(){this.active&&this.active.dom.classList.remove("active"),this.active=void 0},isEmpty:function(){return!this.list.length},select:function(){this.active&&this.active.select()},insert:function(){this.active&&this.active.insert()}},h.Selector=n}(this);
!function(t){function e(t){if(t){this.editor=t.editor,this.container=t.container,this.selector=new n(this.container,t.height),this.list=new Map,this.dataType=t.dataType||"Object",this.limit=t.limit,this.fuzzy=!!t.fuzzy,this.dontCreateSpan=t.dontCreateSpan;var e=t.data;for(var i in e){var s=e[i],a="Object"==this.dataType?i:s;this.list.set(a,new r(a,s,t.attributes||[],t.onSelect,t.onInsert,t.callBack,t.dontCreateSpan))}}}function i(t){var e=new RegExp("[()*+-/.]","gi");return e.test(t)?"\\"+t:t}var s=t.ZSClass||(t.ZSClass={}),a=s.AutoSuggest,r=a.Entry,n=a.Selector;e.prototype={suggest:function(t,e){var s=this.container,a=e||this.list,r=[],n=[],o=t;this.selector.flush(),o=o.replace(/.|$/g,function(t){return".*"+i(t)});var h=this;a.forEach(function(e,s){var a=new RegExp("^"+i(t),"gi"),c=new RegExp(o,"gi"),l=e;a.test(s)?r.push(l):h.fuzzy&&c.test(s)&&n.push(l)});var c=0;for(var l in r){if(this.limit&&++c>this.limit)break;var p=r[l];p.appendTo(s),p.decorate(t),this.selector.add(p)}for(var l in n){if(this.limit&&++c>this.limit)break;var p=n[l];p.appendTo(s),p.decorate(t),this.selector.add(p)}}},a.register=e}(this);
!function(t){function e(t){this.category=t.category,this.categoryList={},t.callBack=n.bind(this),r.register.call(this,t),s.call(this)}function s(){var t=this.suggest.bind(this),e=this.categoryList;this.category.addEventListener("change",function(){t("",e[this.value])});var s={input:a.bind(this),focus:a.bind(this)};this.editor.addListeners(s)}function i(e,s){var i=t.document.createElement("option");i.value=s,i.textContent=s,e.appendChild(i)}function n(e,s){var n=t.document.createElement("span");n.className="plus",n.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),this.insert()}.bind(e)),e.dom.addEventListener("mousedown",function(t){t.preventDefault(),this.select()}.bind(e)),e.dom.appendChild(n);var a=s.Category;!this.categoryList[a]&&i(this.category,a);var o=this.categoryList[a]||(this.categoryList[a]={});o[e.text]=e}function a(){var t=this.editor.value;this.suggest(t),this.selector.reset()}var o=(t.sPlusPlus,t.ZSClass),r=o.AutoSuggest;e.prototype=new r.register,r.Search=e}(this);
!function(t){function e(t){t.onSelect=l.bind(this),t.callBack=s,d.register.call(this,t);var e={input:c.bind(this),blur:u.bind(this),keydown:h.bind(this)};this.editor.addListeners(e)}function s(t){t.dom.addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),this.select()}.bind(t))}function n(t,e,s){{var n=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=t.substring(0,e),r=t.substring(s,t.length),o=e-i.split(n).pop().length,a=s+r.split(n)[0].length;t.substring(0,o),t.substring(a,t.length)}return{start:o,end:a}}function i(t,e){var s=t.substring(0,e);return!(s.split('"').length%2)}function r(t){var e=t.value,s=t.selectionStart;if("="!==e.charAt(0)||i(e,s))return"";var r=t.selectionEnd,o=n(e,s,r),a=e.substring(o.start,o.end);return a}function o(t,e){var s=t.value,i=t.selectionStart,r=t.selectionEnd,o=n(s,i,r),l=s.substring(0,o.start),c=s.substring(o.end,s.length),u=!!c[0]&&"("===c[0],h=l+e.text+(u?"":"(")+c,g=o.start+e.text.length+1;t.value=h,t.setSelectionRange(g,g),a(t.Editor,"input"),a(t.Editor,"selectionChanged")}function a(t,e){var e=new Event(e);t.dispatchEvent(e)}function l(t){this.selector.flush(),o(this.editor,t)}function c(){if("="===this.editor.value.charAt(0)){var t=r(this.editor);""===t?this.selector.flush():this.suggest(t),this.selector.reset()}}function u(){this.selector.flush()}function h(t){var e=t.keyCode||t.which;if(!this.selector.isEmpty())switch(e){case 40:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 37:case 39:this.selector.flush();break;case 13:t.preventDefault(),t.stopPropagation(),t.metaKey?this.selector.insert():this.selector.select();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}var g=(t.sPlusPlus,t.ZSClass),d=g.AutoSuggest;e.prototype=new d.register,d.Formula=e}(this);
!function(t){function e(t){this.editor=t.editor,this.container=t.container,this.selector=new h(this.container,t.height),this.list={},this.limit=t.limit,this.scrollLimit=t.scrollLimit,this.count=0,this.onInsert=t.onInsert,this.onScroll=t.onScroll,this.onMouseInsert=t.onMouseInsert,s.call(this)}function i(t){var e=t.dom,i=this;e.addEventListener("mousedown",function(){i.onMouseInsert(t)})}function s(){var t=this.editor,e={input:r.bind(this),focus:r.bind(this),blur:o.bind(this),keydown:n.bind(this)};t.addListeners(e);var i=this.container,s=this;i.addEventListener("scroll",function(){this.scrollHeight-this.scrollTop<s.selector.height.container+s.scrollLimit&&s.onScroll.call(s)})}function n(t){if("="!==this.editor.value.charAt(0)){var e=t.keyCode||t.which;if(this.selector.isEmpty())return;switch(e){case 40:case 39:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:case 37:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 9:t.preventDefault(),t.stopPropagation();break;case 13:t.preventDefault(),this.selector.insert(),this.selector.flush();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}}function r(){"="!==this.editor.value.charAt(0)&&this.suggest(this.editor.value)}function o(){this.selector.flush()}var a=t.ZSClass.AutoSuggest,c=a.Entry,h=a.Selector;e.prototype={suggest:function(t){var e=document.createDocumentFragment();this.selector.flush();var i=this.list;this.count=0;var s=0;for(var n in i){var r=i[n];if(this.suggestEntry(n,r,e,t),s++,s>2e3)break}this.container.appendChild(e),"{}"!=JSON.stringify(i),this.selector.reset()},suggestEntry:function(t,e,i,s){var n=new RegExp("^"+escape(s),"gi");if(n.test(t)){if(this.limit&&++this.count>this.limit)return;e.appendTo(i),e.decorate(s),this.selector.add(e)}},flush:function(){this.list={},this.selector.flush(),this.count=0},addEntry:function(t,e){var s=new c(t,t,[],this.onSelect,this.onInsert,i.bind(this));this.list[t]=s,this.suggestEntry(t,s,e||this.container)},addEntries:function(t){var e=document.createDocumentFragment();for(var i in t){var s=t[i];this.addEntry(s,e)}this.container.appendChild(e),this.container.style.display="block"}},a.DataValidation=e}(this);
!function(){function t(t,s,n,i){this.dom=t,this.text=s,this.onSelect=n,this.onInsert=i}var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});t.prototype={appendTo:function(t){t.appendChild(this.dom)},insert:function(){this.onInsert.call(this)},select:function(t){this.onSelect.call(this,t)}},s.Entry=t}(this);
!function(){function t(t,i){this.container=t,this.height=i,this.list=[],this.index=0}function i(t){t=~~t,this.list[t]&&(this.active&&this.active.dom.classList.remove("active"),this.index=t,this.active=this.list[t],this.active.dom.classList.add("active"),this.height&&s.call(this,t))}function s(t){var i=this.container.scrollTop,s=t*this.height.inActive-i,e=s+this.height.active,c=this.height.container;0>s?this.container.scrollTop+=s:e>c&&(this.container.scrollTop+=e-c)}var e=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});t.prototype={add:function(t,i){this.list.push(i)},flush:function(){this.container.innerHTML="",this.list=[],this.index=0,this.removeActive()},increment:function(){i.call(this,this.index+1)},decrement:function(){i.call(this,this.index-1)},reset:function(){i.call(this,0)},removeActive:function(){this.active&&this.active.dom.classList.remove("active"),this.active=void 0},isEmpty:function(){return!this.list.length},select:function(t){this.active&&this.active.select(t)},insert:function(t){this.active&&this.active.insert(t)}},e.selector=t}(this);
!function(t){function s(t,s,e,i){this.container=t,this.editor=s,this.select=e,this.selector=i,this.list={},this.allCategory=new ZSClass.AutoSuggest.AllCategory}{var e=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={}),i=t.sPlusPlus,o=t.ZSConstants.FeatureConstants;i.view.Toolbar.Feature[o.DELUGE]}s.prototype={suggest:function(t,s){this.container.innerHTML="";s=this.list[s]||this.allCategory;var e={},i={};s.suggest(t,e,i);var o=this.container;this.selector.flush();var n=this.selector;Object.keys(e).sort().forEach(function(t){e[t].appendTo(o),n.add(t,e[t])}),Object.keys(i).sort().forEach(function(t){i[t].appendTo(o),n.add(t,i[t])}),this.selector.reset()},isEmpty:function(){return this.selector.isEmpty()},getCategory:function(s){this.list[s];if(!this.list[s]){var e=new ZSClass.AutoSuggest.Category,i=t.document.createElement("option");i.value=s,i.textContent=s,this.select.appendChild(i),this.list[s]=e,this.allCategory.addCategory(e)}return this.list[s]},flush:function(t){t.flush()}},e.Search=s}(this);
!function(){function t(){this.map={}}function s(){this.categories=[]}var i=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});t.prototype={addEntry:function(t,s){this.map[t]=s},deleteEntry:function(t){delete this.map[t]},suggest:function(t,s,i){for(var e in this.map)e.startsWith(t)?s[e]=this.map[e]:e.contains(t)&&(i[e]=this.map[e])},flush:function(){this.map={}}},s.prototype={addCategory:function(t){this.categories.push(t)},suggest:function(t,s,i){for(var e=0;e<this.categories.length;e++){var o=this.categories[e];o.suggest(t,s,i)}}},i.Category=t,i.AllCategory=s}(this);
!function(){function t(t,s,n,i){this.dom=t,this.key=s,this.text=n,this.onInsert=i}var s=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});t.prototype={appendTo:function(t){t.appendChild(this.dom)},insert:function(){this.onInsert(this)}},s.FormulaEntry=t}(this);
!function(){function t(t,i){this.container=t,this.height=i,this.list=[],this.index=0}function i(t){var i=this.container.scrollTop,s=t*this.height.inActive-i,e=s+this.height.active,n=this.height.container;0>s?this.container.scrollTop+=s:e>n&&(this.container.scrollTop+=e-n)}function s(t){t=~~t,this.list[t]&&(this.active&&this.active.dom.classList.remove("active"),this.index=t,this.active=this.list[t],this.active.dom.classList.add("active"),this.height&&i.call(this,t))}var e=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});t.prototype={add:function(t,i){this.list.push(i)},flush:function(){this.container.innerHTML="",this.list=[],this.index=0,this.removeActive(),this.container.style.display="none"},increment:function(){s.call(this,this.index+1)},decrement:function(){s.call(this,this.index-1)},reset:function(){s.call(this,0)},removeActive:function(){this.active&&this.active.dom.classList.remove("active"),this.active=void 0},isEmpty:function(){return!this.list.length},insert:function(){this.active&&this.active.insert()}},e.Formulaselector=t}(this);
!function(t){function e(t,e,s){this.container=t,this.container.style.display="none",this.editor=e,this.selector=s,this.list={},this.allCategory=new l.AutoSuggest.FormulaAllCategory;var i={input:r.bind(this),blur:o.bind(this),keydown:a.bind(this)};u.ztooltip(this.container,{displayType:"callout",position:"right"}),this.editor.addListeners(i)}function s(t,e){var s=t.substring(0,e);return!(s.split('"').length%2)}function i(t,e,s){{var i=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,n=t.substring(0,e),r=t.substring(s,t.length),o=e-n.split(i).pop().length,a=s+r.split(i)[0].length;t.substring(0,o),t.substring(a,t.length)}return{start:o,end:a}}function n(t){var e=t.value,n=t.selectionStart;if("="!==e.charAt(0)||s(e,n))return"";var r=t.selectionEnd,o=i(e,n,r),a=e.substring(o.start,o.end);return a}function r(){if("="===this.editor.value.charAt(0)){var t=n(this.editor);""===t?this.selector.flush():this.suggest(t),this.selector.reset()}}function o(){this.selector.flush()}function a(t){var e=t.keyCode||t.which;if(!this.selector.isEmpty())switch(e){case 40:t.preventDefault(),t.stopPropagation(),this.selector.increment();break;case 38:t.preventDefault(),t.stopPropagation(),this.selector.decrement();break;case 37:case 39:this.selector.flush();break;case 13:t.preventDefault(),t.stopPropagation(),this.selector.insert();break;case 27:t.preventDefault(),t.stopPropagation(),this.selector.flush()}}var l=(t.sPlusPlus,t.ZSClass),u=t.UIUtil.Component,h=l.AutoSuggest||(l.AutoSuggest={});e.prototype={suggest:function(t){UserAction.flushSuggest(),this.container.style.display="",t=t.toUpperCase(),this.container.innerHTML="";var e=this.allCategory,s={};e.suggest(t,s);var i=this.container;this.selector.flush();var n=this.selector;Object.keys(s).sort().forEach(function(t){s[t].appendTo(i),n.add(t,s[t])}),"{}"!=JSON.stringify(s)&&(this.container.style.display="")},getCategory:function(e){this.list[e];if(!this.list[e]){var s=new l.AutoSuggest.FormulaCategory,i=t.document.createElement("option");i.value=e,i.textContent=e,this.list[e]=s,this.allCategory.addCategory(s)}return this.list[e]},flush:function(t){t.flush()}},h.Formula=e}(this);
!function(){function t(){this.map={}}function s(){this.categories=[]}var e=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={});t.prototype={addEntry:function(t,s){this.map[t]=s},deleteEntry:function(t){delete this.map[t]},getEntry:function(t){return this.map[t]},suggest:function(t,s){for(var e in this.map)t=t.toLowerCase(),t=t.startsWith("_")?t.substring(1,t.length):t,e.toLowerCase().startsWith(t)&&(s[e]=this.map[e])},flush:function(){this.map={}}},s.prototype={addCategory:function(t){this.categories.push(t)},suggest:function(t,s){for(var e=0;e<this.categories.length;e++){var i=this.categories[e];i.suggest(t,s)}},flush:function(){this.categories=[]}},e.FormulaCategory=t,e.FormulaAllCategory=s}(this);
!function(e){function n(e,n){this.container=e,this.editor=n;var a={keydown:t.bind(this)};this.editor.addListeners(a)}function t(e){var n=e.keyCode||e.which;switch(n){case 27:this.flush()}}var a=ZSClass.AutoSuggest||(ZSClass.AutoSuggest={}),i=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,r=(i.view.Toolbar.Feature[s.DELUGE],{NAME:0,CATEGORY:1,DESCRIPTION:2,SHORT_DESCRIPTION:3,MAX_ARGS:4,NECESSARY:5,OPTIONAL:6,EXTRA_PARAMS:7}),o={NAMES:0,DESCRIPTIONS:1,DATATYPES:2};n.prototype={flush:function(){this.container.innerHTML="",this.container.style.display="none"},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"},constructHelp:function(e,n){this.container.innerHTML="";var t=n.getEntry(e),a=t.key,i=ZSConstants.Function.functions,s=i[a.trim()],c=s[r.NAME],d=s[r.MAX_ARGS],l=s[r.NECESSARY],h=document.createElement("span");h.innerText=c,h.classList.add("formulaHelpLink"),h.addEventListener("mousedown",function(e){UserAction.functionSelection(c),e.stopPropagation(),e.preventDefault()}),this.container.appendChild(h);var p=document.createElement("span");p.classList.add("openBrace"),p.innerText="(",this.container.appendChild(p);var u=0;if(l&&l.length){var m=l[o.NAMES],a=m[0],v=document.createElement("span");v.innerText=a,v.classList.add("fParams"),this.container.appendChild(v);for(var f=1,E=m.length;E>f;f++){var a=m[f],T=", "+a,C=document.createElement("span");C.innerText=T,C.classList.add("fParams"),this.container.appendChild(C)}}var S=s[r.OPTIONAL];if(S&&S.length){var m=S[o.NAMES];u+=m.length;var g=!1,A="";u!==d&&(g=!0,A="1");var L=0;if(!l.length){L=1,A="1";var a=m[0];a+=A;var C=document.createElement("span");C.innerText=a,C.classList.add("fParams"),this.container.appendChild(C)}for(var f=L,E=m.length;E>f;f++){var a=m[f];a+=A;var C=document.createElement("span");C.innerText=", ["+a+"]",C.classList.add("fParams"),this.container.appendChild(C)}if(g){for(var f=0,E=m.length;E>f;f++){var a=m[f];a+="2";var C=document.createElement("span");C.innerText=", ["+a+"]",C.classList.add("fParams"),this.container.appendChild(C)}var C=document.createElement("span");C.innerText="...",C.classList.add("fParams"),this.container.appendChild(C)}}var P=document.createElement("span");P.innerText=")",this.container.appendChild(P),this.show()},delugeHelp:function(e){this.container.innerHTML="";var n=i.view.getActiveGridID(),t=i.view.getResourceID(n),a=i.data.DocRegistry[t].delugeFunctions,s=a.get(e),r=e,o=(s.returntype,s.arguments),c=(document.createDocumentFragment(),document.createElement("span"));c.innerText=r,c.classList.add("formulaHelpLink"),c.addEventListener("mousedown",function(){UserAction.functionSelection(r)}),this.container.appendChild(c);var d=document.createElement("span");d.innerText="( ",this.container.appendChild(d);var l=0;if(null!=o)for(var h=o.length,l=0;h>l;l++){var p=o[l],u=p.name;l!=h-1&&(u+=" , ");var m=document.createElement("span");m.innerText=u,this.container.appendChild(m)}var v=document.createElement("span");v.innerText=")",this.container.appendChild(v),this.show()}},a.SuggestToolTip=n}(this);
!function(e){function n(e){for(var n,t=[e],o="";n=t.pop();)if("BR"==n.nodeName)o+=String.fromCharCode(10);else if(3==n.nodeType)o+=n.textContent;else for(var r=n.childNodes.length;r--;)t.push(n.childNodes[r]);return o}function t(e){var t=e.innerText&&e.innerText.replace(/\r\n/g,"\n")||n(e);return t.replace(/(\n)$/,"")}function o(e,n){e.innerHTML="";for(var t=n.split("\n"),o=0;o<t.length;o++){var r=t[o];e.appendChild(document.createTextNode(r)),o<t.length-1&&(e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("")))}}function r(e,n){o(e,n),e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode(""))}function a(e){var n=window.getSelection(),t=n.getRangeAt(0),o=t.cloneRange();return o.selectNodeContents(e),o}function i(e){var t=e.cloneContents();return n(t).length}function d(e){var n=window.getSelection();if(!n.rangeCount)return 0;var t=a(e);return t.setEnd(n.anchorNode,n.anchorOffset),i(t)}function c(e){var n=window.getSelection();if(!n.rangeCount)return 0;var t=a(e);return t.setEnd(n.focusNode,n.focusOffset),i(t)}function s(e,n,o){var r=n>o;r&&(o=n+o,n=o-n,o-=n);var a=t(e),i=a.length;o=o>i?i:o;var d=l(e,n,o),c=window.getSelection();if(c.extend)r?f(d.focus,d.anchor):f(d.anchor,d.focus);else{var s=document.createRange();s.setStart(d.anchor.node,d.anchor.offset),s.setEnd(d.focus.node,d.focus.offset),c.removeAllRanges(),c.addRange(s)}}function f(e,n){var t=window.getSelection();e&&t.collapse(e.node,e.offset),n&&t.extend(n.node,n.offset)}function l(e,n,t){for(var o,r=0,a=[e],i=!1,d=!1,c={};!d&&(o=a.pop());)if("BR"===o.nodeName&&r++,3===o.nodeType){var s=r+o.length;!i&&n>=r&&s>=n&&(c.anchor={node:o,offset:n-r},i=!0),i&&t>=r&&s>=t&&(c.focus={node:o,offset:t-r},d=!0),r=s}else for(var f=o.childNodes.length;f--;)a.push(o.childNodes[f]);return c}function u(e,n,t,o,r){var a=function(){var e=this.value,r=n(e);r?t&&t():o&&o()}.bind(e),i={valueChanged:r?g(a,r):a};e.addListeners(i),a()}function g(e,n){var t;return function(){clearTimeout(t),t=setTimeout(e,n)}}function h(e){e.Editor.dataset.value=e.value?"yes":""}function v(e){function n(){h(e)}var t={blur:n};e.Editor.classList.add("anEdt"),e.addListeners(t),n()}var p=e.ZSClass,m=p.Editors||(p.Editors={}),C=m.Utility||(m.Utility={});C.setSelectionRange=s,C.getSelectionStart=d,C.getSelectionEnd=c,C.getText=t,C.setText=r,C.setTextForElement=o,C.addValidator=u,C.animateLabel=v,C.animateLabel.trigger=h}(this);
!function(e){function t(e){return new s(e,["value","selectionStart","selectionEnd"],function(t,s,i){e.value=t,e.valueChanged(),e.setSelectionRange(s,i),e.selectionChanged()})}function s(e,t,s){this.editorClass=e,this.props=t,this.setterFunction=s,this.undoStack=[],this.redoStack=[],this.Timer={KeyPress:void 0,Delete:void 0},this.recordForKeyPress=!0,this.recordForDelete=!0;var i={keydown:this.key.down.bind(this),keypress:this.key.press.bind(this),keyup:this.key.up.bind(this)};e.addListeners(i)}var i=e.ZSClass,r=i.Editors.Utility;s.prototype={record:function(){var e=this.get();this.undoStack.push(e),this.redoStack=[]},get:function(){var e=[];for(var t in this.props){var s=this.props[t];e.push(this.editorClass[s])}return e},set:function(e){this.setterFunction.apply(this,e)},undo:function(){this.undoStack.length>0&&(this.redoStack.push(this.get()),this.set(this.undoStack.pop()))},redo:function(){this.redoStack.length>0&&(this.undoStack.push(this.get()),this.set(this.redoStack.pop()))},key:{down:function(e){var t=e.keyCode?e.keyCode:e.which;if(e.metaKey||e.ctrlkey)switch(t){case 89:e.preventDefault(),e.stopPropagation(),this.redo();break;case 90:e.preventDefault(),e.stopPropagation(),e.shiftKey?this.redo():this.undo();break;case 86:case 88:this.record()}8!==t&&46!==t||!this.recordForDelete||(this.record(),this.recordForDelete=!1)},press:function(){this.recordForKeyPress&&(this.record(),this.recordForKeyPress=!1),setTimeout(function(){clearTimeout(this.Timer.KeyPress),this.Timer.KeyPress=setTimeout(function(){this.recordForKeyPress=!0}.bind(this),300)}.bind(this),0)},up:function(){this.recordForDelete||(clearTimeout(this.Timer.Delete),this.Timer.Delete=setTimeout(function(){this.recordForDelete=!0}.bind(this),300))}}},r.addUndoManager=t}(this);
!function(e){function t(e){return e&&e.match(h)||[]}function n(e,n,a){a="undefined"==typeof a?n:a,n>a&&(a=n+a,n=a-n,a-=n);var c=t(e),l=s(e,n,a),u=(l.allObjects,0);return c.forEach(function(e){r(l,e,u),u+=e.length}),l}function r(e,t,n){if(g.test(t))c(e,t,n);else{var r=e.allObjects;r.push(a(e,t,n))}}function s(e,t,n){return{source:e,start:t,end:n,allObjects:[],wholeRanges:[],selectedObjects:[]}}function a(e,t,n,r){var s=e.start,a=e.end,c=n+t.length,u=e.selectedObjects,o={content:t,start:n,end:c};return r&&(s>=n&&c>=s||a>n&&c>a||n>=s&&a>=c)&&(o.mode=l(t),u.push(o)),o}function c(e,t,n){var r=e.wholeRanges,s=a(e,t,n);r.push(s);var c=e.start,l=e.end,u=n+t.length;c>=n&&u>=l&&(e.currRange=s);var i=e.allObjects,f=t.match(/(?:([:.!])|([^:.!]+))/g),h=n;return f.forEach(function(t){i.push(a(e,t,h,o.validCell.test(t))),h+=t.length}),i}function l(e){var t=o.cellRangeForReferenceToggling.exec(e),n=!!t[1],r=!!t[3],s=!!t[2]&&!!t[4];return s?n?r?1:3:r?2:0:t[1]?5:4}var u=e.ZSClass,o=e.JSUtil.REGEXP,i=u.Editors||(u.Editors={}),f=i.Parsers||(i.Parsers={}),h=o.matchRegex,g=o.rangeRegex;f.functionParser=n}(this);
!function(e){function t(e,t){if(""!=t)for(var n=t.split("\n"),a=0;a<n.length;a++){var o=n[a];e.appendChild(document.createTextNode(o)),a<n.length-1&&(e.appendChild(document.createElement("br")),e.appendChild(document.createTextNode("")))}}function n(e,t,n){var a=document.createElement("span");s(a,t),a.style.color="#"+n,e.appendChild(a)}function a(e,t){var n=document.createElement("span");s(n,t),n.style.color="#005713",n.style.fontStyle="italic",e.appendChild(n)}function o(e,o){C.reset(),e.innerHTML="";var r=o.match(d.matchRegex)||[],c=document.createDocumentFragment(),i="";r.forEach(function(e){var o=d.rangeRegex.test(e),r=d.enclosedByQuotes.test(e);if(o||r){if(t(c,i),o){var l=C.get(e);n(c,e,l)}else a(c,e);i=""}else i+=e}),t(c,i),c.appendChild(document.createElement("br")),e.appendChild(c)}var r=e.ZSClass,c=r.Editors||(r.Editors={}),i=c.Utility||(c.Utility={}),l=r.RangeColorChoser,d=e.JSUtil.REGEXP,s=i.setTextForElement,C=new l(["5883DA","E5575B","A43FBC","5B9C27","11A9CC","F7900C","BD4F90","2B799C","AC3135","5F5F5F","0D6856","9B8C2B","3FD0B4","F2B405","4B10AC","65765A","9258F1","795011","584A71","EF3964"]);i.functionDecorate=o}(this);
!function(t){function e(t,e){for(var n in e)t.addEventListener(n,e[n])}function n(t,e){var n=new Event(e);t.dispatchEvent(n)}function i(t,e){t&&(this.Editor=t,this.addListeners(s(this)),e&&r.addFormulaControl(this))}function o(t){if(!this.customPreventDefault||!this.customPreventDefault(t)){var e=t.keyCode||t.which;switch(e){case 65:if(!t.metaKey)return;case 37:case 38:case 39:case 40:setTimeout(function(){this.selectionChanged()}.bind(this),0)}}}function s(t){return{input:function(){this.valueRestore(),this.selectionChanged()}.bind(t),keydown:o.bind(t),mousedown:t.selectionChanged.bind(t),mouseup:t.selectionChanged.bind(t),focus:t.selectionChanged.bind(t)}}var c=t.ZSClass,u=c.Editors,r=u.Utility;i.prototype={set value(t){this.valueSetter(this.Editor,t)},get value(){return this.Editor.value},focus:function(){this.Editor.focus()},blur:function(){this.Editor.blur()},setSelectionRange:function(t,e){this.Editor.setSelectionRange(t,e)},addListeners:function(t){e(this.Editor,t)},valueSetter:function(t,e){t.value=e},valueRestore:function(){this.valueChanged()},valueChanged:function(){n(this.Editor,"valueChanged")},selectionChanged:function(){n(this.Editor,"selectionChanged")},get selectionStart(){return this.Editor.selectionStart},get selectionEnd(){return this.Editor.selectionEnd}},u.TextAreaEditor=i}(this);
!function(e){function t(e){var t={keydown:n.bind(e)};e.addListeners(t)}function n(e){if(!r(e)){var t=e.keyCode?e.keyCode:e.which,n=this.value;if(!this.valueCheck||this.valueCheck(n)){var s,f=this.selectionStart,h=this.selectionEnd,d=m(n,f,h);if((115==t||84==t&&e.altKey&&e.metaKey)&&(s=a(d,e.shiftKey)),9===t&&e.altKey&&(s=u(d,e.shiftKey?f:h,e.shiftKey)),68===t&&e.metaKey&&(s=c(d)),t>=48&&57>=t&&(e.metaKey||e.ctrlkey)){var v=i(t-48,d.wholeRanges.length);s=l(d,v-1)}e.preventDefault(),o.bind(this)(s,d)}}}function r(e){var t=e.keyCode?e.keyCode:e.which;return 115==t||84==t&&e.altKey&&e.metaKey?!1:9===t&&e.altKey?!1:68===t&&e.metaKey?!1:t>=48&&57>=t&&(e.metaKey||e.ctrlkey)?!1:!0}function i(e,t){return C=10*C+e,C>t&&(C=e),clearTimeout(d),d=setTimeout(function(){C=0},300),C}function o(e,t){if(e&&(e.reconstruct&&(h(t),this.value=t.origStr,this.valueChanged()),e.selection)){var n=e.selection;this.setSelectionRange(n.startNode.start,n.endNode.end),this.selectionChanged()}}function a(e,t){var n=e.selectedObjects;if(n.length>0){var r=n[0].mode<4?4:2,i=(n[0].mode+(t?3:1))%r;return n.forEach(function(e){e.content=f(e.content,i)}),{reconstruct:!0,selection:{startNode:n[0],endNode:n[n.length-1]}}}}function c(e){return s(e.currRange)}function s(e){return e?{reconstruct:!1,selection:{startNode:e,endNode:e}}:void 0}function l(e,t){var n=e.wholeRanges;if(!(0>t))return n.length>t?s(n[t]):void 0}function u(e,t,n){for(var r=-1,i=e.wholeRanges,o=0;o<i.length;o++){var a=i[o];if(n){if(!(a.start<t))break;r=o}else if(-1===r&&a.start>t){r=o;break}}return-1===r&&(r=n?i.length-1:0),l(e,r)}function f(e,t){var n=k.cellRangeForReferenceToggling.exec(e),r=n[2]?(1===t||3===t?"$":"")+n[2]:"";return r+=n[4]?(1===t||2===t?"$":"")+n[4]:""}function h(e){var t="";return e.allObjects.forEach(function(e,n,r){t+=e.content,e.start=0==n?0:r[n-1].end,e.end=e.start+e.content.length}),e.origStr=t,e}var d,v=e.ZSClass,y=v.Editors,g=y.Utility,K=y.Parsers,k=e.JSUtil.REGEXP,m=K.functionParser,C=0;g.addFormulaControl=t}(this);
!function(t){function e(t,e){for(var n in e)t.addEventListener(n,e[n])}function n(t,e){for(var n in e)t.removeEventListener(n,e[n])}function i(t,e){var n=new Event(e);t.dispatchEvent(n)}function o(t,e){t&&(this.Editor=t,this.Editor.contentEditable=!0,m(this),this.addListeners(d(this)),e&&C(this))}function s(t){var e=window.getSelection(),n=e.getRangeAt(0);n.deleteContents(),n.collapse(!0),n.insertNode(t),n.setStartAfter(t),n.collapse(!0),e.removeAllRanges(),e.addRange(n)}function a(){s(document.createElement("br")),s(document.createTextNode(""))}function c(t){if(!this.customPreventDefault||!this.customPreventDefault(t)){var e=t.keyCode||t.which;switch(e){case 65:if(!t.metaKey)return;case 37:case 38:case 39:case 40:setTimeout(function(){this.selectionChanged()}.bind(this),0)}13===e&&(t.preventDefault(),a(),i(this.Editor,"selectionChanged"),i(this.Editor,"valueChanged"))}}function d(t){return{compositionstart:function(t){p={data:t.data,done:!1}},compositionupdate:function(t){p||(p={data:t.data,done:!1})},compositionend:function(e){p&&(e.data!=p.data&&(t.valueRestore(),t.selectionChanged()),p.done=!0)},input:function(){p.done&&(t.valueRestore(),t.selectionChanged())},keydown:c.bind(t),mousedown:function(){r(t)}}}function r(e){function n(){e.selectionChanged(),t.removeEventListener("mouseup",n)}t.addEventListener("mouseup",n)}var u=t.ZSClass,h=u.Editors,l=h.Utility,f=l.setText,v=l.getText,E=l.getSelectionStart,g=l.getSelectionEnd,b=l.setSelectionRange,m=l.addUndoManager,C=l.addFormulaControl;o.prototype={set value(t){this.valueSetter(this.Editor,t)},get value(){return v(this.Editor)},focus:function(){this.Editor.focus()},blur:function(){this.Editor.blur()},enable:function(){this.Editor.contentEditable=!0},disable:function(){this.Editor.contentEditable=!1},setSelectionRange:function(t,e){b(this.Editor,t,e)},addListeners:function(t){e(this.Editor,t)},removeListeners:function(t){n(this.Editor,t)},valueSetter:function(t,e){f(t,e)},valueRestore:function(){var t=this.selectionStart,e=this.selectionEnd;this.value=this.value,this.setSelectionRange(t,e),this.valueChanged()},valueChanged:function(){i(this.Editor,"valueChanged")},selectionChanged:function(){i(this.Editor,"selectionChanged")},get selectionStart(){return E(this.Editor)},get selectionEnd(){return g(this.Editor)}},h.BasicEditor=o;var p={done:!0}}(this);
!function(t){function i(){a.apply(this,arguments),this.valueSetter=e,this.value=this.value}function e(t,i){o(t,i)}var s=t.ZSClass,n=s.Editors,a=n.BasicEditor,o=n.Utility.functionDecorate;i.prototype=new a,n.RangeEditor=i}(this);
!function(t){function i(t){t&&(o.apply(this,arguments),this.valueSetter=e,this.value=this.value,this.valueCheck=n)}function e(t,i){n(i)?u(t,i):c(t,i)}function n(t){return"="===t.charAt(0)}var r=t.ZSClass,s=r.Editors,a=s.Utility,o=(s.RangeEditor,s.BasicEditor),u=a.functionDecorate,c=a.setText;i.prototype=new o,s.FormulaEditor=i}(this);
!function(n){function t(n,t,i,s){var o=document.createElement("div");return t&&(o.className=t),e(o,i,s),n.appendChild(o),o}function e(n,t,e){for(var i in t)n.addEventListener(i,t[i].bind(e))}function i(n,e,i,s){n&&(this.Dom=t(n,e,i,s))}var s=n.ZSClass;i.prototype={hide:function(){this.Dom.style.display="none"},show:function(){this.Dom.style.display=""}},s.UILayerElement=i}(this);
!function(t){function e(t,e,i){t&&(n.call(this,t,"Layer "+(e.class||""),e.Listeners,this),i&&i.call(this),e.filler&&(this.filler=s.call(this,this.Dom,e.filler)),e.edges&&(this.edges=r.call(this,this.Dom,"edges",e.edges)),e.corners&&(this.corners=r.call(this,this.Dom,"corners",e.corners)))}function s(t,e){return new n(t,"filler",e,this)}function i(t,e){for(var s in e)t[s]=new n(t.Dom,s,e[s],this)}function r(t,e,s){var r=new n(t,e);return i.call(this,r,s),r}var h=t.ZSClass,n=h.UILayerElement;e.prototype=new n,e.prototype.place=function(t,e,s,i,r,h,n,o){this.show();var l=this.Dom.style;l.top=t-1+"px",l.left=e-1+"px",l.height=s+1+"px",l.width=i+1+"px",l.zIndex=r?1:"";var a=this.filler;!!a&&(h?a.hide():a.show());var c=this.corners;!!c&&(n?c.hide():c.show());var f=this.edges;!!f&&(o?f.hide():f.show())},e.prototype.setData=function(t){for(var e in t)this[e]=t[e]},h.UILayer=e}(this);
!function(i){function t(i,t,s){this.parent=i,this.properties=t,this.alive={},this.Layer=s||e}var s=i.ZSClass,e=s.UILayer;t.prototype={place:function(i,t,s,e,r,h,a,n,o){this.isExist(i)||(this.alive[i]=new this.Layer(this.parent,this.properties)),this.alive[i].place(t,s,e,r,h,a,n,o)},hide:function(i){this.isExist(i)&&this.alive[i].hide()},isExist:function(i){return!!this.alive[i]}},s.UILayerController=t}(this);
!function(t){function e(t,e){n.call(this,t,e)}var i=t.ZSClass,n=i.UILayer;e.prototype=new n,i.UISelectionLayer=e}(this);
!function(t){function e(t,e,i){o.call(this,t,e,i||s),this.alive=[]}var i=t.ZSClass,o=i.UILayerController,s=i.UISelectionLayer;e.prototype=new o,e.prototype.setData=function(t,e,i,o,s){this.alive[t].setData({index:t,startRow:e,startCol:i,endRow:o,endCol:s})},e.prototype.setColor=function(t,e){this.isExist(t)||(this.alive[t]=new this.Layer(this.parent,this.properties)),this.alive[t].Dom.style.color=e},e.prototype.hideFrom=function(t){for(var e=t;e<this.alive.length;e++)this.hide(e)},i.UISelectionController=e}(this);
!function(i){function t(i){var t=document.createElement("div");t.classList.add("rFlash"),this.Dom=t,this.timeout=i}t.prototype={place:function(i,t,e,s){if(!this.inView){var h=this.Dom.style;h.top=i-1+"px",h.left=t-1+"px",h.height=e+1+"px",h.width=s+1+"px"}},hide:function(){this.Dom.remove(),this.Dom.classList.remove("glow"),this.inView=!1},show:function(i){if(!this.inView){this.inView=!0;var t=this;i.appendChild(this.Dom),setTimeout(function(){t.hide()},this.timeout)}}},i.ZSClass.UIRecalculateFlashLayer=t}(this);
!function(i){function t(i){this.parent=i,this.inActive=[],this.Alive={}}var s=i.ZSClass,e=s.UIRecalculateFlashLayer,l=2e3;t.prototype={place:function(i,t,s,n,h){this.isExist(i)||(this.Alive[i]=new e(l)),this.Alive[i].place(t,s,n,h)},show:function(i){this.isExist(i)&&this.Alive[i].show(this.parent)},isExist:function(i){return!!this.Alive[i]}},s.UIRecalculateFlashController=t}(this);
!function(e){function o(){this.elems={}}var i=e.ZSClass,t=e.sPlusPlus,s=16;o.prototype={show:function(e,o,i,t,r,a,l,n){r=s>=r?r:s,a=s>=a?a:s,this.elems[e].place(o,i,t,r,a,l,n)},changeIcon:function(e,o){this.elems[e].changeIcon(o)},remove:function(e,o){var i=this.elems[o],t=i.elem;e.removeChild(t),delete this.elems[o]},removeAll:function(e){for(var o in this.elems){var i=this.elems[o],t=i.elem;e.removeChild(t)}this.elems={}},onResizeRow:function(e,o,i,r,a){var l=t.data.getWorkBook(e,i),n=l.getSheetObj(o);for(var m in this.elems){var v=this.elems[m],h=v.row;if(h>=a){var g=n.Row.auxiliaryAxis.getPos(h),f=a==h?r:n.Row.auxiliaryAxis.getDim(h);v.rePosition(g+f,void 0),s>=f?v.changeIconSize(void 0,f):v.changeIconSize(void 0,s)}}},onResizeCol:function(e,o,i,r,a){var l=t.data.getWorkBook(e,i),n=l.getSheetObj(o);for(var m in this.elems){var v=this.elems[m],h=v.col;if(h>=a){var g=n.Column.axis.getPos(h),f=h==a?r:n.Column.axis.getDim(h);v.rePosition(void 0,g+f),s>=f?v.changeIconSize(f,void 0):v.changeIconSize(s,void 0)}}},onColInsert:function(e,o,i,s){{var r=t.data.getWorkBook(e,i);r.getSheetObj(o)}for(var a in this.elems){var l=this.elems[a],n=l.col;n>=s&&(delete this.elems[a],l.elem.remove())}},onRowInsert:function(e,o,i,s){{var r=t.data.getWorkBook(e,i);r.getSheetObj(o)}for(var a in this.elems){var l=this.elems[a],n=l.row;n>=s&&(delete this.elems[a],l.elem.remove())}},onColDelete:function(e,o,i,s){{var r=t.data.getWorkBook(e,i);r.getSheetObj(o)}for(var a in this.elems){var l=this.elems[a],n=l.col;n>=s&&(delete this.elems[a],l.elem.remove())}},onShowRow:function(e,o,i,s){var r=t.data.getWorkBook(e,i),a=r.getSheetObj(o);for(var l in this.elems){var n=this.elems[l],m=n.row;if(m>=s){var v=a.Row.auxiliaryAxis.getPos(parseInt(m)),h=a.Row.auxiliaryAxis.getDim(m);n.rePosition(v+h,void 0),"none"==n.elem.style.display&&(n.elem.style.display="")}}},onShowCol:function(e,o,i,s){var r=t.data.getWorkBook(e,i),a=r.getSheetObj(o);for(var l in this.elems){var n=this.elems[l],m=n.col;if(m>=s){var v=a.Column.axis.getPos(parseInt(m)),h=a.Column.axis.getDim(m);n.rePosition(void 0,v+h),"none"==n.elem.style.display&&(n.elem.style.display="")}}},onHideCol:function(e,o,i,s,r){for(var a=t.data.getWorkBook(e,i),l=a.getSheetObj(o),n=s+r-1,m=s;n>=m;m++)for(var v in this.elems){var h=this.elems[v],g=h.col;if(m==g&&(h.elem.style.display="none"),g>m){var f=l.Column.axis.getPos(parseInt(g)),c=l.Column.axis.getDim(g);h.rePosition(void 0,f+c)}}},onHideRow:function(e,o,i,s,r){for(var a=t.data.getWorkBook(e,i),l=a.getSheetObj(o),n=s+r-1,m=s;n>=m;m++)for(var v in this.elems){var h=this.elems[v],g=h.row;if(m==g&&(h.elem.style.display="none"),g>=m){var f=l.Row.auxiliaryAxis.getPos(parseInt(g)),c=l.Row.auxiliaryAxis.getDim(g);h.rePosition(f+c,void 0)}}},onRowDelete:function(e,o,i,s){{var r=t.data.getWorkBook(e,i);r.getSheetObj(o)}for(var a in this.elems){var l=this.elems[a],n=l.row;n>=s&&(delete this.elems[a],l.elem.remove())}},refreshIcons:function(e,o,i){var s=t.data.getWorkBook(e,i),r=s.getSheetObj(o);for(var a in this.elems){var l=this.elems[a],n=l.row,m=r.Row.auxiliaryAxis.getPos(parseInt(n)),v=r.Row.auxiliaryAxis.getDim(n);l.rePosition(m+v,void 0)}}},i.UIFilterController=o}(this);
!function(e){function t(e){m.call(this),this.parentDom=e}function s(e){var t=this.row,s=this.col,i=e.getBoundingClientRect(),o=i.height,l=i.width;a.publish(r.UI,h.Menu.SHOW_FILTER_OPTION,{WIDTH:l,HEIGHT:o,ROW:t,COL:s})}var i=e.sPlusPlus,o=e.ZSClass,l=e.ZSEvents,a=l.topic,r=l.Groups,h=l.Names,o=e.ZSClass,n=e.JSUtil.Math,p=i.data.Defaults.MAX_COL,m=o.UIFilterController,c=o.Filter.Icon;t.prototype=new m,t.prototype.place=function(e,t,o,l,a,r,h){var m=i.view.getActiveGridID(),u=i.view.getSheetID(m);if(l&&t==u)for(var g=i.data.getWorkBook(e,o),v=g.getSheetObj(t),f=l.startRow,w=v.Row.auxiliaryAxis.getDim(f),C=v.Row.auxiliaryAxis.getPos(f)+w,d=l.startCol,D=l.endCol;D>=d;d++){var I=-1!==a.indexOf(d),O=v.Column.axis.getPos(d)+v.Column.axis.getDim(d),x=I?"/sheet/appsheet/styles/images/filterApplied.svg":"/sheet/appsheet/styles/images/filter_new.svg",h=n.hash(f,d,p);if(this.elems[h]){var y=this.elems[h].src;y!=x&&(this.changeIcon(h,x),this.elems[h].src=x)}else{var S=v.Column.axis.getDim(d);this.elems[h]=new c,this.show(h,this.parentDom,C,O,w,S,x,s.bind(this.elems[h])),this.elems[h].row=f,this.elems[h].col=d,this.elems[h].src=x}}},t.prototype.hide=function(){this.removeAll(this.parentDom)},t.prototype.showAll=function(e,t,s,o){i.data.getWorkBook(e,s).getSheetObj(t);for(var l in o)this.place(e,t,s,o[l],o[l].appliedColumns,o[l].rows)},o.UIDataFilterController=t}(this);
!function(e){function t(e){c.call(this),this.parentDom=e}function s(){var e=this.row,t=this.col;r.publish(h.UI,a.Menu.SHOW_PIVOTFILTER_OPTION,{ROW:e,COL:t,PIVOT_FILTERCELL:this.filterCell,PIVOT_ID:this.PID})}var i=e.sPlusPlus,l=e.ZSClass,o=e.ZSEvents,r=o.topic,h=o.Groups,a=o.Names,l=e.ZSClass,n=e.JSUtil.Math,m=i.data.Defaults.MAX_COL,c=l.UIFilterController,I=l.Filter.Icon;t.prototype=new c,t.prototype.place=function(e,t,l,o){for(var r=i.view.getActiveGridID(),h=(i.view.getSheetID(r),i.data.getWorkBook(e,l)),a=h.getSheetObj(t),c=0;c<o.length;c++){var p=o[c],u=a.Row.auxiliaryAxis.getDim(p.row),v=a.Row.auxiliaryAxis.getPos(p.row)+u,D=a.Column.axis.getPos(p.col)+a.Column.axis.getDim(p.col),g="/sheet/appsheet/styles/images/"+p.pic+".svg",w=n.hash(p.row,p.col,m);if(this.elems[w]){var P=this.elems[w].src;P!=g&&(this.changeIcon(w,g),this.elems[w].src=g)}else{this.elems[w]=new I,this.elems[w].PID=p.pId,this.elems[w].row=p.row,this.elems[w].col=p.col;var C=a.Column.axis.getDim(p.col);this.elems[w].filterCell=p,this.show(w,this.parentDom,v,D,u,C,g,s.bind(this.elems[w])),this.elems[w].src=g}}},t.prototype.hide=function(e,t,s,i){for(var l in this.elems)this.elems[l].PID&&this.elems[l].PID==i&&this.remove(this.parentDom,l)},l.UIPivotFilterController=t}(this);
!function(){function e(e){var t=document.createElement("div");e.appendChild(t),t.className="Layer Preview",this.Dom=t}function t(t){e.call(this,t)}t.prototype={place:function(e,t,i,n){var o=this.Dom.style;o.top=e+"px",o.left=t+"px",o.height=i+"px",o.width=n+"px"},remove:function(){this.Dom.remove()},show:function(e){e.appendChild(this.Dom)},flush:function(){var e=this.Dom;e.style={},e.innerHTML="",e.className="Layer Preview"},getDom:function(){return this.Dom}},ZSClass.UIPreviewLayer=t}(this);
!function(t){function e(t){this.parent=t,this.inActive=[],this.Active={}}var i=t.sPlusPlus,s=(t.JSUtil,i.data.Defaults.MAX_COL,t.ZSClass),n=s.UIPreviewLayer,r=""===document.createElement("detect").style.zoom;e.prototype={get:function(t){return this.Active[t]?this.Active[t]:(this.Active[t]=this.inActive.length?this.inActive.pop():new n(this.parent),this.Active[t])},place:function(t,e,i,s,n){var r=this.get(t);r.place(e,i,s,n),r.show(this.parent)},remove:function(t){if(this.Active[t]){var e=this.Active[t];e.remove(),this.inActive.push(e),delete this.Active[t]}},setZoom:function(t){r?this.parent.style.zoom=t:(this.parent.style.transform="scale("+t+")",this.parent.style.transformOrigin="0 0")},removeAll:function(){for(var t in this.Active)this.remove(t)},flush:function(t){var e=this.get(t);e.flush()},getDom:function(t){var e=this.get(t);return e.getDom()}},s.UIPreviewController=e}(this);
!function(t){function o(t,o){s.call(this,t,o)}var e=t.ZSClass,s=e.UILayer;o.prototype=new s,o.prototype.place=function(t,o,e,s){var i=this.Dom.style;i.top=t+"px",i.left=o+"px",i.height=e+"px",i.width=s+"px"},o.prototype.setColor=function(t){this.Dom.style.color=t},o.prototype.setName=function(t){this.edges.Dom.dataset.name=t},o.prototype.show=function(t){t.appendChild(this.Dom)},o.prototype.remove=function(){this.Dom.remove()},o.prototype.flush=function(){this.Dom.style={},this.Dom.className="versionCue"},e.UIHighlightLayer=o}(this);
!function(t){function i(t,i){this.parent=t,this.properties=i,this.active={},this.inActive=[]}var e=(t.ZSClass.UILayerController,t.ZSClass.UIHighlightLayer);i.prototype={getLayer:function(t){return this.isExist(t)?this.active[t]:(this.active[t]=this.inActive.length?this.inActive.pop():new e(this.parent,this.properties),this.active[t])},setColor:function(t,i){var e=this.getLayer(t);e.setColor(i)},setName:function(t,i){var e=this.getLayer(t);e.setName(i)},place:function(t,i,e,s,r){var n=this.getLayer(t);n.place(i,e,s,r),n.show(this.parent)},remove:function(t){if(this.isExist(t)){var i=this.active[t];i.remove(),this.inActive.push(i),delete this.active[t]}},removeAll:function(){for(var t in this.active)this.remove(t)},isExist:function(t){return!!this.active[t]}},ZSClass.UIHighlightController=i}(this);
!function(e){function t(e,t){n.call(this,e,t),this.addRecastButton(),this.addRecastOption(),this.Dom.addEventListener("mousedown",function(e){e.stopPropagation()})}function a(){i.bind(l,"zmenuitemclick",function(e,t){for(var a=document.getElementById(l.id).getElementsByTagName("li"),s=0;s<a.length;s++)"checked"===a[s].getAttribute("checked")&&i.zmenu("#"+l.id,"setMenuItemsAttribute",["#"+a[s].id],"checked",!1);i.zmenu("#"+l.id,"setMenuItemsAttribute",["#"+t.data.id],"checked",!0);var n=m.view.getActiveGridID(),o=m.view.getResourceID(n),c=m.view.getSelectedSheets(n),d=m.view.getVersionID(n);r.recastAction(o,c,d,e,t)}),l.addEventListener("mousedown",function(e){e.stopPropagation()}),i.bind(l,"zmenubeforeshow",function(){var e=document.getElementById(l.id).getElementsByTagName("li");if(p!==m.data.RecastInfo.actionId){p=m.data.RecastInfo.actionId;for(var t=0;t<e.length;t++)"checked"===e[t].getAttribute("checked")&&i.zmenu("#"+l.id,"setMenuItemsAttribute",["#"+e[t].id],"checked",!1);switch(m.data.RecastInfo.action){case d.SYSTEMCLIP_PASTE:i.zmenu("#"+l.id,"setMenuItemsAttribute",["#menuItem0"],"checked",!0);break;case d.SERVERCLIP_PASTE_RANGE:case d.COPY_PASTE:i.zmenu("#"+l.id,"setMenuItemsAttribute",["#menuItem"+I.indexOf(m.data.RecastInfo.popUpOptionType)],"checked",!0);break;case d.FILLSERIES:i.zmenu("#"+l.id,"setMenuItemsAttribute",["#menuItem"+I.indexOf(E[m.data.RecastInfo.popUpOptionType])],"checked",!0)}}for(var t=0;t<e.length;t++)e[t].style.display="none";switch(m.data.RecastInfo.action){case d.SYSTEMCLIP_PASTE:for(var t=0;2>t;t++)e[t].style.display="block";break;case d.SERVERCLIP_PASTE_RANGE:case d.COPY_PASTE:for(var t=2;12>t;t++)e[t].style.display="block";break;case d.FILLSERIES:for(var t=12;t<e.length;t++)e[t].style.display="block"}})}var s=e.ZSClass,n=s.UILayer,o=document.getElementById("popupmenu"),i=e.UIUtil.Component,c=ZSConstants.FeatureConstants,d=e.ZSConstants.ActionConstants,m=e.sPlusPlus,r=m.view.Toolbar.Feature[c.RECAST],u=e.ZSConstants.I18N,l=null,p=-1,I=["source_format","destination_format","ALL","VALUES","FORMATS","FORMULAS","COMMENTS","VALUES_AND_NUMBERFORMATS","FORMULAS_AND_NUMBERFORMATS","ALL_EXCEPT_COMMENTS","ALL_EXCEPT_BORDERS","VALIDATION","FILL_DEFAULT","FILL_COPY","FILL_FORMATS","FILL_EXCEPT_FORMATS"],A=["CopyPasteMatchWithSource","CopyPasteMatchWithDestination","MenuItem.HomeTab.Paste.All","MenuItem.HomeTab.Paste.Values","MenuItem.HomeTab.Paste.Formats","MenuItem.HomeTab.Paste.Formulas","MenuItem.HomeTab.Paste.Notes","MenuItem.HomeTab.Paste.ValuesAndNumberFormats","MenuItem.HomeTab.Paste.FormulasAndNumberFormats","MenuItem.HomeTab.Paste.AllExceptNotes","MenuItem.HomeTab.Paste.AllExceptBorders","MenuItem.HomeTab.Paste.Validation","FillSeries.Default","FillSeries.CopyCells","FillSeries.FillFormats","FillSeries.FillWithOutFormats"],E={copy:"FILL_COPY",default:"FILL_DEFAULT"};t.prototype=new n,t.prototype.setDirection=function(e,t){e?this.Dom.classList.add("pasteLeft"):this.Dom.classList.remove("pasteLeft"),t?this.Dom.classList.add("pasteTop"):this.Dom.classList.remove("pasteTop")},t.prototype.addRecastButton=function(){var e=document.createElement("div");e.className="pasteWid";var t=document.createElement("div");t.className="shIcon cpWidget",t.setAttribute("data-menu-id","pasteWidgetPopUp"),e.appendChild(t),t.addEventListener("mousedown",function(e){e.stopPropagation()}),this.Dom.appendChild(e)},t.prototype.createListHolder=function(){l=document.createElement("ul"),l.setAttribute("ctype","zmenu"),l.id="pasteWidgetPopUp",l.setAttribute("data-content-type","icon-text");for(var e=0;e<A.length;e++){var t=document.createElement("li");t.id="menuItem"+e,t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-value",I[e]),t.innerText=u[A[e]],l.appendChild(t)}o.appendChild(l),a.call(this)},t.prototype.addRecastOption=function(){!l&&this.createListHolder()},s.UIPasteWidgetLayer=t}(this);
!function(t){function i(t,i){this.parent=t,this.properties=i,this.active={},this.inActive=[]}var e=(t.ZSClass.UILayerController,t.ZSClass.UIPasteWidgetLayer);i.prototype={getLayer:function(t){return this.isExist(t)?this.active[t]:(this.active[t]=this.inActive.length?this.inActive.pop():new e(this.parent,this.properties),this.active[t])},place:function(t,i,e,s,n){var r=this.getLayer(t);r.place(i,e,s,n),r.show(this.parent)},isExist:function(t){return!!this.active[t]},hide:function(){this.isExist(0)&&this.active[0].hide()},setDirection:function(t,i,e){this.active[t].setDirection(i,e)}},ZSClass.UIPasteWidgetController=i}(this);
!function(t){function e(t,e){o.call(this,t,e)}var s=t.ZSClass,o=s.UILayer,i="editUserPresence",r="uPzero";e.prototype=new o,e.prototype.place=function(t,e,s,i){0>=t?this.Dom.classList.add(r):this.Dom.classList.remove(r),o.prototype.place.call(this,t,e,s,i)},e.prototype.setColor=function(t){this.Dom.style.color=t},e.prototype.setName=function(t){this.edges.Dom.dataset.name=t},e.prototype.setEditStatus=function(t){var e=this.Dom.classList;t?e.add(i):e.remove(i)},s.UIUserPresenceLayer=e}(this);
!function(t){function i(t,i){h.call(this,t,i)}var s=t.ZSClass,h=s.UILayer;i.prototype=new h,i.prototype.hightLightComments=function(){this.Dom.classList.remove("highlightCmt");var t=this.Dom;setTimeout(function(){t.classList.add("highlightCmt")},10)},s.UICommentsHighlightLayer=i}(this);
!function(t){function e(t,e){i.call(this,t,e)}var o=t.ZSClass,i=o.UILayer,s=sPlusPlus;e.prototype=new i,e.prototype.hide=function(){this.Dom.style.display="none"},e.prototype.show=function(){this.Dom.style.display=""},e.prototype.placeDVBtn=function(t,e,o,i,a){var l=s.data.getWorkBook(t,o),n=s.view.getActiveGridID(),p=l.getSheetObj(e),y=p.Row.auxiliaryAxis.getPos(i+1),r=p.Column.axis.getPos(a+1)-17,h=s.view.getSheetState(n,e),u=h.getZoom();this.Dom.style.display="",this.Dom.style.top=y*u-17*u+"px",this.Dom.style.left=r*u-2*u+"px"},o.UIDataValidationLayer=e}(this);
!function(t){function e(t,e){i.call(this,t,e,r),this.alive=[]}var s=t.ZSClass,i=s.UILayerController,r=s.UIUserPresenceLayer;e.prototype=new i,e.prototype.setColor=function(t,e){this.isExist(t)||(this.alive[t]=new this.Layer(this.parent,this.properties)),this.alive[t].setColor(e)},e.prototype.setName=function(t,e){this.isExist(t)||(this.alive[t]=new this.Layer(this.parent,this.properties)),this.alive[t].setName(e)},e.prototype.setEditStatus=function(t,e){this.isExist(t)||(this.alive[t]=new this.Layer(this.parent,this.properties)),this.alive[t].setEditStatus(e)},s.UIUserPresenceController=e}(this);
!function(t){function i(t,i){h.call(this,t,i,e),this.alive=[],this.ranges={}}var s=t.ZSClass,h=s.UILayerController,e=s.UICommentsHighlightLayer;i.prototype=new h,i.prototype.hightLightComments=function(t){this.isExist(t)&&this.alive[t].hightLightComments()},s.UICommentsHighlightController=i}(this);
!function(t){function e(t){var e=document.createElementNS(f,"svg");e.setAttribute("class","CellNoteLine");var i=document.createElementNS(f,"line");return i.setAttribute("x1",0),i.setAttribute("y1",0),e.appendChild(i),t.appendChild(e),i}function i(t){var e=this.Dom,i=r.getTemplate([m])[m];e.appendChild(i);var n=e.querySelector(".CNEditor"),l=e.querySelector(".CNTrash");this.Comment=new a(n),this.Comment.customPreventDefault=s,this.CellInfo=e.querySelector(".CNInfo"),this.Trash=l,o(e,t.Container,this),o(n,t.Editor,this),o(l,t.Trash,this)}function s(e){var i=JSUtil.Key.getKeyCombination(e),s=t.ZSConstants.JSKeyCode;switch(i){case s.SUPER+"+"+s.SHIFT+"+"+s.ENTER:case s.SUPER+"+"+s.ENTER:return!0}}function n(t,e){var i=document.createElement("div");return e&&(i.className=e),t.appendChild(i),i}function o(t,e,i){for(var s in e)t.addEventListener(s,e[s].bind(i))}function l(t,s){this.Dom=n(t,c),this.line=e(this.Dom),this.setLineCoordinates(0,0),i.call(this,s),this.onHide=s.onHide,this.hide()}var h=(t.sPlusPlus,t.ZSClass),r=t.UserAction,a=h.Editors.BasicEditor,d=h.Range,m="CellNoteTemplate",c="CellNoteHolder",u="fixR",C="fixB",f="http://www.w3.org/2000/svg";l.prototype={hide:function(){this.onHide&&this.onHide(),this.Dom.style.display="none",this.Comment.blur()},show:function(){this.Dom.style.display=""},focus:function(){this.Comment.focus();var t=this.Comment.value.length;this.Comment.setSelectionRange(t,t)},place:function(t,e,i,s){var n=this.Dom,o=n.style;this.x=t,this.y=e,o.left=i?"":t+"px",o.right=i?t+"px":"",o.top=s?"":e+"px",o.bottom=s?e+"px":"";var l=n.classList;s?l.add(C):l.remove(C),i?l.add(u):l.remove(u)},enable:function(){this.Comment.enable(),this.Trash.style.display=""},disable:function(){this.Comment.disable(),this.Trash.style.display="none"},setComment:function(t,e,i,s,n,o,l){this.rid=t,this.sheetID=e,this.version=i,this.range=new d(s,n,s,n),this.isAdd=!!l,this.CellInfo.dataset.cell=JSUtil.Cell.getReference(s,n),this.Comment.value=o},setLineCoordinates:function(t,e){this.line.setAttribute("x2",t),this.line.setAttribute("y2",e)},update:function(){var t=this.Comment.value,e=this.isAdd?"add":"edit";r.CellComment(this.rid,[this.sheetID],this.version,e,t,this.range)},delete:function(){r.CellComment(this.rid,[this.sheetID],this.version,"remove","",this.range)}},h.UICellNote=l}(this);
!function(e){function t(e){e.stopPropagation();var t=f.view.Events.Key;t.focusContext(t.Entry.CellNote.Context)}function i(e){g=!0,t(e),C=this,w.register(b.Listener,k.Mouse.RangeDown,o)}function s(){this.delete()}function o(){n.call(C),w.unregister(b.Listener,k.Mouse.RangeDown,o)}function n(){g&&this.Comment.blur(),g&&this.update(),g=!1}function a(t){var i=e.JSUtil.Key.getKeyCombination(t),s=e.ZSConstants.JSKeyCode;switch(i){case s.SUPER+"+"+s.ENTER:n.call(this);break;case s.ESC+"":var o=f.data.getWorkBook(this.rid,this.version),a=o.getSheetObj(this.sheetID),r=e.JSUtil.Math.hash(this.range.startRow,this.range.startCol,S),h=a.Notes.get(r);this.Comment.value=h.value,g=!1,this.Comment.blur()}}function r(t){var i=f.data.getWorkBook(this.rid,this.version);i.isEditable()&&!i.ProtectedSheets.isSheetLocked(this.sheetID)&&(m=t,C=this,t.stopPropagation(),t.preventDefault(),e.addEventListener("mousemove",l),e.addEventListener("mouseup",h))}function h(){var t=f.view.getActiveGridID(),i=f.view.getSheetState(t,C.sheetID),s=i.getZoom();e.UserAction.MoveCellComment(C.rid,C.sheetID,C.version,C.range.startRow,C.range.startCol,C.x/s,C.y/s),e.removeEventListener("mousemove",l),e.removeEventListener("mouseup",h)}function l(e){var t=e.clientX-m.clientX,i=e.clientY-m.clientY,s=f.view.getActiveGridID(),o=f.view.getSheetState(s,C.sheetID),n=o.getZoom();v(C.rid,C.sheetID,C.version,C.range.startRow,C.range.startCol,(C.x+t)/n,(C.y+i)/n),m=e}function v(t,i,s,o,n,a,r){var h=f.data.getWorkBook(t,s),l=h.getSheetObj(i),v=e.JSUtil.Math.hash(o,n,S),c=l.Notes.get(v),u=l.Column.axis,d=l.Row.axis,g=l.Merge.isXists(o,n),C=u.getPos((g?g.root.endCol:n)+1),m=d.getPos(o);w.publish(b.Listener,k.Layers.Note.Place,{RID:t,SHEETID:i,VERSION:s,ROW:o,COL:n,COMMENT:c.value,X:a,Y:r,ROWX:C,COLY:m})}function c(e){e.stopPropagation()}function u(t,i){return e.JSUtil.Math.hash(t,i,S)}function d(e){this.parent=e,this.Alive={},this.inActive=[]}var g,C,m,C,f=e.sPlusPlus,p=e.ZSClass,S=f.data.Defaults.MAX_COL,A=p.UICellNote,E=e.ZSEvents,w=E.topic,b=E.Groups,k=E.Names,D={Container:{mousedown:r},Editor:{keydown:a,mousedown:t,dblclick:c,focus:i,blur:n},Trash:{click:s}};d.prototype={place:function(e,t,i,s,o,n,a,r,h,l,v){var c=this.getNote(s,o),u=f.data.getWorkBook(e,i),d=u.getSheetObj(t),g=d.ProtectedRanges.isXists(s,o),C=u.ProtectedSheets.isSheetLocked(t);!u.isEditable()||g||C?c.disable():c.enable(),c.place(n,a,l,v),c.setLineCoordinates(r-n,h-a),c.show()},setComment:function(e,t,i,s,o,n){var a=this.getNote(s,o);a.setComment(e,t,i,s,o,n)},getNote:function(e,t){var i=u(e,t);return this.Alive[i]||(this.Alive[i]=this.inActive.length?this.inActive.pop():new A(this.parent,D)),this.Alive[i]},hide:function(e,t){var i=u(e,t);this.Alive[i]&&(this.Alive[i].hide(),this.inActive.push(this.Alive[i]),delete this.Alive[i])},hideAll:function(){for(var e in this.Alive)this.Alive[e].hide(),this.inActive.push(this.Alive[e]),delete this.Alive[e]}},p.UICellNoteController=d}(this);
!function(t){function e(t){var e=document.createElementNS(a,"svg");e.setAttribute("class","PrecedanceLine");var i=document.createElementNS(a,"defs"),r=document.createElementNS(a,"marker");r.setAttribute("id","arrow"),r.setAttribute("markerWidth","10"),r.setAttribute("markerHeight","10"),r.setAttribute("refX","9"),r.setAttribute("refY","3"),r.setAttribute("orient","auto"),r.setAttribute("markerUnits","strokeWidth");var s=document.createElementNS(a,"path");s.setAttribute("d","M0,0 L0,6 L9,3 z"),r.appendChild(s),i.appendChild(r),e.appendChild(i);var n=document.createElementNS(a,"line");return n.setAttribute("x1",0),n.setAttribute("y1",0),n.setAttribute("marker-end","url(#arrow)"),e.appendChild(n),t.appendChild(e),n}function i(t,e){var i=document.createElement("div");return e&&(i.className=e),t.appendChild(i),i}function r(t){this.Dom=i(t,n),this.line=e(this.Dom),this.setLineCoordinates(0,0),this.hide()}var s=(t.sPlusPlus,t.ZSClass),n=(t.UserAction,s.Editors.BasicEditor,s.Range,"Precedance"),a="http://www.w3.org/2000/svg";r.prototype={hide:function(){this.Dom.style.display="none"},show:function(){this.Dom.style.display=""},place:function(t,e,i,r){var s=this.Dom,n=s.style;this.x=t,this.y=e,n.left=t+"px",n.top=e+"px",n.width=i+"px",n.height=r+"px"},setLineCoordinates:function(t,e){this.line.setAttribute("x2",t),this.line.setAttribute("y2",e)}},s.UIPrecedance=r}(this);
!function(i){function t(i){this.parent=i,this.Alive={},this.inActive=[]}{var e=(i.sPlusPlus,i.ZSClass),s=e.UIPrecedance,n=i.ZSEvents;n.topic,n.Groups,n.Names}t.prototype={place:function(i,t,e,s,n,h,l){var c=this.get(i);c.place(t,e,s,n),c.setLineCoordinates(h-t,l-e),c.show()},get:function(i){return this.Alive[i]||(this.Alive[i]=this.inActive.length?this.inActive.pop():new s(this.parent)),this.Alive[i]},hide:function(i){this.Alive[i]&&(this.Alive[i].hide(),this.inActive.push(this.Alive[i]),delete this.Alive[i])},hideAll:function(){for(var i in this.Alive)this.hide(i)}},e.UIPrecedanceController=t}(this);
!function(t){function e(t,e){var i=document.createElement("div");i.className=e;var s=UserAction.getTemplate(["dv_hint"]).dv_hint;return t.appendChild(i).appendChild(s),i}function i(t){this.Dom=e(t,"dvHintCont"),this.hide()}function s(t){this.parent=t}{var a=t.sPlusPlus,n=t.ZSClass,r=(a.data.Defaults.MAX_COL,t.ZSEvents);r.topic,r.Groups,r.Names}i.prototype={hide:function(){this.Dom.style.display="none"},show:function(){this.Dom.style.display=""},place:function(t,e,i,s,r,o){this.show();var h=this.Dom,l=h.style,g=a.data.getWorkBook(t,i),p=g.getSheetObj(e),u=p.Row.auxiliaryAxis.getPos(s),c=p.Column.axis.getPos(r+1),v=a.view.getActiveGridID(),d=a.view.getSheetState(v,e),D=d.getZoom();l.top=u*D+"px",l.left=c*D+1+"px",h.querySelector("#hintText").innerText=o;var I=function(t){var e=t[s][r].IsContentValid;h.querySelector("#eMsg").style.display=void 0==e||e?"none":"block"};sPlusPlus.view.fetchRangeData(t,e,i,new n.Range(s,r,s,r),["DV_IsValid"],!0,a.view.getActiveGridID(),I)}},s.prototype={placeDVHint:function(t,e,i,s,a,n,r,o){var h=this.getButton();h.place(t,e,i,s,a,n,r,o),h.show()},hideDVHint:function(){var t=this.getButton();t.hide()},getButton:function(){return this.button||(this.button=new i(this.parent)),this.button}},n.UIDataValidationHintController=s}(this),function(t){function e(t,e){s.call(this,t,e,a),this.alive=[]}var i=t.ZSClass,s=i.UILayerController,a=i.UIDataValidationLayer;e.prototype=new s,e.prototype.hideDVBtn=function(t,e,i,s){this.isExist(s)||(this.alive[s]=new this.Layer(this.parent,this.properties)),this.alive[s].hide()},e.prototype.showDVBtn=function(t,e,i,s){this.isExist(s)||(this.alive[s]=new this.Layer(this.parent,this.properties)),this.alive[s].show()},e.prototype.placeDVBtn=function(t,e,i,s,a,n,r){this.isExist(s)||(this.alive[s]=new this.Layer(this.parent,this.properties)),this.alive[s].placeDVBtn(t,e,i,a,n,r)},i.UIDataValidationController=e}(this),function(t){function e(t,e,i,s,a){var n=o.data.getWorkBook(t,i),r=n.getSheetObj(e),h=r.DataValidation.getIntersectedRanges(new u.Range(s,a,s,a));return h.length?h:""}function i(t,i,a,n){l.publish(g.Listener,p.UserAction.DATA_VALIDATION.HIDE_DV_HINT,{RID:t,SHEETID:i,VERSION:a});var o=n.startRow,h=n.startCol,u=e(t,i,a,o,h)[0];u&&(r=new s(t,i,a,n,u))}function s(t,e,i,s,a){this.rID=t,this.sheetID=e,this.version=i,this.row=s.startRow,this.col=s.startCol,this.totalParts=0,this.partNum=0,this.array=a,this.getValueList()}function a(){r.getValueList()}function n(t){r.listResponse(t)}var r,o=t.sPlusPlus,h=t.ZSEvents,l=h.topic,g=h.Groups,p=h.Names,u=t.ZSClass,c=t.UserAction;s.prototype={getValueList:function(){if(this.array.isListRange&&this.array.range&&-1==this.array.range.indexOf("=")&&!this.hiddenSheetRange()){var t=this,e=this.array.range;if(this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,e),!this.rangeInfo){var i=o.data.getWorkBook(this.rID,this.version),s=i.NamedRange.namedRangeMap.get(e);this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,JSUtil.FormRange(s)),e=JSUtil.FormRange(s)}this.rangeObj=this.rangeInfo.range,this.rangeObj.endRow-this.rangeObj.startRow>2e3&&(this.rangeObj.endRow=this.rangeObj.startRow+2e3);var a=function(i){var s=[],a={};for(var n in i)for(var r in i[n]){var o=i[n][r].ActualValue;a[o]||(!a[o]&&s.push(o),a[o]=!0)}if(s.length){var h=JSUtil.Range.parseRange(t.rID,t.version,e).range,l={dataval:{sr:t.row,er:t.row,sc:t.col,ec:t.col,list:s,listSrcRange:{sr:h.startRow,sc:h.startCol,er:h.endRow,ec:h.endCol,sn:t.sheetID},partnum:-1}};t.listResponse(l)}};o.view.fetchRangeData(this.rID,this.rangeInfo.sheetID,this.version,this.rangeObj,["ActualValue"],!0,o.view.getActiveGridID(),a)}else-1!=this.partNum&&this.array.type&&c.getListValues(this.rID,this.sheetID,this.version,this.row,this.col,this.totalParts,this.partNum,this.array.isListRange,this.array.range)},hiddenSheetRange:function(){var t=this.array.range;this.rngObj=JSUtil.Range.parseRange(this.rID,this.version,t);var e=o.data.getWorkBook(this.rID,this.version);if(!this.rngObj){var i=e.NamedRange.namedRangeMap.get(t);this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,JSUtil.FormRange(i)),t=JSUtil.FormRange(i),this.rngObj=JSUtil.Range.parseRange(this.rID,this.version,t)}var s=e.SheetList.getIdByName(this.rngObj.sheetName),a=e.SheetList.getById(s);return a.getHidden()},listResponse:function(t){this.partNum=t.dataval.partnum,this.totalParts=t.dataval.tparts,l.publish(g.Listener,p.UserAction.DATA_VALIDATION.SHOW_LIST,{LIST_ARRAY:t.dataval.list})}},l.register(g.Listener,p.UserAction.DATA_VALIDATION.LIST_RESPONSE,n,"LIST_JSON"),l.register(g.Listener,p.UserAction.DATA_VALIDATION.GET_SCROLL_LIST,a),l.register(g.Selector.DomUpdate.CellEdit,p.Selection.BOUND_UPDATE.ADD,i,"RID","SHEETID","VERSION","ActiveRange")}(this);
!function(e){function t(e){p=b=!0,c.call(this,e)}function i(e){L=b=!0,c.call(this,e)}function n(e){L=f=!0,c.call(this,e)}function s(e){f=p=!0,c.call(this,e)}function o(e){L=p=b=!0,c.call(this,e)}function l(e){L=f=b=!0,c.call(this,e)}function r(e){L=f=p=!0,c.call(this,e)}function u(e){f=p=b=!0,c.call(this,e)}function c(t){var i=d.view.getActiveGridID(),n=d.view.getResourceID(i),s=d.view.getSheetID(i),o=d.view.getVersionID(i),l=d.data.getWorkBook(n,o);return l.isEditable()?((t.which&&3===t.which||t.button&&2===t.button)&&S.publish(m.Listener,R.ContextMenu.SHOW,{CONTEXT:"OLE"}),w=t,O=t,E=this.index,t.preventDefault(),t.stopPropagation(),S.publish(m.Listener,R.Layers.Ole.Blur,{RID:n,SHEETID:s,VERSION:o}),S.publish(m.Listener,R.Layers.Ole.Focus,{RID:n,SHEETID:s,VERSION:o,ID:E}),e.addEventListener("mousemove",v),void e.addEventListener("mouseup",I)):!1}function I(t){var i=d.view.getActiveGridID(),n=d.view.getResourceID(i),s=d.view.getSheetID(i),o=d.view.getVersionID(i),l=t.clientX-O.clientX===0&&t.clientY-O.clientY===0;!l&&S.publish(m.Listener,R.Layers.Ole.RepositionEnd,{RID:n,SHEETID:s,VERSION:o,TOPX:L?0:t.clientX-O.clientX,TOPY:f?0:t.clientY-O.clientY,BOTTOMX:p?0:t.clientX-O.clientX,BOTTOMY:b?0:t.clientY-O.clientY}),L=f=p=b=!1,e.removeEventListener("mousemove",v),e.removeEventListener("mouseup",I)}function v(e){var t=d.view.getActiveGridID(),i=d.view.getResourceID(t),n=d.view.getSheetID(t),s=d.view.getVersionID(t);S.publish(m.Listener,R.Layers.Ole.Reposition,{RID:i,SHEETID:n,VERSION:s,TOPX:L?0:e.clientX-w.clientX,TOPY:f?0:e.clientY-w.clientY,BOTTOMX:p?0:e.clientX-w.clientX,BOTTOMY:b?0:e.clientY-w.clientY}),w=e}function D(){var e=d.view.getActiveGridID(),t=d.view.getResourceID(e),i=d.view.getSheetID(e),n=d.view.getVersionID(e);S.publish(m.Listener,R.Layers.Ole.MouseOver,{RID:t,SHEETID:i,VERSION:n,ID:this.index})}function a(){var e=d.view.getActiveGridID(),t=d.view.getResourceID(e),i=d.view.getSheetID(e),n=d.view.getVersionID(e);S.publish(m.Listener,R.Layers.Ole.MouseLeave,{RID:t,SHEETID:i,VERSION:n,ID:this.index})}var w,E,O,d=e.sPlusPlus,h=e.ZSClass,g=e.ZSEvents,S=g.topic,m=g.Groups,R=g.Names,T={class:"Ole",Listeners:{mouseover:D,mouseleave:a},filler:{mousedown:c},corners:{tl:{mousedown:t},tr:{mousedown:i},bl:{mousedown:s},br:{mousedown:n},t:{mousedown:o},b:{mousedown:r},l:{mousedown:u},r:{mousedown:l}},edges:{top:{mousedown:c},bottom:{mousedown:c},left:{mousedown:c},right:{mousedown:c}}},L=!1,f=!1,p=!1,b=!1;h.UIOleModel=T,S.register(m.Gesture.Selector.Range,R.GESTURE.ACTION.DOWN,function(e,t,i){S.publish(m.Listener,R.Layers.Ole.Blur,{RID:e,SHEETID:t,VERSION:i})},"RID","SHEETID","VERSION")}(this);
!function(e){{var s=e.sPlusPlus,t=(s.view.measures,e.ZSEvents),l=(t.topic,t.Groups,t.Names,e.ZSClass),i=(l.SelectorHelper.Constants.POINT,l.Range,l.SelectorHelper.Constants.POINT,l.Range,l.Selector),n=i.Design||(i.Design={}),o={class:"rangeHighlighter",filler:!0,edges:{top:!0,bottom:!0,left:!0,right:!0}};document.body}n.Highlight=o}(this);
!function(e){function t(e){e.preventDefault(),e.stopPropagation()}function i(e){t(e),r(this.index,e,this.endRow,this.endCol,h.LEFT_TOP)}function n(e){t(e),r(this.index,e,this.endRow,this.startCol,h.RIGHT_TOP)}function s(e){t(e),r(this.index,e,this.startRow,this.endCol,h.LEFT_BOTTOM)}function o(e){t(e),r(this.index,e,this.startRow,this.startCol,h.RIGHT_BOTTOM)}function r(e,t,i,n,s){l.publish(v.Listener,R.RangePicker.Modify,{index:e});var o=c.view.getActiveGridID(),r=c.view.getResourceID(o),d=c.view.getSheetID(o),g=c.view.getVersionID(o),h=c.view.getGridComponent(o),I=h.getRelativeCoordinates(t),T=new w(i,n,i,n);l.publish(v.Gesture.Selector.RangePicker,R.GESTURE.ACTION.START,{RID:r,SHEETID:d,VERSION:g,COLX:I.x,ROWY:I.y,point:s,fixedRange:T}),E.addEventListener("mousemove",u),E.addEventListener("mouseup",a)}function u(e){t(e);var i=c.view.getActiveGridID(),n=c.view.getResourceID(i),s=c.view.getSheetID(i),o=c.view.getVersionID(i),r=c.view.getGridComponent(i),u=r.getRelativeCoordinates(e);l.publish(v.Gesture.Selector.RangePicker,R.GESTURE.ACTION.MOVE,{RID:n,SHEETID:s,VERSION:o,COLX:u.x,ROWY:u.y})}function a(e){t(e),l.publish(v.Listener,R.RangePicker.Disable),E.removeEventListener("mousemove",u),E.removeEventListener("mouseup",a)}var c=e.sPlusPlus,d=(c.view.measures,e.ZSEvents),l=d.topic,v=d.Groups,R=d.Names,g=e.ZSClass,h=g.SelectorHelper.Constants.POINT,w=g.Range,h=g.SelectorHelper.Constants.POINT,w=g.Range,I=g.Selector,T=I.Design||(I.Design={}),m={class:"rangePicker",filler:!0,corners:{tl:{mousedown:i},tr:{mousedown:n},bl:{mousedown:s},br:{mousedown:o}},edges:{top:!0,bottom:!0,left:!0,right:!0}},E=document.body;T.RangePicker=m}(this);
!function(s){var e=(s.sPlusPlus,s.ZSClass),l=e.Selector,t=l.Design||(l.Design={}),i={class:"cellSelection",edges:{top:!0,bottom:!0,left:!0,right:!0}};t.Cell=i}(this);
!function(e){function t(){D||(this.edges.bottom.Dom.style.cursor="grab",this.edges.bottom.Dom.style.cursor="-webkit-grab",this.edges.top.Dom.style.cursor="grab",this.edges.top.Dom.style.cursor="-webkit-grab",this.edges.left.Dom.style.cursor="grab",this.edges.left.Dom.style.cursor="-webkit-grab",this.edges.right.Dom.style.cursor="grab",this.edges.right.Dom.style.cursor="-webkit-grab")}function s(e){e.edges.bottom.Dom.style.cursor="",e.edges.top.Dom.style.cursor="",e.edges.left.Dom.style.cursor="",e.edges.right.Dom.style.cursor=""}function o(t,o,i){D=!0,t.stopPropagation(),t.preventDefault(),s(this);var u=n.view.getActiveGridID(),g=n.view.getGridComponent(u),l=g.getRelativeCoordinates(t);l.x+=o,l.y+=i;var d=n.view.getSheetID(u),h=n.view.getSheetState(u,d),v=h.getActiveRange();m.publish(a.Listener,c.Mouse.DragStart,{COLX:l.x,ROWY:l.y,RANGE:v}),e.addEventListener("mouseup",r)}function r(){D=!1,e.removeEventListener("mouseup",r)}function i(e){o.call(this,e,0,0)}function u(e){o.call(this,e,0,3)}function g(e){o.call(this,e,3,0)}var n=e.sPlusPlus,l=(n.view.measures,e.ZSEvents),m=l.topic,a=l.Groups,c=l.Names,d=e.ZSClass,h=d.Selector,v=h.Design||(h.Design={}),b=(document.body,{class:"rangeSelection",filler:!0,edges:{top:{mousedown:u,mouseup:r,mouseover:t},bottom:{mousedown:i,mouseup:r,mouseover:t},left:{mousedown:g,mouseup:r,mouseover:t},right:{mousedown:i,mouseup:r,mouseover:t}}}),p={class:"rangeSelection",filler:!0,edges:{top:!1,bottom:!1,left:!1,right:!1}},D=!1;v.Range=b,v.RangeReadOnly=p}(this);
!function(e){function t(){}function i(){}function o(t){{var i=s.view.getActiveGridID(),o=s.view.getResourceID(i),n=s.view.getVersionID(i),c=s.data.getWorkBook(o,n),D=s.view.getSheetID(i),v=c.getSheetObj(D),S=s.view.getGridComponent(i),d=S.getRelativeCoordinates(t),g=v.Row.auxiliaryAxis.findAbs(d.y),E=v.Column.axis.findAbs(d.x);s.view.getSheetState(i,D)}setTimeout(function(){var t=function(e){l.publish(a.Selector.BoundUpdate.CellEdit,u.Selection.BOUND_UPDATE.ADD,{RID:o,SHEETID:D,VERSION:n,RANGE:new r.Range(g,E,g,E),RANGEID:0}),l.publish(a.Listener,u.CellAction.VALUE.SET,{RID:o,SHEETID:D,VERSION:n,ROW:g,COL:E,VALUE:{DisplayValue:e[g][E].DisplayValue},FOCUS:!0})},c=function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)},v=["DisplayValue"];s.view.fetchCellData(o,D,n,g,E,v,i,t,c)},0)}var s=e.sPlusPlus,n=(s.view.measures,e.ZSEvents),l=n.topic,a=n.Groups,u=n.Names,r=e.ZSClass,c=r.Selector,D=c.Design||(c.Design={}),v=(document.body,{class:"dvListBtn",filler:{mousedown:o,mouseover:t,mouseleave:i}});D.DataValidationList=v}(this);
!function(e){function t(t){t.stopPropagation(),t.returnValue=!1;var i=s.view.getActiveGridID(),o=s.view.getGridComponent(i),r=o.getRelativeCoordinates(t),a=e.JSUtil.Key.getKeyCombination(t),c=a===e.ZSConstants.JSKeyCode.SUPER+"+"+t.which;l.publish(n.Listener,S.Mouse.FillStart,{GRIDID:i,COORDINATES:r,ISCTRLPRESSED:c})}function i(e){e.stopPropagation(),e.preventDefault();var t=s.view.getActiveGridID(),i=s.view.getResourceID(t),o=s.view.getSheetID(t),r=s.view.getVersionID(t),l=s.view.getSheetState(t,o),n=s.view.getSelectedSheets(t),S=l.getActiveRange();c.FillSeriesAuto(i,n,r,S)}var s=e.sPlusPlus,o=e.ZSClass,r=e.ZSEvents,l=r.topic,n=r.Groups,S=r.Names,a=o.Selector,c=e.UserAction,g=a.Design||(a.Design={}),u={class:"fillSeriesSelection",edges:{top:!0,bottom:!0,left:!0,right:!0}},v={class:"fillSeriesCue",corners:{br:{mousedown:t,dblclick:i}}};g.FillSeries=u,g.FillSeriesCue=v}(this);
!function(s){var t=(s.sPlusPlus,s.ZSClass),e=t.Selector,o=e.Design||(e.Design={}),i={class:"cutCopySelection",edges:{top:!0,bottom:!0,left:!0,right:!0}};o.CutCopy=i}(this);
!function(e){var s=(e.sPlusPlus,e.ZSClass),t=s.Selector,r=t.Design||(t.Design={}),a={class:"dragSelection",filler:!0,edges:{top:!0,bottom:!0,left:!0,right:!0}};r.Drag=a;var a={class:"dragHeader",edges:{top:!0,left:!0}};r.HeaderDrag=a}(this);
!function(e){var s=(e.sPlusPlus,e.ZSClass),t=s.Selector,r=t.Design||(t.Design={}),l={class:"userPresence",filler:!0,edges:{top:!0,left:!0,bottom:!0,right:!0}};r.UserPresence=l}(this);
!function(s){var t=(s.sPlusPlus,s.ZSClass),e=t.Selector,i=e.Design||(e.Design={}),l={class:"highlightCmt glowUser",filler:!0,edges:{top:!0,left:!0,bottom:!0,right:!0}};i.CommentsHighlight=l}(this);
!function(s){var e=(s.sPlusPlus,s.ZSClass),i=e.Selector,n=i.Design||(i.Design={}),t={class:"versionCue",edges:{top:!0}};n.VersionCue=t}(this);
!function(s){var t=(s.sPlusPlus,s.ZSClass),e=t.Selector,i=e.Design||(e.Design={}),g={class:"pasteWidget",edges:{top:!0,left:!0,bottom:!0,right:!0}};i.PasteWidget=g}(this);
!function(E){var T=E.ZSConstants?E.ZSConstants:{},_=1e3;T.ContextConstant={CUT:_++,COPY:_++,PASTE:_++,CLEAR:_++,INSERT:_++,DELETE:_++,INSERT_ROW:_++,DELETE_ROW:_++,INSERT_COL:_++,DELETE_COL:_++,ROW_HEIGHT_OPTIONS:_++,COLUMN_WIDTH_OPTIONS:_++,FILTER:_++,SORT:_++,HIDE_ROWS:_++,UNHIDE_ROWS:_++,HIDE_COLS:_++,UNHIDE_COLS:_++,ADD_NOTE:_++,EDIT_NOTE:_++,ADD_COMMENT:_++,DEFINE_NAME:_++,FORMATCELL:_++,PICKLIST:_++,ADD_HYPERLINK:_++,DELETE_HYPERLINK:_++,PUBLISHRANGE:_++,FREEZE:_++,UNFREEZE:_++,LOCK_RANGE:_++,UNLOCK_RANGE:_++,PIVOT_BUILDER:_++,REFRESH_PIVOT:_++,DELTE_PIVOT:_++,SPARKLINE:_++,SHEET_INSERT:_++,SHEET_DELETE:_++,SHEET_RENAME:_++,SHEET_DUPLICATE:_++,SHEET_COPY:_++,SHEET_PASTE:_++,SHEET_MOVE:_++,SHEET_VIEWCODE:_++,SHEET_TABCOLOR:_++,SHEET_HIDE:_++,SHEET_UNHIDE:_++,SHEET_LOCKSHEET:_++,ARRANGE_IMAGE:_++,SAVE_IMAGE:_++,DELETE_IMAGE:_++,CLONE_IMAGE:_++,RESIZE_IMAGE:_++,REPLACE_IMAGE:_++,COPYAS_NEW_SHEET:_++,EDIT_CHART:_++,STYLE_CHART:_++,MOVE_CHART:_++,CLONE_CHART:_++,DELETE_CHART:_++,SAVE_CHART:_++,PUBLISH_CHART:_++,PUBLISH_CHART_URL:_++,REVERT_PUBLISH:_++,ADD_TO_IMAGE_LIBRARY:_++,PIVOT_BUILDER:_++,PIVOT_CHART:_++,PIVOT_MOVE:_++,PIVOT_COPY:_++,PIVOT_REFRESH:_++,PIVOT_DELETE:_++,BUTTON_ASSIGN_EXISTING_MACRO:_++,BUTTON_ASSIGN_NEW_MACRO:_++,BUTTON_EDIT_LABEL:_++,BUTTON_CLONE:_++,BUTTON_DELETE:_++,BUTTON_ASSIGN_NEW_DELUGE:_++,BUTTON_ASSIGN_EXISTING_DELUGE:_++,MANAGE_FORM:_++,VBA_EDITOR:_++}}(this);
!function(e){function t(e){var t=n(e);return t&&t.open(e),e.preventDefault(),e.stopPropagation(),!1}function n(e){for(var t=e.path,n=t.length,i=0;n>i;i++){var r=t[i];if("BODY"==r.tagName)return;var o=r.getAttribute("context");if(o)return m[o]}}function i(e){var t=a.getElementById(e);t&&t.remove()}function r(){o&&(o.hide(),u.data.UserInfo.Permission.isScrollable=!0)}var o,u=e.sPlusPlus,a=e.document,s=e.ZSClass,c=e.UIUtil.Component,l=(e.ZSConstants.wCC,e.ZSEvents),d=l.topic,v=l.Groups,f=l.Names,m={},p=[],I=function(){var e=a.createElement("ul");return e.setAttribute("data-type","list"),e}(),h=function(){var e=a.createElement("li");return e.setAttribute("mtype","separator"),e}(),E=function(){};E.custumObj={},E.register=function(e,t){m[e]=t,p.push(e)},E.create=function(e,t,n,r){var s,l=n.length;if(i(e),l){s=I.cloneNode(!0),r&&s.setAttribute("data",'{"componentOptions":{}}'),s.id=e;for(var m=!1,p=!1,g=0;l>g;g++){for(var b=n[g],S=!1,O=0;O<b.length;O++){var C=t[b[O]];C&&(s.appendChild(C),S=!0,m=!1,p=!0)}if(S){var C=h.cloneNode(!0);s.appendChild(C),m=!0}}m&&s.removeChild(s.lastChild),p&&(c.bind(s,"zmenubeforeshow",function(e,t){var n=u.view.getActiveGridID(),i=u.view.getResourceID(n),r=u.view.getSheetID(n),o=u.view.getVersionID(n),a=t.currentTarget;a.dataset&&a.dataset.sheetId&&(r=a.dataset.sheetId),d.publish(v.UI,f.Menu.CONTEXT_BEFORE_SHOW,{RID:i,SHEETID:r,VERSION:o,UI:t.menu.context,OBJ:E.custumObj})}),c.bind(s,"zmenushow",function(e,t){o=t.menu,u.data.UserInfo.Permission.isScrollable=!1;var n=u.view.getActiveGridID(),i=u.view.getResourceID(n),r=u.view.getSheetID(n),a=u.view.getVersionID(n);d.publish(v.UI,f.Menu.CONTEXT_SHOW,{RID:i,SHEETID:r,VERSION:a,UI:t.menu.context,OBJ:E.custumObj})}),c.bind(s,"zmenuhide",function(){u.data.UserInfo.Permission.isScrollable=!0})),p&&(a.body.appendChild(s),c.zmenu(s))}return s},E.open=function(e,t){r(),t&&(c.zmenu(t,"show",{event:e,direction:"at-cursor"}),JSUtil.Mouse.BindOnExternalClick(t,r))},E.doRightClick=function(e,t,n){var i=m[t];return i&&i.open(e),E.custumObj=n,e.preventDefault(),e.stopPropagation(),!1},a.querySelector("#MainGrid").addEventListener("contextmenu",function(e){t(e)},!1),a.querySelector("#TB_SHEET_CONTAINER").addEventListener("contextmenu",function(e){t(e)},!1),s.ContextMenu=E}(this);
!function(i){function t(i,t,h,n){this.fixRight=!!i,this.fixBottom=!!t,this.fixWidth=!!h,this.fixHeight=!!n}var h=i.ZSClass,n=h.Layer||(h.Layer={}),s=n.Utility||(n.Utility={});t.prototype={isFixedRight:function(){return this.fixRight},isFixedBottom:function(){return this.fixBottom},isFixedWidth:function(){return this.fixWidth},isFixedHeight:function(){return this.fixHeight}},s.Point=t}(this);
!function(t){function e(t,e){for(var r={},n=0;n<e.length;n++)e[n]&&e[n].prototype&&Object.assign(r,e[n].prototype);return Object.assign(r,t.prototype),r}var r=t.ZSClass,n=r.Layer||(r.Layer={}),a=n.Interface||(n.Interface={});a.implement=e}(this);
!function(n){function o(){t.error("Layer: Implementation required")}var e=n.ZSClass,t=n.ZSDevTools,i=e.Layer||(e.Layer={}),u=i.Interface||(i.Interface={});o.prototype={onMouseOver:function(){},onMouseLeave:function(){},onFocus:function(){},onBlur:function(){},onMove:function(){},onMoveEnd:function(){},onResize:function(){},onResizeEnd:function(){},getID:function(){},getController:function(){},onPlace:function(){},onRemove:function(){},onLabelChange:function(){},onShowLoader:function(){},onHideLoader:function(){}},u.Layer=o}(this);
!function(n){function o(){t.error("RouterInterface: Implementation required")}var e=n.ZSClass,t=n.ZSDevTools,u=e.Layer||(e.Layer={}),i=u.Interface||(u.Interface={});o.prototype={onMouseOver:function(){},onMouseLeave:function(){},onFocus:function(){},onBlur:function(){},onMove:function(){},onMoveEnd:function(){},onResize:function(){},onResizeEnd:function(){},getID:function(){},getController:function(){},onPlace:function(){},onRemove:function(){},onRemoveAll:function(){},onLabelChange:function(){},onShowLoader:function(){},onHideLoader:function(){}},i.Router=o}(this);
!function(n){function o(){u.error("ControlInterface: Implementation required")}function e(){u.error("ControllerInterface: Implementation required")}function t(){}function i(){}var c=n.ZSClass,u=n.ZSDevTools.Logger,f=c.Layer||(c.Layer={}),r=f.Interface||(f.Interface={});t.prototype={getInteracter:function(){},updateBoundary:function(){},mouseover:function(){},mouseleave:function(){},scrollIntoView:function(){},focus:function(){},blur:function(){},focusAll:function(){},blurAll:function(){},move:function(){},moveEnd:function(){},resize:function(){},resizeEnd:function(){},place:function(){},delete:function(){},remove:function(){},removeAll:function(){},clone:function(){},setLabel:function(){},assignMacro:function(){},showLoader:function(){},hideLoader:function(){},executeScript:function(){},onRender:function(){},onLoad:function(){}},i.prototype={updateBoundary:function(){},onMouseOver:function(){},onMouseLeave:function(){},onScrollIntoView:function(){},onFocus:function(){},onBlur:function(){},onFocusAll:function(){},onBlurAll:function(){},onMove:function(){},onMoveEnd:function(){},onResize:function(){},onResizeEnd:function(){},onPlace:function(){},onRemove:function(){},onShow:function(){},onHide:function(){},onDelete:function(){},onClone:function(){},onPlaceEdit:function(){},onRemoveEdit:function(){},onSubmitEdit:function(){},onExecuteScript:function(){},onLabelChange:function(){},onAssignMacro:function(){},onShowLoader:function(){},onHideLoader:function(){},onRender:function(){},onCachedViewAttach:function(){},onRefresh:function(){},onLoad:function(){},onZoom:function(){},onUpdatePanelStatus:function(){},onURLChange:function(){},onResizeToOriginal:function(){},onReplaceImage:function(){}},o.prototype=r.implement(o,[i]),e.prototype=r.implement(e,[t,i]),r.Control=o,r.Controller=o}(this);
!function(o){function t(){n.error("FocusController: implemetation required")}var e=o.ZSClass,n=o.ZSDevTools,s=e.Layer||(e.Layer={}),i=s.Modules||(s.Modules={}),u=i.Focus||(i.Focus={});t.prototype={mouseover:function(o){this.onMouseOver(o)},mouseleave:function(o){this.onMouseLeave(o)},scrollIntoView:function(o){var t=this.getInteracter(o);this.onScrollIntoView(o,t)},focus:function(o){this.Master.onFocus(this),this.onFocus(o)},blur:function(o){this.Master.onBlur(),this.onBlur(o)},focusAll:function(o,t,e){this.Master.focusAll(o,t,e)},blurAll:function(o,t,e){this.Master.blurAll(o,t,e)},onMouseOver:function(o){this.State.onMouseOver(o),this.Views.onMouseOver(o),this.Network.onMouseOver(o)},onMouseLeave:function(o){this.State.onMouseLeave(o),this.Views.onMouseLeave(o),this.Network.onMouseLeave(o)},onScrollIntoView:function(o,t){this.State.onScrollIntoView(o,t),this.Views.onScrollIntoView(o,t),this.Network.onScrollIntoView(o,t)},onFocus:function(o){this.State.onFocus(o),this.Views.onFocus(o),this.Network.onFocus(o)},onBlur:function(o){this.State.onBlur(o),this.Views.onBlur(o),this.Network.onBlur(o)},onFocusAll:function(){var o=this.getAlive();for(var t in o)this.onFocus(t)},onBlurAll:function(o){var t=this.getActive();for(var o in t)this.onBlur(o)}},u.Controller=t}(this);
!function(o){function s(){t.error("FocusLayer: implemetation required")}var e=o.ZSClass,t=o.ZSDevTools,i=e.Layer||(e.Layer={}),u=i.Modules||(i.Modules={}),r=u.Focus||(u.Focus={});s.prototype={onMouseOver:function(){this.Dom.classList.add("hover")},onMouseLeave:function(){this.Dom.classList.remove("hover")},onFocus:function(){this.Dom.classList.add("focus")},onBlur:function(){this.Dom.classList.remove("focus")}},r.Layer=s}(this);
!function(o){function e(){u.error("FocusRouter: implemetation required")}var t=o.ZSClass,u=o.ZSDevTools,n=t.Layer||(t.Layer={}),s=n.Modules||(n.Modules={}),r=s.Focus||(s.Focus={});e.prototype={onMouseOver:function(o){var e=this.get(o);e.onMouseOver()},onMouseLeave:function(o){var e=this.get(o);e.onMouseLeave()},onFocus:function(o){var e=this.get(o);e.onFocus()},onBlur:function(o){var e=this.get(o);e.onBlur()}},r.Router=e}(this);
!function(o){function i(){e.error("FocusViewControl: implemetation required")}var s=o.ZSClass,e=o.ZSDevTools,r=s.Layer||(s.Layer={}),n=r.Modules||(r.Modules={}),t=n.Focus||(n.Focus={});i.prototype={onMouseOver:function(o){for(var i in this.Views){var s=this.Views[i];s.onMouseOver(o)}},onMouseLeave:function(o){for(var i in this.Views){var s=this.Views[i];s.onMouseLeave(o)}},onFocus:function(o){for(var i in this.Views){var s=this.Views[i];s.onFocus(o)}},onBlur:function(o){for(var i in this.Views){var s=this.Views[i];s.onBlur(o)}}},t.ViewControl=i}(this);
!function(e){function t(t){var r=this.getController(),n=this.getID(),u=r.getInteracter(n);u.isEditable()&&(t.preventDefault(),t.stopPropagation(),c=!1,i=this,r.blurAll(),e.addEventListener("mousemove",s),e.addEventListener("mouseup",o),r.focus(n))}function s(){c=!0}function o(){if(!c){var t=i.getController(),r=i.getID();t.scrollIntoView(r)}e.removeEventListener("mousemove",s),e.removeEventListener("mouseup",o)}function r(){var e=this.getController(),t=this.getID(),s=e.getInteracter(t);s.isEditable()&&e.mouseover(t)}function n(){var e=this.getController(),t=this.getID(),s=e.getInteracter(t);s.isEditable()&&e.mouseleave(t)}var i,u=e.ZSClass,l=(e.sPlusPlus,u.Layer||(u.Layer={})),a=l.Modules||(l.Modules={}),v=a.Focus||(a.Focus={}),c=(e.JSUtil.Mouse.BindEvents,!1);v.Listeners={mouseover:r,mouseleave:n,focuslayer:t}}(this);
!function(e){function o(){n.error("MoveController: implementation required")}var t=e.ZSClass,n=e.ZSDevTools,r=t.Layer||(t.Layer={}),i=r.Modules||(r.Modules={}),v=i.Move||(i.Move={});o.prototype={move:function(e,o){this.Master.move(o)},moveEnd:function(e,o){this.Master.moveEnd(o)},onMove:function(e){var o=this.getActive();for(var t in o){var n=this.getInteracter(t);e.move(n),this.State.onMove(t,n,e),this.Views.onMove(t,n,e),this.Network.onMove(t,n,e)}},onMoveEnd:function(e){var o=this.getActive();for(var t in o){var n=this.getInteracter(t);e.moveEnd(n),this.State.onMoveEnd(t,n,e),this.Views.onMoveEnd(t,n,e),this.Network.onMoveEnd(t,n,e)}}},v.Controller=o}(this);
!function(o){function e(){t.error("MoveViewControl: implementation required")}var n=o.ZSClass,t=o.ZSDevTools,i=n.Layer||(n.Layer={}),r=i.Modules||(i.Modules={}),s=r.Move||(r.Move={});e.prototype={onMove:function(o,e){this.onPlace(o,e)},onMoveEnd:function(o,e){this.onPlace(o,e)}},s.ViewControl=e}(this);
!function(t){function i(t,i,e,s){this.x=t,this.y=i,this.xCallBack=e,this.yCallBack=s}function e(t,i,e){this.direction=t,this.shiftKey=i,this.callBack=e}var s=t.ZSClass,c=(t.ZSDevTools,s.Layer||(s.Layer={})),o=c.Modules||(c.Modules={}),a=o.Move||(o.Move={});i.prototype={move:function(t){var i=this.x+t.getX(),e=this.y+t.getY();0>=i?i=0:this.xCallBack&&this.xCallBack(),0>=e?e=0:this.yCallBack&&this.yCallBack(),t.setPosition(i,e)},moveEnd:function(){}};var h={Left:0,Right:1,Up:2,Down:3};e.prototype={move:function(t){var i=t.getX(),e=t.getY();switch(this.direction){case h.Left:i=this.shiftKey?t.getNextRightStickyX():t.getLeftStickyX();break;case h.Right:i=this.shiftKey?t.getRightStickyX():t.getNextLeftStickyX();break;case h.Up:e=this.shiftKey?t.getNextBottomStickyY():t.getTopStickyY();break;case h.Down:e=this.shiftKey?t.getBottomStickyY():t.getNextTopStickyY()}this.callBack&&this.callBack(),t.setPosition(i,e),t.scrollIntoView()},moveEnd:function(){}},a.Helper=i,a.StickyHelper=e}(this);
!function(t){function e(t){var e=this.getController(),o=this.getID(),a=e.getInteracter(o);if(a.isEditable()){var l=a.getCoordinates(t);s=l.x,i=l.y,t.preventDefault(),t.stopPropagation(),v.call(this,n,r)}}function n(t){var e=this.getID(),n=this.getController(),r=n.getInteracter(e),s=r.getCoordinates(t);o.call(this,s.x,s.y)}function o(t,e){function n(){s=t}function o(){i=e}var r=this.getID(),a=this.getController(),l=(a.getInteracter(r),t-s),g=e-i,u=new c(l,g,n,o);a.move(r,u)}function r(t){var e=this.getID(),n=this.getController(),o=n.getInteracter(e),r=o.getCoordinates(t),a=r.x-s,l=r.y-i,g=new c(a,l);n.moveEnd(e,g)}var s,i,a=t.ZSClass,l=(t.sPlusPlus,a.Layer||(a.Layer={})),g=l.Modules||(l.Modules={}),u=g.Move||(g.Move={}),c=u.Helper,v=t.JSUtil.Mouse.BindEvents;u.Listeners={mousedown:e,update:o}}(this);
!function(e){function i(){s.error("ResizeController: implementation required")}var t=e.ZSClass,s=e.ZSDevTools,r=t.Layer||(t.Layer={}),n=r.Modules||(r.Modules={}),o=n.Resize||(n.Resize={});i.prototype={resize:function(e,i){this.Master.resize(i)},resizeEnd:function(e,i){this.Master.resizeEnd(i)},onResize:function(e){var i=this.getActive();for(var t in i){var s=this.getInteracter(t);e.resize(s),this.State.onResize(t,s,e),this.Views.onResize(t,s,e),this.Network.onResize(t,s,e)}},onResizeEnd:function(e){var i=this.getActive();for(var t in i){var s=this.getInteracter(t);e.resizeEnd(s),this.State.onResizeEnd(t,s,e),this.Views.onResizeEnd(t,s,e),this.Network.onResizeEnd(t,s,e)}}},o.Controller=i}(this);
!function(e){function i(){s.error("MoveViewControl: implementation required")}var o=e.ZSClass,s=e.ZSDevTools,n=o.Layer||(o.Layer={}),r=n.Modules||(n.Modules={}),t=r.Resize||(r.Resize={});i.prototype={onResize:function(e,i,o){for(var s in this.Views){var n=this.Views[s];n.onResize(e,i,o)}},onResizeEnd:function(e,i,o){for(var s in this.Views){var n=this.Views[s];n.onResizeEnd(e,i,o)}}},t.ViewControl=i}(this);
!function(i){function t(i,t,h,s,e){this.point=i,this.X=t,this.Y=h,this.width=s,this.height=e}var h=i.ZSClass,s=(i.ZSDevTools,h.Layer||(h.Layer={})),e=s.Modules||(s.Modules={}),r=e.Resize||(e.Resize={});t.prototype={updateCoordinate:function(i,t){this.currX=i,this.currY=t},resize:function(i){var t=this.point,h=t.isFixedRight(),s=t.isFixedBottom(),e=t.isFixedWidth(),r=t.isFixedHeight(),o=this.X,n=this.Y,u=this.width,d=this.height;if(!e){var o=h?this.currX:this.X;u=h?this.width-(this.currX-this.X):this.currX-this.X}if(!r){var n=s?this.currY:this.Y;d=s?this.height-(this.currY-this.Y):this.currY-this.Y}var c=i.getMinimumDimension();u<=c.width&&(u=c.width,h&&(o=this.X+this.width-u)),d<=c.height&&(d=c.height,s&&(n=this.Y+this.height-d)),i.setPosition(o,n),i.setDimension(u,d)},resizeEnd:function(){}},r.Helper=t}(this);
!function(t){function e(t){c=I.TOPLEFT,h.call(this,t)}function n(t){c=I.TOPRIGHT,h.call(this,t)}function o(t){c=I.BOTTOMRIGHT,h.call(this,t)}function i(t){c=I.BOTTOMLEFT,h.call(this,t)}function s(t){c=I.TOP,h.call(this,t)}function l(t){c=I.RIGHT,h.call(this,t)}function T(t){c=I.BOTTOM,h.call(this,t)}function u(t){c=I.LEFT,h.call(this,t)}function h(t){var e=this.getController(),n=this.getID(),o=e.getInteracter(n);o.isEditable()&&(w=new L(c,this.left,this.top,this.width,this.height),t.preventDefault(),t.stopPropagation(),m.call(this,a,r))}function a(t){var e=this.getController(),n=this.getID(),o=e.getInteracter(n),i=o.getCoordinates(t);w.updateCoordinate(i.x,i.y),e.resize(n,w)}function r(){var t=this.getID(),e=this.getController();e.resizeEnd(t,w)}var c,w,O=t.ZSClass,d=(t.sPlusPlus,O.Layer||(O.Layer={})),f=d.Utility,P=d.Modules||(d.Modules={}),g=P.Resize||(P.Resize={}),L=g.Helper,m=t.JSUtil.Mouse.BindEvents,I={TOP:new f.Point(1,1,1,0),BOTTOM:new f.Point(1,0,1,0),LEFT:new f.Point(1,1,0,1),RIGHT:new f.Point(0,1,0,1),TOPLEFT:new f.Point(1,1,0,0),TOPRIGHT:new f.Point(0,1,0,0),BOTTOMLEFT:new f.Point(1,0,0,0),BOTTOMRIGHT:new f.Point(0,0,0,0)};g.Listeners={TopLeft:{mousedown:e},TopRight:{mousedown:n},BottomRight:{mousedown:o},BottomLeft:{mousedown:i},Top:{mousedown:s},Right:{mousedown:l},Bottom:{mousedown:T},Left:{mousedown:u}}}(this);
!function(e){function i(){s.error("ResizeRouter: implemetation required")}var o=e.ZSClass,s=e.ZSDevTools,t=o.Layer||(o.Layer={}),n=t.Modules||(t.Modules={}),r=n.Resize||(n.Resize={});i.prototype={onResize:function(e,i,o){var s=this.get(e);s.onResize(i,o)},onResizeEnd:function(e,i,o){var s=this.get(e);s.onResizeEnd(i,o)}},r.Router=i}(this);
!function(e){function t(e,t){var i=document.createElement("div");i.className="mOleCue",this.dom=i;var s=document.createElement("span");i.appendChild(s),s.dataset.key=e,this.span1=s;var s=document.createElement("span");s.dataset.key=t,i.appendChild(s),this.span2=s}function i(e,i){this.cue||(this.cue=new t("Width","Height"));var s=i.point;this.cue.show(this.Dom),this.cue.setPosition(s.isFixedWidth(),s.isFixedHeight(),s.isFixedRight(),s.isFixedBottom()),this.cue.setValues(~~e.getWidth()+"px",~~e.getHeight()+"px")}function s(){this.cue.remove()}function n(){a.error("ResizeLayer: implemetation required")}var o=e.ZSClass,a=e.ZSDevTools,h=o.Layer||(o.Layer={}),c=h.Modules||(h.Modules={}),d=c.Resize||(c.Resize={});t.prototype={show:function(e){e.appendChild(this.dom)},remove:function(){this.dom.remove()},setValues:function(e,t){this.span1.innerText=e,this.span2.innerText=t},setPosition:function(e,t,i,s){var n="mOleCue cue";t||(n+=s?"t":"b"),e||(n+=i?"l":"r"),this.dom.className=n}},n.prototype={onResize:function(e,t){var s=e.getX(),n=e.getY(),o=e.getWidth(),a=e.getHeight();this.onPlace(s,n,o,a),i.call(this,e,t)},onResizeEnd:function(e){var t=e.getX(),i=e.getY(),n=e.getWidth(),o=e.getHeight();this.onPlace(t,i,n,o),s.call(this)}},d.Layer=n}(this);
!function(e){function o(){n.error("CloneController: implemetation required")}var t=e.ZSClass,n=e.ZSDevTools,r=t.Layer||(t.Layer={}),l=r.Modules||(r.Modules={}),i=l.Clone||(l.Clone={});o.prototype={clone:function(e,o){this.Master.clone(o)},onClone:function(e){var o=this.getActive();for(var t in o){var n=this.getInteracter(t);e.clone(n),this.State.onClone(t,n,e),this.Views.onClone(t,n,e),this.Network.onClone(t,n,e)}}},i.Controller=o}(this);
!function(t){function e(t,e){this.setOffset(t,e)}var s=t.ZSClass,o=(t.ZSDevTools,s.Layer||(s.Layer={})),i=o.Modules||(o.Modules={}),n=i.Clone||(i.Clone={});e.prototype={clone:function(t){t.clone();var e=t.getX()+this.x,s=t.getY()+this.y;t.setPosition(e,s)},setOffset:function(t,e){this.x=t,this.y=e}},n.Helper=e}(this);
!function(e){function t(e,t,i,n){this.State=new e,this.Network=new t,this.Views=new i,this.Master=n,n.addController(this)}var i=e.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,s=n.Modules||(n.Modules={}),r=s.Main||(s.Main={});t.prototype={addView:function(e){this.Views.add(e)},removeView:function(e){this.Views.remove(e)},getActive:function(){return this.State.getActive()},getAlive:function(){return this.State.getAlive()},getInteracter:function(e){var t=new o.Interacter(e,this);return t},place:function(e){var t=this.getInteracter(e);this.onPlace(e,t)},remove:function(e){this.onRemove(e)},removeAll:function(e){var t=this.getAlive();for(var e in t)this.onRemove(e)},delete:function(e){this.Master.delete(e)},onPlace:function(e,t){this.State.onPlace(e,t),this.Views.onPlace(e,t),this.Network.onPlace(e,t)},onRemove:function(e,t){this.State.onRemove(e,t),this.Views.onRemove(e,t),this.Network.onRemove(e,t)},onShow:function(e,t){this.State.onShow(e,t),this.Views.onShow(e,t),this.Network.onShow(e,t)},onHide:function(e,t){this.State.onHide(e,t),this.Views.onHide(e,t),this.Network.onHide(e,t)},onDelete:function(e){var t=this.getActive();for(var e in t){var i=this.getInteracter(e);this.State.onDelete(e,i),this.Views.onDelete(e,i),this.Network.onDelete(e,i)}}};var a=[o.Controller];t.prototype=o.implement(t,a),r.Controller=t}(this);
!function(t){function i(t,i,e,o,n){r.call(this,i,e,n),this.ID=t,this.parent=i,this.Controller=o}var e=t.ZSClass,o=e.Layer||(e.Layer={}),n=o.Interface,s=o.Modules||(o.Modules={}),h=s.Main||(s.Main={}),r=e.UILayer;i.prototype={getID:function(){return this.ID},getController:function(){return this.Controller},onPlace:function(t,i,e,o){this.top=~~i,this.left=~~t,this.height=~~o,this.width=~~e;var n=this.Dom.style;n.top=this.top+"px",n.left=this.left+"px",n.height=this.height+"px",n.width=this.width+"px"},onRemove:function(){this.Dom.remove(),this.onBlur(),this.onMouseLeave()},onShow:function(){this.Dom.style.display=""},onHide:function(){this.Dom.style.display="none"}};var l=[n.Layer];i.prototype=n.implement(i,l),h.Layer=i}(this);
!function(t){function e(t,e,i,n){this.Active={},this.inActive=[],this.Controller=n,this.Layer=e,this.parent=t,this.Model=i}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,s=n.Modules||(n.Modules={}),r=s.Main||(s.Main={});e.prototype={get:function(t){return this.Active[t]||(this.Active[t]=new this.Layer(t,this.parent,this.Model,this.Controller)),this.Active[t]},onPlace:function(t,e,i,n,o){var s=this.get(t);s.onPlace(e,i,n,o)},onRemove:function(t){var e=this.get(t);e.onRemove(),delete this.Active[t]},onShow:function(t){var e=this.get(t);e.onShow()},onHide:function(t){var e=this.get(t);e.onHide()}};var h=[o.Router];e.prototype=o.implement(e,h),r.Router=e}(this);
!function(t){function e(){this.Alive={},this.Active={}}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,c=n.Modules||(n.Modules={}),l=c.Main||(c.Main={});e.prototype={onPlace:function(t){this.Alive[t]=!0},onRemove:function(t){this.onBlur(t),delete this.Alive[t]},onScrollIntoView:function(t,e){e.scrollIntoView()},onFocus:function(t){this.Active[t]=!0},onBlur:function(t){delete this.Active[t]},getAlive:function(){return this.Alive},getActive:function(){return this.Active}};var r=[o.Control];e.prototype=o.implement(e,r),l.StateControl=e}(this);
!function(t){function o(){}var e=t.ZSClass,r=e.Layer||(e.Layer={}),n=r.Interface,a=r.Modules||(r.Modules={}),i=a.Main||(a.Main={});o.prototype={};var s=[n.Control];o.prototype=n.implement(o,s),i.NetworkControl=o}(this);
!function(i){function e(){this.Views=[]}var t=i.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,s=o.Modules||(o.Modules={}),r=s.Main||(s.Main={});e.prototype={add:function(i){this.Views.push(i)},remove:function(i){var e=this.Views.indexOf(i);this.Views[e]&&(this.Views[e].onRemoveAll(),this.Views.splice(e,1))},onPlace:function(i,e){for(var t in this.Views){var o=this.Views[t];o.onPlace(i,e.getX(),e.getY(),e.getWidth(),e.getHeight())}},onRemove:function(i){for(var e in this.Views){var t=this.Views[e];t.onRemove(i)}},onShow:function(i){for(var e in this.Views){var t=this.Views[e];t.onShow(i)}},onHide:function(i){for(var e in this.Views){var t=this.Views[e];t.onHide(i)}},onDelete:function(i){this.onRemove(i)}};var h=[n.Control];e.prototype=n.implement(e,h),r.ViewControl=e}(this);
!function(o){function e(o){function e(o){var e=n.getController(),s=n.getID(),t=e.getInteracter(s);t.isScriptAvailable()?e.executeScript(s):c.focuslayer.call(n,o)}function s(o){var e=n.Dom,s=e.querySelector(".ZSOLEBtn");s.classList.add("drgDrpCur"),JSUtil.Mouse.BindEvents.call(n,function(){},function(){s.classList.remove("drgDrpCur")});var t=n.getController();c.focuslayer.call(n,o),m.mousedown.call(n,o),f.publish(p.Listener,v.Mouse.ScrollOut,{GRIDID:t.gridID,CALLBACK:function(o,e,s,t,u){m.update.call(n,t,u)}})}function t(o){c.focuslayer.call(n,o)}var n=this;o.preventDefault(),o.stopPropagation(),g.call(this,o,e,s,t)}function s(o){o.preventDefault(),o.stopPropagation()}var t=o.ZSClass,n=t.Layer||(t.Layer={}),u=n.Button||(n.Button={}),r=n.Modules,l=r.Move,i=r.Resize,d=r.Focus,m=l.Listeners,a=i.Listeners,c=d.Listeners,w=o.ZSEvents,f=w.topic,p=w.Groups,v=w.Names,g=o.JSUtil.Mouse.Register,L={class:"ZSOle",Listeners:{mouseover:c.mouseover,mouseleave:c.mouseleave,mousedown:e,dblclick:s},corners:{tl:{mousedown:a.TopLeft.mousedown},tr:{mousedown:a.TopRight.mousedown},bl:{mousedown:a.BottomLeft.mousedown},br:{mousedown:a.BottomRight.mousedown},t:{mousedown:a.Top.mousedown},b:{mousedown:a.Bottom.mousedown},l:{mousedown:a.Left.mousedown},r:{mousedown:a.Right.mousedown}},edges:{top:{mousedown:m.mousedown},bottom:{mousedown:m.mousedown},left:{mousedown:m.mousedown},right:{mousedown:m.mousedown}}};u.Model=L}(this);
!function(t){function e(t,e,i,o,s,r){var n=a.data.getWorkBook(e,o),h=n.getSheetObj(i),g=h.Buttons,u=g.get(s);this.gridID=t,this.rID=e,this.sheetID=i,this.version=o,this.ID=s,this.button=u,this.Controller=r}function i(t){this.interacter=t}function o(t,e,i,o,s,r){switch(r){case b.AddExistingMacro:UserAction.assignExistingMacro(t,e,i,s,function(r,n){s.setScript(r,n),UserAction.SetMacroButton(t,e,i,o,s)});break;case b.CreateMacro:UserAction.CreateAndAssignMacro(t,e,i,function(r,n){s.setScript(r,n),UserAction.SetMacroButton(t,e,i,o,s)});break;case b.RecordMacro:UserAction.RecordAndAssignMacro(t,e,i,function(r,n){s.setScript(r,n),UserAction.SetMacroButton(t,e,i,o,s)});break;case b.CreateDelugeMacro:var n="Deluge";d.buttonAssignMacro(function(r){s.setScript(n,r),UserAction.SetMacroButton(t,e,i,o,s)})}}function s(e,i,o,s,r,n){var h=a.data.getWorkBook(e,o),g=h.SheetList.getById(i),u=g.getName(),c=a.view.getActiveGridID(),I=a.view.getSheetState(c,i),D=I.getActiveRange();t.UserAction.runMacro(e,i,o,s,r,[i],u,D,n)}function r(){I.register(D.Listener,S.ServerAction.PROCESSRESPONSE,n,"RESPONSE")}function n(e){var i=t.ZSConstants.CommandConstants,o=a.view.getActiveGridID(),s=a.view.getResourceID(o),r=(a.view.getVersionID(o),a.view.getSheetID(o)),h=e[i.DOCUMENT_META][s],g=h[i.SHEET_META][r],u=g[i.BUTTON];if(u[i.INSERT]){var c=u[i.INSERT][0],v=a.view.getGridComponent(o);v.Button.blurAll(),v.Button.scrollIntoView(c),v.Button.focus(c)}I.unregister(D.Listener,S.ServerAction.PROCESSRESPONSE,n)}var h=t.ZSClass,a=t.sPlusPlus,g=h.Layer||(h.Layer={}),u=(g.Interface,g.Button||(g.Button={})),c=(u.Interacter,t.ZSEvents),I=c.topic,D=c.Groups,S=c.Names,v=t.ZSConstants.FeatureConstants,d=a.view.Toolbar.Feature[v.DELUGE];e.prototype={getID:function(){return this.ID},isEditable:function(){var t=a.data.getWorkBook(this.rID,this.version);return t.isEditable()&&!t.ProtectedSheets.isSheetLocked(this.sheetID)},getLabel:function(){return this.button.getLabel()},getX:function(){var t=a.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.button.getX()*e},getY:function(){var t=a.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.button.getY()*e},getWidth:function(){var t=a.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.button.getWidth()*e},getHeight:function(){var t=a.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.button.getHeight()*e},getMinimumDimension:function(){var t=a.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return{width:30*e,height:18*e}},getCoordinates:function(t){var e=sPlusPlus.view.getGridComponent(this.gridID),i=e.getRelativeCoordinates(t),o=a.view.getSheetState(this.gridID,this.sheetID),s=o.getZoom();return{x:i.x*s,y:Math.round(i.y*s)}},getAbsoluteX:function(){var t=a.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=a.view.getSheetState(this.gridID,this.sheetID),o=i.getScreenWidths(),s=i.getScrollLefts(),r=e.Column.axis.getPos(e.Column.FreezedCount),n=this.getX(),h=0,g=~~s[1];return n>=r&&(h=o[1],g=~~s[0]),n-g+h},getAbsoluteY:function(){var t=a.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=a.view.getSheetState(this.gridID,this.sheetID),o=i.getScreenHeights(),s=i.getScrollTops(),r=e.Row.axis.getPos(e.Row.FreezedCount),n=this.getY(),h=0,g=~~s[1];return n>=r&&(h=o[1],g=s[0]),n-g+h},getLeftStickyX:function(){var t=this.button.getX(),e=a.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),o=i.Column.axis.findAbs(t-1),s=i.Column.axis.getPos(o),r=a.view.getSheetState(this.gridID,this.sheetID),n=r.getZoom();return s*n},getNextLeftStickyX:function(){var t=this.button.getX(),e=a.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),o=i.Column.axis.findAbs(t),s=i.Column.axis.getPos(o+1),r=a.view.getSheetState(this.gridID,this.sheetID),n=r.getZoom();return s*n},getRightStickyX:function(){var t=this.button.getX(),e=this.button.getWidth(),i=a.data.getWorkBook(this.rID,this.version),o=i.getSheetObj(this.sheetID),s=o.Column.axis.findAbs(t+e+1),r=o.Column.axis.getPos(s+1)-e,n=a.view.getSheetState(this.gridID,this.sheetID),h=n.getZoom();return r*h},getNextRightStickyX:function(){var t=this.button.getX(),e=this.button.getWidth(),i=a.data.getWorkBook(this.rID,this.version),o=i.getSheetObj(this.sheetID),s=o.Column.axis.findAbs(t+e-1),r=o.Column.axis.getPos(s)-e,n=a.view.getSheetState(this.gridID,this.sheetID),h=n.getZoom();return r*h},getTopStickyY:function(){var t=this.button.getY(),e=a.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),o=i.Row.auxiliaryAxis.findAbs(t-1),s=i.Row.auxiliaryAxis.getPos(o),r=a.view.getSheetState(this.gridID,this.sheetID),n=r.getZoom();return s*n},getNextTopStickyY:function(){var t=this.button.getY(),e=a.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),o=i.Row.auxiliaryAxis.findAbs(t),s=i.Row.auxiliaryAxis.getPos(o+1),r=a.view.getSheetState(this.gridID,this.sheetID),n=r.getZoom();return s*n},getBottomStickyY:function(){var t=this.button.getY(),e=this.button.getHeight(),i=a.data.getWorkBook(this.rID,this.version),o=i.getSheetObj(this.sheetID),s=o.Row.auxiliaryAxis.findAbs(t+e+1),r=o.Row.auxiliaryAxis.getPos(s+1)-e,n=a.view.getSheetState(this.gridID,this.sheetID),h=n.getZoom();return r*h},getNextBottomStickyY:function(){var t=this.button.getY(),e=this.button.getHeight(),i=a.data.getWorkBook(this.rID,this.version),o=i.getSheetObj(this.sheetID),s=o.Row.auxiliaryAxis.findAbs(t+e-1),r=o.Row.auxiliaryAxis.getPos(s)-e,n=a.view.getSheetState(this.gridID,this.sheetID),h=n.getZoom();return r*h},setLabel:function(t){this.button.setLabel(t)},setPosition:function(t,e){var i=a.view.getSheetState(this.gridID,this.sheetID),o=i.getZoom();this.button.setPosition(t/o,e/o)},setDimension:function(t,e){var i=a.view.getSheetState(this.gridID,this.sheetID),o=i.getZoom();this.button.setDimension(t/o,e/o)},clone:function(){this.button=this.button.clone()},isScriptAvailable:function(){return!!this.button.script},getNetworkInteracter:function(){var t=new i(this);return t},getController:function(){return this.Controller},scrollIntoView:function(){var t=new i(this);t.scrollIntoView()}},i.prototype={resize:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=t.ID,r=t.button;UserAction.ResizeButton(e,i,o,s,r)},move:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=t.ID,r=t.button;UserAction.MoveButton(e,i,o,s,r)},clone:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=(t.ID,t.button);UserAction.CloneButton(e,i,o,s,r)},delete:function(){{var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=t.ID;t.button}UserAction.DeleteButton(e,i,o,s)},executeScript:function(){var t=this.interacter;if(t.isEditable()){var e=t.button,i=e.getScript();if(i)if("Deluge"==i.getModule())d.runMacro(i.getMacroName());else{var o=t.rID,r=t.sheetID,n=t.version,h=t.ID,a=t.getController();a.blur(h),a.showLoader(h),s(o,r,n,i.getModule(),i.getMacroName(),function(){a.hideLoader(h)})}}},assignMacro:function(t){var e=this.interacter,i=e.rID,s=e.sheetID,r=e.version,n=e.ID,h=e.button;o(i,s,r,n,h,t)},setCaption:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=t.ID,r=t.button;UserAction.SetCaptionButton(e,i,o,s,r)},scrollIntoView:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=t.getX(),r=t.getY(),n=t.getWidth(),h=t.getHeight();UserAction.ScrollAreaIntoView(e,i,o,s,r,n,h)}};var l=0,b={AddExistingMacro:l++,CreateMacro:l++,RecordMacro:l++,CreateDelugeMacro:l++};u.Interacter=e}(this);
!function(t){function i(){var t=document.createElement("div"),i=document.createElement("div");t.classList.add("ZSOLEBtn"),i.classList.add("ZSBtnEditor"),t.appendChild(i),this.Dom=t,this.Editor=new o.Editors.BasicEditor(i)}var o=t.ZSClass,e=o.Layer||(o.Layer={}),n=e.Button||(e.Button={});i.prototype={setLabel:function(t){this.Editor.value=t},showLoader:function(){this.Dom.classList.add("loading")},hideLoader:function(){this.Dom.classList.remove("loading")},appendTo:function(t){t.appendChild(this.Dom)},remove:function(){this.Dom.remove()}},n.UIButton=i}(this);
!function(t){function e(t,e,o,s){a.Layer.call(this,t,e,o,s,function(){this.Dom.setAttribute("context","MI_BUTTON_CONTEXT"),this.Dom.classList.add("ZsBtnLayer");var e=document.createElement("div");e.className="ZSOleMenu",e.setAttribute("data-menu-id","MI_BUTTON_CONTEXT"),e.addEventListener("mousedown",function(t){t.stopPropagation()}),this.button=new h.UIButton(t,this.Dom),this.button.Editor.disable(),this.button.Dom.appendChild(e),this.button.appendTo(this.Dom)})}{var o=t.ZSClass,s=(t.sPlusPlus,o.Layer||(o.Layer={})),i=s.Interface,n=s.Modules,a=n.Main,r=n.Focus,u=n.Resize,h=(n.Move,s.Button||(s.Button={}));h.Model}e.prototype={onLabelChange:function(t){this.button.setLabel(t)},onShowLoader:function(){this.button.showLoader()},onHideLoader:function(){this.button.hideLoader()},onMouseOver:function(){var t=this.Controller.getInteracter(this.ID);this.Dom.classList.add("hover"),t.isScriptAvailable()&&this.Dom.classList.add("hasScript")},onMouseLeave:function(){this.Dom.classList.remove("hover"),this.Dom.classList.remove("hasScript")}};var c=[a.Layer,r.Layer,u.Layer];e.prototype=i.implement(e,c),h.Layer=e}(this);
!function(t){function e(){a.UIButton.call(this),this.Dom.classList.add("fifthPane");var t=this,e={valueChanged:function(){var e=t.interacter;e.setLabel(t.Editor.value)}};this.Editor.addListeners(e),this.Editor.customPreventDefault=i,this.disable()}function i(e){var i=t.JSUtil.Key.getKeyCombination(e),n=t.ZSConstants.JSKeyCode;switch(i){case n.ENTER:return!0}}function n(){this.Button=new e}var s=(t.sPlusPlus,t.JSUtil,t.ZSClass),o=s.Layer,a=o.Button,r=t.ZSEvents,c=r.topic,u=r.Groups,l=r.Names,h=document.createElement("div");h.classList.add("ZSOLEBtnMask"),h.addEventListener("click",function(){var t=a.EditLayer.Button.interacter;c.publish(u.Listener,l.UserAction.BUTTONS.SUBMITEDIT,{RID:t.rID,SHEETID:t.sheetID,VERSION:t.version})}),e.prototype={enable:function(t,e){this.interacter=t;var i=t.getAbsoluteX(),n=t.getAbsoluteY(),s=t.getWidth(),o=t.getHeight(),a=t.getLabel();this.place(i,n,s,o),this.setLabel(a),this.show(e),this.Editor.setSelectionRange(a.length,a.length)},disable:function(){this.hide()},getInteracter:function(){return this.interacter},setLabel:function(t){a.UIButton.prototype.setLabel.call(this,t)},place:function(t,e,i,n){a.Layer.prototype.onPlace.call(this,t,e,i,n)},show:function(t){t.appendChild(h),a.UIButton.prototype.appendTo.call(this,t)},hide:function(){h.remove(),this.Dom.remove()}},n.prototype={place:function(t,e){var i=this.Button;i.enable(e,t),this.Active=!0},remove:function(){var t=this.Button;t.disable(),this.Active=!1},isActive:function(){return this.Active},getInteracter:function(){return this.Button.getInteracter()}},a.EditLayer=new n}(this);
!function(e){function o(e,o){i.Router.call(this,e,h,L,o)}var t=e.ZSClass,n=t.Layer||(t.Layer={}),r=n.Interface,a=n.Modules,i=a.Main,u=a.Focus,s=a.Resize,c=(a.Move,n.Button),h=c.Layer,L=c.Model;o.prototype={onLabelChange:function(e,o){var t=this.get(e);t.onLabelChange(o)},onShowLoader:function(e){var o=this.get(e);o.onShowLoader()},onHideLoader:function(e){var o=this.get(e);o.onHideLoader()}};var d=[i.Router,u.Router,s.Router];o.prototype=r.implement(o,d),c.Router=o}(this);
!function(o){function e(){s.ViewControl.call(this)}var i=o.ZSClass,n=i.Layer||(i.Layer={}),t=n.Interface,r=n.Button,a=n.Modules,s=a.Main,l=a.Focus,w=a.Resize,h=a.Move;e.prototype={onLabelChange:function(o,e){for(var i in this.Views){var n=this.Views[i],t=e.getLabel();n.onLabelChange(o,t)}},onShowLoader:function(o){for(var e in this.Views){var i=this.Views[e];i.onShowLoader(o)}},onHideLoader:function(o){for(var e in this.Views){var i=this.Views[e];i.onHideLoader(o)}}};var V=[s.ViewControl,l.ViewControl,w.ViewControl,h.ViewControl];e.prototype=t.implement(e,V),r.ViewControl=e}(this);
!function(t){function o(){a.StateControl.call(this)}var n=t.sPlusPlus,e=t.ZSClass,r=e.Layer||(e.Layer={}),l=r.Interface,s=r.Modules,a=s.Main,u=r.Button;o.prototype={onFocus:function(t){a.StateControl.prototype.onFocus.call(this,t);var o=n.view.Events.Key;o.focusContext(o.Entry.Button.Context)},onBlur:function(t){a.StateControl.prototype.onBlur.call(this,t);var o=n.view.Events.Key;o.focusContext(o.Entry.CellEditor.Context)}};var i=[a.StateControl];o.prototype=l.implement(o,i),u.StateControl=o}(this);
!function(t){function e(){c.NetworkControl.call(this)}var r=t.ZSClass,n=(t.sPlusPlus,r.Layer||(r.Layer={})),o=n.Interface,a=n.Modules,c=a.Main,i=n.Button;e.prototype={onResizeEnd:function(t,e){var r=e.getNetworkInteracter();r.resize()},onMoveEnd:function(t,e){var r=e.getNetworkInteracter();r.move()},onExecuteScript:function(t,e){var r=e.getNetworkInteracter();r.executeScript()},onClone:function(t,e){var r=e.getNetworkInteracter();r.clone()},onAssignMacro:function(t,e,r){var n=e.getNetworkInteracter();n.assignMacro(r)},onSubmitEdit:function(t,e){var r=e.getNetworkInteracter();r.setCaption()},onDelete:function(t,e){var r=e.getNetworkInteracter();r.delete()}};var s=[c.NetworkControl];e.prototype=o.implement(e,s),i.NetworkControl=e}(this);
!function(t){function e(t,e,o,i,n,r){this.gridID=t,this.rID=e,this.sheetID=o,this.version=i,this.sheetPane=n,a.Controller.call(this,u,S,L,r)}var o=t.ZSClass,i=o.Layer||(o.Layer={}),n=i.Interface,r=i.Button,s=i.Modules,a=s.Main,h=s.Focus,c=s.Resize,d=s.Move,l=s.Clone,u=r.StateControl,S=r.NetworkControl,L=r.ViewControl,w=r.Interacter;e.prototype={getInteracter:function(t){var e=new w(this.gridID,this.rID,this.sheetID,this.version,t,this);return e},showLoader:function(t){this.onShowLoader(t)},hideLoader:function(t){this.onHideLoader(t)},setLabel:function(t){var e=this.getInteracter(t);this.onLabelChange(t,e)},assignMacro:function(t,e){var o=this.getInteracter(t);this.onAssignMacro(t,o,e)},placeEdit:function(t){this.blurAll(),this.focus(t);var e=this.getInteracter(t);e.clone(),this.onPlaceEdit(t,e)},submitEdit:function(t){var e=r.EditLayer.getInteracter();this.onSubmitEdit(t,e),this.onLabelChange(t,e),this.onRemoveEdit(t,e)},removeEdit:function(t){var e=this.getInteracter(t);this.onRemoveEdit(t,e),this.onShow(t,e)},executeScript:function(t){var e=this.getInteracter(t);this.onExecuteScript(t,e)},onPlaceEdit:function(t,e){this.onHide(t,e),r.EditLayer.place(this.sheetPane,e)},onRemoveEdit:function(t,e){this.onShow(t,e),r.EditLayer.remove()},onSubmitEdit:function(t,e){this.State.onSubmitEdit(t,e),this.Views.onSubmitEdit(t,e),this.Network.onSubmitEdit(t,e)},onExecuteScript:function(t,e){this.State.onExecuteScript(t,e),this.Views.onExecuteScript(t,e),this.Network.onExecuteScript(t,e)},onLabelChange:function(t,e){this.State.onLabelChange(t,e),this.Views.onLabelChange(t,e),this.Network.onLabelChange(t,e)},onAssignMacro:function(t,e,o){this.State.onAssignMacro(t,e,o),this.Views.onAssignMacro(t,e,o),this.Network.onAssignMacro(t,e,o)},onShowLoader:function(t){this.State.onShowLoader(t),this.Views.onShowLoader(t),this.Network.onShowLoader(t)},onHideLoader:function(t){this.State.onHideLoader(t),this.Views.onHideLoader(t),this.Network.onHideLoader(t)}};var f=[a.Controller,h.Controller,c.Controller,d.Controller,l.Controller];e.prototype=n.implement(e,f),r.Controller=e}(this);
!function(o){function e(o){function e(o){a.focuslayer.call(u,o)}function s(o){var e=u.Dom,s=e.querySelector(".ZSOLEImage");s.classList.add("drgDrpCur"),JSUtil.Mouse.BindEvents.call(u,function(){},function(){s.classList.remove("drgDrpCur")});var t=u.getController();a.focuslayer.call(u,o),d.mousedown.call(u,o),w.publish(f.Listener,L.Mouse.ScrollOut,{GRIDID:t.gridID,CALLBACK:function(o,e,s,t,n){d.update.call(u,t,n)}})}function t(o){a.focuslayer.call(u,o)}var u=this;o.preventDefault(),o.stopPropagation(),g.call(this,o,e,s,t)}var s=o.ZSClass,t=s.Layer||(s.Layer={}),u=t.Image||(t.Image={}),n=t.Modules,m=n.Move,r=n.Resize,l=n.Focus,d=m.Listeners,i=r.Listeners,a=l.Listeners,c=o.ZSEvents,w=c.topic,f=c.Groups,L=c.Names,g=o.JSUtil.Mouse.Register,p={class:"ZSOle",Listeners:{mouseover:a.mouseover,mouseleave:a.mouseleave,mousedown:e},corners:{tl:{mousedown:i.TopLeft.mousedown},tr:{mousedown:i.TopRight.mousedown},bl:{mousedown:i.BottomLeft.mousedown},br:{mousedown:i.BottomRight.mousedown},t:{mousedown:i.Top.mousedown},b:{mousedown:i.Bottom.mousedown},l:{mousedown:i.Left.mousedown},r:{mousedown:i.Right.mousedown}},edges:{top:{mousedown:d.mousedown},bottom:{mousedown:d.mousedown},left:{mousedown:d.mousedown},right:{mousedown:d.mousedown}}};u.Model=p}(this);
!function(t){function e(t,e,i,o,g,h){var r=s.data.getWorkBook(e,o),a=r.getSheetObj(i),n=a.Images,D=n.get(g);this.gridID=t,this.rID=e,this.sheetID=i,this.version=o,this.ID=g,this.image=D,this.Controller=h}function i(t){this.interacter=t}var o=t.ZSClass,s=t.sPlusPlus,g=o.Layer||(o.Layer={}),h=(g.Interface,g.Image||(g.Image={})),r=t.ZSEvents,a=r.topic,n=r.Groups,D=r.Names;e.prototype={getID:function(){return this.ID},isEditable:function(){var t=s.data.getWorkBook(this.rID,this.version);return t.isEditable()&&!t.ProtectedSheets.isSheetLocked(this.sheetID)},getController:function(){return this.Controller},getRow:function(){return this.image.getRow()},getRowDiff:function(){return Math.round(this.image.getRowDiff())},getCol:function(){return this.image.getCol()},getColDiff:function(){return Math.round(this.image.getColDiff())},getX:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getCol(),o=this.image.getColDiff(),g=e.Column.axis.getPos(i)+o,h=s.view.getSheetState(this.gridID,this.sheetID),r=h.getZoom();return g*r},getY:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getRow(),o=this.image.getRowDiff(),g=e.Row.axis.getPos(i)+o,h=s.view.getSheetState(this.gridID,this.sheetID),r=h.getZoom();return g*r},getWidth:function(){var t=s.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.image.getWidth()*e},getHeight:function(){var t=s.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.image.getHeight()*e},getMinimumDimension:function(){var t=s.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return{width:18*e,height:18*e}},getCoordinates:function(t){var e=sPlusPlus.view.getGridComponent(this.gridID),i=e.getRelativeCoordinates(t),o=s.view.getSheetState(this.gridID,this.sheetID),g=o.getZoom();return{x:i.x*g,y:Math.round(i.y*g)}},getLeftStickyX:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getCol(),o=this.image.getColDiff(),g=e.Column.axis.getPos(i)+o,t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Column.axis.findAbs(g-1),h=e.Column.axis.getPos(i),r=s.view.getSheetState(this.gridID,this.sheetID),a=r.getZoom();return h*a},getNextLeftStickyX:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getCol(),o=this.image.getColDiff(),g=e.Column.axis.getPos(i)+o,t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Column.axis.findAbs(g),h=e.Column.axis.getPos(i+1),r=s.view.getSheetState(this.gridID,this.sheetID),a=r.getZoom();return h*a},getRightStickyX:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getCol(),o=this.image.getColDiff(),g=e.Column.axis.getPos(i)+o,h=this.image.getWidth(),t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Column.axis.findAbs(g+h+1),r=e.Column.axis.getPos(i+1)-h,a=s.view.getSheetState(this.gridID,this.sheetID),n=a.getZoom();return r*n},getNextRightStickyX:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getCol(),o=this.image.getColDiff(),g=e.Column.axis.getPos(i)+o,h=this.image.getWidth(),t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Column.axis.findAbs(g+h-1),r=e.Column.axis.getPos(i)-h,a=s.view.getSheetState(this.gridID,this.sheetID),n=a.getZoom();return r*n},getTopStickyY:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getRow(),o=this.image.getRowDiff(),g=e.Row.axis.getPos(i)+o,t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Row.auxiliaryAxis.findAbs(g-1),h=e.Row.auxiliaryAxis.getPos(i),r=s.view.getSheetState(this.gridID,this.sheetID),a=r.getZoom();return h*a},getNextTopStickyY:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getRow(),o=this.image.getRowDiff(),g=e.Row.axis.getPos(i)+o,t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Row.auxiliaryAxis.findAbs(g),h=e.Row.auxiliaryAxis.getPos(i+1),r=s.view.getSheetState(this.gridID,this.sheetID),a=r.getZoom();return h*a},getBottomStickyY:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getRow(),o=this.image.getRowDiff(),g=e.Row.axis.getPos(i)+o,h=this.image.getHeight(),t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Row.auxiliaryAxis.findAbs(g+h+1),r=e.Row.auxiliaryAxis.getPos(i+1)-h,a=s.view.getSheetState(this.gridID,this.sheetID),n=a.getZoom();return r*n},getNextBottomStickyY:function(){var t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=this.image.getRow(),o=this.image.getRowDiff(),g=e.Row.axis.getPos(i)+o,h=this.image.getHeight(),t=s.data.getWorkBook(this.rID,this.version),e=t.getSheetObj(this.sheetID),i=e.Row.auxiliaryAxis.findAbs(g+h-1),r=e.Row.auxiliaryAxis.getPos(i)-h,a=s.view.getSheetState(this.gridID,this.sheetID),n=a.getZoom();return r*n},setPosition:function(t,e){var i=s.view.getSheetState(this.gridID,this.sheetID),o=i.getZoom();t/=o,e/=o;var g=s.data.getWorkBook(this.rID,this.version),h=g.getSheetObj(this.sheetID),r=(this.image.getRow(),this.image.getRowDiff(),this.image.getCol(),this.image.getColDiff(),h.Row.axis.find(e));this.image.setRow(r.idx),this.image.setRowDiff(r.rsdue);var a=h.Column.axis.find(t);this.image.setCol(a.idx),this.image.setColDiff(a.rsdue)},setDimension:function(t,e){var i=s.view.getSheetState(this.gridID,this.sheetID),o=i.getZoom();t/=o,e/=o,this.image.setWidth(t),this.image.setHeight(e)},clone:function(){this.image=this.image.clone()},getURL:function(){return this.image.getURL()},getNetworkInteracter:function(){var t=new i(this);return t},scrollIntoView:function(){var t=new i(this);t.scrollIntoView()}},i.prototype={delete:function(){var e=this.interacter,i=e.rID,o=e.sheetID,g=e.version,h=s.data.getWorkBook(i,g),r=h.getSheetObj(o),a=s.view.getActiveGridID(),n=s.view.getSelectedSheets(a),D=r.Prop.Name,I="IMAGE_REMOVE",f=[],u={imgId:e.getID()};f.push(u),t.UserAction.ImageAction(i,n,g,D,I,f)},move:function(){var e=this.interacter,i=e.rID,o=e.sheetID,g=e.version,h=s.data.getWorkBook(i,g),r=h.getSheetObj(o),a=s.view.getActiveGridID(),n=s.view.getSelectedSheets(a),D=r.Prop.Name,I="IMAGE_MOVE",f=e.image,u=[],m={imgId:e.getID(),row:f.getRow(),column:f.getCol(),sRowDiff:Math.round(f.getRowDiff()),sColDiff:Math.round(f.getColDiff())};u.push(m),t.UserAction.ImageAction(i,n,g,D,I,u)},resize:function(){var e=this.interacter,i=e.rID,o=e.sheetID,g=e.version,h=s.data.getWorkBook(i,g),r=h.getSheetObj(o),a=s.view.getActiveGridID(),n=s.view.getSelectedSheets(a),D=r.Prop.Name,I="IMAGE_RESIZE",f=e.image,u=[],m={imgId:e.getID(),row:f.getRow(),column:f.getCol(),sRowDiff:Math.round(f.getRowDiff()),sColDiff:Math.round(f.getColDiff()),imgWd:Math.round(f.getWidth()),imgHt:Math.round(f.getHeight())};u.push(m),t.UserAction.ImageAction(i,n,g,D,I,u)},clone:function(){var e=this.interacter,i=e.rID,o=e.sheetID,g=e.version,h=s.data.getWorkBook(i,g),r=h.getSheetObj(o),a=s.view.getActiveGridID(),n=s.view.getSelectedSheets(a),D=r.Prop.Name,I="IMAGE_CLONE",f=e.image,u=[],m={imgsid:e.getID(),row:f.getRow(),column:f.getCol(),sRowDiff:Math.round(f.getRowDiff()),sColDiff:Math.round(f.getColDiff())};u.push(m),t.UserAction.ImageAction(i,n,g,D,I,u)},replace:function(){a.publish(n.UI,D.Toolbar.IMAGE.CLICK,{ID:this.interacter.getID()})},scrollIntoView:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,s=t.getX(),g=t.getY(),h=t.getWidth(),r=t.getHeight();UserAction.ScrollAreaIntoView(e,i,o,s,g,h,r)}},h.Interacter=e}(this);
!function(t){function e(t,e,i,a){r.Layer.call(this,t,e,i,a,function(){this.Dom.setAttribute("context","MI_IMAGE_CONTEXT"),this.Dom.addEventListener("dblclick",function(t){t.stopPropagation()}),this.Dom.addEventListener("contextmenu",function(t){n.doRightClick(t,"MI_IMAGE_CONTEXT",this)});var e=document.createElement("div");e.className="ZSOleMenu",e.setAttribute("data-menu-id","MI_IMAGE_CONTEXT"),this.image=new c.UIImage(t,this.Dom),this.image.Dom.appendChild(e),this.image.appendTo(this.Dom)})}{var i=t.ZSClass,a=(t.sPlusPlus,i.Layer||(i.Layer={})),n=i.ContextMenu,o=a.Interface,s=a.Modules,r=s.Main,u=s.Focus,m=s.Resize,c=(s.Move,a.Image||(a.Image={}));c.Model}e.prototype={onURLChange:function(t){this.image.setImageSrc(t)},getNaturalHeight:function(){return this.image.getNaturalHeight()},getNaturalWidth:function(){return this.image.getNaturalWidth()}};var h=[r.Layer,u.Layer,m.Layer];e.prototype=o.implement(e,h),c.Layer=e}(this);
!function(t){function e(t,e){u.Router.call(this,t,h,l,e)}var r=t.ZSClass,a=r.Layer||(r.Layer={}),o=a.Interface,n=a.Modules,u=n.Main,i=n.Focus,g=n.Resize,s=(n.Move,a.Image),h=s.Layer,l=s.Model;e.prototype={onURLChange:function(t,e){var r=this.get(t);r.onURLChange(e)},getNaturalHeight:function(t){var e=this.get(t);return e.getNaturalHeight()},getNaturalWidth:function(t){var e=this.get(t);return e.getNaturalWidth()}};var c=[u.Router,i.Router,g.Router];e.prototype=o.implement(e,c),s.Router=e}(this);
!function(e){function i(){s.ViewControl.call(this)}var t=e.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,r=o.Image,a=o.Modules,s=a.Main,l=a.Focus,h=a.Resize,g=a.Move;i.prototype={onURLChange:function(e,i){for(var t in this.Views){var o=this.Views[t],n=i.getURL();o.onURLChange(e,n)}},onResizeToOriginal:function(e,i){for(var t in this.Views){var o=this.Views[t];i.image.setHeight(o.getNaturalHeight(e)),i.image.setWidth(o.getNaturalWidth(e))}}};var w=[s.ViewControl,l.ViewControl,h.ViewControl,g.ViewControl];i.prototype=n.implement(i,w),r.ViewControl=i}(this);
!function(t){function o(){s.StateControl.call(this)}var e=t.sPlusPlus,n=t.ZSClass,r=n.Layer||(n.Layer={}),l=r.Interface,a=r.Modules,s=a.Main,i=r.Image;o.prototype={onFocus:function(t){s.StateControl.prototype.onFocus.call(this,t);var o=e.view.Events.Key;o.focusContext(o.Entry.Ole.Context)},onBlur:function(t){s.StateControl.prototype.onBlur.call(this,t);var o=e.view.Events.Key;o.focusContext(o.Entry.CellEditor.Context)}};var u=[s.StateControl];o.prototype=l.implement(o,u),i.StateControl=o}(this);
!function(e){function t(){c.NetworkControl.call(this)}var r=e.ZSClass,n=(e.sPlusPlus,r.Layer||(r.Layer={})),o=n.Interface,a=n.Modules,c=a.Main,i=n.Image;t.prototype={onDelete:function(e,t){var r=t.getNetworkInteracter();r.delete()},onMoveEnd:function(e,t){var r=t.getNetworkInteracter();r.move()},onResizeEnd:function(e,t){var r=t.getNetworkInteracter();r.resize()},onClone:function(e,t){var r=t.getNetworkInteracter();r.clone()},onResizeToOriginal:function(e,t){var r=t.getNetworkInteracter();r.resize()},onReplaceImage:function(e,t){var r=t.getNetworkInteracter();r.replace()}};var l=[c.NetworkControl];t.prototype=o.implement(t,l),i.NetworkControl=t}(this);
!function(e){function t(e,t,i,n,o,r){this.gridID=e,this.rID=t,this.sheetID=i,this.version=n,this.sheetPane=o,a.Controller.call(this,I,C,R,r)}var i=e.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Image,s=n.Modules,a=s.Main,h=s.Focus,l=s.Resize,g=s.Move,c=s.Clone,I=r.StateControl,C=r.NetworkControl,R=r.ViewControl,u=r.Interacter;t.prototype={getInteracter:function(e){var t=new u(this.gridID,this.rID,this.sheetID,this.version,e,this);return t},setImageSrc:function(e){var t=this.getInteracter(e);this.onURLChange(e,t)},onURLChange:function(e,t){this.State.onURLChange(e,t),this.Views.onURLChange(e,t),this.Network.onURLChange(e,t)},replaceImage:function(e){var t=this.getInteracter(e);this.State.onReplaceImage(e,t),this.Views.onReplaceImage(e,t),this.Network.onReplaceImage(e,t)},resizeToOriginal:function(e){var t=this.getInteracter(e);this.onResizeToOriginal(e,t)},onResizeToOriginal:function(e,t){this.State.onResizeToOriginal(e,t),this.Views.onResizeToOriginal(e,t),this.Network.onResizeToOriginal(e,t)}};var f=[a.Controller,h.Controller,l.Controller,g.Controller,c.Controller];t.prototype=o.implement(t,f),r.Controller=t}(this);
!function(t){function e(t,e,i,r,s,h){var n=o.data.getWorkBook(e,r),a=n.getSheetObj(i),g=a.Charts,c=g.get(s);this.gridID=t,this.rID=e,this.sheetID=i,this.version=r,this.ID=s,this.chart=c,this.Controller=h}function i(t){this.interacter=t}{var r=t.ZSClass,s=t.ZSChart,o=t.sPlusPlus,h=r.Layer||(r.Layer={}),n=(h.Interface,h.Chart||(h.Chart={})),a=(n.Interacter,t.ZSEvents);a.topic,a.Groups,a.Names}e.prototype={getID:function(){return this.ID},getPivotID:function(){return this.chart.getPivotId()},getLegendPosition:function(){return this.chart.getLegendPosition()},isEditable:function(){var t=o.data.getWorkBook(this.rID,this.version);return t.isEditable()&&!t.ProtectedSheets.isSheetLocked(this.sheetID)},isReadOnlyChart:function(){return!1},getInstanceByViewIndex:function(t){return this.chart.getInstance()[t]},getNetworkInteracter:function(){var t=new i(this);return t},getController:function(){return this.Controller},scrollIntoView:function(){var t=new i(this);t.scrollIntoView()},getX:function(){var t=o.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.chart.getComputedLeft(this.chart.getStartColIndex())*e},getY:function(){var t=o.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.chart.getComputedTop(this.chart.getStartRowIndex())*e},getWidth:function(){var t=o.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.chart.getWidth()*e},getHeight:function(){var t=o.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return this.chart.getHeight()*e},getMinimumDimension:function(){var t=o.view.getSheetState(this.gridID,this.sheetID),e=t.getZoom();return{width:120*e,height:100*e}},getCoordinates:function(t){var e=sPlusPlus.view.getGridComponent(this.gridID),i=e.getRelativeCoordinates(t),r=o.view.getSheetState(this.gridID,this.sheetID),s=r.getZoom();return{x:i.x*s,y:Math.round(i.y*s)}},getLeftStickyX:function(){var t=this.chart.getLeft(),e=o.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),r=i.Column.axis.findAbs(t-1),s=i.Column.axis.getPos(r),h=o.view.getSheetState(this.gridID,this.sheetID),n=h.getZoom();return s*n},getNextLeftStickyX:function(){var t=this.chart.getLeft(),e=o.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),r=i.Column.axis.findAbs(t),s=i.Column.axis.getPos(r+1),h=o.view.getSheetState(this.gridID,this.sheetID),n=h.getZoom();return s*n},getRightStickyX:function(){var t=this.chart.getLeft(),e=this.chart.getWidth(),i=o.data.getWorkBook(this.rID,this.version),r=i.getSheetObj(this.sheetID),s=r.Column.axis.findAbs(t+e+1),h=r.Column.axis.getPos(s+1)-e,n=o.view.getSheetState(this.gridID,this.sheetID),a=n.getZoom();return h*a},getNextRightStickyX:function(){var t=this.chart.getLeft(),e=this.chart.getWidth(),i=o.data.getWorkBook(this.rID,this.version),r=i.getSheetObj(this.sheetID),s=r.Column.axis.findAbs(t+e-1),h=r.Column.axis.getPos(s)-e,n=o.view.getSheetState(this.gridID,this.sheetID),a=n.getZoom();return h*a},getTopStickyY:function(){var t=this.chart.getTop(),e=o.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),r=i.Row.auxiliaryAxis.findAbs(t-1),s=i.Row.auxiliaryAxis.getPos(r),h=o.view.getSheetState(this.gridID,this.sheetID),n=h.getZoom();return s*n},getNextTopStickyY:function(){var t=this.chart.getTop(),e=o.data.getWorkBook(this.rID,this.version),i=e.getSheetObj(this.sheetID),r=i.Row.auxiliaryAxis.findAbs(t),s=i.Row.auxiliaryAxis.getPos(r+1),h=o.view.getSheetState(this.gridID,this.sheetID),n=h.getZoom();return s*n},getBottomStickyY:function(){var t=this.chart.getTop(),e=this.chart.getHeight(),i=o.data.getWorkBook(this.rID,this.version),r=i.getSheetObj(this.sheetID),s=r.Row.auxiliaryAxis.findAbs(t+e+1),h=r.Row.auxiliaryAxis.getPos(s+1)-e,n=o.view.getSheetState(this.gridID,this.sheetID),a=n.getZoom();return h*a},getNextBottomStickyY:function(){var t=this.chart.getTop(),e=this.chart.getHeight(),i=o.data.getWorkBook(this.rID,this.version),r=i.getSheetObj(this.sheetID),s=r.Row.auxiliaryAxis.findAbs(t+e-1),h=r.Row.auxiliaryAxis.getPos(s)-e,n=o.view.getSheetState(this.gridID,this.sheetID),a=n.getZoom();return h*a},getRID:function(){return this.rID},getSheetID:function(){return this.sheetID},getVersion:function(){return this.version},setPosition:function(t,e){var i=o.view.getSheetState(this.gridID,this.sheetID),r=i.getZoom();this.chart.setPosition(t/r,e/r),s.Client.Action.destroyContextualToolbar(1)},setDimension:function(t,e){var i=o.view.getSheetState(this.gridID,this.sheetID),r=i.getZoom();this.chart.setDimension(t/r,e/r),s.Client.Action.destroyContextualToolbar()},isPivotChart:function(){return this.chart.getPivotState()}},i.prototype={resize:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.ID,h=t.chart;s.Action.resetSize(e,i,r,o,h.getLeft(),h.getTop(),h.getStartRowIndex(),h.getStartColIndex(),h.getStartRowDiff(),h.getStartColDiff(),h.getWidth(),h.getHeight())},move:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.ID,h=t.chart;s.Server.Action.repositionChart(e,i,r,o,h.getLeft(),h.getTop(),h.getStartRowIndex(),h.getStartColIndex(),h.getStartRowDiff(),h.getStartColDiff())},delete:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.ID;s.Server.Action.deleteChart(e,i,r,o)},scrollIntoView:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,s=t.getX(),o=t.getY(),h=t.getWidth(),n=t.getHeight();UserAction.ScrollAreaIntoView(e,i,r,s,o,h,n)}},n.Interacter=e}(this);
!function(t){function e(t,e,o,r){i.Layer.call(this,t,e,o,r,function(){this.Dom.setAttribute("context","MI_CHART_CONTEXT"),this.Dom.classList.add("ZSChartLayer"),this.chart=new h.UIChartLayer(t),this.chart.appendTo(this.Dom),this.Dom.addEventListener("dblclick",function(t){var e=this.chart.getMode(),o=ZSChart.Manager.SidePanelManager;o&&!o.isPanelOpen()&&e.edit?C.publish(u.UI,d.SidePanel.CHARTS.OPEN,{CHART_ID:this.chart.getID(),RECOMMENDATION:o.RECOMMENDATION,TABEL_DEFINATION:!0}):e.edit||a.ZSAlert(p["Chart.Edit.NotAllowed"],{title:p["Alert.Title.YetToSupport"]}),t.stopPropagation(),t.preventDefault()}.bind(this))})}var a=t.ZSClass,o=(t.sPlusPlus,a.Layer||(a.Layer={})),r=o.Interface,s=o.Modules,i=s.Main,n=s.Focus,l=s.Resize,h=(s.Move,o.Chart||(o.Chart={})),c=(h.Model,t.ZSEvents),u=c.Groups,d=c.Names,C=c.topic,p=(t.window,t.ZSConstants.I18N),y="rgb(221, 221, 221)";e.prototype={onFocus:function(){this.Dom.classList.add("focus"),this.chart.onFocus()},onBlur:function(){this.Dom.classList.remove("focus"),this.chart.onBlur(),this.setOutlineColor()},setOutlineColor:function(){try{var t=new ZSChart.Utility.ChartAgent,e=t.getChartMeta(this.chart.getID()),a=e.getBackgroundColor(),o=new ZSChart.Model.ChartModel,r=o.getTransparency(a);r=parseFloat(parseFloat((100-r)/100).toFixed(2));var s=o.getRGBA(y,r);this.Dom.style.outlineColor=s}catch(t){}}};var M=[i.Layer,n.Layer,l.Layer];e.prototype=r.implement(e,M),h.Layer=e}(this);
!function(o){function e(o){function e(o){i.focuslayer.call(n,o)}function s(o){l.classList.add("drgDrpCur");{var e=n.getController(),s=n.getID();e.getInteracter(s)}i.focuslayer.call(n,o),m.mousedown.call(n,o),w.publish(f.Listener,L.Mouse.ScrollOut,{GRIDID:e.gridID,CALLBACK:function(o,e,s,t,u){m.update.call(n,t,u)}})}function t(o){l.classList.remove("drgDrpCur"),i.focuslayer.call(n,o)}function u(o){i.focuslayer.call(n,o)}var n=this;o.preventDefault(),o.stopPropagation();var r=n.Dom,l=r.querySelector(".ZSOLEChart");l.classList.add("drgDrpCur"),g.call(this,o,e,s,t,u)}var s=o.ZSClass,t=s.Layer||(s.Layer={}),u=t.Chart||(t.Chart={}),n=t.Modules,r=n.Move,l=n.Resize,d=n.Focus,m=r.Listeners,a=l.Listeners,i=d.Listeners,c=o.ZSEvents,w=c.topic,f=c.Groups,L=c.Names,g=o.JSUtil.Mouse.Register,p={class:"ZSOle",Listeners:{mouseover:i.mouseover,mouseleave:i.mouseleave,mousedown:e},corners:{tl:{mousedown:a.TopLeft.mousedown},tr:{mousedown:a.TopRight.mousedown},bl:{mousedown:a.BottomLeft.mousedown},br:{mousedown:a.BottomRight.mousedown},t:{mousedown:a.Top.mousedown},b:{mousedown:a.Bottom.mousedown},l:{mousedown:a.Left.mousedown},r:{mousedown:a.Right.mousedown}},edges:{top:{mousedown:m.mousedown},bottom:{mousedown:m.mousedown},left:{mousedown:m.mousedown},right:{mousedown:m.mousedown}}};u.Model=p}(this);
!function(e){function t(){i.NetworkControl.call(this)}var r=e.ZSClass,o=(e.sPlusPlus,r.Layer||(r.Layer={})),n=o.Interface,a=o.Modules,i=a.Main,l=o.Chart;t.prototype={onResizeEnd:function(e,t){var r=t.getNetworkInteracter();r.resize()},onMoveEnd:function(e,t){var r=t.getNetworkInteracter();r.move()},onDelete:function(e,t){var r=t.getNetworkInteracter();r.delete()}};var s=[i.NetworkControl];t.prototype=n.implement(t,s),l.NetworkControl=t}(this);
!function(t){function e(t,e){l.Router.call(this,t,v,d,e),this.Alive=!1,this.boundary={}}function i(t,e){try{t.co.plotOptions.series.animation=e}catch(t){}return t}function n(t,e){{var i=this.Controller,n=i.getInteracter(e);t.chart.getMode()}t.chart.setMode(n.isReadOnlyChart()?!0:!1)}var r=t.ZSClass,o=t.sPlusPlus,a=t.ZSChart,h=r.Layer||(r.Layer={}),c=h.Interface,s=h.Modules,l=s.Main,g=s.Focus,u=s.Resize,p=(s.Move,h.Chart),v=p.Layer,d=p.Model,y=t.ZSEvents,C=y.Groups,A=y.Names,I=y.topic,a=a;e.prototype.updateBoundaryProps=function(t){var e=t.bound;this.boundary=e,this.Alive=e.startRow!=e.endRow&&e.startCol!=e.endCol},e.prototype.updateBoundary=function(t,e,i){try{var n=new a.Utility.ChartAgent,r=n.getAllMetaOfSheet(t,e,i);I.publish(Groups.Listener,A.SheetMeta.CHARTS,{RID:t,SHEETID:e,VERSION:i,CHARTS:r})}catch(t){}},e.prototype.onZoom=function(t,e){var i=e.chart,n=e.getWidth(),r=e.getHeight(),h=o.view.getActiveGridID(),c=o.view.getSheetID(h),s=o.view.getSheetState(h,c),l=s.getZoom();a.Utility.setSize.fn.call(this,i.getInstance(),r/l,n/l)},e.prototype.onRender=function(t,e){var i=this.getLayerByID(t),n=i.chart.getDOM(),r=e.chart,o=r.cloneOf(r.getOptions(),!0),h=r.cloneOf(r.getDetails(),!0),c=r.isActionOwner(),s=e.getRID(),l=e.getSheetID(),g=e.getVersion(),u=[];h.co=o,h=a.Client.Action.addSynchronization(t,h),h.wd=e.getWidth(),h.ht=e.getHeight(),u.push(h),o.chart.renderTo=n,a.Client.Action.insertChart(s,l,g,u);var p=a.Manager.SidePanelManager;r.isInsertFromZiaPanel()||p.isPanelOpen()||(i.chart.setPanelStatus(!0),c&&I.publish(C.UI,A.SidePanel.CHARTS.OPEN,{CHART_ID:i.chart.getID(),RECOMMENDATION:p.RECOMMENDATION,TABEL_DEFINATION:!0}),a.Client.Action.OverrideHighchartEvents(i.chart.getID())),e.isPivotChart()&&this.onAttachFilter(t,e)},e.prototype.onAttachFilter=function(t,e){try{var i=this.getLayerByID(t),n=e.getRID(),o=e.getVersion(),a=e.getPivotID(),h=r.Pivot.Util.getPivotChartFilterDetails(n,o,a);i.chart.clearFilter(),i.chart.onAttachFilter(h,e)}catch(t){}},e.prototype.onCachedViewAttach=function(t,e,i){var n=this.get(t);if(this.Alive){var r=n.chart.getDOM(),o=e.getInstanceByViewIndex(i);o&&o.container?(r.innerHTML="",r.appendChild(o.container),e.isPivotChart()&&this.onAttachFilter(t,e)):this.onRefresh(t,e)}else n&&n.onRemove()},e.prototype.getLayerByID=function(t){return this.Active[t]},e.prototype.onFocus=function(t){var e=this.get(t);return e.onFocus(),!0},e.prototype.setPanelStatus=function(t,e){var i=this.get(t);i.chart.setPanelStatus(e)},e.prototype.onRefresh=function(t,e){var n=this.getLayerByID(t),r=n.chart.getDOM(),o=e.chart,h=o.cloneOf(o.getOptions(),!0),c=o.cloneOf(o.getDetails(),!0),s=e.getRID(),l=e.getSheetID(),g=e.getVersion(),u=[];c.co=h,c=a.Client.Action.addSynchronization(t,c),c.wd=e.getWidth(),c.ht=e.getHeight(),i.call(this,c,!1),u.push(c),h.chart.renderTo=r,a.Client.Action.insertChart(s,l,g,u,!0),a.Client.Action.OverrideHighchartEvents(n.chart.getID()),e.isPivotChart()&&this.onAttachFilter(t,e)},e.prototype.onLoad=function(t,e){var i=this.getLayerByID(t),n=i.chart.getDOM(),r=e.chart,o=r.cloneOf(r.getOptions(),!0),h=r.cloneOf(r.getDetails(),!0),c=e.getRID(),s=e.getSheetID(),l=e.getVersion(),g=[];h.co=o,h=a.Client.Action.addSynchronization(t,h),h.wd=e.getWidth(),h.ht=e.getHeight(),g.push(h),o.chart.renderTo=n,a.Client.Action.insertChart(c,s,l,g,a.Client.Action.getChartState(r.getID())),a.Client.Action.setChartState(r.getID()),a.Client.Action.OverrideHighchartEvents(i.chart.getID()),e.isPivotChart()&&this.onAttachFilter(t,e)},e.prototype.onPlace=function(t,e,i,r,o){var a=this.get(t);this.Alive&&a.onPlace(e,i,r,o),this.Alive&&a.setOutlineColor(),n.call(this,a,t)},e.prototype.onBlur=function(t){var e=this.get(t);e.onBlur()};var D=[l.Router,g.Router,u.Router];e.prototype=c.implement(e,D),p.Router=e}(this);
!function(t){function o(){s.StateControl.call(this)}var e=t.sPlusPlus,n=t.ZSClass,r=n.Layer||(n.Layer={}),l=r.Interface,a=r.Modules,s=a.Main,i=r.Chart;o.prototype={onFocus:function(t){s.StateControl.prototype.onFocus.call(this,t);var o=e.view.Events.Key;o.focusContext(o.Entry.Ole.Context)},onBlur:function(t){s.StateControl.prototype.onBlur.call(this,t);var o=e.view.Events.Key;o.focusContext(o.Entry.CellEditor.Context)}};var u=[s.StateControl];o.prototype=l.implement(o,u),i.StateControl=o}(this);
!function(t){function e(){a.ViewControl.call(this)}var o=t.ZSClass,i=o.Layer||(o.Layer={}),n=i.Interface,r=i.Chart,s=i.Modules,a=s.Main,h=s.Focus,l=s.Resize,p=s.Move,c=t.ZSEvents,v=c.Groups,w=c.Names,V=c.topic,f=t.ZSChart;e.prototype.onZoom=function(t,e){for(var o in this.Views){var i=this.Views[o];i.Alive&&i.onZoom(t,e)}},e.prototype.onRender=function(t,e){for(var o in this.Views){var i=this.Views[o];i.Alive&&i.onRender(t,e)}},e.prototype.onCachedViewAttach=function(t,e){for(var o in this.Views){var i=this.Views[o];i.onCachedViewAttach(t,e,o)}},e.prototype.onRefresh=function(t,e){for(var o in this.Views){var i=this.Views[o];i.Alive&&i.onRefresh(t,e)}},e.prototype.onLoad=function(t,e){for(var o in this.Views){var i=this.Views[o];i.Alive&&i.onLoad(t,e)}},e.prototype.updateBoundary=function(t,e,o){try{var i=new f.Utility.ChartAgent,n=i.getAllChartID(t,e,o);n.length>=1&&V.publish(v.Listener,w.SheetAction.CHARTS.UPDTATE_BOUNDARY,{RID:t,SHEETID:e,VERSION:o,CHARTS:n})}catch(t){}},e.prototype.onUpdatePanelStatus=function(t,e){for(var o in this.Views){var i=this.Views[o];i.setPanelStatus(t,e)}};var u=[a.ViewControl,h.ViewControl,l.ViewControl,p.ViewControl];e.prototype=n.implement(e,u),r.ViewControl=e}(this);
!function(t){function e(t){this.element=o.Wrapper.DOMUtils.createElement("div",{id:t}),this.element.classList.add("ZSOLEChart"),this.elementMenu=document.createElement("div"),this.elementMenu.classList.add("ZsOLEChartMenu"),this.elementMenu.setAttribute("data-menu-id","MI_CHART_CONTEXT"),this.container=o.Wrapper.DOMUtils.createElement("div"),this.container.appendChild(this.element),this.container.appendChild(this.elementMenu),this.filterMenu=document.createElement("div"),this.filterMenu.classList.add("fltChrtMenu"),this.container.appendChild(this.filterMenu),this.mode={view:!0,edit:!1},this.ID=t}function i(){g||(this.setPanelStatus(!1),F.publish(d.UI,u.SidePanel.CHARTS.CLOSE),F.publish(d.UI,u.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:E}),E=null)}function r(){if(v&&E!=this.ID){o.Client.Action.removeBorderAnimation({ID:E}),o.Client.Action.resetChartSelection({ID:E}),F.publish(d.UI,u.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:E}),E=this.ID;{o.Manager.SidePanelManager}F.publish(d.UI,u.SidePanel.CHARTS.OPEN,{CHART_ID:this.getID(),RECOMMENDATION:!0,TABEL_DEFINATION:!0})}}function a(t){var e=t.getBoundingClientRect();return{top:e.top-l.view.measures.gridTop,left:e.left-l.view.measures.gridLeft,width:e.width,height:e.height}}var l=t.sPlusPlus,n=t.ZSClass,o=t.ZSChart,s=n.Layer||(n.Layer={}),p=s.Chart||(s.Chart={}),h=(t.ZSConstants.I18N,t.ZSDevTools.Logger),c=(o.Constants,t.ZSEvents),d=c.Groups,u=c.Names,F=c.topic,C=null,g=!1,v=!1,E=null,f={ROW_FILTER:"rf",COL_FILTER:"cf",PAGE_FILTER:"pf"};e.prototype.appendRowFilterWrapper=function(t){this.rowFilter=o.Wrapper.DOMUtils.createElement("div",{id:this.getID()+"_"+f.ROW_FILTER}),this.rowFilter.classList.add("rfWrapper"),t&&t.appendChild(this.rowFilter)},e.prototype.appendColumnFilterWrapper=function(t){this.colFilter=o.Wrapper.DOMUtils.createElement("div",{id:this.getID()+"_"+f.COL_FILTER}),this.colFilter.classList.add("cfWrapper"),this.colFilter.style.maxWidth="76px",t&&t.appendChild(this.colFilter)},e.prototype.appendPageFilterWrapper=function(t){this.pageFilter=o.Wrapper.DOMUtils.createElement("div",{id:this.getID()+"_"+f.PAGE_FILTER}),this.pageFilter.classList.add("pgWrapper"),t&&t.appendChild(this.pageFilter)},e.prototype.getRowFilterDOM=function(){return!this.rowFilter&&this.appendRowFilterWrapper(this.getFilterContainer()),this.rowFilter},e.prototype.getColumnFilterDOM=function(t){return!this.colFilter&&this.appendColumnFilterWrapper(this.getFilterContainer(),t),this.colFilter},e.prototype.getPageFilterDOM=function(){return!this.pageFilter&&this.appendPageFilterWrapper(this.getFilterContainer()),this.pageFilter},e.prototype.removePageFilter=function(){this.pageFilter&&this.pageFilter.remove(),this.pageFilter=null},e.prototype.removeRowFilter=function(){this.rowFilter&&this.rowFilter.remove(),this.rowFilter=null},e.prototype.removeColumnFilter=function(){this.colFilter&&this.colFilter.remove(),this.colFilter=null},e.prototype.setPanelStatus=function(t){v=t,E=this.ID},e.prototype.onFocus=function(){var t=this.getMode();if(!t.view){g=!0,F.publish(d.UI,u.SidePanel.CHARTS.OPEN_ICON),C&&clearTimeout(C);var e=o.Utility.getActiveChart();F.publish(d.Listener,u.UserAction.CHARTS.RESET_MENU,{ACTIVE_CHART_ID:e}),1==e.length&&r.call(this),this.hasFilter&&this.hideFilter()}},e.prototype.onBlur=function(){g=!1,C=setTimeout(i.bind(this),100),this.hasFilter&&this.hideFilter()},e.prototype.showFilter=function(){o.Wrapper.DOMUtils.show(this.filterMenu)},e.prototype.hideFilter=function(){o.Wrapper.DOMUtils.hide(this.filterMenu)},e.prototype.getDOM=function(){return this.element},e.prototype.getID=function(){return this.ID},e.prototype.getMode=function(){return this.mode},e.prototype.setMode=function(t){this.mode.view=t,this.mode.edit=!t},e.prototype.isReadOnly=function(){return this.mode.view},e.prototype.getContainer=function(){return this.container},e.prototype.getFilterContainer=function(){return this.filterMenu},e.prototype.appendTo=function(t){t.appendChild(this.container)},e.prototype.remove=function(){this.container.remove(),this.hasFilter=!1},e.prototype.clearFilter=function(){this.removeRowFilter(),this.removeColumnFilter(),this.removePageFilter()},e.prototype.onAttachFilter=function(t,e){try{this.hasFilter=!0;var i=this;t&&Object.keys(t).forEach(function(r){switch(r){case f.ROW_FILTER:i.attachRowFilter(t[f.ROW_FILTER],e);break;case f.COL_FILTER:i.attachColumnFilter(t[f.COL_FILTER],e);break;case f.PAGE_FILTER:i.attachPageFilter(t[f.PAGE_FILTER],e)}})}catch(t){h.log("[Chart] Error while attaching filer",t)}},e.prototype.getFilterWrapper=function(t,e){var i=null;switch(t){case f.ROW_FILTER:i=this.getRowFilterDOM();break;case f.COL_FILTER:i=this.getColumnFilterDOM(e);break;case f.PAGE_FILTER:i=this.getPageFilterDOM()}return h.log("[Chart] >>>>>>>> Getting Filter Wrapper"),i},e.prototype.attachRowFilter=function(t,e){var i=this.getFilterWrapper(f.ROW_FILTER,e);t.forEach(function(t){var e=o.Wrapper.DOMUtils.createElement("img");e.src=l.data.AppRegistry.IMAGEPath+"../../images/"+t.pic+".svg";var r=o.Wrapper.DOMUtils.createElement("div");r.classList.add("pvtChrtDlg"),r.classList.add("pvtChrtFlt"),r.setAttribute("data-pivot",t.content),o.Wrapper.DOMUtils.addEventByNode(r,o.Wrapper.DOMUtils.Events.CLICK,function(){var e=t.callback||n.Pivot.Util.openPivotChartFilterDialog;e&&e.call(this,t,a(this)),!e&&h.log("[CHART] >>>>>>>> No callback Added")}),o.Wrapper.DOMUtils.appendChild(i,r),o.Wrapper.DOMUtils.appendChild(r,e)})},e.prototype.attachColumnFilter=function(t,e){this.colFilterLength=t.length;var i=this.getFilterWrapper(f.COL_FILTER,e);t.forEach(function(t){var e=o.Wrapper.DOMUtils.createElement("img");e.src=l.data.AppRegistry.IMAGEPath+"../../images/"+t.pic+".svg";var r=o.Wrapper.DOMUtils.createElement("div");r.classList.add("pvtChrtDlg"),r.classList.add("pvtChrtFlt"),r.setAttribute("data-pivot",t.content),o.Wrapper.DOMUtils.addEventByNode(r,o.Wrapper.DOMUtils.Events.CLICK,function(){var e=t.callback||n.Pivot.Util.openPivotChartFilterDialog;e&&e.call(this,t,a(this)),!e&&h.log("[CHART] >>>>>>>> No callback Added")}),o.Wrapper.DOMUtils.appendChild(i,r),o.Wrapper.DOMUtils.appendChild(r,e)})},e.prototype.attachPageFilter=function(t,e){var i=this.getFilterWrapper(f.PAGE_FILTER,e);t.forEach(function(t){var e=o.Wrapper.DOMUtils.createElement("img");e.src=l.data.AppRegistry.IMAGEPath+"../../images/"+t.pic+".svg";var r=o.Wrapper.DOMUtils.createElement("div");r.classList.add("pvtChrtDlg"),r.classList.add("pvtChrtFlt"),r.setAttribute("data-pivot",t.content),o.Wrapper.DOMUtils.addEventByNode(r,o.Wrapper.DOMUtils.Events.CLICK,function(){var e=t.callback||n.Pivot.Util.openPivotChartFilterDialog;e&&e.call(this,t,a(this)),!e&&h.log("[CHART] >>>>>>>> No callback Added")}),o.Wrapper.DOMUtils.appendChild(i,r),o.Wrapper.DOMUtils.appendChild(r,e)})},p.UIChartLayer=e}(this);
!function(t){function e(t,e,o,n,i,s){this.gridID=t,this.rID=e,this.sheetID=o,this.version=n,this.sheetPane=i,a.Controller.call(this,c,w,C,s)}var o=t.ZSClass,n=o.Layer||(o.Layer={}),i=n.Interface,s=n.Chart,r=n.Modules,a=r.Main,h=r.Focus,d=r.Resize,l=r.Move,u=r.Clone,c=s.StateControl,w=s.NetworkControl,C=s.ViewControl,f=s.Interacter;e.prototype={getInteracter:function(t){var e=new f(this.gridID,this.rID,this.sheetID,this.version,t,this);return e},onRender:function(t,e){this.State.onRender(t,e),this.Views.onRender(t,e),this.Network.onRender(t,e)},onRefresh:function(t,e){this.State.onRefresh(t,e),this.Views.onRefresh(t,e),this.Network.onRefresh(t,e)},onCachedViewAttach:function(t,e){this.State.onCachedViewAttach(t,e),this.Views.onCachedViewAttach(t,e),this.Network.onCachedViewAttach(t,e)},onLoad:function(t,e){this.State.onLoad(t,e),this.Views.onLoad(t,e),this.Network.onLoad(t,e)},updateBoundary:function(t,e,o){this.State.updateBoundary(t,e,o),this.Views.updateBoundary(t,e,o),this.Network.updateBoundary(t,e,o)},onZoom:function(t,e){this.State.onZoom(t,e),this.Views.onZoom(t,e),this.Network.onZoom(t,e)},updatePanelStatus:function(t,e){this.State.onUpdatePanelStatus(t,e),this.Views.onUpdatePanelStatus(t,e),this.Network.onUpdatePanelStatus(t,e)}};var p=[a.Controller,h.Controller,d.Controller,l.Controller,u.Controller];e.prototype=i.implement(e,p),s.Controller=e}(this);
!function(t){function r(t){var r=t.getX(),o=t.getY();return a*o+r}function o(t,r){return t.getController()===r.getController()?t.getID()===r.getID():!1}function e(t,e){for(var n,l,i,s,v=r(t),a=0;a<e.length;a++){var h=e[a],c=h.getAlive();for(var f in c){var u=h.getInteracter(f),C=r(u);n?i>C&&(n=u,i=r(n)):(n=u,i=r(n)),C>=v&&!o(u,t)&&(l||(l=u,s=C),o(l,u)||s>C&&(l=u,s=C))}}!l&&(l=n);var h=l.getController();h.focus(l.getID()),h.scrollIntoView(l.getID())}function n(t,e){for(var n,l,i,s,v=r(t),a=0;a<e.length;a++){var h=e[a],c=h.getAlive();for(var f in c){var u=h.getInteracter(f),C=r(u);n?C>i&&(n=u,i=r(n)):(n=u,i=r(n)),v>=C&&!o(u,t)&&(l||(l=u,s=C),o(l,u)||C>=s&&(l=u,s=C))}}!l&&(l=n);var h=l.getController();h.focus(l.getID()),h.scrollIntoView(l.getID())}function l(){this.Controllers=[]}var i=t.ZSClass,s=i.Layer||(i.Layer={}),v=s.Ole||(s.Ole={}),a=1e3;l.prototype={addController:function(t){this.Controllers.push(t)},removeController:function(t){var r=this.Controllers.indexOf(t);this.Controllers[r]&&(this.Controllers[r].removeAll(),this.Controllers.splice(r,1))},onFocus:function(t){this.active=t},onBlur:function(){delete this.active},focusNext:function(){var t=this.active.getActive();for(var r in t){var o=this.active.getInteracter(r);return this.active.blur(r),void e(o,this.Controllers)}},focusPrev:function(){var t=this.active.getActive();for(var r in t){var o=this.active.getInteracter(r);return this.active.blur(r),void n(o,this.Controllers)}},blurAll:function(){for(var t=0;t<this.Controllers.length;t++){this.Controllers[t].onBlurAll()}},focusAll:function(){for(var t=0;t<this.Controllers.length;t++){this.Controllers[t].onFocusAll()}},removeAll:function(){for(var t=0;t<this.Controllers.length;t++){this.Controllers[t].onRemoveAll()}},move:function(t){for(var r=0;r<this.Controllers.length;r++){this.Controllers[r].onMove(t)}},moveEnd:function(t){for(var r=0;r<this.Controllers.length;r++){this.Controllers[r].onMoveEnd(t)}},resize:function(t){for(var r=0;r<this.Controllers.length;r++){this.Controllers[r].onResize(t)}},resizeEnd:function(t){for(var r=0;r<this.Controllers.length;r++){this.Controllers[r].onResizeEnd(t)}},delete:function(){for(var t=0;t<this.Controllers.length;t++){this.Controllers[t].onDelete()}},clone:function(t){for(var r=0;r<this.Controllers.length;r++){this.Controllers[r].onClone(t)}},updateBoundary:function(t,r,o){for(var e=0;e<this.Controllers.length;e++){this.Controllers[e].updateBoundary(t,r,o)}}},v.MasterController=l}(this);
!function(e){function t(){var t=e.sPlusPlus.view.Events.Key;w=t.Stack[t.Stack.length-1],w&&L.register(N.Listener,T.RangePicker.Disable,r)}function n(){if(K){var t=e.sPlusPlus.view.Events.Key;w=t.Stack[t.Stack.length-1],w&&L.register(N.Gesture.Selector.RangePicker,T.GESTURE.ACTION.END,i)}}function i(){var t=e.sPlusPlus.view.Events.Key;t.focusContext(w),L.unregister(N.Gesture.Selector.RangePicker,T.GESTURE.ACTION.END,i)}function r(){var t=e.sPlusPlus.view.Events.Key;t.focusContext(w),L.unregister(N.Listener,T.RangePicker.Disable,r)}function s(e){var t=p.value,n=t.match(V),i=0,r=0;for(var s in n){var a=n[s];if($.test(a)){if(r===e)return void c(t,i,i+a.length);r++}i+=a.length}}function a(e,t,n){var i=e.substring(0,t),r=e.substring(n),s=i.match(/(.*[(;,!=+\-\/*<>&^])/),a=s?s[0].length:0,o=r.match(/[);,=+\-\/*<>&]/),l=o?i.length+o.index:e.length;return{start:a,end:l}}function o(){var e=window.getSelection(),t=e.getRangeAt(0);t.deleteContents(),j.innerHTML="",t.insertNode(j),t=t.cloneRange(),t.setStartBefore(j),t.setEndBefore(j),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}function l(e,t,n,i){if(i){var r=E();if(r)var t=0,n=e.length;else{var s=a(e,t,n);t=s.start,n=s.end}c(e,t,n),B=i}else c(e,t,n),B=B&&t===n,j.remove(),B&&(p.focus(),p.setSelectionRange(t,n),o())}function g(){B=!1}function c(e,t,n){y=t,H=n;var e=p.value;x=e.substring(0,t),M=e.substring(n);var i=/(?:([\(;,.!\=\+-\/*<>&^]([\s]*)?$)|(^$))/.test(x)&&(p.valueCheck?p.valueCheck(x):!0),r=/(?:(^([\s]*)?[\);,=\+-\/*<>&])|(^$))/.test(M);B=i&&r,B=B&&(p.valueCheck?p.valueCheck(e):!0),h(e,t,n)}function u(e,t,n,i){B&&v(e,t,n,i)}function v(e,t,n,i){f(e,t,n,i);var r=R(e,t,n,i,p.RangePickerOptions.mode),s=x+r+M,a=(x+r).length;p.value=s,p.valueChanged(),p.setSelectionRange(a,a),h(s,y,a)}function R(e,t,n,i,r){var s=O.data.getWorkBook(e,n),a=s.getSheetObj(t),o=a.Prop.Name;o=(/[-\s]/.test(o)?"'"+o+"'":o)+".";var l=O.view.CellEditor.getEditCell();l&&l.getRID()===e&&l.getSheetID()===t&&l.getVersion()===n&&(o="");var g=a.Merge.getInfo(i.startRow,i.startCol);return g&&i.equals(g)&&(i=new A.Range(i.startRow,i.startCol,i.startRow,i.startCol)),o+i.getLabel(r)}function f(e,t,n,i){var r=O.data.getWorkBook(e,n),s=r.getSheetObj(t);return s.Merge.extendRange(i)}function h(e,t,n){var i=p.valueCheck?p.valueCheck(e):!0;L.publish(N.Listener,T.RangePicker.Highlight,{highlight:i,text:e,start:t,end:n})}function d(){if(K){var e=p.value,t=p.selectionStart,n=p.selectionEnd;h(e,t,n)}}function S(e){var t=function(){K=!0,p!==this&&(p=this);var e=p.value,t=p.selectionStart,n=p.selectionEnd,i=p.RangePickerOptions.DialogMode;l(e,t,n,i)}.bind(e),n={blur:D,focus:t,selectionChanged:t};e.addListeners(n)}function k(e,t,n,i,r){p=e,p.RangePickerOptions={SingleSelection:!!t,SingleCell:!!n,DialogMode:!r,mode:i},S(e)}function P(){return K&&B}function E(){return p.RangePickerOptions.SingleSelection}function C(){return p.RangePickerOptions.SingleCell}function D(){p=void 0;var e=O.view.getActiveGridID(),t=O.view.getResourceID(e),n=O.view.getVersionID(e),i=O.view.getSheetID(e);G.KeyBoardApi.Clear(),L.publish(N.Listener,T.RangePicker.HideFrom,{RID:t,SHEETID:i,VERSION:n,fromIndex:0}),B=!1,K=!1}function m(e){return P()&&p===e}function I(e,t,n,i){if(K&&i.length>0){var r="",s=i[0];f(e,t,n,s),r+=R(e,t,n,s,p.RangePickerOptions.mode);for(var a=1;a<i.length;a++)s=i[a],r+=",",r+=R(e,t,n,s,p.RangePickerOptions.mode);p.value=r,p.valueChanged();var o=r.length;p.setSelectionRange(o,o),h(r,o,o)}}var p,w,O=e.sPlusPlus,b=e.ZSEvents,L=b.topic,N=b.Groups,T=b.Names,A=e.ZSClass,G=A.RangePicker={},x="",M="",y=0,H=0,B=!1,K=!1,U=e.JSUtil.REGEXP,V=U.matchRegex,$=U.rangeRegex;L.register(N.Listener,T.Mouse.RangeDown,n),L.register(N.Gesture.Selector.RangePicker,T.GESTURE.ACTION.START,t),L.register(N.Listener,T.RangePicker.Modify,s,"index");var j=document.createElement("span");j.className="RSCue",L.register(N.Listener,T.RangePicker.Disable,g),L.register(N.Listener,T.RangePicker.Update,u,"RID","SHEETID","VERSION","RANGE"),L.register(N.Listener,T.RangePicker.ReHighlight,d),G.setRanges=I,G.register=k,G.isSelection=P,G.isSingleCell=C,G.isActiveOn=m}(this);
!function(t){function o(t,o,n){return z||e(t,o,n),z}function n(){z=null}function e(t,o,n){var e=Y.view.getActiveGridID(),a=Y.view.getSheetState(e,o),l=a.getActiveCellRange();r(t,o,n,l)}function r(t,o,n,e){z=e,F&&z.subset(F)||l(t,o,n,e.startRow,e.startCol)}function a(t,o,n,e){var r=Y.data.getWorkBook(t,n),a=r.getSheetObj(o);return a.Merge.extendRange(e)}function l(t,o,n,e,r){Q=e,J=r,F=new lo(e,r,e,r),F=a(t,o,n,F)}function w(t,o,n,e){{var r=Y.data.getWorkBook(t,n);r.getSheetObj(o)}oo.publish(no.Listener,eo.RangePicker.Update,{RID:t,SHEETID:o,VERSION:n,RANGE:e})}function i(t,o,n,e){var r=Y.data.getWorkBook(t,n),a=r.getSheetObj(o),l=a.Column.hidden.prevNonHidden(e);return 0>l&&(l=0),l}function C(t,o,n,e){var r=Y.data.getWorkBook(t,n),a=r.getSheetObj(o),l=a.Column.hidden.nextNonHidden(e);return l>=ao.MAX_COL&&(l=ao.MAX_COL-1),l}function R(t,o,n,e){var r=Y.data.getWorkBook(t,n),a=r.getSheetObj(o),l=a.Row.Visibility.prevNonHidden(e);return 0>l&&(l=0),l}function s(t,o,n,e){var r=Y.data.getWorkBook(t,n),a=r.getSheetObj(o),l=a.Row.Visibility.nextNonHidden(e);return l>=ao.MAX_ROW&&(l=ao.MAX_ROW-1),l}function c(t,o,n){var e=Q,r=F.startCol,a=i(t,o,n,r),C=new lo(e,a,e,a);l(t,o,n,e,a),w(t,o,n,C),$.ScrollCellIntoView(t,o,n,C.startRow,C.startCol)}function d(t,o,n){var e=Q,r=F.endCol,a=C(t,o,n,r),i=new lo(e,a,e,a);l(t,o,n,e,a),w(t,o,n,i),$.ScrollCellIntoView(t,o,n,i.startRow,i.startCol)}function u(t,o,n){var e=F.startRow,r=J,a=R(t,o,n,e),i=new lo(a,r,a,r);l(t,o,n,a,r),w(t,o,n,i),$.ScrollCellIntoView(t,o,n,i.startRow,i.startCol)}function f(t,o,n){var e=F.endRow,r=J,a=s(t,o,n,e),i=new lo(a,r,a,r);l(t,o,n,a,r),w(t,o,n,i),$.ScrollCellIntoView(t,o,n,i.startRow,i.startCol)}function v(t,n,e){var r=o(t,n,e),l=r.startCol,C=i(t,n,e,l),R=new lo(r.startRow,C,r.endRow,r.endCol);a(t,n,e,R),w(t,n,e,R),$.ScrollColIntoView(t,n,e,R.startCol)}function S(t,n,e){var r=o(t,n,e),l=r.endCol,i=C(t,n,e,l),R=new lo(r.startRow,r.startCol,r.endRow,i);a(t,n,e,R),w(t,n,e,R),$.ScrollColIntoView(t,n,e,R.endCol)}function g(t,n,e){var r=o(t,n,e),l=r.startRow,i=R(t,n,e,l),C=new lo(i,r.startCol,r.endRow,r.endCol);a(t,n,e,C),w(t,n,e,C),$.ScrollRowIntoView(t,n,e,C.startRow)}function I(t,n,e){var r=o(t,n,e),l=r.endRow,i=s(t,n,e,l),C=new lo(r.startRow,r.startCol,i,r.endCol);a(t,n,e,C),w(t,n,e,C),$.ScrollRowIntoView(t,n,e,C.endRow)}function V(t,n,e){var r=o(t,n,e),l=new lo(r.startRow,r.startCol,r.endRow,r.startCol);a(t,n,e,l);var i=C(t,n,e,l.endCol),R=new lo(r.startRow,i,r.endRow,r.endCol);w(t,n,e,R),$.ScrollColIntoView(t,n,e,R.startCol)}function h(t,n,e){var r=o(t,n,e),l=new lo(r.startRow,r.endCol,r.endRow,r.endCol);a(t,n,e,l);var C=i(t,n,e,l.startCol),R=new lo(r.startRow,r.startCol,r.endRow,C);w(t,n,e,R),$.ScrollColIntoView(t,n,e,R.endCol)}function N(t,n,e){var r=o(t,n,e),l=new lo(r.startRow,r.startCol,r.startRow,r.endCol);a(t,n,e,l);var i=s(t,n,e,l.endRow),C=new lo(i,r.startCol,r.endRow,r.endCol);w(t,n,e,C),$.ScrollRowIntoView(t,n,e,C.startRow)}function k(t,n,e){var r=o(t,n,e),l=new lo(r.endRow,r.startCol,r.endRow,r.endCol);a(t,n,e,l);var i=R(t,n,e,l.startRow),C=new lo(r.startRow,r.startCol,i,r.endCol);w(t,n,e,C),$.ScrollRowIntoView(t,n,e,C.endRow)}function p(t,n,e){var r=o(t,n,e),l=new lo(r.startRow,F.startCol,r.endRow,F.endCol);return a(t,n,e,l),l}function O(t,n,e){var r=o(t,n,e),l=new lo(F.startRow,r.startCol,F.endRow,r.endCol);return a(t,n,e,l),l}function b(t,n,e){var r=o(t,n,e),a=p(t,n,e);r.endCol===a.endCol?v(t,n,e):h(t,n,e)}function A(t,n,e){var r=o(t,n,e),a=p(t,n,e);r.startCol===a.startCol?S(t,n,e):V(t,n,e)}function D(t,n,e){var r=o(t,n,e),a=O(t,n,e);r.endRow===a.endRow?g(t,n,e):k(t,n,e)}function E(t,n,e){var r=o(t,n,e),a=O(t,n,e);r.startRow===a.startRow?I(t,n,e):N(t,n,e)}function L(t,o,n,e,r){var a=new lo(e,r,e,r);l(t,o,n,e,r),w(t,o,n,a),$.ScrollCellIntoView(t,o,n,a.startRow,a.startCol)}function W(t,o,n,e){$.CtrlNavigate(t,[o],n,Q,J,e,L)}function B(t,o,n){W(t,o,n,4)}function U(t,o,n){W(t,o,n,3)}function j(t,o,n){W(t,o,n,2)}function H(t,o,n){W(t,o,n,1)}function M(t,o,n){$.CtrlNavigate(t,[o],n,Q,z.startCol,4,function(t,o,n,e,r){var l=new ro.Range(z.startRow,r,z.endRow,z.endCol);a(t,o,n,l),w(t,o,n,l),$.ScrollColIntoView(t,o,n,l.startCol)})}function P(t,o,n){$.CtrlNavigate(t,[o],n,Q,z.endCol,3,function(t,o,n,e,r){var l=new lo(z.startRow,z.startCol,z.endRow,r);a(t,o,n,l),w(t,o,n,l),$.ScrollColIntoView(t,o,n,l.endCol)})}function G(t,o,n){$.CtrlNavigate(t,[o],n,z.startRow,J,2,function(t,o,n,e){var r=new ro.Range(e,z.startCol,z.endRow,z.endCol);a(t,o,n,r),w(t,o,n,r),$.ScrollRowIntoView(t,o,n,r.startRow)})}function X(t,o,n){$.CtrlNavigate(t,[o],n,z.endRow,J,1,function(t,o,n,e){var r=new ro.Range(z.startRow,z.startCol,e,z.endCol);a(t,o,n,r),w(t,o,n,r),$.ScrollRowIntoView(t,o,n,r.startRow)})}function _(t,o,n){$.CtrlNavigate(t,[o],n,Q,z.startCol,3,function(t,o,n,e,r){var l=new lo(z.startRow,r,z.endRow,z.endCol);a(t,o,n,l),w(t,o,n,l),$.ScrollColIntoView(t,o,n,l.startCol)})}function m(t,o,n){$.CtrlNavigate(t,[o],n,Q,z.endCol,4,function(t,o,n,e,r){var l=new ro.Range(z.startRow,z.startCol,z.endRow,r);a(t,o,n,l),w(t,o,n,l),$.ScrollColIntoView(t,o,n,l.endCol)})}function x(t,o,n){$.CtrlNavigate(t,[o],n,z.startRow,J,1,function(t,o,n,e){var r=new ro.Range(e,z.startCol,z.endRow,z.endCol);a(t,o,n,r),w(t,o,n,r),$.ScrollRowIntoView(t,o,n,r.startRow)})}function y(t,o,n){$.CtrlNavigate(t,[o],n,z.endRow,J,2,function(t,o,n,e){var r=new ro.Range(z.startRow,z.startCol,e,z.endCol);a(t,o,n,r),w(t,o,n,r),$.ScrollRowIntoView(t,o,n,r.startRow)})}function T(t,n,e){var r=o(t,n,e),a=p(t,n,e);r.endCol===a.endCol?M(t,n,e):m(t,n,e)}function Z(t,n,e){var r=o(t,n,e),a=p(t,n,e);r.startCol===a.startCol?P(t,n,e):_(t,n,e)}function K(t,n,e){var r=o(t,n,e),a=O(t,n,e);r.endRow===a.endRow?G(t,n,e):y(t,n,e)}function q(t,n,e){var r=o(t,n,e),a=O(t,n,e);r.startRow===a.startRow?X(t,n,e):x(t,n,e)}var z,F,J,Q,Y=t.sPlusPlus,$=t.UserAction,to=t.ZSEvents,oo=to.topic,no=to.Groups,eo=to.Names,ro=t.ZSClass,ao=Y.data.Defaults,lo=ro.Range,wo=ro.RangePicker,io=wo.KeyBoardApi={};io.Init=e,io.Clear=n,io.Left=c,io.Right=d,io.Up=u,io.Down=f,io.ShiftLeft=b,io.ShiftRight=A,io.ShiftUp=D,io.ShiftDown=E,io.CtrlLeft=B,io.CtrlRight=U,io.CtrlUp=j,io.CtrlDown=H,io.CtrlShiftLeft=T,io.CtrlShiftRight=Z,io.CtrlShiftUp=K,io.CtrlShiftDown=q,oo.register(no.Listener,eo.RangePicker.Update,r,"RID","SHEETID","VERSION","RANGE")}(this);
!function(e){function r(e,r,i,s){var R=0,D=t.view.getActiveGridID(),I=t.view.getResourceID(D),c=t.view.getSheetID(D),l=t.view.getVersionID(D),E=t.data.getWorkBook(I,l),F=E.getSheetObj(c);if(e){var B=r.match(v),u=0;h.reset(),i>s&&(i+=s,s=i-s,i-=s);for(var A in B){var d=B[A];if(C.test(d)){var S=o.Range.parseRange(I,l,d);if(S){var f=h.get(d),w=i>=u&&s<=u+d.length;F.Merge.extendRange(S.range),g.publish(n.Listener,a.RangePicker.Add,{RID:I,SHEETID:S.sheetID,VERSION:l,RANGEID:R,Range:S.range,isCurrentRange:w,bringForward:w,color:"#"+f}),R++}}u+=d.length}}g.publish(n.Listener,a.RangePicker.HideFrom,{RID:I,SHEETID:c,VERSION:l,fromIndex:R})}var t=e.sPlusPlus,i=e.ZSEvents,g=i.topic,n=i.Groups,a=i.Names,s=e.ZSClass,o=e.JSUtil,R=s.RangeColorChoser,h=new R(["5883DA","E5575B","A43FBC","5B9C27","11A9CC","F7900C","BD4F90","2B799C","AC3135","5F5F5F","0D6856","9B8C2B","3FD0B4","F2B405","4B10AC","65765A","9258F1","795011","584A71","EF3964"]),D=o.REGEXP,v=D.matchRegex,C=D.rangeRegex;g.register(n.Listener,a.RangePicker.Highlight,r,"highlight","text","start","end")}(this);
!function(e){function E(e,E,t,r,n,S,O){var u=o()?i.Gesture.Selector.RangePicker:i.Gesture.Selector.Range,T=I.GESTURE.ACTION.DOWN,c=R.view.Events.Key;c.focusContext(o()?c.Entry.RangePicker.Context:c.Entry.CellEditor.Context);var D={RID:e,SHEETID:E,VERSION:t,COLX:r,ROWY:n,TYPE:S,ACCUMULATE:O};s.publish(u,T,D)}function t(e,E,t,r,R,n,S){var O=o()?i.Gesture.Selector.RangePicker:i.Gesture.Selector.Range,u=I.GESTURE.ACTION.MOVE,T={RID:e,SHEETID:E,VERSION:t,RANGEID:r,COLX:R,ROWY:n,TYPE:S};s.publish(O,u,T)}function r(e,E,t,r,R,n,S){var O=o()?i.Gesture.Selector.RangePicker:i.Gesture.Selector.Range,u=I.GESTURE.ACTION.END,T={RID:e,SHEETID:E,VERSION:t,RANGEID:r,COLX:R,ROWY:n,TYPE:S};s.publish(O,u,T)}var R=e.sPlusPlus,n=e.ZSEvents,s=n.topic,i=n.Groups,I=n.Names,S=e.ZSClass,o=S.RangePicker.isSelection;s.register(i.Listener,I.Mouse.RangeDown,E,"RID","SHEETID","VERSION","COLX","ROWY","TYPE","ACCUMULATE"),s.register(i.Listener,I.Mouse.RangeMove,t,"RID","SHEETID","VERSION","RANGEID","COLX","ROWY","TYPE"),s.register(i.Listener,I.Mouse.RangeEnd,r,"RID","SHEETID","VERSION","RANGEID","COLX","ROWY","TYPE")}(this);
!function(e){function t(e,t,r,E){n.publish(I.Listener,O.RangePicker.Update,{RID:e,SHEETID:t,VERSION:r,RANGE:E})}function r(e,r,E,i,n,I,O,o){var T=S.data.getWorkBook(e,E),g=T.getSheetObj(r);R=new c(I,!0,a),s=R.ADD(g,i,n,O,o),t(e,r,E,s)}function E(e,r,E,i,n){if(!g.isSingleCell()){var I=S.data.getWorkBook(e,E),O=I.getSheetObj(r);s=R.MODIFY(O,i,n,s),t(e,r,E,s)}}var R,s,S=e.sPlusPlus,i=e.ZSEvents,n=i.topic,I=i.Groups,O=i.Names,o=e.ZSClass,T=o.SelectorHelper.Constants,a=T.MULTI_DIRECTION,c=o.Selector.Assistor,g=(o.Range,o.RangePicker);n.register(I.Gesture.Selector.RangePicker,O.GESTURE.ACTION.DOWN,r,"RID","SHEETID","VERSION","COLX","ROWY","TYPE"),n.register(I.Gesture.Selector.RangePicker,O.GESTURE.ACTION.START,r,"RID","SHEETID","VERSION","COLX","ROWY","TYPE","point","fixedRange"),n.register(I.Gesture.Selector.RangePicker,O.GESTURE.ACTION.MOVE,E,"RID","SHEETID","VERSION","COLX","ROWY","TYPE"),n.register(I.Gesture.Selector.RangePicker,O.GESTURE.ACTION.END,E,"RID","SHEETID","VERSION","COLX","ROWY","TYPE")}(this);
!function(t){function i(i){var e=t.document.createElement("div");e.className="cFC",i.appendChild(e);var n=t.document.createElement("div");n.className="cF",e.appendChild(n);var s=t.document.createElement("div");s.textContent="A1",s.className="cFL",e.appendChild(s);var o=t.document.createElement("div");o.className="suggestBox",e.appendChild(o);var a=t.document.createElement("div");a.className="formulaSyntax",a.style.display="none",e.appendChild(a),this.Label=s,this.Editor=n,this.Container=e,this.SuggestContainer=o,this.ToolTipContainer=a,this.isEnabled=!0,this.inView=!0,this.turnOff(),this.hideLabel()}function e(t,i,e){var o=this.Container.offsetHeight-r,a=this.Container.offsetWidth-r,h=n.call(this,t,i,e,a),l=s.call(this,t,i,e,o);(l||h)&&this.setDimension(this.minWidth,this.minHeight,this.maxWidth,this.maxHeight)}function n(t,i,e,s){if(this.minWidth<s){var o=h.data.getWorkBook(t,e),a=o.getSheetObj(i),l=a.Column.axis.getPos(this.range.endCol+this.expandedColCount)-a.Column.axis.getPos(this.range.startCol);return l<this.maxWidth?(this.minWidth=l,this.expandedColCount++,n.call(this,t,i,e,s)):this.minWidth=this.maxWidth,!0}}function s(t,i,e,n){if(this.minHeight<n){var o=h.data.getWorkBook(t,e),a=o.getSheetObj(i),l=a.Row.auxiliaryAxis.getPos(this.range.endRow+this.expandedRowCount),r=a.Row.auxiliaryAxis.getPos(this.range.startRow),d=l-r;return d<this.maxHeight?(this.minHeight=d,this.expandedRowCount++,s.call(this,t,i,e,n)):this.minHeight=this.maxHeight,!0}}function o(t,i,e,n,s,o,a){this.range=t,this.minWidth=n,this.minHeight=s,this.maxWidth=o,this.maxHeight=a,this.expandedRowCount=0,this.expandedColCount=0}function a(t,e){i.call(this,t),p.call(this,this.Editor,!0),this.addListeners(e)}var h=t.sPlusPlus,l=2,r=3,d=t.ZSClass,p=d.Editors.FormulaEditor;a.prototype=new p,a.prototype.place=function(t,i,e,n,s,a,h){o.call(this,t,i,e,n,s,a,h),this.setPosition(i,e),this.setDimension(n,s,a,h),this.hideLabel()},a.prototype.adjustDimensions=function(t,i,n){!this.labelInView&&e.call(this,t,i,n)},a.prototype.setPosition=function(t,i){var e=this.Container.style;e.left=t-l+"px",e.top=i-l+"px"},a.prototype.setDimension=function(t,i,e,n){var s=this.Container.style;s.minWidth=t+r+"px",s.minHeight=i+r+"px",s.maxWidth=e+l+"px",s.maxHeight=n+l+"px"},a.prototype.show=function(){this.inView||(this.Container.style.display="",this.inView=!0)},a.prototype.hide=function(){this.inView&&(this.Container.style.display="none",this.inView=!1)},a.prototype.showLabel=function(t){var i=this.Label;i.style.display="",!!t&&(i.textContent=t),this.labelInView=!0},a.prototype.hideLabel=function(){var t=this.Label;t.style.display="none",this.labelInView=!1},a.prototype.setStyle=function(t,i){var e=this.Editor.style;switch(e.background=i[0]?i[0]:"",e.color=i[1]?i[1]:"",e.fontSize=i[2]?i[2]+"pt":"",e.fontFamily=i[3]?i[3]:"",e.fontWeight=i[4]?i[4]:"",e.fontStyle=i[5]?i[5]:"",e.textDecoration=""+(i[6]?"line-through":"")+(i[7]?" underline":""),i[9]){case"start":e.textAlign="left";break;case"center":e.textAlign="center";break;case"end":e.textAlign="right";break;default:e.textAlign="FLOAT"===t.CellType||"NUMBER"===t.CellType||"CURRENCY"===t.CellType||"DATE"===t.CellType||"TIME"===t.CellType||"DATETIME"===t.CellType?"right":"left"}},a.prototype.setZoom=function(t){var i=this.Editor.style;i.zoom=t},a.prototype.turnOn=function(){this.isEnabled||(this.show(),this.isEnabled=!0,this.focus())},a.prototype.turnOff=function(){this.isEnabled&&(this.hide(),this.value="",this.Editor.blur(),this.isEnabled=!1)},a.prototype.getValue=function(){return this.value},a.prototype.setValue=function(t){this.value=t},d.CellEditor=a}(this);
!function(t){var r=(t.sPlusPlus,t.ZSClass.SelectorHelper);r.lubricateX=function(t,r){return r},r.lubricateY=function(t,r){return r}}(this);
!function(E){var N={A:"65",B:"66",C:"67",D:"68",E:"69",F:"70",G:"71",H:"72",I:"73",J:"74",K:"75",L:"76",M:"77",N:"78",O:"79",P:"80",Q:"81",R:"82",S:"83",T:"84",U:"85",V:"86",W:"87",X:"88",Y:"89",Z:"90",ZERO:"48",ONE:"49",TWO:"50",THREE:"51",FOUR:"52",FIVE:"53",SIX:"54",SEVEN:"55",EIGHT:"56",NINE:"57",F1:"112",F2:"113",F3:"114",F4:"115",F5:"116",F6:"117",F7:"118",F8:"119",F9:"120",F10:"121",F11:"122",F12:"123",ESC:"27",TILDE:"192",MINUS:"189",EQUAL:"187",BACKSPACE:"8",DELETE:"46",TAB:"9",OPENBRACKET:"219",CLOSEBRACKET:"221",BACKSLASH:"220",CAPSLOCK:"20",SEMICOLON:"186",SINGLEQUOTE:"222",ENTER:"13",SHIFT:"16",COMMA:"188",DOT:"190",SLASH:"191",SPACE:"32",CTRL:"17",ALT:"18",LEFTCOMMAND:"91",RIGHTCOMMAND:"93",COMMAND:"224",LEFT:"37",UP:"38",RIGHT:"39",DOWN:"40",DELETE:"46",HOME:"36",END:"35",PAGEUP:"33",PAGEDOWN:"34",PRINTSCREEN:"124",NUMPAD_ZERO:"96",NUMPAD_ONE:"97",NUMPAD_TWO:"98",NUMPAD_THREE:"99",NUMPAD_FOUR:"100",NUMPAD_FIVE:"101",NUMPAD_SIX:"102",NUMPAD_SEVEN:"103",NUMPAD_EIGHT:"104",NUMPAD_NINE:"105",NUMLOCK:"12",DECIMAL:"110",MULTIPLY:"106",ADD:"107",SUBTRACT:"109",DIVIDE:"111"};N.PURE_PRINTABLE_CHAR="*";var A=E.navigator.userAgent;-1!=A.indexOf("Firefox")&&(N.MINUS="173",N.EQUAL="61",N.SEMICOLON="59",N.PRINTSCREEN="44"),E.ZSConstants.JSKeyCode=N,E.ZSConstants.JSKeyCode.getKey=JSON.getKey}(this);
!function(t){function n(){this.tree=new c.Tree,this.Entry={},this.Stack=[]}function e(){this.alive=!0,this.keyDown={}}function i(t){return{Context:t,Node:f.createNode(t)}}function o(t,n){for(var e=t.Node,i=0;i<n.length;i++){var o=n[i].Node;e.addChild(o),e=o}}function l(t,n){var e=a.data.getWorkBook(t,n),i=a.view.Events.Key.Entry;i.Button.Context.alive=e.isEditable(),i.ButtonEdit.Context.alive=e.isEditable(),i.CellEditor.Context.alive=e.isEditable(),i.CellNote.Context.alive=e.isEditable(),i.RangeEdit.Context.alive=e.isEditable(),i.ShortCut.Context.alive=e.isEditable()}var c=t.ZSClass,a=t.sPlusPlus,r=t.sPlusPlus.view.Events={},s=r.Key={},u=(s.Tree=new c.Tree,s.Entries={},t.ZSEvents.topic),E=t.ZSEvents.Groups,h=t.ZSEvents.Names;n.prototype={createNode:function(t){return this.tree.createNode(t)},setRoot:function(t){this.tree.setRoot(t)},focusContext:function(t){this.Stack=this.tree.getPath(t)}};var f=r.Key=new n;c.KeyMapping=e;var y=f.Entry.Base=i(new function(){e.call(this)}),w=f.Entry.Grid=i(new function(){e.call(this)}),d=f.Entry.ShortCut=i(new function(){e.call(this)}),v=f.Entry.ReadOnlyShortCut=i(new function(){e.call(this)}),C=f.Entry.RangeSelection=i(new function(){e.call(this)}),g=f.Entry.RangeEdit=i(new function(){e.call(this)}),S=f.Entry.CellEditor=i(new function(){e.call(this)}),N=f.Entry.RangePicker=i(new function(){e.call(this)}),R=f.Entry.RangePickerDialog=i(new function(){e.call(this)}),P=f.Entry.SpotLight=i(new function(){e.call(this)}),x=f.Entry.Filter=i(new function(){e.call(this)}),k=f.Entry.PickList=i(new function(){e.call(this)}),p=f.Entry.CellNote=i(new function(){e.call(this)}),b=f.Entry.Ole=i(new function(){e.call(this)}),B=f.Entry.Button=i(new function(){e.call(this)}),T=f.Entry.ButtonEdit=i(new function(){e.call(this)}),D=(f.Entry.DocName=i(new function(){e.call(this)}),f.Entry.Dialog=i(new function(){e.call(this)})),Z=f.Entry.Pane=i(new function(){e.call(this)}),m=f.Entry.RightPane=i(new function(){e.call(this)}),K=f.Entry.SheetTab=i(new function(){e.call(this)}),A=f.Entry.Alert=i(new function(){e.call(this)}),I=f.Entry.Zoom=i(new function(){e.call(this)}),L=f.Entry.QuickFind=i(new function(){e.call(this)}),M=f.Entry.Notification=i(new function(){e.call(this)}),O=f.Entry.Announcement=i(new function(){e.call(this)}),F=f.Entry.pageTour=i(new function(){e.call(this)}),G=(f.Entry.Menu=i(new function(){e.call(this)}),f.Entry.Print=i(new function(){e.call(this)}));f.setRoot(y.Node),o(y,[D]),o(y,[P]),o(y,[Z,m]),o(y,[K]),o(y,[I]),o(y,[L]),o(y,[O]),o(y,[F]),o(y,[M]),o(y,[G]),o(y,[w,v,d,C,g,S,N]),o(y,[R]),o(C,[p]),o(C,[x]),o(C,[k]),o(C,[b,B,T]),o(D,[A]),f.Entry.Base=y,f.focusContext(g.Context),u.register(E.Listener,h.DocMeta.ACTIVE_SHEET,l,"RID","VERSION")}(this);
!function(e){function t(e){var t=e.keyCode||e.which;return t.toString()}function a(e){if(!e.metaKey&&!e.ctrlKey&&!e.altKey){var a=e.keyCode||e.which;if(a>=A&&C>=a||a>=y&&E>=a||a>=S&&v>=a)return!0;var a=t(e);switch(a){case s.TILDE:case s.MINUS:case s.EQUAL:case s.OPENBRACKET:case s.CLOSEBRACKET:case s.BACKSLASH:case s.SEMICOLON:case s.SINGLEQUOTE:case s.COMMA:case s.DOT:case s.SLASH:case s.ADD:case s.SUBTRACT:case s.MULTIPLY:case s.DIVIDE:case s.DECIMAL:return!0;case s.SPACE:return!e.shiftKey}}return!1}function r(e){var r=t(e),i="",c=r===s.RIGHTCOMMAND||r===s.LEFTCOMMAND||r===s.COMMAND||r===s.SHIFT||r===s.ALT||r===s.CTRL;return a(e)?i=s.PURE_PRINTABLE_CHAR:c?(e.metaKey&&(i=s.COMMAND),i+=e.ctrlKey?(""===i?"":"+")+s.CTRL:"",i+=e.shiftKey?(""===i?"":"+")+s.SHIFT:"",i+=e.altKey?(""===i?"":"+")+s.ALT:""):i=n(e),i}function i(e){for(var t=c.view.getActiveGridID(),a=c.view.getResourceID(t),i=c.view.getVersionID(t),n=c.view.getSheetID(t),s=r(e),A=c.view.Events.Key.Stack,C=A.length-1;C>=0;C--){var y=A[C];if(y){var E=y.keyDown;if(y.alive&&E&&E[s]){var S=E[s](e,a,n,i);if(S===!1)return S}}}}{var n,c=e.sPlusPlus,s=e.ZSConstants.JSKeyCode;c.view.Events.Key.Stack}e.navigator.platform.toUpperCase().indexOf("MAC")>=0?(s.SUPER=s.COMMAND,n=function(e){var a=t(e),r="";return e.metaKey&&(r+=s.SUPER+"+"),e.ctrlKey&&(r+=s.CTRL+"+"),e.shiftKey&&(r+=s.SHIFT+"+"),e.altKey&&(r+=s.ALT+"+"),r+=a}):(s.SUPER=s.CTRL,n=function(e){var a=t(e),r="";return e.ctrlKey&&(r+=s.CTRL+"+"),e.shiftKey&&(r+=s.SHIFT+"+"),e.altKey&&(r+=s.ALT+"+"),r+=a});var A=~~s.A,C=~~s.Z,y=~~s.ZERO,E=~~s.NINE,S=~~s.NUMPAD_ZERO,v=~~s.NUMPAD_NINE;e.JSUtil.Key={},e.JSUtil.Key.getKeyCombination=r,e.addEventListener("keydown",i)}(this);
!function(t){function M(t){return t.preventDefault(),!1}var e=t.sPlusPlus.view.Events.Key,n=e.Entry.Base.Context,s=n.keyDown,C=t.ZSConstants.JSKeyCode;s[C.COMMAND+"+"+C.S]=M,s[C.COMMAND+"+"+C.O]=M,s[C.COMMAND+"+"+C.Y]=M,s[C.COMMAND+"+"+C.N]=M,s[C.COMMAND+"+"+C.P]=M,s[C.COMMAND+"+"+C.F]=M,s[C.COMMAND+"+"+C.H]=M}(this);
!function(e){function t(e,t,n,o){b.Left(t,n,o)}function n(e,t,n,o){b.Right(t,n,o)}function o(e,t,n,o){b.Up(t,n,o)}function i(e,t,n,o){b.Down(t,n,o)}function a(e,t,n,o){b.SelectionLeft(t,n,o)}function l(e,t,n,o){b.SelectionRight(t,n,o)}function R(e,t,n,o){b.SelectionUp(t,n,o)}function S(e,t,n,o){b.SelectionDown(t,n,o)}function D(e,t,n,o){e.preventDefault(),b.RightWithinRange(t,n,o)}function E(e,t,n,o){e.preventDefault(),b.LeftWithinRange(t,n,o)}function c(e,t,n,o){b.DownWithinRange(t,n,o)}function r(e,t,n,o){b.UpWithinRange(t,n,o)}function u(e,t,n,o){k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,RANGE:e})}function g(e,t,n,o){e.preventDefault(),u(m,t,n,o)}function I(e,t,n,o){e.preventDefault();var i=G.data.getWorkBook(t,o),a=(i.getSheetObj(n),G.view.getActiveGridID()),l=G.view.getSheetState(a,n),R=l.getActiveRange(),S=new V.Range(0,R.startCol,Z,R.endCol);u(S,t,n,o)}function T(e,t,n,o){e.preventDefault();var i=G.data.getWorkBook(t,o),a=(i.getSheetObj(n),G.view.getActiveGridID()),l=G.view.getSheetState(a,n),R=l.getActiveRange(),S=new V.Range(R.startRow,0,R.endRow,X);u(S,t,n,o)}function s(e,t,n,o){e.preventDefault(),b.CtrlLeft(t,n,o)}function A(e,t,n,o){e.preventDefault(),b.CtrlRight(t,n,o)}function U(e,t,n,o){e.preventDefault(),b.CtrlUp(t,n,o)}function C(e,t,n,o){e.preventDefault(),b.CtrlDown(t,n,o)}function v(e,t,n,o){e.preventDefault(),b.CtrlShiftLeft(t,n,o)}function O(e,t,n,o){e.preventDefault(),b.CtrlShiftRight(t,n,o)}function f(e,t,n,o){e.preventDefault(),b.CtrlShiftUp(t,n,o)}function d(e,t,n,o){e.preventDefault(),b.CtrlShiftDown(t,n,o)}function p(e,t,n,o){b.pageNavigateSelectionUp(t,n,o)}function w(e,t,n,o){b.pageNavigateSelectionDown(t,n,o)}function N(e,t,n,o){var i=G.data.getWorkBook(t,o),a=(i.getSheetObj(n),G.view.getActiveGridID()),l=G.view.getSheetState(a,n),R=l.getActiveRange(),S=new V.Range(R.startRow,0,R.endRow,R.endCol);k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,RANGE:S,TYPE:0}),k.publish(Y.Selector.BoundUpdate.Cell,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,ActiveCellRange:S,ROW:S.startRow,COL:S.startCol,TYPE:0})}function P(e,t,n,o){var i=G.data.getWorkBook(t,o),a=(i.getSheetObj(n),G.view.getActiveGridID()),l=G.view.getSheetState(a,n),R=l.getActiveRange(),S=new V.Range(R.startRow,R.startCol,R.endRow,X);k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,RANGE:S,TYPE:0}),k.publish(Y.Selector.BoundUpdate.Cell,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,ActiveCellRange:S,ROW:S.startRow,COL:S.startCol,TYPE:0})}function h(t,n,o,i){var a=new V.Range(0,0,0,0);e.UserAction.ScrollCellIntoView(n,o,i,a.startRow,a.startCol),k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:o,VERSION:i,RANGE:a,TYPE:0}),k.publish(Y.Selector.BoundUpdate.Cell,M.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:o,VERSION:i,ActiveCellRange:a,ROW:a.startRow,COL:a.startCol,TYPE:0})}function H(t,n,o,i){var a=G.data.getWorkBook(n,i),l=a.getSheetObj(o),R=l.MaxUsedRow,S=l.MaxUsedCol,D=new V.Range(R,S,R,S);e.UserAction.ScrollCellIntoView(n,o,i,D.startRow,D.startCol),k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:o,VERSION:i,RANGE:D,TYPE:0}),k.publish(Y.Selector.BoundUpdate.Cell,M.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:o,VERSION:i,ActiveCellRange:D,ROW:D.startRow,COL:D.startCol,TYPE:0})}function B(e,t,n,o){var i=G.data.getWorkBook(t,o),a=(i.getSheetObj(n),G.view.getActiveGridID()),l=G.view.getSheetState(a,n),R=l.getActiveRange(),S=new V.Range(0,0,R.endRow,R.endCol);k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,RANGE:S,TYPE:0}),k.publish(Y.Selector.BoundUpdate.Cell,M.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:n,VERSION:o,ActiveCellRange:S,ROW:S.startRow,COL:S.startCol,TYPE:0})}function W(t,n,o,i){var a=G.data.getWorkBook(n,i),l=a.getSheetObj(o),R=l.MaxUsedRow,S=l.MaxUsedCol,D=G.view.getActiveGridID(),E=G.view.getSheetState(D,o),c=E.getActiveRange(),r=new V.Range(c.startRow,c.startCol,R,S);e.UserAction.ScrollCellIntoView(n,o,i,r.startRow,r.startCol),k.publish(Y.Selector.BoundUpdate.Range,M.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:o,VERSION:i,RANGE:r,TYPE:0}),k.publish(Y.Selector.BoundUpdate.Cell,M.Selection.BOUND_UPDATE.ADD,{RID:n,SHEETID:o,VERSION:i,ActiveCellRange:r,ROW:r.startRow,COL:r.startCol,TYPE:0})}function L(e,t,n,o){k.publish(Y.Listener,M.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:n,VERSION:o}),k.publish(Y.Listener,M.KeyBoard.Escape,{RID:t,SHEETID:n,VERSION:o})}var b=e.UserAction.CellNavigation,G=e.sPlusPlus,F=G.data.Defaults,V=e.ZSClass,_=e.ZSEvents,k=_.topic,Y=_.Groups,M=_.Names,j=e.sPlusPlus.view.Events.Key,x=j.Entry.RangeSelection.Context,y=x.keyDown,K=e.ZSConstants.JSKeyCode,Z=F.MAX_ROW-1,X=F.MAX_COL-1,m=new V.Range(0,0,Z,X);y[K.LEFT]=t,y[K.RIGHT]=n,y[K.UP]=o,y[K.DOWN]=i,y[K.TAB]=D,y[K.ENTER]=c,y[K.SHIFT+"+"+K.LEFT]=a,y[K.SHIFT+"+"+K.RIGHT]=l,y[K.SHIFT+"+"+K.UP]=R,y[K.SHIFT+"+"+K.DOWN]=S,y[K.SHIFT+"+"+K.TAB]=E,y[K.SHIFT+"+"+K.ENTER]=r,y[K.SUPER+"+"+K.A]=g,y[K.CTRL+"+"+K.SPACE]=I,y[K.SHIFT+"+"+K.SPACE]=T,y[K.SHIFT+"+"+K.HOME]=N,y[K.SHIFT+"+"+K.END]=P,y[K.CTRL+"+"+K.SHIFT+"+"+K.HOME]=B,y[K.CTRL+"+"+K.SHIFT+"+"+K.END]=W,y[K.CTRL+"+"+K.HOME]=h,y[K.CTRL+"+"+K.END]=H,y[K.PAGEUP]=p,y[K.PAGEDOWN]=w,y[K.SUPER+"+"+K.LEFT]=s,y[K.SUPER+"+"+K.RIGHT]=A,y[K.SUPER+"+"+K.UP]=U,y[K.SUPER+"+"+K.DOWN]=C,y[K.SUPER+"+"+K.SHIFT+"+"+K.LEFT]=v,y[K.SUPER+"+"+K.SHIFT+"+"+K.RIGHT]=O,y[K.SUPER+"+"+K.SHIFT+"+"+K.UP]=f,y[K.SUPER+"+"+K.SHIFT+"+"+K.DOWN]=d,y[K.ESC]=L}(this);
!function(e){function t(e,t,i,a){if(!e.repeat){e.preventDefault();var r=s.view.getActiveGridID(),n=s.view.getSelectedSheets(r);UserAction.CLEARCONTENTS(t,n,a)}}function i(t,i,a,r){if(!t.repeat){var n=s.view.getActiveGridID(),i=s.view.getResourceID(n),a=s.view.getSheetID(n),o=s.data.getWorkBook(i,r),g=o.getSheetObj(a),l=s.view.getSheetState(n,a),v=l.getActiveRange(),c=s.view.getSelectedSheets(n),S=g.Merge.getInfo(v.startRow,v.startCol),w=S&&v.equals(S),R="copy";if(!v.isSingle()&&!w){t.preventDefault();var C=new ZSClass.Range(v.startRow,v.startCol,v.startRow,v.endCol);e.UserAction.CalcFillDetails(i,c,r,l.getActiveRange(),C,!1,R)}}}function a(t,i,a,r){if(!t.repeat){var n=s.view.getActiveGridID(),i=s.view.getResourceID(n),a=s.view.getSheetID(n),o=s.data.getWorkBook(i,r),g=o.getSheetObj(a),l=s.view.getSheetState(n,a),v=l.getActiveRange(),c=s.view.getSelectedSheets(n),S=g.Merge.getInfo(v.startRow,v.startCol),w=S&&v.equals(S),R="copy";if(!v.isSingle()&&!w){t.preventDefault();var C=new ZSClass.Range(v.startRow,v.startCol,v.endRow,v.startCol);return e.UserAction.CalcFillDetails(i,c,r,l.getActiveRange(),C,!1,R),!1}}}var s=e.sPlusPlus,r=e.sPlusPlus.view.Events.Key,n=r.Entry.RangeEdit.Context,o=n.keyDown,g=e.ZSConstants.JSKeyCode;o[g.DELETE]=t,o[g.BACKSPACE]=t,o[g.SUPER+"+"+g.D]=i,o[g.CTRL+"+"+g.D]=i,o[g.SUPER+"+"+g.R]=a,o[g.CTRL+"+"+g.R]=a}(this);
!function(e){function t(e,t,r,i){f.publish(h.Selector.BoundUpdate.CellEdit,H.Selection.BOUND_UPDATE.REMOVE,{RID:t,SHEETID:r,VERSION:i}),f.publish(h.Selector.BoundUpdate.Cell,H.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:r,VERSION:i}),f.publish(h.Selector.BoundUpdate.Range,H.Selection.BOUND_UPDATE.SHOW,{RID:t,SHEETID:r,VERSION:i})}function r(e,t,r,i){f.publish(h.Gesture.Selector.CellEdit,H.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:r,VERSION:i,isSubmittable:1})}function i(e,t,r,i){f.publish(h.Gesture.Selector.CellEdit,H.GESTURE.ACTION.ENUMERATE,{RID:t,SHEETID:r,VERSION:i,isSubmittable:1,ISCSE:!0})}function n(){var e=U.view.CellEditor.getEditStatus();return e}function o(e,t,r,i){return!n(t,r,i)}function E(e,t,r,i){var n=U.data.getWorkBook(t,i),o=n.getSheetObj(r),E=U.view.getActiveGridID(),a=U.view.getSheetState(E,r),S=a.getActiveCellRange(),l=o.CheckBoxRanges;return l.isXists(S.startRow,S.startCol)}function a(t,r,i,n){var o,E=U.data.getWorkBook(r,n),a=E.getSheetObj(i),S=U.view.getActiveGridID(),l=U.view.getSheetState(S,i),s=U.view.getSelectedSheets(S),c=l.getActiveCellRange(),u=(a.CheckBoxRanges,function(e){o=e[c.startRow][c.startCol];var t="TRUE"===o.DisplayValue;N.CHECKBOX_EDIT(r,s,n,~~!t)}),R=function(t){e.ZSClass.Logger.log("Cell content couldn't be retrieved",t)},C=["DisplayValue"];U.view.fetchCellData(r,i,n,c.startRow,c.startCol,C,S,u,R)}function S(e,t,r,i){var n=e.keyCode||e.which,o=U.view.getActiveGridID(),E=U.view.getSelectedSheets(o);switch(n=n.toString()){case w.T:case w.Y:case w.ONE:N.CHECKBOX_EDIT(t,E,i,1);break;case w.F:case w.N:case w.ZERO:N.CHECKBOX_EDIT(t,E,i,0);break;case w.SPACE:a(e,t,E,i)}}function l(e,t,r,i){if(E(e,t,r,i))return S(e,t,r,i),void e.preventDefault();var o=n(t,r,i);if(!o){s(t,r,i);var a=e.keyCode||e.which;P=w.EQUAL!==a}return!1}function s(e,t,r){f.publish(h.Gesture.Selector.CellEdit,H.GESTURE.ACTION.ACTUATE,{RID:e,SHEETID:t,VERSION:r})}function c(t,r,i,n){t.preventDefault(),s(r,i,n);var o,E=U.view.getActiveGridID(),a=U.view.getSheetState(E,i),S=a.getActiveCellRange(),n=U.view.getVersionID(E),l=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],c=function(e){o=e[S.startRow][S.startCol],f.publish(h.Listener,H.CellAction.VALUE.SET,{RID:r,SHEETID:i,VERSION:n,ROW:S.startRow,COL:S.startCol,VALUE:o,FOCUS:!0})},u=function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)};return U.view.fetchCellData(r,i,n,S.startRow,S.startCol,l,E,c,u),P=!1,!1}function u(e){f.publish(h.Listener,H.ERROR.SHOW,{ERRORMSG:e})}function R(e,t,r,i){var n=U.data.getWorkBook(e,r),o=n.getSheetObj(t),E=n.ProtectedSheets.isSheetLocked(t),a=o.ProtectedRanges.isIntersecting(i);return E||a}function C(e,t,r,i){var n=U.data.getWorkBook(e,r),o=n.getSheetObj(t);return o.Pivot.isXists(i.startRow,i.startCol)}function g(e,t,r,i){var n=U.data.getWorkBook(e,r),o=n.getSheetObj(t),E=o.CheckBoxRanges.isXists(i.startRow,i.startCol);return E}function T(e,t,r,i){var n=R(e,t,r,i),o=C(e,t,r,i),E=g(e,t,r,i);if(n||o||E){var a=n?"ProtectedRange.alert.ProtectRangeMessage":o?"Error.Pivot.Table.Part.Change":E?"checkbox":"";return u(a),!1}return!0}function v(e,t,r,i){var o=n(t,r,i);o&&(P=!1);var E=U.view.getActiveGridID(),a=U.view.getSheetState(E,r),S=a.getActiveCellRange();return o||!T(t,r,i,S)?!1:c(e,t,r,i)}function I(e,t,i,o){var E=n(t,i,o);return!E&&(P=!1),N.flushSuggest(),E?r(e,t,i,o):D(e,t,i,o)}function d(e,t,r,i){var n=U.data.getWorkBook(e,r),o=n.getSheetObj(t),E=n.ProtectedSheets.isSheetLocked(t),a=o.ProtectedRanges.isIntersecting(i);return E||a}function D(e,t,r,i){if(!E(e,t,r,i)){var n=U.view.getActiveGridID(),o=U.view.getSheetState(n,r),a=o.getActiveRange(),S=o.getActiveCellRange();return!a.isSingle()&&!a.equals(S)||d(t,r,i,S)?!0:c(e,t,r,i)}}function A(e,t,i,o){var E=n(t,i,o);return N.flushSuggest(),E&&P?void r(e,t,i,o):!E}var P,U=e.sPlusPlus,O=e.ZSEvents,f=O.topic,h=O.Groups,H=O.Names,N=e.UserAction,w=e.ZSConstants.JSKeyCode,k=e.ZSClass,G=e.sPlusPlus.view.Events.Key,b=G.Entry.CellEditor.Context,F=b.keyDown;F[w.ESC]=t,F[w.CTRL+"+"+w.ENTER]=o,F[w.SUPER+"+"+w.A]=o,F[w.SUPER+"+"+w.C]=o,F[w.SUPER+"+"+w.V]=o,F[w.SUPER+"+"+w.X]=o,F[w.SHIFT+"+"+w.SPACE]=o,F[w.LEFT]=A,F[w.UP]=A,F[w.RIGHT]=A,F[w.DOWN]=A,F[w.SHIFT+"+"+w.LEFT]=A,F[w.SHIFT+"+"+w.UP]=A,F[w.SHIFT+"+"+w.RIGHT]=A,F[w.SHIFT+"+"+w.DOWN]=A,F[w.SUPER+"+"+w.LEFT]=A,F[w.SUPER+"+"+w.UP]=A,F[w.SUPER+"+"+w.RIGHT]=A,F[w.SUPER+"+"+w.DOWN]=A,F[w.SUPER+"+"+w.SHIFT+"+"+w.LEFT]=A,F[w.SUPER+"+"+w.SHIFT+"+"+w.UP]=A,F[w.SUPER+"+"+w.SHIFT+"+"+w.RIGHT]=A,F[w.SUPER+"+"+w.SHIFT+"+"+w.DOWN]=A,F[w.TAB]=r,F[w.SHIFT+"+"+w.TAB]=r,F[w.SUPER+"+"+w.SHIFT+"+"+w.ENTER]=i,F[w.CTRL+"+"+w.SHIFT+"+"+w.ENTER]=i,F[w.PURE_PRINTABLE_CHAR]=l,F[w.F2]=v,F[w.ENTER]=I,F[w.SHIFT+"+"+w.ENTER]=I,F[w.PAGEUP]=o,F[w.PAGEDOWN]=o,F[w.DELETE]=o,F[w.BACKSPACE]=o,F[w.F9]=o,f.register(h.Gesture.Selector.Range,H.GESTURE.ACTION.START,function(){!k.RangePicker.isSelection()&&G.focusContext(G.Entry.CellEditor.Context)}),f.register(h.Gesture.Selector.CellEdit,H.GESTURE.ACTION.DOWN,function(){P=!1}),G.focusContext(G.Entry.CellEditor.Context)}(this);
!function(t){function e(){return g.isSelection()}function n(t,e,n,r){T||(N.Init(e,n,r),T=!0)}function r(t,r,i,u){return e()?(t.preventDefault(),n(t,r,i,u),N.Left(r,i,u),!1):void 0}function i(t,r,i,u){return e()?(t.preventDefault(),n(t,r,i,u),N.Right(r,i,u),!1):void 0}function u(t,r,i,u){return e()?(t.preventDefault(),n(t,r,i,u),N.Up(r,i,u),!1):void 0}function o(t,r,i,u){return e()?(t.preventDefault(),n(t,r,i,u),N.Down(r,i,u),!1):void 0}function f(){T=!1}function v(t,e,r,i){f(t,e,r,i),n(t,e,r,i)}function l(t,n,r,i){return e()?(t.preventDefault(),N.ShiftLeft(n,r,i),!1):void 0}function S(t,n,r,i){return e()?(t.preventDefault(),N.ShiftRight(n,r,i),!1):void 0}function c(t,n,r,i){return e()?(t.preventDefault(),N.ShiftUp(n,r,i),!1):void 0}function D(t,n,r,i){return e()?(t.preventDefault(),N.ShiftDown(n,r,i),!1):void 0}function a(t,n,r,i){return e()?(t.preventDefault(),N.CtrlLeft(n,r,i),!1):void 0}function p(t,n,r,i){return e()?(t.preventDefault(),N.CtrlRight(n,r,i),!1):void 0}function d(t,n,r,i){return e()?(t.preventDefault(),N.CtrlUp(n,r,i),!1):void 0}function s(t,n,r,i){return e()?(t.preventDefault(),N.CtrlDown(n,r,i),!1):void 0}function R(t,n,r,i){return e()?(t.preventDefault(),N.CtrlShiftLeft(n,r,i),!1):void 0}function E(t,n,r,i){return e()?(t.preventDefault(),N.CtrlShiftRight(n,r,i),!1):void 0}function P(t,n,r,i){return e()?(t.preventDefault(),N.CtrlShiftUp(n,r,i),!1):void 0}function U(t,n,r,i){return e()?(t.preventDefault(),N.CtrlShiftDown(n,r,i),!1):void 0}var T,C=(t.sPlusPlus,t.ZSEvents),I=C.topic,h=C.Groups,H=C.Names,F=(t.UserAction,t.ZSConstants.JSKeyCode),L=t.ZSClass,g=L.RangePicker,N=g.KeyBoardApi,w=t.sPlusPlus.view.Events.Key,y=w.Entry.RangePicker.Context,O=y.keyDown,F=t.ZSConstants.JSKeyCode;I.register(h.Selector.BoundUpdate.CellEdit,H.Selection.BOUND_UPDATE.REMOVE,f),O[F.PURE_PRINTABLE_CHAR]=v,O[F.LEFT]=r,O[F.RIGHT]=i,O[F.UP]=u,O[F.DOWN]=o,O[F.SHIFT+"+"+F.LEFT]=l,O[F.SHIFT+"+"+F.RIGHT]=S,O[F.SHIFT+"+"+F.UP]=c,O[F.SHIFT+"+"+F.DOWN]=D,O[F.SUPER+"+"+F.LEFT]=a,O[F.SUPER+"+"+F.RIGHT]=p,O[F.SUPER+"+"+F.UP]=d,O[F.SUPER+"+"+F.DOWN]=s,O[F.SUPER+"+"+F.SHIFT+"+"+F.LEFT]=R,O[F.SUPER+"+"+F.SHIFT+"+"+F.RIGHT]=E,O[F.SUPER+"+"+F.SHIFT+"+"+F.UP]=P,O[F.SUPER+"+"+F.SHIFT+"+"+F.DOWN]=U}(this);
!function(s){function t(){l.publish(c.Listener,E.SheetAction.ZOOM.OnCustomInput)}var n=(s.sPlusPlus,s.sPlusPlus.view.Events.Key),e=n.Entry.Zoom.Context,o=e.keyDown,u=s.ZSConstants.JSKeyCode,i=s.ZSEvents,l=i.topic,E=i.Names,c=i.Groups;o[u.ENTER]=t,o[u.TAB]=t}(this);
!function(t){function e(t){t.preventDefault(),o.publish(u.Listener,r.DocAction.AlertMsg.TRIGGER_PRIMARY)}function n(t){t.preventDefault(),o.publish(u.Listener,r.DocAction.AlertMsg.TRIGGER_CLOSE)}var s=t.sPlusPlus,i=t.ZSEvents,o=i.topic,r=i.Names,u=i.Groups,c=s.view.Events.Key,l=c.Entry.Alert.Context,E=l.keyDown,R=t.ZSConstants.JSKeyCode;E[R.ENTER]=e,E[R.ESC]=n}(this);
!function(e){function t(e){e.preventDefault(),document.querySelector("#currPageIdx").blur()}var n=e.sPlusPlus,s=e.ZSEvents,r=(s.topic,s.Names,s.Groups,n.view.Events.Key),u=r.Entry.Print.Context,o=u.keyDown,c=e.ZSConstants.JSKeyCode;o[c.ESC]=t}(this);
!function(t){function n(){return!1}var s=t.sPlusPlus,e=t.ZSEvents,o=(e.topic,e.Names,e.Groups,s.view.Events.Key),i=o.Entry.Notification.Context,u=i.keyDown,r=t.ZSConstants.JSKeyCode;u[r.PURE_PRINTABLE_CHAR]=n}(this);
!function(e){function t(e){return e.preventDefault(),!1}function n(e){N.publish(I.Listener,c.CellAction.VALUE.FIND.QUICKFIND,{ev:e,isNext:!0})}function s(e){N.publish(I.Listener,c.CellAction.VALUE.FIND.QUICKFIND,{ev:e,isNext:!1})}function i(e){e.preventDefault(),N.publish(I.Listener,c.CellAction.VALUE.FIND.BLURQUICKFIND)}function o(e){e.preventDefault(),i(e),v.openDialog()}var u=e.sPlusPlus,l=e.ZSConstants,r=l.FeatureConstants,E=e.sPlusPlus.view.Events.Key,a=E.Entry.QuickFind.Context,C=a.keyDown,D=e.ZSConstants.JSKeyCode,F=e.ZSEvents,N=F.topic,c=F.Names,I=F.Groups,v=u.view.Toolbar.Feature[r.FIND];C[D.ENTER]=n,C[D.SHIFT+"+"+D.ENTER]=s,C[D.ESC]=i,C[D.SUPER+"+"+D.H]=o,C[D.SUPER+"+"+D.F]=t}(this);
!function(E){function S(){return!1}function T(E){return E.preventDefault(),E.stopPropagation(),R.publish(e.Listener,n.CellAction.COMMENT.UPDATE),!1}function P(){R.publish(e.Listener,n.CellAction.COMMENT.CANCEL)}var t=(E.sPlusPlus,E.ZSEvents),R=t.topic,e=t.Groups,n=t.Names,s=E.sPlusPlus.view.Events.Key,U=s.Entry.CellNote.Context,o=U.keyDown,H=E.ZSConstants.JSKeyCode;o[H.PURE_PRINTABLE_CHAR]=S,o[H.DELETE]=S,o[H.BACKSPACE]=S,o[H.SUPER+"+"+H.C]=S,o[H.SUPER+"+"+H.X]=S,o[H.SUPER+"+"+H.V]=S,o[H.LEFT]=S,o[H.RIGHT]=S,o[H.UP]=S,o[H.DOWN]=S,o[H.ENTER]=S,o[H.SHIFT+"+"+H.LEFT]=S,o[H.SHIFT+"+"+H.RIGHT]=S,o[H.SHIFT+"+"+H.UP]=S,o[H.SHIFT+"+"+H.DOWN]=S,o[H.SUPER+"+"+H.LEFT]=S,o[H.SUPER+"+"+H.RIGHT]=S,o[H.SUPER+"+"+H.UP]=S,o[H.SUPER+"+"+H.DOWN]=S,o[H.SUPER+"+"+H.SHIFT+"+"+H.LEFT]=S,o[H.SUPER+"+"+H.SHIFT+"+"+H.RIGHT]=S,o[H.SUPER+"+"+H.SHIFT+"+"+H.UP]=S,o[H.SUPER+"+"+H.SHIFT+"+"+H.DOWN]=S,o[H.SHIFT+"+"+H.ENTER]=S,o[H.SUPER+"+"+H.A]=S,o[H.ESC]=P,o[H.TAB]=T,o[H.SHIFT+"+"+H.TAB]=T,o[H.SUPER+"+"+H.ENTER]=T,o[H.SUPER+"+"+H.SHIFT+"+"+H.ENTER]=T}(this);
!function(e){function n(){clearTimeout(P),P=setTimeout(function(){h.publish(C.Listener,F.Layers.Ole.MoveEnd,{RID:H,SHEETID:w,VERSION:O,HELPER:U})},g)}function t(e,n,t,r){H=e,w=n,O=t,U=r,h.publish(C.Listener,F.Layers.Ole.Move,{RID:e,SHEETID:n,VERSION:t,HELPER:r})}function r(e,n,r,u){return e.preventDefault(),t(n,r,u,m),!1}function u(e,n,r,u){return e.preventDefault(),t(n,r,u,W),!1}function E(e,n,r,u){return e.preventDefault(),t(n,r,u,k),!1}function l(e,n,r,u){return e.preventDefault(),t(n,r,u,Z),!1}function i(e,n,r,u){return e.preventDefault(),t(n,r,u,J),!1}function f(e,n,r,u){return e.preventDefault(),t(n,r,u,j),!1}function s(e,n,r,u){return e.preventDefault(),t(n,r,u,q),!1}function o(e,n,r,u){return e.preventDefault(),t(n,r,u,z),!1}function D(e,n,r,u){return e.preventDefault(),t(n,r,u,Q),!1}function S(e,n,r,u){return e.preventDefault(),t(n,r,u,X),!1}function R(e,n,r,u){return e.preventDefault(),t(n,r,u,Y),!1}function I(e,n,r,u){return e.preventDefault(),t(n,r,u,$),!1}function a(e,n,t,r){return e.preventDefault(),h.publish(C.Listener,F.Layers.Ole.Delete,{RID:n,SHEETID:t,VERSION:r}),!1}function c(e,n,t,r){return e.preventDefault(),h.publish(C.Listener,F.Layers.Ole.SelectAll,{RID:n,SHEETID:t,VERSION:r}),!1}function p(e,n,t,r){return e.preventDefault(),h.publish(C.Listener,F.Layers.Ole.SelectNext,{RID:n,SHEETID:t,VERSION:r}),!1}function v(e,n,t,r){return e.preventDefault(),h.publish(C.Listener,F.Layers.Ole.SelectPrev,{RID:n,SHEETID:t,VERSION:r}),!1}function T(e,n,t,r){h.publish(C.Listener,F.Layers.Ole.Blur,{RID:n,SHEETID:t,VERSION:r});var u=y.view.Events.Key;u.focusContext(u.Entry.CellEditor.Context)}function L(){return!1}var P,H,w,O,U,y=e.sPlusPlus,N=e.ZSEvents,h=N.topic,C=N.Groups,F=N.Names,A=e.sPlusPlus.view.Events.Key,b=A.Entry.Ole.Context,V=b.keyDown,B=e.ZSConstants.JSKeyCode,d=ZSClass.Layer,x=d.Modules,G=x.Move,K=G.Helper,M=G.StickyHelper,g=500,m=new K(-10,0,n),W=new K(10,0,n),Z=new K(0,10,n),k=new K(0,-10,n),_={Left:0,Right:1,Up:2,Down:3},J=new M(_.Left,!1,n),j=new M(_.Right,!1,n),q=new M(_.Up,!1,n),z=new M(_.Down,!1,n),Q=new M(_.Left,!0,n),X=new M(_.Right,!0,n),Y=new M(_.Up,!0,n),$=new M(_.Down,!0,n);V[B.PURE_PRINTABLE_CHAR]=L,V[B.ESC]=T,V[B.SUPER+"+"+B.A]=c,V[B.DELETE]=a,V[B.BACKSPACE]=a,V[B.TAB]=p,V[B.SHIFT+"+"+B.TAB]=v,V[B.ENTER]=L,V[B.SHIFT+"+"+B.ENTER]=L,V[B.LEFT]=r,V[B.RIGHT]=u,V[B.UP]=E,V[B.DOWN]=l,V[B.SUPER+"+"+B.LEFT]=i,V[B.SUPER+"+"+B.RIGHT]=f,V[B.SUPER+"+"+B.UP]=s,V[B.SUPER+"+"+B.DOWN]=o,V[B.SUPER+"+"+B.SHIFT+"+"+B.LEFT]=D,V[B.SUPER+"+"+B.SHIFT+"+"+B.RIGHT]=S,V[B.SUPER+"+"+B.SHIFT+"+"+B.UP]=R,V[B.SUPER+"+"+B.SHIFT+"+"+B.DOWN]=I}(this);
!function(s){function t(s,t,n,i){e.publish(o.Listener,u.UserAction.BUTTONS.EDIT,{RID:t,SHEETID:n,VERSION:i})}var n=(s.sPlusPlus,s.ZSEvents),e=n.topic,o=n.Groups,u=n.Names,i=s.sPlusPlus.view.Events.Key,E=i.Entry.Button.Context,r=E.keyDown,S=s.ZSConstants.JSKeyCode;r[S.F2]=t}(this);
!function(t){function E(t,E,n,e){o.publish(U.Listener,I.UserAction.BUTTONS.CANCELEDIT,{RID:E,SHEETID:n,VERSION:e})}function n(t,E,n,e){o.publish(U.Listener,I.UserAction.BUTTONS.SUBMITEDIT,{RID:E,SHEETID:n,VERSION:e})}function e(t,E,e,T){return n(t,E,e,T),!1}function T(){return!1}function S(){var t=i.view.Events.Key;t.focusContext(t.Entry.ButtonEdit.Context)}function s(){var t=i.view.Events.Key;t.focusContext(t.Entry.Button.Context)}var i=t.sPlusPlus,r=t.ZSEvents,o=r.topic,U=r.Groups,I=r.Names,u=t.sPlusPlus.view.Events.Key,P=u.Entry.ButtonEdit.Context,R=P.keyDown,c=t.ZSConstants.JSKeyCode;R[c.ESC]=E,R[c.ENTER]=e,R[c.TAB]=n,R[c.SHIFT+"+"+c.TAB]=n,R[c.DELETE]=T,R[c.BACKSPACE]=T,R[c.SUPER+"+"+c.A]=T,R[c.SUPER+"+"+c.C]=T,R[c.SUPER+"+"+c.V]=T,R[c.SUPER+"+"+c.X]=T,R[c.SHIFT+"+"+c.SPACE]=T,R[c.LEFT]=T,R[c.RIGHT]=T,R[c.UP]=T,R[c.DOWN]=T,R[c.SHIFT+"+"+c.ENTER]=T,R[c.SUPER+"+"+c.LEFT]=T,R[c.SUPER+"+"+c.RIGHT]=T,R[c.SUPER+"+"+c.UP]=T,R[c.SUPER+"+"+c.DOWN]=T,R[c.SUPER+"+"+c.SHIFT+"+"+c.LEFT]=T,R[c.SUPER+"+"+c.SHIFT+"+"+c.RIGHT]=T,R[c.SUPER+"+"+c.SHIFT+"+"+c.UP]=T,R[c.SUPER+"+"+c.SHIFT+"+"+c.DOWN]=T,o.register(U.Listener,I.UserAction.BUTTONS.EDIT,S),o.register(U.Listener,I.UserAction.BUTTONS.CANCELEDIT,s),o.register(U.Listener,I.UserAction.BUTTONS.SUBMITEDIT,s)}(this);
!function(t){function e(){return!1}var n=t.sPlusPlus.view.Events.Key,T=n.Entry.SheetTab.Context,s=T.keyDown,E=t.ZSConstants.JSKeyCode;s[E.PURE_PRINTABLE_CHAR]=e,s[E.SUPER+"+"+E.A]=e,s[E.LEFT]=e,s[E.UP]=e,s[E.RIGHT]=e,s[E.DOWN]=e,s[E.ENTER]=e,s[E.SHIFT+"+"+E.LEFT]=e,s[E.SHIFT+"+"+E.UP]=e,s[E.SHIFT+"+"+E.RIGHT]=e,s[E.SHIFT+"+"+E.DOWN]=e}(this);
!function(e){function t(e,t,n){T=e,a=t,u=n}function n(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),n=A.view.getVersionID(e),i=A.view.getSelectedSheets(e);UserAction.FORMATCELLS_GRID(t,i,n,null,null,{formatType:"SCIENTIFIC",frmtAction:"generate",decimals:2,language:T+"("+a+")"})}function i(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),n=A.view.getVersionID(e),i=A.view.getSelectedSheets(e);UserAction.FORMATCELLS_GRID(t,i,n,null,null,{formatType:"DATETIME",frmtAction:"generate",format:E,language:T+"("+a+")"})}function r(){var e=A.view.getActiveGridID(),t=A.view.getResourceID(e),n=A.view.getVersionID(e),i=A.view.getSelectedSheets(e);UserAction.FORMATCELLS_GRID(t,i,n,null,null,{formatType:"DATETIME",frmtAction:"generate",format:c,language:T+"("+a+")"})}function o(e){if(e&&e[l.DATE]){e=e[l.DATE];var t=e[l.FORMAT_DATE],n=e[l.TIME];E=s(t[t.length-1]),c=s(n[n.length-2])}}function s(e){for(var t in e)return e[t]}var T,a,u,E,c,A=e.sPlusPlus,S=e.ZSEvents,g=S.topic,D=S.Groups,I=S.Names,l=e.ZSConstants.CommandConstants,v=e.ZSConstants.JSKeyCode,C=e.sPlusPlus.view.Events.Key,R=C.Entry.ShortCut.Context,f=R.keyDown;f[v.CTRL+"+"+v.SHIFT+"+"+v.TWO]=r,f[v.CTRL+"+"+v.SHIFT+"+"+v.THREE]=i,f[v.CTRL+"+"+v.SHIFT+"+"+v.SIX]=n,g.register(D.Listener,I.DocMeta.DOCUMENT_LOCALE,t,"LANGUAGE","COUNTRY","LOCALE_DATEFORMAT"),g.register(D.UI,I.Layout.DYNAMIC_DATA_RESPONSE,o,"RESPONSE"),g.register(D.Listener,I.DocMeta.DOC_SETTINGS,o,"DOC_SETTINGS")}(this);
!function(e){function t(e,t,n,r){r!==j&&(r?B.setStyle({},[]):D(e,t,n,B.range),j=r)}function n(){var e=K.view.getActiveGridID(),n=K.view.getResourceID(e),r=K.view.getSheetID(e),i=K.view.getVersionID(e);C();var o=K.view.CellEditor.getValue();t(n,r,i,B.valueCheck(o)),X.publish(z.Listener,q.FormulaBar.UPDATE,{VALUE:{Formula:o}}),X.publish(z.Listener,q.FormulaBar.Dialog.Update,{value:o}),B.adjustDimensions(n,r,i)}function r(e){var t=[",",";","+","-","*","/","%","&","^","<",">","<=",">="," "];e=e.contains(")")?e.replace(new RegExp("\\)","gi"),""):e;for(var n=0;n<t.length;n++){var r=t[n];if(e.contains(r))return e=e.substring(e.lastIndexOf(r)+1)}return e}function i(e,t){e&&(M=e,k=t)}function o(e,t){e.preventDefault(),e.stopPropagation();var n=this.selectionStart,r=this.selectionEnd,i=this.value,o=i.substring(0,n),s=i.substring(r,i.length);this.value=o+t+s;var a=(o+t).length;this.setSelectionRange(a,a),this.valueChanged();var l=K.view.getActiveGridID(),u=K.view.getResourceID(l),c=K.view.getSheetID(l),g=K.view.getVersionID(l);B.adjustDimensions(u,c,g)}function s(t){var n=J.Key.getKeyCombination(t);switch(n){case it.ENTER:case it.SHIFT+"+"+it.ENTER:case it.SUPER+"+"+it.SHIFT+"+"+it.ENTER:case it.CTRL+"+"+it.SHIFT+"+"+it.ENTER:return t.preventDefault(),!0;case it.LEFT:case it.UP:case it.RIGHT:case it.DOWN:case it.SHIFT+"+"+it.LEFT:case it.SHIFT+"+"+it.RIGHT:case it.SHIFT+"+"+it.UP:case it.SHIFT+"+"+it.DOWN:case it.SUPER+"+"+it.SHIFT+"+"+it.LEFT:case it.SUPER+"+"+it.SHIFT+"+"+it.RIGHT:case it.SUPER+"+"+it.SHIFT+"+"+it.UP:case it.SUPER+"+"+it.SHIFT+"+"+it.DOWN:case it.ALT+"+"+it.LEFT:case it.ALT+"+"+it.RIGHT:if(nt.isSelection()){var r=e.sPlusPlus.view.Events.Key;return r.focusContext(r.Entry.RangePicker.Context),!0}}}function a(){X.register(z.Listener,q.GridAction.WheelXYPaneContainerScroll,u,"RID","SHEETID","VERSION"),X.register(z.Listener,q.DocAction.WORKSHEETS.SWITCHSHEET,c,"RID","NEWSHEETID","VERSION")}function l(){X.unregister(z.Listener,q.GridAction.WheelXYPaneContainerScroll,u),X.unregister(z.Listener,q.DocAction.WORKSHEETS.SWITCHSHEET,c)}function u(e,t,n){var r=(K.view.CellEditor.getEditCell(),g(e,t,n));B.showLabel(r)}function c(e,t,n){var r=g(e,t,n);B.showLabel(r)}function g(e,t,n){var r=K.view.CellEditor.getEditCell(),i="";if(r){if(r.getRID()!==e||r.getSheetID()!==t||r.getVersion()!==n){var o=K.data.getWorkBook(e,n),s=o.getSheetObj(r.getSheetID()),i=s.Prop.Name;i=(/[-\s]/.test(i)?"'"+i+"'":i)+"."}var a=r.getCell(),l=new $.Range(a.startRow,a.startCol,a.startRow,a.startCol);return i+l.getLabel()}}function E(t,n,r,i){var o,s=K.view.getActiveGridID(),r=K.view.getVersionID(s),a=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],l=function(e){o=e[i.startRow][i.startCol]},u=function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)};return K.view.fetchCellData(t,n,r,i.startRow,i.startCol,a,s,l,u),!(!o||!o.styleName||"wrap"!==o.styleName[8])}function S(e,t,n,r){B.turnOn();var i=K.data.getWorkBook(e,n),o=(i.getSheetObj(t),E(e,t,n,r));v(e,t,n,r,o),D(e,t,n,r),a(),setTimeout(function(){var e=B.getValue(),t=B.selectionStart;X.publish(z.Listener,q.CellAction.CELLSUGGESTION.GET,{VALUE:e,SELCTIONPOS:t})},0)}function v(e,t,n,r,i){var o=K.data.getWorkBook(e,n),s=o.getSheetObj(t),a=r.startRow,l=r.startCol,u=r.endRow,c=r.endCol,g=L(s,a,s.Row.auxiliaryAxis.getPos(a)),E=h(s,l,s.Column.axis.getPos(l)),S=h(s,c,s.Column.axis.getPos(c+1))-E,v=L(s,u,s.Row.auxiliaryAxis.getPos(u+1))-g,D=St-E,C=vt-g;B.place(r,E,g,S,v,i?S:D,C),Dt.suggest(B.value)}function D(t,n,r,i){var o,s=K.view.getActiveGridID(),a=K.data.getWorkBook(t,r),l=a.getSheetObj(n),u=K.view.getSheetState(s,n),r=K.view.getVersionID(s),c=["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","ConditionalFormat"],g=function(e){o=e[i.startRow][i.startCol];var t=o.Format||l.ColStyleNames.getStyle(i.startCol)||"Default";t=a.CellStyle.getStyleDef(t),t=J.Object.clone(t,!0),t=$.CellDecorator.getStyle(t,o),B.setStyle(o,t);var n=u.getZoom();B.setZoom(n)},E=function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)};K.view.fetchCellData(t,n,r,i.startRow,i.startCol,c,s,g,E)}function C(){K.view.CellEditor.setValue(B.getValue())}function d(){C(),B.turnOff(),j=void 0,at=!1,document.activeElement.blur(),Dt.flush(),l()}function I(e,n,r,i,o,s,a){var l=K.data.getWorkBook(e,r),u=l.getSheetObj(n);if(!B.inView){var c=new $.Range(i,o,i,o),g=E(e,n,r,c);v(e,n,r,c,g),D(e,n,r,c),B.show()}var S=s?s.Formula||s.DisplayValue:B.getValue(),C=u.ArrayFormula.isXists(i,o);if(C&&0==S.indexOf("{=")&&(S=S.substr(1,S.length-2)),K.view.CellEditor.setValue(S),B.setValue(S),Dt.suggest(""),t(e,n,r,B.valueCheck(S)),B.adjustDimensions(e,n,r),a){var d=S.length;B.setSelectionRange(d,d),B.valueChanged(),B.selectionChanged()}}function R(e,n,r,i,o){K.view.CellEditor.setValue(i),B.setValue(i),t(e,n,r,B.valueCheck(i)),B.adjustDimensions(e,n,r),B.setSelectionRange(o,i.length),B.selectionChanged(),X.publish(z.Listener,q.FormulaBar.UPDATE,{VALUE:{Formula:i}})}function f(e){return e.getScreenHeights()[1]}function A(e){return e.getScreenWidths()[1]}function h(e,t,n){var r=K.view.getActiveGridID(),i=K.view.getSheetID(r),o=K.view.getSheetState(r,i);n*=o.getZoom();var s=A(o),a=e.Column.FreezedCount,l=n-(a>t?o.getScrollLefts()[1]:o.getScrollLefts()[0]-s);return l}function T(){ct.flush()}function L(e,t,n){var r=K.view.getActiveGridID(),i=K.view.getSheetID(r),o=K.view.getSheetState(r,i);n*=o.getZoom();var s=f(o),a=e.Row.FreezedCount,l=n-(a>t?o.getScrollTops()[1]:o.getScrollTops()[0]-s);return l}function w(e){Dt.addEntries(e),Dt.suggest(at?B.value:"")}function N(e){O(B,e.text,!0,!1,!0),_.flush()}function m(e){O(B,e.text,!1,!1,!1),_.flush()}function O(e,t,n,r,i){var o=r?"_"+t:t,s=e.value,a=e.selectionStart,l=e.selectionEnd,u=V(s,a,l),c=s.substring(0,u.start),g=s.substring(u.end,s.length),E=n?!!g[0]&&"("===g[0]:!0,S=c+o+(E?"":"(")+g,v=n?1:0,D=u.start+o.length+v;if(e.value=S,e.setSelectionRange(D,D),U(e.Editor,"input"),U(e.Editor,"selectionChanged"),i){var C="Functions",d=W.getCategory(C);r?ct.delugeHelp(t):ct.constructHelp(t,d)}}function V(e,t,n){{var r=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=e.substring(0,t),o=e.substring(n,e.length),s=t-i.split(r).pop().length,a=n+o.split(r)[0].length;e.substring(0,s),e.substring(a,e.length)}return{start:s,end:a}}function U(e,t){var t=new Event(t);e.dispatchEvent(t)}function F(e){_.flush(),O(B,e.text,!0,!0,!0)}function p(e,t,n,r,i){return e.title=r,e.innerText=n,"Functions"==i?e.classList.add("shIconBefore","shSuggestFx"):"Deluge"==i?e.classList.add("shIconBefore","shSuggestDlg"):"NamedRange"==i&&e.classList.add("shIconBefore","shSuggestDfName"),e.addEventListener("mousedown",function(e){t.onInsert(t),e.preventDefault(),e.stopPropagation()}),e}function y(e,t,n){var r="Deluge",i=W.getCategory(r),o=n[0],s=n[2];s||(s=ot["Deluge.DefaultDescription"]);var a=document.createElement("div"),l=new $.AutoSuggest.FormulaEntry(a,o,o,F);p(a,l,o,s,r),i.addEntry(o,l)}function G(e,t,n){for(var r=0;r<n.length;r++)y(e,t,n[r])}function H(e,t,n){for(var r="Deluge",i=W.getCategory(r),o=0;o<n.length;o++)i.deleteEntry(n[o])}function P(e,t,n){for(var r=0;r<t.length;r++)b(e,t[r],n)}function b(e,t){var n="NamedRange",r=W.getCategory(n),i=t[0],o=t[2],s=J.FormRange(o),a=document.createElement("div"),l=new $.AutoSuggest.FormulaEntry(a,i,i,m),a=p(a,l,i,"Refers to "+s,n);a.addEventListener("mouseover",function(){var e=J.FormRange(o);a.setAttribute("title","Refers to "+e)}),r.addEntry(i,l)}function x(e,t){for(var n="NamedRange",r=W.getCategory(n),i=0;i<t.length;i++)r.deleteEntry(t[i][0])}var M,k,_,B,W,Z,j,K=e.sPlusPlus,Y=e.ZSEvents,J=e.JSUtil,X=Y.topic,z=Y.Groups,q=Y.Names,Q=K.view.measures,$=e.ZSClass,et=($.Range,$.CellEditor),tt=document.querySelector(".sheetPaneContainer"),nt=$.RangePicker,rt=nt.register,it=e.ZSConstants.JSKeyCode,ot=e.ZSConstants.I18N,st={valueChanged:n,focus:function(){var t=e.sPlusPlus.view.Events.Key;t.focusContext(t.Entry.CellEditor.Context)},keydown:function(e){if(57==e.keyCode){var t,n=B.getValue(),i="Functions",s=W.getCategory(i),a="Deluge",l=W.getCategory(a);if(n&&n.startsWith("=")){t=n.substring(n.contains("(")?n.lastIndexOf("(")+1:1),t=r(t),t=t.trim();var u=s.getEntry(t.toUpperCase());if(u)O(B,u.text,!1,!1,!0);else{var c=l.getEntry(t.toUpperCase());c&&O(B,c.text,!1,!0,!0)}}}var g=J.Key.getKeyCombination(e);switch(g){case it.SUPER+"+"+it.SEMICOLON:var E=J.Date.currentDate(k,M);o.call(B,e,E);break;case it.SUPER+"+"+it.SHIFT+"+"+it.SEMICOLON:var S=J.Date.currentTime();o.call(B,e,S);break;case it.SUPER+"+"+it.ALT+"+"+it.SEMICOLON:var v=J.Date.currentDate(k,M)+" "+J.Date.currentTime();o.call(B,e,v);break;case it.PURE_PRINTABLE_CHAR:B.addListeners(lt)}},input:function(){at=!0}},at=!1,lt={valueChanged:function(){var e=B.getValue(),t=B.selectionStart;X.publish(z.Listener,q.CellAction.CELLSUGGESTION.GET,{VALUE:e,SELCTIONPOS:t}),B.removeListeners(lt)}};X.register(z.Listener,q.DocMeta.DOCUMENT_LOCALE,i,"DATE_SEPARATOR","LOCALE_DATEFORMAT"),B=new et(tt,st),rt(B,!1,!1,0,!0),B.customPreventDefault=s,$.InsertFunction.register(B);var ut={active:29,inActive:29,container:202};_=new $.AutoSuggest.Formulaselector(B.SuggestContainer,ut);var W=new $.AutoSuggest.Formula(B.SuggestContainer,B,_),ct=new $.AutoSuggest.SuggestToolTip(B.ToolTipContainer,B),gt="Functions",Et=W.getCategory(gt);X.register(z.Listener,q.DocAction.FUNCTIONS.FETCH,function(){W.flush(Et),Z=ZSConstants.Function.functions;for(var e in Z){var t=Z[e],n=document.createElement("div"),t=Z[e],r=t[0],i=new $.AutoSuggest.FormulaEntry(n,e,r,N),o=t[2];p(n,i,r,o,gt),Et.addEntry(r,i)}},"JSON");var St,vt,Dt=new $.AutoSuggest.DataValidation({editor:B,container:B.SuggestContainer,height:{active:29,inActive:29,container:152},scrollLimit:50,onScroll:function(){X.publish(z.Listener,q.UserAction.DATA_VALIDATION.GET_SCROLL_LIST)},onInsert:function(e){{var t=K.view.getActiveGridID(),n=(K.view.getResourceID(t),K.view.getSheetID(t),K.view.getVersionID(t),e.text);K.view.CellEditor.getEditCell()}K.view.CellEditor.setValue(n),Dt.flush()},onMouseInsert:function(e){var t=K.view.getActiveGridID(),n=K.view.getResourceID(t),r=K.view.getSheetID(t),i=K.view.getVersionID(t),o=e.text,s=K.view.CellEditor.getEditCell();K.view.CellEditor.setValue(o),setTimeout(function(){X.publish(z.Gesture.Selector.CellEdit,q.GESTURE.ACTION.ENUMERATE,{RID:n,SHEETID:r,VERSION:i,isSubmittable:0})},0),UserAction.SubmitCell(s.getRID(),[s.getSheetID()],s.getVersion(),o,s.getRow(),s.getCol(),!1),Dt.flush()}});X.register(z.Listener,q.Browser.ScreenViewport,function(e,t){vt=e-(Q.Grid.ColHeader+Q.Grid.HScrollBar+Q.Bottom.sheetTabsBar),St=t-(Q.Grid.RowHeader+Q.Grid.VScrollBar)},"Height","Width"),e.UserAction.flushSuggest=T,X.register(z.Listener,q.DocAction.DELUGE_FUNCTIONS.INSERT,y,"RID","VERSION","DELUGE"),X.register(z.Listener,q.DocAction.DELUGE_FUNCTIONS.REMOVE,H,"RID","VERSION","DELUGE"),X.register(z.Listener,q.DocMeta.DELUGE_FUNCTIONS,G,"RID","VERSION","DELUGE"),X.register(z.Listener,q.DocMeta.NAMED_RANGE,P,"RID","NAMEDRANGE","VERSION"),X.register(z.Listener,q.DocAction.NAMED_RANGE.ADD,P,"RID","NAMEDRANGE","VERSION"),X.register(z.Listener,q.DocAction.NAMED_RANGE.REMOVE,x,"RID","NAMEDRANGE","VERSION"),X.register(z.Listener,q.DocMeta.NAMED_RANGE,P,"RID","NAMEDRANGE","VERSION"),X.register(z.Selector.DomUpdate.CellEdit,q.Selection.BOUND_UPDATE.ADD,S,"RID","SHEETID","VERSION","ActiveRange"),X.register(z.Selector.DomUpdate.CellEdit,q.Selection.BOUND_UPDATE.MODIFY,S,"RID","SHEETID","VERSION","ActiveRange"),X.register(z.Selector.DomUpdate.CellEdit,q.Selection.BOUND_UPDATE.REMOVE,d),X.register(z.Listener,q.CellAction.VALUE.SET,I,"RID","SHEETID","VERSION","ROW","COL","VALUE","FOCUS"),X.register(z.Listener,q.CellAction.CELLSUGGESTION.ADD,R,"RID","SHEETID","VERSION","VALUE","POS"),X.register(z.Listener,q.UserAction.DATA_VALIDATION.SHOW_LIST,w,"LIST_ARRAY")}(this);
!function(t){{var s=t.sPlusPlus;t.ZSConstants.FeatureConstants}s.view.Statusbar.Skeleton={CHAT_BAR:[],NOTIFY_BAR:[],FEATURE_BAR:["FULLSCREEN","GRIDZOOM","KEYBOARDSHORTCUT","VIEW_SETTINGS","AGGREGATEFUNCTION"]}}(this);
!function(e){{var a=e.sPlusPlus,t=e.ZSEvents,s=(t.topic,t.Groups,t.Names,e.ZSClass,e.document);s.body}a.view.measures.Bottom.bottomBand=0,a.view.featureBar={},a.view.featureBar.ephemerals={},a.view.notifyBar={},a.view.notifyBar.ephemerals={};var r=function(){var e=s.createElement("div");e.className="statusBar"};r()}(this);
!function(t){function i(t){void 0==t?n.alert("Error","ID Mandatory"):(this.id=t,this.div=s.createElement("div"),o[this.id]=this)}var e=t.sPlusPlus,n=t.ZSDevTools.Logger,s=t.document,d=s.getElementById("SHEET_SB_CONTAINER"),r=e.view.Statusbar.Skeleton.FEATURE_BAR,o={};i.prototype={add:function(){var t=r.indexOf(this.id);if(-1!=t){var i=(r[t+1],this.getNextFeatureElement());i?d.insertBefore(this.div,i):d.appendChild(this.div)}},remove:function(){d.removeChild(this.div)},show:function(){this.div.style.display="initial"},hide:function(){this.div.style.display="none"},getNextFeatureElement:function(){for(var t=r.indexOf(this.id),i=t+1;i<r.length;i++)if(o[r[i]])return o[r[i]].div;return null}},t.ZSClass.SBFeature=i}(this);
!function(t){function n(){}var o=t.ZSClass,e=t.ZSDevTools.Logger;n.prototype={createElement:function(){e.error("Button Creation ::::",this)},createMenuElement:function(){e.error("Menu Creation ::::",this)},execute:function(){e.error("Action Execution ::::",this)},openDialog:function(){e.error("Open Dialog Called ::::",this)},contextMenu:function(){e.error("Context Menu Action  ::::",this)},shortCut:function(){e.error("ShortCut Execution ::::",this)},quickAction:function(){e.error("QuickAction Execution ::::",this)}},o.FEATURE=n}(this);
!function(e){function i(e){s=r.createElement("div"),s.className="chatBarMedian ui-individual-icon ui-icon-zaddcomment",s.addEventListener("click",t),e.appendChild(s),n.view.measures.Bottom.chatBar=25}function t(){{var e=n.view.getActiveGridID();n.view.getResourceID(e),n.view.getSheetID(e),n.view.getVersionID(e)}return c.publish(o.Listener,v.ERROR.SHOW,{ERRORMSG:"ErrorMsg.YetToImplement"}),!1}var s,n=e.sPlusPlus,r=e.document,a=e.ZSConstants,u=(a.wCC,sPlusPlus.view.measures,e.ZSEvents),c=u.topic,o=u.Groups,v=u.Names;n.view.notifyBar.ephemerals.CHATMEDIAN=i}(this);
!function(e){function o(){ZSClass.KeyMapping.call(this)}function t(){d.initFcomponents(),l.focusContext(l.Entry.Dialog.Context),p||(d.bind("#zfeedbackDialog","zdialogclose",function(){l.focusContext(l.Entry.CellEditor.Context)}),p=!0);var e=i.SupportMailId;ZFeedback.open({formType:"feedback",sendTo:e,allowToAnnotateImages:!1})}function n(){var e=(i.ReportTheError,"websheet-issues@zohocorp.com"),o=a.data.UserInfo.zuid,t=a.view.getActiveGridID(),n=a.view.getResourceID(t),r=s.domain,d=window.location.pathname,c="....",l="...",p=a.data.AppRegistry.buildVersion,u="..",c="..",C="..",f="..",m=o+" - "+r+" [ "+p+" ] - "+n+" [ "+d+" ] - "+u+" [ "+l+" ] - [ "+c+" ] ["+C+" ] ["+f+" ]",v={"Other details":m};ZFeedback.open({sendTo:e,customHeaders:v})}var s=e.document,i=e.ZSConstants.I18N,a=e.sPlusPlus,r=e.ZSEvents,d=(r.topic,r.Groups,r.Names,e.UIUtil.Component),c=new o,l=a.view.Events.Key;l.Entry.Dialog.Node.addChildNode(c),d.addFComponentsFiles();var p=!1;a.view.Toolbar.transient[e.ZSConstants.ActionConstants.FEEDBACK]=t,UserAction.showFeedbackDialog=t,UserAction.reportError=n}(this);
!function(e){function i(){var e=s.view.getActiveGridID(),i=s.view.getResourceID(e),r=s.view.getVersionID(e);t.doRedirect(i,r)}var s=e.sPlusPlus,t=(e.ZSClass,e.UserAction);e.ZSClass.Redirect=i}(this);
!function(t){function e(t,e,n,p,h){var m=u.data.getWorkBook(t,p),v=m.getSheetObj(e),y=s();for(var C in h){var f=l(),g=h[C];for(var b in g){var S=g[b],x=o(S),A=a(t,e,p,S,b),T=i();if(S.Hyperlink){var w=r(x,S.Hyperlink);T.appendChild(w)}else T.innerText=x;var D=d(v,C,b);c(t,e,n,p,C,b,T,f,A,S,D)}y.appendChild(f)}return y}function r(t,e){var r=n(t),o=v.cloneNode(!0);return o.setAttribute("href",e),o.appendChild(r),o.style.textDecoration="underline",o}function n(t){return document.createTextNode(t)}function o(t){return t.DisplayValue||" "}function a(t,e,r,n,o){var a=u.data.getWorkBook(t,r),l=a.getSheetObj(e),i=n.Format?n.Format:l.ColStyleNames.getStyle(o)?l.ColStyleNames.getStyle(o):"Default",s=JSUtil.Object.clone(a.CellStyle.getStyleDef(i),!0);return s=p.CellDecorator.getStyle(s,n)}function l(){return y.cloneNode(!0)}function i(){return C.cloneNode(!0)}function s(){return m.style.borderCollapse="collapse",m.setAttribute("source",h.ZOHOSHEET_COPY_SRC),m.cloneNode(!0)}function c(e,r,n,o,a,l,i,s,c,d,p){var h=u.data.getWorkBook(e,o),m=h.getSheetObj(r),v=m.Merge.isXists(parseInt(a),parseInt(l));if(v&&v.isRoot){var y=v.root.getRowSpan(),C=v.root.getColSpan();i.setAttribute("rowspan",y),i.setAttribute("colspan",C);for(var f=0,g=0,b=v.root,S=b.startRow;S<=b.endRow;S++){v.root.getRowSpan()>1?f+=h.getSheetObj(r).Row.auxiliaryAxis.getDim(parseInt(S)):v.root.getColSpan()>1&&(f=h.getSheetObj(r).Row.auxiliaryAxis.getDim(parseInt(S))),g=0;for(var x=b.startCol;x<=b.endCol;x++)(v.root.getRowSpan()>1||v.root.getColSpan()>1)&&(g+=h.getSheetObj(r).Column.axis.getDim(parseInt(x)))}i.style.height=f+"px",i.style.width=g+"px",t.UserAction.applyCellStyle(e,r,n,o,c,i,d.CellType,p),s.appendChild(i)}v||(t.UserAction.applyCellStyle(e,r,n,o,c,i,d.CellType,p),i.style.height=h.getSheetObj(r).Row.auxiliaryAxis.getDim(parseInt(a))+"px",i.style.width=h.getSheetObj(r).Column.axis.getDim(parseInt(l))+"px",s.appendChild(i))}function d(t,e,r){var n=t.CheckBoxRanges;return n.isXists(parseInt(e),parseInt(r))}var u=t.sPlusPlus,p=t.ZSClass,h=(u.view.Defaults.fontMap,t.ZSConstants.wCC),m=document.createElement("table"),v=document.createElement("a"),y=document.createElement("tr"),C=document.createElement("td");t.UserAction.TableGeneratorUtility=e}(this),function(t){function e(t,e,r){this.parent=t,this.options=e,this.pattern=r,n.call(this),this.parseArray()}function r(){var t=document.querySelector("#tbody"),e=document.querySelector("#thead");e.scrollLeft=t.scrollLeft}function n(){var t=document.createDocumentFragment();this.table=o(),t.appendChild(this.table),this.parent.appendChild(t)}function o(){var t=d.cloneNode(!1);return t}function a(t,e,r,n){var o="number"==typeof e?e:n.target.cellIndex,a=t.querySelectorAll("tr");0!=t.querySelectorAll(".zTActive").length&&s(o,t);for(var l=1;l<a.length;l++){var i=a[l].children[o];i.classList.add("zTCell")}"number"!=typeof e&&null!=r&&e(o,r)}function l(t,e,r,n){e.style.opacity?(i(r,"remove",n,u),u=n):i(r,"add",1,n),t(n)}function i(t,e,r,n){for(var o=r;n>o;o++){for(var a=t.querySelectorAll("tr")[o],l=a.querySelectorAll("td"),i=0;i<l.length;i++)"add"==e?l[i].style.opacity="0.4":l[i].style.removeProperty("opacity");u=n}}function s(t,e){for(var r=e.querySelectorAll(".zTActive"),n=0;n<r.length;n++){var o=r[n];"zTActive"==o.className&&(o.removeClass="zTActive",o.className="zTCell")}}function c(t){var e=t.map(function(t){return t.length});return Math.max.apply(Math,e)}{var d=document.createElement("table"),u=(document.createElement("th"),0),p=(ZSConstants.I18N,t.sPlusPlus),h=ZSConstants.FeatureConstants;p.view.Toolbar.Feature[h.TEXT_TO_COLUMN]}e.prototype={parseArray:function(){{var t=this.pattern,e=c(t),n=t.length;this.options.colHeader?this.options.colHeader:void 0}this.table.classList.add("txtColtable");var o=document.createElement("thead");o.setAttribute("id","thead"),o.classList.add("txtColthead"),this.table.appendChild(o);for(var a=o.insertRow(-1),i=[],s=[],d=0;e>d;d++){var u=document.createElement("TH");u.setAttribute("index",d);var p=document.createElement("span");p.innerText="General";var h=document.createElement("i");h.id="dropDownArrowID",h.setAttribute("data-menu-id","TTCtype"),h.className="txtColTheadDownArrow",u.appendChild(p),u.appendChild(h),u.classList.add("txtColTDTH"),u.style.height=this.options.height+"px",i.push(u),a.appendChild(u)}var m=document.createElement("tbody");m.setAttribute("id","tbody"),m.classList.add("txtColtbody"),this.table.appendChild(m),m.addEventListener("mousewheel",r),m.addEventListener("scroll",r);for(var d=0;n>d;d++)for(var v=m.insertRow(-1),y=0;e>y;y++){var C=v.insertCell(-1);C.innerText=void 0!=t[d][y]?t[d][y]:"",this.options.rowClick&&C.addEventListener("click",l.bind(null,this.options.rowClick,C,this.table,v.rowIndex)),C.className="zTCell txtColTDTH",C.style.minWidth=this.options.width+"px",C.style.height=this.options.height+"px",0==d&&s.push(C)}for(var f=0;e>f;f++){var g=s[f].clientWidth;i[f].style.minWidth=g-10+"px"}},setActiveCol:function(t){a(this.table,t,null,null)},setStartRow:function(t){t>=u?i(this.table,"add",1,t):(i(this.table,"remove",t,u),u=t)},resetTempValue:function(){u=0}},t.UserAction.ZSTable=e}(this);
!function(t){function e(t,e,s,d,f,y,b,h){var v=p.data.Defaults.VIEW;y.style.backgroundColor=f[0],y.style.color=f[1],y.style.fontSize=n(f[2]),y.style.fontFamily=r(f[3]),y.style.fontWeight=f[4],y.style.fontStyle=f[5],y.style.textDecoration=o(f[6],f[7]),y.style.textAlign=i(f[9],b),y.style.verticalAlign=a(f[10]),y.style.padding="0px 2px",v===p.data.View.COMFORT&&(y.style.padding="2px 4px"),l(t,e,s,d,f[11],y),c(f[8],y),u(h,b,y)}function n(t){return t?t+"pt":"10pt"}function r(t){return f&&f[t]&&(t=f[t]),t}function o(t,e){var n="";return"solid"==t&&"solid"==e?n="line-through underline":"solid"==t?n="line-through":"solid"==e&&(n="underline"),n}function i(t,e){var n;switch(t){case"start":n="left";break;case"center":n="center";break;case"end":n="right";break;default:("FLOAT"===e||"NUMBER"===e||"PERCENTAGE"===e||"CURRENCY"===e||"DATE"===e||"TIME"===e||"DATETIME"===e||"FRACTION"===e||"SCIENTIFIC"===e||"BOOLEAN"===e||"SSN"===e||"ZIPCODE"===e||"ZIPCODE4"===e||"PHONENUMBER"===e)&&(n="right")}return n}function a(t){var e;switch(t){case"vtop":case"top":e="top";break;case"vcenter":case"middle":e="middle";break;case"vbottom":case"bottom":e="bottom";break;default:e="top"}return e}function l(t,e,n,r,o,i){for(var a=p.data.getWorkBook(t,r),l=a.getSheetObj(e),d=p.view.getSheetState(n,e),c="solid "+l.Border_Size+"px #D5D5D5",u="solid "+l.Border_Size+"px transparent",f=o.length-1,y=0;f>=y;y++){var b=s(l,d,i,o[y],c,u);0===y?0===f?(i.style.borderLeft=b,i.style.borderRight=b,i.style.borderTop=b,i.style.borderBottom=b):i.style.borderLeft=b:1===y?i.style.borderRight=b:2===y?i.style.borderTop=b:3===y&&(i.style.borderBottom=b)}}function s(t,e,n,r,o,i){var a,l=d(r,o),s=!t.IsShowGrid,c=e.getZoom();if(l.contains("in")||l.contains("pt")){var u=l.split(" ");for(var p in u)if(u[p].contains("in")||u[p].contains("pt"))var f=u[p];var y=parseFloat(f),b=(y/c).toFixed(3)+(l.contains("in")?"in":"pt");l=l.replace(f,b)}return a=""!==l&&"none"!==l?"transparent"===l?i:l:s?"":o}function d(t,e){return t.contains("double-thin")?t=t.replace("double-thin","double"):(t.contains("dash-dot-dot")||t.contains("dash-dot")||t.contains("fine-dashed"))&&(t=e),t}function c(t,e){"wrap"!==t&&(e.style.overflow="hidden",e.noWrap="true")}function u(t,e,n){if(t){var r=document.createElement("input");r.setAttribute("type","checkbox");var o=n.innerText;"TRUE"==o&&r.setAttribute("checked",!0),n.style.verticalAlign="middle",n.style.textAlign="center",n.innerText="",n.appendChild(r)}}var p=t.sPlusPlus,f=(t.ZSClass,p.view.Defaults.fontMap);t.UserAction.applyCellStyle=e}(this);
!function(e){function t(t,o,a,d,c,p){for(var u,C=s.data.getWorkBook(t,c),v=C.getSheetObj(o),y=v.Row,f=v.Column,g={},b=!1,h=0;h<p.length;h++){var m=p[h],w=m.startRow,A=m.startCol,R=m.endRow,x=m.endCol,H=s.view.getGridComponent(a).isInViewPort(m);if(!H){b=!0;break}for(var U=w;R>=U;U=y.Visibility.nextNonHidden(U)){g[U]||(g[U]={});for(var T=A;x>=T;T=f.hidden.nextNonHidden(T)){var E=s.view.getGridComponent(a).getCellRef(t,o,c,U,T);g[U][T]=E.data}}}b?n(t,d,c,void 0,!1,!1):(u=e.UserAction.TableGeneratorUtility(t,o,a,c,g),l.innerHTML="",l.appendChild(u),i(),r(),l.blur(),e.UserAction.Copy(t,d,c,void 0,!0,!0))}function n(t,n,o,i,r,s){e.UserAction.CopyToClipAction(t,n,o,i,r,s)}function o(e){l.innerHTML="",l.innerHTML=e,i(),r(),l.blur()}function i(){var e=a.createRange();e.selectNodeContents(l);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}function r(){a.execCommand("copy")}var s=e.sPlusPlus,a=(ZSClass.Editors,e.document),d=e.ZSEvents,l=(d.topic,d.Groups,d.Names,a.createElement("div"));l.setAttribute("contenteditable",!0),l.setAttribute("id","copyEditor"),l.style.width="1000px",l.style.height="0px",l.style.position="absolute",l.style.top="-100010px",l.style.left="-100010px",a.body.appendChild(l),e.UserAction.CopyData=t,e.UserAction.CopyResponseHandling=o}(this);
!function(e){function a(e,a,n){var i=u.view.getActiveGridID(),s=u.view.getResourceID(i),o=u.view.getSheetID(i),c=u.view.getVersionID(i),r=u.view.getSelectedSheets(i),h=g.activeInfo.getCopyState();"undefined"!=typeof u.data.isRecastAction&&u.data.isRecastAction&&(u.data.isRecastAction=!1);var p=(u.data.getWorkBook(s,c),u.view.getActiveState(i)),f=p.getFormatPainterRange(),L=p.getFormatPainterState(),T=L?f:g.activeInfo.getCopyDetails();if(a&&a.indexOf(v)>=0&&0!=Object.keys(T).length||0==h)UserAction.PasteFromSheet(s,r,c,"ALL",!1);else if("undefined"!=typeof n)UserAction.PasteOutsideSource(s,r,c,a,!0,n);else if(a.length>0)UserAction.PasteOutsideSource(s,r,c,a,!0);else{var m=S(e);t(m)?e.length>0&&UserAction.PasteOutsideSource(s,r,c,e):A.publish(d.Listener,D.UserAction.OPEN_TEXT_TO_COLUMNS,{RID:s,SHEETID:o,VERSION:c,ISOUTSIDE_DATA:!0,DATA:l(m),ORIGINALDATA:e,DELIMITER:w})}}function t(e){o(),T.wholeDataLen=e.length,n();for(var a=0;a<e.length;a++){var t=e[a];h(t),L.isdataEmpty||(c(t,a),i(t,a),r(t,a))}return s(e),L.isdataEmpty||L.isSingleSpace||L.hasNoSpace||L.hasTab||L.isSingleLine||L.hasAlphanumeric||!w?!0:!1}function n(){1===T.wholeDataLen&&(L.isSingleLine=!0)}function i(e,a){var t=e.indexOf("	"),n=e.split(/\t/g);m.tabs+=n.length-1,-1!=t&&T.hasTab++,a==T.wholeDataLen-1&&T.hasTab==T.wholeDataLen&&(L.hasTab=!0)}function s(){var e=Object.keys(m).reduce(function(e,a){var t=m[e]>m[a]?e:a;return m[t]<=1?void 0:t});return w=e,e}function o(){L.isdataEmpty=!1,L.isSingleSpace=!1,L.hasNoSpace=!1,L.hasTab=!1,L.hasAlphanumeric=!1,L.isSingleLine=!1,T.wholeDataLen=0,T.hasSingle=0,T.noSpace=0,T.hasTab=0,T.hasAlphanumeric=0,m.tabs=0,m.space=0}function c(e,a){var t=e,n=t.match(/([\s,;]+)/g);n?(m.space+=n.length-1,n.length<2&&T.hasSingle++):T.noSpace++,a==T.wholeDataLen-1&&(T.hasSingle==T.wholeDataLen?L.isSingleSpace=!0:T.noSpace==T.wholeDataLen&&(L.hasNoSpace=!0))}function r(e){var a=/^[A-Za-z0-9]*$/;a.test(e)&&T.hasAlphanumeric++}function h(e){""===e&&(L.isdataEmpty=!0)}function l(e){for(var a=[],t=0;t<e.length;t++){var n=[];n.push(e[t]),a.push(n)}return a}function S(e){var a=[],t=e.split("\n");for(var n in t)t[n]=t[n],a.push(t[n]);return a}var u=e.sPlusPlus,p=e.ZSConstants.wCC,g=u.data.UserInfo,v=p.ZOHOSHEET_COPY_SRC,f=e.ZSEvents,A=f.topic,d=f.Groups,D=f.Names,L={};L.isdataEmpty=!1,L.isSingleSpace=!1,L.hasNoSpace=!1,L.hasTab=!1,L.isSingleLine=!1,L.hasAlphanumeric=!1;var T={};T.wholeDataLen=0,T.hasSingle=0,T.noSpace=0,T.hasTab=0,T.hasAlphanumeric=0;var m={};m.tabs=0,m.space=0;var w;e.UserAction.handleClipData=a}(this);
!function(t){function e(t,e,s){c=t,p=e,h=s,m||i(),m.open()}function i(){y=v.createElement("span"),y.className="ZsLoader";var e=T.getTemplate(["MANAGE_FORMAT"]),i=e.MANAGE_FORMAT,o={modal:!0,width:750,dialogClass:"fmcell",title:M.FormatCells,open:n};u=v.createElement("div"),u.id=E.DI+"ManageFormat"+E.IDENTITY,u.appendChild(i),s(),F=u.querySelector("#valueInput"),C=u.querySelector("#custFormatList"),m=new t.ZSClass.Dialog(u,o)}function s(){u.querySelector("#fCloseDlg").addEventListener("click",r),u.querySelector("#addBtn").addEventListener("click",a),u.querySelector("#addApplyBtn").addEventListener("click",l)}function o(){m.close()}function n(){C.appendChild(y);var t={formatType:"CUSTOM",frmtAction:"readCustomFormats"};T.FORMATCELLS_CLIENT(c,p,h,t,function(t){C.removeChild(y),C=u.querySelector("#custFormatList");var e=u.querySelector("#custFormatList"),i=t.USERLEVELCUSTOMFORMATS;if(i&&i.length>0){e.innerText="",e.removeAttribute("style");for(var s=0;s<i.length;s++){var o=new d(i[s]);q.push(o),C.appendChild(o.dom)}}else e.setAttribute("style","text-align:center;line-height: 265px"),e.innerText="0 "+M["FormatCells.CustomFormats"]})}function r(){C.innerHTML="",q=[],U.openDialog(null,"custom")}function a(){var t=F.value,e={formatType:"CUSTOM",frmtAction:"saveCustomFormats",format:t};T.FORMATCELLS_CLIENT(c,p,h,e,function(t){if(t.CUSTOMFORMAT){var e=u.querySelector("#custFormatList");e.hasAttribute("style")&&(e.innerText="",e.removeAttribute("style"));var i=new d(t.CUSTOMFORMAT);C.appendChild(i.dom),q.push(i)}else if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var s=M["FormatCells.CustomFormat.AlertMessage"];L(s,{title:M["Alert.Title.InvalidFormatCode"]})}},U.UpdateCustomFormats.bind(this,q))}function l(){var t=F.value,e={formatType:"CUSTOM",frmtAction:"saveAndApplyCustomFormats",format:t};T.FORMATCELLS_CLIENT(c,p,h,e,function(t){var i=t.cusFrmtStatus;if("FormatNotSupported"==i){var s=M["FormatCells.CustomFormat.AlertMessage"];L(s,{title:M["Alert.Title.InvalidFormatCode"]})}else"FormatSupported"==i&&(o(),T.FORMATCELLS_GRID(c,p,h,null,null,e))},U.UpdateCustomFormats.bind(this,q))}function d(t){this.value=decodeURIComponent(t),this.init()}var u,m,c,p,h,C,y,F,S=t.sPlusPlus,v=t.document,T=(t.UIUtil.Component,t.UserAction),A=(t.JSUtil,t.ZSConstants),f=A.FeatureConstants,M=(A.CommandConstants,A.I18N),E=A.wCC,L=t.ZSClass.ZSAlert,O=t.ZSEvents,N=O.topic,I=O.Groups,R=O.Names,U=S.view.Toolbar.Feature[f.FORMATCELLS],q=[];d.prototype={init:function(){var t=T.getTemplate(["MANAGE_FORMAT_LIST"]);this.dom=v.createElement("li"),this.dom.appendChild(t.MANAGE_FORMAT_LIST),this.displayName=this.dom.querySelector("#roCustName"),this.displayName.innerText=this.value,this.viewMode=this.dom.querySelector("#viewAction"),this.input=this.dom.querySelector("#rwCustName"),this.input.value=this.value,this.input.style.display="none",this.editMode=this.dom.querySelector("#editAction"),this.editMode.style.display="none",this.bindEvents()},bindEvents:function(){this.dom.querySelector("#rwCustName").addEventListener("keydown",function(){}),this.dom.querySelector("#deleteCustFrmt").addEventListener("click",this.deleteFormat.bind(this)),this.dom.querySelector("#editCustFrmt").addEventListener("click",this.editFormat.bind(this)),this.dom.querySelector("#updateCustFrmt").addEventListener("click",this.updateFormat.bind(this)),this.dom.querySelector("#cancelCustFrmt").addEventListener("click",this.cancelEdit.bind(this))},editFormat:function(){this.viewMode.style.display="none",this.displayName.style.display="none",this.editMode.style.display="",this.input.style.display=""},deleteFormat:function(){this.dom.parentNode.removeChild(this.dom);for(var t=q.indexOf(this),e=0;e<q.length;e++)t==e&&q.splice(t,1);var i={formatType:"CUSTOM",frmtAction:"deleteCustomFormats",index:t};T.FORMATCELLS_CLIENT(c,p,h,i,null,U.UpdateCustomFormats.bind(this,q));var s=u.querySelector("#custFormatList"),o=s.querySelectorAll("li");if(0==o.length){var n=u.querySelector("#custFormatList");n.setAttribute("style","text-align:center;line-height: 265px"),n.innerText="0 "+M["FormatCells.CustomFormats"]}},updateFormat:function(){var t=q.indexOf(this),e=this.input.value,i={formatType:"CUSTOM",frmtAction:"updateCustomFormats",index:t,format:e};T.FORMATCELLS_CLIENT(c,p,h,i,function(t){if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var e=M["FormatCells.CustomFormat.AlertMessage"];L(e,{title:M["Alert.Title.InvalidFormatCode"]})}else this.displayName.innerText=decodeURIComponent(t.CUSTOMFORMAT),this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none",this.displayName.style.display="",this.input.value=""}.bind(this),U.UpdateCustomFormats.bind(this,q))},cancelEdit:function(){this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none",this.displayName.style.display="",F.value=""}},N.register(I.UI,R.Toolbar.FORMAT.OPEN_MANAGEFORMAT,e,"RID","SHEETLIST","VERSION")}(this);
!function(r){function o(){this.border={colour:"0.0138in solid",thickNess:"#000000"}}var t=r.UserAction;o.prototype={setBackgroundColour:function(r){this.border.colour=r},setBorderThickness:function(r){this.border.thickNess=r},getBorderStyle:function(){return this.border.thickNess+" "+this.border.colour},resetDefault:function(){this.border={colour:"0.0138in solid",thickNess:"#000000"}}},t.BorderManager=o}(this);
!function(e){function t(){{var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),i=s.view.getSheetID(e),n=s.view.getVersionID(e),o=s.data.getWorkBook(t,n),r=(o.getSheetObj(i),s.view.getActiveState(e));r.getUserPresenceList()}}var s=e.sPlusPlus,i=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.ZSEvents),n=i.topic,o=i.Groups,r=i.Names;n.register(o.Listener,r.UserAction.SHOW_COLLABS_LIST,t)}(this);
!function(e){function t(){this.actionLogDom=o(),this.colorCodeDom=this.actionLogDom.querySelector("#colorCodeAndName"),this.Name=this.actionLogDom.querySelector("#colorCodeAndName"),this.Time=this.actionLogDom.querySelector("#time"),this.MessageContainer=this.actionLogDom.querySelector("#msgContainer")}function o(){if(!u){var e=UserAction.getTemplate(["AUDIT_TRAIL_ACTION_LOG"]);u=e.AUDIT_TRAIL_ACTION_LOG}return u.cloneNode(!0)}var i=e.ZSClass,n=e.ZSConstants.I18N,a=e.sPlusPlus,s=e.ZSEvents,r=s.topic,c=s.Groups,l=s.Names,d=e.ZSDevTools.Logger;t.prototype={setColorCode:function(e){this.colorCodeDom.style.color="#"+e},setName:function(e){this.Name.dataset.actname=this.Name.title=e},setTime:function(e){this.Time.dataset.acttime=e},setMessage:function(e){this.MessageContainer.appendChild(e)},append:function(e){e.appendChild(this.actionLogDom)},setAsRollBackAction:function(){this.Time.classList.add("aDrollBack")},createLink:function(e,t){var o=document.createElement("a");o.classList.add("aDlnk");var i=[e,t],s=t?n["AT.GotoCell"]:n["AT.GotoCellCurrentVersion"],d=0;return s=s.replace(/{\d}/gi,function(){return i[d++]}),o.title=s,o.text=e,o.addEventListener("click",function(){var o=a.view.getActiveGridID(),i=a.view.getResourceID(o),n=a.view.getVersionID(o);n===a.data.Defaults.version&&(n=""),n!=t?r.publish(c.UI,l.SidePanel.VersionHistory.OPEN,{RID:i,VERSION:t,RANGE:e}):UserAction.Goto(e)}),o},processMessage:function(e){var t,o,i,a=e.undid,s=e.redid;a||s?(t=a?n["AT.Undid"]+"-"+n[a.msg]:n["AT.Redid"]+"-"+n[s.msg],o=a?a.lp:s.lp,i=a?a.nlp:s.nlp):(t=n[e.msg],o=e.lp,i=e.nlp),e.d_msg&&(t+=e.d_msg);var r=document.createDocumentFragment();if(!t)return d.log("No Message availble for the key :: ",e),r;t=t.replace(/({\d})|#L\{\d\}#CL/gi,function(e,t){return t=t&&t.replace(/[{}]/gi,""),t?decodeURIComponent(i[t]):e});var c=t.split(/#L{\d\}#CL/g);t=c[0],r.appendChild(document.createTextNode(t));for(var l=1;l<c.length;l++){this.anchor=this.createLink(o[l-1],e.ver);var u=o[l-1];if(u){u=u.split(/;/g);for(var m=0;m<u.length;m++)this.anchor=this.createLink(u[m],e.ver),m>0&&r.appendChild(document.createTextNode(", ")),r.appendChild(this.anchor)}r.appendChild(document.createTextNode(c[l]))}return r}};var u;i.UIActionLog=t}(this);
!function(e){function o(){this.userInfoDom=t(),this.userName=this.userInfoDom.querySelector("#colorCodeAndName"),this.colorCode=this.userInfoDom.querySelector("#colorCodeAndName")}function t(){if(!s){var e=UserAction.getTemplate(["SP_VERSION_USERINFO"]),o=e.SP_VERSION_USERINFO;s=o.querySelector("#userInfo")}return s.cloneNode(!0)}var r=e.ZSClass;o.prototype={setColorCode:function(e){this.colorCode.style.color=e},setName:function(e){this.userName.title=this.userName.dataset.actname=e},append:function(e){e.appendChild(this.userInfoDom)}};var s;r.UIVersionUserInfo=o}(this);
!function(e){function o(){this.versionLogDom=i(),this.dom=this.versionLogDom.querySelector("div"),this.timeStamp=this.versionLogDom.querySelector("#timeStamp"),this.versionNumberDom=this.versionLogDom.querySelector("#versionNumber"),this.description=this.versionLogDom.querySelector("#description"),this.versionName="",this.revertVersion=this.versionLogDom.querySelector("#revertVersion"),this.userInfoHolder=this.versionLogDom.querySelector("#userInfoHolder"),this.userList=[],this.versionNumber,this.userInfoContainer=this.versionLogDom.querySelector("#userInfoContainer"),this.changeLog=this.versionLogDom.querySelector("#changeLog")}function t(e,o){for(var t in o)e.addEventListener(t,o[t].bind(this))}function i(){if(!h){var e=UserAction.getTemplate(["VERSION_LOG"]);h=e.VERSION_LOG}return h.cloneNode(!0)}{var r=e.ZSClass,n=r.UIVersionUserInfo,s=e.ZSEvents;s.topic,s.Groups,s.Names,e.sPlusPlus}o.prototype={setTime:function(e){this.timeStamp.textContent=e},setVersionNumber:function(e){this.versionNumberDom.textContent="#"+parseFloat(e),this.versionNumber=e},setUserNameAndColor:function(e){this.userInfoContainer.innerHTML="";for(var o=e?e.length:0,t=0;o>t;t++){var i=new n;i.setName(e[t].name),i.setColorCode(e[t].colorCode),i.append(this.userInfoContainer)}},getVersionName:function(){return this.versionName},setDescription:function(e){this.versionName=e,this.description.textContent="Description : "+this.versionName,this.userInfoHolder.prepend(this.description)},append:function(e){e.appendChild(this.dom)},getDom:function(){return this.dom},getVersionNumber:function(){return this.versionNumber},addEventListener:function(e){e.changeLog&&t.call(this,this.changeLog,e.changeLog),e.dom&&t.call(this,this.dom,e.dom)},addRevertVersion:function(e,o){this.revertVersion.title=o+" #"+e,this.dom.insertBefore(this.revertVersion,this.versionNumberDom)},remove:function(){this.dom.remove()}};var h;r.UIVersionLog=o}(this);
!function(e){function n(){this.currentVersionLogDom=o(),this.dom=this.currentVersionLogDom.querySelector("div"),this.changeLog=this.currentVersionLogDom.querySelector("#changeLog"),this.versionNumber}function t(e,n){for(var t in n)e.addEventListener(t,n[t].bind(this))}function o(){if(!r){var e=UserAction.getTemplate(["CURRENT_VERSION_LOG"]);r=e.CURRENT_VERSION_LOG}return r.cloneNode(!0)}{var i=e.ZSClass;e.sPlusPlus}n.prototype={setVersionNumber:function(e){this.versionNumber=e},getVersionNumber:function(){return this.versionNumber},addEventListener:function(e){e.dom&&t.call(this,this.dom,e.dom),e.changeLog&&t.call(this,this.changeLog,e.changeLog)},append:function(e){e.appendChild(this.dom)}};var r;i.UICurrentVersionLog=n}(this);
!function(t){function e(t,e){for(var i in t)e.call(this,i,t[i])}function i(t,e,i){var s=r.data.getWorkBook(t,e),a=s.SheetList.getIdByName(i);return a?{sheetID:a,range:void 0,sheetName:i}:void 0}function s(){this.actionList={},this.byUser={},this.byDate={},this.byVersion={},this.partialVersion=[],this.alreadyParsed={}}var r=t.sPlusPlus,a=t.ZSClass;s.prototype={isEmpty:function(){var t=!0;for(var e in this.actionList){t=!1;break}return t},addAction:function(t){this.actionList=t;for(var i,s=Object.keys(t),a=s.length-1;a>=0;a--)i=t[s[a]].ver;r.view.actionListManager.byVersion[i]||this.partialVersion.push(i),e.call(this,this.actionList,this.splitByUser)},appendAction:function(t){var e=Object.keys(t);if(e.length){var i=t[e[0]].ver;r.view.actionListManager.byVersion[i]||this.partialVersion.push(i)}for(var s,a,n=Object.keys(this.alreadyParsed),h=e.length-1;h>=0;h--){s=e[h],a=t[e[h]],this.actionList[s]=a;for(var o=0;o<n.length;o++){var y=this.alreadyParsed[n[o]];y.call(this,s,a)}}},getActionList:function(){return this.actionList},getByUser:function(t){return 0===Object.keys(this.byUser).length&&this.byUser.constructor===Object&&e.call(this,this.actionList,this.splitByUser),this.byUser[t]},splitByUser:function(t,e){var i=e.un;this.alreadyParsed.splitByUser=this.splitByUser,!this.byUser[i]&&(this.byUser[i]={}),this.byUser[i][t]=e},getBySheet:function(t){return this.bySheet[t]},splitBySheet:function(t,e){var s=e.lp,a=e.undid,n=e.redo,h=e;(a||n)&&(s=a?a.lp:n.lp,h=a?a:n),h.parsedRange=[];for(var o=r.view.getActiveGridID(),y=r.view.getResourceID(o),c=r.view.getVersionID(o),l=0;l<s.length;l++){var v=JSUtil.Range.parseRange(y,c,s[l])||i(y,c,s[l]);v&&(!this.bySheet[v.sheetID]&&(this.bySheet[v.sheetID]=[]),this.bySheet[v.sheetID].push(e),h.parsedRange.push(v))}},splitByDate:function(t,e){var i=(e.ts,new Date(e.ts).valueOf());this.alreadyParsed.splitByDate=this.splitByDate,!this.byDate[i]&&(this.byDate[i]={}),this.byDate[i][t]=e},getByDate:function(t,i,s){0===Object.keys(this.byDate).length&&this.byDate.constructor===Object&&e.call(this,this.actionList,this.splitByDate);for(var r={},a={},n=Object.keys(this.byDate),h=0,o=0,y=0;h<n.length;h++)if(n[h]>=t&&n[h]<=i){var c=this.byDate[n[h]];for(var l in c)r[o]=c[l],o++}else{var c=this.byDate[n[h]];for(var v in c)a[y]=c[v],y++}return s?r:a},getByRange:function(t,e,s){var r=JSUtil.Range.parseRange(t,e,s)||i(t,e,s);if(r){var a=this.getBySheet(r.sheetID),n=r.range;if(!n)return a;for(var h=[],o=0;o<a.length;o++){var y=a[o],c=y.undid,l=y.redo;(c||l)&&(y=c?c:l);for(var v=0;v<y.parsedRange.length;v++){var u=y.parsedRange[v].range;n.intersects(u)&&h.push(y)}}return h}},splitByVersion:function(t,e){var i=e.ver;this.alreadyParsed.splitByVersion=this.splitByVersion,i&&(!this.byVersion[i]&&(this.byVersion[i]={}),this.byVersion[i][t]=e)},getByVersion:function(t){0===Object.keys(this.byVersion).length&&this.byVersion.constructor===Object&&e.call(this,this.actionList,this.splitByVersion);var i=this.partialVersion.indexOf(t);return-1==i?this.byVersion[t]:void this.partialVersion.splice(i,1)}},r.view.actionListManager=new s,a.ActionListManager=s}(this);
!function(e){function t(e){var t=u.view.actionListManager,i=t.getByVersion(this.versionNumber),s=u.view.getActiveGridID(),n=this.versionNumber?h["AT.ChangeLog"]+" - "+h.version+" #"+this.versionNumber:h["AT.ChangeLog"];if(i)a(n,i);else{var o=u.view.getResourceID(s),r=u.view.getVersionID(s);UserAction.getActionListBasedOnVersion(o,r,this.versionNumber,function(e){a(n,e)},!0)}e.stopPropagation()}function i(e){var t=e.data,i=this.versionNumber,s=u.view.getActiveGridID(),o=u.view.getVersionState(s),r=o.getActiveVersionLog();if(r){var a=r.getVersionNumber();if(a===i)return;r.dom.classList.remove("active")}var c=u.view.getResourceID(s);this.dom.appendChild(C),this.dom.appendChild(L),UserAction.LoadVersion(c,"",i,!1,function(){var e=t?t.range:void 0;n(i,e),L.remove(),C.remove()}),this.dom.classList.add("active"),o.getIsDialogOpen()&&this.changeLog.click(),o.setActiveVersionLog(this),I()}function s(e,t,i){var s=u.view.getActiveGridID(),n=(u.data.getWorkBook(e,t),u.view.getVersionState(s));setTimeout(function(){D.publish(A.UI,E.SidePanel.VersionHistory.HIGHLIGHT_CHANGES)},0);var r=n.getVersionActionList();D.publish(A.Listener,E.DocAction.WORKSHEETS.ADD_NO_OF_EDITS,{RID:e,VERSION:t,DATA:r});var a=n.getGoToRange();a&&o(e,i,t,a)}function n(e,t){var i=u.view.actionListManager.getByVersion(e),n=u.view.getActiveGridID(),o=u.view.getResourceID(n),r=u.view.getSheetID(n),a=u.view.getVersionID(n),c=u.view.getVersionState(n);if(D.publish(A.UI,E.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES),D.publish(A.Listener,E.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS),c.setVersionNumber(e),c.setGoToRange(t),c.setIsCloseButton(!1),i)c.setVersionActionList(i),s(o,a,r);else{var o=u.view.getResourceID(n),a=u.view.getVersionID(n);UserAction.getActionListBasedOnVersion(o,a,e,function(t){c.setVersionActionList(t),s(o,e,r)},!0)}D.publish(A.Listener,E.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE),D.publish(A.UI,E.SidePanel.VersionHistory.UPDATE_TITLE,{VERSION_NUMBER:e})}function o(e,t,i,s){var n,o,a=JSUtil.Range.parseRange(e,i,s);if(a)n=a.sheetID,o=a.range;else{var c=u.data.getWorkBook(e,i),l=c.SheetList.getSheets();if(!l.isNameExists(s))return;n=l.getIdByName(s),o=new ZSClass.Range(0,0,0,0)}t!=n?UserAction.SwitchSheet(e,t,i,n,o):r(e,t,i,o,o.startRow,o.startCol)}function r(e,t,i,s,n,o){D.publish(A.Selector.BoundUpdate.Range,E.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:s});var r=new ZSClass.Range(n,o,n,o);D.publish(A.Selector.BoundUpdate.Cell,E.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:r,ROW:n,COL:o}),UserAction.ScrollCellIntoView(e,t,i,n,o)}function a(t,i){var s=u.view.getActiveGridID(),n=u.view.getVersionState(s);O=n.getChangeLogDialog();var o={width:500,title:t,close:function(){n.setIsDialogOpen(!1)},open:function(){n.setIsDialogOpen(!0),c(i)}};g(),O&&O.close(),O=new e.ZSClass.Dialog(m,o),O.open(),n.setChangeLogDialog(O)}function c(e){var t=Object.keys(e),i=t.length;i?(w.innerHTML="",m.style.position="relative"):(m.style.position="static",w.innerHTML="",w.appendChild(H));for(var s=i-1;s>=0;s--){l(e[t[s]],w)}}function l(e,t){var i=new N;return i.setColorCode(e.cc),i.setName(e.un),i.setTime(e.ts),e.irb&&i.setAsRollBackAction(),i.setMessage(i.processMessage(e)),i.append(t),i}function g(){var t=e.UserAction.getTemplate(["VERSION_HISTORY_AUDIT"]),i=t.VERSION_HISTORY_AUDIT;w=i.querySelector("#actionLogContainer"),m=document.createElement("div"),m.id=V.DI+T.VIEW_VERSION+V.IDENTITY,m.appendChild(i)}function v(){var e=u.view.getActiveGridID(),t=u.view.getVersionState(e);D.publish(A.UI,E.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES),O=t.getChangeLogDialog(),O&&O.close()}function I(){if(!U){var e=new ZSClass.VersionHistoryToolbar;U=new ZSClass.UIView("VERSION",e),D.publish(A.UI,E.Toolbar.VERSION_HISTORY.SHOW)}U.show()}function S(){U&&U.hide()}var u=e.sPlusPlus,d=e.ZSEvents,D=d.topic,A=d.Groups,E=d.Names,h=e.ZSConstants.I18N,V=e.ZSConstants.wCC,T=e.ZSConstants.FeatureConstants,N=ZSClass.UIActionLog,p={dom:{click:i}},R={changeLog:{click:t}},C=document.createElement("span");C.className="ZsMask";var L=e.document.createElement("span");L.className="ZsLoader ZsLoaderSmall";var O,m,w,H=document.createElement("span");H.textContent=h["AT.NoEdits.Version"],H.className="ZsNoMsg";var U;D.register(A.UI,E.Toolbar.VERSION_HISTORY.HIDE,S),D.register(A.UI,E.SidePanel.VersionHistory.CLOSE,v),e.ZSClass.VersionLogBinds=p,e.ZSClass.ChangeLogBinds=R}(this);
!function(e){function t(){var e=l.view.getActiveGridID(),t=this.versionNumber?h["AT.ChangeLog"]+" - "+h.version+" #"+this.versionNumber:h["AT.ChangeLog"],i=l.view.getResourceID(e),s=l.view.getVersionID(e);UserAction.getActionListBasedOnVersion(i,s,this.versionNumber,function(e){n(t,e)},!1)}function i(e){var t=e.data,i=this.versionNumber,n=l.view.getActiveGridID(),o=l.view.getVersionState(n),r=o.getActiveVersionLog();if(r){var a=r.getVersionNumber();if(a===i)return;r.dom.classList.remove("active")}var c=l.view.getResourceID(n);UserAction.LoadVersion(c,"",i,!1,function(){var e=t?t.range:void 0;s(i,e)}),this.dom.classList.add("active"),o.getIsDialogOpen()&&this.changeLog.click(),o.setActiveVersionLog(this)}function s(e,t){var i=l.view.getActiveGridID(),s=l.view.getResourceID(i),n=l.view.getSheetID(i),o=(l.view.getVersionID(i),l.view.getVersionState(i));I.publish(d.UI,S.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES),o.setVersionNumber(e),I.publish(d.UI,S.Toolbar.VERSION_HISTORY.HIDE),I.publish(d.UI,S.SidePanel.VersionHistory.UPDATE_TITLE),I.publish(d.Listener,S.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS),I.publish(d.Listener,S.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE),t&&goTo(s,n,e,t)}function n(t,i){var s=l.view.getActiveGridID(),n=l.view.getVersionState(s);c=n.getChangeLogDialog();var r={width:500,title:t,close:function(){n.setIsDialogOpen(!1)},open:function(){n.setIsDialogOpen(!0),o(i)}};a(),c&&c.close(),c=new e.ZSClass.Dialog(g,r),c.open(),n.setChangeLogDialog(c)}function o(e){var t=Object.keys(e),i=t.length;i?(v.innerHTML="",g.style.position="relative"):(g.style.position="static",v.innerHTML="",v.appendChild(A));for(var s=i-1;s>=0;s--){r(e[t[s]],v)}}function r(e,t){var i=new T;return i.setColorCode(e.cc),i.setName(e.un),i.setTime(e.ts),i.setMessage(i.processMessage(e)),i.append(t),i}function a(){var t=e.UserAction.getTemplate(["VERSION_HISTORY_AUDIT"]),i=t.VERSION_HISTORY_AUDIT;v=i.querySelector("#actionLogContainer"),g=document.createElement("div"),g.id=D.DI+C.VIEW_VERSION+D.IDENTITY,g.appendChild(i)}var c,g,v,l=e.sPlusPlus,u=e.ZSEvents,I=u.topic,d=u.Groups,S=u.Names,T=ZSClass.UIActionLog,h=e.ZSConstants.I18N,D=e.ZSConstants.wCC,C=e.ZSConstants.FeatureConstants,p={dom:{click:i}},V={changeLog:{click:t}},A=document.createElement("span");A.textContent=h["AT.NoEdits.Version"],A.className="ZsNoMsg",ZSClass.CurrentVersionLogBinds=p,ZSClass.CurrentVersionChangeLogBinds=V}(this);
!function(t){function e(t){var e=l.createElement("button");e.id=o.MI+r.SAVE+o.IDENTITY,e.setAttribute("data",'{"label":"'+u["MenuItem.FileTab.Save"]+'"}'),e.addEventListener("click",a),t.appendChild(e)}function n(t){var e=l.createElement("li");e.id=o.MI+r.SAVE+o.MENU,e.setAttribute("data",'{"label":"'+u["MenuItem.FileTab.Save"]+'"}'),e.addEventListener("click",a),t.appendChild(e)}function a(){}function i(){}var s=t.sPlusPlus,r=t.ZSConstants.FeatureConstants,l=t.document,u=t.ZSConstants.I18N,o=t.ZSConstants.wCC;s.view.Toolbar.transient[r.SAVE]=e,s.view.Menu.transient[r.SAVE]=n,s.view.Toolbar.transient.destructor[r.SAVE]=i}(this);
!function(t){function e(){var t=document.createElement("div"),e=document.createElement("img");t.appendChild(e),t.classList.add("ZSOLEImage"),this.image=e,this.Dom=t}var a=t.ZSClass,i=a.Layer||(a.Layer={}),n=i.Image||(i.Image={});e.prototype={setName:function(t){this.image.name=t},setImageSrc:function(t){this.image.src=t},getNaturalHeight:function(){return this.image.naturalHeight},getNaturalWidth:function(){return this.image.naturalWidth},appendTo:function(t){t.appendChild(this.Dom)},remove:function(){this.Dom.remove()}},n.UIImage=e}(this);
!function(e){function t(){this.container=n.querySelector("#TB_LEFT_CONTAINER"),this.quickAccessContainer=n.querySelector("#quickAccessPrintToolbar"),this.QuickAccessItems=r.view.Toolbar.Skeleton_PRINT}var n=e.document,r=e.sPlusPlus,s=e.ZSClass,i=e.ZSConstants.wCC,o=e.ZSConstants.FeatureConstants;t.prototype={getName:function(){return"PRINT"},getMenuTabHolder:function(){var e=n.createElement("div");return e.setAttribute("data",'{"selectTabOnInit":true }'),e.setAttribute("id","TB_PRINT_MENU_TAB_HOLDER"),e.style.display="none",this.holder=e,this.holder},getTabHolder:function(){return n.createElement("ul")},getMenuHolder:function(){var e=n.createElement("div");return e.style.display="none",e},getContainer:function(){return this.container},getMenuTabItems:function(){return this.MTBItems},getQuickAccessItems:function(){return this.QuickAccessItems},getQuickAccessContainer:function(){return this.quickAccessContainer},getTabItems:function(){return""},onShow:function(){var e=n.querySelector("#menutabContainer");e&&e.classList.add("zsDisable"),n.querySelector(".shFindBar").style.display="none";var t=n.querySelector("#"+i.MI+o.SHARE+i.IDENTITY);t&&(t.style.display="none")},onHide:function(){var e=n.querySelector("#menutabContainer");e&&e.classList.remove("zsDisable"),n.querySelector(".shFindBar").style.display="";var t=n.querySelector("#"+i.MI+o.SHARE+i.IDENTITY);t&&(t.style.display="")},callBack:function(){}},s.PrintToolbar=t}(this);
!function(e){function t(){this.container=n.querySelector("#TB_LEFT_CONTAINER"),this.quickAccessContainer=n.querySelector("#quickAccessVersionToolbar"),this.QuickAccessItems=s.view.Toolbar.Skeleton_VERSION}var n=e.document,s=e.sPlusPlus,r=(e.UIUtil.Component,e.ZSConstants.wCC),o=e.ZSConstants.FeatureConstants;t.prototype={getName:function(){return"VERSION"},getTabHolder:function(){var e=n.createElement("ul");return e.id="TB_VERSION_MENU_TAB_HOLDER",e.className="shMenu dspFlex algnCnt",e},getMenuHolder:function(){var e=n.createElement("div");return e.style.display="none",e},getContainer:function(){return this.container},getQuickAccessContainer:function(){return this.quickAccessContainer},getQuickAccessItems:function(){return this.QuickAccessItems},getMenuTabItems:function(){return this.MTBItems},getTabItems:function(){return""},onShow:function(){var e=n.querySelector("#menutabContainer");e&&e.classList.add("zsDisable");var t=n.querySelector("#"+r.MI+o.SHARE+r.IDENTITY);t.style.display="none"},onHide:function(){var e=n.querySelector("#menutabContainer");e&&e.classList.remove("zsDisable");var t=n.querySelector("#"+r.MI+o.SHARE+r.IDENTITY);t.style.display=""},callBack:function(){}},ZSClass.VersionHistoryToolbar=t}(this);
!function(i){function t(i,t,s,e,l,o){this.rID=i,this.sheetID=t,this.version=s,this.files=e,this.options=l,this.callback=o,this.init()}var s=(i.sPlusPlus,i.ZSClass),e=i.ZSConstants.I18N;t.prototype={init:function(){this.allowedFilType=this.options.allowedFileTypes,this.maxSize=this.options.maxFileSize,this.alertMsg=this.options.alertMsg},validate:function(){for(var i,t,l,o=!0,a=0;l=this.files[a];a++){var r=l.name,n=l.size,h=r.lastIndexOf("."),p=r.substring(h+1).toLowerCase();if(-1==this.allowedFilType.indexOf(p)){t=e.Wecurrentlydonotsupportfiles,o=!1;break}if(this.maxSize<n){this.alertMsg&&(t=this.alertMsg),o=!1;break}if(i=p,i!==p){o=!1,t=e.selectValidFiles;break}o=!0}o?this.callback.onDrop(this.rID,this.sheetID,this.version,this.files):s.ZSAlert(t,{title:e["Alert.Title.UnsupportedFormat"]})}},s.DragAndDrop=t}(this);
!function(e){function t(e){var e=document.querySelector(".fB"),t=document.createElement("div");t.className="fbCellAddr",e.appendChild(t),I=document.createElement("input"),t.appendChild(I),I.addEventListener("keydown",c),I.addEventListener("input",u),I.addEventListener("blur",d),I.addEventListener("focus",g),D()}function n(t,n,r,o){var a,i=o.startRow,s=o.endRow,l=o.startCol,c=o.endCol,u=C.data.getWorkBook(t,r),g=u.getSheetObj(n),d=g.Merge.getInfo(o.startRow,o.startCol);a=d&&!o.equals(d)||!d&&(i!==s||l!==c)?o.getLabel():e.JSUtil.Cell.getReference(i,l),I.value=a}function r(t,n,r,o){O=o;var a,i=o.startRow,s=o.endRow,l=o.startCol,c=o.endCol,u=C.data.getWorkBook(t,r),g=u.getSheetObj(n),d=g.Merge.getInfo(o.startRow,o.startCol);a=d&&!o.equals(d)||!d&&(i!==s||l!==c)?s-i+1+"R X "+(c-l+1)+"C":e.JSUtil.Cell.getReference(i,l),I.value=a}function o(e){return a(e)||i(e)}function a(e){var t=C.view.getActiveGridID(),n=C.view.getResourceID(t),r=(C.view.getSheetID(t),C.view.getVersionID(t)),o=C.data.getWorkBook(n,r);return o.NamedRange.has(e)}function i(t){return e.JSUtil.REGEXP.rangeRegex.test(t)}function s(t){if(l(t)){var n=C.view.getActiveGridID(),r=C.view.getResourceID(n),o=C.view.getSheetID(n),a=C.view.getVersionID(n),i=C.data.getWorkBook(r,a),s=i.getSheetObj(o),c=s.Prop.getName(),u=C.view.getSheetState(n,o),g=u.getRange(0),d=C.view.getSelectedSheets(n),D=c+"."+g.getLabel(1);UserAction.addNamedRange(r,d,a,t,e.JSUtil.Range.addApostrophe(D))}else{var S=h["InvalidName.AlertContent"],R=JSUtil.fn.replaceParams(h.InvalidCellName,new Array(t));N.ZSAlert(S,{title:R})}}function l(e){return new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF]+$").test(e)}function c(e){e.stopPropagation();var t=e.keyCode||e.which,n=this.value;switch(t){case 13:o(n)?(UserAction.Goto(n),p.publish(A.Listener,f.FormulaBar.CellIndicator.DropDown.Hide)):s(n);case 27:this.blur()}}function u(){p.publish(A.Listener,f.FormulaBar.CellIndicator.DropDown.Update,{value:this.value})}function g(){this.select()}function d(){p.publish(A.Listener,f.FormulaBar.CellIndicator.DropDown.Hide)}function D(){p.register(A.Gesture.Selector.Range,f.GESTURE.ACTION.DOWN,R),p.register(A.Selector.DomUpdate.Range,f.Selection.BOUND_UPDATE.ADD,n,"RID","SHEETID","VERSION","ActiveRange")}function S(e,t,o){p.register(A.Selector.DomUpdate.Range,f.Selection.BOUND_UPDATE.ADD,n,"RID","SHEETID","VERSION","ActiveRange"),p.unregister(A.Selector.BoundUpdate.Range,f.Selection.BOUND_UPDATE.MODIFY,r),p.unregister(A.Gesture.Selector.Range,f.GESTURE.ACTION.END,S),n(e,t,o,O)}function R(){p.unregister(A.Selector.DomUpdate.Range,f.Selection.BOUND_UPDATE.ADD,n),p.register(A.Selector.BoundUpdate.Range,f.Selection.BOUND_UPDATE.MODIFY,r,"RID","SHEETID","VERSION","RANGE"),p.register(A.Gesture.Selector.Range,f.GESTURE.ACTION.END,S,"RID","SHEETID","VERSION")}function E(){p.unregister(A.Selector.DomUpdate.Range,f.Selection.BOUND_UPDATE.ADD,n)}function v(){I.select()}var I,C=e.sPlusPlus,U=e.ZSEvents,p=U.topic,A=U.Groups,f=U.Names,N=e.ZSClass,w=e.ZSConstants.JSKeyCode,h=e.ZSConstants.I18N;t();var O;p.register(A.Listener,f.DocAction.DOCUMENT.CLOSE,E);var m=e.sPlusPlus.view.Events.Key,T=m.Entry.ShortCut.Context,B=T.keyDown;B[w.CTRL+"+"+w.SHIFT+"+"+w.N]=v}(this);
!function(e){function t(){var e=document.querySelector(".fB");c=document.createElement("div"),c.className="fBDrpIco",c.onclick=n,e.appendChild(c),d=document.createElement("div"),d.className="dropList",e.appendChild(d)}function n(){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),n=l.view.getVersionID(e);p?r():i(t,n)}function i(e,t){if(!p){var n=l.view.getActiveGridID();e=e||l.view.getResourceID(n),t=t||l.view.getVersionID(n);var i=l.data.getWorkBook(e,t),r=i.NamedRange.getKeys();if(!r.size)return;d.classList.add("show"),d.innerHTML="",r.forEach(function(e){var t=i.NamedRange.namedRangeMap.get(e);d.appendChild(o(e,JSUtil.FormRange(t)))}),p=!0}}function r(){p&&(d.classList.remove("show"),p=!1)}function o(e,t){var n=document.createElement("div");return n.textContent=e,n.onclick=function(){UserAction.Goto(t),r()},n.className="dropEntry",n}function a(e){return new RegExp(e.split(/(.|$)/g).join(".*"),"gi")}function s(e){!p&&i();for(var t=0;t<d.children.length;t++){var n=d.children[t],r=a(e);n.style.display=r.test(n.textContent)?"":"none"}}var c,d,l=e.sPlusPlus,u=e.ZSEvents,v=u.topic,g=u.Groups,m=u.Names;t();var p=!1,f=m.FormulaBar.CellIndicator.DropDown;v.register(g.Listener,f.Update,s,"value"),v.register(g.Listener,f.Hide,r),v.register(g.Listener,m.Mouse.RangeDown,r)}(this);
!function(e){function t(){var e=n.querySelector(".fB"),t=n.createElement("div");t.className="fbCtn",e.appendChild(t);var a=n.createElement("div");a.className="fxs",a.setAttribute("data-shortcutkey","Shift+F3"),a.title=l["Formulas.Function"],t.appendChild(a),r.fn.addIcon(a,"formulaBarFxIcon"),a.addEventListener("click",function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),n=i.view.getVersionID(e),a=i.data.getWorkBook(t,n);a.isEditable()&&s.publish(o.UI,c.SidePanel.Function.toggle)})}var i=e.sPlusPlus,n=e.document,a=e.ZSEvents,s=a.topic,o=a.Groups,c=a.Names,r=e.UIUtil,l=e.ZSConstants.I18N;t()}(this);
!function(e){function t(){G.register(B.Listener,b.SheetAction.ACTIVE_CELL.INFO,l,"VALUE"),G.register(B.Listener,b.FormulaBar.UPDATE,l,"VALUE"),G.register(B.Listener,b.FormulaBar.RESIZE,g,"height"),G.register(B.Listener,b.Browser.ScreenViewport,E,"Width")}function n(e,t,n,r){var i=T.data.getWorkBook(e,n),s=i.getSheetObj(t),o=i.ProtectedSheets.isSheetLocked(t),a=s.ProtectedRanges.isIntersecting(r);return o||a}function r(e,t,n,r){var i=T.data.getWorkBook(e,n),s=i.getSheetObj(t);return s.Pivot.isXists(r.startRow,r.startCol)}function i(e,t,n,r){var i=T.data.getWorkBook(e,n),s=i.getSheetObj(t),o=s.CheckBoxRanges.isXists(r.startRow,r.startCol);return o}function s(e,t,s,o){var a=n(e,t,s,o),u=r(e,t,s,o),c=i(e,t,s,o);return!(a||u||c)}function o(){var e=T.view.getActiveGridID(),t=T.view.getResourceID(e),n=T.view.getSheetID(e),r=T.view.getVersionID(e),i=T.view.getSheetState(e,n);G.publish(B.Listener,b.CellAction.VALUE.SET,{RID:t,SHEETID:n,VERSION:r,ROW:i.getActiveRow(),COL:i.getActiveCol(),VALUE:{DisplayValue:p.value}}),G.publish(B.Listener,b.FormulaBar.Dialog.Update,{value:p.value})}function a(t){var n=T.view.getActiveGridID(),r=T.view.CellEditor.getEditStatus();if(!r){var i=T.view.getResourceID(n),o=T.view.getSheetID(n),a=T.view.getVersionID(n),u=T.view.getSheetState(n,o),c=u.getActiveCellRange();if(s(i,o,a,c)){var l=e.sPlusPlus.view.Events.Key;l.focusContext(l.Entry.CellEditor.Context),G.publish(B.Selector.BoundUpdate.CellEdit,b.Selection.BOUND_UPDATE.ADD,{RID:i,SHEETID:o,VERSION:a,RANGE:c,RANGEID:0,TYPE:void 0})}else t.preventDefault()}}function u(t){var n=t.keyCode||t.which;switch(n){case 13:if(!t.altKey&&!t.ctrlKey&&!t.metaKey)return t.preventDefault(),!0;case 37:case 38:case 39:case 40:if(M.isSelection()){var r=e.sPlusPlus.view.Events.Key;return r.focusContext(r.Entry.RangePicker.Context),t.preventDefault(),!0}}}function c(){function e(e){var t=e.functions;for(var n in t){var r=t[n],i=document.createElement("div"),s=r[0],u=new P.AutoSuggest.FormulaEntry(i,s,f),c=r[2];d(i,u,s,c,o),a.addEntry(s,u)}}F=document.querySelector(".fB");var n=document.createElement("div");n.className="fBAutoCmplt",F.appendChild(n);var r=document.createElement("div");r.className="fBEdit",n.appendChild(r);var i=document.createElement("div");i.className="suggestBox",n.appendChild(i),p=new _(r,!0),M.register(p,!1,!1,0,!0),p.customPreventDefault=u;var s={active:29,inActive:29,container:202};y=new P.AutoSuggest.Formulaselector(i,s),U=new P.AutoSuggest.Formula(i,p,y);var o="Functions",a=U.getCategory(o);G.register(B.Listener,b.DocAction.FUNCTIONS.FETCH,function(){U.flush(a),e(k.Function)}),p.addListeners(W),P.InsertFunction.register(p),t()}function l(e){p.value=e.Formula?e.Formula:""}function g(e){F.style.height=e+"px"}function E(e){F.style.width=e+"px"}function s(e,t,n,r){var i=T.data.getWorkBook(e,n),s=i.getSheetObj(t),o=s.ProtectedRanges.isXists(r.startRow,r.startCol),a=s.CheckBoxRanges.isXists(r.startRow,r.startCol),u=s.Pivot.isXists(r.startRow,r.startCol),c=i.ProtectedSheets.isSheetLocked(t),l=i.isEditable();return o||u||c||a||!l?!1:!0}function v(e,t,n,r){var i=T.view.getActiveGridID(),o=T.view.getSheetState(i,n),a=o.getActiveCellRange();if(s(t,n,r,a)){G.publish(B.Gesture.Selector.CellEdit,b.GESTURE.ACTION.ACTUATE,{RID:t,SHEETID:n,VERSION:r}),p.focus();var u=p.value.length;p.setSelectionRange(u,u)}}function d(e,t,n,r,i){return e.innerText=n,e.title=r,"Functions"==i?(e.classList.add("shIconBefore","shSuggestFx"),e.title=r):"Deluge"==i?(e.classList.add("shIconBefore","shSuggestDlg"),e.title=r):"NamedRange"==i&&e.classList.add("shIconBefore","shSuggestDfName"),e.addEventListener("mousedown",function(){t.onInsert(t)}),e}function D(e,t,n){var r="Deluge",i=U.getCategory(r),s=n[0],o=n[2]||"my test description",a=document.createElement("div"),u=new P.AutoSuggest.FormulaEntry(a,s,I);d(a,u,s,o,r),i.addEntry(s,u)}function S(e,t,n){for(var r=0;r<n.length;r++)D(e,t,n[r])}function R(e,t,n){for(var r="Deluge",i=U.getCategory(r),s=0;s<n.length;s++)i.deleteEntry(n[s])}function f(e){y.flush(),A(p,e.text,!0)}function h(e){y.flush(),A(p,e.text,!1)}function I(e){y.flush(),A(p,"_"+e.text,!0)}function A(e,t,n){var r=e.value,i=e.selectionStart,s=e.selectionEnd,o=C(r,i,s),a=r.substring(0,o.start),u=r.substring(o.end,r.length),c=n?!!u[0]&&"("===u[0]:!0,l=a+t+(c?"":"(")+u,g=n?1:0,E=o.start+t.length+g;e.value=l,e.setSelectionRange(E,E),N(e.Editor,"input"),N(e.Editor,"selectionChanged")}function C(e,t,n){{var r=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=e.substring(0,t),s=e.substring(n,e.length),o=t-i.split(r).pop().length,a=n+s.split(r)[0].length;e.substring(0,o),e.substring(a,e.length)}return{start:o,end:a}}function N(e,t){var t=new Event(t);e.dispatchEvent(t)}function L(e,t,n){for(var r=0;r<t.length;r++)m(e,t[r],n)}function m(e,t){var n="NamedRange",r=U.getCategory(n),i=t[0],s=t[2],o=JSUtil.FormRange(s),a=document.createElement("div"),u=new P.AutoSuggest.FormulaEntry(a,i,h),a=d(a,u,i,"Refers to "+o,n);a.addEventListener("mouseover",function(){var e=JSUtil.FormRange(s);a.setAttribute("title","Refers to "+e)}),r.addEntry(i,u)}function w(e,t){for(var n="NamedRange",r=U.getCategory(n),i=0;i<t.length;i++)r.deleteEntry(t[i][0])}function O(e,t,n,r,i){var o=T.data.getWorkBook(e,n),a=new P.Range(r,i,r,i);o.isEditable()&&s(e,t,n,a)?p.enable():p.disable()}var p,F,y,U,T=e.sPlusPlus,V=e.ZSEvents,G=V.topic,B=V.Groups,b=V.Names,P=e.ZSClass,k=e.ZSConstants,x=k.JSKeyCode,_=P.Editors.FormulaEditor,M=P.RangePicker;G.create(B.Listener,b.FormulaBar.Dialog.Open),G.register(B.Listener,b.FormulaBar.Dialog.Open,function(){G.publish(B.Listener,b.FormulaBar.Dialog.Update,{value:p.value})});var W={mousedown:a,valueChanged:o,focus:o};c(),G.register(B.Listener,b.DocAction.DELUGE_FUNCTIONS.INSERT,D,"RID","VERSION","DELUGE"),G.register(B.Listener,b.DocAction.DELUGE_FUNCTIONS.REMOVE,R,"RID","VERSION","DELUGE"),G.register(B.Listener,b.DocMeta.DELUGE_FUNCTIONS,S,"RID","VERSION","DELUGE"),G.register(B.Listener,b.DocMeta.NAMED_RANGE,L,"RID","NAMEDRANGE","VERSION"),G.register(B.Listener,b.DocAction.NAMED_RANGE.ADD,L,"RID","NAMEDRANGE","VERSION"),G.register(B.Listener,b.DocAction.NAMED_RANGE.REMOVE,w,"RID","NAMEDRANGE","VERSION"),G.register(B.Listener,b.SheetAction.ACTIVE_CELL.INFO,O,"RID","SHEETID","VERSION","ROW","COL"),G.register(B.Listener,b.DocAction.DELUGE_FUNCTIONS.INSERT,D,"RID","VERSION","DELUGE"),G.register(B.Listener,b.DocAction.DELUGE_FUNCTIONS.REMOVE,R,"RID","VERSION","DELUGE");var K=e.sPlusPlus.view.Events.Key,H=K.Entry.ShortCut.Context,X=H.keyDown;X[x.CTRL+"+"+x.SHIFT+"+"+x.F]=v}(this);
!function(e){function t(){var e=document.querySelector(".fB");s=document.createElement("div"),s.className="fBExp",s.title=c.ExpandFormula+f,e.appendChild(s),s.addEventListener("click",r,!1),o.Top.formulaBar=e.offsetHeight}function r(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),r=a.view.getSheetID(e),i=a.view.getVersionID(e),v=p?d:m;n.publish(u.Listener,l.FormulaBar.RESIZE,{height:v}),p=!p;var E;p?(E=c.CollapseFormula+f,formulaBar.classList.add("fBExpTru")):(E=c.ExpandFormula+f,formulaBar.classList.remove("fBExpTru")),s.title=E,o.Top.formulaBar=v,UserAction.UpdateScreenViewPort(t,r,i)}var s,a=e.sPlusPlus,o=a.view.measures,i=e.ZSEvents,n=i.topic,u=i.Groups,l=i.Names,c=e.ZSConstants.I18N,v=e.ZSConstants.JSKeyCode,m=80,d=23,f=" (Ctrl+Shift+U)";t();var p=!1,E=e.sPlusPlus.view.Events.Key,S=E.Entry.ShortCut.Context,C=S.keyDown;C[v.COMMAND+"+"+v.SHIFT+"+"+v.U]=r,C[v.CTRL+"+"+v.SHIFT+"+"+v.U]=r}(this);
!function(t){function s(t){this.showCloseButton=!1,this.autoClose=!1,this.msg=t}function e(){var t=this;this.closeBtn=this.banner.querySelector("#close"),this.showCloseButton?this.closeBtn.addEventListener("click",function(){t.hide()}):this.closeBtn.style.display="none",this.autoClose&&setTimeout(function(){t.hide()},this.timeout?this.timeout:2500);var s=this.banner.querySelector("#icon");switch(this.bannerType){case"success":this.banner.classList.add("shNtfyInfo"),s.classList.add("shNtfyIcoSuccess");break;case"failure":break;case"warning":s.classList.add("shNtfyIcoWarning")}var e=this.banner.querySelector("#msg");e.innerHTML=this.msg}function n(){var t=l.getTemplate(["NotificationBanner"]);o=t.NotificationBanner,i&&i.display()}var o,i,a=t.ZSEvents,h=a.Groups,r=a.Names,c=a.topic,l=(t.ZSConstants.FeatureConstants,t.UserAction);s.prototype={setOptions:function(t){t.showCloseButton&&(this.showCloseButton=t.showCloseButton),t.autoClose&&(this.autoClose=t.autoClose),t.timeout&&(this.timeout=t.timeout),t.onOpen&&(this.onOpen=t.onOpen),t.onClose&&(this.onClose=t.onClose),t.bannerType&&(this.bannerType=t.bannerType)},setMessage:function(t){this.msg=t},display:function(t){this.onOpen&&this.onOpen(),o?(this.banner=t?t:o.cloneNode(!0).querySelector("#banner"),t||e.call(this),document.body.appendChild(this.banner)):i=this},hide:function(){this.onClose&&this.onClose(),document.body.removeChild(this.banner)}},c.register(h.UI,r.Layout.TEMPLATE_LOADED_DEFER,n);var u=t.ZSClass||(t.ZSClass={});u.ZSBanner=s}(this);
!function(t){function i(){var t=UserAction.getTemplate(["NotificationBanner"]),i=t.NotificationBanner;g.body.appendChild(i),r=g.body.querySelector("#banner"),r.style.display="none",a=r.querySelector("#msg"),d=r.querySelector("#close"),d.addEventListener("click",function(){!!u&&u.remove()}),l=r.querySelector("#icon"),q=!0,f&&f.show()}function e(t){t.delayIndex=D.length,D.concat(t),y=setTimeout(function(){D.splice(t.delayIndex,1),t.show()},1e3)}function s(){r.classList.remove(r.classList[1]),r.style.display="none",a.innerText="",C=!1}function n(t){E.focusContext(t)}function o(){return E.Stack[E.Stack.length-1]}function h(t,i){t?(this.index=-1,this.msg=t,!i&&(i={}),this.timeOut=i.timeOut?i.timeOut:2500,this.mode=i.mode?i.mode:"DYN",this.showCloseBtn=!!i.showCloseBtn,this.isHtml=!!i.isHtml,this.showIcon=!!i.showIcon,this.type=i.type?i.type:"warning",this.disableEditIfShown=!!i.disableEdit,this.isShown=!1,this.parent=i.parent):N.alert("Error","Notification message is mandatory")}var r,a,d,l,c,y,u,f,p,m=t.sPlusPlus,w=t.ZSEvents,S=w.topic,v=w.Groups,x=w.Names,g=t.document,E=m.view.Events.Key,I=E.Entry.Notification.Context,N=(I.keyDown,t.ZSConstants.JSKeyCode,t.ZSDevTools.Logger),C=!1,T=[],D=[],L={warning:"shNtfyWarn",error:"shNtfyErr",success:"shNtfySucc",info:"shNtfyInfo"},b={warning:"shNtfyIcoWarning",info:"shNtfyIcoInfo",error:"",success:"shNtfyIcoSuccess"},q=!1;h.prototype={show:function(t){if(t)return this.isDelayed=!0,void e(this);if(this.isDelayed=!1,!q)return void(f=this);C&&s();var i=T.length;if(d.style.display=this.showCloseBtn?"":"none",u=this,l.style.display=this.showIcon?"":"none",this.showIcon&&l.classList.add(b[this.type]),r.classList.add(L[this.type]),this.isHtml?(a.innerText="",a.appendChild(this.msg)):a.innerText=this.msg,this.parent&&this.parent.appendChild(r),r.style.display="",this.disableEditIfShown){p=o(),n(E.Entry.Notification.Context);var h=g.querySelector(".mainGrid");h.classList.add("zsDisable")}C=!0,this.isShown=!0,"DYN"==this.mode?(c&&clearTimeout(c),c=setTimeout(this.hide,this.timeOut)):(this.delayIndex=-1,-1==this.index?(this.index=i,T[i]=this):this.index=i-1)},hide:function(){if(this.parent&&g.body.appendChild(r),this.isShown=!1,this.disableEditIfShown){n(E.Entry.CellEditor.Context);var t=g.querySelector(".mainGrid");t.classList.remove("zsDisable")}s();var i=T.length;!!i&&T[i-1].show()},remove:function(){if(-1!=this.delayIndex)return D.splice(this.delayIndex,1),void clearTimeout(y);T.splice(this.index,1),this.index=-1;for(var t=T.length,i=0;t>i;i++)T[i].index=i;this.hide()}},S.register(v.UI,x.Layout.TEMPLATE_LOADED_DEFER,i),t.ZSClass.TBNotification=h}(this);
!function(t){function e(){{var t=f.getTemplate(["SuccessAlert","ErrorAlert","InfoAlert","WarningAlert"]);E.createDocumentFragment()}for(var e in t)E.body.appendChild(t[e]);B.warning=E.body.querySelector("#ZSAlertWarning"),B.info=E.body.querySelector("#ZSAlertInfo"),B.error=E.body.querySelector("#ZSAlertError"),B.success=E.body.querySelector("#ZSAlertSuccess"),x=!0;var n=f.getTemplate(["successAlertBtn","errorAlertBtn","warnAlertBtn","infoAlertBtn","GreyAlertBtn"]);T.warning=n.warnAlertBtn.firstElementChild,T.info=n.infoAlertBtn.firstElementChild,T.error=n.errorAlertBtn.firstElementChild,T.success=n.successAlertBtn.firstElementChild,T.grey=n.GreyAlertBtn.firstElementChild}function n(t,e,n){for(var r,o=e.length,s=0;o>s;s++){var l;r=!1,e[s].primary?(l=T[n].cloneNode(!0),r=!0):l=T.grey.cloneNode(!0),l.innerText=e[s].text,e[s].click&&(r&&(p=e[s].click),l.addEventListener("click",e[s].click)),l.addEventListener("click",i),t.appendChild(l)}}function r(t,e){this.msg=t,this.options=e}function o(t){d--,0>=d&&(i(),(void 0==t||t)&&E.location.reload(!0)),h&&(h.innerText=d)}function i(){I=!1,b.hideAlert()}function s(t){q.focusContext(t)}function l(){return q.Stack[q.Stack.length-1]}function c(){I&&(p&&p(),i())}function a(t,n){x||e(),I&&i(),I=!0,b.setMsg(t),b.setOptions(n),b.showAlert()}var h,d,u,p,y,A=t.sPlusPlus,f=t.UserAction,g=t.ZSClass,v=t.ZSConstants.I18N,S=t.JSUtil,m=t.ZSEvents,C=m.topic,w=m.Names,Z=m.Groups,E=t.document,q=A.view.Events.Key,x=!1,B={},T={},I=!1;r.prototype={setMsg:function(t){this.msg=t},setOptions:function(t){this.options=t},showCustomAlert:function(){var t="warning";this.options.type&&(t=this.options.type);var e=B[t].querySelector(".fntBld");if(e.innerText=this.options&&this.options.title?this.options.title:v.ZohoSheet,this.options&&this.options.isHtml?(B[t].querySelector(".ZsAlertContent").innerText="",B[t].querySelector(".ZsAlertContent").appendChild(this.msg)):B[t].querySelector(".ZsAlertContent").innerText=this.msg,this.options&&this.options.countDown){var r=S.fn.replaceParams(this.options.timerMsg?this.options.timerMsg:v["Share.dialog.closeMessage"],new Array("<b id='cntDwn'>"+this.options.countDown+"</b>")),s=E.createElement("div");s.innerHTML=r,B[t].querySelector(".ZsAlertContent").appendChild(s),h=B[t].querySelector("#cntDwn"),d=this.options.countDown,clearInterval(u),u=setInterval(function(t){I?o(t):clearInterval(u)},1e3,this.options?this.options.reload:void 0)}if(this.options.buttons)n(B[t].querySelector(".ZsAlertFooter"),this.options.buttons,t);else{var l=T[t].cloneNode(!0);l.addEventListener("click",i),B[t].querySelector(".ZsAlertFooter").appendChild(l)}B[t].style.display=""},hideAlert:function(){var t;t=this.options&&this.options.type?this.options.type:"warning",B[t].style.display="none";for(var e=B[t].querySelector(".ZsAlertFooter");e.hasChildNodes();)e.removeChild(e.lastChild);for(var n=E.querySelectorAll(".ui-widget-overlay"),r=n.length,o=0;r>o;o++)2e4==n[o].style.zIndex&&n[o].parentNode.removeChild(n[o]);h=void 0,(!this.options||this.options&&!this.options.dontSetPrevContextFlag)&&s(y)},showDefaultAlert:function(){B.warning.querySelector(".fntBld").innerText=v.ZohoSheet,B.warning.querySelector(".ZsAlertContent").innerText=this.msg;var t=T.warning.cloneNode(!0);t.addEventListener("click",i),B.warning.querySelector(".ZsAlertFooter").appendChild(t),B.warning.style.display=""},showAlert:function(){y=l();var t=E.createElement("div");t.className="ui-widget-overlay",t.style.zIndex=2e4,E.body.appendChild(t),this.options?this.showCustomAlert():this.showDefaultAlert(),setTimeout(function(){E.querySelector("#ZsAlertBtn").focus(),s(q.Entry.Alert.Context)},0)}};var b=new r;C.register(Z.Listener,w.DocAction.AlertMsg.TRIGGER_PRIMARY,c),C.register(Z.Listener,w.DocAction.AlertMsg.TRIGGER_CLOSE,i),g.ZSAlert=a}(this);
!function(s){function t(s,t){this.msg=s,this.titleMsg=t}var n=(s.sPlusPlus,s.ZSClass),i=s.ZSConstants.I18N,c={CANCEL:0,YES:1,NO:2};t.prototype={onYES:function(s,t){this.successFn=s,this.successParam=t},onNO:function(s,t){this.failureFn=s,this.failureParam=t},onCancel:function(s,t){this.onCancelFn=s,this.onCancelParam=t},process:function(s){s===c.YES?this.successFn&&this.successFn(this.successParam):s===c.NO?this.failureFn&&this.failureFn(this.failureParam):this.onCancelFn&&this.onCancelFn(this.onCancelParam)},getMsg:function(){return this.msg},execute:function(){var s=this,t=[{text:i.Yes,primary:!0,click:function(){s.process(c.YES)}},{text:i.No,click:function(){s.process(c.NO)}}],e={buttons:t,title:s.titleMsg};n.ZSAlert(this.msg,e)}},n.ZSConfirm=t}(this);
!function(t){function e(){L.KeyMapping.call(this)}function i(t,i){this.options=u(i),this.Dom=o.call(this,t),this.dragObject=this.Dom.querySelector(".ui-drag-elem"),this.KeyContext=new e;var s=S.view.Events.Key;s.Entry.Dialog.Node.addChildNode(this.KeyContext),h.call(this),B.appendChild(this.Dom),this.isInited=!1}function o(t){var e=document.createElement("div");e.className+="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable";var i=s(this);return i&&(this.options.dialogClass&&(t.className+=this.options.dialogClass),t.className+=" ui-dialog-content ui-widget-content",e.appendChild(i)),e.style.display="none",e.appendChild(t),e}function s(t){var e=t.options.title;if(e&&"string"==typeof e){var i=UserAction.getTemplate(["DLG_TITLE"]),o=i.DLG_TITLE;return o.querySelector("#dlgNameSpace").innerText=e,o.querySelector("#dlgCloseBtn").addEventListener("click",function(){t.close()}),o}return e}function n(e){var i=e.Dom,o=e.options.width||i.offsetWidth;e.left=e.options.left||(t.innerWidth-o)/2,e.top=e.options.top||(t.innerHeight-i.offsetHeight)/2,i.style.height="auto",i.style.width=o+"px",i.style.left=e.left+"px",i.style.top=e.top+"px"}function l(){var t=S.view.Events.Key;t.focusContext(this.getKeyContext())}function a(){document.activeElement.blur();var t=S.view.Events.Key;t.focusContext(t.Entry.CellEditor.Context)}function h(){var t=this;this.Dom.addEventListener("mousedown",function(e){-1!=e.path.indexOf(t.dragObject)&&r(t,e),l.call(t)});var e=this.KeyContext.keyDown;e[M.ESC]=this.options.closeOnEsc&&this.close.bind(this)}function r(e,i){g=i,b=e;var o=e.Dom;T=o.offsetLeft,C=o.offsetTop,w=t.innerHeight-o.offsetHeight,E=t.innerWidth-o.offsetWidth,i.preventDefault(),t.addEventListener("mousemove",c),t.addEventListener("mouseup",m)}function d(t,e,i){return e=Math.max(t,e),e=Math.min(e,i)}function c(t){var e=t.pageX-g.pageX,i=t.pageY-g.pageY,o=T+e,s=i+C;o=d(0,o,E),s=d(0,s,w),b.place(o,s)}function m(){t.removeEventListener("mousemove",c),t.removeEventListener("mouseup",m)}function p(){var t=document.createElement("div");return t.style.bottom=S.view.measures.Bottom.Height+"px",t.className="minimizeHolder",document.body.appendChild(t),t}function u(t){for(var e in q)t.hasOwnProperty(e)||(t[e]=q[e]);return t}function y(){return++H}function v(){x&&x.alive&&!x.isMinimize()&&x.options.maskToolbar&&x.maskToolbar()}var f,D,g,b,T,C,E,w,x,S=t.sPlusPlus,I=t.ZSEvents,k=I.topic,N=I.Groups,z=I.Names,L=t.ZSClass,M=t.ZSConstants.JSKeyCode,K=t.UIUtil.Component,B=document.body,O=S.view.measures,H=1e3;i.prototype={open:function(){x&&x.alive&&!x.min&&this.options.closePreviousDialog&&x.close(),x=this,this.options.modal&&this.showModel(),this.options.maskToolbar&&this.maskToolbar(),this.Dom.style.display="",this.Dom.style.zIndex=y(),this.alive=!0,this.isInited||(n(this),this.isInited=!0,K.initComponent(this.Dom)),k.publish(N.UI,z.Toolbar.DIALOG_OPEN);var t=S.view.getActiveGridID();this.gridID=t,this.rID=S.view.getResourceID(t),this.sheetID=S.view.getSheetID(t),this.version=S.view.getVersionID(t),this.sheetList=S.view.getSelectedSheets(t),k.publish(N.Selector.BoundUpdate.Copy,z.Selection.BOUND_UPDATE.HIDE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,VisualCueStatus:0}),this.options.open&&this.options.open.call(this),l.call(this)},close:function(){this.alive&&(this.hidden&&this.show(),this.min&&this.maximize(),this.options.modal&&this.hideModel(),this.options.maskToolbar&&this.unMaskToolbar(),this.Dom.style.display="none",this.alive=!1,a(),this.options.close&&this.options.close.call(this))},setTitle:function(t){this.options.title=t,this.Dom.querySelector("#dlgNameSpace")&&(this.Dom.querySelector("#dlgNameSpace").innerText=t)},getKeyContext:function(){return this.KeyContext},place:function(t,e){this.left=t,this.top=e,this.Dom.style.left=t+"px",this.Dom.style.top=e+"px"},show:function(){this.Dom.style.display="",this.options.modal&&(D.style.display=""),this.options.maskToolbar&&this.maskToolbar(),l.call(this),this.hidden=!1},hide:function(){this.Dom.style.display="none",this.options.modal&&(D.style.display="none"),this.options.maskToolbar&&this.unMaskToolbar(),a(),this.hidden=!0},maximize:function(){this.Dom.querySelector(".ui-dialog-content").style.display="block",this.options.modal&&(D.style.display=""),this.options.maskToolbar&&this.maskToolbar(),this.minimizeDiv.style.display="none",B.appendChild(this.Dom),this.Dom.style.zIndex=y(),l.call(this),this.min=!1},minimize:function(){this.Dom.querySelector(".ui-dialog-content").style.display="none",this.options.modal&&(D.style.display="none"),this.options.maskToolbar&&this.unMaskToolbar(),this.minimizeDiv||(this.minimizeDiv=p()),this.minimizeDiv.appendChild(this.Dom),this.minimizeDiv.style.display="block",a(),this.min=!0},showModel:function(){D||(D=document.createElement("div"),D.className="ui-widget-overlay",document.body.appendChild(D)),D.style.display="",D.style.zIndex=y()},hideModel:function(){D.style.display="none"},isAlive:function(){return this.alive},maskToolbar:function(){f||(f=document.createElement("div"),f.className="toolbarMask",document.body.appendChild(f)),f.style.display="",f.style.height=O.Top.topBand+O.Top.menuBar.Tab+O.Top.menuBar.toolBar+"px",f.style.top=O.Top.announcementBanner+"px"},unMaskToolbar:function(){f.style.display="none"},getDialog:function(){return this.Dom},isMinimize:function(){return this.min},focus:function(){l.call(this)}};var q={modal:!1,closeOnEsc:!0,maskToolbar:!0,closePreviousDialog:!0};k.register(N.Listener,z.Browser.ScreenViewport,v),t.ZSClass.Dialog=i}(this);
!function(e){function t(e,t,o,i,n){var r=N.view.getActiveGridID(),s=N.view.getSheetState(r,t),a=N.data.getWorkBook(e,o),l=a.getSheetObj(t),c=l.Column.axis,g=l.Row.auxiliaryAxis,u=l.Row.FreezedCount,E=l.Column.FreezedCount,S=s.getZoom(),h=n>=E,C=i>=u,O=s.getScrollLefts(),f=s.getScrollTops(),d=s.getScreenWidths(),v=s.getScreenHeights(),R=h?O[0]:O[1],I=C?f[0]:f[1],M=h?d[0]:d[1],L=C?v[0]:v[1],D=h?d[1]:0,m=C?v[1]:0,T=new A.Range(i,n,i,n);l.Merge.extendRange(T);var x=D+c.getPos(T.startCol)*S-R,P=m+g.getPos(T.startRow)*S-I,W=m+g.getPos(T.endRow+1)*S-I,b=D+c.getPos(T.endCol+1)*S-R;return P=Math.max(P,m),x=Math.max(x,D),W=Math.min(W,m+L),b=Math.min(b,D+M),{left:x,top:P,right:b,bottom:W}}function o(e,o,i,n,r){var s=t(e,o,i,n,r),a=N.view.getActiveGridID(),l=N.view.getSheetState(a,o),c=l.getScreenHeights(),g=l.getScreenWidths(),u=g[0]+g[1],E=c[0]+c[1],S=s.right+b>=u,h=s.top+k>=E,C=S?u-s.left+w:s.right-w,O=h?E-s.bottom+w:s.top-w;return{x:C,y:O,fixRight:S,fixBottom:h}}function i(t){var o={value:e.decodeURIComponent(t[0]),x:~~t[1],y:~~t[2]};return o}function n(t,o,n,r,s,a){var l=N.data.getWorkBook(t,n),g=l.getSheetObj(o),u=e.JSUtil.Math.hash(r,s,W);a=i(a),g.Notes.set(u,a),H&&c(t,o,n,r,s,a)}function r(t,o,i,n,r){var s=N.data.getWorkBook(t,i),a=s.getSheetObj(o),l=e.JSUtil.Math.hash(n,r,W);a.Notes.get(l)&&(a.Notes.remove(l),H&&g(t,o,i,n,r))}function s(e){return Math.floor(e/W)}function a(e){return e%W}function l(e,t,o){var i=N.data.getWorkBook(e,o),n=i.getSheetObj(t),r=n.Notes.getMap();for(var l in r){var g=s(l),u=a(l);c(e,t,o,g,u,r[l])}H=!0}function c(e,t,o,i,n,r){var s=N.data.getWorkBook(e,o),a=s.getSheetObj(t),l=a.Column.axis,c=a.Row.auxiliaryAxis,g=a.Merge.isXists(i,n),u=l.getPos((g?g.root.endCol:n)+1),E=c.getPos(i);m.publish(T.Listener,x.Layers.Note.Place,{RID:e,SHEETID:t,VERSION:o,ROW:i,COL:n,COMMENT:r.value,X:r.x||u+10,Y:r.y||E-10,ROWX:u,COLY:E})}function g(e,t,o,i,n){m.publish(T.Listener,x.Layers.Note.Remove,{RID:e,SHEETID:t,VERSION:o,ROW:i,COL:n})}function u(e,t,o){m.publish(T.Listener,x.Layers.Note.RemoveAll,{RID:e,SHEETID:t,VERSION:o}),H=!1}function E(e,t,o){H&&l(e,t,o)}function S(){p.show()}function h(){!y&&p.hide()}function C(){if(!y){y=!0,N.data.UserInfo.Permission.isScrollable=!1;var t=e.sPlusPlus.view.Events.Key;t.focusContext(t.Entry.CellNote.Context),e.JSUtil.Mouse.BindOnExternalClick(p.Dom,v)}}function O(){p.delete(),p.hide()}function f(){if(y){y=!1,N.data.UserInfo.Permission.isScrollable=!0;var t=e.sPlusPlus.view.Events.Key;t.focusContext(t.Entry.CellEditor.Context)}}function d(t,i,n,r,s){if(!H&&!y){var a=N.data.getWorkBook(t,n),l=a.getSheetObj(i),c=e.JSUtil.Math.hash(r,s,W),g=l.Notes.get(c),u=o(t,i,n,r,s),E=N.view.getActiveGridID(),h=N.view.getSheetState(E,i),C=(h.getZoom(),l.ProtectedRanges.isXists(r,s)),O=a.ProtectedSheets.isSheetLocked(i);!a.isEditable()||C||O?p.disable():p.enable(),p.setComment(t,i,n,r,s,g.value),p.place(u.x,u.y,u.fixRight,u.fixBottom),S.call(p)}}function v(){y&&p.update(),p.hide()}function R(t,i,n,r,s){var a=o(t,i,n,r,s),l=N.data.getWorkBook(t,n),c=l.getSheetObj(i),g=e.JSUtil.Math.hash(r,s,W),u=c.Notes.get(g),E=u?u.value:"";p.setComment(t,i,n,r,s,E,!0),p.place(a.x,a.y,a.fixRight,a.fixBottom),p.show(),p.focus()}function I(){p.hide()}function M(e){e.stopPropagation()}function L(){var e=document.querySelector(".sheetPaneContainer");p=new P(e,B),p.Dom.classList.add("fifthPane"),m.register(T.Listener,x.CellAction.COMMENT.SHOW,d,"RID","SHEETID","VERSION","ROW","COL"),m.register(T.Listener,x.CellAction.COMMENT.HIDE,h),m.register(T.Listener,x.CellAction.COMMENT.UPDATE,v),m.register(T.Listener,x.CellAction.COMMENT.CANCEL,I),m.register(T.Listener,x.CellAction.COMMENT.NEW,R,"RID","SHEETID","VERSION","ROW","COL"),m.register(T.Listener,x.GridAction.WheelXYPaneContainerScroll,h)}var N=e.sPlusPlus,D=e.ZSEvents,m=D.topic,T=D.Groups,x=D.Names,A=e.ZSClass,P=A.UICellNote,W=N.data.Defaults.MAX_COL,b=222,k=127,w=1;m.register(T.Listener,x.CellAction.COMMENT.ADD,n,"RID","SHEETID","VERSION","ROW","COL","COMMENT"),m.register(T.Listener,x.CellAction.COMMENT.DELETE,r,"RID","SHEETID","VERSION","ROW","COL");var H=!1;m.register(T.Listener,x.SheetAction.ZOOM.On,E,"RID","SHEETID","VERSION"),m.register(T.Listener,x.CellAction.COMMENT.SHOWALL,l,"RID","SHEETID","VERSION"),m.register(T.Listener,x.CellAction.COMMENT.HIDEALL,u,"RID","SHEETID","VERSION");var p,y=!1,B={Container:{mouseover:S,mouseleave:h},Editor:{focus:C,dblclick:M},Trash:{click:O},onHide:f};m.register(T.UI,x.Layout.TEMPLATE_LOADED,L)}(this);
!function(e){function t(e,t,i){var n=0,s=O.view.getActiveGridID(),o=O.view.getResourceID(s),a=O.view.getVersionID(s),r=e.match(U),l=0;t>i&&(t+=i,i=t-i,t-=i);for(var c in r){var u=r[c];if(M.test(u)){var h=JSUtil.Range.parseRange(o,a,u);if(h){if(t>=l&&i<=l+u.length){q.publish(J.Listener,K.RangePicker.Modify,{index:n});break}n++}}l+=u.length}}function i(e){var t=e.keyCode||e.which;return 13===t?(e.preventDefault(),!0):void 0}function n(e){var t="RangePickerOut",n=T.getTemplate([t])[t],s=document.createElement("div");s.className="ui-dialog rPDialog",s.appendChild(n);var o=s.querySelector(".rPhead"),a=s.querySelector(".rPin"),r=s.querySelector(".rPpopin"),l=new N.RangeEditor(a);l.customPreventDefault=i,x.RangePicker.register(l),e.appendChild(s),this.Dom=s,this.input=l,this.popin=r,this.title=o}function s(e,t,i,s,o,a,r){n.call(this,e),this.alive=!0,this.close(),this.width=s,this.height=o,this.onOpen=a,this.onClose=r,this.place(t,i);var u=this;this.Dom.addEventListener("mousedown",function(e){e.target===this&&c(u,e),l()}),this.popin.addEventListener("click",function(){u.close()})}function o(){var e=R.value,i=R.selectionStart,n=R.selectionEnd;D.hide(),this.input.RangePickerOptions=R.RangePickerOptions,this.input.focus(),this.input.value=e,this.input.valueChanged(),this.input.setSelectionRange(i,n),this.input.selectionChanged();var s=R.RangePickerOptions.title;this.setTitle(s),m=!0,t(e,i,n),l()}function a(){var e=this.input.value,i=this.input.selectionStart,n=this.input.selectionEnd;D.show(),R.focus(),R.value=e,R.valueChanged(),R.setSelectionRange(i,n),R.selectionChanged(),P=!1,m=!1,t(e,i,n)}function r(e){return e.preventDefault(),E.close(),!1}function l(){var t=e.sPlusPlus.view.Events.Key;t.focusContext(V)}function c(t,i){C=i,y=t,S=t.left,k=t.top,L=e.innerHeight-t.height,w=e.innerWidth-t.width,i.preventDefault(),e.addEventListener("mousemove",h),e.addEventListener("mouseup",p)}function u(e,t,i){return t=Math.max(e,t),t=Math.min(t,i)}function h(e){var t=e.pageX-C.pageX,i=e.pageY-C.pageY,n=S+t,s=i+k;n=u(0,n,w),s=u(0,s,L),y.place(n,s)}function p(){e.removeEventListener("mousemove",h),e.removeEventListener("mouseup",p)}function v(e,t,i,n){i&&i.addEventListener("mousedown",function(i){i.preventDefault(),i.stopPropagation(),R=e,D=t,P=!0,E.open()}),e.addListeners({focus:function(){D=t,R=e}}),e.RangePickerOptions.title=n}function d(){E=new s(_,(e.innerWidth-Z)/2,100,Z,X,o,a)}function g(){G.isActiveOn(R)&&!P&&E.open()}function f(){m&&!P&&E.close()}var E,m,P,R,D,C,y,S,k,w,L,O=e.sPlusPlus,T=e.UserAction,x=e.ZSClass,A=e.ZSConstants.JSKeyCode,N=x.Editors,G=x.RangePicker,I=JSUtil.REGEXP,U=I.matchRegex,M=I.rangeRegex,b=e.ZSEvents,q=b.topic,J=b.Groups,K=b.Names,X=72,Z=382,_=document.createElement("div");_.className="rPcon",document.body.appendChild(_),s.prototype={place:function(e,t){this.left=e,this.top=t,this.Dom.style.left=e+"px",this.Dom.style.top=t+"px"},setTitle:function(e){this.title.innerText=e},open:function(){this.alive||(this.Dom.style.display="",this.onOpen&&this.onOpen.call(this),this.alive=!0)},close:function(){this.alive&&(this.Dom.style.display="none",this.onClose&&this.onClose.call(this),this.alive=!1)}};var H=e.sPlusPlus.view.Events.Key,V=H.Entry.RangePickerDialog.Context,W=V.keyDown;W[A.ENTER]=r,W[A.ESC]=r,W[A.PURE_PRINTABLE_CHAR]=function(){return!1},G.Dialog={register:v},q.register(J.UI,K.Layout.TEMPLATE_LOADED,d),q.register(J.Gesture.Selector.RangePicker,K.GESTURE.ACTION.MOVE,g),q.register(J.Gesture.Selector.RangePicker,K.GESTURE.ACTION.END,f),q.register(J.Listener,K.RangePicker.Disable,f)}(this);
function getCell(e,t){var i=sPlusPlus,l=i.view.getActiveGridID(),g=i.view.getResourceID(l),r=i.view.getSheetID(l),n=i.view.getVersionID(l),s=i.view.getGridComponent(l);return s.getCellRef(g,r,n,e,t)}function getCellDOM(e,t){var i=getCell(e,t);return i.DOM}function getCellAttribute(e,t,i){var l=getCell(e,t),g=l.DOM;return g.getAttribute(i)}function getCellData(e,t){var i=getCell(e,t);return i.data}function gotoCell(e,t){var i=sPlusPlus,l=i.view.getActiveGridID(),g=i.view.getResourceID(l),r=i.view.getSheetID(l),n=i.view.getVersionID(l),s=new ZSClass.Range(e,t,e,t);UserAction.gotoCell(g,r,n,s,e,t)}function gotoCellRange(e,t,i,l){var g=sPlusPlus,r=g.view.getActiveGridID(),n=g.view.getResourceID(r),s=g.view.getSheetID(r),o=g.view.getVersionID(r),v=new ZSClass.Range(e,t,i,l);UserAction.gotoCell(n,s,o,v,e,t)}function submitCell(e,t,i){var l=sPlusPlus,g=l.view.getActiveGridID(),r=l.view.getResourceID(g),n=l.view.getSelectedSheets(g),s=l.view.getVersionID(g);UserAction.SubmitCell(r,n,s,e,t,i)}
!function(t){function i(){return 0>=g?{sparkline:void 0,index:void 0}:d[g--]}function e(t,i){d[++g]={},d[g].sparkline=t,d[g].index=i}function s(){return JSON.parse(JSON.stringify(x))}function a(t,i,e,s,a){for(var o=e.sparklines.groupranges.getInfo(s,a),n=o.outputRange,r=o.inputRange,h=o.orientationArray,c=0;c<n.length;c++){var p=n[c];if(s>=p[0]&&s<=p[2]&&a>=p[1]&&a<=p[3]){var u=r[c];if(0===Object.keys(u).length&&u.constructor===Object)return void 0;var d=h[c];if("HORIZONTAL"==d&&p[1]==p[3]||"VERTICAL"==d&&p[0]==p[2]){var g=l.FormRange(u,s,a,!1),x=g?JSUtil.Range.parseRange(t,i,g):void 0;return x}var v=p[0]+(a-p[1]),m=p[1]+(s-p[0]),g=l.FormRange(u,v,m,!1),x=g?JSUtil.Range.parseRange(t,i,g):void 0;return x}}}function o(t,i,e,s,a){var o=r.view.getActiveGridID(),h=0,d=r.data.getWorkBook(t,e).getSheetObj(i),g=sPlusPlus.view.getSheetState(o,i),x=g.getActiveCellRange();if(void 0!=x){var s=x.startRow,a=x.startCol,m=d.sparklines.groupranges,R=(d.sparklines.cellRange,m.RangeList.cellRange),S=R[256*s+a];if(void 0==S&&(S=m.RangeList.colRange[a]),void 0!=S){c.publish(p.UI,u.SidePanel.Sparklines.OPEN),c.publish(p.Listener,u.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:t,SHEETID:i,VERSION:e,RANGEIDS:v}),v=[];for(var k=256*S.startRow+S.startCol,f=m.RangeList.masterList[k].outputRange,P=[],A=0;A<f.length;A++){var y=f[A],I=new ZSClass.Range(y[0],y[1],y[2],y[3]),w=d.Merge.getInfo(I.endRow,I.endCol);void 0!=w&&I.union(w),n(I,P)}for(var A=0;A<P.length;A++){var C=P[A],b="#0000FF";h++,c.publish(p.Listener,u.UserAction.HIGHLIGHT_RANGE.ADD,{RID:t,SHEETID:i,VERSION:e,RANGEID:h,RANGE:C,COLOR:b}),v.push(h)}var V=l.SparklinePool.getDataRange(t,e,d,s,a);if(void 0==V)return;if(void 0!=V.range){h++;var b="#FF0000",E=V.sheetID;E==i&&(c.publish(p.Listener,u.UserAction.HIGHLIGHT_RANGE.ADD,{RID:t,SHEETID:i,VERSION:e,RANGEID:h,RANGE:V.range,COLOR:b}),v.push(h))}}else c.publish(p.Listener,u.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:t,SHEETID:i,VERSION:e,RANGEIDS:v}),v=[],c.publish(p.UI,u.SidePanel.Sparklines.CLOSE)}}function n(t,i){for(var e,s=t.startRow,a=t.startCol,o=t.endRow,r=t.endCol,l=0;l<i.length;l++){var h=i[l],c=h.startRow,p=h.endRow,u=h.startCol,d=h.endCol;if(a==u&&r==d){if(o>=c-1&&p>=o)return i.splice(l,1),e=new ZSClass.Range(s,a,p,r),t=e,n(t,i),!0;if(p+1>=s&&s>=c)return i.splice(l,1),e=new ZSClass.Range(c,a,o,r),t=e,n(t,i),!0}else if(s==c&&o==p){if(r>=u-1&&d>=r)return i.splice(l,1),e=new ZSClass.Range(s,a,o,d),t=e,n(t,i),!0;if(d+1>=a&&a>=u)return i.splice(l,1),e=new ZSClass.Range(s,u,o,r),t=e,n(t,i),!0}}return i.push(t),!1}var r=t.sPlusPlus,l=t.JSUtil,h=t.ZSEvents,c=h.topic,p=h.Groups,u=h.Names,d={},g=0,x={chart:{animation:!1,backgroundColor:null,borderWidth:0,type:"",panning:!1,margin:[4,10,4,6],style:{overflow:"visible"},skipClone:!0},title:{text:""},credits:{enabled:!1},xAxis:{tickPositions:[],visible:!1,reversed:!1},accessibility:{enabled:!1},navigator:{enabled:!1},scrollbar:{enabled:!1},rangeSelector:{enabled:!1},yAxis:{endOnTick:!1,startOnTick:!1,visible:!1,min:null,max:null},legend:{enabled:!1},tooltip:{enabled:!1},series:[],plotOptions:{line:{negativeColor:null,animation:!1,boostThreshold:1,color:"#0000FF",lineWidth:1,enableMouseTracking:!1,states:{hover:{enabled:!1}},marker:{enabled:!1,radius:1.5,states:{hover:{enabled:!1}}}},column:{negativeColor:null,boostThreshold:1,minPointLength:1,color:"#0000FF",animation:!1,states:{hover:{enabled:!1}}},series:{pointPadding:.1,groupPadding:.2,borderWidth:1}}},v=[];l.SparklinePool.getFromPool=i,l.SparklinePool.putInPool=e,l.SparklinePool.pool=d,l.SparklinePool.getOptions=s,l.SparklinePool.getDataRange=a,l.SparklinePool.mergeRanges=n,l.SparklinePool.highlightRanges=o,t.JSUtil=l,c.register(p.Listener,u.SheetAction.ACTIVE_CELL.INFO,o,"RID","SHEETID","VERSION","ROW","COLUMN"),c.register(p.Listener,u.SheetAction.SPARKLINES.GROUP,o,"RID","SHEETID","VERSION")}(this),function(t){var i=(t.sPlusPlus,function(t,i,e,s,a,o,n){return this.row=t,this.col=i,this.height=e,this.width=s,this.properties=a,this.minValue,this.maxValue,this.data=this.setData(o,n,a),void 0!=this.data?this.preProcess():{undefined:!0}});i.prototype={setData:function(t,i,e){for(var s=[],a=void 0,o=void 0,n=!0,r=t.range.startRow;r<=t.range.endRow;r++)for(var l=t.range.startCol;l<=t.range.endCol;l++)if(i[r]&&i[r][l]){var h=parseFloat(i[r][l].ActualValue);if(isNaN(h)){if("skip"==e.emptyCell)continue;h="gap"==e.emptyCell?0/0:"zero"==e.emptyCell?0:0/0}o=void 0==o?h:o>h?h:o,a=void 0==a?h:h>a?h:a,isNaN(h)||(n=!1),s.push(h)}return e.reverse&&s.reverse(),this.maxValue=a,this.minValue=o,n?void 0:s},preProcess:function(){var t=parseInt(this.height)-2,i=parseInt(this.width),o=document.createElement("canvas");o.className="sparkline",o.height=t,o.width=i;var n=o.getContext("2d");this.context=n,this.context.data=this.data;var r,l=window.devicePixelRatio||1,r=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1,h=l/r;if(l!==r){var c=o.width,p=o.height;o.width=c*h,o.height=p*h,o.style.width=c+"px",o.style.height=p+"px",n.scale(h,h)}else o.style.width=i+"px",o.style.height=t+"px";var u;this.setPadding(o,t,i),"line"==this.properties.sparklineType?u=new e(o,n,this.data,this.properties,this.minValue,this.maxValue):"column"==this.properties.sparklineType?u=new s(o,n,this.data,this.properties,this.minValue,this.maxValue):"winloss"==this.properties.sparklineType&&(u=new a(o,n,this.data,this.properties,this.minValue,this.maxValue));var o=u.insertSparkline();return o.classList.add("sprkHighChartsCont"),o},setPadding:function(t){t.style.paddingTop="2px",t.style.paddingBottom="2px",t.style.paddingLeft="2px",t.style.paddingRight="2px"},drawMarkers:function(t,e,s,a){this.context.beginPath();var o=i.prototype.setMarkerColor.call(this,t,e);(this.properties.marker||o)&&this.drawMarker(s,a,t),this.context.closePath()},setMarkerColor:function(t,i){var e=!1,s=this.properties,a=s.markerColor;return s.negativePoints&&0>t&&(a=s.negativePointColor,e=!0),s.highPoint&&t==this.maxValue&&(a=s.highPointColor,e=!0),s.lowPoint&&t==this.minValue&&(a=s.lowPointColor,e=!0),s.firstPoint&&0==i&&(a=s.firstPointColor,e=!0),s.lastPoint&&i==this.data.length-1&&(a=s.lastPointColor,e=!0),this.context.strokeStyle=a,this.context.fillStyle=a,e},drawHorizontalAxis:function(t,i,e){this.properties.showAxis&&(this.context.beginPath(),this.context.strokeStyle="#b6b6b6",this.context.moveTo(t,i),this.context.lineTo(t+e,i),this.context.stroke(),this.context.closePath())}};var e=function(t,i,e,s,a,o){this.canvas=t,this.context=i,this.data=e,this.properties=s,this.minValue=a,this.maxValue=o};e.prototype={insertSparkline:function(){var t=.95*parseInt(this.canvas.style.height),e=parseInt(this.canvas.style.width),s=this.data.length,a=e/s,o=.03*a*s;a=(e-o)/s;var n=a,r=this.maxValue,l=this.minValue;"automatic"!=this.properties.verticalAxisMaximum&&(r=this.properties.maxValue),"automatic"!=this.properties.verticalAxisMinimum&&(l=this.properties.minValue);var h=0>l?(t-2)/(r+Math.abs(l)):r>0?(t-2)/(r-l):0;h=.85*h;var c=0>l?t-Math.abs(l)*h:t;this.context.strokeStyle=this.properties.sparklineColor,this.context.beginPath();var p,u,d=this.properties.sparklineColor,g=(this.properties.markerColor,this.properties.highPoint,0);if(i.prototype.drawHorizontalAxis.call(this,g,c,e),g+=o,r==l)return 1==s?this.canvas:(this.context.beginPath(),this.context.moveTo(g,t/2),this.context.strokeStyle=d,this.context.fillStyle=d,this.context.lineTo(e-o,t/2),this.context.stroke(),this.context.closePath(),this.canvas);for(var x=(a-o)/(s-1),v=0;s>v;v++){var m=this.data[v];if(!isNaN(m)||"connect"!=this.properties.emptyCell){var R=m*h+1;R=0>l?c-R:c-R+l*h,this.context.beginPath(),this.context.strokeStyle=d,this.context.fillStyle=d,this.context.moveTo(p,u),0!=v&&this.context.lineTo(g,R),this.context.stroke(),this.context.closePath(),i.prototype.drawMarkers.call(this,m,v,g,R),p=g,u=R}g=g+n+x}return this.context.closePath(),this.canvas},drawMarker:function(t,i){this.context.arc(t,i,1.5,0,2*Math.PI,!0),this.context.fill()}};var s=function(t,i,e,s,a,o){this.canvas=t,this.context=i,this.data=e,this.properties=s,this.horizontalAxis,this.columnWidth,this.columnHeight,this.minValue=a,this.maxValue=o};s.prototype={insertSparkline:function(){var t=parseInt(this.canvas.style.height),e=parseInt(this.canvas.style.width),s=this.data.length,a=e/s,o=.3*a,n=this.maxValue,r=this.minValue;"automatic"!=this.properties.verticalAxisMaximum&&(n=this.properties.maxValue),"automatic"!=this.properties.verticalAxisMinimum&&(r=this.properties.minValue),this.columnWidth=.7*a;var l;l=n==r?t/Math.abs(n):0>r?t/(n+Math.abs(r)):t/(n-r),l=.85*l,this.horizontalAxis=0>r?t-Math.abs(r)*l:t;var h=0;i.prototype.drawHorizontalAxis.call(this,h,this.horizontalAxis,e);for(var c=0;s>c;c++){h+=o/2;var p=this.data[c];this.columnHeight=0-p*l,this.columnHeight=r==n?0>=r?this.columnHeight:this.columnHeight-1:0>=r?this.columnHeight:this.columnHeight+r*l-1,this.context.beginPath(),this.context.strokeStyle=this.properties.sparklineColor,this.context.fillStyle=this.properties.sparklineColor,0==c?(this.context.moveTo(h,this.horizontalAxis),this.context.fillRect(h,this.horizontalAxis,this.columnWidth,this.columnHeight)):this.context.fillRect(h,this.horizontalAxis,this.columnWidth,this.columnHeight),this.context.stroke(),this.context.closePath(),i.prototype.drawMarkers.call(this,p,c,h,this.horizontalAxis),h=h+this.columnWidth+o/2}return this.context.closePath(),this.canvas},drawMarker:function(t){this.context.fillRect(t,this.horizontalAxis,this.columnWidth,this.columnHeight)}};var a=function(t,i,e,s,a,o){this.canvas=t,this.context=i,this.data=e,this.properties=s,this.horizontalAxis,this.columnWidth,this.verticalSpacing,this.minValue=a,this.maxValue=o};a.prototype={insertSparkline:function(){var t=parseInt(this.canvas.style.height),e=parseInt(this.canvas.style.width),s=this.data.length,a=e/s,o=.3*a,n=(this.maxValue,this.minValue,this.maxValue),r=this.minValue;"automatic"!=this.properties.verticalAxisMaximum&&(n=this.properties.maxValue),"automatic"!=this.properties.verticalAxisMinimum&&(r=this.properties.minValue),this.columnWidth=.7*a,this.verticalSpacing=.8*t/2,this.verticalSpacing=.85*this.verticalSpacing,this.horizontalAxis=t/2;var l=0;i.prototype.drawHorizontalAxis.call(this,l,this.horizontalAxis,e);for(var h=0;s>h;h++){l+=o/2;var c=this.data[h],p=c>0?1:0>c?-1:c,u=(0-p)*this.verticalSpacing;p=0>r?this.horizontalAxis-p:this.horizontalAxis-p+r*this.verticalSpacing,this.context.strokeStyle=this.properties.sparklineColor,this.context.fillStyle=this.properties.sparklineColor,this.context.beginPath(),0==h?(this.context.moveTo(l,p),this.context.fillRect(l,this.horizontalAxis,this.columnWidth,u)):this.context.fillRect(l,this.horizontalAxis,this.columnWidth,u),this.context.stroke(),this.context.closePath(),i.prototype.drawMarkers.call(this,c,h,l,p),l=l+this.columnWidth+o/2}return this.context.closePath(),this.canvas},drawMarker:function(t,i,e){var s=e>0?1:0>e?-1:e;this.context.fillRect(t,this.horizontalAxis,this.columnWidth,-s*this.verticalSpacing)}},ZSClass.Sparkline=i}(this);
!function(o){var N=o.ZSConstants,n=N.I18N;if(n&&N.I18N_COMPONENTS){var s={ok:n.OK,cancel:n["Dialog.Button.Cancel"],close:n.Close};N.I18N_COMPONENTS.common=s}o.ZComponents.setI18NKeys(N.I18N_COMPONENTS)}(this);
!function(t){function i(t,i,n,e){this.id=t,this.description=i,this.arguments=n,this.returntype=e,this.script=null}i.prototype={setScript:function(t){this.script=t},setDescription:function(t){this.description=t},setArguments:function(t){this.arguments=t},setReturnType:function(t){this.returntype=t},setId:function(t){this.id=t},getScript:function(){return this.script},getDescription:function(){return this.description},getArguments:function(){return this.arguments},getReturnType:function(){return this.returntype},getId:function(){return this.id}},t.ZSClass.DelugeFunction=i}(this);
!function(e){var s=e.sPlusPlus,t=e.UserAction;t.loadInitialVariable(s.data.AppRegistry.LoadVar),t.processResponse(s.transientResponse),s.clearTransientQueue(),delete s.transientResponse}(this);
!function(t){function e(){var t=a.getTemplate(["BOTTOMCARDINFO"]),e=t.BOTTOMCARDINFO;o=e.querySelector("#btmCardInfo"),s=o.querySelector("#infoBanner");var n=o.querySelector("#btmInfoClsBtn");n.addEventListener("click",function(){r&&r.hide()}),o.style.display="none",c.body.appendChild(e),y=!0,i&&i.show()}function n(t){t?(this.dom=c.createElement("div"),this.dom.appendChild(t),this.isShown=!1):p.alert("Error","DOM is mandatory",t)}var o,s,i,r,a=(t.sPlusPlus,t.UserAction),d=t.ZSEvents,l=d.topic,h=d.Groups,u=d.Names,c=t.document,p=(ZSConstants.I18N,t.ZSConstants.FeatureConstants,t.ZSDevTools.Logger),y=!1;n.prototype={show:function(){return y?(this.remove(),o.style.display="",s.appendChild(this.dom),r=this,void(this.isShown=!0)):void(i=this)},hide:function(){o.style.display="none"},remove:function(){s.innerHTML="",this.isShown=!1}},l.register(h.UI,u.Layout.TEMPLATE_LOADED_DEFER,e),t.ZSClass.InfoBanner=n}(this);
!function(t){function e(t,e,i){this.sheetID=t,this.name=e,this.tab=this.createDom(i),this.color}var i=t.ZSClass,s=t.JSUtil,n=t.ZSConstants.I18N,a=t.UIUtil;e.prototype={createDom:function(t){var e=document.createElement("li");e.innerText=this.name,e.classList.add("tab"),e.setAttribute("data-sheet-id",this.sheetID),e.setAttribute("context","MI_SHEET_CONTEXT"),t.DBLCLICK&&e.addEventListener("dblclick",t.DBLCLICK.bind(this)),t.MOUSEDOWN&&e.addEventListener("mousedown",t.MOUSEDOWN.bind(this));var i=document.getElementById("MI_SHEET_CONTEXT");if(null!=i){var s=document.createElement("span");s.className="sheetTabArrow",s.setAttribute("data-menu-id","MI_SHEET_CONTEXT"),a.fn.addIcon(s,"PATCHED_DROPDOWN_ICON"),e.appendChild(s)}return e},getTab:function(){return this.tab},delete:function(){var t=this.getTab();t.remove()},rename:function(t){var e=document.getElementById("MI_SHEET_CONTEXT");if(null!=e){this.name=t,this.tab.innerText=t;var i=document.createElement("span");i.className="sheetTabArrow",i.setAttribute("data-menu-id","MI_SHEET_CONTEXT"),a.fn.addIcon(i,"PATCHED_DROPDOWN_ICON"),this.tab.appendChild(i)}},active:function(){this.tab.classList.add("activeTab"),this.color&&this.setColor(this.color,!0)},inActive:function(){this.tab.classList.remove("activeTab"),this.color&&this.setColor(this.color,!1)},setColor:function(t,e){if(t=t||"",this.tab.style.color="#000",this.tab.style.background="",t)if(e)this.tab.style.background="linear-gradient(to top,"+t+" 5px,#fff 3px)";else{var i=s.fn.isDarkerColor(t);this.tab.style.background=t,this.tab.style.color=i?"#fff":"#000"}this.color=t},addFormIcon:function(){this.tab.classList.add("shIconAfter","formIcon")},removeFormIcon:function(){this.tab.classList.remove("shIconAfter","formIcon")},hideSheet:function(){this.tab.remove()},addLockIcon:function(){this.tab.classList.add("shIconBefore","lockIcon")},removeLockIcon:function(){this.tab.classList.remove("shIconBefore","lockIcon")},applyHighlightLock:function(){this.tab.classList.add("hgtLockIcon")},removeHighlightLock:function(){this.tab.classList.remove("hgtLockIcon")},addVersionEditNumber:function(t){var e=t>1?n.edits:n.edit,i=s.fn.replaceParams(n["AT.sheetTabCallOutMsg"],[t,e]),a=document.createElement("span");a.title=i,a.innerText=t,this.tab.appendChild(a),this.tab.classList.add("editNumber")},removeVersionEditNumber:function(){var t=this.tab.classList;t.contains("editNumber")&&t.remove("editNumber")}},i.SheetTab=e}(this);
!function(e){function t(e,t){this.sheetTabsMap=Object.create(null),this.parent=e,this.listener=t,this.activeSheetID}var i=(e.sPlusPlus,e.ZSClass),h=i.SheetTab;t.prototype={flush:function(){this.parent.innerHTML="",this.sheetTabsMap=Object.create(null),this.activeSheetID=void 0},insert:function(e,t,i,a){var s=new h(e,t,this.listener);this.sheetTabsMap[e]=s;var n=s.getTab();if(a){var r=this.parent.children[a];this.parent.insertBefore(n,r)}else this.parent.appendChild(n);i&&this.setColor(e,i)},setActiveSheetID:function(e){this.sheetTabsMap[this.activeSheetID]&&this.sheetTabsMap[this.activeSheetID].inActive(),this.activeSheetID=e;var t=this.getSheetTab(e);t.active()},getActiveSheetID:function(){return this.activeSheetID},setColor:function(e,t){var i=this.getSheetTab(e);i.setColor(t,this.activeSheetID===e)},rename:function(e,t){var i=this.getSheetTab(e);i.rename(t)},delete:function(e){var t=this.getSheetTab(e);t.delete(),delete this.sheetTabsMap[e]},addFormIcon:function(e){var t=this.getSheetTab(e);t.addFormIcon()},removeFormIcon:function(e){var t=this.getSheetTab(e);t.removeFormIcon()},addLockIcon:function(e){var t=this.getSheetTab(e);t.addLockIcon()},removeLockIcon:function(e){var t=this.getSheetTab(e);t.removeLockIcon()},applyHighlightLock:function(e){var t=this.getSheetTab(e);t.applyHighlightLock()},removeHighlightLock:function(e){var t=this.getSheetTab(e);t.removeHighlightLock()},addVersionEditNumber:function(e,t){var i=this.getSheetTab(e);i.addVersionEditNumber(t)},removeAllVersionEditNumber:function(){for(var e in this.sheetTabsMap){var t=this.getSheetTab(e);t.removeVersionEditNumber()}},moveTo:function(e,t){var i=this.sheetTabsMap[e],h=i.getTab();if(t===this.parent.childElementCount-1)this.parent.appendChild(h);else{var a=Array.prototype.indexOf.call(this.parent.childNodes,h);t>a&&t++,this.parent.insertBefore(h,this.parent.childNodes[t])}},hidesheet:function(e){var t=this.sheetTabsMap[e];t&&t.hideSheet()},getSheetTab:function(e){return this.sheetTabsMap[e]},getSheetListMap:function(){return this.sheetTabsMap}},i.SheetTabController=t}(this);
!function(e){function t(){var e=C.view.getActiveGridID(),t=C.view.getResourceID(e),r=C.view.getSheetID(e),o=C.view.getVersionID(e),i=this.sheetID;UserAction.SwitchSheet(t,r,o,i)}function r(e,t,r){if(y)for(var o in K){var i=K[o];if(i.rID===e&&i.version===r){var n=y.offsetWidth,a=i.getSheetTabController(),s=a.getSheetTab(t),v=s.getTab(),c=v.offsetLeft,S=v.offsetWidth;if(c-y.scrollLeft<0)y.scrollLeft=n>c?0:c;else if(c+S-y.scrollLeft>n){var E=c+S-n;F.scrollLeft=c>=y.scrollWidth-n?E:y.scrollWidth}else c-F.scrollLeft-F.offsetLeft<0&&(F.scrollLeft+=c-F.scrollLeft-F.offsetLeft)}}}function o(e,t,r){C.data.getWorkBook(e,t);for(var o in K){var i=K[o];if(i.rID==e&&i.version==t)for(var n=0;n<r.length;n++){var s=r[n][0],v=r[n][2],c=i.getSheetTabController(),S=a(e,t,v);c.moveTo(s,S)}}}function i(e,t,r){for(var o in K){var i,n=K[o];if(n.rID==e&&n.version==t){var s=C.data.getWorkBook(e,t),v=n.getSheetTabController();for(var c in r){n.unHideSheet(r[c]);var i=r[c][0],S=r[c][2],E=a(e,t,S);v.moveTo(i,E);var l=s.ProtectedSheets.isSheetLocked(i);l&&n.addLockIcon(r[c])}}}}function n(e,t,r){this.rID=e,this.version=t,this.controller=r}function a(e,t,r){for(var o=C.data.getWorkBook(e,t),i=o.SheetList,n=i.getSheets(!0),a=(n.length,0),s=0;r>s;s++){var v=n[s];v.isHidden||a++}return a}function s(e,t,r){var o=C.view.getActiveGridID();if(K[o]){var i=K[o];i.flush()}var a=C.data.getWorkBook(e,t);K[o]=new n(e,t,new P(F,a.isEditable()?ZSClass.SheetTabListener:ZSClass.ReadOnlySheetTabListener));for(var s in r)r[s][4]||K[o].insert(r[s]);B.sortable(F,{disabled:a.isEditable()?!1:!0}),"Head"!=t?F.classList.add("noArrow"):F.classList.remove("noArrow")}function v(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r)i.insert(r[n])}}function c(e,t,o){for(var i in K){var a=K[i];if(a.rID===e&&a.version===t){var s=a.getSheetTabController();s.setActiveSheetID(o),r(e,o,t)}else{K[i]&&K[i].flush();var v=C.data.getWorkBook(e,t),c=v.SheetList.getSheets();K[i]=new n(e,t,new P(F,v.isEditable()?ZSClass.SheetTabListener:ZSClass.ReadOnlySheetTabListener));for(var S=0,E=c.length;E>S;S++){var l=c[S];K[i].insertNew(l.getID(),l.getName(),l.getStyle())}v.isEditable()?B.sortable(F,{disabled:!1}):B.sortable(F,{disabled:!0});var s=K[i].getSheetTabController();s.setActiveSheetID(o),r(e,o,t)}}}function S(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r)i.rename(r[n])}}function E(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r)i.setColor(r[n])}}function l(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r)i.delete(r[n])}}function f(e,t,r){for(var o in K){var i=K[o];i.rID===e&&i.version===t&&I(i,r)}}function I(e,t){var r,o=C.data.getWorkBook(e.rID,e.version),i=e.getSheetTabController(),n=i.getActiveSheetID(),a=o.SheetList.clone();for(var s in t){var v=t[s],c=v[0];n===c?r=!0:a.removeById(c)}if(r){var S=a.getNextAvalable(n);UserAction.SwitchSheet(e.rID,n,e.version,S)}}function h(e,t,r){for(var o in K){var i=K[o];i.rID===e&&i.version===t&&D(i,r)}}function D(e,t){var r,o=C.data.getWorkBook(e.rID,e.version),i=e.getSheetTabController(),n=i.getActiveSheetID(),a=o.SheetList.clone();for(var s in t){var v=t[s],c=v[0];n===c&&(r=!0)}if(r){var S=a.getNextAvalable(n);UserAction.SwitchSheet(e.rID,n,e.version,S)}}function d(e,t,r){for(var o in K){var i,n=K[o];if(n.rID==e&&n.version==t)for(var a=0;a<r.length;a++){i=r[a][0];var s=r[a][4],v=n.getSheetTabController();v.hidesheet(i,s)}}}function g(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t){var n=C.data.getWorkBook(e,t);for(var a in r){var s=r[0][0],v=n.SheetList.getById(s).getHidden();!v&&i.addFormIcon(r[a])}}}}function T(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t){var n=C.data.getWorkBook(e,t),a=r[0],s=n.SheetList.getById(a).getHidden();!s&&i.addFormIcon(r)}}}function L(e,t,r){for(var o in K){var i=K[o];i.rID===e&&i.version===t&&i.removeFormIcon(r)}}function R(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t){var n=C.data.getWorkBook(e,t);for(var a in r){var s=r[a][1],v=n.SheetList.getById(r[a][0]).getHidden();s&&!v&&i.addLockIcon(r[a])}}}}function u(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r){var a=r[n][1];a?i.addLockIcon(r[n]):i.removeLockIcon(r[n])}}}function O(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r)i.removeLockIcon(r[n])}}function H(e,t,r){var o=C.data.getWorkBook(e,t);if(o.highlightLocks){var r=o.ProtectedSheets;for(var i in K){var n=K[i];if(n.rID===e&&n.version===t)for(var a=Object.keys(r),s=0;s<a.length;s++){var v=a[s],c=r[v],S=o.SheetList.getById(v).getHidden();!S&&c&&n.applyHighlightLock(v)}}}}function A(e,t,r){var o=C.data.getWorkBook(e,t),r=o.ProtectedSheets;for(var i in K){var n=K[i];if(n.rID===e&&n.version===t)for(var a=Object.keys(r),s=0;s<a.length;s++){var v=a[s],c=r[v],S=o.SheetList.getById(v).getHidden();!S&&c&&n.removeHighlightLock(v)}}}function k(e,t,r){for(var o in K){var i=K[o];if(i.rID===e&&i.version===t)for(var n in r){var a=r[n];i.addVersionEditNumber(n,a.length)}}}function b(e,t){for(var r in K){var o=K[r];o.rID===e&&o.version===t&&o.removeAllVersionEditNumber()}}function m(e,t,o,i){e.preventDefault();var n=C.view.CellEditor;if(!n.getEditStatus())for(var a in K){var s=K[a];if(s.rID===t&&s.version===i){var v=e.keyCode,c=s.getSheetTabController(),S=c.getActiveSheetID(),E=C.data.getWorkBook(t,i).SheetList,l=E.getPosById(S);if(v==X.RIGHT){if(l++,l>=E.length)return}else if(v==X.LEFT&&(l--,0>l))return;window.clearTimeout(Z),x=!0;var f=E.getByPos(l).Id,I=c.getSheetTab(S);I.inActive(),c.setActiveSheetID(f),S=f;var h=c.getSheetTab(S);h.active(),r(t,f,i),Z=window.setTimeout(function(){UserAction.SwitchSheet(t,o,i,S),x=!1},300)}}}function N(){var e=C.view.getActiveGridID(),t=C.view.getSheetID(e),r=(C.view.getSheetState(e,t),C.view.getResourceID(e)),o=C.view.getVersionID(e),i=C.data.getWorkBook(r,o);return i.ProtectedSheets.isSheetLocked(t)}var C=e.sPlusPlus,V=e.ZSEvents,w=V.topic,W=V.Groups,_=V.Names,B=e.UIUtil.Component,M=C.view.Toolbar.Feature.SHEET_TAB,y=M.sheetsTabDom,F=M.sheetTabHolderDom,K=(M.sheetListHolderDom,Object.create(null)),P=(ZSClass.SheetTab,ZSClass.SheetTabController),p={MOUSEDOWN:t,DBLCLICK:function(){!N()&&UserAction.UISheetRename&&UserAction.UISheetRename.call(this)}},U=[];B.sortable(F,{axis:"x",tolerance:"pointer",start:function(e,t){U=t.item.parent().children("li[context='MI_SHEET_CONTEXT']")},update:function(e,t){var r=C.view.getActiveGridID(),o=C.view.getResourceID(r),i=C.view.getVersionID(r),n=C.data.getWorkBook(o,i),a=n.SheetList,s=t.item.data("sheetId"),v=t.item.index(),c=U[v],S=0;if(c){var E=c.dataset.sheetId;S=a.getPosById(E,!0)}UserAction.MoveSheet(o,[s],i,S)}});var G={MOUSEDOWN:t};ZSClass.SheetTabListener=p,ZSClass.ReadOnlySheetTabListener=G,n.prototype={flush:function(){this.rID=void 0,this.version=void 0,this.controller.flush()},unHideSheet:function(e){var t=e[0],r=e[1],o=(e[2],e[3]);this.controller.insert(t,r,o)},insert:function(e){var t=e[0],r=e[1],o=e[2],i=e[3];this.controller.insert(t,r,i,o)},insertNew:function(e,t,r){this.controller.insert(e,t,r)},delete:function(e){var t=e[0];this.controller.delete(t)},getSheetTabController:function(){return this.controller},rename:function(e){var t=e[0],r=e[1];this.controller.rename(t,r)},setColor:function(e){var t=e[0],r=e[3];this.controller.setColor(t,r)},addFormIcon:function(e){var t=e[0];this.controller.addFormIcon(t)},removeFormIcon:function(e){var t=e[0];this.controller.removeFormIcon(t)},addLockIcon:function(e){var t=e[0];this.controller.addLockIcon(t)},removeLockIcon:function(e){var t=e[0];this.controller.removeLockIcon(t)},applyHighlightLock:function(e){this.controller.applyHighlightLock(e)},removeHighlightLock:function(e){this.controller.removeHighlightLock(e)},addVersionEditNumber:function(e,t){this.controller.addVersionEditNumber(e,t)},removeAllVersionEditNumber:function(){this.controller.removeAllVersionEditNumber()},getSheetTabList:function(){return this.controller.getSheetListMap()}};var Z="",x=!1;C.view.getSheetTabHolder=function(){return K};var j=e.sPlusPlus.view.Events.Key,Y=j.Entry.ReadOnlyShortCut.Context,J=Y.keyDown,X=e.ZSConstants.JSKeyCode;J[X.ALT+"+"+X.LEFT]=m,J[X.ALT+"+"+X.RIGHT]=m,w.register(W.Listener,_.DocMeta.WORKSHEETS,s,"RID","VERSION","SHEET_NAME_LISTS"),w.register(W.Listener,_.DocAction.WORKSHEETS.INSERT,v,"RID","VERSION","INSERT"),w.register(W.Listener,_.DocAction.WORKSHEETS.ON_BEFORE_DELETE,f,"RID","VERSION","DELETE"),w.register(W.Listener,_.DocAction.WORKSHEETS.DELETE,l,"RID","VERSION","DELETE"),w.register(W.Listener,_.DocMeta.ACTIVE_SHEET,c,"RID","VERSION","ACTIVE_SHEET"),w.register(W.Listener,_.DocAction.WORKSHEETS.RENAME,S,"RID","VERSION","RENAME"),w.register(W.Listener,_.DocAction.WORKSHEETS.TABCOLOR,E,"RID","VERSION","TABCOLOR"),w.register(W.Listener,_.DocMeta.SCROLL_SHEET,r,"RID","SHEETID","VERSION"),w.register(W.Listener,_.DocAction.WORKSHEETS.MOVE,o,"RID","VERSION","MOVE"),w.register(W.Listener,_.DocAction.WORKSHEETS.ONBEFORE_HIDE_SHEETS,h,"RID","VERSION","meta"),w.register(W.Listener,_.DocAction.WORKSHEETS.HIDE_SHEETS,d,"RID","VERSION","meta"),w.register(W.Listener,_.DocAction.WORKSHEETS.UNHIDE_SHEETS,i,"RID","VERSION","meta"),w.register(W.Listener,_.DocMeta.FORM_SHEETS,g,"RID","VERSION","FORMSHEETS"),w.register(W.Listener,_.DocAction.FORM_SHEETS.ADD,T,"RID","VERSION","FORMSHEETS"),w.register(W.Listener,_.DocAction.FORM_SHEETS.DELETE,L,"RID","VERSION","FORMSHEETS"),w.register(W.Listener,_.DocMeta.PROTECTED_SHEETS,R,"RID","VERSION","PROTECTED_SHEETS"),w.register(W.Listener,_.DocAction.PROTECTED_SHEETS.MODIFY,u,"RID","VERSION","MODIFY"),w.register(W.Listener,_.DocAction.PROTECTED_SHEETS.REMOVE,O,"RID","VERSION","REMOVE"),w.register(W.Listener,_.DocAction.PROTECTED_SHEETS.MODIFY,H,"RID","VERSION","PROTECTED_SHEETS"),w.register(W.Listener,_.UserAction.HIGHLIGHT_LOCKS,H,"RID","VERSION","SHEETLIST"),w.register(W.Listener,_.UserAction.REMOVE_HIGHLIGHT_LOCKS,A,"RID","VERSION","SHEETLIST"),w.register(W.Listener,_.DocAction.WORKSHEETS.ADD_NO_OF_EDITS,k,"RID","VERSION","DATA"),w.register(W.Listener,_.DocAction.WORKSHEETS.REMOVE_NO_OF_EDITS,b,"RID","VERSION")}(this);
